{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8864536713058956, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9068996362158033, "policy_loss": -0.01673055462245616, "vf_loss": 3.920401477128172, "vf_explained_var": 0.0005088338709740847, "kl": 0.016143559211762623, "entropy": 1.5880840151073834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -117.0, "episode_reward_min": -1597.0, "episode_reward_mean": -667.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -66.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.0, -936.0, -746.0, -160.0, -1178.0, -155.0, -1049.0, -490.0, -619.0, -145.0, -1597.0, -1070.0, -690.0, -785.0, -421.0, -663.0, -117.0, -632.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-146.0, -162.0, 0.0, 0.0, 0.0, -205.0, 0.0, 20.0, -69.0, 0.0, -315.0, 0.0, 8.0, -55.0, 0.0, 0.0, -4.0, -485.0, -95.0, 10.0, -11.0, -325.0, -9.0, 0.0, -65.0, -1.0, -5.0, 0.0, -340.0, 10.0, 10.0, 0.0, -5.0, -5.0, 0.0, -150.0, -60.0, 0.0, 10.0, 40.0, -305.0, -5.0, 0.0, 0.0, -2.0, 0.0, -250.0, -155.0, -1.0, -460.0, 0.0, -115.0, -60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -458.0, 10.0, -460.0, -30.0, -20.0, 0.0, 10.0, 0.0, -111.0, 10.0, 0.0, 0.0, 40.0, -25.0, -120.0, 20.0, 10.0, -345.0, -70.0, 0.0, -90.0, 0.0, -152.0, 0.0, 0.0, -347.0, -40.0, 0.0, 10.0, 0.0, 0.0, -3.0, -1.0, -4.0, 0.0, 0.0, -75.0, 0.0, 8.0, -70.0, -475.0, 0.0, 0.0, -20.0, -182.0, -75.0, -495.0, -350.0, 0.0, 0.0, -120.0, 0.0, -185.0, -125.0, 0.0, -100.0, 10.0, 0.0, -550.0, 0.0, -95.0, -185.0, -5.0, 0.0, 0.0, -180.0, 0.0, 0.0, 0.0, -225.0, 30.0, 0.0, -230.0, -80.0, -275.0, -210.0, 0.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, -195.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 19.0, 0.0, -25.0, -2.0, 0.0, 0.0, -430.0, -245.0, 0.0, 20.0, -33.0, 0.0, -40.0, -13.0, -25.0, 9.0, -2.0, -11.0, -10.0, 8.0, 0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2740685543298786, "mean_inference_ms": 1.7266907697054346, "mean_action_processing_ms": 0.656441573123694, "mean_env_wait_ms": 1.8424078520730756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.026089615292019315, "StateBufferConnector_ms": 0.012254714965820312, "ViewRequirementAgentConnector_ms": 0.8967704243130155}, "num_episodes": 18, "episode_return_max": -117.0, "episode_return_min": -1597.0, "episode_return_mean": -667.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.847962025442442, "num_env_steps_trained_throughput_per_sec": 19.847962025442442, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 201532.033, "restore_workers_time_ms": 0.016, "training_step_time_ms": 201531.981, "sample_time_ms": 3582.561, "learn_time_ms": 197931.958, "learn_throughput": 20.209, "synch_weights_time_ms": 9.462}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "a22d3_00000", "date": "2024-08-05_22-46-48", "timestamp": 1722912408, "time_this_iter_s": 201.5423059463501, "time_total_s": 201.5423059463501, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0183af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.5423059463501, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.26341463414635, "ram_util_percent": 78.92543554006969}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.240867681548999, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9809975195680056, "policy_loss": -0.01379039359898371, "vf_loss": 1.993235248485947, "vf_explained_var": 0.011813413950835808, "kl": 0.007763323883064939, "entropy": 1.574836359872097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 53.0, "episode_reward_min": -1597.0, "episode_reward_mean": -387.9166666666667, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -38.791666666666664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.0, -936.0, -746.0, -160.0, -1178.0, -155.0, -1049.0, -490.0, -619.0, -145.0, -1597.0, -1070.0, -690.0, -785.0, -421.0, -663.0, -117.0, -632.0, -120.0, -64.0, -66.0, -43.0, -423.0, -32.0, -85.0, 0.0, -286.0, -110.0, -361.0, -95.0, -33.0, -26.0, -130.0, 18.0, -147.0, 53.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-146.0, -162.0, 0.0, 0.0, 0.0, -205.0, 0.0, 20.0, -69.0, 0.0, -315.0, 0.0, 8.0, -55.0, 0.0, 0.0, -4.0, -485.0, -95.0, 10.0, -11.0, -325.0, -9.0, 0.0, -65.0, -1.0, -5.0, 0.0, -340.0, 10.0, 10.0, 0.0, -5.0, -5.0, 0.0, -150.0, -60.0, 0.0, 10.0, 40.0, -305.0, -5.0, 0.0, 0.0, -2.0, 0.0, -250.0, -155.0, -1.0, -460.0, 0.0, -115.0, -60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -458.0, 10.0, -460.0, -30.0, -20.0, 0.0, 10.0, 0.0, -111.0, 10.0, 0.0, 0.0, 40.0, -25.0, -120.0, 20.0, 10.0, -345.0, -70.0, 0.0, -90.0, 0.0, -152.0, 0.0, 0.0, -347.0, -40.0, 0.0, 10.0, 0.0, 0.0, -3.0, -1.0, -4.0, 0.0, 0.0, -75.0, 0.0, 8.0, -70.0, -475.0, 0.0, 0.0, -20.0, -182.0, -75.0, -495.0, -350.0, 0.0, 0.0, -120.0, 0.0, -185.0, -125.0, 0.0, -100.0, 10.0, 0.0, -550.0, 0.0, -95.0, -185.0, -5.0, 0.0, 0.0, -180.0, 0.0, 0.0, 0.0, -225.0, 30.0, 0.0, -230.0, -80.0, -275.0, -210.0, 0.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, -195.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 19.0, 0.0, -25.0, -2.0, 0.0, 0.0, -430.0, -245.0, 0.0, 20.0, -33.0, 0.0, -40.0, -13.0, -25.0, 9.0, -2.0, -11.0, -10.0, 8.0, 0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0, 10.0, -120.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -25.0, 10.0, 0.0, 10.0, 2.0, -11.0, 0.0, 0.0, -60.0, -17.0, -1.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, -1.0, -50.0, -53.0, -283.0, -20.0, -55.0, 12.0, -25.0, 0.0, -9.0, 20.0, -10.0, -1.0, 0.0, 10.0, 0.0, -11.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, 0.0, -35.0, -45.0, -15.0, -6.0, -10.0, 0.0, 10.0, 0.0, 0.0, -185.0, -7.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -103.0, 0.0, 0.0, 0.0, -52.0, -125.0, -54.0, -160.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -65.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -45.0, -4.0, 0.0, 10.0, 0.0, -4.0, 20.0, -65.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -18.0, -10.0, -8.0, -5.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -170.0, 4.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -4.0, -138.0, -3.0, 0.0, 0.0, -4.0, -8.0, 0.0, 10.0, -4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.154453143643473, "mean_inference_ms": 1.686864642778067, "mean_action_processing_ms": 0.6389018070239203, "mean_env_wait_ms": 1.8086374115796913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019880798127916124, "StateBufferConnector_ms": 0.01189377572801378, "ViewRequirementAgentConnector_ms": 0.6999956236945258}, "num_episodes": 18, "episode_return_max": 53.0, "episode_return_min": -1597.0, "episode_return_mean": -387.9166666666667}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.773354545279805, "num_env_steps_trained_throughput_per_sec": 19.773354545279805, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 201912.237, "restore_workers_time_ms": 0.014, "training_step_time_ms": 201912.189, "sample_time_ms": 3385.47, "learn_time_ms": 198508.897, "learn_throughput": 20.15, "synch_weights_time_ms": 9.594}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "a22d3_00000", "date": "2024-08-05_22-50-10", "timestamp": 1722912610, "time_this_iter_s": 202.30199193954468, "time_total_s": 403.8442978858948, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01baf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 403.8442978858948, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.481881533101046, "ram_util_percent": 78.9362369337979}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.134638003305124, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5232845166874642, "policy_loss": -0.006543124647051318, "vf_loss": 1.5286079644458617, "vf_explained_var": 0.05874799346517577, "kl": 0.0060983736319002784, "entropy": 1.569085514926301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 53.0, "episode_reward_min": -1597.0, "episode_reward_mean": -263.85185185185185, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -26.385185185185186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.0, -936.0, -746.0, -160.0, -1178.0, -155.0, -1049.0, -490.0, -619.0, -145.0, -1597.0, -1070.0, -690.0, -785.0, -421.0, -663.0, -117.0, -632.0, -120.0, -64.0, -66.0, -43.0, -423.0, -32.0, -85.0, 0.0, -286.0, -110.0, -361.0, -95.0, -33.0, -26.0, -130.0, 18.0, -147.0, 53.0, 15.0, 4.0, -33.0, 24.0, -7.0, -11.0, -105.0, -41.0, -74.0, 30.0, -41.0, 2.0, 10.0, -6.0, -10.0, -34.0, -24.0, 18.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-146.0, -162.0, 0.0, 0.0, 0.0, -205.0, 0.0, 20.0, -69.0, 0.0, -315.0, 0.0, 8.0, -55.0, 0.0, 0.0, -4.0, -485.0, -95.0, 10.0, -11.0, -325.0, -9.0, 0.0, -65.0, -1.0, -5.0, 0.0, -340.0, 10.0, 10.0, 0.0, -5.0, -5.0, 0.0, -150.0, -60.0, 0.0, 10.0, 40.0, -305.0, -5.0, 0.0, 0.0, -2.0, 0.0, -250.0, -155.0, -1.0, -460.0, 0.0, -115.0, -60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -458.0, 10.0, -460.0, -30.0, -20.0, 0.0, 10.0, 0.0, -111.0, 10.0, 0.0, 0.0, 40.0, -25.0, -120.0, 20.0, 10.0, -345.0, -70.0, 0.0, -90.0, 0.0, -152.0, 0.0, 0.0, -347.0, -40.0, 0.0, 10.0, 0.0, 0.0, -3.0, -1.0, -4.0, 0.0, 0.0, -75.0, 0.0, 8.0, -70.0, -475.0, 0.0, 0.0, -20.0, -182.0, -75.0, -495.0, -350.0, 0.0, 0.0, -120.0, 0.0, -185.0, -125.0, 0.0, -100.0, 10.0, 0.0, -550.0, 0.0, -95.0, -185.0, -5.0, 0.0, 0.0, -180.0, 0.0, 0.0, 0.0, -225.0, 30.0, 0.0, -230.0, -80.0, -275.0, -210.0, 0.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, -195.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 19.0, 0.0, -25.0, -2.0, 0.0, 0.0, -430.0, -245.0, 0.0, 20.0, -33.0, 0.0, -40.0, -13.0, -25.0, 9.0, -2.0, -11.0, -10.0, 8.0, 0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0, 10.0, -120.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -25.0, 10.0, 0.0, 10.0, 2.0, -11.0, 0.0, 0.0, -60.0, -17.0, -1.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, -1.0, -50.0, -53.0, -283.0, -20.0, -55.0, 12.0, -25.0, 0.0, -9.0, 20.0, -10.0, -1.0, 0.0, 10.0, 0.0, -11.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, 0.0, -35.0, -45.0, -15.0, -6.0, -10.0, 0.0, 10.0, 0.0, 0.0, -185.0, -7.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -103.0, 0.0, 0.0, 0.0, -52.0, -125.0, -54.0, -160.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -65.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -45.0, -4.0, 0.0, 10.0, 0.0, -4.0, 20.0, -65.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -18.0, -10.0, -8.0, -5.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -170.0, 4.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -4.0, -138.0, -3.0, 0.0, 0.0, -4.0, -8.0, 0.0, 10.0, -4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -3.0, 10.0, -2.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -13.0, -2.0, -11.0, -5.0, 0.0, 0.0, 0.0, 16.0, -65.0, 0.0, 10.0, 16.0, -5.0, 0.0, -14.0, 0.0, 10.0, 9.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, -17.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, 5.0, 6.0, 3.0, 0.0, -3.0, -3.0, -3.0, 0.0, -16.0, 0.0, 0.0, 20.0, 10.0, -17.0, 0.0, -28.0, 0.0, 0.0, -90.0, -6.0, 0.0, -9.0, 0.0, -4.0, -4.0, -3.0, -7.0, -8.0, 0.0, 0.0, -11.0, 0.0, -17.0, 0.0, -1.0, -24.0, -2.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, -4.0, -20.0, 0.0, 0.0, 10.0, 0.0, -11.0, -16.0, 0.0, 0.0, -14.0, -1.0, -5.0, -3.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 10.0, -28.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -46.0, -2.0, 0.0, 10.0, -2.0, 20.0, 10.0, -34.0, 0.0, 10.0, -22.0, -22.0, 0.0, -50.0, 0.0, 20.0, 0.0, 30.0, 10.0, -1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.100964594924331, "mean_inference_ms": 1.6705166953651645, "mean_action_processing_ms": 0.6296040724599359, "mean_env_wait_ms": 1.7895476395703687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01773304409450955, "StateBufferConnector_ms": 0.011304131260624638, "ViewRequirementAgentConnector_ms": 0.633843739827474}, "num_episodes": 18, "episode_return_max": 53.0, "episode_return_min": -1597.0, "episode_return_mean": -263.85185185185185}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.80329868141415, "num_env_steps_trained_throughput_per_sec": 19.80329868141415, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 201937.015, "restore_workers_time_ms": 0.018, "training_step_time_ms": 201936.957, "sample_time_ms": 3266.725, "learn_time_ms": 198649.862, "learn_throughput": 20.136, "synch_weights_time_ms": 11.89}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "a22d3_00000", "date": "2024-08-05_22-53-32", "timestamp": 1722912812, "time_this_iter_s": 201.9996988773346, "time_total_s": 605.8439967632294, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a00bb040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 605.8439967632294, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.77657342657342, "ram_util_percent": 78.15244755244754}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7163268851903806, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.029061632999343, "policy_loss": -0.009347540771708199, "vf_loss": 2.0367619440578424, "vf_explained_var": 0.07939442061006832, "kl": 0.008236143648089384, "entropy": 1.5552805661266478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -1597.0, "episode_reward_mean": -200.52777777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -20.052777777777777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.0, -936.0, -746.0, -160.0, -1178.0, -155.0, -1049.0, -490.0, -619.0, -145.0, -1597.0, -1070.0, -690.0, -785.0, -421.0, -663.0, -117.0, -632.0, -120.0, -64.0, -66.0, -43.0, -423.0, -32.0, -85.0, 0.0, -286.0, -110.0, -361.0, -95.0, -33.0, -26.0, -130.0, 18.0, -147.0, 53.0, 15.0, 4.0, -33.0, 24.0, -7.0, -11.0, -105.0, -41.0, -74.0, 30.0, -41.0, 2.0, 10.0, -6.0, -10.0, -34.0, -24.0, 18.0, 17.0, 60.0, -15.0, -31.0, 10.0, -23.0, 20.0, -246.0, 17.0, -22.0, -19.0, -39.0, 40.0, 60.0, -39.0, 2.0, 29.0, -11.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-146.0, -162.0, 0.0, 0.0, 0.0, -205.0, 0.0, 20.0, -69.0, 0.0, -315.0, 0.0, 8.0, -55.0, 0.0, 0.0, -4.0, -485.0, -95.0, 10.0, -11.0, -325.0, -9.0, 0.0, -65.0, -1.0, -5.0, 0.0, -340.0, 10.0, 10.0, 0.0, -5.0, -5.0, 0.0, -150.0, -60.0, 0.0, 10.0, 40.0, -305.0, -5.0, 0.0, 0.0, -2.0, 0.0, -250.0, -155.0, -1.0, -460.0, 0.0, -115.0, -60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -458.0, 10.0, -460.0, -30.0, -20.0, 0.0, 10.0, 0.0, -111.0, 10.0, 0.0, 0.0, 40.0, -25.0, -120.0, 20.0, 10.0, -345.0, -70.0, 0.0, -90.0, 0.0, -152.0, 0.0, 0.0, -347.0, -40.0, 0.0, 10.0, 0.0, 0.0, -3.0, -1.0, -4.0, 0.0, 0.0, -75.0, 0.0, 8.0, -70.0, -475.0, 0.0, 0.0, -20.0, -182.0, -75.0, -495.0, -350.0, 0.0, 0.0, -120.0, 0.0, -185.0, -125.0, 0.0, -100.0, 10.0, 0.0, -550.0, 0.0, -95.0, -185.0, -5.0, 0.0, 0.0, -180.0, 0.0, 0.0, 0.0, -225.0, 30.0, 0.0, -230.0, -80.0, -275.0, -210.0, 0.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, -195.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 19.0, 0.0, -25.0, -2.0, 0.0, 0.0, -430.0, -245.0, 0.0, 20.0, -33.0, 0.0, -40.0, -13.0, -25.0, 9.0, -2.0, -11.0, -10.0, 8.0, 0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0, 10.0, -120.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -25.0, 10.0, 0.0, 10.0, 2.0, -11.0, 0.0, 0.0, -60.0, -17.0, -1.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, -1.0, -50.0, -53.0, -283.0, -20.0, -55.0, 12.0, -25.0, 0.0, -9.0, 20.0, -10.0, -1.0, 0.0, 10.0, 0.0, -11.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, 0.0, -35.0, -45.0, -15.0, -6.0, -10.0, 0.0, 10.0, 0.0, 0.0, -185.0, -7.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -103.0, 0.0, 0.0, 0.0, -52.0, -125.0, -54.0, -160.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -65.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -45.0, -4.0, 0.0, 10.0, 0.0, -4.0, 20.0, -65.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -18.0, -10.0, -8.0, -5.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -170.0, 4.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -4.0, -138.0, -3.0, 0.0, 0.0, -4.0, -8.0, 0.0, 10.0, -4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -3.0, 10.0, -2.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -13.0, -2.0, -11.0, -5.0, 0.0, 0.0, 0.0, 16.0, -65.0, 0.0, 10.0, 16.0, -5.0, 0.0, -14.0, 0.0, 10.0, 9.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, -17.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, 5.0, 6.0, 3.0, 0.0, -3.0, -3.0, -3.0, 0.0, -16.0, 0.0, 0.0, 20.0, 10.0, -17.0, 0.0, -28.0, 0.0, 0.0, -90.0, -6.0, 0.0, -9.0, 0.0, -4.0, -4.0, -3.0, -7.0, -8.0, 0.0, 0.0, -11.0, 0.0, -17.0, 0.0, -1.0, -24.0, -2.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, -4.0, -20.0, 0.0, 0.0, 10.0, 0.0, -11.0, -16.0, 0.0, 0.0, -14.0, -1.0, -5.0, -3.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 10.0, -28.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -46.0, -2.0, 0.0, 10.0, -2.0, 20.0, 10.0, -34.0, 0.0, 10.0, -22.0, -22.0, 0.0, -50.0, 0.0, 20.0, 0.0, 30.0, 10.0, -1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0, -13.0, -4.0, 0.0, 10.0, -1.0, 10.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, -17.0, 0.0, -5.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, -4.0, -7.0, -6.0, -5.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -72.0, -67.0, 0.0, 10.0, 0.0, 0.0, -75.0, 0.0, -42.0, 0.0, -1.0, 0.0, -11.0, -11.0, 6.0, 20.0, 4.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, -14.0, 0.0, 0.0, -8.0, 0.0, 10.0, -22.0, -29.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 10.0, 0.0, 0.0, -20.0, -7.0, -1.0, 0.0, -9.0, 0.0, -5.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.0510782155419585, "mean_inference_ms": 1.6583231480393517, "mean_action_processing_ms": 0.6225171818351654, "mean_env_wait_ms": 1.7759995104602673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017588999536302354, "StateBufferConnector_ms": 0.011704034275478788, "ViewRequirementAgentConnector_ms": 0.608172681596544}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -1597.0, "episode_return_mean": -200.52777777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.997688345024887, "num_env_steps_trained_throughput_per_sec": 18.997688345024887, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 204090.748, "restore_workers_time_ms": 0.017, "training_step_time_ms": 204090.692, "sample_time_ms": 3250.842, "learn_time_ms": 200820.181, "learn_throughput": 19.918, "synch_weights_time_ms": 11.492}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "a22d3_00000", "date": "2024-08-05_22-57-03", "timestamp": 1722913023, "time_this_iter_s": 210.56292581558228, "time_total_s": 816.4069225788116, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01ba160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 816.4069225788116, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.852348993288594, "ram_util_percent": 77.41342281879194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.709486574969226, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.416526183305076, "policy_loss": -0.010144821860623189, "vf_loss": 2.425041370136669, "vf_explained_var": 0.048863694113029585, "kl": 0.00814818003099233, "entropy": 1.5345172671972118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 85.0, "episode_reward_min": -1597.0, "episode_reward_mean": -139.6060606060606, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -13.960606060606061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.0, -936.0, -746.0, -160.0, -1178.0, -155.0, -1049.0, -490.0, -619.0, -145.0, -1597.0, -1070.0, -690.0, -785.0, -421.0, -663.0, -117.0, -632.0, -120.0, -64.0, -66.0, -43.0, -423.0, -32.0, -85.0, 0.0, -286.0, -110.0, -361.0, -95.0, -33.0, -26.0, -130.0, 18.0, -147.0, 53.0, 15.0, 4.0, -33.0, 24.0, -7.0, -11.0, -105.0, -41.0, -74.0, 30.0, -41.0, 2.0, 10.0, -6.0, -10.0, -34.0, -24.0, 18.0, 17.0, 60.0, -15.0, -31.0, 10.0, -23.0, 20.0, -246.0, 17.0, -22.0, -19.0, -39.0, 40.0, 60.0, -39.0, 2.0, 29.0, -11.0, 85.0, 70.0, 7.0, -12.0, 6.0, 33.0, 48.0, -7.0, -90.0, 46.0, 78.0, 20.0, 15.0, 16.0, 66.0, 59.0, 21.0, -2.0, 6.0, -48.0, 56.0, 36.0, 63.0, 59.0, -2.0, -30.0, 18.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-146.0, -162.0, 0.0, 0.0, 0.0, -205.0, 0.0, 20.0, -69.0, 0.0, -315.0, 0.0, 8.0, -55.0, 0.0, 0.0, -4.0, -485.0, -95.0, 10.0, -11.0, -325.0, -9.0, 0.0, -65.0, -1.0, -5.0, 0.0, -340.0, 10.0, 10.0, 0.0, -5.0, -5.0, 0.0, -150.0, -60.0, 0.0, 10.0, 40.0, -305.0, -5.0, 0.0, 0.0, -2.0, 0.0, -250.0, -155.0, -1.0, -460.0, 0.0, -115.0, -60.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -458.0, 10.0, -460.0, -30.0, -20.0, 0.0, 10.0, 0.0, -111.0, 10.0, 0.0, 0.0, 40.0, -25.0, -120.0, 20.0, 10.0, -345.0, -70.0, 0.0, -90.0, 0.0, -152.0, 0.0, 0.0, -347.0, -40.0, 0.0, 10.0, 0.0, 0.0, -3.0, -1.0, -4.0, 0.0, 0.0, -75.0, 0.0, 8.0, -70.0, -475.0, 0.0, 0.0, -20.0, -182.0, -75.0, -495.0, -350.0, 0.0, 0.0, -120.0, 0.0, -185.0, -125.0, 0.0, -100.0, 10.0, 0.0, -550.0, 0.0, -95.0, -185.0, -5.0, 0.0, 0.0, -180.0, 0.0, 0.0, 0.0, -225.0, 30.0, 0.0, -230.0, -80.0, -275.0, -210.0, 0.0, 0.0, 0.0, -20.0, 0.0, -1.0, 0.0, -195.0, 10.0, 0.0, 0.0, 0.0, -235.0, 0.0, 19.0, 0.0, -25.0, -2.0, 0.0, 0.0, -430.0, -245.0, 0.0, 20.0, -33.0, 0.0, -40.0, -13.0, -25.0, 9.0, -2.0, -11.0, -10.0, 8.0, 0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0, 10.0, -120.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -25.0, 10.0, 0.0, 10.0, 2.0, -11.0, 0.0, 0.0, -60.0, -17.0, -1.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, -1.0, -50.0, -53.0, -283.0, -20.0, -55.0, 12.0, -25.0, 0.0, -9.0, 20.0, -10.0, -1.0, 0.0, 10.0, 0.0, -11.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, 0.0, -35.0, -45.0, -15.0, -6.0, -10.0, 0.0, 10.0, 0.0, 0.0, -185.0, -7.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -103.0, 0.0, 0.0, 0.0, -52.0, -125.0, -54.0, -160.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -65.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -45.0, -4.0, 0.0, 10.0, 0.0, -4.0, 20.0, -65.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -18.0, -10.0, -8.0, -5.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -170.0, 4.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -4.0, -138.0, -3.0, 0.0, 0.0, -4.0, -8.0, 0.0, 10.0, -4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -3.0, 10.0, -2.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -13.0, -2.0, -11.0, -5.0, 0.0, 0.0, 0.0, 16.0, -65.0, 0.0, 10.0, 16.0, -5.0, 0.0, -14.0, 0.0, 10.0, 9.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, -17.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, 5.0, 6.0, 3.0, 0.0, -3.0, -3.0, -3.0, 0.0, -16.0, 0.0, 0.0, 20.0, 10.0, -17.0, 0.0, -28.0, 0.0, 0.0, -90.0, -6.0, 0.0, -9.0, 0.0, -4.0, -4.0, -3.0, -7.0, -8.0, 0.0, 0.0, -11.0, 0.0, -17.0, 0.0, -1.0, -24.0, -2.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, -4.0, -20.0, 0.0, 0.0, 10.0, 0.0, -11.0, -16.0, 0.0, 0.0, -14.0, -1.0, -5.0, -3.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 10.0, -28.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -46.0, -2.0, 0.0, 10.0, -2.0, 20.0, 10.0, -34.0, 0.0, 10.0, -22.0, -22.0, 0.0, -50.0, 0.0, 20.0, 0.0, 30.0, 10.0, -1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0, -13.0, -4.0, 0.0, 10.0, -1.0, 10.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, -17.0, 0.0, -5.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, -4.0, -7.0, -6.0, -5.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -72.0, -67.0, 0.0, 10.0, 0.0, 0.0, -75.0, 0.0, -42.0, 0.0, -1.0, 0.0, -11.0, -11.0, 6.0, 20.0, 4.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, -14.0, 0.0, 0.0, -8.0, 0.0, 10.0, -22.0, -29.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 10.0, 0.0, 0.0, -20.0, -7.0, -1.0, 0.0, -9.0, 0.0, -5.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0, 0.0, 20.0, 10.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 7.0, 0.0, 10.0, -8.0, -4.0, -4.0, 8.0, 0.0, 0.0, -4.0, 0.0, -7.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, 10.0, 0.0, 0.0, 0.0, -2.0, -1.0, 10.0, -5.0, 8.0, 10.0, 0.0, 0.0, 10.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -1.0, 9.0, -20.0, 4.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 6.0, -11.0, 0.0, 0.0, 10.0, -85.0, -6.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -2.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 4.0, 10.0, 20.0, 10.0, 10.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -14.0, 0.0, 0.0, 20.0, 0.0, 2.0, -4.0, 10.0, 0.0, 1.0, -17.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, -17.0, 10.0, 0.0, 0.0, 10.0, 23.0, 19.0, -2.0, 0.0, -4.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 9.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, -7.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 20.0, -10.0, 10.0, -7.0, -45.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, -15.0, -1.0, 0.0, 0.0, -8.0, 0.0, 20.0, 10.0, 0.0, -40.0, 0.0, -5.0, 0.0, 0.0, 10.0, -43.0, 14.0, 0.0, -8.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, -4.0, 20.0, 14.0, 30.0, 0.0, -6.0, -11.0, -7.0, 0.0, 0.0, 9.0, 10.0, 7.0, 0.0, 0.0, 10.0, 10.0, 7.0, 10.0, 0.0, 0.0, -2.0, -1.0, 28.0, -1.0, 10.0, 20.0, -15.0, 20.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 10.0, -20.0, 0.0, -7.0, -16.0, -7.0, 0.0, 10.0, -10.0, 20.0, 0.0, 10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9997308841326538, "mean_inference_ms": 1.6626984692534228, "mean_action_processing_ms": 0.6155287320166928, "mean_env_wait_ms": 1.7614682284200718, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0166815940779869, "StateBufferConnector_ms": 0.011384125911828243, "ViewRequirementAgentConnector_ms": 0.5704867719399809}, "num_episodes": 27, "episode_return_max": 85.0, "episode_return_min": -1597.0, "episode_return_mean": -139.6060606060606}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.93697577706299, "num_env_steps_trained_throughput_per_sec": 18.93697577706299, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 205517.994, "restore_workers_time_ms": 0.016, "training_step_time_ms": 205517.94, "sample_time_ms": 3203.767, "learn_time_ms": 202293.63, "learn_throughput": 19.773, "synch_weights_time_ms": 12.551}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "a22d3_00000", "date": "2024-08-05_23-00-34", "timestamp": 1722913234, "time_this_iter_s": 211.2398898601532, "time_total_s": 1027.6468124389648, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a00e0280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1027.6468124389648, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.55351170568562, "ram_util_percent": 78.27591973244147}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.818582773983034, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.690572813118355, "policy_loss": -0.010315027723078447, "vf_loss": 2.6990711061718367, "vf_explained_var": 0.09941226946660124, "kl": 0.009083671148803353, "entropy": 1.5053996822958429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 100.0, "episode_reward_min": -632.0, "episode_reward_mean": -21.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -2.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-632.0, -120.0, -64.0, -66.0, -43.0, -423.0, -32.0, -85.0, 0.0, -286.0, -110.0, -361.0, -95.0, -33.0, -26.0, -130.0, 18.0, -147.0, 53.0, 15.0, 4.0, -33.0, 24.0, -7.0, -11.0, -105.0, -41.0, -74.0, 30.0, -41.0, 2.0, 10.0, -6.0, -10.0, -34.0, -24.0, 18.0, 17.0, 60.0, -15.0, -31.0, 10.0, -23.0, 20.0, -246.0, 17.0, -22.0, -19.0, -39.0, 40.0, 60.0, -39.0, 2.0, 29.0, -11.0, 85.0, 70.0, 7.0, -12.0, 6.0, 33.0, 48.0, -7.0, -90.0, 46.0, 78.0, 20.0, 15.0, 16.0, 66.0, 59.0, 21.0, -2.0, 6.0, -48.0, 56.0, 36.0, 63.0, 59.0, -2.0, -30.0, 18.0, 19.0, -79.0, -73.0, 67.0, -84.0, 30.0, -37.0, 56.0, 40.0, 60.0, 23.0, 60.0, 100.0, 1.0, 6.0, 74.0, -5.0, 10.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -165.0, -150.0, 20.0, -2.0, -320.0, 0.0, 5.0, -20.0, 0.0, 10.0, -120.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -25.0, 10.0, 0.0, 10.0, 2.0, -11.0, 0.0, 0.0, -60.0, -17.0, -1.0, -18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -30.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 8.0, -1.0, -50.0, -53.0, -283.0, -20.0, -55.0, 12.0, -25.0, 0.0, -9.0, 20.0, -10.0, -1.0, 0.0, 10.0, 0.0, -11.0, 10.0, 0.0, -40.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -20.0, 10.0, 0.0, -35.0, -45.0, -15.0, -6.0, -10.0, 0.0, 10.0, 0.0, 0.0, -185.0, -7.0, 0.0, 0.0, 0.0, -20.0, 10.0, 10.0, -103.0, 0.0, 0.0, 0.0, -52.0, -125.0, -54.0, -160.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, -65.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, -45.0, -4.0, 0.0, 10.0, 0.0, -4.0, 20.0, -65.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -18.0, -10.0, -8.0, -5.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -170.0, 4.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, 0.0, -4.0, -138.0, -3.0, 0.0, 0.0, -4.0, -8.0, 0.0, 10.0, -4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -3.0, 10.0, -2.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -13.0, -2.0, -11.0, -5.0, 0.0, 0.0, 0.0, 16.0, -65.0, 0.0, 10.0, 16.0, -5.0, 0.0, -14.0, 0.0, 10.0, 9.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, -17.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, 5.0, 6.0, 3.0, 0.0, -3.0, -3.0, -3.0, 0.0, -16.0, 0.0, 0.0, 20.0, 10.0, -17.0, 0.0, -28.0, 0.0, 0.0, -90.0, -6.0, 0.0, -9.0, 0.0, -4.0, -4.0, -3.0, -7.0, -8.0, 0.0, 0.0, -11.0, 0.0, -17.0, 0.0, -1.0, -24.0, -2.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, -4.0, -20.0, 0.0, 0.0, 10.0, 0.0, -11.0, -16.0, 0.0, 0.0, -14.0, -1.0, -5.0, -3.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 10.0, -28.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -46.0, -2.0, 0.0, 10.0, -2.0, 20.0, 10.0, -34.0, 0.0, 10.0, -22.0, -22.0, 0.0, -50.0, 0.0, 20.0, 0.0, 30.0, 10.0, -1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0, -13.0, -4.0, 0.0, 10.0, -1.0, 10.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, -17.0, 0.0, -5.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, -4.0, -7.0, -6.0, -5.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -72.0, -67.0, 0.0, 10.0, 0.0, 0.0, -75.0, 0.0, -42.0, 0.0, -1.0, 0.0, -11.0, -11.0, 6.0, 20.0, 4.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, -14.0, 0.0, 0.0, -8.0, 0.0, 10.0, -22.0, -29.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 10.0, 0.0, 0.0, -20.0, -7.0, -1.0, 0.0, -9.0, 0.0, -5.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0, 0.0, 20.0, 10.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 7.0, 0.0, 10.0, -8.0, -4.0, -4.0, 8.0, 0.0, 0.0, -4.0, 0.0, -7.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, 10.0, 0.0, 0.0, 0.0, -2.0, -1.0, 10.0, -5.0, 8.0, 10.0, 0.0, 0.0, 10.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -1.0, 9.0, -20.0, 4.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 6.0, -11.0, 0.0, 0.0, 10.0, -85.0, -6.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -2.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 4.0, 10.0, 20.0, 10.0, 10.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -14.0, 0.0, 0.0, 20.0, 0.0, 2.0, -4.0, 10.0, 0.0, 1.0, -17.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, -17.0, 10.0, 0.0, 0.0, 10.0, 23.0, 19.0, -2.0, 0.0, -4.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 9.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, -7.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 20.0, -10.0, 10.0, -7.0, -45.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, -15.0, -1.0, 0.0, 0.0, -8.0, 0.0, 20.0, 10.0, 0.0, -40.0, 0.0, -5.0, 0.0, 0.0, 10.0, -43.0, 14.0, 0.0, -8.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, -4.0, 20.0, 14.0, 30.0, 0.0, -6.0, -11.0, -7.0, 0.0, 0.0, 9.0, 10.0, 7.0, 0.0, 0.0, 10.0, 10.0, 7.0, 10.0, 0.0, 0.0, -2.0, -1.0, 28.0, -1.0, 10.0, 20.0, -15.0, 20.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 10.0, -20.0, 0.0, -7.0, -16.0, -7.0, 0.0, 10.0, -10.0, 20.0, 0.0, 10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0, 0.0, 10.0, 0.0, -7.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, -12.0, -17.0, -3.0, -18.0, 0.0, -26.0, -7.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, -20.0, -2.0, -28.0, -3.0, 0.0, 20.0, -2.0, 10.0, 20.0, 0.0, -6.0, 0.0, 0.0, 29.0, -4.0, 28.0, -1.0, -44.0, 10.0, -46.0, 10.0, -15.0, 10.0, -36.0, 0.0, -18.0, 10.0, -11.0, -1.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -5.0, -25.0, 0.0, 25.0, 0.0, 30.0, 0.0, 0.0, -7.0, 5.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 20.0, 5.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 8.0, -3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -6.0, -4.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 8.0, 0.0, 5.0, -1.0, 0.0, 0.0, -4.0, -4.0, 0.0, -3.0, -5.0, 0.0, 5.0, 2.0, 20.0, -2.0, 0.0, -8.0, -1.0, -5.0, 30.0, -3.0, -8.0, 8.0, 11.0, 30.0, -6.0, 10.0, -5.0, 7.0, 10.0, 10.0, 20.0, -1.0, -20.0, -4.0, -15.0, -5.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9255143396793772, "mean_inference_ms": 1.661937068524806, "mean_action_processing_ms": 0.604407543233283, "mean_env_wait_ms": 1.7382311139437605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014979124069213867, "StateBufferConnector_ms": 0.011133909225463867, "ViewRequirementAgentConnector_ms": 0.5112133026123047}, "num_episodes": 18, "episode_return_max": 100.0, "episode_return_min": -632.0, "episode_return_mean": -21.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.04048540348931, "num_env_steps_trained_throughput_per_sec": 19.04048540348931, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 206278.11, "restore_workers_time_ms": 0.016, "training_step_time_ms": 206278.055, "sample_time_ms": 3239.687, "learn_time_ms": 203018.005, "learn_throughput": 19.703, "synch_weights_time_ms": 12.453}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "a22d3_00000", "date": "2024-08-05_23-04-04", "timestamp": 1722913444, "time_this_iter_s": 210.09029507637024, "time_total_s": 1237.737107515335, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b8b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1237.737107515335, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 34.0912457912458, "ram_util_percent": 77.70740740740742}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7499468034194807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1536357984502223, "policy_loss": -0.010857904873712979, "vf_loss": 3.1629040356388236, "vf_explained_var": 0.02281284275146338, "kl": 0.007948325398375656, "entropy": 1.4782150522715494, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 180.0, "episode_reward_min": -246.0, "episode_reward_mean": 16.33, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 50.0}, "policy_reward_mean": {"policy_0": 1.633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [53.0, 15.0, 4.0, -33.0, 24.0, -7.0, -11.0, -105.0, -41.0, -74.0, 30.0, -41.0, 2.0, 10.0, -6.0, -10.0, -34.0, -24.0, 18.0, 17.0, 60.0, -15.0, -31.0, 10.0, -23.0, 20.0, -246.0, 17.0, -22.0, -19.0, -39.0, 40.0, 60.0, -39.0, 2.0, 29.0, -11.0, 85.0, 70.0, 7.0, -12.0, 6.0, 33.0, 48.0, -7.0, -90.0, 46.0, 78.0, 20.0, 15.0, 16.0, 66.0, 59.0, 21.0, -2.0, 6.0, -48.0, 56.0, 36.0, 63.0, 59.0, -2.0, -30.0, 18.0, 19.0, -79.0, -73.0, 67.0, -84.0, 30.0, -37.0, 56.0, 40.0, 60.0, 23.0, 60.0, 100.0, 1.0, 6.0, 74.0, -5.0, 10.0, 72.0, 59.0, 70.0, 93.0, 69.0, 77.0, 180.0, 80.0, 38.0, 42.0, 57.0, 7.0, 140.0, 40.0, 39.0, 50.0, 15.0, 40.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-4.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, -3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -3.0, 10.0, -2.0, -10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -13.0, -2.0, -11.0, -5.0, 0.0, 0.0, 0.0, 16.0, -65.0, 0.0, 10.0, 16.0, -5.0, 0.0, -14.0, 0.0, 10.0, 9.0, 9.0, 0.0, 0.0, 10.0, 0.0, 0.0, -17.0, 0.0, 0.0, 10.0, 10.0, -20.0, 0.0, 0.0, 10.0, 0.0, 5.0, 6.0, 3.0, 0.0, -3.0, -3.0, -3.0, 0.0, -16.0, 0.0, 0.0, 20.0, 10.0, -17.0, 0.0, -28.0, 0.0, 0.0, -90.0, -6.0, 0.0, -9.0, 0.0, -4.0, -4.0, -3.0, -7.0, -8.0, 0.0, 0.0, -11.0, 0.0, -17.0, 0.0, -1.0, -24.0, -2.0, 0.0, -19.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, -4.0, -20.0, 0.0, 0.0, 10.0, 0.0, -11.0, -16.0, 0.0, 0.0, -14.0, -1.0, -5.0, -3.0, 0.0, 0.0, 40.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, -6.0, -4.0, 0.0, 0.0, 0.0, 0.0, -3.0, 0.0, -3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -12.0, 0.0, 10.0, -28.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, -46.0, -2.0, 0.0, 10.0, -2.0, 20.0, 10.0, -34.0, 0.0, 10.0, -22.0, -22.0, 0.0, -50.0, 0.0, 20.0, 0.0, 30.0, 10.0, -1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0, -13.0, -4.0, 0.0, 10.0, -1.0, 10.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, -17.0, 0.0, -5.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, -4.0, -7.0, -6.0, -5.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -72.0, -67.0, 0.0, 10.0, 0.0, 0.0, -75.0, 0.0, -42.0, 0.0, -1.0, 0.0, -11.0, -11.0, 6.0, 20.0, 4.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, -14.0, 0.0, 0.0, -8.0, 0.0, 10.0, -22.0, -29.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 10.0, 0.0, 0.0, -20.0, -7.0, -1.0, 0.0, -9.0, 0.0, -5.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0, 0.0, 20.0, 10.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 7.0, 0.0, 10.0, -8.0, -4.0, -4.0, 8.0, 0.0, 0.0, -4.0, 0.0, -7.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, 10.0, 0.0, 0.0, 0.0, -2.0, -1.0, 10.0, -5.0, 8.0, 10.0, 0.0, 0.0, 10.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -1.0, 9.0, -20.0, 4.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 6.0, -11.0, 0.0, 0.0, 10.0, -85.0, -6.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -2.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 4.0, 10.0, 20.0, 10.0, 10.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -14.0, 0.0, 0.0, 20.0, 0.0, 2.0, -4.0, 10.0, 0.0, 1.0, -17.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, -17.0, 10.0, 0.0, 0.0, 10.0, 23.0, 19.0, -2.0, 0.0, -4.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 9.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, -7.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 20.0, -10.0, 10.0, -7.0, -45.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, -15.0, -1.0, 0.0, 0.0, -8.0, 0.0, 20.0, 10.0, 0.0, -40.0, 0.0, -5.0, 0.0, 0.0, 10.0, -43.0, 14.0, 0.0, -8.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, -4.0, 20.0, 14.0, 30.0, 0.0, -6.0, -11.0, -7.0, 0.0, 0.0, 9.0, 10.0, 7.0, 0.0, 0.0, 10.0, 10.0, 7.0, 10.0, 0.0, 0.0, -2.0, -1.0, 28.0, -1.0, 10.0, 20.0, -15.0, 20.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 10.0, -20.0, 0.0, -7.0, -16.0, -7.0, 0.0, 10.0, -10.0, 20.0, 0.0, 10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0, 0.0, 10.0, 0.0, -7.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, -12.0, -17.0, -3.0, -18.0, 0.0, -26.0, -7.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, -20.0, -2.0, -28.0, -3.0, 0.0, 20.0, -2.0, 10.0, 20.0, 0.0, -6.0, 0.0, 0.0, 29.0, -4.0, 28.0, -1.0, -44.0, 10.0, -46.0, 10.0, -15.0, 10.0, -36.0, 0.0, -18.0, 10.0, -11.0, -1.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -5.0, -25.0, 0.0, 25.0, 0.0, 30.0, 0.0, 0.0, -7.0, 5.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 20.0, 5.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 8.0, -3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -6.0, -4.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 8.0, 0.0, 5.0, -1.0, 0.0, 0.0, -4.0, -4.0, 0.0, -3.0, -5.0, 0.0, 5.0, 2.0, 20.0, -2.0, 0.0, -8.0, -1.0, -5.0, 30.0, -3.0, -8.0, 8.0, 11.0, 30.0, -6.0, 10.0, -5.0, 7.0, 10.0, 10.0, 20.0, -1.0, -20.0, -4.0, -15.0, -5.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0, 16.0, 10.0, 24.0, 0.0, -9.0, -3.0, 14.0, 0.0, 20.0, 0.0, 4.0, 50.0, -15.0, 20.0, -2.0, -1.0, -1.0, 5.0, 24.0, -25.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 10.0, -3.0, 30.0, 20.0, 7.0, 10.0, 10.0, 0.0, -1.0, 30.0, 20.0, 18.0, -1.0, 0.0, -6.0, 0.0, -10.0, 50.0, -9.0, 0.0, 0.0, 40.0, 0.0, 4.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 0.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 7.0, 10.0, -2.0, 10.0, 0.0, -4.0, 20.0, -3.0, 0.0, 10.0, -37.0, 0.0, 20.0, 0.0, 10.0, -1.0, 10.0, 10.0, 20.0, 0.0, 0.0, -1.0, 10.0, 10.0, 18.0, -30.0, 30.0, 10.0, 10.0, 40.0, 4.0, 23.0, -32.0, -5.0, -10.0, 0.0, -22.0, -3.0, 12.0, -5.0, 20.0, 10.0, 0.0, 50.0, 0.0, 5.0, 0.0, 20.0, 40.0, -12.0, 0.0, 10.0, 0.0, 0.0, -11.0, 10.0, 0.0, 3.0, 40.0, 2.0, -2.0, 0.0, 0.0, 10.0, 10.0, -2.0, 10.0, -9.0, 20.0, -16.0, 0.0, 17.0, 10.0, 0.0, 0.0, 0.0, 5.0, -16.0, 50.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8893002729250903, "mean_inference_ms": 1.6817776358437593, "mean_action_processing_ms": 0.5989726846180153, "mean_env_wait_ms": 1.725377455361651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01500248908996582, "StateBufferConnector_ms": 0.011057376861572266, "ViewRequirementAgentConnector_ms": 0.5266826152801514}, "num_episodes": 18, "episode_return_max": 180.0, "episode_return_min": -246.0, "episode_return_mean": 16.33}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.07970163833982, "num_env_steps_trained_throughput_per_sec": 19.07970163833982, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 206759.365, "restore_workers_time_ms": 0.015, "training_step_time_ms": 206759.311, "sample_time_ms": 3208.428, "learn_time_ms": 203530.708, "learn_throughput": 19.653, "synch_weights_time_ms": 12.414}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "a22d3_00000", "date": "2024-08-05_23-07-34", "timestamp": 1722913654, "time_this_iter_s": 209.6568660736084, "time_total_s": 1447.3939735889435, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01340d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1447.3939735889435, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.08451178451178, "ram_util_percent": 77.06262626262625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.810860644196804, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.419649778311245, "policy_loss": -0.011832621882764347, "vf_loss": 3.4296764319189315, "vf_explained_var": 0.03921794265476913, "kl": 0.009029834861687349, "entropy": 1.4543268846373716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 180.0, "episode_reward_min": -246.0, "episode_reward_mean": 30.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 3.004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 17.0, 60.0, -15.0, -31.0, 10.0, -23.0, 20.0, -246.0, 17.0, -22.0, -19.0, -39.0, 40.0, 60.0, -39.0, 2.0, 29.0, -11.0, 85.0, 70.0, 7.0, -12.0, 6.0, 33.0, 48.0, -7.0, -90.0, 46.0, 78.0, 20.0, 15.0, 16.0, 66.0, 59.0, 21.0, -2.0, 6.0, -48.0, 56.0, 36.0, 63.0, 59.0, -2.0, -30.0, 18.0, 19.0, -79.0, -73.0, 67.0, -84.0, 30.0, -37.0, 56.0, 40.0, 60.0, 23.0, 60.0, 100.0, 1.0, 6.0, 74.0, -5.0, 10.0, 72.0, 59.0, 70.0, 93.0, 69.0, 77.0, 180.0, 80.0, 38.0, 42.0, 57.0, 7.0, 140.0, 40.0, 39.0, 50.0, 15.0, 40.0, 8.0, 167.0, 63.0, 145.0, 60.0, 11.0, 52.0, 180.0, 150.0, -8.0, -6.0, 12.0, 11.0, 146.0, 0.0, 82.0, 61.0, -11.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, 20.0, -9.0, -7.0, -2.0, 0.0, 19.0, 0.0, 0.0, -2.0, -13.0, -4.0, 0.0, 10.0, -1.0, 10.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 7.0, 0.0, 10.0, -17.0, 0.0, -5.0, 0.0, 0.0, -19.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 0.0, -4.0, -7.0, -6.0, -5.0, -6.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -72.0, -67.0, 0.0, 10.0, 0.0, 0.0, -75.0, 0.0, -42.0, 0.0, -1.0, 0.0, -11.0, -11.0, 6.0, 20.0, 4.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, -8.0, 0.0, -24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, -14.0, 0.0, 0.0, -8.0, 0.0, 10.0, -22.0, -29.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 10.0, 0.0, 0.0, -20.0, -7.0, -1.0, 0.0, -9.0, 0.0, -5.0, 0.0, 10.0, 0.0, -4.0, 0.0, 0.0, 10.0, -1.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0, 0.0, 20.0, 10.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 7.0, 0.0, 10.0, -8.0, -4.0, -4.0, 8.0, 0.0, 0.0, -4.0, 0.0, -7.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, 10.0, 0.0, 0.0, 0.0, -2.0, -1.0, 10.0, -5.0, 8.0, 10.0, 0.0, 0.0, 10.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -1.0, 9.0, -20.0, 4.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 6.0, -11.0, 0.0, 0.0, 10.0, -85.0, -6.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -2.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 4.0, 10.0, 20.0, 10.0, 10.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -14.0, 0.0, 0.0, 20.0, 0.0, 2.0, -4.0, 10.0, 0.0, 1.0, -17.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, -17.0, 10.0, 0.0, 0.0, 10.0, 23.0, 19.0, -2.0, 0.0, -4.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 9.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, -7.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 20.0, -10.0, 10.0, -7.0, -45.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, -15.0, -1.0, 0.0, 0.0, -8.0, 0.0, 20.0, 10.0, 0.0, -40.0, 0.0, -5.0, 0.0, 0.0, 10.0, -43.0, 14.0, 0.0, -8.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, -4.0, 20.0, 14.0, 30.0, 0.0, -6.0, -11.0, -7.0, 0.0, 0.0, 9.0, 10.0, 7.0, 0.0, 0.0, 10.0, 10.0, 7.0, 10.0, 0.0, 0.0, -2.0, -1.0, 28.0, -1.0, 10.0, 20.0, -15.0, 20.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 10.0, -20.0, 0.0, -7.0, -16.0, -7.0, 0.0, 10.0, -10.0, 20.0, 0.0, 10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0, 0.0, 10.0, 0.0, -7.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, -12.0, -17.0, -3.0, -18.0, 0.0, -26.0, -7.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, -20.0, -2.0, -28.0, -3.0, 0.0, 20.0, -2.0, 10.0, 20.0, 0.0, -6.0, 0.0, 0.0, 29.0, -4.0, 28.0, -1.0, -44.0, 10.0, -46.0, 10.0, -15.0, 10.0, -36.0, 0.0, -18.0, 10.0, -11.0, -1.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -5.0, -25.0, 0.0, 25.0, 0.0, 30.0, 0.0, 0.0, -7.0, 5.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 20.0, 5.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 8.0, -3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -6.0, -4.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 8.0, 0.0, 5.0, -1.0, 0.0, 0.0, -4.0, -4.0, 0.0, -3.0, -5.0, 0.0, 5.0, 2.0, 20.0, -2.0, 0.0, -8.0, -1.0, -5.0, 30.0, -3.0, -8.0, 8.0, 11.0, 30.0, -6.0, 10.0, -5.0, 7.0, 10.0, 10.0, 20.0, -1.0, -20.0, -4.0, -15.0, -5.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0, 16.0, 10.0, 24.0, 0.0, -9.0, -3.0, 14.0, 0.0, 20.0, 0.0, 4.0, 50.0, -15.0, 20.0, -2.0, -1.0, -1.0, 5.0, 24.0, -25.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 10.0, -3.0, 30.0, 20.0, 7.0, 10.0, 10.0, 0.0, -1.0, 30.0, 20.0, 18.0, -1.0, 0.0, -6.0, 0.0, -10.0, 50.0, -9.0, 0.0, 0.0, 40.0, 0.0, 4.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 0.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 7.0, 10.0, -2.0, 10.0, 0.0, -4.0, 20.0, -3.0, 0.0, 10.0, -37.0, 0.0, 20.0, 0.0, 10.0, -1.0, 10.0, 10.0, 20.0, 0.0, 0.0, -1.0, 10.0, 10.0, 18.0, -30.0, 30.0, 10.0, 10.0, 40.0, 4.0, 23.0, -32.0, -5.0, -10.0, 0.0, -22.0, -3.0, 12.0, -5.0, 20.0, 10.0, 0.0, 50.0, 0.0, 5.0, 0.0, 20.0, 40.0, -12.0, 0.0, 10.0, 0.0, 0.0, -11.0, 10.0, 0.0, 3.0, 40.0, 2.0, -2.0, 0.0, 0.0, 10.0, 10.0, -2.0, 10.0, -9.0, 20.0, -16.0, 0.0, 17.0, 10.0, 0.0, 0.0, 0.0, 5.0, -16.0, 50.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0, 18.0, 0.0, 10.0, 0.0, 0.0, -5.0, -44.0, 29.0, 0.0, 0.0, 12.0, 0.0, 30.0, 30.0, 0.0, 10.0, 7.0, 8.0, 0.0, 70.0, 19.0, -20.0, 21.0, 9.0, 2.0, 10.0, 0.0, 9.0, 20.0, -7.0, -5.0, 50.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 3.0, 20.0, 10.0, 10.0, 20.0, -25.0, 22.0, 0.0, 0.0, 0.0, -13.0, 0.0, 10.0, -26.0, -11.0, 10.0, 30.0, 0.0, -19.0, 30.0, 20.0, -8.0, 8.0, 0.0, 0.0, 0.0, 0.0, -1.0, 13.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 30.0, 30.0, 20.0, 17.0, 0.0, 0.0, -5.0, 20.0, 60.0, 0.0, 8.0, -13.0, 20.0, -23.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -6.0, 10.0, 8.0, 9.0, -3.0, -60.0, 20.0, -4.0, 8.0, 12.0, 10.0, -11.0, -5.0, -10.0, -4.0, -18.0, 20.0, 20.0, -10.0, 20.0, -10.0, 10.0, -2.0, -4.0, 7.0, -4.0, 30.0, 0.0, -14.0, -2.0, 25.0, 50.0, 0.0, 15.0, 0.0, 20.0, -4.0, 30.0, 0.0, 10.0, -8.0, -6.0, 0.0, -3.0, 10.0, 5.0, -9.0, -1.0, 12.0, 0.0, 7.0, 10.0, 10.0, 10.0, 10.0, 20.0, 5.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, -1.0, 10.0, 0.0, -48.0, 10.0, 20.0, -7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.870203507677712, "mean_inference_ms": 1.7200694840636164, "mean_action_processing_ms": 0.5987431904678213, "mean_env_wait_ms": 1.7244582836337008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015371322631835938, "StateBufferConnector_ms": 0.011394739151000977, "ViewRequirementAgentConnector_ms": 0.5512673854827881}, "num_episodes": 18, "episode_return_max": 180.0, "episode_return_min": -246.0, "episode_return_mean": 30.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.124033100759384, "num_env_steps_trained_throughput_per_sec": 19.124033100759384, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 207059.558, "restore_workers_time_ms": 0.015, "training_step_time_ms": 207059.505, "sample_time_ms": 3288.413, "learn_time_ms": 203751.343, "learn_throughput": 19.632, "synch_weights_time_ms": 11.971}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "a22d3_00000", "date": "2024-08-05_23-11-03", "timestamp": 1722913863, "time_this_iter_s": 209.1745879650116, "time_total_s": 1656.568561553955, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01ba1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1656.568561553955, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 34.50135135135135, "ram_util_percent": 77.60033783783784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1327635928210866, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1788510464758666, "policy_loss": -0.012064679333378776, "vf_loss": 3.1892492138285733, "vf_explained_var": 0.04372070966818081, "kl": 0.008332582395171578, "entropy": 1.4534122893477655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 207.0, "episode_reward_min": -90.0, "episode_reward_mean": 47.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 4.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 85.0, 70.0, 7.0, -12.0, 6.0, 33.0, 48.0, -7.0, -90.0, 46.0, 78.0, 20.0, 15.0, 16.0, 66.0, 59.0, 21.0, -2.0, 6.0, -48.0, 56.0, 36.0, 63.0, 59.0, -2.0, -30.0, 18.0, 19.0, -79.0, -73.0, 67.0, -84.0, 30.0, -37.0, 56.0, 40.0, 60.0, 23.0, 60.0, 100.0, 1.0, 6.0, 74.0, -5.0, 10.0, 72.0, 59.0, 70.0, 93.0, 69.0, 77.0, 180.0, 80.0, 38.0, 42.0, 57.0, 7.0, 140.0, 40.0, 39.0, 50.0, 15.0, 40.0, 8.0, 167.0, 63.0, 145.0, 60.0, 11.0, 52.0, 180.0, 150.0, -8.0, -6.0, 12.0, 11.0, 146.0, 0.0, 82.0, 61.0, -11.0, 52.0, 207.0, 25.0, 140.0, 43.0, 73.0, 94.0, 119.0, 179.0, 75.0, 70.0, 138.0, 58.0, 28.0, 25.0, 159.0, 65.0, 60.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-20.0, -5.0, 0.0, 5.0, 20.0, 0.0, 0.0, 10.0, 0.0, -21.0, 0.0, 20.0, 10.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -2.0, 7.0, 0.0, 10.0, -8.0, -4.0, -4.0, 8.0, 0.0, 0.0, -4.0, 0.0, -7.0, 10.0, 0.0, 10.0, -16.0, -5.0, 0.0, 0.0, -2.0, 0.0, 0.0, 0.0, 0.0, -2.0, 10.0, 0.0, 0.0, 0.0, -2.0, -1.0, 10.0, -5.0, 8.0, 10.0, 0.0, 0.0, 10.0, 3.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, -1.0, 9.0, -20.0, 4.0, 0.0, 4.0, 0.0, 0.0, 10.0, 0.0, 6.0, -11.0, 0.0, 0.0, 10.0, -85.0, -6.0, 0.0, 0.0, 0.0, 0.0, -9.0, 0.0, -2.0, 8.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 4.0, 10.0, 20.0, 10.0, 10.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -14.0, 0.0, 0.0, 20.0, 0.0, 2.0, -4.0, 10.0, 0.0, 1.0, -17.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, -17.0, 10.0, 0.0, 0.0, 10.0, 23.0, 19.0, -2.0, 0.0, -4.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 9.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 9.0, 0.0, -7.0, 0.0, 0.0, 10.0, 0.0, 9.0, 10.0, 20.0, -10.0, 10.0, -7.0, -45.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, -15.0, -1.0, 0.0, 0.0, -8.0, 0.0, 20.0, 10.0, 0.0, -40.0, 0.0, -5.0, 0.0, 0.0, 10.0, -43.0, 14.0, 0.0, -8.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, -4.0, 20.0, 14.0, 30.0, 0.0, -6.0, -11.0, -7.0, 0.0, 0.0, 9.0, 10.0, 7.0, 0.0, 0.0, 10.0, 10.0, 7.0, 10.0, 0.0, 0.0, -2.0, -1.0, 28.0, -1.0, 10.0, 20.0, -15.0, 20.0, 0.0, 0.0, -6.0, 0.0, 0.0, 0.0, 0.0, -6.0, 0.0, 0.0, 10.0, -20.0, 0.0, -7.0, -16.0, -7.0, 0.0, 10.0, -10.0, 20.0, 0.0, 10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0, 0.0, 10.0, 0.0, -7.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, -12.0, -17.0, -3.0, -18.0, 0.0, -26.0, -7.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, -20.0, -2.0, -28.0, -3.0, 0.0, 20.0, -2.0, 10.0, 20.0, 0.0, -6.0, 0.0, 0.0, 29.0, -4.0, 28.0, -1.0, -44.0, 10.0, -46.0, 10.0, -15.0, 10.0, -36.0, 0.0, -18.0, 10.0, -11.0, -1.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -5.0, -25.0, 0.0, 25.0, 0.0, 30.0, 0.0, 0.0, -7.0, 5.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 20.0, 5.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 8.0, -3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -6.0, -4.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 8.0, 0.0, 5.0, -1.0, 0.0, 0.0, -4.0, -4.0, 0.0, -3.0, -5.0, 0.0, 5.0, 2.0, 20.0, -2.0, 0.0, -8.0, -1.0, -5.0, 30.0, -3.0, -8.0, 8.0, 11.0, 30.0, -6.0, 10.0, -5.0, 7.0, 10.0, 10.0, 20.0, -1.0, -20.0, -4.0, -15.0, -5.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0, 16.0, 10.0, 24.0, 0.0, -9.0, -3.0, 14.0, 0.0, 20.0, 0.0, 4.0, 50.0, -15.0, 20.0, -2.0, -1.0, -1.0, 5.0, 24.0, -25.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 10.0, -3.0, 30.0, 20.0, 7.0, 10.0, 10.0, 0.0, -1.0, 30.0, 20.0, 18.0, -1.0, 0.0, -6.0, 0.0, -10.0, 50.0, -9.0, 0.0, 0.0, 40.0, 0.0, 4.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 0.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 7.0, 10.0, -2.0, 10.0, 0.0, -4.0, 20.0, -3.0, 0.0, 10.0, -37.0, 0.0, 20.0, 0.0, 10.0, -1.0, 10.0, 10.0, 20.0, 0.0, 0.0, -1.0, 10.0, 10.0, 18.0, -30.0, 30.0, 10.0, 10.0, 40.0, 4.0, 23.0, -32.0, -5.0, -10.0, 0.0, -22.0, -3.0, 12.0, -5.0, 20.0, 10.0, 0.0, 50.0, 0.0, 5.0, 0.0, 20.0, 40.0, -12.0, 0.0, 10.0, 0.0, 0.0, -11.0, 10.0, 0.0, 3.0, 40.0, 2.0, -2.0, 0.0, 0.0, 10.0, 10.0, -2.0, 10.0, -9.0, 20.0, -16.0, 0.0, 17.0, 10.0, 0.0, 0.0, 0.0, 5.0, -16.0, 50.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0, 18.0, 0.0, 10.0, 0.0, 0.0, -5.0, -44.0, 29.0, 0.0, 0.0, 12.0, 0.0, 30.0, 30.0, 0.0, 10.0, 7.0, 8.0, 0.0, 70.0, 19.0, -20.0, 21.0, 9.0, 2.0, 10.0, 0.0, 9.0, 20.0, -7.0, -5.0, 50.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 3.0, 20.0, 10.0, 10.0, 20.0, -25.0, 22.0, 0.0, 0.0, 0.0, -13.0, 0.0, 10.0, -26.0, -11.0, 10.0, 30.0, 0.0, -19.0, 30.0, 20.0, -8.0, 8.0, 0.0, 0.0, 0.0, 0.0, -1.0, 13.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 30.0, 30.0, 20.0, 17.0, 0.0, 0.0, -5.0, 20.0, 60.0, 0.0, 8.0, -13.0, 20.0, -23.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -6.0, 10.0, 8.0, 9.0, -3.0, -60.0, 20.0, -4.0, 8.0, 12.0, 10.0, -11.0, -5.0, -10.0, -4.0, -18.0, 20.0, 20.0, -10.0, 20.0, -10.0, 10.0, -2.0, -4.0, 7.0, -4.0, 30.0, 0.0, -14.0, -2.0, 25.0, 50.0, 0.0, 15.0, 0.0, 20.0, -4.0, 30.0, 0.0, 10.0, -8.0, -6.0, 0.0, -3.0, 10.0, 5.0, -9.0, -1.0, 12.0, 0.0, 7.0, 10.0, 10.0, 10.0, 10.0, 20.0, 5.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, -1.0, 10.0, 0.0, -48.0, 10.0, 20.0, -7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, -3.0, 17.0, 10.0, 9.0, -2.0, 0.0, 20.0, 10.0, 39.0, 10.0, 30.0, 20.0, 40.0, 40.0, 8.0, -13.0, 20.0, 8.0, -29.0, -25.0, -1.0, 7.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 30.0, 20.0, -8.0, -5.0, 20.0, 0.0, 0.0, 10.0, -24.0, 0.0, 17.0, 0.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, -4.0, 0.0, 20.0, 0.0, 10.0, -1.0, 20.0, 20.0, 10.0, 0.0, 20.0, -5.0, 10.0, 9.0, 10.0, 10.0, 40.0, 0.0, 0.0, 0.0, 20.0, 20.0, 27.0, -4.0, 30.0, -25.0, 20.0, 36.0, 5.0, 60.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, -22.0, 20.0, 0.0, 0.0, -2.0, 7.0, 40.0, 0.0, 7.0, -1.0, 10.0, 9.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 0.0, -4.0, 10.0, -18.0, 20.0, 10.0, 10.0, 30.0, -11.0, 10.0, 10.0, 0.0, 0.0, -2.0, -8.0, -1.0, 0.0, 0.0, 0.0, -63.0, 20.0, 8.0, 20.0, 30.0, 30.0, -30.0, 10.0, 20.0, 0.0, 30.0, 13.0, 6.0, 0.0, 10.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8733259123522163, "mean_inference_ms": 1.7710185820567659, "mean_action_processing_ms": 0.6012064689792896, "mean_env_wait_ms": 1.729083227684622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015088319778442383, "StateBufferConnector_ms": 0.011101007461547852, "ViewRequirementAgentConnector_ms": 0.5670740604400635}, "num_episodes": 18, "episode_return_max": 207.0, "episode_return_min": -90.0, "episode_return_mean": 47.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.15647635914412, "num_env_steps_trained_throughput_per_sec": 19.15647635914412, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 207253.683, "restore_workers_time_ms": 0.015, "training_step_time_ms": 207253.63, "sample_time_ms": 3319.382, "learn_time_ms": 203914.556, "learn_throughput": 19.616, "synch_weights_time_ms": 11.912}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "a22d3_00000", "date": "2024-08-05_23-14-32", "timestamp": 1722914072, "time_this_iter_s": 208.8175609111786, "time_total_s": 1865.3861224651337, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1865.3861224651337, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.33457627118644, "ram_util_percent": 77.73389830508475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9802101125732396, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.594813133758732, "policy_loss": -0.011290535081403093, "vf_loss": 3.604313566687262, "vf_explained_var": 0.026530130875631136, "kl": 0.008950519576440902, "entropy": 1.4203928575602076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 213.0, "episode_reward_min": -104.0, "episode_reward_mean": 71.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -138.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 7.146}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18.0, 19.0, -79.0, -73.0, 67.0, -84.0, 30.0, -37.0, 56.0, 40.0, 60.0, 23.0, 60.0, 100.0, 1.0, 6.0, 74.0, -5.0, 10.0, 72.0, 59.0, 70.0, 93.0, 69.0, 77.0, 180.0, 80.0, 38.0, 42.0, 57.0, 7.0, 140.0, 40.0, 39.0, 50.0, 15.0, 40.0, 8.0, 167.0, 63.0, 145.0, 60.0, 11.0, 52.0, 180.0, 150.0, -8.0, -6.0, 12.0, 11.0, 146.0, 0.0, 82.0, 61.0, -11.0, 52.0, 207.0, 25.0, 140.0, 43.0, 73.0, 94.0, 119.0, 179.0, 75.0, 70.0, 138.0, 58.0, 28.0, 25.0, 159.0, 65.0, 60.0, 16.0, 91.0, 148.0, 160.0, 100.0, 213.0, 160.0, 144.0, 174.0, -104.0, 160.0, 109.0, 200.0, 127.0, 77.0, 103.0, -5.0, 9.0, 110.0, 64.0, 127.0, 101.0, 112.0, 186.0, 128.0, 82.0, 167.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, -1.0, 0.0, 0.0, 0.0, -5.0, -5.0, 10.0, -1.0, 0.0, 10.0, 0.0, -7.0, 10.0, -4.0, 10.0, 0.0, 0.0, 0.0, 0.0, -6.0, -12.0, -17.0, -3.0, -18.0, 0.0, -26.0, -7.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, -20.0, -2.0, -28.0, -3.0, 0.0, 20.0, -2.0, 10.0, 20.0, 0.0, -6.0, 0.0, 0.0, 29.0, -4.0, 28.0, -1.0, -44.0, 10.0, -46.0, 10.0, -15.0, 10.0, -36.0, 0.0, -18.0, 10.0, -11.0, -1.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -7.0, 0.0, -5.0, -25.0, 0.0, 25.0, 0.0, 30.0, 0.0, 0.0, -7.0, 5.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 0.0, -15.0, 0.0, 0.0, 20.0, 5.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 8.0, 0.0, 10.0, 8.0, -3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -6.0, -4.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 8.0, 0.0, 5.0, -1.0, 0.0, 0.0, -4.0, -4.0, 0.0, -3.0, -5.0, 0.0, 5.0, 2.0, 20.0, -2.0, 0.0, -8.0, -1.0, -5.0, 30.0, -3.0, -8.0, 8.0, 11.0, 30.0, -6.0, 10.0, -5.0, 7.0, 10.0, 10.0, 20.0, -1.0, -20.0, -4.0, -15.0, -5.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0, 16.0, 10.0, 24.0, 0.0, -9.0, -3.0, 14.0, 0.0, 20.0, 0.0, 4.0, 50.0, -15.0, 20.0, -2.0, -1.0, -1.0, 5.0, 24.0, -25.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 10.0, -3.0, 30.0, 20.0, 7.0, 10.0, 10.0, 0.0, -1.0, 30.0, 20.0, 18.0, -1.0, 0.0, -6.0, 0.0, -10.0, 50.0, -9.0, 0.0, 0.0, 40.0, 0.0, 4.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 0.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 7.0, 10.0, -2.0, 10.0, 0.0, -4.0, 20.0, -3.0, 0.0, 10.0, -37.0, 0.0, 20.0, 0.0, 10.0, -1.0, 10.0, 10.0, 20.0, 0.0, 0.0, -1.0, 10.0, 10.0, 18.0, -30.0, 30.0, 10.0, 10.0, 40.0, 4.0, 23.0, -32.0, -5.0, -10.0, 0.0, -22.0, -3.0, 12.0, -5.0, 20.0, 10.0, 0.0, 50.0, 0.0, 5.0, 0.0, 20.0, 40.0, -12.0, 0.0, 10.0, 0.0, 0.0, -11.0, 10.0, 0.0, 3.0, 40.0, 2.0, -2.0, 0.0, 0.0, 10.0, 10.0, -2.0, 10.0, -9.0, 20.0, -16.0, 0.0, 17.0, 10.0, 0.0, 0.0, 0.0, 5.0, -16.0, 50.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0, 18.0, 0.0, 10.0, 0.0, 0.0, -5.0, -44.0, 29.0, 0.0, 0.0, 12.0, 0.0, 30.0, 30.0, 0.0, 10.0, 7.0, 8.0, 0.0, 70.0, 19.0, -20.0, 21.0, 9.0, 2.0, 10.0, 0.0, 9.0, 20.0, -7.0, -5.0, 50.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 3.0, 20.0, 10.0, 10.0, 20.0, -25.0, 22.0, 0.0, 0.0, 0.0, -13.0, 0.0, 10.0, -26.0, -11.0, 10.0, 30.0, 0.0, -19.0, 30.0, 20.0, -8.0, 8.0, 0.0, 0.0, 0.0, 0.0, -1.0, 13.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 30.0, 30.0, 20.0, 17.0, 0.0, 0.0, -5.0, 20.0, 60.0, 0.0, 8.0, -13.0, 20.0, -23.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -6.0, 10.0, 8.0, 9.0, -3.0, -60.0, 20.0, -4.0, 8.0, 12.0, 10.0, -11.0, -5.0, -10.0, -4.0, -18.0, 20.0, 20.0, -10.0, 20.0, -10.0, 10.0, -2.0, -4.0, 7.0, -4.0, 30.0, 0.0, -14.0, -2.0, 25.0, 50.0, 0.0, 15.0, 0.0, 20.0, -4.0, 30.0, 0.0, 10.0, -8.0, -6.0, 0.0, -3.0, 10.0, 5.0, -9.0, -1.0, 12.0, 0.0, 7.0, 10.0, 10.0, 10.0, 10.0, 20.0, 5.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, -1.0, 10.0, 0.0, -48.0, 10.0, 20.0, -7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, -3.0, 17.0, 10.0, 9.0, -2.0, 0.0, 20.0, 10.0, 39.0, 10.0, 30.0, 20.0, 40.0, 40.0, 8.0, -13.0, 20.0, 8.0, -29.0, -25.0, -1.0, 7.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 30.0, 20.0, -8.0, -5.0, 20.0, 0.0, 0.0, 10.0, -24.0, 0.0, 17.0, 0.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, -4.0, 0.0, 20.0, 0.0, 10.0, -1.0, 20.0, 20.0, 10.0, 0.0, 20.0, -5.0, 10.0, 9.0, 10.0, 10.0, 40.0, 0.0, 0.0, 0.0, 20.0, 20.0, 27.0, -4.0, 30.0, -25.0, 20.0, 36.0, 5.0, 60.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, -22.0, 20.0, 0.0, 0.0, -2.0, 7.0, 40.0, 0.0, 7.0, -1.0, 10.0, 9.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 0.0, -4.0, 10.0, -18.0, 20.0, 10.0, 10.0, 30.0, -11.0, 10.0, 10.0, 0.0, 0.0, -2.0, -8.0, -1.0, 0.0, 0.0, 0.0, -63.0, 20.0, 8.0, 20.0, 30.0, 30.0, -30.0, 10.0, 20.0, 0.0, 30.0, 13.0, 6.0, 0.0, 10.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0, -3.0, 0.0, -5.0, 2.0, -3.0, 10.0, 10.0, -1.0, -4.0, 10.0, 10.0, 20.0, 0.0, -10.0, 50.0, 0.0, 0.0, 20.0, -9.0, 10.0, 12.0, 30.0, -19.0, 60.0, 23.0, 0.0, 30.0, 30.0, 0.0, -18.0, 0.0, 10.0, 20.0, -10.0, 20.0, 10.0, 70.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 40.0, 5.0, -5.0, 20.0, 10.0, 50.0, 10.0, 3.0, 9.0, 30.0, 50.0, 3.0, 0.0, 29.0, 29.0, 0.0, 20.0, 0.0, 40.0, 50.0, 10.0, 10.0, 0.0, 30.0, 0.0, 8.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 6.0, 10.0, 40.0, 30.0, -2.0, 30.0, 10.0, 40.0, 0.0, 40.0, 16.0, 0.0, 10.0, -138.0, 0.0, 20.0, 4.0, 10.0, -19.0, 30.0, 0.0, -9.0, -2.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, -6.0, 10.0, 26.0, 20.0, -12.0, -1.0, 19.0, 20.0, 0.0, 20.0, 10.0, 3.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 60.0, 17.0, 30.0, 10.0, 8.0, 10.0, 5.0, 7.0, 10.0, 0.0, 30.0, -5.0, 20.0, -3.0, 0.0, 3.0, 20.0, 6.0, -1.0, 20.0, 17.0, 2.0, 30.0, 10.0, 22.0, 9.0, 10.0, 10.0, 0.0, 0.0, 10.0, -43.0, 4.0, 30.0, -3.0, -12.0, 2.0, -2.0, 9.0, 10.0, 0.0, 10.0, 0.0, -1.0, -9.0, -15.0, -1.0, -13.0, 10.0, 20.0, 8.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 18.0, 10.0, 0.0, 10.0, 0.0, 0.0, -2.0, 8.0, 0.0, 20.0, 0.0, 50.0, 10.0, 18.0, 9.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, -1.0, 20.0, 20.0, 40.0, 10.0, 10.0, -3.0, -5.0, 10.0, 50.0, -2.0, -3.0, 8.0, 10.0, 0.0, 0.0, 9.0, 40.0, 0.0, 40.0, 0.0, 30.0, -4.0, 30.0, 10.0, 20.0, 28.0, 15.0, 17.0, 40.0, 0.0, 30.0, 19.0, 10.0, -10.0, 0.0, 20.0, 20.0, -1.0, 20.0, -13.0, 10.0, -3.0, 20.0, 9.0, 10.0, 20.0, 10.0, -1.0, 10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8857988046201068, "mean_inference_ms": 1.8361255961523881, "mean_action_processing_ms": 0.605095663411857, "mean_env_wait_ms": 1.737876281757977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015479803085327148, "StateBufferConnector_ms": 0.011276721954345703, "ViewRequirementAgentConnector_ms": 0.5856015682220459}, "num_episodes": 27, "episode_return_max": 213.0, "episode_return_min": -104.0, "episode_return_mean": 71.46}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.106130666941258, "num_env_steps_trained_throughput_per_sec": 19.106130666941258, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 207464.004, "restore_workers_time_ms": 0.014, "training_step_time_ms": 207463.951, "sample_time_ms": 3295.477, "learn_time_ms": 204148.999, "learn_throughput": 19.594, "synch_weights_time_ms": 11.695}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "a22d3_00000", "date": "2024-08-05_23-18-01", "timestamp": 1722914281, "time_this_iter_s": 209.37080430984497, "time_total_s": 2074.7569267749786, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01349d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2074.7569267749786, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.451351351351356, "ram_util_percent": 78.02770270270271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.657163159344524, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.218169739832893, "policy_loss": -0.011049203984181499, "vf_loss": 4.227534499031286, "vf_explained_var": 0.042055822827945503, "kl": 0.008422196558647862, "entropy": 1.3909513117533268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 300.0, "episode_reward_min": -104.0, "episode_reward_mean": 101.76, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -138.0}, "policy_reward_max": {"policy_0": 120.0}, "policy_reward_mean": {"policy_0": 10.176}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 72.0, 59.0, 70.0, 93.0, 69.0, 77.0, 180.0, 80.0, 38.0, 42.0, 57.0, 7.0, 140.0, 40.0, 39.0, 50.0, 15.0, 40.0, 8.0, 167.0, 63.0, 145.0, 60.0, 11.0, 52.0, 180.0, 150.0, -8.0, -6.0, 12.0, 11.0, 146.0, 0.0, 82.0, 61.0, -11.0, 52.0, 207.0, 25.0, 140.0, 43.0, 73.0, 94.0, 119.0, 179.0, 75.0, 70.0, 138.0, 58.0, 28.0, 25.0, 159.0, 65.0, 60.0, 16.0, 91.0, 148.0, 160.0, 100.0, 213.0, 160.0, 144.0, 174.0, -104.0, 160.0, 109.0, 200.0, 127.0, 77.0, 103.0, -5.0, 9.0, 110.0, 64.0, 127.0, 101.0, 112.0, 186.0, 128.0, 82.0, 167.0, 197.0, 223.0, 78.0, 151.0, 174.0, 283.0, 133.0, 182.0, 100.0, 163.0, 162.0, 266.0, 118.0, 121.0, 250.0, 300.0, 196.0, 209.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 10.0, 0.0, 0.0, 0.0, -14.0, -16.0, 0.0, -20.0, 20.0, 16.0, 10.0, 24.0, 0.0, -9.0, -3.0, 14.0, 0.0, 20.0, 0.0, 4.0, 50.0, -15.0, 20.0, -2.0, -1.0, -1.0, 5.0, 24.0, -25.0, 0.0, -7.0, 10.0, 0.0, 0.0, 10.0, 10.0, -3.0, 30.0, 20.0, 7.0, 10.0, 10.0, 0.0, -1.0, 30.0, 20.0, 18.0, -1.0, 0.0, -6.0, 0.0, -10.0, 50.0, -9.0, 0.0, 0.0, 40.0, 0.0, 4.0, 0.0, 0.0, 10.0, 8.0, -1.0, 10.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 0.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 7.0, 10.0, -2.0, 10.0, 0.0, -4.0, 20.0, -3.0, 0.0, 10.0, -37.0, 0.0, 20.0, 0.0, 10.0, -1.0, 10.0, 10.0, 20.0, 0.0, 0.0, -1.0, 10.0, 10.0, 18.0, -30.0, 30.0, 10.0, 10.0, 40.0, 4.0, 23.0, -32.0, -5.0, -10.0, 0.0, -22.0, -3.0, 12.0, -5.0, 20.0, 10.0, 0.0, 50.0, 0.0, 5.0, 0.0, 20.0, 40.0, -12.0, 0.0, 10.0, 0.0, 0.0, -11.0, 10.0, 0.0, 3.0, 40.0, 2.0, -2.0, 0.0, 0.0, 10.0, 10.0, -2.0, 10.0, -9.0, 20.0, -16.0, 0.0, 17.0, 10.0, 0.0, 0.0, 0.0, 5.0, -16.0, 50.0, 0.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0, 18.0, 0.0, 10.0, 0.0, 0.0, -5.0, -44.0, 29.0, 0.0, 0.0, 12.0, 0.0, 30.0, 30.0, 0.0, 10.0, 7.0, 8.0, 0.0, 70.0, 19.0, -20.0, 21.0, 9.0, 2.0, 10.0, 0.0, 9.0, 20.0, -7.0, -5.0, 50.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 3.0, 20.0, 10.0, 10.0, 20.0, -25.0, 22.0, 0.0, 0.0, 0.0, -13.0, 0.0, 10.0, -26.0, -11.0, 10.0, 30.0, 0.0, -19.0, 30.0, 20.0, -8.0, 8.0, 0.0, 0.0, 0.0, 0.0, -1.0, 13.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 30.0, 30.0, 20.0, 17.0, 0.0, 0.0, -5.0, 20.0, 60.0, 0.0, 8.0, -13.0, 20.0, -23.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -6.0, 10.0, 8.0, 9.0, -3.0, -60.0, 20.0, -4.0, 8.0, 12.0, 10.0, -11.0, -5.0, -10.0, -4.0, -18.0, 20.0, 20.0, -10.0, 20.0, -10.0, 10.0, -2.0, -4.0, 7.0, -4.0, 30.0, 0.0, -14.0, -2.0, 25.0, 50.0, 0.0, 15.0, 0.0, 20.0, -4.0, 30.0, 0.0, 10.0, -8.0, -6.0, 0.0, -3.0, 10.0, 5.0, -9.0, -1.0, 12.0, 0.0, 7.0, 10.0, 10.0, 10.0, 10.0, 20.0, 5.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, -1.0, 10.0, 0.0, -48.0, 10.0, 20.0, -7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, -3.0, 17.0, 10.0, 9.0, -2.0, 0.0, 20.0, 10.0, 39.0, 10.0, 30.0, 20.0, 40.0, 40.0, 8.0, -13.0, 20.0, 8.0, -29.0, -25.0, -1.0, 7.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 30.0, 20.0, -8.0, -5.0, 20.0, 0.0, 0.0, 10.0, -24.0, 0.0, 17.0, 0.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, -4.0, 0.0, 20.0, 0.0, 10.0, -1.0, 20.0, 20.0, 10.0, 0.0, 20.0, -5.0, 10.0, 9.0, 10.0, 10.0, 40.0, 0.0, 0.0, 0.0, 20.0, 20.0, 27.0, -4.0, 30.0, -25.0, 20.0, 36.0, 5.0, 60.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, -22.0, 20.0, 0.0, 0.0, -2.0, 7.0, 40.0, 0.0, 7.0, -1.0, 10.0, 9.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 0.0, -4.0, 10.0, -18.0, 20.0, 10.0, 10.0, 30.0, -11.0, 10.0, 10.0, 0.0, 0.0, -2.0, -8.0, -1.0, 0.0, 0.0, 0.0, -63.0, 20.0, 8.0, 20.0, 30.0, 30.0, -30.0, 10.0, 20.0, 0.0, 30.0, 13.0, 6.0, 0.0, 10.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0, -3.0, 0.0, -5.0, 2.0, -3.0, 10.0, 10.0, -1.0, -4.0, 10.0, 10.0, 20.0, 0.0, -10.0, 50.0, 0.0, 0.0, 20.0, -9.0, 10.0, 12.0, 30.0, -19.0, 60.0, 23.0, 0.0, 30.0, 30.0, 0.0, -18.0, 0.0, 10.0, 20.0, -10.0, 20.0, 10.0, 70.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 40.0, 5.0, -5.0, 20.0, 10.0, 50.0, 10.0, 3.0, 9.0, 30.0, 50.0, 3.0, 0.0, 29.0, 29.0, 0.0, 20.0, 0.0, 40.0, 50.0, 10.0, 10.0, 0.0, 30.0, 0.0, 8.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 6.0, 10.0, 40.0, 30.0, -2.0, 30.0, 10.0, 40.0, 0.0, 40.0, 16.0, 0.0, 10.0, -138.0, 0.0, 20.0, 4.0, 10.0, -19.0, 30.0, 0.0, -9.0, -2.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, -6.0, 10.0, 26.0, 20.0, -12.0, -1.0, 19.0, 20.0, 0.0, 20.0, 10.0, 3.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 60.0, 17.0, 30.0, 10.0, 8.0, 10.0, 5.0, 7.0, 10.0, 0.0, 30.0, -5.0, 20.0, -3.0, 0.0, 3.0, 20.0, 6.0, -1.0, 20.0, 17.0, 2.0, 30.0, 10.0, 22.0, 9.0, 10.0, 10.0, 0.0, 0.0, 10.0, -43.0, 4.0, 30.0, -3.0, -12.0, 2.0, -2.0, 9.0, 10.0, 0.0, 10.0, 0.0, -1.0, -9.0, -15.0, -1.0, -13.0, 10.0, 20.0, 8.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 18.0, 10.0, 0.0, 10.0, 0.0, 0.0, -2.0, 8.0, 0.0, 20.0, 0.0, 50.0, 10.0, 18.0, 9.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, -1.0, 20.0, 20.0, 40.0, 10.0, 10.0, -3.0, -5.0, 10.0, 50.0, -2.0, -3.0, 8.0, 10.0, 0.0, 0.0, 9.0, 40.0, 0.0, 40.0, 0.0, 30.0, -4.0, 30.0, 10.0, 20.0, 28.0, 15.0, 17.0, 40.0, 0.0, 30.0, 19.0, 10.0, -10.0, 0.0, 20.0, 20.0, -1.0, 20.0, -13.0, 10.0, -3.0, 20.0, 9.0, 10.0, 20.0, 10.0, -1.0, 10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0, 40.0, 0.0, 36.0, 20.0, 6.0, 10.0, 27.0, 8.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 16.0, 30.0, 0.0, 0.0, -3.0, 70.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, -12.0, 10.0, 0.0, 30.0, 35.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 0.0, -4.0, -5.0, 40.0, 30.0, 40.0, 20.0, -4.0, 7.0, 30.0, 6.0, 10.0, 120.0, 50.0, 40.0, 19.0, 1.0, 13.0, 10.0, 20.0, -10.0, 20.0, 19.0, 20.0, 30.0, 10.0, 10.0, -4.0, 8.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 0.0, 0.0, -8.0, 70.0, 20.0, 30.0, 10.0, 0.0, 60.0, 30.0, -6.0, 20.0, 0.0, 10.0, -2.0, -7.0, -5.0, 30.0, 20.0, 0.0, 10.0, -8.0, 22.0, 50.0, 20.0, 0.0, 19.0, 20.0, 20.0, 40.0, 10.0, 27.0, 10.0, 10.0, 0.0, 15.0, 10.0, -1.0, 60.0, 20.0, 40.0, 27.0, 20.0, 40.0, 20.0, 10.0, 30.0, 16.0, 10.0, 25.0, 0.0, 38.0, 0.0, 7.0, 5.0, 7.0, 10.0, 0.0, -7.0, -21.0, 16.0, 3.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 0.0, 40.0, 10.0, 10.0, 30.0, 30.0, 40.0, 20.0, 90.0, 20.0, 40.0, 30.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 19.0, -3.0, 20.0, 10.0, 70.0, 0.0, 20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8919964891967456, "mean_inference_ms": 1.8717277332749545, "mean_action_processing_ms": 0.6071839154050864, "mean_env_wait_ms": 1.743684945160349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016115903854370117, "StateBufferConnector_ms": 0.01171565055847168, "ViewRequirementAgentConnector_ms": 0.5890841484069824}, "num_episodes": 18, "episode_return_max": 300.0, "episode_return_min": -104.0, "episode_return_mean": 101.76}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 19.20309379433705, "num_env_steps_trained_throughput_per_sec": 19.20309379433705, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 208140.779, "restore_workers_time_ms": 0.014, "training_step_time_ms": 208140.726, "sample_time_ms": 3241.087, "learn_time_ms": 204880.398, "learn_throughput": 19.524, "synch_weights_time_ms": 11.667}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "a22d3_00000", "date": "2024-08-05_23-21-30", "timestamp": 1722914490, "time_this_iter_s": 208.31256699562073, "time_total_s": 2283.0694937705994, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b8790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2283.0694937705994, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.886779661016945, "ram_util_percent": 78.54881355932204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7706086699320234, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.30341089802682, "policy_loss": -0.011718152224976883, "vf_loss": 4.313221764640686, "vf_explained_var": 0.014018844231502951, "kl": 0.009536426197028448, "entropy": 1.3713742740872823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 320.0, "episode_reward_min": -104.0, "episode_reward_mean": 122.53, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -138.0}, "policy_reward_max": {"policy_0": 120.0}, "policy_reward_mean": {"policy_0": 12.253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0, 8.0, 167.0, 63.0, 145.0, 60.0, 11.0, 52.0, 180.0, 150.0, -8.0, -6.0, 12.0, 11.0, 146.0, 0.0, 82.0, 61.0, -11.0, 52.0, 207.0, 25.0, 140.0, 43.0, 73.0, 94.0, 119.0, 179.0, 75.0, 70.0, 138.0, 58.0, 28.0, 25.0, 159.0, 65.0, 60.0, 16.0, 91.0, 148.0, 160.0, 100.0, 213.0, 160.0, 144.0, 174.0, -104.0, 160.0, 109.0, 200.0, 127.0, 77.0, 103.0, -5.0, 9.0, 110.0, 64.0, 127.0, 101.0, 112.0, 186.0, 128.0, 82.0, 167.0, 197.0, 223.0, 78.0, 151.0, 174.0, 283.0, 133.0, 182.0, 100.0, 163.0, 162.0, 266.0, 118.0, 121.0, 250.0, 300.0, 196.0, 209.0, 223.0, 29.0, 260.0, 86.0, 96.0, 320.0, 284.0, 170.0, -15.0, 260.0, 244.0, 119.0, 275.0, 260.0, 65.0, 195.0, 120.0, 224.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 10.0, -72.0, 0.0, 0.0, 30.0, -8.0, 20.0, 30.0, 18.0, 0.0, 10.0, 0.0, 0.0, -5.0, -44.0, 29.0, 0.0, 0.0, 12.0, 0.0, 30.0, 30.0, 0.0, 10.0, 7.0, 8.0, 0.0, 70.0, 19.0, -20.0, 21.0, 9.0, 2.0, 10.0, 0.0, 9.0, 20.0, -7.0, -5.0, 50.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 3.0, 20.0, 10.0, 10.0, 20.0, -25.0, 22.0, 0.0, 0.0, 0.0, -13.0, 0.0, 10.0, -26.0, -11.0, 10.0, 30.0, 0.0, -19.0, 30.0, 20.0, -8.0, 8.0, 0.0, 0.0, 0.0, 0.0, -1.0, 13.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 30.0, 10.0, 0.0, 10.0, 30.0, 30.0, 20.0, 17.0, 0.0, 0.0, -5.0, 20.0, 60.0, 0.0, 8.0, -13.0, 20.0, -23.0, -2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -6.0, 10.0, 8.0, 9.0, -3.0, -60.0, 20.0, -4.0, 8.0, 12.0, 10.0, -11.0, -5.0, -10.0, -4.0, -18.0, 20.0, 20.0, -10.0, 20.0, -10.0, 10.0, -2.0, -4.0, 7.0, -4.0, 30.0, 0.0, -14.0, -2.0, 25.0, 50.0, 0.0, 15.0, 0.0, 20.0, -4.0, 30.0, 0.0, 10.0, -8.0, -6.0, 0.0, -3.0, 10.0, 5.0, -9.0, -1.0, 12.0, 0.0, 7.0, 10.0, 10.0, 10.0, 10.0, 20.0, 5.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 20.0, -1.0, 10.0, 0.0, -48.0, 10.0, 20.0, -7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, -3.0, 17.0, 10.0, 9.0, -2.0, 0.0, 20.0, 10.0, 39.0, 10.0, 30.0, 20.0, 40.0, 40.0, 8.0, -13.0, 20.0, 8.0, -29.0, -25.0, -1.0, 7.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 30.0, 20.0, -8.0, -5.0, 20.0, 0.0, 0.0, 10.0, -24.0, 0.0, 17.0, 0.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, -4.0, 0.0, 20.0, 0.0, 10.0, -1.0, 20.0, 20.0, 10.0, 0.0, 20.0, -5.0, 10.0, 9.0, 10.0, 10.0, 40.0, 0.0, 0.0, 0.0, 20.0, 20.0, 27.0, -4.0, 30.0, -25.0, 20.0, 36.0, 5.0, 60.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, -22.0, 20.0, 0.0, 0.0, -2.0, 7.0, 40.0, 0.0, 7.0, -1.0, 10.0, 9.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 0.0, -4.0, 10.0, -18.0, 20.0, 10.0, 10.0, 30.0, -11.0, 10.0, 10.0, 0.0, 0.0, -2.0, -8.0, -1.0, 0.0, 0.0, 0.0, -63.0, 20.0, 8.0, 20.0, 30.0, 30.0, -30.0, 10.0, 20.0, 0.0, 30.0, 13.0, 6.0, 0.0, 10.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0, -3.0, 0.0, -5.0, 2.0, -3.0, 10.0, 10.0, -1.0, -4.0, 10.0, 10.0, 20.0, 0.0, -10.0, 50.0, 0.0, 0.0, 20.0, -9.0, 10.0, 12.0, 30.0, -19.0, 60.0, 23.0, 0.0, 30.0, 30.0, 0.0, -18.0, 0.0, 10.0, 20.0, -10.0, 20.0, 10.0, 70.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 40.0, 5.0, -5.0, 20.0, 10.0, 50.0, 10.0, 3.0, 9.0, 30.0, 50.0, 3.0, 0.0, 29.0, 29.0, 0.0, 20.0, 0.0, 40.0, 50.0, 10.0, 10.0, 0.0, 30.0, 0.0, 8.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 6.0, 10.0, 40.0, 30.0, -2.0, 30.0, 10.0, 40.0, 0.0, 40.0, 16.0, 0.0, 10.0, -138.0, 0.0, 20.0, 4.0, 10.0, -19.0, 30.0, 0.0, -9.0, -2.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, -6.0, 10.0, 26.0, 20.0, -12.0, -1.0, 19.0, 20.0, 0.0, 20.0, 10.0, 3.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 60.0, 17.0, 30.0, 10.0, 8.0, 10.0, 5.0, 7.0, 10.0, 0.0, 30.0, -5.0, 20.0, -3.0, 0.0, 3.0, 20.0, 6.0, -1.0, 20.0, 17.0, 2.0, 30.0, 10.0, 22.0, 9.0, 10.0, 10.0, 0.0, 0.0, 10.0, -43.0, 4.0, 30.0, -3.0, -12.0, 2.0, -2.0, 9.0, 10.0, 0.0, 10.0, 0.0, -1.0, -9.0, -15.0, -1.0, -13.0, 10.0, 20.0, 8.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 18.0, 10.0, 0.0, 10.0, 0.0, 0.0, -2.0, 8.0, 0.0, 20.0, 0.0, 50.0, 10.0, 18.0, 9.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, -1.0, 20.0, 20.0, 40.0, 10.0, 10.0, -3.0, -5.0, 10.0, 50.0, -2.0, -3.0, 8.0, 10.0, 0.0, 0.0, 9.0, 40.0, 0.0, 40.0, 0.0, 30.0, -4.0, 30.0, 10.0, 20.0, 28.0, 15.0, 17.0, 40.0, 0.0, 30.0, 19.0, 10.0, -10.0, 0.0, 20.0, 20.0, -1.0, 20.0, -13.0, 10.0, -3.0, 20.0, 9.0, 10.0, 20.0, 10.0, -1.0, 10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0, 40.0, 0.0, 36.0, 20.0, 6.0, 10.0, 27.0, 8.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 16.0, 30.0, 0.0, 0.0, -3.0, 70.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, -12.0, 10.0, 0.0, 30.0, 35.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 0.0, -4.0, -5.0, 40.0, 30.0, 40.0, 20.0, -4.0, 7.0, 30.0, 6.0, 10.0, 120.0, 50.0, 40.0, 19.0, 1.0, 13.0, 10.0, 20.0, -10.0, 20.0, 19.0, 20.0, 30.0, 10.0, 10.0, -4.0, 8.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 0.0, 0.0, -8.0, 70.0, 20.0, 30.0, 10.0, 0.0, 60.0, 30.0, -6.0, 20.0, 0.0, 10.0, -2.0, -7.0, -5.0, 30.0, 20.0, 0.0, 10.0, -8.0, 22.0, 50.0, 20.0, 0.0, 19.0, 20.0, 20.0, 40.0, 10.0, 27.0, 10.0, 10.0, 0.0, 15.0, 10.0, -1.0, 60.0, 20.0, 40.0, 27.0, 20.0, 40.0, 20.0, 10.0, 30.0, 16.0, 10.0, 25.0, 0.0, 38.0, 0.0, 7.0, 5.0, 7.0, 10.0, 0.0, -7.0, -21.0, 16.0, 3.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 0.0, 40.0, 10.0, 10.0, 30.0, 30.0, 40.0, 20.0, 90.0, 20.0, 40.0, 30.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 19.0, -3.0, 20.0, 10.0, 70.0, 0.0, 20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0, 10.0, 7.0, 10.0, 10.0, 29.0, 20.0, 0.0, 20.0, 79.0, 38.0, -50.0, 15.0, -14.0, 0.0, 40.0, 26.0, -27.0, 20.0, 30.0, -11.0, 80.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, -13.0, 35.0, -3.0, 17.0, 0.0, 0.0, 30.0, 20.0, 40.0, -2.0, 20.0, 3.0, -10.0, 20.0, 12.0, 10.0, 4.0, -1.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 0.0, 30.0, 100.0, 20.0, 6.0, 60.0, 0.0, -2.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, -2.0, 2.0, 0.0, 5.0, -32.0, 0.0, 26.0, 10.0, -5.0, -19.0, 17.0, -3.0, 50.0, 20.0, -11.0, 20.0, 60.0, -13.0, 90.0, 30.0, 7.0, 50.0, 20.0, 40.0, 10.0, 0.0, 17.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, -20.0, -7.0, 40.0, 40.0, 30.0, -17.0, 3.0, 60.0, 10.0, 30.0, 60.0, 24.0, 0.0, 30.0, 21.0, 0.0, 40.0, 0.0, 50.0, 20.0, 50.0, 20.0, 30.0, 0.0, 20.0, 60.0, 10.0, 15.0, 8.0, 10.0, 1.0, 10.0, 16.0, 0.0, 10.0, -15.0, 10.0, 20.0, 20.0, 20.0, 0.0, 8.0, 10.0, 20.0, 20.0, 50.0, 27.0, -7.0, 6.0, 20.0, 10.0, 10.0, 20.0, 50.0, 17.0, -1.0, -5.0, -14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9014203467110187, "mean_inference_ms": 1.902507784554316, "mean_action_processing_ms": 0.6096957552498402, "mean_env_wait_ms": 1.7509567654711364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01579737663269043, "StateBufferConnector_ms": 0.011749982833862305, "ViewRequirementAgentConnector_ms": 0.5880060195922852}, "num_episodes": 18, "episode_return_max": 320.0, "episode_return_min": -104.0, "episode_return_mean": 122.53}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.69364017211352, "num_env_steps_trained_throughput_per_sec": 18.69364017211352, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 209309.187, "restore_workers_time_ms": 0.014, "training_step_time_ms": 209309.134, "sample_time_ms": 3243.671, "learn_time_ms": 206045.82, "learn_throughput": 19.413, "synch_weights_time_ms": 12.199}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "a22d3_00000", "date": "2024-08-05_23-25-04", "timestamp": 1722914704, "time_this_iter_s": 213.99192714691162, "time_total_s": 2497.061420917511, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b9c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2497.061420917511, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.4364238410596, "ram_util_percent": 78.93278145695363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5790279818292117, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.190097396036053, "policy_loss": -0.010369312518308013, "vf_loss": 4.198801005864169, "vf_explained_var": 0.007415030634822175, "kl": 0.008328509832283492, "entropy": 1.3583490307338701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 328.0, "episode_reward_min": -104.0, "episode_reward_mean": 139.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -138.0}, "policy_reward_max": {"policy_0": 120.0}, "policy_reward_mean": {"policy_0": 13.972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-11.0, 52.0, 207.0, 25.0, 140.0, 43.0, 73.0, 94.0, 119.0, 179.0, 75.0, 70.0, 138.0, 58.0, 28.0, 25.0, 159.0, 65.0, 60.0, 16.0, 91.0, 148.0, 160.0, 100.0, 213.0, 160.0, 144.0, 174.0, -104.0, 160.0, 109.0, 200.0, 127.0, 77.0, 103.0, -5.0, 9.0, 110.0, 64.0, 127.0, 101.0, 112.0, 186.0, 128.0, 82.0, 167.0, 197.0, 223.0, 78.0, 151.0, 174.0, 283.0, 133.0, 182.0, 100.0, 163.0, 162.0, 266.0, 118.0, 121.0, 250.0, 300.0, 196.0, 209.0, 223.0, 29.0, 260.0, 86.0, 96.0, 320.0, 284.0, 170.0, -15.0, 260.0, 244.0, 119.0, 275.0, 260.0, 65.0, 195.0, 120.0, 224.0, 61.0, 188.0, 120.0, 76.0, 118.0, 230.0, 129.0, 328.0, 196.0, 101.0, 214.0, 218.0, 61.0, 213.0, 247.0, 176.0, 60.0, 157.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-7.0, 0.0, -17.0, 20.0, -21.0, -7.0, 20.0, 30.0, 10.0, -39.0, 0.0, 0.0, 10.0, 0.0, 9.0, 0.0, -3.0, 17.0, 10.0, 9.0, -2.0, 0.0, 20.0, 10.0, 39.0, 10.0, 30.0, 20.0, 40.0, 40.0, 8.0, -13.0, 20.0, 8.0, -29.0, -25.0, -1.0, 7.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 30.0, 20.0, -8.0, -5.0, 20.0, 0.0, 0.0, 10.0, -24.0, 0.0, 17.0, 0.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, -4.0, 0.0, 20.0, 0.0, 10.0, -1.0, 20.0, 20.0, 10.0, 0.0, 20.0, -5.0, 10.0, 9.0, 10.0, 10.0, 40.0, 0.0, 0.0, 0.0, 20.0, 20.0, 27.0, -4.0, 30.0, -25.0, 20.0, 36.0, 5.0, 60.0, 10.0, 20.0, 10.0, 0.0, 10.0, 0.0, 5.0, 20.0, 10.0, 0.0, 10.0, 10.0, 20.0, -22.0, 20.0, 0.0, 0.0, -2.0, 7.0, 40.0, 0.0, 7.0, -1.0, 10.0, 9.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 0.0, 0.0, -4.0, 10.0, -18.0, 20.0, 10.0, 10.0, 30.0, -11.0, 10.0, 10.0, 0.0, 0.0, -2.0, -8.0, -1.0, 0.0, 0.0, 0.0, -63.0, 20.0, 8.0, 20.0, 30.0, 30.0, -30.0, 10.0, 20.0, 0.0, 30.0, 13.0, 6.0, 0.0, 10.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0, -3.0, 0.0, -5.0, 2.0, -3.0, 10.0, 10.0, -1.0, -4.0, 10.0, 10.0, 20.0, 0.0, -10.0, 50.0, 0.0, 0.0, 20.0, -9.0, 10.0, 12.0, 30.0, -19.0, 60.0, 23.0, 0.0, 30.0, 30.0, 0.0, -18.0, 0.0, 10.0, 20.0, -10.0, 20.0, 10.0, 70.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 40.0, 5.0, -5.0, 20.0, 10.0, 50.0, 10.0, 3.0, 9.0, 30.0, 50.0, 3.0, 0.0, 29.0, 29.0, 0.0, 20.0, 0.0, 40.0, 50.0, 10.0, 10.0, 0.0, 30.0, 0.0, 8.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 6.0, 10.0, 40.0, 30.0, -2.0, 30.0, 10.0, 40.0, 0.0, 40.0, 16.0, 0.0, 10.0, -138.0, 0.0, 20.0, 4.0, 10.0, -19.0, 30.0, 0.0, -9.0, -2.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, -6.0, 10.0, 26.0, 20.0, -12.0, -1.0, 19.0, 20.0, 0.0, 20.0, 10.0, 3.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 60.0, 17.0, 30.0, 10.0, 8.0, 10.0, 5.0, 7.0, 10.0, 0.0, 30.0, -5.0, 20.0, -3.0, 0.0, 3.0, 20.0, 6.0, -1.0, 20.0, 17.0, 2.0, 30.0, 10.0, 22.0, 9.0, 10.0, 10.0, 0.0, 0.0, 10.0, -43.0, 4.0, 30.0, -3.0, -12.0, 2.0, -2.0, 9.0, 10.0, 0.0, 10.0, 0.0, -1.0, -9.0, -15.0, -1.0, -13.0, 10.0, 20.0, 8.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 18.0, 10.0, 0.0, 10.0, 0.0, 0.0, -2.0, 8.0, 0.0, 20.0, 0.0, 50.0, 10.0, 18.0, 9.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, -1.0, 20.0, 20.0, 40.0, 10.0, 10.0, -3.0, -5.0, 10.0, 50.0, -2.0, -3.0, 8.0, 10.0, 0.0, 0.0, 9.0, 40.0, 0.0, 40.0, 0.0, 30.0, -4.0, 30.0, 10.0, 20.0, 28.0, 15.0, 17.0, 40.0, 0.0, 30.0, 19.0, 10.0, -10.0, 0.0, 20.0, 20.0, -1.0, 20.0, -13.0, 10.0, -3.0, 20.0, 9.0, 10.0, 20.0, 10.0, -1.0, 10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0, 40.0, 0.0, 36.0, 20.0, 6.0, 10.0, 27.0, 8.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 16.0, 30.0, 0.0, 0.0, -3.0, 70.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, -12.0, 10.0, 0.0, 30.0, 35.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 0.0, -4.0, -5.0, 40.0, 30.0, 40.0, 20.0, -4.0, 7.0, 30.0, 6.0, 10.0, 120.0, 50.0, 40.0, 19.0, 1.0, 13.0, 10.0, 20.0, -10.0, 20.0, 19.0, 20.0, 30.0, 10.0, 10.0, -4.0, 8.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 0.0, 0.0, -8.0, 70.0, 20.0, 30.0, 10.0, 0.0, 60.0, 30.0, -6.0, 20.0, 0.0, 10.0, -2.0, -7.0, -5.0, 30.0, 20.0, 0.0, 10.0, -8.0, 22.0, 50.0, 20.0, 0.0, 19.0, 20.0, 20.0, 40.0, 10.0, 27.0, 10.0, 10.0, 0.0, 15.0, 10.0, -1.0, 60.0, 20.0, 40.0, 27.0, 20.0, 40.0, 20.0, 10.0, 30.0, 16.0, 10.0, 25.0, 0.0, 38.0, 0.0, 7.0, 5.0, 7.0, 10.0, 0.0, -7.0, -21.0, 16.0, 3.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 0.0, 40.0, 10.0, 10.0, 30.0, 30.0, 40.0, 20.0, 90.0, 20.0, 40.0, 30.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 19.0, -3.0, 20.0, 10.0, 70.0, 0.0, 20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0, 10.0, 7.0, 10.0, 10.0, 29.0, 20.0, 0.0, 20.0, 79.0, 38.0, -50.0, 15.0, -14.0, 0.0, 40.0, 26.0, -27.0, 20.0, 30.0, -11.0, 80.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, -13.0, 35.0, -3.0, 17.0, 0.0, 0.0, 30.0, 20.0, 40.0, -2.0, 20.0, 3.0, -10.0, 20.0, 12.0, 10.0, 4.0, -1.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 0.0, 30.0, 100.0, 20.0, 6.0, 60.0, 0.0, -2.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, -2.0, 2.0, 0.0, 5.0, -32.0, 0.0, 26.0, 10.0, -5.0, -19.0, 17.0, -3.0, 50.0, 20.0, -11.0, 20.0, 60.0, -13.0, 90.0, 30.0, 7.0, 50.0, 20.0, 40.0, 10.0, 0.0, 17.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, -20.0, -7.0, 40.0, 40.0, 30.0, -17.0, 3.0, 60.0, 10.0, 30.0, 60.0, 24.0, 0.0, 30.0, 21.0, 0.0, 40.0, 0.0, 50.0, 20.0, 50.0, 20.0, 30.0, 0.0, 20.0, 60.0, 10.0, 15.0, 8.0, 10.0, 1.0, 10.0, 16.0, 0.0, 10.0, -15.0, 10.0, 20.0, 20.0, 20.0, 0.0, 8.0, 10.0, 20.0, 20.0, 50.0, 27.0, -7.0, 6.0, 20.0, 10.0, 10.0, 20.0, 50.0, 17.0, -1.0, -5.0, -14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0, 10.0, 20.0, 6.0, 19.0, -10.0, -4.0, -6.0, -4.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 20.0, 3.0, -5.0, 20.0, 54.0, 6.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, -3.0, 17.0, 60.0, 20.0, -3.0, -5.0, 9.0, -18.0, -1.0, 10.0, 30.0, 7.0, 0.0, -4.0, 10.0, 38.0, 10.0, 9.0, 8.0, 0.0, 20.0, 40.0, 30.0, 20.0, 80.0, 10.0, 20.0, 0.0, 10.0, 0.0, 16.0, 20.0, 30.0, 47.0, 20.0, -5.0, 6.0, 10.0, -15.0, 10.0, 0.0, 40.0, 26.0, 40.0, 17.0, 89.0, 30.0, 80.0, -4.0, -1.0, 0.0, 20.0, 10.0, 28.0, 20.0, 30.0, 100.0, -10.0, -1.0, 20.0, 0.0, 10.0, 20.0, -9.0, 0.0, 40.0, -10.0, 10.0, 20.0, 30.0, 11.0, 0.0, 10.0, 70.0, 30.0, 30.0, -4.0, 7.0, 30.0, 10.0, 30.0, 20.0, 20.0, -1.0, 30.0, 0.0, 70.0, 40.0, -1.0, 0.0, 20.0, 0.0, -5.0, 0.0, -2.0, 0.0, 10.0, -2.0, 40.0, 10.0, 20.0, 7.0, 19.0, 9.0, 7.0, 100.0, 30.0, 15.0, -4.0, 20.0, 40.0, 30.0, -2.0, 0.0, 30.0, 40.0, 40.0, 19.0, 30.0, 30.0, 30.0, -2.0, 10.0, 20.0, 48.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9014756386608178, "mean_inference_ms": 1.9164786205626234, "mean_action_processing_ms": 0.6087074627286299, "mean_env_wait_ms": 1.7495336306028322, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015694379806518555, "StateBufferConnector_ms": 0.01162099838256836, "ViewRequirementAgentConnector_ms": 0.5724570751190186}, "num_episodes": 18, "episode_return_max": 328.0, "episode_return_min": -104.0, "episode_return_mean": 139.72}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.646376371697873, "num_env_steps_trained_throughput_per_sec": 18.646376371697873, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 210562.42, "restore_workers_time_ms": 0.013, "training_step_time_ms": 210562.371, "sample_time_ms": 3266.533, "learn_time_ms": 207276.534, "learn_throughput": 19.298, "synch_weights_time_ms": 12.045}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "a22d3_00000", "date": "2024-08-05_23-28-38", "timestamp": 1722914918, "time_this_iter_s": 214.52710914611816, "time_total_s": 2711.588530063629, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014d160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2711.588530063629, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.33125, "ram_util_percent": 78.19111842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8577693629442567, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8520205779070547, "policy_loss": -0.01091404360477516, "vf_loss": 3.8613616137204967, "vf_explained_var": 0.012188034386426624, "kl": 0.007865068191478322, "entropy": 1.3320246043296669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 328.0, "episode_reward_min": -104.0, "episode_reward_mean": 154.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -138.0}, "policy_reward_max": {"policy_0": 120.0}, "policy_reward_mean": {"policy_0": 15.43}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 16.0, 91.0, 148.0, 160.0, 100.0, 213.0, 160.0, 144.0, 174.0, -104.0, 160.0, 109.0, 200.0, 127.0, 77.0, 103.0, -5.0, 9.0, 110.0, 64.0, 127.0, 101.0, 112.0, 186.0, 128.0, 82.0, 167.0, 197.0, 223.0, 78.0, 151.0, 174.0, 283.0, 133.0, 182.0, 100.0, 163.0, 162.0, 266.0, 118.0, 121.0, 250.0, 300.0, 196.0, 209.0, 223.0, 29.0, 260.0, 86.0, 96.0, 320.0, 284.0, 170.0, -15.0, 260.0, 244.0, 119.0, 275.0, 260.0, 65.0, 195.0, 120.0, 224.0, 61.0, 188.0, 120.0, 76.0, 118.0, 230.0, 129.0, 328.0, 196.0, 101.0, 214.0, 218.0, 61.0, 213.0, 247.0, 176.0, 60.0, 157.0, 200.0, 179.0, 152.0, 239.0, 146.0, 301.0, 199.0, 150.0, 193.0, 103.0, 186.0, 72.0, 185.0, 80.0, 123.0, 122.0, 138.0, 229.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, -5.0, 9.0, 0.0, 0.0, 10.0, 0.0, -4.0, 40.0, 0.0, -3.0, 0.0, -5.0, 2.0, -3.0, 10.0, 10.0, -1.0, -4.0, 10.0, 10.0, 20.0, 0.0, -10.0, 50.0, 0.0, 0.0, 20.0, -9.0, 10.0, 12.0, 30.0, -19.0, 60.0, 23.0, 0.0, 30.0, 30.0, 0.0, -18.0, 0.0, 10.0, 20.0, -10.0, 20.0, 10.0, 70.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 40.0, 5.0, -5.0, 20.0, 10.0, 50.0, 10.0, 3.0, 9.0, 30.0, 50.0, 3.0, 0.0, 29.0, 29.0, 0.0, 20.0, 0.0, 40.0, 50.0, 10.0, 10.0, 0.0, 30.0, 0.0, 8.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 6.0, 10.0, 40.0, 30.0, -2.0, 30.0, 10.0, 40.0, 0.0, 40.0, 16.0, 0.0, 10.0, -138.0, 0.0, 20.0, 4.0, 10.0, -19.0, 30.0, 0.0, -9.0, -2.0, 10.0, 20.0, 30.0, 20.0, 10.0, 20.0, -6.0, 10.0, 26.0, 20.0, -12.0, -1.0, 19.0, 20.0, 0.0, 20.0, 10.0, 3.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 60.0, 17.0, 30.0, 10.0, 8.0, 10.0, 5.0, 7.0, 10.0, 0.0, 30.0, -5.0, 20.0, -3.0, 0.0, 3.0, 20.0, 6.0, -1.0, 20.0, 17.0, 2.0, 30.0, 10.0, 22.0, 9.0, 10.0, 10.0, 0.0, 0.0, 10.0, -43.0, 4.0, 30.0, -3.0, -12.0, 2.0, -2.0, 9.0, 10.0, 0.0, 10.0, 0.0, -1.0, -9.0, -15.0, -1.0, -13.0, 10.0, 20.0, 8.0, 20.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 10.0, 18.0, 10.0, 0.0, 10.0, 0.0, 0.0, -2.0, 8.0, 0.0, 20.0, 0.0, 50.0, 10.0, 18.0, 9.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, -1.0, 20.0, 20.0, 40.0, 10.0, 10.0, -3.0, -5.0, 10.0, 50.0, -2.0, -3.0, 8.0, 10.0, 0.0, 0.0, 9.0, 40.0, 0.0, 40.0, 0.0, 30.0, -4.0, 30.0, 10.0, 20.0, 28.0, 15.0, 17.0, 40.0, 0.0, 30.0, 19.0, 10.0, -10.0, 0.0, 20.0, 20.0, -1.0, 20.0, -13.0, 10.0, -3.0, 20.0, 9.0, 10.0, 20.0, 10.0, -1.0, 10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0, 40.0, 0.0, 36.0, 20.0, 6.0, 10.0, 27.0, 8.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 16.0, 30.0, 0.0, 0.0, -3.0, 70.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, -12.0, 10.0, 0.0, 30.0, 35.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 0.0, -4.0, -5.0, 40.0, 30.0, 40.0, 20.0, -4.0, 7.0, 30.0, 6.0, 10.0, 120.0, 50.0, 40.0, 19.0, 1.0, 13.0, 10.0, 20.0, -10.0, 20.0, 19.0, 20.0, 30.0, 10.0, 10.0, -4.0, 8.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 0.0, 0.0, -8.0, 70.0, 20.0, 30.0, 10.0, 0.0, 60.0, 30.0, -6.0, 20.0, 0.0, 10.0, -2.0, -7.0, -5.0, 30.0, 20.0, 0.0, 10.0, -8.0, 22.0, 50.0, 20.0, 0.0, 19.0, 20.0, 20.0, 40.0, 10.0, 27.0, 10.0, 10.0, 0.0, 15.0, 10.0, -1.0, 60.0, 20.0, 40.0, 27.0, 20.0, 40.0, 20.0, 10.0, 30.0, 16.0, 10.0, 25.0, 0.0, 38.0, 0.0, 7.0, 5.0, 7.0, 10.0, 0.0, -7.0, -21.0, 16.0, 3.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 0.0, 40.0, 10.0, 10.0, 30.0, 30.0, 40.0, 20.0, 90.0, 20.0, 40.0, 30.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 19.0, -3.0, 20.0, 10.0, 70.0, 0.0, 20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0, 10.0, 7.0, 10.0, 10.0, 29.0, 20.0, 0.0, 20.0, 79.0, 38.0, -50.0, 15.0, -14.0, 0.0, 40.0, 26.0, -27.0, 20.0, 30.0, -11.0, 80.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, -13.0, 35.0, -3.0, 17.0, 0.0, 0.0, 30.0, 20.0, 40.0, -2.0, 20.0, 3.0, -10.0, 20.0, 12.0, 10.0, 4.0, -1.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 0.0, 30.0, 100.0, 20.0, 6.0, 60.0, 0.0, -2.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, -2.0, 2.0, 0.0, 5.0, -32.0, 0.0, 26.0, 10.0, -5.0, -19.0, 17.0, -3.0, 50.0, 20.0, -11.0, 20.0, 60.0, -13.0, 90.0, 30.0, 7.0, 50.0, 20.0, 40.0, 10.0, 0.0, 17.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, -20.0, -7.0, 40.0, 40.0, 30.0, -17.0, 3.0, 60.0, 10.0, 30.0, 60.0, 24.0, 0.0, 30.0, 21.0, 0.0, 40.0, 0.0, 50.0, 20.0, 50.0, 20.0, 30.0, 0.0, 20.0, 60.0, 10.0, 15.0, 8.0, 10.0, 1.0, 10.0, 16.0, 0.0, 10.0, -15.0, 10.0, 20.0, 20.0, 20.0, 0.0, 8.0, 10.0, 20.0, 20.0, 50.0, 27.0, -7.0, 6.0, 20.0, 10.0, 10.0, 20.0, 50.0, 17.0, -1.0, -5.0, -14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0, 10.0, 20.0, 6.0, 19.0, -10.0, -4.0, -6.0, -4.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 20.0, 3.0, -5.0, 20.0, 54.0, 6.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, -3.0, 17.0, 60.0, 20.0, -3.0, -5.0, 9.0, -18.0, -1.0, 10.0, 30.0, 7.0, 0.0, -4.0, 10.0, 38.0, 10.0, 9.0, 8.0, 0.0, 20.0, 40.0, 30.0, 20.0, 80.0, 10.0, 20.0, 0.0, 10.0, 0.0, 16.0, 20.0, 30.0, 47.0, 20.0, -5.0, 6.0, 10.0, -15.0, 10.0, 0.0, 40.0, 26.0, 40.0, 17.0, 89.0, 30.0, 80.0, -4.0, -1.0, 0.0, 20.0, 10.0, 28.0, 20.0, 30.0, 100.0, -10.0, -1.0, 20.0, 0.0, 10.0, 20.0, -9.0, 0.0, 40.0, -10.0, 10.0, 20.0, 30.0, 11.0, 0.0, 10.0, 70.0, 30.0, 30.0, -4.0, 7.0, 30.0, 10.0, 30.0, 20.0, 20.0, -1.0, 30.0, 0.0, 70.0, 40.0, -1.0, 0.0, 20.0, 0.0, -5.0, 0.0, -2.0, 0.0, 10.0, -2.0, 40.0, 10.0, 20.0, 7.0, 19.0, 9.0, 7.0, 100.0, 30.0, 15.0, -4.0, 20.0, 40.0, 30.0, -2.0, 0.0, 30.0, 40.0, 40.0, 19.0, 30.0, 30.0, 30.0, -2.0, 10.0, 20.0, 48.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0, -3.0, 10.0, 0.0, 4.0, 71.0, 40.0, 20.0, -10.0, 18.0, 50.0, 30.0, 30.0, 13.0, 35.0, 10.0, 0.0, 60.0, 10.0, -6.0, -3.0, 20.0, 19.0, 9.0, 20.0, 20.0, -12.0, 26.0, 10.0, 30.0, 10.0, 0.0, 9.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 12.0, 0.0, 3.0, -4.0, 15.0, 80.0, -3.0, 30.0, -5.0, 18.0, 70.0, 6.0, 30.0, 30.0, 35.0, 30.0, 20.0, 10.0, 50.0, 20.0, 9.0, 10.0, 40.0, -12.0, 60.0, 20.0, 9.0, 4.0, 30.0, 29.0, 24.0, 10.0, 15.0, 0.0, 10.0, 0.0, 70.0, 0.0, -9.0, 30.0, 10.0, 18.0, 29.0, 50.0, 20.0, 0.0, 10.0, 37.0, 0.0, 19.0, 20.0, 0.0, 15.0, 10.0, 16.0, -4.0, -4.0, 20.0, 30.0, 0.0, -5.0, 40.0, 10.0, 0.0, -2.0, 5.0, 40.0, 60.0, 8.0, 30.0, 18.0, -70.0, 30.0, -3.0, 30.0, 0.0, -11.0, 60.0, 8.0, 10.0, 20.0, 18.0, 16.0, 20.0, 8.0, 20.0, 28.0, 20.0, 15.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 10.0, 16.0, -2.0, -12.0, -2.0, 10.0, 10.0, 10.0, 0.0, -6.0, 19.0, 10.0, 20.0, 0.0, 50.0, 30.0, 20.0, -7.0, 10.0, 9.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 26.0, 10.0, 50.0, 2.0, 0.0, -50.0, 50.0, 47.0, 17.0, 27.0, -4.0, 70.0, 16.0, 30.0, 35.0, -19.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8941365086889437, "mean_inference_ms": 1.9184633085176683, "mean_action_processing_ms": 0.605956865738097, "mean_env_wait_ms": 1.7432854411116117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01562786102294922, "StateBufferConnector_ms": 0.011749744415283203, "ViewRequirementAgentConnector_ms": 0.5603852272033691}, "num_episodes": 18, "episode_return_max": 328.0, "episode_return_min": -104.0, "episode_return_mean": 154.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.41398573172759, "num_env_steps_trained_throughput_per_sec": 18.41398573172759, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 211229.846, "restore_workers_time_ms": 0.013, "training_step_time_ms": 211229.795, "sample_time_ms": 3254.455, "learn_time_ms": 207955.35, "learn_throughput": 19.235, "synch_weights_time_ms": 12.582}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "a22d3_00000", "date": "2024-08-05_23-32-16", "timestamp": 1722915136, "time_this_iter_s": 217.23357915878296, "time_total_s": 2928.822109222412, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01ba040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2928.822109222412, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 33.91270358306189, "ram_util_percent": 78.27947882736156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4067471250177572, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.192193303575404, "policy_loss": -0.010775764743947246, "vf_loss": 4.20138080833565, "vf_explained_var": 0.008889268375179385, "kl": 0.007941303116935357, "entropy": 1.2960741342066195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 410.0, "episode_reward_min": -15.0, "episode_reward_mean": 177.59, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 120.0}, "policy_reward_mean": {"policy_0": 17.759}, "custom_metrics": {}, "hist_stats": {"episode_reward": [167.0, 197.0, 223.0, 78.0, 151.0, 174.0, 283.0, 133.0, 182.0, 100.0, 163.0, 162.0, 266.0, 118.0, 121.0, 250.0, 300.0, 196.0, 209.0, 223.0, 29.0, 260.0, 86.0, 96.0, 320.0, 284.0, 170.0, -15.0, 260.0, 244.0, 119.0, 275.0, 260.0, 65.0, 195.0, 120.0, 224.0, 61.0, 188.0, 120.0, 76.0, 118.0, 230.0, 129.0, 328.0, 196.0, 101.0, 214.0, 218.0, 61.0, 213.0, 247.0, 176.0, 60.0, 157.0, 200.0, 179.0, 152.0, 239.0, 146.0, 301.0, 199.0, 150.0, 193.0, 103.0, 186.0, 72.0, 185.0, 80.0, 123.0, 122.0, 138.0, 229.0, 107.0, 237.0, 108.0, 149.0, 308.0, 216.0, 195.0, 162.0, 210.0, 125.0, 143.0, 410.0, 181.0, 152.0, 206.0, 347.0, 222.0, 126.0, 117.0, 93.0, 199.0, 167.0, 233.0, 158.0, 245.0, 76.0, 289.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, -12.0, 3.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 6.0, 40.0, 0.0, 36.0, 20.0, 6.0, 10.0, 27.0, 8.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 16.0, 30.0, 0.0, 0.0, -3.0, 70.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, -12.0, 10.0, 0.0, 30.0, 35.0, 10.0, 20.0, 40.0, 10.0, 10.0, 0.0, 0.0, -4.0, -5.0, 40.0, 30.0, 40.0, 20.0, -4.0, 7.0, 30.0, 6.0, 10.0, 120.0, 50.0, 40.0, 19.0, 1.0, 13.0, 10.0, 20.0, -10.0, 20.0, 19.0, 20.0, 30.0, 10.0, 10.0, -4.0, 8.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 0.0, 0.0, -8.0, 70.0, 20.0, 30.0, 10.0, 0.0, 60.0, 30.0, -6.0, 20.0, 0.0, 10.0, -2.0, -7.0, -5.0, 30.0, 20.0, 0.0, 10.0, -8.0, 22.0, 50.0, 20.0, 0.0, 19.0, 20.0, 20.0, 40.0, 10.0, 27.0, 10.0, 10.0, 0.0, 15.0, 10.0, -1.0, 60.0, 20.0, 40.0, 27.0, 20.0, 40.0, 20.0, 10.0, 30.0, 16.0, 10.0, 25.0, 0.0, 38.0, 0.0, 7.0, 5.0, 7.0, 10.0, 0.0, -7.0, -21.0, 16.0, 3.0, 20.0, 40.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 0.0, 40.0, 10.0, 10.0, 30.0, 30.0, 40.0, 20.0, 90.0, 20.0, 40.0, 30.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 19.0, -3.0, 20.0, 10.0, 70.0, 0.0, 20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0, 10.0, 7.0, 10.0, 10.0, 29.0, 20.0, 0.0, 20.0, 79.0, 38.0, -50.0, 15.0, -14.0, 0.0, 40.0, 26.0, -27.0, 20.0, 30.0, -11.0, 80.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, -13.0, 35.0, -3.0, 17.0, 0.0, 0.0, 30.0, 20.0, 40.0, -2.0, 20.0, 3.0, -10.0, 20.0, 12.0, 10.0, 4.0, -1.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 0.0, 30.0, 100.0, 20.0, 6.0, 60.0, 0.0, -2.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, -2.0, 2.0, 0.0, 5.0, -32.0, 0.0, 26.0, 10.0, -5.0, -19.0, 17.0, -3.0, 50.0, 20.0, -11.0, 20.0, 60.0, -13.0, 90.0, 30.0, 7.0, 50.0, 20.0, 40.0, 10.0, 0.0, 17.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, -20.0, -7.0, 40.0, 40.0, 30.0, -17.0, 3.0, 60.0, 10.0, 30.0, 60.0, 24.0, 0.0, 30.0, 21.0, 0.0, 40.0, 0.0, 50.0, 20.0, 50.0, 20.0, 30.0, 0.0, 20.0, 60.0, 10.0, 15.0, 8.0, 10.0, 1.0, 10.0, 16.0, 0.0, 10.0, -15.0, 10.0, 20.0, 20.0, 20.0, 0.0, 8.0, 10.0, 20.0, 20.0, 50.0, 27.0, -7.0, 6.0, 20.0, 10.0, 10.0, 20.0, 50.0, 17.0, -1.0, -5.0, -14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0, 10.0, 20.0, 6.0, 19.0, -10.0, -4.0, -6.0, -4.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 20.0, 3.0, -5.0, 20.0, 54.0, 6.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, -3.0, 17.0, 60.0, 20.0, -3.0, -5.0, 9.0, -18.0, -1.0, 10.0, 30.0, 7.0, 0.0, -4.0, 10.0, 38.0, 10.0, 9.0, 8.0, 0.0, 20.0, 40.0, 30.0, 20.0, 80.0, 10.0, 20.0, 0.0, 10.0, 0.0, 16.0, 20.0, 30.0, 47.0, 20.0, -5.0, 6.0, 10.0, -15.0, 10.0, 0.0, 40.0, 26.0, 40.0, 17.0, 89.0, 30.0, 80.0, -4.0, -1.0, 0.0, 20.0, 10.0, 28.0, 20.0, 30.0, 100.0, -10.0, -1.0, 20.0, 0.0, 10.0, 20.0, -9.0, 0.0, 40.0, -10.0, 10.0, 20.0, 30.0, 11.0, 0.0, 10.0, 70.0, 30.0, 30.0, -4.0, 7.0, 30.0, 10.0, 30.0, 20.0, 20.0, -1.0, 30.0, 0.0, 70.0, 40.0, -1.0, 0.0, 20.0, 0.0, -5.0, 0.0, -2.0, 0.0, 10.0, -2.0, 40.0, 10.0, 20.0, 7.0, 19.0, 9.0, 7.0, 100.0, 30.0, 15.0, -4.0, 20.0, 40.0, 30.0, -2.0, 0.0, 30.0, 40.0, 40.0, 19.0, 30.0, 30.0, 30.0, -2.0, 10.0, 20.0, 48.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0, -3.0, 10.0, 0.0, 4.0, 71.0, 40.0, 20.0, -10.0, 18.0, 50.0, 30.0, 30.0, 13.0, 35.0, 10.0, 0.0, 60.0, 10.0, -6.0, -3.0, 20.0, 19.0, 9.0, 20.0, 20.0, -12.0, 26.0, 10.0, 30.0, 10.0, 0.0, 9.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 12.0, 0.0, 3.0, -4.0, 15.0, 80.0, -3.0, 30.0, -5.0, 18.0, 70.0, 6.0, 30.0, 30.0, 35.0, 30.0, 20.0, 10.0, 50.0, 20.0, 9.0, 10.0, 40.0, -12.0, 60.0, 20.0, 9.0, 4.0, 30.0, 29.0, 24.0, 10.0, 15.0, 0.0, 10.0, 0.0, 70.0, 0.0, -9.0, 30.0, 10.0, 18.0, 29.0, 50.0, 20.0, 0.0, 10.0, 37.0, 0.0, 19.0, 20.0, 0.0, 15.0, 10.0, 16.0, -4.0, -4.0, 20.0, 30.0, 0.0, -5.0, 40.0, 10.0, 0.0, -2.0, 5.0, 40.0, 60.0, 8.0, 30.0, 18.0, -70.0, 30.0, -3.0, 30.0, 0.0, -11.0, 60.0, 8.0, 10.0, 20.0, 18.0, 16.0, 20.0, 8.0, 20.0, 28.0, 20.0, 15.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 10.0, 16.0, -2.0, -12.0, -2.0, 10.0, 10.0, 10.0, 0.0, -6.0, 19.0, 10.0, 20.0, 0.0, 50.0, 30.0, 20.0, -7.0, 10.0, 9.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 26.0, 10.0, 50.0, 2.0, 0.0, -50.0, 50.0, 47.0, 17.0, 27.0, -4.0, 70.0, 16.0, 30.0, 35.0, -19.0, 10.0, 30.0, -14.0, 20.0, -11.0, 20.0, 30.0, 0.0, -8.0, 10.0, 30.0, 90.0, 0.0, 3.0, 20.0, 20.0, 70.0, -26.0, 10.0, 30.0, 20.0, 6.0, -2.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 8.0, 16.0, 4.0, 10.0, 10.0, 0.0, 25.0, 19.0, 1.0, 40.0, 30.0, 10.0, 30.0, 39.0, 0.0, 50.0, 50.0, 30.0, 20.0, 20.0, 29.0, 40.0, 2.0, 8.0, -16.0, 70.0, 50.0, 60.0, -6.0, 16.0, 12.0, 20.0, 25.0, 0.0, 40.0, 60.0, 10.0, 10.0, -5.0, 45.0, 0.0, 10.0, 20.0, 6.0, 30.0, 20.0, 40.0, 20.0, -4.0, 0.0, 0.0, 30.0, 0.0, 10.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, -8.0, 40.0, 8.0, 50.0, 9.0, 10.0, 30.0, 0.0, -21.0, 7.0, -18.0, 40.0, 0.0, -9.0, 10.0, 0.0, 20.0, 50.0, 30.0, 20.0, 20.0, 40.0, 80.0, -2.0, 18.0, 90.0, 29.0, 25.0, 60.0, 50.0, 40.0, -7.0, 40.0, 20.0, 60.0, 5.0, 20.0, 0.0, -7.0, 10.0, 0.0, 4.0, 0.0, 14.0, 70.0, 40.0, 19.0, 0.0, -5.0, 10.0, 50.0, 32.0, 25.0, 10.0, 8.0, 10.0, 16.0, 50.0, -15.0, 20.0, 30.0, 10.0, 39.0, 20.0, 50.0, 60.0, 30.0, 40.0, 50.0, 18.0, -9.0, 20.0, 19.0, 0.0, 40.0, 2.0, 48.0, 60.0, 45.0, -3.0, 0.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, -2.0, 9.0, 9.0, 10.0, 4.0, 0.0, 20.0, 40.0, 9.0, 0.0, 20.0, 9.0, 5.0, 30.0, 20.0, 7.0, 5.0, 20.0, -5.0, 0.0, 10.0, -24.0, 30.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, -1.0, 10.0, 50.0, 40.0, -1.0, 20.0, 10.0, -2.0, 50.0, 10.0, 50.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 0.0, 90.0, 1.0, -15.0, 18.0, 19.0, 60.0, 0.0, 5.0, 20.0, -4.0, 40.0, 20.0, 0.0, 39.0, 18.0, 20.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 35.0, 8.0, 40.0, 20.0, 0.0, 10.0, 18.0, 0.0, -60.0, 20.0, 20.0, 50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.883421554515545, "mean_inference_ms": 1.9206806178562132, "mean_action_processing_ms": 0.6026073733272351, "mean_env_wait_ms": 1.733919240477106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0161588191986084, "StateBufferConnector_ms": 0.012316465377807617, "ViewRequirementAgentConnector_ms": 0.5673427581787109}, "num_episodes": 27, "episode_return_max": 410.0, "episode_return_min": -15.0, "episode_return_mean": 177.59}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.635026528046588, "num_env_steps_trained_throughput_per_sec": 18.635026528046588, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 211572.104, "restore_workers_time_ms": 0.013, "training_step_time_ms": 211572.053, "sample_time_ms": 3257.287, "learn_time_ms": 208294.771, "learn_throughput": 19.204, "synch_weights_time_ms": 12.478}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "a22d3_00000", "date": "2024-08-05_23-35-50", "timestamp": 1722915350, "time_this_iter_s": 214.6592767238617, "time_total_s": 3143.481385946274, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b9310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3143.481385946274, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 34.366447368421056, "ram_util_percent": 76.81052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2025977588563173, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.2166498922565365, "policy_loss": -0.011957522338386168, "vf_loss": 4.226878007989341, "vf_explained_var": -0.002746274092961678, "kl": 0.008647060900316542, "entropy": 1.2578844822379855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 410.0, "episode_reward_min": -15.0, "episode_reward_mean": 179.31, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 100.0}, "policy_reward_mean": {"policy_0": 17.931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.0, 223.0, 29.0, 260.0, 86.0, 96.0, 320.0, 284.0, 170.0, -15.0, 260.0, 244.0, 119.0, 275.0, 260.0, 65.0, 195.0, 120.0, 224.0, 61.0, 188.0, 120.0, 76.0, 118.0, 230.0, 129.0, 328.0, 196.0, 101.0, 214.0, 218.0, 61.0, 213.0, 247.0, 176.0, 60.0, 157.0, 200.0, 179.0, 152.0, 239.0, 146.0, 301.0, 199.0, 150.0, 193.0, 103.0, 186.0, 72.0, 185.0, 80.0, 123.0, 122.0, 138.0, 229.0, 107.0, 237.0, 108.0, 149.0, 308.0, 216.0, 195.0, 162.0, 210.0, 125.0, 143.0, 410.0, 181.0, 152.0, 206.0, 347.0, 222.0, 126.0, 117.0, 93.0, 199.0, 167.0, 233.0, 158.0, 245.0, 76.0, 289.0, 269.0, 264.0, 210.0, 183.0, 322.0, 123.0, 177.0, 229.0, 190.0, 255.0, 56.0, 167.0, 32.0, 236.0, 103.0, 225.0, 216.0, 179.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 30.0, 40.0, 30.0, -1.0, 30.0, 10.0, 10.0, 10.0, 7.0, 10.0, 10.0, 29.0, 20.0, 0.0, 20.0, 79.0, 38.0, -50.0, 15.0, -14.0, 0.0, 40.0, 26.0, -27.0, 20.0, 30.0, -11.0, 80.0, 20.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, -13.0, 35.0, -3.0, 17.0, 0.0, 0.0, 30.0, 20.0, 40.0, -2.0, 20.0, 3.0, -10.0, 20.0, 12.0, 10.0, 4.0, -1.0, 10.0, 20.0, 20.0, 60.0, 40.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 0.0, 30.0, 100.0, 20.0, 6.0, 60.0, 0.0, -2.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 20.0, -2.0, 2.0, 0.0, 5.0, -32.0, 0.0, 26.0, 10.0, -5.0, -19.0, 17.0, -3.0, 50.0, 20.0, -11.0, 20.0, 60.0, -13.0, 90.0, 30.0, 7.0, 50.0, 20.0, 40.0, 10.0, 0.0, 17.0, 20.0, 20.0, 60.0, 20.0, 10.0, 20.0, -20.0, -7.0, 40.0, 40.0, 30.0, -17.0, 3.0, 60.0, 10.0, 30.0, 60.0, 24.0, 0.0, 30.0, 21.0, 0.0, 40.0, 0.0, 50.0, 20.0, 50.0, 20.0, 30.0, 0.0, 20.0, 60.0, 10.0, 15.0, 8.0, 10.0, 1.0, 10.0, 16.0, 0.0, 10.0, -15.0, 10.0, 20.0, 20.0, 20.0, 0.0, 8.0, 10.0, 20.0, 20.0, 50.0, 27.0, -7.0, 6.0, 20.0, 10.0, 10.0, 20.0, 50.0, 17.0, -1.0, -5.0, -14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0, 10.0, 20.0, 6.0, 19.0, -10.0, -4.0, -6.0, -4.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 20.0, 3.0, -5.0, 20.0, 54.0, 6.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, -3.0, 17.0, 60.0, 20.0, -3.0, -5.0, 9.0, -18.0, -1.0, 10.0, 30.0, 7.0, 0.0, -4.0, 10.0, 38.0, 10.0, 9.0, 8.0, 0.0, 20.0, 40.0, 30.0, 20.0, 80.0, 10.0, 20.0, 0.0, 10.0, 0.0, 16.0, 20.0, 30.0, 47.0, 20.0, -5.0, 6.0, 10.0, -15.0, 10.0, 0.0, 40.0, 26.0, 40.0, 17.0, 89.0, 30.0, 80.0, -4.0, -1.0, 0.0, 20.0, 10.0, 28.0, 20.0, 30.0, 100.0, -10.0, -1.0, 20.0, 0.0, 10.0, 20.0, -9.0, 0.0, 40.0, -10.0, 10.0, 20.0, 30.0, 11.0, 0.0, 10.0, 70.0, 30.0, 30.0, -4.0, 7.0, 30.0, 10.0, 30.0, 20.0, 20.0, -1.0, 30.0, 0.0, 70.0, 40.0, -1.0, 0.0, 20.0, 0.0, -5.0, 0.0, -2.0, 0.0, 10.0, -2.0, 40.0, 10.0, 20.0, 7.0, 19.0, 9.0, 7.0, 100.0, 30.0, 15.0, -4.0, 20.0, 40.0, 30.0, -2.0, 0.0, 30.0, 40.0, 40.0, 19.0, 30.0, 30.0, 30.0, -2.0, 10.0, 20.0, 48.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0, -3.0, 10.0, 0.0, 4.0, 71.0, 40.0, 20.0, -10.0, 18.0, 50.0, 30.0, 30.0, 13.0, 35.0, 10.0, 0.0, 60.0, 10.0, -6.0, -3.0, 20.0, 19.0, 9.0, 20.0, 20.0, -12.0, 26.0, 10.0, 30.0, 10.0, 0.0, 9.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 12.0, 0.0, 3.0, -4.0, 15.0, 80.0, -3.0, 30.0, -5.0, 18.0, 70.0, 6.0, 30.0, 30.0, 35.0, 30.0, 20.0, 10.0, 50.0, 20.0, 9.0, 10.0, 40.0, -12.0, 60.0, 20.0, 9.0, 4.0, 30.0, 29.0, 24.0, 10.0, 15.0, 0.0, 10.0, 0.0, 70.0, 0.0, -9.0, 30.0, 10.0, 18.0, 29.0, 50.0, 20.0, 0.0, 10.0, 37.0, 0.0, 19.0, 20.0, 0.0, 15.0, 10.0, 16.0, -4.0, -4.0, 20.0, 30.0, 0.0, -5.0, 40.0, 10.0, 0.0, -2.0, 5.0, 40.0, 60.0, 8.0, 30.0, 18.0, -70.0, 30.0, -3.0, 30.0, 0.0, -11.0, 60.0, 8.0, 10.0, 20.0, 18.0, 16.0, 20.0, 8.0, 20.0, 28.0, 20.0, 15.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 10.0, 16.0, -2.0, -12.0, -2.0, 10.0, 10.0, 10.0, 0.0, -6.0, 19.0, 10.0, 20.0, 0.0, 50.0, 30.0, 20.0, -7.0, 10.0, 9.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 26.0, 10.0, 50.0, 2.0, 0.0, -50.0, 50.0, 47.0, 17.0, 27.0, -4.0, 70.0, 16.0, 30.0, 35.0, -19.0, 10.0, 30.0, -14.0, 20.0, -11.0, 20.0, 30.0, 0.0, -8.0, 10.0, 30.0, 90.0, 0.0, 3.0, 20.0, 20.0, 70.0, -26.0, 10.0, 30.0, 20.0, 6.0, -2.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 8.0, 16.0, 4.0, 10.0, 10.0, 0.0, 25.0, 19.0, 1.0, 40.0, 30.0, 10.0, 30.0, 39.0, 0.0, 50.0, 50.0, 30.0, 20.0, 20.0, 29.0, 40.0, 2.0, 8.0, -16.0, 70.0, 50.0, 60.0, -6.0, 16.0, 12.0, 20.0, 25.0, 0.0, 40.0, 60.0, 10.0, 10.0, -5.0, 45.0, 0.0, 10.0, 20.0, 6.0, 30.0, 20.0, 40.0, 20.0, -4.0, 0.0, 0.0, 30.0, 0.0, 10.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, -8.0, 40.0, 8.0, 50.0, 9.0, 10.0, 30.0, 0.0, -21.0, 7.0, -18.0, 40.0, 0.0, -9.0, 10.0, 0.0, 20.0, 50.0, 30.0, 20.0, 20.0, 40.0, 80.0, -2.0, 18.0, 90.0, 29.0, 25.0, 60.0, 50.0, 40.0, -7.0, 40.0, 20.0, 60.0, 5.0, 20.0, 0.0, -7.0, 10.0, 0.0, 4.0, 0.0, 14.0, 70.0, 40.0, 19.0, 0.0, -5.0, 10.0, 50.0, 32.0, 25.0, 10.0, 8.0, 10.0, 16.0, 50.0, -15.0, 20.0, 30.0, 10.0, 39.0, 20.0, 50.0, 60.0, 30.0, 40.0, 50.0, 18.0, -9.0, 20.0, 19.0, 0.0, 40.0, 2.0, 48.0, 60.0, 45.0, -3.0, 0.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, -2.0, 9.0, 9.0, 10.0, 4.0, 0.0, 20.0, 40.0, 9.0, 0.0, 20.0, 9.0, 5.0, 30.0, 20.0, 7.0, 5.0, 20.0, -5.0, 0.0, 10.0, -24.0, 30.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, -1.0, 10.0, 50.0, 40.0, -1.0, 20.0, 10.0, -2.0, 50.0, 10.0, 50.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 0.0, 90.0, 1.0, -15.0, 18.0, 19.0, 60.0, 0.0, 5.0, 20.0, -4.0, 40.0, 20.0, 0.0, 39.0, 18.0, 20.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 35.0, 8.0, 40.0, 20.0, 0.0, 10.0, 18.0, 0.0, -60.0, 20.0, 20.0, 50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0, 30.0, 37.0, 20.0, 10.0, 60.0, 10.0, 20.0, 5.0, 17.0, 60.0, 20.0, 20.0, 90.0, 49.0, 20.0, 20.0, 20.0, 20.0, 5.0, 0.0, 20.0, 10.0, 40.0, 30.0, 50.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 40.0, 0.0, 19.0, 26.0, 30.0, 8.0, 19.0, 38.0, 30.0, 40.0, 30.0, 30.0, 20.0, 20.0, 55.0, 40.0, -3.0, 0.0, -4.0, 0.0, 30.0, 10.0, 10.0, 30.0, 50.0, 0.0, -35.0, 10.0, 48.0, 10.0, 10.0, 60.0, 0.0, 25.0, 19.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, 19.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 10.0, 13.0, 30.0, 30.0, 20.0, 10.0, 0.0, 7.0, 20.0, 0.0, 62.0, 3.0, 40.0, 20.0, -10.0, 50.0, 10.0, 60.0, 4.0, -1.0, 2.0, 1.0, 7.0, 20.0, 0.0, -1.0, 17.0, 7.0, 19.0, -9.0, -19.0, 40.0, -10.0, 20.0, 89.0, 39.0, 0.0, -2.0, 5.0, 5.0, -5.0, 10.0, 30.0, 19.0, 30.0, -65.0, -7.0, 10.0, -25.0, 20.0, 40.0, 20.0, 10.0, 20.0, 16.0, 35.0, 30.0, 70.0, 30.0, 15.0, -11.0, 15.0, 20.0, -1.0, -2.0, 35.0, 7.0, -5.0, 20.0, 20.0, 50.0, 20.0, 50.0, 20.0, 20.0, 0.0, 5.0, 20.0, 40.0, 18.0, 14.0, 20.0, 14.0, 28.0, 40.0, 6.0, 34.0, 2.0, 30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8778329671290441, "mean_inference_ms": 1.9207710774406184, "mean_action_processing_ms": 0.6010286260557822, "mean_env_wait_ms": 1.7285053451958232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015098094940185547, "StateBufferConnector_ms": 0.011858463287353516, "ViewRequirementAgentConnector_ms": 0.5431861877441406}, "num_episodes": 18, "episode_return_max": 410.0, "episode_return_min": -15.0, "episode_return_mean": 179.31}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.65329662008896, "num_env_steps_trained_throughput_per_sec": 18.65329662008896, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 212008.167, "restore_workers_time_ms": 0.013, "training_step_time_ms": 212008.116, "sample_time_ms": 3209.929, "learn_time_ms": 208778.044, "learn_throughput": 19.159, "synch_weights_time_ms": 12.609}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "a22d3_00000", "date": "2024-08-05_23-39-25", "timestamp": 1722915565, "time_this_iter_s": 214.44891619682312, "time_total_s": 3357.930302143097, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01ba790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3357.930302143097, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.68118811881189, "ram_util_percent": 76.77359735973597}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.570512545807039, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.007017803192139, "policy_loss": -0.011920452670588954, "vf_loss": 4.01712261909367, "vf_explained_var": 0.01591189153912984, "kl": 0.009078170560355227, "entropy": 1.2417824647677973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 410.0, "episode_reward_min": 32.0, "episode_reward_mean": 185.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 100.0}, "policy_reward_mean": {"policy_0": 18.546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [224.0, 61.0, 188.0, 120.0, 76.0, 118.0, 230.0, 129.0, 328.0, 196.0, 101.0, 214.0, 218.0, 61.0, 213.0, 247.0, 176.0, 60.0, 157.0, 200.0, 179.0, 152.0, 239.0, 146.0, 301.0, 199.0, 150.0, 193.0, 103.0, 186.0, 72.0, 185.0, 80.0, 123.0, 122.0, 138.0, 229.0, 107.0, 237.0, 108.0, 149.0, 308.0, 216.0, 195.0, 162.0, 210.0, 125.0, 143.0, 410.0, 181.0, 152.0, 206.0, 347.0, 222.0, 126.0, 117.0, 93.0, 199.0, 167.0, 233.0, 158.0, 245.0, 76.0, 289.0, 269.0, 264.0, 210.0, 183.0, 322.0, 123.0, 177.0, 229.0, 190.0, 255.0, 56.0, 167.0, 32.0, 236.0, 103.0, 225.0, 216.0, 179.0, 225.0, 286.0, 197.0, 340.0, 155.0, 170.0, 164.0, 335.0, 337.0, 301.0, 180.0, 152.0, 163.0, 164.0, 92.0, 221.0, 134.0, 199.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-14.0, -1.0, -3.0, 40.0, 20.0, 80.0, 32.0, 40.0, 30.0, 0.0, 10.0, 20.0, 6.0, 19.0, -10.0, -4.0, -6.0, -4.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 20.0, 3.0, -5.0, 20.0, 54.0, 6.0, 30.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, -3.0, 17.0, 60.0, 20.0, -3.0, -5.0, 9.0, -18.0, -1.0, 10.0, 30.0, 7.0, 0.0, -4.0, 10.0, 38.0, 10.0, 9.0, 8.0, 0.0, 20.0, 40.0, 30.0, 20.0, 80.0, 10.0, 20.0, 0.0, 10.0, 0.0, 16.0, 20.0, 30.0, 47.0, 20.0, -5.0, 6.0, 10.0, -15.0, 10.0, 0.0, 40.0, 26.0, 40.0, 17.0, 89.0, 30.0, 80.0, -4.0, -1.0, 0.0, 20.0, 10.0, 28.0, 20.0, 30.0, 100.0, -10.0, -1.0, 20.0, 0.0, 10.0, 20.0, -9.0, 0.0, 40.0, -10.0, 10.0, 20.0, 30.0, 11.0, 0.0, 10.0, 70.0, 30.0, 30.0, -4.0, 7.0, 30.0, 10.0, 30.0, 20.0, 20.0, -1.0, 30.0, 0.0, 70.0, 40.0, -1.0, 0.0, 20.0, 0.0, -5.0, 0.0, -2.0, 0.0, 10.0, -2.0, 40.0, 10.0, 20.0, 7.0, 19.0, 9.0, 7.0, 100.0, 30.0, 15.0, -4.0, 20.0, 40.0, 30.0, -2.0, 0.0, 30.0, 40.0, 40.0, 19.0, 30.0, 30.0, 30.0, -2.0, 10.0, 20.0, 48.0, 0.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0, -3.0, 10.0, 0.0, 4.0, 71.0, 40.0, 20.0, -10.0, 18.0, 50.0, 30.0, 30.0, 13.0, 35.0, 10.0, 0.0, 60.0, 10.0, -6.0, -3.0, 20.0, 19.0, 9.0, 20.0, 20.0, -12.0, 26.0, 10.0, 30.0, 10.0, 0.0, 9.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 12.0, 0.0, 3.0, -4.0, 15.0, 80.0, -3.0, 30.0, -5.0, 18.0, 70.0, 6.0, 30.0, 30.0, 35.0, 30.0, 20.0, 10.0, 50.0, 20.0, 9.0, 10.0, 40.0, -12.0, 60.0, 20.0, 9.0, 4.0, 30.0, 29.0, 24.0, 10.0, 15.0, 0.0, 10.0, 0.0, 70.0, 0.0, -9.0, 30.0, 10.0, 18.0, 29.0, 50.0, 20.0, 0.0, 10.0, 37.0, 0.0, 19.0, 20.0, 0.0, 15.0, 10.0, 16.0, -4.0, -4.0, 20.0, 30.0, 0.0, -5.0, 40.0, 10.0, 0.0, -2.0, 5.0, 40.0, 60.0, 8.0, 30.0, 18.0, -70.0, 30.0, -3.0, 30.0, 0.0, -11.0, 60.0, 8.0, 10.0, 20.0, 18.0, 16.0, 20.0, 8.0, 20.0, 28.0, 20.0, 15.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 10.0, 16.0, -2.0, -12.0, -2.0, 10.0, 10.0, 10.0, 0.0, -6.0, 19.0, 10.0, 20.0, 0.0, 50.0, 30.0, 20.0, -7.0, 10.0, 9.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 26.0, 10.0, 50.0, 2.0, 0.0, -50.0, 50.0, 47.0, 17.0, 27.0, -4.0, 70.0, 16.0, 30.0, 35.0, -19.0, 10.0, 30.0, -14.0, 20.0, -11.0, 20.0, 30.0, 0.0, -8.0, 10.0, 30.0, 90.0, 0.0, 3.0, 20.0, 20.0, 70.0, -26.0, 10.0, 30.0, 20.0, 6.0, -2.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 8.0, 16.0, 4.0, 10.0, 10.0, 0.0, 25.0, 19.0, 1.0, 40.0, 30.0, 10.0, 30.0, 39.0, 0.0, 50.0, 50.0, 30.0, 20.0, 20.0, 29.0, 40.0, 2.0, 8.0, -16.0, 70.0, 50.0, 60.0, -6.0, 16.0, 12.0, 20.0, 25.0, 0.0, 40.0, 60.0, 10.0, 10.0, -5.0, 45.0, 0.0, 10.0, 20.0, 6.0, 30.0, 20.0, 40.0, 20.0, -4.0, 0.0, 0.0, 30.0, 0.0, 10.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, -8.0, 40.0, 8.0, 50.0, 9.0, 10.0, 30.0, 0.0, -21.0, 7.0, -18.0, 40.0, 0.0, -9.0, 10.0, 0.0, 20.0, 50.0, 30.0, 20.0, 20.0, 40.0, 80.0, -2.0, 18.0, 90.0, 29.0, 25.0, 60.0, 50.0, 40.0, -7.0, 40.0, 20.0, 60.0, 5.0, 20.0, 0.0, -7.0, 10.0, 0.0, 4.0, 0.0, 14.0, 70.0, 40.0, 19.0, 0.0, -5.0, 10.0, 50.0, 32.0, 25.0, 10.0, 8.0, 10.0, 16.0, 50.0, -15.0, 20.0, 30.0, 10.0, 39.0, 20.0, 50.0, 60.0, 30.0, 40.0, 50.0, 18.0, -9.0, 20.0, 19.0, 0.0, 40.0, 2.0, 48.0, 60.0, 45.0, -3.0, 0.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, -2.0, 9.0, 9.0, 10.0, 4.0, 0.0, 20.0, 40.0, 9.0, 0.0, 20.0, 9.0, 5.0, 30.0, 20.0, 7.0, 5.0, 20.0, -5.0, 0.0, 10.0, -24.0, 30.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, -1.0, 10.0, 50.0, 40.0, -1.0, 20.0, 10.0, -2.0, 50.0, 10.0, 50.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 0.0, 90.0, 1.0, -15.0, 18.0, 19.0, 60.0, 0.0, 5.0, 20.0, -4.0, 40.0, 20.0, 0.0, 39.0, 18.0, 20.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 35.0, 8.0, 40.0, 20.0, 0.0, 10.0, 18.0, 0.0, -60.0, 20.0, 20.0, 50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0, 30.0, 37.0, 20.0, 10.0, 60.0, 10.0, 20.0, 5.0, 17.0, 60.0, 20.0, 20.0, 90.0, 49.0, 20.0, 20.0, 20.0, 20.0, 5.0, 0.0, 20.0, 10.0, 40.0, 30.0, 50.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 40.0, 0.0, 19.0, 26.0, 30.0, 8.0, 19.0, 38.0, 30.0, 40.0, 30.0, 30.0, 20.0, 20.0, 55.0, 40.0, -3.0, 0.0, -4.0, 0.0, 30.0, 10.0, 10.0, 30.0, 50.0, 0.0, -35.0, 10.0, 48.0, 10.0, 10.0, 60.0, 0.0, 25.0, 19.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, 19.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 10.0, 13.0, 30.0, 30.0, 20.0, 10.0, 0.0, 7.0, 20.0, 0.0, 62.0, 3.0, 40.0, 20.0, -10.0, 50.0, 10.0, 60.0, 4.0, -1.0, 2.0, 1.0, 7.0, 20.0, 0.0, -1.0, 17.0, 7.0, 19.0, -9.0, -19.0, 40.0, -10.0, 20.0, 89.0, 39.0, 0.0, -2.0, 5.0, 5.0, -5.0, 10.0, 30.0, 19.0, 30.0, -65.0, -7.0, 10.0, -25.0, 20.0, 40.0, 20.0, 10.0, 20.0, 16.0, 35.0, 30.0, 70.0, 30.0, 15.0, -11.0, 15.0, 20.0, -1.0, -2.0, 35.0, 7.0, -5.0, 20.0, 20.0, 50.0, 20.0, 50.0, 20.0, 20.0, 0.0, 5.0, 20.0, 40.0, 18.0, 14.0, 20.0, 14.0, 28.0, 40.0, 6.0, 34.0, 2.0, 30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 80.0, -18.0, 20.0, 13.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 28.0, 18.0, 40.0, 20.0, 20.0, 20.0, 60.0, 10.0, 60.0, 14.0, 30.0, 30.0, 0.0, 0.0, 30.0, 13.0, 60.0, 20.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 50.0, 60.0, 0.0, 40.0, 30.0, 18.0, 0.0, 0.0, 10.0, 0.0, 7.0, 30.0, 20.0, -3.0, 12.0, 0.0, 70.0, 10.0, 10.0, 17.0, 40.0, 6.0, 8.0, 10.0, 18.0, 7.0, 50.0, 19.0, 20.0, 7.0, 20.0, -7.0, 20.0, 5.0, 49.0, 20.0, 0.0, 10.0, 57.0, 60.0, 60.0, 64.0, 10.0, 30.0, 0.0, 45.0, 0.0, 25.0, 80.0, 70.0, 37.0, 20.0, 30.0, 60.0, 23.0, 80.0, 10.0, 30.0, 0.0, 18.0, 0.0, 80.0, 0.0, 30.0, 39.0, -2.0, 38.0, 20.0, -13.0, 60.0, 29.0, -2.0, -19.0, 4.0, 40.0, 6.0, -6.0, 50.0, 11.0, 30.0, -12.0, 26.0, 3.0, 20.0, 40.0, -6.0, 0.0, 28.0, 20.0, 20.0, -2.0, 30.0, 13.0, -9.0, 10.0, 20.0, -23.0, 10.0, 50.0, 39.0, 20.0, 50.0, -3.0, -7.0, 0.0, 8.0, 10.0, 28.0, 26.0, -1.0, 6.0, -5.0, 27.0, 0.0, -3.0, 80.0, 20.0, -11.0, 30.0, 60.0, 50.0, -5.0, 0.0, 22.0, 0.0, 0.0, 11.0, 18.0, 10.0, 18.0, 0.0, 28.0, 27.0, 29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8699286978747705, "mean_inference_ms": 1.9186202668793157, "mean_action_processing_ms": 0.5996247900700683, "mean_env_wait_ms": 1.7225876973218361, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015666723251342773, "StateBufferConnector_ms": 0.012206315994262695, "ViewRequirementAgentConnector_ms": 0.5302839279174805}, "num_episodes": 18, "episode_return_max": 410.0, "episode_return_min": 32.0, "episode_return_mean": 185.46}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.58017923605331, "num_env_steps_trained_throughput_per_sec": 18.58017923605331, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 212571.796, "restore_workers_time_ms": 0.013, "training_step_time_ms": 212571.746, "sample_time_ms": 3202.055, "learn_time_ms": 209348.426, "learn_throughput": 19.107, "synch_weights_time_ms": 13.017}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "a22d3_00000", "date": "2024-08-05_23-43-00", "timestamp": 1722915780, "time_this_iter_s": 215.29949593544006, "time_total_s": 3573.229798078537, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3573.229798078537, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 35.109836065573774, "ram_util_percent": 76.91344262295081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8736009898277137, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9717642900915826, "policy_loss": -0.011368427712954304, "vf_loss": 3.9814773050994794, "vf_explained_var": 0.018184592174138, "kl": 0.008277050353606824, "entropy": 1.2329505512381769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 410.0, "episode_reward_min": 32.0, "episode_reward_mean": 192.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 100.0}, "policy_reward_mean": {"policy_0": 19.238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 200.0, 179.0, 152.0, 239.0, 146.0, 301.0, 199.0, 150.0, 193.0, 103.0, 186.0, 72.0, 185.0, 80.0, 123.0, 122.0, 138.0, 229.0, 107.0, 237.0, 108.0, 149.0, 308.0, 216.0, 195.0, 162.0, 210.0, 125.0, 143.0, 410.0, 181.0, 152.0, 206.0, 347.0, 222.0, 126.0, 117.0, 93.0, 199.0, 167.0, 233.0, 158.0, 245.0, 76.0, 289.0, 269.0, 264.0, 210.0, 183.0, 322.0, 123.0, 177.0, 229.0, 190.0, 255.0, 56.0, 167.0, 32.0, 236.0, 103.0, 225.0, 216.0, 179.0, 225.0, 286.0, 197.0, 340.0, 155.0, 170.0, 164.0, 335.0, 337.0, 301.0, 180.0, 152.0, 163.0, 164.0, 92.0, 221.0, 134.0, 199.0, 322.0, 304.0, 107.0, 227.0, 181.0, 291.0, 166.0, 67.0, 95.0, 146.0, 150.0, 217.0, 311.0, 265.0, 186.0, 221.0, 155.0, 241.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 0.0, 0.0, 30.0, -3.0, 0.0, 40.0, -10.0, 30.0, 20.0, -3.0, 10.0, 0.0, 4.0, 71.0, 40.0, 20.0, -10.0, 18.0, 50.0, 30.0, 30.0, 13.0, 35.0, 10.0, 0.0, 60.0, 10.0, -6.0, -3.0, 20.0, 19.0, 9.0, 20.0, 20.0, -12.0, 26.0, 10.0, 30.0, 10.0, 0.0, 9.0, 30.0, 30.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 12.0, 0.0, 3.0, -4.0, 15.0, 80.0, -3.0, 30.0, -5.0, 18.0, 70.0, 6.0, 30.0, 30.0, 35.0, 30.0, 20.0, 10.0, 50.0, 20.0, 9.0, 10.0, 40.0, -12.0, 60.0, 20.0, 9.0, 4.0, 30.0, 29.0, 24.0, 10.0, 15.0, 0.0, 10.0, 0.0, 70.0, 0.0, -9.0, 30.0, 10.0, 18.0, 29.0, 50.0, 20.0, 0.0, 10.0, 37.0, 0.0, 19.0, 20.0, 0.0, 15.0, 10.0, 16.0, -4.0, -4.0, 20.0, 30.0, 0.0, -5.0, 40.0, 10.0, 0.0, -2.0, 5.0, 40.0, 60.0, 8.0, 30.0, 18.0, -70.0, 30.0, -3.0, 30.0, 0.0, -11.0, 60.0, 8.0, 10.0, 20.0, 18.0, 16.0, 20.0, 8.0, 20.0, 28.0, 20.0, 15.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 10.0, 16.0, -2.0, -12.0, -2.0, 10.0, 10.0, 10.0, 0.0, -6.0, 19.0, 10.0, 20.0, 0.0, 50.0, 30.0, 20.0, -7.0, 10.0, 9.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 26.0, 10.0, 50.0, 2.0, 0.0, -50.0, 50.0, 47.0, 17.0, 27.0, -4.0, 70.0, 16.0, 30.0, 35.0, -19.0, 10.0, 30.0, -14.0, 20.0, -11.0, 20.0, 30.0, 0.0, -8.0, 10.0, 30.0, 90.0, 0.0, 3.0, 20.0, 20.0, 70.0, -26.0, 10.0, 30.0, 20.0, 6.0, -2.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 8.0, 16.0, 4.0, 10.0, 10.0, 0.0, 25.0, 19.0, 1.0, 40.0, 30.0, 10.0, 30.0, 39.0, 0.0, 50.0, 50.0, 30.0, 20.0, 20.0, 29.0, 40.0, 2.0, 8.0, -16.0, 70.0, 50.0, 60.0, -6.0, 16.0, 12.0, 20.0, 25.0, 0.0, 40.0, 60.0, 10.0, 10.0, -5.0, 45.0, 0.0, 10.0, 20.0, 6.0, 30.0, 20.0, 40.0, 20.0, -4.0, 0.0, 0.0, 30.0, 0.0, 10.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, -8.0, 40.0, 8.0, 50.0, 9.0, 10.0, 30.0, 0.0, -21.0, 7.0, -18.0, 40.0, 0.0, -9.0, 10.0, 0.0, 20.0, 50.0, 30.0, 20.0, 20.0, 40.0, 80.0, -2.0, 18.0, 90.0, 29.0, 25.0, 60.0, 50.0, 40.0, -7.0, 40.0, 20.0, 60.0, 5.0, 20.0, 0.0, -7.0, 10.0, 0.0, 4.0, 0.0, 14.0, 70.0, 40.0, 19.0, 0.0, -5.0, 10.0, 50.0, 32.0, 25.0, 10.0, 8.0, 10.0, 16.0, 50.0, -15.0, 20.0, 30.0, 10.0, 39.0, 20.0, 50.0, 60.0, 30.0, 40.0, 50.0, 18.0, -9.0, 20.0, 19.0, 0.0, 40.0, 2.0, 48.0, 60.0, 45.0, -3.0, 0.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, -2.0, 9.0, 9.0, 10.0, 4.0, 0.0, 20.0, 40.0, 9.0, 0.0, 20.0, 9.0, 5.0, 30.0, 20.0, 7.0, 5.0, 20.0, -5.0, 0.0, 10.0, -24.0, 30.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, -1.0, 10.0, 50.0, 40.0, -1.0, 20.0, 10.0, -2.0, 50.0, 10.0, 50.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 0.0, 90.0, 1.0, -15.0, 18.0, 19.0, 60.0, 0.0, 5.0, 20.0, -4.0, 40.0, 20.0, 0.0, 39.0, 18.0, 20.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 35.0, 8.0, 40.0, 20.0, 0.0, 10.0, 18.0, 0.0, -60.0, 20.0, 20.0, 50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0, 30.0, 37.0, 20.0, 10.0, 60.0, 10.0, 20.0, 5.0, 17.0, 60.0, 20.0, 20.0, 90.0, 49.0, 20.0, 20.0, 20.0, 20.0, 5.0, 0.0, 20.0, 10.0, 40.0, 30.0, 50.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 40.0, 0.0, 19.0, 26.0, 30.0, 8.0, 19.0, 38.0, 30.0, 40.0, 30.0, 30.0, 20.0, 20.0, 55.0, 40.0, -3.0, 0.0, -4.0, 0.0, 30.0, 10.0, 10.0, 30.0, 50.0, 0.0, -35.0, 10.0, 48.0, 10.0, 10.0, 60.0, 0.0, 25.0, 19.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, 19.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 10.0, 13.0, 30.0, 30.0, 20.0, 10.0, 0.0, 7.0, 20.0, 0.0, 62.0, 3.0, 40.0, 20.0, -10.0, 50.0, 10.0, 60.0, 4.0, -1.0, 2.0, 1.0, 7.0, 20.0, 0.0, -1.0, 17.0, 7.0, 19.0, -9.0, -19.0, 40.0, -10.0, 20.0, 89.0, 39.0, 0.0, -2.0, 5.0, 5.0, -5.0, 10.0, 30.0, 19.0, 30.0, -65.0, -7.0, 10.0, -25.0, 20.0, 40.0, 20.0, 10.0, 20.0, 16.0, 35.0, 30.0, 70.0, 30.0, 15.0, -11.0, 15.0, 20.0, -1.0, -2.0, 35.0, 7.0, -5.0, 20.0, 20.0, 50.0, 20.0, 50.0, 20.0, 20.0, 0.0, 5.0, 20.0, 40.0, 18.0, 14.0, 20.0, 14.0, 28.0, 40.0, 6.0, 34.0, 2.0, 30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 80.0, -18.0, 20.0, 13.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 28.0, 18.0, 40.0, 20.0, 20.0, 20.0, 60.0, 10.0, 60.0, 14.0, 30.0, 30.0, 0.0, 0.0, 30.0, 13.0, 60.0, 20.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 50.0, 60.0, 0.0, 40.0, 30.0, 18.0, 0.0, 0.0, 10.0, 0.0, 7.0, 30.0, 20.0, -3.0, 12.0, 0.0, 70.0, 10.0, 10.0, 17.0, 40.0, 6.0, 8.0, 10.0, 18.0, 7.0, 50.0, 19.0, 20.0, 7.0, 20.0, -7.0, 20.0, 5.0, 49.0, 20.0, 0.0, 10.0, 57.0, 60.0, 60.0, 64.0, 10.0, 30.0, 0.0, 45.0, 0.0, 25.0, 80.0, 70.0, 37.0, 20.0, 30.0, 60.0, 23.0, 80.0, 10.0, 30.0, 0.0, 18.0, 0.0, 80.0, 0.0, 30.0, 39.0, -2.0, 38.0, 20.0, -13.0, 60.0, 29.0, -2.0, -19.0, 4.0, 40.0, 6.0, -6.0, 50.0, 11.0, 30.0, -12.0, 26.0, 3.0, 20.0, 40.0, -6.0, 0.0, 28.0, 20.0, 20.0, -2.0, 30.0, 13.0, -9.0, 10.0, 20.0, -23.0, 10.0, 50.0, 39.0, 20.0, 50.0, -3.0, -7.0, 0.0, 8.0, 10.0, 28.0, 26.0, -1.0, 6.0, -5.0, 27.0, 0.0, -3.0, 80.0, 20.0, -11.0, 30.0, 60.0, 50.0, -5.0, 0.0, 22.0, 0.0, 0.0, 11.0, 18.0, 10.0, 18.0, 0.0, 28.0, 27.0, 29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0, 90.0, 9.0, 10.0, 30.0, 35.0, 40.0, 28.0, 20.0, 40.0, 20.0, 20.0, 30.0, 50.0, 0.0, 20.0, 60.0, 20.0, 19.0, 80.0, 5.0, 16.0, 20.0, -1.0, 9.0, 40.0, 0.0, 0.0, 3.0, 0.0, 20.0, -1.0, 19.0, 19.0, 19.0, 80.0, 0.0, 10.0, 40.0, -4.0, 45.0, 20.0, 18.0, 10.0, 30.0, -7.0, 7.0, 40.0, 20.0, 40.0, 3.0, 15.0, 10.0, 40.0, 0.0, -2.0, 70.0, 30.0, 30.0, 28.0, 70.0, -5.0, -6.0, 40.0, 40.0, 20.0, 0.0, 10.0, 20.0, 7.0, 40.0, 10.0, 26.0, 8.0, 0.0, 24.0, 0.0, -11.0, -25.0, 37.0, -2.0, 5.0, -1.0, 0.0, 0.0, -7.0, 0.0, 20.0, 60.0, 8.0, 10.0, 13.0, 10.0, 10.0, 9.0, 0.0, -9.0, 20.0, -6.0, -1.0, 100.0, -5.0, 20.0, 10.0, 10.0, -13.0, 10.0, 50.0, 10.0, 60.0, -2.0, 31.0, 37.0, -6.0, 30.0, 20.0, 16.0, 30.0, 40.0, -1.0, 20.0, -14.0, 7.0, 40.0, 60.0, 70.0, 40.0, -1.0, 69.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 15.0, 30.0, 60.0, 0.0, 50.0, 20.0, 3.0, 50.0, 20.0, 40.0, 10.0, 20.0, 0.0, -6.0, 29.0, 20.0, 0.0, 20.0, 5.0, 26.0, 30.0, 60.0, 0.0, 30.0, 50.0, 0.0, 40.0, 7.0, 18.0, 20.0, -15.0, 40.0, 0.0, 20.0, 20.0, 5.0, 27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8612239343111794, "mean_inference_ms": 1.9186421919080414, "mean_action_processing_ms": 0.5985127449125599, "mean_env_wait_ms": 1.7176824941921962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01721978187561035, "StateBufferConnector_ms": 0.012692689895629883, "ViewRequirementAgentConnector_ms": 0.5286149978637695}, "num_episodes": 18, "episode_return_max": 410.0, "episode_return_min": 32.0, "episode_return_mean": 192.38}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.29870471389975, "num_env_steps_trained_throughput_per_sec": 18.29870471389975, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 213515.177, "restore_workers_time_ms": 0.013, "training_step_time_ms": 213515.126, "sample_time_ms": 3121.33, "learn_time_ms": 210370.678, "learn_throughput": 19.014, "synch_weights_time_ms": 14.816}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "a22d3_00000", "date": "2024-08-05_23-46-39", "timestamp": 1722915999, "time_this_iter_s": 218.60179495811462, "time_total_s": 3791.8315930366516, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01cb820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3791.8315930366516, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 38.947249190938514, "ram_util_percent": 80.45307443365695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5278944233228096, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.142940124510703, "policy_loss": -0.01155531425971272, "vf_loss": 4.152706645370419, "vf_explained_var": 0.016903654727945947, "kl": 0.00894396206369742, "entropy": 1.2366885964989789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 415.0, "episode_reward_min": 32.0, "episode_reward_mean": 202.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 100.0}, "policy_reward_mean": {"policy_0": 20.256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [149.0, 308.0, 216.0, 195.0, 162.0, 210.0, 125.0, 143.0, 410.0, 181.0, 152.0, 206.0, 347.0, 222.0, 126.0, 117.0, 93.0, 199.0, 167.0, 233.0, 158.0, 245.0, 76.0, 289.0, 269.0, 264.0, 210.0, 183.0, 322.0, 123.0, 177.0, 229.0, 190.0, 255.0, 56.0, 167.0, 32.0, 236.0, 103.0, 225.0, 216.0, 179.0, 225.0, 286.0, 197.0, 340.0, 155.0, 170.0, 164.0, 335.0, 337.0, 301.0, 180.0, 152.0, 163.0, 164.0, 92.0, 221.0, 134.0, 199.0, 322.0, 304.0, 107.0, 227.0, 181.0, 291.0, 166.0, 67.0, 95.0, 146.0, 150.0, 217.0, 311.0, 265.0, 186.0, 221.0, 155.0, 241.0, 225.0, 268.0, 314.0, 144.0, 194.0, 282.0, 196.0, 227.0, 415.0, 194.0, 74.0, 229.0, 278.0, 186.0, 192.0, 243.0, 266.0, 129.0, 86.0, 346.0, 79.0, 57.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [4.0, 10.0, 10.0, 0.0, 25.0, 19.0, 1.0, 40.0, 30.0, 10.0, 30.0, 39.0, 0.0, 50.0, 50.0, 30.0, 20.0, 20.0, 29.0, 40.0, 2.0, 8.0, -16.0, 70.0, 50.0, 60.0, -6.0, 16.0, 12.0, 20.0, 25.0, 0.0, 40.0, 60.0, 10.0, 10.0, -5.0, 45.0, 0.0, 10.0, 20.0, 6.0, 30.0, 20.0, 40.0, 20.0, -4.0, 0.0, 0.0, 30.0, 0.0, 10.0, 80.0, 30.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, -8.0, 40.0, 8.0, 50.0, 9.0, 10.0, 30.0, 0.0, -21.0, 7.0, -18.0, 40.0, 0.0, -9.0, 10.0, 0.0, 20.0, 50.0, 30.0, 20.0, 20.0, 40.0, 80.0, -2.0, 18.0, 90.0, 29.0, 25.0, 60.0, 50.0, 40.0, -7.0, 40.0, 20.0, 60.0, 5.0, 20.0, 0.0, -7.0, 10.0, 0.0, 4.0, 0.0, 14.0, 70.0, 40.0, 19.0, 0.0, -5.0, 10.0, 50.0, 32.0, 25.0, 10.0, 8.0, 10.0, 16.0, 50.0, -15.0, 20.0, 30.0, 10.0, 39.0, 20.0, 50.0, 60.0, 30.0, 40.0, 50.0, 18.0, -9.0, 20.0, 19.0, 0.0, 40.0, 2.0, 48.0, 60.0, 45.0, -3.0, 0.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, -2.0, 9.0, 9.0, 10.0, 4.0, 0.0, 20.0, 40.0, 9.0, 0.0, 20.0, 9.0, 5.0, 30.0, 20.0, 7.0, 5.0, 20.0, -5.0, 0.0, 10.0, -24.0, 30.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, -1.0, 10.0, 50.0, 40.0, -1.0, 20.0, 10.0, -2.0, 50.0, 10.0, 50.0, 10.0, 10.0, 10.0, 20.0, 40.0, 0.0, 0.0, 90.0, 1.0, -15.0, 18.0, 19.0, 60.0, 0.0, 5.0, 20.0, -4.0, 40.0, 20.0, 0.0, 39.0, 18.0, 20.0, 10.0, 60.0, 20.0, 40.0, 20.0, 30.0, 10.0, 10.0, 10.0, 35.0, 8.0, 40.0, 20.0, 0.0, 10.0, 18.0, 0.0, -60.0, 20.0, 20.0, 50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0, 30.0, 37.0, 20.0, 10.0, 60.0, 10.0, 20.0, 5.0, 17.0, 60.0, 20.0, 20.0, 90.0, 49.0, 20.0, 20.0, 20.0, 20.0, 5.0, 0.0, 20.0, 10.0, 40.0, 30.0, 50.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 40.0, 0.0, 19.0, 26.0, 30.0, 8.0, 19.0, 38.0, 30.0, 40.0, 30.0, 30.0, 20.0, 20.0, 55.0, 40.0, -3.0, 0.0, -4.0, 0.0, 30.0, 10.0, 10.0, 30.0, 50.0, 0.0, -35.0, 10.0, 48.0, 10.0, 10.0, 60.0, 0.0, 25.0, 19.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, 19.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 10.0, 13.0, 30.0, 30.0, 20.0, 10.0, 0.0, 7.0, 20.0, 0.0, 62.0, 3.0, 40.0, 20.0, -10.0, 50.0, 10.0, 60.0, 4.0, -1.0, 2.0, 1.0, 7.0, 20.0, 0.0, -1.0, 17.0, 7.0, 19.0, -9.0, -19.0, 40.0, -10.0, 20.0, 89.0, 39.0, 0.0, -2.0, 5.0, 5.0, -5.0, 10.0, 30.0, 19.0, 30.0, -65.0, -7.0, 10.0, -25.0, 20.0, 40.0, 20.0, 10.0, 20.0, 16.0, 35.0, 30.0, 70.0, 30.0, 15.0, -11.0, 15.0, 20.0, -1.0, -2.0, 35.0, 7.0, -5.0, 20.0, 20.0, 50.0, 20.0, 50.0, 20.0, 20.0, 0.0, 5.0, 20.0, 40.0, 18.0, 14.0, 20.0, 14.0, 28.0, 40.0, 6.0, 34.0, 2.0, 30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 80.0, -18.0, 20.0, 13.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 28.0, 18.0, 40.0, 20.0, 20.0, 20.0, 60.0, 10.0, 60.0, 14.0, 30.0, 30.0, 0.0, 0.0, 30.0, 13.0, 60.0, 20.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 50.0, 60.0, 0.0, 40.0, 30.0, 18.0, 0.0, 0.0, 10.0, 0.0, 7.0, 30.0, 20.0, -3.0, 12.0, 0.0, 70.0, 10.0, 10.0, 17.0, 40.0, 6.0, 8.0, 10.0, 18.0, 7.0, 50.0, 19.0, 20.0, 7.0, 20.0, -7.0, 20.0, 5.0, 49.0, 20.0, 0.0, 10.0, 57.0, 60.0, 60.0, 64.0, 10.0, 30.0, 0.0, 45.0, 0.0, 25.0, 80.0, 70.0, 37.0, 20.0, 30.0, 60.0, 23.0, 80.0, 10.0, 30.0, 0.0, 18.0, 0.0, 80.0, 0.0, 30.0, 39.0, -2.0, 38.0, 20.0, -13.0, 60.0, 29.0, -2.0, -19.0, 4.0, 40.0, 6.0, -6.0, 50.0, 11.0, 30.0, -12.0, 26.0, 3.0, 20.0, 40.0, -6.0, 0.0, 28.0, 20.0, 20.0, -2.0, 30.0, 13.0, -9.0, 10.0, 20.0, -23.0, 10.0, 50.0, 39.0, 20.0, 50.0, -3.0, -7.0, 0.0, 8.0, 10.0, 28.0, 26.0, -1.0, 6.0, -5.0, 27.0, 0.0, -3.0, 80.0, 20.0, -11.0, 30.0, 60.0, 50.0, -5.0, 0.0, 22.0, 0.0, 0.0, 11.0, 18.0, 10.0, 18.0, 0.0, 28.0, 27.0, 29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0, 90.0, 9.0, 10.0, 30.0, 35.0, 40.0, 28.0, 20.0, 40.0, 20.0, 20.0, 30.0, 50.0, 0.0, 20.0, 60.0, 20.0, 19.0, 80.0, 5.0, 16.0, 20.0, -1.0, 9.0, 40.0, 0.0, 0.0, 3.0, 0.0, 20.0, -1.0, 19.0, 19.0, 19.0, 80.0, 0.0, 10.0, 40.0, -4.0, 45.0, 20.0, 18.0, 10.0, 30.0, -7.0, 7.0, 40.0, 20.0, 40.0, 3.0, 15.0, 10.0, 40.0, 0.0, -2.0, 70.0, 30.0, 30.0, 28.0, 70.0, -5.0, -6.0, 40.0, 40.0, 20.0, 0.0, 10.0, 20.0, 7.0, 40.0, 10.0, 26.0, 8.0, 0.0, 24.0, 0.0, -11.0, -25.0, 37.0, -2.0, 5.0, -1.0, 0.0, 0.0, -7.0, 0.0, 20.0, 60.0, 8.0, 10.0, 13.0, 10.0, 10.0, 9.0, 0.0, -9.0, 20.0, -6.0, -1.0, 100.0, -5.0, 20.0, 10.0, 10.0, -13.0, 10.0, 50.0, 10.0, 60.0, -2.0, 31.0, 37.0, -6.0, 30.0, 20.0, 16.0, 30.0, 40.0, -1.0, 20.0, -14.0, 7.0, 40.0, 60.0, 70.0, 40.0, -1.0, 69.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 15.0, 30.0, 60.0, 0.0, 50.0, 20.0, 3.0, 50.0, 20.0, 40.0, 10.0, 20.0, 0.0, -6.0, 29.0, 20.0, 0.0, 20.0, 5.0, 26.0, 30.0, 60.0, 0.0, 30.0, 50.0, 0.0, 40.0, 7.0, 18.0, 20.0, -15.0, 40.0, 0.0, 20.0, 20.0, 5.0, 27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0, 60.0, 17.0, 10.0, -6.0, -6.0, 20.0, 50.0, 10.0, 20.0, 50.0, 9.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 60.0, 30.0, 50.0, 8.0, 30.0, 39.0, 10.0, 39.0, 28.0, -7.0, 30.0, 0.0, 0.0, -5.0, 16.0, 40.0, 20.0, 10.0, 40.0, 20.0, -2.0, 40.0, 0.0, -3.0, 0.0, 40.0, 40.0, 30.0, 29.0, 40.0, 10.0, 25.0, 40.0, 40.0, -4.0, 80.0, 40.0, 18.0, -7.0, 8.0, 10.0, 20.0, 13.0, 28.0, 0.0, 60.0, 50.0, -3.0, 10.0, 11.0, 20.0, 50.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 6.0, 80.0, 5.0, 30.0, 90.0, 20.0, 15.0, 15.0, 80.0, 10.0, 70.0, 11.0, 0.0, 7.0, 40.0, 0.0, 40.0, 0.0, 37.0, 50.0, 9.0, 6.0, 30.0, 0.0, -4.0, 10.0, 0.0, 0.0, 30.0, -4.0, 6.0, 50.0, 40.0, -13.0, 70.0, 13.0, 9.0, 28.0, -2.0, 13.0, 21.0, 5.0, 10.0, -9.0, 39.0, 60.0, 13.0, 60.0, 40.0, 50.0, 10.0, 0.0, -1.0, 30.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, -3.0, 50.0, 30.0, -5.0, 10.0, 11.0, 20.0, 30.0, 28.0, 8.0, 10.0, 20.0, 0.0, 32.0, 20.0, 40.0, 9.0, 30.0, 92.0, 0.0, 0.0, 15.0, 30.0, 0.0, 26.0, 25.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 17.0, -33.0, 17.0, 40.0, 10.0, -2.0, 10.0, 0.0, 50.0, -13.0, 40.0, -20.0, 10.0, 50.0, 0.0, 0.0, 30.0, -11.0, 0.0, 38.0, 90.0, 10.0, 40.0, 30.0, 40.0, 48.0, 0.0, 20.0, 30.0, 10.0, 20.0, 2.0, 5.0, 0.0, 0.0, 9.0, 20.0, 10.0, 3.0, 6.0, -2.0, 10.0, 0.0, 5.0, -1.0, 29.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.849899283046278, "mean_inference_ms": 1.9186071377065625, "mean_action_processing_ms": 0.5971183060640878, "mean_env_wait_ms": 1.7128076401032986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017457962036132812, "StateBufferConnector_ms": 0.012749671936035156, "ViewRequirementAgentConnector_ms": 0.5406711101531982}, "num_episodes": 22, "episode_return_max": 415.0, "episode_return_min": 32.0, "episode_return_mean": 202.56}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.67448818116076, "num_env_steps_trained_throughput_per_sec": 18.67448818116076, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 214054.106, "restore_workers_time_ms": 0.013, "training_step_time_ms": 214054.055, "sample_time_ms": 3148.832, "learn_time_ms": 210881.492, "learn_throughput": 18.968, "synch_weights_time_ms": 15.484}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "a22d3_00000", "date": "2024-08-05_23-50-13", "timestamp": 1722916213, "time_this_iter_s": 214.20282697677612, "time_total_s": 4006.0344200134277, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4006.0344200134277, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 33.214521452145206, "ram_util_percent": 79.17590759075908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5320796702362607, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.810755031355146, "policy_loss": -0.010372800902608302, "vf_loss": 3.8194925731236435, "vf_explained_var": -0.002537794888844759, "kl": 0.008176275170472206, "entropy": 1.1825459272335894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 415.0, "episode_reward_min": 32.0, "episode_reward_mean": 208.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 100.0}, "policy_reward_mean": {"policy_0": 20.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [289.0, 269.0, 264.0, 210.0, 183.0, 322.0, 123.0, 177.0, 229.0, 190.0, 255.0, 56.0, 167.0, 32.0, 236.0, 103.0, 225.0, 216.0, 179.0, 225.0, 286.0, 197.0, 340.0, 155.0, 170.0, 164.0, 335.0, 337.0, 301.0, 180.0, 152.0, 163.0, 164.0, 92.0, 221.0, 134.0, 199.0, 322.0, 304.0, 107.0, 227.0, 181.0, 291.0, 166.0, 67.0, 95.0, 146.0, 150.0, 217.0, 311.0, 265.0, 186.0, 221.0, 155.0, 241.0, 225.0, 268.0, 314.0, 144.0, 194.0, 282.0, 196.0, 227.0, 415.0, 194.0, 74.0, 229.0, 278.0, 186.0, 192.0, 243.0, 266.0, 129.0, 86.0, 346.0, 79.0, 57.0, 159.0, 207.0, 235.0, 286.0, 239.0, 260.0, 149.0, 240.0, 140.0, 246.0, 232.0, 206.0, 202.0, 230.0, 204.0, 88.0, 185.0, 325.0, 281.0, 220.0, 234.0, 255.0, 171.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 1.0, 30.0, 50.0, 10.0, 70.0, 8.0, 10.0, 50.0, 10.0, 30.0, 37.0, 20.0, 10.0, 60.0, 10.0, 20.0, 5.0, 17.0, 60.0, 20.0, 20.0, 90.0, 49.0, 20.0, 20.0, 20.0, 20.0, 5.0, 0.0, 20.0, 10.0, 40.0, 30.0, 50.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 30.0, 20.0, 40.0, 0.0, 19.0, 26.0, 30.0, 8.0, 19.0, 38.0, 30.0, 40.0, 30.0, 30.0, 20.0, 20.0, 55.0, 40.0, -3.0, 0.0, -4.0, 0.0, 30.0, 10.0, 10.0, 30.0, 50.0, 0.0, -35.0, 10.0, 48.0, 10.0, 10.0, 60.0, 0.0, 25.0, 19.0, 30.0, 20.0, 10.0, 30.0, 40.0, 0.0, 19.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 10.0, 13.0, 30.0, 30.0, 20.0, 10.0, 0.0, 7.0, 20.0, 0.0, 62.0, 3.0, 40.0, 20.0, -10.0, 50.0, 10.0, 60.0, 4.0, -1.0, 2.0, 1.0, 7.0, 20.0, 0.0, -1.0, 17.0, 7.0, 19.0, -9.0, -19.0, 40.0, -10.0, 20.0, 89.0, 39.0, 0.0, -2.0, 5.0, 5.0, -5.0, 10.0, 30.0, 19.0, 30.0, -65.0, -7.0, 10.0, -25.0, 20.0, 40.0, 20.0, 10.0, 20.0, 16.0, 35.0, 30.0, 70.0, 30.0, 15.0, -11.0, 15.0, 20.0, -1.0, -2.0, 35.0, 7.0, -5.0, 20.0, 20.0, 50.0, 20.0, 50.0, 20.0, 20.0, 0.0, 5.0, 20.0, 40.0, 18.0, 14.0, 20.0, 14.0, 28.0, 40.0, 6.0, 34.0, 2.0, 30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 80.0, -18.0, 20.0, 13.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 28.0, 18.0, 40.0, 20.0, 20.0, 20.0, 60.0, 10.0, 60.0, 14.0, 30.0, 30.0, 0.0, 0.0, 30.0, 13.0, 60.0, 20.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 50.0, 60.0, 0.0, 40.0, 30.0, 18.0, 0.0, 0.0, 10.0, 0.0, 7.0, 30.0, 20.0, -3.0, 12.0, 0.0, 70.0, 10.0, 10.0, 17.0, 40.0, 6.0, 8.0, 10.0, 18.0, 7.0, 50.0, 19.0, 20.0, 7.0, 20.0, -7.0, 20.0, 5.0, 49.0, 20.0, 0.0, 10.0, 57.0, 60.0, 60.0, 64.0, 10.0, 30.0, 0.0, 45.0, 0.0, 25.0, 80.0, 70.0, 37.0, 20.0, 30.0, 60.0, 23.0, 80.0, 10.0, 30.0, 0.0, 18.0, 0.0, 80.0, 0.0, 30.0, 39.0, -2.0, 38.0, 20.0, -13.0, 60.0, 29.0, -2.0, -19.0, 4.0, 40.0, 6.0, -6.0, 50.0, 11.0, 30.0, -12.0, 26.0, 3.0, 20.0, 40.0, -6.0, 0.0, 28.0, 20.0, 20.0, -2.0, 30.0, 13.0, -9.0, 10.0, 20.0, -23.0, 10.0, 50.0, 39.0, 20.0, 50.0, -3.0, -7.0, 0.0, 8.0, 10.0, 28.0, 26.0, -1.0, 6.0, -5.0, 27.0, 0.0, -3.0, 80.0, 20.0, -11.0, 30.0, 60.0, 50.0, -5.0, 0.0, 22.0, 0.0, 0.0, 11.0, 18.0, 10.0, 18.0, 0.0, 28.0, 27.0, 29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0, 90.0, 9.0, 10.0, 30.0, 35.0, 40.0, 28.0, 20.0, 40.0, 20.0, 20.0, 30.0, 50.0, 0.0, 20.0, 60.0, 20.0, 19.0, 80.0, 5.0, 16.0, 20.0, -1.0, 9.0, 40.0, 0.0, 0.0, 3.0, 0.0, 20.0, -1.0, 19.0, 19.0, 19.0, 80.0, 0.0, 10.0, 40.0, -4.0, 45.0, 20.0, 18.0, 10.0, 30.0, -7.0, 7.0, 40.0, 20.0, 40.0, 3.0, 15.0, 10.0, 40.0, 0.0, -2.0, 70.0, 30.0, 30.0, 28.0, 70.0, -5.0, -6.0, 40.0, 40.0, 20.0, 0.0, 10.0, 20.0, 7.0, 40.0, 10.0, 26.0, 8.0, 0.0, 24.0, 0.0, -11.0, -25.0, 37.0, -2.0, 5.0, -1.0, 0.0, 0.0, -7.0, 0.0, 20.0, 60.0, 8.0, 10.0, 13.0, 10.0, 10.0, 9.0, 0.0, -9.0, 20.0, -6.0, -1.0, 100.0, -5.0, 20.0, 10.0, 10.0, -13.0, 10.0, 50.0, 10.0, 60.0, -2.0, 31.0, 37.0, -6.0, 30.0, 20.0, 16.0, 30.0, 40.0, -1.0, 20.0, -14.0, 7.0, 40.0, 60.0, 70.0, 40.0, -1.0, 69.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 15.0, 30.0, 60.0, 0.0, 50.0, 20.0, 3.0, 50.0, 20.0, 40.0, 10.0, 20.0, 0.0, -6.0, 29.0, 20.0, 0.0, 20.0, 5.0, 26.0, 30.0, 60.0, 0.0, 30.0, 50.0, 0.0, 40.0, 7.0, 18.0, 20.0, -15.0, 40.0, 0.0, 20.0, 20.0, 5.0, 27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0, 60.0, 17.0, 10.0, -6.0, -6.0, 20.0, 50.0, 10.0, 20.0, 50.0, 9.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 60.0, 30.0, 50.0, 8.0, 30.0, 39.0, 10.0, 39.0, 28.0, -7.0, 30.0, 0.0, 0.0, -5.0, 16.0, 40.0, 20.0, 10.0, 40.0, 20.0, -2.0, 40.0, 0.0, -3.0, 0.0, 40.0, 40.0, 30.0, 29.0, 40.0, 10.0, 25.0, 40.0, 40.0, -4.0, 80.0, 40.0, 18.0, -7.0, 8.0, 10.0, 20.0, 13.0, 28.0, 0.0, 60.0, 50.0, -3.0, 10.0, 11.0, 20.0, 50.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 6.0, 80.0, 5.0, 30.0, 90.0, 20.0, 15.0, 15.0, 80.0, 10.0, 70.0, 11.0, 0.0, 7.0, 40.0, 0.0, 40.0, 0.0, 37.0, 50.0, 9.0, 6.0, 30.0, 0.0, -4.0, 10.0, 0.0, 0.0, 30.0, -4.0, 6.0, 50.0, 40.0, -13.0, 70.0, 13.0, 9.0, 28.0, -2.0, 13.0, 21.0, 5.0, 10.0, -9.0, 39.0, 60.0, 13.0, 60.0, 40.0, 50.0, 10.0, 0.0, -1.0, 30.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, -3.0, 50.0, 30.0, -5.0, 10.0, 11.0, 20.0, 30.0, 28.0, 8.0, 10.0, 20.0, 0.0, 32.0, 20.0, 40.0, 9.0, 30.0, 92.0, 0.0, 0.0, 15.0, 30.0, 0.0, 26.0, 25.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 17.0, -33.0, 17.0, 40.0, 10.0, -2.0, 10.0, 0.0, 50.0, -13.0, 40.0, -20.0, 10.0, 50.0, 0.0, 0.0, 30.0, -11.0, 0.0, 38.0, 90.0, 10.0, 40.0, 30.0, 40.0, 48.0, 0.0, 20.0, 30.0, 10.0, 20.0, 2.0, 5.0, 0.0, 0.0, 9.0, 20.0, 10.0, 3.0, 6.0, -2.0, 10.0, 0.0, 5.0, -1.0, 29.0, 0.0, 10.0, 0.0, 6.0, 60.0, 40.0, -8.0, 10.0, 7.0, -6.0, 10.0, 30.0, 10.0, 9.0, 30.0, 30.0, 19.0, 20.0, 0.0, 40.0, 10.0, 40.0, 9.0, 28.0, 0.0, 0.0, 30.0, 40.0, 40.0, 20.0, 30.0, 29.0, 18.0, 40.0, 40.0, 20.0, 10.0, 10.0, 10.0, 50.0, 40.0, 20.0, 46.0, 60.0, 10.0, 70.0, 0.0, 14.0, 30.0, 37.0, -2.0, 10.0, 10.0, 30.0, 10.0, 30.0, 0.0, 10.0, 30.0, 50.0, 10.0, 60.0, 30.0, -4.0, 40.0, 40.0, 20.0, 9.0, 20.0, 0.0, 9.0, -5.0, 20.0, 0.0, 60.0, 0.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 20.0, -6.0, 10.0, 40.0, 15.0, 50.0, 0.0, 11.0, 25.0, 20.0, -25.0, 20.0, 10.0, 54.0, 70.0, 0.0, 50.0, -1.0, -1.0, 14.0, 30.0, 70.0, 10.0, 15.0, 30.0, 3.0, 18.0, 13.0, 30.0, 50.0, -7.0, 40.0, 20.0, -8.0, 25.0, 26.0, 20.0, 20.0, 10.0, 40.0, 13.0, 9.0, 10.0, 6.0, 40.0, -1.0, 70.0, 10.0, 8.0, 40.0, 10.0, 0.0, -2.0, 29.0, 30.0, -1.0, 50.0, 50.0, 37.0, 28.0, 9.0, 30.0, 40.0, 0.0, 10.0, 29.0, 13.0, 10.0, 60.0, 2.0, 10.0, 20.0, -1.0, 20.0, 50.0, 5.0, -4.0, -7.0, 10.0, 0.0, -5.0, 22.0, -3.0, 20.0, 20.0, 26.0, -3.0, 70.0, -2.0, 31.0, 4.0, -1.0, -10.0, 6.0, 62.0, 30.0, 90.0, 30.0, 70.0, 8.0, 40.0, 10.0, 8.0, 40.0, 20.0, 20.0, 26.0, 30.0, 38.0, 39.0, 50.0, 50.0, 40.0, 28.0, 27.0, 0.0, 20.0, 20.0, 15.0, 0.0, 20.0, 40.0, 0.0, 20.0, 26.0, 30.0, 10.0, 18.0, 30.0, 50.0, 10.0, 30.0, 14.0, 2.0, 10.0, 0.0, 60.0, 49.0, 60.0, 0.0, 30.0, 10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8400670451897332, "mean_inference_ms": 1.9226908853411608, "mean_action_processing_ms": 0.5966501827879095, "mean_env_wait_ms": 1.7087651441263148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018666744232177734, "StateBufferConnector_ms": 0.01287221908569336, "ViewRequirementAgentConnector_ms": 0.5391206741333008}, "num_episodes": 23, "episode_return_max": 415.0, "episode_return_min": 32.0, "episode_return_mean": 208.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.70009944742458, "num_env_steps_trained_throughput_per_sec": 18.70009944742458, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 214508.679, "restore_workers_time_ms": 0.013, "training_step_time_ms": 214508.627, "sample_time_ms": 3154.402, "learn_time_ms": 211328.696, "learn_throughput": 18.928, "synch_weights_time_ms": 16.733}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "a22d3_00000", "date": "2024-08-05_23-53-47", "timestamp": 1722916427, "time_this_iter_s": 213.91317486763, "time_total_s": 4219.947594881058, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4219.947594881058, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.10496688741722, "ram_util_percent": 79.23476821192054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.293958068287538, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.759871360085135, "policy_loss": -0.010899845478015816, "vf_loss": 3.7690880493615, "vf_explained_var": -0.01222465542304757, "kl": 0.008415778728661796, "entropy": 1.1555587968125511, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 415.0, "episode_reward_min": 57.0, "episode_reward_mean": 217.39, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -33.0}, "policy_reward_max": {"policy_0": 119.0}, "policy_reward_mean": {"policy_0": 21.739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [179.0, 225.0, 286.0, 197.0, 340.0, 155.0, 170.0, 164.0, 335.0, 337.0, 301.0, 180.0, 152.0, 163.0, 164.0, 92.0, 221.0, 134.0, 199.0, 322.0, 304.0, 107.0, 227.0, 181.0, 291.0, 166.0, 67.0, 95.0, 146.0, 150.0, 217.0, 311.0, 265.0, 186.0, 221.0, 155.0, 241.0, 225.0, 268.0, 314.0, 144.0, 194.0, 282.0, 196.0, 227.0, 415.0, 194.0, 74.0, 229.0, 278.0, 186.0, 192.0, 243.0, 266.0, 129.0, 86.0, 346.0, 79.0, 57.0, 159.0, 207.0, 235.0, 286.0, 239.0, 260.0, 149.0, 240.0, 140.0, 246.0, 232.0, 206.0, 202.0, 230.0, 204.0, 88.0, 185.0, 325.0, 281.0, 220.0, 234.0, 255.0, 171.0, 247.0, 245.0, 110.0, 173.0, 294.0, 209.0, 329.0, 247.0, 365.0, 284.0, 288.0, 388.0, 174.0, 256.0, 243.0, 139.0, 194.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, -1.0, 30.0, 3.0, 7.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 80.0, -18.0, 20.0, 13.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 28.0, 18.0, 40.0, 20.0, 20.0, 20.0, 60.0, 10.0, 60.0, 14.0, 30.0, 30.0, 0.0, 0.0, 30.0, 13.0, 60.0, 20.0, 0.0, 70.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 50.0, 60.0, 0.0, 40.0, 30.0, 18.0, 0.0, 0.0, 10.0, 0.0, 7.0, 30.0, 20.0, -3.0, 12.0, 0.0, 70.0, 10.0, 10.0, 17.0, 40.0, 6.0, 8.0, 10.0, 18.0, 7.0, 50.0, 19.0, 20.0, 7.0, 20.0, -7.0, 20.0, 5.0, 49.0, 20.0, 0.0, 10.0, 57.0, 60.0, 60.0, 64.0, 10.0, 30.0, 0.0, 45.0, 0.0, 25.0, 80.0, 70.0, 37.0, 20.0, 30.0, 60.0, 23.0, 80.0, 10.0, 30.0, 0.0, 18.0, 0.0, 80.0, 0.0, 30.0, 39.0, -2.0, 38.0, 20.0, -13.0, 60.0, 29.0, -2.0, -19.0, 4.0, 40.0, 6.0, -6.0, 50.0, 11.0, 30.0, -12.0, 26.0, 3.0, 20.0, 40.0, -6.0, 0.0, 28.0, 20.0, 20.0, -2.0, 30.0, 13.0, -9.0, 10.0, 20.0, -23.0, 10.0, 50.0, 39.0, 20.0, 50.0, -3.0, -7.0, 0.0, 8.0, 10.0, 28.0, 26.0, -1.0, 6.0, -5.0, 27.0, 0.0, -3.0, 80.0, 20.0, -11.0, 30.0, 60.0, 50.0, -5.0, 0.0, 22.0, 0.0, 0.0, 11.0, 18.0, 10.0, 18.0, 0.0, 28.0, 27.0, 29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0, 90.0, 9.0, 10.0, 30.0, 35.0, 40.0, 28.0, 20.0, 40.0, 20.0, 20.0, 30.0, 50.0, 0.0, 20.0, 60.0, 20.0, 19.0, 80.0, 5.0, 16.0, 20.0, -1.0, 9.0, 40.0, 0.0, 0.0, 3.0, 0.0, 20.0, -1.0, 19.0, 19.0, 19.0, 80.0, 0.0, 10.0, 40.0, -4.0, 45.0, 20.0, 18.0, 10.0, 30.0, -7.0, 7.0, 40.0, 20.0, 40.0, 3.0, 15.0, 10.0, 40.0, 0.0, -2.0, 70.0, 30.0, 30.0, 28.0, 70.0, -5.0, -6.0, 40.0, 40.0, 20.0, 0.0, 10.0, 20.0, 7.0, 40.0, 10.0, 26.0, 8.0, 0.0, 24.0, 0.0, -11.0, -25.0, 37.0, -2.0, 5.0, -1.0, 0.0, 0.0, -7.0, 0.0, 20.0, 60.0, 8.0, 10.0, 13.0, 10.0, 10.0, 9.0, 0.0, -9.0, 20.0, -6.0, -1.0, 100.0, -5.0, 20.0, 10.0, 10.0, -13.0, 10.0, 50.0, 10.0, 60.0, -2.0, 31.0, 37.0, -6.0, 30.0, 20.0, 16.0, 30.0, 40.0, -1.0, 20.0, -14.0, 7.0, 40.0, 60.0, 70.0, 40.0, -1.0, 69.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 15.0, 30.0, 60.0, 0.0, 50.0, 20.0, 3.0, 50.0, 20.0, 40.0, 10.0, 20.0, 0.0, -6.0, 29.0, 20.0, 0.0, 20.0, 5.0, 26.0, 30.0, 60.0, 0.0, 30.0, 50.0, 0.0, 40.0, 7.0, 18.0, 20.0, -15.0, 40.0, 0.0, 20.0, 20.0, 5.0, 27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0, 60.0, 17.0, 10.0, -6.0, -6.0, 20.0, 50.0, 10.0, 20.0, 50.0, 9.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 60.0, 30.0, 50.0, 8.0, 30.0, 39.0, 10.0, 39.0, 28.0, -7.0, 30.0, 0.0, 0.0, -5.0, 16.0, 40.0, 20.0, 10.0, 40.0, 20.0, -2.0, 40.0, 0.0, -3.0, 0.0, 40.0, 40.0, 30.0, 29.0, 40.0, 10.0, 25.0, 40.0, 40.0, -4.0, 80.0, 40.0, 18.0, -7.0, 8.0, 10.0, 20.0, 13.0, 28.0, 0.0, 60.0, 50.0, -3.0, 10.0, 11.0, 20.0, 50.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 6.0, 80.0, 5.0, 30.0, 90.0, 20.0, 15.0, 15.0, 80.0, 10.0, 70.0, 11.0, 0.0, 7.0, 40.0, 0.0, 40.0, 0.0, 37.0, 50.0, 9.0, 6.0, 30.0, 0.0, -4.0, 10.0, 0.0, 0.0, 30.0, -4.0, 6.0, 50.0, 40.0, -13.0, 70.0, 13.0, 9.0, 28.0, -2.0, 13.0, 21.0, 5.0, 10.0, -9.0, 39.0, 60.0, 13.0, 60.0, 40.0, 50.0, 10.0, 0.0, -1.0, 30.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, -3.0, 50.0, 30.0, -5.0, 10.0, 11.0, 20.0, 30.0, 28.0, 8.0, 10.0, 20.0, 0.0, 32.0, 20.0, 40.0, 9.0, 30.0, 92.0, 0.0, 0.0, 15.0, 30.0, 0.0, 26.0, 25.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 17.0, -33.0, 17.0, 40.0, 10.0, -2.0, 10.0, 0.0, 50.0, -13.0, 40.0, -20.0, 10.0, 50.0, 0.0, 0.0, 30.0, -11.0, 0.0, 38.0, 90.0, 10.0, 40.0, 30.0, 40.0, 48.0, 0.0, 20.0, 30.0, 10.0, 20.0, 2.0, 5.0, 0.0, 0.0, 9.0, 20.0, 10.0, 3.0, 6.0, -2.0, 10.0, 0.0, 5.0, -1.0, 29.0, 0.0, 10.0, 0.0, 6.0, 60.0, 40.0, -8.0, 10.0, 7.0, -6.0, 10.0, 30.0, 10.0, 9.0, 30.0, 30.0, 19.0, 20.0, 0.0, 40.0, 10.0, 40.0, 9.0, 28.0, 0.0, 0.0, 30.0, 40.0, 40.0, 20.0, 30.0, 29.0, 18.0, 40.0, 40.0, 20.0, 10.0, 10.0, 10.0, 50.0, 40.0, 20.0, 46.0, 60.0, 10.0, 70.0, 0.0, 14.0, 30.0, 37.0, -2.0, 10.0, 10.0, 30.0, 10.0, 30.0, 0.0, 10.0, 30.0, 50.0, 10.0, 60.0, 30.0, -4.0, 40.0, 40.0, 20.0, 9.0, 20.0, 0.0, 9.0, -5.0, 20.0, 0.0, 60.0, 0.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 20.0, -6.0, 10.0, 40.0, 15.0, 50.0, 0.0, 11.0, 25.0, 20.0, -25.0, 20.0, 10.0, 54.0, 70.0, 0.0, 50.0, -1.0, -1.0, 14.0, 30.0, 70.0, 10.0, 15.0, 30.0, 3.0, 18.0, 13.0, 30.0, 50.0, -7.0, 40.0, 20.0, -8.0, 25.0, 26.0, 20.0, 20.0, 10.0, 40.0, 13.0, 9.0, 10.0, 6.0, 40.0, -1.0, 70.0, 10.0, 8.0, 40.0, 10.0, 0.0, -2.0, 29.0, 30.0, -1.0, 50.0, 50.0, 37.0, 28.0, 9.0, 30.0, 40.0, 0.0, 10.0, 29.0, 13.0, 10.0, 60.0, 2.0, 10.0, 20.0, -1.0, 20.0, 50.0, 5.0, -4.0, -7.0, 10.0, 0.0, -5.0, 22.0, -3.0, 20.0, 20.0, 26.0, -3.0, 70.0, -2.0, 31.0, 4.0, -1.0, -10.0, 6.0, 62.0, 30.0, 90.0, 30.0, 70.0, 8.0, 40.0, 10.0, 8.0, 40.0, 20.0, 20.0, 26.0, 30.0, 38.0, 39.0, 50.0, 50.0, 40.0, 28.0, 27.0, 0.0, 20.0, 20.0, 15.0, 0.0, 20.0, 40.0, 0.0, 20.0, 26.0, 30.0, 10.0, 18.0, 30.0, 50.0, 10.0, 30.0, 14.0, 2.0, 10.0, 0.0, 60.0, 49.0, 60.0, 0.0, 30.0, 10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0, 40.0, 40.0, 35.0, 10.0, 30.0, 7.0, 40.0, 20.0, 5.0, 20.0, 50.0, 0.0, -2.0, 30.0, 9.0, 10.0, 30.0, 50.0, 70.0, -2.0, 8.0, 16.0, 10.0, 10.0, 4.0, 28.0, -2.0, 8.0, 3.0, 25.0, 30.0, 19.0, 50.0, 20.0, -3.0, 20.0, 27.0, 0.0, 10.0, 0.0, 119.0, 10.0, 0.0, 19.0, 9.0, 50.0, 0.0, 10.0, 27.0, 50.0, 60.0, 0.0, 10.0, 40.0, 15.0, -1.0, 10.0, 25.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 26.0, 0.0, 70.0, 20.0, 70.0, 33.0, 10.0, 30.0, 60.0, 20.0, 30.0, 10.0, -20.0, 50.0, 29.0, 28.0, 20.0, 67.0, 20.0, 17.0, 30.0, 60.0, 55.0, 80.0, -4.0, 20.0, 20.0, 20.0, 48.0, -2.0, 10.0, 40.0, 10.0, 70.0, 20.0, 48.0, 39.0, 10.0, 70.0, 60.0, 6.0, 20.0, 0.0, 36.0, 33.0, 14.0, 60.0, 80.0, -2.0, 60.0, 10.0, 40.0, 0.0, 20.0, 80.0, 40.0, 10.0, 0.0, 38.0, 4.0, 4.0, 0.0, 38.0, 0.0, 40.0, 40.0, 10.0, 19.0, 70.0, 30.0, -16.0, 20.0, 20.0, 75.0, 10.0, 18.0, 30.0, 30.0, 20.0, 26.0, 30.0, 3.0, 19.0, 15.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 38.0, 17.0, 8.0, 50.0, -4.0, 14.0, 20.0, 30.0, -12.0, 20.0, 30.0, 50.0, -8.0, 25.0, 25.0, 30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8344636553044809, "mean_inference_ms": 1.9251780009958137, "mean_action_processing_ms": 0.5963767168016132, "mean_env_wait_ms": 1.7062304537968342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019545316696166992, "StateBufferConnector_ms": 0.012908697128295898, "ViewRequirementAgentConnector_ms": 0.5595250129699707}, "num_episodes": 18, "episode_return_max": 415.0, "episode_return_min": 57.0, "episode_return_mean": 217.39}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 14.683990098813693, "num_env_steps_trained_throughput_per_sec": 14.683990098813693, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 220919.254, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220919.203, "sample_time_ms": 3224.986, "learn_time_ms": 217667.613, "learn_throughput": 18.377, "synch_weights_time_ms": 17.48}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "a22d3_00000", "date": "2024-08-05_23-58-19", "timestamp": 1722916699, "time_this_iter_s": 272.41618609428406, "time_total_s": 4492.363780975342, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4492.363780975342, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 50.3053050397878, "ram_util_percent": 78.05729442970822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7851080323433597, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7260057527798054, "policy_loss": -0.010848922267654382, "vf_loss": 3.73514656621935, "vf_explained_var": 0.006052376052188163, "kl": 0.008540539177131937, "entropy": 1.13343145827008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": 57.0, "episode_reward_mean": 225.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -33.0}, "policy_reward_max": {"policy_0": 119.0}, "policy_reward_mean": {"policy_0": 22.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [199.0, 322.0, 304.0, 107.0, 227.0, 181.0, 291.0, 166.0, 67.0, 95.0, 146.0, 150.0, 217.0, 311.0, 265.0, 186.0, 221.0, 155.0, 241.0, 225.0, 268.0, 314.0, 144.0, 194.0, 282.0, 196.0, 227.0, 415.0, 194.0, 74.0, 229.0, 278.0, 186.0, 192.0, 243.0, 266.0, 129.0, 86.0, 346.0, 79.0, 57.0, 159.0, 207.0, 235.0, 286.0, 239.0, 260.0, 149.0, 240.0, 140.0, 246.0, 232.0, 206.0, 202.0, 230.0, 204.0, 88.0, 185.0, 325.0, 281.0, 220.0, 234.0, 255.0, 171.0, 247.0, 245.0, 110.0, 173.0, 294.0, 209.0, 329.0, 247.0, 365.0, 284.0, 288.0, 388.0, 174.0, 256.0, 243.0, 139.0, 194.0, 290.0, 277.0, 205.0, 206.0, 250.0, 233.0, 194.0, 166.0, 195.0, 247.0, 234.0, 319.0, 333.0, 213.0, 481.0, 158.0, 410.0, 120.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [29.0, -3.0, 30.0, 10.0, 21.0, 15.0, 29.0, 7.0, 50.0, 11.0, 90.0, 9.0, 10.0, 30.0, 35.0, 40.0, 28.0, 20.0, 40.0, 20.0, 20.0, 30.0, 50.0, 0.0, 20.0, 60.0, 20.0, 19.0, 80.0, 5.0, 16.0, 20.0, -1.0, 9.0, 40.0, 0.0, 0.0, 3.0, 0.0, 20.0, -1.0, 19.0, 19.0, 19.0, 80.0, 0.0, 10.0, 40.0, -4.0, 45.0, 20.0, 18.0, 10.0, 30.0, -7.0, 7.0, 40.0, 20.0, 40.0, 3.0, 15.0, 10.0, 40.0, 0.0, -2.0, 70.0, 30.0, 30.0, 28.0, 70.0, -5.0, -6.0, 40.0, 40.0, 20.0, 0.0, 10.0, 20.0, 7.0, 40.0, 10.0, 26.0, 8.0, 0.0, 24.0, 0.0, -11.0, -25.0, 37.0, -2.0, 5.0, -1.0, 0.0, 0.0, -7.0, 0.0, 20.0, 60.0, 8.0, 10.0, 13.0, 10.0, 10.0, 9.0, 0.0, -9.0, 20.0, -6.0, -1.0, 100.0, -5.0, 20.0, 10.0, 10.0, -13.0, 10.0, 50.0, 10.0, 60.0, -2.0, 31.0, 37.0, -6.0, 30.0, 20.0, 16.0, 30.0, 40.0, -1.0, 20.0, -14.0, 7.0, 40.0, 60.0, 70.0, 40.0, -1.0, 69.0, 20.0, 20.0, 20.0, 40.0, 10.0, 20.0, 15.0, 30.0, 60.0, 0.0, 50.0, 20.0, 3.0, 50.0, 20.0, 40.0, 10.0, 20.0, 0.0, -6.0, 29.0, 20.0, 0.0, 20.0, 5.0, 26.0, 30.0, 60.0, 0.0, 30.0, 50.0, 0.0, 40.0, 7.0, 18.0, 20.0, -15.0, 40.0, 0.0, 20.0, 20.0, 5.0, 27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0, 60.0, 17.0, 10.0, -6.0, -6.0, 20.0, 50.0, 10.0, 20.0, 50.0, 9.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 60.0, 30.0, 50.0, 8.0, 30.0, 39.0, 10.0, 39.0, 28.0, -7.0, 30.0, 0.0, 0.0, -5.0, 16.0, 40.0, 20.0, 10.0, 40.0, 20.0, -2.0, 40.0, 0.0, -3.0, 0.0, 40.0, 40.0, 30.0, 29.0, 40.0, 10.0, 25.0, 40.0, 40.0, -4.0, 80.0, 40.0, 18.0, -7.0, 8.0, 10.0, 20.0, 13.0, 28.0, 0.0, 60.0, 50.0, -3.0, 10.0, 11.0, 20.0, 50.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 6.0, 80.0, 5.0, 30.0, 90.0, 20.0, 15.0, 15.0, 80.0, 10.0, 70.0, 11.0, 0.0, 7.0, 40.0, 0.0, 40.0, 0.0, 37.0, 50.0, 9.0, 6.0, 30.0, 0.0, -4.0, 10.0, 0.0, 0.0, 30.0, -4.0, 6.0, 50.0, 40.0, -13.0, 70.0, 13.0, 9.0, 28.0, -2.0, 13.0, 21.0, 5.0, 10.0, -9.0, 39.0, 60.0, 13.0, 60.0, 40.0, 50.0, 10.0, 0.0, -1.0, 30.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, -3.0, 50.0, 30.0, -5.0, 10.0, 11.0, 20.0, 30.0, 28.0, 8.0, 10.0, 20.0, 0.0, 32.0, 20.0, 40.0, 9.0, 30.0, 92.0, 0.0, 0.0, 15.0, 30.0, 0.0, 26.0, 25.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 17.0, -33.0, 17.0, 40.0, 10.0, -2.0, 10.0, 0.0, 50.0, -13.0, 40.0, -20.0, 10.0, 50.0, 0.0, 0.0, 30.0, -11.0, 0.0, 38.0, 90.0, 10.0, 40.0, 30.0, 40.0, 48.0, 0.0, 20.0, 30.0, 10.0, 20.0, 2.0, 5.0, 0.0, 0.0, 9.0, 20.0, 10.0, 3.0, 6.0, -2.0, 10.0, 0.0, 5.0, -1.0, 29.0, 0.0, 10.0, 0.0, 6.0, 60.0, 40.0, -8.0, 10.0, 7.0, -6.0, 10.0, 30.0, 10.0, 9.0, 30.0, 30.0, 19.0, 20.0, 0.0, 40.0, 10.0, 40.0, 9.0, 28.0, 0.0, 0.0, 30.0, 40.0, 40.0, 20.0, 30.0, 29.0, 18.0, 40.0, 40.0, 20.0, 10.0, 10.0, 10.0, 50.0, 40.0, 20.0, 46.0, 60.0, 10.0, 70.0, 0.0, 14.0, 30.0, 37.0, -2.0, 10.0, 10.0, 30.0, 10.0, 30.0, 0.0, 10.0, 30.0, 50.0, 10.0, 60.0, 30.0, -4.0, 40.0, 40.0, 20.0, 9.0, 20.0, 0.0, 9.0, -5.0, 20.0, 0.0, 60.0, 0.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 20.0, -6.0, 10.0, 40.0, 15.0, 50.0, 0.0, 11.0, 25.0, 20.0, -25.0, 20.0, 10.0, 54.0, 70.0, 0.0, 50.0, -1.0, -1.0, 14.0, 30.0, 70.0, 10.0, 15.0, 30.0, 3.0, 18.0, 13.0, 30.0, 50.0, -7.0, 40.0, 20.0, -8.0, 25.0, 26.0, 20.0, 20.0, 10.0, 40.0, 13.0, 9.0, 10.0, 6.0, 40.0, -1.0, 70.0, 10.0, 8.0, 40.0, 10.0, 0.0, -2.0, 29.0, 30.0, -1.0, 50.0, 50.0, 37.0, 28.0, 9.0, 30.0, 40.0, 0.0, 10.0, 29.0, 13.0, 10.0, 60.0, 2.0, 10.0, 20.0, -1.0, 20.0, 50.0, 5.0, -4.0, -7.0, 10.0, 0.0, -5.0, 22.0, -3.0, 20.0, 20.0, 26.0, -3.0, 70.0, -2.0, 31.0, 4.0, -1.0, -10.0, 6.0, 62.0, 30.0, 90.0, 30.0, 70.0, 8.0, 40.0, 10.0, 8.0, 40.0, 20.0, 20.0, 26.0, 30.0, 38.0, 39.0, 50.0, 50.0, 40.0, 28.0, 27.0, 0.0, 20.0, 20.0, 15.0, 0.0, 20.0, 40.0, 0.0, 20.0, 26.0, 30.0, 10.0, 18.0, 30.0, 50.0, 10.0, 30.0, 14.0, 2.0, 10.0, 0.0, 60.0, 49.0, 60.0, 0.0, 30.0, 10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0, 40.0, 40.0, 35.0, 10.0, 30.0, 7.0, 40.0, 20.0, 5.0, 20.0, 50.0, 0.0, -2.0, 30.0, 9.0, 10.0, 30.0, 50.0, 70.0, -2.0, 8.0, 16.0, 10.0, 10.0, 4.0, 28.0, -2.0, 8.0, 3.0, 25.0, 30.0, 19.0, 50.0, 20.0, -3.0, 20.0, 27.0, 0.0, 10.0, 0.0, 119.0, 10.0, 0.0, 19.0, 9.0, 50.0, 0.0, 10.0, 27.0, 50.0, 60.0, 0.0, 10.0, 40.0, 15.0, -1.0, 10.0, 25.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 26.0, 0.0, 70.0, 20.0, 70.0, 33.0, 10.0, 30.0, 60.0, 20.0, 30.0, 10.0, -20.0, 50.0, 29.0, 28.0, 20.0, 67.0, 20.0, 17.0, 30.0, 60.0, 55.0, 80.0, -4.0, 20.0, 20.0, 20.0, 48.0, -2.0, 10.0, 40.0, 10.0, 70.0, 20.0, 48.0, 39.0, 10.0, 70.0, 60.0, 6.0, 20.0, 0.0, 36.0, 33.0, 14.0, 60.0, 80.0, -2.0, 60.0, 10.0, 40.0, 0.0, 20.0, 80.0, 40.0, 10.0, 0.0, 38.0, 4.0, 4.0, 0.0, 38.0, 0.0, 40.0, 40.0, 10.0, 19.0, 70.0, 30.0, -16.0, 20.0, 20.0, 75.0, 10.0, 18.0, 30.0, 30.0, 20.0, 26.0, 30.0, 3.0, 19.0, 15.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 38.0, 17.0, 8.0, 50.0, -4.0, 14.0, 20.0, 30.0, -12.0, 20.0, 30.0, 50.0, -8.0, 25.0, 25.0, 30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0, 18.0, 70.0, 0.0, 40.0, 20.0, 14.0, 26.0, 40.0, 29.0, 20.0, 40.0, 8.0, 20.0, 0.0, 10.0, 40.0, 20.0, 50.0, 20.0, -3.0, 20.0, 0.0, 20.0, 20.0, 20.0, 9.0, 20.0, -3.0, 70.0, 30.0, 20.0, 40.0, 20.0, 30.0, 20.0, 30.0, 50.0, 20.0, 10.0, 10.0, 20.0, 39.0, 29.0, 50.0, 50.0, 5.0, 20.0, 0.0, 10.0, 10.0, 40.0, 60.0, 24.0, 30.0, 0.0, -24.0, 10.0, 10.0, 20.0, 24.0, 10.0, 20.0, 33.0, 10.0, 20.0, 13.0, 40.0, 0.0, 10.0, 10.0, 90.0, 20.0, -1.0, 1.0, 30.0, 10.0, -1.0, 20.0, 17.0, 9.0, 30.0, 40.0, 10.0, 9.0, 50.0, 35.0, 30.0, 3.0, 30.0, 10.0, 40.0, 18.0, 20.0, 10.0, 40.0, 9.0, -3.0, 10.0, 70.0, 20.0, 20.0, 80.0, 40.0, 40.0, 30.0, 20.0, 40.0, 30.0, 10.0, 9.0, 40.0, 60.0, 25.0, 39.0, 20.0, 44.0, 40.0, -8.0, 60.0, 13.0, 12.0, 10.0, 28.0, 28.0, 0.0, 30.0, 26.0, 10.0, 9.0, 60.0, 28.0, 8.0, 50.0, 59.0, 18.0, 30.0, 58.0, 90.0, 90.0, 50.0, 40.0, 49.0, -1.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 50.0, 80.0, 70.0, 60.0, 20.0, 10.0, 10.0, 70.0, 10.0, 30.0, 10.0, 5.0, 10.0, 10.0, 10.0, 0.0, 40.0, -5.0, 60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8306262634307204, "mean_inference_ms": 1.927405360250289, "mean_action_processing_ms": 0.5959929521736439, "mean_env_wait_ms": 1.7043801333963733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01910257339477539, "StateBufferConnector_ms": 0.012464761734008789, "ViewRequirementAgentConnector_ms": 0.5520362854003906}, "num_episodes": 18, "episode_return_max": 481.0, "episode_return_min": 57.0, "episode_return_mean": 225.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.730067867326746, "num_env_steps_trained_throughput_per_sec": 18.730067867326746, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 220877.639, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220877.586, "sample_time_ms": 3262.356, "learn_time_ms": 217588.414, "learn_throughput": 18.383, "synch_weights_time_ms": 17.688}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "a22d3_00000", "date": "2024-08-06_00-01-53", "timestamp": 1722916913, "time_this_iter_s": 213.5685338973999, "time_total_s": 4705.932314872742, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4705.932314872742, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 34.08344370860927, "ram_util_percent": 78.02317880794702}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9595538189235966, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.686103306055323, "policy_loss": -0.010622846212384863, "vf_loss": 3.6951510600515576, "vf_explained_var": 0.0018603792142309447, "kl": 0.007875459491195221, "entropy": 1.1269127746042225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": 52.0, "episode_reward_mean": 228.52, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -33.0}, "policy_reward_max": {"policy_0": 119.0}, "policy_reward_mean": {"policy_0": 22.852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [241.0, 225.0, 268.0, 314.0, 144.0, 194.0, 282.0, 196.0, 227.0, 415.0, 194.0, 74.0, 229.0, 278.0, 186.0, 192.0, 243.0, 266.0, 129.0, 86.0, 346.0, 79.0, 57.0, 159.0, 207.0, 235.0, 286.0, 239.0, 260.0, 149.0, 240.0, 140.0, 246.0, 232.0, 206.0, 202.0, 230.0, 204.0, 88.0, 185.0, 325.0, 281.0, 220.0, 234.0, 255.0, 171.0, 247.0, 245.0, 110.0, 173.0, 294.0, 209.0, 329.0, 247.0, 365.0, 284.0, 288.0, 388.0, 174.0, 256.0, 243.0, 139.0, 194.0, 290.0, 277.0, 205.0, 206.0, 250.0, 233.0, 194.0, 166.0, 195.0, 247.0, 234.0, 319.0, 333.0, 213.0, 481.0, 158.0, 410.0, 120.0, 370.0, 220.0, 189.0, 167.0, 119.0, 52.0, 169.0, 235.0, 200.0, 281.0, 256.0, 279.0, 275.0, 120.0, 259.0, 290.0, 161.0, 337.0, 298.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [27.0, 20.0, 20.0, 30.0, 15.0, 0.0, -1.0, 10.0, 70.0, 50.0, 60.0, 17.0, 10.0, -6.0, -6.0, 20.0, 50.0, 10.0, 20.0, 50.0, 9.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 60.0, 30.0, 50.0, 8.0, 30.0, 39.0, 10.0, 39.0, 28.0, -7.0, 30.0, 0.0, 0.0, -5.0, 16.0, 40.0, 20.0, 10.0, 40.0, 20.0, -2.0, 40.0, 0.0, -3.0, 0.0, 40.0, 40.0, 30.0, 29.0, 40.0, 10.0, 25.0, 40.0, 40.0, -4.0, 80.0, 40.0, 18.0, -7.0, 8.0, 10.0, 20.0, 13.0, 28.0, 0.0, 60.0, 50.0, -3.0, 10.0, 11.0, 20.0, 50.0, 30.0, 20.0, 30.0, 20.0, 40.0, 0.0, 6.0, 80.0, 5.0, 30.0, 90.0, 20.0, 15.0, 15.0, 80.0, 10.0, 70.0, 11.0, 0.0, 7.0, 40.0, 0.0, 40.0, 0.0, 37.0, 50.0, 9.0, 6.0, 30.0, 0.0, -4.0, 10.0, 0.0, 0.0, 30.0, -4.0, 6.0, 50.0, 40.0, -13.0, 70.0, 13.0, 9.0, 28.0, -2.0, 13.0, 21.0, 5.0, 10.0, -9.0, 39.0, 60.0, 13.0, 60.0, 40.0, 50.0, 10.0, 0.0, -1.0, 30.0, 30.0, 30.0, 0.0, 20.0, 60.0, 20.0, -3.0, 50.0, 30.0, -5.0, 10.0, 11.0, 20.0, 30.0, 28.0, 8.0, 10.0, 20.0, 0.0, 32.0, 20.0, 40.0, 9.0, 30.0, 92.0, 0.0, 0.0, 15.0, 30.0, 0.0, 26.0, 25.0, 30.0, 20.0, 40.0, 20.0, 60.0, 20.0, 17.0, -33.0, 17.0, 40.0, 10.0, -2.0, 10.0, 0.0, 50.0, -13.0, 40.0, -20.0, 10.0, 50.0, 0.0, 0.0, 30.0, -11.0, 0.0, 38.0, 90.0, 10.0, 40.0, 30.0, 40.0, 48.0, 0.0, 20.0, 30.0, 10.0, 20.0, 2.0, 5.0, 0.0, 0.0, 9.0, 20.0, 10.0, 3.0, 6.0, -2.0, 10.0, 0.0, 5.0, -1.0, 29.0, 0.0, 10.0, 0.0, 6.0, 60.0, 40.0, -8.0, 10.0, 7.0, -6.0, 10.0, 30.0, 10.0, 9.0, 30.0, 30.0, 19.0, 20.0, 0.0, 40.0, 10.0, 40.0, 9.0, 28.0, 0.0, 0.0, 30.0, 40.0, 40.0, 20.0, 30.0, 29.0, 18.0, 40.0, 40.0, 20.0, 10.0, 10.0, 10.0, 50.0, 40.0, 20.0, 46.0, 60.0, 10.0, 70.0, 0.0, 14.0, 30.0, 37.0, -2.0, 10.0, 10.0, 30.0, 10.0, 30.0, 0.0, 10.0, 30.0, 50.0, 10.0, 60.0, 30.0, -4.0, 40.0, 40.0, 20.0, 9.0, 20.0, 0.0, 9.0, -5.0, 20.0, 0.0, 60.0, 0.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 20.0, -6.0, 10.0, 40.0, 15.0, 50.0, 0.0, 11.0, 25.0, 20.0, -25.0, 20.0, 10.0, 54.0, 70.0, 0.0, 50.0, -1.0, -1.0, 14.0, 30.0, 70.0, 10.0, 15.0, 30.0, 3.0, 18.0, 13.0, 30.0, 50.0, -7.0, 40.0, 20.0, -8.0, 25.0, 26.0, 20.0, 20.0, 10.0, 40.0, 13.0, 9.0, 10.0, 6.0, 40.0, -1.0, 70.0, 10.0, 8.0, 40.0, 10.0, 0.0, -2.0, 29.0, 30.0, -1.0, 50.0, 50.0, 37.0, 28.0, 9.0, 30.0, 40.0, 0.0, 10.0, 29.0, 13.0, 10.0, 60.0, 2.0, 10.0, 20.0, -1.0, 20.0, 50.0, 5.0, -4.0, -7.0, 10.0, 0.0, -5.0, 22.0, -3.0, 20.0, 20.0, 26.0, -3.0, 70.0, -2.0, 31.0, 4.0, -1.0, -10.0, 6.0, 62.0, 30.0, 90.0, 30.0, 70.0, 8.0, 40.0, 10.0, 8.0, 40.0, 20.0, 20.0, 26.0, 30.0, 38.0, 39.0, 50.0, 50.0, 40.0, 28.0, 27.0, 0.0, 20.0, 20.0, 15.0, 0.0, 20.0, 40.0, 0.0, 20.0, 26.0, 30.0, 10.0, 18.0, 30.0, 50.0, 10.0, 30.0, 14.0, 2.0, 10.0, 0.0, 60.0, 49.0, 60.0, 0.0, 30.0, 10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0, 40.0, 40.0, 35.0, 10.0, 30.0, 7.0, 40.0, 20.0, 5.0, 20.0, 50.0, 0.0, -2.0, 30.0, 9.0, 10.0, 30.0, 50.0, 70.0, -2.0, 8.0, 16.0, 10.0, 10.0, 4.0, 28.0, -2.0, 8.0, 3.0, 25.0, 30.0, 19.0, 50.0, 20.0, -3.0, 20.0, 27.0, 0.0, 10.0, 0.0, 119.0, 10.0, 0.0, 19.0, 9.0, 50.0, 0.0, 10.0, 27.0, 50.0, 60.0, 0.0, 10.0, 40.0, 15.0, -1.0, 10.0, 25.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 26.0, 0.0, 70.0, 20.0, 70.0, 33.0, 10.0, 30.0, 60.0, 20.0, 30.0, 10.0, -20.0, 50.0, 29.0, 28.0, 20.0, 67.0, 20.0, 17.0, 30.0, 60.0, 55.0, 80.0, -4.0, 20.0, 20.0, 20.0, 48.0, -2.0, 10.0, 40.0, 10.0, 70.0, 20.0, 48.0, 39.0, 10.0, 70.0, 60.0, 6.0, 20.0, 0.0, 36.0, 33.0, 14.0, 60.0, 80.0, -2.0, 60.0, 10.0, 40.0, 0.0, 20.0, 80.0, 40.0, 10.0, 0.0, 38.0, 4.0, 4.0, 0.0, 38.0, 0.0, 40.0, 40.0, 10.0, 19.0, 70.0, 30.0, -16.0, 20.0, 20.0, 75.0, 10.0, 18.0, 30.0, 30.0, 20.0, 26.0, 30.0, 3.0, 19.0, 15.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 38.0, 17.0, 8.0, 50.0, -4.0, 14.0, 20.0, 30.0, -12.0, 20.0, 30.0, 50.0, -8.0, 25.0, 25.0, 30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0, 18.0, 70.0, 0.0, 40.0, 20.0, 14.0, 26.0, 40.0, 29.0, 20.0, 40.0, 8.0, 20.0, 0.0, 10.0, 40.0, 20.0, 50.0, 20.0, -3.0, 20.0, 0.0, 20.0, 20.0, 20.0, 9.0, 20.0, -3.0, 70.0, 30.0, 20.0, 40.0, 20.0, 30.0, 20.0, 30.0, 50.0, 20.0, 10.0, 10.0, 20.0, 39.0, 29.0, 50.0, 50.0, 5.0, 20.0, 0.0, 10.0, 10.0, 40.0, 60.0, 24.0, 30.0, 0.0, -24.0, 10.0, 10.0, 20.0, 24.0, 10.0, 20.0, 33.0, 10.0, 20.0, 13.0, 40.0, 0.0, 10.0, 10.0, 90.0, 20.0, -1.0, 1.0, 30.0, 10.0, -1.0, 20.0, 17.0, 9.0, 30.0, 40.0, 10.0, 9.0, 50.0, 35.0, 30.0, 3.0, 30.0, 10.0, 40.0, 18.0, 20.0, 10.0, 40.0, 9.0, -3.0, 10.0, 70.0, 20.0, 20.0, 80.0, 40.0, 40.0, 30.0, 20.0, 40.0, 30.0, 10.0, 9.0, 40.0, 60.0, 25.0, 39.0, 20.0, 44.0, 40.0, -8.0, 60.0, 13.0, 12.0, 10.0, 28.0, 28.0, 0.0, 30.0, 26.0, 10.0, 9.0, 60.0, 28.0, 8.0, 50.0, 59.0, 18.0, 30.0, 58.0, 90.0, 90.0, 50.0, 40.0, 49.0, -1.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 50.0, 80.0, 70.0, 60.0, 20.0, 10.0, 10.0, 70.0, 10.0, 30.0, 10.0, 5.0, 10.0, 10.0, 10.0, 0.0, 40.0, -5.0, 60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 0.0, 50.0, -1.0, 22.0, 18.0, 19.0, 30.0, 11.0, 0.0, 20.0, 20.0, 20.0, 20.0, 27.0, 0.0, 30.0, 25.0, 7.0, 16.0, 5.0, 17.0, 0.0, 10.0, -22.0, 70.0, 20.0, 40.0, -4.0, 10.0, 0.0, -5.0, 0.0, 7.0, 10.0, 10.0, 8.0, 0.0, 10.0, 10.0, -1.0, -2.0, 4.0, 35.0, 20.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 40.0, 7.0, 6.0, 18.0, 40.0, -2.0, 26.0, 10.0, 60.0, 30.0, -4.0, 6.0, 10.0, 20.0, 20.0, 10.0, 40.0, 50.0, 8.0, 40.0, 30.0, 0.0, 20.0, 49.0, 7.0, -4.0, 10.0, 70.0, 49.0, 50.0, 30.0, 70.0, 20.0, 10.0, 20.0, 10.0, 8.0, 0.0, 50.0, 38.0, 30.0, 80.0, 10.0, 0.0, 0.0, 60.0, 0.0, 40.0, 40.0, 19.0, 50.0, 0.0, 0.0, -15.0, 50.0, 50.0, 70.0, 30.0, 10.0, 30.0, 30.0, 10.0, -1.0, 20.0, -7.0, 10.0, 38.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 0.0, 30.0, 70.0, 10.0, 20.0, 29.0, 30.0, 70.0, 20.0, 40.0, 50.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, -9.0, 1.0, 20.0, 9.0, 40.0, 0.0, 30.0, 40.0, 50.0, 20.0, 60.0, 10.0, 10.0, 38.0, 39.0, 50.0, 20.0, 20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8294637474703466, "mean_inference_ms": 1.9278302143620618, "mean_action_processing_ms": 0.5954760668982773, "mean_env_wait_ms": 1.7026424182230449, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017658710479736328, "StateBufferConnector_ms": 0.012378215789794922, "ViewRequirementAgentConnector_ms": 0.5665562152862549}, "num_episodes": 18, "episode_return_max": 481.0, "episode_return_min": 52.0, "episode_return_mean": 228.52}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.68924100370205, "num_env_steps_trained_throughput_per_sec": 18.68924100370205, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 220828.438, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220828.382, "sample_time_ms": 3319.549, "learn_time_ms": 217481.881, "learn_throughput": 18.392, "synch_weights_time_ms": 17.795}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "a22d3_00000", "date": "2024-08-06_00-05-27", "timestamp": 1722917127, "time_this_iter_s": 214.03479194641113, "time_total_s": 4919.967106819153, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b9dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4919.967106819153, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.08844884488449, "ram_util_percent": 78.56468646864687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8654046312307777, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2998356680519665, "policy_loss": -0.009394557146267237, "vf_loss": 3.307710835118644, "vf_explained_var": -0.007182896162628239, "kl": 0.007596946502298723, "entropy": 1.104553855423983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": 52.0, "episode_reward_mean": 232.22, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -25.0}, "policy_reward_max": {"policy_0": 119.0}, "policy_reward_mean": {"policy_0": 23.222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [239.0, 260.0, 149.0, 240.0, 140.0, 246.0, 232.0, 206.0, 202.0, 230.0, 204.0, 88.0, 185.0, 325.0, 281.0, 220.0, 234.0, 255.0, 171.0, 247.0, 245.0, 110.0, 173.0, 294.0, 209.0, 329.0, 247.0, 365.0, 284.0, 288.0, 388.0, 174.0, 256.0, 243.0, 139.0, 194.0, 290.0, 277.0, 205.0, 206.0, 250.0, 233.0, 194.0, 166.0, 195.0, 247.0, 234.0, 319.0, 333.0, 213.0, 481.0, 158.0, 410.0, 120.0, 370.0, 220.0, 189.0, 167.0, 119.0, 52.0, 169.0, 235.0, 200.0, 281.0, 256.0, 279.0, 275.0, 120.0, 259.0, 290.0, 161.0, 337.0, 298.0, 190.0, 249.0, 180.0, 186.0, 153.0, 300.0, 251.0, 210.0, 292.0, 338.0, 174.0, 216.0, 230.0, 124.0, 240.0, 159.0, 206.0, 66.0, 185.0, 292.0, 175.0, 406.0, 270.0, 370.0, 195.0, 295.0, 170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 10.0, 70.0, 0.0, 14.0, 30.0, 37.0, -2.0, 10.0, 10.0, 30.0, 10.0, 30.0, 0.0, 10.0, 30.0, 50.0, 10.0, 60.0, 30.0, -4.0, 40.0, 40.0, 20.0, 9.0, 20.0, 0.0, 9.0, -5.0, 20.0, 0.0, 60.0, 0.0, 40.0, 20.0, 30.0, 10.0, 50.0, 10.0, 20.0, -6.0, 10.0, 40.0, 15.0, 50.0, 0.0, 11.0, 25.0, 20.0, -25.0, 20.0, 10.0, 54.0, 70.0, 0.0, 50.0, -1.0, -1.0, 14.0, 30.0, 70.0, 10.0, 15.0, 30.0, 3.0, 18.0, 13.0, 30.0, 50.0, -7.0, 40.0, 20.0, -8.0, 25.0, 26.0, 20.0, 20.0, 10.0, 40.0, 13.0, 9.0, 10.0, 6.0, 40.0, -1.0, 70.0, 10.0, 8.0, 40.0, 10.0, 0.0, -2.0, 29.0, 30.0, -1.0, 50.0, 50.0, 37.0, 28.0, 9.0, 30.0, 40.0, 0.0, 10.0, 29.0, 13.0, 10.0, 60.0, 2.0, 10.0, 20.0, -1.0, 20.0, 50.0, 5.0, -4.0, -7.0, 10.0, 0.0, -5.0, 22.0, -3.0, 20.0, 20.0, 26.0, -3.0, 70.0, -2.0, 31.0, 4.0, -1.0, -10.0, 6.0, 62.0, 30.0, 90.0, 30.0, 70.0, 8.0, 40.0, 10.0, 8.0, 40.0, 20.0, 20.0, 26.0, 30.0, 38.0, 39.0, 50.0, 50.0, 40.0, 28.0, 27.0, 0.0, 20.0, 20.0, 15.0, 0.0, 20.0, 40.0, 0.0, 20.0, 26.0, 30.0, 10.0, 18.0, 30.0, 50.0, 10.0, 30.0, 14.0, 2.0, 10.0, 0.0, 60.0, 49.0, 60.0, 0.0, 30.0, 10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0, 40.0, 40.0, 35.0, 10.0, 30.0, 7.0, 40.0, 20.0, 5.0, 20.0, 50.0, 0.0, -2.0, 30.0, 9.0, 10.0, 30.0, 50.0, 70.0, -2.0, 8.0, 16.0, 10.0, 10.0, 4.0, 28.0, -2.0, 8.0, 3.0, 25.0, 30.0, 19.0, 50.0, 20.0, -3.0, 20.0, 27.0, 0.0, 10.0, 0.0, 119.0, 10.0, 0.0, 19.0, 9.0, 50.0, 0.0, 10.0, 27.0, 50.0, 60.0, 0.0, 10.0, 40.0, 15.0, -1.0, 10.0, 25.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 26.0, 0.0, 70.0, 20.0, 70.0, 33.0, 10.0, 30.0, 60.0, 20.0, 30.0, 10.0, -20.0, 50.0, 29.0, 28.0, 20.0, 67.0, 20.0, 17.0, 30.0, 60.0, 55.0, 80.0, -4.0, 20.0, 20.0, 20.0, 48.0, -2.0, 10.0, 40.0, 10.0, 70.0, 20.0, 48.0, 39.0, 10.0, 70.0, 60.0, 6.0, 20.0, 0.0, 36.0, 33.0, 14.0, 60.0, 80.0, -2.0, 60.0, 10.0, 40.0, 0.0, 20.0, 80.0, 40.0, 10.0, 0.0, 38.0, 4.0, 4.0, 0.0, 38.0, 0.0, 40.0, 40.0, 10.0, 19.0, 70.0, 30.0, -16.0, 20.0, 20.0, 75.0, 10.0, 18.0, 30.0, 30.0, 20.0, 26.0, 30.0, 3.0, 19.0, 15.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 38.0, 17.0, 8.0, 50.0, -4.0, 14.0, 20.0, 30.0, -12.0, 20.0, 30.0, 50.0, -8.0, 25.0, 25.0, 30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0, 18.0, 70.0, 0.0, 40.0, 20.0, 14.0, 26.0, 40.0, 29.0, 20.0, 40.0, 8.0, 20.0, 0.0, 10.0, 40.0, 20.0, 50.0, 20.0, -3.0, 20.0, 0.0, 20.0, 20.0, 20.0, 9.0, 20.0, -3.0, 70.0, 30.0, 20.0, 40.0, 20.0, 30.0, 20.0, 30.0, 50.0, 20.0, 10.0, 10.0, 20.0, 39.0, 29.0, 50.0, 50.0, 5.0, 20.0, 0.0, 10.0, 10.0, 40.0, 60.0, 24.0, 30.0, 0.0, -24.0, 10.0, 10.0, 20.0, 24.0, 10.0, 20.0, 33.0, 10.0, 20.0, 13.0, 40.0, 0.0, 10.0, 10.0, 90.0, 20.0, -1.0, 1.0, 30.0, 10.0, -1.0, 20.0, 17.0, 9.0, 30.0, 40.0, 10.0, 9.0, 50.0, 35.0, 30.0, 3.0, 30.0, 10.0, 40.0, 18.0, 20.0, 10.0, 40.0, 9.0, -3.0, 10.0, 70.0, 20.0, 20.0, 80.0, 40.0, 40.0, 30.0, 20.0, 40.0, 30.0, 10.0, 9.0, 40.0, 60.0, 25.0, 39.0, 20.0, 44.0, 40.0, -8.0, 60.0, 13.0, 12.0, 10.0, 28.0, 28.0, 0.0, 30.0, 26.0, 10.0, 9.0, 60.0, 28.0, 8.0, 50.0, 59.0, 18.0, 30.0, 58.0, 90.0, 90.0, 50.0, 40.0, 49.0, -1.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 50.0, 80.0, 70.0, 60.0, 20.0, 10.0, 10.0, 70.0, 10.0, 30.0, 10.0, 5.0, 10.0, 10.0, 10.0, 0.0, 40.0, -5.0, 60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 0.0, 50.0, -1.0, 22.0, 18.0, 19.0, 30.0, 11.0, 0.0, 20.0, 20.0, 20.0, 20.0, 27.0, 0.0, 30.0, 25.0, 7.0, 16.0, 5.0, 17.0, 0.0, 10.0, -22.0, 70.0, 20.0, 40.0, -4.0, 10.0, 0.0, -5.0, 0.0, 7.0, 10.0, 10.0, 8.0, 0.0, 10.0, 10.0, -1.0, -2.0, 4.0, 35.0, 20.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 40.0, 7.0, 6.0, 18.0, 40.0, -2.0, 26.0, 10.0, 60.0, 30.0, -4.0, 6.0, 10.0, 20.0, 20.0, 10.0, 40.0, 50.0, 8.0, 40.0, 30.0, 0.0, 20.0, 49.0, 7.0, -4.0, 10.0, 70.0, 49.0, 50.0, 30.0, 70.0, 20.0, 10.0, 20.0, 10.0, 8.0, 0.0, 50.0, 38.0, 30.0, 80.0, 10.0, 0.0, 0.0, 60.0, 0.0, 40.0, 40.0, 19.0, 50.0, 0.0, 0.0, -15.0, 50.0, 50.0, 70.0, 30.0, 10.0, 30.0, 30.0, 10.0, -1.0, 20.0, -7.0, 10.0, 38.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 0.0, 30.0, 70.0, 10.0, 20.0, 29.0, 30.0, 70.0, 20.0, 40.0, 50.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, -9.0, 1.0, 20.0, 9.0, 40.0, 0.0, 30.0, 40.0, 50.0, 20.0, 60.0, 10.0, 10.0, 38.0, 39.0, 50.0, 20.0, 20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0, 20.0, 80.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 40.0, 70.0, 39.0, 10.0, 10.0, 20.0, -5.0, 15.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 30.0, 29.0, 10.0, 30.0, 20.0, 19.0, -2.0, 30.0, 20.0, 30.0, 0.0, 20.0, 9.0, -1.0, 9.0, 49.0, 0.0, 20.0, 0.0, 37.0, 10.0, 90.0, 29.0, -3.0, 20.0, 30.0, 70.0, 6.0, 6.0, 15.0, 37.0, 20.0, 60.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 21.0, 30.0, 49.0, 10.0, 19.0, -2.0, 29.0, 19.0, 18.0, 30.0, 20.0, 18.0, 40.0, 37.0, 60.0, 27.0, 16.0, 16.0, 30.0, 40.0, -3.0, 29.0, 30.0, 60.0, 40.0, 20.0, 40.0, 29.0, 29.0, 10.0, 50.0, 30.0, -2.0, 10.0, -1.0, 20.0, 20.0, 17.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 39.0, 40.0, 50.0, 10.0, -1.0, 19.0, 20.0, 19.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, -2.0, 0.0, 6.0, 30.0, 7.0, 26.0, 16.0, -10.0, 40.0, 11.0, 20.0, 75.0, 30.0, 40.0, 10.0, 19.0, 10.0, 0.0, 37.0, -1.0, -1.0, 6.0, 1.0, -20.0, 20.0, 50.0, 40.0, -1.0, 34.0, 30.0, 38.0, 0.0, 20.0, 10.0, 19.0, 9.0, 50.0, 10.0, 0.0, 50.0, 0.0, 10.0, 6.0, 20.0, 10.0, 5.0, 0.0, 8.0, 10.0, -3.0, 0.0, 10.0, 17.0, 23.0, 27.0, 30.0, 30.0, 20.0, 19.0, 9.0, 39.0, 25.0, 9.0, 50.0, 30.0, 19.0, 50.0, 30.0, 30.0, 10.0, -1.0, 37.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 39.0, 65.0, 18.0, 70.0, 78.0, 30.0, 25.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 50.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 80.0, 60.0, 60.0, 40.0, 0.0, 80.0, 10.0, 5.0, -3.0, 5.0, 28.0, 40.0, 20.0, 10.0, 40.0, 15.0, 30.0, 28.0, 45.0, 5.0, 22.0, 60.0, 30.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8287820643811605, "mean_inference_ms": 1.9247055143930754, "mean_action_processing_ms": 0.5946879749477505, "mean_env_wait_ms": 1.701571670648219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017145395278930664, "StateBufferConnector_ms": 0.01247859001159668, "ViewRequirementAgentConnector_ms": 0.5454754829406738}, "num_episodes": 27, "episode_return_max": 481.0, "episode_return_min": 52.0, "episode_return_mean": 232.22}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.772366628253835, "num_env_steps_trained_throughput_per_sec": 18.772366628253835, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 220413.734, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220413.678, "sample_time_ms": 3332.904, "learn_time_ms": 217053.955, "learn_throughput": 18.429, "synch_weights_time_ms": 17.613}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "a22d3_00000", "date": "2024-08-06_00-09-00", "timestamp": 1722917340, "time_this_iter_s": 213.0856738090515, "time_total_s": 5133.052780628204, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a013d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5133.052780628204, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 31.635548172757474, "ram_util_percent": 78.83488372093024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7768269518820747, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.169002585720838, "policy_loss": -0.010639601404589222, "vf_loss": 4.178041614739659, "vf_explained_var": -0.00031979563898933583, "kl": 0.0080028494061366, "entropy": 1.0580632954359817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": 52.0, "episode_reward_mean": 239.44, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -24.0}, "policy_reward_max": {"policy_0": 119.0}, "policy_reward_mean": {"policy_0": 23.944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.0, 247.0, 245.0, 110.0, 173.0, 294.0, 209.0, 329.0, 247.0, 365.0, 284.0, 288.0, 388.0, 174.0, 256.0, 243.0, 139.0, 194.0, 290.0, 277.0, 205.0, 206.0, 250.0, 233.0, 194.0, 166.0, 195.0, 247.0, 234.0, 319.0, 333.0, 213.0, 481.0, 158.0, 410.0, 120.0, 370.0, 220.0, 189.0, 167.0, 119.0, 52.0, 169.0, 235.0, 200.0, 281.0, 256.0, 279.0, 275.0, 120.0, 259.0, 290.0, 161.0, 337.0, 298.0, 190.0, 249.0, 180.0, 186.0, 153.0, 300.0, 251.0, 210.0, 292.0, 338.0, 174.0, 216.0, 230.0, 124.0, 240.0, 159.0, 206.0, 66.0, 185.0, 292.0, 175.0, 406.0, 270.0, 370.0, 195.0, 295.0, 170.0, 400.0, 356.0, 310.0, 312.0, 335.0, 228.0, 182.0, 297.0, 202.0, 250.0, 300.0, 285.0, 237.0, 245.0, 283.0, 127.0, 208.0, 101.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 28.0, 10.0, -1.0, 60.0, 19.0, 0.0, 9.0, 38.0, -2.0, 40.0, 40.0, 35.0, 10.0, 30.0, 7.0, 40.0, 20.0, 5.0, 20.0, 50.0, 0.0, -2.0, 30.0, 9.0, 10.0, 30.0, 50.0, 70.0, -2.0, 8.0, 16.0, 10.0, 10.0, 4.0, 28.0, -2.0, 8.0, 3.0, 25.0, 30.0, 19.0, 50.0, 20.0, -3.0, 20.0, 27.0, 0.0, 10.0, 0.0, 119.0, 10.0, 0.0, 19.0, 9.0, 50.0, 0.0, 10.0, 27.0, 50.0, 60.0, 0.0, 10.0, 40.0, 15.0, -1.0, 10.0, 25.0, 10.0, 40.0, 30.0, 10.0, 0.0, 70.0, 26.0, 0.0, 70.0, 20.0, 70.0, 33.0, 10.0, 30.0, 60.0, 20.0, 30.0, 10.0, -20.0, 50.0, 29.0, 28.0, 20.0, 67.0, 20.0, 17.0, 30.0, 60.0, 55.0, 80.0, -4.0, 20.0, 20.0, 20.0, 48.0, -2.0, 10.0, 40.0, 10.0, 70.0, 20.0, 48.0, 39.0, 10.0, 70.0, 60.0, 6.0, 20.0, 0.0, 36.0, 33.0, 14.0, 60.0, 80.0, -2.0, 60.0, 10.0, 40.0, 0.0, 20.0, 80.0, 40.0, 10.0, 0.0, 38.0, 4.0, 4.0, 0.0, 38.0, 0.0, 40.0, 40.0, 10.0, 19.0, 70.0, 30.0, -16.0, 20.0, 20.0, 75.0, 10.0, 18.0, 30.0, 30.0, 20.0, 26.0, 30.0, 3.0, 19.0, 15.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 38.0, 17.0, 8.0, 50.0, -4.0, 14.0, 20.0, 30.0, -12.0, 20.0, 30.0, 50.0, -8.0, 25.0, 25.0, 30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0, 18.0, 70.0, 0.0, 40.0, 20.0, 14.0, 26.0, 40.0, 29.0, 20.0, 40.0, 8.0, 20.0, 0.0, 10.0, 40.0, 20.0, 50.0, 20.0, -3.0, 20.0, 0.0, 20.0, 20.0, 20.0, 9.0, 20.0, -3.0, 70.0, 30.0, 20.0, 40.0, 20.0, 30.0, 20.0, 30.0, 50.0, 20.0, 10.0, 10.0, 20.0, 39.0, 29.0, 50.0, 50.0, 5.0, 20.0, 0.0, 10.0, 10.0, 40.0, 60.0, 24.0, 30.0, 0.0, -24.0, 10.0, 10.0, 20.0, 24.0, 10.0, 20.0, 33.0, 10.0, 20.0, 13.0, 40.0, 0.0, 10.0, 10.0, 90.0, 20.0, -1.0, 1.0, 30.0, 10.0, -1.0, 20.0, 17.0, 9.0, 30.0, 40.0, 10.0, 9.0, 50.0, 35.0, 30.0, 3.0, 30.0, 10.0, 40.0, 18.0, 20.0, 10.0, 40.0, 9.0, -3.0, 10.0, 70.0, 20.0, 20.0, 80.0, 40.0, 40.0, 30.0, 20.0, 40.0, 30.0, 10.0, 9.0, 40.0, 60.0, 25.0, 39.0, 20.0, 44.0, 40.0, -8.0, 60.0, 13.0, 12.0, 10.0, 28.0, 28.0, 0.0, 30.0, 26.0, 10.0, 9.0, 60.0, 28.0, 8.0, 50.0, 59.0, 18.0, 30.0, 58.0, 90.0, 90.0, 50.0, 40.0, 49.0, -1.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 50.0, 80.0, 70.0, 60.0, 20.0, 10.0, 10.0, 70.0, 10.0, 30.0, 10.0, 5.0, 10.0, 10.0, 10.0, 0.0, 40.0, -5.0, 60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 0.0, 50.0, -1.0, 22.0, 18.0, 19.0, 30.0, 11.0, 0.0, 20.0, 20.0, 20.0, 20.0, 27.0, 0.0, 30.0, 25.0, 7.0, 16.0, 5.0, 17.0, 0.0, 10.0, -22.0, 70.0, 20.0, 40.0, -4.0, 10.0, 0.0, -5.0, 0.0, 7.0, 10.0, 10.0, 8.0, 0.0, 10.0, 10.0, -1.0, -2.0, 4.0, 35.0, 20.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 40.0, 7.0, 6.0, 18.0, 40.0, -2.0, 26.0, 10.0, 60.0, 30.0, -4.0, 6.0, 10.0, 20.0, 20.0, 10.0, 40.0, 50.0, 8.0, 40.0, 30.0, 0.0, 20.0, 49.0, 7.0, -4.0, 10.0, 70.0, 49.0, 50.0, 30.0, 70.0, 20.0, 10.0, 20.0, 10.0, 8.0, 0.0, 50.0, 38.0, 30.0, 80.0, 10.0, 0.0, 0.0, 60.0, 0.0, 40.0, 40.0, 19.0, 50.0, 0.0, 0.0, -15.0, 50.0, 50.0, 70.0, 30.0, 10.0, 30.0, 30.0, 10.0, -1.0, 20.0, -7.0, 10.0, 38.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 0.0, 30.0, 70.0, 10.0, 20.0, 29.0, 30.0, 70.0, 20.0, 40.0, 50.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, -9.0, 1.0, 20.0, 9.0, 40.0, 0.0, 30.0, 40.0, 50.0, 20.0, 60.0, 10.0, 10.0, 38.0, 39.0, 50.0, 20.0, 20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0, 20.0, 80.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 40.0, 70.0, 39.0, 10.0, 10.0, 20.0, -5.0, 15.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 30.0, 29.0, 10.0, 30.0, 20.0, 19.0, -2.0, 30.0, 20.0, 30.0, 0.0, 20.0, 9.0, -1.0, 9.0, 49.0, 0.0, 20.0, 0.0, 37.0, 10.0, 90.0, 29.0, -3.0, 20.0, 30.0, 70.0, 6.0, 6.0, 15.0, 37.0, 20.0, 60.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 21.0, 30.0, 49.0, 10.0, 19.0, -2.0, 29.0, 19.0, 18.0, 30.0, 20.0, 18.0, 40.0, 37.0, 60.0, 27.0, 16.0, 16.0, 30.0, 40.0, -3.0, 29.0, 30.0, 60.0, 40.0, 20.0, 40.0, 29.0, 29.0, 10.0, 50.0, 30.0, -2.0, 10.0, -1.0, 20.0, 20.0, 17.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 39.0, 40.0, 50.0, 10.0, -1.0, 19.0, 20.0, 19.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, -2.0, 0.0, 6.0, 30.0, 7.0, 26.0, 16.0, -10.0, 40.0, 11.0, 20.0, 75.0, 30.0, 40.0, 10.0, 19.0, 10.0, 0.0, 37.0, -1.0, -1.0, 6.0, 1.0, -20.0, 20.0, 50.0, 40.0, -1.0, 34.0, 30.0, 38.0, 0.0, 20.0, 10.0, 19.0, 9.0, 50.0, 10.0, 0.0, 50.0, 0.0, 10.0, 6.0, 20.0, 10.0, 5.0, 0.0, 8.0, 10.0, -3.0, 0.0, 10.0, 17.0, 23.0, 27.0, 30.0, 30.0, 20.0, 19.0, 9.0, 39.0, 25.0, 9.0, 50.0, 30.0, 19.0, 50.0, 30.0, 30.0, 10.0, -1.0, 37.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 39.0, 65.0, 18.0, 70.0, 78.0, 30.0, 25.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 50.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 80.0, 60.0, 60.0, 40.0, 0.0, 80.0, 10.0, 5.0, -3.0, 5.0, 28.0, 40.0, 20.0, 10.0, 40.0, 15.0, 30.0, 28.0, 45.0, 5.0, 22.0, 60.0, 30.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 70.0, 80.0, 30.0, 20.0, 50.0, 30.0, 30.0, 40.0, 20.0, 30.0, 10.0, 0.0, 49.0, 19.0, 60.0, 40.0, 20.0, 90.0, 28.0, 40.0, 70.0, 19.0, 40.0, 38.0, 0.0, 0.0, 60.0, 23.0, 20.0, 40.0, 50.0, 40.0, 21.0, 29.0, 4.0, 8.0, 60.0, 40.0, 30.0, 30.0, 60.0, 20.0, 22.0, 90.0, 40.0, 40.0, 36.0, 28.0, 10.0, -11.0, 30.0, 20.0, 10.0, 29.0, 10.0, 30.0, 20.0, 0.0, 50.0, 29.0, 50.0, 30.0, 8.0, 10.0, 10.0, 0.0, 27.0, 39.0, 8.0, 0.0, 60.0, 20.0, 20.0, 10.0, 19.0, 30.0, 20.0, 20.0, 38.0, 60.0, 27.0, 30.0, 10.0, 40.0, 10.0, 10.0, 17.0, 8.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 10.0, 50.0, 30.0, 30.0, 30.0, 30.0, 30.0, 40.0, 30.0, 60.0, 50.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 20.0, 25.0, 40.0, 40.0, 30.0, 50.0, 50.0, 20.0, 50.0, 49.0, 40.0, 9.0, 0.0, 29.0, 0.0, 20.0, 20.0, 5.0, 10.0, 50.0, 10.0, 10.0, 50.0, 10.0, 90.0, 0.0, 10.0, -4.0, 10.0, 17.0, 60.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, -1.0, 26.0, 10.0, 0.0, 36.0, 10.0, -1.0, 20.0, 12.0, 15.0, 18.0, 0.0, 19.0, -6.0, 50.0, 0.0, 40.0, 37.0, 10.0, 40.0, 0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.830903326196734, "mean_inference_ms": 1.9282283765439765, "mean_action_processing_ms": 0.6010312220544394, "mean_env_wait_ms": 1.6995007072048407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015459775924682617, "StateBufferConnector_ms": 0.012340784072875977, "ViewRequirementAgentConnector_ms": 0.5253472328186035}, "num_episodes": 18, "episode_return_max": 481.0, "episode_return_min": 52.0, "episode_return_mean": 239.44}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.573423787159722, "num_env_steps_trained_throughput_per_sec": 18.573423787159722, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 220484.927, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220484.871, "sample_time_ms": 3384.98, "learn_time_ms": 217073.215, "learn_throughput": 18.427, "synch_weights_time_ms": 17.478}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "a22d3_00000", "date": "2024-08-06_00-12-35", "timestamp": 1722917555, "time_this_iter_s": 215.37043976783752, "time_total_s": 5348.423220396042, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a013de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5348.423220396042, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 31.11245901639344, "ram_util_percent": 78.72393442622952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.79640088730092, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.851685428873292, "policy_loss": -0.009763007887953513, "vf_loss": 3.8599442606916825, "vf_explained_var": -0.005636759884695149, "kl": 0.007520875856228227, "entropy": 1.0673959305111211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 481.0, "episode_reward_min": 52.0, "episode_reward_mean": 246.24, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -24.0}, "policy_reward_max": {"policy_0": 90.0}, "policy_reward_mean": {"policy_0": 24.624}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 277.0, 205.0, 206.0, 250.0, 233.0, 194.0, 166.0, 195.0, 247.0, 234.0, 319.0, 333.0, 213.0, 481.0, 158.0, 410.0, 120.0, 370.0, 220.0, 189.0, 167.0, 119.0, 52.0, 169.0, 235.0, 200.0, 281.0, 256.0, 279.0, 275.0, 120.0, 259.0, 290.0, 161.0, 337.0, 298.0, 190.0, 249.0, 180.0, 186.0, 153.0, 300.0, 251.0, 210.0, 292.0, 338.0, 174.0, 216.0, 230.0, 124.0, 240.0, 159.0, 206.0, 66.0, 185.0, 292.0, 175.0, 406.0, 270.0, 370.0, 195.0, 295.0, 170.0, 400.0, 356.0, 310.0, 312.0, 335.0, 228.0, 182.0, 297.0, 202.0, 250.0, 300.0, 285.0, 237.0, 245.0, 283.0, 127.0, 208.0, 101.0, 278.0, 360.0, 278.0, 348.0, 274.0, 359.0, 240.0, 380.0, 240.0, 400.0, 137.0, 399.0, 226.0, 148.0, 341.0, 227.0, 210.0, 191.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 20.0, 60.0, 18.0, 70.0, 0.0, 40.0, 20.0, 14.0, 26.0, 40.0, 29.0, 20.0, 40.0, 8.0, 20.0, 0.0, 10.0, 40.0, 20.0, 50.0, 20.0, -3.0, 20.0, 0.0, 20.0, 20.0, 20.0, 9.0, 20.0, -3.0, 70.0, 30.0, 20.0, 40.0, 20.0, 30.0, 20.0, 30.0, 50.0, 20.0, 10.0, 10.0, 20.0, 39.0, 29.0, 50.0, 50.0, 5.0, 20.0, 0.0, 10.0, 10.0, 40.0, 60.0, 24.0, 30.0, 0.0, -24.0, 10.0, 10.0, 20.0, 24.0, 10.0, 20.0, 33.0, 10.0, 20.0, 13.0, 40.0, 0.0, 10.0, 10.0, 90.0, 20.0, -1.0, 1.0, 30.0, 10.0, -1.0, 20.0, 17.0, 9.0, 30.0, 40.0, 10.0, 9.0, 50.0, 35.0, 30.0, 3.0, 30.0, 10.0, 40.0, 18.0, 20.0, 10.0, 40.0, 9.0, -3.0, 10.0, 70.0, 20.0, 20.0, 80.0, 40.0, 40.0, 30.0, 20.0, 40.0, 30.0, 10.0, 9.0, 40.0, 60.0, 25.0, 39.0, 20.0, 44.0, 40.0, -8.0, 60.0, 13.0, 12.0, 10.0, 28.0, 28.0, 0.0, 30.0, 26.0, 10.0, 9.0, 60.0, 28.0, 8.0, 50.0, 59.0, 18.0, 30.0, 58.0, 90.0, 90.0, 50.0, 40.0, 49.0, -1.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 50.0, 80.0, 70.0, 60.0, 20.0, 10.0, 10.0, 70.0, 10.0, 30.0, 10.0, 5.0, 10.0, 10.0, 10.0, 0.0, 40.0, -5.0, 60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 0.0, 50.0, -1.0, 22.0, 18.0, 19.0, 30.0, 11.0, 0.0, 20.0, 20.0, 20.0, 20.0, 27.0, 0.0, 30.0, 25.0, 7.0, 16.0, 5.0, 17.0, 0.0, 10.0, -22.0, 70.0, 20.0, 40.0, -4.0, 10.0, 0.0, -5.0, 0.0, 7.0, 10.0, 10.0, 8.0, 0.0, 10.0, 10.0, -1.0, -2.0, 4.0, 35.0, 20.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 40.0, 7.0, 6.0, 18.0, 40.0, -2.0, 26.0, 10.0, 60.0, 30.0, -4.0, 6.0, 10.0, 20.0, 20.0, 10.0, 40.0, 50.0, 8.0, 40.0, 30.0, 0.0, 20.0, 49.0, 7.0, -4.0, 10.0, 70.0, 49.0, 50.0, 30.0, 70.0, 20.0, 10.0, 20.0, 10.0, 8.0, 0.0, 50.0, 38.0, 30.0, 80.0, 10.0, 0.0, 0.0, 60.0, 0.0, 40.0, 40.0, 19.0, 50.0, 0.0, 0.0, -15.0, 50.0, 50.0, 70.0, 30.0, 10.0, 30.0, 30.0, 10.0, -1.0, 20.0, -7.0, 10.0, 38.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 0.0, 30.0, 70.0, 10.0, 20.0, 29.0, 30.0, 70.0, 20.0, 40.0, 50.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, -9.0, 1.0, 20.0, 9.0, 40.0, 0.0, 30.0, 40.0, 50.0, 20.0, 60.0, 10.0, 10.0, 38.0, 39.0, 50.0, 20.0, 20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0, 20.0, 80.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 40.0, 70.0, 39.0, 10.0, 10.0, 20.0, -5.0, 15.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 30.0, 29.0, 10.0, 30.0, 20.0, 19.0, -2.0, 30.0, 20.0, 30.0, 0.0, 20.0, 9.0, -1.0, 9.0, 49.0, 0.0, 20.0, 0.0, 37.0, 10.0, 90.0, 29.0, -3.0, 20.0, 30.0, 70.0, 6.0, 6.0, 15.0, 37.0, 20.0, 60.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 21.0, 30.0, 49.0, 10.0, 19.0, -2.0, 29.0, 19.0, 18.0, 30.0, 20.0, 18.0, 40.0, 37.0, 60.0, 27.0, 16.0, 16.0, 30.0, 40.0, -3.0, 29.0, 30.0, 60.0, 40.0, 20.0, 40.0, 29.0, 29.0, 10.0, 50.0, 30.0, -2.0, 10.0, -1.0, 20.0, 20.0, 17.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 39.0, 40.0, 50.0, 10.0, -1.0, 19.0, 20.0, 19.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, -2.0, 0.0, 6.0, 30.0, 7.0, 26.0, 16.0, -10.0, 40.0, 11.0, 20.0, 75.0, 30.0, 40.0, 10.0, 19.0, 10.0, 0.0, 37.0, -1.0, -1.0, 6.0, 1.0, -20.0, 20.0, 50.0, 40.0, -1.0, 34.0, 30.0, 38.0, 0.0, 20.0, 10.0, 19.0, 9.0, 50.0, 10.0, 0.0, 50.0, 0.0, 10.0, 6.0, 20.0, 10.0, 5.0, 0.0, 8.0, 10.0, -3.0, 0.0, 10.0, 17.0, 23.0, 27.0, 30.0, 30.0, 20.0, 19.0, 9.0, 39.0, 25.0, 9.0, 50.0, 30.0, 19.0, 50.0, 30.0, 30.0, 10.0, -1.0, 37.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 39.0, 65.0, 18.0, 70.0, 78.0, 30.0, 25.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 50.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 80.0, 60.0, 60.0, 40.0, 0.0, 80.0, 10.0, 5.0, -3.0, 5.0, 28.0, 40.0, 20.0, 10.0, 40.0, 15.0, 30.0, 28.0, 45.0, 5.0, 22.0, 60.0, 30.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 70.0, 80.0, 30.0, 20.0, 50.0, 30.0, 30.0, 40.0, 20.0, 30.0, 10.0, 0.0, 49.0, 19.0, 60.0, 40.0, 20.0, 90.0, 28.0, 40.0, 70.0, 19.0, 40.0, 38.0, 0.0, 0.0, 60.0, 23.0, 20.0, 40.0, 50.0, 40.0, 21.0, 29.0, 4.0, 8.0, 60.0, 40.0, 30.0, 30.0, 60.0, 20.0, 22.0, 90.0, 40.0, 40.0, 36.0, 28.0, 10.0, -11.0, 30.0, 20.0, 10.0, 29.0, 10.0, 30.0, 20.0, 0.0, 50.0, 29.0, 50.0, 30.0, 8.0, 10.0, 10.0, 0.0, 27.0, 39.0, 8.0, 0.0, 60.0, 20.0, 20.0, 10.0, 19.0, 30.0, 20.0, 20.0, 38.0, 60.0, 27.0, 30.0, 10.0, 40.0, 10.0, 10.0, 17.0, 8.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 10.0, 50.0, 30.0, 30.0, 30.0, 30.0, 30.0, 40.0, 30.0, 60.0, 50.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 20.0, 25.0, 40.0, 40.0, 30.0, 50.0, 50.0, 20.0, 50.0, 49.0, 40.0, 9.0, 0.0, 29.0, 0.0, 20.0, 20.0, 5.0, 10.0, 50.0, 10.0, 10.0, 50.0, 10.0, 90.0, 0.0, 10.0, -4.0, 10.0, 17.0, 60.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, -1.0, 26.0, 10.0, 0.0, 36.0, 10.0, -1.0, 20.0, 12.0, 15.0, 18.0, 0.0, 19.0, -6.0, 50.0, 0.0, 40.0, 37.0, 10.0, 40.0, 0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0, 70.0, 10.0, 22.0, 30.0, -4.0, 0.0, 40.0, 10.0, 70.0, 30.0, 40.0, 20.0, 39.0, 10.0, 18.0, 14.0, 70.0, 80.0, 9.0, 60.0, 30.0, 20.0, 40.0, 10.0, 29.0, 40.0, 30.0, 20.0, 30.0, 29.0, 38.0, 30.0, 20.0, 10.0, 80.0, 20.0, 60.0, 60.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, -15.0, 59.0, 10.0, 0.0, 40.0, 20.0, 70.0, 10.0, 70.0, 30.0, 30.0, 40.0, 20.0, 50.0, 9.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 60.0, 50.0, 0.0, 70.0, 30.0, 20.0, 50.0, 60.0, 10.0, 80.0, 10.0, 10.0, 70.0, 30.0, 60.0, 10.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 50.0, 30.0, 60.0, 40.0, 60.0, 20.0, 50.0, 10.0, 40.0, -7.0, 60.0, 28.0, 30.0, 0.0, 9.0, 10.0, 0.0, -21.0, 28.0, 20.0, 50.0, 40.0, 17.0, 36.0, 20.0, 80.0, 8.0, 80.0, 48.0, 50.0, -20.0, 30.0, 70.0, 0.0, 18.0, 10.0, 8.0, 20.0, 40.0, 50.0, 0.0, 38.0, 30.0, 30.0, 8.0, 10.0, -6.0, -10.0, -2.0, -4.0, 39.0, 70.0, 6.0, 30.0, 20.0, 60.0, 30.0, 40.0, 50.0, 10.0, -6.0, 50.0, 14.0, 17.0, 30.0, 17.0, 60.0, -5.0, 40.0, 20.0, 0.0, 37.0, 7.0, 10.0, 50.0, 20.0, 46.0, 0.0, 20.0, 14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8322930676736593, "mean_inference_ms": 1.9294817400398592, "mean_action_processing_ms": 0.606665496045847, "mean_env_wait_ms": 1.6989430948376565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01490473747253418, "StateBufferConnector_ms": 0.01258540153503418, "ViewRequirementAgentConnector_ms": 0.5238797664642334}, "num_episodes": 18, "episode_return_max": 481.0, "episode_return_min": 52.0, "episode_return_mean": 246.24}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.632781294604104, "num_env_steps_trained_throughput_per_sec": 18.632781294604104, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 220508.538, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220508.481, "sample_time_ms": 3429.359, "learn_time_ms": 217052.455, "learn_throughput": 18.429, "synch_weights_time_ms": 17.522}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "a22d3_00000", "date": "2024-08-06_00-16-10", "timestamp": 1722917770, "time_this_iter_s": 214.68226313591003, "time_total_s": 5563.105483531952, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01badc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5563.105483531952, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 32.838815789473685, "ram_util_percent": 78.70888157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1129504800223695, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4142252975378553, "policy_loss": -0.009737370457526007, "vf_loss": 3.4223580128849505, "vf_explained_var": 0.010160179513965806, "kl": 0.008023289040642947, "entropy": 1.078737063980458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 420.0, "episode_reward_min": 52.0, "episode_reward_mean": 246.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -22.0}, "policy_reward_max": {"policy_0": 90.0}, "policy_reward_mean": {"policy_0": 24.604}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 220.0, 189.0, 167.0, 119.0, 52.0, 169.0, 235.0, 200.0, 281.0, 256.0, 279.0, 275.0, 120.0, 259.0, 290.0, 161.0, 337.0, 298.0, 190.0, 249.0, 180.0, 186.0, 153.0, 300.0, 251.0, 210.0, 292.0, 338.0, 174.0, 216.0, 230.0, 124.0, 240.0, 159.0, 206.0, 66.0, 185.0, 292.0, 175.0, 406.0, 270.0, 370.0, 195.0, 295.0, 170.0, 400.0, 356.0, 310.0, 312.0, 335.0, 228.0, 182.0, 297.0, 202.0, 250.0, 300.0, 285.0, 237.0, 245.0, 283.0, 127.0, 208.0, 101.0, 278.0, 360.0, 278.0, 348.0, 274.0, 359.0, 240.0, 380.0, 240.0, 400.0, 137.0, 399.0, 226.0, 148.0, 341.0, 227.0, 210.0, 191.0, 364.0, 238.0, 420.0, 288.0, 181.0, 170.0, 159.0, 390.0, 137.0, 274.0, 173.0, 146.0, 271.0, 330.0, 183.0, 285.0, 242.0, 260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 40.0, 40.0, 50.0, 70.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 0.0, 50.0, -1.0, 22.0, 18.0, 19.0, 30.0, 11.0, 0.0, 20.0, 20.0, 20.0, 20.0, 27.0, 0.0, 30.0, 25.0, 7.0, 16.0, 5.0, 17.0, 0.0, 10.0, -22.0, 70.0, 20.0, 40.0, -4.0, 10.0, 0.0, -5.0, 0.0, 7.0, 10.0, 10.0, 8.0, 0.0, 10.0, 10.0, -1.0, -2.0, 4.0, 35.0, 20.0, 30.0, 20.0, 30.0, 10.0, 0.0, 10.0, 10.0, 40.0, 7.0, 6.0, 18.0, 40.0, -2.0, 26.0, 10.0, 60.0, 30.0, -4.0, 6.0, 10.0, 20.0, 20.0, 10.0, 40.0, 50.0, 8.0, 40.0, 30.0, 0.0, 20.0, 49.0, 7.0, -4.0, 10.0, 70.0, 49.0, 50.0, 30.0, 70.0, 20.0, 10.0, 20.0, 10.0, 8.0, 0.0, 50.0, 38.0, 30.0, 80.0, 10.0, 0.0, 0.0, 60.0, 0.0, 40.0, 40.0, 19.0, 50.0, 0.0, 0.0, -15.0, 50.0, 50.0, 70.0, 30.0, 10.0, 30.0, 30.0, 10.0, -1.0, 20.0, -7.0, 10.0, 38.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 0.0, 30.0, 70.0, 10.0, 20.0, 29.0, 30.0, 70.0, 20.0, 40.0, 50.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, -9.0, 1.0, 20.0, 9.0, 40.0, 0.0, 30.0, 40.0, 50.0, 20.0, 60.0, 10.0, 10.0, 38.0, 39.0, 50.0, 20.0, 20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0, 20.0, 80.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 40.0, 70.0, 39.0, 10.0, 10.0, 20.0, -5.0, 15.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 30.0, 29.0, 10.0, 30.0, 20.0, 19.0, -2.0, 30.0, 20.0, 30.0, 0.0, 20.0, 9.0, -1.0, 9.0, 49.0, 0.0, 20.0, 0.0, 37.0, 10.0, 90.0, 29.0, -3.0, 20.0, 30.0, 70.0, 6.0, 6.0, 15.0, 37.0, 20.0, 60.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 21.0, 30.0, 49.0, 10.0, 19.0, -2.0, 29.0, 19.0, 18.0, 30.0, 20.0, 18.0, 40.0, 37.0, 60.0, 27.0, 16.0, 16.0, 30.0, 40.0, -3.0, 29.0, 30.0, 60.0, 40.0, 20.0, 40.0, 29.0, 29.0, 10.0, 50.0, 30.0, -2.0, 10.0, -1.0, 20.0, 20.0, 17.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 39.0, 40.0, 50.0, 10.0, -1.0, 19.0, 20.0, 19.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, -2.0, 0.0, 6.0, 30.0, 7.0, 26.0, 16.0, -10.0, 40.0, 11.0, 20.0, 75.0, 30.0, 40.0, 10.0, 19.0, 10.0, 0.0, 37.0, -1.0, -1.0, 6.0, 1.0, -20.0, 20.0, 50.0, 40.0, -1.0, 34.0, 30.0, 38.0, 0.0, 20.0, 10.0, 19.0, 9.0, 50.0, 10.0, 0.0, 50.0, 0.0, 10.0, 6.0, 20.0, 10.0, 5.0, 0.0, 8.0, 10.0, -3.0, 0.0, 10.0, 17.0, 23.0, 27.0, 30.0, 30.0, 20.0, 19.0, 9.0, 39.0, 25.0, 9.0, 50.0, 30.0, 19.0, 50.0, 30.0, 30.0, 10.0, -1.0, 37.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 39.0, 65.0, 18.0, 70.0, 78.0, 30.0, 25.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 50.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 80.0, 60.0, 60.0, 40.0, 0.0, 80.0, 10.0, 5.0, -3.0, 5.0, 28.0, 40.0, 20.0, 10.0, 40.0, 15.0, 30.0, 28.0, 45.0, 5.0, 22.0, 60.0, 30.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 70.0, 80.0, 30.0, 20.0, 50.0, 30.0, 30.0, 40.0, 20.0, 30.0, 10.0, 0.0, 49.0, 19.0, 60.0, 40.0, 20.0, 90.0, 28.0, 40.0, 70.0, 19.0, 40.0, 38.0, 0.0, 0.0, 60.0, 23.0, 20.0, 40.0, 50.0, 40.0, 21.0, 29.0, 4.0, 8.0, 60.0, 40.0, 30.0, 30.0, 60.0, 20.0, 22.0, 90.0, 40.0, 40.0, 36.0, 28.0, 10.0, -11.0, 30.0, 20.0, 10.0, 29.0, 10.0, 30.0, 20.0, 0.0, 50.0, 29.0, 50.0, 30.0, 8.0, 10.0, 10.0, 0.0, 27.0, 39.0, 8.0, 0.0, 60.0, 20.0, 20.0, 10.0, 19.0, 30.0, 20.0, 20.0, 38.0, 60.0, 27.0, 30.0, 10.0, 40.0, 10.0, 10.0, 17.0, 8.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 10.0, 50.0, 30.0, 30.0, 30.0, 30.0, 30.0, 40.0, 30.0, 60.0, 50.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 20.0, 25.0, 40.0, 40.0, 30.0, 50.0, 50.0, 20.0, 50.0, 49.0, 40.0, 9.0, 0.0, 29.0, 0.0, 20.0, 20.0, 5.0, 10.0, 50.0, 10.0, 10.0, 50.0, 10.0, 90.0, 0.0, 10.0, -4.0, 10.0, 17.0, 60.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, -1.0, 26.0, 10.0, 0.0, 36.0, 10.0, -1.0, 20.0, 12.0, 15.0, 18.0, 0.0, 19.0, -6.0, 50.0, 0.0, 40.0, 37.0, 10.0, 40.0, 0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0, 70.0, 10.0, 22.0, 30.0, -4.0, 0.0, 40.0, 10.0, 70.0, 30.0, 40.0, 20.0, 39.0, 10.0, 18.0, 14.0, 70.0, 80.0, 9.0, 60.0, 30.0, 20.0, 40.0, 10.0, 29.0, 40.0, 30.0, 20.0, 30.0, 29.0, 38.0, 30.0, 20.0, 10.0, 80.0, 20.0, 60.0, 60.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, -15.0, 59.0, 10.0, 0.0, 40.0, 20.0, 70.0, 10.0, 70.0, 30.0, 30.0, 40.0, 20.0, 50.0, 9.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 60.0, 50.0, 0.0, 70.0, 30.0, 20.0, 50.0, 60.0, 10.0, 80.0, 10.0, 10.0, 70.0, 30.0, 60.0, 10.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 50.0, 30.0, 60.0, 40.0, 60.0, 20.0, 50.0, 10.0, 40.0, -7.0, 60.0, 28.0, 30.0, 0.0, 9.0, 10.0, 0.0, -21.0, 28.0, 20.0, 50.0, 40.0, 17.0, 36.0, 20.0, 80.0, 8.0, 80.0, 48.0, 50.0, -20.0, 30.0, 70.0, 0.0, 18.0, 10.0, 8.0, 20.0, 40.0, 50.0, 0.0, 38.0, 30.0, 30.0, 8.0, 10.0, -6.0, -10.0, -2.0, -4.0, 39.0, 70.0, 6.0, 30.0, 20.0, 60.0, 30.0, 40.0, 50.0, 10.0, -6.0, 50.0, 14.0, 17.0, 30.0, 17.0, 60.0, -5.0, 40.0, 20.0, 0.0, 37.0, 7.0, 10.0, 50.0, 20.0, 46.0, 0.0, 20.0, 14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0, 80.0, 17.0, 20.0, 60.0, 20.0, 50.0, 10.0, 27.0, 40.0, 40.0, 70.0, 20.0, 4.0, 10.0, 20.0, 14.0, 20.0, 60.0, 10.0, 10.0, 70.0, 30.0, 50.0, 70.0, 60.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 70.0, 10.0, 50.0, 20.0, 10.0, 29.0, 50.0, -1.0, 40.0, 30.0, 0.0, 30.0, 10.0, 18.0, 19.0, -6.0, 50.0, 0.0, 30.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 36.0, 4.0, 10.0, 20.0, 20.0, 0.0, 19.0, 26.0, 40.0, -1.0, 30.0, 0.0, 5.0, 20.0, 70.0, 40.0, 30.0, 0.0, 60.0, 30.0, 80.0, 20.0, 50.0, 10.0, 47.0, 20.0, 20.0, -1.0, -5.0, -4.0, -4.0, 20.0, 55.0, -11.0, 40.0, 10.0, 50.0, 26.0, 60.0, 29.0, 10.0, 10.0, 9.0, 30.0, 0.0, 23.0, 0.0, 40.0, 20.0, 10.0, 20.0, 18.0, 29.0, 13.0, 30.0, 60.0, 10.0, 0.0, 20.0, 10.0, 0.0, 16.0, 0.0, 0.0, 27.0, 15.0, 10.0, 20.0, 10.0, 9.0, 70.0, 30.0, 60.0, 20.0, 0.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 40.0, 10.0, 60.0, 20.0, 0.0, 20.0, 30.0, 10.0, 0.0, 56.0, 20.0, -3.0, 30.0, 20.0, 30.0, 25.0, 10.0, 20.0, 10.0, 50.0, 60.0, 40.0, 20.0, 40.0, 20.0, 5.0, 0.0, 7.0, 20.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8336690129539897, "mean_inference_ms": 1.9315421255214102, "mean_action_processing_ms": 0.6122088140055252, "mean_env_wait_ms": 1.6985460102676928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014766454696655273, "StateBufferConnector_ms": 0.012817621231079102, "ViewRequirementAgentConnector_ms": 0.5445234775543213}, "num_episodes": 18, "episode_return_max": 420.0, "episode_return_min": 52.0, "episode_return_mean": 246.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.18435249102625, "num_env_steps_trained_throughput_per_sec": 18.18435249102625, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 220977.154, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220977.098, "sample_time_ms": 3448.828, "learn_time_ms": 217501.465, "learn_throughput": 18.391, "synch_weights_time_ms": 18.166}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "a22d3_00000", "date": "2024-08-06_00-19-50", "timestamp": 1722917990, "time_this_iter_s": 219.97644591331482, "time_total_s": 5783.081929445267, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2096160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5783.081929445267, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 37.0849358974359, "ram_util_percent": 80.45224358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.362408638140137, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.333466406295094, "policy_loss": -0.01097244920463949, "vf_loss": 3.342730777725752, "vf_explained_var": 0.043326609361920745, "kl": 0.008540361603188029, "entropy": 1.072504328488034, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 420.0, "episode_reward_min": 66.0, "episode_reward_mean": 247.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -21.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 24.764}, "custom_metrics": {}, "hist_stats": {"episode_reward": [298.0, 190.0, 249.0, 180.0, 186.0, 153.0, 300.0, 251.0, 210.0, 292.0, 338.0, 174.0, 216.0, 230.0, 124.0, 240.0, 159.0, 206.0, 66.0, 185.0, 292.0, 175.0, 406.0, 270.0, 370.0, 195.0, 295.0, 170.0, 400.0, 356.0, 310.0, 312.0, 335.0, 228.0, 182.0, 297.0, 202.0, 250.0, 300.0, 285.0, 237.0, 245.0, 283.0, 127.0, 208.0, 101.0, 278.0, 360.0, 278.0, 348.0, 274.0, 359.0, 240.0, 380.0, 240.0, 400.0, 137.0, 399.0, 226.0, 148.0, 341.0, 227.0, 210.0, 191.0, 364.0, 238.0, 420.0, 288.0, 181.0, 170.0, 159.0, 390.0, 137.0, 274.0, 173.0, 146.0, 271.0, 330.0, 183.0, 285.0, 242.0, 260.0, 274.0, 380.0, 139.0, 335.0, 250.0, 178.0, 342.0, 321.0, 184.0, 200.0, 180.0, 157.0, 166.0, 102.0, 158.0, 280.0, 166.0, 327.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 9.0, 30.0, 39.0, 70.0, 37.0, 28.0, 30.0, 20.0, 15.0, 20.0, 80.0, 0.0, 0.0, 30.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 40.0, 70.0, 39.0, 10.0, 10.0, 20.0, -5.0, 15.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 30.0, 29.0, 10.0, 30.0, 20.0, 19.0, -2.0, 30.0, 20.0, 30.0, 0.0, 20.0, 9.0, -1.0, 9.0, 49.0, 0.0, 20.0, 0.0, 37.0, 10.0, 90.0, 29.0, -3.0, 20.0, 30.0, 70.0, 6.0, 6.0, 15.0, 37.0, 20.0, 60.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 21.0, 30.0, 49.0, 10.0, 19.0, -2.0, 29.0, 19.0, 18.0, 30.0, 20.0, 18.0, 40.0, 37.0, 60.0, 27.0, 16.0, 16.0, 30.0, 40.0, -3.0, 29.0, 30.0, 60.0, 40.0, 20.0, 40.0, 29.0, 29.0, 10.0, 50.0, 30.0, -2.0, 10.0, -1.0, 20.0, 20.0, 17.0, 40.0, 40.0, 10.0, 20.0, 20.0, 0.0, 39.0, 40.0, 50.0, 10.0, -1.0, 19.0, 20.0, 19.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, 30.0, 10.0, 50.0, 0.0, -2.0, 0.0, 6.0, 30.0, 7.0, 26.0, 16.0, -10.0, 40.0, 11.0, 20.0, 75.0, 30.0, 40.0, 10.0, 19.0, 10.0, 0.0, 37.0, -1.0, -1.0, 6.0, 1.0, -20.0, 20.0, 50.0, 40.0, -1.0, 34.0, 30.0, 38.0, 0.0, 20.0, 10.0, 19.0, 9.0, 50.0, 10.0, 0.0, 50.0, 0.0, 10.0, 6.0, 20.0, 10.0, 5.0, 0.0, 8.0, 10.0, -3.0, 0.0, 10.0, 17.0, 23.0, 27.0, 30.0, 30.0, 20.0, 19.0, 9.0, 39.0, 25.0, 9.0, 50.0, 30.0, 19.0, 50.0, 30.0, 30.0, 10.0, -1.0, 37.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 40.0, 39.0, 65.0, 18.0, 70.0, 78.0, 30.0, 25.0, 30.0, 20.0, 10.0, 60.0, 30.0, 30.0, 50.0, 30.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 0.0, 10.0, 30.0, 50.0, 80.0, 60.0, 60.0, 40.0, 0.0, 80.0, 10.0, 5.0, -3.0, 5.0, 28.0, 40.0, 20.0, 10.0, 40.0, 15.0, 30.0, 28.0, 45.0, 5.0, 22.0, 60.0, 30.0, 20.0, 0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 70.0, 80.0, 30.0, 20.0, 50.0, 30.0, 30.0, 40.0, 20.0, 30.0, 10.0, 0.0, 49.0, 19.0, 60.0, 40.0, 20.0, 90.0, 28.0, 40.0, 70.0, 19.0, 40.0, 38.0, 0.0, 0.0, 60.0, 23.0, 20.0, 40.0, 50.0, 40.0, 21.0, 29.0, 4.0, 8.0, 60.0, 40.0, 30.0, 30.0, 60.0, 20.0, 22.0, 90.0, 40.0, 40.0, 36.0, 28.0, 10.0, -11.0, 30.0, 20.0, 10.0, 29.0, 10.0, 30.0, 20.0, 0.0, 50.0, 29.0, 50.0, 30.0, 8.0, 10.0, 10.0, 0.0, 27.0, 39.0, 8.0, 0.0, 60.0, 20.0, 20.0, 10.0, 19.0, 30.0, 20.0, 20.0, 38.0, 60.0, 27.0, 30.0, 10.0, 40.0, 10.0, 10.0, 17.0, 8.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 10.0, 50.0, 30.0, 30.0, 30.0, 30.0, 30.0, 40.0, 30.0, 60.0, 50.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 20.0, 25.0, 40.0, 40.0, 30.0, 50.0, 50.0, 20.0, 50.0, 49.0, 40.0, 9.0, 0.0, 29.0, 0.0, 20.0, 20.0, 5.0, 10.0, 50.0, 10.0, 10.0, 50.0, 10.0, 90.0, 0.0, 10.0, -4.0, 10.0, 17.0, 60.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, -1.0, 26.0, 10.0, 0.0, 36.0, 10.0, -1.0, 20.0, 12.0, 15.0, 18.0, 0.0, 19.0, -6.0, 50.0, 0.0, 40.0, 37.0, 10.0, 40.0, 0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0, 70.0, 10.0, 22.0, 30.0, -4.0, 0.0, 40.0, 10.0, 70.0, 30.0, 40.0, 20.0, 39.0, 10.0, 18.0, 14.0, 70.0, 80.0, 9.0, 60.0, 30.0, 20.0, 40.0, 10.0, 29.0, 40.0, 30.0, 20.0, 30.0, 29.0, 38.0, 30.0, 20.0, 10.0, 80.0, 20.0, 60.0, 60.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, -15.0, 59.0, 10.0, 0.0, 40.0, 20.0, 70.0, 10.0, 70.0, 30.0, 30.0, 40.0, 20.0, 50.0, 9.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 60.0, 50.0, 0.0, 70.0, 30.0, 20.0, 50.0, 60.0, 10.0, 80.0, 10.0, 10.0, 70.0, 30.0, 60.0, 10.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 50.0, 30.0, 60.0, 40.0, 60.0, 20.0, 50.0, 10.0, 40.0, -7.0, 60.0, 28.0, 30.0, 0.0, 9.0, 10.0, 0.0, -21.0, 28.0, 20.0, 50.0, 40.0, 17.0, 36.0, 20.0, 80.0, 8.0, 80.0, 48.0, 50.0, -20.0, 30.0, 70.0, 0.0, 18.0, 10.0, 8.0, 20.0, 40.0, 50.0, 0.0, 38.0, 30.0, 30.0, 8.0, 10.0, -6.0, -10.0, -2.0, -4.0, 39.0, 70.0, 6.0, 30.0, 20.0, 60.0, 30.0, 40.0, 50.0, 10.0, -6.0, 50.0, 14.0, 17.0, 30.0, 17.0, 60.0, -5.0, 40.0, 20.0, 0.0, 37.0, 7.0, 10.0, 50.0, 20.0, 46.0, 0.0, 20.0, 14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0, 80.0, 17.0, 20.0, 60.0, 20.0, 50.0, 10.0, 27.0, 40.0, 40.0, 70.0, 20.0, 4.0, 10.0, 20.0, 14.0, 20.0, 60.0, 10.0, 10.0, 70.0, 30.0, 50.0, 70.0, 60.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 70.0, 10.0, 50.0, 20.0, 10.0, 29.0, 50.0, -1.0, 40.0, 30.0, 0.0, 30.0, 10.0, 18.0, 19.0, -6.0, 50.0, 0.0, 30.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 36.0, 4.0, 10.0, 20.0, 20.0, 0.0, 19.0, 26.0, 40.0, -1.0, 30.0, 0.0, 5.0, 20.0, 70.0, 40.0, 30.0, 0.0, 60.0, 30.0, 80.0, 20.0, 50.0, 10.0, 47.0, 20.0, 20.0, -1.0, -5.0, -4.0, -4.0, 20.0, 55.0, -11.0, 40.0, 10.0, 50.0, 26.0, 60.0, 29.0, 10.0, 10.0, 9.0, 30.0, 0.0, 23.0, 0.0, 40.0, 20.0, 10.0, 20.0, 18.0, 29.0, 13.0, 30.0, 60.0, 10.0, 0.0, 20.0, 10.0, 0.0, 16.0, 0.0, 0.0, 27.0, 15.0, 10.0, 20.0, 10.0, 9.0, 70.0, 30.0, 60.0, 20.0, 0.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 40.0, 10.0, 60.0, 20.0, 0.0, 20.0, 30.0, 10.0, 0.0, 56.0, 20.0, -3.0, 30.0, 20.0, 30.0, 25.0, 10.0, 20.0, 10.0, 50.0, 60.0, 40.0, 20.0, 40.0, 20.0, 5.0, 0.0, 7.0, 20.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0, 20.0, 5.0, 30.0, 7.0, 50.0, 20.0, 32.0, 30.0, 50.0, 30.0, 40.0, 60.0, 50.0, 20.0, 110.0, 30.0, 4.0, 59.0, -3.0, 10.0, 30.0, 10.0, 40.0, -3.0, 10.0, 40.0, 0.0, -8.0, 10.0, 10.0, 0.0, 60.0, 60.0, 10.0, 50.0, 30.0, 34.0, 45.0, 46.0, 0.0, 0.0, 50.0, 20.0, 30.0, 40.0, 20.0, 30.0, 10.0, 30.0, 20.0, 60.0, 20.0, 0.0, 40.0, 9.0, 18.0, 5.0, 10.0, 15.0, 1.0, 8.0, 26.0, 29.0, 40.0, 30.0, 40.0, 60.0, 50.0, 20.0, 39.0, 5.0, 7.0, 30.0, 40.0, 70.0, 30.0, 40.0, 30.0, 33.0, 36.0, 17.0, 20.0, 20.0, 40.0, 7.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, -5.0, 16.0, 10.0, 30.0, 0.0, 20.0, 20.0, 90.0, -1.0, 0.0, 18.0, 9.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 17.0, 9.0, 10.0, 30.0, 20.0, 50.0, 10.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 30.0, -8.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 50.0, 9.0, -1.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 20.0, 20.0, 60.0, 60.0, 0.0, 20.0, 30.0, 40.0, 20.0, -2.0, 10.0, 20.0, 0.0, 8.0, 20.0, 30.0, 30.0, 40.0, 40.0, 30.0, 19.0, 20.0, 10.0, 48.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8345082995759332, "mean_inference_ms": 1.9348791158624328, "mean_action_processing_ms": 0.6178440454349456, "mean_env_wait_ms": 1.69876439345874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015461206436157227, "StateBufferConnector_ms": 0.013350725173950195, "ViewRequirementAgentConnector_ms": 0.5390737056732178}, "num_episodes": 18, "episode_return_max": 420.0, "episode_return_min": 66.0, "episode_return_mean": 247.64}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 18.67698156237729, "num_env_steps_trained_throughput_per_sec": 18.67698156237729, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 220534.42, "restore_workers_time_ms": 0.013, "training_step_time_ms": 220534.362, "sample_time_ms": 3521.561, "learn_time_ms": 216986.026, "learn_throughput": 18.434, "synch_weights_time_ms": 17.359}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "a22d3_00000", "date": "2024-08-06_00-23-24", "timestamp": 1722918204, "time_this_iter_s": 214.18461632728577, "time_total_s": 5997.2665457725525, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5997.2665457725525, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 34.26513157894736, "ram_util_percent": 78.37434210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7921172286247926, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.391437698908634, "policy_loss": -0.010604483853897657, "vf_loss": 4.400438943051428, "vf_explained_var": 0.04603781400524135, "kl": 0.008016201409578538, "entropy": 1.0245154605188562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 420.0, "episode_reward_min": 101.0, "episode_reward_mean": 251.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -21.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 25.192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 400.0, 356.0, 310.0, 312.0, 335.0, 228.0, 182.0, 297.0, 202.0, 250.0, 300.0, 285.0, 237.0, 245.0, 283.0, 127.0, 208.0, 101.0, 278.0, 360.0, 278.0, 348.0, 274.0, 359.0, 240.0, 380.0, 240.0, 400.0, 137.0, 399.0, 226.0, 148.0, 341.0, 227.0, 210.0, 191.0, 364.0, 238.0, 420.0, 288.0, 181.0, 170.0, 159.0, 390.0, 137.0, 274.0, 173.0, 146.0, 271.0, 330.0, 183.0, 285.0, 242.0, 260.0, 274.0, 380.0, 139.0, 335.0, 250.0, 178.0, 342.0, 321.0, 184.0, 200.0, 180.0, 157.0, 166.0, 102.0, 158.0, 280.0, 166.0, 327.0, 213.0, 217.0, 345.0, 228.0, 299.0, 199.0, 212.0, 195.0, 227.0, 341.0, 116.0, 420.0, 140.0, 231.0, 202.0, 249.0, 306.0, 364.0, 268.0, 414.0, 156.0, 144.0, 315.0, 154.0, 190.0, 242.0, 291.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 70.0, 80.0, 30.0, 20.0, 50.0, 30.0, 30.0, 40.0, 20.0, 30.0, 10.0, 0.0, 49.0, 19.0, 60.0, 40.0, 20.0, 90.0, 28.0, 40.0, 70.0, 19.0, 40.0, 38.0, 0.0, 0.0, 60.0, 23.0, 20.0, 40.0, 50.0, 40.0, 21.0, 29.0, 4.0, 8.0, 60.0, 40.0, 30.0, 30.0, 60.0, 20.0, 22.0, 90.0, 40.0, 40.0, 36.0, 28.0, 10.0, -11.0, 30.0, 20.0, 10.0, 29.0, 10.0, 30.0, 20.0, 0.0, 50.0, 29.0, 50.0, 30.0, 8.0, 10.0, 10.0, 0.0, 27.0, 39.0, 8.0, 0.0, 60.0, 20.0, 20.0, 10.0, 19.0, 30.0, 20.0, 20.0, 38.0, 60.0, 27.0, 30.0, 10.0, 40.0, 10.0, 10.0, 17.0, 8.0, 20.0, 30.0, 10.0, 0.0, 30.0, 30.0, 10.0, 50.0, 30.0, 30.0, 30.0, 30.0, 30.0, 40.0, 30.0, 60.0, 50.0, 0.0, 50.0, 10.0, 30.0, 0.0, 0.0, 30.0, 0.0, 20.0, 25.0, 40.0, 40.0, 30.0, 50.0, 50.0, 20.0, 50.0, 49.0, 40.0, 9.0, 0.0, 29.0, 0.0, 20.0, 20.0, 5.0, 10.0, 50.0, 10.0, 10.0, 50.0, 10.0, 90.0, 0.0, 10.0, -4.0, 10.0, 17.0, 60.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, -1.0, 26.0, 10.0, 0.0, 36.0, 10.0, -1.0, 20.0, 12.0, 15.0, 18.0, 0.0, 19.0, -6.0, 50.0, 0.0, 40.0, 37.0, 10.0, 40.0, 0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0, 70.0, 10.0, 22.0, 30.0, -4.0, 0.0, 40.0, 10.0, 70.0, 30.0, 40.0, 20.0, 39.0, 10.0, 18.0, 14.0, 70.0, 80.0, 9.0, 60.0, 30.0, 20.0, 40.0, 10.0, 29.0, 40.0, 30.0, 20.0, 30.0, 29.0, 38.0, 30.0, 20.0, 10.0, 80.0, 20.0, 60.0, 60.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, -15.0, 59.0, 10.0, 0.0, 40.0, 20.0, 70.0, 10.0, 70.0, 30.0, 30.0, 40.0, 20.0, 50.0, 9.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 60.0, 50.0, 0.0, 70.0, 30.0, 20.0, 50.0, 60.0, 10.0, 80.0, 10.0, 10.0, 70.0, 30.0, 60.0, 10.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 50.0, 30.0, 60.0, 40.0, 60.0, 20.0, 50.0, 10.0, 40.0, -7.0, 60.0, 28.0, 30.0, 0.0, 9.0, 10.0, 0.0, -21.0, 28.0, 20.0, 50.0, 40.0, 17.0, 36.0, 20.0, 80.0, 8.0, 80.0, 48.0, 50.0, -20.0, 30.0, 70.0, 0.0, 18.0, 10.0, 8.0, 20.0, 40.0, 50.0, 0.0, 38.0, 30.0, 30.0, 8.0, 10.0, -6.0, -10.0, -2.0, -4.0, 39.0, 70.0, 6.0, 30.0, 20.0, 60.0, 30.0, 40.0, 50.0, 10.0, -6.0, 50.0, 14.0, 17.0, 30.0, 17.0, 60.0, -5.0, 40.0, 20.0, 0.0, 37.0, 7.0, 10.0, 50.0, 20.0, 46.0, 0.0, 20.0, 14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0, 80.0, 17.0, 20.0, 60.0, 20.0, 50.0, 10.0, 27.0, 40.0, 40.0, 70.0, 20.0, 4.0, 10.0, 20.0, 14.0, 20.0, 60.0, 10.0, 10.0, 70.0, 30.0, 50.0, 70.0, 60.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 70.0, 10.0, 50.0, 20.0, 10.0, 29.0, 50.0, -1.0, 40.0, 30.0, 0.0, 30.0, 10.0, 18.0, 19.0, -6.0, 50.0, 0.0, 30.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 36.0, 4.0, 10.0, 20.0, 20.0, 0.0, 19.0, 26.0, 40.0, -1.0, 30.0, 0.0, 5.0, 20.0, 70.0, 40.0, 30.0, 0.0, 60.0, 30.0, 80.0, 20.0, 50.0, 10.0, 47.0, 20.0, 20.0, -1.0, -5.0, -4.0, -4.0, 20.0, 55.0, -11.0, 40.0, 10.0, 50.0, 26.0, 60.0, 29.0, 10.0, 10.0, 9.0, 30.0, 0.0, 23.0, 0.0, 40.0, 20.0, 10.0, 20.0, 18.0, 29.0, 13.0, 30.0, 60.0, 10.0, 0.0, 20.0, 10.0, 0.0, 16.0, 0.0, 0.0, 27.0, 15.0, 10.0, 20.0, 10.0, 9.0, 70.0, 30.0, 60.0, 20.0, 0.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 40.0, 10.0, 60.0, 20.0, 0.0, 20.0, 30.0, 10.0, 0.0, 56.0, 20.0, -3.0, 30.0, 20.0, 30.0, 25.0, 10.0, 20.0, 10.0, 50.0, 60.0, 40.0, 20.0, 40.0, 20.0, 5.0, 0.0, 7.0, 20.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0, 20.0, 5.0, 30.0, 7.0, 50.0, 20.0, 32.0, 30.0, 50.0, 30.0, 40.0, 60.0, 50.0, 20.0, 110.0, 30.0, 4.0, 59.0, -3.0, 10.0, 30.0, 10.0, 40.0, -3.0, 10.0, 40.0, 0.0, -8.0, 10.0, 10.0, 0.0, 60.0, 60.0, 10.0, 50.0, 30.0, 34.0, 45.0, 46.0, 0.0, 0.0, 50.0, 20.0, 30.0, 40.0, 20.0, 30.0, 10.0, 30.0, 20.0, 60.0, 20.0, 0.0, 40.0, 9.0, 18.0, 5.0, 10.0, 15.0, 1.0, 8.0, 26.0, 29.0, 40.0, 30.0, 40.0, 60.0, 50.0, 20.0, 39.0, 5.0, 7.0, 30.0, 40.0, 70.0, 30.0, 40.0, 30.0, 33.0, 36.0, 17.0, 20.0, 20.0, 40.0, 7.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, -5.0, 16.0, 10.0, 30.0, 0.0, 20.0, 20.0, 90.0, -1.0, 0.0, 18.0, 9.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 17.0, 9.0, 10.0, 30.0, 20.0, 50.0, 10.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 30.0, -8.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 50.0, 9.0, -1.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 20.0, 20.0, 60.0, 60.0, 0.0, 20.0, 30.0, 40.0, 20.0, -2.0, 10.0, 20.0, 0.0, 8.0, 20.0, 30.0, 30.0, 40.0, 40.0, 30.0, 19.0, 20.0, 10.0, 48.0, 60.0, 16.0, 0.0, 60.0, 30.0, 0.0, 7.0, 50.0, 20.0, 20.0, 10.0, 16.0, 20.0, 20.0, 18.0, 53.0, 12.0, 20.0, 18.0, 30.0, 10.0, 40.0, 23.0, 13.0, 70.0, 26.0, 14.0, 40.0, 20.0, -1.0, 100.0, 10.0, 50.0, 60.0, 20.0, 40.0, 13.0, 10.0, 5.0, 20.0, 0.0, 0.0, 9.0, 50.0, 60.0, 20.0, 25.0, 35.0, 30.0, 30.0, 40.0, 20.0, -5.0, 80.0, 10.0, 0.0, 9.0, 7.0, 20.0, 30.0, 28.0, 40.0, 20.0, 40.0, 10.0, 3.0, 40.0, 0.0, 29.0, 10.0, 20.0, 20.0, 7.0, 20.0, 8.0, 28.0, -5.0, 17.0, 40.0, 20.0, 40.0, 30.0, 9.0, 50.0, 10.0, 40.0, 10.0, 0.0, -11.0, 19.0, 70.0, 33.0, 30.0, 20.0, 60.0, 10.0, 20.0, 19.0, 29.0, 90.0, 30.0, 13.0, 13.0, 0.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 30.0, 0.0, 40.0, 60.0, 30.0, 40.0, 80.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 30.0, 0.0, 0.0, 30.0, 40.0, 40.0, 17.0, 18.0, 20.0, 10.0, -4.0, 20.0, 40.0, 8.0, 18.0, 10.0, 7.0, 40.0, 32.0, 10.0, 40.0, 30.0, 7.0, 30.0, 20.0, 10.0, -5.0, 70.0, 34.0, 0.0, 20.0, 40.0, 30.0, 50.0, 40.0, 30.0, 30.0, 10.0, 26.0, 60.0, 10.0, 40.0, 10.0, 38.0, 40.0, 20.0, 10.0, 60.0, -1.0, 40.0, 17.0, 50.0, 90.0, 10.0, 30.0, 19.0, 20.0, 80.0, 30.0, 0.0, 40.0, 40.0, -1.0, 0.0, 60.0, 90.0, 50.0, 10.0, 39.0, 50.0, 30.0, 60.0, 25.0, 0.0, 40.0, 2.0, 30.0, 36.0, 20.0, 10.0, 0.0, 8.0, 10.0, 50.0, 0.0, 15.0, 14.0, -15.0, 10.0, 21.0, 20.0, 30.0, -1.0, 20.0, 30.0, 18.0, 40.0, 30.0, 20.0, 40.0, 50.0, 37.0, 30.0, 28.0, 20.0, 7.0, 5.0, -1.0, 10.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 40.0, 14.0, 20.0, 50.0, 40.0, -4.0, 10.0, 0.0, 30.0, 10.0, 51.0, 10.0, 0.0, 30.0, 30.0, -9.0, 40.0, 50.0, 17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8350013420922247, "mean_inference_ms": 1.939737767873995, "mean_action_processing_ms": 0.6256390305725479, "mean_env_wait_ms": 1.698595684983973, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017303466796875, "StateBufferConnector_ms": 0.013364553451538086, "ViewRequirementAgentConnector_ms": 0.5574421882629395}, "num_episodes": 27, "episode_return_max": 420.0, "episode_return_min": 101.0, "episode_return_mean": 251.92}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.647797075299906, "num_env_steps_trained_throughput_per_sec": 20.647797075299906, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 218487.351, "restore_workers_time_ms": 0.013, "training_step_time_ms": 218487.292, "sample_time_ms": 3488.238, "learn_time_ms": 214973.031, "learn_throughput": 18.607, "synch_weights_time_ms": 16.562}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "a22d3_00000", "date": "2024-08-06_00-26-38", "timestamp": 1722918398, "time_this_iter_s": 193.7325849533081, "time_total_s": 6190.999130725861, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20968b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6190.999130725861, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 29.902554744525546, "ram_util_percent": 77.31897810218979}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9978354255612283, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9765458624964705, "policy_loss": -0.010101195939824469, "vf_loss": 3.985089796470504, "vf_explained_var": 0.017740797114194518, "kl": 0.007786308242067906, "entropy": 1.0200411047607947, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 420.0, "episode_reward_min": 101.0, "episode_reward_mean": 256.53, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -21.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 25.653}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.0, 278.0, 360.0, 278.0, 348.0, 274.0, 359.0, 240.0, 380.0, 240.0, 400.0, 137.0, 399.0, 226.0, 148.0, 341.0, 227.0, 210.0, 191.0, 364.0, 238.0, 420.0, 288.0, 181.0, 170.0, 159.0, 390.0, 137.0, 274.0, 173.0, 146.0, 271.0, 330.0, 183.0, 285.0, 242.0, 260.0, 274.0, 380.0, 139.0, 335.0, 250.0, 178.0, 342.0, 321.0, 184.0, 200.0, 180.0, 157.0, 166.0, 102.0, 158.0, 280.0, 166.0, 327.0, 213.0, 217.0, 345.0, 228.0, 299.0, 199.0, 212.0, 195.0, 227.0, 341.0, 116.0, 420.0, 140.0, 231.0, 202.0, 249.0, 306.0, 364.0, 268.0, 414.0, 156.0, 144.0, 315.0, 154.0, 190.0, 242.0, 291.0, 285.0, 375.0, 351.0, 260.0, 416.0, 307.0, 287.0, 185.0, 158.0, 335.0, 348.0, 119.0, 378.0, 141.0, 210.0, 380.0, 260.0, 393.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 55.0, 40.0, -10.0, 20.0, -5.0, 0.0, -4.0, -15.0, 20.0, 70.0, 10.0, 22.0, 30.0, -4.0, 0.0, 40.0, 10.0, 70.0, 30.0, 40.0, 20.0, 39.0, 10.0, 18.0, 14.0, 70.0, 80.0, 9.0, 60.0, 30.0, 20.0, 40.0, 10.0, 29.0, 40.0, 30.0, 20.0, 30.0, 29.0, 38.0, 30.0, 20.0, 10.0, 80.0, 20.0, 60.0, 60.0, 20.0, 10.0, 20.0, 90.0, 20.0, 30.0, -15.0, 59.0, 10.0, 0.0, 40.0, 20.0, 70.0, 10.0, 70.0, 30.0, 30.0, 40.0, 20.0, 50.0, 9.0, 30.0, 0.0, 10.0, 50.0, 20.0, 10.0, 60.0, 10.0, 0.0, 20.0, 60.0, 50.0, 0.0, 70.0, 30.0, 20.0, 50.0, 60.0, 10.0, 80.0, 10.0, 10.0, 70.0, 30.0, 60.0, 10.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 50.0, 30.0, 60.0, 40.0, 60.0, 20.0, 50.0, 10.0, 40.0, -7.0, 60.0, 28.0, 30.0, 0.0, 9.0, 10.0, 0.0, -21.0, 28.0, 20.0, 50.0, 40.0, 17.0, 36.0, 20.0, 80.0, 8.0, 80.0, 48.0, 50.0, -20.0, 30.0, 70.0, 0.0, 18.0, 10.0, 8.0, 20.0, 40.0, 50.0, 0.0, 38.0, 30.0, 30.0, 8.0, 10.0, -6.0, -10.0, -2.0, -4.0, 39.0, 70.0, 6.0, 30.0, 20.0, 60.0, 30.0, 40.0, 50.0, 10.0, -6.0, 50.0, 14.0, 17.0, 30.0, 17.0, 60.0, -5.0, 40.0, 20.0, 0.0, 37.0, 7.0, 10.0, 50.0, 20.0, 46.0, 0.0, 20.0, 14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0, 80.0, 17.0, 20.0, 60.0, 20.0, 50.0, 10.0, 27.0, 40.0, 40.0, 70.0, 20.0, 4.0, 10.0, 20.0, 14.0, 20.0, 60.0, 10.0, 10.0, 70.0, 30.0, 50.0, 70.0, 60.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 70.0, 10.0, 50.0, 20.0, 10.0, 29.0, 50.0, -1.0, 40.0, 30.0, 0.0, 30.0, 10.0, 18.0, 19.0, -6.0, 50.0, 0.0, 30.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 36.0, 4.0, 10.0, 20.0, 20.0, 0.0, 19.0, 26.0, 40.0, -1.0, 30.0, 0.0, 5.0, 20.0, 70.0, 40.0, 30.0, 0.0, 60.0, 30.0, 80.0, 20.0, 50.0, 10.0, 47.0, 20.0, 20.0, -1.0, -5.0, -4.0, -4.0, 20.0, 55.0, -11.0, 40.0, 10.0, 50.0, 26.0, 60.0, 29.0, 10.0, 10.0, 9.0, 30.0, 0.0, 23.0, 0.0, 40.0, 20.0, 10.0, 20.0, 18.0, 29.0, 13.0, 30.0, 60.0, 10.0, 0.0, 20.0, 10.0, 0.0, 16.0, 0.0, 0.0, 27.0, 15.0, 10.0, 20.0, 10.0, 9.0, 70.0, 30.0, 60.0, 20.0, 0.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 40.0, 10.0, 60.0, 20.0, 0.0, 20.0, 30.0, 10.0, 0.0, 56.0, 20.0, -3.0, 30.0, 20.0, 30.0, 25.0, 10.0, 20.0, 10.0, 50.0, 60.0, 40.0, 20.0, 40.0, 20.0, 5.0, 0.0, 7.0, 20.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0, 20.0, 5.0, 30.0, 7.0, 50.0, 20.0, 32.0, 30.0, 50.0, 30.0, 40.0, 60.0, 50.0, 20.0, 110.0, 30.0, 4.0, 59.0, -3.0, 10.0, 30.0, 10.0, 40.0, -3.0, 10.0, 40.0, 0.0, -8.0, 10.0, 10.0, 0.0, 60.0, 60.0, 10.0, 50.0, 30.0, 34.0, 45.0, 46.0, 0.0, 0.0, 50.0, 20.0, 30.0, 40.0, 20.0, 30.0, 10.0, 30.0, 20.0, 60.0, 20.0, 0.0, 40.0, 9.0, 18.0, 5.0, 10.0, 15.0, 1.0, 8.0, 26.0, 29.0, 40.0, 30.0, 40.0, 60.0, 50.0, 20.0, 39.0, 5.0, 7.0, 30.0, 40.0, 70.0, 30.0, 40.0, 30.0, 33.0, 36.0, 17.0, 20.0, 20.0, 40.0, 7.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, -5.0, 16.0, 10.0, 30.0, 0.0, 20.0, 20.0, 90.0, -1.0, 0.0, 18.0, 9.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 17.0, 9.0, 10.0, 30.0, 20.0, 50.0, 10.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 30.0, -8.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 50.0, 9.0, -1.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 20.0, 20.0, 60.0, 60.0, 0.0, 20.0, 30.0, 40.0, 20.0, -2.0, 10.0, 20.0, 0.0, 8.0, 20.0, 30.0, 30.0, 40.0, 40.0, 30.0, 19.0, 20.0, 10.0, 48.0, 60.0, 16.0, 0.0, 60.0, 30.0, 0.0, 7.0, 50.0, 20.0, 20.0, 10.0, 16.0, 20.0, 20.0, 18.0, 53.0, 12.0, 20.0, 18.0, 30.0, 10.0, 40.0, 23.0, 13.0, 70.0, 26.0, 14.0, 40.0, 20.0, -1.0, 100.0, 10.0, 50.0, 60.0, 20.0, 40.0, 13.0, 10.0, 5.0, 20.0, 0.0, 0.0, 9.0, 50.0, 60.0, 20.0, 25.0, 35.0, 30.0, 30.0, 40.0, 20.0, -5.0, 80.0, 10.0, 0.0, 9.0, 7.0, 20.0, 30.0, 28.0, 40.0, 20.0, 40.0, 10.0, 3.0, 40.0, 0.0, 29.0, 10.0, 20.0, 20.0, 7.0, 20.0, 8.0, 28.0, -5.0, 17.0, 40.0, 20.0, 40.0, 30.0, 9.0, 50.0, 10.0, 40.0, 10.0, 0.0, -11.0, 19.0, 70.0, 33.0, 30.0, 20.0, 60.0, 10.0, 20.0, 19.0, 29.0, 90.0, 30.0, 13.0, 13.0, 0.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 30.0, 0.0, 40.0, 60.0, 30.0, 40.0, 80.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 30.0, 0.0, 0.0, 30.0, 40.0, 40.0, 17.0, 18.0, 20.0, 10.0, -4.0, 20.0, 40.0, 8.0, 18.0, 10.0, 7.0, 40.0, 32.0, 10.0, 40.0, 30.0, 7.0, 30.0, 20.0, 10.0, -5.0, 70.0, 34.0, 0.0, 20.0, 40.0, 30.0, 50.0, 40.0, 30.0, 30.0, 10.0, 26.0, 60.0, 10.0, 40.0, 10.0, 38.0, 40.0, 20.0, 10.0, 60.0, -1.0, 40.0, 17.0, 50.0, 90.0, 10.0, 30.0, 19.0, 20.0, 80.0, 30.0, 0.0, 40.0, 40.0, -1.0, 0.0, 60.0, 90.0, 50.0, 10.0, 39.0, 50.0, 30.0, 60.0, 25.0, 0.0, 40.0, 2.0, 30.0, 36.0, 20.0, 10.0, 0.0, 8.0, 10.0, 50.0, 0.0, 15.0, 14.0, -15.0, 10.0, 21.0, 20.0, 30.0, -1.0, 20.0, 30.0, 18.0, 40.0, 30.0, 20.0, 40.0, 50.0, 37.0, 30.0, 28.0, 20.0, 7.0, 5.0, -1.0, 10.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 40.0, 14.0, 20.0, 50.0, 40.0, -4.0, 10.0, 0.0, 30.0, 10.0, 51.0, 10.0, 0.0, 30.0, 30.0, -9.0, 40.0, 50.0, 17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0, 0.0, 60.0, 30.0, 15.0, 30.0, 50.0, 60.0, 10.0, 10.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 50.0, 30.0, 30.0, 61.0, 24.0, 50.0, 60.0, 19.0, 49.0, 50.0, 26.0, 40.0, 10.0, 7.0, 40.0, 40.0, 50.0, -3.0, 28.0, 0.0, 60.0, 0.0, 20.0, 40.0, 25.0, 0.0, 50.0, 110.0, 70.0, 60.0, 50.0, 28.0, -2.0, 0.0, 50.0, 60.0, 50.0, 24.0, 40.0, 12.0, 28.0, 14.0, 10.0, 29.0, 40.0, 70.0, -1.0, 30.0, 10.0, 20.0, 20.0, 50.0, 40.0, 38.0, 10.0, 0.0, 0.0, -10.0, -5.0, 50.0, 10.0, 40.0, 40.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 7.0, 30.0, 29.0, 20.0, -2.0, 24.0, 30.0, 23.0, 30.0, 60.0, 40.0, 10.0, 13.0, 9.0, 40.0, 80.0, 40.0, 14.0, 60.0, 0.0, 60.0, 12.0, 50.0, 19.0, 80.0, 13.0, 30.0, -1.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 50.0, 40.0, 39.0, 70.0, 30.0, 29.0, 40.0, 16.0, 40.0, 10.0, 1.0, 0.0, 10.0, 10.0, 20.0, 40.0, -6.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 70.0, 10.0, 50.0, 40.0, 10.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 20.0, -5.0, 10.0, 60.0, 70.0, 50.0, 15.0, 20.0, 10.0, 20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8332242255204148, "mean_inference_ms": 1.939179950016777, "mean_action_processing_ms": 0.6239529978242497, "mean_env_wait_ms": 1.6957746018956135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01654052734375, "StateBufferConnector_ms": 0.012331724166870117, "ViewRequirementAgentConnector_ms": 0.5468218326568604}, "num_episodes": 18, "episode_return_max": 420.0, "episode_return_min": 101.0, "episode_return_mean": 256.53}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.591265093524637, "num_env_steps_trained_throughput_per_sec": 21.591265093524637, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 215623.1, "restore_workers_time_ms": 0.013, "training_step_time_ms": 215623.043, "sample_time_ms": 3461.133, "learn_time_ms": 212137.843, "learn_throughput": 18.856, "synch_weights_time_ms": 15.236}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "a22d3_00000", "date": "2024-08-06_00-29-43", "timestamp": 1722918583, "time_this_iter_s": 185.27016711235046, "time_total_s": 6376.269297838211, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01cbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6376.269297838211, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 26.316030534351146, "ram_util_percent": 78.17137404580151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.578287147142636, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.911721600485813, "policy_loss": -0.009744795003689674, "vf_loss": 3.9200174095277713, "vf_explained_var": -0.00519486980570264, "kl": 0.00724493545590352, "entropy": 1.0025523997914676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 102.0, "episode_reward_mean": 257.33, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -15.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 25.733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [191.0, 364.0, 238.0, 420.0, 288.0, 181.0, 170.0, 159.0, 390.0, 137.0, 274.0, 173.0, 146.0, 271.0, 330.0, 183.0, 285.0, 242.0, 260.0, 274.0, 380.0, 139.0, 335.0, 250.0, 178.0, 342.0, 321.0, 184.0, 200.0, 180.0, 157.0, 166.0, 102.0, 158.0, 280.0, 166.0, 327.0, 213.0, 217.0, 345.0, 228.0, 299.0, 199.0, 212.0, 195.0, 227.0, 341.0, 116.0, 420.0, 140.0, 231.0, 202.0, 249.0, 306.0, 364.0, 268.0, 414.0, 156.0, 144.0, 315.0, 154.0, 190.0, 242.0, 291.0, 285.0, 375.0, 351.0, 260.0, 416.0, 307.0, 287.0, 185.0, 158.0, 335.0, 348.0, 119.0, 378.0, 141.0, 210.0, 380.0, 260.0, 393.0, 435.0, 330.0, 184.0, 240.0, 361.0, 201.0, 179.0, 335.0, 148.0, 243.0, 294.0, 220.0, 256.0, 378.0, 465.0, 195.0, 155.0, 407.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [14.0, -7.0, 30.0, -7.0, 30.0, 36.0, 30.0, 19.0, 16.0, 30.0, 80.0, 17.0, 20.0, 60.0, 20.0, 50.0, 10.0, 27.0, 40.0, 40.0, 70.0, 20.0, 4.0, 10.0, 20.0, 14.0, 20.0, 60.0, 10.0, 10.0, 70.0, 30.0, 50.0, 70.0, 60.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 70.0, 10.0, 50.0, 20.0, 10.0, 29.0, 50.0, -1.0, 40.0, 30.0, 0.0, 30.0, 10.0, 18.0, 19.0, -6.0, 50.0, 0.0, 30.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 36.0, 4.0, 10.0, 20.0, 20.0, 0.0, 19.0, 26.0, 40.0, -1.0, 30.0, 0.0, 5.0, 20.0, 70.0, 40.0, 30.0, 0.0, 60.0, 30.0, 80.0, 20.0, 50.0, 10.0, 47.0, 20.0, 20.0, -1.0, -5.0, -4.0, -4.0, 20.0, 55.0, -11.0, 40.0, 10.0, 50.0, 26.0, 60.0, 29.0, 10.0, 10.0, 9.0, 30.0, 0.0, 23.0, 0.0, 40.0, 20.0, 10.0, 20.0, 18.0, 29.0, 13.0, 30.0, 60.0, 10.0, 0.0, 20.0, 10.0, 0.0, 16.0, 0.0, 0.0, 27.0, 15.0, 10.0, 20.0, 10.0, 9.0, 70.0, 30.0, 60.0, 20.0, 0.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 40.0, 10.0, 60.0, 20.0, 0.0, 20.0, 30.0, 10.0, 0.0, 56.0, 20.0, -3.0, 30.0, 20.0, 30.0, 25.0, 10.0, 20.0, 10.0, 50.0, 60.0, 40.0, 20.0, 40.0, 20.0, 5.0, 0.0, 7.0, 20.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0, 20.0, 5.0, 30.0, 7.0, 50.0, 20.0, 32.0, 30.0, 50.0, 30.0, 40.0, 60.0, 50.0, 20.0, 110.0, 30.0, 4.0, 59.0, -3.0, 10.0, 30.0, 10.0, 40.0, -3.0, 10.0, 40.0, 0.0, -8.0, 10.0, 10.0, 0.0, 60.0, 60.0, 10.0, 50.0, 30.0, 34.0, 45.0, 46.0, 0.0, 0.0, 50.0, 20.0, 30.0, 40.0, 20.0, 30.0, 10.0, 30.0, 20.0, 60.0, 20.0, 0.0, 40.0, 9.0, 18.0, 5.0, 10.0, 15.0, 1.0, 8.0, 26.0, 29.0, 40.0, 30.0, 40.0, 60.0, 50.0, 20.0, 39.0, 5.0, 7.0, 30.0, 40.0, 70.0, 30.0, 40.0, 30.0, 33.0, 36.0, 17.0, 20.0, 20.0, 40.0, 7.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, -5.0, 16.0, 10.0, 30.0, 0.0, 20.0, 20.0, 90.0, -1.0, 0.0, 18.0, 9.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 17.0, 9.0, 10.0, 30.0, 20.0, 50.0, 10.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 30.0, -8.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 50.0, 9.0, -1.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 20.0, 20.0, 60.0, 60.0, 0.0, 20.0, 30.0, 40.0, 20.0, -2.0, 10.0, 20.0, 0.0, 8.0, 20.0, 30.0, 30.0, 40.0, 40.0, 30.0, 19.0, 20.0, 10.0, 48.0, 60.0, 16.0, 0.0, 60.0, 30.0, 0.0, 7.0, 50.0, 20.0, 20.0, 10.0, 16.0, 20.0, 20.0, 18.0, 53.0, 12.0, 20.0, 18.0, 30.0, 10.0, 40.0, 23.0, 13.0, 70.0, 26.0, 14.0, 40.0, 20.0, -1.0, 100.0, 10.0, 50.0, 60.0, 20.0, 40.0, 13.0, 10.0, 5.0, 20.0, 0.0, 0.0, 9.0, 50.0, 60.0, 20.0, 25.0, 35.0, 30.0, 30.0, 40.0, 20.0, -5.0, 80.0, 10.0, 0.0, 9.0, 7.0, 20.0, 30.0, 28.0, 40.0, 20.0, 40.0, 10.0, 3.0, 40.0, 0.0, 29.0, 10.0, 20.0, 20.0, 7.0, 20.0, 8.0, 28.0, -5.0, 17.0, 40.0, 20.0, 40.0, 30.0, 9.0, 50.0, 10.0, 40.0, 10.0, 0.0, -11.0, 19.0, 70.0, 33.0, 30.0, 20.0, 60.0, 10.0, 20.0, 19.0, 29.0, 90.0, 30.0, 13.0, 13.0, 0.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 30.0, 0.0, 40.0, 60.0, 30.0, 40.0, 80.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 30.0, 0.0, 0.0, 30.0, 40.0, 40.0, 17.0, 18.0, 20.0, 10.0, -4.0, 20.0, 40.0, 8.0, 18.0, 10.0, 7.0, 40.0, 32.0, 10.0, 40.0, 30.0, 7.0, 30.0, 20.0, 10.0, -5.0, 70.0, 34.0, 0.0, 20.0, 40.0, 30.0, 50.0, 40.0, 30.0, 30.0, 10.0, 26.0, 60.0, 10.0, 40.0, 10.0, 38.0, 40.0, 20.0, 10.0, 60.0, -1.0, 40.0, 17.0, 50.0, 90.0, 10.0, 30.0, 19.0, 20.0, 80.0, 30.0, 0.0, 40.0, 40.0, -1.0, 0.0, 60.0, 90.0, 50.0, 10.0, 39.0, 50.0, 30.0, 60.0, 25.0, 0.0, 40.0, 2.0, 30.0, 36.0, 20.0, 10.0, 0.0, 8.0, 10.0, 50.0, 0.0, 15.0, 14.0, -15.0, 10.0, 21.0, 20.0, 30.0, -1.0, 20.0, 30.0, 18.0, 40.0, 30.0, 20.0, 40.0, 50.0, 37.0, 30.0, 28.0, 20.0, 7.0, 5.0, -1.0, 10.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 40.0, 14.0, 20.0, 50.0, 40.0, -4.0, 10.0, 0.0, 30.0, 10.0, 51.0, 10.0, 0.0, 30.0, 30.0, -9.0, 40.0, 50.0, 17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0, 0.0, 60.0, 30.0, 15.0, 30.0, 50.0, 60.0, 10.0, 10.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 50.0, 30.0, 30.0, 61.0, 24.0, 50.0, 60.0, 19.0, 49.0, 50.0, 26.0, 40.0, 10.0, 7.0, 40.0, 40.0, 50.0, -3.0, 28.0, 0.0, 60.0, 0.0, 20.0, 40.0, 25.0, 0.0, 50.0, 110.0, 70.0, 60.0, 50.0, 28.0, -2.0, 0.0, 50.0, 60.0, 50.0, 24.0, 40.0, 12.0, 28.0, 14.0, 10.0, 29.0, 40.0, 70.0, -1.0, 30.0, 10.0, 20.0, 20.0, 50.0, 40.0, 38.0, 10.0, 0.0, 0.0, -10.0, -5.0, 50.0, 10.0, 40.0, 40.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 7.0, 30.0, 29.0, 20.0, -2.0, 24.0, 30.0, 23.0, 30.0, 60.0, 40.0, 10.0, 13.0, 9.0, 40.0, 80.0, 40.0, 14.0, 60.0, 0.0, 60.0, 12.0, 50.0, 19.0, 80.0, 13.0, 30.0, -1.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 50.0, 40.0, 39.0, 70.0, 30.0, 29.0, 40.0, 16.0, 40.0, 10.0, 1.0, 0.0, 10.0, 10.0, 20.0, 40.0, -6.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 70.0, 10.0, 50.0, 40.0, 10.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 20.0, -5.0, 10.0, 60.0, 70.0, 50.0, 15.0, 20.0, 10.0, 20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0, 60.0, 50.0, 50.0, 70.0, 50.0, 20.0, 40.0, 70.0, 5.0, 20.0, 30.0, 50.0, 50.0, 20.0, 60.0, 10.0, 10.0, 40.0, 40.0, 20.0, 50.0, 17.0, 9.0, 0.0, -2.0, 0.0, 50.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 10.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 19.0, 50.0, 70.0, 70.0, 18.0, 29.0, 75.0, 10.0, 10.0, 10.0, 9.0, 37.0, 0.0, 20.0, 18.0, 40.0, 40.0, 0.0, 37.0, 0.0, 10.0, 29.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 0.0, 0.0, 19.0, 50.0, 76.0, -2.0, 17.0, 60.0, -5.0, 30.0, 40.0, 50.0, 10.0, 20.0, 39.0, 9.0, 20.0, 10.0, 7.0, 4.0, 10.0, 19.0, 40.0, 30.0, 40.0, 48.0, 0.0, -2.0, 0.0, 18.0, 30.0, 39.0, 10.0, 40.0, 36.0, 30.0, 50.0, 15.0, 27.0, 30.0, 10.0, 46.0, 26.0, 30.0, 10.0, 3.0, 30.0, 20.0, 40.0, 27.0, 34.0, 0.0, 28.0, 40.0, 28.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 60.0, 44.0, 20.0, 80.0, 40.0, 60.0, 0.0, 34.0, 40.0, 50.0, 10.0, 40.0, 50.0, 10.0, 0.0, 100.0, 18.0, 70.0, 50.0, 27.0, 100.0, 29.0, 50.0, 17.0, 9.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 5.0, 30.0, 20.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.828234383138315, "mean_inference_ms": 1.9343800630090544, "mean_action_processing_ms": 0.6209452279516586, "mean_env_wait_ms": 1.6899088008780376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016036272048950195, "StateBufferConnector_ms": 0.011706352233886719, "ViewRequirementAgentConnector_ms": 0.5191757678985596}, "num_episodes": 18, "episode_return_max": 465.0, "episode_return_min": 102.0, "episode_return_mean": 257.33}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.543671495519305, "num_env_steps_trained_throughput_per_sec": 21.543671495519305, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 206949.485, "restore_workers_time_ms": 0.013, "training_step_time_ms": 206949.427, "sample_time_ms": 3345.275, "learn_time_ms": 203580.137, "learn_throughput": 19.648, "synch_weights_time_ms": 15.199}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "a22d3_00000", "date": "2024-08-06_00-32-49", "timestamp": 1722918769, "time_this_iter_s": 185.68036603927612, "time_total_s": 6561.949663877487, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a166eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6561.949663877487, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 22.78555133079848, "ram_util_percent": 78.46159695817491}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6298027690226276, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.356661962193295, "policy_loss": -0.010046320220656867, "vf_loss": 3.365154393983725, "vf_explained_var": -0.013390251622794154, "kl": 0.007769456230069408, "entropy": 1.0381761985338027, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 102.0, "episode_reward_mean": 259.26, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -15.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 25.926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [260.0, 274.0, 380.0, 139.0, 335.0, 250.0, 178.0, 342.0, 321.0, 184.0, 200.0, 180.0, 157.0, 166.0, 102.0, 158.0, 280.0, 166.0, 327.0, 213.0, 217.0, 345.0, 228.0, 299.0, 199.0, 212.0, 195.0, 227.0, 341.0, 116.0, 420.0, 140.0, 231.0, 202.0, 249.0, 306.0, 364.0, 268.0, 414.0, 156.0, 144.0, 315.0, 154.0, 190.0, 242.0, 291.0, 285.0, 375.0, 351.0, 260.0, 416.0, 307.0, 287.0, 185.0, 158.0, 335.0, 348.0, 119.0, 378.0, 141.0, 210.0, 380.0, 260.0, 393.0, 435.0, 330.0, 184.0, 240.0, 361.0, 201.0, 179.0, 335.0, 148.0, 243.0, 294.0, 220.0, 256.0, 378.0, 465.0, 195.0, 155.0, 407.0, 270.0, 199.0, 196.0, 229.0, 218.0, 210.0, 330.0, 163.0, 365.0, 375.0, 256.0, 239.0, 390.0, 120.0, 332.0, 206.0, 345.0, 192.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 90.0, 0.0, 20.0, 20.0, 20.0, 5.0, 30.0, 7.0, 50.0, 20.0, 32.0, 30.0, 50.0, 30.0, 40.0, 60.0, 50.0, 20.0, 110.0, 30.0, 4.0, 59.0, -3.0, 10.0, 30.0, 10.0, 40.0, -3.0, 10.0, 40.0, 0.0, -8.0, 10.0, 10.0, 0.0, 60.0, 60.0, 10.0, 50.0, 30.0, 34.0, 45.0, 46.0, 0.0, 0.0, 50.0, 20.0, 30.0, 40.0, 20.0, 30.0, 10.0, 30.0, 20.0, 60.0, 20.0, 0.0, 40.0, 9.0, 18.0, 5.0, 10.0, 15.0, 1.0, 8.0, 26.0, 29.0, 40.0, 30.0, 40.0, 60.0, 50.0, 20.0, 39.0, 5.0, 7.0, 30.0, 40.0, 70.0, 30.0, 40.0, 30.0, 33.0, 36.0, 17.0, 20.0, 20.0, 40.0, 7.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, -5.0, 16.0, 10.0, 30.0, 0.0, 20.0, 20.0, 90.0, -1.0, 0.0, 18.0, 9.0, 30.0, 10.0, 30.0, 10.0, 20.0, 20.0, 0.0, 10.0, 17.0, 9.0, 10.0, 30.0, 20.0, 50.0, 10.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 10.0, 10.0, 30.0, -8.0, 10.0, 0.0, 0.0, 0.0, 30.0, 10.0, 50.0, 9.0, -1.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 20.0, 20.0, 60.0, 60.0, 0.0, 20.0, 30.0, 40.0, 20.0, -2.0, 10.0, 20.0, 0.0, 8.0, 20.0, 30.0, 30.0, 40.0, 40.0, 30.0, 19.0, 20.0, 10.0, 48.0, 60.0, 16.0, 0.0, 60.0, 30.0, 0.0, 7.0, 50.0, 20.0, 20.0, 10.0, 16.0, 20.0, 20.0, 18.0, 53.0, 12.0, 20.0, 18.0, 30.0, 10.0, 40.0, 23.0, 13.0, 70.0, 26.0, 14.0, 40.0, 20.0, -1.0, 100.0, 10.0, 50.0, 60.0, 20.0, 40.0, 13.0, 10.0, 5.0, 20.0, 0.0, 0.0, 9.0, 50.0, 60.0, 20.0, 25.0, 35.0, 30.0, 30.0, 40.0, 20.0, -5.0, 80.0, 10.0, 0.0, 9.0, 7.0, 20.0, 30.0, 28.0, 40.0, 20.0, 40.0, 10.0, 3.0, 40.0, 0.0, 29.0, 10.0, 20.0, 20.0, 7.0, 20.0, 8.0, 28.0, -5.0, 17.0, 40.0, 20.0, 40.0, 30.0, 9.0, 50.0, 10.0, 40.0, 10.0, 0.0, -11.0, 19.0, 70.0, 33.0, 30.0, 20.0, 60.0, 10.0, 20.0, 19.0, 29.0, 90.0, 30.0, 13.0, 13.0, 0.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 30.0, 0.0, 40.0, 60.0, 30.0, 40.0, 80.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 30.0, 0.0, 0.0, 30.0, 40.0, 40.0, 17.0, 18.0, 20.0, 10.0, -4.0, 20.0, 40.0, 8.0, 18.0, 10.0, 7.0, 40.0, 32.0, 10.0, 40.0, 30.0, 7.0, 30.0, 20.0, 10.0, -5.0, 70.0, 34.0, 0.0, 20.0, 40.0, 30.0, 50.0, 40.0, 30.0, 30.0, 10.0, 26.0, 60.0, 10.0, 40.0, 10.0, 38.0, 40.0, 20.0, 10.0, 60.0, -1.0, 40.0, 17.0, 50.0, 90.0, 10.0, 30.0, 19.0, 20.0, 80.0, 30.0, 0.0, 40.0, 40.0, -1.0, 0.0, 60.0, 90.0, 50.0, 10.0, 39.0, 50.0, 30.0, 60.0, 25.0, 0.0, 40.0, 2.0, 30.0, 36.0, 20.0, 10.0, 0.0, 8.0, 10.0, 50.0, 0.0, 15.0, 14.0, -15.0, 10.0, 21.0, 20.0, 30.0, -1.0, 20.0, 30.0, 18.0, 40.0, 30.0, 20.0, 40.0, 50.0, 37.0, 30.0, 28.0, 20.0, 7.0, 5.0, -1.0, 10.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 40.0, 14.0, 20.0, 50.0, 40.0, -4.0, 10.0, 0.0, 30.0, 10.0, 51.0, 10.0, 0.0, 30.0, 30.0, -9.0, 40.0, 50.0, 17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0, 0.0, 60.0, 30.0, 15.0, 30.0, 50.0, 60.0, 10.0, 10.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 50.0, 30.0, 30.0, 61.0, 24.0, 50.0, 60.0, 19.0, 49.0, 50.0, 26.0, 40.0, 10.0, 7.0, 40.0, 40.0, 50.0, -3.0, 28.0, 0.0, 60.0, 0.0, 20.0, 40.0, 25.0, 0.0, 50.0, 110.0, 70.0, 60.0, 50.0, 28.0, -2.0, 0.0, 50.0, 60.0, 50.0, 24.0, 40.0, 12.0, 28.0, 14.0, 10.0, 29.0, 40.0, 70.0, -1.0, 30.0, 10.0, 20.0, 20.0, 50.0, 40.0, 38.0, 10.0, 0.0, 0.0, -10.0, -5.0, 50.0, 10.0, 40.0, 40.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 7.0, 30.0, 29.0, 20.0, -2.0, 24.0, 30.0, 23.0, 30.0, 60.0, 40.0, 10.0, 13.0, 9.0, 40.0, 80.0, 40.0, 14.0, 60.0, 0.0, 60.0, 12.0, 50.0, 19.0, 80.0, 13.0, 30.0, -1.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 50.0, 40.0, 39.0, 70.0, 30.0, 29.0, 40.0, 16.0, 40.0, 10.0, 1.0, 0.0, 10.0, 10.0, 20.0, 40.0, -6.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 70.0, 10.0, 50.0, 40.0, 10.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 20.0, -5.0, 10.0, 60.0, 70.0, 50.0, 15.0, 20.0, 10.0, 20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0, 60.0, 50.0, 50.0, 70.0, 50.0, 20.0, 40.0, 70.0, 5.0, 20.0, 30.0, 50.0, 50.0, 20.0, 60.0, 10.0, 10.0, 40.0, 40.0, 20.0, 50.0, 17.0, 9.0, 0.0, -2.0, 0.0, 50.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 10.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 19.0, 50.0, 70.0, 70.0, 18.0, 29.0, 75.0, 10.0, 10.0, 10.0, 9.0, 37.0, 0.0, 20.0, 18.0, 40.0, 40.0, 0.0, 37.0, 0.0, 10.0, 29.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 0.0, 0.0, 19.0, 50.0, 76.0, -2.0, 17.0, 60.0, -5.0, 30.0, 40.0, 50.0, 10.0, 20.0, 39.0, 9.0, 20.0, 10.0, 7.0, 4.0, 10.0, 19.0, 40.0, 30.0, 40.0, 48.0, 0.0, -2.0, 0.0, 18.0, 30.0, 39.0, 10.0, 40.0, 36.0, 30.0, 50.0, 15.0, 27.0, 30.0, 10.0, 46.0, 26.0, 30.0, 10.0, 3.0, 30.0, 20.0, 40.0, 27.0, 34.0, 0.0, 28.0, 40.0, 28.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 60.0, 44.0, 20.0, 80.0, 40.0, 60.0, 0.0, 34.0, 40.0, 50.0, 10.0, 40.0, 50.0, 10.0, 0.0, 100.0, 18.0, 70.0, 50.0, 27.0, 100.0, 29.0, 50.0, 17.0, 9.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 5.0, 30.0, 20.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0, 60.0, 20.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 10.0, 29.0, 30.0, 10.0, 50.0, 0.0, 10.0, 20.0, 0.0, 40.0, 50.0, 10.0, 19.0, 30.0, 20.0, 30.0, -1.0, -2.0, 5.0, 10.0, 41.0, 20.0, 50.0, -4.0, 40.0, 30.0, 9.0, 28.0, 0.0, 40.0, 0.0, 60.0, 40.0, -12.0, 10.0, 10.0, 20.0, 50.0, 20.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 80.0, 20.0, 20.0, 20.0, 30.0, -2.0, 15.0, 10.0, 0.0, 30.0, 40.0, 0.0, 40.0, 30.0, 0.0, 50.0, 50.0, 50.0, 70.0, 30.0, 20.0, 60.0, 0.0, 35.0, 0.0, 40.0, 40.0, 50.0, 60.0, 35.0, 30.0, 70.0, 30.0, 20.0, 0.0, 30.0, 50.0, -5.0, 65.0, 10.0, 40.0, 20.0, 6.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 50.0, 40.0, 29.0, 20.0, 50.0, 50.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 10.0, 0.0, 10.0, 20.0, -6.0, 50.0, 20.0, -1.0, 18.0, -1.0, 30.0, 19.0, 28.0, 40.0, 5.0, 60.0, 70.0, 10.0, 20.0, 50.0, 30.0, 0.0, 34.0, 50.0, 20.0, -3.0, 10.0, -5.0, 20.0, 50.0, 55.0, 18.0, 30.0, 50.0, 29.0, 30.0, 70.0, 20.0, 8.0, 35.0, 50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8216053453882883, "mean_inference_ms": 1.9268564499172505, "mean_action_processing_ms": 0.6171128074086247, "mean_env_wait_ms": 1.6816291547216027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01571369171142578, "StateBufferConnector_ms": 0.011020183563232422, "ViewRequirementAgentConnector_ms": 0.4746575355529785}, "num_episodes": 18, "episode_return_max": 465.0, "episode_return_min": 102.0, "episode_return_mean": 259.26}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.48709442387519, "num_env_steps_trained_throughput_per_sec": 21.48709442387519, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 204209.275, "restore_workers_time_ms": 0.013, "training_step_time_ms": 204209.218, "sample_time_ms": 3234.535, "learn_time_ms": 200951.319, "learn_throughput": 19.905, "synch_weights_time_ms": 14.452}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "a22d3_00000", "date": "2024-08-06_00-35-55", "timestamp": 1722918955, "time_this_iter_s": 186.1685140132904, "time_total_s": 6748.118177890778, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a014de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6748.118177890778, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 29.686692015209125, "ram_util_percent": 77.94714828897338}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.541738299623973, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.759326173017581, "policy_loss": -0.01038444731540728, "vf_loss": 3.768088760848243, "vf_explained_var": -0.004454911466096791, "kl": 0.008109287502210115, "entropy": 0.9712024093689883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 465.0, "episode_reward_min": 116.0, "episode_reward_mean": 270.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -15.0}, "policy_reward_max": {"policy_0": 110.0}, "policy_reward_mean": {"policy_0": 27.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.0, 299.0, 199.0, 212.0, 195.0, 227.0, 341.0, 116.0, 420.0, 140.0, 231.0, 202.0, 249.0, 306.0, 364.0, 268.0, 414.0, 156.0, 144.0, 315.0, 154.0, 190.0, 242.0, 291.0, 285.0, 375.0, 351.0, 260.0, 416.0, 307.0, 287.0, 185.0, 158.0, 335.0, 348.0, 119.0, 378.0, 141.0, 210.0, 380.0, 260.0, 393.0, 435.0, 330.0, 184.0, 240.0, 361.0, 201.0, 179.0, 335.0, 148.0, 243.0, 294.0, 220.0, 256.0, 378.0, 465.0, 195.0, 155.0, 407.0, 270.0, 199.0, 196.0, 229.0, 218.0, 210.0, 330.0, 163.0, 365.0, 375.0, 256.0, 239.0, 390.0, 120.0, 332.0, 206.0, 345.0, 192.0, 261.0, 270.0, 439.0, 330.0, 160.0, 438.0, 244.0, 280.0, 177.0, 177.0, 367.0, 320.0, 188.0, 335.0, 308.0, 145.0, 325.0, 290.0, 310.0, 144.0, 320.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 60.0, 20.0, 40.0, 13.0, 10.0, 5.0, 20.0, 0.0, 0.0, 9.0, 50.0, 60.0, 20.0, 25.0, 35.0, 30.0, 30.0, 40.0, 20.0, -5.0, 80.0, 10.0, 0.0, 9.0, 7.0, 20.0, 30.0, 28.0, 40.0, 20.0, 40.0, 10.0, 3.0, 40.0, 0.0, 29.0, 10.0, 20.0, 20.0, 7.0, 20.0, 8.0, 28.0, -5.0, 17.0, 40.0, 20.0, 40.0, 30.0, 9.0, 50.0, 10.0, 40.0, 10.0, 0.0, -11.0, 19.0, 70.0, 33.0, 30.0, 20.0, 60.0, 10.0, 20.0, 19.0, 29.0, 90.0, 30.0, 13.0, 13.0, 0.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 30.0, 0.0, 40.0, 60.0, 30.0, 40.0, 80.0, 80.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 30.0, 0.0, 0.0, 30.0, 40.0, 40.0, 17.0, 18.0, 20.0, 10.0, -4.0, 20.0, 40.0, 8.0, 18.0, 10.0, 7.0, 40.0, 32.0, 10.0, 40.0, 30.0, 7.0, 30.0, 20.0, 10.0, -5.0, 70.0, 34.0, 0.0, 20.0, 40.0, 30.0, 50.0, 40.0, 30.0, 30.0, 10.0, 26.0, 60.0, 10.0, 40.0, 10.0, 38.0, 40.0, 20.0, 10.0, 60.0, -1.0, 40.0, 17.0, 50.0, 90.0, 10.0, 30.0, 19.0, 20.0, 80.0, 30.0, 0.0, 40.0, 40.0, -1.0, 0.0, 60.0, 90.0, 50.0, 10.0, 39.0, 50.0, 30.0, 60.0, 25.0, 0.0, 40.0, 2.0, 30.0, 36.0, 20.0, 10.0, 0.0, 8.0, 10.0, 50.0, 0.0, 15.0, 14.0, -15.0, 10.0, 21.0, 20.0, 30.0, -1.0, 20.0, 30.0, 18.0, 40.0, 30.0, 20.0, 40.0, 50.0, 37.0, 30.0, 28.0, 20.0, 7.0, 5.0, -1.0, 10.0, 20.0, 10.0, 15.0, 40.0, 0.0, 20.0, 40.0, 14.0, 20.0, 50.0, 40.0, -4.0, 10.0, 0.0, 30.0, 10.0, 51.0, 10.0, 0.0, 30.0, 30.0, -9.0, 40.0, 50.0, 17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0, 0.0, 60.0, 30.0, 15.0, 30.0, 50.0, 60.0, 10.0, 10.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 50.0, 30.0, 30.0, 61.0, 24.0, 50.0, 60.0, 19.0, 49.0, 50.0, 26.0, 40.0, 10.0, 7.0, 40.0, 40.0, 50.0, -3.0, 28.0, 0.0, 60.0, 0.0, 20.0, 40.0, 25.0, 0.0, 50.0, 110.0, 70.0, 60.0, 50.0, 28.0, -2.0, 0.0, 50.0, 60.0, 50.0, 24.0, 40.0, 12.0, 28.0, 14.0, 10.0, 29.0, 40.0, 70.0, -1.0, 30.0, 10.0, 20.0, 20.0, 50.0, 40.0, 38.0, 10.0, 0.0, 0.0, -10.0, -5.0, 50.0, 10.0, 40.0, 40.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 7.0, 30.0, 29.0, 20.0, -2.0, 24.0, 30.0, 23.0, 30.0, 60.0, 40.0, 10.0, 13.0, 9.0, 40.0, 80.0, 40.0, 14.0, 60.0, 0.0, 60.0, 12.0, 50.0, 19.0, 80.0, 13.0, 30.0, -1.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 50.0, 40.0, 39.0, 70.0, 30.0, 29.0, 40.0, 16.0, 40.0, 10.0, 1.0, 0.0, 10.0, 10.0, 20.0, 40.0, -6.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 70.0, 10.0, 50.0, 40.0, 10.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 20.0, -5.0, 10.0, 60.0, 70.0, 50.0, 15.0, 20.0, 10.0, 20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0, 60.0, 50.0, 50.0, 70.0, 50.0, 20.0, 40.0, 70.0, 5.0, 20.0, 30.0, 50.0, 50.0, 20.0, 60.0, 10.0, 10.0, 40.0, 40.0, 20.0, 50.0, 17.0, 9.0, 0.0, -2.0, 0.0, 50.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 10.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 19.0, 50.0, 70.0, 70.0, 18.0, 29.0, 75.0, 10.0, 10.0, 10.0, 9.0, 37.0, 0.0, 20.0, 18.0, 40.0, 40.0, 0.0, 37.0, 0.0, 10.0, 29.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 0.0, 0.0, 19.0, 50.0, 76.0, -2.0, 17.0, 60.0, -5.0, 30.0, 40.0, 50.0, 10.0, 20.0, 39.0, 9.0, 20.0, 10.0, 7.0, 4.0, 10.0, 19.0, 40.0, 30.0, 40.0, 48.0, 0.0, -2.0, 0.0, 18.0, 30.0, 39.0, 10.0, 40.0, 36.0, 30.0, 50.0, 15.0, 27.0, 30.0, 10.0, 46.0, 26.0, 30.0, 10.0, 3.0, 30.0, 20.0, 40.0, 27.0, 34.0, 0.0, 28.0, 40.0, 28.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 60.0, 44.0, 20.0, 80.0, 40.0, 60.0, 0.0, 34.0, 40.0, 50.0, 10.0, 40.0, 50.0, 10.0, 0.0, 100.0, 18.0, 70.0, 50.0, 27.0, 100.0, 29.0, 50.0, 17.0, 9.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 5.0, 30.0, 20.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0, 60.0, 20.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 10.0, 29.0, 30.0, 10.0, 50.0, 0.0, 10.0, 20.0, 0.0, 40.0, 50.0, 10.0, 19.0, 30.0, 20.0, 30.0, -1.0, -2.0, 5.0, 10.0, 41.0, 20.0, 50.0, -4.0, 40.0, 30.0, 9.0, 28.0, 0.0, 40.0, 0.0, 60.0, 40.0, -12.0, 10.0, 10.0, 20.0, 50.0, 20.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 80.0, 20.0, 20.0, 20.0, 30.0, -2.0, 15.0, 10.0, 0.0, 30.0, 40.0, 0.0, 40.0, 30.0, 0.0, 50.0, 50.0, 50.0, 70.0, 30.0, 20.0, 60.0, 0.0, 35.0, 0.0, 40.0, 40.0, 50.0, 60.0, 35.0, 30.0, 70.0, 30.0, 20.0, 0.0, 30.0, 50.0, -5.0, 65.0, 10.0, 40.0, 20.0, 6.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 50.0, 40.0, 29.0, 20.0, 50.0, 50.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 10.0, 0.0, 10.0, 20.0, -6.0, 50.0, 20.0, -1.0, 18.0, -1.0, 30.0, 19.0, 28.0, 40.0, 5.0, 60.0, 70.0, 10.0, 20.0, 50.0, 30.0, 0.0, 34.0, 50.0, 20.0, -3.0, 10.0, -5.0, 20.0, 50.0, 55.0, 18.0, 30.0, 50.0, 29.0, 30.0, 70.0, 20.0, 8.0, 35.0, 50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0, 30.0, 40.0, 6.0, 20.0, 40.0, 20.0, 40.0, 10.0, 40.0, 15.0, 20.0, 9.0, 16.0, 0.0, 70.0, 30.0, 40.0, 40.0, 18.0, 27.0, 50.0, 60.0, 40.0, 30.0, 30.0, 40.0, 69.0, 30.0, 20.0, 70.0, 20.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 20.0, 50.0, 10.0, 90.0, 20.0, 0.0, 14.0, 37.0, 19.0, 70.0, 100.0, 40.0, 48.0, 60.0, 18.0, 20.0, 30.0, 30.0, 16.0, 50.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 60.0, 50.0, 10.0, 50.0, 10.0, 0.0, 0.0, 30.0, 8.0, 4.0, 0.0, 5.0, 20.0, 40.0, 60.0, 10.0, 50.0, -5.0, 0.0, 20.0, -8.0, 20.0, 30.0, 30.0, 30.0, 10.0, 70.0, 17.0, 0.0, 30.0, 30.0, 10.0, 30.0, 50.0, 30.0, 100.0, 20.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 20.0, 18.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, 10.0, 45.0, 50.0, 10.0, 40.0, 80.0, 10.0, 20.0, 25.0, 50.0, 5.0, 0.0, 60.0, 25.0, 19.0, 10.0, 50.0, 30.0, 80.0, 25.0, 9.0, 10.0, 10.0, 10.0, 24.0, 10.0, 10.0, 1.0, 20.0, 50.0, 0.0, 40.0, 20.0, 70.0, 20.0, 10.0, 30.0, 50.0, 55.0, 10.0, 20.0, 20.0, 10.0, 10.0, 50.0, 30.0, 40.0, 70.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 40.0, 20.0, 10.0, 30.0, 40.0, 0.0, 10.0, 50.0, 28.0, 30.0, -2.0, 10.0, -11.0, 19.0, 10.0, 2.0, 0.0, 70.0, 18.0, 9.0, 30.0, 20.0, 66.0, 65.0, 40.0, 0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8103540235241533, "mean_inference_ms": 1.912492634668177, "mean_action_processing_ms": 0.6111080476996024, "mean_env_wait_ms": 1.6682543253977833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013902425765991211, "StateBufferConnector_ms": 0.00978708267211914, "ViewRequirementAgentConnector_ms": 0.4267418384552002}, "num_episodes": 22, "episode_return_max": 465.0, "episode_return_min": 116.0, "episode_return_mean": 270.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.65392213524867, "num_env_steps_trained_throughput_per_sec": 21.65392213524867, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 201278.991, "restore_workers_time_ms": 0.013, "training_step_time_ms": 201278.937, "sample_time_ms": 3085.644, "learn_time_ms": 198170.347, "learn_throughput": 20.185, "synch_weights_time_ms": 14.057}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "a22d3_00000", "date": "2024-08-06_00-39-00", "timestamp": 1722919140, "time_this_iter_s": 184.73220109939575, "time_total_s": 6932.850378990173, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16665e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6932.850378990173, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 29.48582375478927, "ram_util_percent": 77.66513409961685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.507905105686289, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.05932526809339, "policy_loss": -0.009927762609671433, "vf_loss": 4.0677023660895415, "vf_explained_var": -0.0080230654492038, "kl": 0.007753311870691767, "entropy": 0.931597992146231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 470.0, "episode_reward_min": 119.0, "episode_reward_mean": 290.49, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -12.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 29.049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, 285.0, 375.0, 351.0, 260.0, 416.0, 307.0, 287.0, 185.0, 158.0, 335.0, 348.0, 119.0, 378.0, 141.0, 210.0, 380.0, 260.0, 393.0, 435.0, 330.0, 184.0, 240.0, 361.0, 201.0, 179.0, 335.0, 148.0, 243.0, 294.0, 220.0, 256.0, 378.0, 465.0, 195.0, 155.0, 407.0, 270.0, 199.0, 196.0, 229.0, 218.0, 210.0, 330.0, 163.0, 365.0, 375.0, 256.0, 239.0, 390.0, 120.0, 332.0, 206.0, 345.0, 192.0, 261.0, 270.0, 439.0, 330.0, 160.0, 438.0, 244.0, 280.0, 177.0, 177.0, 367.0, 320.0, 188.0, 335.0, 308.0, 145.0, 325.0, 290.0, 310.0, 144.0, 320.0, 420.0, 230.0, 377.0, 400.0, 420.0, 380.0, 305.0, 204.0, 371.0, 447.0, 310.0, 299.0, 355.0, 298.0, 310.0, 249.0, 420.0, 330.0, 257.0, 340.0, 289.0, 380.0, 470.0, 220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [17.0, 4.0, 40.0, -8.0, 60.0, 6.0, 36.0, 30.0, 70.0, 36.0, 0.0, 60.0, 30.0, 15.0, 30.0, 50.0, 60.0, 10.0, 10.0, 20.0, 60.0, 30.0, 20.0, 60.0, 10.0, 50.0, 30.0, 30.0, 61.0, 24.0, 50.0, 60.0, 19.0, 49.0, 50.0, 26.0, 40.0, 10.0, 7.0, 40.0, 40.0, 50.0, -3.0, 28.0, 0.0, 60.0, 0.0, 20.0, 40.0, 25.0, 0.0, 50.0, 110.0, 70.0, 60.0, 50.0, 28.0, -2.0, 0.0, 50.0, 60.0, 50.0, 24.0, 40.0, 12.0, 28.0, 14.0, 10.0, 29.0, 40.0, 70.0, -1.0, 30.0, 10.0, 20.0, 20.0, 50.0, 40.0, 38.0, 10.0, 0.0, 0.0, -10.0, -5.0, 50.0, 10.0, 40.0, 40.0, 40.0, 20.0, 30.0, 0.0, 20.0, 0.0, 7.0, 30.0, 29.0, 20.0, -2.0, 24.0, 30.0, 23.0, 30.0, 60.0, 40.0, 10.0, 13.0, 9.0, 40.0, 80.0, 40.0, 14.0, 60.0, 0.0, 60.0, 12.0, 50.0, 19.0, 80.0, 13.0, 30.0, -1.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 50.0, 40.0, 39.0, 70.0, 30.0, 29.0, 40.0, 16.0, 40.0, 10.0, 1.0, 0.0, 10.0, 10.0, 20.0, 40.0, -6.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 60.0, 70.0, 10.0, 50.0, 40.0, 10.0, 30.0, 20.0, 40.0, 50.0, 60.0, 10.0, 20.0, -5.0, 10.0, 60.0, 70.0, 50.0, 15.0, 20.0, 10.0, 20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0, 60.0, 50.0, 50.0, 70.0, 50.0, 20.0, 40.0, 70.0, 5.0, 20.0, 30.0, 50.0, 50.0, 20.0, 60.0, 10.0, 10.0, 40.0, 40.0, 20.0, 50.0, 17.0, 9.0, 0.0, -2.0, 0.0, 50.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 10.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 19.0, 50.0, 70.0, 70.0, 18.0, 29.0, 75.0, 10.0, 10.0, 10.0, 9.0, 37.0, 0.0, 20.0, 18.0, 40.0, 40.0, 0.0, 37.0, 0.0, 10.0, 29.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 0.0, 0.0, 19.0, 50.0, 76.0, -2.0, 17.0, 60.0, -5.0, 30.0, 40.0, 50.0, 10.0, 20.0, 39.0, 9.0, 20.0, 10.0, 7.0, 4.0, 10.0, 19.0, 40.0, 30.0, 40.0, 48.0, 0.0, -2.0, 0.0, 18.0, 30.0, 39.0, 10.0, 40.0, 36.0, 30.0, 50.0, 15.0, 27.0, 30.0, 10.0, 46.0, 26.0, 30.0, 10.0, 3.0, 30.0, 20.0, 40.0, 27.0, 34.0, 0.0, 28.0, 40.0, 28.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 60.0, 44.0, 20.0, 80.0, 40.0, 60.0, 0.0, 34.0, 40.0, 50.0, 10.0, 40.0, 50.0, 10.0, 0.0, 100.0, 18.0, 70.0, 50.0, 27.0, 100.0, 29.0, 50.0, 17.0, 9.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 5.0, 30.0, 20.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0, 60.0, 20.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 10.0, 29.0, 30.0, 10.0, 50.0, 0.0, 10.0, 20.0, 0.0, 40.0, 50.0, 10.0, 19.0, 30.0, 20.0, 30.0, -1.0, -2.0, 5.0, 10.0, 41.0, 20.0, 50.0, -4.0, 40.0, 30.0, 9.0, 28.0, 0.0, 40.0, 0.0, 60.0, 40.0, -12.0, 10.0, 10.0, 20.0, 50.0, 20.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 80.0, 20.0, 20.0, 20.0, 30.0, -2.0, 15.0, 10.0, 0.0, 30.0, 40.0, 0.0, 40.0, 30.0, 0.0, 50.0, 50.0, 50.0, 70.0, 30.0, 20.0, 60.0, 0.0, 35.0, 0.0, 40.0, 40.0, 50.0, 60.0, 35.0, 30.0, 70.0, 30.0, 20.0, 0.0, 30.0, 50.0, -5.0, 65.0, 10.0, 40.0, 20.0, 6.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 50.0, 40.0, 29.0, 20.0, 50.0, 50.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 10.0, 0.0, 10.0, 20.0, -6.0, 50.0, 20.0, -1.0, 18.0, -1.0, 30.0, 19.0, 28.0, 40.0, 5.0, 60.0, 70.0, 10.0, 20.0, 50.0, 30.0, 0.0, 34.0, 50.0, 20.0, -3.0, 10.0, -5.0, 20.0, 50.0, 55.0, 18.0, 30.0, 50.0, 29.0, 30.0, 70.0, 20.0, 8.0, 35.0, 50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0, 30.0, 40.0, 6.0, 20.0, 40.0, 20.0, 40.0, 10.0, 40.0, 15.0, 20.0, 9.0, 16.0, 0.0, 70.0, 30.0, 40.0, 40.0, 18.0, 27.0, 50.0, 60.0, 40.0, 30.0, 30.0, 40.0, 69.0, 30.0, 20.0, 70.0, 20.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 20.0, 50.0, 10.0, 90.0, 20.0, 0.0, 14.0, 37.0, 19.0, 70.0, 100.0, 40.0, 48.0, 60.0, 18.0, 20.0, 30.0, 30.0, 16.0, 50.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 60.0, 50.0, 10.0, 50.0, 10.0, 0.0, 0.0, 30.0, 8.0, 4.0, 0.0, 5.0, 20.0, 40.0, 60.0, 10.0, 50.0, -5.0, 0.0, 20.0, -8.0, 20.0, 30.0, 30.0, 30.0, 10.0, 70.0, 17.0, 0.0, 30.0, 30.0, 10.0, 30.0, 50.0, 30.0, 100.0, 20.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 20.0, 18.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, 10.0, 45.0, 50.0, 10.0, 40.0, 80.0, 10.0, 20.0, 25.0, 50.0, 5.0, 0.0, 60.0, 25.0, 19.0, 10.0, 50.0, 30.0, 80.0, 25.0, 9.0, 10.0, 10.0, 10.0, 24.0, 10.0, 10.0, 1.0, 20.0, 50.0, 0.0, 40.0, 20.0, 70.0, 20.0, 10.0, 30.0, 50.0, 55.0, 10.0, 20.0, 20.0, 10.0, 10.0, 50.0, 30.0, 40.0, 70.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 40.0, 20.0, 10.0, 30.0, 40.0, 0.0, 10.0, 50.0, 28.0, 30.0, -2.0, 10.0, -11.0, 19.0, 10.0, 2.0, 0.0, 70.0, 18.0, 9.0, 30.0, 20.0, 66.0, 65.0, 40.0, 0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0, 22.0, 15.0, 30.0, -2.0, 0.0, 20.0, 30.0, 30.0, 70.0, 15.0, 20.0, 10.0, 28.0, 20.0, 70.0, 29.0, 40.0, 40.0, 30.0, 90.0, 20.0, 20.0, 30.0, 40.0, 50.0, 70.0, 60.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 50.0, 40.0, 100.0, 50.0, 40.0, 40.0, 30.0, 50.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 120.0, 20.0, 10.0, 40.0, 28.0, 40.0, 0.0, 30.0, 30.0, 20.0, 27.0, 20.0, 70.0, 60.0, 10.0, 30.0, 0.0, 20.0, 20.0, 40.0, 19.0, -5.0, 10.0, 50.0, 19.0, -5.0, 19.0, 20.0, 50.0, 60.0, 70.0, 70.0, 18.0, 30.0, 20.0, 29.0, 20.0, 60.0, 20.0, 18.0, 60.0, 130.0, 60.0, 10.0, 50.0, 0.0, 40.0, 50.0, 30.0, 50.0, 20.0, 50.0, 10.0, 30.0, -6.0, 30.0, 80.0, 0.0, -5.0, 70.0, 40.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 30.0, 47.0, 30.0, 68.0, 30.0, 30.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 19.0, 10.0, 20.0, 80.0, 20.0, 60.0, 30.0, 20.0, 20.0, 0.0, 50.0, 30.0, 50.0, 30.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 20.0, -1.0, 50.0, 60.0, 60.0, 10.0, 30.0, 30.0, 50.0, 30.0, 30.0, 20.0, 100.0, 40.0, 30.0, 0.0, 40.0, 20.0, 80.0, 10.0, 40.0, 30.0, 40.0, 47.0, 20.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 60.0, 10.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 60.0, 0.0, 40.0, 70.0, 40.0, 60.0, 29.0, 10.0, 0.0, 40.0, 0.0, 60.0, 90.0, 20.0, 30.0, 40.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 60.0, 40.0, 80.0, 70.0, 60.0, 40.0, 10.0, 0.0, 80.0, 10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7978976343509359, "mean_inference_ms": 1.8957553889056769, "mean_action_processing_ms": 0.6046113223652059, "mean_env_wait_ms": 1.6516137051711608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011339664459228516, "StateBufferConnector_ms": 0.008568763732910156, "ViewRequirementAgentConnector_ms": 0.371614933013916}, "num_episodes": 23, "episode_return_max": 470.0, "episode_return_min": 119.0, "episode_return_mean": 290.49}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.496714783827823, "num_env_steps_trained_throughput_per_sec": 21.496714783827823, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 198578.57, "restore_workers_time_ms": 0.013, "training_step_time_ms": 198578.515, "sample_time_ms": 2998.128, "learn_time_ms": 195557.975, "learn_throughput": 20.454, "synch_weights_time_ms": 13.571}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "a22d3_00000", "date": "2024-08-06_00-42-06", "timestamp": 1722919326, "time_this_iter_s": 186.08594393730164, "time_total_s": 7118.936322927475, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1666310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7118.936322927475, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 30.823954372623575, "ram_util_percent": 77.81026615969583}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.602724074815917, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.92439130876011, "policy_loss": -0.009944210139587243, "vf_loss": 3.932776496306268, "vf_explained_var": 0.0050199929835062565, "kl": 0.007795111003318402, "entropy": 0.9416100772488485, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 470.0, "episode_reward_min": 120.0, "episode_reward_mean": 294.24, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -30.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 29.424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.0, 435.0, 330.0, 184.0, 240.0, 361.0, 201.0, 179.0, 335.0, 148.0, 243.0, 294.0, 220.0, 256.0, 378.0, 465.0, 195.0, 155.0, 407.0, 270.0, 199.0, 196.0, 229.0, 218.0, 210.0, 330.0, 163.0, 365.0, 375.0, 256.0, 239.0, 390.0, 120.0, 332.0, 206.0, 345.0, 192.0, 261.0, 270.0, 439.0, 330.0, 160.0, 438.0, 244.0, 280.0, 177.0, 177.0, 367.0, 320.0, 188.0, 335.0, 308.0, 145.0, 325.0, 290.0, 310.0, 144.0, 320.0, 420.0, 230.0, 377.0, 400.0, 420.0, 380.0, 305.0, 204.0, 371.0, 447.0, 310.0, 299.0, 355.0, 298.0, 310.0, 249.0, 420.0, 330.0, 257.0, 340.0, 289.0, 380.0, 470.0, 220.0, 410.0, 345.0, 420.0, 180.0, 159.0, 205.0, 241.0, 270.0, 366.0, 297.0, 340.0, 320.0, 413.0, 269.0, 329.0, 311.0, 319.0, 267.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 28.0, 80.0, 30.0, 90.0, 16.0, 40.0, 40.0, 10.0, 39.0, 60.0, 50.0, 50.0, 70.0, 50.0, 20.0, 40.0, 70.0, 5.0, 20.0, 30.0, 50.0, 50.0, 20.0, 60.0, 10.0, 10.0, 40.0, 40.0, 20.0, 50.0, 17.0, 9.0, 0.0, -2.0, 0.0, 50.0, 30.0, 20.0, 10.0, 50.0, 30.0, 20.0, 10.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 19.0, 50.0, 70.0, 70.0, 18.0, 29.0, 75.0, 10.0, 10.0, 10.0, 9.0, 37.0, 0.0, 20.0, 18.0, 40.0, 40.0, 0.0, 37.0, 0.0, 10.0, 29.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 0.0, 0.0, 19.0, 50.0, 76.0, -2.0, 17.0, 60.0, -5.0, 30.0, 40.0, 50.0, 10.0, 20.0, 39.0, 9.0, 20.0, 10.0, 7.0, 4.0, 10.0, 19.0, 40.0, 30.0, 40.0, 48.0, 0.0, -2.0, 0.0, 18.0, 30.0, 39.0, 10.0, 40.0, 36.0, 30.0, 50.0, 15.0, 27.0, 30.0, 10.0, 46.0, 26.0, 30.0, 10.0, 3.0, 30.0, 20.0, 40.0, 27.0, 34.0, 0.0, 28.0, 40.0, 28.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 60.0, 44.0, 20.0, 80.0, 40.0, 60.0, 0.0, 34.0, 40.0, 50.0, 10.0, 40.0, 50.0, 10.0, 0.0, 100.0, 18.0, 70.0, 50.0, 27.0, 100.0, 29.0, 50.0, 17.0, 9.0, 30.0, 0.0, 0.0, 50.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 5.0, 30.0, 20.0, 0.0, 60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0, 60.0, 20.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 10.0, 29.0, 30.0, 10.0, 50.0, 0.0, 10.0, 20.0, 0.0, 40.0, 50.0, 10.0, 19.0, 30.0, 20.0, 30.0, -1.0, -2.0, 5.0, 10.0, 41.0, 20.0, 50.0, -4.0, 40.0, 30.0, 9.0, 28.0, 0.0, 40.0, 0.0, 60.0, 40.0, -12.0, 10.0, 10.0, 20.0, 50.0, 20.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 80.0, 20.0, 20.0, 20.0, 30.0, -2.0, 15.0, 10.0, 0.0, 30.0, 40.0, 0.0, 40.0, 30.0, 0.0, 50.0, 50.0, 50.0, 70.0, 30.0, 20.0, 60.0, 0.0, 35.0, 0.0, 40.0, 40.0, 50.0, 60.0, 35.0, 30.0, 70.0, 30.0, 20.0, 0.0, 30.0, 50.0, -5.0, 65.0, 10.0, 40.0, 20.0, 6.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 50.0, 40.0, 29.0, 20.0, 50.0, 50.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 10.0, 0.0, 10.0, 20.0, -6.0, 50.0, 20.0, -1.0, 18.0, -1.0, 30.0, 19.0, 28.0, 40.0, 5.0, 60.0, 70.0, 10.0, 20.0, 50.0, 30.0, 0.0, 34.0, 50.0, 20.0, -3.0, 10.0, -5.0, 20.0, 50.0, 55.0, 18.0, 30.0, 50.0, 29.0, 30.0, 70.0, 20.0, 8.0, 35.0, 50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0, 30.0, 40.0, 6.0, 20.0, 40.0, 20.0, 40.0, 10.0, 40.0, 15.0, 20.0, 9.0, 16.0, 0.0, 70.0, 30.0, 40.0, 40.0, 18.0, 27.0, 50.0, 60.0, 40.0, 30.0, 30.0, 40.0, 69.0, 30.0, 20.0, 70.0, 20.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 20.0, 50.0, 10.0, 90.0, 20.0, 0.0, 14.0, 37.0, 19.0, 70.0, 100.0, 40.0, 48.0, 60.0, 18.0, 20.0, 30.0, 30.0, 16.0, 50.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 60.0, 50.0, 10.0, 50.0, 10.0, 0.0, 0.0, 30.0, 8.0, 4.0, 0.0, 5.0, 20.0, 40.0, 60.0, 10.0, 50.0, -5.0, 0.0, 20.0, -8.0, 20.0, 30.0, 30.0, 30.0, 10.0, 70.0, 17.0, 0.0, 30.0, 30.0, 10.0, 30.0, 50.0, 30.0, 100.0, 20.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 20.0, 18.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, 10.0, 45.0, 50.0, 10.0, 40.0, 80.0, 10.0, 20.0, 25.0, 50.0, 5.0, 0.0, 60.0, 25.0, 19.0, 10.0, 50.0, 30.0, 80.0, 25.0, 9.0, 10.0, 10.0, 10.0, 24.0, 10.0, 10.0, 1.0, 20.0, 50.0, 0.0, 40.0, 20.0, 70.0, 20.0, 10.0, 30.0, 50.0, 55.0, 10.0, 20.0, 20.0, 10.0, 10.0, 50.0, 30.0, 40.0, 70.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 40.0, 20.0, 10.0, 30.0, 40.0, 0.0, 10.0, 50.0, 28.0, 30.0, -2.0, 10.0, -11.0, 19.0, 10.0, 2.0, 0.0, 70.0, 18.0, 9.0, 30.0, 20.0, 66.0, 65.0, 40.0, 0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0, 22.0, 15.0, 30.0, -2.0, 0.0, 20.0, 30.0, 30.0, 70.0, 15.0, 20.0, 10.0, 28.0, 20.0, 70.0, 29.0, 40.0, 40.0, 30.0, 90.0, 20.0, 20.0, 30.0, 40.0, 50.0, 70.0, 60.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 50.0, 40.0, 100.0, 50.0, 40.0, 40.0, 30.0, 50.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 120.0, 20.0, 10.0, 40.0, 28.0, 40.0, 0.0, 30.0, 30.0, 20.0, 27.0, 20.0, 70.0, 60.0, 10.0, 30.0, 0.0, 20.0, 20.0, 40.0, 19.0, -5.0, 10.0, 50.0, 19.0, -5.0, 19.0, 20.0, 50.0, 60.0, 70.0, 70.0, 18.0, 30.0, 20.0, 29.0, 20.0, 60.0, 20.0, 18.0, 60.0, 130.0, 60.0, 10.0, 50.0, 0.0, 40.0, 50.0, 30.0, 50.0, 20.0, 50.0, 10.0, 30.0, -6.0, 30.0, 80.0, 0.0, -5.0, 70.0, 40.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 30.0, 47.0, 30.0, 68.0, 30.0, 30.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 19.0, 10.0, 20.0, 80.0, 20.0, 60.0, 30.0, 20.0, 20.0, 0.0, 50.0, 30.0, 50.0, 30.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 20.0, -1.0, 50.0, 60.0, 60.0, 10.0, 30.0, 30.0, 50.0, 30.0, 30.0, 20.0, 100.0, 40.0, 30.0, 0.0, 40.0, 20.0, 80.0, 10.0, 40.0, 30.0, 40.0, 47.0, 20.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 60.0, 10.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 60.0, 0.0, 40.0, 70.0, 40.0, 60.0, 29.0, 10.0, 0.0, 40.0, 0.0, 60.0, 90.0, 20.0, 30.0, 40.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 60.0, 40.0, 80.0, 70.0, 60.0, 40.0, 10.0, 0.0, 80.0, 10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 20.0, 40.0, 40.0, 60.0, 110.0, 30.0, 10.0, 20.0, 30.0, 0.0, 30.0, 18.0, 47.0, 40.0, 24.0, 26.0, 40.0, 40.0, 80.0, 10.0, 60.0, 70.0, 50.0, 20.0, 70.0, 40.0, 70.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 40.0, 7.0, 20.0, -1.0, 19.0, 25.0, -30.0, 29.0, 0.0, 40.0, 0.0, 10.0, -25.0, 10.0, 20.0, 70.0, 40.0, 40.0, 14.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 27.0, 40.0, 20.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 20.0, 16.0, 30.0, 140.0, 0.0, 40.0, 0.0, 60.0, 20.0, 30.0, 29.0, 18.0, 10.0, 60.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 80.0, 50.0, 20.0, 50.0, 0.0, 60.0, 20.0, 40.0, 30.0, 60.0, 10.0, 30.0, 20.0, 60.0, 20.0, 30.0, 20.0, 38.0, 55.0, 60.0, 90.0, 20.0, 10.0, 0.0, 70.0, 20.0, 30.0, 30.0, 30.0, 39.0, 30.0, 10.0, 10.0, 10.0, 60.0, 30.0, 100.0, 30.0, 9.0, 20.0, 30.0, 30.0, 8.0, 20.0, 30.0, 40.0, 80.0, 40.0, 20.0, 20.0, 54.0, -1.0, 30.0, 20.0, 46.0, 9.0, 10.0, 26.0, 28.0, 30.0, 60.0, 60.0, 49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.787909185407364, "mean_inference_ms": 1.8826234835167441, "mean_action_processing_ms": 0.5996283010663983, "mean_env_wait_ms": 1.6395263789054317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011414527893066406, "StateBufferConnector_ms": 0.008924484252929688, "ViewRequirementAgentConnector_ms": 0.3569190502166748}, "num_episodes": 18, "episode_return_max": 470.0, "episode_return_min": 120.0, "episode_return_mean": 294.24}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.350944159123355, "num_env_steps_trained_throughput_per_sec": 21.350944159123355, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 195776.956, "restore_workers_time_ms": 0.012, "training_step_time_ms": 195776.902, "sample_time_ms": 2881.732, "learn_time_ms": 192873.107, "learn_throughput": 20.739, "synch_weights_time_ms": 13.279}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "a22d3_00000", "date": "2024-08-06_00-45-14", "timestamp": 1722919514, "time_this_iter_s": 187.3552529811859, "time_total_s": 7306.291575908661, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1666e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7306.291575908661, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 30.410566037735848, "ram_util_percent": 77.8433962264151}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3154128028688845, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.280549843166583, "policy_loss": -0.009611240808635799, "vf_loss": 3.2886271763025636, "vf_explained_var": 0.0016463917855637524, "kl": 0.007669548898965084, "entropy": 0.9869566607970399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 492.0, "episode_reward_min": 111.0, "episode_reward_mean": 288.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -33.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 28.842}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.0, 270.0, 199.0, 196.0, 229.0, 218.0, 210.0, 330.0, 163.0, 365.0, 375.0, 256.0, 239.0, 390.0, 120.0, 332.0, 206.0, 345.0, 192.0, 261.0, 270.0, 439.0, 330.0, 160.0, 438.0, 244.0, 280.0, 177.0, 177.0, 367.0, 320.0, 188.0, 335.0, 308.0, 145.0, 325.0, 290.0, 310.0, 144.0, 320.0, 420.0, 230.0, 377.0, 400.0, 420.0, 380.0, 305.0, 204.0, 371.0, 447.0, 310.0, 299.0, 355.0, 298.0, 310.0, 249.0, 420.0, 330.0, 257.0, 340.0, 289.0, 380.0, 470.0, 220.0, 410.0, 345.0, 420.0, 180.0, 159.0, 205.0, 241.0, 270.0, 366.0, 297.0, 340.0, 320.0, 413.0, 269.0, 329.0, 311.0, 319.0, 267.0, 210.0, 148.0, 290.0, 164.0, 330.0, 492.0, 340.0, 127.0, 111.0, 401.0, 280.0, 134.0, 203.0, 194.0, 228.0, 325.0, 253.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 80.0, 60.0, 20.0, 10.0, 40.0, 70.0, 28.0, 9.0, 60.0, 20.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 10.0, 29.0, 30.0, 10.0, 50.0, 0.0, 10.0, 20.0, 0.0, 40.0, 50.0, 10.0, 19.0, 30.0, 20.0, 30.0, -1.0, -2.0, 5.0, 10.0, 41.0, 20.0, 50.0, -4.0, 40.0, 30.0, 9.0, 28.0, 0.0, 40.0, 0.0, 60.0, 40.0, -12.0, 10.0, 10.0, 20.0, 50.0, 20.0, 20.0, 20.0, 40.0, 0.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 40.0, 50.0, 40.0, 10.0, 80.0, 20.0, 20.0, 20.0, 30.0, -2.0, 15.0, 10.0, 0.0, 30.0, 40.0, 0.0, 40.0, 30.0, 0.0, 50.0, 50.0, 50.0, 70.0, 30.0, 20.0, 60.0, 0.0, 35.0, 0.0, 40.0, 40.0, 50.0, 60.0, 35.0, 30.0, 70.0, 30.0, 20.0, 0.0, 30.0, 50.0, -5.0, 65.0, 10.0, 40.0, 20.0, 6.0, 20.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 50.0, 40.0, 29.0, 20.0, 50.0, 50.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 10.0, 0.0, 10.0, 20.0, -6.0, 50.0, 20.0, -1.0, 18.0, -1.0, 30.0, 19.0, 28.0, 40.0, 5.0, 60.0, 70.0, 10.0, 20.0, 50.0, 30.0, 0.0, 34.0, 50.0, 20.0, -3.0, 10.0, -5.0, 20.0, 50.0, 55.0, 18.0, 30.0, 50.0, 29.0, 30.0, 70.0, 20.0, 8.0, 35.0, 50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0, 30.0, 40.0, 6.0, 20.0, 40.0, 20.0, 40.0, 10.0, 40.0, 15.0, 20.0, 9.0, 16.0, 0.0, 70.0, 30.0, 40.0, 40.0, 18.0, 27.0, 50.0, 60.0, 40.0, 30.0, 30.0, 40.0, 69.0, 30.0, 20.0, 70.0, 20.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 20.0, 50.0, 10.0, 90.0, 20.0, 0.0, 14.0, 37.0, 19.0, 70.0, 100.0, 40.0, 48.0, 60.0, 18.0, 20.0, 30.0, 30.0, 16.0, 50.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 60.0, 50.0, 10.0, 50.0, 10.0, 0.0, 0.0, 30.0, 8.0, 4.0, 0.0, 5.0, 20.0, 40.0, 60.0, 10.0, 50.0, -5.0, 0.0, 20.0, -8.0, 20.0, 30.0, 30.0, 30.0, 10.0, 70.0, 17.0, 0.0, 30.0, 30.0, 10.0, 30.0, 50.0, 30.0, 100.0, 20.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 20.0, 18.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, 10.0, 45.0, 50.0, 10.0, 40.0, 80.0, 10.0, 20.0, 25.0, 50.0, 5.0, 0.0, 60.0, 25.0, 19.0, 10.0, 50.0, 30.0, 80.0, 25.0, 9.0, 10.0, 10.0, 10.0, 24.0, 10.0, 10.0, 1.0, 20.0, 50.0, 0.0, 40.0, 20.0, 70.0, 20.0, 10.0, 30.0, 50.0, 55.0, 10.0, 20.0, 20.0, 10.0, 10.0, 50.0, 30.0, 40.0, 70.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 40.0, 20.0, 10.0, 30.0, 40.0, 0.0, 10.0, 50.0, 28.0, 30.0, -2.0, 10.0, -11.0, 19.0, 10.0, 2.0, 0.0, 70.0, 18.0, 9.0, 30.0, 20.0, 66.0, 65.0, 40.0, 0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0, 22.0, 15.0, 30.0, -2.0, 0.0, 20.0, 30.0, 30.0, 70.0, 15.0, 20.0, 10.0, 28.0, 20.0, 70.0, 29.0, 40.0, 40.0, 30.0, 90.0, 20.0, 20.0, 30.0, 40.0, 50.0, 70.0, 60.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 50.0, 40.0, 100.0, 50.0, 40.0, 40.0, 30.0, 50.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 120.0, 20.0, 10.0, 40.0, 28.0, 40.0, 0.0, 30.0, 30.0, 20.0, 27.0, 20.0, 70.0, 60.0, 10.0, 30.0, 0.0, 20.0, 20.0, 40.0, 19.0, -5.0, 10.0, 50.0, 19.0, -5.0, 19.0, 20.0, 50.0, 60.0, 70.0, 70.0, 18.0, 30.0, 20.0, 29.0, 20.0, 60.0, 20.0, 18.0, 60.0, 130.0, 60.0, 10.0, 50.0, 0.0, 40.0, 50.0, 30.0, 50.0, 20.0, 50.0, 10.0, 30.0, -6.0, 30.0, 80.0, 0.0, -5.0, 70.0, 40.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 30.0, 47.0, 30.0, 68.0, 30.0, 30.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 19.0, 10.0, 20.0, 80.0, 20.0, 60.0, 30.0, 20.0, 20.0, 0.0, 50.0, 30.0, 50.0, 30.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 20.0, -1.0, 50.0, 60.0, 60.0, 10.0, 30.0, 30.0, 50.0, 30.0, 30.0, 20.0, 100.0, 40.0, 30.0, 0.0, 40.0, 20.0, 80.0, 10.0, 40.0, 30.0, 40.0, 47.0, 20.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 60.0, 10.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 60.0, 0.0, 40.0, 70.0, 40.0, 60.0, 29.0, 10.0, 0.0, 40.0, 0.0, 60.0, 90.0, 20.0, 30.0, 40.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 60.0, 40.0, 80.0, 70.0, 60.0, 40.0, 10.0, 0.0, 80.0, 10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 20.0, 40.0, 40.0, 60.0, 110.0, 30.0, 10.0, 20.0, 30.0, 0.0, 30.0, 18.0, 47.0, 40.0, 24.0, 26.0, 40.0, 40.0, 80.0, 10.0, 60.0, 70.0, 50.0, 20.0, 70.0, 40.0, 70.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 40.0, 7.0, 20.0, -1.0, 19.0, 25.0, -30.0, 29.0, 0.0, 40.0, 0.0, 10.0, -25.0, 10.0, 20.0, 70.0, 40.0, 40.0, 14.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 27.0, 40.0, 20.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 20.0, 16.0, 30.0, 140.0, 0.0, 40.0, 0.0, 60.0, 20.0, 30.0, 29.0, 18.0, 10.0, 60.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 80.0, 50.0, 20.0, 50.0, 0.0, 60.0, 20.0, 40.0, 30.0, 60.0, 10.0, 30.0, 20.0, 60.0, 20.0, 30.0, 20.0, 38.0, 55.0, 60.0, 90.0, 20.0, 10.0, 0.0, 70.0, 20.0, 30.0, 30.0, 30.0, 39.0, 30.0, 10.0, 10.0, 10.0, 60.0, 30.0, 100.0, 30.0, 9.0, 20.0, 30.0, 30.0, 8.0, 20.0, 30.0, 40.0, 80.0, 40.0, 20.0, 20.0, 54.0, -1.0, 30.0, 20.0, 46.0, 9.0, 10.0, 26.0, 28.0, 30.0, 60.0, 60.0, 49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 13.0, 40.0, -13.0, 30.0, 0.0, 20.0, 10.0, 30.0, 8.0, 40.0, 50.0, 40.0, 30.0, 10.0, 30.0, 30.0, 0.0, 30.0, 30.0, 40.0, 20.0, 10.0, 30.0, 20.0, -4.0, 50.0, -27.0, 15.0, 10.0, 60.0, 50.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 40.0, 40.0, 80.0, 67.0, 20.0, 69.0, 46.0, 40.0, 60.0, 30.0, 20.0, 5.0, 50.0, 30.0, 70.0, 15.0, 50.0, 20.0, 20.0, 60.0, 10.0, 11.0, 20.0, 32.0, 40.0, 10.0, -8.0, 0.0, 2.0, 10.0, 18.0, 20.0, 20.0, 0.0, 0.0, 10.0, 41.0, -28.0, 20.0, 10.0, 60.0, 20.0, 50.0, 10.0, 98.0, 20.0, -17.0, 40.0, 80.0, 40.0, 0.0, 30.0, 50.0, 60.0, 20.0, 0.0, 20.0, 20.0, 20.0, 60.0, -3.0, 10.0, 20.0, 9.0, 20.0, 30.0, 9.0, 9.0, 40.0, -10.0, 20.0, 20.0, 19.0, 39.0, 5.0, 10.0, 28.0, 33.0, 10.0, 19.0, 0.0, 40.0, 10.0, 10.0, 15.0, 30.0, 9.0, 0.0, 30.0, 50.0, 30.0, 30.0, 40.0, 10.0, 30.0, -9.0, 60.0, -33.0, 40.0, 30.0, 40.0, 80.0, 10.0, 20.0, 20.0, 20.0, 5.0, 40.0, 20.0, 70.0, 0.0, 30.0, 27.0, 40.0, 50.0, 50.0, -4.0, 10.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.778207372128702, "mean_inference_ms": 1.8709717359617088, "mean_action_processing_ms": 0.5951400530986326, "mean_env_wait_ms": 1.6288800868543507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011520862579345703, "StateBufferConnector_ms": 0.008974790573120117, "ViewRequirementAgentConnector_ms": 0.35639286041259766}, "num_episodes": 18, "episode_return_max": 492.0, "episode_return_min": 111.0, "episode_return_mean": 288.42}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.511989785930506, "num_env_steps_trained_throughput_per_sec": 21.511989785930506, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 192903.696, "restore_workers_time_ms": 0.012, "training_step_time_ms": 192903.643, "sample_time_ms": 2794.189, "learn_time_ms": 190087.715, "learn_throughput": 21.043, "synch_weights_time_ms": 12.88}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "a22d3_00000", "date": "2024-08-06_00-48-19", "timestamp": 1722919699, "time_this_iter_s": 185.9535369873047, "time_total_s": 7492.245112895966, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01cbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7492.245112895966, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 25.76882129277567, "ram_util_percent": 77.56235741444867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.471026152023238, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.111653804144286, "policy_loss": -0.010214233835261509, "vf_loss": 4.120295643095518, "vf_explained_var": 0.009423134775080493, "kl": 0.007861983177830304, "entropy": 0.9503602833222277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 587.0, "episode_reward_min": 111.0, "episode_reward_mean": 298.39, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -45.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 29.839}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.0, 261.0, 270.0, 439.0, 330.0, 160.0, 438.0, 244.0, 280.0, 177.0, 177.0, 367.0, 320.0, 188.0, 335.0, 308.0, 145.0, 325.0, 290.0, 310.0, 144.0, 320.0, 420.0, 230.0, 377.0, 400.0, 420.0, 380.0, 305.0, 204.0, 371.0, 447.0, 310.0, 299.0, 355.0, 298.0, 310.0, 249.0, 420.0, 330.0, 257.0, 340.0, 289.0, 380.0, 470.0, 220.0, 410.0, 345.0, 420.0, 180.0, 159.0, 205.0, 241.0, 270.0, 366.0, 297.0, 340.0, 320.0, 413.0, 269.0, 329.0, 311.0, 319.0, 267.0, 210.0, 148.0, 290.0, 164.0, 330.0, 492.0, 340.0, 127.0, 111.0, 401.0, 280.0, 134.0, 203.0, 194.0, 228.0, 325.0, 253.0, 200.0, 271.0, 260.0, 315.0, 318.0, 138.0, 168.0, 587.0, 369.0, 340.0, 370.0, 420.0, 290.0, 314.0, 350.0, 310.0, 480.0, 327.0, 220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 30.0, 7.0, 50.0, -4.0, 9.0, 20.0, 0.0, 15.0, 15.0, 30.0, 40.0, 6.0, 20.0, 40.0, 20.0, 40.0, 10.0, 40.0, 15.0, 20.0, 9.0, 16.0, 0.0, 70.0, 30.0, 40.0, 40.0, 18.0, 27.0, 50.0, 60.0, 40.0, 30.0, 30.0, 40.0, 69.0, 30.0, 20.0, 70.0, 20.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 40.0, 30.0, 20.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 20.0, 50.0, 10.0, 90.0, 20.0, 0.0, 14.0, 37.0, 19.0, 70.0, 100.0, 40.0, 48.0, 60.0, 18.0, 20.0, 30.0, 30.0, 16.0, 50.0, 0.0, 20.0, 0.0, 50.0, 10.0, 10.0, 30.0, 60.0, 50.0, 10.0, 50.0, 10.0, 0.0, 0.0, 30.0, 8.0, 4.0, 0.0, 5.0, 20.0, 40.0, 60.0, 10.0, 50.0, -5.0, 0.0, 20.0, -8.0, 20.0, 30.0, 30.0, 30.0, 10.0, 70.0, 17.0, 0.0, 30.0, 30.0, 10.0, 30.0, 50.0, 30.0, 100.0, 20.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 20.0, 40.0, 40.0, 20.0, 18.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, 10.0, 45.0, 50.0, 10.0, 40.0, 80.0, 10.0, 20.0, 25.0, 50.0, 5.0, 0.0, 60.0, 25.0, 19.0, 10.0, 50.0, 30.0, 80.0, 25.0, 9.0, 10.0, 10.0, 10.0, 24.0, 10.0, 10.0, 1.0, 20.0, 50.0, 0.0, 40.0, 20.0, 70.0, 20.0, 10.0, 30.0, 50.0, 55.0, 10.0, 20.0, 20.0, 10.0, 10.0, 50.0, 30.0, 40.0, 70.0, 10.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 40.0, 20.0, 10.0, 30.0, 40.0, 0.0, 10.0, 50.0, 28.0, 30.0, -2.0, 10.0, -11.0, 19.0, 10.0, 2.0, 0.0, 70.0, 18.0, 9.0, 30.0, 20.0, 66.0, 65.0, 40.0, 0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0, 22.0, 15.0, 30.0, -2.0, 0.0, 20.0, 30.0, 30.0, 70.0, 15.0, 20.0, 10.0, 28.0, 20.0, 70.0, 29.0, 40.0, 40.0, 30.0, 90.0, 20.0, 20.0, 30.0, 40.0, 50.0, 70.0, 60.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 50.0, 40.0, 100.0, 50.0, 40.0, 40.0, 30.0, 50.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 120.0, 20.0, 10.0, 40.0, 28.0, 40.0, 0.0, 30.0, 30.0, 20.0, 27.0, 20.0, 70.0, 60.0, 10.0, 30.0, 0.0, 20.0, 20.0, 40.0, 19.0, -5.0, 10.0, 50.0, 19.0, -5.0, 19.0, 20.0, 50.0, 60.0, 70.0, 70.0, 18.0, 30.0, 20.0, 29.0, 20.0, 60.0, 20.0, 18.0, 60.0, 130.0, 60.0, 10.0, 50.0, 0.0, 40.0, 50.0, 30.0, 50.0, 20.0, 50.0, 10.0, 30.0, -6.0, 30.0, 80.0, 0.0, -5.0, 70.0, 40.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 30.0, 47.0, 30.0, 68.0, 30.0, 30.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 19.0, 10.0, 20.0, 80.0, 20.0, 60.0, 30.0, 20.0, 20.0, 0.0, 50.0, 30.0, 50.0, 30.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 20.0, -1.0, 50.0, 60.0, 60.0, 10.0, 30.0, 30.0, 50.0, 30.0, 30.0, 20.0, 100.0, 40.0, 30.0, 0.0, 40.0, 20.0, 80.0, 10.0, 40.0, 30.0, 40.0, 47.0, 20.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 60.0, 10.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 60.0, 0.0, 40.0, 70.0, 40.0, 60.0, 29.0, 10.0, 0.0, 40.0, 0.0, 60.0, 90.0, 20.0, 30.0, 40.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 60.0, 40.0, 80.0, 70.0, 60.0, 40.0, 10.0, 0.0, 80.0, 10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 20.0, 40.0, 40.0, 60.0, 110.0, 30.0, 10.0, 20.0, 30.0, 0.0, 30.0, 18.0, 47.0, 40.0, 24.0, 26.0, 40.0, 40.0, 80.0, 10.0, 60.0, 70.0, 50.0, 20.0, 70.0, 40.0, 70.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 40.0, 7.0, 20.0, -1.0, 19.0, 25.0, -30.0, 29.0, 0.0, 40.0, 0.0, 10.0, -25.0, 10.0, 20.0, 70.0, 40.0, 40.0, 14.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 27.0, 40.0, 20.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 20.0, 16.0, 30.0, 140.0, 0.0, 40.0, 0.0, 60.0, 20.0, 30.0, 29.0, 18.0, 10.0, 60.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 80.0, 50.0, 20.0, 50.0, 0.0, 60.0, 20.0, 40.0, 30.0, 60.0, 10.0, 30.0, 20.0, 60.0, 20.0, 30.0, 20.0, 38.0, 55.0, 60.0, 90.0, 20.0, 10.0, 0.0, 70.0, 20.0, 30.0, 30.0, 30.0, 39.0, 30.0, 10.0, 10.0, 10.0, 60.0, 30.0, 100.0, 30.0, 9.0, 20.0, 30.0, 30.0, 8.0, 20.0, 30.0, 40.0, 80.0, 40.0, 20.0, 20.0, 54.0, -1.0, 30.0, 20.0, 46.0, 9.0, 10.0, 26.0, 28.0, 30.0, 60.0, 60.0, 49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 13.0, 40.0, -13.0, 30.0, 0.0, 20.0, 10.0, 30.0, 8.0, 40.0, 50.0, 40.0, 30.0, 10.0, 30.0, 30.0, 0.0, 30.0, 30.0, 40.0, 20.0, 10.0, 30.0, 20.0, -4.0, 50.0, -27.0, 15.0, 10.0, 60.0, 50.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 40.0, 40.0, 80.0, 67.0, 20.0, 69.0, 46.0, 40.0, 60.0, 30.0, 20.0, 5.0, 50.0, 30.0, 70.0, 15.0, 50.0, 20.0, 20.0, 60.0, 10.0, 11.0, 20.0, 32.0, 40.0, 10.0, -8.0, 0.0, 2.0, 10.0, 18.0, 20.0, 20.0, 0.0, 0.0, 10.0, 41.0, -28.0, 20.0, 10.0, 60.0, 20.0, 50.0, 10.0, 98.0, 20.0, -17.0, 40.0, 80.0, 40.0, 0.0, 30.0, 50.0, 60.0, 20.0, 0.0, 20.0, 20.0, 20.0, 60.0, -3.0, 10.0, 20.0, 9.0, 20.0, 30.0, 9.0, 9.0, 40.0, -10.0, 20.0, 20.0, 19.0, 39.0, 5.0, 10.0, 28.0, 33.0, 10.0, 19.0, 0.0, 40.0, 10.0, 10.0, 15.0, 30.0, 9.0, 0.0, 30.0, 50.0, 30.0, 30.0, 40.0, 10.0, 30.0, -9.0, 60.0, -33.0, 40.0, 30.0, 40.0, 80.0, 10.0, 20.0, 20.0, 20.0, 5.0, 40.0, 20.0, 70.0, 0.0, 30.0, 27.0, 40.0, 50.0, 50.0, -4.0, 10.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0, 50.0, 17.0, 20.0, 29.0, 70.0, 0.0, 19.0, 16.0, 40.0, 10.0, 60.0, 17.0, 20.0, 20.0, 38.0, -15.0, 10.0, 20.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, -45.0, 30.0, 0.0, 30.0, 60.0, 60.0, 20.0, 40.0, 40.0, 40.0, 10.0, 30.0, 38.0, 70.0, 30.0, 0.0, 20.0, 10.0, 18.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 19.0, 20.0, 14.0, 10.0, 30.0, 30.0, -2.0, 8.0, 19.0, 20.0, 104.0, 50.0, 90.0, 60.0, 50.0, 60.0, 53.0, 20.0, 40.0, 60.0, 50.0, 10.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 80.0, 29.0, 30.0, 20.0, 30.0, 40.0, 30.0, 0.0, 90.0, 30.0, 30.0, 40.0, 28.0, 50.0, 49.0, 36.0, 60.0, 40.0, 17.0, 10.0, 40.0, 40.0, 40.0, 30.0, 90.0, 40.0, 40.0, 50.0, 30.0, 20.0, 20.0, 60.0, 10.0, 70.0, 10.0, 50.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 35.0, 50.0, 40.0, 39.0, 70.0, 30.0, 60.0, 50.0, 10.0, 40.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 50.0, 50.0, 40.0, 60.0, 10.0, 20.0, 70.0, 60.0, 50.0, 50.0, 70.0, 40.0, 10.0, 70.0, 40.0, 20.0, -1.0, 30.0, 40.0, 30.0, -2.0, 40.0, 40.0, 90.0, 40.0, 40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7692069380903064, "mean_inference_ms": 1.8596732590966623, "mean_action_processing_ms": 0.5908730423628517, "mean_env_wait_ms": 1.6188049582025155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011456966400146484, "StateBufferConnector_ms": 0.00901174545288086, "ViewRequirementAgentConnector_ms": 0.3556849956512451}, "num_episodes": 18, "episode_return_max": 587.0, "episode_return_min": 111.0, "episode_return_mean": 298.39}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.778006541041364, "num_env_steps_trained_throughput_per_sec": 21.778006541041364, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 189273.916, "restore_workers_time_ms": 0.012, "training_step_time_ms": 189273.776, "sample_time_ms": 2725.574, "learn_time_ms": 186525.688, "learn_throughput": 21.445, "synch_weights_time_ms": 11.732}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "a22d3_00000", "date": "2024-08-06_00-51-23", "timestamp": 1722919883, "time_this_iter_s": 183.7073049545288, "time_total_s": 7675.952417850494, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16791f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7675.952417850494, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.701538461538462, "ram_util_percent": 77.36769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.469007714659261, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.722814319004266, "policy_loss": -0.010358894159903312, "vf_loss": 3.7314469766312133, "vf_explained_var": 0.004486487175836858, "kl": 0.00863119045192028, "entropy": 0.9560750451458656, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 587.0, "episode_reward_min": 111.0, "episode_reward_mean": 308.01, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 30.801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 230.0, 377.0, 400.0, 420.0, 380.0, 305.0, 204.0, 371.0, 447.0, 310.0, 299.0, 355.0, 298.0, 310.0, 249.0, 420.0, 330.0, 257.0, 340.0, 289.0, 380.0, 470.0, 220.0, 410.0, 345.0, 420.0, 180.0, 159.0, 205.0, 241.0, 270.0, 366.0, 297.0, 340.0, 320.0, 413.0, 269.0, 329.0, 311.0, 319.0, 267.0, 210.0, 148.0, 290.0, 164.0, 330.0, 492.0, 340.0, 127.0, 111.0, 401.0, 280.0, 134.0, 203.0, 194.0, 228.0, 325.0, 253.0, 200.0, 271.0, 260.0, 315.0, 318.0, 138.0, 168.0, 587.0, 369.0, 340.0, 370.0, 420.0, 290.0, 314.0, 350.0, 310.0, 480.0, 327.0, 220.0, 359.0, 175.0, 352.0, 420.0, 469.0, 185.0, 157.0, 294.0, 119.0, 498.0, 555.0, 330.0, 182.0, 279.0, 296.0, 325.0, 395.0, 209.0, 177.0, 380.0, 400.0, 426.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 80.0, 40.0, 40.0, 30.0, 80.0, 10.0, 50.0, 70.0, 22.0, 15.0, 30.0, -2.0, 0.0, 20.0, 30.0, 30.0, 70.0, 15.0, 20.0, 10.0, 28.0, 20.0, 70.0, 29.0, 40.0, 40.0, 30.0, 90.0, 20.0, 20.0, 30.0, 40.0, 50.0, 70.0, 60.0, 70.0, 10.0, 30.0, 40.0, 0.0, 30.0, 50.0, 40.0, 100.0, 50.0, 40.0, 40.0, 30.0, 50.0, 30.0, 10.0, 80.0, 10.0, 10.0, 40.0, 120.0, 20.0, 10.0, 40.0, 28.0, 40.0, 0.0, 30.0, 30.0, 20.0, 27.0, 20.0, 70.0, 60.0, 10.0, 30.0, 0.0, 20.0, 20.0, 40.0, 19.0, -5.0, 10.0, 50.0, 19.0, -5.0, 19.0, 20.0, 50.0, 60.0, 70.0, 70.0, 18.0, 30.0, 20.0, 29.0, 20.0, 60.0, 20.0, 18.0, 60.0, 130.0, 60.0, 10.0, 50.0, 0.0, 40.0, 50.0, 30.0, 50.0, 20.0, 50.0, 10.0, 30.0, -6.0, 30.0, 80.0, 0.0, -5.0, 70.0, 40.0, 40.0, 20.0, 40.0, 30.0, 0.0, 50.0, 30.0, 47.0, 30.0, 68.0, 30.0, 30.0, 30.0, 19.0, 20.0, 40.0, 30.0, 30.0, 19.0, 10.0, 20.0, 80.0, 20.0, 60.0, 30.0, 20.0, 20.0, 0.0, 50.0, 30.0, 50.0, 30.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 20.0, -1.0, 50.0, 60.0, 60.0, 10.0, 30.0, 30.0, 50.0, 30.0, 30.0, 20.0, 100.0, 40.0, 30.0, 0.0, 40.0, 20.0, 80.0, 10.0, 40.0, 30.0, 40.0, 47.0, 20.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 60.0, 10.0, 30.0, 30.0, 40.0, 50.0, 30.0, 20.0, 20.0, 50.0, 10.0, 60.0, 0.0, 40.0, 70.0, 40.0, 60.0, 29.0, 10.0, 0.0, 40.0, 0.0, 60.0, 90.0, 20.0, 30.0, 40.0, 0.0, 60.0, 50.0, 10.0, 20.0, 30.0, 60.0, 40.0, 80.0, 70.0, 60.0, 40.0, 10.0, 0.0, 80.0, 10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 20.0, 40.0, 40.0, 60.0, 110.0, 30.0, 10.0, 20.0, 30.0, 0.0, 30.0, 18.0, 47.0, 40.0, 24.0, 26.0, 40.0, 40.0, 80.0, 10.0, 60.0, 70.0, 50.0, 20.0, 70.0, 40.0, 70.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 40.0, 7.0, 20.0, -1.0, 19.0, 25.0, -30.0, 29.0, 0.0, 40.0, 0.0, 10.0, -25.0, 10.0, 20.0, 70.0, 40.0, 40.0, 14.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 27.0, 40.0, 20.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 20.0, 16.0, 30.0, 140.0, 0.0, 40.0, 0.0, 60.0, 20.0, 30.0, 29.0, 18.0, 10.0, 60.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 80.0, 50.0, 20.0, 50.0, 0.0, 60.0, 20.0, 40.0, 30.0, 60.0, 10.0, 30.0, 20.0, 60.0, 20.0, 30.0, 20.0, 38.0, 55.0, 60.0, 90.0, 20.0, 10.0, 0.0, 70.0, 20.0, 30.0, 30.0, 30.0, 39.0, 30.0, 10.0, 10.0, 10.0, 60.0, 30.0, 100.0, 30.0, 9.0, 20.0, 30.0, 30.0, 8.0, 20.0, 30.0, 40.0, 80.0, 40.0, 20.0, 20.0, 54.0, -1.0, 30.0, 20.0, 46.0, 9.0, 10.0, 26.0, 28.0, 30.0, 60.0, 60.0, 49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 13.0, 40.0, -13.0, 30.0, 0.0, 20.0, 10.0, 30.0, 8.0, 40.0, 50.0, 40.0, 30.0, 10.0, 30.0, 30.0, 0.0, 30.0, 30.0, 40.0, 20.0, 10.0, 30.0, 20.0, -4.0, 50.0, -27.0, 15.0, 10.0, 60.0, 50.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 40.0, 40.0, 80.0, 67.0, 20.0, 69.0, 46.0, 40.0, 60.0, 30.0, 20.0, 5.0, 50.0, 30.0, 70.0, 15.0, 50.0, 20.0, 20.0, 60.0, 10.0, 11.0, 20.0, 32.0, 40.0, 10.0, -8.0, 0.0, 2.0, 10.0, 18.0, 20.0, 20.0, 0.0, 0.0, 10.0, 41.0, -28.0, 20.0, 10.0, 60.0, 20.0, 50.0, 10.0, 98.0, 20.0, -17.0, 40.0, 80.0, 40.0, 0.0, 30.0, 50.0, 60.0, 20.0, 0.0, 20.0, 20.0, 20.0, 60.0, -3.0, 10.0, 20.0, 9.0, 20.0, 30.0, 9.0, 9.0, 40.0, -10.0, 20.0, 20.0, 19.0, 39.0, 5.0, 10.0, 28.0, 33.0, 10.0, 19.0, 0.0, 40.0, 10.0, 10.0, 15.0, 30.0, 9.0, 0.0, 30.0, 50.0, 30.0, 30.0, 40.0, 10.0, 30.0, -9.0, 60.0, -33.0, 40.0, 30.0, 40.0, 80.0, 10.0, 20.0, 20.0, 20.0, 5.0, 40.0, 20.0, 70.0, 0.0, 30.0, 27.0, 40.0, 50.0, 50.0, -4.0, 10.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0, 50.0, 17.0, 20.0, 29.0, 70.0, 0.0, 19.0, 16.0, 40.0, 10.0, 60.0, 17.0, 20.0, 20.0, 38.0, -15.0, 10.0, 20.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, -45.0, 30.0, 0.0, 30.0, 60.0, 60.0, 20.0, 40.0, 40.0, 40.0, 10.0, 30.0, 38.0, 70.0, 30.0, 0.0, 20.0, 10.0, 18.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 19.0, 20.0, 14.0, 10.0, 30.0, 30.0, -2.0, 8.0, 19.0, 20.0, 104.0, 50.0, 90.0, 60.0, 50.0, 60.0, 53.0, 20.0, 40.0, 60.0, 50.0, 10.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 80.0, 29.0, 30.0, 20.0, 30.0, 40.0, 30.0, 0.0, 90.0, 30.0, 30.0, 40.0, 28.0, 50.0, 49.0, 36.0, 60.0, 40.0, 17.0, 10.0, 40.0, 40.0, 40.0, 30.0, 90.0, 40.0, 40.0, 50.0, 30.0, 20.0, 20.0, 60.0, 10.0, 70.0, 10.0, 50.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 35.0, 50.0, 40.0, 39.0, 70.0, 30.0, 60.0, 50.0, 10.0, 40.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 50.0, 50.0, 40.0, 60.0, 10.0, 20.0, 70.0, 60.0, 50.0, 50.0, 70.0, 40.0, 10.0, 70.0, 40.0, 20.0, -1.0, 30.0, 40.0, 30.0, -2.0, 40.0, 40.0, 90.0, 40.0, 40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0, 10.0, 70.0, 9.0, 60.0, 20.0, 60.0, 20.0, 40.0, 0.0, 70.0, 9.0, 10.0, 20.0, 7.0, 10.0, 0.0, 50.0, 30.0, 9.0, 30.0, 30.0, 60.0, 27.0, 50.0, 25.0, 20.0, 30.0, 30.0, 10.0, 70.0, 50.0, 50.0, 60.0, 20.0, -10.0, 30.0, 80.0, 40.0, 60.0, 40.0, 80.0, 100.0, 29.0, 60.0, 30.0, 0.0, 50.0, 30.0, 70.0, 20.0, 0.0, 60.0, 0.0, 0.0, 10.0, 57.0, 88.0, 5.0, 20.0, -55.0, 20.0, 20.0, 0.0, 20.0, 0.0, 9.0, 60.0, 15.0, 20.0, -7.0, 40.0, 40.0, 17.0, -3.0, 30.0, 40.0, 0.0, 10.0, 60.0, 60.0, -4.0, 20.0, 8.0, 5.0, 10.0, 0.0, 30.0, 20.0, 10.0, 20.0, 12.0, 20.0, 20.0, 126.0, 80.0, 40.0, 50.0, 40.0, 60.0, 50.0, 50.0, 40.0, 20.0, 50.0, 90.0, 50.0, 80.0, 50.0, 70.0, 55.0, 40.0, 40.0, 30.0, 60.0, 40.0, 20.0, 40.0, 0.0, 20.0, 40.0, -4.0, 30.0, 10.0, 29.0, 50.0, 0.0, 3.0, 50.0, -2.0, 16.0, 0.0, 20.0, 9.0, 10.0, 30.0, 40.0, 20.0, 50.0, 60.0, 40.0, 40.0, 90.0, 30.0, 20.0, 20.0, -12.0, 50.0, -2.0, 40.0, 20.0, 50.0, 30.0, 60.0, 0.0, 20.0, 20.0, 40.0, 15.0, 60.0, 30.0, 50.0, 40.0, 20.0, 80.0, 5.0, 10.0, 80.0, 0.0, 70.0, 40.0, 10.0, 30.0, 10.0, 40.0, 40.0, 20.0, -1.0, 20.0, 0.0, 40.0, 6.0, 10.0, -35.0, 20.0, 0.0, 40.0, 30.0, 60.0, 30.0, 16.0, 10.0, 50.0, 20.0, 60.0, -5.0, 50.0, 30.0, 80.0, 35.0, 50.0, 30.0, 20.0, 60.0, 50.0, 70.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7603554247362245, "mean_inference_ms": 1.8493635129459765, "mean_action_processing_ms": 0.5867104126131839, "mean_env_wait_ms": 1.6094102278956286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012099027633666992, "StateBufferConnector_ms": 0.009401559829711914, "ViewRequirementAgentConnector_ms": 0.39476537704467773}, "num_episodes": 22, "episode_return_max": 587.0, "episode_return_min": 111.0, "episode_return_mean": 308.01}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.36260749854974, "num_env_steps_trained_throughput_per_sec": 21.36260749854974, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 186581.485, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186581.347, "sample_time_ms": 2648.597, "learn_time_ms": 183911.852, "learn_throughput": 21.75, "synch_weights_time_ms": 10.778}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "a22d3_00000", "date": "2024-08-06_00-54-30", "timestamp": 1722920070, "time_this_iter_s": 187.25328493118286, "time_total_s": 7863.205702781677, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1679790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7863.205702781677, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 21.267924528301887, "ram_util_percent": 78.01509433962264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6089292186073347, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.771717549868412, "policy_loss": -0.010305040460367537, "vf_loss": 4.780526056508033, "vf_explained_var": 0.0006265746772733613, "kl": 0.007482679637261375, "entropy": 0.8711539583211255, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 587.0, "episode_reward_min": 111.0, "episode_reward_mean": 307.62, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 30.762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.0, 410.0, 345.0, 420.0, 180.0, 159.0, 205.0, 241.0, 270.0, 366.0, 297.0, 340.0, 320.0, 413.0, 269.0, 329.0, 311.0, 319.0, 267.0, 210.0, 148.0, 290.0, 164.0, 330.0, 492.0, 340.0, 127.0, 111.0, 401.0, 280.0, 134.0, 203.0, 194.0, 228.0, 325.0, 253.0, 200.0, 271.0, 260.0, 315.0, 318.0, 138.0, 168.0, 587.0, 369.0, 340.0, 370.0, 420.0, 290.0, 314.0, 350.0, 310.0, 480.0, 327.0, 220.0, 359.0, 175.0, 352.0, 420.0, 469.0, 185.0, 157.0, 294.0, 119.0, 498.0, 555.0, 330.0, 182.0, 279.0, 296.0, 325.0, 395.0, 209.0, 177.0, 380.0, 400.0, 426.0, 255.0, 350.0, 380.0, 162.0, 535.0, 405.0, 430.0, 265.0, 144.0, 386.0, 451.0, 293.0, 530.0, 341.0, 275.0, 378.0, 459.0, 193.0, 197.0, 233.0, 432.0, 449.0, 279.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 20.0, 40.0, 40.0, 60.0, 110.0, 30.0, 10.0, 20.0, 30.0, 0.0, 30.0, 18.0, 47.0, 40.0, 24.0, 26.0, 40.0, 40.0, 80.0, 10.0, 60.0, 70.0, 50.0, 20.0, 70.0, 40.0, 70.0, 10.0, 20.0, 30.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 40.0, 20.0, 30.0, 40.0, 7.0, 20.0, -1.0, 19.0, 25.0, -30.0, 29.0, 0.0, 40.0, 0.0, 10.0, -25.0, 10.0, 20.0, 70.0, 40.0, 40.0, 14.0, 20.0, 40.0, 20.0, 20.0, 20.0, 20.0, 27.0, 40.0, 20.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 10.0, 40.0, 40.0, 50.0, 50.0, 40.0, 30.0, 20.0, 16.0, 30.0, 140.0, 0.0, 40.0, 0.0, 60.0, 20.0, 30.0, 29.0, 18.0, 10.0, 60.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 60.0, 30.0, 60.0, 80.0, 50.0, 20.0, 50.0, 0.0, 60.0, 20.0, 40.0, 30.0, 60.0, 10.0, 30.0, 20.0, 60.0, 20.0, 30.0, 20.0, 38.0, 55.0, 60.0, 90.0, 20.0, 10.0, 0.0, 70.0, 20.0, 30.0, 30.0, 30.0, 39.0, 30.0, 10.0, 10.0, 10.0, 60.0, 30.0, 100.0, 30.0, 9.0, 20.0, 30.0, 30.0, 8.0, 20.0, 30.0, 40.0, 80.0, 40.0, 20.0, 20.0, 54.0, -1.0, 30.0, 20.0, 46.0, 9.0, 10.0, 26.0, 28.0, 30.0, 60.0, 60.0, 49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 13.0, 40.0, -13.0, 30.0, 0.0, 20.0, 10.0, 30.0, 8.0, 40.0, 50.0, 40.0, 30.0, 10.0, 30.0, 30.0, 0.0, 30.0, 30.0, 40.0, 20.0, 10.0, 30.0, 20.0, -4.0, 50.0, -27.0, 15.0, 10.0, 60.0, 50.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 40.0, 40.0, 80.0, 67.0, 20.0, 69.0, 46.0, 40.0, 60.0, 30.0, 20.0, 5.0, 50.0, 30.0, 70.0, 15.0, 50.0, 20.0, 20.0, 60.0, 10.0, 11.0, 20.0, 32.0, 40.0, 10.0, -8.0, 0.0, 2.0, 10.0, 18.0, 20.0, 20.0, 0.0, 0.0, 10.0, 41.0, -28.0, 20.0, 10.0, 60.0, 20.0, 50.0, 10.0, 98.0, 20.0, -17.0, 40.0, 80.0, 40.0, 0.0, 30.0, 50.0, 60.0, 20.0, 0.0, 20.0, 20.0, 20.0, 60.0, -3.0, 10.0, 20.0, 9.0, 20.0, 30.0, 9.0, 9.0, 40.0, -10.0, 20.0, 20.0, 19.0, 39.0, 5.0, 10.0, 28.0, 33.0, 10.0, 19.0, 0.0, 40.0, 10.0, 10.0, 15.0, 30.0, 9.0, 0.0, 30.0, 50.0, 30.0, 30.0, 40.0, 10.0, 30.0, -9.0, 60.0, -33.0, 40.0, 30.0, 40.0, 80.0, 10.0, 20.0, 20.0, 20.0, 5.0, 40.0, 20.0, 70.0, 0.0, 30.0, 27.0, 40.0, 50.0, 50.0, -4.0, 10.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0, 50.0, 17.0, 20.0, 29.0, 70.0, 0.0, 19.0, 16.0, 40.0, 10.0, 60.0, 17.0, 20.0, 20.0, 38.0, -15.0, 10.0, 20.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, -45.0, 30.0, 0.0, 30.0, 60.0, 60.0, 20.0, 40.0, 40.0, 40.0, 10.0, 30.0, 38.0, 70.0, 30.0, 0.0, 20.0, 10.0, 18.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 19.0, 20.0, 14.0, 10.0, 30.0, 30.0, -2.0, 8.0, 19.0, 20.0, 104.0, 50.0, 90.0, 60.0, 50.0, 60.0, 53.0, 20.0, 40.0, 60.0, 50.0, 10.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 80.0, 29.0, 30.0, 20.0, 30.0, 40.0, 30.0, 0.0, 90.0, 30.0, 30.0, 40.0, 28.0, 50.0, 49.0, 36.0, 60.0, 40.0, 17.0, 10.0, 40.0, 40.0, 40.0, 30.0, 90.0, 40.0, 40.0, 50.0, 30.0, 20.0, 20.0, 60.0, 10.0, 70.0, 10.0, 50.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 35.0, 50.0, 40.0, 39.0, 70.0, 30.0, 60.0, 50.0, 10.0, 40.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 50.0, 50.0, 40.0, 60.0, 10.0, 20.0, 70.0, 60.0, 50.0, 50.0, 70.0, 40.0, 10.0, 70.0, 40.0, 20.0, -1.0, 30.0, 40.0, 30.0, -2.0, 40.0, 40.0, 90.0, 40.0, 40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0, 10.0, 70.0, 9.0, 60.0, 20.0, 60.0, 20.0, 40.0, 0.0, 70.0, 9.0, 10.0, 20.0, 7.0, 10.0, 0.0, 50.0, 30.0, 9.0, 30.0, 30.0, 60.0, 27.0, 50.0, 25.0, 20.0, 30.0, 30.0, 10.0, 70.0, 50.0, 50.0, 60.0, 20.0, -10.0, 30.0, 80.0, 40.0, 60.0, 40.0, 80.0, 100.0, 29.0, 60.0, 30.0, 0.0, 50.0, 30.0, 70.0, 20.0, 0.0, 60.0, 0.0, 0.0, 10.0, 57.0, 88.0, 5.0, 20.0, -55.0, 20.0, 20.0, 0.0, 20.0, 0.0, 9.0, 60.0, 15.0, 20.0, -7.0, 40.0, 40.0, 17.0, -3.0, 30.0, 40.0, 0.0, 10.0, 60.0, 60.0, -4.0, 20.0, 8.0, 5.0, 10.0, 0.0, 30.0, 20.0, 10.0, 20.0, 12.0, 20.0, 20.0, 126.0, 80.0, 40.0, 50.0, 40.0, 60.0, 50.0, 50.0, 40.0, 20.0, 50.0, 90.0, 50.0, 80.0, 50.0, 70.0, 55.0, 40.0, 40.0, 30.0, 60.0, 40.0, 20.0, 40.0, 0.0, 20.0, 40.0, -4.0, 30.0, 10.0, 29.0, 50.0, 0.0, 3.0, 50.0, -2.0, 16.0, 0.0, 20.0, 9.0, 10.0, 30.0, 40.0, 20.0, 50.0, 60.0, 40.0, 40.0, 90.0, 30.0, 20.0, 20.0, -12.0, 50.0, -2.0, 40.0, 20.0, 50.0, 30.0, 60.0, 0.0, 20.0, 20.0, 40.0, 15.0, 60.0, 30.0, 50.0, 40.0, 20.0, 80.0, 5.0, 10.0, 80.0, 0.0, 70.0, 40.0, 10.0, 30.0, 10.0, 40.0, 40.0, 20.0, -1.0, 20.0, 0.0, 40.0, 6.0, 10.0, -35.0, 20.0, 0.0, 40.0, 30.0, 60.0, 30.0, 16.0, 10.0, 50.0, 20.0, 60.0, -5.0, 50.0, 30.0, 80.0, 35.0, 50.0, 30.0, 20.0, 60.0, 50.0, 70.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0, 40.0, 20.0, 10.0, 68.0, 20.0, 17.0, 10.0, 10.0, 10.0, 50.0, 50.0, 30.0, 20.0, 30.0, 40.0, 30.0, 40.0, 50.0, 60.0, 0.0, 70.0, 30.0, 40.0, 50.0, 60.0, 20.0, 20.0, 40.0, 40.0, 10.0, -18.0, 18.0, -4.0, 20.0, 28.0, 15.0, 20.0, 50.0, 23.0, 10.0, 60.0, 15.0, 50.0, 80.0, 80.0, 30.0, 40.0, 70.0, 60.0, 50.0, 60.0, 10.0, 40.0, 60.0, 90.0, 50.0, 30.0, 20.0, 30.0, 15.0, 40.0, 50.0, 50.0, 70.0, 20.0, 50.0, 40.0, 40.0, 50.0, 20.0, -5.0, 20.0, 40.0, 20.0, 30.0, 10.0, 80.0, 20.0, 40.0, 10.0, 10.0, 20.0, 39.0, 0.0, 10.0, 15.0, 10.0, 10.0, 0.0, 30.0, 50.0, 17.0, 60.0, 3.0, -2.0, 90.0, 20.0, 50.0, 28.0, 70.0, 60.0, 45.0, 100.0, 70.0, 14.0, 40.0, 65.0, 17.0, 40.0, 0.0, 10.0, 80.0, 30.0, 37.0, 20.0, 30.0, 40.0, 30.0, 6.0, 10.0, 30.0, 60.0, 20.0, 50.0, 100.0, 30.0, 50.0, 70.0, 70.0, 50.0, 23.0, 30.0, 40.0, 0.0, 70.0, 0.0, 8.0, 30.0, 110.0, 30.0, 0.0, 30.0, 6.0, 60.0, 60.0, 9.0, 10.0, 30.0, 30.0, 40.0, 20.0, 40.0, 39.0, 40.0, 30.0, 50.0, 80.0, 70.0, -30.0, 39.0, 40.0, 39.0, 40.0, 30.0, 20.0, 60.0, 80.0, 20.0, 40.0, 90.0, 40.0, 10.0, 20.0, 10.0, 30.0, 50.0, -8.0, 30.0, -8.0, 19.0, 50.0, 20.0, 6.0, 25.0, 10.0, -1.0, 10.0, 40.0, 17.0, 20.0, -40.0, 70.0, 60.0, 25.0, 60.0, 20.0, 30.0, 8.0, 0.0, 0.0, -1.0, 0.0, 35.0, 70.0, 24.0, 94.0, 60.0, 50.0, 30.0, 70.0, 80.0, 20.0, 40.0, 30.0, 69.0, 70.0, 60.0, 50.0, 20.0, 10.0, 39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.752675280191504, "mean_inference_ms": 1.839166854306109, "mean_action_processing_ms": 0.5827461104034155, "mean_env_wait_ms": 1.6001982608019194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012709856033325195, "StateBufferConnector_ms": 0.009457111358642578, "ViewRequirementAgentConnector_ms": 0.3975827693939209}, "num_episodes": 23, "episode_return_max": 587.0, "episode_return_min": 111.0, "episode_return_mean": 307.62}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.614177472856166, "num_env_steps_trained_throughput_per_sec": 21.614177472856166, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 185715.33, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185715.192, "sample_time_ms": 2594.681, "learn_time_ms": 183099.561, "learn_throughput": 21.846, "synch_weights_time_ms": 10.79}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "a22d3_00000", "date": "2024-08-06_00-57-36", "timestamp": 1722920256, "time_this_iter_s": 185.07278680801392, "time_total_s": 8048.278489589691, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1679c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8048.278489589691, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 18.122605363984675, "ram_util_percent": 77.15134099616859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6243148063889707, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.153746467657363, "policy_loss": -0.010971299054163594, "vf_loss": 4.162913469054574, "vf_explained_var": 0.0025523253205739145, "kl": 0.009021494865197266, "entropy": 0.9062331300066175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 587.0, "episode_reward_min": 70.0, "episode_reward_mean": 308.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 30.868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [267.0, 210.0, 148.0, 290.0, 164.0, 330.0, 492.0, 340.0, 127.0, 111.0, 401.0, 280.0, 134.0, 203.0, 194.0, 228.0, 325.0, 253.0, 200.0, 271.0, 260.0, 315.0, 318.0, 138.0, 168.0, 587.0, 369.0, 340.0, 370.0, 420.0, 290.0, 314.0, 350.0, 310.0, 480.0, 327.0, 220.0, 359.0, 175.0, 352.0, 420.0, 469.0, 185.0, 157.0, 294.0, 119.0, 498.0, 555.0, 330.0, 182.0, 279.0, 296.0, 325.0, 395.0, 209.0, 177.0, 380.0, 400.0, 426.0, 255.0, 350.0, 380.0, 162.0, 535.0, 405.0, 430.0, 265.0, 144.0, 386.0, 451.0, 293.0, 530.0, 341.0, 275.0, 378.0, 459.0, 193.0, 197.0, 233.0, 432.0, 449.0, 279.0, 361.0, 374.0, 350.0, 342.0, 290.0, 406.0, 70.0, 340.0, 240.0, 328.0, 259.0, 444.0, 416.0, 221.0, 358.0, 319.0, 307.0, 95.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [49.0, 40.0, 30.0, 10.0, 10.0, 0.0, 80.0, 20.0, -2.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 10.0, 13.0, 40.0, -13.0, 30.0, 0.0, 20.0, 10.0, 30.0, 8.0, 40.0, 50.0, 40.0, 30.0, 10.0, 30.0, 30.0, 0.0, 30.0, 30.0, 40.0, 20.0, 10.0, 30.0, 20.0, -4.0, 50.0, -27.0, 15.0, 10.0, 60.0, 50.0, 0.0, 50.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 40.0, 40.0, 80.0, 67.0, 20.0, 69.0, 46.0, 40.0, 60.0, 30.0, 20.0, 5.0, 50.0, 30.0, 70.0, 15.0, 50.0, 20.0, 20.0, 60.0, 10.0, 11.0, 20.0, 32.0, 40.0, 10.0, -8.0, 0.0, 2.0, 10.0, 18.0, 20.0, 20.0, 0.0, 0.0, 10.0, 41.0, -28.0, 20.0, 10.0, 60.0, 20.0, 50.0, 10.0, 98.0, 20.0, -17.0, 40.0, 80.0, 40.0, 0.0, 30.0, 50.0, 60.0, 20.0, 0.0, 20.0, 20.0, 20.0, 60.0, -3.0, 10.0, 20.0, 9.0, 20.0, 30.0, 9.0, 9.0, 40.0, -10.0, 20.0, 20.0, 19.0, 39.0, 5.0, 10.0, 28.0, 33.0, 10.0, 19.0, 0.0, 40.0, 10.0, 10.0, 15.0, 30.0, 9.0, 0.0, 30.0, 50.0, 30.0, 30.0, 40.0, 10.0, 30.0, -9.0, 60.0, -33.0, 40.0, 30.0, 40.0, 80.0, 10.0, 20.0, 20.0, 20.0, 5.0, 40.0, 20.0, 70.0, 0.0, 30.0, 27.0, 40.0, 50.0, 50.0, -4.0, 10.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0, 50.0, 17.0, 20.0, 29.0, 70.0, 0.0, 19.0, 16.0, 40.0, 10.0, 60.0, 17.0, 20.0, 20.0, 38.0, -15.0, 10.0, 20.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, -45.0, 30.0, 0.0, 30.0, 60.0, 60.0, 20.0, 40.0, 40.0, 40.0, 10.0, 30.0, 38.0, 70.0, 30.0, 0.0, 20.0, 10.0, 18.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 19.0, 20.0, 14.0, 10.0, 30.0, 30.0, -2.0, 8.0, 19.0, 20.0, 104.0, 50.0, 90.0, 60.0, 50.0, 60.0, 53.0, 20.0, 40.0, 60.0, 50.0, 10.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 80.0, 29.0, 30.0, 20.0, 30.0, 40.0, 30.0, 0.0, 90.0, 30.0, 30.0, 40.0, 28.0, 50.0, 49.0, 36.0, 60.0, 40.0, 17.0, 10.0, 40.0, 40.0, 40.0, 30.0, 90.0, 40.0, 40.0, 50.0, 30.0, 20.0, 20.0, 60.0, 10.0, 70.0, 10.0, 50.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 35.0, 50.0, 40.0, 39.0, 70.0, 30.0, 60.0, 50.0, 10.0, 40.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 50.0, 50.0, 40.0, 60.0, 10.0, 20.0, 70.0, 60.0, 50.0, 50.0, 70.0, 40.0, 10.0, 70.0, 40.0, 20.0, -1.0, 30.0, 40.0, 30.0, -2.0, 40.0, 40.0, 90.0, 40.0, 40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0, 10.0, 70.0, 9.0, 60.0, 20.0, 60.0, 20.0, 40.0, 0.0, 70.0, 9.0, 10.0, 20.0, 7.0, 10.0, 0.0, 50.0, 30.0, 9.0, 30.0, 30.0, 60.0, 27.0, 50.0, 25.0, 20.0, 30.0, 30.0, 10.0, 70.0, 50.0, 50.0, 60.0, 20.0, -10.0, 30.0, 80.0, 40.0, 60.0, 40.0, 80.0, 100.0, 29.0, 60.0, 30.0, 0.0, 50.0, 30.0, 70.0, 20.0, 0.0, 60.0, 0.0, 0.0, 10.0, 57.0, 88.0, 5.0, 20.0, -55.0, 20.0, 20.0, 0.0, 20.0, 0.0, 9.0, 60.0, 15.0, 20.0, -7.0, 40.0, 40.0, 17.0, -3.0, 30.0, 40.0, 0.0, 10.0, 60.0, 60.0, -4.0, 20.0, 8.0, 5.0, 10.0, 0.0, 30.0, 20.0, 10.0, 20.0, 12.0, 20.0, 20.0, 126.0, 80.0, 40.0, 50.0, 40.0, 60.0, 50.0, 50.0, 40.0, 20.0, 50.0, 90.0, 50.0, 80.0, 50.0, 70.0, 55.0, 40.0, 40.0, 30.0, 60.0, 40.0, 20.0, 40.0, 0.0, 20.0, 40.0, -4.0, 30.0, 10.0, 29.0, 50.0, 0.0, 3.0, 50.0, -2.0, 16.0, 0.0, 20.0, 9.0, 10.0, 30.0, 40.0, 20.0, 50.0, 60.0, 40.0, 40.0, 90.0, 30.0, 20.0, 20.0, -12.0, 50.0, -2.0, 40.0, 20.0, 50.0, 30.0, 60.0, 0.0, 20.0, 20.0, 40.0, 15.0, 60.0, 30.0, 50.0, 40.0, 20.0, 80.0, 5.0, 10.0, 80.0, 0.0, 70.0, 40.0, 10.0, 30.0, 10.0, 40.0, 40.0, 20.0, -1.0, 20.0, 0.0, 40.0, 6.0, 10.0, -35.0, 20.0, 0.0, 40.0, 30.0, 60.0, 30.0, 16.0, 10.0, 50.0, 20.0, 60.0, -5.0, 50.0, 30.0, 80.0, 35.0, 50.0, 30.0, 20.0, 60.0, 50.0, 70.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0, 40.0, 20.0, 10.0, 68.0, 20.0, 17.0, 10.0, 10.0, 10.0, 50.0, 50.0, 30.0, 20.0, 30.0, 40.0, 30.0, 40.0, 50.0, 60.0, 0.0, 70.0, 30.0, 40.0, 50.0, 60.0, 20.0, 20.0, 40.0, 40.0, 10.0, -18.0, 18.0, -4.0, 20.0, 28.0, 15.0, 20.0, 50.0, 23.0, 10.0, 60.0, 15.0, 50.0, 80.0, 80.0, 30.0, 40.0, 70.0, 60.0, 50.0, 60.0, 10.0, 40.0, 60.0, 90.0, 50.0, 30.0, 20.0, 30.0, 15.0, 40.0, 50.0, 50.0, 70.0, 20.0, 50.0, 40.0, 40.0, 50.0, 20.0, -5.0, 20.0, 40.0, 20.0, 30.0, 10.0, 80.0, 20.0, 40.0, 10.0, 10.0, 20.0, 39.0, 0.0, 10.0, 15.0, 10.0, 10.0, 0.0, 30.0, 50.0, 17.0, 60.0, 3.0, -2.0, 90.0, 20.0, 50.0, 28.0, 70.0, 60.0, 45.0, 100.0, 70.0, 14.0, 40.0, 65.0, 17.0, 40.0, 0.0, 10.0, 80.0, 30.0, 37.0, 20.0, 30.0, 40.0, 30.0, 6.0, 10.0, 30.0, 60.0, 20.0, 50.0, 100.0, 30.0, 50.0, 70.0, 70.0, 50.0, 23.0, 30.0, 40.0, 0.0, 70.0, 0.0, 8.0, 30.0, 110.0, 30.0, 0.0, 30.0, 6.0, 60.0, 60.0, 9.0, 10.0, 30.0, 30.0, 40.0, 20.0, 40.0, 39.0, 40.0, 30.0, 50.0, 80.0, 70.0, -30.0, 39.0, 40.0, 39.0, 40.0, 30.0, 20.0, 60.0, 80.0, 20.0, 40.0, 90.0, 40.0, 10.0, 20.0, 10.0, 30.0, 50.0, -8.0, 30.0, -8.0, 19.0, 50.0, 20.0, 6.0, 25.0, 10.0, -1.0, 10.0, 40.0, 17.0, 20.0, -40.0, 70.0, 60.0, 25.0, 60.0, 20.0, 30.0, 8.0, 0.0, 0.0, -1.0, 0.0, 35.0, 70.0, 24.0, 94.0, 60.0, 50.0, 30.0, 70.0, 80.0, 20.0, 40.0, 30.0, 69.0, 70.0, 60.0, 50.0, 20.0, 10.0, 39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 90.0, 36.0, 20.0, -5.0, 50.0, 10.0, 70.0, 20.0, 50.0, 40.0, 10.0, 10.0, 80.0, 50.0, 18.0, 16.0, 30.0, 80.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 80.0, 40.0, 30.0, 15.0, 40.0, 9.0, 50.0, 29.0, 80.0, 20.0, 30.0, 19.0, 50.0, 20.0, 30.0, 20.0, 60.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 60.0, 20.0, 20.0, 50.0, 40.0, -2.0, 30.0, 60.0, 60.0, 68.0, 0.0, 0.0, -4.0, 40.0, 0.0, 4.0, 10.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 50.0, 40.0, 20.0, 40.0, 10.0, 30.0, 60.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 60.0, 0.0, 40.0, 60.0, 30.0, 16.0, 50.0, 40.0, -15.0, 70.0, 30.0, 50.0, -3.0, 16.0, 28.0, 10.0, 30.0, 15.0, 30.0, 30.0, 70.0, 20.0, 10.0, 60.0, 80.0, 50.0, 40.0, 29.0, 40.0, 20.0, 50.0, 25.0, 50.0, 60.0, -2.0, 28.0, 100.0, 30.0, 20.0, 30.0, 40.0, 60.0, 50.0, 15.0, 60.0, 20.0, 0.0, 20.0, 40.0, 10.0, 30.0, -4.0, 30.0, 10.0, 29.0, 60.0, 40.0, 70.0, 30.0, 20.0, 80.0, -1.0, 20.0, 0.0, 0.0, 30.0, 70.0, 30.0, 90.0, 19.0, 10.0, 30.0, 40.0, 50.0, 20.0, 40.0, 10.0, 10.0, 9.0, 28.0, 80.0, 40.0, 20.0, -84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7469944175514633, "mean_inference_ms": 1.8311345535223955, "mean_action_processing_ms": 0.5796688666820953, "mean_env_wait_ms": 1.592994914562881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012610912322998047, "StateBufferConnector_ms": 0.009091854095458984, "ViewRequirementAgentConnector_ms": 0.3916335105895996}, "num_episodes": 18, "episode_return_max": 587.0, "episode_return_min": 70.0, "episode_return_mean": 308.68}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.586471042789697, "num_env_steps_trained_throughput_per_sec": 21.586471042789697, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 185719.444, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185719.307, "sample_time_ms": 2542.941, "learn_time_ms": 183155.051, "learn_throughput": 21.839, "synch_weights_time_ms": 11.042}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "a22d3_00000", "date": "2024-08-06_01-00-41", "timestamp": 1722920441, "time_this_iter_s": 185.31080198287964, "time_total_s": 8233.58929157257, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01cb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8233.58929157257, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 19.384732824427477, "ram_util_percent": 78.06030534351146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6922325256533517, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.153948350125354, "policy_loss": -0.009658783268088255, "vf_loss": 4.162114316967729, "vf_explained_var": 0.010052463536064465, "kl": 0.007464084115061762, "entropy": 0.8903992497311614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 587.0, "episode_reward_min": 70.0, "episode_reward_mean": 320.67, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 32.067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 271.0, 260.0, 315.0, 318.0, 138.0, 168.0, 587.0, 369.0, 340.0, 370.0, 420.0, 290.0, 314.0, 350.0, 310.0, 480.0, 327.0, 220.0, 359.0, 175.0, 352.0, 420.0, 469.0, 185.0, 157.0, 294.0, 119.0, 498.0, 555.0, 330.0, 182.0, 279.0, 296.0, 325.0, 395.0, 209.0, 177.0, 380.0, 400.0, 426.0, 255.0, 350.0, 380.0, 162.0, 535.0, 405.0, 430.0, 265.0, 144.0, 386.0, 451.0, 293.0, 530.0, 341.0, 275.0, 378.0, 459.0, 193.0, 197.0, 233.0, 432.0, 449.0, 279.0, 361.0, 374.0, 350.0, 342.0, 290.0, 406.0, 70.0, 340.0, 240.0, 328.0, 259.0, 444.0, 416.0, 221.0, 358.0, 319.0, 307.0, 95.0, 370.0, 405.0, 332.0, 430.0, 259.0, 342.0, 265.0, 240.0, 158.0, 467.0, 360.0, 331.0, 210.0, 379.0, 288.0, 273.0, 295.0, 292.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 10.0, 30.0, 50.0, 17.0, 20.0, 29.0, 70.0, 0.0, 19.0, 16.0, 40.0, 10.0, 60.0, 17.0, 20.0, 20.0, 38.0, -15.0, 10.0, 20.0, 60.0, 30.0, 130.0, 30.0, 0.0, 20.0, -45.0, 30.0, 0.0, 30.0, 60.0, 60.0, 20.0, 40.0, 40.0, 40.0, 10.0, 30.0, 38.0, 70.0, 30.0, 0.0, 20.0, 10.0, 18.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 19.0, 20.0, 14.0, 10.0, 30.0, 30.0, -2.0, 8.0, 19.0, 20.0, 104.0, 50.0, 90.0, 60.0, 50.0, 60.0, 53.0, 20.0, 40.0, 60.0, 50.0, 10.0, 50.0, 30.0, 30.0, 60.0, 10.0, 20.0, 80.0, 29.0, 30.0, 20.0, 30.0, 40.0, 30.0, 0.0, 90.0, 30.0, 30.0, 40.0, 28.0, 50.0, 49.0, 36.0, 60.0, 40.0, 17.0, 10.0, 40.0, 40.0, 40.0, 30.0, 90.0, 40.0, 40.0, 50.0, 30.0, 20.0, 20.0, 60.0, 10.0, 70.0, 10.0, 50.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 35.0, 50.0, 40.0, 39.0, 70.0, 30.0, 60.0, 50.0, 10.0, 40.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 40.0, 50.0, 50.0, 40.0, 60.0, 10.0, 20.0, 70.0, 60.0, 50.0, 50.0, 70.0, 40.0, 10.0, 70.0, 40.0, 20.0, -1.0, 30.0, 40.0, 30.0, -2.0, 40.0, 40.0, 90.0, 40.0, 40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0, 10.0, 70.0, 9.0, 60.0, 20.0, 60.0, 20.0, 40.0, 0.0, 70.0, 9.0, 10.0, 20.0, 7.0, 10.0, 0.0, 50.0, 30.0, 9.0, 30.0, 30.0, 60.0, 27.0, 50.0, 25.0, 20.0, 30.0, 30.0, 10.0, 70.0, 50.0, 50.0, 60.0, 20.0, -10.0, 30.0, 80.0, 40.0, 60.0, 40.0, 80.0, 100.0, 29.0, 60.0, 30.0, 0.0, 50.0, 30.0, 70.0, 20.0, 0.0, 60.0, 0.0, 0.0, 10.0, 57.0, 88.0, 5.0, 20.0, -55.0, 20.0, 20.0, 0.0, 20.0, 0.0, 9.0, 60.0, 15.0, 20.0, -7.0, 40.0, 40.0, 17.0, -3.0, 30.0, 40.0, 0.0, 10.0, 60.0, 60.0, -4.0, 20.0, 8.0, 5.0, 10.0, 0.0, 30.0, 20.0, 10.0, 20.0, 12.0, 20.0, 20.0, 126.0, 80.0, 40.0, 50.0, 40.0, 60.0, 50.0, 50.0, 40.0, 20.0, 50.0, 90.0, 50.0, 80.0, 50.0, 70.0, 55.0, 40.0, 40.0, 30.0, 60.0, 40.0, 20.0, 40.0, 0.0, 20.0, 40.0, -4.0, 30.0, 10.0, 29.0, 50.0, 0.0, 3.0, 50.0, -2.0, 16.0, 0.0, 20.0, 9.0, 10.0, 30.0, 40.0, 20.0, 50.0, 60.0, 40.0, 40.0, 90.0, 30.0, 20.0, 20.0, -12.0, 50.0, -2.0, 40.0, 20.0, 50.0, 30.0, 60.0, 0.0, 20.0, 20.0, 40.0, 15.0, 60.0, 30.0, 50.0, 40.0, 20.0, 80.0, 5.0, 10.0, 80.0, 0.0, 70.0, 40.0, 10.0, 30.0, 10.0, 40.0, 40.0, 20.0, -1.0, 20.0, 0.0, 40.0, 6.0, 10.0, -35.0, 20.0, 0.0, 40.0, 30.0, 60.0, 30.0, 16.0, 10.0, 50.0, 20.0, 60.0, -5.0, 50.0, 30.0, 80.0, 35.0, 50.0, 30.0, 20.0, 60.0, 50.0, 70.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0, 40.0, 20.0, 10.0, 68.0, 20.0, 17.0, 10.0, 10.0, 10.0, 50.0, 50.0, 30.0, 20.0, 30.0, 40.0, 30.0, 40.0, 50.0, 60.0, 0.0, 70.0, 30.0, 40.0, 50.0, 60.0, 20.0, 20.0, 40.0, 40.0, 10.0, -18.0, 18.0, -4.0, 20.0, 28.0, 15.0, 20.0, 50.0, 23.0, 10.0, 60.0, 15.0, 50.0, 80.0, 80.0, 30.0, 40.0, 70.0, 60.0, 50.0, 60.0, 10.0, 40.0, 60.0, 90.0, 50.0, 30.0, 20.0, 30.0, 15.0, 40.0, 50.0, 50.0, 70.0, 20.0, 50.0, 40.0, 40.0, 50.0, 20.0, -5.0, 20.0, 40.0, 20.0, 30.0, 10.0, 80.0, 20.0, 40.0, 10.0, 10.0, 20.0, 39.0, 0.0, 10.0, 15.0, 10.0, 10.0, 0.0, 30.0, 50.0, 17.0, 60.0, 3.0, -2.0, 90.0, 20.0, 50.0, 28.0, 70.0, 60.0, 45.0, 100.0, 70.0, 14.0, 40.0, 65.0, 17.0, 40.0, 0.0, 10.0, 80.0, 30.0, 37.0, 20.0, 30.0, 40.0, 30.0, 6.0, 10.0, 30.0, 60.0, 20.0, 50.0, 100.0, 30.0, 50.0, 70.0, 70.0, 50.0, 23.0, 30.0, 40.0, 0.0, 70.0, 0.0, 8.0, 30.0, 110.0, 30.0, 0.0, 30.0, 6.0, 60.0, 60.0, 9.0, 10.0, 30.0, 30.0, 40.0, 20.0, 40.0, 39.0, 40.0, 30.0, 50.0, 80.0, 70.0, -30.0, 39.0, 40.0, 39.0, 40.0, 30.0, 20.0, 60.0, 80.0, 20.0, 40.0, 90.0, 40.0, 10.0, 20.0, 10.0, 30.0, 50.0, -8.0, 30.0, -8.0, 19.0, 50.0, 20.0, 6.0, 25.0, 10.0, -1.0, 10.0, 40.0, 17.0, 20.0, -40.0, 70.0, 60.0, 25.0, 60.0, 20.0, 30.0, 8.0, 0.0, 0.0, -1.0, 0.0, 35.0, 70.0, 24.0, 94.0, 60.0, 50.0, 30.0, 70.0, 80.0, 20.0, 40.0, 30.0, 69.0, 70.0, 60.0, 50.0, 20.0, 10.0, 39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 90.0, 36.0, 20.0, -5.0, 50.0, 10.0, 70.0, 20.0, 50.0, 40.0, 10.0, 10.0, 80.0, 50.0, 18.0, 16.0, 30.0, 80.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 80.0, 40.0, 30.0, 15.0, 40.0, 9.0, 50.0, 29.0, 80.0, 20.0, 30.0, 19.0, 50.0, 20.0, 30.0, 20.0, 60.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 60.0, 20.0, 20.0, 50.0, 40.0, -2.0, 30.0, 60.0, 60.0, 68.0, 0.0, 0.0, -4.0, 40.0, 0.0, 4.0, 10.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 50.0, 40.0, 20.0, 40.0, 10.0, 30.0, 60.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 60.0, 0.0, 40.0, 60.0, 30.0, 16.0, 50.0, 40.0, -15.0, 70.0, 30.0, 50.0, -3.0, 16.0, 28.0, 10.0, 30.0, 15.0, 30.0, 30.0, 70.0, 20.0, 10.0, 60.0, 80.0, 50.0, 40.0, 29.0, 40.0, 20.0, 50.0, 25.0, 50.0, 60.0, -2.0, 28.0, 100.0, 30.0, 20.0, 30.0, 40.0, 60.0, 50.0, 15.0, 60.0, 20.0, 0.0, 20.0, 40.0, 10.0, 30.0, -4.0, 30.0, 10.0, 29.0, 60.0, 40.0, 70.0, 30.0, 20.0, 80.0, -1.0, 20.0, 0.0, 0.0, 30.0, 70.0, 30.0, 90.0, 19.0, 10.0, 30.0, 40.0, 50.0, 20.0, 40.0, 10.0, 10.0, 9.0, 28.0, 80.0, 40.0, 20.0, -84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 30.0, 50.0, 70.0, 30.0, 60.0, 90.0, 40.0, 90.0, 40.0, 15.0, 0.0, 30.0, 30.0, 10.0, -2.0, 88.0, 70.0, 78.0, 0.0, 20.0, 18.0, 0.0, 30.0, 30.0, 60.0, 80.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 20.0, 60.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 70.0, 19.0, 10.0, 20.0, 60.0, 50.0, 10.0, 40.0, 20.0, 50.0, 4.0, -2.0, 30.0, 80.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 50.0, 65.0, 36.0, -3.0, 70.0, 8.0, 60.0, 0.0, 5.0, 30.0, 20.0, 14.0, 30.0, 0.0, 19.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 19.0, 60.0, 30.0, 42.0, 40.0, 60.0, 30.0, 30.0, 30.0, 55.0, 90.0, 10.0, 15.0, 70.0, 39.0, 50.0, 50.0, -4.0, 50.0, 50.0, 30.0, 10.0, 10.0, 60.0, 70.0, 10.0, 26.0, 6.0, 70.0, 69.0, 0.0, 0.0, 60.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 30.0, 0.0, 29.0, 30.0, 10.0, 30.0, 70.0, 90.0, 30.0, 60.0, 20.0, 10.0, 8.0, 14.0, 30.0, 30.0, 10.0, 89.0, 40.0, 29.0, 28.0, 10.0, 40.0, 29.0, -25.0, 38.0, 28.0, 18.0, 50.0, 77.0, 18.0, 0.0, 20.0, 8.0, 40.0, 10.0, 40.0, 7.0, 20.0, 40.0, 70.0, 40.0, 16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7416744855903428, "mean_inference_ms": 1.8225142983918665, "mean_action_processing_ms": 0.5765429748866843, "mean_env_wait_ms": 1.585484497410751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012726068496704102, "StateBufferConnector_ms": 0.009181737899780273, "ViewRequirementAgentConnector_ms": 0.3918774127960205}, "num_episodes": 18, "episode_return_max": 587.0, "episode_return_min": 70.0, "episode_return_mean": 320.67}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.65402668982602, "num_env_steps_trained_throughput_per_sec": 21.65402668982602, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 185624.822, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185624.685, "sample_time_ms": 2524.473, "learn_time_ms": 183079.632, "learn_throughput": 21.848, "synch_weights_time_ms": 10.57}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "a22d3_00000", "date": "2024-08-06_01-03-46", "timestamp": 1722920626, "time_this_iter_s": 184.73965787887573, "time_total_s": 8418.328949451447, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2096310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8418.328949451447, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.388505747126434, "ram_util_percent": 77.69157088122604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6940896003391033, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.644915702548651, "policy_loss": -0.010634359595845865, "vf_loss": 4.653889637531691, "vf_explained_var": 0.009938388066296888, "kl": 0.008302121005501222, "entropy": 0.8678117684409007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 70.0, "episode_reward_mean": 327.77, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 32.777}, "custom_metrics": {}, "hist_stats": {"episode_reward": [220.0, 359.0, 175.0, 352.0, 420.0, 469.0, 185.0, 157.0, 294.0, 119.0, 498.0, 555.0, 330.0, 182.0, 279.0, 296.0, 325.0, 395.0, 209.0, 177.0, 380.0, 400.0, 426.0, 255.0, 350.0, 380.0, 162.0, 535.0, 405.0, 430.0, 265.0, 144.0, 386.0, 451.0, 293.0, 530.0, 341.0, 275.0, 378.0, 459.0, 193.0, 197.0, 233.0, 432.0, 449.0, 279.0, 361.0, 374.0, 350.0, 342.0, 290.0, 406.0, 70.0, 340.0, 240.0, 328.0, 259.0, 444.0, 416.0, 221.0, 358.0, 319.0, 307.0, 95.0, 370.0, 405.0, 332.0, 430.0, 259.0, 342.0, 265.0, 240.0, 158.0, 467.0, 360.0, 331.0, 210.0, 379.0, 288.0, 273.0, 295.0, 292.0, 240.0, 551.0, 408.0, 445.0, 350.0, 449.0, 332.0, 258.0, 293.0, 605.0, 379.0, 440.0, 261.0, 370.0, 300.0, 290.0, 159.0, 407.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 30.0, 45.0, 30.0, 20.0, -5.0, 20.0, 20.0, 10.0, 10.0, 70.0, 9.0, 60.0, 20.0, 60.0, 20.0, 40.0, 0.0, 70.0, 9.0, 10.0, 20.0, 7.0, 10.0, 0.0, 50.0, 30.0, 9.0, 30.0, 30.0, 60.0, 27.0, 50.0, 25.0, 20.0, 30.0, 30.0, 10.0, 70.0, 50.0, 50.0, 60.0, 20.0, -10.0, 30.0, 80.0, 40.0, 60.0, 40.0, 80.0, 100.0, 29.0, 60.0, 30.0, 0.0, 50.0, 30.0, 70.0, 20.0, 0.0, 60.0, 0.0, 0.0, 10.0, 57.0, 88.0, 5.0, 20.0, -55.0, 20.0, 20.0, 0.0, 20.0, 0.0, 9.0, 60.0, 15.0, 20.0, -7.0, 40.0, 40.0, 17.0, -3.0, 30.0, 40.0, 0.0, 10.0, 60.0, 60.0, -4.0, 20.0, 8.0, 5.0, 10.0, 0.0, 30.0, 20.0, 10.0, 20.0, 12.0, 20.0, 20.0, 126.0, 80.0, 40.0, 50.0, 40.0, 60.0, 50.0, 50.0, 40.0, 20.0, 50.0, 90.0, 50.0, 80.0, 50.0, 70.0, 55.0, 40.0, 40.0, 30.0, 60.0, 40.0, 20.0, 40.0, 0.0, 20.0, 40.0, -4.0, 30.0, 10.0, 29.0, 50.0, 0.0, 3.0, 50.0, -2.0, 16.0, 0.0, 20.0, 9.0, 10.0, 30.0, 40.0, 20.0, 50.0, 60.0, 40.0, 40.0, 90.0, 30.0, 20.0, 20.0, -12.0, 50.0, -2.0, 40.0, 20.0, 50.0, 30.0, 60.0, 0.0, 20.0, 20.0, 40.0, 15.0, 60.0, 30.0, 50.0, 40.0, 20.0, 80.0, 5.0, 10.0, 80.0, 0.0, 70.0, 40.0, 10.0, 30.0, 10.0, 40.0, 40.0, 20.0, -1.0, 20.0, 0.0, 40.0, 6.0, 10.0, -35.0, 20.0, 0.0, 40.0, 30.0, 60.0, 30.0, 16.0, 10.0, 50.0, 20.0, 60.0, -5.0, 50.0, 30.0, 80.0, 35.0, 50.0, 30.0, 20.0, 60.0, 50.0, 70.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0, 40.0, 20.0, 10.0, 68.0, 20.0, 17.0, 10.0, 10.0, 10.0, 50.0, 50.0, 30.0, 20.0, 30.0, 40.0, 30.0, 40.0, 50.0, 60.0, 0.0, 70.0, 30.0, 40.0, 50.0, 60.0, 20.0, 20.0, 40.0, 40.0, 10.0, -18.0, 18.0, -4.0, 20.0, 28.0, 15.0, 20.0, 50.0, 23.0, 10.0, 60.0, 15.0, 50.0, 80.0, 80.0, 30.0, 40.0, 70.0, 60.0, 50.0, 60.0, 10.0, 40.0, 60.0, 90.0, 50.0, 30.0, 20.0, 30.0, 15.0, 40.0, 50.0, 50.0, 70.0, 20.0, 50.0, 40.0, 40.0, 50.0, 20.0, -5.0, 20.0, 40.0, 20.0, 30.0, 10.0, 80.0, 20.0, 40.0, 10.0, 10.0, 20.0, 39.0, 0.0, 10.0, 15.0, 10.0, 10.0, 0.0, 30.0, 50.0, 17.0, 60.0, 3.0, -2.0, 90.0, 20.0, 50.0, 28.0, 70.0, 60.0, 45.0, 100.0, 70.0, 14.0, 40.0, 65.0, 17.0, 40.0, 0.0, 10.0, 80.0, 30.0, 37.0, 20.0, 30.0, 40.0, 30.0, 6.0, 10.0, 30.0, 60.0, 20.0, 50.0, 100.0, 30.0, 50.0, 70.0, 70.0, 50.0, 23.0, 30.0, 40.0, 0.0, 70.0, 0.0, 8.0, 30.0, 110.0, 30.0, 0.0, 30.0, 6.0, 60.0, 60.0, 9.0, 10.0, 30.0, 30.0, 40.0, 20.0, 40.0, 39.0, 40.0, 30.0, 50.0, 80.0, 70.0, -30.0, 39.0, 40.0, 39.0, 40.0, 30.0, 20.0, 60.0, 80.0, 20.0, 40.0, 90.0, 40.0, 10.0, 20.0, 10.0, 30.0, 50.0, -8.0, 30.0, -8.0, 19.0, 50.0, 20.0, 6.0, 25.0, 10.0, -1.0, 10.0, 40.0, 17.0, 20.0, -40.0, 70.0, 60.0, 25.0, 60.0, 20.0, 30.0, 8.0, 0.0, 0.0, -1.0, 0.0, 35.0, 70.0, 24.0, 94.0, 60.0, 50.0, 30.0, 70.0, 80.0, 20.0, 40.0, 30.0, 69.0, 70.0, 60.0, 50.0, 20.0, 10.0, 39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 90.0, 36.0, 20.0, -5.0, 50.0, 10.0, 70.0, 20.0, 50.0, 40.0, 10.0, 10.0, 80.0, 50.0, 18.0, 16.0, 30.0, 80.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 80.0, 40.0, 30.0, 15.0, 40.0, 9.0, 50.0, 29.0, 80.0, 20.0, 30.0, 19.0, 50.0, 20.0, 30.0, 20.0, 60.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 60.0, 20.0, 20.0, 50.0, 40.0, -2.0, 30.0, 60.0, 60.0, 68.0, 0.0, 0.0, -4.0, 40.0, 0.0, 4.0, 10.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 50.0, 40.0, 20.0, 40.0, 10.0, 30.0, 60.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 60.0, 0.0, 40.0, 60.0, 30.0, 16.0, 50.0, 40.0, -15.0, 70.0, 30.0, 50.0, -3.0, 16.0, 28.0, 10.0, 30.0, 15.0, 30.0, 30.0, 70.0, 20.0, 10.0, 60.0, 80.0, 50.0, 40.0, 29.0, 40.0, 20.0, 50.0, 25.0, 50.0, 60.0, -2.0, 28.0, 100.0, 30.0, 20.0, 30.0, 40.0, 60.0, 50.0, 15.0, 60.0, 20.0, 0.0, 20.0, 40.0, 10.0, 30.0, -4.0, 30.0, 10.0, 29.0, 60.0, 40.0, 70.0, 30.0, 20.0, 80.0, -1.0, 20.0, 0.0, 0.0, 30.0, 70.0, 30.0, 90.0, 19.0, 10.0, 30.0, 40.0, 50.0, 20.0, 40.0, 10.0, 10.0, 9.0, 28.0, 80.0, 40.0, 20.0, -84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 30.0, 50.0, 70.0, 30.0, 60.0, 90.0, 40.0, 90.0, 40.0, 15.0, 0.0, 30.0, 30.0, 10.0, -2.0, 88.0, 70.0, 78.0, 0.0, 20.0, 18.0, 0.0, 30.0, 30.0, 60.0, 80.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 20.0, 60.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 70.0, 19.0, 10.0, 20.0, 60.0, 50.0, 10.0, 40.0, 20.0, 50.0, 4.0, -2.0, 30.0, 80.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 50.0, 65.0, 36.0, -3.0, 70.0, 8.0, 60.0, 0.0, 5.0, 30.0, 20.0, 14.0, 30.0, 0.0, 19.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 19.0, 60.0, 30.0, 42.0, 40.0, 60.0, 30.0, 30.0, 30.0, 55.0, 90.0, 10.0, 15.0, 70.0, 39.0, 50.0, 50.0, -4.0, 50.0, 50.0, 30.0, 10.0, 10.0, 60.0, 70.0, 10.0, 26.0, 6.0, 70.0, 69.0, 0.0, 0.0, 60.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 30.0, 0.0, 29.0, 30.0, 10.0, 30.0, 70.0, 90.0, 30.0, 60.0, 20.0, 10.0, 8.0, 14.0, 30.0, 30.0, 10.0, 89.0, 40.0, 29.0, 28.0, 10.0, 40.0, 29.0, -25.0, 38.0, 28.0, 18.0, 50.0, 77.0, 18.0, 0.0, 20.0, 8.0, 40.0, 10.0, 40.0, 7.0, 20.0, 40.0, 70.0, 40.0, 16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 0.0, -2.0, 50.0, 160.0, 10.0, 60.0, 40.0, 46.0, 47.0, 60.0, 80.0, 4.0, -10.0, 5.0, 66.0, 50.0, 102.0, 41.0, 80.0, 60.0, 10.0, 30.0, -25.0, 60.0, 50.0, 60.0, 50.0, 60.0, 100.0, 40.0, 20.0, 20.0, 50.0, 10.0, 50.0, 40.0, 30.0, 30.0, 40.0, 60.0, 20.0, 50.0, 60.0, 55.0, 17.0, 60.0, 60.0, 18.0, 40.0, 50.0, 39.0, 30.0, 23.0, 14.0, 70.0, 60.0, 30.0, 30.0, 50.0, 5.0, 20.0, 20.0, 28.0, 30.0, 30.0, 0.0, 10.0, 90.0, 20.0, 0.0, 30.0, 40.0, 40.0, 10.0, 30.0, 20.0, 40.0, 27.0, 46.0, 10.0, 30.0, 100.0, 39.0, 6.0, 20.0, 30.0, 80.0, 90.0, 40.0, 130.0, 70.0, 70.0, 50.0, 50.0, -3.0, 70.0, 15.0, 30.0, 21.0, 17.0, 59.0, 30.0, 60.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 80.0, 40.0, 86.0, 10.0, -3.0, -12.0, 20.0, 50.0, 10.0, 10.0, 40.0, 50.0, 30.0, 25.0, 50.0, 90.0, 25.0, 15.0, 45.0, 40.0, 20.0, 30.0, 50.0, 20.0, 10.0, -10.0, 50.0, 60.0, 20.0, 10.0, 50.0, 40.0, 0.0, 50.0, 10.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 19.0, 20.0, 0.0, 40.0, 20.0, 40.0, 3.0, 14.0, 50.0, 40.0, 90.0, 60.0, 40.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.73669695681975, "mean_inference_ms": 1.8142300244760716, "mean_action_processing_ms": 0.573601424969981, "mean_env_wait_ms": 1.5783343212730596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012735366821289062, "StateBufferConnector_ms": 0.009213685989379883, "ViewRequirementAgentConnector_ms": 0.3981485366821289}, "num_episodes": 18, "episode_return_max": 605.0, "episode_return_min": 70.0, "episode_return_mean": 327.77}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.725255413884796, "num_env_steps_trained_throughput_per_sec": 21.725255413884796, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 185420.748, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185420.61, "sample_time_ms": 2515.906, "learn_time_ms": 182884.001, "learn_throughput": 21.872, "synch_weights_time_ms": 10.637}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "a22d3_00000", "date": "2024-08-06_01-06-50", "timestamp": 1722920810, "time_this_iter_s": 184.12765073776245, "time_total_s": 8602.456600189209, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a0a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8602.456600189209, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.09655172413793, "ram_util_percent": 78.15785440613027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.749976484615582, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.522569264542942, "policy_loss": -0.01031985251209178, "vf_loss": 4.531260355161275, "vf_explained_var": 0.010720502536771651, "kl": 0.0081437987814904, "entropy": 0.844802267895466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 70.0, "episode_reward_mean": 339.66, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 33.966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [426.0, 255.0, 350.0, 380.0, 162.0, 535.0, 405.0, 430.0, 265.0, 144.0, 386.0, 451.0, 293.0, 530.0, 341.0, 275.0, 378.0, 459.0, 193.0, 197.0, 233.0, 432.0, 449.0, 279.0, 361.0, 374.0, 350.0, 342.0, 290.0, 406.0, 70.0, 340.0, 240.0, 328.0, 259.0, 444.0, 416.0, 221.0, 358.0, 319.0, 307.0, 95.0, 370.0, 405.0, 332.0, 430.0, 259.0, 342.0, 265.0, 240.0, 158.0, 467.0, 360.0, 331.0, 210.0, 379.0, 288.0, 273.0, 295.0, 292.0, 240.0, 551.0, 408.0, 445.0, 350.0, 449.0, 332.0, 258.0, 293.0, 605.0, 379.0, 440.0, 261.0, 370.0, 300.0, 290.0, 159.0, 407.0, 428.0, 306.0, 332.0, 306.0, 565.0, 375.0, 395.0, 338.0, 268.0, 295.0, 370.0, 407.0, 208.0, 245.0, 350.0, 340.0, 382.0, 390.0, 390.0, 369.0, 366.0, 540.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 10.0, 50.0, 50.0, 60.0, 38.0, 90.0, 8.0, 60.0, 40.0, 20.0, 10.0, 68.0, 20.0, 17.0, 10.0, 10.0, 10.0, 50.0, 50.0, 30.0, 20.0, 30.0, 40.0, 30.0, 40.0, 50.0, 60.0, 0.0, 70.0, 30.0, 40.0, 50.0, 60.0, 20.0, 20.0, 40.0, 40.0, 10.0, -18.0, 18.0, -4.0, 20.0, 28.0, 15.0, 20.0, 50.0, 23.0, 10.0, 60.0, 15.0, 50.0, 80.0, 80.0, 30.0, 40.0, 70.0, 60.0, 50.0, 60.0, 10.0, 40.0, 60.0, 90.0, 50.0, 30.0, 20.0, 30.0, 15.0, 40.0, 50.0, 50.0, 70.0, 20.0, 50.0, 40.0, 40.0, 50.0, 20.0, -5.0, 20.0, 40.0, 20.0, 30.0, 10.0, 80.0, 20.0, 40.0, 10.0, 10.0, 20.0, 39.0, 0.0, 10.0, 15.0, 10.0, 10.0, 0.0, 30.0, 50.0, 17.0, 60.0, 3.0, -2.0, 90.0, 20.0, 50.0, 28.0, 70.0, 60.0, 45.0, 100.0, 70.0, 14.0, 40.0, 65.0, 17.0, 40.0, 0.0, 10.0, 80.0, 30.0, 37.0, 20.0, 30.0, 40.0, 30.0, 6.0, 10.0, 30.0, 60.0, 20.0, 50.0, 100.0, 30.0, 50.0, 70.0, 70.0, 50.0, 23.0, 30.0, 40.0, 0.0, 70.0, 0.0, 8.0, 30.0, 110.0, 30.0, 0.0, 30.0, 6.0, 60.0, 60.0, 9.0, 10.0, 30.0, 30.0, 40.0, 20.0, 40.0, 39.0, 40.0, 30.0, 50.0, 80.0, 70.0, -30.0, 39.0, 40.0, 39.0, 40.0, 30.0, 20.0, 60.0, 80.0, 20.0, 40.0, 90.0, 40.0, 10.0, 20.0, 10.0, 30.0, 50.0, -8.0, 30.0, -8.0, 19.0, 50.0, 20.0, 6.0, 25.0, 10.0, -1.0, 10.0, 40.0, 17.0, 20.0, -40.0, 70.0, 60.0, 25.0, 60.0, 20.0, 30.0, 8.0, 0.0, 0.0, -1.0, 0.0, 35.0, 70.0, 24.0, 94.0, 60.0, 50.0, 30.0, 70.0, 80.0, 20.0, 40.0, 30.0, 69.0, 70.0, 60.0, 50.0, 20.0, 10.0, 39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 90.0, 36.0, 20.0, -5.0, 50.0, 10.0, 70.0, 20.0, 50.0, 40.0, 10.0, 10.0, 80.0, 50.0, 18.0, 16.0, 30.0, 80.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 80.0, 40.0, 30.0, 15.0, 40.0, 9.0, 50.0, 29.0, 80.0, 20.0, 30.0, 19.0, 50.0, 20.0, 30.0, 20.0, 60.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 60.0, 20.0, 20.0, 50.0, 40.0, -2.0, 30.0, 60.0, 60.0, 68.0, 0.0, 0.0, -4.0, 40.0, 0.0, 4.0, 10.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 50.0, 40.0, 20.0, 40.0, 10.0, 30.0, 60.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 60.0, 0.0, 40.0, 60.0, 30.0, 16.0, 50.0, 40.0, -15.0, 70.0, 30.0, 50.0, -3.0, 16.0, 28.0, 10.0, 30.0, 15.0, 30.0, 30.0, 70.0, 20.0, 10.0, 60.0, 80.0, 50.0, 40.0, 29.0, 40.0, 20.0, 50.0, 25.0, 50.0, 60.0, -2.0, 28.0, 100.0, 30.0, 20.0, 30.0, 40.0, 60.0, 50.0, 15.0, 60.0, 20.0, 0.0, 20.0, 40.0, 10.0, 30.0, -4.0, 30.0, 10.0, 29.0, 60.0, 40.0, 70.0, 30.0, 20.0, 80.0, -1.0, 20.0, 0.0, 0.0, 30.0, 70.0, 30.0, 90.0, 19.0, 10.0, 30.0, 40.0, 50.0, 20.0, 40.0, 10.0, 10.0, 9.0, 28.0, 80.0, 40.0, 20.0, -84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 30.0, 50.0, 70.0, 30.0, 60.0, 90.0, 40.0, 90.0, 40.0, 15.0, 0.0, 30.0, 30.0, 10.0, -2.0, 88.0, 70.0, 78.0, 0.0, 20.0, 18.0, 0.0, 30.0, 30.0, 60.0, 80.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 20.0, 60.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 70.0, 19.0, 10.0, 20.0, 60.0, 50.0, 10.0, 40.0, 20.0, 50.0, 4.0, -2.0, 30.0, 80.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 50.0, 65.0, 36.0, -3.0, 70.0, 8.0, 60.0, 0.0, 5.0, 30.0, 20.0, 14.0, 30.0, 0.0, 19.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 19.0, 60.0, 30.0, 42.0, 40.0, 60.0, 30.0, 30.0, 30.0, 55.0, 90.0, 10.0, 15.0, 70.0, 39.0, 50.0, 50.0, -4.0, 50.0, 50.0, 30.0, 10.0, 10.0, 60.0, 70.0, 10.0, 26.0, 6.0, 70.0, 69.0, 0.0, 0.0, 60.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 30.0, 0.0, 29.0, 30.0, 10.0, 30.0, 70.0, 90.0, 30.0, 60.0, 20.0, 10.0, 8.0, 14.0, 30.0, 30.0, 10.0, 89.0, 40.0, 29.0, 28.0, 10.0, 40.0, 29.0, -25.0, 38.0, 28.0, 18.0, 50.0, 77.0, 18.0, 0.0, 20.0, 8.0, 40.0, 10.0, 40.0, 7.0, 20.0, 40.0, 70.0, 40.0, 16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 0.0, -2.0, 50.0, 160.0, 10.0, 60.0, 40.0, 46.0, 47.0, 60.0, 80.0, 4.0, -10.0, 5.0, 66.0, 50.0, 102.0, 41.0, 80.0, 60.0, 10.0, 30.0, -25.0, 60.0, 50.0, 60.0, 50.0, 60.0, 100.0, 40.0, 20.0, 20.0, 50.0, 10.0, 50.0, 40.0, 30.0, 30.0, 40.0, 60.0, 20.0, 50.0, 60.0, 55.0, 17.0, 60.0, 60.0, 18.0, 40.0, 50.0, 39.0, 30.0, 23.0, 14.0, 70.0, 60.0, 30.0, 30.0, 50.0, 5.0, 20.0, 20.0, 28.0, 30.0, 30.0, 0.0, 10.0, 90.0, 20.0, 0.0, 30.0, 40.0, 40.0, 10.0, 30.0, 20.0, 40.0, 27.0, 46.0, 10.0, 30.0, 100.0, 39.0, 6.0, 20.0, 30.0, 80.0, 90.0, 40.0, 130.0, 70.0, 70.0, 50.0, 50.0, -3.0, 70.0, 15.0, 30.0, 21.0, 17.0, 59.0, 30.0, 60.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 80.0, 40.0, 86.0, 10.0, -3.0, -12.0, 20.0, 50.0, 10.0, 10.0, 40.0, 50.0, 30.0, 25.0, 50.0, 90.0, 25.0, 15.0, 45.0, 40.0, 20.0, 30.0, 50.0, 20.0, 10.0, -10.0, 50.0, 60.0, 20.0, 10.0, 50.0, 40.0, 0.0, 50.0, 10.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 19.0, 20.0, 0.0, 40.0, 20.0, 40.0, 3.0, 14.0, 50.0, 40.0, 90.0, 60.0, 40.0, 10.0, 60.0, 50.0, 10.0, 110.0, 20.0, 60.0, 20.0, 40.0, 70.0, 30.0, 18.0, 16.0, 10.0, 60.0, 0.0, 60.0, 15.0, 50.0, 55.0, 30.0, 10.0, 0.0, 60.0, 7.0, 80.0, 50.0, 50.0, 10.0, 29.0, 16.0, 30.0, 80.0, 10.0, 28.0, 8.0, 60.0, 10.0, 20.0, 40.0, 30.0, 20.0, 40.0, 60.0, 50.0, 72.0, 34.0, 10.0, 100.0, 60.0, 59.0, 80.0, 40.0, 15.0, 40.0, 60.0, 60.0, 40.0, 10.0, 20.0, 10.0, 80.0, 70.0, 30.0, 40.0, 20.0, 70.0, 50.0, 20.0, 15.0, 20.0, 60.0, 40.0, 0.0, 88.0, 60.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 3.0, 20.0, 16.0, 6.0, 13.0, 60.0, 30.0, 50.0, 10.0, 60.0, 26.0, 4.0, 17.0, 20.0, 50.0, 30.0, 30.0, 28.0, 20.0, 70.0, 50.0, 50.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 90.0, 70.0, 80.0, 0.0, 70.0, 30.0, 8.0, 30.0, 39.0, 30.0, 50.0, 30.0, 44.0, 30.0, -6.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 15.0, 50.0, 18.0, 26.0, 6.0, 60.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 0.0, 70.0, 80.0, 40.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 50.0, 30.0, 40.0, 50.0, 60.0, 40.0, 60.0, 6.0, 20.0, 40.0, 36.0, 20.0, 20.0, 10.0, 20.0, 80.0, 70.0, 50.0, 40.0, 20.0, 60.0, 20.0, 90.0, 40.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 80.0, 29.0, 40.0, 40.0, 40.0, 50.0, 50.0, 50.0, 50.0, -12.0, 25.0, 13.0, 60.0, 10.0, 50.0, 50.0, 70.0, 70.0, 20.0, 60.0, 110.0, 60.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7294557864402993, "mean_inference_ms": 1.8020355300356865, "mean_action_processing_ms": 0.5694905399664887, "mean_env_wait_ms": 1.5681029992460673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012923955917358398, "StateBufferConnector_ms": 0.00934600830078125, "ViewRequirementAgentConnector_ms": 0.3706514835357666}, "num_episodes": 22, "episode_return_max": 605.0, "episode_return_min": 70.0, "episode_return_mean": 339.66}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.721797258071742, "num_env_steps_trained_throughput_per_sec": 21.721797258071742, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 185363.026, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185362.888, "sample_time_ms": 2516.326, "learn_time_ms": 182825.68, "learn_throughput": 21.879, "synch_weights_time_ms": 10.645}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "a22d3_00000", "date": "2024-08-06_01-09-54", "timestamp": 1722920994, "time_this_iter_s": 184.1565260887146, "time_total_s": 8786.613126277924, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8786.613126277924, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.12923076923077, "ram_util_percent": 78.37884615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.897972836027257, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.729478657664583, "policy_loss": -0.010802603711565526, "vf_loss": 4.738739048050869, "vf_explained_var": 0.006088727966538126, "kl": 0.007711075871718944, "entropy": 0.8239727441749126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 70.0, "episode_reward_mean": 342.86, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 34.286}, "custom_metrics": {}, "hist_stats": {"episode_reward": [279.0, 361.0, 374.0, 350.0, 342.0, 290.0, 406.0, 70.0, 340.0, 240.0, 328.0, 259.0, 444.0, 416.0, 221.0, 358.0, 319.0, 307.0, 95.0, 370.0, 405.0, 332.0, 430.0, 259.0, 342.0, 265.0, 240.0, 158.0, 467.0, 360.0, 331.0, 210.0, 379.0, 288.0, 273.0, 295.0, 292.0, 240.0, 551.0, 408.0, 445.0, 350.0, 449.0, 332.0, 258.0, 293.0, 605.0, 379.0, 440.0, 261.0, 370.0, 300.0, 290.0, 159.0, 407.0, 428.0, 306.0, 332.0, 306.0, 565.0, 375.0, 395.0, 338.0, 268.0, 295.0, 370.0, 407.0, 208.0, 245.0, 350.0, 340.0, 382.0, 390.0, 390.0, 369.0, 366.0, 540.0, 328.0, 390.0, 353.0, 372.0, 137.0, 362.0, 290.0, 330.0, 275.0, 340.0, 480.0, 409.0, 350.0, 402.0, 509.0, 440.0, 408.0, 320.0, 317.0, 295.0, 550.0, 339.0, 293.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [39.0, 40.0, 10.0, 10.0, 30.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 90.0, 36.0, 20.0, -5.0, 50.0, 10.0, 70.0, 20.0, 50.0, 40.0, 10.0, 10.0, 80.0, 50.0, 18.0, 16.0, 30.0, 80.0, 40.0, 30.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 80.0, 40.0, 30.0, 15.0, 40.0, 9.0, 50.0, 29.0, 80.0, 20.0, 30.0, 19.0, 50.0, 20.0, 30.0, 20.0, 60.0, 10.0, 20.0, 20.0, 70.0, 20.0, 20.0, 60.0, 20.0, 20.0, 50.0, 40.0, -2.0, 30.0, 60.0, 60.0, 68.0, 0.0, 0.0, -4.0, 40.0, 0.0, 4.0, 10.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 50.0, 40.0, 20.0, 40.0, 10.0, 30.0, 60.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 60.0, 0.0, 40.0, 60.0, 30.0, 16.0, 50.0, 40.0, -15.0, 70.0, 30.0, 50.0, -3.0, 16.0, 28.0, 10.0, 30.0, 15.0, 30.0, 30.0, 70.0, 20.0, 10.0, 60.0, 80.0, 50.0, 40.0, 29.0, 40.0, 20.0, 50.0, 25.0, 50.0, 60.0, -2.0, 28.0, 100.0, 30.0, 20.0, 30.0, 40.0, 60.0, 50.0, 15.0, 60.0, 20.0, 0.0, 20.0, 40.0, 10.0, 30.0, -4.0, 30.0, 10.0, 29.0, 60.0, 40.0, 70.0, 30.0, 20.0, 80.0, -1.0, 20.0, 0.0, 0.0, 30.0, 70.0, 30.0, 90.0, 19.0, 10.0, 30.0, 40.0, 50.0, 20.0, 40.0, 10.0, 10.0, 9.0, 28.0, 80.0, 40.0, 20.0, -84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 30.0, 50.0, 70.0, 30.0, 60.0, 90.0, 40.0, 90.0, 40.0, 15.0, 0.0, 30.0, 30.0, 10.0, -2.0, 88.0, 70.0, 78.0, 0.0, 20.0, 18.0, 0.0, 30.0, 30.0, 60.0, 80.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 20.0, 60.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 70.0, 19.0, 10.0, 20.0, 60.0, 50.0, 10.0, 40.0, 20.0, 50.0, 4.0, -2.0, 30.0, 80.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 50.0, 65.0, 36.0, -3.0, 70.0, 8.0, 60.0, 0.0, 5.0, 30.0, 20.0, 14.0, 30.0, 0.0, 19.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 19.0, 60.0, 30.0, 42.0, 40.0, 60.0, 30.0, 30.0, 30.0, 55.0, 90.0, 10.0, 15.0, 70.0, 39.0, 50.0, 50.0, -4.0, 50.0, 50.0, 30.0, 10.0, 10.0, 60.0, 70.0, 10.0, 26.0, 6.0, 70.0, 69.0, 0.0, 0.0, 60.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 30.0, 0.0, 29.0, 30.0, 10.0, 30.0, 70.0, 90.0, 30.0, 60.0, 20.0, 10.0, 8.0, 14.0, 30.0, 30.0, 10.0, 89.0, 40.0, 29.0, 28.0, 10.0, 40.0, 29.0, -25.0, 38.0, 28.0, 18.0, 50.0, 77.0, 18.0, 0.0, 20.0, 8.0, 40.0, 10.0, 40.0, 7.0, 20.0, 40.0, 70.0, 40.0, 16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 0.0, -2.0, 50.0, 160.0, 10.0, 60.0, 40.0, 46.0, 47.0, 60.0, 80.0, 4.0, -10.0, 5.0, 66.0, 50.0, 102.0, 41.0, 80.0, 60.0, 10.0, 30.0, -25.0, 60.0, 50.0, 60.0, 50.0, 60.0, 100.0, 40.0, 20.0, 20.0, 50.0, 10.0, 50.0, 40.0, 30.0, 30.0, 40.0, 60.0, 20.0, 50.0, 60.0, 55.0, 17.0, 60.0, 60.0, 18.0, 40.0, 50.0, 39.0, 30.0, 23.0, 14.0, 70.0, 60.0, 30.0, 30.0, 50.0, 5.0, 20.0, 20.0, 28.0, 30.0, 30.0, 0.0, 10.0, 90.0, 20.0, 0.0, 30.0, 40.0, 40.0, 10.0, 30.0, 20.0, 40.0, 27.0, 46.0, 10.0, 30.0, 100.0, 39.0, 6.0, 20.0, 30.0, 80.0, 90.0, 40.0, 130.0, 70.0, 70.0, 50.0, 50.0, -3.0, 70.0, 15.0, 30.0, 21.0, 17.0, 59.0, 30.0, 60.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 80.0, 40.0, 86.0, 10.0, -3.0, -12.0, 20.0, 50.0, 10.0, 10.0, 40.0, 50.0, 30.0, 25.0, 50.0, 90.0, 25.0, 15.0, 45.0, 40.0, 20.0, 30.0, 50.0, 20.0, 10.0, -10.0, 50.0, 60.0, 20.0, 10.0, 50.0, 40.0, 0.0, 50.0, 10.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 19.0, 20.0, 0.0, 40.0, 20.0, 40.0, 3.0, 14.0, 50.0, 40.0, 90.0, 60.0, 40.0, 10.0, 60.0, 50.0, 10.0, 110.0, 20.0, 60.0, 20.0, 40.0, 70.0, 30.0, 18.0, 16.0, 10.0, 60.0, 0.0, 60.0, 15.0, 50.0, 55.0, 30.0, 10.0, 0.0, 60.0, 7.0, 80.0, 50.0, 50.0, 10.0, 29.0, 16.0, 30.0, 80.0, 10.0, 28.0, 8.0, 60.0, 10.0, 20.0, 40.0, 30.0, 20.0, 40.0, 60.0, 50.0, 72.0, 34.0, 10.0, 100.0, 60.0, 59.0, 80.0, 40.0, 15.0, 40.0, 60.0, 60.0, 40.0, 10.0, 20.0, 10.0, 80.0, 70.0, 30.0, 40.0, 20.0, 70.0, 50.0, 20.0, 15.0, 20.0, 60.0, 40.0, 0.0, 88.0, 60.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 3.0, 20.0, 16.0, 6.0, 13.0, 60.0, 30.0, 50.0, 10.0, 60.0, 26.0, 4.0, 17.0, 20.0, 50.0, 30.0, 30.0, 28.0, 20.0, 70.0, 50.0, 50.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 90.0, 70.0, 80.0, 0.0, 70.0, 30.0, 8.0, 30.0, 39.0, 30.0, 50.0, 30.0, 44.0, 30.0, -6.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 15.0, 50.0, 18.0, 26.0, 6.0, 60.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 0.0, 70.0, 80.0, 40.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 50.0, 30.0, 40.0, 50.0, 60.0, 40.0, 60.0, 6.0, 20.0, 40.0, 36.0, 20.0, 20.0, 10.0, 20.0, 80.0, 70.0, 50.0, 40.0, 20.0, 60.0, 20.0, 90.0, 40.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 80.0, 29.0, 40.0, 40.0, 40.0, 50.0, 50.0, 50.0, 50.0, -12.0, 25.0, 13.0, 60.0, 10.0, 50.0, 50.0, 70.0, 70.0, 20.0, 60.0, 110.0, 60.0, 40.0, 40.0, 50.0, 20.0, 50.0, 50.0, 20.0, 22.0, 20.0, 40.0, 16.0, 50.0, 40.0, 50.0, 10.0, 100.0, 10.0, 30.0, 30.0, 0.0, 70.0, 20.0, 80.0, 50.0, 16.0, 30.0, 20.0, 20.0, 30.0, 37.0, 50.0, 7.0, 20.0, 15.0, 50.0, 70.0, 100.0, 70.0, 50.0, -30.0, 20.0, 20.0, 30.0, 10.0, 14.0, 10.0, 7.0, 20.0, 18.0, -6.0, 14.0, 10.0, 10.0, 14.0, 10.0, 100.0, 60.0, 18.0, 60.0, 80.0, 0.0, 40.0, 0.0, 20.0, 30.0, 40.0, 40.0, 50.0, 39.0, 11.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 0.0, 80.0, 70.0, 60.0, 20.0, 10.0, -3.0, 18.0, 100.0, 20.0, 10.0, 20.0, 20.0, 30.0, 50.0, 0.0, 50.0, 80.0, 30.0, 10.0, 20.0, 60.0, 20.0, 40.0, 30.0, 60.0, 40.0, 20.0, 30.0, 40.0, 50.0, 50.0, 90.0, 50.0, 50.0, 10.0, 40.0, 60.0, 30.0, 60.0, 29.0, 70.0, 30.0, 60.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 35.0, 20.0, 50.0, 29.0, 70.0, 80.0, 40.0, -2.0, 30.0, 50.0, 50.0, 90.0, 23.0, 60.0, 16.0, 50.0, 90.0, 40.0, 60.0, 30.0, 80.0, 30.0, 20.0, 60.0, 60.0, 30.0, 20.0, 50.0, 40.0, 50.0, 20.0, 8.0, 90.0, 60.0, 10.0, 30.0, 80.0, 70.0, 30.0, 10.0, 40.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 110.0, 60.0, 30.0, 70.0, 38.0, -6.0, 20.0, 50.0, 20.0, 10.0, 25.0, 37.0, 20.0, 28.0, 50.0, -4.0, 70.0, -9.0, 70.0, 8.0, 25.0, 30.0, 100.0, 80.0, 50.0, 60.0, 70.0, 70.0, 40.0, 20.0, 30.0, 20.0, 40.0, 70.0, 33.0, 20.0, 36.0, 30.0, 10.0, 30.0, 50.0, 14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.721492613344034, "mean_inference_ms": 1.7901900586187645, "mean_action_processing_ms": 0.5653938083080865, "mean_env_wait_ms": 1.5579387877144149, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012971162796020508, "StateBufferConnector_ms": 0.009774208068847656, "ViewRequirementAgentConnector_ms": 0.3912050724029541}, "num_episodes": 23, "episode_return_max": 605.0, "episode_return_min": 70.0, "episode_return_mean": 342.86}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.718371016748378, "num_env_steps_trained_throughput_per_sec": 21.718371016748378, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 185173.12, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185172.984, "sample_time_ms": 2524.06, "learn_time_ms": 182627.96, "learn_throughput": 21.902, "synch_weights_time_ms": 10.824}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "a22d3_00000", "date": "2024-08-06_01-12-58", "timestamp": 1722921178, "time_this_iter_s": 184.18539905548096, "time_total_s": 8970.798525333405, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a0040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8970.798525333405, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.25823754789272, "ram_util_percent": 77.90306513409962}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.816055588993909, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.154958032825377, "policy_loss": -0.009018683073996578, "vf_loss": 4.162432492249055, "vf_explained_var": 0.004613293067842754, "kl": 0.0077210781592961806, "entropy": 0.8662399452270918, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 95.0, "episode_reward_mean": 341.61, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -84.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 34.161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.0, 370.0, 405.0, 332.0, 430.0, 259.0, 342.0, 265.0, 240.0, 158.0, 467.0, 360.0, 331.0, 210.0, 379.0, 288.0, 273.0, 295.0, 292.0, 240.0, 551.0, 408.0, 445.0, 350.0, 449.0, 332.0, 258.0, 293.0, 605.0, 379.0, 440.0, 261.0, 370.0, 300.0, 290.0, 159.0, 407.0, 428.0, 306.0, 332.0, 306.0, 565.0, 375.0, 395.0, 338.0, 268.0, 295.0, 370.0, 407.0, 208.0, 245.0, 350.0, 340.0, 382.0, 390.0, 390.0, 369.0, 366.0, 540.0, 328.0, 390.0, 353.0, 372.0, 137.0, 362.0, 290.0, 330.0, 275.0, 340.0, 480.0, 409.0, 350.0, 402.0, 509.0, 440.0, 408.0, 320.0, 317.0, 295.0, 550.0, 339.0, 293.0, 306.0, 238.0, 236.0, 385.0, 359.0, 508.0, 195.0, 408.0, 239.0, 210.0, 263.0, 97.0, 470.0, 295.0, 445.0, 259.0, 228.0, 438.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-84.0, 9.0, 110.0, 20.0, 18.0, -56.0, 30.0, 40.0, 9.0, -1.0, 20.0, 50.0, 40.0, 30.0, 20.0, 30.0, 30.0, 50.0, 70.0, 30.0, 60.0, 90.0, 40.0, 90.0, 40.0, 15.0, 0.0, 30.0, 30.0, 10.0, -2.0, 88.0, 70.0, 78.0, 0.0, 20.0, 18.0, 0.0, 30.0, 30.0, 60.0, 80.0, 50.0, 40.0, 10.0, 40.0, 20.0, 50.0, 20.0, 60.0, 20.0, 20.0, 30.0, 20.0, 30.0, 20.0, 70.0, 19.0, 10.0, 20.0, 60.0, 50.0, 10.0, 40.0, 20.0, 50.0, 4.0, -2.0, 30.0, 80.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 50.0, 65.0, 36.0, -3.0, 70.0, 8.0, 60.0, 0.0, 5.0, 30.0, 20.0, 14.0, 30.0, 0.0, 19.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 19.0, 60.0, 30.0, 42.0, 40.0, 60.0, 30.0, 30.0, 30.0, 55.0, 90.0, 10.0, 15.0, 70.0, 39.0, 50.0, 50.0, -4.0, 50.0, 50.0, 30.0, 10.0, 10.0, 60.0, 70.0, 10.0, 26.0, 6.0, 70.0, 69.0, 0.0, 0.0, 60.0, 10.0, 10.0, 20.0, 10.0, 30.0, 40.0, 30.0, 0.0, 29.0, 30.0, 10.0, 30.0, 70.0, 90.0, 30.0, 60.0, 20.0, 10.0, 8.0, 14.0, 30.0, 30.0, 10.0, 89.0, 40.0, 29.0, 28.0, 10.0, 40.0, 29.0, -25.0, 38.0, 28.0, 18.0, 50.0, 77.0, 18.0, 0.0, 20.0, 8.0, 40.0, 10.0, 40.0, 7.0, 20.0, 40.0, 70.0, 40.0, 16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 0.0, -2.0, 50.0, 160.0, 10.0, 60.0, 40.0, 46.0, 47.0, 60.0, 80.0, 4.0, -10.0, 5.0, 66.0, 50.0, 102.0, 41.0, 80.0, 60.0, 10.0, 30.0, -25.0, 60.0, 50.0, 60.0, 50.0, 60.0, 100.0, 40.0, 20.0, 20.0, 50.0, 10.0, 50.0, 40.0, 30.0, 30.0, 40.0, 60.0, 20.0, 50.0, 60.0, 55.0, 17.0, 60.0, 60.0, 18.0, 40.0, 50.0, 39.0, 30.0, 23.0, 14.0, 70.0, 60.0, 30.0, 30.0, 50.0, 5.0, 20.0, 20.0, 28.0, 30.0, 30.0, 0.0, 10.0, 90.0, 20.0, 0.0, 30.0, 40.0, 40.0, 10.0, 30.0, 20.0, 40.0, 27.0, 46.0, 10.0, 30.0, 100.0, 39.0, 6.0, 20.0, 30.0, 80.0, 90.0, 40.0, 130.0, 70.0, 70.0, 50.0, 50.0, -3.0, 70.0, 15.0, 30.0, 21.0, 17.0, 59.0, 30.0, 60.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 80.0, 40.0, 86.0, 10.0, -3.0, -12.0, 20.0, 50.0, 10.0, 10.0, 40.0, 50.0, 30.0, 25.0, 50.0, 90.0, 25.0, 15.0, 45.0, 40.0, 20.0, 30.0, 50.0, 20.0, 10.0, -10.0, 50.0, 60.0, 20.0, 10.0, 50.0, 40.0, 0.0, 50.0, 10.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 19.0, 20.0, 0.0, 40.0, 20.0, 40.0, 3.0, 14.0, 50.0, 40.0, 90.0, 60.0, 40.0, 10.0, 60.0, 50.0, 10.0, 110.0, 20.0, 60.0, 20.0, 40.0, 70.0, 30.0, 18.0, 16.0, 10.0, 60.0, 0.0, 60.0, 15.0, 50.0, 55.0, 30.0, 10.0, 0.0, 60.0, 7.0, 80.0, 50.0, 50.0, 10.0, 29.0, 16.0, 30.0, 80.0, 10.0, 28.0, 8.0, 60.0, 10.0, 20.0, 40.0, 30.0, 20.0, 40.0, 60.0, 50.0, 72.0, 34.0, 10.0, 100.0, 60.0, 59.0, 80.0, 40.0, 15.0, 40.0, 60.0, 60.0, 40.0, 10.0, 20.0, 10.0, 80.0, 70.0, 30.0, 40.0, 20.0, 70.0, 50.0, 20.0, 15.0, 20.0, 60.0, 40.0, 0.0, 88.0, 60.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 3.0, 20.0, 16.0, 6.0, 13.0, 60.0, 30.0, 50.0, 10.0, 60.0, 26.0, 4.0, 17.0, 20.0, 50.0, 30.0, 30.0, 28.0, 20.0, 70.0, 50.0, 50.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 90.0, 70.0, 80.0, 0.0, 70.0, 30.0, 8.0, 30.0, 39.0, 30.0, 50.0, 30.0, 44.0, 30.0, -6.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 15.0, 50.0, 18.0, 26.0, 6.0, 60.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 0.0, 70.0, 80.0, 40.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 50.0, 30.0, 40.0, 50.0, 60.0, 40.0, 60.0, 6.0, 20.0, 40.0, 36.0, 20.0, 20.0, 10.0, 20.0, 80.0, 70.0, 50.0, 40.0, 20.0, 60.0, 20.0, 90.0, 40.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 80.0, 29.0, 40.0, 40.0, 40.0, 50.0, 50.0, 50.0, 50.0, -12.0, 25.0, 13.0, 60.0, 10.0, 50.0, 50.0, 70.0, 70.0, 20.0, 60.0, 110.0, 60.0, 40.0, 40.0, 50.0, 20.0, 50.0, 50.0, 20.0, 22.0, 20.0, 40.0, 16.0, 50.0, 40.0, 50.0, 10.0, 100.0, 10.0, 30.0, 30.0, 0.0, 70.0, 20.0, 80.0, 50.0, 16.0, 30.0, 20.0, 20.0, 30.0, 37.0, 50.0, 7.0, 20.0, 15.0, 50.0, 70.0, 100.0, 70.0, 50.0, -30.0, 20.0, 20.0, 30.0, 10.0, 14.0, 10.0, 7.0, 20.0, 18.0, -6.0, 14.0, 10.0, 10.0, 14.0, 10.0, 100.0, 60.0, 18.0, 60.0, 80.0, 0.0, 40.0, 0.0, 20.0, 30.0, 40.0, 40.0, 50.0, 39.0, 11.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 0.0, 80.0, 70.0, 60.0, 20.0, 10.0, -3.0, 18.0, 100.0, 20.0, 10.0, 20.0, 20.0, 30.0, 50.0, 0.0, 50.0, 80.0, 30.0, 10.0, 20.0, 60.0, 20.0, 40.0, 30.0, 60.0, 40.0, 20.0, 30.0, 40.0, 50.0, 50.0, 90.0, 50.0, 50.0, 10.0, 40.0, 60.0, 30.0, 60.0, 29.0, 70.0, 30.0, 60.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 35.0, 20.0, 50.0, 29.0, 70.0, 80.0, 40.0, -2.0, 30.0, 50.0, 50.0, 90.0, 23.0, 60.0, 16.0, 50.0, 90.0, 40.0, 60.0, 30.0, 80.0, 30.0, 20.0, 60.0, 60.0, 30.0, 20.0, 50.0, 40.0, 50.0, 20.0, 8.0, 90.0, 60.0, 10.0, 30.0, 80.0, 70.0, 30.0, 10.0, 40.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 110.0, 60.0, 30.0, 70.0, 38.0, -6.0, 20.0, 50.0, 20.0, 10.0, 25.0, 37.0, 20.0, 28.0, 50.0, -4.0, 70.0, -9.0, 70.0, 8.0, 25.0, 30.0, 100.0, 80.0, 50.0, 60.0, 70.0, 70.0, 40.0, 20.0, 30.0, 20.0, 40.0, 70.0, 33.0, 20.0, 36.0, 30.0, 10.0, 30.0, 50.0, 14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0, 60.0, 18.0, 60.0, -5.0, 17.0, 6.0, 30.0, 10.0, 30.0, 80.0, 20.0, 35.0, 10.0, 50.0, 30.0, 13.0, 0.0, 30.0, 0.0, 50.0, 40.0, 10.0, 40.0, 50.0, 19.0, -1.0, 10.0, 28.0, 30.0, 10.0, 50.0, 90.0, 5.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 80.0, 40.0, 70.0, 40.0, 10.0, 20.0, 50.0, 35.0, 50.0, 14.0, 30.0, 80.0, 100.0, 40.0, 80.0, 8.0, 40.0, 40.0, 30.0, 40.0, 50.0, 21.0, 20.0, 60.0, 0.0, -6.0, 0.0, 0.0, 40.0, 40.0, 20.0, 30.0, 50.0, 40.0, 10.0, 30.0, 20.0, 80.0, 60.0, 40.0, 48.0, 10.0, 60.0, 10.0, 4.0, -2.0, 0.0, 30.0, 60.0, 30.0, 37.0, 40.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 26.0, 0.0, 0.0, 40.0, 37.0, 20.0, 30.0, 30.0, 50.0, -20.0, 30.0, 10.0, 17.0, 10.0, 20.0, -6.0, 3.0, 23.0, 10.0, 70.0, 20.0, 60.0, 60.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 30.0, 20.0, 40.0, 30.0, 20.0, 48.0, -13.0, 50.0, 10.0, 60.0, 5.0, 80.0, 20.0, 40.0, 10.0, 40.0, 50.0, 110.0, 50.0, 40.0, 20.0, 10.0, 20.0, 50.0, 69.0, 20.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 10.0, 30.0, 8.0, 30.0, 10.0, 80.0, 50.0, 0.0, 50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7154745573368546, "mean_inference_ms": 1.7815185185716675, "mean_action_processing_ms": 0.5623844545720048, "mean_env_wait_ms": 1.5504902265176557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013125181198120117, "StateBufferConnector_ms": 0.009911537170410156, "ViewRequirementAgentConnector_ms": 0.40337324142456055}, "num_episodes": 18, "episode_return_max": 605.0, "episode_return_min": 95.0, "episode_return_mean": 341.61}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.64320901071419, "num_env_steps_trained_throughput_per_sec": 21.64320901071419, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 184920.133, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184919.997, "sample_time_ms": 2520.667, "learn_time_ms": 182378.052, "learn_throughput": 21.932, "synch_weights_time_ms": 11.093}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "a22d3_00000", "date": "2024-08-06_01-16-03", "timestamp": 1722921363, "time_this_iter_s": 184.82304191589355, "time_total_s": 9155.621567249298, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a208c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9155.621567249298, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 18.43486590038314, "ram_util_percent": 78.97892720306514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6289707320312847, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.039411055165739, "policy_loss": -0.009784826081984055, "vf_loss": 4.047627118220345, "vf_explained_var": 0.002569483498287912, "kl": 0.00784381555716687, "entropy": 0.8697831047165254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 97.0, "episode_reward_mean": 347.34, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -30.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 34.734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 240.0, 551.0, 408.0, 445.0, 350.0, 449.0, 332.0, 258.0, 293.0, 605.0, 379.0, 440.0, 261.0, 370.0, 300.0, 290.0, 159.0, 407.0, 428.0, 306.0, 332.0, 306.0, 565.0, 375.0, 395.0, 338.0, 268.0, 295.0, 370.0, 407.0, 208.0, 245.0, 350.0, 340.0, 382.0, 390.0, 390.0, 369.0, 366.0, 540.0, 328.0, 390.0, 353.0, 372.0, 137.0, 362.0, 290.0, 330.0, 275.0, 340.0, 480.0, 409.0, 350.0, 402.0, 509.0, 440.0, 408.0, 320.0, 317.0, 295.0, 550.0, 339.0, 293.0, 306.0, 238.0, 236.0, 385.0, 359.0, 508.0, 195.0, 408.0, 239.0, 210.0, 263.0, 97.0, 470.0, 295.0, 445.0, 259.0, 228.0, 438.0, 605.0, 420.0, 383.0, 242.0, 256.0, 279.0, 226.0, 438.0, 400.0, 370.0, 260.0, 300.0, 286.0, 153.0, 470.0, 230.0, 252.0, 502.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [16.0, 0.0, 30.0, 10.0, 20.0, 50.0, 40.0, 26.0, 80.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 0.0, -2.0, 50.0, 160.0, 10.0, 60.0, 40.0, 46.0, 47.0, 60.0, 80.0, 4.0, -10.0, 5.0, 66.0, 50.0, 102.0, 41.0, 80.0, 60.0, 10.0, 30.0, -25.0, 60.0, 50.0, 60.0, 50.0, 60.0, 100.0, 40.0, 20.0, 20.0, 50.0, 10.0, 50.0, 40.0, 30.0, 30.0, 40.0, 60.0, 20.0, 50.0, 60.0, 55.0, 17.0, 60.0, 60.0, 18.0, 40.0, 50.0, 39.0, 30.0, 23.0, 14.0, 70.0, 60.0, 30.0, 30.0, 50.0, 5.0, 20.0, 20.0, 28.0, 30.0, 30.0, 0.0, 10.0, 90.0, 20.0, 0.0, 30.0, 40.0, 40.0, 10.0, 30.0, 20.0, 40.0, 27.0, 46.0, 10.0, 30.0, 100.0, 39.0, 6.0, 20.0, 30.0, 80.0, 90.0, 40.0, 130.0, 70.0, 70.0, 50.0, 50.0, -3.0, 70.0, 15.0, 30.0, 21.0, 17.0, 59.0, 30.0, 60.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 80.0, 40.0, 86.0, 10.0, -3.0, -12.0, 20.0, 50.0, 10.0, 10.0, 40.0, 50.0, 30.0, 25.0, 50.0, 90.0, 25.0, 15.0, 45.0, 40.0, 20.0, 30.0, 50.0, 20.0, 10.0, -10.0, 50.0, 60.0, 20.0, 10.0, 50.0, 40.0, 0.0, 50.0, 10.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 19.0, 20.0, 0.0, 40.0, 20.0, 40.0, 3.0, 14.0, 50.0, 40.0, 90.0, 60.0, 40.0, 10.0, 60.0, 50.0, 10.0, 110.0, 20.0, 60.0, 20.0, 40.0, 70.0, 30.0, 18.0, 16.0, 10.0, 60.0, 0.0, 60.0, 15.0, 50.0, 55.0, 30.0, 10.0, 0.0, 60.0, 7.0, 80.0, 50.0, 50.0, 10.0, 29.0, 16.0, 30.0, 80.0, 10.0, 28.0, 8.0, 60.0, 10.0, 20.0, 40.0, 30.0, 20.0, 40.0, 60.0, 50.0, 72.0, 34.0, 10.0, 100.0, 60.0, 59.0, 80.0, 40.0, 15.0, 40.0, 60.0, 60.0, 40.0, 10.0, 20.0, 10.0, 80.0, 70.0, 30.0, 40.0, 20.0, 70.0, 50.0, 20.0, 15.0, 20.0, 60.0, 40.0, 0.0, 88.0, 60.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 3.0, 20.0, 16.0, 6.0, 13.0, 60.0, 30.0, 50.0, 10.0, 60.0, 26.0, 4.0, 17.0, 20.0, 50.0, 30.0, 30.0, 28.0, 20.0, 70.0, 50.0, 50.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 90.0, 70.0, 80.0, 0.0, 70.0, 30.0, 8.0, 30.0, 39.0, 30.0, 50.0, 30.0, 44.0, 30.0, -6.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 15.0, 50.0, 18.0, 26.0, 6.0, 60.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 0.0, 70.0, 80.0, 40.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 50.0, 30.0, 40.0, 50.0, 60.0, 40.0, 60.0, 6.0, 20.0, 40.0, 36.0, 20.0, 20.0, 10.0, 20.0, 80.0, 70.0, 50.0, 40.0, 20.0, 60.0, 20.0, 90.0, 40.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 80.0, 29.0, 40.0, 40.0, 40.0, 50.0, 50.0, 50.0, 50.0, -12.0, 25.0, 13.0, 60.0, 10.0, 50.0, 50.0, 70.0, 70.0, 20.0, 60.0, 110.0, 60.0, 40.0, 40.0, 50.0, 20.0, 50.0, 50.0, 20.0, 22.0, 20.0, 40.0, 16.0, 50.0, 40.0, 50.0, 10.0, 100.0, 10.0, 30.0, 30.0, 0.0, 70.0, 20.0, 80.0, 50.0, 16.0, 30.0, 20.0, 20.0, 30.0, 37.0, 50.0, 7.0, 20.0, 15.0, 50.0, 70.0, 100.0, 70.0, 50.0, -30.0, 20.0, 20.0, 30.0, 10.0, 14.0, 10.0, 7.0, 20.0, 18.0, -6.0, 14.0, 10.0, 10.0, 14.0, 10.0, 100.0, 60.0, 18.0, 60.0, 80.0, 0.0, 40.0, 0.0, 20.0, 30.0, 40.0, 40.0, 50.0, 39.0, 11.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 0.0, 80.0, 70.0, 60.0, 20.0, 10.0, -3.0, 18.0, 100.0, 20.0, 10.0, 20.0, 20.0, 30.0, 50.0, 0.0, 50.0, 80.0, 30.0, 10.0, 20.0, 60.0, 20.0, 40.0, 30.0, 60.0, 40.0, 20.0, 30.0, 40.0, 50.0, 50.0, 90.0, 50.0, 50.0, 10.0, 40.0, 60.0, 30.0, 60.0, 29.0, 70.0, 30.0, 60.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 35.0, 20.0, 50.0, 29.0, 70.0, 80.0, 40.0, -2.0, 30.0, 50.0, 50.0, 90.0, 23.0, 60.0, 16.0, 50.0, 90.0, 40.0, 60.0, 30.0, 80.0, 30.0, 20.0, 60.0, 60.0, 30.0, 20.0, 50.0, 40.0, 50.0, 20.0, 8.0, 90.0, 60.0, 10.0, 30.0, 80.0, 70.0, 30.0, 10.0, 40.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 110.0, 60.0, 30.0, 70.0, 38.0, -6.0, 20.0, 50.0, 20.0, 10.0, 25.0, 37.0, 20.0, 28.0, 50.0, -4.0, 70.0, -9.0, 70.0, 8.0, 25.0, 30.0, 100.0, 80.0, 50.0, 60.0, 70.0, 70.0, 40.0, 20.0, 30.0, 20.0, 40.0, 70.0, 33.0, 20.0, 36.0, 30.0, 10.0, 30.0, 50.0, 14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0, 60.0, 18.0, 60.0, -5.0, 17.0, 6.0, 30.0, 10.0, 30.0, 80.0, 20.0, 35.0, 10.0, 50.0, 30.0, 13.0, 0.0, 30.0, 0.0, 50.0, 40.0, 10.0, 40.0, 50.0, 19.0, -1.0, 10.0, 28.0, 30.0, 10.0, 50.0, 90.0, 5.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 80.0, 40.0, 70.0, 40.0, 10.0, 20.0, 50.0, 35.0, 50.0, 14.0, 30.0, 80.0, 100.0, 40.0, 80.0, 8.0, 40.0, 40.0, 30.0, 40.0, 50.0, 21.0, 20.0, 60.0, 0.0, -6.0, 0.0, 0.0, 40.0, 40.0, 20.0, 30.0, 50.0, 40.0, 10.0, 30.0, 20.0, 80.0, 60.0, 40.0, 48.0, 10.0, 60.0, 10.0, 4.0, -2.0, 0.0, 30.0, 60.0, 30.0, 37.0, 40.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 26.0, 0.0, 0.0, 40.0, 37.0, 20.0, 30.0, 30.0, 50.0, -20.0, 30.0, 10.0, 17.0, 10.0, 20.0, -6.0, 3.0, 23.0, 10.0, 70.0, 20.0, 60.0, 60.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 30.0, 20.0, 40.0, 30.0, 20.0, 48.0, -13.0, 50.0, 10.0, 60.0, 5.0, 80.0, 20.0, 40.0, 10.0, 40.0, 50.0, 110.0, 50.0, 40.0, 20.0, 10.0, 20.0, 50.0, 69.0, 20.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 10.0, 30.0, 8.0, 30.0, 10.0, 80.0, 50.0, 0.0, 50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0, 20.0, 30.0, 24.0, 92.0, 110.0, 20.0, 19.0, 130.0, 80.0, 80.0, 40.0, 30.0, 50.0, 60.0, 10.0, 70.0, 10.0, 70.0, 30.0, 50.0, 18.0, 80.0, 19.0, 60.0, 50.0, 40.0, 50.0, 6.0, 30.0, 30.0, 7.0, 8.0, 70.0, 60.0, 0.0, 40.0, 40.0, 0.0, 7.0, 10.0, -1.0, 16.0, 140.0, 20.0, 30.0, 5.0, -6.0, 0.0, 32.0, 20.0, 10.0, 70.0, 20.0, -1.0, 10.0, 20.0, 0.0, 60.0, 60.0, 30.0, 20.0, 33.0, 70.0, 20.0, 20.0, 20.0, 20.0, 17.0, 20.0, -14.0, 70.0, 60.0, 10.0, 50.0, 20.0, 30.0, 60.0, 28.0, 50.0, 60.0, 10.0, 60.0, 40.0, 30.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 30.0, 50.0, 70.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 20.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 20.0, 50.0, 10.0, 60.0, 90.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 20.0, 19.0, 19.0, 50.0, 30.0, 60.0, 15.0, 11.0, 2.0, -2.0, -19.0, 30.0, 7.0, 10.0, 30.0, 45.0, 12.0, 30.0, 10.0, 40.0, 20.0, 60.0, 60.0, 0.0, 50.0, 50.0, 60.0, 80.0, 50.0, 0.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 60.0, 22.0, 50.0, 10.0, 30.0, 0.0, 20.0, 20.0, -10.0, 50.0, 20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7097290231000677, "mean_inference_ms": 1.7734462596957201, "mean_action_processing_ms": 0.559547909520349, "mean_env_wait_ms": 1.5434840307562103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013095855712890625, "StateBufferConnector_ms": 0.009897470474243164, "ViewRequirementAgentConnector_ms": 0.4047830104827881}, "num_episodes": 18, "episode_return_max": 605.0, "episode_return_min": 97.0, "episode_return_mean": 347.34}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.710353451054807, "num_env_steps_trained_throughput_per_sec": 21.710353451054807, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 184750.24, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184750.105, "sample_time_ms": 2525.686, "learn_time_ms": 182203.146, "learn_throughput": 21.954, "synch_weights_time_ms": 11.196}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "a22d3_00000", "date": "2024-08-06_01-19-07", "timestamp": 1722921547, "time_this_iter_s": 184.25433802604675, "time_total_s": 9339.875905275345, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1666310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9339.875905275345, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.12346153846154, "ram_util_percent": 79.15}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9179438226647014, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7711767582847666, "policy_loss": -0.009361438089619659, "vf_loss": 3.778968713255609, "vf_explained_var": 0.01409430263268427, "kl": 0.007847413978862383, "entropy": 0.8949357416937018, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 97.0, "episode_reward_mean": 341.77, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -30.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 34.177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.0, 565.0, 375.0, 395.0, 338.0, 268.0, 295.0, 370.0, 407.0, 208.0, 245.0, 350.0, 340.0, 382.0, 390.0, 390.0, 369.0, 366.0, 540.0, 328.0, 390.0, 353.0, 372.0, 137.0, 362.0, 290.0, 330.0, 275.0, 340.0, 480.0, 409.0, 350.0, 402.0, 509.0, 440.0, 408.0, 320.0, 317.0, 295.0, 550.0, 339.0, 293.0, 306.0, 238.0, 236.0, 385.0, 359.0, 508.0, 195.0, 408.0, 239.0, 210.0, 263.0, 97.0, 470.0, 295.0, 445.0, 259.0, 228.0, 438.0, 605.0, 420.0, 383.0, 242.0, 256.0, 279.0, 226.0, 438.0, 400.0, 370.0, 260.0, 300.0, 286.0, 153.0, 470.0, 230.0, 252.0, 502.0, 330.0, 347.0, 325.0, 365.0, 300.0, 204.0, 390.0, 420.0, 325.0, 480.0, 225.0, 338.0, 420.0, 545.0, 208.0, 305.0, 320.0, 317.0, 197.0, 234.0, 377.0, 366.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 10.0, 28.0, 8.0, 60.0, 10.0, 20.0, 40.0, 30.0, 20.0, 40.0, 60.0, 50.0, 72.0, 34.0, 10.0, 100.0, 60.0, 59.0, 80.0, 40.0, 15.0, 40.0, 60.0, 60.0, 40.0, 10.0, 20.0, 10.0, 80.0, 70.0, 30.0, 40.0, 20.0, 70.0, 50.0, 20.0, 15.0, 20.0, 60.0, 40.0, 0.0, 88.0, 60.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 3.0, 20.0, 16.0, 6.0, 13.0, 60.0, 30.0, 50.0, 10.0, 60.0, 26.0, 4.0, 17.0, 20.0, 50.0, 30.0, 30.0, 28.0, 20.0, 70.0, 50.0, 50.0, 30.0, 30.0, 30.0, 20.0, 40.0, 20.0, 10.0, 90.0, 70.0, 80.0, 0.0, 70.0, 30.0, 8.0, 30.0, 39.0, 30.0, 50.0, 30.0, 44.0, 30.0, -6.0, 20.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 15.0, 50.0, 18.0, 26.0, 6.0, 60.0, 10.0, 20.0, 30.0, 30.0, 30.0, 20.0, 30.0, 20.0, 0.0, 70.0, 80.0, 40.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 30.0, 50.0, 30.0, 40.0, 50.0, 30.0, 40.0, 50.0, 60.0, 40.0, 60.0, 6.0, 20.0, 40.0, 36.0, 20.0, 20.0, 10.0, 20.0, 80.0, 70.0, 50.0, 40.0, 20.0, 60.0, 20.0, 90.0, 40.0, 40.0, 40.0, 40.0, 0.0, 80.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 0.0, 50.0, 40.0, 80.0, 29.0, 40.0, 40.0, 40.0, 50.0, 50.0, 50.0, 50.0, -12.0, 25.0, 13.0, 60.0, 10.0, 50.0, 50.0, 70.0, 70.0, 20.0, 60.0, 110.0, 60.0, 40.0, 40.0, 50.0, 20.0, 50.0, 50.0, 20.0, 22.0, 20.0, 40.0, 16.0, 50.0, 40.0, 50.0, 10.0, 100.0, 10.0, 30.0, 30.0, 0.0, 70.0, 20.0, 80.0, 50.0, 16.0, 30.0, 20.0, 20.0, 30.0, 37.0, 50.0, 7.0, 20.0, 15.0, 50.0, 70.0, 100.0, 70.0, 50.0, -30.0, 20.0, 20.0, 30.0, 10.0, 14.0, 10.0, 7.0, 20.0, 18.0, -6.0, 14.0, 10.0, 10.0, 14.0, 10.0, 100.0, 60.0, 18.0, 60.0, 80.0, 0.0, 40.0, 0.0, 20.0, 30.0, 40.0, 40.0, 50.0, 39.0, 11.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 0.0, 80.0, 70.0, 60.0, 20.0, 10.0, -3.0, 18.0, 100.0, 20.0, 10.0, 20.0, 20.0, 30.0, 50.0, 0.0, 50.0, 80.0, 30.0, 10.0, 20.0, 60.0, 20.0, 40.0, 30.0, 60.0, 40.0, 20.0, 30.0, 40.0, 50.0, 50.0, 90.0, 50.0, 50.0, 10.0, 40.0, 60.0, 30.0, 60.0, 29.0, 70.0, 30.0, 60.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 35.0, 20.0, 50.0, 29.0, 70.0, 80.0, 40.0, -2.0, 30.0, 50.0, 50.0, 90.0, 23.0, 60.0, 16.0, 50.0, 90.0, 40.0, 60.0, 30.0, 80.0, 30.0, 20.0, 60.0, 60.0, 30.0, 20.0, 50.0, 40.0, 50.0, 20.0, 8.0, 90.0, 60.0, 10.0, 30.0, 80.0, 70.0, 30.0, 10.0, 40.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 110.0, 60.0, 30.0, 70.0, 38.0, -6.0, 20.0, 50.0, 20.0, 10.0, 25.0, 37.0, 20.0, 28.0, 50.0, -4.0, 70.0, -9.0, 70.0, 8.0, 25.0, 30.0, 100.0, 80.0, 50.0, 60.0, 70.0, 70.0, 40.0, 20.0, 30.0, 20.0, 40.0, 70.0, 33.0, 20.0, 36.0, 30.0, 10.0, 30.0, 50.0, 14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0, 60.0, 18.0, 60.0, -5.0, 17.0, 6.0, 30.0, 10.0, 30.0, 80.0, 20.0, 35.0, 10.0, 50.0, 30.0, 13.0, 0.0, 30.0, 0.0, 50.0, 40.0, 10.0, 40.0, 50.0, 19.0, -1.0, 10.0, 28.0, 30.0, 10.0, 50.0, 90.0, 5.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 80.0, 40.0, 70.0, 40.0, 10.0, 20.0, 50.0, 35.0, 50.0, 14.0, 30.0, 80.0, 100.0, 40.0, 80.0, 8.0, 40.0, 40.0, 30.0, 40.0, 50.0, 21.0, 20.0, 60.0, 0.0, -6.0, 0.0, 0.0, 40.0, 40.0, 20.0, 30.0, 50.0, 40.0, 10.0, 30.0, 20.0, 80.0, 60.0, 40.0, 48.0, 10.0, 60.0, 10.0, 4.0, -2.0, 0.0, 30.0, 60.0, 30.0, 37.0, 40.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 26.0, 0.0, 0.0, 40.0, 37.0, 20.0, 30.0, 30.0, 50.0, -20.0, 30.0, 10.0, 17.0, 10.0, 20.0, -6.0, 3.0, 23.0, 10.0, 70.0, 20.0, 60.0, 60.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 30.0, 20.0, 40.0, 30.0, 20.0, 48.0, -13.0, 50.0, 10.0, 60.0, 5.0, 80.0, 20.0, 40.0, 10.0, 40.0, 50.0, 110.0, 50.0, 40.0, 20.0, 10.0, 20.0, 50.0, 69.0, 20.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 10.0, 30.0, 8.0, 30.0, 10.0, 80.0, 50.0, 0.0, 50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0, 20.0, 30.0, 24.0, 92.0, 110.0, 20.0, 19.0, 130.0, 80.0, 80.0, 40.0, 30.0, 50.0, 60.0, 10.0, 70.0, 10.0, 70.0, 30.0, 50.0, 18.0, 80.0, 19.0, 60.0, 50.0, 40.0, 50.0, 6.0, 30.0, 30.0, 7.0, 8.0, 70.0, 60.0, 0.0, 40.0, 40.0, 0.0, 7.0, 10.0, -1.0, 16.0, 140.0, 20.0, 30.0, 5.0, -6.0, 0.0, 32.0, 20.0, 10.0, 70.0, 20.0, -1.0, 10.0, 20.0, 0.0, 60.0, 60.0, 30.0, 20.0, 33.0, 70.0, 20.0, 20.0, 20.0, 20.0, 17.0, 20.0, -14.0, 70.0, 60.0, 10.0, 50.0, 20.0, 30.0, 60.0, 28.0, 50.0, 60.0, 10.0, 60.0, 40.0, 30.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 30.0, 50.0, 70.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 20.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 20.0, 50.0, 10.0, 60.0, 90.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 20.0, 19.0, 19.0, 50.0, 30.0, 60.0, 15.0, 11.0, 2.0, -2.0, -19.0, 30.0, 7.0, 10.0, 30.0, 45.0, 12.0, 30.0, 10.0, 40.0, 20.0, 60.0, 60.0, 0.0, 50.0, 50.0, 60.0, 80.0, 50.0, 0.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 60.0, 22.0, 50.0, 10.0, 30.0, 0.0, 20.0, 20.0, -10.0, 50.0, 20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0, 10.0, 50.0, 50.0, 10.0, 30.0, 50.0, 10.0, 50.0, 10.0, 60.0, 30.0, 20.0, 29.0, 50.0, 20.0, 50.0, 20.0, 60.0, 18.0, 50.0, 40.0, 40.0, 20.0, 15.0, 30.0, 30.0, 50.0, 20.0, 10.0, 70.0, 50.0, 20.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 40.0, 45.0, 50.0, 20.0, 0.0, 40.0, 70.0, 20.0, 30.0, 25.0, 15.0, 30.0, 20.0, 40.0, 0.0, -4.0, 18.0, 30.0, 20.0, 40.0, 40.0, 0.0, 20.0, 10.0, 60.0, 40.0, 20.0, 10.0, 40.0, 80.0, 60.0, 50.0, 60.0, 20.0, 30.0, 70.0, 40.0, 20.0, 40.0, 40.0, 50.0, 50.0, 40.0, 20.0, 0.0, 28.0, 80.0, 10.0, 50.0, 7.0, 40.0, 50.0, 30.0, 40.0, 40.0, 80.0, 80.0, 50.0, 10.0, 80.0, 30.0, 40.0, 20.0, 15.0, 0.0, 30.0, 20.0, 50.0, 10.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 69.0, 60.0, 20.0, 20.0, 40.0, 9.0, 50.0, 60.0, 40.0, 50.0, 50.0, 40.0, 20.0, 20.0, 40.0, 50.0, 50.0, 45.0, 40.0, 100.0, 70.0, 30.0, 30.0, 30.0, 60.0, 50.0, 90.0, -5.0, 20.0, 8.0, 80.0, 19.0, 17.0, 20.0, -1.0, 20.0, 30.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 25.0, 30.0, 40.0, 10.0, 50.0, 20.0, 60.0, 30.0, 10.0, 20.0, 30.0, 40.0, 40.0, 20.0, 20.0, 10.0, 40.0, 80.0, 29.0, 30.0, 60.0, 29.0, 9.0, 10.0, -1.0, 10.0, 69.0, 10.0, 20.0, 40.0, 40.0, 10.0, -1.0, 0.0, 50.0, 40.0, 20.0, 19.0, 5.0, 0.0, 50.0, -10.0, 20.0, 40.0, 20.0, 20.0, 90.0, 28.0, 90.0, 10.0, 20.0, 20.0, 19.0, 60.0, 38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7016391088737084, "mean_inference_ms": 1.7636740298090274, "mean_action_processing_ms": 0.5562384056667844, "mean_env_wait_ms": 1.535639651588429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01257634162902832, "StateBufferConnector_ms": 0.01142740249633789, "ViewRequirementAgentConnector_ms": 0.40377330780029297}, "num_episodes": 22, "episode_return_max": 605.0, "episode_return_min": 97.0, "episode_return_mean": 341.77}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.686550229518097, "num_env_steps_trained_throughput_per_sec": 21.686550229518097, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 184827.697, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184827.651, "sample_time_ms": 2525.569, "learn_time_ms": 182282.958, "learn_throughput": 21.944, "synch_weights_time_ms": 11.099}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "a22d3_00000", "date": "2024-08-06_01-22-12", "timestamp": 1722921732, "time_this_iter_s": 184.45612692832947, "time_total_s": 9524.332032203674, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a015d430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9524.332032203674, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 17.14176245210728, "ram_util_percent": 78.80498084291187}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0800808069043266, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9572774894194356, "policy_loss": -0.009406152938510449, "vf_loss": 3.96513877613222, "vf_explained_var": 0.007796148928844383, "kl": 0.00772432325710853, "entropy": 0.8712981084220833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 88.0, "episode_reward_mean": 322.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -40.0}, "policy_reward_max": {"policy_0": 149.0}, "policy_reward_mean": {"policy_0": 32.255}, "custom_metrics": {}, "hist_stats": {"episode_reward": [137.0, 362.0, 290.0, 330.0, 275.0, 340.0, 480.0, 409.0, 350.0, 402.0, 509.0, 440.0, 408.0, 320.0, 317.0, 295.0, 550.0, 339.0, 293.0, 306.0, 238.0, 236.0, 385.0, 359.0, 508.0, 195.0, 408.0, 239.0, 210.0, 263.0, 97.0, 470.0, 295.0, 445.0, 259.0, 228.0, 438.0, 605.0, 420.0, 383.0, 242.0, 256.0, 279.0, 226.0, 438.0, 400.0, 370.0, 260.0, 300.0, 286.0, 153.0, 470.0, 230.0, 252.0, 502.0, 330.0, 347.0, 325.0, 365.0, 300.0, 204.0, 390.0, 420.0, 325.0, 480.0, 225.0, 338.0, 420.0, 545.0, 208.0, 305.0, 320.0, 317.0, 197.0, 234.0, 377.0, 366.0, 298.0, 207.0, 355.0, 282.0, 210.0, 218.0, 340.0, 230.0, 378.0, 250.0, 189.0, 300.0, 334.0, 207.0, 170.0, 333.0, 88.0, 223.0, 370.0, 552.0, 340.0, 282.0, 264.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 14.0, 10.0, 7.0, 20.0, 18.0, -6.0, 14.0, 10.0, 10.0, 14.0, 10.0, 100.0, 60.0, 18.0, 60.0, 80.0, 0.0, 40.0, 0.0, 20.0, 30.0, 40.0, 40.0, 50.0, 39.0, 11.0, 20.0, 10.0, 0.0, 50.0, 20.0, 20.0, 0.0, 80.0, 70.0, 60.0, 20.0, 10.0, -3.0, 18.0, 100.0, 20.0, 10.0, 20.0, 20.0, 30.0, 50.0, 0.0, 50.0, 80.0, 30.0, 10.0, 20.0, 60.0, 20.0, 40.0, 30.0, 60.0, 40.0, 20.0, 30.0, 40.0, 50.0, 50.0, 90.0, 50.0, 50.0, 10.0, 40.0, 60.0, 30.0, 60.0, 29.0, 70.0, 30.0, 60.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 30.0, 30.0, 30.0, 30.0, 30.0, 35.0, 20.0, 50.0, 29.0, 70.0, 80.0, 40.0, -2.0, 30.0, 50.0, 50.0, 90.0, 23.0, 60.0, 16.0, 50.0, 90.0, 40.0, 60.0, 30.0, 80.0, 30.0, 20.0, 60.0, 60.0, 30.0, 20.0, 50.0, 40.0, 50.0, 20.0, 8.0, 90.0, 60.0, 10.0, 30.0, 80.0, 70.0, 30.0, 10.0, 40.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 10.0, 20.0, 110.0, 60.0, 30.0, 70.0, 38.0, -6.0, 20.0, 50.0, 20.0, 10.0, 25.0, 37.0, 20.0, 28.0, 50.0, -4.0, 70.0, -9.0, 70.0, 8.0, 25.0, 30.0, 100.0, 80.0, 50.0, 60.0, 70.0, 70.0, 40.0, 20.0, 30.0, 20.0, 40.0, 70.0, 33.0, 20.0, 36.0, 30.0, 10.0, 30.0, 50.0, 14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0, 60.0, 18.0, 60.0, -5.0, 17.0, 6.0, 30.0, 10.0, 30.0, 80.0, 20.0, 35.0, 10.0, 50.0, 30.0, 13.0, 0.0, 30.0, 0.0, 50.0, 40.0, 10.0, 40.0, 50.0, 19.0, -1.0, 10.0, 28.0, 30.0, 10.0, 50.0, 90.0, 5.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 80.0, 40.0, 70.0, 40.0, 10.0, 20.0, 50.0, 35.0, 50.0, 14.0, 30.0, 80.0, 100.0, 40.0, 80.0, 8.0, 40.0, 40.0, 30.0, 40.0, 50.0, 21.0, 20.0, 60.0, 0.0, -6.0, 0.0, 0.0, 40.0, 40.0, 20.0, 30.0, 50.0, 40.0, 10.0, 30.0, 20.0, 80.0, 60.0, 40.0, 48.0, 10.0, 60.0, 10.0, 4.0, -2.0, 0.0, 30.0, 60.0, 30.0, 37.0, 40.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 26.0, 0.0, 0.0, 40.0, 37.0, 20.0, 30.0, 30.0, 50.0, -20.0, 30.0, 10.0, 17.0, 10.0, 20.0, -6.0, 3.0, 23.0, 10.0, 70.0, 20.0, 60.0, 60.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 30.0, 20.0, 40.0, 30.0, 20.0, 48.0, -13.0, 50.0, 10.0, 60.0, 5.0, 80.0, 20.0, 40.0, 10.0, 40.0, 50.0, 110.0, 50.0, 40.0, 20.0, 10.0, 20.0, 50.0, 69.0, 20.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 10.0, 30.0, 8.0, 30.0, 10.0, 80.0, 50.0, 0.0, 50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0, 20.0, 30.0, 24.0, 92.0, 110.0, 20.0, 19.0, 130.0, 80.0, 80.0, 40.0, 30.0, 50.0, 60.0, 10.0, 70.0, 10.0, 70.0, 30.0, 50.0, 18.0, 80.0, 19.0, 60.0, 50.0, 40.0, 50.0, 6.0, 30.0, 30.0, 7.0, 8.0, 70.0, 60.0, 0.0, 40.0, 40.0, 0.0, 7.0, 10.0, -1.0, 16.0, 140.0, 20.0, 30.0, 5.0, -6.0, 0.0, 32.0, 20.0, 10.0, 70.0, 20.0, -1.0, 10.0, 20.0, 0.0, 60.0, 60.0, 30.0, 20.0, 33.0, 70.0, 20.0, 20.0, 20.0, 20.0, 17.0, 20.0, -14.0, 70.0, 60.0, 10.0, 50.0, 20.0, 30.0, 60.0, 28.0, 50.0, 60.0, 10.0, 60.0, 40.0, 30.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 30.0, 50.0, 70.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 20.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 20.0, 50.0, 10.0, 60.0, 90.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 20.0, 19.0, 19.0, 50.0, 30.0, 60.0, 15.0, 11.0, 2.0, -2.0, -19.0, 30.0, 7.0, 10.0, 30.0, 45.0, 12.0, 30.0, 10.0, 40.0, 20.0, 60.0, 60.0, 0.0, 50.0, 50.0, 60.0, 80.0, 50.0, 0.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 60.0, 22.0, 50.0, 10.0, 30.0, 0.0, 20.0, 20.0, -10.0, 50.0, 20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0, 10.0, 50.0, 50.0, 10.0, 30.0, 50.0, 10.0, 50.0, 10.0, 60.0, 30.0, 20.0, 29.0, 50.0, 20.0, 50.0, 20.0, 60.0, 18.0, 50.0, 40.0, 40.0, 20.0, 15.0, 30.0, 30.0, 50.0, 20.0, 10.0, 70.0, 50.0, 20.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 40.0, 45.0, 50.0, 20.0, 0.0, 40.0, 70.0, 20.0, 30.0, 25.0, 15.0, 30.0, 20.0, 40.0, 0.0, -4.0, 18.0, 30.0, 20.0, 40.0, 40.0, 0.0, 20.0, 10.0, 60.0, 40.0, 20.0, 10.0, 40.0, 80.0, 60.0, 50.0, 60.0, 20.0, 30.0, 70.0, 40.0, 20.0, 40.0, 40.0, 50.0, 50.0, 40.0, 20.0, 0.0, 28.0, 80.0, 10.0, 50.0, 7.0, 40.0, 50.0, 30.0, 40.0, 40.0, 80.0, 80.0, 50.0, 10.0, 80.0, 30.0, 40.0, 20.0, 15.0, 0.0, 30.0, 20.0, 50.0, 10.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 69.0, 60.0, 20.0, 20.0, 40.0, 9.0, 50.0, 60.0, 40.0, 50.0, 50.0, 40.0, 20.0, 20.0, 40.0, 50.0, 50.0, 45.0, 40.0, 100.0, 70.0, 30.0, 30.0, 30.0, 60.0, 50.0, 90.0, -5.0, 20.0, 8.0, 80.0, 19.0, 17.0, 20.0, -1.0, 20.0, 30.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 25.0, 30.0, 40.0, 10.0, 50.0, 20.0, 60.0, 30.0, 10.0, 20.0, 30.0, 40.0, 40.0, 20.0, 20.0, 10.0, 40.0, 80.0, 29.0, 30.0, 60.0, 29.0, 9.0, 10.0, -1.0, 10.0, 69.0, 10.0, 20.0, 40.0, 40.0, 10.0, -1.0, 0.0, 50.0, 40.0, 20.0, 19.0, 5.0, 0.0, 50.0, -10.0, 20.0, 40.0, 20.0, 20.0, 90.0, 28.0, 90.0, 10.0, 20.0, 20.0, 19.0, 60.0, 38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0, 30.0, -1.0, 60.0, 30.0, 10.0, 40.0, 70.0, 9.0, 10.0, 40.0, 60.0, 20.0, 50.0, 24.0, 8.0, -12.0, 10.0, 20.0, 17.0, 10.0, 5.0, 30.0, -16.0, 40.0, 28.0, 50.0, 68.0, 50.0, 30.0, 70.0, 9.0, 0.0, 19.0, 6.0, 50.0, 30.0, 48.0, 30.0, 90.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 20.0, 50.0, 9.0, 39.0, 0.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 60.0, 90.0, 30.0, 30.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 40.0, 50.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 70.0, 20.0, 20.0, 50.0, 80.0, 30.0, 48.0, 20.0, 30.0, 60.0, 30.0, -8.0, 8.0, 0.0, 50.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 70.0, 14.0, 40.0, 0.0, 7.0, 20.0, -12.0, -25.0, 60.0, -1.0, 4.0, -5.0, 20.0, 44.0, 149.0, 26.0, 28.0, 30.0, 20.0, 90.0, 1.0, 30.0, 40.0, 30.0, 50.0, 20.0, 23.0, 30.0, 0.0, 60.0, 0.0, 60.0, 10.0, 10.0, 8.0, 10.0, 19.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 20.0, 0.0, 20.0, 20.0, 50.0, -5.0, 30.0, 23.0, 2.0, 70.0, 3.0, 60.0, 20.0, 80.0, 0.0, 0.0, 0.0, 20.0, 23.0, -4.0, 10.0, 10.0, 10.0, 19.0, 15.0, 30.0, 75.0, 23.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 80.0, 60.0, 70.0, -40.0, 60.0, 70.0, 10.0, 110.0, 92.0, 50.0, 70.0, 10.0, 20.0, 40.0, 20.0, 80.0, 20.0, 10.0, 20.0, 28.0, 30.0, 80.0, 10.0, 30.0, 40.0, 9.0, -2.0, 40.0, 17.0, 40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6953361044424122, "mean_inference_ms": 1.7541267233138935, "mean_action_processing_ms": 0.5534017570700108, "mean_env_wait_ms": 1.5287943999339983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012436628341674805, "StateBufferConnector_ms": 0.011159181594848633, "ViewRequirementAgentConnector_ms": 0.3898482322692871}, "num_episodes": 23, "episode_return_max": 605.0, "episode_return_min": 88.0, "episode_return_mean": 322.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.489579555621606, "num_env_steps_trained_throughput_per_sec": 21.489579555621606, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 184717.064, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184717.017, "sample_time_ms": 2457.093, "learn_time_ms": 182240.986, "learn_throughput": 21.949, "synch_weights_time_ms": 11.088}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "a22d3_00000", "date": "2024-08-06_01-25-18", "timestamp": 1722921918, "time_this_iter_s": 186.1475977897644, "time_total_s": 9710.479629993439, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a015de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9710.479629993439, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 19.78560606060606, "ram_util_percent": 78.40416666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.791577502447195, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.835019903340406, "policy_loss": -0.010431310189793657, "vf_loss": 4.843780838922697, "vf_explained_var": 0.0007900564117045702, "kl": 0.008351892746262732, "entropy": 0.8156154164935326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 605.0, "episode_reward_min": 88.0, "episode_reward_mean": 320.59, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -183.0}, "policy_reward_max": {"policy_0": 149.0}, "policy_reward_mean": {"policy_0": 32.059}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0, 306.0, 238.0, 236.0, 385.0, 359.0, 508.0, 195.0, 408.0, 239.0, 210.0, 263.0, 97.0, 470.0, 295.0, 445.0, 259.0, 228.0, 438.0, 605.0, 420.0, 383.0, 242.0, 256.0, 279.0, 226.0, 438.0, 400.0, 370.0, 260.0, 300.0, 286.0, 153.0, 470.0, 230.0, 252.0, 502.0, 330.0, 347.0, 325.0, 365.0, 300.0, 204.0, 390.0, 420.0, 325.0, 480.0, 225.0, 338.0, 420.0, 545.0, 208.0, 305.0, 320.0, 317.0, 197.0, 234.0, 377.0, 366.0, 298.0, 207.0, 355.0, 282.0, 210.0, 218.0, 340.0, 230.0, 378.0, 250.0, 189.0, 300.0, 334.0, 207.0, 170.0, 333.0, 88.0, 223.0, 370.0, 552.0, 340.0, 282.0, 264.0, 318.0, 170.0, 153.0, 360.0, 415.0, 320.0, 580.0, 166.0, 388.0, 342.0, 389.0, 181.0, 374.0, 370.0, 445.0, 410.0, 506.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [14.0, 10.0, 30.0, 70.0, 10.0, -11.0, 50.0, 40.0, 40.0, 40.0, 60.0, 18.0, 60.0, -5.0, 17.0, 6.0, 30.0, 10.0, 30.0, 80.0, 20.0, 35.0, 10.0, 50.0, 30.0, 13.0, 0.0, 30.0, 0.0, 50.0, 40.0, 10.0, 40.0, 50.0, 19.0, -1.0, 10.0, 28.0, 30.0, 10.0, 50.0, 90.0, 5.0, 60.0, 20.0, 10.0, 30.0, 20.0, 20.0, 80.0, 40.0, 70.0, 40.0, 10.0, 20.0, 50.0, 35.0, 50.0, 14.0, 30.0, 80.0, 100.0, 40.0, 80.0, 8.0, 40.0, 40.0, 30.0, 40.0, 50.0, 21.0, 20.0, 60.0, 0.0, -6.0, 0.0, 0.0, 40.0, 40.0, 20.0, 30.0, 50.0, 40.0, 10.0, 30.0, 20.0, 80.0, 60.0, 40.0, 48.0, 10.0, 60.0, 10.0, 4.0, -2.0, 0.0, 30.0, 60.0, 30.0, 37.0, 40.0, 10.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 30.0, 30.0, 26.0, 0.0, 0.0, 40.0, 37.0, 20.0, 30.0, 30.0, 50.0, -20.0, 30.0, 10.0, 17.0, 10.0, 20.0, -6.0, 3.0, 23.0, 10.0, 70.0, 20.0, 60.0, 60.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 30.0, 20.0, 40.0, 30.0, 20.0, 48.0, -13.0, 50.0, 10.0, 60.0, 5.0, 80.0, 20.0, 40.0, 10.0, 40.0, 50.0, 110.0, 50.0, 40.0, 20.0, 10.0, 20.0, 50.0, 69.0, 20.0, 20.0, 0.0, 50.0, 0.0, 0.0, 10.0, 10.0, 30.0, 8.0, 30.0, 10.0, 80.0, 50.0, 0.0, 50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0, 20.0, 30.0, 24.0, 92.0, 110.0, 20.0, 19.0, 130.0, 80.0, 80.0, 40.0, 30.0, 50.0, 60.0, 10.0, 70.0, 10.0, 70.0, 30.0, 50.0, 18.0, 80.0, 19.0, 60.0, 50.0, 40.0, 50.0, 6.0, 30.0, 30.0, 7.0, 8.0, 70.0, 60.0, 0.0, 40.0, 40.0, 0.0, 7.0, 10.0, -1.0, 16.0, 140.0, 20.0, 30.0, 5.0, -6.0, 0.0, 32.0, 20.0, 10.0, 70.0, 20.0, -1.0, 10.0, 20.0, 0.0, 60.0, 60.0, 30.0, 20.0, 33.0, 70.0, 20.0, 20.0, 20.0, 20.0, 17.0, 20.0, -14.0, 70.0, 60.0, 10.0, 50.0, 20.0, 30.0, 60.0, 28.0, 50.0, 60.0, 10.0, 60.0, 40.0, 30.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 30.0, 50.0, 70.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 20.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 20.0, 50.0, 10.0, 60.0, 90.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 20.0, 19.0, 19.0, 50.0, 30.0, 60.0, 15.0, 11.0, 2.0, -2.0, -19.0, 30.0, 7.0, 10.0, 30.0, 45.0, 12.0, 30.0, 10.0, 40.0, 20.0, 60.0, 60.0, 0.0, 50.0, 50.0, 60.0, 80.0, 50.0, 0.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 60.0, 22.0, 50.0, 10.0, 30.0, 0.0, 20.0, 20.0, -10.0, 50.0, 20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0, 10.0, 50.0, 50.0, 10.0, 30.0, 50.0, 10.0, 50.0, 10.0, 60.0, 30.0, 20.0, 29.0, 50.0, 20.0, 50.0, 20.0, 60.0, 18.0, 50.0, 40.0, 40.0, 20.0, 15.0, 30.0, 30.0, 50.0, 20.0, 10.0, 70.0, 50.0, 20.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 40.0, 45.0, 50.0, 20.0, 0.0, 40.0, 70.0, 20.0, 30.0, 25.0, 15.0, 30.0, 20.0, 40.0, 0.0, -4.0, 18.0, 30.0, 20.0, 40.0, 40.0, 0.0, 20.0, 10.0, 60.0, 40.0, 20.0, 10.0, 40.0, 80.0, 60.0, 50.0, 60.0, 20.0, 30.0, 70.0, 40.0, 20.0, 40.0, 40.0, 50.0, 50.0, 40.0, 20.0, 0.0, 28.0, 80.0, 10.0, 50.0, 7.0, 40.0, 50.0, 30.0, 40.0, 40.0, 80.0, 80.0, 50.0, 10.0, 80.0, 30.0, 40.0, 20.0, 15.0, 0.0, 30.0, 20.0, 50.0, 10.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 69.0, 60.0, 20.0, 20.0, 40.0, 9.0, 50.0, 60.0, 40.0, 50.0, 50.0, 40.0, 20.0, 20.0, 40.0, 50.0, 50.0, 45.0, 40.0, 100.0, 70.0, 30.0, 30.0, 30.0, 60.0, 50.0, 90.0, -5.0, 20.0, 8.0, 80.0, 19.0, 17.0, 20.0, -1.0, 20.0, 30.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 25.0, 30.0, 40.0, 10.0, 50.0, 20.0, 60.0, 30.0, 10.0, 20.0, 30.0, 40.0, 40.0, 20.0, 20.0, 10.0, 40.0, 80.0, 29.0, 30.0, 60.0, 29.0, 9.0, 10.0, -1.0, 10.0, 69.0, 10.0, 20.0, 40.0, 40.0, 10.0, -1.0, 0.0, 50.0, 40.0, 20.0, 19.0, 5.0, 0.0, 50.0, -10.0, 20.0, 40.0, 20.0, 20.0, 90.0, 28.0, 90.0, 10.0, 20.0, 20.0, 19.0, 60.0, 38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0, 30.0, -1.0, 60.0, 30.0, 10.0, 40.0, 70.0, 9.0, 10.0, 40.0, 60.0, 20.0, 50.0, 24.0, 8.0, -12.0, 10.0, 20.0, 17.0, 10.0, 5.0, 30.0, -16.0, 40.0, 28.0, 50.0, 68.0, 50.0, 30.0, 70.0, 9.0, 0.0, 19.0, 6.0, 50.0, 30.0, 48.0, 30.0, 90.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 20.0, 50.0, 9.0, 39.0, 0.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 60.0, 90.0, 30.0, 30.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 40.0, 50.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 70.0, 20.0, 20.0, 50.0, 80.0, 30.0, 48.0, 20.0, 30.0, 60.0, 30.0, -8.0, 8.0, 0.0, 50.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 70.0, 14.0, 40.0, 0.0, 7.0, 20.0, -12.0, -25.0, 60.0, -1.0, 4.0, -5.0, 20.0, 44.0, 149.0, 26.0, 28.0, 30.0, 20.0, 90.0, 1.0, 30.0, 40.0, 30.0, 50.0, 20.0, 23.0, 30.0, 0.0, 60.0, 0.0, 60.0, 10.0, 10.0, 8.0, 10.0, 19.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 20.0, 0.0, 20.0, 20.0, 50.0, -5.0, 30.0, 23.0, 2.0, 70.0, 3.0, 60.0, 20.0, 80.0, 0.0, 0.0, 0.0, 20.0, 23.0, -4.0, 10.0, 10.0, 10.0, 19.0, 15.0, 30.0, 75.0, 23.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 80.0, 60.0, 70.0, -40.0, 60.0, 70.0, 10.0, 110.0, 92.0, 50.0, 70.0, 10.0, 20.0, 40.0, 20.0, 80.0, 20.0, 10.0, 20.0, 28.0, 30.0, 80.0, 10.0, 30.0, 40.0, 9.0, -2.0, 40.0, 17.0, 40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 20.0, 20.0, 28.0, 50.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 10.0, -14.0, 10.0, 80.0, 10.0, 10.0, 10.0, 0.0, 10.0, 27.0, 30.0, 30.0, 30.0, 19.0, 5.0, 70.0, 60.0, 6.0, 50.0, 60.0, 40.0, 40.0, 60.0, 70.0, 10.0, -15.0, 45.0, 80.0, 60.0, 25.0, 10.0, 40.0, 50.0, 20.0, 60.0, 30.0, 10.0, 10.0, 60.0, 30.0, 70.0, 90.0, 60.0, 60.0, 60.0, 50.0, 10.0, 60.0, 80.0, 40.0, 70.0, 5.0, 40.0, 30.0, 54.0, 6.0, 40.0, 79.0, 25.0, -183.0, 110.0, 20.0, 10.0, 70.0, 80.0, 39.0, 10.0, 19.0, 20.0, 10.0, 70.0, 20.0, 41.0, 40.0, 40.0, 0.0, 10.0, 50.0, 70.0, 1.0, 20.0, 9.0, 40.0, 60.0, 10.0, 30.0, 60.0, 40.0, 40.0, 80.0, 28.0, -21.0, 0.0, -17.0, 20.0, 50.0, 13.0, 18.0, 30.0, 60.0, 20.0, 60.0, 20.0, 70.0, 30.0, 40.0, 0.0, 70.0, 14.0, 50.0, 40.0, 20.0, 40.0, 20.0, 40.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 20.0, 60.0, 90.0, 40.0, 50.0, 35.0, 20.0, 60.0, 40.0, 60.0, 30.0, 40.0, 10.0, 40.0, 20.0, 30.0, 130.0, 30.0, 20.0, 50.0, 60.0, 37.0, 30.0, 40.0, 90.0, 50.0, 20.0, 39.0, 90.0, 50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6913057430938596, "mean_inference_ms": 1.7491817089859745, "mean_action_processing_ms": 0.5510765713569402, "mean_env_wait_ms": 1.5224246506751278, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011894464492797852, "StateBufferConnector_ms": 0.010841846466064453, "ViewRequirementAgentConnector_ms": 0.3830258846282959}, "num_episodes": 18, "episode_return_max": 605.0, "episode_return_min": 88.0, "episode_return_mean": 320.59}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.805131825056808, "num_env_steps_trained_throughput_per_sec": 21.805131825056808, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 184554.998, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184554.951, "sample_time_ms": 2439.105, "learn_time_ms": 182097.079, "learn_throughput": 21.966, "synch_weights_time_ms": 10.93}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "a22d3_00000", "date": "2024-08-06_01-28-21", "timestamp": 1722922101, "time_this_iter_s": 183.45340180397034, "time_total_s": 9893.933031797409, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a0670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9893.933031797409, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 16.905405405405407, "ram_util_percent": 77.59536679536679}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.560334491621826, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.255810661285449, "policy_loss": -0.009804594451343369, "vf_loss": 4.2639402752359326, "vf_explained_var": 0.0046047660425956, "kl": 0.008374901916065195, "entropy": 0.8189302438427719, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 650.0, "episode_reward_min": 88.0, "episode_reward_mean": 340.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -183.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 34.074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0, 605.0, 420.0, 383.0, 242.0, 256.0, 279.0, 226.0, 438.0, 400.0, 370.0, 260.0, 300.0, 286.0, 153.0, 470.0, 230.0, 252.0, 502.0, 330.0, 347.0, 325.0, 365.0, 300.0, 204.0, 390.0, 420.0, 325.0, 480.0, 225.0, 338.0, 420.0, 545.0, 208.0, 305.0, 320.0, 317.0, 197.0, 234.0, 377.0, 366.0, 298.0, 207.0, 355.0, 282.0, 210.0, 218.0, 340.0, 230.0, 378.0, 250.0, 189.0, 300.0, 334.0, 207.0, 170.0, 333.0, 88.0, 223.0, 370.0, 552.0, 340.0, 282.0, 264.0, 318.0, 170.0, 153.0, 360.0, 415.0, 320.0, 580.0, 166.0, 388.0, 342.0, 389.0, 181.0, 374.0, 370.0, 445.0, 410.0, 506.0, 470.0, 494.0, 437.0, 330.0, 461.0, 650.0, 473.0, 405.0, 384.0, 409.0, 360.0, 521.0, 150.0, 551.0, 470.0, 375.0, 270.0, 379.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 30.0, 30.0, 80.0, 100.0, 0.0, 8.0, 40.0, 50.0, 50.0, 20.0, 30.0, 24.0, 92.0, 110.0, 20.0, 19.0, 130.0, 80.0, 80.0, 40.0, 30.0, 50.0, 60.0, 10.0, 70.0, 10.0, 70.0, 30.0, 50.0, 18.0, 80.0, 19.0, 60.0, 50.0, 40.0, 50.0, 6.0, 30.0, 30.0, 7.0, 8.0, 70.0, 60.0, 0.0, 40.0, 40.0, 0.0, 7.0, 10.0, -1.0, 16.0, 140.0, 20.0, 30.0, 5.0, -6.0, 0.0, 32.0, 20.0, 10.0, 70.0, 20.0, -1.0, 10.0, 20.0, 0.0, 60.0, 60.0, 30.0, 20.0, 33.0, 70.0, 20.0, 20.0, 20.0, 20.0, 17.0, 20.0, -14.0, 70.0, 60.0, 10.0, 50.0, 20.0, 30.0, 60.0, 28.0, 50.0, 60.0, 10.0, 60.0, 40.0, 30.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 30.0, 50.0, 70.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 20.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 20.0, 50.0, 10.0, 60.0, 90.0, 20.0, 0.0, 10.0, 20.0, 20.0, 60.0, 20.0, 19.0, 19.0, 50.0, 30.0, 60.0, 15.0, 11.0, 2.0, -2.0, -19.0, 30.0, 7.0, 10.0, 30.0, 45.0, 12.0, 30.0, 10.0, 40.0, 20.0, 60.0, 60.0, 0.0, 50.0, 50.0, 60.0, 80.0, 50.0, 0.0, 10.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 20.0, 60.0, 22.0, 50.0, 10.0, 30.0, 0.0, 20.0, 20.0, -10.0, 50.0, 20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0, 10.0, 50.0, 50.0, 10.0, 30.0, 50.0, 10.0, 50.0, 10.0, 60.0, 30.0, 20.0, 29.0, 50.0, 20.0, 50.0, 20.0, 60.0, 18.0, 50.0, 40.0, 40.0, 20.0, 15.0, 30.0, 30.0, 50.0, 20.0, 10.0, 70.0, 50.0, 20.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 40.0, 45.0, 50.0, 20.0, 0.0, 40.0, 70.0, 20.0, 30.0, 25.0, 15.0, 30.0, 20.0, 40.0, 0.0, -4.0, 18.0, 30.0, 20.0, 40.0, 40.0, 0.0, 20.0, 10.0, 60.0, 40.0, 20.0, 10.0, 40.0, 80.0, 60.0, 50.0, 60.0, 20.0, 30.0, 70.0, 40.0, 20.0, 40.0, 40.0, 50.0, 50.0, 40.0, 20.0, 0.0, 28.0, 80.0, 10.0, 50.0, 7.0, 40.0, 50.0, 30.0, 40.0, 40.0, 80.0, 80.0, 50.0, 10.0, 80.0, 30.0, 40.0, 20.0, 15.0, 0.0, 30.0, 20.0, 50.0, 10.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 69.0, 60.0, 20.0, 20.0, 40.0, 9.0, 50.0, 60.0, 40.0, 50.0, 50.0, 40.0, 20.0, 20.0, 40.0, 50.0, 50.0, 45.0, 40.0, 100.0, 70.0, 30.0, 30.0, 30.0, 60.0, 50.0, 90.0, -5.0, 20.0, 8.0, 80.0, 19.0, 17.0, 20.0, -1.0, 20.0, 30.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 25.0, 30.0, 40.0, 10.0, 50.0, 20.0, 60.0, 30.0, 10.0, 20.0, 30.0, 40.0, 40.0, 20.0, 20.0, 10.0, 40.0, 80.0, 29.0, 30.0, 60.0, 29.0, 9.0, 10.0, -1.0, 10.0, 69.0, 10.0, 20.0, 40.0, 40.0, 10.0, -1.0, 0.0, 50.0, 40.0, 20.0, 19.0, 5.0, 0.0, 50.0, -10.0, 20.0, 40.0, 20.0, 20.0, 90.0, 28.0, 90.0, 10.0, 20.0, 20.0, 19.0, 60.0, 38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0, 30.0, -1.0, 60.0, 30.0, 10.0, 40.0, 70.0, 9.0, 10.0, 40.0, 60.0, 20.0, 50.0, 24.0, 8.0, -12.0, 10.0, 20.0, 17.0, 10.0, 5.0, 30.0, -16.0, 40.0, 28.0, 50.0, 68.0, 50.0, 30.0, 70.0, 9.0, 0.0, 19.0, 6.0, 50.0, 30.0, 48.0, 30.0, 90.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 20.0, 50.0, 9.0, 39.0, 0.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 60.0, 90.0, 30.0, 30.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 40.0, 50.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 70.0, 20.0, 20.0, 50.0, 80.0, 30.0, 48.0, 20.0, 30.0, 60.0, 30.0, -8.0, 8.0, 0.0, 50.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 70.0, 14.0, 40.0, 0.0, 7.0, 20.0, -12.0, -25.0, 60.0, -1.0, 4.0, -5.0, 20.0, 44.0, 149.0, 26.0, 28.0, 30.0, 20.0, 90.0, 1.0, 30.0, 40.0, 30.0, 50.0, 20.0, 23.0, 30.0, 0.0, 60.0, 0.0, 60.0, 10.0, 10.0, 8.0, 10.0, 19.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 20.0, 0.0, 20.0, 20.0, 50.0, -5.0, 30.0, 23.0, 2.0, 70.0, 3.0, 60.0, 20.0, 80.0, 0.0, 0.0, 0.0, 20.0, 23.0, -4.0, 10.0, 10.0, 10.0, 19.0, 15.0, 30.0, 75.0, 23.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 80.0, 60.0, 70.0, -40.0, 60.0, 70.0, 10.0, 110.0, 92.0, 50.0, 70.0, 10.0, 20.0, 40.0, 20.0, 80.0, 20.0, 10.0, 20.0, 28.0, 30.0, 80.0, 10.0, 30.0, 40.0, 9.0, -2.0, 40.0, 17.0, 40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 20.0, 20.0, 28.0, 50.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 10.0, -14.0, 10.0, 80.0, 10.0, 10.0, 10.0, 0.0, 10.0, 27.0, 30.0, 30.0, 30.0, 19.0, 5.0, 70.0, 60.0, 6.0, 50.0, 60.0, 40.0, 40.0, 60.0, 70.0, 10.0, -15.0, 45.0, 80.0, 60.0, 25.0, 10.0, 40.0, 50.0, 20.0, 60.0, 30.0, 10.0, 10.0, 60.0, 30.0, 70.0, 90.0, 60.0, 60.0, 60.0, 50.0, 10.0, 60.0, 80.0, 40.0, 70.0, 5.0, 40.0, 30.0, 54.0, 6.0, 40.0, 79.0, 25.0, -183.0, 110.0, 20.0, 10.0, 70.0, 80.0, 39.0, 10.0, 19.0, 20.0, 10.0, 70.0, 20.0, 41.0, 40.0, 40.0, 0.0, 10.0, 50.0, 70.0, 1.0, 20.0, 9.0, 40.0, 60.0, 10.0, 30.0, 60.0, 40.0, 40.0, 80.0, 28.0, -21.0, 0.0, -17.0, 20.0, 50.0, 13.0, 18.0, 30.0, 60.0, 20.0, 60.0, 20.0, 70.0, 30.0, 40.0, 0.0, 70.0, 14.0, 50.0, 40.0, 20.0, 40.0, 20.0, 40.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 20.0, 60.0, 90.0, 40.0, 50.0, 35.0, 20.0, 60.0, 40.0, 60.0, 30.0, 40.0, 10.0, 40.0, 20.0, 30.0, 130.0, 30.0, 20.0, 50.0, 60.0, 37.0, 30.0, 40.0, 90.0, 50.0, 20.0, 39.0, 90.0, 50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0, 110.0, 50.0, 20.0, 70.0, 40.0, 30.0, 40.0, 4.0, 50.0, 80.0, 10.0, 40.0, 10.0, 40.0, 37.0, 30.0, 50.0, 50.0, 80.0, 90.0, 30.0, 80.0, 20.0, 20.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 22.0, 30.0, 110.0, 9.0, 50.0, 60.0, 50.0, 60.0, 50.0, 20.0, 50.0, 50.0, 50.0, 90.0, 170.0, 50.0, 60.0, 20.0, 50.0, 60.0, 90.0, 50.0, 40.0, 50.0, 130.0, 20.0, 50.0, 20.0, 17.0, 6.0, 30.0, 15.0, 60.0, 50.0, 40.0, 50.0, 60.0, 20.0, 80.0, 0.0, 148.0, 60.0, 20.0, 30.0, 10.0, 0.0, 37.0, 30.0, 10.0, 39.0, 50.0, 100.0, 60.0, 40.0, 0.0, 40.0, 20.0, -1.0, 30.0, 70.0, 20.0, 40.0, 20.0, 20.0, 10.0, 80.0, 60.0, 60.0, 0.0, 50.0, 60.0, 50.0, 70.0, 35.0, 60.0, 70.0, 40.0, 50.0, 63.0, 23.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 30.0, 56.0, 50.0, 60.0, 0.0, 90.0, 85.0, 40.0, 80.0, 40.0, 80.0, 50.0, 20.0, 10.0, 70.0, 50.0, 0.0, 50.0, 100.0, 7.0, 50.0, 60.0, 89.0, 31.0, 58.0, -49.0, 49.0, -10.0, 90.0, 20.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 60.0, 50.0, 30.0, 50.0, 20.0, 20.0, 20.0, 49.0, 70.0, 60.0, 20.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.687087057495401, "mean_inference_ms": 1.7429574367734733, "mean_action_processing_ms": 0.5489626974956325, "mean_env_wait_ms": 1.5171674752793893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012079238891601562, "StateBufferConnector_ms": 0.010961771011352539, "ViewRequirementAgentConnector_ms": 0.3957381248474121}, "num_episodes": 18, "episode_return_max": 650.0, "episode_return_min": 88.0, "episode_return_mean": 340.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.675725522683294, "num_env_steps_trained_throughput_per_sec": 21.675725522683294, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 184478.696, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184478.649, "sample_time_ms": 2464.209, "learn_time_ms": 181995.664, "learn_throughput": 21.979, "synch_weights_time_ms": 10.69}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "a22d3_00000", "date": "2024-08-06_01-31-26", "timestamp": 1722922286, "time_this_iter_s": 184.56766295433044, "time_total_s": 10078.50069475174, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a03a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10078.50069475174, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.66130268199234, "ram_util_percent": 78.227969348659}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7397360743044286, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.641281494825158, "policy_loss": -0.010224529667866552, "vf_loss": 4.649765827759894, "vf_explained_var": 0.009514919586709768, "kl": 0.008700981746023637, "entropy": 0.8335987324912708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 650.0, "episode_reward_min": 88.0, "episode_reward_mean": 346.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -183.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 34.679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [502.0, 330.0, 347.0, 325.0, 365.0, 300.0, 204.0, 390.0, 420.0, 325.0, 480.0, 225.0, 338.0, 420.0, 545.0, 208.0, 305.0, 320.0, 317.0, 197.0, 234.0, 377.0, 366.0, 298.0, 207.0, 355.0, 282.0, 210.0, 218.0, 340.0, 230.0, 378.0, 250.0, 189.0, 300.0, 334.0, 207.0, 170.0, 333.0, 88.0, 223.0, 370.0, 552.0, 340.0, 282.0, 264.0, 318.0, 170.0, 153.0, 360.0, 415.0, 320.0, 580.0, 166.0, 388.0, 342.0, 389.0, 181.0, 374.0, 370.0, 445.0, 410.0, 506.0, 470.0, 494.0, 437.0, 330.0, 461.0, 650.0, 473.0, 405.0, 384.0, 409.0, 360.0, 521.0, 150.0, 551.0, 470.0, 375.0, 270.0, 379.0, 330.0, 350.0, 370.0, 298.0, 647.0, 440.0, 249.0, 315.0, 528.0, 403.0, 240.0, 420.0, 270.0, 256.0, 530.0, 207.0, 329.0, 421.0, 340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 26.0, 100.0, 100.0, 40.0, -4.0, 100.0, 50.0, 60.0, 10.0, 50.0, 50.0, 10.0, 30.0, 50.0, 10.0, 50.0, 10.0, 60.0, 30.0, 20.0, 29.0, 50.0, 20.0, 50.0, 20.0, 60.0, 18.0, 50.0, 40.0, 40.0, 20.0, 15.0, 30.0, 30.0, 50.0, 20.0, 10.0, 70.0, 50.0, 20.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 40.0, 45.0, 50.0, 20.0, 0.0, 40.0, 70.0, 20.0, 30.0, 25.0, 15.0, 30.0, 20.0, 40.0, 0.0, -4.0, 18.0, 30.0, 20.0, 40.0, 40.0, 0.0, 20.0, 10.0, 60.0, 40.0, 20.0, 10.0, 40.0, 80.0, 60.0, 50.0, 60.0, 20.0, 30.0, 70.0, 40.0, 20.0, 40.0, 40.0, 50.0, 50.0, 40.0, 20.0, 0.0, 28.0, 80.0, 10.0, 50.0, 7.0, 40.0, 50.0, 30.0, 40.0, 40.0, 80.0, 80.0, 50.0, 10.0, 80.0, 30.0, 40.0, 20.0, 15.0, 0.0, 30.0, 20.0, 50.0, 10.0, 50.0, 10.0, 20.0, 20.0, 30.0, 20.0, 69.0, 60.0, 20.0, 20.0, 40.0, 9.0, 50.0, 60.0, 40.0, 50.0, 50.0, 40.0, 20.0, 20.0, 40.0, 50.0, 50.0, 45.0, 40.0, 100.0, 70.0, 30.0, 30.0, 30.0, 60.0, 50.0, 90.0, -5.0, 20.0, 8.0, 80.0, 19.0, 17.0, 20.0, -1.0, 20.0, 30.0, 10.0, 60.0, 30.0, 10.0, 40.0, 50.0, 25.0, 30.0, 40.0, 10.0, 50.0, 20.0, 60.0, 30.0, 10.0, 20.0, 30.0, 40.0, 40.0, 20.0, 20.0, 10.0, 40.0, 80.0, 29.0, 30.0, 60.0, 29.0, 9.0, 10.0, -1.0, 10.0, 69.0, 10.0, 20.0, 40.0, 40.0, 10.0, -1.0, 0.0, 50.0, 40.0, 20.0, 19.0, 5.0, 0.0, 50.0, -10.0, 20.0, 40.0, 20.0, 20.0, 90.0, 28.0, 90.0, 10.0, 20.0, 20.0, 19.0, 60.0, 38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0, 30.0, -1.0, 60.0, 30.0, 10.0, 40.0, 70.0, 9.0, 10.0, 40.0, 60.0, 20.0, 50.0, 24.0, 8.0, -12.0, 10.0, 20.0, 17.0, 10.0, 5.0, 30.0, -16.0, 40.0, 28.0, 50.0, 68.0, 50.0, 30.0, 70.0, 9.0, 0.0, 19.0, 6.0, 50.0, 30.0, 48.0, 30.0, 90.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 20.0, 50.0, 9.0, 39.0, 0.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 60.0, 90.0, 30.0, 30.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 40.0, 50.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 70.0, 20.0, 20.0, 50.0, 80.0, 30.0, 48.0, 20.0, 30.0, 60.0, 30.0, -8.0, 8.0, 0.0, 50.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 70.0, 14.0, 40.0, 0.0, 7.0, 20.0, -12.0, -25.0, 60.0, -1.0, 4.0, -5.0, 20.0, 44.0, 149.0, 26.0, 28.0, 30.0, 20.0, 90.0, 1.0, 30.0, 40.0, 30.0, 50.0, 20.0, 23.0, 30.0, 0.0, 60.0, 0.0, 60.0, 10.0, 10.0, 8.0, 10.0, 19.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 20.0, 0.0, 20.0, 20.0, 50.0, -5.0, 30.0, 23.0, 2.0, 70.0, 3.0, 60.0, 20.0, 80.0, 0.0, 0.0, 0.0, 20.0, 23.0, -4.0, 10.0, 10.0, 10.0, 19.0, 15.0, 30.0, 75.0, 23.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 80.0, 60.0, 70.0, -40.0, 60.0, 70.0, 10.0, 110.0, 92.0, 50.0, 70.0, 10.0, 20.0, 40.0, 20.0, 80.0, 20.0, 10.0, 20.0, 28.0, 30.0, 80.0, 10.0, 30.0, 40.0, 9.0, -2.0, 40.0, 17.0, 40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 20.0, 20.0, 28.0, 50.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 10.0, -14.0, 10.0, 80.0, 10.0, 10.0, 10.0, 0.0, 10.0, 27.0, 30.0, 30.0, 30.0, 19.0, 5.0, 70.0, 60.0, 6.0, 50.0, 60.0, 40.0, 40.0, 60.0, 70.0, 10.0, -15.0, 45.0, 80.0, 60.0, 25.0, 10.0, 40.0, 50.0, 20.0, 60.0, 30.0, 10.0, 10.0, 60.0, 30.0, 70.0, 90.0, 60.0, 60.0, 60.0, 50.0, 10.0, 60.0, 80.0, 40.0, 70.0, 5.0, 40.0, 30.0, 54.0, 6.0, 40.0, 79.0, 25.0, -183.0, 110.0, 20.0, 10.0, 70.0, 80.0, 39.0, 10.0, 19.0, 20.0, 10.0, 70.0, 20.0, 41.0, 40.0, 40.0, 0.0, 10.0, 50.0, 70.0, 1.0, 20.0, 9.0, 40.0, 60.0, 10.0, 30.0, 60.0, 40.0, 40.0, 80.0, 28.0, -21.0, 0.0, -17.0, 20.0, 50.0, 13.0, 18.0, 30.0, 60.0, 20.0, 60.0, 20.0, 70.0, 30.0, 40.0, 0.0, 70.0, 14.0, 50.0, 40.0, 20.0, 40.0, 20.0, 40.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 20.0, 60.0, 90.0, 40.0, 50.0, 35.0, 20.0, 60.0, 40.0, 60.0, 30.0, 40.0, 10.0, 40.0, 20.0, 30.0, 130.0, 30.0, 20.0, 50.0, 60.0, 37.0, 30.0, 40.0, 90.0, 50.0, 20.0, 39.0, 90.0, 50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0, 110.0, 50.0, 20.0, 70.0, 40.0, 30.0, 40.0, 4.0, 50.0, 80.0, 10.0, 40.0, 10.0, 40.0, 37.0, 30.0, 50.0, 50.0, 80.0, 90.0, 30.0, 80.0, 20.0, 20.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 22.0, 30.0, 110.0, 9.0, 50.0, 60.0, 50.0, 60.0, 50.0, 20.0, 50.0, 50.0, 50.0, 90.0, 170.0, 50.0, 60.0, 20.0, 50.0, 60.0, 90.0, 50.0, 40.0, 50.0, 130.0, 20.0, 50.0, 20.0, 17.0, 6.0, 30.0, 15.0, 60.0, 50.0, 40.0, 50.0, 60.0, 20.0, 80.0, 0.0, 148.0, 60.0, 20.0, 30.0, 10.0, 0.0, 37.0, 30.0, 10.0, 39.0, 50.0, 100.0, 60.0, 40.0, 0.0, 40.0, 20.0, -1.0, 30.0, 70.0, 20.0, 40.0, 20.0, 20.0, 10.0, 80.0, 60.0, 60.0, 0.0, 50.0, 60.0, 50.0, 70.0, 35.0, 60.0, 70.0, 40.0, 50.0, 63.0, 23.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 30.0, 56.0, 50.0, 60.0, 0.0, 90.0, 85.0, 40.0, 80.0, 40.0, 80.0, 50.0, 20.0, 10.0, 70.0, 50.0, 0.0, 50.0, 100.0, 7.0, 50.0, 60.0, 89.0, 31.0, 58.0, -49.0, 49.0, -10.0, 90.0, 20.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 60.0, 50.0, 30.0, 50.0, 20.0, 20.0, 20.0, 49.0, 70.0, 60.0, 20.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 50.0, 20.0, 40.0, 50.0, 30.0, 60.0, 20.0, 20.0, 40.0, 20.0, 70.0, 30.0, 20.0, 40.0, 40.0, 60.0, 30.0, 30.0, -1.0, 10.0, 119.0, 0.0, 40.0, 40.0, 40.0, 20.0, 0.0, 60.0, 50.0, 50.0, 130.0, 0.0, 60.0, 100.0, 30.0, 107.0, 60.0, 50.0, 60.0, 30.0, 30.0, 30.0, 90.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 29.0, 0.0, 80.0, 10.0, 20.0, 80.0, 50.0, 30.0, 70.0, -5.0, 20.0, 20.0, 20.0, 110.0, 70.0, -55.0, 60.0, 110.0, 70.0, 50.0, 36.0, 47.0, 30.0, 60.0, 10.0, 50.0, 47.0, 98.0, 10.0, 30.0, 0.0, 50.0, 48.0, 20.0, 20.0, 50.0, 20.0, 10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 70.0, 40.0, 10.0, 70.0, 70.0, 30.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 100.0, 30.0, 20.0, 40.0, 80.0, 30.0, -21.0, 10.0, 40.0, 60.0, 19.0, -11.0, 39.0, 10.0, 50.0, 50.0, 70.0, -30.0, 97.0, 40.0, 110.0, 43.0, 40.0, 60.0, 22.0, 6.0, 2.0, 10.0, 17.0, 60.0, 10.0, 50.0, 0.0, 30.0, 50.0, 10.0, 9.0, 30.0, 30.0, 40.0, 50.0, 30.0, 60.0, 20.0, 0.0, 21.0, 10.0, 100.0, 70.0, 50.0, 50.0, 40.0, 20.0, 60.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6833758013018534, "mean_inference_ms": 1.7372786471878607, "mean_action_processing_ms": 0.5470018087382615, "mean_env_wait_ms": 1.5123798856161554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012060165405273438, "StateBufferConnector_ms": 0.010957717895507812, "ViewRequirementAgentConnector_ms": 0.4000999927520752}, "num_episodes": 18, "episode_return_max": 650.0, "episode_return_min": 88.0, "episode_return_mean": 346.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.66056197079682, "num_env_steps_trained_throughput_per_sec": 21.66056197079682, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 184473.123, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184473.075, "sample_time_ms": 2468.169, "learn_time_ms": 181986.078, "learn_throughput": 21.98, "synch_weights_time_ms": 10.607}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "a22d3_00000", "date": "2024-08-06_01-34-31", "timestamp": 1722922471, "time_this_iter_s": 184.675518989563, "time_total_s": 10263.176213741302, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a139e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10263.176213741302, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.860919540229883, "ram_util_percent": 78.5536398467433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9352099391726005, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.546936875156447, "policy_loss": -0.009013813971819532, "vf_loss": 4.554298181808033, "vf_explained_var": 0.005524789918852817, "kl": 0.008262527364778564, "entropy": 0.8324957877683182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 650.0, "episode_reward_min": 88.0, "episode_reward_mean": 357.84, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -183.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 35.784}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 298.0, 207.0, 355.0, 282.0, 210.0, 218.0, 340.0, 230.0, 378.0, 250.0, 189.0, 300.0, 334.0, 207.0, 170.0, 333.0, 88.0, 223.0, 370.0, 552.0, 340.0, 282.0, 264.0, 318.0, 170.0, 153.0, 360.0, 415.0, 320.0, 580.0, 166.0, 388.0, 342.0, 389.0, 181.0, 374.0, 370.0, 445.0, 410.0, 506.0, 470.0, 494.0, 437.0, 330.0, 461.0, 650.0, 473.0, 405.0, 384.0, 409.0, 360.0, 521.0, 150.0, 551.0, 470.0, 375.0, 270.0, 379.0, 330.0, 350.0, 370.0, 298.0, 647.0, 440.0, 249.0, 315.0, 528.0, 403.0, 240.0, 420.0, 270.0, 256.0, 530.0, 207.0, 329.0, 421.0, 340.0, 319.0, 380.0, 189.0, 420.0, 570.0, 468.0, 430.0, 222.0, 434.0, 376.0, 290.0, 349.0, 317.0, 450.0, 369.0, 330.0, 310.0, 320.0, 470.0, 537.0, 559.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [38.0, 28.0, 40.0, 20.0, 80.0, 20.0, 50.0, 20.0, 50.0, 20.0, 30.0, -1.0, 60.0, 30.0, 10.0, 40.0, 70.0, 9.0, 10.0, 40.0, 60.0, 20.0, 50.0, 24.0, 8.0, -12.0, 10.0, 20.0, 17.0, 10.0, 5.0, 30.0, -16.0, 40.0, 28.0, 50.0, 68.0, 50.0, 30.0, 70.0, 9.0, 0.0, 19.0, 6.0, 50.0, 30.0, 48.0, 30.0, 90.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 0.0, 80.0, 20.0, 50.0, 9.0, 39.0, 0.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 60.0, 90.0, 30.0, 30.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 40.0, 50.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 70.0, 20.0, 20.0, 50.0, 80.0, 30.0, 48.0, 20.0, 30.0, 60.0, 30.0, -8.0, 8.0, 0.0, 50.0, 30.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 70.0, 14.0, 40.0, 0.0, 7.0, 20.0, -12.0, -25.0, 60.0, -1.0, 4.0, -5.0, 20.0, 44.0, 149.0, 26.0, 28.0, 30.0, 20.0, 90.0, 1.0, 30.0, 40.0, 30.0, 50.0, 20.0, 23.0, 30.0, 0.0, 60.0, 0.0, 60.0, 10.0, 10.0, 8.0, 10.0, 19.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 20.0, 0.0, 20.0, 20.0, 50.0, -5.0, 30.0, 23.0, 2.0, 70.0, 3.0, 60.0, 20.0, 80.0, 0.0, 0.0, 0.0, 20.0, 23.0, -4.0, 10.0, 10.0, 10.0, 19.0, 15.0, 30.0, 75.0, 23.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 60.0, 20.0, 40.0, 20.0, 20.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 80.0, 60.0, 70.0, -40.0, 60.0, 70.0, 10.0, 110.0, 92.0, 50.0, 70.0, 10.0, 20.0, 40.0, 20.0, 80.0, 20.0, 10.0, 20.0, 28.0, 30.0, 80.0, 10.0, 30.0, 40.0, 9.0, -2.0, 40.0, 17.0, 40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 20.0, 20.0, 28.0, 50.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 10.0, -14.0, 10.0, 80.0, 10.0, 10.0, 10.0, 0.0, 10.0, 27.0, 30.0, 30.0, 30.0, 19.0, 5.0, 70.0, 60.0, 6.0, 50.0, 60.0, 40.0, 40.0, 60.0, 70.0, 10.0, -15.0, 45.0, 80.0, 60.0, 25.0, 10.0, 40.0, 50.0, 20.0, 60.0, 30.0, 10.0, 10.0, 60.0, 30.0, 70.0, 90.0, 60.0, 60.0, 60.0, 50.0, 10.0, 60.0, 80.0, 40.0, 70.0, 5.0, 40.0, 30.0, 54.0, 6.0, 40.0, 79.0, 25.0, -183.0, 110.0, 20.0, 10.0, 70.0, 80.0, 39.0, 10.0, 19.0, 20.0, 10.0, 70.0, 20.0, 41.0, 40.0, 40.0, 0.0, 10.0, 50.0, 70.0, 1.0, 20.0, 9.0, 40.0, 60.0, 10.0, 30.0, 60.0, 40.0, 40.0, 80.0, 28.0, -21.0, 0.0, -17.0, 20.0, 50.0, 13.0, 18.0, 30.0, 60.0, 20.0, 60.0, 20.0, 70.0, 30.0, 40.0, 0.0, 70.0, 14.0, 50.0, 40.0, 20.0, 40.0, 20.0, 40.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 20.0, 60.0, 90.0, 40.0, 50.0, 35.0, 20.0, 60.0, 40.0, 60.0, 30.0, 40.0, 10.0, 40.0, 20.0, 30.0, 130.0, 30.0, 20.0, 50.0, 60.0, 37.0, 30.0, 40.0, 90.0, 50.0, 20.0, 39.0, 90.0, 50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0, 110.0, 50.0, 20.0, 70.0, 40.0, 30.0, 40.0, 4.0, 50.0, 80.0, 10.0, 40.0, 10.0, 40.0, 37.0, 30.0, 50.0, 50.0, 80.0, 90.0, 30.0, 80.0, 20.0, 20.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 22.0, 30.0, 110.0, 9.0, 50.0, 60.0, 50.0, 60.0, 50.0, 20.0, 50.0, 50.0, 50.0, 90.0, 170.0, 50.0, 60.0, 20.0, 50.0, 60.0, 90.0, 50.0, 40.0, 50.0, 130.0, 20.0, 50.0, 20.0, 17.0, 6.0, 30.0, 15.0, 60.0, 50.0, 40.0, 50.0, 60.0, 20.0, 80.0, 0.0, 148.0, 60.0, 20.0, 30.0, 10.0, 0.0, 37.0, 30.0, 10.0, 39.0, 50.0, 100.0, 60.0, 40.0, 0.0, 40.0, 20.0, -1.0, 30.0, 70.0, 20.0, 40.0, 20.0, 20.0, 10.0, 80.0, 60.0, 60.0, 0.0, 50.0, 60.0, 50.0, 70.0, 35.0, 60.0, 70.0, 40.0, 50.0, 63.0, 23.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 30.0, 56.0, 50.0, 60.0, 0.0, 90.0, 85.0, 40.0, 80.0, 40.0, 80.0, 50.0, 20.0, 10.0, 70.0, 50.0, 0.0, 50.0, 100.0, 7.0, 50.0, 60.0, 89.0, 31.0, 58.0, -49.0, 49.0, -10.0, 90.0, 20.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 60.0, 50.0, 30.0, 50.0, 20.0, 20.0, 20.0, 49.0, 70.0, 60.0, 20.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 50.0, 20.0, 40.0, 50.0, 30.0, 60.0, 20.0, 20.0, 40.0, 20.0, 70.0, 30.0, 20.0, 40.0, 40.0, 60.0, 30.0, 30.0, -1.0, 10.0, 119.0, 0.0, 40.0, 40.0, 40.0, 20.0, 0.0, 60.0, 50.0, 50.0, 130.0, 0.0, 60.0, 100.0, 30.0, 107.0, 60.0, 50.0, 60.0, 30.0, 30.0, 30.0, 90.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 29.0, 0.0, 80.0, 10.0, 20.0, 80.0, 50.0, 30.0, 70.0, -5.0, 20.0, 20.0, 20.0, 110.0, 70.0, -55.0, 60.0, 110.0, 70.0, 50.0, 36.0, 47.0, 30.0, 60.0, 10.0, 50.0, 47.0, 98.0, 10.0, 30.0, 0.0, 50.0, 48.0, 20.0, 20.0, 50.0, 20.0, 10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 70.0, 40.0, 10.0, 70.0, 70.0, 30.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 100.0, 30.0, 20.0, 40.0, 80.0, 30.0, -21.0, 10.0, 40.0, 60.0, 19.0, -11.0, 39.0, 10.0, 50.0, 50.0, 70.0, -30.0, 97.0, 40.0, 110.0, 43.0, 40.0, 60.0, 22.0, 6.0, 2.0, 10.0, 17.0, 60.0, 10.0, 50.0, 0.0, 30.0, 50.0, 10.0, 9.0, 30.0, 30.0, 40.0, 50.0, 30.0, 60.0, 20.0, 0.0, 21.0, 10.0, 100.0, 70.0, 50.0, 50.0, 40.0, 20.0, 60.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0, 30.0, 17.0, 30.0, 50.0, 60.0, -5.0, 10.0, 19.0, 8.0, 100.0, 20.0, 30.0, 20.0, 30.0, 10.0, 50.0, 80.0, 20.0, 20.0, 100.0, 0.0, 10.0, 40.0, 10.0, 20.0, 29.0, 40.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 70.0, 0.0, 80.0, 30.0, 20.0, 50.0, 10.0, 40.0, 40.0, 80.0, 50.0, 40.0, 50.0, 80.0, 90.0, 40.0, 60.0, 50.0, 20.0, 40.0, 70.0, 70.0, 30.0, 30.0, 39.0, 19.0, 100.0, 70.0, 40.0, 30.0, 70.0, 30.0, 30.0, 20.0, 80.0, 40.0, 20.0, 7.0, 8.0, 19.0, 50.0, 40.0, 40.0, 29.0, 9.0, 20.0, 0.0, 80.0, 60.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 30.0, 24.0, 20.0, 38.0, 0.0, 70.0, 60.0, 10.0, 9.0, 29.0, 90.0, 50.0, 40.0, 30.0, 20.0, 20.0, 50.0, 30.0, 30.0, 10.0, 20.0, 40.0, 19.0, 40.0, 10.0, 40.0, 50.0, 20.0, 40.0, 60.0, 20.0, 50.0, 25.0, 9.0, 40.0, 40.0, 47.0, 10.0, 50.0, 40.0, 30.0, 26.0, 20.0, 50.0, 10.0, 40.0, 50.0, 50.0, 50.0, 60.0, 100.0, 20.0, 30.0, 30.0, 0.0, 50.0, 50.0, 40.0, 20.0, 39.0, 80.0, 30.0, 0.0, 30.0, 60.0, 90.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 80.0, 20.0, 20.0, 60.0, 10.0, 60.0, 10.0, 50.0, 23.0, 40.0, 0.0, 38.0, 60.0, 28.0, 40.0, 38.0, 23.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 60.0, 80.0, 60.0, 40.0, 60.0, 48.0, 9.0, 60.0, 110.0, 70.0, 30.0, 30.0, 80.0, 160.0, 10.0, 10.0, 10.0, 50.0, 100.0, 79.0, 50.0, 50.0, 40.0, 40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.67865512850623, "mean_inference_ms": 1.730718664215447, "mean_action_processing_ms": 0.5446760279824671, "mean_env_wait_ms": 1.5067687206822824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011959075927734375, "StateBufferConnector_ms": 0.009304046630859375, "ViewRequirementAgentConnector_ms": 0.3926236629486084}, "num_episodes": 22, "episode_return_max": 650.0, "episode_return_min": 88.0, "episode_return_mean": 357.84}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.54385192353469, "num_env_steps_trained_throughput_per_sec": 21.54385192353469, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 184628.154, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184628.106, "sample_time_ms": 2465.039, "learn_time_ms": 182144.042, "learn_throughput": 21.961, "synch_weights_time_ms": 10.78}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "a22d3_00000", "date": "2024-08-06_01-37-36", "timestamp": 1722922656, "time_this_iter_s": 185.67463779449463, "time_total_s": 10448.850851535797, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a139e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10448.850851535797, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 18.321673003802278, "ram_util_percent": 79.04790874524714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.897587770369614, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.931165499402819, "policy_loss": -0.010714570220204762, "vf_loss": 4.940169892295862, "vf_explained_var": 0.0009051785999720596, "kl": 0.008550907798855678, "entropy": 0.7933815250635401, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 650.0, "episode_reward_min": 133.0, "episode_reward_mean": 382.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -183.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 38.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [264.0, 318.0, 170.0, 153.0, 360.0, 415.0, 320.0, 580.0, 166.0, 388.0, 342.0, 389.0, 181.0, 374.0, 370.0, 445.0, 410.0, 506.0, 470.0, 494.0, 437.0, 330.0, 461.0, 650.0, 473.0, 405.0, 384.0, 409.0, 360.0, 521.0, 150.0, 551.0, 470.0, 375.0, 270.0, 379.0, 330.0, 350.0, 370.0, 298.0, 647.0, 440.0, 249.0, 315.0, 528.0, 403.0, 240.0, 420.0, 270.0, 256.0, 530.0, 207.0, 329.0, 421.0, 340.0, 319.0, 380.0, 189.0, 420.0, 570.0, 468.0, 430.0, 222.0, 434.0, 376.0, 290.0, 349.0, 317.0, 450.0, 369.0, 330.0, 310.0, 320.0, 470.0, 537.0, 559.0, 470.0, 420.0, 550.0, 635.0, 370.0, 389.0, 426.0, 376.0, 295.0, 251.0, 379.0, 350.0, 352.0, 350.0, 525.0, 320.0, 190.0, 380.0, 400.0, 500.0, 499.0, 133.0, 413.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 38.0, 60.0, 30.0, 30.0, 10.0, 27.0, 10.0, 9.0, 10.0, 50.0, 40.0, 10.0, 20.0, 20.0, 60.0, 20.0, 20.0, 28.0, 50.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 30.0, 30.0, 10.0, -14.0, 10.0, 80.0, 10.0, 10.0, 10.0, 0.0, 10.0, 27.0, 30.0, 30.0, 30.0, 19.0, 5.0, 70.0, 60.0, 6.0, 50.0, 60.0, 40.0, 40.0, 60.0, 70.0, 10.0, -15.0, 45.0, 80.0, 60.0, 25.0, 10.0, 40.0, 50.0, 20.0, 60.0, 30.0, 10.0, 10.0, 60.0, 30.0, 70.0, 90.0, 60.0, 60.0, 60.0, 50.0, 10.0, 60.0, 80.0, 40.0, 70.0, 5.0, 40.0, 30.0, 54.0, 6.0, 40.0, 79.0, 25.0, -183.0, 110.0, 20.0, 10.0, 70.0, 80.0, 39.0, 10.0, 19.0, 20.0, 10.0, 70.0, 20.0, 41.0, 40.0, 40.0, 0.0, 10.0, 50.0, 70.0, 1.0, 20.0, 9.0, 40.0, 60.0, 10.0, 30.0, 60.0, 40.0, 40.0, 80.0, 28.0, -21.0, 0.0, -17.0, 20.0, 50.0, 13.0, 18.0, 30.0, 60.0, 20.0, 60.0, 20.0, 70.0, 30.0, 40.0, 0.0, 70.0, 14.0, 50.0, 40.0, 20.0, 40.0, 20.0, 40.0, 30.0, 30.0, 60.0, 0.0, 90.0, 30.0, 20.0, 60.0, 90.0, 40.0, 50.0, 35.0, 20.0, 60.0, 40.0, 60.0, 30.0, 40.0, 10.0, 40.0, 20.0, 30.0, 130.0, 30.0, 20.0, 50.0, 60.0, 37.0, 30.0, 40.0, 90.0, 50.0, 20.0, 39.0, 90.0, 50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0, 110.0, 50.0, 20.0, 70.0, 40.0, 30.0, 40.0, 4.0, 50.0, 80.0, 10.0, 40.0, 10.0, 40.0, 37.0, 30.0, 50.0, 50.0, 80.0, 90.0, 30.0, 80.0, 20.0, 20.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 22.0, 30.0, 110.0, 9.0, 50.0, 60.0, 50.0, 60.0, 50.0, 20.0, 50.0, 50.0, 50.0, 90.0, 170.0, 50.0, 60.0, 20.0, 50.0, 60.0, 90.0, 50.0, 40.0, 50.0, 130.0, 20.0, 50.0, 20.0, 17.0, 6.0, 30.0, 15.0, 60.0, 50.0, 40.0, 50.0, 60.0, 20.0, 80.0, 0.0, 148.0, 60.0, 20.0, 30.0, 10.0, 0.0, 37.0, 30.0, 10.0, 39.0, 50.0, 100.0, 60.0, 40.0, 0.0, 40.0, 20.0, -1.0, 30.0, 70.0, 20.0, 40.0, 20.0, 20.0, 10.0, 80.0, 60.0, 60.0, 0.0, 50.0, 60.0, 50.0, 70.0, 35.0, 60.0, 70.0, 40.0, 50.0, 63.0, 23.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 30.0, 56.0, 50.0, 60.0, 0.0, 90.0, 85.0, 40.0, 80.0, 40.0, 80.0, 50.0, 20.0, 10.0, 70.0, 50.0, 0.0, 50.0, 100.0, 7.0, 50.0, 60.0, 89.0, 31.0, 58.0, -49.0, 49.0, -10.0, 90.0, 20.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 60.0, 50.0, 30.0, 50.0, 20.0, 20.0, 20.0, 49.0, 70.0, 60.0, 20.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 50.0, 20.0, 40.0, 50.0, 30.0, 60.0, 20.0, 20.0, 40.0, 20.0, 70.0, 30.0, 20.0, 40.0, 40.0, 60.0, 30.0, 30.0, -1.0, 10.0, 119.0, 0.0, 40.0, 40.0, 40.0, 20.0, 0.0, 60.0, 50.0, 50.0, 130.0, 0.0, 60.0, 100.0, 30.0, 107.0, 60.0, 50.0, 60.0, 30.0, 30.0, 30.0, 90.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 29.0, 0.0, 80.0, 10.0, 20.0, 80.0, 50.0, 30.0, 70.0, -5.0, 20.0, 20.0, 20.0, 110.0, 70.0, -55.0, 60.0, 110.0, 70.0, 50.0, 36.0, 47.0, 30.0, 60.0, 10.0, 50.0, 47.0, 98.0, 10.0, 30.0, 0.0, 50.0, 48.0, 20.0, 20.0, 50.0, 20.0, 10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 70.0, 40.0, 10.0, 70.0, 70.0, 30.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 100.0, 30.0, 20.0, 40.0, 80.0, 30.0, -21.0, 10.0, 40.0, 60.0, 19.0, -11.0, 39.0, 10.0, 50.0, 50.0, 70.0, -30.0, 97.0, 40.0, 110.0, 43.0, 40.0, 60.0, 22.0, 6.0, 2.0, 10.0, 17.0, 60.0, 10.0, 50.0, 0.0, 30.0, 50.0, 10.0, 9.0, 30.0, 30.0, 40.0, 50.0, 30.0, 60.0, 20.0, 0.0, 21.0, 10.0, 100.0, 70.0, 50.0, 50.0, 40.0, 20.0, 60.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0, 30.0, 17.0, 30.0, 50.0, 60.0, -5.0, 10.0, 19.0, 8.0, 100.0, 20.0, 30.0, 20.0, 30.0, 10.0, 50.0, 80.0, 20.0, 20.0, 100.0, 0.0, 10.0, 40.0, 10.0, 20.0, 29.0, 40.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 70.0, 0.0, 80.0, 30.0, 20.0, 50.0, 10.0, 40.0, 40.0, 80.0, 50.0, 40.0, 50.0, 80.0, 90.0, 40.0, 60.0, 50.0, 20.0, 40.0, 70.0, 70.0, 30.0, 30.0, 39.0, 19.0, 100.0, 70.0, 40.0, 30.0, 70.0, 30.0, 30.0, 20.0, 80.0, 40.0, 20.0, 7.0, 8.0, 19.0, 50.0, 40.0, 40.0, 29.0, 9.0, 20.0, 0.0, 80.0, 60.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 30.0, 24.0, 20.0, 38.0, 0.0, 70.0, 60.0, 10.0, 9.0, 29.0, 90.0, 50.0, 40.0, 30.0, 20.0, 20.0, 50.0, 30.0, 30.0, 10.0, 20.0, 40.0, 19.0, 40.0, 10.0, 40.0, 50.0, 20.0, 40.0, 60.0, 20.0, 50.0, 25.0, 9.0, 40.0, 40.0, 47.0, 10.0, 50.0, 40.0, 30.0, 26.0, 20.0, 50.0, 10.0, 40.0, 50.0, 50.0, 50.0, 60.0, 100.0, 20.0, 30.0, 30.0, 0.0, 50.0, 50.0, 40.0, 20.0, 39.0, 80.0, 30.0, 0.0, 30.0, 60.0, 90.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 80.0, 20.0, 20.0, 60.0, 10.0, 60.0, 10.0, 50.0, 23.0, 40.0, 0.0, 38.0, 60.0, 28.0, 40.0, 38.0, 23.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 60.0, 80.0, 60.0, 40.0, 60.0, 48.0, 9.0, 60.0, 110.0, 70.0, 30.0, 30.0, 80.0, 160.0, 10.0, 10.0, 10.0, 50.0, 100.0, 79.0, 50.0, 50.0, 40.0, 40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0, 70.0, 70.0, 17.0, 25.0, 20.0, 20.0, 60.0, 19.0, 30.0, 89.0, 60.0, 20.0, 50.0, 90.0, 50.0, 90.0, 30.0, 60.0, 90.0, 10.0, 60.0, 80.0, 85.0, 60.0, 30.0, 40.0, 80.0, 40.0, 80.0, 80.0, 40.0, 20.0, 30.0, 40.0, 60.0, 40.0, 20.0, 20.0, 40.0, 60.0, 29.0, 60.0, 90.0, 50.0, 20.0, 50.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 80.0, 8.0, 20.0, 68.0, 0.0, 70.0, 60.0, 37.0, 40.0, 50.0, 80.0, 30.0, 9.0, 20.0, 0.0, 50.0, 17.0, 50.0, 10.0, 19.0, 30.0, -1.0, 60.0, 30.0, 20.0, 60.0, 20.0, 16.0, 40.0, 0.0, 30.0, 40.0, 30.0, 35.0, 30.0, 10.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 40.0, 10.0, 29.0, 100.0, 40.0, 10.0, 40.0, 20.0, 40.0, 20.0, 60.0, 70.0, 50.0, 0.0, 40.0, 1.0, 12.0, 30.0, 58.0, 61.0, 30.0, 20.0, 40.0, 60.0, 20.0, 10.0, 70.0, 20.0, 50.0, 40.0, 40.0, 20.0, 40.0, 40.0, 80.0, -3.0, 70.0, 20.0, 80.0, 40.0, 48.0, 90.0, 30.0, 70.0, 41.0, 20.0, 60.0, 10.0, 30.0, 60.0, 30.0, 39.0, 20.0, 10.0, 40.0, 70.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 70.0, 30.0, 30.0, 0.0, 60.0, 30.0, 80.0, 40.0, 90.0, 40.0, 40.0, 40.0, 20.0, 40.0, 50.0, 0.0, 40.0, 30.0, 70.0, 20.0, 100.0, 10.0, 70.0, 30.0, 100.0, 50.0, 20.0, 50.0, 30.0, 50.0, 49.0, 50.0, 50.0, 50.0, 30.0, 80.0, 60.0, 10.0, 40.0, 40.0, 10.0, 8.0, 20.0, -2.0, 0.0, -3.0, 10.0, 30.0, 60.0, 60.0, 28.0, 50.0, 16.0, 80.0, 10.0, 60.0, 19.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.674296782704683, "mean_inference_ms": 1.7245457852987018, "mean_action_processing_ms": 0.5423751106216547, "mean_env_wait_ms": 1.5011751499559458, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011823892593383789, "StateBufferConnector_ms": 0.009241342544555664, "ViewRequirementAgentConnector_ms": 0.3896796703338623}, "num_episodes": 23, "episode_return_max": 650.0, "episode_return_min": 133.0, "episode_return_mean": 382.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.796205707366074, "num_env_steps_trained_throughput_per_sec": 21.796205707366074, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 184565.289, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184565.242, "sample_time_ms": 2518.262, "learn_time_ms": 182028.071, "learn_throughput": 21.975, "synch_weights_time_ms": 10.705}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "a22d3_00000", "date": "2024-08-06_01-40-40", "timestamp": 1722922840, "time_this_iter_s": 183.52696919441223, "time_total_s": 10632.37782073021, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a139eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10632.37782073021, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.953281853281855, "ram_util_percent": 78.14826254826254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.704302853428391, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.068900142970303, "policy_loss": -0.010210548771378664, "vf_loss": 5.077466847061222, "vf_explained_var": 0.0032500602693730394, "kl": 0.008219222083818655, "entropy": 0.7658292535140999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 650.0, "episode_reward_min": 133.0, "episode_reward_mean": 396.19, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 39.619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 494.0, 437.0, 330.0, 461.0, 650.0, 473.0, 405.0, 384.0, 409.0, 360.0, 521.0, 150.0, 551.0, 470.0, 375.0, 270.0, 379.0, 330.0, 350.0, 370.0, 298.0, 647.0, 440.0, 249.0, 315.0, 528.0, 403.0, 240.0, 420.0, 270.0, 256.0, 530.0, 207.0, 329.0, 421.0, 340.0, 319.0, 380.0, 189.0, 420.0, 570.0, 468.0, 430.0, 222.0, 434.0, 376.0, 290.0, 349.0, 317.0, 450.0, 369.0, 330.0, 310.0, 320.0, 470.0, 537.0, 559.0, 470.0, 420.0, 550.0, 635.0, 370.0, 389.0, 426.0, 376.0, 295.0, 251.0, 379.0, 350.0, 352.0, 350.0, 525.0, 320.0, 190.0, 380.0, 400.0, 500.0, 499.0, 133.0, 413.0, 440.0, 250.0, 573.0, 545.0, 405.0, 329.0, 387.0, 340.0, 592.0, 382.0, 600.0, 535.0, 340.0, 350.0, 440.0, 566.0, 181.0, 349.0, 401.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 30.0, 40.0, 40.0, 40.0, 50.0, 50.0, 60.0, 40.0, 70.0, 110.0, 50.0, 20.0, 70.0, 40.0, 30.0, 40.0, 4.0, 50.0, 80.0, 10.0, 40.0, 10.0, 40.0, 37.0, 30.0, 50.0, 50.0, 80.0, 90.0, 30.0, 80.0, 20.0, 20.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 22.0, 30.0, 110.0, 9.0, 50.0, 60.0, 50.0, 60.0, 50.0, 20.0, 50.0, 50.0, 50.0, 90.0, 170.0, 50.0, 60.0, 20.0, 50.0, 60.0, 90.0, 50.0, 40.0, 50.0, 130.0, 20.0, 50.0, 20.0, 17.0, 6.0, 30.0, 15.0, 60.0, 50.0, 40.0, 50.0, 60.0, 20.0, 80.0, 0.0, 148.0, 60.0, 20.0, 30.0, 10.0, 0.0, 37.0, 30.0, 10.0, 39.0, 50.0, 100.0, 60.0, 40.0, 0.0, 40.0, 20.0, -1.0, 30.0, 70.0, 20.0, 40.0, 20.0, 20.0, 10.0, 80.0, 60.0, 60.0, 0.0, 50.0, 60.0, 50.0, 70.0, 35.0, 60.0, 70.0, 40.0, 50.0, 63.0, 23.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 30.0, 56.0, 50.0, 60.0, 0.0, 90.0, 85.0, 40.0, 80.0, 40.0, 80.0, 50.0, 20.0, 10.0, 70.0, 50.0, 0.0, 50.0, 100.0, 7.0, 50.0, 60.0, 89.0, 31.0, 58.0, -49.0, 49.0, -10.0, 90.0, 20.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 60.0, 50.0, 30.0, 50.0, 20.0, 20.0, 20.0, 49.0, 70.0, 60.0, 20.0, 40.0, 10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 50.0, 20.0, 40.0, 50.0, 30.0, 60.0, 20.0, 20.0, 40.0, 20.0, 70.0, 30.0, 20.0, 40.0, 40.0, 60.0, 30.0, 30.0, -1.0, 10.0, 119.0, 0.0, 40.0, 40.0, 40.0, 20.0, 0.0, 60.0, 50.0, 50.0, 130.0, 0.0, 60.0, 100.0, 30.0, 107.0, 60.0, 50.0, 60.0, 30.0, 30.0, 30.0, 90.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 29.0, 0.0, 80.0, 10.0, 20.0, 80.0, 50.0, 30.0, 70.0, -5.0, 20.0, 20.0, 20.0, 110.0, 70.0, -55.0, 60.0, 110.0, 70.0, 50.0, 36.0, 47.0, 30.0, 60.0, 10.0, 50.0, 47.0, 98.0, 10.0, 30.0, 0.0, 50.0, 48.0, 20.0, 20.0, 50.0, 20.0, 10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 70.0, 40.0, 10.0, 70.0, 70.0, 30.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 100.0, 30.0, 20.0, 40.0, 80.0, 30.0, -21.0, 10.0, 40.0, 60.0, 19.0, -11.0, 39.0, 10.0, 50.0, 50.0, 70.0, -30.0, 97.0, 40.0, 110.0, 43.0, 40.0, 60.0, 22.0, 6.0, 2.0, 10.0, 17.0, 60.0, 10.0, 50.0, 0.0, 30.0, 50.0, 10.0, 9.0, 30.0, 30.0, 40.0, 50.0, 30.0, 60.0, 20.0, 0.0, 21.0, 10.0, 100.0, 70.0, 50.0, 50.0, 40.0, 20.0, 60.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0, 30.0, 17.0, 30.0, 50.0, 60.0, -5.0, 10.0, 19.0, 8.0, 100.0, 20.0, 30.0, 20.0, 30.0, 10.0, 50.0, 80.0, 20.0, 20.0, 100.0, 0.0, 10.0, 40.0, 10.0, 20.0, 29.0, 40.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 70.0, 0.0, 80.0, 30.0, 20.0, 50.0, 10.0, 40.0, 40.0, 80.0, 50.0, 40.0, 50.0, 80.0, 90.0, 40.0, 60.0, 50.0, 20.0, 40.0, 70.0, 70.0, 30.0, 30.0, 39.0, 19.0, 100.0, 70.0, 40.0, 30.0, 70.0, 30.0, 30.0, 20.0, 80.0, 40.0, 20.0, 7.0, 8.0, 19.0, 50.0, 40.0, 40.0, 29.0, 9.0, 20.0, 0.0, 80.0, 60.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 30.0, 24.0, 20.0, 38.0, 0.0, 70.0, 60.0, 10.0, 9.0, 29.0, 90.0, 50.0, 40.0, 30.0, 20.0, 20.0, 50.0, 30.0, 30.0, 10.0, 20.0, 40.0, 19.0, 40.0, 10.0, 40.0, 50.0, 20.0, 40.0, 60.0, 20.0, 50.0, 25.0, 9.0, 40.0, 40.0, 47.0, 10.0, 50.0, 40.0, 30.0, 26.0, 20.0, 50.0, 10.0, 40.0, 50.0, 50.0, 50.0, 60.0, 100.0, 20.0, 30.0, 30.0, 0.0, 50.0, 50.0, 40.0, 20.0, 39.0, 80.0, 30.0, 0.0, 30.0, 60.0, 90.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 80.0, 20.0, 20.0, 60.0, 10.0, 60.0, 10.0, 50.0, 23.0, 40.0, 0.0, 38.0, 60.0, 28.0, 40.0, 38.0, 23.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 60.0, 80.0, 60.0, 40.0, 60.0, 48.0, 9.0, 60.0, 110.0, 70.0, 30.0, 30.0, 80.0, 160.0, 10.0, 10.0, 10.0, 50.0, 100.0, 79.0, 50.0, 50.0, 40.0, 40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0, 70.0, 70.0, 17.0, 25.0, 20.0, 20.0, 60.0, 19.0, 30.0, 89.0, 60.0, 20.0, 50.0, 90.0, 50.0, 90.0, 30.0, 60.0, 90.0, 10.0, 60.0, 80.0, 85.0, 60.0, 30.0, 40.0, 80.0, 40.0, 80.0, 80.0, 40.0, 20.0, 30.0, 40.0, 60.0, 40.0, 20.0, 20.0, 40.0, 60.0, 29.0, 60.0, 90.0, 50.0, 20.0, 50.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 80.0, 8.0, 20.0, 68.0, 0.0, 70.0, 60.0, 37.0, 40.0, 50.0, 80.0, 30.0, 9.0, 20.0, 0.0, 50.0, 17.0, 50.0, 10.0, 19.0, 30.0, -1.0, 60.0, 30.0, 20.0, 60.0, 20.0, 16.0, 40.0, 0.0, 30.0, 40.0, 30.0, 35.0, 30.0, 10.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 40.0, 10.0, 29.0, 100.0, 40.0, 10.0, 40.0, 20.0, 40.0, 20.0, 60.0, 70.0, 50.0, 0.0, 40.0, 1.0, 12.0, 30.0, 58.0, 61.0, 30.0, 20.0, 40.0, 60.0, 20.0, 10.0, 70.0, 20.0, 50.0, 40.0, 40.0, 20.0, 40.0, 40.0, 80.0, -3.0, 70.0, 20.0, 80.0, 40.0, 48.0, 90.0, 30.0, 70.0, 41.0, 20.0, 60.0, 10.0, 30.0, 60.0, 30.0, 39.0, 20.0, 10.0, 40.0, 70.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 70.0, 30.0, 30.0, 0.0, 60.0, 30.0, 80.0, 40.0, 90.0, 40.0, 40.0, 40.0, 20.0, 40.0, 50.0, 0.0, 40.0, 30.0, 70.0, 20.0, 100.0, 10.0, 70.0, 30.0, 100.0, 50.0, 20.0, 50.0, 30.0, 50.0, 49.0, 50.0, 50.0, 50.0, 30.0, 80.0, 60.0, 10.0, 40.0, 40.0, 10.0, 8.0, 20.0, -2.0, 0.0, -3.0, 10.0, 30.0, 60.0, 60.0, 28.0, 50.0, 16.0, 80.0, 10.0, 60.0, 19.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0, 0.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 60.0, 38.0, 80.0, 80.0, 109.0, 50.0, 30.0, 50.0, 26.0, 60.0, 70.0, 50.0, 5.0, 70.0, 30.0, 20.0, 100.0, 70.0, 70.0, 4.0, 80.0, 60.0, 50.0, 20.0, 22.0, 30.0, 80.0, 49.0, 10.0, 30.0, 20.0, 20.0, 30.0, 80.0, 50.0, 30.0, 50.0, 10.0, 9.0, 30.0, 120.0, 40.0, 10.0, 27.0, 40.0, 30.0, 30.0, 20.0, 40.0, 15.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 80.0, -4.0, 39.0, 60.0, 61.0, 80.0, 40.0, 80.0, 40.0, 80.0, 30.0, 80.0, 41.0, 60.0, 20.0, 20.0, 30.0, 90.0, 30.0, 20.0, 2.0, 60.0, 50.0, 30.0, 70.0, 60.0, 50.0, 60.0, 90.0, 70.0, 60.0, 70.0, 40.0, 60.0, 60.0, 80.0, 70.0, 110.0, 5.0, 0.0, 70.0, 50.0, 30.0, 20.0, 80.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 30.0, 50.0, 0.0, 50.0, 140.0, 0.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 70.0, 40.0, 60.0, 60.0, 30.0, 60.0, 60.0, 29.0, 50.0, 80.0, 50.0, 40.0, 100.0, 60.0, 50.0, 47.0, 10.0, 18.0, 40.0, -3.0, 50.0, 10.0, 10.0, 20.0, 18.0, 8.0, 90.0, 30.0, 40.0, 30.0, 40.0, 20.0, 19.0, 10.0, 40.0, 30.0, 0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6710508305959837, "mean_inference_ms": 1.7201042610701989, "mean_action_processing_ms": 0.5406633488142145, "mean_env_wait_ms": 1.4969256911322817, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01180720329284668, "StateBufferConnector_ms": 0.009164810180664062, "ViewRequirementAgentConnector_ms": 0.39046263694763184}, "num_episodes": 18, "episode_return_max": 650.0, "episode_return_min": 133.0, "episode_return_mean": 396.19}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.624734433551165, "num_env_steps_trained_throughput_per_sec": 21.624734433551165, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 184645.039, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184644.99, "sample_time_ms": 2514.254, "learn_time_ms": 182111.973, "learn_throughput": 21.965, "synch_weights_time_ms": 10.575}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "a22d3_00000", "date": "2024-08-06_01-43-45", "timestamp": 1722923025, "time_this_iter_s": 184.9808111190796, "time_total_s": 10817.358631849289, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a01b9dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10817.358631849289, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.498091603053435, "ram_util_percent": 77.6854961832061}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7985212444116514, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.085346821626535, "policy_loss": -0.010308187303065866, "vf_loss": 5.0940177807538785, "vf_explained_var": 0.004141609445293617, "kl": 0.008186169840247249, "entropy": 0.773016091613089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 647.0, "episode_reward_min": 133.0, "episode_reward_mean": 392.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 39.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 350.0, 370.0, 298.0, 647.0, 440.0, 249.0, 315.0, 528.0, 403.0, 240.0, 420.0, 270.0, 256.0, 530.0, 207.0, 329.0, 421.0, 340.0, 319.0, 380.0, 189.0, 420.0, 570.0, 468.0, 430.0, 222.0, 434.0, 376.0, 290.0, 349.0, 317.0, 450.0, 369.0, 330.0, 310.0, 320.0, 470.0, 537.0, 559.0, 470.0, 420.0, 550.0, 635.0, 370.0, 389.0, 426.0, 376.0, 295.0, 251.0, 379.0, 350.0, 352.0, 350.0, 525.0, 320.0, 190.0, 380.0, 400.0, 500.0, 499.0, 133.0, 413.0, 440.0, 250.0, 573.0, 545.0, 405.0, 329.0, 387.0, 340.0, 592.0, 382.0, 600.0, 535.0, 340.0, 350.0, 440.0, 566.0, 181.0, 349.0, 401.0, 400.0, 285.0, 520.0, 369.0, 460.0, 310.0, 517.0, 380.0, 446.0, 319.0, 579.0, 316.0, 238.0, 371.0, 620.0, 322.0, 403.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 20.0, 90.0, 40.0, 90.0, 20.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 50.0, 20.0, 40.0, 50.0, 30.0, 60.0, 20.0, 20.0, 40.0, 20.0, 70.0, 30.0, 20.0, 40.0, 40.0, 60.0, 30.0, 30.0, -1.0, 10.0, 119.0, 0.0, 40.0, 40.0, 40.0, 20.0, 0.0, 60.0, 50.0, 50.0, 130.0, 0.0, 60.0, 100.0, 30.0, 107.0, 60.0, 50.0, 60.0, 30.0, 30.0, 30.0, 90.0, 40.0, 10.0, 60.0, 40.0, 10.0, 30.0, 20.0, 10.0, 0.0, 40.0, 30.0, 29.0, 0.0, 80.0, 10.0, 20.0, 80.0, 50.0, 30.0, 70.0, -5.0, 20.0, 20.0, 20.0, 110.0, 70.0, -55.0, 60.0, 110.0, 70.0, 50.0, 36.0, 47.0, 30.0, 60.0, 10.0, 50.0, 47.0, 98.0, 10.0, 30.0, 0.0, 50.0, 48.0, 20.0, 20.0, 50.0, 20.0, 10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 70.0, 40.0, 10.0, 70.0, 70.0, 30.0, 40.0, 70.0, 0.0, 20.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 100.0, 30.0, 20.0, 40.0, 80.0, 30.0, -21.0, 10.0, 40.0, 60.0, 19.0, -11.0, 39.0, 10.0, 50.0, 50.0, 70.0, -30.0, 97.0, 40.0, 110.0, 43.0, 40.0, 60.0, 22.0, 6.0, 2.0, 10.0, 17.0, 60.0, 10.0, 50.0, 0.0, 30.0, 50.0, 10.0, 9.0, 30.0, 30.0, 40.0, 50.0, 30.0, 60.0, 20.0, 0.0, 21.0, 10.0, 100.0, 70.0, 50.0, 50.0, 40.0, 20.0, 60.0, 10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0, 30.0, 17.0, 30.0, 50.0, 60.0, -5.0, 10.0, 19.0, 8.0, 100.0, 20.0, 30.0, 20.0, 30.0, 10.0, 50.0, 80.0, 20.0, 20.0, 100.0, 0.0, 10.0, 40.0, 10.0, 20.0, 29.0, 40.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 70.0, 0.0, 80.0, 30.0, 20.0, 50.0, 10.0, 40.0, 40.0, 80.0, 50.0, 40.0, 50.0, 80.0, 90.0, 40.0, 60.0, 50.0, 20.0, 40.0, 70.0, 70.0, 30.0, 30.0, 39.0, 19.0, 100.0, 70.0, 40.0, 30.0, 70.0, 30.0, 30.0, 20.0, 80.0, 40.0, 20.0, 7.0, 8.0, 19.0, 50.0, 40.0, 40.0, 29.0, 9.0, 20.0, 0.0, 80.0, 60.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 30.0, 24.0, 20.0, 38.0, 0.0, 70.0, 60.0, 10.0, 9.0, 29.0, 90.0, 50.0, 40.0, 30.0, 20.0, 20.0, 50.0, 30.0, 30.0, 10.0, 20.0, 40.0, 19.0, 40.0, 10.0, 40.0, 50.0, 20.0, 40.0, 60.0, 20.0, 50.0, 25.0, 9.0, 40.0, 40.0, 47.0, 10.0, 50.0, 40.0, 30.0, 26.0, 20.0, 50.0, 10.0, 40.0, 50.0, 50.0, 50.0, 60.0, 100.0, 20.0, 30.0, 30.0, 0.0, 50.0, 50.0, 40.0, 20.0, 39.0, 80.0, 30.0, 0.0, 30.0, 60.0, 90.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 80.0, 20.0, 20.0, 60.0, 10.0, 60.0, 10.0, 50.0, 23.0, 40.0, 0.0, 38.0, 60.0, 28.0, 40.0, 38.0, 23.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 60.0, 80.0, 60.0, 40.0, 60.0, 48.0, 9.0, 60.0, 110.0, 70.0, 30.0, 30.0, 80.0, 160.0, 10.0, 10.0, 10.0, 50.0, 100.0, 79.0, 50.0, 50.0, 40.0, 40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0, 70.0, 70.0, 17.0, 25.0, 20.0, 20.0, 60.0, 19.0, 30.0, 89.0, 60.0, 20.0, 50.0, 90.0, 50.0, 90.0, 30.0, 60.0, 90.0, 10.0, 60.0, 80.0, 85.0, 60.0, 30.0, 40.0, 80.0, 40.0, 80.0, 80.0, 40.0, 20.0, 30.0, 40.0, 60.0, 40.0, 20.0, 20.0, 40.0, 60.0, 29.0, 60.0, 90.0, 50.0, 20.0, 50.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 80.0, 8.0, 20.0, 68.0, 0.0, 70.0, 60.0, 37.0, 40.0, 50.0, 80.0, 30.0, 9.0, 20.0, 0.0, 50.0, 17.0, 50.0, 10.0, 19.0, 30.0, -1.0, 60.0, 30.0, 20.0, 60.0, 20.0, 16.0, 40.0, 0.0, 30.0, 40.0, 30.0, 35.0, 30.0, 10.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 40.0, 10.0, 29.0, 100.0, 40.0, 10.0, 40.0, 20.0, 40.0, 20.0, 60.0, 70.0, 50.0, 0.0, 40.0, 1.0, 12.0, 30.0, 58.0, 61.0, 30.0, 20.0, 40.0, 60.0, 20.0, 10.0, 70.0, 20.0, 50.0, 40.0, 40.0, 20.0, 40.0, 40.0, 80.0, -3.0, 70.0, 20.0, 80.0, 40.0, 48.0, 90.0, 30.0, 70.0, 41.0, 20.0, 60.0, 10.0, 30.0, 60.0, 30.0, 39.0, 20.0, 10.0, 40.0, 70.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 70.0, 30.0, 30.0, 0.0, 60.0, 30.0, 80.0, 40.0, 90.0, 40.0, 40.0, 40.0, 20.0, 40.0, 50.0, 0.0, 40.0, 30.0, 70.0, 20.0, 100.0, 10.0, 70.0, 30.0, 100.0, 50.0, 20.0, 50.0, 30.0, 50.0, 49.0, 50.0, 50.0, 50.0, 30.0, 80.0, 60.0, 10.0, 40.0, 40.0, 10.0, 8.0, 20.0, -2.0, 0.0, -3.0, 10.0, 30.0, 60.0, 60.0, 28.0, 50.0, 16.0, 80.0, 10.0, 60.0, 19.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0, 0.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 60.0, 38.0, 80.0, 80.0, 109.0, 50.0, 30.0, 50.0, 26.0, 60.0, 70.0, 50.0, 5.0, 70.0, 30.0, 20.0, 100.0, 70.0, 70.0, 4.0, 80.0, 60.0, 50.0, 20.0, 22.0, 30.0, 80.0, 49.0, 10.0, 30.0, 20.0, 20.0, 30.0, 80.0, 50.0, 30.0, 50.0, 10.0, 9.0, 30.0, 120.0, 40.0, 10.0, 27.0, 40.0, 30.0, 30.0, 20.0, 40.0, 15.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 80.0, -4.0, 39.0, 60.0, 61.0, 80.0, 40.0, 80.0, 40.0, 80.0, 30.0, 80.0, 41.0, 60.0, 20.0, 20.0, 30.0, 90.0, 30.0, 20.0, 2.0, 60.0, 50.0, 30.0, 70.0, 60.0, 50.0, 60.0, 90.0, 70.0, 60.0, 70.0, 40.0, 60.0, 60.0, 80.0, 70.0, 110.0, 5.0, 0.0, 70.0, 50.0, 30.0, 20.0, 80.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 30.0, 50.0, 0.0, 50.0, 140.0, 0.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 70.0, 40.0, 60.0, 60.0, 30.0, 60.0, 60.0, 29.0, 50.0, 80.0, 50.0, 40.0, 100.0, 60.0, 50.0, 47.0, 10.0, 18.0, 40.0, -3.0, 50.0, 10.0, 10.0, 20.0, 18.0, 8.0, 90.0, 30.0, 40.0, 30.0, 40.0, 20.0, 19.0, 10.0, 40.0, 30.0, 0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0, 60.0, 50.0, 0.0, 60.0, 40.0, 20.0, 60.0, 20.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 37.0, 40.0, 38.0, 20.0, 70.0, 80.0, 120.0, 40.0, 80.0, 10.0, 20.0, 60.0, 100.0, -60.0, 70.0, 36.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 60.0, 23.0, 70.0, 50.0, 50.0, 10.0, 60.0, 70.0, 60.0, 50.0, 20.0, 20.0, 15.0, 30.0, 50.0, 60.0, 20.0, 10.0, 35.0, 50.0, 20.0, 20.0, 40.0, 60.0, 66.0, 40.0, 40.0, 90.0, 11.0, 90.0, 30.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, 30.0, 20.0, 70.0, 90.0, 50.0, 24.0, 30.0, 2.0, 40.0, 30.0, 60.0, 80.0, 40.0, 0.0, 0.0, 20.0, 40.0, 60.0, 30.0, 90.0, 39.0, 0.0, 40.0, 90.0, 70.0, 50.0, 40.0, 60.0, 110.0, 70.0, 40.0, 20.0, 29.0, 18.0, 10.0, 80.0, 30.0, 20.0, 70.0, 0.0, 0.0, 80.0, 8.0, 10.0, 20.0, 8.0, 10.0, 40.0, 30.0, 80.0, 30.0, 0.0, 10.0, 70.0, -45.0, 69.0, 17.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 70.0, 40.0, 90.0, 70.0, 20.0, 100.0, 60.0, 70.0, 50.0, 50.0, 30.0, 0.0, 30.0, 22.0, 50.0, 12.0, 24.0, 90.0, 40.0, 24.0, 40.0, 20.0, -1.0, 32.0, 50.0, -18.0, 50.0, 80.0, 30.0, 120.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6672587562406511, "mean_inference_ms": 1.7152870649948553, "mean_action_processing_ms": 0.5388205770717862, "mean_env_wait_ms": 1.4923393058868992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011967658996582031, "StateBufferConnector_ms": 0.008998394012451172, "ViewRequirementAgentConnector_ms": 0.3706703186035156}, "num_episodes": 18, "episode_return_max": 647.0, "episode_return_min": 133.0, "episode_return_mean": 392.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.53254319966531, "num_env_steps_trained_throughput_per_sec": 21.53254319966531, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 184740.025, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184739.976, "sample_time_ms": 2512.336, "learn_time_ms": 182209.012, "learn_throughput": 21.953, "synch_weights_time_ms": 10.38}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "a22d3_00000", "date": "2024-08-06_01-46-51", "timestamp": 1722923211, "time_this_iter_s": 185.77496814727783, "time_total_s": 11003.133599996567, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11003.133599996567, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 17.77832699619772, "ram_util_percent": 78.65057034220531}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7655407856701535, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.690576446551485, "policy_loss": -0.009764011675408616, "vf_loss": 4.698666980319891, "vf_explained_var": 0.0069140540652127816, "kl": 0.008367358531664176, "entropy": 0.8091390476440088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 699.0, "episode_reward_min": 133.0, "episode_reward_mean": 395.87, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 39.587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 319.0, 380.0, 189.0, 420.0, 570.0, 468.0, 430.0, 222.0, 434.0, 376.0, 290.0, 349.0, 317.0, 450.0, 369.0, 330.0, 310.0, 320.0, 470.0, 537.0, 559.0, 470.0, 420.0, 550.0, 635.0, 370.0, 389.0, 426.0, 376.0, 295.0, 251.0, 379.0, 350.0, 352.0, 350.0, 525.0, 320.0, 190.0, 380.0, 400.0, 500.0, 499.0, 133.0, 413.0, 440.0, 250.0, 573.0, 545.0, 405.0, 329.0, 387.0, 340.0, 592.0, 382.0, 600.0, 535.0, 340.0, 350.0, 440.0, 566.0, 181.0, 349.0, 401.0, 400.0, 285.0, 520.0, 369.0, 460.0, 310.0, 517.0, 380.0, 446.0, 319.0, 579.0, 316.0, 238.0, 371.0, 620.0, 322.0, 403.0, 330.0, 374.0, 428.0, 520.0, 300.0, 478.0, 213.0, 369.0, 339.0, 449.0, 390.0, 276.0, 432.0, 326.0, 329.0, 699.0, 500.0, 350.0, 203.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 10.0, 40.0, 0.0, 90.0, 60.0, 80.0, 30.0, 30.0, 17.0, 30.0, 50.0, 60.0, -5.0, 10.0, 19.0, 8.0, 100.0, 20.0, 30.0, 20.0, 30.0, 10.0, 50.0, 80.0, 20.0, 20.0, 100.0, 0.0, 10.0, 40.0, 10.0, 20.0, 29.0, 40.0, 20.0, 10.0, 10.0, 60.0, 60.0, 40.0, 70.0, 0.0, 80.0, 30.0, 20.0, 50.0, 10.0, 40.0, 40.0, 80.0, 50.0, 40.0, 50.0, 80.0, 90.0, 40.0, 60.0, 50.0, 20.0, 40.0, 70.0, 70.0, 30.0, 30.0, 39.0, 19.0, 100.0, 70.0, 40.0, 30.0, 70.0, 30.0, 30.0, 20.0, 80.0, 40.0, 20.0, 7.0, 8.0, 19.0, 50.0, 40.0, 40.0, 29.0, 9.0, 20.0, 0.0, 80.0, 60.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 30.0, 24.0, 20.0, 38.0, 0.0, 70.0, 60.0, 10.0, 9.0, 29.0, 90.0, 50.0, 40.0, 30.0, 20.0, 20.0, 50.0, 30.0, 30.0, 10.0, 20.0, 40.0, 19.0, 40.0, 10.0, 40.0, 50.0, 20.0, 40.0, 60.0, 20.0, 50.0, 25.0, 9.0, 40.0, 40.0, 47.0, 10.0, 50.0, 40.0, 30.0, 26.0, 20.0, 50.0, 10.0, 40.0, 50.0, 50.0, 50.0, 60.0, 100.0, 20.0, 30.0, 30.0, 0.0, 50.0, 50.0, 40.0, 20.0, 39.0, 80.0, 30.0, 0.0, 30.0, 60.0, 90.0, 30.0, 20.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 80.0, 20.0, 20.0, 60.0, 10.0, 60.0, 10.0, 50.0, 23.0, 40.0, 0.0, 38.0, 60.0, 28.0, 40.0, 38.0, 23.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 20.0, 50.0, 60.0, 80.0, 60.0, 40.0, 60.0, 48.0, 9.0, 60.0, 110.0, 70.0, 30.0, 30.0, 80.0, 160.0, 10.0, 10.0, 10.0, 50.0, 100.0, 79.0, 50.0, 50.0, 40.0, 40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0, 70.0, 70.0, 17.0, 25.0, 20.0, 20.0, 60.0, 19.0, 30.0, 89.0, 60.0, 20.0, 50.0, 90.0, 50.0, 90.0, 30.0, 60.0, 90.0, 10.0, 60.0, 80.0, 85.0, 60.0, 30.0, 40.0, 80.0, 40.0, 80.0, 80.0, 40.0, 20.0, 30.0, 40.0, 60.0, 40.0, 20.0, 20.0, 40.0, 60.0, 29.0, 60.0, 90.0, 50.0, 20.0, 50.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 80.0, 8.0, 20.0, 68.0, 0.0, 70.0, 60.0, 37.0, 40.0, 50.0, 80.0, 30.0, 9.0, 20.0, 0.0, 50.0, 17.0, 50.0, 10.0, 19.0, 30.0, -1.0, 60.0, 30.0, 20.0, 60.0, 20.0, 16.0, 40.0, 0.0, 30.0, 40.0, 30.0, 35.0, 30.0, 10.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 40.0, 10.0, 29.0, 100.0, 40.0, 10.0, 40.0, 20.0, 40.0, 20.0, 60.0, 70.0, 50.0, 0.0, 40.0, 1.0, 12.0, 30.0, 58.0, 61.0, 30.0, 20.0, 40.0, 60.0, 20.0, 10.0, 70.0, 20.0, 50.0, 40.0, 40.0, 20.0, 40.0, 40.0, 80.0, -3.0, 70.0, 20.0, 80.0, 40.0, 48.0, 90.0, 30.0, 70.0, 41.0, 20.0, 60.0, 10.0, 30.0, 60.0, 30.0, 39.0, 20.0, 10.0, 40.0, 70.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 70.0, 30.0, 30.0, 0.0, 60.0, 30.0, 80.0, 40.0, 90.0, 40.0, 40.0, 40.0, 20.0, 40.0, 50.0, 0.0, 40.0, 30.0, 70.0, 20.0, 100.0, 10.0, 70.0, 30.0, 100.0, 50.0, 20.0, 50.0, 30.0, 50.0, 49.0, 50.0, 50.0, 50.0, 30.0, 80.0, 60.0, 10.0, 40.0, 40.0, 10.0, 8.0, 20.0, -2.0, 0.0, -3.0, 10.0, 30.0, 60.0, 60.0, 28.0, 50.0, 16.0, 80.0, 10.0, 60.0, 19.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0, 0.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 60.0, 38.0, 80.0, 80.0, 109.0, 50.0, 30.0, 50.0, 26.0, 60.0, 70.0, 50.0, 5.0, 70.0, 30.0, 20.0, 100.0, 70.0, 70.0, 4.0, 80.0, 60.0, 50.0, 20.0, 22.0, 30.0, 80.0, 49.0, 10.0, 30.0, 20.0, 20.0, 30.0, 80.0, 50.0, 30.0, 50.0, 10.0, 9.0, 30.0, 120.0, 40.0, 10.0, 27.0, 40.0, 30.0, 30.0, 20.0, 40.0, 15.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 80.0, -4.0, 39.0, 60.0, 61.0, 80.0, 40.0, 80.0, 40.0, 80.0, 30.0, 80.0, 41.0, 60.0, 20.0, 20.0, 30.0, 90.0, 30.0, 20.0, 2.0, 60.0, 50.0, 30.0, 70.0, 60.0, 50.0, 60.0, 90.0, 70.0, 60.0, 70.0, 40.0, 60.0, 60.0, 80.0, 70.0, 110.0, 5.0, 0.0, 70.0, 50.0, 30.0, 20.0, 80.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 30.0, 50.0, 0.0, 50.0, 140.0, 0.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 70.0, 40.0, 60.0, 60.0, 30.0, 60.0, 60.0, 29.0, 50.0, 80.0, 50.0, 40.0, 100.0, 60.0, 50.0, 47.0, 10.0, 18.0, 40.0, -3.0, 50.0, 10.0, 10.0, 20.0, 18.0, 8.0, 90.0, 30.0, 40.0, 30.0, 40.0, 20.0, 19.0, 10.0, 40.0, 30.0, 0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0, 60.0, 50.0, 0.0, 60.0, 40.0, 20.0, 60.0, 20.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 37.0, 40.0, 38.0, 20.0, 70.0, 80.0, 120.0, 40.0, 80.0, 10.0, 20.0, 60.0, 100.0, -60.0, 70.0, 36.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 60.0, 23.0, 70.0, 50.0, 50.0, 10.0, 60.0, 70.0, 60.0, 50.0, 20.0, 20.0, 15.0, 30.0, 50.0, 60.0, 20.0, 10.0, 35.0, 50.0, 20.0, 20.0, 40.0, 60.0, 66.0, 40.0, 40.0, 90.0, 11.0, 90.0, 30.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, 30.0, 20.0, 70.0, 90.0, 50.0, 24.0, 30.0, 2.0, 40.0, 30.0, 60.0, 80.0, 40.0, 0.0, 0.0, 20.0, 40.0, 60.0, 30.0, 90.0, 39.0, 0.0, 40.0, 90.0, 70.0, 50.0, 40.0, 60.0, 110.0, 70.0, 40.0, 20.0, 29.0, 18.0, 10.0, 80.0, 30.0, 20.0, 70.0, 0.0, 0.0, 80.0, 8.0, 10.0, 20.0, 8.0, 10.0, 40.0, 30.0, 80.0, 30.0, 0.0, 10.0, 70.0, -45.0, 69.0, 17.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 70.0, 40.0, 90.0, 70.0, 20.0, 100.0, 60.0, 70.0, 50.0, 50.0, 30.0, 0.0, 30.0, 22.0, 50.0, 12.0, 24.0, 90.0, 40.0, 24.0, 40.0, 20.0, -1.0, 32.0, 50.0, -18.0, 50.0, 80.0, 30.0, 120.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0, 50.0, 30.0, 90.0, 20.0, 17.0, 40.0, 20.0, 70.0, 7.0, 30.0, 50.0, 30.0, 50.0, -5.0, -7.0, 20.0, 50.0, 130.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 30.0, 70.0, 100.0, 30.0, 60.0, 80.0, 50.0, 15.0, 20.0, 10.0, 10.0, 40.0, 30.0, 70.0, 5.0, 50.0, 30.0, 60.0, 40.0, 110.0, 40.0, 50.0, 50.0, 10.0, 58.0, 30.0, 40.0, 10.0, 20.0, 0.0, 18.0, 10.0, 40.0, 19.0, 6.0, 50.0, 50.0, 30.0, 0.0, 26.0, 80.0, 50.0, 30.0, 0.0, 70.0, 33.0, 30.0, 50.0, 20.0, 30.0, 30.0, 30.0, 50.0, 20.0, 19.0, 60.0, 40.0, 60.0, 10.0, 40.0, 30.0, 90.0, 29.0, 20.0, 80.0, 50.0, 20.0, 30.0, 80.0, 20.0, 49.0, 11.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 19.0, 0.0, 14.0, 29.0, -5.0, -15.0, 67.0, 47.0, 60.0, 60.0, 31.0, 50.0, 50.0, 60.0, 1.0, 50.0, 50.0, 20.0, 70.0, -3.0, 28.0, 45.0, 57.0, 12.0, 34.0, 70.0, 6.0, 7.0, 40.0, 30.0, 70.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, 39.0, 60.0, 79.0, 70.0, 60.0, 80.0, 70.0, 50.0, 60.0, 120.0, 50.0, 90.0, 50.0, 40.0, 40.0, 60.0, 20.0, 10.0, 60.0, 40.0, 90.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 50.0, 30.0, 30.0, 30.0, -3.0, 37.0, 5.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6637713738251778, "mean_inference_ms": 1.7101896421356093, "mean_action_processing_ms": 0.5369317419944803, "mean_env_wait_ms": 1.4875983949092595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01197671890258789, "StateBufferConnector_ms": 0.0089874267578125, "ViewRequirementAgentConnector_ms": 0.3668022155761719}, "num_episodes": 18, "episode_return_max": 699.0, "episode_return_min": 133.0, "episode_return_mean": 395.87}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.613905340638357, "num_env_steps_trained_throughput_per_sec": 21.613905340638357, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 184822.241, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184822.191, "sample_time_ms": 2526.623, "learn_time_ms": 182276.474, "learn_throughput": 21.945, "synch_weights_time_ms": 10.713}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "a22d3_00000", "date": "2024-08-06_01-49-56", "timestamp": 1722923396, "time_this_iter_s": 185.07640314102173, "time_total_s": 11188.210003137589, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a013d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11188.210003137589, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.56908396946565, "ram_util_percent": 78.25839694656487}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8718979109082614, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.62815002379453, "policy_loss": -0.010762148016009429, "vf_loss": 4.637164888899928, "vf_explained_var": 0.009744183914349102, "kl": 0.008736410429594355, "entropy": 0.7789640441870156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 699.0, "episode_reward_min": 133.0, "episode_reward_mean": 401.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 40.164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 420.0, 550.0, 635.0, 370.0, 389.0, 426.0, 376.0, 295.0, 251.0, 379.0, 350.0, 352.0, 350.0, 525.0, 320.0, 190.0, 380.0, 400.0, 500.0, 499.0, 133.0, 413.0, 440.0, 250.0, 573.0, 545.0, 405.0, 329.0, 387.0, 340.0, 592.0, 382.0, 600.0, 535.0, 340.0, 350.0, 440.0, 566.0, 181.0, 349.0, 401.0, 400.0, 285.0, 520.0, 369.0, 460.0, 310.0, 517.0, 380.0, 446.0, 319.0, 579.0, 316.0, 238.0, 371.0, 620.0, 322.0, 403.0, 330.0, 374.0, 428.0, 520.0, 300.0, 478.0, 213.0, 369.0, 339.0, 449.0, 390.0, 276.0, 432.0, 326.0, 329.0, 699.0, 500.0, 350.0, 203.0, 421.0, 190.0, 470.0, 443.0, 500.0, 378.0, 493.0, 427.0, 225.0, 408.0, 550.0, 417.0, 270.0, 480.0, 443.0, 535.0, 568.0, 527.0, 387.0, 279.0, 249.0, 366.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 100.0, 10.0, 30.0, 10.0, 30.0, 30.0, 40.0, 50.0, 130.0, 70.0, 70.0, 17.0, 25.0, 20.0, 20.0, 60.0, 19.0, 30.0, 89.0, 60.0, 20.0, 50.0, 90.0, 50.0, 90.0, 30.0, 60.0, 90.0, 10.0, 60.0, 80.0, 85.0, 60.0, 30.0, 40.0, 80.0, 40.0, 80.0, 80.0, 40.0, 20.0, 30.0, 40.0, 60.0, 40.0, 20.0, 20.0, 40.0, 60.0, 29.0, 60.0, 90.0, 50.0, 20.0, 50.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 50.0, 40.0, 80.0, 8.0, 20.0, 68.0, 0.0, 70.0, 60.0, 37.0, 40.0, 50.0, 80.0, 30.0, 9.0, 20.0, 0.0, 50.0, 17.0, 50.0, 10.0, 19.0, 30.0, -1.0, 60.0, 30.0, 20.0, 60.0, 20.0, 16.0, 40.0, 0.0, 30.0, 40.0, 30.0, 35.0, 30.0, 10.0, 10.0, 30.0, 50.0, 20.0, 30.0, 60.0, 40.0, 10.0, 29.0, 100.0, 40.0, 10.0, 40.0, 20.0, 40.0, 20.0, 60.0, 70.0, 50.0, 0.0, 40.0, 1.0, 12.0, 30.0, 58.0, 61.0, 30.0, 20.0, 40.0, 60.0, 20.0, 10.0, 70.0, 20.0, 50.0, 40.0, 40.0, 20.0, 40.0, 40.0, 80.0, -3.0, 70.0, 20.0, 80.0, 40.0, 48.0, 90.0, 30.0, 70.0, 41.0, 20.0, 60.0, 10.0, 30.0, 60.0, 30.0, 39.0, 20.0, 10.0, 40.0, 70.0, 10.0, 20.0, 20.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 20.0, 30.0, 70.0, 30.0, 30.0, 0.0, 60.0, 30.0, 80.0, 40.0, 90.0, 40.0, 40.0, 40.0, 20.0, 40.0, 50.0, 0.0, 40.0, 30.0, 70.0, 20.0, 100.0, 10.0, 70.0, 30.0, 100.0, 50.0, 20.0, 50.0, 30.0, 50.0, 49.0, 50.0, 50.0, 50.0, 30.0, 80.0, 60.0, 10.0, 40.0, 40.0, 10.0, 8.0, 20.0, -2.0, 0.0, -3.0, 10.0, 30.0, 60.0, 60.0, 28.0, 50.0, 16.0, 80.0, 10.0, 60.0, 19.0, 40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0, 0.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 60.0, 38.0, 80.0, 80.0, 109.0, 50.0, 30.0, 50.0, 26.0, 60.0, 70.0, 50.0, 5.0, 70.0, 30.0, 20.0, 100.0, 70.0, 70.0, 4.0, 80.0, 60.0, 50.0, 20.0, 22.0, 30.0, 80.0, 49.0, 10.0, 30.0, 20.0, 20.0, 30.0, 80.0, 50.0, 30.0, 50.0, 10.0, 9.0, 30.0, 120.0, 40.0, 10.0, 27.0, 40.0, 30.0, 30.0, 20.0, 40.0, 15.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 80.0, -4.0, 39.0, 60.0, 61.0, 80.0, 40.0, 80.0, 40.0, 80.0, 30.0, 80.0, 41.0, 60.0, 20.0, 20.0, 30.0, 90.0, 30.0, 20.0, 2.0, 60.0, 50.0, 30.0, 70.0, 60.0, 50.0, 60.0, 90.0, 70.0, 60.0, 70.0, 40.0, 60.0, 60.0, 80.0, 70.0, 110.0, 5.0, 0.0, 70.0, 50.0, 30.0, 20.0, 80.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 30.0, 50.0, 0.0, 50.0, 140.0, 0.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 70.0, 40.0, 60.0, 60.0, 30.0, 60.0, 60.0, 29.0, 50.0, 80.0, 50.0, 40.0, 100.0, 60.0, 50.0, 47.0, 10.0, 18.0, 40.0, -3.0, 50.0, 10.0, 10.0, 20.0, 18.0, 8.0, 90.0, 30.0, 40.0, 30.0, 40.0, 20.0, 19.0, 10.0, 40.0, 30.0, 0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0, 60.0, 50.0, 0.0, 60.0, 40.0, 20.0, 60.0, 20.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 37.0, 40.0, 38.0, 20.0, 70.0, 80.0, 120.0, 40.0, 80.0, 10.0, 20.0, 60.0, 100.0, -60.0, 70.0, 36.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 60.0, 23.0, 70.0, 50.0, 50.0, 10.0, 60.0, 70.0, 60.0, 50.0, 20.0, 20.0, 15.0, 30.0, 50.0, 60.0, 20.0, 10.0, 35.0, 50.0, 20.0, 20.0, 40.0, 60.0, 66.0, 40.0, 40.0, 90.0, 11.0, 90.0, 30.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, 30.0, 20.0, 70.0, 90.0, 50.0, 24.0, 30.0, 2.0, 40.0, 30.0, 60.0, 80.0, 40.0, 0.0, 0.0, 20.0, 40.0, 60.0, 30.0, 90.0, 39.0, 0.0, 40.0, 90.0, 70.0, 50.0, 40.0, 60.0, 110.0, 70.0, 40.0, 20.0, 29.0, 18.0, 10.0, 80.0, 30.0, 20.0, 70.0, 0.0, 0.0, 80.0, 8.0, 10.0, 20.0, 8.0, 10.0, 40.0, 30.0, 80.0, 30.0, 0.0, 10.0, 70.0, -45.0, 69.0, 17.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 70.0, 40.0, 90.0, 70.0, 20.0, 100.0, 60.0, 70.0, 50.0, 50.0, 30.0, 0.0, 30.0, 22.0, 50.0, 12.0, 24.0, 90.0, 40.0, 24.0, 40.0, 20.0, -1.0, 32.0, 50.0, -18.0, 50.0, 80.0, 30.0, 120.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0, 50.0, 30.0, 90.0, 20.0, 17.0, 40.0, 20.0, 70.0, 7.0, 30.0, 50.0, 30.0, 50.0, -5.0, -7.0, 20.0, 50.0, 130.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 30.0, 70.0, 100.0, 30.0, 60.0, 80.0, 50.0, 15.0, 20.0, 10.0, 10.0, 40.0, 30.0, 70.0, 5.0, 50.0, 30.0, 60.0, 40.0, 110.0, 40.0, 50.0, 50.0, 10.0, 58.0, 30.0, 40.0, 10.0, 20.0, 0.0, 18.0, 10.0, 40.0, 19.0, 6.0, 50.0, 50.0, 30.0, 0.0, 26.0, 80.0, 50.0, 30.0, 0.0, 70.0, 33.0, 30.0, 50.0, 20.0, 30.0, 30.0, 30.0, 50.0, 20.0, 19.0, 60.0, 40.0, 60.0, 10.0, 40.0, 30.0, 90.0, 29.0, 20.0, 80.0, 50.0, 20.0, 30.0, 80.0, 20.0, 49.0, 11.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 19.0, 0.0, 14.0, 29.0, -5.0, -15.0, 67.0, 47.0, 60.0, 60.0, 31.0, 50.0, 50.0, 60.0, 1.0, 50.0, 50.0, 20.0, 70.0, -3.0, 28.0, 45.0, 57.0, 12.0, 34.0, 70.0, 6.0, 7.0, 40.0, 30.0, 70.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, 39.0, 60.0, 79.0, 70.0, 60.0, 80.0, 70.0, 50.0, 60.0, 120.0, 50.0, 90.0, 50.0, 40.0, 40.0, 60.0, 20.0, 10.0, 60.0, 40.0, 90.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 50.0, 30.0, 30.0, 30.0, -3.0, 37.0, 5.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 14.0, 40.0, 60.0, 10.0, 20.0, 6.0, 100.0, 50.0, 90.0, -5.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 90.0, 40.0, 40.0, 0.0, 50.0, 30.0, 30.0, 70.0, 60.0, 90.0, 60.0, 70.0, 7.0, 40.0, 10.0, 30.0, 40.0, 36.0, 60.0, 70.0, 20.0, 60.0, 50.0, 40.0, 40.0, 60.0, 70.0, 40.0, 50.0, -25.0, -4.0, 60.0, 22.0, 16.0, 70.0, 90.0, 28.0, 80.0, 41.0, 90.0, 80.0, 50.0, 40.0, 10.0, 5.0, 70.0, 80.0, 60.0, 8.0, 50.0, 50.0, 50.0, -5.0, 29.0, 50.0, 90.0, 29.0, 24.0, 60.0, 8.0, 0.0, 20.0, 10.0, 30.0, 30.0, 30.0, 7.0, 40.0, 50.0, 50.0, 70.0, -10.0, 1.0, 39.0, 40.0, 29.0, 90.0, 9.0, 90.0, 100.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 50.0, 70.0, 20.0, 20.0, 28.0, 30.0, 10.0, 80.0, -2.0, 30.0, 90.0, 40.0, 91.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 60.0, 20.0, 10.0, 90.0, 100.0, 30.0, 20.0, 70.0, 30.0, 60.0, 20.0, 50.0, 10.0, 30.0, 45.0, 84.0, 20.0, 75.0, 60.0, 60.0, 10.0, 40.0, 19.0, 20.0, 80.0, 60.0, 40.0, 50.0, 65.0, 50.0, 90.0, 20.0, 60.0, 60.0, 70.0, 80.0, 18.0, 30.0, 60.0, 70.0, 40.0, 70.0, 70.0, 80.0, 20.0, 130.0, 57.0, 14.0, 40.0, 20.0, 80.0, 70.0, 16.0, 40.0, 27.0, 50.0, 0.0, 10.0, 60.0, 30.0, 11.0, 130.0, 29.0, 40.0, 30.0, 10.0, 39.0, 40.0, 20.0, 0.0, 40.0, 10.0, 50.0, 40.0, 10.0, 20.0, 29.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6599999987697425, "mean_inference_ms": 1.7037130096519189, "mean_action_processing_ms": 0.5346915373814117, "mean_env_wait_ms": 1.482002622019068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012456893920898438, "StateBufferConnector_ms": 0.00933527946472168, "ViewRequirementAgentConnector_ms": 0.37233591079711914}, "num_episodes": 22, "episode_return_max": 699.0, "episode_return_min": 133.0, "episode_return_mean": 401.64}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.561822959427243, "num_env_steps_trained_throughput_per_sec": 21.561822959427243, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 184928.936, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184928.883, "sample_time_ms": 2513.271, "learn_time_ms": 182394.192, "learn_throughput": 21.931, "synch_weights_time_ms": 12.539}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "a22d3_00000", "date": "2024-08-06_01-53-01", "timestamp": 1722923581, "time_this_iter_s": 185.52695870399475, "time_total_s": 11373.736961841583, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16661f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11373.736961841583, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 18.265648854961835, "ram_util_percent": 78.15954198473284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8892169908593637, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.21549764436147, "policy_loss": -0.010599521966080784, "vf_loss": 5.224374601457574, "vf_explained_var": 0.007300790969810039, "kl": 0.008612857975737128, "entropy": 0.7156836717717817, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 699.0, "episode_reward_min": 144.0, "episode_reward_mean": 402.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 40.229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 250.0, 573.0, 545.0, 405.0, 329.0, 387.0, 340.0, 592.0, 382.0, 600.0, 535.0, 340.0, 350.0, 440.0, 566.0, 181.0, 349.0, 401.0, 400.0, 285.0, 520.0, 369.0, 460.0, 310.0, 517.0, 380.0, 446.0, 319.0, 579.0, 316.0, 238.0, 371.0, 620.0, 322.0, 403.0, 330.0, 374.0, 428.0, 520.0, 300.0, 478.0, 213.0, 369.0, 339.0, 449.0, 390.0, 276.0, 432.0, 326.0, 329.0, 699.0, 500.0, 350.0, 203.0, 421.0, 190.0, 470.0, 443.0, 500.0, 378.0, 493.0, 427.0, 225.0, 408.0, 550.0, 417.0, 270.0, 480.0, 443.0, 535.0, 568.0, 527.0, 387.0, 279.0, 249.0, 366.0, 350.0, 330.0, 394.0, 539.0, 360.0, 451.0, 287.0, 517.0, 400.0, 413.0, 430.0, 144.0, 315.0, 290.0, 371.0, 395.0, 456.0, 489.0, 310.0, 673.0, 298.0, 398.0, 428.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 20.0, 40.0, 20.0, 30.0, 60.0, 90.0, 50.0, 10.0, 80.0, 0.0, 40.0, 0.0, 20.0, 60.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 60.0, 38.0, 80.0, 80.0, 109.0, 50.0, 30.0, 50.0, 26.0, 60.0, 70.0, 50.0, 5.0, 70.0, 30.0, 20.0, 100.0, 70.0, 70.0, 4.0, 80.0, 60.0, 50.0, 20.0, 22.0, 30.0, 80.0, 49.0, 10.0, 30.0, 20.0, 20.0, 30.0, 80.0, 50.0, 30.0, 50.0, 10.0, 9.0, 30.0, 120.0, 40.0, 10.0, 27.0, 40.0, 30.0, 30.0, 20.0, 40.0, 15.0, 40.0, 50.0, 20.0, 20.0, 30.0, 50.0, 80.0, -4.0, 39.0, 60.0, 61.0, 80.0, 40.0, 80.0, 40.0, 80.0, 30.0, 80.0, 41.0, 60.0, 20.0, 20.0, 30.0, 90.0, 30.0, 20.0, 2.0, 60.0, 50.0, 30.0, 70.0, 60.0, 50.0, 60.0, 90.0, 70.0, 60.0, 70.0, 40.0, 60.0, 60.0, 80.0, 70.0, 110.0, 5.0, 0.0, 70.0, 50.0, 30.0, 20.0, 80.0, 50.0, 20.0, 40.0, 20.0, 20.0, 20.0, 0.0, 70.0, 10.0, 30.0, 50.0, 0.0, 50.0, 140.0, 0.0, 10.0, 50.0, 10.0, 40.0, 30.0, 30.0, 20.0, 70.0, 40.0, 60.0, 60.0, 30.0, 60.0, 60.0, 29.0, 50.0, 80.0, 50.0, 40.0, 100.0, 60.0, 50.0, 47.0, 10.0, 18.0, 40.0, -3.0, 50.0, 10.0, 10.0, 20.0, 18.0, 8.0, 90.0, 30.0, 40.0, 30.0, 40.0, 20.0, 19.0, 10.0, 40.0, 30.0, 0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0, 60.0, 50.0, 0.0, 60.0, 40.0, 20.0, 60.0, 20.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 37.0, 40.0, 38.0, 20.0, 70.0, 80.0, 120.0, 40.0, 80.0, 10.0, 20.0, 60.0, 100.0, -60.0, 70.0, 36.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 60.0, 23.0, 70.0, 50.0, 50.0, 10.0, 60.0, 70.0, 60.0, 50.0, 20.0, 20.0, 15.0, 30.0, 50.0, 60.0, 20.0, 10.0, 35.0, 50.0, 20.0, 20.0, 40.0, 60.0, 66.0, 40.0, 40.0, 90.0, 11.0, 90.0, 30.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, 30.0, 20.0, 70.0, 90.0, 50.0, 24.0, 30.0, 2.0, 40.0, 30.0, 60.0, 80.0, 40.0, 0.0, 0.0, 20.0, 40.0, 60.0, 30.0, 90.0, 39.0, 0.0, 40.0, 90.0, 70.0, 50.0, 40.0, 60.0, 110.0, 70.0, 40.0, 20.0, 29.0, 18.0, 10.0, 80.0, 30.0, 20.0, 70.0, 0.0, 0.0, 80.0, 8.0, 10.0, 20.0, 8.0, 10.0, 40.0, 30.0, 80.0, 30.0, 0.0, 10.0, 70.0, -45.0, 69.0, 17.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 70.0, 40.0, 90.0, 70.0, 20.0, 100.0, 60.0, 70.0, 50.0, 50.0, 30.0, 0.0, 30.0, 22.0, 50.0, 12.0, 24.0, 90.0, 40.0, 24.0, 40.0, 20.0, -1.0, 32.0, 50.0, -18.0, 50.0, 80.0, 30.0, 120.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0, 50.0, 30.0, 90.0, 20.0, 17.0, 40.0, 20.0, 70.0, 7.0, 30.0, 50.0, 30.0, 50.0, -5.0, -7.0, 20.0, 50.0, 130.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 30.0, 70.0, 100.0, 30.0, 60.0, 80.0, 50.0, 15.0, 20.0, 10.0, 10.0, 40.0, 30.0, 70.0, 5.0, 50.0, 30.0, 60.0, 40.0, 110.0, 40.0, 50.0, 50.0, 10.0, 58.0, 30.0, 40.0, 10.0, 20.0, 0.0, 18.0, 10.0, 40.0, 19.0, 6.0, 50.0, 50.0, 30.0, 0.0, 26.0, 80.0, 50.0, 30.0, 0.0, 70.0, 33.0, 30.0, 50.0, 20.0, 30.0, 30.0, 30.0, 50.0, 20.0, 19.0, 60.0, 40.0, 60.0, 10.0, 40.0, 30.0, 90.0, 29.0, 20.0, 80.0, 50.0, 20.0, 30.0, 80.0, 20.0, 49.0, 11.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 19.0, 0.0, 14.0, 29.0, -5.0, -15.0, 67.0, 47.0, 60.0, 60.0, 31.0, 50.0, 50.0, 60.0, 1.0, 50.0, 50.0, 20.0, 70.0, -3.0, 28.0, 45.0, 57.0, 12.0, 34.0, 70.0, 6.0, 7.0, 40.0, 30.0, 70.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, 39.0, 60.0, 79.0, 70.0, 60.0, 80.0, 70.0, 50.0, 60.0, 120.0, 50.0, 90.0, 50.0, 40.0, 40.0, 60.0, 20.0, 10.0, 60.0, 40.0, 90.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 50.0, 30.0, 30.0, 30.0, -3.0, 37.0, 5.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 14.0, 40.0, 60.0, 10.0, 20.0, 6.0, 100.0, 50.0, 90.0, -5.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 90.0, 40.0, 40.0, 0.0, 50.0, 30.0, 30.0, 70.0, 60.0, 90.0, 60.0, 70.0, 7.0, 40.0, 10.0, 30.0, 40.0, 36.0, 60.0, 70.0, 20.0, 60.0, 50.0, 40.0, 40.0, 60.0, 70.0, 40.0, 50.0, -25.0, -4.0, 60.0, 22.0, 16.0, 70.0, 90.0, 28.0, 80.0, 41.0, 90.0, 80.0, 50.0, 40.0, 10.0, 5.0, 70.0, 80.0, 60.0, 8.0, 50.0, 50.0, 50.0, -5.0, 29.0, 50.0, 90.0, 29.0, 24.0, 60.0, 8.0, 0.0, 20.0, 10.0, 30.0, 30.0, 30.0, 7.0, 40.0, 50.0, 50.0, 70.0, -10.0, 1.0, 39.0, 40.0, 29.0, 90.0, 9.0, 90.0, 100.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 50.0, 70.0, 20.0, 20.0, 28.0, 30.0, 10.0, 80.0, -2.0, 30.0, 90.0, 40.0, 91.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 60.0, 20.0, 10.0, 90.0, 100.0, 30.0, 20.0, 70.0, 30.0, 60.0, 20.0, 50.0, 10.0, 30.0, 45.0, 84.0, 20.0, 75.0, 60.0, 60.0, 10.0, 40.0, 19.0, 20.0, 80.0, 60.0, 40.0, 50.0, 65.0, 50.0, 90.0, 20.0, 60.0, 60.0, 70.0, 80.0, 18.0, 30.0, 60.0, 70.0, 40.0, 70.0, 70.0, 80.0, 20.0, 130.0, 57.0, 14.0, 40.0, 20.0, 80.0, 70.0, 16.0, 40.0, 27.0, 50.0, 0.0, 10.0, 60.0, 30.0, 11.0, 130.0, 29.0, 40.0, 30.0, 10.0, 39.0, 40.0, 20.0, 0.0, 40.0, 10.0, 50.0, 40.0, 10.0, 20.0, 29.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0, 18.0, 5.0, 100.0, 40.0, 80.0, 10.0, 10.0, -1.0, 28.0, 60.0, 60.0, 25.0, 20.0, 10.0, 50.0, 16.0, 70.0, 20.0, 50.0, 9.0, 90.0, 20.0, 50.0, -10.0, 100.0, 29.0, 10.0, 45.0, 60.0, 0.0, 90.0, 60.0, 60.0, 90.0, 39.0, 40.0, 40.0, 30.0, 20.0, 70.0, 0.0, 30.0, 50.0, 90.0, 30.0, 0.0, 60.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 20.0, 50.0, 80.0, 3.0, 50.0, 28.0, 100.0, 30.0, 20.0, 30.0, 14.0, -2.0, 90.0, 50.0, 20.0, 30.0, 5.0, 70.0, 30.0, 40.0, 110.0, 60.0, 50.0, 60.0, 30.0, 27.0, 40.0, 10.0, 80.0, 40.0, 20.0, 50.0, 60.0, 20.0, 60.0, 20.0, 40.0, 60.0, 31.0, -8.0, 10.0, 110.0, 30.0, 40.0, 10.0, 40.0, 90.0, 60.0, 30.0, 40.0, 10.0, 60.0, 30.0, 10.0, 70.0, 50.0, 70.0, 0.0, 20.0, 40.0, 18.0, 0.0, 10.0, 0.0, 10.0, 9.0, 37.0, 50.0, 60.0, 30.0, 21.0, 25.0, 70.0, 40.0, 20.0, 0.0, -1.0, 10.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 50.0, 10.0, 20.0, 10.0, 20.0, 29.0, 54.0, 60.0, 10.0, 30.0, 20.0, 28.0, 110.0, 60.0, 40.0, 40.0, 40.0, 15.0, 40.0, 0.0, 0.0, 90.0, 70.0, 110.0, 70.0, 20.0, 20.0, 18.0, 30.0, 50.0, 60.0, 60.0, 18.0, 20.0, 70.0, 60.0, 30.0, 15.0, 40.0, 70.0, 110.0, 54.0, 20.0, 40.0, 10.0, 80.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 10.0, 90.0, 70.0, 50.0, 19.0, 24.0, 50.0, 100.0, 90.0, 100.0, 80.0, -1.0, 40.0, 20.0, 10.0, 60.0, 70.0, 20.0, 30.0, 19.0, 30.0, 50.0, 40.0, 9.0, 70.0, 30.0, 20.0, 80.0, 9.0, 40.0, 50.0, 16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.655893523659467, "mean_inference_ms": 1.6976514828754679, "mean_action_processing_ms": 0.5324575559044327, "mean_env_wait_ms": 1.4764737855639825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012805938720703125, "StateBufferConnector_ms": 0.009597063064575195, "ViewRequirementAgentConnector_ms": 0.3754420280456543}, "num_episodes": 23, "episode_return_max": 699.0, "episode_return_min": 144.0, "episode_return_mean": 402.29}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.62728493458332, "num_env_steps_trained_throughput_per_sec": 21.62728493458332, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 184810.419, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184810.366, "sample_time_ms": 2529.544, "learn_time_ms": 182259.482, "learn_throughput": 21.947, "synch_weights_time_ms": 12.543}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "a22d3_00000", "date": "2024-08-06_01-56-06", "timestamp": 1722923766, "time_this_iter_s": 184.96268796920776, "time_total_s": 11558.699649810791, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a139e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11558.699649810791, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.36832061068702, "ram_util_percent": 77.02557251908395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7381044720625853, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.85642797103959, "policy_loss": -0.008961436498530321, "vf_loss": 4.863829548798176, "vf_explained_var": -0.0014370201748653976, "kl": 0.007799259814231581, "entropy": 0.7256478764442083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 699.0, "episode_reward_min": 144.0, "episode_reward_mean": 400.33, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 136.0}, "policy_reward_mean": {"policy_0": 40.033}, "custom_metrics": {}, "hist_stats": {"episode_reward": [401.0, 400.0, 285.0, 520.0, 369.0, 460.0, 310.0, 517.0, 380.0, 446.0, 319.0, 579.0, 316.0, 238.0, 371.0, 620.0, 322.0, 403.0, 330.0, 374.0, 428.0, 520.0, 300.0, 478.0, 213.0, 369.0, 339.0, 449.0, 390.0, 276.0, 432.0, 326.0, 329.0, 699.0, 500.0, 350.0, 203.0, 421.0, 190.0, 470.0, 443.0, 500.0, 378.0, 493.0, 427.0, 225.0, 408.0, 550.0, 417.0, 270.0, 480.0, 443.0, 535.0, 568.0, 527.0, 387.0, 279.0, 249.0, 366.0, 350.0, 330.0, 394.0, 539.0, 360.0, 451.0, 287.0, 517.0, 400.0, 413.0, 430.0, 144.0, 315.0, 290.0, 371.0, 395.0, 456.0, 489.0, 310.0, 673.0, 298.0, 398.0, 428.0, 327.0, 212.0, 550.0, 335.0, 520.0, 368.0, 430.0, 429.0, 531.0, 430.0, 308.0, 296.0, 354.0, 400.0, 520.0, 430.0, 435.0, 533.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 47.0, 8.0, 9.0, 10.0, 50.0, 37.0, 90.0, 60.0, 90.0, 60.0, 50.0, 0.0, 60.0, 40.0, 20.0, 60.0, 20.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 30.0, 20.0, 37.0, 40.0, 38.0, 20.0, 70.0, 80.0, 120.0, 40.0, 80.0, 10.0, 20.0, 60.0, 100.0, -60.0, 70.0, 36.0, 20.0, 0.0, 20.0, 50.0, 50.0, 40.0, 60.0, 23.0, 70.0, 50.0, 50.0, 10.0, 60.0, 70.0, 60.0, 50.0, 20.0, 20.0, 15.0, 30.0, 50.0, 60.0, 20.0, 10.0, 35.0, 50.0, 20.0, 20.0, 40.0, 60.0, 66.0, 40.0, 40.0, 90.0, 11.0, 90.0, 30.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 40.0, 30.0, 20.0, 70.0, 90.0, 50.0, 24.0, 30.0, 2.0, 40.0, 30.0, 60.0, 80.0, 40.0, 0.0, 0.0, 20.0, 40.0, 60.0, 30.0, 90.0, 39.0, 0.0, 40.0, 90.0, 70.0, 50.0, 40.0, 60.0, 110.0, 70.0, 40.0, 20.0, 29.0, 18.0, 10.0, 80.0, 30.0, 20.0, 70.0, 0.0, 0.0, 80.0, 8.0, 10.0, 20.0, 8.0, 10.0, 40.0, 30.0, 80.0, 30.0, 0.0, 10.0, 70.0, -45.0, 69.0, 17.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 70.0, 40.0, 90.0, 70.0, 20.0, 100.0, 60.0, 70.0, 50.0, 50.0, 30.0, 0.0, 30.0, 22.0, 50.0, 12.0, 24.0, 90.0, 40.0, 24.0, 40.0, 20.0, -1.0, 32.0, 50.0, -18.0, 50.0, 80.0, 30.0, 120.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0, 50.0, 30.0, 90.0, 20.0, 17.0, 40.0, 20.0, 70.0, 7.0, 30.0, 50.0, 30.0, 50.0, -5.0, -7.0, 20.0, 50.0, 130.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 30.0, 70.0, 100.0, 30.0, 60.0, 80.0, 50.0, 15.0, 20.0, 10.0, 10.0, 40.0, 30.0, 70.0, 5.0, 50.0, 30.0, 60.0, 40.0, 110.0, 40.0, 50.0, 50.0, 10.0, 58.0, 30.0, 40.0, 10.0, 20.0, 0.0, 18.0, 10.0, 40.0, 19.0, 6.0, 50.0, 50.0, 30.0, 0.0, 26.0, 80.0, 50.0, 30.0, 0.0, 70.0, 33.0, 30.0, 50.0, 20.0, 30.0, 30.0, 30.0, 50.0, 20.0, 19.0, 60.0, 40.0, 60.0, 10.0, 40.0, 30.0, 90.0, 29.0, 20.0, 80.0, 50.0, 20.0, 30.0, 80.0, 20.0, 49.0, 11.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 19.0, 0.0, 14.0, 29.0, -5.0, -15.0, 67.0, 47.0, 60.0, 60.0, 31.0, 50.0, 50.0, 60.0, 1.0, 50.0, 50.0, 20.0, 70.0, -3.0, 28.0, 45.0, 57.0, 12.0, 34.0, 70.0, 6.0, 7.0, 40.0, 30.0, 70.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, 39.0, 60.0, 79.0, 70.0, 60.0, 80.0, 70.0, 50.0, 60.0, 120.0, 50.0, 90.0, 50.0, 40.0, 40.0, 60.0, 20.0, 10.0, 60.0, 40.0, 90.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 50.0, 30.0, 30.0, 30.0, -3.0, 37.0, 5.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 14.0, 40.0, 60.0, 10.0, 20.0, 6.0, 100.0, 50.0, 90.0, -5.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 90.0, 40.0, 40.0, 0.0, 50.0, 30.0, 30.0, 70.0, 60.0, 90.0, 60.0, 70.0, 7.0, 40.0, 10.0, 30.0, 40.0, 36.0, 60.0, 70.0, 20.0, 60.0, 50.0, 40.0, 40.0, 60.0, 70.0, 40.0, 50.0, -25.0, -4.0, 60.0, 22.0, 16.0, 70.0, 90.0, 28.0, 80.0, 41.0, 90.0, 80.0, 50.0, 40.0, 10.0, 5.0, 70.0, 80.0, 60.0, 8.0, 50.0, 50.0, 50.0, -5.0, 29.0, 50.0, 90.0, 29.0, 24.0, 60.0, 8.0, 0.0, 20.0, 10.0, 30.0, 30.0, 30.0, 7.0, 40.0, 50.0, 50.0, 70.0, -10.0, 1.0, 39.0, 40.0, 29.0, 90.0, 9.0, 90.0, 100.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 50.0, 70.0, 20.0, 20.0, 28.0, 30.0, 10.0, 80.0, -2.0, 30.0, 90.0, 40.0, 91.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 60.0, 20.0, 10.0, 90.0, 100.0, 30.0, 20.0, 70.0, 30.0, 60.0, 20.0, 50.0, 10.0, 30.0, 45.0, 84.0, 20.0, 75.0, 60.0, 60.0, 10.0, 40.0, 19.0, 20.0, 80.0, 60.0, 40.0, 50.0, 65.0, 50.0, 90.0, 20.0, 60.0, 60.0, 70.0, 80.0, 18.0, 30.0, 60.0, 70.0, 40.0, 70.0, 70.0, 80.0, 20.0, 130.0, 57.0, 14.0, 40.0, 20.0, 80.0, 70.0, 16.0, 40.0, 27.0, 50.0, 0.0, 10.0, 60.0, 30.0, 11.0, 130.0, 29.0, 40.0, 30.0, 10.0, 39.0, 40.0, 20.0, 0.0, 40.0, 10.0, 50.0, 40.0, 10.0, 20.0, 29.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0, 18.0, 5.0, 100.0, 40.0, 80.0, 10.0, 10.0, -1.0, 28.0, 60.0, 60.0, 25.0, 20.0, 10.0, 50.0, 16.0, 70.0, 20.0, 50.0, 9.0, 90.0, 20.0, 50.0, -10.0, 100.0, 29.0, 10.0, 45.0, 60.0, 0.0, 90.0, 60.0, 60.0, 90.0, 39.0, 40.0, 40.0, 30.0, 20.0, 70.0, 0.0, 30.0, 50.0, 90.0, 30.0, 0.0, 60.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 20.0, 50.0, 80.0, 3.0, 50.0, 28.0, 100.0, 30.0, 20.0, 30.0, 14.0, -2.0, 90.0, 50.0, 20.0, 30.0, 5.0, 70.0, 30.0, 40.0, 110.0, 60.0, 50.0, 60.0, 30.0, 27.0, 40.0, 10.0, 80.0, 40.0, 20.0, 50.0, 60.0, 20.0, 60.0, 20.0, 40.0, 60.0, 31.0, -8.0, 10.0, 110.0, 30.0, 40.0, 10.0, 40.0, 90.0, 60.0, 30.0, 40.0, 10.0, 60.0, 30.0, 10.0, 70.0, 50.0, 70.0, 0.0, 20.0, 40.0, 18.0, 0.0, 10.0, 0.0, 10.0, 9.0, 37.0, 50.0, 60.0, 30.0, 21.0, 25.0, 70.0, 40.0, 20.0, 0.0, -1.0, 10.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 50.0, 10.0, 20.0, 10.0, 20.0, 29.0, 54.0, 60.0, 10.0, 30.0, 20.0, 28.0, 110.0, 60.0, 40.0, 40.0, 40.0, 15.0, 40.0, 0.0, 0.0, 90.0, 70.0, 110.0, 70.0, 20.0, 20.0, 18.0, 30.0, 50.0, 60.0, 60.0, 18.0, 20.0, 70.0, 60.0, 30.0, 15.0, 40.0, 70.0, 110.0, 54.0, 20.0, 40.0, 10.0, 80.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 10.0, 90.0, 70.0, 50.0, 19.0, 24.0, 50.0, 100.0, 90.0, 100.0, 80.0, -1.0, 40.0, 20.0, 10.0, 60.0, 70.0, 20.0, 30.0, 19.0, 30.0, 50.0, 40.0, 9.0, 70.0, 30.0, 20.0, 80.0, 9.0, 40.0, 50.0, 16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0, 10.0, 30.0, 8.0, 15.0, -3.0, 70.0, 59.0, 59.0, 19.0, 60.0, 9.0, 20.0, 36.0, 20.0, 9.0, -3.0, 20.0, 33.0, 80.0, -12.0, 70.0, 60.0, 70.0, 80.0, 30.0, 50.0, 40.0, 30.0, 50.0, 70.0, 14.0, 60.0, -6.0, 30.0, 80.0, 9.0, 60.0, 80.0, -2.0, 10.0, 30.0, 70.0, 60.0, 80.0, 10.0, 40.0, 50.0, 60.0, 50.0, 70.0, 90.0, 60.0, 30.0, 10.0, 30.0, 18.0, 10.0, 30.0, 30.0, 60.0, 50.0, 60.0, 10.0, 50.0, 50.0, 40.0, 30.0, 50.0, 50.0, 40.0, 40.0, 9.0, 30.0, 60.0, 0.0, 50.0, 70.0, 50.0, 40.0, 80.0, -4.0, 26.0, 110.0, 100.0, 59.0, 50.0, 40.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 30.0, 30.0, 10.0, 20.0, 60.0, 70.0, 80.0, 40.0, 9.0, 10.0, 30.0, 40.0, 20.0, 40.0, 50.0, 9.0, 60.0, 70.0, 50.0, 10.0, 7.0, 50.0, 0.0, 40.0, 40.0, 19.0, 10.0, 30.0, 70.0, 60.0, 80.0, 40.0, 20.0, 40.0, 47.0, 17.0, -50.0, 100.0, 10.0, 100.0, 20.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 60.0, 30.0, 50.0, 40.0, 60.0, 100.0, 60.0, 30.0, 70.0, 20.0, 30.0, 100.0, 50.0, 80.0, 70.0, 0.0, 0.0, 40.0, 10.0, 50.0, 80.0, 30.0, 19.0, 30.0, 50.0, 10.0, 90.0, 50.0, 33.0, 43.0, 0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6525740812651366, "mean_inference_ms": 1.6928733071637152, "mean_action_processing_ms": 0.5307798951585334, "mean_env_wait_ms": 1.4723140387968852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012722969055175781, "StateBufferConnector_ms": 0.009526491165161133, "ViewRequirementAgentConnector_ms": 0.37030744552612305}, "num_episodes": 18, "episode_return_max": 699.0, "episode_return_min": 144.0, "episode_return_mean": 400.33}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.31449256559766, "num_env_steps_trained_throughput_per_sec": 21.31449256559766, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 185232.687, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185232.634, "sample_time_ms": 2481.913, "learn_time_ms": 182728.824, "learn_throughput": 21.89, "synch_weights_time_ms": 12.871}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "a22d3_00000", "date": "2024-08-06_01-59-14", "timestamp": 1722923954, "time_this_iter_s": 187.67320775985718, "time_total_s": 11746.372857570648, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20bd670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11746.372857570648, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 21.009056603773583, "ram_util_percent": 78.14830188679245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.973357521802092, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.849668663886154, "policy_loss": -0.008880546718341903, "vf_loss": 4.856959575941515, "vf_explained_var": -0.004265448162223077, "kl": 0.007948166358799332, "entropy": 0.7401986576116885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 699.0, "episode_reward_min": 125.0, "episode_reward_mean": 394.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 136.0}, "policy_reward_mean": {"policy_0": 39.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 374.0, 428.0, 520.0, 300.0, 478.0, 213.0, 369.0, 339.0, 449.0, 390.0, 276.0, 432.0, 326.0, 329.0, 699.0, 500.0, 350.0, 203.0, 421.0, 190.0, 470.0, 443.0, 500.0, 378.0, 493.0, 427.0, 225.0, 408.0, 550.0, 417.0, 270.0, 480.0, 443.0, 535.0, 568.0, 527.0, 387.0, 279.0, 249.0, 366.0, 350.0, 330.0, 394.0, 539.0, 360.0, 451.0, 287.0, 517.0, 400.0, 413.0, 430.0, 144.0, 315.0, 290.0, 371.0, 395.0, 456.0, 489.0, 310.0, 673.0, 298.0, 398.0, 428.0, 327.0, 212.0, 550.0, 335.0, 520.0, 368.0, 430.0, 429.0, 531.0, 430.0, 308.0, 296.0, 354.0, 400.0, 520.0, 430.0, 435.0, 533.0, 266.0, 364.0, 359.0, 590.0, 376.0, 462.0, 380.0, 398.0, 414.0, 180.0, 549.0, 125.0, 346.0, 314.0, 193.0, 302.0, 527.0, 483.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 20.0, -31.0, 1.0, 20.0, 50.0, 30.0, 90.0, 20.0, 17.0, 40.0, 20.0, 70.0, 7.0, 30.0, 50.0, 30.0, 50.0, -5.0, -7.0, 20.0, 50.0, 130.0, 70.0, 40.0, 30.0, 50.0, 50.0, 20.0, 30.0, 70.0, 100.0, 30.0, 60.0, 80.0, 50.0, 15.0, 20.0, 10.0, 10.0, 40.0, 30.0, 70.0, 5.0, 50.0, 30.0, 60.0, 40.0, 110.0, 40.0, 50.0, 50.0, 10.0, 58.0, 30.0, 40.0, 10.0, 20.0, 0.0, 18.0, 10.0, 40.0, 19.0, 6.0, 50.0, 50.0, 30.0, 0.0, 26.0, 80.0, 50.0, 30.0, 0.0, 70.0, 33.0, 30.0, 50.0, 20.0, 30.0, 30.0, 30.0, 50.0, 20.0, 19.0, 60.0, 40.0, 60.0, 10.0, 40.0, 30.0, 90.0, 29.0, 20.0, 80.0, 50.0, 20.0, 30.0, 80.0, 20.0, 49.0, 11.0, 30.0, 60.0, 60.0, 30.0, 60.0, 60.0, 19.0, 0.0, 14.0, 29.0, -5.0, -15.0, 67.0, 47.0, 60.0, 60.0, 31.0, 50.0, 50.0, 60.0, 1.0, 50.0, 50.0, 20.0, 70.0, -3.0, 28.0, 45.0, 57.0, 12.0, 34.0, 70.0, 6.0, 7.0, 40.0, 30.0, 70.0, 20.0, 50.0, 40.0, 0.0, 20.0, 20.0, 39.0, 60.0, 79.0, 70.0, 60.0, 80.0, 70.0, 50.0, 60.0, 120.0, 50.0, 90.0, 50.0, 40.0, 40.0, 60.0, 20.0, 10.0, 60.0, 40.0, 90.0, 40.0, 20.0, 50.0, 30.0, 20.0, 50.0, 50.0, 30.0, 30.0, 30.0, -3.0, 37.0, 5.0, 20.0, 20.0, 40.0, 30.0, 10.0, 30.0, 14.0, 40.0, 60.0, 10.0, 20.0, 6.0, 100.0, 50.0, 90.0, -5.0, 50.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 90.0, 40.0, 40.0, 0.0, 50.0, 30.0, 30.0, 70.0, 60.0, 90.0, 60.0, 70.0, 7.0, 40.0, 10.0, 30.0, 40.0, 36.0, 60.0, 70.0, 20.0, 60.0, 50.0, 40.0, 40.0, 60.0, 70.0, 40.0, 50.0, -25.0, -4.0, 60.0, 22.0, 16.0, 70.0, 90.0, 28.0, 80.0, 41.0, 90.0, 80.0, 50.0, 40.0, 10.0, 5.0, 70.0, 80.0, 60.0, 8.0, 50.0, 50.0, 50.0, -5.0, 29.0, 50.0, 90.0, 29.0, 24.0, 60.0, 8.0, 0.0, 20.0, 10.0, 30.0, 30.0, 30.0, 7.0, 40.0, 50.0, 50.0, 70.0, -10.0, 1.0, 39.0, 40.0, 29.0, 90.0, 9.0, 90.0, 100.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 50.0, 70.0, 20.0, 20.0, 28.0, 30.0, 10.0, 80.0, -2.0, 30.0, 90.0, 40.0, 91.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 60.0, 20.0, 10.0, 90.0, 100.0, 30.0, 20.0, 70.0, 30.0, 60.0, 20.0, 50.0, 10.0, 30.0, 45.0, 84.0, 20.0, 75.0, 60.0, 60.0, 10.0, 40.0, 19.0, 20.0, 80.0, 60.0, 40.0, 50.0, 65.0, 50.0, 90.0, 20.0, 60.0, 60.0, 70.0, 80.0, 18.0, 30.0, 60.0, 70.0, 40.0, 70.0, 70.0, 80.0, 20.0, 130.0, 57.0, 14.0, 40.0, 20.0, 80.0, 70.0, 16.0, 40.0, 27.0, 50.0, 0.0, 10.0, 60.0, 30.0, 11.0, 130.0, 29.0, 40.0, 30.0, 10.0, 39.0, 40.0, 20.0, 0.0, 40.0, 10.0, 50.0, 40.0, 10.0, 20.0, 29.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0, 18.0, 5.0, 100.0, 40.0, 80.0, 10.0, 10.0, -1.0, 28.0, 60.0, 60.0, 25.0, 20.0, 10.0, 50.0, 16.0, 70.0, 20.0, 50.0, 9.0, 90.0, 20.0, 50.0, -10.0, 100.0, 29.0, 10.0, 45.0, 60.0, 0.0, 90.0, 60.0, 60.0, 90.0, 39.0, 40.0, 40.0, 30.0, 20.0, 70.0, 0.0, 30.0, 50.0, 90.0, 30.0, 0.0, 60.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 20.0, 50.0, 80.0, 3.0, 50.0, 28.0, 100.0, 30.0, 20.0, 30.0, 14.0, -2.0, 90.0, 50.0, 20.0, 30.0, 5.0, 70.0, 30.0, 40.0, 110.0, 60.0, 50.0, 60.0, 30.0, 27.0, 40.0, 10.0, 80.0, 40.0, 20.0, 50.0, 60.0, 20.0, 60.0, 20.0, 40.0, 60.0, 31.0, -8.0, 10.0, 110.0, 30.0, 40.0, 10.0, 40.0, 90.0, 60.0, 30.0, 40.0, 10.0, 60.0, 30.0, 10.0, 70.0, 50.0, 70.0, 0.0, 20.0, 40.0, 18.0, 0.0, 10.0, 0.0, 10.0, 9.0, 37.0, 50.0, 60.0, 30.0, 21.0, 25.0, 70.0, 40.0, 20.0, 0.0, -1.0, 10.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 50.0, 10.0, 20.0, 10.0, 20.0, 29.0, 54.0, 60.0, 10.0, 30.0, 20.0, 28.0, 110.0, 60.0, 40.0, 40.0, 40.0, 15.0, 40.0, 0.0, 0.0, 90.0, 70.0, 110.0, 70.0, 20.0, 20.0, 18.0, 30.0, 50.0, 60.0, 60.0, 18.0, 20.0, 70.0, 60.0, 30.0, 15.0, 40.0, 70.0, 110.0, 54.0, 20.0, 40.0, 10.0, 80.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 10.0, 90.0, 70.0, 50.0, 19.0, 24.0, 50.0, 100.0, 90.0, 100.0, 80.0, -1.0, 40.0, 20.0, 10.0, 60.0, 70.0, 20.0, 30.0, 19.0, 30.0, 50.0, 40.0, 9.0, 70.0, 30.0, 20.0, 80.0, 9.0, 40.0, 50.0, 16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0, 10.0, 30.0, 8.0, 15.0, -3.0, 70.0, 59.0, 59.0, 19.0, 60.0, 9.0, 20.0, 36.0, 20.0, 9.0, -3.0, 20.0, 33.0, 80.0, -12.0, 70.0, 60.0, 70.0, 80.0, 30.0, 50.0, 40.0, 30.0, 50.0, 70.0, 14.0, 60.0, -6.0, 30.0, 80.0, 9.0, 60.0, 80.0, -2.0, 10.0, 30.0, 70.0, 60.0, 80.0, 10.0, 40.0, 50.0, 60.0, 50.0, 70.0, 90.0, 60.0, 30.0, 10.0, 30.0, 18.0, 10.0, 30.0, 30.0, 60.0, 50.0, 60.0, 10.0, 50.0, 50.0, 40.0, 30.0, 50.0, 50.0, 40.0, 40.0, 9.0, 30.0, 60.0, 0.0, 50.0, 70.0, 50.0, 40.0, 80.0, -4.0, 26.0, 110.0, 100.0, 59.0, 50.0, 40.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 30.0, 30.0, 10.0, 20.0, 60.0, 70.0, 80.0, 40.0, 9.0, 10.0, 30.0, 40.0, 20.0, 40.0, 50.0, 9.0, 60.0, 70.0, 50.0, 10.0, 7.0, 50.0, 0.0, 40.0, 40.0, 19.0, 10.0, 30.0, 70.0, 60.0, 80.0, 40.0, 20.0, 40.0, 47.0, 17.0, -50.0, 100.0, 10.0, 100.0, 20.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 60.0, 30.0, 50.0, 40.0, 60.0, 100.0, 60.0, 30.0, 70.0, 20.0, 30.0, 100.0, 50.0, 80.0, 70.0, 0.0, 0.0, 40.0, 10.0, 50.0, 80.0, 30.0, 19.0, 30.0, 50.0, 10.0, 90.0, 50.0, 33.0, 43.0, 0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0, 10.0, 50.0, 0.0, 20.0, 60.0, 20.0, 30.0, 6.0, 30.0, 40.0, 30.0, -5.0, 80.0, 50.0, 30.0, 50.0, 10.0, 39.0, 20.0, 60.0, 40.0, 39.0, 30.0, 30.0, 0.0, 70.0, 20.0, 50.0, 40.0, 40.0, 70.0, 40.0, 80.0, 90.0, 20.0, 30.0, 110.0, 20.0, 70.0, 60.0, 10.0, 80.0, 10.0, 40.0, -4.0, 80.0, 10.0, 40.0, 60.0, 50.0, 40.0, 60.0, 40.0, 30.0, 60.0, 39.0, 20.0, 20.0, 100.0, 53.0, 30.0, 60.0, 30.0, 50.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 60.0, 20.0, 100.0, 80.0, 20.0, 10.0, 60.0, 34.0, 0.0, 14.0, 70.0, 30.0, 30.0, 40.0, 40.0, 90.0, 25.0, 50.0, 20.0, 19.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 40.0, 90.0, 60.0, 70.0, 8.0, 80.0, 80.0, 50.0, 80.0, -2.0, 33.0, -1.0, 9.0, 0.0, -2.0, 20.0, 10.0, 49.0, 10.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 90.0, 9.0, 28.0, 30.0, 19.0, 50.0, 20.0, 70.0, 40.0, 2.0, 12.0, 0.0, 10.0, 80.0, 50.0, 30.0, 8.0, 20.0, 20.0, 50.0, 0.0, -15.0, 30.0, 30.0, 30.0, 20.0, 30.0, 58.0, -2.0, 90.0, 20.0, 40.0, -11.0, 20.0, 40.0, 17.0, 80.0, 9.0, 0.0, 100.0, 60.0, 100.0, 40.0, 90.0, 29.0, 19.0, 110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6496895278296375, "mean_inference_ms": 1.6884103190502446, "mean_action_processing_ms": 0.5291848174310538, "mean_env_wait_ms": 1.4683841802100859, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012122154235839844, "StateBufferConnector_ms": 0.009357213973999023, "ViewRequirementAgentConnector_ms": 0.3658759593963623}, "num_episodes": 18, "episode_return_max": 699.0, "episode_return_min": 125.0, "episode_return_mean": 394.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.597594803756394, "num_env_steps_trained_throughput_per_sec": 21.597594803756394, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 185299.445, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185299.392, "sample_time_ms": 2497.096, "learn_time_ms": 182780.466, "learn_throughput": 21.884, "synch_weights_time_ms": 13.121}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "a22d3_00000", "date": "2024-08-06_02-02-19", "timestamp": 1722924139, "time_this_iter_s": 185.2150101661682, "time_total_s": 11931.587867736816, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20bd0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11931.587867736816, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.936641221374046, "ram_util_percent": 78.5583969465649}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7810465132593474, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.964711813525524, "policy_loss": -0.009475939213154446, "vf_loss": 4.9725526022581, "vf_explained_var": 0.0010839126996211985, "kl": 0.00817574759952535, "entropy": 0.7018383734523298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 673.0, "episode_reward_min": 125.0, "episode_reward_mean": 406.19, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 40.619}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.0, 500.0, 378.0, 493.0, 427.0, 225.0, 408.0, 550.0, 417.0, 270.0, 480.0, 443.0, 535.0, 568.0, 527.0, 387.0, 279.0, 249.0, 366.0, 350.0, 330.0, 394.0, 539.0, 360.0, 451.0, 287.0, 517.0, 400.0, 413.0, 430.0, 144.0, 315.0, 290.0, 371.0, 395.0, 456.0, 489.0, 310.0, 673.0, 298.0, 398.0, 428.0, 327.0, 212.0, 550.0, 335.0, 520.0, 368.0, 430.0, 429.0, 531.0, 430.0, 308.0, 296.0, 354.0, 400.0, 520.0, 430.0, 435.0, 533.0, 266.0, 364.0, 359.0, 590.0, 376.0, 462.0, 380.0, 398.0, 414.0, 180.0, 549.0, 125.0, 346.0, 314.0, 193.0, 302.0, 527.0, 483.0, 470.0, 380.0, 559.0, 430.0, 457.0, 481.0, 598.0, 450.0, 579.0, 479.0, 570.0, 480.0, 339.0, 211.0, 357.0, 470.0, 299.0, 390.0, 480.0, 413.0, 178.0, 530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 60.0, 70.0, 7.0, 40.0, 10.0, 30.0, 40.0, 36.0, 60.0, 70.0, 20.0, 60.0, 50.0, 40.0, 40.0, 60.0, 70.0, 40.0, 50.0, -25.0, -4.0, 60.0, 22.0, 16.0, 70.0, 90.0, 28.0, 80.0, 41.0, 90.0, 80.0, 50.0, 40.0, 10.0, 5.0, 70.0, 80.0, 60.0, 8.0, 50.0, 50.0, 50.0, -5.0, 29.0, 50.0, 90.0, 29.0, 24.0, 60.0, 8.0, 0.0, 20.0, 10.0, 30.0, 30.0, 30.0, 7.0, 40.0, 50.0, 50.0, 70.0, -10.0, 1.0, 39.0, 40.0, 29.0, 90.0, 9.0, 90.0, 100.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 50.0, 70.0, 20.0, 20.0, 28.0, 30.0, 10.0, 80.0, -2.0, 30.0, 90.0, 40.0, 91.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 60.0, 20.0, 10.0, 90.0, 100.0, 30.0, 20.0, 70.0, 30.0, 60.0, 20.0, 50.0, 10.0, 30.0, 45.0, 84.0, 20.0, 75.0, 60.0, 60.0, 10.0, 40.0, 19.0, 20.0, 80.0, 60.0, 40.0, 50.0, 65.0, 50.0, 90.0, 20.0, 60.0, 60.0, 70.0, 80.0, 18.0, 30.0, 60.0, 70.0, 40.0, 70.0, 70.0, 80.0, 20.0, 130.0, 57.0, 14.0, 40.0, 20.0, 80.0, 70.0, 16.0, 40.0, 27.0, 50.0, 0.0, 10.0, 60.0, 30.0, 11.0, 130.0, 29.0, 40.0, 30.0, 10.0, 39.0, 40.0, 20.0, 0.0, 40.0, 10.0, 50.0, 40.0, 10.0, 20.0, 29.0, 20.0, 0.0, 10.0, 30.0, 50.0, 40.0, 20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0, 18.0, 5.0, 100.0, 40.0, 80.0, 10.0, 10.0, -1.0, 28.0, 60.0, 60.0, 25.0, 20.0, 10.0, 50.0, 16.0, 70.0, 20.0, 50.0, 9.0, 90.0, 20.0, 50.0, -10.0, 100.0, 29.0, 10.0, 45.0, 60.0, 0.0, 90.0, 60.0, 60.0, 90.0, 39.0, 40.0, 40.0, 30.0, 20.0, 70.0, 0.0, 30.0, 50.0, 90.0, 30.0, 0.0, 60.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 20.0, 50.0, 80.0, 3.0, 50.0, 28.0, 100.0, 30.0, 20.0, 30.0, 14.0, -2.0, 90.0, 50.0, 20.0, 30.0, 5.0, 70.0, 30.0, 40.0, 110.0, 60.0, 50.0, 60.0, 30.0, 27.0, 40.0, 10.0, 80.0, 40.0, 20.0, 50.0, 60.0, 20.0, 60.0, 20.0, 40.0, 60.0, 31.0, -8.0, 10.0, 110.0, 30.0, 40.0, 10.0, 40.0, 90.0, 60.0, 30.0, 40.0, 10.0, 60.0, 30.0, 10.0, 70.0, 50.0, 70.0, 0.0, 20.0, 40.0, 18.0, 0.0, 10.0, 0.0, 10.0, 9.0, 37.0, 50.0, 60.0, 30.0, 21.0, 25.0, 70.0, 40.0, 20.0, 0.0, -1.0, 10.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 50.0, 10.0, 20.0, 10.0, 20.0, 29.0, 54.0, 60.0, 10.0, 30.0, 20.0, 28.0, 110.0, 60.0, 40.0, 40.0, 40.0, 15.0, 40.0, 0.0, 0.0, 90.0, 70.0, 110.0, 70.0, 20.0, 20.0, 18.0, 30.0, 50.0, 60.0, 60.0, 18.0, 20.0, 70.0, 60.0, 30.0, 15.0, 40.0, 70.0, 110.0, 54.0, 20.0, 40.0, 10.0, 80.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 10.0, 90.0, 70.0, 50.0, 19.0, 24.0, 50.0, 100.0, 90.0, 100.0, 80.0, -1.0, 40.0, 20.0, 10.0, 60.0, 70.0, 20.0, 30.0, 19.0, 30.0, 50.0, 40.0, 9.0, 70.0, 30.0, 20.0, 80.0, 9.0, 40.0, 50.0, 16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0, 10.0, 30.0, 8.0, 15.0, -3.0, 70.0, 59.0, 59.0, 19.0, 60.0, 9.0, 20.0, 36.0, 20.0, 9.0, -3.0, 20.0, 33.0, 80.0, -12.0, 70.0, 60.0, 70.0, 80.0, 30.0, 50.0, 40.0, 30.0, 50.0, 70.0, 14.0, 60.0, -6.0, 30.0, 80.0, 9.0, 60.0, 80.0, -2.0, 10.0, 30.0, 70.0, 60.0, 80.0, 10.0, 40.0, 50.0, 60.0, 50.0, 70.0, 90.0, 60.0, 30.0, 10.0, 30.0, 18.0, 10.0, 30.0, 30.0, 60.0, 50.0, 60.0, 10.0, 50.0, 50.0, 40.0, 30.0, 50.0, 50.0, 40.0, 40.0, 9.0, 30.0, 60.0, 0.0, 50.0, 70.0, 50.0, 40.0, 80.0, -4.0, 26.0, 110.0, 100.0, 59.0, 50.0, 40.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 30.0, 30.0, 10.0, 20.0, 60.0, 70.0, 80.0, 40.0, 9.0, 10.0, 30.0, 40.0, 20.0, 40.0, 50.0, 9.0, 60.0, 70.0, 50.0, 10.0, 7.0, 50.0, 0.0, 40.0, 40.0, 19.0, 10.0, 30.0, 70.0, 60.0, 80.0, 40.0, 20.0, 40.0, 47.0, 17.0, -50.0, 100.0, 10.0, 100.0, 20.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 60.0, 30.0, 50.0, 40.0, 60.0, 100.0, 60.0, 30.0, 70.0, 20.0, 30.0, 100.0, 50.0, 80.0, 70.0, 0.0, 0.0, 40.0, 10.0, 50.0, 80.0, 30.0, 19.0, 30.0, 50.0, 10.0, 90.0, 50.0, 33.0, 43.0, 0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0, 10.0, 50.0, 0.0, 20.0, 60.0, 20.0, 30.0, 6.0, 30.0, 40.0, 30.0, -5.0, 80.0, 50.0, 30.0, 50.0, 10.0, 39.0, 20.0, 60.0, 40.0, 39.0, 30.0, 30.0, 0.0, 70.0, 20.0, 50.0, 40.0, 40.0, 70.0, 40.0, 80.0, 90.0, 20.0, 30.0, 110.0, 20.0, 70.0, 60.0, 10.0, 80.0, 10.0, 40.0, -4.0, 80.0, 10.0, 40.0, 60.0, 50.0, 40.0, 60.0, 40.0, 30.0, 60.0, 39.0, 20.0, 20.0, 100.0, 53.0, 30.0, 60.0, 30.0, 50.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 60.0, 20.0, 100.0, 80.0, 20.0, 10.0, 60.0, 34.0, 0.0, 14.0, 70.0, 30.0, 30.0, 40.0, 40.0, 90.0, 25.0, 50.0, 20.0, 19.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 40.0, 90.0, 60.0, 70.0, 8.0, 80.0, 80.0, 50.0, 80.0, -2.0, 33.0, -1.0, 9.0, 0.0, -2.0, 20.0, 10.0, 49.0, 10.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 90.0, 9.0, 28.0, 30.0, 19.0, 50.0, 20.0, 70.0, 40.0, 2.0, 12.0, 0.0, 10.0, 80.0, 50.0, 30.0, 8.0, 20.0, 20.0, 50.0, 0.0, -15.0, 30.0, 30.0, 30.0, 20.0, 30.0, 58.0, -2.0, 90.0, 20.0, 40.0, -11.0, 20.0, 40.0, 17.0, 80.0, 9.0, 0.0, 100.0, 60.0, 100.0, 40.0, 90.0, 29.0, 19.0, 110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0, 20.0, 40.0, 20.0, 70.0, 50.0, 10.0, 60.0, 70.0, 80.0, 50.0, 70.0, 40.0, 20.0, 50.0, 50.0, 20.0, 20.0, 30.0, 30.0, 50.0, 60.0, 70.0, 49.0, 0.0, 70.0, 80.0, 60.0, 20.0, 90.0, 60.0, 100.0, 50.0, 40.0, 50.0, 50.0, 50.0, 30.0, 50.0, 16.0, -6.0, 100.0, 29.0, 40.0, 5.0, 80.0, 120.0, 50.0, 34.0, -26.0, 25.0, 60.0, 60.0, 39.0, 80.0, 32.0, 30.0, 30.0, 60.0, 60.0, 30.0, 70.0, 30.0, 60.0, 69.0, 70.0, 40.0, 60.0, 20.0, 99.0, 80.0, 0.0, 30.0, 50.0, 40.0, 140.0, 60.0, 10.0, 20.0, 40.0, 60.0, 100.0, 49.0, 40.0, 100.0, 50.0, 70.0, 70.0, 40.0, 30.0, 30.0, 10.0, 60.0, 40.0, 50.0, 39.0, 30.0, 50.0, 20.0, 120.0, 60.0, 60.0, 110.0, 80.0, 50.0, 40.0, 20.0, 10.0, 100.0, 60.0, 40.0, 50.0, 40.0, 50.0, 30.0, 60.0, 20.0, 30.0, 70.0, 110.0, 20.0, 20.0, 10.0, 70.0, 29.0, 60.0, 70.0, 20.0, 40.0, 35.0, -15.0, 3.0, 20.0, 0.0, 20.0, 0.0, 8.0, 100.0, 30.0, 20.0, 10.0, 30.0, 2.0, 40.0, 50.0, 50.0, 37.0, 10.0, 29.0, 60.0, 49.0, 90.0, 80.0, 70.0, 10.0, 0.0, 40.0, 10.0, 20.0, 140.0, 10.0, 0.0, 80.0, 30.0, 20.0, 9.0, 20.0, 30.0, 50.0, 0.0, 60.0, 30.0, 40.0, 50.0, 20.0, 50.0, 20.0, 60.0, 50.0, 20.0, 50.0, 70.0, 40.0, 40.0, 40.0, 40.0, 20.0, 30.0, 90.0, 60.0, 50.0, 10.0, 80.0, 60.0, 70.0, 20.0, 50.0, 58.0, 40.0, 30.0, -5.0, 0.0, 10.0, 10.0, 35.0, -3.0, 20.0, 6.0, 90.0, 10.0, 0.0, 22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.644340860472977, "mean_inference_ms": 1.6824621612939823, "mean_action_processing_ms": 0.5272326277701701, "mean_env_wait_ms": 1.4639836690785462, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011922836303710938, "StateBufferConnector_ms": 0.009238958358764648, "ViewRequirementAgentConnector_ms": 0.36168456077575684}, "num_episodes": 22, "episode_return_max": 673.0, "episode_return_min": 125.0, "episode_return_mean": 406.19}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.548595757989602, "num_env_steps_trained_throughput_per_sec": 21.548595757989602, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 185395.398, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185395.346, "sample_time_ms": 2483.105, "learn_time_ms": 182890.666, "learn_throughput": 21.871, "synch_weights_time_ms": 13.014}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "a22d3_00000", "date": "2024-08-06_02-05-25", "timestamp": 1722924325, "time_this_iter_s": 185.63335800170898, "time_total_s": 12117.221225738525, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20bdee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12117.221225738525, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.722053231939164, "ram_util_percent": 78.68250950570345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8698271855886497, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.439462061456471, "policy_loss": -0.010262815523914956, "vf_loss": 5.448130371979377, "vf_explained_var": 0.00845923767176172, "kl": 0.00797250888006132, "entropy": 0.6712435462921699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 716.0, "episode_reward_min": 125.0, "episode_reward_mean": 410.38, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 41.038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.0, 350.0, 330.0, 394.0, 539.0, 360.0, 451.0, 287.0, 517.0, 400.0, 413.0, 430.0, 144.0, 315.0, 290.0, 371.0, 395.0, 456.0, 489.0, 310.0, 673.0, 298.0, 398.0, 428.0, 327.0, 212.0, 550.0, 335.0, 520.0, 368.0, 430.0, 429.0, 531.0, 430.0, 308.0, 296.0, 354.0, 400.0, 520.0, 430.0, 435.0, 533.0, 266.0, 364.0, 359.0, 590.0, 376.0, 462.0, 380.0, 398.0, 414.0, 180.0, 549.0, 125.0, 346.0, 314.0, 193.0, 302.0, 527.0, 483.0, 470.0, 380.0, 559.0, 430.0, 457.0, 481.0, 598.0, 450.0, 579.0, 479.0, 570.0, 480.0, 339.0, 211.0, 357.0, 470.0, 299.0, 390.0, 480.0, 413.0, 178.0, 530.0, 641.0, 500.0, 332.0, 379.0, 384.0, 380.0, 250.0, 527.0, 610.0, 300.0, 490.0, 490.0, 321.0, 383.0, 390.0, 325.0, 580.0, 716.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 50.0, 30.0, 30.0, 60.0, 16.0, 40.0, 70.0, 10.0, 40.0, 18.0, 5.0, 100.0, 40.0, 80.0, 10.0, 10.0, -1.0, 28.0, 60.0, 60.0, 25.0, 20.0, 10.0, 50.0, 16.0, 70.0, 20.0, 50.0, 9.0, 90.0, 20.0, 50.0, -10.0, 100.0, 29.0, 10.0, 45.0, 60.0, 0.0, 90.0, 60.0, 60.0, 90.0, 39.0, 40.0, 40.0, 30.0, 20.0, 70.0, 0.0, 30.0, 50.0, 90.0, 30.0, 0.0, 60.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 20.0, 50.0, 80.0, 3.0, 50.0, 28.0, 100.0, 30.0, 20.0, 30.0, 14.0, -2.0, 90.0, 50.0, 20.0, 30.0, 5.0, 70.0, 30.0, 40.0, 110.0, 60.0, 50.0, 60.0, 30.0, 27.0, 40.0, 10.0, 80.0, 40.0, 20.0, 50.0, 60.0, 20.0, 60.0, 20.0, 40.0, 60.0, 31.0, -8.0, 10.0, 110.0, 30.0, 40.0, 10.0, 40.0, 90.0, 60.0, 30.0, 40.0, 10.0, 60.0, 30.0, 10.0, 70.0, 50.0, 70.0, 0.0, 20.0, 40.0, 18.0, 0.0, 10.0, 0.0, 10.0, 9.0, 37.0, 50.0, 60.0, 30.0, 21.0, 25.0, 70.0, 40.0, 20.0, 0.0, -1.0, 10.0, 0.0, 10.0, 40.0, 30.0, 100.0, 20.0, 50.0, 10.0, 20.0, 10.0, 20.0, 29.0, 54.0, 60.0, 10.0, 30.0, 20.0, 28.0, 110.0, 60.0, 40.0, 40.0, 40.0, 15.0, 40.0, 0.0, 0.0, 90.0, 70.0, 110.0, 70.0, 20.0, 20.0, 18.0, 30.0, 50.0, 60.0, 60.0, 18.0, 20.0, 70.0, 60.0, 30.0, 15.0, 40.0, 70.0, 110.0, 54.0, 20.0, 40.0, 10.0, 80.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 10.0, 90.0, 70.0, 50.0, 19.0, 24.0, 50.0, 100.0, 90.0, 100.0, 80.0, -1.0, 40.0, 20.0, 10.0, 60.0, 70.0, 20.0, 30.0, 19.0, 30.0, 50.0, 40.0, 9.0, 70.0, 30.0, 20.0, 80.0, 9.0, 40.0, 50.0, 16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0, 10.0, 30.0, 8.0, 15.0, -3.0, 70.0, 59.0, 59.0, 19.0, 60.0, 9.0, 20.0, 36.0, 20.0, 9.0, -3.0, 20.0, 33.0, 80.0, -12.0, 70.0, 60.0, 70.0, 80.0, 30.0, 50.0, 40.0, 30.0, 50.0, 70.0, 14.0, 60.0, -6.0, 30.0, 80.0, 9.0, 60.0, 80.0, -2.0, 10.0, 30.0, 70.0, 60.0, 80.0, 10.0, 40.0, 50.0, 60.0, 50.0, 70.0, 90.0, 60.0, 30.0, 10.0, 30.0, 18.0, 10.0, 30.0, 30.0, 60.0, 50.0, 60.0, 10.0, 50.0, 50.0, 40.0, 30.0, 50.0, 50.0, 40.0, 40.0, 9.0, 30.0, 60.0, 0.0, 50.0, 70.0, 50.0, 40.0, 80.0, -4.0, 26.0, 110.0, 100.0, 59.0, 50.0, 40.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 30.0, 30.0, 10.0, 20.0, 60.0, 70.0, 80.0, 40.0, 9.0, 10.0, 30.0, 40.0, 20.0, 40.0, 50.0, 9.0, 60.0, 70.0, 50.0, 10.0, 7.0, 50.0, 0.0, 40.0, 40.0, 19.0, 10.0, 30.0, 70.0, 60.0, 80.0, 40.0, 20.0, 40.0, 47.0, 17.0, -50.0, 100.0, 10.0, 100.0, 20.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 60.0, 30.0, 50.0, 40.0, 60.0, 100.0, 60.0, 30.0, 70.0, 20.0, 30.0, 100.0, 50.0, 80.0, 70.0, 0.0, 0.0, 40.0, 10.0, 50.0, 80.0, 30.0, 19.0, 30.0, 50.0, 10.0, 90.0, 50.0, 33.0, 43.0, 0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0, 10.0, 50.0, 0.0, 20.0, 60.0, 20.0, 30.0, 6.0, 30.0, 40.0, 30.0, -5.0, 80.0, 50.0, 30.0, 50.0, 10.0, 39.0, 20.0, 60.0, 40.0, 39.0, 30.0, 30.0, 0.0, 70.0, 20.0, 50.0, 40.0, 40.0, 70.0, 40.0, 80.0, 90.0, 20.0, 30.0, 110.0, 20.0, 70.0, 60.0, 10.0, 80.0, 10.0, 40.0, -4.0, 80.0, 10.0, 40.0, 60.0, 50.0, 40.0, 60.0, 40.0, 30.0, 60.0, 39.0, 20.0, 20.0, 100.0, 53.0, 30.0, 60.0, 30.0, 50.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 60.0, 20.0, 100.0, 80.0, 20.0, 10.0, 60.0, 34.0, 0.0, 14.0, 70.0, 30.0, 30.0, 40.0, 40.0, 90.0, 25.0, 50.0, 20.0, 19.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 40.0, 90.0, 60.0, 70.0, 8.0, 80.0, 80.0, 50.0, 80.0, -2.0, 33.0, -1.0, 9.0, 0.0, -2.0, 20.0, 10.0, 49.0, 10.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 90.0, 9.0, 28.0, 30.0, 19.0, 50.0, 20.0, 70.0, 40.0, 2.0, 12.0, 0.0, 10.0, 80.0, 50.0, 30.0, 8.0, 20.0, 20.0, 50.0, 0.0, -15.0, 30.0, 30.0, 30.0, 20.0, 30.0, 58.0, -2.0, 90.0, 20.0, 40.0, -11.0, 20.0, 40.0, 17.0, 80.0, 9.0, 0.0, 100.0, 60.0, 100.0, 40.0, 90.0, 29.0, 19.0, 110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0, 20.0, 40.0, 20.0, 70.0, 50.0, 10.0, 60.0, 70.0, 80.0, 50.0, 70.0, 40.0, 20.0, 50.0, 50.0, 20.0, 20.0, 30.0, 30.0, 50.0, 60.0, 70.0, 49.0, 0.0, 70.0, 80.0, 60.0, 20.0, 90.0, 60.0, 100.0, 50.0, 40.0, 50.0, 50.0, 50.0, 30.0, 50.0, 16.0, -6.0, 100.0, 29.0, 40.0, 5.0, 80.0, 120.0, 50.0, 34.0, -26.0, 25.0, 60.0, 60.0, 39.0, 80.0, 32.0, 30.0, 30.0, 60.0, 60.0, 30.0, 70.0, 30.0, 60.0, 69.0, 70.0, 40.0, 60.0, 20.0, 99.0, 80.0, 0.0, 30.0, 50.0, 40.0, 140.0, 60.0, 10.0, 20.0, 40.0, 60.0, 100.0, 49.0, 40.0, 100.0, 50.0, 70.0, 70.0, 40.0, 30.0, 30.0, 10.0, 60.0, 40.0, 50.0, 39.0, 30.0, 50.0, 20.0, 120.0, 60.0, 60.0, 110.0, 80.0, 50.0, 40.0, 20.0, 10.0, 100.0, 60.0, 40.0, 50.0, 40.0, 50.0, 30.0, 60.0, 20.0, 30.0, 70.0, 110.0, 20.0, 20.0, 10.0, 70.0, 29.0, 60.0, 70.0, 20.0, 40.0, 35.0, -15.0, 3.0, 20.0, 0.0, 20.0, 0.0, 8.0, 100.0, 30.0, 20.0, 10.0, 30.0, 2.0, 40.0, 50.0, 50.0, 37.0, 10.0, 29.0, 60.0, 49.0, 90.0, 80.0, 70.0, 10.0, 0.0, 40.0, 10.0, 20.0, 140.0, 10.0, 0.0, 80.0, 30.0, 20.0, 9.0, 20.0, 30.0, 50.0, 0.0, 60.0, 30.0, 40.0, 50.0, 20.0, 50.0, 20.0, 60.0, 50.0, 20.0, 50.0, 70.0, 40.0, 40.0, 40.0, 40.0, 20.0, 30.0, 90.0, 60.0, 50.0, 10.0, 80.0, 60.0, 70.0, 20.0, 50.0, 58.0, 40.0, 30.0, -5.0, 0.0, 10.0, 10.0, 35.0, -3.0, 20.0, 6.0, 90.0, 10.0, 0.0, 22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0, 70.0, 70.0, 80.0, 50.0, 70.0, 40.0, 40.0, 70.0, 36.0, 115.0, 60.0, 20.0, 70.0, 70.0, 70.0, 30.0, 100.0, 30.0, 40.0, 10.0, 30.0, 80.0, 4.0, 10.0, 56.0, 60.0, -8.0, 50.0, 30.0, 20.0, 10.0, 50.0, 0.0, 19.0, 30.0, 20.0, 80.0, 50.0, 50.0, 70.0, 50.0, 80.0, 10.0, 40.0, 0.0, 30.0, 70.0, 24.0, 40.0, 40.0, 60.0, 105.0, 20.0, 7.0, 20.0, 10.0, 29.0, 19.0, 100.0, 10.0, 40.0, 9.0, 30.0, 39.0, 60.0, -9.0, 20.0, -19.0, 30.0, 50.0, 89.0, 60.0, 50.0, 40.0, 80.0, 30.0, 8.0, 70.0, 80.0, 20.0, 70.0, 40.0, 30.0, 70.0, 40.0, 20.0, 80.0, 90.0, 50.0, 120.0, 50.0, 30.0, 30.0, 40.0, 10.0, 40.0, 20.0, 10.0, 50.0, 20.0, 50.0, 40.0, 10.0, 50.0, 60.0, 70.0, 10.0, 70.0, 90.0, 40.0, 50.0, 10.0, 30.0, 80.0, 70.0, 20.0, 50.0, 30.0, 70.0, 80.0, 0.0, 37.0, 60.0, -5.0, 0.0, -90.0, 119.0, 90.0, 100.0, 10.0, 19.0, 60.0, 30.0, 40.0, 9.0, 100.0, 30.0, 17.0, 50.0, 28.0, 60.0, 68.0, 40.0, 11.0, 40.0, 10.0, 10.0, 60.0, 61.0, 30.0, 39.0, 51.0, 40.0, 17.0, 50.0, 69.0, 19.0, 10.0, 20.0, 10.0, 80.0, 50.0, 40.0, 20.0, 90.0, 50.0, 90.0, 40.0, 50.0, 70.0, 100.0, 60.0, 66.0, 25.0, 90.0, 130.0, 67.0, 90.0, 60.0, 28.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6422634482175167, "mean_inference_ms": 1.679403899156016, "mean_action_processing_ms": 0.5259972754929505, "mean_env_wait_ms": 1.4606241267702476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011748075485229492, "StateBufferConnector_ms": 0.009312868118286133, "ViewRequirementAgentConnector_ms": 0.3682987689971924}, "num_episodes": 18, "episode_return_max": 716.0, "episode_return_min": 125.0, "episode_return_mean": 410.38}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.603015487182294, "num_env_steps_trained_throughput_per_sec": 21.603015487182294, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 185344.549, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185344.497, "sample_time_ms": 2479.393, "learn_time_ms": 182843.689, "learn_throughput": 21.877, "synch_weights_time_ms": 13.053}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "a22d3_00000", "date": "2024-08-06_02-08-30", "timestamp": 1722924510, "time_this_iter_s": 185.16667532920837, "time_total_s": 12302.387901067734, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a015dc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12302.387901067734, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 17.245801526717557, "ram_util_percent": 78.73282442748092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9917928121341304, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.674416980423485, "policy_loss": -0.011660891804344261, "vf_loss": 4.684276470132529, "vf_explained_var": 0.006828090431083378, "kl": 0.00900702081393178, "entropy": 0.7117141616039764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 716.0, "episode_reward_min": 125.0, "episode_reward_mean": 413.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 41.355}, "custom_metrics": {}, "hist_stats": {"episode_reward": [428.0, 327.0, 212.0, 550.0, 335.0, 520.0, 368.0, 430.0, 429.0, 531.0, 430.0, 308.0, 296.0, 354.0, 400.0, 520.0, 430.0, 435.0, 533.0, 266.0, 364.0, 359.0, 590.0, 376.0, 462.0, 380.0, 398.0, 414.0, 180.0, 549.0, 125.0, 346.0, 314.0, 193.0, 302.0, 527.0, 483.0, 470.0, 380.0, 559.0, 430.0, 457.0, 481.0, 598.0, 450.0, 579.0, 479.0, 570.0, 480.0, 339.0, 211.0, 357.0, 470.0, 299.0, 390.0, 480.0, 413.0, 178.0, 530.0, 641.0, 500.0, 332.0, 379.0, 384.0, 380.0, 250.0, 527.0, 610.0, 300.0, 490.0, 490.0, 321.0, 383.0, 390.0, 325.0, 580.0, 716.0, 223.0, 185.0, 320.0, 200.0, 390.0, 376.0, 445.0, 587.0, 530.0, 330.0, 324.0, 560.0, 327.0, 569.0, 537.0, 433.0, 419.0, 190.0, 347.0, 546.0, 606.0, 449.0, 400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [16.0, -5.0, 57.0, 50.0, 10.0, 20.0, 100.0, 100.0, 60.0, 20.0, 10.0, 30.0, 8.0, 15.0, -3.0, 70.0, 59.0, 59.0, 19.0, 60.0, 9.0, 20.0, 36.0, 20.0, 9.0, -3.0, 20.0, 33.0, 80.0, -12.0, 70.0, 60.0, 70.0, 80.0, 30.0, 50.0, 40.0, 30.0, 50.0, 70.0, 14.0, 60.0, -6.0, 30.0, 80.0, 9.0, 60.0, 80.0, -2.0, 10.0, 30.0, 70.0, 60.0, 80.0, 10.0, 40.0, 50.0, 60.0, 50.0, 70.0, 90.0, 60.0, 30.0, 10.0, 30.0, 18.0, 10.0, 30.0, 30.0, 60.0, 50.0, 60.0, 10.0, 50.0, 50.0, 40.0, 30.0, 50.0, 50.0, 40.0, 40.0, 9.0, 30.0, 60.0, 0.0, 50.0, 70.0, 50.0, 40.0, 80.0, -4.0, 26.0, 110.0, 100.0, 59.0, 50.0, 40.0, 60.0, 60.0, 30.0, 60.0, 50.0, 20.0, 30.0, 30.0, 10.0, 20.0, 60.0, 70.0, 80.0, 40.0, 9.0, 10.0, 30.0, 40.0, 20.0, 40.0, 50.0, 9.0, 60.0, 70.0, 50.0, 10.0, 7.0, 50.0, 0.0, 40.0, 40.0, 19.0, 10.0, 30.0, 70.0, 60.0, 80.0, 40.0, 20.0, 40.0, 47.0, 17.0, -50.0, 100.0, 10.0, 100.0, 20.0, 40.0, 40.0, 20.0, 60.0, 0.0, 10.0, 60.0, 30.0, 50.0, 40.0, 60.0, 100.0, 60.0, 30.0, 70.0, 20.0, 30.0, 100.0, 50.0, 80.0, 70.0, 0.0, 0.0, 40.0, 10.0, 50.0, 80.0, 30.0, 19.0, 30.0, 50.0, 10.0, 90.0, 50.0, 33.0, 43.0, 0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0, 10.0, 50.0, 0.0, 20.0, 60.0, 20.0, 30.0, 6.0, 30.0, 40.0, 30.0, -5.0, 80.0, 50.0, 30.0, 50.0, 10.0, 39.0, 20.0, 60.0, 40.0, 39.0, 30.0, 30.0, 0.0, 70.0, 20.0, 50.0, 40.0, 40.0, 70.0, 40.0, 80.0, 90.0, 20.0, 30.0, 110.0, 20.0, 70.0, 60.0, 10.0, 80.0, 10.0, 40.0, -4.0, 80.0, 10.0, 40.0, 60.0, 50.0, 40.0, 60.0, 40.0, 30.0, 60.0, 39.0, 20.0, 20.0, 100.0, 53.0, 30.0, 60.0, 30.0, 50.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 60.0, 20.0, 100.0, 80.0, 20.0, 10.0, 60.0, 34.0, 0.0, 14.0, 70.0, 30.0, 30.0, 40.0, 40.0, 90.0, 25.0, 50.0, 20.0, 19.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 40.0, 90.0, 60.0, 70.0, 8.0, 80.0, 80.0, 50.0, 80.0, -2.0, 33.0, -1.0, 9.0, 0.0, -2.0, 20.0, 10.0, 49.0, 10.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 90.0, 9.0, 28.0, 30.0, 19.0, 50.0, 20.0, 70.0, 40.0, 2.0, 12.0, 0.0, 10.0, 80.0, 50.0, 30.0, 8.0, 20.0, 20.0, 50.0, 0.0, -15.0, 30.0, 30.0, 30.0, 20.0, 30.0, 58.0, -2.0, 90.0, 20.0, 40.0, -11.0, 20.0, 40.0, 17.0, 80.0, 9.0, 0.0, 100.0, 60.0, 100.0, 40.0, 90.0, 29.0, 19.0, 110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0, 20.0, 40.0, 20.0, 70.0, 50.0, 10.0, 60.0, 70.0, 80.0, 50.0, 70.0, 40.0, 20.0, 50.0, 50.0, 20.0, 20.0, 30.0, 30.0, 50.0, 60.0, 70.0, 49.0, 0.0, 70.0, 80.0, 60.0, 20.0, 90.0, 60.0, 100.0, 50.0, 40.0, 50.0, 50.0, 50.0, 30.0, 50.0, 16.0, -6.0, 100.0, 29.0, 40.0, 5.0, 80.0, 120.0, 50.0, 34.0, -26.0, 25.0, 60.0, 60.0, 39.0, 80.0, 32.0, 30.0, 30.0, 60.0, 60.0, 30.0, 70.0, 30.0, 60.0, 69.0, 70.0, 40.0, 60.0, 20.0, 99.0, 80.0, 0.0, 30.0, 50.0, 40.0, 140.0, 60.0, 10.0, 20.0, 40.0, 60.0, 100.0, 49.0, 40.0, 100.0, 50.0, 70.0, 70.0, 40.0, 30.0, 30.0, 10.0, 60.0, 40.0, 50.0, 39.0, 30.0, 50.0, 20.0, 120.0, 60.0, 60.0, 110.0, 80.0, 50.0, 40.0, 20.0, 10.0, 100.0, 60.0, 40.0, 50.0, 40.0, 50.0, 30.0, 60.0, 20.0, 30.0, 70.0, 110.0, 20.0, 20.0, 10.0, 70.0, 29.0, 60.0, 70.0, 20.0, 40.0, 35.0, -15.0, 3.0, 20.0, 0.0, 20.0, 0.0, 8.0, 100.0, 30.0, 20.0, 10.0, 30.0, 2.0, 40.0, 50.0, 50.0, 37.0, 10.0, 29.0, 60.0, 49.0, 90.0, 80.0, 70.0, 10.0, 0.0, 40.0, 10.0, 20.0, 140.0, 10.0, 0.0, 80.0, 30.0, 20.0, 9.0, 20.0, 30.0, 50.0, 0.0, 60.0, 30.0, 40.0, 50.0, 20.0, 50.0, 20.0, 60.0, 50.0, 20.0, 50.0, 70.0, 40.0, 40.0, 40.0, 40.0, 20.0, 30.0, 90.0, 60.0, 50.0, 10.0, 80.0, 60.0, 70.0, 20.0, 50.0, 58.0, 40.0, 30.0, -5.0, 0.0, 10.0, 10.0, 35.0, -3.0, 20.0, 6.0, 90.0, 10.0, 0.0, 22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0, 70.0, 70.0, 80.0, 50.0, 70.0, 40.0, 40.0, 70.0, 36.0, 115.0, 60.0, 20.0, 70.0, 70.0, 70.0, 30.0, 100.0, 30.0, 40.0, 10.0, 30.0, 80.0, 4.0, 10.0, 56.0, 60.0, -8.0, 50.0, 30.0, 20.0, 10.0, 50.0, 0.0, 19.0, 30.0, 20.0, 80.0, 50.0, 50.0, 70.0, 50.0, 80.0, 10.0, 40.0, 0.0, 30.0, 70.0, 24.0, 40.0, 40.0, 60.0, 105.0, 20.0, 7.0, 20.0, 10.0, 29.0, 19.0, 100.0, 10.0, 40.0, 9.0, 30.0, 39.0, 60.0, -9.0, 20.0, -19.0, 30.0, 50.0, 89.0, 60.0, 50.0, 40.0, 80.0, 30.0, 8.0, 70.0, 80.0, 20.0, 70.0, 40.0, 30.0, 70.0, 40.0, 20.0, 80.0, 90.0, 50.0, 120.0, 50.0, 30.0, 30.0, 40.0, 10.0, 40.0, 20.0, 10.0, 50.0, 20.0, 50.0, 40.0, 10.0, 50.0, 60.0, 70.0, 10.0, 70.0, 90.0, 40.0, 50.0, 10.0, 30.0, 80.0, 70.0, 20.0, 50.0, 30.0, 70.0, 80.0, 0.0, 37.0, 60.0, -5.0, 0.0, -90.0, 119.0, 90.0, 100.0, 10.0, 19.0, 60.0, 30.0, 40.0, 9.0, 100.0, 30.0, 17.0, 50.0, 28.0, 60.0, 68.0, 40.0, 11.0, 40.0, 10.0, 10.0, 60.0, 61.0, 30.0, 39.0, 51.0, 40.0, 17.0, 50.0, 69.0, 19.0, 10.0, 20.0, 10.0, 80.0, 50.0, 40.0, 20.0, 90.0, 50.0, 90.0, 40.0, 50.0, 70.0, 100.0, 60.0, 66.0, 25.0, 90.0, 130.0, 67.0, 90.0, 60.0, 28.0, -60.0, 30.0, 20.0, 20.0, 19.0, -8.0, 73.0, 70.0, 29.0, 30.0, 40.0, 20.0, 20.0, 29.0, 0.0, 20.0, 0.0, 9.0, 37.0, 10.0, 10.0, 70.0, 0.0, 0.0, 20.0, 70.0, 30.0, 10.0, 50.0, 60.0, 30.0, 20.0, 50.0, 7.0, 0.0, 10.0, 37.0, 10.0, 20.0, 16.0, 50.0, 20.0, 60.0, 30.0, 40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 60.0, 19.0, 40.0, 40.0, 30.0, 90.0, 30.0, 40.0, 30.0, -3.0, 30.0, 50.0, 25.0, 10.0, 80.0, 60.0, 60.0, 60.0, 40.0, 30.0, 60.0, 90.0, 20.0, 60.0, 88.0, 40.0, 50.0, 60.0, 69.0, 50.0, 80.0, 100.0, 60.0, 20.0, 30.0, 50.0, 60.0, 60.0, 40.0, 30.0, 50.0, 40.0, 0.0, 30.0, 60.0, 50.0, 40.0, 0.0, 20.0, 40.0, 43.0, 34.0, 50.0, 10.0, 24.0, 10.0, 23.0, 60.0, 50.0, 20.0, 50.0, 30.0, 60.0, 80.0, 50.0, 50.0, 40.0, 80.0, 40.0, 80.0, 28.0, 30.0, 40.0, 20.0, 10.0, 40.0, 19.0, 50.0, 50.0, 40.0, -16.0, 89.0, 90.0, 80.0, 79.0, 30.0, 60.0, 90.0, 8.0, 59.0, 60.0, 110.0, 60.0, 23.0, 34.0, 19.0, 50.0, 31.0, 50.0, 100.0, 110.0, 30.0, 90.0, 29.0, 44.0, 10.0, 45.0, 22.0, 50.0, 3.0, 30.0, 13.0, 40.0, 110.0, 50.0, 28.0, 49.0, 70.0, 29.0, 0.0, 40.0, 10.0, 10.0, 10.0, 36.0, 3.0, 20.0, 30.0, 20.0, 11.0, 50.0, 50.0, 28.0, 20.0, 19.0, 70.0, 10.0, 70.0, 10.0, 20.0, 50.0, 60.0, 20.0, 7.0, 80.0, 60.0, 70.0, 110.0, 79.0, 10.0, 70.0, 100.0, 90.0, 50.0, 40.0, 27.0, 70.0, 29.0, 60.0, 70.0, 40.0, 50.0, 30.0, 40.0, 30.0, 20.0, 90.0, 29.0, 90.0, 30.0, 0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6377463496454192, "mean_inference_ms": 1.6734363577680684, "mean_action_processing_ms": 0.5241890655569652, "mean_env_wait_ms": 1.4562002561343517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012347936630249023, "StateBufferConnector_ms": 0.009384393692016602, "ViewRequirementAgentConnector_ms": 0.3875861167907715}, "num_episodes": 23, "episode_return_max": 716.0, "episode_return_min": 125.0, "episode_return_mean": 413.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.66292862540664, "num_env_steps_trained_throughput_per_sec": 21.66292862540664, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 185457.455, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185457.404, "sample_time_ms": 2426.395, "learn_time_ms": 183009.71, "learn_throughput": 21.857, "synch_weights_time_ms": 13.18}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "a22d3_00000", "date": "2024-08-06_02-11-35", "timestamp": 1722924695, "time_this_iter_s": 184.6544337272644, "time_total_s": 12487.042334794998, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12487.042334794998, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.059003831417623, "ram_util_percent": 78.88199233716475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1501994852313855, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.225958468637273, "policy_loss": -0.009959209954695373, "vf_loss": 5.234234588494062, "vf_explained_var": 0.016450130012723458, "kl": 0.00841545200274196, "entropy": 0.7053897287581549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 716.0, "episode_reward_min": 125.0, "episode_reward_mean": 410.94, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 41.094}, "custom_metrics": {}, "hist_stats": {"episode_reward": [533.0, 266.0, 364.0, 359.0, 590.0, 376.0, 462.0, 380.0, 398.0, 414.0, 180.0, 549.0, 125.0, 346.0, 314.0, 193.0, 302.0, 527.0, 483.0, 470.0, 380.0, 559.0, 430.0, 457.0, 481.0, 598.0, 450.0, 579.0, 479.0, 570.0, 480.0, 339.0, 211.0, 357.0, 470.0, 299.0, 390.0, 480.0, 413.0, 178.0, 530.0, 641.0, 500.0, 332.0, 379.0, 384.0, 380.0, 250.0, 527.0, 610.0, 300.0, 490.0, 490.0, 321.0, 383.0, 390.0, 325.0, 580.0, 716.0, 223.0, 185.0, 320.0, 200.0, 390.0, 376.0, 445.0, 587.0, 530.0, 330.0, 324.0, 560.0, 327.0, 569.0, 537.0, 433.0, 419.0, 190.0, 347.0, 546.0, 606.0, 449.0, 400.0, 281.0, 377.0, 475.0, 416.0, 269.0, 359.0, 264.0, 306.0, 570.0, 500.0, 545.0, 527.0, 397.0, 268.0, 416.0, 345.0, 174.0, 553.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 136.0, 70.0, 35.0, 29.0, 40.0, 40.0, 73.0, 50.0, 60.0, 10.0, 50.0, 0.0, 20.0, 60.0, 20.0, 30.0, 6.0, 30.0, 40.0, 30.0, -5.0, 80.0, 50.0, 30.0, 50.0, 10.0, 39.0, 20.0, 60.0, 40.0, 39.0, 30.0, 30.0, 0.0, 70.0, 20.0, 50.0, 40.0, 40.0, 70.0, 40.0, 80.0, 90.0, 20.0, 30.0, 110.0, 20.0, 70.0, 60.0, 10.0, 80.0, 10.0, 40.0, -4.0, 80.0, 10.0, 40.0, 60.0, 50.0, 40.0, 60.0, 40.0, 30.0, 60.0, 39.0, 20.0, 20.0, 100.0, 53.0, 30.0, 60.0, 30.0, 50.0, 40.0, 60.0, 40.0, 20.0, 40.0, 10.0, 60.0, 20.0, 100.0, 80.0, 20.0, 10.0, 60.0, 34.0, 0.0, 14.0, 70.0, 30.0, 30.0, 40.0, 40.0, 90.0, 25.0, 50.0, 20.0, 19.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 10.0, 10.0, 40.0, 90.0, 60.0, 70.0, 8.0, 80.0, 80.0, 50.0, 80.0, -2.0, 33.0, -1.0, 9.0, 0.0, -2.0, 20.0, 10.0, 49.0, 10.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 90.0, 9.0, 28.0, 30.0, 19.0, 50.0, 20.0, 70.0, 40.0, 2.0, 12.0, 0.0, 10.0, 80.0, 50.0, 30.0, 8.0, 20.0, 20.0, 50.0, 0.0, -15.0, 30.0, 30.0, 30.0, 20.0, 30.0, 58.0, -2.0, 90.0, 20.0, 40.0, -11.0, 20.0, 40.0, 17.0, 80.0, 9.0, 0.0, 100.0, 60.0, 100.0, 40.0, 90.0, 29.0, 19.0, 110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0, 20.0, 40.0, 20.0, 70.0, 50.0, 10.0, 60.0, 70.0, 80.0, 50.0, 70.0, 40.0, 20.0, 50.0, 50.0, 20.0, 20.0, 30.0, 30.0, 50.0, 60.0, 70.0, 49.0, 0.0, 70.0, 80.0, 60.0, 20.0, 90.0, 60.0, 100.0, 50.0, 40.0, 50.0, 50.0, 50.0, 30.0, 50.0, 16.0, -6.0, 100.0, 29.0, 40.0, 5.0, 80.0, 120.0, 50.0, 34.0, -26.0, 25.0, 60.0, 60.0, 39.0, 80.0, 32.0, 30.0, 30.0, 60.0, 60.0, 30.0, 70.0, 30.0, 60.0, 69.0, 70.0, 40.0, 60.0, 20.0, 99.0, 80.0, 0.0, 30.0, 50.0, 40.0, 140.0, 60.0, 10.0, 20.0, 40.0, 60.0, 100.0, 49.0, 40.0, 100.0, 50.0, 70.0, 70.0, 40.0, 30.0, 30.0, 10.0, 60.0, 40.0, 50.0, 39.0, 30.0, 50.0, 20.0, 120.0, 60.0, 60.0, 110.0, 80.0, 50.0, 40.0, 20.0, 10.0, 100.0, 60.0, 40.0, 50.0, 40.0, 50.0, 30.0, 60.0, 20.0, 30.0, 70.0, 110.0, 20.0, 20.0, 10.0, 70.0, 29.0, 60.0, 70.0, 20.0, 40.0, 35.0, -15.0, 3.0, 20.0, 0.0, 20.0, 0.0, 8.0, 100.0, 30.0, 20.0, 10.0, 30.0, 2.0, 40.0, 50.0, 50.0, 37.0, 10.0, 29.0, 60.0, 49.0, 90.0, 80.0, 70.0, 10.0, 0.0, 40.0, 10.0, 20.0, 140.0, 10.0, 0.0, 80.0, 30.0, 20.0, 9.0, 20.0, 30.0, 50.0, 0.0, 60.0, 30.0, 40.0, 50.0, 20.0, 50.0, 20.0, 60.0, 50.0, 20.0, 50.0, 70.0, 40.0, 40.0, 40.0, 40.0, 20.0, 30.0, 90.0, 60.0, 50.0, 10.0, 80.0, 60.0, 70.0, 20.0, 50.0, 58.0, 40.0, 30.0, -5.0, 0.0, 10.0, 10.0, 35.0, -3.0, 20.0, 6.0, 90.0, 10.0, 0.0, 22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0, 70.0, 70.0, 80.0, 50.0, 70.0, 40.0, 40.0, 70.0, 36.0, 115.0, 60.0, 20.0, 70.0, 70.0, 70.0, 30.0, 100.0, 30.0, 40.0, 10.0, 30.0, 80.0, 4.0, 10.0, 56.0, 60.0, -8.0, 50.0, 30.0, 20.0, 10.0, 50.0, 0.0, 19.0, 30.0, 20.0, 80.0, 50.0, 50.0, 70.0, 50.0, 80.0, 10.0, 40.0, 0.0, 30.0, 70.0, 24.0, 40.0, 40.0, 60.0, 105.0, 20.0, 7.0, 20.0, 10.0, 29.0, 19.0, 100.0, 10.0, 40.0, 9.0, 30.0, 39.0, 60.0, -9.0, 20.0, -19.0, 30.0, 50.0, 89.0, 60.0, 50.0, 40.0, 80.0, 30.0, 8.0, 70.0, 80.0, 20.0, 70.0, 40.0, 30.0, 70.0, 40.0, 20.0, 80.0, 90.0, 50.0, 120.0, 50.0, 30.0, 30.0, 40.0, 10.0, 40.0, 20.0, 10.0, 50.0, 20.0, 50.0, 40.0, 10.0, 50.0, 60.0, 70.0, 10.0, 70.0, 90.0, 40.0, 50.0, 10.0, 30.0, 80.0, 70.0, 20.0, 50.0, 30.0, 70.0, 80.0, 0.0, 37.0, 60.0, -5.0, 0.0, -90.0, 119.0, 90.0, 100.0, 10.0, 19.0, 60.0, 30.0, 40.0, 9.0, 100.0, 30.0, 17.0, 50.0, 28.0, 60.0, 68.0, 40.0, 11.0, 40.0, 10.0, 10.0, 60.0, 61.0, 30.0, 39.0, 51.0, 40.0, 17.0, 50.0, 69.0, 19.0, 10.0, 20.0, 10.0, 80.0, 50.0, 40.0, 20.0, 90.0, 50.0, 90.0, 40.0, 50.0, 70.0, 100.0, 60.0, 66.0, 25.0, 90.0, 130.0, 67.0, 90.0, 60.0, 28.0, -60.0, 30.0, 20.0, 20.0, 19.0, -8.0, 73.0, 70.0, 29.0, 30.0, 40.0, 20.0, 20.0, 29.0, 0.0, 20.0, 0.0, 9.0, 37.0, 10.0, 10.0, 70.0, 0.0, 0.0, 20.0, 70.0, 30.0, 10.0, 50.0, 60.0, 30.0, 20.0, 50.0, 7.0, 0.0, 10.0, 37.0, 10.0, 20.0, 16.0, 50.0, 20.0, 60.0, 30.0, 40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 60.0, 19.0, 40.0, 40.0, 30.0, 90.0, 30.0, 40.0, 30.0, -3.0, 30.0, 50.0, 25.0, 10.0, 80.0, 60.0, 60.0, 60.0, 40.0, 30.0, 60.0, 90.0, 20.0, 60.0, 88.0, 40.0, 50.0, 60.0, 69.0, 50.0, 80.0, 100.0, 60.0, 20.0, 30.0, 50.0, 60.0, 60.0, 40.0, 30.0, 50.0, 40.0, 0.0, 30.0, 60.0, 50.0, 40.0, 0.0, 20.0, 40.0, 43.0, 34.0, 50.0, 10.0, 24.0, 10.0, 23.0, 60.0, 50.0, 20.0, 50.0, 30.0, 60.0, 80.0, 50.0, 50.0, 40.0, 80.0, 40.0, 80.0, 28.0, 30.0, 40.0, 20.0, 10.0, 40.0, 19.0, 50.0, 50.0, 40.0, -16.0, 89.0, 90.0, 80.0, 79.0, 30.0, 60.0, 90.0, 8.0, 59.0, 60.0, 110.0, 60.0, 23.0, 34.0, 19.0, 50.0, 31.0, 50.0, 100.0, 110.0, 30.0, 90.0, 29.0, 44.0, 10.0, 45.0, 22.0, 50.0, 3.0, 30.0, 13.0, 40.0, 110.0, 50.0, 28.0, 49.0, 70.0, 29.0, 0.0, 40.0, 10.0, 10.0, 10.0, 36.0, 3.0, 20.0, 30.0, 20.0, 11.0, 50.0, 50.0, 28.0, 20.0, 19.0, 70.0, 10.0, 70.0, 10.0, 20.0, 50.0, 60.0, 20.0, 7.0, 80.0, 60.0, 70.0, 110.0, 79.0, 10.0, 70.0, 100.0, 90.0, 50.0, 40.0, 27.0, 70.0, 29.0, 60.0, 70.0, 40.0, 50.0, 30.0, 40.0, 30.0, 20.0, 90.0, 29.0, 90.0, 30.0, 0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0, 20.0, 60.0, 5.0, 60.0, 36.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 50.0, 70.0, 20.0, 20.0, 34.0, 80.0, 20.0, 26.0, 37.0, 90.0, 30.0, 20.0, 80.0, 70.0, 60.0, 24.0, 40.0, 31.0, 30.0, 30.0, 18.0, 39.0, 70.0, 70.0, 30.0, 20.0, 40.0, 39.0, 60.0, 50.0, 30.0, -1.0, 40.0, 40.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 14.0, 40.0, 30.0, 60.0, 30.0, 15.0, 30.0, 60.0, 50.0, -4.0, 30.0, 60.0, -12.0, 10.0, 10.0, 60.0, 40.0, 0.0, 70.0, 50.0, 60.0, 60.0, 24.0, 29.0, 19.0, 10.0, 15.0, 30.0, 9.0, 40.0, 30.0, 40.0, 100.0, 40.0, 60.0, 100.0, 30.0, 70.0, 60.0, 90.0, 10.0, 30.0, 110.0, 10.0, 110.0, 50.0, 60.0, 10.0, 20.0, 70.0, 50.0, 10.0, 30.0, 40.0, 120.0, 60.0, 55.0, 10.0, 100.0, 30.0, 60.0, 90.0, 90.0, 80.0, 30.0, 60.0, 30.0, 37.0, 20.0, -1.0, 38.0, 70.0, 10.0, 30.0, 40.0, 30.0, 70.0, 70.0, 40.0, 20.0, 20.0, 50.0, 40.0, 10.0, 30.0, 18.0, 30.0, 40.0, 10.0, 80.0, 30.0, 40.0, 10.0, 80.0, 10.0, 38.0, 38.0, 80.0, 10.0, 30.0, 20.0, 20.0, 50.0, 23.0, 20.0, 32.0, 70.0, 30.0, 50.0, 15.0, 5.0, 30.0, 8.0, 0.0, 20.0, 30.0, 20.0, 6.0, 40.0, 18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6346620634790878, "mean_inference_ms": 1.6691278425627363, "mean_action_processing_ms": 0.5228329744647674, "mean_env_wait_ms": 1.4528669794283053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012507200241088867, "StateBufferConnector_ms": 0.009443998336791992, "ViewRequirementAgentConnector_ms": 0.3891026973724365}, "num_episodes": 18, "episode_return_max": 716.0, "episode_return_min": 125.0, "episode_return_mean": 410.94}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.542781212441984, "num_env_steps_trained_throughput_per_sec": 21.542781212441984, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 185527.823, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185527.772, "sample_time_ms": 2434.667, "learn_time_ms": 183071.765, "learn_throughput": 21.849, "synch_weights_time_ms": 13.106}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "a22d3_00000", "date": "2024-08-06_02-14-41", "timestamp": 1722924881, "time_this_iter_s": 185.68918585777283, "time_total_s": 12672.731520652771, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12672.731520652771, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.92709923664122, "ram_util_percent": 79.03473282442748}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0822331396281655, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.814266769472148, "policy_loss": -0.010570993824243046, "vf_loss": 4.823089192495051, "vf_explained_var": 0.0201343692212313, "kl": 0.008742871582356981, "entropy": 0.7213759146368922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 716.0, "episode_reward_min": 174.0, "episode_reward_mean": 418.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 41.879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [483.0, 470.0, 380.0, 559.0, 430.0, 457.0, 481.0, 598.0, 450.0, 579.0, 479.0, 570.0, 480.0, 339.0, 211.0, 357.0, 470.0, 299.0, 390.0, 480.0, 413.0, 178.0, 530.0, 641.0, 500.0, 332.0, 379.0, 384.0, 380.0, 250.0, 527.0, 610.0, 300.0, 490.0, 490.0, 321.0, 383.0, 390.0, 325.0, 580.0, 716.0, 223.0, 185.0, 320.0, 200.0, 390.0, 376.0, 445.0, 587.0, 530.0, 330.0, 324.0, 560.0, 327.0, 569.0, 537.0, 433.0, 419.0, 190.0, 347.0, 546.0, 606.0, 449.0, 400.0, 281.0, 377.0, 475.0, 416.0, 269.0, 359.0, 264.0, 306.0, 570.0, 500.0, 545.0, 527.0, 397.0, 268.0, 416.0, 345.0, 174.0, 553.0, 651.0, 227.0, 256.0, 430.0, 456.0, 530.0, 310.0, 517.0, 470.0, 305.0, 413.0, 537.0, 354.0, 427.0, 460.0, 404.0, 459.0, 257.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 80.0, 50.0, 18.0, 50.0, 25.0, 40.0, 40.0, 20.0, 50.0, 20.0, 40.0, 20.0, 70.0, 50.0, 10.0, 60.0, 70.0, 80.0, 50.0, 70.0, 40.0, 20.0, 50.0, 50.0, 20.0, 20.0, 30.0, 30.0, 50.0, 60.0, 70.0, 49.0, 0.0, 70.0, 80.0, 60.0, 20.0, 90.0, 60.0, 100.0, 50.0, 40.0, 50.0, 50.0, 50.0, 30.0, 50.0, 16.0, -6.0, 100.0, 29.0, 40.0, 5.0, 80.0, 120.0, 50.0, 34.0, -26.0, 25.0, 60.0, 60.0, 39.0, 80.0, 32.0, 30.0, 30.0, 60.0, 60.0, 30.0, 70.0, 30.0, 60.0, 69.0, 70.0, 40.0, 60.0, 20.0, 99.0, 80.0, 0.0, 30.0, 50.0, 40.0, 140.0, 60.0, 10.0, 20.0, 40.0, 60.0, 100.0, 49.0, 40.0, 100.0, 50.0, 70.0, 70.0, 40.0, 30.0, 30.0, 10.0, 60.0, 40.0, 50.0, 39.0, 30.0, 50.0, 20.0, 120.0, 60.0, 60.0, 110.0, 80.0, 50.0, 40.0, 20.0, 10.0, 100.0, 60.0, 40.0, 50.0, 40.0, 50.0, 30.0, 60.0, 20.0, 30.0, 70.0, 110.0, 20.0, 20.0, 10.0, 70.0, 29.0, 60.0, 70.0, 20.0, 40.0, 35.0, -15.0, 3.0, 20.0, 0.0, 20.0, 0.0, 8.0, 100.0, 30.0, 20.0, 10.0, 30.0, 2.0, 40.0, 50.0, 50.0, 37.0, 10.0, 29.0, 60.0, 49.0, 90.0, 80.0, 70.0, 10.0, 0.0, 40.0, 10.0, 20.0, 140.0, 10.0, 0.0, 80.0, 30.0, 20.0, 9.0, 20.0, 30.0, 50.0, 0.0, 60.0, 30.0, 40.0, 50.0, 20.0, 50.0, 20.0, 60.0, 50.0, 20.0, 50.0, 70.0, 40.0, 40.0, 40.0, 40.0, 20.0, 30.0, 90.0, 60.0, 50.0, 10.0, 80.0, 60.0, 70.0, 20.0, 50.0, 58.0, 40.0, 30.0, -5.0, 0.0, 10.0, 10.0, 35.0, -3.0, 20.0, 6.0, 90.0, 10.0, 0.0, 22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0, 70.0, 70.0, 80.0, 50.0, 70.0, 40.0, 40.0, 70.0, 36.0, 115.0, 60.0, 20.0, 70.0, 70.0, 70.0, 30.0, 100.0, 30.0, 40.0, 10.0, 30.0, 80.0, 4.0, 10.0, 56.0, 60.0, -8.0, 50.0, 30.0, 20.0, 10.0, 50.0, 0.0, 19.0, 30.0, 20.0, 80.0, 50.0, 50.0, 70.0, 50.0, 80.0, 10.0, 40.0, 0.0, 30.0, 70.0, 24.0, 40.0, 40.0, 60.0, 105.0, 20.0, 7.0, 20.0, 10.0, 29.0, 19.0, 100.0, 10.0, 40.0, 9.0, 30.0, 39.0, 60.0, -9.0, 20.0, -19.0, 30.0, 50.0, 89.0, 60.0, 50.0, 40.0, 80.0, 30.0, 8.0, 70.0, 80.0, 20.0, 70.0, 40.0, 30.0, 70.0, 40.0, 20.0, 80.0, 90.0, 50.0, 120.0, 50.0, 30.0, 30.0, 40.0, 10.0, 40.0, 20.0, 10.0, 50.0, 20.0, 50.0, 40.0, 10.0, 50.0, 60.0, 70.0, 10.0, 70.0, 90.0, 40.0, 50.0, 10.0, 30.0, 80.0, 70.0, 20.0, 50.0, 30.0, 70.0, 80.0, 0.0, 37.0, 60.0, -5.0, 0.0, -90.0, 119.0, 90.0, 100.0, 10.0, 19.0, 60.0, 30.0, 40.0, 9.0, 100.0, 30.0, 17.0, 50.0, 28.0, 60.0, 68.0, 40.0, 11.0, 40.0, 10.0, 10.0, 60.0, 61.0, 30.0, 39.0, 51.0, 40.0, 17.0, 50.0, 69.0, 19.0, 10.0, 20.0, 10.0, 80.0, 50.0, 40.0, 20.0, 90.0, 50.0, 90.0, 40.0, 50.0, 70.0, 100.0, 60.0, 66.0, 25.0, 90.0, 130.0, 67.0, 90.0, 60.0, 28.0, -60.0, 30.0, 20.0, 20.0, 19.0, -8.0, 73.0, 70.0, 29.0, 30.0, 40.0, 20.0, 20.0, 29.0, 0.0, 20.0, 0.0, 9.0, 37.0, 10.0, 10.0, 70.0, 0.0, 0.0, 20.0, 70.0, 30.0, 10.0, 50.0, 60.0, 30.0, 20.0, 50.0, 7.0, 0.0, 10.0, 37.0, 10.0, 20.0, 16.0, 50.0, 20.0, 60.0, 30.0, 40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 60.0, 19.0, 40.0, 40.0, 30.0, 90.0, 30.0, 40.0, 30.0, -3.0, 30.0, 50.0, 25.0, 10.0, 80.0, 60.0, 60.0, 60.0, 40.0, 30.0, 60.0, 90.0, 20.0, 60.0, 88.0, 40.0, 50.0, 60.0, 69.0, 50.0, 80.0, 100.0, 60.0, 20.0, 30.0, 50.0, 60.0, 60.0, 40.0, 30.0, 50.0, 40.0, 0.0, 30.0, 60.0, 50.0, 40.0, 0.0, 20.0, 40.0, 43.0, 34.0, 50.0, 10.0, 24.0, 10.0, 23.0, 60.0, 50.0, 20.0, 50.0, 30.0, 60.0, 80.0, 50.0, 50.0, 40.0, 80.0, 40.0, 80.0, 28.0, 30.0, 40.0, 20.0, 10.0, 40.0, 19.0, 50.0, 50.0, 40.0, -16.0, 89.0, 90.0, 80.0, 79.0, 30.0, 60.0, 90.0, 8.0, 59.0, 60.0, 110.0, 60.0, 23.0, 34.0, 19.0, 50.0, 31.0, 50.0, 100.0, 110.0, 30.0, 90.0, 29.0, 44.0, 10.0, 45.0, 22.0, 50.0, 3.0, 30.0, 13.0, 40.0, 110.0, 50.0, 28.0, 49.0, 70.0, 29.0, 0.0, 40.0, 10.0, 10.0, 10.0, 36.0, 3.0, 20.0, 30.0, 20.0, 11.0, 50.0, 50.0, 28.0, 20.0, 19.0, 70.0, 10.0, 70.0, 10.0, 20.0, 50.0, 60.0, 20.0, 7.0, 80.0, 60.0, 70.0, 110.0, 79.0, 10.0, 70.0, 100.0, 90.0, 50.0, 40.0, 27.0, 70.0, 29.0, 60.0, 70.0, 40.0, 50.0, 30.0, 40.0, 30.0, 20.0, 90.0, 29.0, 90.0, 30.0, 0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0, 20.0, 60.0, 5.0, 60.0, 36.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 50.0, 70.0, 20.0, 20.0, 34.0, 80.0, 20.0, 26.0, 37.0, 90.0, 30.0, 20.0, 80.0, 70.0, 60.0, 24.0, 40.0, 31.0, 30.0, 30.0, 18.0, 39.0, 70.0, 70.0, 30.0, 20.0, 40.0, 39.0, 60.0, 50.0, 30.0, -1.0, 40.0, 40.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 14.0, 40.0, 30.0, 60.0, 30.0, 15.0, 30.0, 60.0, 50.0, -4.0, 30.0, 60.0, -12.0, 10.0, 10.0, 60.0, 40.0, 0.0, 70.0, 50.0, 60.0, 60.0, 24.0, 29.0, 19.0, 10.0, 15.0, 30.0, 9.0, 40.0, 30.0, 40.0, 100.0, 40.0, 60.0, 100.0, 30.0, 70.0, 60.0, 90.0, 10.0, 30.0, 110.0, 10.0, 110.0, 50.0, 60.0, 10.0, 20.0, 70.0, 50.0, 10.0, 30.0, 40.0, 120.0, 60.0, 55.0, 10.0, 100.0, 30.0, 60.0, 90.0, 90.0, 80.0, 30.0, 60.0, 30.0, 37.0, 20.0, -1.0, 38.0, 70.0, 10.0, 30.0, 40.0, 30.0, 70.0, 70.0, 40.0, 20.0, 20.0, 50.0, 40.0, 10.0, 30.0, 18.0, 30.0, 40.0, 10.0, 80.0, 30.0, 40.0, 10.0, 80.0, 10.0, 38.0, 38.0, 80.0, 10.0, 30.0, 20.0, 20.0, 50.0, 23.0, 20.0, 32.0, 70.0, 30.0, 50.0, 15.0, 5.0, 30.0, 8.0, 0.0, 20.0, 30.0, 20.0, 6.0, 40.0, 18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0, 74.0, 110.0, 50.0, 59.0, 120.0, 58.0, 20.0, 70.0, 50.0, 40.0, 80.0, -2.0, -1.0, -9.0, 10.0, 30.0, 60.0, 18.0, 28.0, 13.0, -2.0, 40.0, 30.0, 18.0, 70.0, 10.0, 10.0, 40.0, 20.0, 20.0, 70.0, 60.0, 60.0, 10.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, 60.0, 10.0, 70.0, -4.0, 20.0, 40.0, 20.0, 110.0, 100.0, 30.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 80.0, 30.0, 100.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 50.0, 40.0, 32.0, 25.0, 50.0, 60.0, 60.0, 40.0, 60.0, 40.0, 30.0, 20.0, 100.0, 20.0, 70.0, 40.0, 90.0, 30.0, 30.0, 20.0, 50.0, 10.0, 40.0, 38.0, 80.0, -30.0, 60.0, -3.0, 40.0, 90.0, 20.0, 60.0, 40.0, 40.0, 10.0, 20.0, 33.0, 70.0, 30.0, 60.0, 70.0, 40.0, 60.0, 69.0, 30.0, 40.0, 98.0, 60.0, 10.0, 20.0, 18.0, 0.0, 10.0, 70.0, 70.0, 80.0, 28.0, 30.0, 28.0, 50.0, 24.0, 60.0, 30.0, 60.0, 70.0, 50.0, 50.0, 30.0, 3.0, 60.0, 50.0, 60.0, 40.0, 40.0, 50.0, 60.0, 50.0, 20.0, 30.0, 30.0, 79.0, 49.0, 50.0, -61.0, 40.0, 110.0, 40.0, 28.0, 39.0, 60.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 50.0, 80.0, 59.0, 50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6315942844021247, "mean_inference_ms": 1.6649205217579333, "mean_action_processing_ms": 0.521522691942835, "mean_env_wait_ms": 1.449701813089839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012560844421386719, "StateBufferConnector_ms": 0.009598255157470703, "ViewRequirementAgentConnector_ms": 0.392139196395874}, "num_episodes": 18, "episode_return_max": 716.0, "episode_return_min": 174.0, "episode_return_mean": 418.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.61067330263759, "num_env_steps_trained_throughput_per_sec": 21.61067330263759, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 185460.662, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185460.611, "sample_time_ms": 2442.39, "learn_time_ms": 182996.749, "learn_throughput": 21.858, "synch_weights_time_ms": 13.188}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "a22d3_00000", "date": "2024-08-06_02-17-46", "timestamp": 1722925066, "time_this_iter_s": 185.10111618041992, "time_total_s": 12857.832636833191, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b2430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12857.832636833191, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.475572519083972, "ram_util_percent": 78.26564885496184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.982284850345506, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.579442244723709, "policy_loss": -0.010484620595759492, "vf_loss": 5.58812625128875, "vf_explained_var": 0.006937504297120376, "kl": 0.009003058290879416, "entropy": 0.688781989630038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 716.0, "episode_reward_min": 174.0, "episode_reward_mean": 418.76, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 41.876}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.0, 641.0, 500.0, 332.0, 379.0, 384.0, 380.0, 250.0, 527.0, 610.0, 300.0, 490.0, 490.0, 321.0, 383.0, 390.0, 325.0, 580.0, 716.0, 223.0, 185.0, 320.0, 200.0, 390.0, 376.0, 445.0, 587.0, 530.0, 330.0, 324.0, 560.0, 327.0, 569.0, 537.0, 433.0, 419.0, 190.0, 347.0, 546.0, 606.0, 449.0, 400.0, 281.0, 377.0, 475.0, 416.0, 269.0, 359.0, 264.0, 306.0, 570.0, 500.0, 545.0, 527.0, 397.0, 268.0, 416.0, 345.0, 174.0, 553.0, 651.0, 227.0, 256.0, 430.0, 456.0, 530.0, 310.0, 517.0, 470.0, 305.0, 413.0, 537.0, 354.0, 427.0, 460.0, 404.0, 459.0, 257.0, 402.0, 465.0, 467.0, 310.0, 367.0, 445.0, 286.0, 384.0, 510.0, 290.0, 366.0, 570.0, 562.0, 257.0, 584.0, 590.0, 362.0, 584.0, 441.0, 548.0, 430.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [22.0, 70.0, 47.0, 33.0, 70.0, 50.0, 80.0, 48.0, 60.0, 50.0, 70.0, 70.0, 80.0, 50.0, 70.0, 40.0, 40.0, 70.0, 36.0, 115.0, 60.0, 20.0, 70.0, 70.0, 70.0, 30.0, 100.0, 30.0, 40.0, 10.0, 30.0, 80.0, 4.0, 10.0, 56.0, 60.0, -8.0, 50.0, 30.0, 20.0, 10.0, 50.0, 0.0, 19.0, 30.0, 20.0, 80.0, 50.0, 50.0, 70.0, 50.0, 80.0, 10.0, 40.0, 0.0, 30.0, 70.0, 24.0, 40.0, 40.0, 60.0, 105.0, 20.0, 7.0, 20.0, 10.0, 29.0, 19.0, 100.0, 10.0, 40.0, 9.0, 30.0, 39.0, 60.0, -9.0, 20.0, -19.0, 30.0, 50.0, 89.0, 60.0, 50.0, 40.0, 80.0, 30.0, 8.0, 70.0, 80.0, 20.0, 70.0, 40.0, 30.0, 70.0, 40.0, 20.0, 80.0, 90.0, 50.0, 120.0, 50.0, 30.0, 30.0, 40.0, 10.0, 40.0, 20.0, 10.0, 50.0, 20.0, 50.0, 40.0, 10.0, 50.0, 60.0, 70.0, 10.0, 70.0, 90.0, 40.0, 50.0, 10.0, 30.0, 80.0, 70.0, 20.0, 50.0, 30.0, 70.0, 80.0, 0.0, 37.0, 60.0, -5.0, 0.0, -90.0, 119.0, 90.0, 100.0, 10.0, 19.0, 60.0, 30.0, 40.0, 9.0, 100.0, 30.0, 17.0, 50.0, 28.0, 60.0, 68.0, 40.0, 11.0, 40.0, 10.0, 10.0, 60.0, 61.0, 30.0, 39.0, 51.0, 40.0, 17.0, 50.0, 69.0, 19.0, 10.0, 20.0, 10.0, 80.0, 50.0, 40.0, 20.0, 90.0, 50.0, 90.0, 40.0, 50.0, 70.0, 100.0, 60.0, 66.0, 25.0, 90.0, 130.0, 67.0, 90.0, 60.0, 28.0, -60.0, 30.0, 20.0, 20.0, 19.0, -8.0, 73.0, 70.0, 29.0, 30.0, 40.0, 20.0, 20.0, 29.0, 0.0, 20.0, 0.0, 9.0, 37.0, 10.0, 10.0, 70.0, 0.0, 0.0, 20.0, 70.0, 30.0, 10.0, 50.0, 60.0, 30.0, 20.0, 50.0, 7.0, 0.0, 10.0, 37.0, 10.0, 20.0, 16.0, 50.0, 20.0, 60.0, 30.0, 40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 60.0, 19.0, 40.0, 40.0, 30.0, 90.0, 30.0, 40.0, 30.0, -3.0, 30.0, 50.0, 25.0, 10.0, 80.0, 60.0, 60.0, 60.0, 40.0, 30.0, 60.0, 90.0, 20.0, 60.0, 88.0, 40.0, 50.0, 60.0, 69.0, 50.0, 80.0, 100.0, 60.0, 20.0, 30.0, 50.0, 60.0, 60.0, 40.0, 30.0, 50.0, 40.0, 0.0, 30.0, 60.0, 50.0, 40.0, 0.0, 20.0, 40.0, 43.0, 34.0, 50.0, 10.0, 24.0, 10.0, 23.0, 60.0, 50.0, 20.0, 50.0, 30.0, 60.0, 80.0, 50.0, 50.0, 40.0, 80.0, 40.0, 80.0, 28.0, 30.0, 40.0, 20.0, 10.0, 40.0, 19.0, 50.0, 50.0, 40.0, -16.0, 89.0, 90.0, 80.0, 79.0, 30.0, 60.0, 90.0, 8.0, 59.0, 60.0, 110.0, 60.0, 23.0, 34.0, 19.0, 50.0, 31.0, 50.0, 100.0, 110.0, 30.0, 90.0, 29.0, 44.0, 10.0, 45.0, 22.0, 50.0, 3.0, 30.0, 13.0, 40.0, 110.0, 50.0, 28.0, 49.0, 70.0, 29.0, 0.0, 40.0, 10.0, 10.0, 10.0, 36.0, 3.0, 20.0, 30.0, 20.0, 11.0, 50.0, 50.0, 28.0, 20.0, 19.0, 70.0, 10.0, 70.0, 10.0, 20.0, 50.0, 60.0, 20.0, 7.0, 80.0, 60.0, 70.0, 110.0, 79.0, 10.0, 70.0, 100.0, 90.0, 50.0, 40.0, 27.0, 70.0, 29.0, 60.0, 70.0, 40.0, 50.0, 30.0, 40.0, 30.0, 20.0, 90.0, 29.0, 90.0, 30.0, 0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0, 20.0, 60.0, 5.0, 60.0, 36.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 50.0, 70.0, 20.0, 20.0, 34.0, 80.0, 20.0, 26.0, 37.0, 90.0, 30.0, 20.0, 80.0, 70.0, 60.0, 24.0, 40.0, 31.0, 30.0, 30.0, 18.0, 39.0, 70.0, 70.0, 30.0, 20.0, 40.0, 39.0, 60.0, 50.0, 30.0, -1.0, 40.0, 40.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 14.0, 40.0, 30.0, 60.0, 30.0, 15.0, 30.0, 60.0, 50.0, -4.0, 30.0, 60.0, -12.0, 10.0, 10.0, 60.0, 40.0, 0.0, 70.0, 50.0, 60.0, 60.0, 24.0, 29.0, 19.0, 10.0, 15.0, 30.0, 9.0, 40.0, 30.0, 40.0, 100.0, 40.0, 60.0, 100.0, 30.0, 70.0, 60.0, 90.0, 10.0, 30.0, 110.0, 10.0, 110.0, 50.0, 60.0, 10.0, 20.0, 70.0, 50.0, 10.0, 30.0, 40.0, 120.0, 60.0, 55.0, 10.0, 100.0, 30.0, 60.0, 90.0, 90.0, 80.0, 30.0, 60.0, 30.0, 37.0, 20.0, -1.0, 38.0, 70.0, 10.0, 30.0, 40.0, 30.0, 70.0, 70.0, 40.0, 20.0, 20.0, 50.0, 40.0, 10.0, 30.0, 18.0, 30.0, 40.0, 10.0, 80.0, 30.0, 40.0, 10.0, 80.0, 10.0, 38.0, 38.0, 80.0, 10.0, 30.0, 20.0, 20.0, 50.0, 23.0, 20.0, 32.0, 70.0, 30.0, 50.0, 15.0, 5.0, 30.0, 8.0, 0.0, 20.0, 30.0, 20.0, 6.0, 40.0, 18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0, 74.0, 110.0, 50.0, 59.0, 120.0, 58.0, 20.0, 70.0, 50.0, 40.0, 80.0, -2.0, -1.0, -9.0, 10.0, 30.0, 60.0, 18.0, 28.0, 13.0, -2.0, 40.0, 30.0, 18.0, 70.0, 10.0, 10.0, 40.0, 20.0, 20.0, 70.0, 60.0, 60.0, 10.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, 60.0, 10.0, 70.0, -4.0, 20.0, 40.0, 20.0, 110.0, 100.0, 30.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 80.0, 30.0, 100.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 50.0, 40.0, 32.0, 25.0, 50.0, 60.0, 60.0, 40.0, 60.0, 40.0, 30.0, 20.0, 100.0, 20.0, 70.0, 40.0, 90.0, 30.0, 30.0, 20.0, 50.0, 10.0, 40.0, 38.0, 80.0, -30.0, 60.0, -3.0, 40.0, 90.0, 20.0, 60.0, 40.0, 40.0, 10.0, 20.0, 33.0, 70.0, 30.0, 60.0, 70.0, 40.0, 60.0, 69.0, 30.0, 40.0, 98.0, 60.0, 10.0, 20.0, 18.0, 0.0, 10.0, 70.0, 70.0, 80.0, 28.0, 30.0, 28.0, 50.0, 24.0, 60.0, 30.0, 60.0, 70.0, 50.0, 50.0, 30.0, 3.0, 60.0, 50.0, 60.0, 40.0, 40.0, 50.0, 60.0, 50.0, 20.0, 30.0, 30.0, 79.0, 49.0, 50.0, -61.0, 40.0, 110.0, 40.0, 28.0, 39.0, 60.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 50.0, 80.0, 59.0, 50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0, 50.0, 40.0, 50.0, 80.0, 90.0, -10.0, 10.0, 32.0, 30.0, 30.0, 30.0, 20.0, 10.0, 40.0, 35.0, 30.0, 70.0, 120.0, 50.0, 60.0, 30.0, 60.0, 0.0, 100.0, 80.0, 29.0, 90.0, 60.0, 20.0, -2.0, 60.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 50.0, 59.0, 30.0, 30.0, 30.0, 70.0, 40.0, 40.0, 40.0, 19.0, 9.0, 80.0, 50.0, 24.0, 0.0, 40.0, 70.0, 60.0, 77.0, 4.0, 40.0, 10.0, 20.0, 10.0, 50.0, 30.0, 10.0, 50.0, 13.0, 49.0, 44.0, 58.0, 70.0, 60.0, 24.0, 1.0, 50.0, 70.0, 6.0, 39.0, 6.0, 80.0, 60.0, 70.0, 30.0, 10.0, 90.0, 40.0, 20.0, 70.0, 40.0, 30.0, 30.0, 40.0, 30.0, 20.0, 40.0, 10.0, 30.0, 50.0, 10.0, 90.0, 22.0, 40.0, 10.0, 80.0, 40.0, 20.0, 20.0, -6.0, 50.0, 50.0, 10.0, 90.0, 60.0, 70.0, 70.0, 100.0, 40.0, 30.0, 50.0, 80.0, 50.0, 60.0, 50.0, 60.0, 22.0, 90.0, 20.0, 70.0, 60.0, 0.0, 0.0, 30.0, 19.0, 70.0, 40.0, 30.0, 30.0, 19.0, 19.0, 90.0, 70.0, 70.0, 29.0, 63.0, 80.0, 20.0, 102.0, 30.0, 30.0, 100.0, 60.0, 20.0, 80.0, 30.0, 30.0, 40.0, 100.0, 100.0, 30.0, 30.0, 50.0, 70.0, 40.0, 26.0, 20.0, 16.0, 60.0, 20.0, 30.0, 90.0, 55.0, 63.0, 67.0, -1.0, 80.0, 40.0, 70.0, 100.0, 20.0, 50.0, 9.0, 60.0, -1.0, 40.0, 37.0, 106.0, 70.0, 60.0, 10.0, 20.0, 100.0, 50.0, 100.0, 60.0, 30.0, 28.0, 30.0, 50.0, 80.0, 50.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 70.0, 50.0, 0.0, 5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6282424779233753, "mean_inference_ms": 1.6603438512084943, "mean_action_processing_ms": 0.5199855197490731, "mean_env_wait_ms": 1.4459961166757183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01261591911315918, "StateBufferConnector_ms": 0.009687662124633789, "ViewRequirementAgentConnector_ms": 0.39414334297180176}, "num_episodes": 22, "episode_return_max": 716.0, "episode_return_min": 174.0, "episode_return_mean": 418.76}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.6415142565416, "num_env_steps_trained_throughput_per_sec": 21.6415142565416, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 185437.052, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185437.001, "sample_time_ms": 2404.779, "learn_time_ms": 183011.3, "learn_throughput": 21.857, "synch_weights_time_ms": 12.65}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "a22d3_00000", "date": "2024-08-06_02-20-51", "timestamp": 1722925251, "time_this_iter_s": 184.84143900871277, "time_total_s": 13042.674075841904, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a13c1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13042.674075841904, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.01679389312977, "ram_util_percent": 78.75076335877861}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1720675514782832, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.240717053794252, "policy_loss": -0.01051880260936904, "vf_loss": 5.249504943523671, "vf_explained_var": 0.012520899127720517, "kl": 0.008654594680690839, "entropy": 0.6941656222231726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 91.0, "episode_reward_mean": 428.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -61.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 42.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.0, 376.0, 445.0, 587.0, 530.0, 330.0, 324.0, 560.0, 327.0, 569.0, 537.0, 433.0, 419.0, 190.0, 347.0, 546.0, 606.0, 449.0, 400.0, 281.0, 377.0, 475.0, 416.0, 269.0, 359.0, 264.0, 306.0, 570.0, 500.0, 545.0, 527.0, 397.0, 268.0, 416.0, 345.0, 174.0, 553.0, 651.0, 227.0, 256.0, 430.0, 456.0, 530.0, 310.0, 517.0, 470.0, 305.0, 413.0, 537.0, 354.0, 427.0, 460.0, 404.0, 459.0, 257.0, 402.0, 465.0, 467.0, 310.0, 367.0, 445.0, 286.0, 384.0, 510.0, 290.0, 366.0, 570.0, 562.0, 257.0, 584.0, 590.0, 362.0, 584.0, 441.0, 548.0, 430.0, 330.0, 367.0, 367.0, 615.0, 396.0, 418.0, 490.0, 411.0, 460.0, 576.0, 750.0, 268.0, 409.0, 512.0, 648.0, 595.0, 201.0, 297.0, 528.0, 619.0, 91.0, 590.0, 389.0, 478.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 60.0, 30.0, 40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 60.0, 19.0, 40.0, 40.0, 30.0, 90.0, 30.0, 40.0, 30.0, -3.0, 30.0, 50.0, 25.0, 10.0, 80.0, 60.0, 60.0, 60.0, 40.0, 30.0, 60.0, 90.0, 20.0, 60.0, 88.0, 40.0, 50.0, 60.0, 69.0, 50.0, 80.0, 100.0, 60.0, 20.0, 30.0, 50.0, 60.0, 60.0, 40.0, 30.0, 50.0, 40.0, 0.0, 30.0, 60.0, 50.0, 40.0, 0.0, 20.0, 40.0, 43.0, 34.0, 50.0, 10.0, 24.0, 10.0, 23.0, 60.0, 50.0, 20.0, 50.0, 30.0, 60.0, 80.0, 50.0, 50.0, 40.0, 80.0, 40.0, 80.0, 28.0, 30.0, 40.0, 20.0, 10.0, 40.0, 19.0, 50.0, 50.0, 40.0, -16.0, 89.0, 90.0, 80.0, 79.0, 30.0, 60.0, 90.0, 8.0, 59.0, 60.0, 110.0, 60.0, 23.0, 34.0, 19.0, 50.0, 31.0, 50.0, 100.0, 110.0, 30.0, 90.0, 29.0, 44.0, 10.0, 45.0, 22.0, 50.0, 3.0, 30.0, 13.0, 40.0, 110.0, 50.0, 28.0, 49.0, 70.0, 29.0, 0.0, 40.0, 10.0, 10.0, 10.0, 36.0, 3.0, 20.0, 30.0, 20.0, 11.0, 50.0, 50.0, 28.0, 20.0, 19.0, 70.0, 10.0, 70.0, 10.0, 20.0, 50.0, 60.0, 20.0, 7.0, 80.0, 60.0, 70.0, 110.0, 79.0, 10.0, 70.0, 100.0, 90.0, 50.0, 40.0, 27.0, 70.0, 29.0, 60.0, 70.0, 40.0, 50.0, 30.0, 40.0, 30.0, 20.0, 90.0, 29.0, 90.0, 30.0, 0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0, 20.0, 60.0, 5.0, 60.0, 36.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 50.0, 70.0, 20.0, 20.0, 34.0, 80.0, 20.0, 26.0, 37.0, 90.0, 30.0, 20.0, 80.0, 70.0, 60.0, 24.0, 40.0, 31.0, 30.0, 30.0, 18.0, 39.0, 70.0, 70.0, 30.0, 20.0, 40.0, 39.0, 60.0, 50.0, 30.0, -1.0, 40.0, 40.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 14.0, 40.0, 30.0, 60.0, 30.0, 15.0, 30.0, 60.0, 50.0, -4.0, 30.0, 60.0, -12.0, 10.0, 10.0, 60.0, 40.0, 0.0, 70.0, 50.0, 60.0, 60.0, 24.0, 29.0, 19.0, 10.0, 15.0, 30.0, 9.0, 40.0, 30.0, 40.0, 100.0, 40.0, 60.0, 100.0, 30.0, 70.0, 60.0, 90.0, 10.0, 30.0, 110.0, 10.0, 110.0, 50.0, 60.0, 10.0, 20.0, 70.0, 50.0, 10.0, 30.0, 40.0, 120.0, 60.0, 55.0, 10.0, 100.0, 30.0, 60.0, 90.0, 90.0, 80.0, 30.0, 60.0, 30.0, 37.0, 20.0, -1.0, 38.0, 70.0, 10.0, 30.0, 40.0, 30.0, 70.0, 70.0, 40.0, 20.0, 20.0, 50.0, 40.0, 10.0, 30.0, 18.0, 30.0, 40.0, 10.0, 80.0, 30.0, 40.0, 10.0, 80.0, 10.0, 38.0, 38.0, 80.0, 10.0, 30.0, 20.0, 20.0, 50.0, 23.0, 20.0, 32.0, 70.0, 30.0, 50.0, 15.0, 5.0, 30.0, 8.0, 0.0, 20.0, 30.0, 20.0, 6.0, 40.0, 18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0, 74.0, 110.0, 50.0, 59.0, 120.0, 58.0, 20.0, 70.0, 50.0, 40.0, 80.0, -2.0, -1.0, -9.0, 10.0, 30.0, 60.0, 18.0, 28.0, 13.0, -2.0, 40.0, 30.0, 18.0, 70.0, 10.0, 10.0, 40.0, 20.0, 20.0, 70.0, 60.0, 60.0, 10.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, 60.0, 10.0, 70.0, -4.0, 20.0, 40.0, 20.0, 110.0, 100.0, 30.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 80.0, 30.0, 100.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 50.0, 40.0, 32.0, 25.0, 50.0, 60.0, 60.0, 40.0, 60.0, 40.0, 30.0, 20.0, 100.0, 20.0, 70.0, 40.0, 90.0, 30.0, 30.0, 20.0, 50.0, 10.0, 40.0, 38.0, 80.0, -30.0, 60.0, -3.0, 40.0, 90.0, 20.0, 60.0, 40.0, 40.0, 10.0, 20.0, 33.0, 70.0, 30.0, 60.0, 70.0, 40.0, 60.0, 69.0, 30.0, 40.0, 98.0, 60.0, 10.0, 20.0, 18.0, 0.0, 10.0, 70.0, 70.0, 80.0, 28.0, 30.0, 28.0, 50.0, 24.0, 60.0, 30.0, 60.0, 70.0, 50.0, 50.0, 30.0, 3.0, 60.0, 50.0, 60.0, 40.0, 40.0, 50.0, 60.0, 50.0, 20.0, 30.0, 30.0, 79.0, 49.0, 50.0, -61.0, 40.0, 110.0, 40.0, 28.0, 39.0, 60.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 50.0, 80.0, 59.0, 50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0, 50.0, 40.0, 50.0, 80.0, 90.0, -10.0, 10.0, 32.0, 30.0, 30.0, 30.0, 20.0, 10.0, 40.0, 35.0, 30.0, 70.0, 120.0, 50.0, 60.0, 30.0, 60.0, 0.0, 100.0, 80.0, 29.0, 90.0, 60.0, 20.0, -2.0, 60.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 50.0, 59.0, 30.0, 30.0, 30.0, 70.0, 40.0, 40.0, 40.0, 19.0, 9.0, 80.0, 50.0, 24.0, 0.0, 40.0, 70.0, 60.0, 77.0, 4.0, 40.0, 10.0, 20.0, 10.0, 50.0, 30.0, 10.0, 50.0, 13.0, 49.0, 44.0, 58.0, 70.0, 60.0, 24.0, 1.0, 50.0, 70.0, 6.0, 39.0, 6.0, 80.0, 60.0, 70.0, 30.0, 10.0, 90.0, 40.0, 20.0, 70.0, 40.0, 30.0, 30.0, 40.0, 30.0, 20.0, 40.0, 10.0, 30.0, 50.0, 10.0, 90.0, 22.0, 40.0, 10.0, 80.0, 40.0, 20.0, 20.0, -6.0, 50.0, 50.0, 10.0, 90.0, 60.0, 70.0, 70.0, 100.0, 40.0, 30.0, 50.0, 80.0, 50.0, 60.0, 50.0, 60.0, 22.0, 90.0, 20.0, 70.0, 60.0, 0.0, 0.0, 30.0, 19.0, 70.0, 40.0, 30.0, 30.0, 19.0, 19.0, 90.0, 70.0, 70.0, 29.0, 63.0, 80.0, 20.0, 102.0, 30.0, 30.0, 100.0, 60.0, 20.0, 80.0, 30.0, 30.0, 40.0, 100.0, 100.0, 30.0, 30.0, 50.0, 70.0, 40.0, 26.0, 20.0, 16.0, 60.0, 20.0, 30.0, 90.0, 55.0, 63.0, 67.0, -1.0, 80.0, 40.0, 70.0, 100.0, 20.0, 50.0, 9.0, 60.0, -1.0, 40.0, 37.0, 106.0, 70.0, 60.0, 10.0, 20.0, 100.0, 50.0, 100.0, 60.0, 30.0, 28.0, 30.0, 50.0, 80.0, 50.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 70.0, 50.0, 0.0, 5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0, 40.0, 10.0, 39.0, 39.0, 60.0, 20.0, 60.0, 30.0, 50.0, 19.0, 20.0, 10.0, 40.0, 29.0, 100.0, 20.0, 109.0, 40.0, -1.0, 0.0, 50.0, 50.0, 58.0, 40.0, 80.0, 90.0, 10.0, 67.0, 90.0, 80.0, 60.0, 50.0, 28.0, 40.0, 28.0, 30.0, 50.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 20.0, 18.0, 60.0, 60.0, 70.0, 110.0, 40.0, 30.0, 40.0, 60.0, 60.0, 10.0, 50.0, 40.0, 50.0, 10.0, 12.0, 70.0, 16.0, 50.0, 90.0, 24.0, 29.0, 60.0, 50.0, 70.0, 10.0, 20.0, 60.0, 90.0, 10.0, 40.0, 80.0, 40.0, 40.0, 27.0, 90.0, 20.0, 60.0, 90.0, 120.0, 80.0, -10.0, 60.0, 39.0, 70.0, 50.0, 70.0, 50.0, 70.0, 30.0, 110.0, 100.0, 110.0, 90.0, 39.0, 31.0, 20.0, -1.0, 9.0, 10.0, 50.0, 0.0, 40.0, 70.0, 60.0, 70.0, 30.0, 90.0, 80.0, 40.0, 0.0, 0.0, 9.0, 30.0, 80.0, 21.0, 47.0, 110.0, -14.0, 20.0, 20.0, 78.0, 40.0, 110.0, 100.0, 80.0, 110.0, 60.0, 40.0, 60.0, 60.0, 42.0, 70.0, 26.0, 60.0, 100.0, 80.0, 40.0, 80.0, 70.0, 5.0, 30.0, 60.0, 70.0, 10.0, 25.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 26.0, 0.0, 60.0, 60.0, 20.0, 19.0, 70.0, 20.0, 18.0, 10.0, 20.0, 70.0, 100.0, 30.0, 50.0, 47.0, 40.0, -9.0, 40.0, 90.0, 70.0, 80.0, 50.0, 9.0, 120.0, 50.0, 50.0, 60.0, 60.0, 50.0, 90.0, -31.0, 7.0, 8.0, 20.0, -24.0, 0.0, 20.0, -6.0, 27.0, 70.0, 80.0, 80.0, 80.0, 50.0, 60.0, 70.0, 60.0, 30.0, 20.0, 60.0, 84.0, 40.0, -5.0, 57.0, 70.0, 10.0, 20.0, 90.0, -5.0, 28.0, 80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.623543047650694, "mean_inference_ms": 1.6535891063075139, "mean_action_processing_ms": 0.5183906850305717, "mean_env_wait_ms": 1.4424783916457296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012489557266235352, "StateBufferConnector_ms": 0.009361505508422852, "ViewRequirementAgentConnector_ms": 0.37908172607421875}, "num_episodes": 23, "episode_return_max": 750.0, "episode_return_min": 91.0, "episode_return_mean": 428.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.402252121945637, "num_env_steps_trained_throughput_per_sec": 21.402252121945637, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 185575.368, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185575.319, "sample_time_ms": 2411.473, "learn_time_ms": 183144.746, "learn_throughput": 21.841, "synch_weights_time_ms": 11.218}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "a22d3_00000", "date": "2024-08-06_02-23-57", "timestamp": 1722925437, "time_this_iter_s": 186.9046709537506, "time_total_s": 13229.578746795654, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a21035e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13229.578746795654, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.656439393939394, "ram_util_percent": 78.29090909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3078887320174197, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.318670242079023, "policy_loss": -0.010525586927994983, "vf_loss": 5.3275281524505855, "vf_explained_var": 0.007018835787067271, "kl": 0.008338391802531596, "entropy": 0.700222339226415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 91.0, "episode_reward_mean": 421.08, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -61.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 42.108}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 281.0, 377.0, 475.0, 416.0, 269.0, 359.0, 264.0, 306.0, 570.0, 500.0, 545.0, 527.0, 397.0, 268.0, 416.0, 345.0, 174.0, 553.0, 651.0, 227.0, 256.0, 430.0, 456.0, 530.0, 310.0, 517.0, 470.0, 305.0, 413.0, 537.0, 354.0, 427.0, 460.0, 404.0, 459.0, 257.0, 402.0, 465.0, 467.0, 310.0, 367.0, 445.0, 286.0, 384.0, 510.0, 290.0, 366.0, 570.0, 562.0, 257.0, 584.0, 590.0, 362.0, 584.0, 441.0, 548.0, 430.0, 330.0, 367.0, 367.0, 615.0, 396.0, 418.0, 490.0, 411.0, 460.0, 576.0, 750.0, 268.0, 409.0, 512.0, 648.0, 595.0, 201.0, 297.0, 528.0, 619.0, 91.0, 590.0, 389.0, 478.0, 378.0, 216.0, 531.0, 397.0, 210.0, 560.0, 475.0, 202.0, 517.0, 447.0, 417.0, 504.0, 238.0, 327.0, 400.0, 650.0, 271.0, 438.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 90.0, 60.0, 40.0, 30.0, 50.0, 30.0, 30.0, 10.0, 60.0, 20.0, 60.0, 5.0, 60.0, 36.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 50.0, 70.0, 20.0, 20.0, 34.0, 80.0, 20.0, 26.0, 37.0, 90.0, 30.0, 20.0, 80.0, 70.0, 60.0, 24.0, 40.0, 31.0, 30.0, 30.0, 18.0, 39.0, 70.0, 70.0, 30.0, 20.0, 40.0, 39.0, 60.0, 50.0, 30.0, -1.0, 40.0, 40.0, 10.0, 30.0, 40.0, 10.0, 20.0, 30.0, 14.0, 40.0, 30.0, 60.0, 30.0, 15.0, 30.0, 60.0, 50.0, -4.0, 30.0, 60.0, -12.0, 10.0, 10.0, 60.0, 40.0, 0.0, 70.0, 50.0, 60.0, 60.0, 24.0, 29.0, 19.0, 10.0, 15.0, 30.0, 9.0, 40.0, 30.0, 40.0, 100.0, 40.0, 60.0, 100.0, 30.0, 70.0, 60.0, 90.0, 10.0, 30.0, 110.0, 10.0, 110.0, 50.0, 60.0, 10.0, 20.0, 70.0, 50.0, 10.0, 30.0, 40.0, 120.0, 60.0, 55.0, 10.0, 100.0, 30.0, 60.0, 90.0, 90.0, 80.0, 30.0, 60.0, 30.0, 37.0, 20.0, -1.0, 38.0, 70.0, 10.0, 30.0, 40.0, 30.0, 70.0, 70.0, 40.0, 20.0, 20.0, 50.0, 40.0, 10.0, 30.0, 18.0, 30.0, 40.0, 10.0, 80.0, 30.0, 40.0, 10.0, 80.0, 10.0, 38.0, 38.0, 80.0, 10.0, 30.0, 20.0, 20.0, 50.0, 23.0, 20.0, 32.0, 70.0, 30.0, 50.0, 15.0, 5.0, 30.0, 8.0, 0.0, 20.0, 30.0, 20.0, 6.0, 40.0, 18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0, 74.0, 110.0, 50.0, 59.0, 120.0, 58.0, 20.0, 70.0, 50.0, 40.0, 80.0, -2.0, -1.0, -9.0, 10.0, 30.0, 60.0, 18.0, 28.0, 13.0, -2.0, 40.0, 30.0, 18.0, 70.0, 10.0, 10.0, 40.0, 20.0, 20.0, 70.0, 60.0, 60.0, 10.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, 60.0, 10.0, 70.0, -4.0, 20.0, 40.0, 20.0, 110.0, 100.0, 30.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 80.0, 30.0, 100.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 50.0, 40.0, 32.0, 25.0, 50.0, 60.0, 60.0, 40.0, 60.0, 40.0, 30.0, 20.0, 100.0, 20.0, 70.0, 40.0, 90.0, 30.0, 30.0, 20.0, 50.0, 10.0, 40.0, 38.0, 80.0, -30.0, 60.0, -3.0, 40.0, 90.0, 20.0, 60.0, 40.0, 40.0, 10.0, 20.0, 33.0, 70.0, 30.0, 60.0, 70.0, 40.0, 60.0, 69.0, 30.0, 40.0, 98.0, 60.0, 10.0, 20.0, 18.0, 0.0, 10.0, 70.0, 70.0, 80.0, 28.0, 30.0, 28.0, 50.0, 24.0, 60.0, 30.0, 60.0, 70.0, 50.0, 50.0, 30.0, 3.0, 60.0, 50.0, 60.0, 40.0, 40.0, 50.0, 60.0, 50.0, 20.0, 30.0, 30.0, 79.0, 49.0, 50.0, -61.0, 40.0, 110.0, 40.0, 28.0, 39.0, 60.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 50.0, 80.0, 59.0, 50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0, 50.0, 40.0, 50.0, 80.0, 90.0, -10.0, 10.0, 32.0, 30.0, 30.0, 30.0, 20.0, 10.0, 40.0, 35.0, 30.0, 70.0, 120.0, 50.0, 60.0, 30.0, 60.0, 0.0, 100.0, 80.0, 29.0, 90.0, 60.0, 20.0, -2.0, 60.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 50.0, 59.0, 30.0, 30.0, 30.0, 70.0, 40.0, 40.0, 40.0, 19.0, 9.0, 80.0, 50.0, 24.0, 0.0, 40.0, 70.0, 60.0, 77.0, 4.0, 40.0, 10.0, 20.0, 10.0, 50.0, 30.0, 10.0, 50.0, 13.0, 49.0, 44.0, 58.0, 70.0, 60.0, 24.0, 1.0, 50.0, 70.0, 6.0, 39.0, 6.0, 80.0, 60.0, 70.0, 30.0, 10.0, 90.0, 40.0, 20.0, 70.0, 40.0, 30.0, 30.0, 40.0, 30.0, 20.0, 40.0, 10.0, 30.0, 50.0, 10.0, 90.0, 22.0, 40.0, 10.0, 80.0, 40.0, 20.0, 20.0, -6.0, 50.0, 50.0, 10.0, 90.0, 60.0, 70.0, 70.0, 100.0, 40.0, 30.0, 50.0, 80.0, 50.0, 60.0, 50.0, 60.0, 22.0, 90.0, 20.0, 70.0, 60.0, 0.0, 0.0, 30.0, 19.0, 70.0, 40.0, 30.0, 30.0, 19.0, 19.0, 90.0, 70.0, 70.0, 29.0, 63.0, 80.0, 20.0, 102.0, 30.0, 30.0, 100.0, 60.0, 20.0, 80.0, 30.0, 30.0, 40.0, 100.0, 100.0, 30.0, 30.0, 50.0, 70.0, 40.0, 26.0, 20.0, 16.0, 60.0, 20.0, 30.0, 90.0, 55.0, 63.0, 67.0, -1.0, 80.0, 40.0, 70.0, 100.0, 20.0, 50.0, 9.0, 60.0, -1.0, 40.0, 37.0, 106.0, 70.0, 60.0, 10.0, 20.0, 100.0, 50.0, 100.0, 60.0, 30.0, 28.0, 30.0, 50.0, 80.0, 50.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 70.0, 50.0, 0.0, 5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0, 40.0, 10.0, 39.0, 39.0, 60.0, 20.0, 60.0, 30.0, 50.0, 19.0, 20.0, 10.0, 40.0, 29.0, 100.0, 20.0, 109.0, 40.0, -1.0, 0.0, 50.0, 50.0, 58.0, 40.0, 80.0, 90.0, 10.0, 67.0, 90.0, 80.0, 60.0, 50.0, 28.0, 40.0, 28.0, 30.0, 50.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 20.0, 18.0, 60.0, 60.0, 70.0, 110.0, 40.0, 30.0, 40.0, 60.0, 60.0, 10.0, 50.0, 40.0, 50.0, 10.0, 12.0, 70.0, 16.0, 50.0, 90.0, 24.0, 29.0, 60.0, 50.0, 70.0, 10.0, 20.0, 60.0, 90.0, 10.0, 40.0, 80.0, 40.0, 40.0, 27.0, 90.0, 20.0, 60.0, 90.0, 120.0, 80.0, -10.0, 60.0, 39.0, 70.0, 50.0, 70.0, 50.0, 70.0, 30.0, 110.0, 100.0, 110.0, 90.0, 39.0, 31.0, 20.0, -1.0, 9.0, 10.0, 50.0, 0.0, 40.0, 70.0, 60.0, 70.0, 30.0, 90.0, 80.0, 40.0, 0.0, 0.0, 9.0, 30.0, 80.0, 21.0, 47.0, 110.0, -14.0, 20.0, 20.0, 78.0, 40.0, 110.0, 100.0, 80.0, 110.0, 60.0, 40.0, 60.0, 60.0, 42.0, 70.0, 26.0, 60.0, 100.0, 80.0, 40.0, 80.0, 70.0, 5.0, 30.0, 60.0, 70.0, 10.0, 25.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 26.0, 0.0, 60.0, 60.0, 20.0, 19.0, 70.0, 20.0, 18.0, 10.0, 20.0, 70.0, 100.0, 30.0, 50.0, 47.0, 40.0, -9.0, 40.0, 90.0, 70.0, 80.0, 50.0, 9.0, 120.0, 50.0, 50.0, 60.0, 60.0, 50.0, 90.0, -31.0, 7.0, 8.0, 20.0, -24.0, 0.0, 20.0, -6.0, 27.0, 70.0, 80.0, 80.0, 80.0, 50.0, 60.0, 70.0, 60.0, 30.0, 20.0, 60.0, 84.0, 40.0, -5.0, 57.0, 70.0, 10.0, 20.0, 90.0, -5.0, 28.0, 80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0, 30.0, 30.0, 19.0, 50.0, 40.0, 50.0, 50.0, 20.0, 39.0, 50.0, 10.0, 39.0, 0.0, 40.0, 10.0, 20.0, 20.0, -3.0, 0.0, 80.0, 60.0, -15.0, 70.0, 57.0, 60.0, 50.0, 99.0, 90.0, 50.0, 10.0, 60.0, 80.0, 50.0, 110.0, 20.0, 19.0, -2.0, 10.0, 10.0, 40.0, 30.0, 30.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 70.0, 80.0, 30.0, 30.0, 60.0, 50.0, 90.0, 50.0, 70.0, 30.0, 80.0, 30.0, 20.0, 100.0, -13.0, 90.0, 80.0, 20.0, -25.0, 93.0, 17.0, 40.0, 30.0, 30.0, 8.0, 8.0, 30.0, 15.0, 4.0, 20.0, 40.0, 50.0, -20.0, 80.0, 9.0, 110.0, 18.0, 50.0, 70.0, 110.0, 60.0, 60.0, 70.0, 38.0, 70.0, 40.0, 50.0, 40.0, 0.0, 19.0, 30.0, -7.0, 50.0, -6.0, 110.0, 80.0, 30.0, 50.0, 70.0, 10.0, 16.0, 49.0, 70.0, 70.0, 30.0, 100.0, -1.0, 80.0, 40.0, 50.0, 50.0, 10.0, 30.0, 28.0, 40.0, 0.0, 0.0, 19.0, 44.0, 17.0, 17.0, 90.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 30.0, 50.0, 70.0, 30.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 0.0, 60.0, 70.0, 20.0, 70.0, 130.0, 90.0, 20.0, 60.0, 50.0, 80.0, 6.0, 70.0, 60.0, 40.0, -3.0, 30.0, 20.0, 37.0, 1.0, 10.0, 23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6229480790854132, "mean_inference_ms": 1.6519850599928072, "mean_action_processing_ms": 0.5172497374388266, "mean_env_wait_ms": 1.4390390988851691, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011628389358520508, "StateBufferConnector_ms": 0.009745597839355469, "ViewRequirementAgentConnector_ms": 0.36530208587646484}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 91.0, "episode_return_mean": 421.08}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.605714203456923, "num_env_steps_trained_throughput_per_sec": 21.605714203456923, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 185593.833, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185593.785, "sample_time_ms": 2401.614, "learn_time_ms": 183172.739, "learn_throughput": 21.837, "synch_weights_time_ms": 11.426}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "a22d3_00000", "date": "2024-08-06_02-27-03", "timestamp": 1722925623, "time_this_iter_s": 185.14611101150513, "time_total_s": 13414.72485780716, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b2a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13414.72485780716, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.04083969465649, "ram_util_percent": 75.4618320610687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.902811224861775, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.401425014110926, "policy_loss": -0.010514769131735293, "vf_loss": 5.410369909761813, "vf_explained_var": 0.0010380110674645827, "kl": 0.007849345447645657, "entropy": 0.6726762384588852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 91.0, "episode_reward_mean": 434.57, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -61.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 43.457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [553.0, 651.0, 227.0, 256.0, 430.0, 456.0, 530.0, 310.0, 517.0, 470.0, 305.0, 413.0, 537.0, 354.0, 427.0, 460.0, 404.0, 459.0, 257.0, 402.0, 465.0, 467.0, 310.0, 367.0, 445.0, 286.0, 384.0, 510.0, 290.0, 366.0, 570.0, 562.0, 257.0, 584.0, 590.0, 362.0, 584.0, 441.0, 548.0, 430.0, 330.0, 367.0, 367.0, 615.0, 396.0, 418.0, 490.0, 411.0, 460.0, 576.0, 750.0, 268.0, 409.0, 512.0, 648.0, 595.0, 201.0, 297.0, 528.0, 619.0, 91.0, 590.0, 389.0, 478.0, 378.0, 216.0, 531.0, 397.0, 210.0, 560.0, 475.0, 202.0, 517.0, 447.0, 417.0, 504.0, 238.0, 327.0, 400.0, 650.0, 271.0, 438.0, 420.0, 466.0, 507.0, 586.0, 418.0, 500.0, 477.0, 495.0, 260.0, 390.0, 461.0, 478.0, 599.0, 464.0, 360.0, 480.0, 419.0, 458.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [18.0, 50.0, 50.0, 30.0, 150.0, 80.0, 50.0, 35.0, 40.0, 50.0, 74.0, 110.0, 50.0, 59.0, 120.0, 58.0, 20.0, 70.0, 50.0, 40.0, 80.0, -2.0, -1.0, -9.0, 10.0, 30.0, 60.0, 18.0, 28.0, 13.0, -2.0, 40.0, 30.0, 18.0, 70.0, 10.0, 10.0, 40.0, 20.0, 20.0, 70.0, 60.0, 60.0, 10.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, 60.0, 10.0, 70.0, -4.0, 20.0, 40.0, 20.0, 110.0, 100.0, 30.0, 40.0, 40.0, 60.0, 70.0, 50.0, 30.0, 80.0, 30.0, 100.0, 30.0, 10.0, 40.0, 0.0, 30.0, 20.0, 0.0, 30.0, 50.0, 80.0, 50.0, 100.0, 50.0, 40.0, 32.0, 25.0, 50.0, 60.0, 60.0, 40.0, 60.0, 40.0, 30.0, 20.0, 100.0, 20.0, 70.0, 40.0, 90.0, 30.0, 30.0, 20.0, 50.0, 10.0, 40.0, 38.0, 80.0, -30.0, 60.0, -3.0, 40.0, 90.0, 20.0, 60.0, 40.0, 40.0, 10.0, 20.0, 33.0, 70.0, 30.0, 60.0, 70.0, 40.0, 60.0, 69.0, 30.0, 40.0, 98.0, 60.0, 10.0, 20.0, 18.0, 0.0, 10.0, 70.0, 70.0, 80.0, 28.0, 30.0, 28.0, 50.0, 24.0, 60.0, 30.0, 60.0, 70.0, 50.0, 50.0, 30.0, 3.0, 60.0, 50.0, 60.0, 40.0, 40.0, 50.0, 60.0, 50.0, 20.0, 30.0, 30.0, 79.0, 49.0, 50.0, -61.0, 40.0, 110.0, 40.0, 28.0, 39.0, 60.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 50.0, 80.0, 59.0, 50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0, 50.0, 40.0, 50.0, 80.0, 90.0, -10.0, 10.0, 32.0, 30.0, 30.0, 30.0, 20.0, 10.0, 40.0, 35.0, 30.0, 70.0, 120.0, 50.0, 60.0, 30.0, 60.0, 0.0, 100.0, 80.0, 29.0, 90.0, 60.0, 20.0, -2.0, 60.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 50.0, 59.0, 30.0, 30.0, 30.0, 70.0, 40.0, 40.0, 40.0, 19.0, 9.0, 80.0, 50.0, 24.0, 0.0, 40.0, 70.0, 60.0, 77.0, 4.0, 40.0, 10.0, 20.0, 10.0, 50.0, 30.0, 10.0, 50.0, 13.0, 49.0, 44.0, 58.0, 70.0, 60.0, 24.0, 1.0, 50.0, 70.0, 6.0, 39.0, 6.0, 80.0, 60.0, 70.0, 30.0, 10.0, 90.0, 40.0, 20.0, 70.0, 40.0, 30.0, 30.0, 40.0, 30.0, 20.0, 40.0, 10.0, 30.0, 50.0, 10.0, 90.0, 22.0, 40.0, 10.0, 80.0, 40.0, 20.0, 20.0, -6.0, 50.0, 50.0, 10.0, 90.0, 60.0, 70.0, 70.0, 100.0, 40.0, 30.0, 50.0, 80.0, 50.0, 60.0, 50.0, 60.0, 22.0, 90.0, 20.0, 70.0, 60.0, 0.0, 0.0, 30.0, 19.0, 70.0, 40.0, 30.0, 30.0, 19.0, 19.0, 90.0, 70.0, 70.0, 29.0, 63.0, 80.0, 20.0, 102.0, 30.0, 30.0, 100.0, 60.0, 20.0, 80.0, 30.0, 30.0, 40.0, 100.0, 100.0, 30.0, 30.0, 50.0, 70.0, 40.0, 26.0, 20.0, 16.0, 60.0, 20.0, 30.0, 90.0, 55.0, 63.0, 67.0, -1.0, 80.0, 40.0, 70.0, 100.0, 20.0, 50.0, 9.0, 60.0, -1.0, 40.0, 37.0, 106.0, 70.0, 60.0, 10.0, 20.0, 100.0, 50.0, 100.0, 60.0, 30.0, 28.0, 30.0, 50.0, 80.0, 50.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 70.0, 50.0, 0.0, 5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0, 40.0, 10.0, 39.0, 39.0, 60.0, 20.0, 60.0, 30.0, 50.0, 19.0, 20.0, 10.0, 40.0, 29.0, 100.0, 20.0, 109.0, 40.0, -1.0, 0.0, 50.0, 50.0, 58.0, 40.0, 80.0, 90.0, 10.0, 67.0, 90.0, 80.0, 60.0, 50.0, 28.0, 40.0, 28.0, 30.0, 50.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 20.0, 18.0, 60.0, 60.0, 70.0, 110.0, 40.0, 30.0, 40.0, 60.0, 60.0, 10.0, 50.0, 40.0, 50.0, 10.0, 12.0, 70.0, 16.0, 50.0, 90.0, 24.0, 29.0, 60.0, 50.0, 70.0, 10.0, 20.0, 60.0, 90.0, 10.0, 40.0, 80.0, 40.0, 40.0, 27.0, 90.0, 20.0, 60.0, 90.0, 120.0, 80.0, -10.0, 60.0, 39.0, 70.0, 50.0, 70.0, 50.0, 70.0, 30.0, 110.0, 100.0, 110.0, 90.0, 39.0, 31.0, 20.0, -1.0, 9.0, 10.0, 50.0, 0.0, 40.0, 70.0, 60.0, 70.0, 30.0, 90.0, 80.0, 40.0, 0.0, 0.0, 9.0, 30.0, 80.0, 21.0, 47.0, 110.0, -14.0, 20.0, 20.0, 78.0, 40.0, 110.0, 100.0, 80.0, 110.0, 60.0, 40.0, 60.0, 60.0, 42.0, 70.0, 26.0, 60.0, 100.0, 80.0, 40.0, 80.0, 70.0, 5.0, 30.0, 60.0, 70.0, 10.0, 25.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 26.0, 0.0, 60.0, 60.0, 20.0, 19.0, 70.0, 20.0, 18.0, 10.0, 20.0, 70.0, 100.0, 30.0, 50.0, 47.0, 40.0, -9.0, 40.0, 90.0, 70.0, 80.0, 50.0, 9.0, 120.0, 50.0, 50.0, 60.0, 60.0, 50.0, 90.0, -31.0, 7.0, 8.0, 20.0, -24.0, 0.0, 20.0, -6.0, 27.0, 70.0, 80.0, 80.0, 80.0, 50.0, 60.0, 70.0, 60.0, 30.0, 20.0, 60.0, 84.0, 40.0, -5.0, 57.0, 70.0, 10.0, 20.0, 90.0, -5.0, 28.0, 80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0, 30.0, 30.0, 19.0, 50.0, 40.0, 50.0, 50.0, 20.0, 39.0, 50.0, 10.0, 39.0, 0.0, 40.0, 10.0, 20.0, 20.0, -3.0, 0.0, 80.0, 60.0, -15.0, 70.0, 57.0, 60.0, 50.0, 99.0, 90.0, 50.0, 10.0, 60.0, 80.0, 50.0, 110.0, 20.0, 19.0, -2.0, 10.0, 10.0, 40.0, 30.0, 30.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 70.0, 80.0, 30.0, 30.0, 60.0, 50.0, 90.0, 50.0, 70.0, 30.0, 80.0, 30.0, 20.0, 100.0, -13.0, 90.0, 80.0, 20.0, -25.0, 93.0, 17.0, 40.0, 30.0, 30.0, 8.0, 8.0, 30.0, 15.0, 4.0, 20.0, 40.0, 50.0, -20.0, 80.0, 9.0, 110.0, 18.0, 50.0, 70.0, 110.0, 60.0, 60.0, 70.0, 38.0, 70.0, 40.0, 50.0, 40.0, 0.0, 19.0, 30.0, -7.0, 50.0, -6.0, 110.0, 80.0, 30.0, 50.0, 70.0, 10.0, 16.0, 49.0, 70.0, 70.0, 30.0, 100.0, -1.0, 80.0, 40.0, 50.0, 50.0, 10.0, 30.0, 28.0, 40.0, 0.0, 0.0, 19.0, 44.0, 17.0, 17.0, 90.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 30.0, 50.0, 70.0, 30.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 0.0, 60.0, 70.0, 20.0, 70.0, 130.0, 90.0, 20.0, 60.0, 50.0, 80.0, 6.0, 70.0, 60.0, 40.0, -3.0, 30.0, 20.0, 37.0, 1.0, 10.0, 23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0, 20.0, 0.0, 30.0, 80.0, 100.0, 50.0, 70.0, 20.0, 10.0, 40.0, 100.0, 20.0, 80.0, 30.0, 18.0, 28.0, 10.0, 30.0, 70.0, 80.0, 30.0, 50.0, 30.0, -1.0, 50.0, 60.0, 40.0, 48.0, 100.0, 100.0, 40.0, 100.0, 70.0, 48.0, 50.0, 30.0, 100.0, 40.0, 28.0, 80.0, 20.0, 40.0, 30.0, 40.0, 20.0, 78.0, 20.0, 40.0, 70.0, 60.0, 10.0, 70.0, 30.0, 50.0, 130.0, 40.0, 40.0, 50.0, 40.0, 40.0, 40.0, 40.0, 50.0, 60.0, -1.0, 60.0, 40.0, 130.0, -2.0, 60.0, 80.0, 70.0, 70.0, 30.0, 9.0, 50.0, 80.0, 50.0, 90.0, -34.0, 70.0, 60.0, 50.0, -10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 70.0, 40.0, 30.0, 60.0, -19.0, 60.0, 20.0, 50.0, 19.0, 60.0, 30.0, 37.0, 60.0, 19.0, 30.0, 30.0, 90.0, 55.0, 60.0, 50.0, 100.0, 40.0, 10.0, 70.0, 30.0, 90.0, 20.0, 38.0, 70.0, 10.0, 60.0, 80.0, 40.0, 110.0, 29.0, 70.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 70.0, 60.0, 30.0, 5.0, 34.0, 48.0, 8.0, 79.0, 40.0, 40.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 80.0, 90.0, 40.0, 2.0, 11.0, 60.0, 40.0, 87.0, 50.0, 90.0, 70.0, -5.0, 70.0, 24.0, 30.0, 12.0, 90.0, 50.0, -12.0, 50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.620885167478117, "mean_inference_ms": 1.6483553361551264, "mean_action_processing_ms": 0.5160691550590184, "mean_env_wait_ms": 1.4361044471048763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011556386947631836, "StateBufferConnector_ms": 0.009694337844848633, "ViewRequirementAgentConnector_ms": 0.36460280418395996}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 91.0, "episode_return_mean": 434.57}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.678124763316482, "num_env_steps_trained_throughput_per_sec": 21.678124763316482, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 185279.039, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185278.993, "sample_time_ms": 2415.351, "learn_time_ms": 182844.576, "learn_throughput": 21.877, "synch_weights_time_ms": 11.399}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "a22d3_00000", "date": "2024-08-06_02-30-07", "timestamp": 1722925807, "time_this_iter_s": 184.5272719860077, "time_total_s": 13599.252129793167, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20fddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13599.252129793167, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.05632183908046, "ram_util_percent": 75.76858237547893}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0219750735706414, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.3118538468790515, "policy_loss": -0.010023986715059708, "vf_loss": 5.320241192354562, "vf_explained_var": -0.004208854796152653, "kl": 0.008183186641379405, "entropy": 0.6714291023084531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 91.0, "episode_reward_mean": 432.62, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 130.0}, "policy_reward_mean": {"policy_0": 43.262}, "custom_metrics": {}, "hist_stats": {"episode_reward": [257.0, 402.0, 465.0, 467.0, 310.0, 367.0, 445.0, 286.0, 384.0, 510.0, 290.0, 366.0, 570.0, 562.0, 257.0, 584.0, 590.0, 362.0, 584.0, 441.0, 548.0, 430.0, 330.0, 367.0, 367.0, 615.0, 396.0, 418.0, 490.0, 411.0, 460.0, 576.0, 750.0, 268.0, 409.0, 512.0, 648.0, 595.0, 201.0, 297.0, 528.0, 619.0, 91.0, 590.0, 389.0, 478.0, 378.0, 216.0, 531.0, 397.0, 210.0, 560.0, 475.0, 202.0, 517.0, 447.0, 417.0, 504.0, 238.0, 327.0, 400.0, 650.0, 271.0, 438.0, 420.0, 466.0, 507.0, 586.0, 418.0, 500.0, 477.0, 495.0, 260.0, 390.0, 461.0, 478.0, 599.0, 464.0, 360.0, 480.0, 419.0, 458.0, 335.0, 275.0, 613.0, 525.0, 380.0, 299.0, 455.0, 346.0, 465.0, 465.0, 419.0, 506.0, 620.0, 245.0, 462.0, 364.0, 440.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 10.0, 50.0, -5.0, 0.0, 80.0, 0.0, 30.0, 2.0, 40.0, 50.0, 40.0, 50.0, 80.0, 90.0, -10.0, 10.0, 32.0, 30.0, 30.0, 30.0, 20.0, 10.0, 40.0, 35.0, 30.0, 70.0, 120.0, 50.0, 60.0, 30.0, 60.0, 0.0, 100.0, 80.0, 29.0, 90.0, 60.0, 20.0, -2.0, 60.0, 20.0, 70.0, 20.0, 20.0, 20.0, 10.0, 30.0, 10.0, 50.0, 59.0, 30.0, 30.0, 30.0, 70.0, 40.0, 40.0, 40.0, 19.0, 9.0, 80.0, 50.0, 24.0, 0.0, 40.0, 70.0, 60.0, 77.0, 4.0, 40.0, 10.0, 20.0, 10.0, 50.0, 30.0, 10.0, 50.0, 13.0, 49.0, 44.0, 58.0, 70.0, 60.0, 24.0, 1.0, 50.0, 70.0, 6.0, 39.0, 6.0, 80.0, 60.0, 70.0, 30.0, 10.0, 90.0, 40.0, 20.0, 70.0, 40.0, 30.0, 30.0, 40.0, 30.0, 20.0, 40.0, 10.0, 30.0, 50.0, 10.0, 90.0, 22.0, 40.0, 10.0, 80.0, 40.0, 20.0, 20.0, -6.0, 50.0, 50.0, 10.0, 90.0, 60.0, 70.0, 70.0, 100.0, 40.0, 30.0, 50.0, 80.0, 50.0, 60.0, 50.0, 60.0, 22.0, 90.0, 20.0, 70.0, 60.0, 0.0, 0.0, 30.0, 19.0, 70.0, 40.0, 30.0, 30.0, 19.0, 19.0, 90.0, 70.0, 70.0, 29.0, 63.0, 80.0, 20.0, 102.0, 30.0, 30.0, 100.0, 60.0, 20.0, 80.0, 30.0, 30.0, 40.0, 100.0, 100.0, 30.0, 30.0, 50.0, 70.0, 40.0, 26.0, 20.0, 16.0, 60.0, 20.0, 30.0, 90.0, 55.0, 63.0, 67.0, -1.0, 80.0, 40.0, 70.0, 100.0, 20.0, 50.0, 9.0, 60.0, -1.0, 40.0, 37.0, 106.0, 70.0, 60.0, 10.0, 20.0, 100.0, 50.0, 100.0, 60.0, 30.0, 28.0, 30.0, 50.0, 80.0, 50.0, 60.0, 10.0, 50.0, 30.0, 50.0, 60.0, 70.0, 50.0, 0.0, 5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0, 40.0, 10.0, 39.0, 39.0, 60.0, 20.0, 60.0, 30.0, 50.0, 19.0, 20.0, 10.0, 40.0, 29.0, 100.0, 20.0, 109.0, 40.0, -1.0, 0.0, 50.0, 50.0, 58.0, 40.0, 80.0, 90.0, 10.0, 67.0, 90.0, 80.0, 60.0, 50.0, 28.0, 40.0, 28.0, 30.0, 50.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 20.0, 18.0, 60.0, 60.0, 70.0, 110.0, 40.0, 30.0, 40.0, 60.0, 60.0, 10.0, 50.0, 40.0, 50.0, 10.0, 12.0, 70.0, 16.0, 50.0, 90.0, 24.0, 29.0, 60.0, 50.0, 70.0, 10.0, 20.0, 60.0, 90.0, 10.0, 40.0, 80.0, 40.0, 40.0, 27.0, 90.0, 20.0, 60.0, 90.0, 120.0, 80.0, -10.0, 60.0, 39.0, 70.0, 50.0, 70.0, 50.0, 70.0, 30.0, 110.0, 100.0, 110.0, 90.0, 39.0, 31.0, 20.0, -1.0, 9.0, 10.0, 50.0, 0.0, 40.0, 70.0, 60.0, 70.0, 30.0, 90.0, 80.0, 40.0, 0.0, 0.0, 9.0, 30.0, 80.0, 21.0, 47.0, 110.0, -14.0, 20.0, 20.0, 78.0, 40.0, 110.0, 100.0, 80.0, 110.0, 60.0, 40.0, 60.0, 60.0, 42.0, 70.0, 26.0, 60.0, 100.0, 80.0, 40.0, 80.0, 70.0, 5.0, 30.0, 60.0, 70.0, 10.0, 25.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 26.0, 0.0, 60.0, 60.0, 20.0, 19.0, 70.0, 20.0, 18.0, 10.0, 20.0, 70.0, 100.0, 30.0, 50.0, 47.0, 40.0, -9.0, 40.0, 90.0, 70.0, 80.0, 50.0, 9.0, 120.0, 50.0, 50.0, 60.0, 60.0, 50.0, 90.0, -31.0, 7.0, 8.0, 20.0, -24.0, 0.0, 20.0, -6.0, 27.0, 70.0, 80.0, 80.0, 80.0, 50.0, 60.0, 70.0, 60.0, 30.0, 20.0, 60.0, 84.0, 40.0, -5.0, 57.0, 70.0, 10.0, 20.0, 90.0, -5.0, 28.0, 80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0, 30.0, 30.0, 19.0, 50.0, 40.0, 50.0, 50.0, 20.0, 39.0, 50.0, 10.0, 39.0, 0.0, 40.0, 10.0, 20.0, 20.0, -3.0, 0.0, 80.0, 60.0, -15.0, 70.0, 57.0, 60.0, 50.0, 99.0, 90.0, 50.0, 10.0, 60.0, 80.0, 50.0, 110.0, 20.0, 19.0, -2.0, 10.0, 10.0, 40.0, 30.0, 30.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 70.0, 80.0, 30.0, 30.0, 60.0, 50.0, 90.0, 50.0, 70.0, 30.0, 80.0, 30.0, 20.0, 100.0, -13.0, 90.0, 80.0, 20.0, -25.0, 93.0, 17.0, 40.0, 30.0, 30.0, 8.0, 8.0, 30.0, 15.0, 4.0, 20.0, 40.0, 50.0, -20.0, 80.0, 9.0, 110.0, 18.0, 50.0, 70.0, 110.0, 60.0, 60.0, 70.0, 38.0, 70.0, 40.0, 50.0, 40.0, 0.0, 19.0, 30.0, -7.0, 50.0, -6.0, 110.0, 80.0, 30.0, 50.0, 70.0, 10.0, 16.0, 49.0, 70.0, 70.0, 30.0, 100.0, -1.0, 80.0, 40.0, 50.0, 50.0, 10.0, 30.0, 28.0, 40.0, 0.0, 0.0, 19.0, 44.0, 17.0, 17.0, 90.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 30.0, 50.0, 70.0, 30.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 0.0, 60.0, 70.0, 20.0, 70.0, 130.0, 90.0, 20.0, 60.0, 50.0, 80.0, 6.0, 70.0, 60.0, 40.0, -3.0, 30.0, 20.0, 37.0, 1.0, 10.0, 23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0, 20.0, 0.0, 30.0, 80.0, 100.0, 50.0, 70.0, 20.0, 10.0, 40.0, 100.0, 20.0, 80.0, 30.0, 18.0, 28.0, 10.0, 30.0, 70.0, 80.0, 30.0, 50.0, 30.0, -1.0, 50.0, 60.0, 40.0, 48.0, 100.0, 100.0, 40.0, 100.0, 70.0, 48.0, 50.0, 30.0, 100.0, 40.0, 28.0, 80.0, 20.0, 40.0, 30.0, 40.0, 20.0, 78.0, 20.0, 40.0, 70.0, 60.0, 10.0, 70.0, 30.0, 50.0, 130.0, 40.0, 40.0, 50.0, 40.0, 40.0, 40.0, 40.0, 50.0, 60.0, -1.0, 60.0, 40.0, 130.0, -2.0, 60.0, 80.0, 70.0, 70.0, 30.0, 9.0, 50.0, 80.0, 50.0, 90.0, -34.0, 70.0, 60.0, 50.0, -10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 70.0, 40.0, 30.0, 60.0, -19.0, 60.0, 20.0, 50.0, 19.0, 60.0, 30.0, 37.0, 60.0, 19.0, 30.0, 30.0, 90.0, 55.0, 60.0, 50.0, 100.0, 40.0, 10.0, 70.0, 30.0, 90.0, 20.0, 38.0, 70.0, 10.0, 60.0, 80.0, 40.0, 110.0, 29.0, 70.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 70.0, 60.0, 30.0, 5.0, 34.0, 48.0, 8.0, 79.0, 40.0, 40.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 80.0, 90.0, 40.0, 2.0, 11.0, 60.0, 40.0, 87.0, 50.0, 90.0, 70.0, -5.0, 70.0, 24.0, 30.0, 12.0, 90.0, 50.0, -12.0, 50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 7.0, 60.0, 80.0, 20.0, -2.0, 40.0, 60.0, 40.0, 10.0, 20.0, 20.0, 30.0, 60.0, -5.0, 20.0, 20.0, 30.0, 60.0, 46.0, 110.0, 20.0, 90.0, 50.0, 80.0, 70.0, 57.0, 40.0, -6.0, 21.0, 90.0, 80.0, 60.0, 70.0, 100.0, 50.0, 20.0, 40.0, 70.0, 20.0, 30.0, 40.0, 0.0, 40.0, 40.0, 40.0, 60.0, 50.0, 40.0, 10.0, 20.0, 30.0, 40.0, 29.0, 30.0, 0.0, 50.0, 20.0, 17.0, 90.0, 28.0, 60.0, 80.0, 70.0, 40.0, 20.0, 30.0, 10.0, 50.0, 9.0, 50.0, 18.0, 90.0, 19.0, 40.0, 30.0, 30.0, 40.0, 80.0, 10.0, 60.0, 88.0, 37.0, 40.0, 50.0, 30.0, 30.0, 20.0, 67.0, -20.0, 70.0, 30.0, 60.0, 38.0, 70.0, 30.0, 100.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 49.0, 20.0, 60.0, 40.0, 80.0, 70.0, 90.0, 70.0, 40.0, 10.0, 50.0, 26.0, 30.0, 50.0, 80.0, 40.0, 60.0, 70.0, 70.0, 100.0, 20.0, 40.0, 90.0, 0.0, 0.0, 10.0, 40.0, 66.0, 30.0, 10.0, 40.0, 30.0, 19.0, 80.0, 70.0, 40.0, 23.0, 30.0, 70.0, 60.0, 29.0, 30.0, 30.0, 18.0, 35.0, 6.0, 10.0, 57.0, 40.0, 19.0, 50.0, 100.0, 29.0, 30.0, 10.0, 120.0, 90.0, 20.0, 20.0, 70.0, 30.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 30.0, 59.0, 50.0, 81.0, 38.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.618640105131226, "mean_inference_ms": 1.6445859763790218, "mean_action_processing_ms": 0.5149089452328692, "mean_env_wait_ms": 1.4330532816499837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011531352996826172, "StateBufferConnector_ms": 0.009636640548706055, "ViewRequirementAgentConnector_ms": 0.36327362060546875}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 91.0, "episode_return_mean": 432.62}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.64936779453147, "num_env_steps_trained_throughput_per_sec": 21.64936779453147, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 185234.749, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185234.7, "sample_time_ms": 2366.512, "learn_time_ms": 182849.051, "learn_throughput": 21.876, "synch_weights_time_ms": 11.392}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "a22d3_00000", "date": "2024-08-06_02-33-12", "timestamp": 1722925992, "time_this_iter_s": 184.7719407081604, "time_total_s": 13784.024070501328, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13784.024070501328, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.067432950191574, "ram_util_percent": 75.72030651340997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8313272858262697, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4568538004597915, "policy_loss": -0.00950613738289569, "vf_loss": 5.4648094619805825, "vf_explained_var": 0.0014151782400437945, "kl": 0.007752384820194588, "entropy": 0.6825406736681383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 91.0, "episode_reward_mean": 434.88, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -34.0}, "policy_reward_max": {"policy_0": 140.0}, "policy_reward_mean": {"policy_0": 43.488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.0, 367.0, 367.0, 615.0, 396.0, 418.0, 490.0, 411.0, 460.0, 576.0, 750.0, 268.0, 409.0, 512.0, 648.0, 595.0, 201.0, 297.0, 528.0, 619.0, 91.0, 590.0, 389.0, 478.0, 378.0, 216.0, 531.0, 397.0, 210.0, 560.0, 475.0, 202.0, 517.0, 447.0, 417.0, 504.0, 238.0, 327.0, 400.0, 650.0, 271.0, 438.0, 420.0, 466.0, 507.0, 586.0, 418.0, 500.0, 477.0, 495.0, 260.0, 390.0, 461.0, 478.0, 599.0, 464.0, 360.0, 480.0, 419.0, 458.0, 335.0, 275.0, 613.0, 525.0, 380.0, 299.0, 455.0, 346.0, 465.0, 465.0, 419.0, 506.0, 620.0, 245.0, 462.0, 364.0, 440.0, 350.0, 427.0, 358.0, 456.0, 504.0, 545.0, 258.0, 588.0, 395.0, 400.0, 480.0, 663.0, 205.0, 703.0, 483.0, 512.0, 365.0, 443.0, 410.0, 258.0, 554.0, 308.0, 388.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [5.0, 29.0, 10.0, 32.0, 20.0, 20.0, 30.0, 110.0, 19.0, 55.0, 40.0, 10.0, 39.0, 39.0, 60.0, 20.0, 60.0, 30.0, 50.0, 19.0, 20.0, 10.0, 40.0, 29.0, 100.0, 20.0, 109.0, 40.0, -1.0, 0.0, 50.0, 50.0, 58.0, 40.0, 80.0, 90.0, 10.0, 67.0, 90.0, 80.0, 60.0, 50.0, 28.0, 40.0, 28.0, 30.0, 50.0, 30.0, 70.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 20.0, 18.0, 60.0, 60.0, 70.0, 110.0, 40.0, 30.0, 40.0, 60.0, 60.0, 10.0, 50.0, 40.0, 50.0, 10.0, 12.0, 70.0, 16.0, 50.0, 90.0, 24.0, 29.0, 60.0, 50.0, 70.0, 10.0, 20.0, 60.0, 90.0, 10.0, 40.0, 80.0, 40.0, 40.0, 27.0, 90.0, 20.0, 60.0, 90.0, 120.0, 80.0, -10.0, 60.0, 39.0, 70.0, 50.0, 70.0, 50.0, 70.0, 30.0, 110.0, 100.0, 110.0, 90.0, 39.0, 31.0, 20.0, -1.0, 9.0, 10.0, 50.0, 0.0, 40.0, 70.0, 60.0, 70.0, 30.0, 90.0, 80.0, 40.0, 0.0, 0.0, 9.0, 30.0, 80.0, 21.0, 47.0, 110.0, -14.0, 20.0, 20.0, 78.0, 40.0, 110.0, 100.0, 80.0, 110.0, 60.0, 40.0, 60.0, 60.0, 42.0, 70.0, 26.0, 60.0, 100.0, 80.0, 40.0, 80.0, 70.0, 5.0, 30.0, 60.0, 70.0, 10.0, 25.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 40.0, 26.0, 0.0, 60.0, 60.0, 20.0, 19.0, 70.0, 20.0, 18.0, 10.0, 20.0, 70.0, 100.0, 30.0, 50.0, 47.0, 40.0, -9.0, 40.0, 90.0, 70.0, 80.0, 50.0, 9.0, 120.0, 50.0, 50.0, 60.0, 60.0, 50.0, 90.0, -31.0, 7.0, 8.0, 20.0, -24.0, 0.0, 20.0, -6.0, 27.0, 70.0, 80.0, 80.0, 80.0, 50.0, 60.0, 70.0, 60.0, 30.0, 20.0, 60.0, 84.0, 40.0, -5.0, 57.0, 70.0, 10.0, 20.0, 90.0, -5.0, 28.0, 80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0, 30.0, 30.0, 19.0, 50.0, 40.0, 50.0, 50.0, 20.0, 39.0, 50.0, 10.0, 39.0, 0.0, 40.0, 10.0, 20.0, 20.0, -3.0, 0.0, 80.0, 60.0, -15.0, 70.0, 57.0, 60.0, 50.0, 99.0, 90.0, 50.0, 10.0, 60.0, 80.0, 50.0, 110.0, 20.0, 19.0, -2.0, 10.0, 10.0, 40.0, 30.0, 30.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 70.0, 80.0, 30.0, 30.0, 60.0, 50.0, 90.0, 50.0, 70.0, 30.0, 80.0, 30.0, 20.0, 100.0, -13.0, 90.0, 80.0, 20.0, -25.0, 93.0, 17.0, 40.0, 30.0, 30.0, 8.0, 8.0, 30.0, 15.0, 4.0, 20.0, 40.0, 50.0, -20.0, 80.0, 9.0, 110.0, 18.0, 50.0, 70.0, 110.0, 60.0, 60.0, 70.0, 38.0, 70.0, 40.0, 50.0, 40.0, 0.0, 19.0, 30.0, -7.0, 50.0, -6.0, 110.0, 80.0, 30.0, 50.0, 70.0, 10.0, 16.0, 49.0, 70.0, 70.0, 30.0, 100.0, -1.0, 80.0, 40.0, 50.0, 50.0, 10.0, 30.0, 28.0, 40.0, 0.0, 0.0, 19.0, 44.0, 17.0, 17.0, 90.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 30.0, 50.0, 70.0, 30.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 0.0, 60.0, 70.0, 20.0, 70.0, 130.0, 90.0, 20.0, 60.0, 50.0, 80.0, 6.0, 70.0, 60.0, 40.0, -3.0, 30.0, 20.0, 37.0, 1.0, 10.0, 23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0, 20.0, 0.0, 30.0, 80.0, 100.0, 50.0, 70.0, 20.0, 10.0, 40.0, 100.0, 20.0, 80.0, 30.0, 18.0, 28.0, 10.0, 30.0, 70.0, 80.0, 30.0, 50.0, 30.0, -1.0, 50.0, 60.0, 40.0, 48.0, 100.0, 100.0, 40.0, 100.0, 70.0, 48.0, 50.0, 30.0, 100.0, 40.0, 28.0, 80.0, 20.0, 40.0, 30.0, 40.0, 20.0, 78.0, 20.0, 40.0, 70.0, 60.0, 10.0, 70.0, 30.0, 50.0, 130.0, 40.0, 40.0, 50.0, 40.0, 40.0, 40.0, 40.0, 50.0, 60.0, -1.0, 60.0, 40.0, 130.0, -2.0, 60.0, 80.0, 70.0, 70.0, 30.0, 9.0, 50.0, 80.0, 50.0, 90.0, -34.0, 70.0, 60.0, 50.0, -10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 70.0, 40.0, 30.0, 60.0, -19.0, 60.0, 20.0, 50.0, 19.0, 60.0, 30.0, 37.0, 60.0, 19.0, 30.0, 30.0, 90.0, 55.0, 60.0, 50.0, 100.0, 40.0, 10.0, 70.0, 30.0, 90.0, 20.0, 38.0, 70.0, 10.0, 60.0, 80.0, 40.0, 110.0, 29.0, 70.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 70.0, 60.0, 30.0, 5.0, 34.0, 48.0, 8.0, 79.0, 40.0, 40.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 80.0, 90.0, 40.0, 2.0, 11.0, 60.0, 40.0, 87.0, 50.0, 90.0, 70.0, -5.0, 70.0, 24.0, 30.0, 12.0, 90.0, 50.0, -12.0, 50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 7.0, 60.0, 80.0, 20.0, -2.0, 40.0, 60.0, 40.0, 10.0, 20.0, 20.0, 30.0, 60.0, -5.0, 20.0, 20.0, 30.0, 60.0, 46.0, 110.0, 20.0, 90.0, 50.0, 80.0, 70.0, 57.0, 40.0, -6.0, 21.0, 90.0, 80.0, 60.0, 70.0, 100.0, 50.0, 20.0, 40.0, 70.0, 20.0, 30.0, 40.0, 0.0, 40.0, 40.0, 40.0, 60.0, 50.0, 40.0, 10.0, 20.0, 30.0, 40.0, 29.0, 30.0, 0.0, 50.0, 20.0, 17.0, 90.0, 28.0, 60.0, 80.0, 70.0, 40.0, 20.0, 30.0, 10.0, 50.0, 9.0, 50.0, 18.0, 90.0, 19.0, 40.0, 30.0, 30.0, 40.0, 80.0, 10.0, 60.0, 88.0, 37.0, 40.0, 50.0, 30.0, 30.0, 20.0, 67.0, -20.0, 70.0, 30.0, 60.0, 38.0, 70.0, 30.0, 100.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 49.0, 20.0, 60.0, 40.0, 80.0, 70.0, 90.0, 70.0, 40.0, 10.0, 50.0, 26.0, 30.0, 50.0, 80.0, 40.0, 60.0, 70.0, 70.0, 100.0, 20.0, 40.0, 90.0, 0.0, 0.0, 10.0, 40.0, 66.0, 30.0, 10.0, 40.0, 30.0, 19.0, 80.0, 70.0, 40.0, 23.0, 30.0, 70.0, 60.0, 29.0, 30.0, 30.0, 18.0, 35.0, 6.0, 10.0, 57.0, 40.0, 19.0, 50.0, 100.0, 29.0, 30.0, 10.0, 120.0, 90.0, 20.0, 20.0, 70.0, 30.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 30.0, 59.0, 50.0, 81.0, 38.0, 12.0, 100.0, 20.0, 40.0, 60.0, 40.0, -2.0, 30.0, 40.0, 60.0, 39.0, 10.0, 20.0, 70.0, 38.0, 30.0, 60.0, 20.0, 70.0, 0.0, 40.0, 8.0, 70.0, 30.0, 38.0, 20.0, 90.0, 30.0, 60.0, 70.0, 40.0, 22.0, 20.0, 80.0, 90.0, 70.0, 60.0, 12.0, 40.0, 80.0, 30.0, 40.0, 100.0, 30.0, 60.0, 50.0, 70.0, 80.0, 40.0, 70.0, 5.0, 20.0, 6.0, 27.0, 60.0, 30.0, 20.0, 40.0, 13.0, 20.0, 22.0, 100.0, 30.0, 60.0, 73.0, 60.0, 40.0, 35.0, 40.0, 40.0, 110.0, 40.0, 30.0, 20.0, 50.0, 10.0, 30.0, 110.0, 50.0, 31.0, 24.0, 60.0, -4.0, 50.0, 60.0, 40.0, 54.0, 70.0, 20.0, 20.0, 30.0, 20.0, 20.0, 70.0, 80.0, 30.0, 70.0, 30.0, 60.0, 60.0, 40.0, 140.0, 70.0, 49.0, 60.0, 140.0, 14.0, 10.0, 30.0, 70.0, 80.0, 30.0, 0.0, 40.0, 3.0, 0.0, 30.0, 30.0, 30.0, 20.0, 22.0, 110.0, 39.0, 50.0, 50.0, 70.0, 80.0, 90.0, 75.0, 39.0, 100.0, 20.0, 60.0, 20.0, 40.0, 47.0, 80.0, 70.0, 60.0, 6.0, 80.0, 10.0, 30.0, 50.0, -8.0, 20.0, 50.0, 70.0, 70.0, 90.0, 130.0, 40.0, 40.0, 20.0, 30.0, 39.0, 29.0, 60.0, 80.0, 7.0, 20.0, 60.0, 15.0, 40.0, 90.0, 70.0, 60.0, 23.0, 30.0, 2.0, 53.0, 30.0, 100.0, 30.0, 40.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 18.0, 10.0, 60.0, 60.0, 60.0, 40.0, 80.0, 100.0, 60.0, 10.0, 34.0, 50.0, 3.0, 37.0, 10.0, 50.0, 8.0, 20.0, 100.0, 30.0, 50.0, 0.0, 30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.616175422108375, "mean_inference_ms": 1.6399861424508544, "mean_action_processing_ms": 0.5135430163082935, "mean_env_wait_ms": 1.4294610792960376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011800289154052734, "StateBufferConnector_ms": 0.009784936904907227, "ViewRequirementAgentConnector_ms": 0.36779069900512695}, "num_episodes": 22, "episode_return_max": 750.0, "episode_return_min": 91.0, "episode_return_mean": 434.88}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.621451535946388, "num_env_steps_trained_throughput_per_sec": 21.621451535946388, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 185172.2, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185172.15, "sample_time_ms": 2366.966, "learn_time_ms": 182785.688, "learn_throughput": 21.884, "synch_weights_time_ms": 11.595}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "a22d3_00000", "date": "2024-08-06_02-36-17", "timestamp": 1722926177, "time_this_iter_s": 185.012060880661, "time_total_s": 13969.036131381989, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20d33a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13969.036131381989, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 16.98206106870229, "ram_util_percent": 76.10076335877862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.792235943138663, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.319500302608275, "policy_loss": -0.010471783795481283, "vf_loss": 5.328266636759074, "vf_explained_var": 0.007225211766073371, "kl": 0.008527303457600733, "entropy": 0.6929292419498848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 202.0, "episode_reward_mean": 434.54, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -39.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 43.454}, "custom_metrics": {}, "hist_stats": {"episode_reward": [478.0, 378.0, 216.0, 531.0, 397.0, 210.0, 560.0, 475.0, 202.0, 517.0, 447.0, 417.0, 504.0, 238.0, 327.0, 400.0, 650.0, 271.0, 438.0, 420.0, 466.0, 507.0, 586.0, 418.0, 500.0, 477.0, 495.0, 260.0, 390.0, 461.0, 478.0, 599.0, 464.0, 360.0, 480.0, 419.0, 458.0, 335.0, 275.0, 613.0, 525.0, 380.0, 299.0, 455.0, 346.0, 465.0, 465.0, 419.0, 506.0, 620.0, 245.0, 462.0, 364.0, 440.0, 350.0, 427.0, 358.0, 456.0, 504.0, 545.0, 258.0, 588.0, 395.0, 400.0, 480.0, 663.0, 205.0, 703.0, 483.0, 512.0, 365.0, 443.0, 410.0, 258.0, 554.0, 308.0, 388.0, 420.0, 648.0, 237.0, 750.0, 450.0, 531.0, 603.0, 590.0, 456.0, 560.0, 280.0, 500.0, 256.0, 602.0, 370.0, 245.0, 479.0, 306.0, 575.0, 486.0, 415.0, 224.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 90.0, 30.0, 10.0, 50.0, 58.0, 40.0, 30.0, 60.0, 30.0, 30.0, 30.0, 19.0, 50.0, 40.0, 50.0, 50.0, 20.0, 39.0, 50.0, 10.0, 39.0, 0.0, 40.0, 10.0, 20.0, 20.0, -3.0, 0.0, 80.0, 60.0, -15.0, 70.0, 57.0, 60.0, 50.0, 99.0, 90.0, 50.0, 10.0, 60.0, 80.0, 50.0, 110.0, 20.0, 19.0, -2.0, 10.0, 10.0, 40.0, 30.0, 30.0, 20.0, 40.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 70.0, 80.0, 30.0, 30.0, 60.0, 50.0, 90.0, 50.0, 70.0, 30.0, 80.0, 30.0, 20.0, 100.0, -13.0, 90.0, 80.0, 20.0, -25.0, 93.0, 17.0, 40.0, 30.0, 30.0, 8.0, 8.0, 30.0, 15.0, 4.0, 20.0, 40.0, 50.0, -20.0, 80.0, 9.0, 110.0, 18.0, 50.0, 70.0, 110.0, 60.0, 60.0, 70.0, 38.0, 70.0, 40.0, 50.0, 40.0, 0.0, 19.0, 30.0, -7.0, 50.0, -6.0, 110.0, 80.0, 30.0, 50.0, 70.0, 10.0, 16.0, 49.0, 70.0, 70.0, 30.0, 100.0, -1.0, 80.0, 40.0, 50.0, 50.0, 10.0, 30.0, 28.0, 40.0, 0.0, 0.0, 19.0, 44.0, 17.0, 17.0, 90.0, 30.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 30.0, 50.0, 70.0, 30.0, 40.0, 40.0, 20.0, 50.0, 60.0, 40.0, 0.0, 60.0, 70.0, 20.0, 70.0, 130.0, 90.0, 20.0, 60.0, 50.0, 80.0, 6.0, 70.0, 60.0, 40.0, -3.0, 30.0, 20.0, 37.0, 1.0, 10.0, 23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0, 20.0, 0.0, 30.0, 80.0, 100.0, 50.0, 70.0, 20.0, 10.0, 40.0, 100.0, 20.0, 80.0, 30.0, 18.0, 28.0, 10.0, 30.0, 70.0, 80.0, 30.0, 50.0, 30.0, -1.0, 50.0, 60.0, 40.0, 48.0, 100.0, 100.0, 40.0, 100.0, 70.0, 48.0, 50.0, 30.0, 100.0, 40.0, 28.0, 80.0, 20.0, 40.0, 30.0, 40.0, 20.0, 78.0, 20.0, 40.0, 70.0, 60.0, 10.0, 70.0, 30.0, 50.0, 130.0, 40.0, 40.0, 50.0, 40.0, 40.0, 40.0, 40.0, 50.0, 60.0, -1.0, 60.0, 40.0, 130.0, -2.0, 60.0, 80.0, 70.0, 70.0, 30.0, 9.0, 50.0, 80.0, 50.0, 90.0, -34.0, 70.0, 60.0, 50.0, -10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 70.0, 40.0, 30.0, 60.0, -19.0, 60.0, 20.0, 50.0, 19.0, 60.0, 30.0, 37.0, 60.0, 19.0, 30.0, 30.0, 90.0, 55.0, 60.0, 50.0, 100.0, 40.0, 10.0, 70.0, 30.0, 90.0, 20.0, 38.0, 70.0, 10.0, 60.0, 80.0, 40.0, 110.0, 29.0, 70.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 70.0, 60.0, 30.0, 5.0, 34.0, 48.0, 8.0, 79.0, 40.0, 40.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 80.0, 90.0, 40.0, 2.0, 11.0, 60.0, 40.0, 87.0, 50.0, 90.0, 70.0, -5.0, 70.0, 24.0, 30.0, 12.0, 90.0, 50.0, -12.0, 50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 7.0, 60.0, 80.0, 20.0, -2.0, 40.0, 60.0, 40.0, 10.0, 20.0, 20.0, 30.0, 60.0, -5.0, 20.0, 20.0, 30.0, 60.0, 46.0, 110.0, 20.0, 90.0, 50.0, 80.0, 70.0, 57.0, 40.0, -6.0, 21.0, 90.0, 80.0, 60.0, 70.0, 100.0, 50.0, 20.0, 40.0, 70.0, 20.0, 30.0, 40.0, 0.0, 40.0, 40.0, 40.0, 60.0, 50.0, 40.0, 10.0, 20.0, 30.0, 40.0, 29.0, 30.0, 0.0, 50.0, 20.0, 17.0, 90.0, 28.0, 60.0, 80.0, 70.0, 40.0, 20.0, 30.0, 10.0, 50.0, 9.0, 50.0, 18.0, 90.0, 19.0, 40.0, 30.0, 30.0, 40.0, 80.0, 10.0, 60.0, 88.0, 37.0, 40.0, 50.0, 30.0, 30.0, 20.0, 67.0, -20.0, 70.0, 30.0, 60.0, 38.0, 70.0, 30.0, 100.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 49.0, 20.0, 60.0, 40.0, 80.0, 70.0, 90.0, 70.0, 40.0, 10.0, 50.0, 26.0, 30.0, 50.0, 80.0, 40.0, 60.0, 70.0, 70.0, 100.0, 20.0, 40.0, 90.0, 0.0, 0.0, 10.0, 40.0, 66.0, 30.0, 10.0, 40.0, 30.0, 19.0, 80.0, 70.0, 40.0, 23.0, 30.0, 70.0, 60.0, 29.0, 30.0, 30.0, 18.0, 35.0, 6.0, 10.0, 57.0, 40.0, 19.0, 50.0, 100.0, 29.0, 30.0, 10.0, 120.0, 90.0, 20.0, 20.0, 70.0, 30.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 30.0, 59.0, 50.0, 81.0, 38.0, 12.0, 100.0, 20.0, 40.0, 60.0, 40.0, -2.0, 30.0, 40.0, 60.0, 39.0, 10.0, 20.0, 70.0, 38.0, 30.0, 60.0, 20.0, 70.0, 0.0, 40.0, 8.0, 70.0, 30.0, 38.0, 20.0, 90.0, 30.0, 60.0, 70.0, 40.0, 22.0, 20.0, 80.0, 90.0, 70.0, 60.0, 12.0, 40.0, 80.0, 30.0, 40.0, 100.0, 30.0, 60.0, 50.0, 70.0, 80.0, 40.0, 70.0, 5.0, 20.0, 6.0, 27.0, 60.0, 30.0, 20.0, 40.0, 13.0, 20.0, 22.0, 100.0, 30.0, 60.0, 73.0, 60.0, 40.0, 35.0, 40.0, 40.0, 110.0, 40.0, 30.0, 20.0, 50.0, 10.0, 30.0, 110.0, 50.0, 31.0, 24.0, 60.0, -4.0, 50.0, 60.0, 40.0, 54.0, 70.0, 20.0, 20.0, 30.0, 20.0, 20.0, 70.0, 80.0, 30.0, 70.0, 30.0, 60.0, 60.0, 40.0, 140.0, 70.0, 49.0, 60.0, 140.0, 14.0, 10.0, 30.0, 70.0, 80.0, 30.0, 0.0, 40.0, 3.0, 0.0, 30.0, 30.0, 30.0, 20.0, 22.0, 110.0, 39.0, 50.0, 50.0, 70.0, 80.0, 90.0, 75.0, 39.0, 100.0, 20.0, 60.0, 20.0, 40.0, 47.0, 80.0, 70.0, 60.0, 6.0, 80.0, 10.0, 30.0, 50.0, -8.0, 20.0, 50.0, 70.0, 70.0, 90.0, 130.0, 40.0, 40.0, 20.0, 30.0, 39.0, 29.0, 60.0, 80.0, 7.0, 20.0, 60.0, 15.0, 40.0, 90.0, 70.0, 60.0, 23.0, 30.0, 2.0, 53.0, 30.0, 100.0, 30.0, 40.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 18.0, 10.0, 60.0, 60.0, 60.0, 40.0, 80.0, 100.0, 60.0, 10.0, 34.0, 50.0, 3.0, 37.0, 10.0, 50.0, 8.0, 20.0, 100.0, 30.0, 50.0, 0.0, 30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0, 50.0, 10.0, 100.0, 10.0, 10.0, 60.0, 20.0, 110.0, 10.0, 40.0, 110.0, 70.0, 120.0, 69.0, 80.0, 50.0, 30.0, 60.0, 20.0, 39.0, 40.0, 20.0, 10.0, 40.0, 50.0, 20.0, 10.0, -16.0, 60.0, 3.0, 50.0, 90.0, 40.0, 70.0, 60.0, 90.0, 70.0, 100.0, 110.0, 70.0, 30.0, 20.0, 40.0, 30.0, 90.0, 80.0, 70.0, 30.0, 10.0, 50.0, 60.0, 50.0, 80.0, 30.0, 88.0, 80.0, 50.0, 10.0, 23.0, 60.0, 50.0, 60.0, 30.0, 79.0, 66.0, 50.0, 60.0, 88.0, 90.0, 30.0, 30.0, 30.0, 50.0, 60.0, 70.0, 80.0, 50.0, 100.0, 70.0, 50.0, 70.0, 90.0, -39.0, 70.0, 40.0, 36.0, 19.0, 10.0, 100.0, 60.0, 100.0, 60.0, 70.0, 50.0, 40.0, 80.0, 30.0, -10.0, 110.0, 30.0, 80.0, 30.0, 10.0, 0.0, 50.0, 30.0, 40.0, 20.0, 10.0, 10.0, 10.0, 60.0, 30.0, 50.0, 70.0, 30.0, 70.0, 110.0, 50.0, 20.0, 35.0, 60.0, 40.0, 0.0, 0.0, 13.0, 0.0, 8.0, 60.0, 40.0, 9.0, 30.0, 130.0, 70.0, 16.0, 71.0, 160.0, 30.0, 16.0, 70.0, 70.0, 30.0, 0.0, 30.0, 90.0, 70.0, 0.0, 50.0, 20.0, 10.0, 20.0, 60.0, 0.0, 18.0, 0.0, 30.0, 40.0, 7.0, 40.0, 30.0, 40.0, 10.0, 20.0, 40.0, 40.0, 40.0, 149.0, 20.0, 40.0, 80.0, -5.0, 10.0, 19.0, 29.0, 40.0, 30.0, 120.0, 27.0, -4.0, 40.0, 80.0, 45.0, 80.0, 50.0, 70.0, 80.0, 40.0, 70.0, 20.0, 40.0, 20.0, 53.0, 19.0, 80.0, 50.0, 60.0, 10.0, 60.0, 100.0, 34.0, 20.0, 38.0, 20.0, 67.0, 20.0, 20.0, 90.0, 30.0, 40.0, 70.0, 14.0, 15.0, 0.0, 20.0, 30.0, 40.0, 30.0, 9.0, 60.0, 6.0, 10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6130812918231343, "mean_inference_ms": 1.6356462796885263, "mean_action_processing_ms": 0.5121442610279504, "mean_env_wait_ms": 1.4258318873801112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011739969253540039, "StateBufferConnector_ms": 0.00978231430053711, "ViewRequirementAgentConnector_ms": 0.366560697555542}, "num_episodes": 23, "episode_return_max": 750.0, "episode_return_min": 202.0, "episode_return_mean": 434.54}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.67589651933873, "num_env_steps_trained_throughput_per_sec": 21.67589651933873, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 185109.944, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185109.894, "sample_time_ms": 2362.111, "learn_time_ms": 182728.558, "learn_throughput": 21.89, "synch_weights_time_ms": 11.22}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "a22d3_00000", "date": "2024-08-06_02-39-22", "timestamp": 1722926362, "time_this_iter_s": 184.54638385772705, "time_total_s": 14153.582515239716, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20fd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14153.582515239716, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.354615384615386, "ram_util_percent": 76.03423076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0389856175873606, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.317325251018659, "policy_loss": -0.01013606450732706, "vf_loss": 5.325793620318778, "vf_explained_var": 0.023931675685988193, "kl": 0.00833845771804383, "entropy": 0.6704928571836383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 157.0, "episode_reward_mean": 437.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -97.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 43.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [438.0, 420.0, 466.0, 507.0, 586.0, 418.0, 500.0, 477.0, 495.0, 260.0, 390.0, 461.0, 478.0, 599.0, 464.0, 360.0, 480.0, 419.0, 458.0, 335.0, 275.0, 613.0, 525.0, 380.0, 299.0, 455.0, 346.0, 465.0, 465.0, 419.0, 506.0, 620.0, 245.0, 462.0, 364.0, 440.0, 350.0, 427.0, 358.0, 456.0, 504.0, 545.0, 258.0, 588.0, 395.0, 400.0, 480.0, 663.0, 205.0, 703.0, 483.0, 512.0, 365.0, 443.0, 410.0, 258.0, 554.0, 308.0, 388.0, 420.0, 648.0, 237.0, 750.0, 450.0, 531.0, 603.0, 590.0, 456.0, 560.0, 280.0, 500.0, 256.0, 602.0, 370.0, 245.0, 479.0, 306.0, 575.0, 486.0, 415.0, 224.0, 310.0, 556.0, 530.0, 447.0, 230.0, 398.0, 387.0, 507.0, 331.0, 685.0, 347.0, 633.0, 229.0, 319.0, 607.0, 231.0, 729.0, 226.0, 157.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [23.0, 60.0, 60.0, 20.0, 20.0, 30.0, 70.0, 35.0, 70.0, 50.0, 20.0, 0.0, 30.0, 80.0, 100.0, 50.0, 70.0, 20.0, 10.0, 40.0, 100.0, 20.0, 80.0, 30.0, 18.0, 28.0, 10.0, 30.0, 70.0, 80.0, 30.0, 50.0, 30.0, -1.0, 50.0, 60.0, 40.0, 48.0, 100.0, 100.0, 40.0, 100.0, 70.0, 48.0, 50.0, 30.0, 100.0, 40.0, 28.0, 80.0, 20.0, 40.0, 30.0, 40.0, 20.0, 78.0, 20.0, 40.0, 70.0, 60.0, 10.0, 70.0, 30.0, 50.0, 130.0, 40.0, 40.0, 50.0, 40.0, 40.0, 40.0, 40.0, 50.0, 60.0, -1.0, 60.0, 40.0, 130.0, -2.0, 60.0, 80.0, 70.0, 70.0, 30.0, 9.0, 50.0, 80.0, 50.0, 90.0, -34.0, 70.0, 60.0, 50.0, -10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 10.0, 70.0, 40.0, 30.0, 60.0, -19.0, 60.0, 20.0, 50.0, 19.0, 60.0, 30.0, 37.0, 60.0, 19.0, 30.0, 30.0, 90.0, 55.0, 60.0, 50.0, 100.0, 40.0, 10.0, 70.0, 30.0, 90.0, 20.0, 38.0, 70.0, 10.0, 60.0, 80.0, 40.0, 110.0, 29.0, 70.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 70.0, 60.0, 30.0, 5.0, 34.0, 48.0, 8.0, 79.0, 40.0, 40.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 50.0, 20.0, 80.0, 90.0, 40.0, 2.0, 11.0, 60.0, 40.0, 87.0, 50.0, 90.0, 70.0, -5.0, 70.0, 24.0, 30.0, 12.0, 90.0, 50.0, -12.0, 50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 7.0, 60.0, 80.0, 20.0, -2.0, 40.0, 60.0, 40.0, 10.0, 20.0, 20.0, 30.0, 60.0, -5.0, 20.0, 20.0, 30.0, 60.0, 46.0, 110.0, 20.0, 90.0, 50.0, 80.0, 70.0, 57.0, 40.0, -6.0, 21.0, 90.0, 80.0, 60.0, 70.0, 100.0, 50.0, 20.0, 40.0, 70.0, 20.0, 30.0, 40.0, 0.0, 40.0, 40.0, 40.0, 60.0, 50.0, 40.0, 10.0, 20.0, 30.0, 40.0, 29.0, 30.0, 0.0, 50.0, 20.0, 17.0, 90.0, 28.0, 60.0, 80.0, 70.0, 40.0, 20.0, 30.0, 10.0, 50.0, 9.0, 50.0, 18.0, 90.0, 19.0, 40.0, 30.0, 30.0, 40.0, 80.0, 10.0, 60.0, 88.0, 37.0, 40.0, 50.0, 30.0, 30.0, 20.0, 67.0, -20.0, 70.0, 30.0, 60.0, 38.0, 70.0, 30.0, 100.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 49.0, 20.0, 60.0, 40.0, 80.0, 70.0, 90.0, 70.0, 40.0, 10.0, 50.0, 26.0, 30.0, 50.0, 80.0, 40.0, 60.0, 70.0, 70.0, 100.0, 20.0, 40.0, 90.0, 0.0, 0.0, 10.0, 40.0, 66.0, 30.0, 10.0, 40.0, 30.0, 19.0, 80.0, 70.0, 40.0, 23.0, 30.0, 70.0, 60.0, 29.0, 30.0, 30.0, 18.0, 35.0, 6.0, 10.0, 57.0, 40.0, 19.0, 50.0, 100.0, 29.0, 30.0, 10.0, 120.0, 90.0, 20.0, 20.0, 70.0, 30.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 30.0, 59.0, 50.0, 81.0, 38.0, 12.0, 100.0, 20.0, 40.0, 60.0, 40.0, -2.0, 30.0, 40.0, 60.0, 39.0, 10.0, 20.0, 70.0, 38.0, 30.0, 60.0, 20.0, 70.0, 0.0, 40.0, 8.0, 70.0, 30.0, 38.0, 20.0, 90.0, 30.0, 60.0, 70.0, 40.0, 22.0, 20.0, 80.0, 90.0, 70.0, 60.0, 12.0, 40.0, 80.0, 30.0, 40.0, 100.0, 30.0, 60.0, 50.0, 70.0, 80.0, 40.0, 70.0, 5.0, 20.0, 6.0, 27.0, 60.0, 30.0, 20.0, 40.0, 13.0, 20.0, 22.0, 100.0, 30.0, 60.0, 73.0, 60.0, 40.0, 35.0, 40.0, 40.0, 110.0, 40.0, 30.0, 20.0, 50.0, 10.0, 30.0, 110.0, 50.0, 31.0, 24.0, 60.0, -4.0, 50.0, 60.0, 40.0, 54.0, 70.0, 20.0, 20.0, 30.0, 20.0, 20.0, 70.0, 80.0, 30.0, 70.0, 30.0, 60.0, 60.0, 40.0, 140.0, 70.0, 49.0, 60.0, 140.0, 14.0, 10.0, 30.0, 70.0, 80.0, 30.0, 0.0, 40.0, 3.0, 0.0, 30.0, 30.0, 30.0, 20.0, 22.0, 110.0, 39.0, 50.0, 50.0, 70.0, 80.0, 90.0, 75.0, 39.0, 100.0, 20.0, 60.0, 20.0, 40.0, 47.0, 80.0, 70.0, 60.0, 6.0, 80.0, 10.0, 30.0, 50.0, -8.0, 20.0, 50.0, 70.0, 70.0, 90.0, 130.0, 40.0, 40.0, 20.0, 30.0, 39.0, 29.0, 60.0, 80.0, 7.0, 20.0, 60.0, 15.0, 40.0, 90.0, 70.0, 60.0, 23.0, 30.0, 2.0, 53.0, 30.0, 100.0, 30.0, 40.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 18.0, 10.0, 60.0, 60.0, 60.0, 40.0, 80.0, 100.0, 60.0, 10.0, 34.0, 50.0, 3.0, 37.0, 10.0, 50.0, 8.0, 20.0, 100.0, 30.0, 50.0, 0.0, 30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0, 50.0, 10.0, 100.0, 10.0, 10.0, 60.0, 20.0, 110.0, 10.0, 40.0, 110.0, 70.0, 120.0, 69.0, 80.0, 50.0, 30.0, 60.0, 20.0, 39.0, 40.0, 20.0, 10.0, 40.0, 50.0, 20.0, 10.0, -16.0, 60.0, 3.0, 50.0, 90.0, 40.0, 70.0, 60.0, 90.0, 70.0, 100.0, 110.0, 70.0, 30.0, 20.0, 40.0, 30.0, 90.0, 80.0, 70.0, 30.0, 10.0, 50.0, 60.0, 50.0, 80.0, 30.0, 88.0, 80.0, 50.0, 10.0, 23.0, 60.0, 50.0, 60.0, 30.0, 79.0, 66.0, 50.0, 60.0, 88.0, 90.0, 30.0, 30.0, 30.0, 50.0, 60.0, 70.0, 80.0, 50.0, 100.0, 70.0, 50.0, 70.0, 90.0, -39.0, 70.0, 40.0, 36.0, 19.0, 10.0, 100.0, 60.0, 100.0, 60.0, 70.0, 50.0, 40.0, 80.0, 30.0, -10.0, 110.0, 30.0, 80.0, 30.0, 10.0, 0.0, 50.0, 30.0, 40.0, 20.0, 10.0, 10.0, 10.0, 60.0, 30.0, 50.0, 70.0, 30.0, 70.0, 110.0, 50.0, 20.0, 35.0, 60.0, 40.0, 0.0, 0.0, 13.0, 0.0, 8.0, 60.0, 40.0, 9.0, 30.0, 130.0, 70.0, 16.0, 71.0, 160.0, 30.0, 16.0, 70.0, 70.0, 30.0, 0.0, 30.0, 90.0, 70.0, 0.0, 50.0, 20.0, 10.0, 20.0, 60.0, 0.0, 18.0, 0.0, 30.0, 40.0, 7.0, 40.0, 30.0, 40.0, 10.0, 20.0, 40.0, 40.0, 40.0, 149.0, 20.0, 40.0, 80.0, -5.0, 10.0, 19.0, 29.0, 40.0, 30.0, 120.0, 27.0, -4.0, 40.0, 80.0, 45.0, 80.0, 50.0, 70.0, 80.0, 40.0, 70.0, 20.0, 40.0, 20.0, 53.0, 19.0, 80.0, 50.0, 60.0, 10.0, 60.0, 100.0, 34.0, 20.0, 38.0, 20.0, 67.0, 20.0, 20.0, 90.0, 30.0, 40.0, 70.0, 14.0, 15.0, 0.0, 20.0, 30.0, 40.0, 30.0, 9.0, 60.0, 6.0, 10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0, 140.0, 70.0, 120.0, 50.0, 10.0, 38.0, 50.0, 50.0, 8.0, 20.0, 60.0, 40.0, 40.0, 30.0, 100.0, 50.0, 50.0, 30.0, 60.0, 70.0, 130.0, 60.0, 40.0, 39.0, 20.0, 0.0, 30.0, 110.0, 10.0, 8.0, 23.0, 20.0, 34.0, 10.0, 29.0, 30.0, 21.0, 50.0, -7.0, 20.0, 30.0, 18.0, 30.0, 30.0, 70.0, 37.0, 30.0, 71.0, 22.0, 60.0, 50.0, 40.0, 29.0, 30.0, 30.0, 70.0, 10.0, 20.0, 90.0, 18.0, 70.0, 9.0, 30.0, 110.0, 70.0, 40.0, 10.0, 70.0, 40.0, 58.0, 19.0, 24.0, 50.0, 24.0, 30.0, 35.0, 30.0, 9.0, 90.0, 20.0, 30.0, 90.0, 40.0, 150.0, 50.0, 100.0, 17.0, 70.0, 50.0, 88.0, 40.0, 29.0, 70.0, 20.0, 30.0, 40.0, 40.0, 18.0, 50.0, 10.0, 20.0, 80.0, 70.0, 62.0, 21.0, 80.0, 70.0, 20.0, 60.0, 150.0, 0.0, 40.0, 50.0, 10.0, 40.0, 12.0, 0.0, 20.0, 40.0, 17.0, 70.0, 0.0, 9.0, 40.0, 80.0, 30.0, 10.0, 20.0, 10.0, 50.0, 80.0, 30.0, 90.0, -2.0, 40.0, 130.0, 100.0, 9.0, 74.0, 56.0, 80.0, 9.0, 24.0, 51.0, 19.0, 12.0, 70.0, -97.0, 140.0, -77.0, 50.0, 10.0, 90.0, 70.0, 70.0, 100.0, 80.0, 100.0, 79.0, 80.0, 40.0, 0.0, 10.0, 8.0, 30.0, 0.0, 28.0, 30.0, 30.0, 50.0, 10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.610779644622234, "mean_inference_ms": 1.632351066271572, "mean_action_processing_ms": 0.5110692269238208, "mean_env_wait_ms": 1.4230828739913925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011671066284179688, "StateBufferConnector_ms": 0.009052038192749023, "ViewRequirementAgentConnector_ms": 0.3567066192626953}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 157.0, "episode_return_mean": 437.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.68481560816767, "num_env_steps_trained_throughput_per_sec": 21.68481560816767, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 185091.307, "restore_workers_time_ms": 0.013, "training_step_time_ms": 185091.256, "sample_time_ms": 2361.482, "learn_time_ms": 182710.901, "learn_throughput": 21.893, "synch_weights_time_ms": 10.81}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "a22d3_00000", "date": "2024-08-06_02-42-26", "timestamp": 1722926546, "time_this_iter_s": 184.47026085853577, "time_total_s": 14338.052776098251, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a13c1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14338.052776098251, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.657471264367818, "ram_util_percent": 76.27931034482759}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8250181178188427, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.352070163360165, "policy_loss": -0.011863268726417067, "vf_loss": 5.362238785507072, "vf_explained_var": 0.007731292162713405, "kl": 0.008473242979339289, "entropy": 0.6904090867001916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 157.0, "episode_reward_mean": 437.86, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -97.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 43.786}, "custom_metrics": {}, "hist_stats": {"episode_reward": [458.0, 335.0, 275.0, 613.0, 525.0, 380.0, 299.0, 455.0, 346.0, 465.0, 465.0, 419.0, 506.0, 620.0, 245.0, 462.0, 364.0, 440.0, 350.0, 427.0, 358.0, 456.0, 504.0, 545.0, 258.0, 588.0, 395.0, 400.0, 480.0, 663.0, 205.0, 703.0, 483.0, 512.0, 365.0, 443.0, 410.0, 258.0, 554.0, 308.0, 388.0, 420.0, 648.0, 237.0, 750.0, 450.0, 531.0, 603.0, 590.0, 456.0, 560.0, 280.0, 500.0, 256.0, 602.0, 370.0, 245.0, 479.0, 306.0, 575.0, 486.0, 415.0, 224.0, 310.0, 556.0, 530.0, 447.0, 230.0, 398.0, 387.0, 507.0, 331.0, 685.0, 347.0, 633.0, 229.0, 319.0, 607.0, 231.0, 729.0, 226.0, 157.0, 590.0, 474.0, 450.0, 399.0, 449.0, 649.0, 446.0, 630.0, 305.0, 392.0, 454.0, 621.0, 690.0, 248.0, 417.0, 348.0, 311.0, 346.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 80.0, 60.0, 19.0, 70.0, 50.0, 29.0, 50.0, 20.0, 30.0, 40.0, 20.0, 40.0, 30.0, 7.0, 60.0, 80.0, 20.0, -2.0, 40.0, 60.0, 40.0, 10.0, 20.0, 20.0, 30.0, 60.0, -5.0, 20.0, 20.0, 30.0, 60.0, 46.0, 110.0, 20.0, 90.0, 50.0, 80.0, 70.0, 57.0, 40.0, -6.0, 21.0, 90.0, 80.0, 60.0, 70.0, 100.0, 50.0, 20.0, 40.0, 70.0, 20.0, 30.0, 40.0, 0.0, 40.0, 40.0, 40.0, 60.0, 50.0, 40.0, 10.0, 20.0, 30.0, 40.0, 29.0, 30.0, 0.0, 50.0, 20.0, 17.0, 90.0, 28.0, 60.0, 80.0, 70.0, 40.0, 20.0, 30.0, 10.0, 50.0, 9.0, 50.0, 18.0, 90.0, 19.0, 40.0, 30.0, 30.0, 40.0, 80.0, 10.0, 60.0, 88.0, 37.0, 40.0, 50.0, 30.0, 30.0, 20.0, 67.0, -20.0, 70.0, 30.0, 60.0, 38.0, 70.0, 30.0, 100.0, 40.0, 40.0, 50.0, 30.0, 20.0, 40.0, 70.0, 49.0, 20.0, 60.0, 40.0, 80.0, 70.0, 90.0, 70.0, 40.0, 10.0, 50.0, 26.0, 30.0, 50.0, 80.0, 40.0, 60.0, 70.0, 70.0, 100.0, 20.0, 40.0, 90.0, 0.0, 0.0, 10.0, 40.0, 66.0, 30.0, 10.0, 40.0, 30.0, 19.0, 80.0, 70.0, 40.0, 23.0, 30.0, 70.0, 60.0, 29.0, 30.0, 30.0, 18.0, 35.0, 6.0, 10.0, 57.0, 40.0, 19.0, 50.0, 100.0, 29.0, 30.0, 10.0, 120.0, 90.0, 20.0, 20.0, 70.0, 30.0, 0.0, 50.0, 20.0, 50.0, 0.0, 10.0, 30.0, 59.0, 50.0, 81.0, 38.0, 12.0, 100.0, 20.0, 40.0, 60.0, 40.0, -2.0, 30.0, 40.0, 60.0, 39.0, 10.0, 20.0, 70.0, 38.0, 30.0, 60.0, 20.0, 70.0, 0.0, 40.0, 8.0, 70.0, 30.0, 38.0, 20.0, 90.0, 30.0, 60.0, 70.0, 40.0, 22.0, 20.0, 80.0, 90.0, 70.0, 60.0, 12.0, 40.0, 80.0, 30.0, 40.0, 100.0, 30.0, 60.0, 50.0, 70.0, 80.0, 40.0, 70.0, 5.0, 20.0, 6.0, 27.0, 60.0, 30.0, 20.0, 40.0, 13.0, 20.0, 22.0, 100.0, 30.0, 60.0, 73.0, 60.0, 40.0, 35.0, 40.0, 40.0, 110.0, 40.0, 30.0, 20.0, 50.0, 10.0, 30.0, 110.0, 50.0, 31.0, 24.0, 60.0, -4.0, 50.0, 60.0, 40.0, 54.0, 70.0, 20.0, 20.0, 30.0, 20.0, 20.0, 70.0, 80.0, 30.0, 70.0, 30.0, 60.0, 60.0, 40.0, 140.0, 70.0, 49.0, 60.0, 140.0, 14.0, 10.0, 30.0, 70.0, 80.0, 30.0, 0.0, 40.0, 3.0, 0.0, 30.0, 30.0, 30.0, 20.0, 22.0, 110.0, 39.0, 50.0, 50.0, 70.0, 80.0, 90.0, 75.0, 39.0, 100.0, 20.0, 60.0, 20.0, 40.0, 47.0, 80.0, 70.0, 60.0, 6.0, 80.0, 10.0, 30.0, 50.0, -8.0, 20.0, 50.0, 70.0, 70.0, 90.0, 130.0, 40.0, 40.0, 20.0, 30.0, 39.0, 29.0, 60.0, 80.0, 7.0, 20.0, 60.0, 15.0, 40.0, 90.0, 70.0, 60.0, 23.0, 30.0, 2.0, 53.0, 30.0, 100.0, 30.0, 40.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 18.0, 10.0, 60.0, 60.0, 60.0, 40.0, 80.0, 100.0, 60.0, 10.0, 34.0, 50.0, 3.0, 37.0, 10.0, 50.0, 8.0, 20.0, 100.0, 30.0, 50.0, 0.0, 30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0, 50.0, 10.0, 100.0, 10.0, 10.0, 60.0, 20.0, 110.0, 10.0, 40.0, 110.0, 70.0, 120.0, 69.0, 80.0, 50.0, 30.0, 60.0, 20.0, 39.0, 40.0, 20.0, 10.0, 40.0, 50.0, 20.0, 10.0, -16.0, 60.0, 3.0, 50.0, 90.0, 40.0, 70.0, 60.0, 90.0, 70.0, 100.0, 110.0, 70.0, 30.0, 20.0, 40.0, 30.0, 90.0, 80.0, 70.0, 30.0, 10.0, 50.0, 60.0, 50.0, 80.0, 30.0, 88.0, 80.0, 50.0, 10.0, 23.0, 60.0, 50.0, 60.0, 30.0, 79.0, 66.0, 50.0, 60.0, 88.0, 90.0, 30.0, 30.0, 30.0, 50.0, 60.0, 70.0, 80.0, 50.0, 100.0, 70.0, 50.0, 70.0, 90.0, -39.0, 70.0, 40.0, 36.0, 19.0, 10.0, 100.0, 60.0, 100.0, 60.0, 70.0, 50.0, 40.0, 80.0, 30.0, -10.0, 110.0, 30.0, 80.0, 30.0, 10.0, 0.0, 50.0, 30.0, 40.0, 20.0, 10.0, 10.0, 10.0, 60.0, 30.0, 50.0, 70.0, 30.0, 70.0, 110.0, 50.0, 20.0, 35.0, 60.0, 40.0, 0.0, 0.0, 13.0, 0.0, 8.0, 60.0, 40.0, 9.0, 30.0, 130.0, 70.0, 16.0, 71.0, 160.0, 30.0, 16.0, 70.0, 70.0, 30.0, 0.0, 30.0, 90.0, 70.0, 0.0, 50.0, 20.0, 10.0, 20.0, 60.0, 0.0, 18.0, 0.0, 30.0, 40.0, 7.0, 40.0, 30.0, 40.0, 10.0, 20.0, 40.0, 40.0, 40.0, 149.0, 20.0, 40.0, 80.0, -5.0, 10.0, 19.0, 29.0, 40.0, 30.0, 120.0, 27.0, -4.0, 40.0, 80.0, 45.0, 80.0, 50.0, 70.0, 80.0, 40.0, 70.0, 20.0, 40.0, 20.0, 53.0, 19.0, 80.0, 50.0, 60.0, 10.0, 60.0, 100.0, 34.0, 20.0, 38.0, 20.0, 67.0, 20.0, 20.0, 90.0, 30.0, 40.0, 70.0, 14.0, 15.0, 0.0, 20.0, 30.0, 40.0, 30.0, 9.0, 60.0, 6.0, 10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0, 140.0, 70.0, 120.0, 50.0, 10.0, 38.0, 50.0, 50.0, 8.0, 20.0, 60.0, 40.0, 40.0, 30.0, 100.0, 50.0, 50.0, 30.0, 60.0, 70.0, 130.0, 60.0, 40.0, 39.0, 20.0, 0.0, 30.0, 110.0, 10.0, 8.0, 23.0, 20.0, 34.0, 10.0, 29.0, 30.0, 21.0, 50.0, -7.0, 20.0, 30.0, 18.0, 30.0, 30.0, 70.0, 37.0, 30.0, 71.0, 22.0, 60.0, 50.0, 40.0, 29.0, 30.0, 30.0, 70.0, 10.0, 20.0, 90.0, 18.0, 70.0, 9.0, 30.0, 110.0, 70.0, 40.0, 10.0, 70.0, 40.0, 58.0, 19.0, 24.0, 50.0, 24.0, 30.0, 35.0, 30.0, 9.0, 90.0, 20.0, 30.0, 90.0, 40.0, 150.0, 50.0, 100.0, 17.0, 70.0, 50.0, 88.0, 40.0, 29.0, 70.0, 20.0, 30.0, 40.0, 40.0, 18.0, 50.0, 10.0, 20.0, 80.0, 70.0, 62.0, 21.0, 80.0, 70.0, 20.0, 60.0, 150.0, 0.0, 40.0, 50.0, 10.0, 40.0, 12.0, 0.0, 20.0, 40.0, 17.0, 70.0, 0.0, 9.0, 40.0, 80.0, 30.0, 10.0, 20.0, 10.0, 50.0, 80.0, 30.0, 90.0, -2.0, 40.0, 130.0, 100.0, 9.0, 74.0, 56.0, 80.0, 9.0, 24.0, 51.0, 19.0, 12.0, 70.0, -97.0, 140.0, -77.0, 50.0, 10.0, 90.0, 70.0, 70.0, 100.0, 80.0, 100.0, 79.0, 80.0, 40.0, 0.0, 10.0, 8.0, 30.0, 0.0, 28.0, 30.0, 30.0, 50.0, 10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0, 20.0, 10.0, 100.0, 40.0, 70.0, 90.0, 40.0, 100.0, 70.0, 50.0, 40.0, 100.0, -3.0, 90.0, 40.0, 40.0, 50.0, 7.0, 30.0, 80.0, 70.0, 20.0, 70.0, 70.0, 60.0, 40.0, 40.0, 50.0, 0.0, 30.0, 30.0, 50.0, 50.0, 69.0, 10.0, 0.0, 50.0, 80.0, 30.0, 30.0, 60.0, 70.0, 60.0, 39.0, 50.0, 10.0, 20.0, 0.0, 30.0, 110.0, 60.0, 70.0, 100.0, 30.0, 84.0, 100.0, 40.0, 60.0, 100.0, 5.0, 34.0, 30.0, 4.0, 90.0, 80.0, 20.0, 48.0, 60.0, 20.0, 60.0, 90.0, 10.0, 90.0, 50.0, 50.0, 30.0, 100.0, 90.0, 70.0, 50.0, 20.0, 60.0, 20.0, 40.0, 70.0, 40.0, 50.0, 0.0, 10.0, -5.0, 50.0, 50.0, 5.0, 30.0, 80.0, 50.0, 30.0, 37.0, 20.0, 40.0, 80.0, 50.0, 20.0, 20.0, 10.0, 80.0, 30.0, 25.0, 39.0, 100.0, 60.0, 110.0, 60.0, -23.0, 64.0, 60.0, 70.0, 80.0, 50.0, 90.0, 60.0, 45.0, 80.0, 50.0, 45.0, 90.0, 70.0, 80.0, 70.0, 100.0, 10.0, 10.0, 10.0, 20.0, 29.0, 60.0, 50.0, 30.0, 20.0, 9.0, 9.0, 80.0, 32.0, 40.0, 20.0, 70.0, 30.0, 70.0, 16.0, 50.0, 80.0, -10.0, 70.0, 6.0, 30.0, 13.0, 40.0, 19.0, 50.0, 50.0, 100.0, 8.0, 40.0, -65.0, 20.0, 60.0, -2.0, 30.0, 70.0, 50.0, 8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6081153230426757, "mean_inference_ms": 1.6291222334925974, "mean_action_processing_ms": 0.5100670558736699, "mean_env_wait_ms": 1.420513301168186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011862039566040039, "StateBufferConnector_ms": 0.009352684020996094, "ViewRequirementAgentConnector_ms": 0.36864471435546875}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 157.0, "episode_return_mean": 437.86}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.640893726420636, "num_env_steps_trained_throughput_per_sec": 21.640893726420636, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 185007.127, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185007.077, "sample_time_ms": 2347.027, "learn_time_ms": 182640.891, "learn_throughput": 21.901, "synch_weights_time_ms": 11.113}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "a22d3_00000", "date": "2024-08-06_02-45-31", "timestamp": 1722926731, "time_this_iter_s": 184.84234809875488, "time_total_s": 14522.895124197006, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20d3280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14522.895124197006, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 18.27671755725191, "ram_util_percent": 75.89312977099236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8426677311317357, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.55444525519626, "policy_loss": -0.010511810412366119, "vf_loss": 5.563400069491678, "vf_explained_var": 0.011770998790495184, "kl": 0.007784977481462543, "entropy": 0.671864443014478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 157.0, "episode_reward_mean": 451.07, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -97.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 45.107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [504.0, 545.0, 258.0, 588.0, 395.0, 400.0, 480.0, 663.0, 205.0, 703.0, 483.0, 512.0, 365.0, 443.0, 410.0, 258.0, 554.0, 308.0, 388.0, 420.0, 648.0, 237.0, 750.0, 450.0, 531.0, 603.0, 590.0, 456.0, 560.0, 280.0, 500.0, 256.0, 602.0, 370.0, 245.0, 479.0, 306.0, 575.0, 486.0, 415.0, 224.0, 310.0, 556.0, 530.0, 447.0, 230.0, 398.0, 387.0, 507.0, 331.0, 685.0, 347.0, 633.0, 229.0, 319.0, 607.0, 231.0, 729.0, 226.0, 157.0, 590.0, 474.0, 450.0, 399.0, 449.0, 649.0, 446.0, 630.0, 305.0, 392.0, 454.0, 621.0, 690.0, 248.0, 417.0, 348.0, 311.0, 346.0, 515.0, 270.0, 479.0, 411.0, 508.0, 383.0, 578.0, 540.0, 702.0, 452.0, 655.0, 266.0, 563.0, 639.0, 680.0, 725.0, 371.0, 325.0, 333.0, 410.0, 369.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [22.0, 20.0, 80.0, 90.0, 70.0, 60.0, 12.0, 40.0, 80.0, 30.0, 40.0, 100.0, 30.0, 60.0, 50.0, 70.0, 80.0, 40.0, 70.0, 5.0, 20.0, 6.0, 27.0, 60.0, 30.0, 20.0, 40.0, 13.0, 20.0, 22.0, 100.0, 30.0, 60.0, 73.0, 60.0, 40.0, 35.0, 40.0, 40.0, 110.0, 40.0, 30.0, 20.0, 50.0, 10.0, 30.0, 110.0, 50.0, 31.0, 24.0, 60.0, -4.0, 50.0, 60.0, 40.0, 54.0, 70.0, 20.0, 20.0, 30.0, 20.0, 20.0, 70.0, 80.0, 30.0, 70.0, 30.0, 60.0, 60.0, 40.0, 140.0, 70.0, 49.0, 60.0, 140.0, 14.0, 10.0, 30.0, 70.0, 80.0, 30.0, 0.0, 40.0, 3.0, 0.0, 30.0, 30.0, 30.0, 20.0, 22.0, 110.0, 39.0, 50.0, 50.0, 70.0, 80.0, 90.0, 75.0, 39.0, 100.0, 20.0, 60.0, 20.0, 40.0, 47.0, 80.0, 70.0, 60.0, 6.0, 80.0, 10.0, 30.0, 50.0, -8.0, 20.0, 50.0, 70.0, 70.0, 90.0, 130.0, 40.0, 40.0, 20.0, 30.0, 39.0, 29.0, 60.0, 80.0, 7.0, 20.0, 60.0, 15.0, 40.0, 90.0, 70.0, 60.0, 23.0, 30.0, 2.0, 53.0, 30.0, 100.0, 30.0, 40.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 20.0, 60.0, 50.0, 18.0, 10.0, 60.0, 60.0, 60.0, 40.0, 80.0, 100.0, 60.0, 10.0, 34.0, 50.0, 3.0, 37.0, 10.0, 50.0, 8.0, 20.0, 100.0, 30.0, 50.0, 0.0, 30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0, 50.0, 10.0, 100.0, 10.0, 10.0, 60.0, 20.0, 110.0, 10.0, 40.0, 110.0, 70.0, 120.0, 69.0, 80.0, 50.0, 30.0, 60.0, 20.0, 39.0, 40.0, 20.0, 10.0, 40.0, 50.0, 20.0, 10.0, -16.0, 60.0, 3.0, 50.0, 90.0, 40.0, 70.0, 60.0, 90.0, 70.0, 100.0, 110.0, 70.0, 30.0, 20.0, 40.0, 30.0, 90.0, 80.0, 70.0, 30.0, 10.0, 50.0, 60.0, 50.0, 80.0, 30.0, 88.0, 80.0, 50.0, 10.0, 23.0, 60.0, 50.0, 60.0, 30.0, 79.0, 66.0, 50.0, 60.0, 88.0, 90.0, 30.0, 30.0, 30.0, 50.0, 60.0, 70.0, 80.0, 50.0, 100.0, 70.0, 50.0, 70.0, 90.0, -39.0, 70.0, 40.0, 36.0, 19.0, 10.0, 100.0, 60.0, 100.0, 60.0, 70.0, 50.0, 40.0, 80.0, 30.0, -10.0, 110.0, 30.0, 80.0, 30.0, 10.0, 0.0, 50.0, 30.0, 40.0, 20.0, 10.0, 10.0, 10.0, 60.0, 30.0, 50.0, 70.0, 30.0, 70.0, 110.0, 50.0, 20.0, 35.0, 60.0, 40.0, 0.0, 0.0, 13.0, 0.0, 8.0, 60.0, 40.0, 9.0, 30.0, 130.0, 70.0, 16.0, 71.0, 160.0, 30.0, 16.0, 70.0, 70.0, 30.0, 0.0, 30.0, 90.0, 70.0, 0.0, 50.0, 20.0, 10.0, 20.0, 60.0, 0.0, 18.0, 0.0, 30.0, 40.0, 7.0, 40.0, 30.0, 40.0, 10.0, 20.0, 40.0, 40.0, 40.0, 149.0, 20.0, 40.0, 80.0, -5.0, 10.0, 19.0, 29.0, 40.0, 30.0, 120.0, 27.0, -4.0, 40.0, 80.0, 45.0, 80.0, 50.0, 70.0, 80.0, 40.0, 70.0, 20.0, 40.0, 20.0, 53.0, 19.0, 80.0, 50.0, 60.0, 10.0, 60.0, 100.0, 34.0, 20.0, 38.0, 20.0, 67.0, 20.0, 20.0, 90.0, 30.0, 40.0, 70.0, 14.0, 15.0, 0.0, 20.0, 30.0, 40.0, 30.0, 9.0, 60.0, 6.0, 10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0, 140.0, 70.0, 120.0, 50.0, 10.0, 38.0, 50.0, 50.0, 8.0, 20.0, 60.0, 40.0, 40.0, 30.0, 100.0, 50.0, 50.0, 30.0, 60.0, 70.0, 130.0, 60.0, 40.0, 39.0, 20.0, 0.0, 30.0, 110.0, 10.0, 8.0, 23.0, 20.0, 34.0, 10.0, 29.0, 30.0, 21.0, 50.0, -7.0, 20.0, 30.0, 18.0, 30.0, 30.0, 70.0, 37.0, 30.0, 71.0, 22.0, 60.0, 50.0, 40.0, 29.0, 30.0, 30.0, 70.0, 10.0, 20.0, 90.0, 18.0, 70.0, 9.0, 30.0, 110.0, 70.0, 40.0, 10.0, 70.0, 40.0, 58.0, 19.0, 24.0, 50.0, 24.0, 30.0, 35.0, 30.0, 9.0, 90.0, 20.0, 30.0, 90.0, 40.0, 150.0, 50.0, 100.0, 17.0, 70.0, 50.0, 88.0, 40.0, 29.0, 70.0, 20.0, 30.0, 40.0, 40.0, 18.0, 50.0, 10.0, 20.0, 80.0, 70.0, 62.0, 21.0, 80.0, 70.0, 20.0, 60.0, 150.0, 0.0, 40.0, 50.0, 10.0, 40.0, 12.0, 0.0, 20.0, 40.0, 17.0, 70.0, 0.0, 9.0, 40.0, 80.0, 30.0, 10.0, 20.0, 10.0, 50.0, 80.0, 30.0, 90.0, -2.0, 40.0, 130.0, 100.0, 9.0, 74.0, 56.0, 80.0, 9.0, 24.0, 51.0, 19.0, 12.0, 70.0, -97.0, 140.0, -77.0, 50.0, 10.0, 90.0, 70.0, 70.0, 100.0, 80.0, 100.0, 79.0, 80.0, 40.0, 0.0, 10.0, 8.0, 30.0, 0.0, 28.0, 30.0, 30.0, 50.0, 10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0, 20.0, 10.0, 100.0, 40.0, 70.0, 90.0, 40.0, 100.0, 70.0, 50.0, 40.0, 100.0, -3.0, 90.0, 40.0, 40.0, 50.0, 7.0, 30.0, 80.0, 70.0, 20.0, 70.0, 70.0, 60.0, 40.0, 40.0, 50.0, 0.0, 30.0, 30.0, 50.0, 50.0, 69.0, 10.0, 0.0, 50.0, 80.0, 30.0, 30.0, 60.0, 70.0, 60.0, 39.0, 50.0, 10.0, 20.0, 0.0, 30.0, 110.0, 60.0, 70.0, 100.0, 30.0, 84.0, 100.0, 40.0, 60.0, 100.0, 5.0, 34.0, 30.0, 4.0, 90.0, 80.0, 20.0, 48.0, 60.0, 20.0, 60.0, 90.0, 10.0, 90.0, 50.0, 50.0, 30.0, 100.0, 90.0, 70.0, 50.0, 20.0, 60.0, 20.0, 40.0, 70.0, 40.0, 50.0, 0.0, 10.0, -5.0, 50.0, 50.0, 5.0, 30.0, 80.0, 50.0, 30.0, 37.0, 20.0, 40.0, 80.0, 50.0, 20.0, 20.0, 10.0, 80.0, 30.0, 25.0, 39.0, 100.0, 60.0, 110.0, 60.0, -23.0, 64.0, 60.0, 70.0, 80.0, 50.0, 90.0, 60.0, 45.0, 80.0, 50.0, 45.0, 90.0, 70.0, 80.0, 70.0, 100.0, 10.0, 10.0, 10.0, 20.0, 29.0, 60.0, 50.0, 30.0, 20.0, 9.0, 9.0, 80.0, 32.0, 40.0, 20.0, 70.0, 30.0, 70.0, 16.0, 50.0, 80.0, -10.0, 70.0, 6.0, 30.0, 13.0, 40.0, 19.0, 50.0, 50.0, 100.0, 8.0, 40.0, -65.0, 20.0, 60.0, -2.0, 30.0, 70.0, 50.0, 8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0, 50.0, 10.0, 20.0, 70.0, 10.0, 130.0, 30.0, 15.0, 160.0, 20.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 10.0, 80.0, 0.0, 20.0, 90.0, 30.0, 80.0, 40.0, 70.0, 70.0, -10.0, 29.0, 60.0, 20.0, 50.0, 50.0, -2.0, -5.0, 18.0, 60.0, 50.0, 80.0, 40.0, 70.0, 20.0, 19.0, 79.0, 10.0, 70.0, 60.0, 80.0, 70.0, 40.0, 60.0, 40.0, 50.0, 40.0, 45.0, 80.0, 20.0, 39.0, 30.0, 39.0, 0.0, 110.0, 40.0, 50.0, 90.0, 80.0, 20.0, 18.0, 80.0, 60.0, 30.0, 10.0, 50.0, 50.0, 70.0, 40.0, 80.0, 60.0, 90.0, 60.0, 30.0, 120.0, 35.0, 90.0, 60.0, 27.0, 0.0, 80.0, 120.0, 90.0, 80.0, 66.0, 10.0, 30.0, 60.0, 60.0, 70.0, 70.0, 30.0, 16.0, 40.0, 40.0, 70.0, 70.0, 30.0, 120.0, 25.0, 53.0, 90.0, 37.0, 120.0, 50.0, 80.0, 17.0, 20.0, 10.0, 50.0, 10.0, 19.0, 10.0, 0.0, 160.0, 30.0, 40.0, 50.0, 26.0, 30.0, 50.0, 50.0, 27.0, 100.0, 30.0, 90.0, 50.0, 59.0, 60.0, 90.0, 60.0, 80.0, 70.0, 50.0, 10.0, 70.0, 20.0, 80.0, 150.0, 40.0, 110.0, 40.0, 100.0, 60.0, 110.0, 60.0, 70.0, 110.0, 100.0, -45.0, 150.0, 30.0, 70.0, 70.0, 16.0, 80.0, 20.0, 40.0, 60.0, 30.0, 26.0, 10.0, 60.0, 29.0, 19.0, 30.0, 60.0, 40.0, 20.0, 20.0, 20.0, 100.0, 7.0, 9.0, 25.0, 50.0, 90.0, 50.0, 40.0, -25.0, 70.0, 70.0, 60.0, -97.0, 60.0, 30.0, 30.0, 70.0, 60.0, 20.0, 30.0, 50.0, 20.0, 40.0, 30.0, 39.0, 70.0, 20.0, 20.0, 40.0, 40.0, 40.0, 40.0, 30.0, 10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6044302228570941, "mean_inference_ms": 1.624839959554302, "mean_action_processing_ms": 0.50881300803436, "mean_env_wait_ms": 1.4177623506374402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011701345443725586, "StateBufferConnector_ms": 0.0091705322265625, "ViewRequirementAgentConnector_ms": 0.3609957695007324}, "num_episodes": 22, "episode_return_max": 750.0, "episode_return_min": 157.0, "episode_return_mean": 451.07}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.80223426217431, "num_env_steps_trained_throughput_per_sec": 21.80223426217431, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 184844.498, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184844.448, "sample_time_ms": 2334.352, "learn_time_ms": 182491.226, "learn_throughput": 21.919, "synch_weights_time_ms": 10.994}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "a22d3_00000", "date": "2024-08-06_02-48-34", "timestamp": 1722926914, "time_this_iter_s": 183.47554516792297, "time_total_s": 14706.37066936493, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2231af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14706.37066936493, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 17.493436293436293, "ram_util_percent": 75.09227799227799}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.029052503941793, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.052181827552276, "policy_loss": -0.011542247095357535, "vf_loss": 5.062000321021603, "vf_explained_var": 0.025704862966070288, "kl": 0.008618734904455692, "entropy": 0.6943826889268125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 750.0, "episode_reward_min": 157.0, "episode_reward_mean": 452.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -134.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 45.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 420.0, 648.0, 237.0, 750.0, 450.0, 531.0, 603.0, 590.0, 456.0, 560.0, 280.0, 500.0, 256.0, 602.0, 370.0, 245.0, 479.0, 306.0, 575.0, 486.0, 415.0, 224.0, 310.0, 556.0, 530.0, 447.0, 230.0, 398.0, 387.0, 507.0, 331.0, 685.0, 347.0, 633.0, 229.0, 319.0, 607.0, 231.0, 729.0, 226.0, 157.0, 590.0, 474.0, 450.0, 399.0, 449.0, 649.0, 446.0, 630.0, 305.0, 392.0, 454.0, 621.0, 690.0, 248.0, 417.0, 348.0, 311.0, 346.0, 515.0, 270.0, 479.0, 411.0, 508.0, 383.0, 578.0, 540.0, 702.0, 452.0, 655.0, 266.0, 563.0, 639.0, 680.0, 725.0, 371.0, 325.0, 333.0, 410.0, 369.0, 410.0, 600.0, 252.0, 406.0, 224.0, 340.0, 265.0, 327.0, 548.0, 490.0, 327.0, 692.0, 600.0, 480.0, 579.0, 710.0, 405.0, 522.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 60.0, 35.0, 37.0, 0.0, 40.0, 30.0, 30.0, 46.0, 80.0, 50.0, 10.0, 100.0, 10.0, 10.0, 60.0, 20.0, 110.0, 10.0, 40.0, 110.0, 70.0, 120.0, 69.0, 80.0, 50.0, 30.0, 60.0, 20.0, 39.0, 40.0, 20.0, 10.0, 40.0, 50.0, 20.0, 10.0, -16.0, 60.0, 3.0, 50.0, 90.0, 40.0, 70.0, 60.0, 90.0, 70.0, 100.0, 110.0, 70.0, 30.0, 20.0, 40.0, 30.0, 90.0, 80.0, 70.0, 30.0, 10.0, 50.0, 60.0, 50.0, 80.0, 30.0, 88.0, 80.0, 50.0, 10.0, 23.0, 60.0, 50.0, 60.0, 30.0, 79.0, 66.0, 50.0, 60.0, 88.0, 90.0, 30.0, 30.0, 30.0, 50.0, 60.0, 70.0, 80.0, 50.0, 100.0, 70.0, 50.0, 70.0, 90.0, -39.0, 70.0, 40.0, 36.0, 19.0, 10.0, 100.0, 60.0, 100.0, 60.0, 70.0, 50.0, 40.0, 80.0, 30.0, -10.0, 110.0, 30.0, 80.0, 30.0, 10.0, 0.0, 50.0, 30.0, 40.0, 20.0, 10.0, 10.0, 10.0, 60.0, 30.0, 50.0, 70.0, 30.0, 70.0, 110.0, 50.0, 20.0, 35.0, 60.0, 40.0, 0.0, 0.0, 13.0, 0.0, 8.0, 60.0, 40.0, 9.0, 30.0, 130.0, 70.0, 16.0, 71.0, 160.0, 30.0, 16.0, 70.0, 70.0, 30.0, 0.0, 30.0, 90.0, 70.0, 0.0, 50.0, 20.0, 10.0, 20.0, 60.0, 0.0, 18.0, 0.0, 30.0, 40.0, 7.0, 40.0, 30.0, 40.0, 10.0, 20.0, 40.0, 40.0, 40.0, 149.0, 20.0, 40.0, 80.0, -5.0, 10.0, 19.0, 29.0, 40.0, 30.0, 120.0, 27.0, -4.0, 40.0, 80.0, 45.0, 80.0, 50.0, 70.0, 80.0, 40.0, 70.0, 20.0, 40.0, 20.0, 53.0, 19.0, 80.0, 50.0, 60.0, 10.0, 60.0, 100.0, 34.0, 20.0, 38.0, 20.0, 67.0, 20.0, 20.0, 90.0, 30.0, 40.0, 70.0, 14.0, 15.0, 0.0, 20.0, 30.0, 40.0, 30.0, 9.0, 60.0, 6.0, 10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0, 140.0, 70.0, 120.0, 50.0, 10.0, 38.0, 50.0, 50.0, 8.0, 20.0, 60.0, 40.0, 40.0, 30.0, 100.0, 50.0, 50.0, 30.0, 60.0, 70.0, 130.0, 60.0, 40.0, 39.0, 20.0, 0.0, 30.0, 110.0, 10.0, 8.0, 23.0, 20.0, 34.0, 10.0, 29.0, 30.0, 21.0, 50.0, -7.0, 20.0, 30.0, 18.0, 30.0, 30.0, 70.0, 37.0, 30.0, 71.0, 22.0, 60.0, 50.0, 40.0, 29.0, 30.0, 30.0, 70.0, 10.0, 20.0, 90.0, 18.0, 70.0, 9.0, 30.0, 110.0, 70.0, 40.0, 10.0, 70.0, 40.0, 58.0, 19.0, 24.0, 50.0, 24.0, 30.0, 35.0, 30.0, 9.0, 90.0, 20.0, 30.0, 90.0, 40.0, 150.0, 50.0, 100.0, 17.0, 70.0, 50.0, 88.0, 40.0, 29.0, 70.0, 20.0, 30.0, 40.0, 40.0, 18.0, 50.0, 10.0, 20.0, 80.0, 70.0, 62.0, 21.0, 80.0, 70.0, 20.0, 60.0, 150.0, 0.0, 40.0, 50.0, 10.0, 40.0, 12.0, 0.0, 20.0, 40.0, 17.0, 70.0, 0.0, 9.0, 40.0, 80.0, 30.0, 10.0, 20.0, 10.0, 50.0, 80.0, 30.0, 90.0, -2.0, 40.0, 130.0, 100.0, 9.0, 74.0, 56.0, 80.0, 9.0, 24.0, 51.0, 19.0, 12.0, 70.0, -97.0, 140.0, -77.0, 50.0, 10.0, 90.0, 70.0, 70.0, 100.0, 80.0, 100.0, 79.0, 80.0, 40.0, 0.0, 10.0, 8.0, 30.0, 0.0, 28.0, 30.0, 30.0, 50.0, 10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0, 20.0, 10.0, 100.0, 40.0, 70.0, 90.0, 40.0, 100.0, 70.0, 50.0, 40.0, 100.0, -3.0, 90.0, 40.0, 40.0, 50.0, 7.0, 30.0, 80.0, 70.0, 20.0, 70.0, 70.0, 60.0, 40.0, 40.0, 50.0, 0.0, 30.0, 30.0, 50.0, 50.0, 69.0, 10.0, 0.0, 50.0, 80.0, 30.0, 30.0, 60.0, 70.0, 60.0, 39.0, 50.0, 10.0, 20.0, 0.0, 30.0, 110.0, 60.0, 70.0, 100.0, 30.0, 84.0, 100.0, 40.0, 60.0, 100.0, 5.0, 34.0, 30.0, 4.0, 90.0, 80.0, 20.0, 48.0, 60.0, 20.0, 60.0, 90.0, 10.0, 90.0, 50.0, 50.0, 30.0, 100.0, 90.0, 70.0, 50.0, 20.0, 60.0, 20.0, 40.0, 70.0, 40.0, 50.0, 0.0, 10.0, -5.0, 50.0, 50.0, 5.0, 30.0, 80.0, 50.0, 30.0, 37.0, 20.0, 40.0, 80.0, 50.0, 20.0, 20.0, 10.0, 80.0, 30.0, 25.0, 39.0, 100.0, 60.0, 110.0, 60.0, -23.0, 64.0, 60.0, 70.0, 80.0, 50.0, 90.0, 60.0, 45.0, 80.0, 50.0, 45.0, 90.0, 70.0, 80.0, 70.0, 100.0, 10.0, 10.0, 10.0, 20.0, 29.0, 60.0, 50.0, 30.0, 20.0, 9.0, 9.0, 80.0, 32.0, 40.0, 20.0, 70.0, 30.0, 70.0, 16.0, 50.0, 80.0, -10.0, 70.0, 6.0, 30.0, 13.0, 40.0, 19.0, 50.0, 50.0, 100.0, 8.0, 40.0, -65.0, 20.0, 60.0, -2.0, 30.0, 70.0, 50.0, 8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0, 50.0, 10.0, 20.0, 70.0, 10.0, 130.0, 30.0, 15.0, 160.0, 20.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 10.0, 80.0, 0.0, 20.0, 90.0, 30.0, 80.0, 40.0, 70.0, 70.0, -10.0, 29.0, 60.0, 20.0, 50.0, 50.0, -2.0, -5.0, 18.0, 60.0, 50.0, 80.0, 40.0, 70.0, 20.0, 19.0, 79.0, 10.0, 70.0, 60.0, 80.0, 70.0, 40.0, 60.0, 40.0, 50.0, 40.0, 45.0, 80.0, 20.0, 39.0, 30.0, 39.0, 0.0, 110.0, 40.0, 50.0, 90.0, 80.0, 20.0, 18.0, 80.0, 60.0, 30.0, 10.0, 50.0, 50.0, 70.0, 40.0, 80.0, 60.0, 90.0, 60.0, 30.0, 120.0, 35.0, 90.0, 60.0, 27.0, 0.0, 80.0, 120.0, 90.0, 80.0, 66.0, 10.0, 30.0, 60.0, 60.0, 70.0, 70.0, 30.0, 16.0, 40.0, 40.0, 70.0, 70.0, 30.0, 120.0, 25.0, 53.0, 90.0, 37.0, 120.0, 50.0, 80.0, 17.0, 20.0, 10.0, 50.0, 10.0, 19.0, 10.0, 0.0, 160.0, 30.0, 40.0, 50.0, 26.0, 30.0, 50.0, 50.0, 27.0, 100.0, 30.0, 90.0, 50.0, 59.0, 60.0, 90.0, 60.0, 80.0, 70.0, 50.0, 10.0, 70.0, 20.0, 80.0, 150.0, 40.0, 110.0, 40.0, 100.0, 60.0, 110.0, 60.0, 70.0, 110.0, 100.0, -45.0, 150.0, 30.0, 70.0, 70.0, 16.0, 80.0, 20.0, 40.0, 60.0, 30.0, 26.0, 10.0, 60.0, 29.0, 19.0, 30.0, 60.0, 40.0, 20.0, 20.0, 20.0, 100.0, 7.0, 9.0, 25.0, 50.0, 90.0, 50.0, 40.0, -25.0, 70.0, 70.0, 60.0, -97.0, 60.0, 30.0, 30.0, 70.0, 60.0, 20.0, 30.0, 50.0, 20.0, 40.0, 30.0, 39.0, 70.0, 20.0, 20.0, 40.0, 40.0, 40.0, 40.0, 30.0, 10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0, 120.0, 20.0, 60.0, 60.0, 20.0, 60.0, 110.0, 0.0, 100.0, 50.0, 10.0, 10.0, 130.0, 0.0, 30.0, -9.0, 15.0, 20.0, 8.0, 38.0, 80.0, 90.0, 40.0, -3.0, 20.0, 40.0, 9.0, 90.0, 10.0, 30.0, 20.0, 10.0, 0.0, 39.0, 33.0, 20.0, 11.0, 17.0, 30.0, 44.0, 0.0, 30.0, 50.0, 70.0, 60.0, 60.0, 20.0, 0.0, 0.0, 50.0, 50.0, -55.0, 30.0, 20.0, 110.0, 40.0, 20.0, 30.0, 30.0, -10.0, 50.0, 39.0, 20.0, 110.0, 20.0, 0.0, 9.0, 10.0, 9.0, 60.0, 60.0, 100.0, 40.0, 70.0, 30.0, 40.0, 18.0, 70.0, 30.0, 90.0, 40.0, 140.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 70.0, 80.0, 70.0, 35.0, 80.0, 100.0, -134.0, 70.0, 60.0, 70.0, 4.0, -28.0, 109.0, 35.0, 110.0, 51.0, 4.0, 110.0, 63.0, 60.0, 70.0, 80.0, 0.0, 70.0, 80.0, 100.0, 70.0, 80.0, 70.0, 10.0, 50.0, 70.0, 50.0, 60.0, 70.0, 28.0, 7.0, 30.0, 90.0, 60.0, 45.0, 40.0, 100.0, 20.0, 35.0, 30.0, 29.0, 90.0, 80.0, 130.0, 60.0, 5.0, 80.0, 50.0, 80.0, 90.0, 60.0, 60.0, 80.0, 60.0, 40.0, 110.0, 90.0, 50.0, 0.0, 80.0, 50.0, -15.0, 30.0, 70.0, 10.0, 40.0, 30.0, 60.0, 60.0, 110.0, 22.0, 130.0, 20.0, 20.0, 30.0, 40.0, 90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6024618055094333, "mean_inference_ms": 1.6227787144969859, "mean_action_processing_ms": 0.5079688482157023, "mean_env_wait_ms": 1.4153499794442876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011601924896240234, "StateBufferConnector_ms": 0.009035348892211914, "ViewRequirementAgentConnector_ms": 0.37122368812561035}, "num_episodes": 18, "episode_return_max": 750.0, "episode_return_min": 157.0, "episode_return_mean": 452.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.73561033089159, "num_env_steps_trained_throughput_per_sec": 21.73561033089159, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 184764.483, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184764.433, "sample_time_ms": 2332.112, "learn_time_ms": 182413.352, "learn_throughput": 21.928, "synch_weights_time_ms": 11.033}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "a22d3_00000", "date": "2024-08-06_02-51-38", "timestamp": 1722927098, "time_this_iter_s": 184.03983306884766, "time_total_s": 14890.410502433777, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2231280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14890.410502433777, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.33984674329502, "ram_util_percent": 75.17356321839078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.014152853189312, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.750286860511706, "policy_loss": -0.011335499776791111, "vf_loss": 5.75996893409469, "vf_explained_var": 0.011201436514544664, "kl": 0.00826715107416856, "entropy": 0.6380047799775395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 870.0, "episode_reward_min": 157.0, "episode_reward_mean": 463.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -134.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 46.329}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 556.0, 530.0, 447.0, 230.0, 398.0, 387.0, 507.0, 331.0, 685.0, 347.0, 633.0, 229.0, 319.0, 607.0, 231.0, 729.0, 226.0, 157.0, 590.0, 474.0, 450.0, 399.0, 449.0, 649.0, 446.0, 630.0, 305.0, 392.0, 454.0, 621.0, 690.0, 248.0, 417.0, 348.0, 311.0, 346.0, 515.0, 270.0, 479.0, 411.0, 508.0, 383.0, 578.0, 540.0, 702.0, 452.0, 655.0, 266.0, 563.0, 639.0, 680.0, 725.0, 371.0, 325.0, 333.0, 410.0, 369.0, 410.0, 600.0, 252.0, 406.0, 224.0, 340.0, 265.0, 327.0, 548.0, 490.0, 327.0, 692.0, 600.0, 480.0, 579.0, 710.0, 405.0, 522.0, 470.0, 870.0, 520.0, 620.0, 318.0, 232.0, 345.0, 431.0, 565.0, 666.0, 418.0, 434.0, 480.0, 208.0, 630.0, 343.0, 443.0, 500.0, 587.0, 770.0, 488.0, 532.0, 549.0, 481.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 0.0, 0.0, 30.0, 80.0, 20.0, 40.0, 20.0, 40.0, 140.0, 70.0, 120.0, 50.0, 10.0, 38.0, 50.0, 50.0, 8.0, 20.0, 60.0, 40.0, 40.0, 30.0, 100.0, 50.0, 50.0, 30.0, 60.0, 70.0, 130.0, 60.0, 40.0, 39.0, 20.0, 0.0, 30.0, 110.0, 10.0, 8.0, 23.0, 20.0, 34.0, 10.0, 29.0, 30.0, 21.0, 50.0, -7.0, 20.0, 30.0, 18.0, 30.0, 30.0, 70.0, 37.0, 30.0, 71.0, 22.0, 60.0, 50.0, 40.0, 29.0, 30.0, 30.0, 70.0, 10.0, 20.0, 90.0, 18.0, 70.0, 9.0, 30.0, 110.0, 70.0, 40.0, 10.0, 70.0, 40.0, 58.0, 19.0, 24.0, 50.0, 24.0, 30.0, 35.0, 30.0, 9.0, 90.0, 20.0, 30.0, 90.0, 40.0, 150.0, 50.0, 100.0, 17.0, 70.0, 50.0, 88.0, 40.0, 29.0, 70.0, 20.0, 30.0, 40.0, 40.0, 18.0, 50.0, 10.0, 20.0, 80.0, 70.0, 62.0, 21.0, 80.0, 70.0, 20.0, 60.0, 150.0, 0.0, 40.0, 50.0, 10.0, 40.0, 12.0, 0.0, 20.0, 40.0, 17.0, 70.0, 0.0, 9.0, 40.0, 80.0, 30.0, 10.0, 20.0, 10.0, 50.0, 80.0, 30.0, 90.0, -2.0, 40.0, 130.0, 100.0, 9.0, 74.0, 56.0, 80.0, 9.0, 24.0, 51.0, 19.0, 12.0, 70.0, -97.0, 140.0, -77.0, 50.0, 10.0, 90.0, 70.0, 70.0, 100.0, 80.0, 100.0, 79.0, 80.0, 40.0, 0.0, 10.0, 8.0, 30.0, 0.0, 28.0, 30.0, 30.0, 50.0, 10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0, 20.0, 10.0, 100.0, 40.0, 70.0, 90.0, 40.0, 100.0, 70.0, 50.0, 40.0, 100.0, -3.0, 90.0, 40.0, 40.0, 50.0, 7.0, 30.0, 80.0, 70.0, 20.0, 70.0, 70.0, 60.0, 40.0, 40.0, 50.0, 0.0, 30.0, 30.0, 50.0, 50.0, 69.0, 10.0, 0.0, 50.0, 80.0, 30.0, 30.0, 60.0, 70.0, 60.0, 39.0, 50.0, 10.0, 20.0, 0.0, 30.0, 110.0, 60.0, 70.0, 100.0, 30.0, 84.0, 100.0, 40.0, 60.0, 100.0, 5.0, 34.0, 30.0, 4.0, 90.0, 80.0, 20.0, 48.0, 60.0, 20.0, 60.0, 90.0, 10.0, 90.0, 50.0, 50.0, 30.0, 100.0, 90.0, 70.0, 50.0, 20.0, 60.0, 20.0, 40.0, 70.0, 40.0, 50.0, 0.0, 10.0, -5.0, 50.0, 50.0, 5.0, 30.0, 80.0, 50.0, 30.0, 37.0, 20.0, 40.0, 80.0, 50.0, 20.0, 20.0, 10.0, 80.0, 30.0, 25.0, 39.0, 100.0, 60.0, 110.0, 60.0, -23.0, 64.0, 60.0, 70.0, 80.0, 50.0, 90.0, 60.0, 45.0, 80.0, 50.0, 45.0, 90.0, 70.0, 80.0, 70.0, 100.0, 10.0, 10.0, 10.0, 20.0, 29.0, 60.0, 50.0, 30.0, 20.0, 9.0, 9.0, 80.0, 32.0, 40.0, 20.0, 70.0, 30.0, 70.0, 16.0, 50.0, 80.0, -10.0, 70.0, 6.0, 30.0, 13.0, 40.0, 19.0, 50.0, 50.0, 100.0, 8.0, 40.0, -65.0, 20.0, 60.0, -2.0, 30.0, 70.0, 50.0, 8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0, 50.0, 10.0, 20.0, 70.0, 10.0, 130.0, 30.0, 15.0, 160.0, 20.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 10.0, 80.0, 0.0, 20.0, 90.0, 30.0, 80.0, 40.0, 70.0, 70.0, -10.0, 29.0, 60.0, 20.0, 50.0, 50.0, -2.0, -5.0, 18.0, 60.0, 50.0, 80.0, 40.0, 70.0, 20.0, 19.0, 79.0, 10.0, 70.0, 60.0, 80.0, 70.0, 40.0, 60.0, 40.0, 50.0, 40.0, 45.0, 80.0, 20.0, 39.0, 30.0, 39.0, 0.0, 110.0, 40.0, 50.0, 90.0, 80.0, 20.0, 18.0, 80.0, 60.0, 30.0, 10.0, 50.0, 50.0, 70.0, 40.0, 80.0, 60.0, 90.0, 60.0, 30.0, 120.0, 35.0, 90.0, 60.0, 27.0, 0.0, 80.0, 120.0, 90.0, 80.0, 66.0, 10.0, 30.0, 60.0, 60.0, 70.0, 70.0, 30.0, 16.0, 40.0, 40.0, 70.0, 70.0, 30.0, 120.0, 25.0, 53.0, 90.0, 37.0, 120.0, 50.0, 80.0, 17.0, 20.0, 10.0, 50.0, 10.0, 19.0, 10.0, 0.0, 160.0, 30.0, 40.0, 50.0, 26.0, 30.0, 50.0, 50.0, 27.0, 100.0, 30.0, 90.0, 50.0, 59.0, 60.0, 90.0, 60.0, 80.0, 70.0, 50.0, 10.0, 70.0, 20.0, 80.0, 150.0, 40.0, 110.0, 40.0, 100.0, 60.0, 110.0, 60.0, 70.0, 110.0, 100.0, -45.0, 150.0, 30.0, 70.0, 70.0, 16.0, 80.0, 20.0, 40.0, 60.0, 30.0, 26.0, 10.0, 60.0, 29.0, 19.0, 30.0, 60.0, 40.0, 20.0, 20.0, 20.0, 100.0, 7.0, 9.0, 25.0, 50.0, 90.0, 50.0, 40.0, -25.0, 70.0, 70.0, 60.0, -97.0, 60.0, 30.0, 30.0, 70.0, 60.0, 20.0, 30.0, 50.0, 20.0, 40.0, 30.0, 39.0, 70.0, 20.0, 20.0, 40.0, 40.0, 40.0, 40.0, 30.0, 10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0, 120.0, 20.0, 60.0, 60.0, 20.0, 60.0, 110.0, 0.0, 100.0, 50.0, 10.0, 10.0, 130.0, 0.0, 30.0, -9.0, 15.0, 20.0, 8.0, 38.0, 80.0, 90.0, 40.0, -3.0, 20.0, 40.0, 9.0, 90.0, 10.0, 30.0, 20.0, 10.0, 0.0, 39.0, 33.0, 20.0, 11.0, 17.0, 30.0, 44.0, 0.0, 30.0, 50.0, 70.0, 60.0, 60.0, 20.0, 0.0, 0.0, 50.0, 50.0, -55.0, 30.0, 20.0, 110.0, 40.0, 20.0, 30.0, 30.0, -10.0, 50.0, 39.0, 20.0, 110.0, 20.0, 0.0, 9.0, 10.0, 9.0, 60.0, 60.0, 100.0, 40.0, 70.0, 30.0, 40.0, 18.0, 70.0, 30.0, 90.0, 40.0, 140.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 70.0, 80.0, 70.0, 35.0, 80.0, 100.0, -134.0, 70.0, 60.0, 70.0, 4.0, -28.0, 109.0, 35.0, 110.0, 51.0, 4.0, 110.0, 63.0, 60.0, 70.0, 80.0, 0.0, 70.0, 80.0, 100.0, 70.0, 80.0, 70.0, 10.0, 50.0, 70.0, 50.0, 60.0, 70.0, 28.0, 7.0, 30.0, 90.0, 60.0, 45.0, 40.0, 100.0, 20.0, 35.0, 30.0, 29.0, 90.0, 80.0, 130.0, 60.0, 5.0, 80.0, 50.0, 80.0, 90.0, 60.0, 60.0, 80.0, 60.0, 40.0, 110.0, 90.0, 50.0, 0.0, 80.0, 50.0, -15.0, 30.0, 70.0, 10.0, 40.0, 30.0, 60.0, 60.0, 110.0, 22.0, 130.0, 20.0, 20.0, 30.0, 40.0, 90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0, 100.0, 120.0, 50.0, 50.0, 100.0, 70.0, 40.0, 110.0, 120.0, 110.0, 30.0, 80.0, 70.0, 80.0, 60.0, 40.0, 40.0, 20.0, 40.0, 60.0, 40.0, 80.0, 50.0, 60.0, 40.0, 60.0, 110.0, 70.0, 50.0, 60.0, 47.0, 20.0, 0.0, 106.0, 20.0, 25.0, 40.0, 50.0, 0.0, 10.0, 40.0, 50.0, 10.0, 37.0, -5.0, 10.0, 70.0, 20.0, 0.0, 0.0, 60.0, 40.0, 30.0, 5.0, 10.0, 110.0, 10.0, 30.0, 10.0, 40.0, 20.0, 80.0, 8.0, 38.0, 20.0, 80.0, 50.0, 90.0, 30.0, 15.0, 40.0, 30.0, 60.0, 25.0, 108.0, 50.0, 70.0, 90.0, 52.0, 40.0, 90.0, 110.0, 87.0, 60.0, 119.0, 10.0, 30.0, 30.0, 90.0, 40.0, 80.0, 60.0, -50.0, 64.0, 50.0, 60.0, 40.0, 37.0, 50.0, 27.0, 55.0, 30.0, 50.0, 34.0, 50.0, 30.0, 40.0, 80.0, 10.0, 55.0, 10.0, 30.0, 80.0, 90.0, 110.0, 0.0, 50.0, 20.0, 50.0, 40.0, 10.0, 70.0, 10.0, 8.0, 0.0, 80.0, 30.0, -5.0, 5.0, 0.0, 20.0, 50.0, 70.0, 70.0, 100.0, 100.0, 30.0, 60.0, 80.0, 50.0, 49.0, 60.0, 0.0, 50.0, 27.0, 60.0, 14.0, 30.0, 60.0, -7.0, 90.0, 60.0, 8.0, 90.0, 80.0, 70.0, 30.0, 40.0, 14.0, -39.0, 19.0, 80.0, 50.0, -3.0, 39.0, 30.0, 90.0, 15.0, 100.0, 80.0, 90.0, 20.0, 99.0, 1.0, 60.0, 110.0, 30.0, 60.0, 77.0, 40.0, 30.0, 100.0, 90.0, 120.0, 90.0, 100.0, 50.0, 30.0, 70.0, 90.0, 70.0, 30.0, 40.0, 77.0, 30.0, 70.0, 50.0, 60.0, 35.0, 26.0, 86.0, 21.0, 50.0, 40.0, 70.0, 80.0, 35.0, 30.0, 70.0, 50.0, 35.0, 100.0, -102.0, 100.0, 20.0, 137.0, 97.0, 12.0, 80.0, 70.0, 20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5989639957568789, "mean_inference_ms": 1.6194521886370992, "mean_action_processing_ms": 0.5067518687597781, "mean_env_wait_ms": 1.4124203718776716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687040328979492, "StateBufferConnector_ms": 0.00913858413696289, "ViewRequirementAgentConnector_ms": 0.3800926208496094}, "num_episodes": 23, "episode_return_max": 870.0, "episode_return_min": 157.0, "episode_return_mean": 463.29}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.563945298816858, "num_env_steps_trained_throughput_per_sec": 21.563945298816858, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 184624.341, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184624.292, "sample_time_ms": 2319.052, "learn_time_ms": 182286.55, "learn_throughput": 21.943, "synch_weights_time_ms": 10.703}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "a22d3_00000", "date": "2024-08-06_02-54-44", "timestamp": 1722927284, "time_this_iter_s": 185.50302624702454, "time_total_s": 15075.913528680801, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2231f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15075.913528680801, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.509541984732824, "ram_util_percent": 75.39236641221373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.084094765671272, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.69407740477175, "policy_loss": -0.01166888718159534, "vf_loss": 5.704047468650582, "vf_explained_var": 0.008682306753560758, "kl": 0.008494116384243222, "entropy": 0.6922274403678723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 870.0, "episode_reward_min": 157.0, "episode_reward_mean": 468.08, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -134.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 46.808}, "custom_metrics": {}, "hist_stats": {"episode_reward": [157.0, 590.0, 474.0, 450.0, 399.0, 449.0, 649.0, 446.0, 630.0, 305.0, 392.0, 454.0, 621.0, 690.0, 248.0, 417.0, 348.0, 311.0, 346.0, 515.0, 270.0, 479.0, 411.0, 508.0, 383.0, 578.0, 540.0, 702.0, 452.0, 655.0, 266.0, 563.0, 639.0, 680.0, 725.0, 371.0, 325.0, 333.0, 410.0, 369.0, 410.0, 600.0, 252.0, 406.0, 224.0, 340.0, 265.0, 327.0, 548.0, 490.0, 327.0, 692.0, 600.0, 480.0, 579.0, 710.0, 405.0, 522.0, 470.0, 870.0, 520.0, 620.0, 318.0, 232.0, 345.0, 431.0, 565.0, 666.0, 418.0, 434.0, 480.0, 208.0, 630.0, 343.0, 443.0, 500.0, 587.0, 770.0, 488.0, 532.0, 549.0, 481.0, 624.0, 366.0, 365.0, 500.0, 240.0, 565.0, 534.0, 626.0, 654.0, 420.0, 330.0, 223.0, 309.0, 480.0, 668.0, 381.0, 518.0, 378.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 26.0, 20.0, -3.0, -7.0, 30.0, 6.0, 20.0, 5.0, 50.0, 20.0, 10.0, 100.0, 40.0, 70.0, 90.0, 40.0, 100.0, 70.0, 50.0, 40.0, 100.0, -3.0, 90.0, 40.0, 40.0, 50.0, 7.0, 30.0, 80.0, 70.0, 20.0, 70.0, 70.0, 60.0, 40.0, 40.0, 50.0, 0.0, 30.0, 30.0, 50.0, 50.0, 69.0, 10.0, 0.0, 50.0, 80.0, 30.0, 30.0, 60.0, 70.0, 60.0, 39.0, 50.0, 10.0, 20.0, 0.0, 30.0, 110.0, 60.0, 70.0, 100.0, 30.0, 84.0, 100.0, 40.0, 60.0, 100.0, 5.0, 34.0, 30.0, 4.0, 90.0, 80.0, 20.0, 48.0, 60.0, 20.0, 60.0, 90.0, 10.0, 90.0, 50.0, 50.0, 30.0, 100.0, 90.0, 70.0, 50.0, 20.0, 60.0, 20.0, 40.0, 70.0, 40.0, 50.0, 0.0, 10.0, -5.0, 50.0, 50.0, 5.0, 30.0, 80.0, 50.0, 30.0, 37.0, 20.0, 40.0, 80.0, 50.0, 20.0, 20.0, 10.0, 80.0, 30.0, 25.0, 39.0, 100.0, 60.0, 110.0, 60.0, -23.0, 64.0, 60.0, 70.0, 80.0, 50.0, 90.0, 60.0, 45.0, 80.0, 50.0, 45.0, 90.0, 70.0, 80.0, 70.0, 100.0, 10.0, 10.0, 10.0, 20.0, 29.0, 60.0, 50.0, 30.0, 20.0, 9.0, 9.0, 80.0, 32.0, 40.0, 20.0, 70.0, 30.0, 70.0, 16.0, 50.0, 80.0, -10.0, 70.0, 6.0, 30.0, 13.0, 40.0, 19.0, 50.0, 50.0, 100.0, 8.0, 40.0, -65.0, 20.0, 60.0, -2.0, 30.0, 70.0, 50.0, 8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0, 50.0, 10.0, 20.0, 70.0, 10.0, 130.0, 30.0, 15.0, 160.0, 20.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 10.0, 80.0, 0.0, 20.0, 90.0, 30.0, 80.0, 40.0, 70.0, 70.0, -10.0, 29.0, 60.0, 20.0, 50.0, 50.0, -2.0, -5.0, 18.0, 60.0, 50.0, 80.0, 40.0, 70.0, 20.0, 19.0, 79.0, 10.0, 70.0, 60.0, 80.0, 70.0, 40.0, 60.0, 40.0, 50.0, 40.0, 45.0, 80.0, 20.0, 39.0, 30.0, 39.0, 0.0, 110.0, 40.0, 50.0, 90.0, 80.0, 20.0, 18.0, 80.0, 60.0, 30.0, 10.0, 50.0, 50.0, 70.0, 40.0, 80.0, 60.0, 90.0, 60.0, 30.0, 120.0, 35.0, 90.0, 60.0, 27.0, 0.0, 80.0, 120.0, 90.0, 80.0, 66.0, 10.0, 30.0, 60.0, 60.0, 70.0, 70.0, 30.0, 16.0, 40.0, 40.0, 70.0, 70.0, 30.0, 120.0, 25.0, 53.0, 90.0, 37.0, 120.0, 50.0, 80.0, 17.0, 20.0, 10.0, 50.0, 10.0, 19.0, 10.0, 0.0, 160.0, 30.0, 40.0, 50.0, 26.0, 30.0, 50.0, 50.0, 27.0, 100.0, 30.0, 90.0, 50.0, 59.0, 60.0, 90.0, 60.0, 80.0, 70.0, 50.0, 10.0, 70.0, 20.0, 80.0, 150.0, 40.0, 110.0, 40.0, 100.0, 60.0, 110.0, 60.0, 70.0, 110.0, 100.0, -45.0, 150.0, 30.0, 70.0, 70.0, 16.0, 80.0, 20.0, 40.0, 60.0, 30.0, 26.0, 10.0, 60.0, 29.0, 19.0, 30.0, 60.0, 40.0, 20.0, 20.0, 20.0, 100.0, 7.0, 9.0, 25.0, 50.0, 90.0, 50.0, 40.0, -25.0, 70.0, 70.0, 60.0, -97.0, 60.0, 30.0, 30.0, 70.0, 60.0, 20.0, 30.0, 50.0, 20.0, 40.0, 30.0, 39.0, 70.0, 20.0, 20.0, 40.0, 40.0, 40.0, 40.0, 30.0, 10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0, 120.0, 20.0, 60.0, 60.0, 20.0, 60.0, 110.0, 0.0, 100.0, 50.0, 10.0, 10.0, 130.0, 0.0, 30.0, -9.0, 15.0, 20.0, 8.0, 38.0, 80.0, 90.0, 40.0, -3.0, 20.0, 40.0, 9.0, 90.0, 10.0, 30.0, 20.0, 10.0, 0.0, 39.0, 33.0, 20.0, 11.0, 17.0, 30.0, 44.0, 0.0, 30.0, 50.0, 70.0, 60.0, 60.0, 20.0, 0.0, 0.0, 50.0, 50.0, -55.0, 30.0, 20.0, 110.0, 40.0, 20.0, 30.0, 30.0, -10.0, 50.0, 39.0, 20.0, 110.0, 20.0, 0.0, 9.0, 10.0, 9.0, 60.0, 60.0, 100.0, 40.0, 70.0, 30.0, 40.0, 18.0, 70.0, 30.0, 90.0, 40.0, 140.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 70.0, 80.0, 70.0, 35.0, 80.0, 100.0, -134.0, 70.0, 60.0, 70.0, 4.0, -28.0, 109.0, 35.0, 110.0, 51.0, 4.0, 110.0, 63.0, 60.0, 70.0, 80.0, 0.0, 70.0, 80.0, 100.0, 70.0, 80.0, 70.0, 10.0, 50.0, 70.0, 50.0, 60.0, 70.0, 28.0, 7.0, 30.0, 90.0, 60.0, 45.0, 40.0, 100.0, 20.0, 35.0, 30.0, 29.0, 90.0, 80.0, 130.0, 60.0, 5.0, 80.0, 50.0, 80.0, 90.0, 60.0, 60.0, 80.0, 60.0, 40.0, 110.0, 90.0, 50.0, 0.0, 80.0, 50.0, -15.0, 30.0, 70.0, 10.0, 40.0, 30.0, 60.0, 60.0, 110.0, 22.0, 130.0, 20.0, 20.0, 30.0, 40.0, 90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0, 100.0, 120.0, 50.0, 50.0, 100.0, 70.0, 40.0, 110.0, 120.0, 110.0, 30.0, 80.0, 70.0, 80.0, 60.0, 40.0, 40.0, 20.0, 40.0, 60.0, 40.0, 80.0, 50.0, 60.0, 40.0, 60.0, 110.0, 70.0, 50.0, 60.0, 47.0, 20.0, 0.0, 106.0, 20.0, 25.0, 40.0, 50.0, 0.0, 10.0, 40.0, 50.0, 10.0, 37.0, -5.0, 10.0, 70.0, 20.0, 0.0, 0.0, 60.0, 40.0, 30.0, 5.0, 10.0, 110.0, 10.0, 30.0, 10.0, 40.0, 20.0, 80.0, 8.0, 38.0, 20.0, 80.0, 50.0, 90.0, 30.0, 15.0, 40.0, 30.0, 60.0, 25.0, 108.0, 50.0, 70.0, 90.0, 52.0, 40.0, 90.0, 110.0, 87.0, 60.0, 119.0, 10.0, 30.0, 30.0, 90.0, 40.0, 80.0, 60.0, -50.0, 64.0, 50.0, 60.0, 40.0, 37.0, 50.0, 27.0, 55.0, 30.0, 50.0, 34.0, 50.0, 30.0, 40.0, 80.0, 10.0, 55.0, 10.0, 30.0, 80.0, 90.0, 110.0, 0.0, 50.0, 20.0, 50.0, 40.0, 10.0, 70.0, 10.0, 8.0, 0.0, 80.0, 30.0, -5.0, 5.0, 0.0, 20.0, 50.0, 70.0, 70.0, 100.0, 100.0, 30.0, 60.0, 80.0, 50.0, 49.0, 60.0, 0.0, 50.0, 27.0, 60.0, 14.0, 30.0, 60.0, -7.0, 90.0, 60.0, 8.0, 90.0, 80.0, 70.0, 30.0, 40.0, 14.0, -39.0, 19.0, 80.0, 50.0, -3.0, 39.0, 30.0, 90.0, 15.0, 100.0, 80.0, 90.0, 20.0, 99.0, 1.0, 60.0, 110.0, 30.0, 60.0, 77.0, 40.0, 30.0, 100.0, 90.0, 120.0, 90.0, 100.0, 50.0, 30.0, 70.0, 90.0, 70.0, 30.0, 40.0, 77.0, 30.0, 70.0, 50.0, 60.0, 35.0, 26.0, 86.0, 21.0, 50.0, 40.0, 70.0, 80.0, 35.0, 30.0, 70.0, 50.0, 35.0, 100.0, -102.0, 100.0, 20.0, 137.0, 97.0, 12.0, 80.0, 70.0, 20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0, 50.0, 140.0, 20.0, 90.0, 10.0, 50.0, 110.0, 44.0, 60.0, 50.0, 18.0, 50.0, 28.0, 40.0, 60.0, 37.0, -45.0, 38.0, 40.0, 100.0, 80.0, 30.0, 40.0, 70.0, 30.0, 10.0, -45.0, 60.0, 40.0, 50.0, 60.0, 40.0, 30.0, 30.0, 100.0, 60.0, 30.0, 50.0, 50.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 20.0, 10.0, 20.0, 57.0, 150.0, 72.0, 34.0, 30.0, 12.0, 120.0, 40.0, 30.0, 38.0, 44.0, 63.0, 10.0, 30.0, 79.0, 80.0, 60.0, 70.0, 60.0, 70.0, 79.0, 100.0, 60.0, 100.0, 60.0, 40.0, 68.0, -11.0, 60.0, 41.0, 30.0, 90.0, 90.0, 53.0, -60.0, 70.0, 150.0, 140.0, 50.0, 30.0, 20.0, 40.0, 40.0, 70.0, 130.0, 20.0, 30.0, 20.0, 20.0, 110.0, 100.0, 80.0, 12.0, 8.0, 20.0, 59.0, -80.0, 11.0, 10.0, 40.0, 60.0, 30.0, -85.0, 60.0, 33.0, 10.0, -5.0, 70.0, 10.0, 60.0, 50.0, 5.0, 0.0, 20.0, 0.0, 80.0, 24.0, 30.0, 40.0, 25.0, 27.0, 40.0, 40.0, 60.0, 70.0, 50.0, 78.0, 30.0, 60.0, 24.0, 60.0, 38.0, 90.0, 51.0, 115.0, 70.0, 90.0, 60.0, 70.0, 10.0, 22.0, 40.0, 40.0, 40.0, 50.0, -10.0, 100.0, 60.0, 29.0, 60.0, -25.0, 60.0, 100.0, 20.0, 80.0, 60.0, 40.0, 73.0, 50.0, 40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5962373114509356, "mean_inference_ms": 1.6168408995000987, "mean_action_processing_ms": 0.5058583872318301, "mean_env_wait_ms": 1.410135391081547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011733770370483398, "StateBufferConnector_ms": 0.009142160415649414, "ViewRequirementAgentConnector_ms": 0.3826286792755127}, "num_episodes": 18, "episode_return_max": 870.0, "episode_return_min": 157.0, "episode_return_mean": 468.08}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5143930840856, "num_env_steps_trained_throughput_per_sec": 21.5143930840856, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 184702.925, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184702.875, "sample_time_ms": 2315.349, "learn_time_ms": 182368.827, "learn_throughput": 21.934, "synch_weights_time_ms": 10.71}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "a22d3_00000", "date": "2024-08-06_02-57-50", "timestamp": 1722927470, "time_this_iter_s": 185.9320032596588, "time_total_s": 15261.84553194046, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a222a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15261.84553194046, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 19.561977186311786, "ram_util_percent": 74.90342205323194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9634307257029704, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.617817947303398, "policy_loss": -0.010620103199659779, "vf_loss": 5.62684470713456, "vf_explained_var": 0.011073880067394692, "kl": 0.007966720154974757, "entropy": 0.6510392332007202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 870.0, "episode_reward_min": 208.0, "episode_reward_mean": 466.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -134.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 46.63}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.0, 515.0, 270.0, 479.0, 411.0, 508.0, 383.0, 578.0, 540.0, 702.0, 452.0, 655.0, 266.0, 563.0, 639.0, 680.0, 725.0, 371.0, 325.0, 333.0, 410.0, 369.0, 410.0, 600.0, 252.0, 406.0, 224.0, 340.0, 265.0, 327.0, 548.0, 490.0, 327.0, 692.0, 600.0, 480.0, 579.0, 710.0, 405.0, 522.0, 470.0, 870.0, 520.0, 620.0, 318.0, 232.0, 345.0, 431.0, 565.0, 666.0, 418.0, 434.0, 480.0, 208.0, 630.0, 343.0, 443.0, 500.0, 587.0, 770.0, 488.0, 532.0, 549.0, 481.0, 624.0, 366.0, 365.0, 500.0, 240.0, 565.0, 534.0, 626.0, 654.0, 420.0, 330.0, 223.0, 309.0, 480.0, 668.0, 381.0, 518.0, 378.0, 231.0, 379.0, 407.0, 397.0, 257.0, 350.0, 555.0, 451.0, 388.0, 569.0, 390.0, 600.0, 425.0, 495.0, 530.0, 428.0, 455.0, 545.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [8.0, 40.0, 40.0, 50.0, 30.0, 38.0, 70.0, 50.0, 10.0, 10.0, 50.0, 10.0, 20.0, 70.0, 10.0, 130.0, 30.0, 15.0, 160.0, 20.0, 20.0, 40.0, 20.0, 10.0, 10.0, 60.0, 10.0, 80.0, 0.0, 20.0, 90.0, 30.0, 80.0, 40.0, 70.0, 70.0, -10.0, 29.0, 60.0, 20.0, 50.0, 50.0, -2.0, -5.0, 18.0, 60.0, 50.0, 80.0, 40.0, 70.0, 20.0, 19.0, 79.0, 10.0, 70.0, 60.0, 80.0, 70.0, 40.0, 60.0, 40.0, 50.0, 40.0, 45.0, 80.0, 20.0, 39.0, 30.0, 39.0, 0.0, 110.0, 40.0, 50.0, 90.0, 80.0, 20.0, 18.0, 80.0, 60.0, 30.0, 10.0, 50.0, 50.0, 70.0, 40.0, 80.0, 60.0, 90.0, 60.0, 30.0, 120.0, 35.0, 90.0, 60.0, 27.0, 0.0, 80.0, 120.0, 90.0, 80.0, 66.0, 10.0, 30.0, 60.0, 60.0, 70.0, 70.0, 30.0, 16.0, 40.0, 40.0, 70.0, 70.0, 30.0, 120.0, 25.0, 53.0, 90.0, 37.0, 120.0, 50.0, 80.0, 17.0, 20.0, 10.0, 50.0, 10.0, 19.0, 10.0, 0.0, 160.0, 30.0, 40.0, 50.0, 26.0, 30.0, 50.0, 50.0, 27.0, 100.0, 30.0, 90.0, 50.0, 59.0, 60.0, 90.0, 60.0, 80.0, 70.0, 50.0, 10.0, 70.0, 20.0, 80.0, 150.0, 40.0, 110.0, 40.0, 100.0, 60.0, 110.0, 60.0, 70.0, 110.0, 100.0, -45.0, 150.0, 30.0, 70.0, 70.0, 16.0, 80.0, 20.0, 40.0, 60.0, 30.0, 26.0, 10.0, 60.0, 29.0, 19.0, 30.0, 60.0, 40.0, 20.0, 20.0, 20.0, 100.0, 7.0, 9.0, 25.0, 50.0, 90.0, 50.0, 40.0, -25.0, 70.0, 70.0, 60.0, -97.0, 60.0, 30.0, 30.0, 70.0, 60.0, 20.0, 30.0, 50.0, 20.0, 40.0, 30.0, 39.0, 70.0, 20.0, 20.0, 40.0, 40.0, 40.0, 40.0, 30.0, 10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0, 120.0, 20.0, 60.0, 60.0, 20.0, 60.0, 110.0, 0.0, 100.0, 50.0, 10.0, 10.0, 130.0, 0.0, 30.0, -9.0, 15.0, 20.0, 8.0, 38.0, 80.0, 90.0, 40.0, -3.0, 20.0, 40.0, 9.0, 90.0, 10.0, 30.0, 20.0, 10.0, 0.0, 39.0, 33.0, 20.0, 11.0, 17.0, 30.0, 44.0, 0.0, 30.0, 50.0, 70.0, 60.0, 60.0, 20.0, 0.0, 0.0, 50.0, 50.0, -55.0, 30.0, 20.0, 110.0, 40.0, 20.0, 30.0, 30.0, -10.0, 50.0, 39.0, 20.0, 110.0, 20.0, 0.0, 9.0, 10.0, 9.0, 60.0, 60.0, 100.0, 40.0, 70.0, 30.0, 40.0, 18.0, 70.0, 30.0, 90.0, 40.0, 140.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 70.0, 80.0, 70.0, 35.0, 80.0, 100.0, -134.0, 70.0, 60.0, 70.0, 4.0, -28.0, 109.0, 35.0, 110.0, 51.0, 4.0, 110.0, 63.0, 60.0, 70.0, 80.0, 0.0, 70.0, 80.0, 100.0, 70.0, 80.0, 70.0, 10.0, 50.0, 70.0, 50.0, 60.0, 70.0, 28.0, 7.0, 30.0, 90.0, 60.0, 45.0, 40.0, 100.0, 20.0, 35.0, 30.0, 29.0, 90.0, 80.0, 130.0, 60.0, 5.0, 80.0, 50.0, 80.0, 90.0, 60.0, 60.0, 80.0, 60.0, 40.0, 110.0, 90.0, 50.0, 0.0, 80.0, 50.0, -15.0, 30.0, 70.0, 10.0, 40.0, 30.0, 60.0, 60.0, 110.0, 22.0, 130.0, 20.0, 20.0, 30.0, 40.0, 90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0, 100.0, 120.0, 50.0, 50.0, 100.0, 70.0, 40.0, 110.0, 120.0, 110.0, 30.0, 80.0, 70.0, 80.0, 60.0, 40.0, 40.0, 20.0, 40.0, 60.0, 40.0, 80.0, 50.0, 60.0, 40.0, 60.0, 110.0, 70.0, 50.0, 60.0, 47.0, 20.0, 0.0, 106.0, 20.0, 25.0, 40.0, 50.0, 0.0, 10.0, 40.0, 50.0, 10.0, 37.0, -5.0, 10.0, 70.0, 20.0, 0.0, 0.0, 60.0, 40.0, 30.0, 5.0, 10.0, 110.0, 10.0, 30.0, 10.0, 40.0, 20.0, 80.0, 8.0, 38.0, 20.0, 80.0, 50.0, 90.0, 30.0, 15.0, 40.0, 30.0, 60.0, 25.0, 108.0, 50.0, 70.0, 90.0, 52.0, 40.0, 90.0, 110.0, 87.0, 60.0, 119.0, 10.0, 30.0, 30.0, 90.0, 40.0, 80.0, 60.0, -50.0, 64.0, 50.0, 60.0, 40.0, 37.0, 50.0, 27.0, 55.0, 30.0, 50.0, 34.0, 50.0, 30.0, 40.0, 80.0, 10.0, 55.0, 10.0, 30.0, 80.0, 90.0, 110.0, 0.0, 50.0, 20.0, 50.0, 40.0, 10.0, 70.0, 10.0, 8.0, 0.0, 80.0, 30.0, -5.0, 5.0, 0.0, 20.0, 50.0, 70.0, 70.0, 100.0, 100.0, 30.0, 60.0, 80.0, 50.0, 49.0, 60.0, 0.0, 50.0, 27.0, 60.0, 14.0, 30.0, 60.0, -7.0, 90.0, 60.0, 8.0, 90.0, 80.0, 70.0, 30.0, 40.0, 14.0, -39.0, 19.0, 80.0, 50.0, -3.0, 39.0, 30.0, 90.0, 15.0, 100.0, 80.0, 90.0, 20.0, 99.0, 1.0, 60.0, 110.0, 30.0, 60.0, 77.0, 40.0, 30.0, 100.0, 90.0, 120.0, 90.0, 100.0, 50.0, 30.0, 70.0, 90.0, 70.0, 30.0, 40.0, 77.0, 30.0, 70.0, 50.0, 60.0, 35.0, 26.0, 86.0, 21.0, 50.0, 40.0, 70.0, 80.0, 35.0, 30.0, 70.0, 50.0, 35.0, 100.0, -102.0, 100.0, 20.0, 137.0, 97.0, 12.0, 80.0, 70.0, 20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0, 50.0, 140.0, 20.0, 90.0, 10.0, 50.0, 110.0, 44.0, 60.0, 50.0, 18.0, 50.0, 28.0, 40.0, 60.0, 37.0, -45.0, 38.0, 40.0, 100.0, 80.0, 30.0, 40.0, 70.0, 30.0, 10.0, -45.0, 60.0, 40.0, 50.0, 60.0, 40.0, 30.0, 30.0, 100.0, 60.0, 30.0, 50.0, 50.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 20.0, 10.0, 20.0, 57.0, 150.0, 72.0, 34.0, 30.0, 12.0, 120.0, 40.0, 30.0, 38.0, 44.0, 63.0, 10.0, 30.0, 79.0, 80.0, 60.0, 70.0, 60.0, 70.0, 79.0, 100.0, 60.0, 100.0, 60.0, 40.0, 68.0, -11.0, 60.0, 41.0, 30.0, 90.0, 90.0, 53.0, -60.0, 70.0, 150.0, 140.0, 50.0, 30.0, 20.0, 40.0, 40.0, 70.0, 130.0, 20.0, 30.0, 20.0, 20.0, 110.0, 100.0, 80.0, 12.0, 8.0, 20.0, 59.0, -80.0, 11.0, 10.0, 40.0, 60.0, 30.0, -85.0, 60.0, 33.0, 10.0, -5.0, 70.0, 10.0, 60.0, 50.0, 5.0, 0.0, 20.0, 0.0, 80.0, 24.0, 30.0, 40.0, 25.0, 27.0, 40.0, 40.0, 60.0, 70.0, 50.0, 78.0, 30.0, 60.0, 24.0, 60.0, 38.0, 90.0, 51.0, 115.0, 70.0, 90.0, 60.0, 70.0, 10.0, 22.0, 40.0, 40.0, 40.0, 50.0, -10.0, 100.0, 60.0, 29.0, 60.0, -25.0, 60.0, 100.0, 20.0, 80.0, 60.0, 40.0, 73.0, 50.0, 40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0, 29.0, 7.0, 40.0, 10.0, 20.0, 9.0, 30.0, 16.0, 20.0, 50.0, 50.0, 50.0, 80.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, 29.0, 30.0, 7.0, 20.0, 30.0, 20.0, 10.0, 40.0, 140.0, 70.0, 40.0, 20.0, 1.0, 70.0, 31.0, 60.0, -20.0, 40.0, 90.0, 65.0, 40.0, 50.0, 40.0, 0.0, 30.0, 50.0, 9.0, 16.0, 25.0, 26.0, 11.0, 40.0, 10.0, 20.0, -10.0, 20.0, 50.0, 60.0, 60.0, 40.0, 60.0, 60.0, 40.0, 97.0, 40.0, 70.0, 30.0, 60.0, 18.0, 50.0, 90.0, 0.0, 22.0, 90.0, 40.0, 50.0, 39.0, 60.0, 40.0, 50.0, 60.0, 25.0, 70.0, 90.0, 20.0, 53.0, 20.0, 0.0, 60.0, 40.0, 10.0, 50.0, 50.0, 110.0, 0.0, 94.0, 40.0, 80.0, 70.0, 70.0, 5.0, 50.0, 40.0, 30.0, 80.0, 50.0, 30.0, 20.0, 30.0, 60.0, 0.0, 50.0, 90.0, 30.0, 10.0, 110.0, 60.0, 80.0, 40.0, 50.0, 80.0, 40.0, 30.0, 60.0, 50.0, 110.0, 0.0, 10.0, 40.0, 90.0, -5.0, 90.0, 20.0, 20.0, 110.0, 70.0, 50.0, 70.0, -2.0, 37.0, 30.0, 80.0, 30.0, 20.0, 30.0, 70.0, 40.0, 50.0, 130.0, 20.0, 60.0, 70.0, 1.0, 59.0, 50.0, 59.0, 100.0, 0.0, 36.0, -1.0, 54.0, 0.0, 30.0, 20.0, 60.0, 15.0, 120.0, 50.0, 50.0, 60.0, 50.0, 70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5933507579789243, "mean_inference_ms": 1.6140781143423717, "mean_action_processing_ms": 0.5049164218248079, "mean_env_wait_ms": 1.4077047539702898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011386632919311523, "StateBufferConnector_ms": 0.008743762969970703, "ViewRequirementAgentConnector_ms": 0.36655282974243164}, "num_episodes": 18, "episode_return_max": 870.0, "episode_return_min": 208.0, "episode_return_mean": 466.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5215478115355, "num_env_steps_trained_throughput_per_sec": 21.5215478115355, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 184837.168, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184837.118, "sample_time_ms": 2288.403, "learn_time_ms": 182530.011, "learn_throughput": 21.914, "synch_weights_time_ms": 10.638}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "a22d3_00000", "date": "2024-08-06_03-00-56", "timestamp": 1722927656, "time_this_iter_s": 185.87091588974, "time_total_s": 15447.7164478302, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a222ac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15447.7164478302, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.537262357414445, "ram_util_percent": 75.65893536121673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9160996381594098, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.903781590091027, "policy_loss": -0.010450290165235574, "vf_loss": 5.912705397072692, "vf_explained_var": 0.028217477349046702, "kl": 0.00763243453359165, "entropy": 0.6738690255072932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 870.0, "episode_reward_min": 208.0, "episode_reward_mean": 473.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -134.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 47.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 600.0, 252.0, 406.0, 224.0, 340.0, 265.0, 327.0, 548.0, 490.0, 327.0, 692.0, 600.0, 480.0, 579.0, 710.0, 405.0, 522.0, 470.0, 870.0, 520.0, 620.0, 318.0, 232.0, 345.0, 431.0, 565.0, 666.0, 418.0, 434.0, 480.0, 208.0, 630.0, 343.0, 443.0, 500.0, 587.0, 770.0, 488.0, 532.0, 549.0, 481.0, 624.0, 366.0, 365.0, 500.0, 240.0, 565.0, 534.0, 626.0, 654.0, 420.0, 330.0, 223.0, 309.0, 480.0, 668.0, 381.0, 518.0, 378.0, 231.0, 379.0, 407.0, 397.0, 257.0, 350.0, 555.0, 451.0, 388.0, 569.0, 390.0, 600.0, 425.0, 495.0, 530.0, 428.0, 455.0, 545.0, 435.0, 298.0, 340.0, 610.0, 470.0, 309.0, 597.0, 620.0, 615.0, 557.0, 521.0, 625.0, 588.0, 623.0, 438.0, 299.0, 545.0, 420.0, 720.0, 496.0, 390.0, 689.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 5.0, 100.0, 70.0, 52.0, 60.0, 30.0, 70.0, 3.0, 10.0, 120.0, 20.0, 60.0, 60.0, 20.0, 60.0, 110.0, 0.0, 100.0, 50.0, 10.0, 10.0, 130.0, 0.0, 30.0, -9.0, 15.0, 20.0, 8.0, 38.0, 80.0, 90.0, 40.0, -3.0, 20.0, 40.0, 9.0, 90.0, 10.0, 30.0, 20.0, 10.0, 0.0, 39.0, 33.0, 20.0, 11.0, 17.0, 30.0, 44.0, 0.0, 30.0, 50.0, 70.0, 60.0, 60.0, 20.0, 0.0, 0.0, 50.0, 50.0, -55.0, 30.0, 20.0, 110.0, 40.0, 20.0, 30.0, 30.0, -10.0, 50.0, 39.0, 20.0, 110.0, 20.0, 0.0, 9.0, 10.0, 9.0, 60.0, 60.0, 100.0, 40.0, 70.0, 30.0, 40.0, 18.0, 70.0, 30.0, 90.0, 40.0, 140.0, 30.0, 40.0, 20.0, 20.0, 20.0, 30.0, 70.0, 80.0, 70.0, 35.0, 80.0, 100.0, -134.0, 70.0, 60.0, 70.0, 4.0, -28.0, 109.0, 35.0, 110.0, 51.0, 4.0, 110.0, 63.0, 60.0, 70.0, 80.0, 0.0, 70.0, 80.0, 100.0, 70.0, 80.0, 70.0, 10.0, 50.0, 70.0, 50.0, 60.0, 70.0, 28.0, 7.0, 30.0, 90.0, 60.0, 45.0, 40.0, 100.0, 20.0, 35.0, 30.0, 29.0, 90.0, 80.0, 130.0, 60.0, 5.0, 80.0, 50.0, 80.0, 90.0, 60.0, 60.0, 80.0, 60.0, 40.0, 110.0, 90.0, 50.0, 0.0, 80.0, 50.0, -15.0, 30.0, 70.0, 10.0, 40.0, 30.0, 60.0, 60.0, 110.0, 22.0, 130.0, 20.0, 20.0, 30.0, 40.0, 90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0, 100.0, 120.0, 50.0, 50.0, 100.0, 70.0, 40.0, 110.0, 120.0, 110.0, 30.0, 80.0, 70.0, 80.0, 60.0, 40.0, 40.0, 20.0, 40.0, 60.0, 40.0, 80.0, 50.0, 60.0, 40.0, 60.0, 110.0, 70.0, 50.0, 60.0, 47.0, 20.0, 0.0, 106.0, 20.0, 25.0, 40.0, 50.0, 0.0, 10.0, 40.0, 50.0, 10.0, 37.0, -5.0, 10.0, 70.0, 20.0, 0.0, 0.0, 60.0, 40.0, 30.0, 5.0, 10.0, 110.0, 10.0, 30.0, 10.0, 40.0, 20.0, 80.0, 8.0, 38.0, 20.0, 80.0, 50.0, 90.0, 30.0, 15.0, 40.0, 30.0, 60.0, 25.0, 108.0, 50.0, 70.0, 90.0, 52.0, 40.0, 90.0, 110.0, 87.0, 60.0, 119.0, 10.0, 30.0, 30.0, 90.0, 40.0, 80.0, 60.0, -50.0, 64.0, 50.0, 60.0, 40.0, 37.0, 50.0, 27.0, 55.0, 30.0, 50.0, 34.0, 50.0, 30.0, 40.0, 80.0, 10.0, 55.0, 10.0, 30.0, 80.0, 90.0, 110.0, 0.0, 50.0, 20.0, 50.0, 40.0, 10.0, 70.0, 10.0, 8.0, 0.0, 80.0, 30.0, -5.0, 5.0, 0.0, 20.0, 50.0, 70.0, 70.0, 100.0, 100.0, 30.0, 60.0, 80.0, 50.0, 49.0, 60.0, 0.0, 50.0, 27.0, 60.0, 14.0, 30.0, 60.0, -7.0, 90.0, 60.0, 8.0, 90.0, 80.0, 70.0, 30.0, 40.0, 14.0, -39.0, 19.0, 80.0, 50.0, -3.0, 39.0, 30.0, 90.0, 15.0, 100.0, 80.0, 90.0, 20.0, 99.0, 1.0, 60.0, 110.0, 30.0, 60.0, 77.0, 40.0, 30.0, 100.0, 90.0, 120.0, 90.0, 100.0, 50.0, 30.0, 70.0, 90.0, 70.0, 30.0, 40.0, 77.0, 30.0, 70.0, 50.0, 60.0, 35.0, 26.0, 86.0, 21.0, 50.0, 40.0, 70.0, 80.0, 35.0, 30.0, 70.0, 50.0, 35.0, 100.0, -102.0, 100.0, 20.0, 137.0, 97.0, 12.0, 80.0, 70.0, 20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0, 50.0, 140.0, 20.0, 90.0, 10.0, 50.0, 110.0, 44.0, 60.0, 50.0, 18.0, 50.0, 28.0, 40.0, 60.0, 37.0, -45.0, 38.0, 40.0, 100.0, 80.0, 30.0, 40.0, 70.0, 30.0, 10.0, -45.0, 60.0, 40.0, 50.0, 60.0, 40.0, 30.0, 30.0, 100.0, 60.0, 30.0, 50.0, 50.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 20.0, 10.0, 20.0, 57.0, 150.0, 72.0, 34.0, 30.0, 12.0, 120.0, 40.0, 30.0, 38.0, 44.0, 63.0, 10.0, 30.0, 79.0, 80.0, 60.0, 70.0, 60.0, 70.0, 79.0, 100.0, 60.0, 100.0, 60.0, 40.0, 68.0, -11.0, 60.0, 41.0, 30.0, 90.0, 90.0, 53.0, -60.0, 70.0, 150.0, 140.0, 50.0, 30.0, 20.0, 40.0, 40.0, 70.0, 130.0, 20.0, 30.0, 20.0, 20.0, 110.0, 100.0, 80.0, 12.0, 8.0, 20.0, 59.0, -80.0, 11.0, 10.0, 40.0, 60.0, 30.0, -85.0, 60.0, 33.0, 10.0, -5.0, 70.0, 10.0, 60.0, 50.0, 5.0, 0.0, 20.0, 0.0, 80.0, 24.0, 30.0, 40.0, 25.0, 27.0, 40.0, 40.0, 60.0, 70.0, 50.0, 78.0, 30.0, 60.0, 24.0, 60.0, 38.0, 90.0, 51.0, 115.0, 70.0, 90.0, 60.0, 70.0, 10.0, 22.0, 40.0, 40.0, 40.0, 50.0, -10.0, 100.0, 60.0, 29.0, 60.0, -25.0, 60.0, 100.0, 20.0, 80.0, 60.0, 40.0, 73.0, 50.0, 40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0, 29.0, 7.0, 40.0, 10.0, 20.0, 9.0, 30.0, 16.0, 20.0, 50.0, 50.0, 50.0, 80.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, 29.0, 30.0, 7.0, 20.0, 30.0, 20.0, 10.0, 40.0, 140.0, 70.0, 40.0, 20.0, 1.0, 70.0, 31.0, 60.0, -20.0, 40.0, 90.0, 65.0, 40.0, 50.0, 40.0, 0.0, 30.0, 50.0, 9.0, 16.0, 25.0, 26.0, 11.0, 40.0, 10.0, 20.0, -10.0, 20.0, 50.0, 60.0, 60.0, 40.0, 60.0, 60.0, 40.0, 97.0, 40.0, 70.0, 30.0, 60.0, 18.0, 50.0, 90.0, 0.0, 22.0, 90.0, 40.0, 50.0, 39.0, 60.0, 40.0, 50.0, 60.0, 25.0, 70.0, 90.0, 20.0, 53.0, 20.0, 0.0, 60.0, 40.0, 10.0, 50.0, 50.0, 110.0, 0.0, 94.0, 40.0, 80.0, 70.0, 70.0, 5.0, 50.0, 40.0, 30.0, 80.0, 50.0, 30.0, 20.0, 30.0, 60.0, 0.0, 50.0, 90.0, 30.0, 10.0, 110.0, 60.0, 80.0, 40.0, 50.0, 80.0, 40.0, 30.0, 60.0, 50.0, 110.0, 0.0, 10.0, 40.0, 90.0, -5.0, 90.0, 20.0, 20.0, 110.0, 70.0, 50.0, 70.0, -2.0, 37.0, 30.0, 80.0, 30.0, 20.0, 30.0, 70.0, 40.0, 50.0, 130.0, 20.0, 60.0, 70.0, 1.0, 59.0, 50.0, 59.0, 100.0, 0.0, 36.0, -1.0, 54.0, 0.0, 30.0, 20.0, 60.0, 15.0, 120.0, 50.0, 50.0, 60.0, 50.0, 70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 45.0, 50.0, 50.0, 70.0, 70.0, 30.0, 30.0, 50.0, 20.0, 12.0, 50.0, 9.0, 10.0, 27.0, 60.0, 30.0, 20.0, 100.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 30.0, 50.0, 70.0, 120.0, 130.0, 40.0, 0.0, 50.0, 70.0, 20.0, 60.0, 30.0, 60.0, 30.0, 70.0, 20.0, 60.0, 60.0, 70.0, 30.0, 40.0, 30.0, 60.0, 20.0, 50.0, 50.0, 60.0, 9.0, -10.0, 20.0, 20.0, 40.0, 60.0, 80.0, 60.0, 60.0, 70.0, 80.0, 52.0, 65.0, 30.0, 90.0, 0.0, 50.0, 30.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 30.0, 80.0, 58.0, 40.0, 106.0, 26.0, 37.0, 90.0, 110.0, 38.0, 21.0, 40.0, 60.0, 40.0, 16.0, 50.0, 100.0, 40.0, 90.0, 100.0, 50.0, 10.0, 14.0, 40.0, 10.0, 1.0, 90.0, 124.0, 100.0, 82.0, 22.0, 60.0, 95.0, 60.0, 70.0, 9.0, 110.0, 50.0, 100.0, 49.0, 70.0, 45.0, 40.0, 50.0, 40.0, 78.0, 100.0, 55.0, 70.0, 40.0, 2.0, 90.0, 31.0, 90.0, 100.0, 130.0, 40.0, -14.0, 64.0, 90.0, 18.0, 43.0, 60.0, 40.0, 60.0, 20.0, 80.0, 70.0, 20.0, 27.0, 10.0, 59.0, 50.0, 10.0, 0.0, 90.0, 30.0, 20.0, 30.0, 0.0, 90.0, 27.0, 38.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 90.0, 22.0, 40.0, 49.0, 70.0, 60.0, 20.0, 80.0, 4.0, 57.0, 18.0, 106.0, 70.0, 60.0, 60.0, 50.0, 60.0, 120.0, 92.0, 91.0, 11.0, 60.0, 50.0, 70.0, 69.0, 80.0, -1.0, 18.0, 60.0, 70.0, 20.0, 50.0, 0.0, 10.0, 40.0, 70.0, 60.0, 20.0, 70.0, 20.0, 50.0, 100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5898071810763248, "mean_inference_ms": 1.6105913157796454, "mean_action_processing_ms": 0.5038214324398799, "mean_env_wait_ms": 1.4048679763074063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011341571807861328, "StateBufferConnector_ms": 0.008701562881469727, "ViewRequirementAgentConnector_ms": 0.36482858657836914}, "num_episodes": 22, "episode_return_max": 870.0, "episode_return_min": 208.0, "episode_return_mean": 473.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.35848540287068, "num_env_steps_trained_throughput_per_sec": 21.35848540287068, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 185088.798, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185088.75, "sample_time_ms": 2287.348, "learn_time_ms": 182781.838, "learn_throughput": 21.884, "synch_weights_time_ms": 11.461}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "a22d3_00000", "date": "2024-08-06_03-04-03", "timestamp": 1722927843, "time_this_iter_s": 187.2866232395172, "time_total_s": 15635.003071069717, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a222a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15635.003071069717, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 21.327169811320754, "ram_util_percent": 76.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.148797713097927, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5017565973015765, "policy_loss": -0.010926433914530471, "vf_loss": 5.511025514617896, "vf_explained_var": 0.013512063877016338, "kl": 0.008287602040703616, "entropy": 0.6764556575189637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 870.0, "episode_reward_min": 208.0, "episode_reward_mean": 476.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -102.0}, "policy_reward_max": {"policy_0": 150.0}, "policy_reward_mean": {"policy_0": 47.614}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 870.0, 520.0, 620.0, 318.0, 232.0, 345.0, 431.0, 565.0, 666.0, 418.0, 434.0, 480.0, 208.0, 630.0, 343.0, 443.0, 500.0, 587.0, 770.0, 488.0, 532.0, 549.0, 481.0, 624.0, 366.0, 365.0, 500.0, 240.0, 565.0, 534.0, 626.0, 654.0, 420.0, 330.0, 223.0, 309.0, 480.0, 668.0, 381.0, 518.0, 378.0, 231.0, 379.0, 407.0, 397.0, 257.0, 350.0, 555.0, 451.0, 388.0, 569.0, 390.0, 600.0, 425.0, 495.0, 530.0, 428.0, 455.0, 545.0, 435.0, 298.0, 340.0, 610.0, 470.0, 309.0, 597.0, 620.0, 615.0, 557.0, 521.0, 625.0, 588.0, 623.0, 438.0, 299.0, 545.0, 420.0, 720.0, 496.0, 390.0, 689.0, 460.0, 731.0, 431.0, 255.0, 586.0, 500.0, 369.0, 279.0, 444.0, 545.0, 578.0, 520.0, 500.0, 385.0, 500.0, 663.0, 480.0, 250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 40.0, 60.0, 50.0, 20.0, 50.0, 0.0, 20.0, 80.0, 60.0, 100.0, 120.0, 50.0, 50.0, 100.0, 70.0, 40.0, 110.0, 120.0, 110.0, 30.0, 80.0, 70.0, 80.0, 60.0, 40.0, 40.0, 20.0, 40.0, 60.0, 40.0, 80.0, 50.0, 60.0, 40.0, 60.0, 110.0, 70.0, 50.0, 60.0, 47.0, 20.0, 0.0, 106.0, 20.0, 25.0, 40.0, 50.0, 0.0, 10.0, 40.0, 50.0, 10.0, 37.0, -5.0, 10.0, 70.0, 20.0, 0.0, 0.0, 60.0, 40.0, 30.0, 5.0, 10.0, 110.0, 10.0, 30.0, 10.0, 40.0, 20.0, 80.0, 8.0, 38.0, 20.0, 80.0, 50.0, 90.0, 30.0, 15.0, 40.0, 30.0, 60.0, 25.0, 108.0, 50.0, 70.0, 90.0, 52.0, 40.0, 90.0, 110.0, 87.0, 60.0, 119.0, 10.0, 30.0, 30.0, 90.0, 40.0, 80.0, 60.0, -50.0, 64.0, 50.0, 60.0, 40.0, 37.0, 50.0, 27.0, 55.0, 30.0, 50.0, 34.0, 50.0, 30.0, 40.0, 80.0, 10.0, 55.0, 10.0, 30.0, 80.0, 90.0, 110.0, 0.0, 50.0, 20.0, 50.0, 40.0, 10.0, 70.0, 10.0, 8.0, 0.0, 80.0, 30.0, -5.0, 5.0, 0.0, 20.0, 50.0, 70.0, 70.0, 100.0, 100.0, 30.0, 60.0, 80.0, 50.0, 49.0, 60.0, 0.0, 50.0, 27.0, 60.0, 14.0, 30.0, 60.0, -7.0, 90.0, 60.0, 8.0, 90.0, 80.0, 70.0, 30.0, 40.0, 14.0, -39.0, 19.0, 80.0, 50.0, -3.0, 39.0, 30.0, 90.0, 15.0, 100.0, 80.0, 90.0, 20.0, 99.0, 1.0, 60.0, 110.0, 30.0, 60.0, 77.0, 40.0, 30.0, 100.0, 90.0, 120.0, 90.0, 100.0, 50.0, 30.0, 70.0, 90.0, 70.0, 30.0, 40.0, 77.0, 30.0, 70.0, 50.0, 60.0, 35.0, 26.0, 86.0, 21.0, 50.0, 40.0, 70.0, 80.0, 35.0, 30.0, 70.0, 50.0, 35.0, 100.0, -102.0, 100.0, 20.0, 137.0, 97.0, 12.0, 80.0, 70.0, 20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0, 50.0, 140.0, 20.0, 90.0, 10.0, 50.0, 110.0, 44.0, 60.0, 50.0, 18.0, 50.0, 28.0, 40.0, 60.0, 37.0, -45.0, 38.0, 40.0, 100.0, 80.0, 30.0, 40.0, 70.0, 30.0, 10.0, -45.0, 60.0, 40.0, 50.0, 60.0, 40.0, 30.0, 30.0, 100.0, 60.0, 30.0, 50.0, 50.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 20.0, 10.0, 20.0, 57.0, 150.0, 72.0, 34.0, 30.0, 12.0, 120.0, 40.0, 30.0, 38.0, 44.0, 63.0, 10.0, 30.0, 79.0, 80.0, 60.0, 70.0, 60.0, 70.0, 79.0, 100.0, 60.0, 100.0, 60.0, 40.0, 68.0, -11.0, 60.0, 41.0, 30.0, 90.0, 90.0, 53.0, -60.0, 70.0, 150.0, 140.0, 50.0, 30.0, 20.0, 40.0, 40.0, 70.0, 130.0, 20.0, 30.0, 20.0, 20.0, 110.0, 100.0, 80.0, 12.0, 8.0, 20.0, 59.0, -80.0, 11.0, 10.0, 40.0, 60.0, 30.0, -85.0, 60.0, 33.0, 10.0, -5.0, 70.0, 10.0, 60.0, 50.0, 5.0, 0.0, 20.0, 0.0, 80.0, 24.0, 30.0, 40.0, 25.0, 27.0, 40.0, 40.0, 60.0, 70.0, 50.0, 78.0, 30.0, 60.0, 24.0, 60.0, 38.0, 90.0, 51.0, 115.0, 70.0, 90.0, 60.0, 70.0, 10.0, 22.0, 40.0, 40.0, 40.0, 50.0, -10.0, 100.0, 60.0, 29.0, 60.0, -25.0, 60.0, 100.0, 20.0, 80.0, 60.0, 40.0, 73.0, 50.0, 40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0, 29.0, 7.0, 40.0, 10.0, 20.0, 9.0, 30.0, 16.0, 20.0, 50.0, 50.0, 50.0, 80.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, 29.0, 30.0, 7.0, 20.0, 30.0, 20.0, 10.0, 40.0, 140.0, 70.0, 40.0, 20.0, 1.0, 70.0, 31.0, 60.0, -20.0, 40.0, 90.0, 65.0, 40.0, 50.0, 40.0, 0.0, 30.0, 50.0, 9.0, 16.0, 25.0, 26.0, 11.0, 40.0, 10.0, 20.0, -10.0, 20.0, 50.0, 60.0, 60.0, 40.0, 60.0, 60.0, 40.0, 97.0, 40.0, 70.0, 30.0, 60.0, 18.0, 50.0, 90.0, 0.0, 22.0, 90.0, 40.0, 50.0, 39.0, 60.0, 40.0, 50.0, 60.0, 25.0, 70.0, 90.0, 20.0, 53.0, 20.0, 0.0, 60.0, 40.0, 10.0, 50.0, 50.0, 110.0, 0.0, 94.0, 40.0, 80.0, 70.0, 70.0, 5.0, 50.0, 40.0, 30.0, 80.0, 50.0, 30.0, 20.0, 30.0, 60.0, 0.0, 50.0, 90.0, 30.0, 10.0, 110.0, 60.0, 80.0, 40.0, 50.0, 80.0, 40.0, 30.0, 60.0, 50.0, 110.0, 0.0, 10.0, 40.0, 90.0, -5.0, 90.0, 20.0, 20.0, 110.0, 70.0, 50.0, 70.0, -2.0, 37.0, 30.0, 80.0, 30.0, 20.0, 30.0, 70.0, 40.0, 50.0, 130.0, 20.0, 60.0, 70.0, 1.0, 59.0, 50.0, 59.0, 100.0, 0.0, 36.0, -1.0, 54.0, 0.0, 30.0, 20.0, 60.0, 15.0, 120.0, 50.0, 50.0, 60.0, 50.0, 70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 45.0, 50.0, 50.0, 70.0, 70.0, 30.0, 30.0, 50.0, 20.0, 12.0, 50.0, 9.0, 10.0, 27.0, 60.0, 30.0, 20.0, 100.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 30.0, 50.0, 70.0, 120.0, 130.0, 40.0, 0.0, 50.0, 70.0, 20.0, 60.0, 30.0, 60.0, 30.0, 70.0, 20.0, 60.0, 60.0, 70.0, 30.0, 40.0, 30.0, 60.0, 20.0, 50.0, 50.0, 60.0, 9.0, -10.0, 20.0, 20.0, 40.0, 60.0, 80.0, 60.0, 60.0, 70.0, 80.0, 52.0, 65.0, 30.0, 90.0, 0.0, 50.0, 30.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 30.0, 80.0, 58.0, 40.0, 106.0, 26.0, 37.0, 90.0, 110.0, 38.0, 21.0, 40.0, 60.0, 40.0, 16.0, 50.0, 100.0, 40.0, 90.0, 100.0, 50.0, 10.0, 14.0, 40.0, 10.0, 1.0, 90.0, 124.0, 100.0, 82.0, 22.0, 60.0, 95.0, 60.0, 70.0, 9.0, 110.0, 50.0, 100.0, 49.0, 70.0, 45.0, 40.0, 50.0, 40.0, 78.0, 100.0, 55.0, 70.0, 40.0, 2.0, 90.0, 31.0, 90.0, 100.0, 130.0, 40.0, -14.0, 64.0, 90.0, 18.0, 43.0, 60.0, 40.0, 60.0, 20.0, 80.0, 70.0, 20.0, 27.0, 10.0, 59.0, 50.0, 10.0, 0.0, 90.0, 30.0, 20.0, 30.0, 0.0, 90.0, 27.0, 38.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 90.0, 22.0, 40.0, 49.0, 70.0, 60.0, 20.0, 80.0, 4.0, 57.0, 18.0, 106.0, 70.0, 60.0, 60.0, 50.0, 60.0, 120.0, 92.0, 91.0, 11.0, 60.0, 50.0, 70.0, 69.0, 80.0, -1.0, 18.0, 60.0, 70.0, 20.0, 50.0, 0.0, 10.0, 40.0, 70.0, 60.0, 20.0, 70.0, 20.0, 50.0, 100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0, 60.0, 80.0, 40.0, 70.0, 30.0, 60.0, 30.0, 20.0, 40.0, 30.0, 108.0, 50.0, 110.0, 65.0, 60.0, 130.0, 68.0, 80.0, 40.0, 20.0, 70.0, 80.0, 14.0, 64.0, -75.0, 51.0, 80.0, -23.0, 50.0, 120.0, 20.0, -20.0, 30.0, 21.0, 45.0, 30.0, 70.0, 104.0, -85.0, 40.0, 60.0, 80.0, 120.0, 49.0, 60.0, 70.0, 10.0, -3.0, 20.0, 120.0, 15.0, 100.0, 19.0, 100.0, 20.0, 40.0, 80.0, 50.0, 20.0, 56.0, 8.0, 4.0, 50.0, 90.0, 20.0, 19.0, 8.0, 60.0, 60.0, 50.0, 50.0, 10.0, 60.0, 10.0, 10.0, 50.0, 49.0, 20.0, 26.0, -6.0, 40.0, 70.0, 60.0, 50.0, 18.0, 80.0, -4.0, 60.0, 20.0, 50.0, 50.0, 30.0, 39.0, 60.0, 80.0, 16.0, 20.0, 150.0, 50.0, 50.0, 80.0, 20.0, 80.0, 30.0, 100.0, 90.0, 50.0, 78.0, 20.0, 30.0, 30.0, 10.0, 60.0, 90.0, 30.0, 140.0, 20.0, 30.0, 80.0, 30.0, 50.0, 0.0, 90.0, 40.0, 30.0, 60.0, 50.0, 10.0, 40.0, 130.0, 37.0, 30.0, 110.0, 90.0, 30.0, 0.0, 40.0, 10.0, 38.0, 0.0, 30.0, 50.0, 110.0, 30.0, 20.0, 40.0, 50.0, 40.0, 100.0, 30.0, 50.0, 40.0, 90.0, 60.0, 150.0, 87.0, 40.0, 60.0, 50.0, 36.0, 90.0, 40.0, 60.0, 50.0, 40.0, 60.0, 0.0, 30.0, 60.0, 50.0, 0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.587054067735449, "mean_inference_ms": 1.6074672222299131, "mean_action_processing_ms": 0.5029425884040521, "mean_env_wait_ms": 1.4025290581703223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012027502059936523, "StateBufferConnector_ms": 0.008676290512084961, "ViewRequirementAgentConnector_ms": 0.3513603210449219}, "num_episodes": 18, "episode_return_max": 870.0, "episode_return_min": 208.0, "episode_return_mean": 476.14}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.676727036881335, "num_env_steps_trained_throughput_per_sec": 21.676727036881335, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 185041.623, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185041.576, "sample_time_ms": 2332.774, "learn_time_ms": 182689.376, "learn_throughput": 21.895, "synch_weights_time_ms": 11.401}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "a22d3_00000", "date": "2024-08-06_03-07-08", "timestamp": 1722928028, "time_this_iter_s": 184.53842902183533, "time_total_s": 15819.541500091553, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2275280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15819.541500091553, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 17.245210727969347, "ram_util_percent": 76.9199233716475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.150136919410084, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.033643174958559, "policy_loss": -0.010410081678917146, "vf_loss": 6.042395765712848, "vf_explained_var": 0.0023775451226483264, "kl": 0.008287502795477339, "entropy": 0.6252143363633984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 731.0, "episode_reward_min": 67.0, "episode_reward_mean": 477.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 47.742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [481.0, 624.0, 366.0, 365.0, 500.0, 240.0, 565.0, 534.0, 626.0, 654.0, 420.0, 330.0, 223.0, 309.0, 480.0, 668.0, 381.0, 518.0, 378.0, 231.0, 379.0, 407.0, 397.0, 257.0, 350.0, 555.0, 451.0, 388.0, 569.0, 390.0, 600.0, 425.0, 495.0, 530.0, 428.0, 455.0, 545.0, 435.0, 298.0, 340.0, 610.0, 470.0, 309.0, 597.0, 620.0, 615.0, 557.0, 521.0, 625.0, 588.0, 623.0, 438.0, 299.0, 545.0, 420.0, 720.0, 496.0, 390.0, 689.0, 460.0, 731.0, 431.0, 255.0, 586.0, 500.0, 369.0, 279.0, 444.0, 545.0, 578.0, 520.0, 500.0, 385.0, 500.0, 663.0, 480.0, 250.0, 725.0, 402.0, 390.0, 620.0, 570.0, 398.0, 660.0, 578.0, 627.0, 360.0, 500.0, 617.0, 479.0, 566.0, 304.0, 691.0, 464.0, 67.0, 686.0, 426.0, 344.0, 583.0, 490.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, -12.0, 100.0, 43.0, 50.0, 80.0, 50.0, 80.0, 40.0, 50.0, 140.0, 20.0, 90.0, 10.0, 50.0, 110.0, 44.0, 60.0, 50.0, 18.0, 50.0, 28.0, 40.0, 60.0, 37.0, -45.0, 38.0, 40.0, 100.0, 80.0, 30.0, 40.0, 70.0, 30.0, 10.0, -45.0, 60.0, 40.0, 50.0, 60.0, 40.0, 30.0, 30.0, 100.0, 60.0, 30.0, 50.0, 50.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 50.0, 50.0, 10.0, 20.0, 10.0, 20.0, 57.0, 150.0, 72.0, 34.0, 30.0, 12.0, 120.0, 40.0, 30.0, 38.0, 44.0, 63.0, 10.0, 30.0, 79.0, 80.0, 60.0, 70.0, 60.0, 70.0, 79.0, 100.0, 60.0, 100.0, 60.0, 40.0, 68.0, -11.0, 60.0, 41.0, 30.0, 90.0, 90.0, 53.0, -60.0, 70.0, 150.0, 140.0, 50.0, 30.0, 20.0, 40.0, 40.0, 70.0, 130.0, 20.0, 30.0, 20.0, 20.0, 110.0, 100.0, 80.0, 12.0, 8.0, 20.0, 59.0, -80.0, 11.0, 10.0, 40.0, 60.0, 30.0, -85.0, 60.0, 33.0, 10.0, -5.0, 70.0, 10.0, 60.0, 50.0, 5.0, 0.0, 20.0, 0.0, 80.0, 24.0, 30.0, 40.0, 25.0, 27.0, 40.0, 40.0, 60.0, 70.0, 50.0, 78.0, 30.0, 60.0, 24.0, 60.0, 38.0, 90.0, 51.0, 115.0, 70.0, 90.0, 60.0, 70.0, 10.0, 22.0, 40.0, 40.0, 40.0, 50.0, -10.0, 100.0, 60.0, 29.0, 60.0, -25.0, 60.0, 100.0, 20.0, 80.0, 60.0, 40.0, 73.0, 50.0, 40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0, 29.0, 7.0, 40.0, 10.0, 20.0, 9.0, 30.0, 16.0, 20.0, 50.0, 50.0, 50.0, 80.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, 29.0, 30.0, 7.0, 20.0, 30.0, 20.0, 10.0, 40.0, 140.0, 70.0, 40.0, 20.0, 1.0, 70.0, 31.0, 60.0, -20.0, 40.0, 90.0, 65.0, 40.0, 50.0, 40.0, 0.0, 30.0, 50.0, 9.0, 16.0, 25.0, 26.0, 11.0, 40.0, 10.0, 20.0, -10.0, 20.0, 50.0, 60.0, 60.0, 40.0, 60.0, 60.0, 40.0, 97.0, 40.0, 70.0, 30.0, 60.0, 18.0, 50.0, 90.0, 0.0, 22.0, 90.0, 40.0, 50.0, 39.0, 60.0, 40.0, 50.0, 60.0, 25.0, 70.0, 90.0, 20.0, 53.0, 20.0, 0.0, 60.0, 40.0, 10.0, 50.0, 50.0, 110.0, 0.0, 94.0, 40.0, 80.0, 70.0, 70.0, 5.0, 50.0, 40.0, 30.0, 80.0, 50.0, 30.0, 20.0, 30.0, 60.0, 0.0, 50.0, 90.0, 30.0, 10.0, 110.0, 60.0, 80.0, 40.0, 50.0, 80.0, 40.0, 30.0, 60.0, 50.0, 110.0, 0.0, 10.0, 40.0, 90.0, -5.0, 90.0, 20.0, 20.0, 110.0, 70.0, 50.0, 70.0, -2.0, 37.0, 30.0, 80.0, 30.0, 20.0, 30.0, 70.0, 40.0, 50.0, 130.0, 20.0, 60.0, 70.0, 1.0, 59.0, 50.0, 59.0, 100.0, 0.0, 36.0, -1.0, 54.0, 0.0, 30.0, 20.0, 60.0, 15.0, 120.0, 50.0, 50.0, 60.0, 50.0, 70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 45.0, 50.0, 50.0, 70.0, 70.0, 30.0, 30.0, 50.0, 20.0, 12.0, 50.0, 9.0, 10.0, 27.0, 60.0, 30.0, 20.0, 100.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 30.0, 50.0, 70.0, 120.0, 130.0, 40.0, 0.0, 50.0, 70.0, 20.0, 60.0, 30.0, 60.0, 30.0, 70.0, 20.0, 60.0, 60.0, 70.0, 30.0, 40.0, 30.0, 60.0, 20.0, 50.0, 50.0, 60.0, 9.0, -10.0, 20.0, 20.0, 40.0, 60.0, 80.0, 60.0, 60.0, 70.0, 80.0, 52.0, 65.0, 30.0, 90.0, 0.0, 50.0, 30.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 30.0, 80.0, 58.0, 40.0, 106.0, 26.0, 37.0, 90.0, 110.0, 38.0, 21.0, 40.0, 60.0, 40.0, 16.0, 50.0, 100.0, 40.0, 90.0, 100.0, 50.0, 10.0, 14.0, 40.0, 10.0, 1.0, 90.0, 124.0, 100.0, 82.0, 22.0, 60.0, 95.0, 60.0, 70.0, 9.0, 110.0, 50.0, 100.0, 49.0, 70.0, 45.0, 40.0, 50.0, 40.0, 78.0, 100.0, 55.0, 70.0, 40.0, 2.0, 90.0, 31.0, 90.0, 100.0, 130.0, 40.0, -14.0, 64.0, 90.0, 18.0, 43.0, 60.0, 40.0, 60.0, 20.0, 80.0, 70.0, 20.0, 27.0, 10.0, 59.0, 50.0, 10.0, 0.0, 90.0, 30.0, 20.0, 30.0, 0.0, 90.0, 27.0, 38.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 90.0, 22.0, 40.0, 49.0, 70.0, 60.0, 20.0, 80.0, 4.0, 57.0, 18.0, 106.0, 70.0, 60.0, 60.0, 50.0, 60.0, 120.0, 92.0, 91.0, 11.0, 60.0, 50.0, 70.0, 69.0, 80.0, -1.0, 18.0, 60.0, 70.0, 20.0, 50.0, 0.0, 10.0, 40.0, 70.0, 60.0, 20.0, 70.0, 20.0, 50.0, 100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0, 60.0, 80.0, 40.0, 70.0, 30.0, 60.0, 30.0, 20.0, 40.0, 30.0, 108.0, 50.0, 110.0, 65.0, 60.0, 130.0, 68.0, 80.0, 40.0, 20.0, 70.0, 80.0, 14.0, 64.0, -75.0, 51.0, 80.0, -23.0, 50.0, 120.0, 20.0, -20.0, 30.0, 21.0, 45.0, 30.0, 70.0, 104.0, -85.0, 40.0, 60.0, 80.0, 120.0, 49.0, 60.0, 70.0, 10.0, -3.0, 20.0, 120.0, 15.0, 100.0, 19.0, 100.0, 20.0, 40.0, 80.0, 50.0, 20.0, 56.0, 8.0, 4.0, 50.0, 90.0, 20.0, 19.0, 8.0, 60.0, 60.0, 50.0, 50.0, 10.0, 60.0, 10.0, 10.0, 50.0, 49.0, 20.0, 26.0, -6.0, 40.0, 70.0, 60.0, 50.0, 18.0, 80.0, -4.0, 60.0, 20.0, 50.0, 50.0, 30.0, 39.0, 60.0, 80.0, 16.0, 20.0, 150.0, 50.0, 50.0, 80.0, 20.0, 80.0, 30.0, 100.0, 90.0, 50.0, 78.0, 20.0, 30.0, 30.0, 10.0, 60.0, 90.0, 30.0, 140.0, 20.0, 30.0, 80.0, 30.0, 50.0, 0.0, 90.0, 40.0, 30.0, 60.0, 50.0, 10.0, 40.0, 130.0, 37.0, 30.0, 110.0, 90.0, 30.0, 0.0, 40.0, 10.0, 38.0, 0.0, 30.0, 50.0, 110.0, 30.0, 20.0, 40.0, 50.0, 40.0, 100.0, 30.0, 50.0, 40.0, 90.0, 60.0, 150.0, 87.0, 40.0, 60.0, 50.0, 36.0, 90.0, 40.0, 60.0, 50.0, 40.0, 60.0, 0.0, 30.0, 60.0, 50.0, 0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0, 100.0, 40.0, 70.0, 150.0, 38.0, 100.0, 50.0, 100.0, 40.0, 37.0, 2.0, 20.0, 50.0, 70.0, 0.0, 50.0, 30.0, 20.0, 120.0, 40.0, 70.0, 10.0, 50.0, 10.0, 20.0, 70.0, 50.0, 20.0, 40.0, 50.0, 90.0, 80.0, 50.0, 40.0, 60.0, 60.0, 80.0, 109.0, 18.0, 33.0, 30.0, 50.0, 30.0, 30.0, 110.0, 90.0, 100.0, 30.0, 40.0, 60.0, 40.0, 60.0, 20.0, 10.0, 90.0, 58.0, 70.0, 30.0, 0.0, 20.0, 50.0, 110.0, 110.0, 50.0, 90.0, 40.0, 20.0, 60.0, 60.0, 70.0, 50.0, 40.0, 40.0, 40.0, 50.0, 90.0, 80.0, 70.0, 48.0, 70.0, 30.0, 70.0, 60.0, 70.0, 150.0, 30.0, 90.0, 17.0, 30.0, 80.0, 90.0, 50.0, 60.0, 14.0, 50.0, 20.0, 20.0, 20.0, 6.0, 30.0, 30.0, 40.0, 60.0, 80.0, 50.0, 40.0, 90.0, 40.0, 20.0, 50.0, 70.0, 30.0, 90.0, 47.0, 20.0, 80.0, 110.0, 50.0, 80.0, 40.0, 70.0, 40.0, 50.0, 70.0, 50.0, 60.0, 20.0, 19.0, 80.0, 20.0, 30.0, 30.0, 80.0, 60.0, 50.0, 70.0, 50.0, 26.0, 60.0, 110.0, 13.0, 25.0, 70.0, 20.0, 40.0, -5.0, 41.0, 0.0, 40.0, 60.0, 170.0, 48.0, 38.0, 10.0, 90.0, 70.0, 80.0, 60.0, 40.0, 85.0, 81.0, 17.0, 50.0, 50.0, 30.0, 60.0, 48.0, 50.0, 38.0, 40.0, 8.0, -5.0, 0.0, 20.0, 20.0, 5.0, 2.0, 0.0, 10.0, 7.0, 86.0, 70.0, 27.0, 90.0, 90.0, 66.0, 70.0, 27.0, 100.0, 60.0, 70.0, 18.0, 90.0, 40.0, 20.0, 70.0, 8.0, 20.0, 50.0, 40.0, 29.0, 80.0, 35.0, 10.0, 30.0, 50.0, 20.0, 37.0, 13.0, 40.0, 60.0, 30.0, 100.0, 20.0, 0.0, 80.0, 80.0, 93.0, 70.0, 50.0, 40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5834788031143183, "mean_inference_ms": 1.6035785496659285, "mean_action_processing_ms": 0.5018452544751497, "mean_env_wait_ms": 1.3995781317807814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012315511703491211, "StateBufferConnector_ms": 0.008610248565673828, "ViewRequirementAgentConnector_ms": 0.3475501537322998}, "num_episodes": 23, "episode_return_max": 731.0, "episode_return_min": 67.0, "episode_return_mean": 477.42}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.697102318227486, "num_env_steps_trained_throughput_per_sec": 21.697102318227486, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 185023.587, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185023.54, "sample_time_ms": 2333.443, "learn_time_ms": 182670.743, "learn_throughput": 21.897, "synch_weights_time_ms": 11.414}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "a22d3_00000", "date": "2024-08-06_03-10-12", "timestamp": 1722928212, "time_this_iter_s": 184.36707401275635, "time_total_s": 16003.908574104309, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2275430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16003.908574104309, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 17.362307692307695, "ram_util_percent": 77.39038461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.976470893589706, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.386719473482321, "policy_loss": -0.01047508861535825, "vf_loss": 6.3955527752986985, "vf_explained_var": 0.005526331298775312, "kl": 0.008208939808938205, "entropy": 0.6085510304973275, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 764.0, "episode_reward_min": 67.0, "episode_reward_mean": 492.47, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 49.247}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.0, 231.0, 379.0, 407.0, 397.0, 257.0, 350.0, 555.0, 451.0, 388.0, 569.0, 390.0, 600.0, 425.0, 495.0, 530.0, 428.0, 455.0, 545.0, 435.0, 298.0, 340.0, 610.0, 470.0, 309.0, 597.0, 620.0, 615.0, 557.0, 521.0, 625.0, 588.0, 623.0, 438.0, 299.0, 545.0, 420.0, 720.0, 496.0, 390.0, 689.0, 460.0, 731.0, 431.0, 255.0, 586.0, 500.0, 369.0, 279.0, 444.0, 545.0, 578.0, 520.0, 500.0, 385.0, 500.0, 663.0, 480.0, 250.0, 725.0, 402.0, 390.0, 620.0, 570.0, 398.0, 660.0, 578.0, 627.0, 360.0, 500.0, 617.0, 479.0, 566.0, 304.0, 691.0, 464.0, 67.0, 686.0, 426.0, 344.0, 583.0, 490.0, 518.0, 633.0, 407.0, 764.0, 410.0, 390.0, 379.0, 459.0, 456.0, 755.0, 560.0, 600.0, 580.0, 610.0, 465.0, 668.0, 414.0, 721.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 80.0, 63.0, 30.0, 20.0, 50.0, 10.0, 20.0, 15.0, 29.0, 7.0, 40.0, 10.0, 20.0, 9.0, 30.0, 16.0, 20.0, 50.0, 50.0, 50.0, 80.0, 20.0, 20.0, 30.0, 20.0, 10.0, 70.0, 29.0, 30.0, 7.0, 20.0, 30.0, 20.0, 10.0, 40.0, 140.0, 70.0, 40.0, 20.0, 1.0, 70.0, 31.0, 60.0, -20.0, 40.0, 90.0, 65.0, 40.0, 50.0, 40.0, 0.0, 30.0, 50.0, 9.0, 16.0, 25.0, 26.0, 11.0, 40.0, 10.0, 20.0, -10.0, 20.0, 50.0, 60.0, 60.0, 40.0, 60.0, 60.0, 40.0, 97.0, 40.0, 70.0, 30.0, 60.0, 18.0, 50.0, 90.0, 0.0, 22.0, 90.0, 40.0, 50.0, 39.0, 60.0, 40.0, 50.0, 60.0, 25.0, 70.0, 90.0, 20.0, 53.0, 20.0, 0.0, 60.0, 40.0, 10.0, 50.0, 50.0, 110.0, 0.0, 94.0, 40.0, 80.0, 70.0, 70.0, 5.0, 50.0, 40.0, 30.0, 80.0, 50.0, 30.0, 20.0, 30.0, 60.0, 0.0, 50.0, 90.0, 30.0, 10.0, 110.0, 60.0, 80.0, 40.0, 50.0, 80.0, 40.0, 30.0, 60.0, 50.0, 110.0, 0.0, 10.0, 40.0, 90.0, -5.0, 90.0, 20.0, 20.0, 110.0, 70.0, 50.0, 70.0, -2.0, 37.0, 30.0, 80.0, 30.0, 20.0, 30.0, 70.0, 40.0, 50.0, 130.0, 20.0, 60.0, 70.0, 1.0, 59.0, 50.0, 59.0, 100.0, 0.0, 36.0, -1.0, 54.0, 0.0, 30.0, 20.0, 60.0, 15.0, 120.0, 50.0, 50.0, 60.0, 50.0, 70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 45.0, 50.0, 50.0, 70.0, 70.0, 30.0, 30.0, 50.0, 20.0, 12.0, 50.0, 9.0, 10.0, 27.0, 60.0, 30.0, 20.0, 100.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 30.0, 50.0, 70.0, 120.0, 130.0, 40.0, 0.0, 50.0, 70.0, 20.0, 60.0, 30.0, 60.0, 30.0, 70.0, 20.0, 60.0, 60.0, 70.0, 30.0, 40.0, 30.0, 60.0, 20.0, 50.0, 50.0, 60.0, 9.0, -10.0, 20.0, 20.0, 40.0, 60.0, 80.0, 60.0, 60.0, 70.0, 80.0, 52.0, 65.0, 30.0, 90.0, 0.0, 50.0, 30.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 30.0, 80.0, 58.0, 40.0, 106.0, 26.0, 37.0, 90.0, 110.0, 38.0, 21.0, 40.0, 60.0, 40.0, 16.0, 50.0, 100.0, 40.0, 90.0, 100.0, 50.0, 10.0, 14.0, 40.0, 10.0, 1.0, 90.0, 124.0, 100.0, 82.0, 22.0, 60.0, 95.0, 60.0, 70.0, 9.0, 110.0, 50.0, 100.0, 49.0, 70.0, 45.0, 40.0, 50.0, 40.0, 78.0, 100.0, 55.0, 70.0, 40.0, 2.0, 90.0, 31.0, 90.0, 100.0, 130.0, 40.0, -14.0, 64.0, 90.0, 18.0, 43.0, 60.0, 40.0, 60.0, 20.0, 80.0, 70.0, 20.0, 27.0, 10.0, 59.0, 50.0, 10.0, 0.0, 90.0, 30.0, 20.0, 30.0, 0.0, 90.0, 27.0, 38.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 90.0, 22.0, 40.0, 49.0, 70.0, 60.0, 20.0, 80.0, 4.0, 57.0, 18.0, 106.0, 70.0, 60.0, 60.0, 50.0, 60.0, 120.0, 92.0, 91.0, 11.0, 60.0, 50.0, 70.0, 69.0, 80.0, -1.0, 18.0, 60.0, 70.0, 20.0, 50.0, 0.0, 10.0, 40.0, 70.0, 60.0, 20.0, 70.0, 20.0, 50.0, 100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0, 60.0, 80.0, 40.0, 70.0, 30.0, 60.0, 30.0, 20.0, 40.0, 30.0, 108.0, 50.0, 110.0, 65.0, 60.0, 130.0, 68.0, 80.0, 40.0, 20.0, 70.0, 80.0, 14.0, 64.0, -75.0, 51.0, 80.0, -23.0, 50.0, 120.0, 20.0, -20.0, 30.0, 21.0, 45.0, 30.0, 70.0, 104.0, -85.0, 40.0, 60.0, 80.0, 120.0, 49.0, 60.0, 70.0, 10.0, -3.0, 20.0, 120.0, 15.0, 100.0, 19.0, 100.0, 20.0, 40.0, 80.0, 50.0, 20.0, 56.0, 8.0, 4.0, 50.0, 90.0, 20.0, 19.0, 8.0, 60.0, 60.0, 50.0, 50.0, 10.0, 60.0, 10.0, 10.0, 50.0, 49.0, 20.0, 26.0, -6.0, 40.0, 70.0, 60.0, 50.0, 18.0, 80.0, -4.0, 60.0, 20.0, 50.0, 50.0, 30.0, 39.0, 60.0, 80.0, 16.0, 20.0, 150.0, 50.0, 50.0, 80.0, 20.0, 80.0, 30.0, 100.0, 90.0, 50.0, 78.0, 20.0, 30.0, 30.0, 10.0, 60.0, 90.0, 30.0, 140.0, 20.0, 30.0, 80.0, 30.0, 50.0, 0.0, 90.0, 40.0, 30.0, 60.0, 50.0, 10.0, 40.0, 130.0, 37.0, 30.0, 110.0, 90.0, 30.0, 0.0, 40.0, 10.0, 38.0, 0.0, 30.0, 50.0, 110.0, 30.0, 20.0, 40.0, 50.0, 40.0, 100.0, 30.0, 50.0, 40.0, 90.0, 60.0, 150.0, 87.0, 40.0, 60.0, 50.0, 36.0, 90.0, 40.0, 60.0, 50.0, 40.0, 60.0, 0.0, 30.0, 60.0, 50.0, 0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0, 100.0, 40.0, 70.0, 150.0, 38.0, 100.0, 50.0, 100.0, 40.0, 37.0, 2.0, 20.0, 50.0, 70.0, 0.0, 50.0, 30.0, 20.0, 120.0, 40.0, 70.0, 10.0, 50.0, 10.0, 20.0, 70.0, 50.0, 20.0, 40.0, 50.0, 90.0, 80.0, 50.0, 40.0, 60.0, 60.0, 80.0, 109.0, 18.0, 33.0, 30.0, 50.0, 30.0, 30.0, 110.0, 90.0, 100.0, 30.0, 40.0, 60.0, 40.0, 60.0, 20.0, 10.0, 90.0, 58.0, 70.0, 30.0, 0.0, 20.0, 50.0, 110.0, 110.0, 50.0, 90.0, 40.0, 20.0, 60.0, 60.0, 70.0, 50.0, 40.0, 40.0, 40.0, 50.0, 90.0, 80.0, 70.0, 48.0, 70.0, 30.0, 70.0, 60.0, 70.0, 150.0, 30.0, 90.0, 17.0, 30.0, 80.0, 90.0, 50.0, 60.0, 14.0, 50.0, 20.0, 20.0, 20.0, 6.0, 30.0, 30.0, 40.0, 60.0, 80.0, 50.0, 40.0, 90.0, 40.0, 20.0, 50.0, 70.0, 30.0, 90.0, 47.0, 20.0, 80.0, 110.0, 50.0, 80.0, 40.0, 70.0, 40.0, 50.0, 70.0, 50.0, 60.0, 20.0, 19.0, 80.0, 20.0, 30.0, 30.0, 80.0, 60.0, 50.0, 70.0, 50.0, 26.0, 60.0, 110.0, 13.0, 25.0, 70.0, 20.0, 40.0, -5.0, 41.0, 0.0, 40.0, 60.0, 170.0, 48.0, 38.0, 10.0, 90.0, 70.0, 80.0, 60.0, 40.0, 85.0, 81.0, 17.0, 50.0, 50.0, 30.0, 60.0, 48.0, 50.0, 38.0, 40.0, 8.0, -5.0, 0.0, 20.0, 20.0, 5.0, 2.0, 0.0, 10.0, 7.0, 86.0, 70.0, 27.0, 90.0, 90.0, 66.0, 70.0, 27.0, 100.0, 60.0, 70.0, 18.0, 90.0, 40.0, 20.0, 70.0, 8.0, 20.0, 50.0, 40.0, 29.0, 80.0, 35.0, 10.0, 30.0, 50.0, 20.0, 37.0, 13.0, 40.0, 60.0, 30.0, 100.0, 20.0, 0.0, 80.0, 80.0, 93.0, 70.0, 50.0, 40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0, 90.0, 65.0, 50.0, 60.0, 80.0, -12.0, 10.0, 60.0, 35.0, 80.0, 90.0, 65.0, 40.0, 38.0, 80.0, 30.0, 110.0, 90.0, 80.0, 10.0, 80.0, 34.0, -3.0, 20.0, 20.0, 10.0, 100.0, 17.0, 79.0, 50.0, 72.0, 100.0, 70.0, 110.0, 80.0, 100.0, 62.0, 40.0, 90.0, 40.0, 20.0, 90.0, 30.0, 70.0, 20.0, 70.0, 40.0, 10.0, 20.0, 40.0, 100.0, 30.0, 110.0, 9.0, 16.0, 20.0, 20.0, 35.0, 20.0, 30.0, 26.0, 80.0, 18.0, -3.0, 20.0, 19.0, 40.0, 80.0, 50.0, 49.0, 14.0, 30.0, 70.0, 20.0, 60.0, 30.0, 20.0, 60.0, 50.0, 105.0, 30.0, -11.0, 90.0, 17.0, 20.0, 100.0, 100.0, 50.0, 10.0, 50.0, 90.0, 80.0, 10.0, 80.0, 100.0, 10.0, 45.0, 80.0, 100.0, 160.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 40.0, 90.0, 80.0, 70.0, 30.0, 100.0, 50.0, 70.0, 50.0, 70.0, 50.0, 60.0, 70.0, 50.0, 40.0, 30.0, 40.0, 60.0, 30.0, 90.0, 100.0, 120.0, 20.0, 50.0, 20.0, 70.0, 60.0, 20.0, 0.0, 110.0, 40.0, 130.0, 60.0, 100.0, 70.0, 70.0, 50.0, 70.0, 40.0, 37.0, 10.0, 78.0, 0.0, 40.0, 60.0, 80.0, 29.0, 130.0, 80.0, 50.0, 120.0, 60.0, 80.0, -21.0, 27.0, 20.0, 27.0, 90.0, 50.0, 80.0, 30.0, 40.0, 0.0, 50.0, 90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5808573945187248, "mean_inference_ms": 1.6009946533427304, "mean_action_processing_ms": 0.5024608287505203, "mean_env_wait_ms": 1.3974086950877247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012392759323120117, "StateBufferConnector_ms": 0.008658409118652344, "ViewRequirementAgentConnector_ms": 0.3498830795288086}, "num_episodes": 18, "episode_return_max": 764.0, "episode_return_min": 67.0, "episode_return_mean": 492.47}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.625461884149864, "num_env_steps_trained_throughput_per_sec": 21.625461884149864, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 185074.214, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185074.168, "sample_time_ms": 2370.757, "learn_time_ms": 182683.917, "learn_throughput": 21.896, "synch_weights_time_ms": 11.693}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "a22d3_00000", "date": "2024-08-06_03-13-17", "timestamp": 1722928397, "time_this_iter_s": 184.9713318347931, "time_total_s": 16188.879905939102, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22310d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16188.879905939102, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 17.810305343511452, "ram_util_percent": 77.25763358778626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8444225104345175, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.805979716206511, "policy_loss": -0.010346725992377376, "vf_loss": 5.81475758689661, "vf_explained_var": 0.016835619853581358, "kl": 0.007844294736653509, "entropy": 0.6489229020124045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 764.0, "episode_reward_min": 67.0, "episode_reward_mean": 508.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 50.883}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.0, 435.0, 298.0, 340.0, 610.0, 470.0, 309.0, 597.0, 620.0, 615.0, 557.0, 521.0, 625.0, 588.0, 623.0, 438.0, 299.0, 545.0, 420.0, 720.0, 496.0, 390.0, 689.0, 460.0, 731.0, 431.0, 255.0, 586.0, 500.0, 369.0, 279.0, 444.0, 545.0, 578.0, 520.0, 500.0, 385.0, 500.0, 663.0, 480.0, 250.0, 725.0, 402.0, 390.0, 620.0, 570.0, 398.0, 660.0, 578.0, 627.0, 360.0, 500.0, 617.0, 479.0, 566.0, 304.0, 691.0, 464.0, 67.0, 686.0, 426.0, 344.0, 583.0, 490.0, 518.0, 633.0, 407.0, 764.0, 410.0, 390.0, 379.0, 459.0, 456.0, 755.0, 560.0, 600.0, 580.0, 610.0, 465.0, 668.0, 414.0, 721.0, 609.0, 332.0, 692.0, 468.0, 506.0, 565.0, 479.0, 557.0, 664.0, 567.0, 289.0, 544.0, 635.0, 430.0, 459.0, 480.0, 522.0, 523.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 120.0, 0.0, 60.0, 100.0, 100.0, 10.0, 55.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 45.0, 50.0, 50.0, 70.0, 70.0, 30.0, 30.0, 50.0, 20.0, 12.0, 50.0, 9.0, 10.0, 27.0, 60.0, 30.0, 20.0, 100.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 50.0, 30.0, 50.0, 70.0, 120.0, 130.0, 40.0, 0.0, 50.0, 70.0, 20.0, 60.0, 30.0, 60.0, 30.0, 70.0, 20.0, 60.0, 60.0, 70.0, 30.0, 40.0, 30.0, 60.0, 20.0, 50.0, 50.0, 60.0, 9.0, -10.0, 20.0, 20.0, 40.0, 60.0, 80.0, 60.0, 60.0, 70.0, 80.0, 52.0, 65.0, 30.0, 90.0, 0.0, 50.0, 30.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 30.0, 80.0, 58.0, 40.0, 106.0, 26.0, 37.0, 90.0, 110.0, 38.0, 21.0, 40.0, 60.0, 40.0, 16.0, 50.0, 100.0, 40.0, 90.0, 100.0, 50.0, 10.0, 14.0, 40.0, 10.0, 1.0, 90.0, 124.0, 100.0, 82.0, 22.0, 60.0, 95.0, 60.0, 70.0, 9.0, 110.0, 50.0, 100.0, 49.0, 70.0, 45.0, 40.0, 50.0, 40.0, 78.0, 100.0, 55.0, 70.0, 40.0, 2.0, 90.0, 31.0, 90.0, 100.0, 130.0, 40.0, -14.0, 64.0, 90.0, 18.0, 43.0, 60.0, 40.0, 60.0, 20.0, 80.0, 70.0, 20.0, 27.0, 10.0, 59.0, 50.0, 10.0, 0.0, 90.0, 30.0, 20.0, 30.0, 0.0, 90.0, 27.0, 38.0, 80.0, 20.0, 60.0, 50.0, 20.0, 70.0, 90.0, 22.0, 40.0, 49.0, 70.0, 60.0, 20.0, 80.0, 4.0, 57.0, 18.0, 106.0, 70.0, 60.0, 60.0, 50.0, 60.0, 120.0, 92.0, 91.0, 11.0, 60.0, 50.0, 70.0, 69.0, 80.0, -1.0, 18.0, 60.0, 70.0, 20.0, 50.0, 0.0, 10.0, 40.0, 70.0, 60.0, 20.0, 70.0, 20.0, 50.0, 100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0, 60.0, 80.0, 40.0, 70.0, 30.0, 60.0, 30.0, 20.0, 40.0, 30.0, 108.0, 50.0, 110.0, 65.0, 60.0, 130.0, 68.0, 80.0, 40.0, 20.0, 70.0, 80.0, 14.0, 64.0, -75.0, 51.0, 80.0, -23.0, 50.0, 120.0, 20.0, -20.0, 30.0, 21.0, 45.0, 30.0, 70.0, 104.0, -85.0, 40.0, 60.0, 80.0, 120.0, 49.0, 60.0, 70.0, 10.0, -3.0, 20.0, 120.0, 15.0, 100.0, 19.0, 100.0, 20.0, 40.0, 80.0, 50.0, 20.0, 56.0, 8.0, 4.0, 50.0, 90.0, 20.0, 19.0, 8.0, 60.0, 60.0, 50.0, 50.0, 10.0, 60.0, 10.0, 10.0, 50.0, 49.0, 20.0, 26.0, -6.0, 40.0, 70.0, 60.0, 50.0, 18.0, 80.0, -4.0, 60.0, 20.0, 50.0, 50.0, 30.0, 39.0, 60.0, 80.0, 16.0, 20.0, 150.0, 50.0, 50.0, 80.0, 20.0, 80.0, 30.0, 100.0, 90.0, 50.0, 78.0, 20.0, 30.0, 30.0, 10.0, 60.0, 90.0, 30.0, 140.0, 20.0, 30.0, 80.0, 30.0, 50.0, 0.0, 90.0, 40.0, 30.0, 60.0, 50.0, 10.0, 40.0, 130.0, 37.0, 30.0, 110.0, 90.0, 30.0, 0.0, 40.0, 10.0, 38.0, 0.0, 30.0, 50.0, 110.0, 30.0, 20.0, 40.0, 50.0, 40.0, 100.0, 30.0, 50.0, 40.0, 90.0, 60.0, 150.0, 87.0, 40.0, 60.0, 50.0, 36.0, 90.0, 40.0, 60.0, 50.0, 40.0, 60.0, 0.0, 30.0, 60.0, 50.0, 0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0, 100.0, 40.0, 70.0, 150.0, 38.0, 100.0, 50.0, 100.0, 40.0, 37.0, 2.0, 20.0, 50.0, 70.0, 0.0, 50.0, 30.0, 20.0, 120.0, 40.0, 70.0, 10.0, 50.0, 10.0, 20.0, 70.0, 50.0, 20.0, 40.0, 50.0, 90.0, 80.0, 50.0, 40.0, 60.0, 60.0, 80.0, 109.0, 18.0, 33.0, 30.0, 50.0, 30.0, 30.0, 110.0, 90.0, 100.0, 30.0, 40.0, 60.0, 40.0, 60.0, 20.0, 10.0, 90.0, 58.0, 70.0, 30.0, 0.0, 20.0, 50.0, 110.0, 110.0, 50.0, 90.0, 40.0, 20.0, 60.0, 60.0, 70.0, 50.0, 40.0, 40.0, 40.0, 50.0, 90.0, 80.0, 70.0, 48.0, 70.0, 30.0, 70.0, 60.0, 70.0, 150.0, 30.0, 90.0, 17.0, 30.0, 80.0, 90.0, 50.0, 60.0, 14.0, 50.0, 20.0, 20.0, 20.0, 6.0, 30.0, 30.0, 40.0, 60.0, 80.0, 50.0, 40.0, 90.0, 40.0, 20.0, 50.0, 70.0, 30.0, 90.0, 47.0, 20.0, 80.0, 110.0, 50.0, 80.0, 40.0, 70.0, 40.0, 50.0, 70.0, 50.0, 60.0, 20.0, 19.0, 80.0, 20.0, 30.0, 30.0, 80.0, 60.0, 50.0, 70.0, 50.0, 26.0, 60.0, 110.0, 13.0, 25.0, 70.0, 20.0, 40.0, -5.0, 41.0, 0.0, 40.0, 60.0, 170.0, 48.0, 38.0, 10.0, 90.0, 70.0, 80.0, 60.0, 40.0, 85.0, 81.0, 17.0, 50.0, 50.0, 30.0, 60.0, 48.0, 50.0, 38.0, 40.0, 8.0, -5.0, 0.0, 20.0, 20.0, 5.0, 2.0, 0.0, 10.0, 7.0, 86.0, 70.0, 27.0, 90.0, 90.0, 66.0, 70.0, 27.0, 100.0, 60.0, 70.0, 18.0, 90.0, 40.0, 20.0, 70.0, 8.0, 20.0, 50.0, 40.0, 29.0, 80.0, 35.0, 10.0, 30.0, 50.0, 20.0, 37.0, 13.0, 40.0, 60.0, 30.0, 100.0, 20.0, 0.0, 80.0, 80.0, 93.0, 70.0, 50.0, 40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0, 90.0, 65.0, 50.0, 60.0, 80.0, -12.0, 10.0, 60.0, 35.0, 80.0, 90.0, 65.0, 40.0, 38.0, 80.0, 30.0, 110.0, 90.0, 80.0, 10.0, 80.0, 34.0, -3.0, 20.0, 20.0, 10.0, 100.0, 17.0, 79.0, 50.0, 72.0, 100.0, 70.0, 110.0, 80.0, 100.0, 62.0, 40.0, 90.0, 40.0, 20.0, 90.0, 30.0, 70.0, 20.0, 70.0, 40.0, 10.0, 20.0, 40.0, 100.0, 30.0, 110.0, 9.0, 16.0, 20.0, 20.0, 35.0, 20.0, 30.0, 26.0, 80.0, 18.0, -3.0, 20.0, 19.0, 40.0, 80.0, 50.0, 49.0, 14.0, 30.0, 70.0, 20.0, 60.0, 30.0, 20.0, 60.0, 50.0, 105.0, 30.0, -11.0, 90.0, 17.0, 20.0, 100.0, 100.0, 50.0, 10.0, 50.0, 90.0, 80.0, 10.0, 80.0, 100.0, 10.0, 45.0, 80.0, 100.0, 160.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 40.0, 90.0, 80.0, 70.0, 30.0, 100.0, 50.0, 70.0, 50.0, 70.0, 50.0, 60.0, 70.0, 50.0, 40.0, 30.0, 40.0, 60.0, 30.0, 90.0, 100.0, 120.0, 20.0, 50.0, 20.0, 70.0, 60.0, 20.0, 0.0, 110.0, 40.0, 130.0, 60.0, 100.0, 70.0, 70.0, 50.0, 70.0, 40.0, 37.0, 10.0, 78.0, 0.0, 40.0, 60.0, 80.0, 29.0, 130.0, 80.0, 50.0, 120.0, 60.0, 80.0, -21.0, 27.0, 20.0, 27.0, 90.0, 50.0, 80.0, 30.0, 40.0, 0.0, 50.0, 90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0, 2.0, 40.0, 40.0, 90.0, 50.0, 77.0, 20.0, 70.0, 110.0, 110.0, -38.0, 4.0, 30.0, 90.0, 100.0, 8.0, 40.0, 70.0, 30.0, -2.0, 150.0, 110.0, 30.0, 32.0, 90.0, 40.0, 50.0, 10.0, 110.0, 70.0, 10.0, 0.0, 3.0, 28.0, 49.0, 68.0, 102.0, 78.0, 70.0, 60.0, 20.0, 20.0, 50.0, 50.0, 38.0, 70.0, 48.0, 80.0, 80.0, 50.0, 97.0, 60.0, 110.0, 30.0, 48.0, 40.0, 50.0, 60.0, 30.0, 40.0, 20.0, 70.0, 70.0, 30.0, 19.0, 30.0, 70.0, 40.0, 110.0, 20.0, 40.0, 54.0, 40.0, 30.0, 0.0, 80.0, 120.0, 80.0, 73.0, 40.0, 29.0, 80.0, 80.0, 50.0, -2.0, 110.0, 57.0, 90.0, 100.0, 70.0, 70.0, 19.0, -2.0, 110.0, 130.0, 30.0, 50.0, 30.0, 70.0, 60.0, 9.0, 120.0, 30.0, 50.0, 10.0, -6.0, 6.0, 10.0, 40.0, 20.0, 15.0, 29.0, 110.0, -18.0, 68.0, 60.0, 50.0, 120.0, 10.0, 100.0, 80.0, 60.0, 60.0, 60.0, 120.0, 41.0, 30.0, 74.0, 90.0, 20.0, 30.0, 20.0, 90.0, 110.0, 40.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 30.0, 40.0, 39.0, 60.0, 20.0, 40.0, 100.0, 50.0, 40.0, 50.0, 60.0, 0.0, 30.0, 10.0, 50.0, 70.0, 50.0, 120.0, 40.0, 40.0, 50.0, 30.0, 12.0, 110.0, 20.0, 30.0, 100.0, 80.0, 50.0, 20.0, 5.0, 58.0, 20.0, 100.0, 20.0, 120.0, 50.0, 50.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.578462706264644, "mean_inference_ms": 1.5987807776094018, "mean_action_processing_ms": 0.5031183588758208, "mean_env_wait_ms": 1.3954824060187343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012526512145996094, "StateBufferConnector_ms": 0.008732080459594727, "ViewRequirementAgentConnector_ms": 0.35802364349365234}, "num_episodes": 18, "episode_return_max": 764.0, "episode_return_min": 67.0, "episode_return_mean": 508.83}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.496272989911596, "num_env_steps_trained_throughput_per_sec": 21.496272989911596, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 185198.566, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185198.52, "sample_time_ms": 2387.057, "learn_time_ms": 182791.553, "learn_throughput": 21.883, "synch_weights_time_ms": 11.906}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "a22d3_00000", "date": "2024-08-06_03-16-23", "timestamp": 1722928583, "time_this_iter_s": 186.11369585990906, "time_total_s": 16374.993601799011, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a0040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16374.993601799011, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 19.050950570342202, "ram_util_percent": 77.72889733840303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.100336622214292, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.836197108785692, "policy_loss": -0.011005081349579147, "vf_loss": 5.845427171262308, "vf_explained_var": 0.020372353276759545, "kl": 0.008875130140398375, "entropy": 0.665466734633659, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 764.0, "episode_reward_min": 67.0, "episode_reward_mean": 503.02, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 50.302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [689.0, 460.0, 731.0, 431.0, 255.0, 586.0, 500.0, 369.0, 279.0, 444.0, 545.0, 578.0, 520.0, 500.0, 385.0, 500.0, 663.0, 480.0, 250.0, 725.0, 402.0, 390.0, 620.0, 570.0, 398.0, 660.0, 578.0, 627.0, 360.0, 500.0, 617.0, 479.0, 566.0, 304.0, 691.0, 464.0, 67.0, 686.0, 426.0, 344.0, 583.0, 490.0, 518.0, 633.0, 407.0, 764.0, 410.0, 390.0, 379.0, 459.0, 456.0, 755.0, 560.0, 600.0, 580.0, 610.0, 465.0, 668.0, 414.0, 721.0, 609.0, 332.0, 692.0, 468.0, 506.0, 565.0, 479.0, 557.0, 664.0, 567.0, 289.0, 544.0, 635.0, 430.0, 459.0, 480.0, 522.0, 523.0, 460.0, 470.0, 369.0, 369.0, 634.0, 462.0, 538.0, 359.0, 306.0, 450.0, 390.0, 390.0, 590.0, 565.0, 580.0, 429.0, 600.0, 519.0, 630.0, 579.0, 441.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 7.0, 50.0, 60.0, 70.0, 130.0, 29.0, 53.0, 100.0, 90.0, 60.0, 80.0, 40.0, 70.0, 30.0, 60.0, 30.0, 20.0, 40.0, 30.0, 108.0, 50.0, 110.0, 65.0, 60.0, 130.0, 68.0, 80.0, 40.0, 20.0, 70.0, 80.0, 14.0, 64.0, -75.0, 51.0, 80.0, -23.0, 50.0, 120.0, 20.0, -20.0, 30.0, 21.0, 45.0, 30.0, 70.0, 104.0, -85.0, 40.0, 60.0, 80.0, 120.0, 49.0, 60.0, 70.0, 10.0, -3.0, 20.0, 120.0, 15.0, 100.0, 19.0, 100.0, 20.0, 40.0, 80.0, 50.0, 20.0, 56.0, 8.0, 4.0, 50.0, 90.0, 20.0, 19.0, 8.0, 60.0, 60.0, 50.0, 50.0, 10.0, 60.0, 10.0, 10.0, 50.0, 49.0, 20.0, 26.0, -6.0, 40.0, 70.0, 60.0, 50.0, 18.0, 80.0, -4.0, 60.0, 20.0, 50.0, 50.0, 30.0, 39.0, 60.0, 80.0, 16.0, 20.0, 150.0, 50.0, 50.0, 80.0, 20.0, 80.0, 30.0, 100.0, 90.0, 50.0, 78.0, 20.0, 30.0, 30.0, 10.0, 60.0, 90.0, 30.0, 140.0, 20.0, 30.0, 80.0, 30.0, 50.0, 0.0, 90.0, 40.0, 30.0, 60.0, 50.0, 10.0, 40.0, 130.0, 37.0, 30.0, 110.0, 90.0, 30.0, 0.0, 40.0, 10.0, 38.0, 0.0, 30.0, 50.0, 110.0, 30.0, 20.0, 40.0, 50.0, 40.0, 100.0, 30.0, 50.0, 40.0, 90.0, 60.0, 150.0, 87.0, 40.0, 60.0, 50.0, 36.0, 90.0, 40.0, 60.0, 50.0, 40.0, 60.0, 0.0, 30.0, 60.0, 50.0, 0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0, 100.0, 40.0, 70.0, 150.0, 38.0, 100.0, 50.0, 100.0, 40.0, 37.0, 2.0, 20.0, 50.0, 70.0, 0.0, 50.0, 30.0, 20.0, 120.0, 40.0, 70.0, 10.0, 50.0, 10.0, 20.0, 70.0, 50.0, 20.0, 40.0, 50.0, 90.0, 80.0, 50.0, 40.0, 60.0, 60.0, 80.0, 109.0, 18.0, 33.0, 30.0, 50.0, 30.0, 30.0, 110.0, 90.0, 100.0, 30.0, 40.0, 60.0, 40.0, 60.0, 20.0, 10.0, 90.0, 58.0, 70.0, 30.0, 0.0, 20.0, 50.0, 110.0, 110.0, 50.0, 90.0, 40.0, 20.0, 60.0, 60.0, 70.0, 50.0, 40.0, 40.0, 40.0, 50.0, 90.0, 80.0, 70.0, 48.0, 70.0, 30.0, 70.0, 60.0, 70.0, 150.0, 30.0, 90.0, 17.0, 30.0, 80.0, 90.0, 50.0, 60.0, 14.0, 50.0, 20.0, 20.0, 20.0, 6.0, 30.0, 30.0, 40.0, 60.0, 80.0, 50.0, 40.0, 90.0, 40.0, 20.0, 50.0, 70.0, 30.0, 90.0, 47.0, 20.0, 80.0, 110.0, 50.0, 80.0, 40.0, 70.0, 40.0, 50.0, 70.0, 50.0, 60.0, 20.0, 19.0, 80.0, 20.0, 30.0, 30.0, 80.0, 60.0, 50.0, 70.0, 50.0, 26.0, 60.0, 110.0, 13.0, 25.0, 70.0, 20.0, 40.0, -5.0, 41.0, 0.0, 40.0, 60.0, 170.0, 48.0, 38.0, 10.0, 90.0, 70.0, 80.0, 60.0, 40.0, 85.0, 81.0, 17.0, 50.0, 50.0, 30.0, 60.0, 48.0, 50.0, 38.0, 40.0, 8.0, -5.0, 0.0, 20.0, 20.0, 5.0, 2.0, 0.0, 10.0, 7.0, 86.0, 70.0, 27.0, 90.0, 90.0, 66.0, 70.0, 27.0, 100.0, 60.0, 70.0, 18.0, 90.0, 40.0, 20.0, 70.0, 8.0, 20.0, 50.0, 40.0, 29.0, 80.0, 35.0, 10.0, 30.0, 50.0, 20.0, 37.0, 13.0, 40.0, 60.0, 30.0, 100.0, 20.0, 0.0, 80.0, 80.0, 93.0, 70.0, 50.0, 40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0, 90.0, 65.0, 50.0, 60.0, 80.0, -12.0, 10.0, 60.0, 35.0, 80.0, 90.0, 65.0, 40.0, 38.0, 80.0, 30.0, 110.0, 90.0, 80.0, 10.0, 80.0, 34.0, -3.0, 20.0, 20.0, 10.0, 100.0, 17.0, 79.0, 50.0, 72.0, 100.0, 70.0, 110.0, 80.0, 100.0, 62.0, 40.0, 90.0, 40.0, 20.0, 90.0, 30.0, 70.0, 20.0, 70.0, 40.0, 10.0, 20.0, 40.0, 100.0, 30.0, 110.0, 9.0, 16.0, 20.0, 20.0, 35.0, 20.0, 30.0, 26.0, 80.0, 18.0, -3.0, 20.0, 19.0, 40.0, 80.0, 50.0, 49.0, 14.0, 30.0, 70.0, 20.0, 60.0, 30.0, 20.0, 60.0, 50.0, 105.0, 30.0, -11.0, 90.0, 17.0, 20.0, 100.0, 100.0, 50.0, 10.0, 50.0, 90.0, 80.0, 10.0, 80.0, 100.0, 10.0, 45.0, 80.0, 100.0, 160.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 40.0, 90.0, 80.0, 70.0, 30.0, 100.0, 50.0, 70.0, 50.0, 70.0, 50.0, 60.0, 70.0, 50.0, 40.0, 30.0, 40.0, 60.0, 30.0, 90.0, 100.0, 120.0, 20.0, 50.0, 20.0, 70.0, 60.0, 20.0, 0.0, 110.0, 40.0, 130.0, 60.0, 100.0, 70.0, 70.0, 50.0, 70.0, 40.0, 37.0, 10.0, 78.0, 0.0, 40.0, 60.0, 80.0, 29.0, 130.0, 80.0, 50.0, 120.0, 60.0, 80.0, -21.0, 27.0, 20.0, 27.0, 90.0, 50.0, 80.0, 30.0, 40.0, 0.0, 50.0, 90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0, 2.0, 40.0, 40.0, 90.0, 50.0, 77.0, 20.0, 70.0, 110.0, 110.0, -38.0, 4.0, 30.0, 90.0, 100.0, 8.0, 40.0, 70.0, 30.0, -2.0, 150.0, 110.0, 30.0, 32.0, 90.0, 40.0, 50.0, 10.0, 110.0, 70.0, 10.0, 0.0, 3.0, 28.0, 49.0, 68.0, 102.0, 78.0, 70.0, 60.0, 20.0, 20.0, 50.0, 50.0, 38.0, 70.0, 48.0, 80.0, 80.0, 50.0, 97.0, 60.0, 110.0, 30.0, 48.0, 40.0, 50.0, 60.0, 30.0, 40.0, 20.0, 70.0, 70.0, 30.0, 19.0, 30.0, 70.0, 40.0, 110.0, 20.0, 40.0, 54.0, 40.0, 30.0, 0.0, 80.0, 120.0, 80.0, 73.0, 40.0, 29.0, 80.0, 80.0, 50.0, -2.0, 110.0, 57.0, 90.0, 100.0, 70.0, 70.0, 19.0, -2.0, 110.0, 130.0, 30.0, 50.0, 30.0, 70.0, 60.0, 9.0, 120.0, 30.0, 50.0, 10.0, -6.0, 6.0, 10.0, 40.0, 20.0, 15.0, 29.0, 110.0, -18.0, 68.0, 60.0, 50.0, 120.0, 10.0, 100.0, 80.0, 60.0, 60.0, 60.0, 120.0, 41.0, 30.0, 74.0, 90.0, 20.0, 30.0, 20.0, 90.0, 110.0, 40.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 30.0, 40.0, 39.0, 60.0, 20.0, 40.0, 100.0, 50.0, 40.0, 50.0, 60.0, 0.0, 30.0, 10.0, 50.0, 70.0, 50.0, 120.0, 40.0, 40.0, 50.0, 30.0, 12.0, 110.0, 20.0, 30.0, 100.0, 80.0, 50.0, 20.0, 5.0, 58.0, 20.0, 100.0, 20.0, 120.0, 50.0, 50.0, 80.0, 30.0, 50.0, 10.0, 50.0, 30.0, 20.0, 70.0, 10.0, 40.0, 150.0, 50.0, 10.0, 40.0, 110.0, 100.0, 40.0, 20.0, 20.0, 30.0, 50.0, 17.0, 42.0, 40.0, 10.0, 80.0, 40.0, 10.0, 80.0, 20.0, 30.0, 20.0, 50.0, 39.0, 0.0, 50.0, 50.0, 30.0, 30.0, 60.0, 40.0, 60.0, 30.0, 140.0, 70.0, 0.0, 90.0, 60.0, 40.0, 94.0, 50.0, 60.0, 20.0, 50.0, 30.0, 70.0, 40.0, 40.0, 47.0, 49.0, 56.0, 23.0, 140.0, 50.0, 50.0, 40.0, -22.0, 47.0, 110.0, 50.0, 50.0, 20.0, 10.0, 60.0, 50.0, 34.0, 20.0, 35.0, 70.0, 60.0, 0.0, 50.0, 70.0, 20.0, 50.0, -7.0, 30.0, 40.0, 17.0, 26.0, 10.0, 20.0, 10.0, 30.0, 70.0, 60.0, 60.0, 40.0, 90.0, 0.0, 70.0, 50.0, 50.0, 40.0, 0.0, 60.0, 80.0, 40.0, 60.0, 0.0, 10.0, 26.0, 40.0, -1.0, 38.0, 20.0, 70.0, 59.0, 8.0, 110.0, 20.0, 10.0, 80.0, 60.0, 80.0, 40.0, 120.0, 80.0, 40.0, 40.0, 40.0, 40.0, 60.0, 30.0, 15.0, 60.0, 30.0, 160.0, 40.0, 80.0, 50.0, 60.0, 40.0, 80.0, 40.0, 50.0, 10.0, 80.0, 50.0, 80.0, 90.0, 50.0, 30.0, 20.0, 40.0, 89.0, 40.0, 20.0, 80.0, 40.0, 20.0, 40.0, 20.0, 40.0, 20.0, 30.0, 100.0, 110.0, 100.0, 70.0, 70.0, 80.0, 50.0, 80.0, 12.0, 100.0, 20.0, 30.0, 20.0, 80.0, 47.0, 40.0, 50.0, 60.0, 130.0, 60.0, 70.0, 80.0, 10.0, 110.0, 20.0, 80.0, 90.0, 70.0, 90.0, 80.0, 60.0, 90.0, 17.0, 0.0, 2.0, -39.0, 28.0, -1.0, 50.0, 70.0, 90.0, 50.0, 43.0, 50.0, 100.0, 50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5761303277313143, "mean_inference_ms": 1.5971948748663045, "mean_action_processing_ms": 0.5040308028792977, "mean_env_wait_ms": 1.3935694589771654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017058610916137695, "StateBufferConnector_ms": 0.009342193603515625, "ViewRequirementAgentConnector_ms": 0.37884020805358887}, "num_episodes": 22, "episode_return_max": 764.0, "episode_return_min": 67.0, "episode_return_mean": 503.02}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.638087394961477, "num_env_steps_trained_throughput_per_sec": 21.638087394961477, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 185337.745, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185337.698, "sample_time_ms": 2421.031, "learn_time_ms": 182896.93, "learn_throughput": 21.87, "synch_weights_time_ms": 11.59}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "a22d3_00000", "date": "2024-08-06_03-19-28", "timestamp": 1722928768, "time_this_iter_s": 184.86850023269653, "time_total_s": 16559.862102031708, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a139e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16559.862102031708, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.851340996168584, "ram_util_percent": 78.24291187739465}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.076780668005776, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.782657146149169, "policy_loss": -0.010617707105461583, "vf_loss": 5.791677625364643, "vf_explained_var": 0.01969526338374145, "kl": 0.007986116916075552, "entropy": 0.6685118333663677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 764.0, "episode_reward_min": 67.0, "episode_reward_mean": 509.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -40.0}, "policy_reward_max": {"policy_0": 180.0}, "policy_reward_mean": {"policy_0": 50.992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 725.0, 402.0, 390.0, 620.0, 570.0, 398.0, 660.0, 578.0, 627.0, 360.0, 500.0, 617.0, 479.0, 566.0, 304.0, 691.0, 464.0, 67.0, 686.0, 426.0, 344.0, 583.0, 490.0, 518.0, 633.0, 407.0, 764.0, 410.0, 390.0, 379.0, 459.0, 456.0, 755.0, 560.0, 600.0, 580.0, 610.0, 465.0, 668.0, 414.0, 721.0, 609.0, 332.0, 692.0, 468.0, 506.0, 565.0, 479.0, 557.0, 664.0, 567.0, 289.0, 544.0, 635.0, 430.0, 459.0, 480.0, 522.0, 523.0, 460.0, 470.0, 369.0, 369.0, 634.0, 462.0, 538.0, 359.0, 306.0, 450.0, 390.0, 390.0, 590.0, 565.0, 580.0, 429.0, 600.0, 519.0, 630.0, 579.0, 441.0, 350.0, 437.0, 598.0, 428.0, 364.0, 564.0, 550.0, 515.0, 544.0, 470.0, 534.0, 708.0, 475.0, 352.0, 565.0, 666.0, 755.0, 710.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 90.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 40.0, 100.0, 40.0, 70.0, 150.0, 38.0, 100.0, 50.0, 100.0, 40.0, 37.0, 2.0, 20.0, 50.0, 70.0, 0.0, 50.0, 30.0, 20.0, 120.0, 40.0, 70.0, 10.0, 50.0, 10.0, 20.0, 70.0, 50.0, 20.0, 40.0, 50.0, 90.0, 80.0, 50.0, 40.0, 60.0, 60.0, 80.0, 109.0, 18.0, 33.0, 30.0, 50.0, 30.0, 30.0, 110.0, 90.0, 100.0, 30.0, 40.0, 60.0, 40.0, 60.0, 20.0, 10.0, 90.0, 58.0, 70.0, 30.0, 0.0, 20.0, 50.0, 110.0, 110.0, 50.0, 90.0, 40.0, 20.0, 60.0, 60.0, 70.0, 50.0, 40.0, 40.0, 40.0, 50.0, 90.0, 80.0, 70.0, 48.0, 70.0, 30.0, 70.0, 60.0, 70.0, 150.0, 30.0, 90.0, 17.0, 30.0, 80.0, 90.0, 50.0, 60.0, 14.0, 50.0, 20.0, 20.0, 20.0, 6.0, 30.0, 30.0, 40.0, 60.0, 80.0, 50.0, 40.0, 90.0, 40.0, 20.0, 50.0, 70.0, 30.0, 90.0, 47.0, 20.0, 80.0, 110.0, 50.0, 80.0, 40.0, 70.0, 40.0, 50.0, 70.0, 50.0, 60.0, 20.0, 19.0, 80.0, 20.0, 30.0, 30.0, 80.0, 60.0, 50.0, 70.0, 50.0, 26.0, 60.0, 110.0, 13.0, 25.0, 70.0, 20.0, 40.0, -5.0, 41.0, 0.0, 40.0, 60.0, 170.0, 48.0, 38.0, 10.0, 90.0, 70.0, 80.0, 60.0, 40.0, 85.0, 81.0, 17.0, 50.0, 50.0, 30.0, 60.0, 48.0, 50.0, 38.0, 40.0, 8.0, -5.0, 0.0, 20.0, 20.0, 5.0, 2.0, 0.0, 10.0, 7.0, 86.0, 70.0, 27.0, 90.0, 90.0, 66.0, 70.0, 27.0, 100.0, 60.0, 70.0, 18.0, 90.0, 40.0, 20.0, 70.0, 8.0, 20.0, 50.0, 40.0, 29.0, 80.0, 35.0, 10.0, 30.0, 50.0, 20.0, 37.0, 13.0, 40.0, 60.0, 30.0, 100.0, 20.0, 0.0, 80.0, 80.0, 93.0, 70.0, 50.0, 40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0, 90.0, 65.0, 50.0, 60.0, 80.0, -12.0, 10.0, 60.0, 35.0, 80.0, 90.0, 65.0, 40.0, 38.0, 80.0, 30.0, 110.0, 90.0, 80.0, 10.0, 80.0, 34.0, -3.0, 20.0, 20.0, 10.0, 100.0, 17.0, 79.0, 50.0, 72.0, 100.0, 70.0, 110.0, 80.0, 100.0, 62.0, 40.0, 90.0, 40.0, 20.0, 90.0, 30.0, 70.0, 20.0, 70.0, 40.0, 10.0, 20.0, 40.0, 100.0, 30.0, 110.0, 9.0, 16.0, 20.0, 20.0, 35.0, 20.0, 30.0, 26.0, 80.0, 18.0, -3.0, 20.0, 19.0, 40.0, 80.0, 50.0, 49.0, 14.0, 30.0, 70.0, 20.0, 60.0, 30.0, 20.0, 60.0, 50.0, 105.0, 30.0, -11.0, 90.0, 17.0, 20.0, 100.0, 100.0, 50.0, 10.0, 50.0, 90.0, 80.0, 10.0, 80.0, 100.0, 10.0, 45.0, 80.0, 100.0, 160.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 40.0, 90.0, 80.0, 70.0, 30.0, 100.0, 50.0, 70.0, 50.0, 70.0, 50.0, 60.0, 70.0, 50.0, 40.0, 30.0, 40.0, 60.0, 30.0, 90.0, 100.0, 120.0, 20.0, 50.0, 20.0, 70.0, 60.0, 20.0, 0.0, 110.0, 40.0, 130.0, 60.0, 100.0, 70.0, 70.0, 50.0, 70.0, 40.0, 37.0, 10.0, 78.0, 0.0, 40.0, 60.0, 80.0, 29.0, 130.0, 80.0, 50.0, 120.0, 60.0, 80.0, -21.0, 27.0, 20.0, 27.0, 90.0, 50.0, 80.0, 30.0, 40.0, 0.0, 50.0, 90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0, 2.0, 40.0, 40.0, 90.0, 50.0, 77.0, 20.0, 70.0, 110.0, 110.0, -38.0, 4.0, 30.0, 90.0, 100.0, 8.0, 40.0, 70.0, 30.0, -2.0, 150.0, 110.0, 30.0, 32.0, 90.0, 40.0, 50.0, 10.0, 110.0, 70.0, 10.0, 0.0, 3.0, 28.0, 49.0, 68.0, 102.0, 78.0, 70.0, 60.0, 20.0, 20.0, 50.0, 50.0, 38.0, 70.0, 48.0, 80.0, 80.0, 50.0, 97.0, 60.0, 110.0, 30.0, 48.0, 40.0, 50.0, 60.0, 30.0, 40.0, 20.0, 70.0, 70.0, 30.0, 19.0, 30.0, 70.0, 40.0, 110.0, 20.0, 40.0, 54.0, 40.0, 30.0, 0.0, 80.0, 120.0, 80.0, 73.0, 40.0, 29.0, 80.0, 80.0, 50.0, -2.0, 110.0, 57.0, 90.0, 100.0, 70.0, 70.0, 19.0, -2.0, 110.0, 130.0, 30.0, 50.0, 30.0, 70.0, 60.0, 9.0, 120.0, 30.0, 50.0, 10.0, -6.0, 6.0, 10.0, 40.0, 20.0, 15.0, 29.0, 110.0, -18.0, 68.0, 60.0, 50.0, 120.0, 10.0, 100.0, 80.0, 60.0, 60.0, 60.0, 120.0, 41.0, 30.0, 74.0, 90.0, 20.0, 30.0, 20.0, 90.0, 110.0, 40.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 30.0, 40.0, 39.0, 60.0, 20.0, 40.0, 100.0, 50.0, 40.0, 50.0, 60.0, 0.0, 30.0, 10.0, 50.0, 70.0, 50.0, 120.0, 40.0, 40.0, 50.0, 30.0, 12.0, 110.0, 20.0, 30.0, 100.0, 80.0, 50.0, 20.0, 5.0, 58.0, 20.0, 100.0, 20.0, 120.0, 50.0, 50.0, 80.0, 30.0, 50.0, 10.0, 50.0, 30.0, 20.0, 70.0, 10.0, 40.0, 150.0, 50.0, 10.0, 40.0, 110.0, 100.0, 40.0, 20.0, 20.0, 30.0, 50.0, 17.0, 42.0, 40.0, 10.0, 80.0, 40.0, 10.0, 80.0, 20.0, 30.0, 20.0, 50.0, 39.0, 0.0, 50.0, 50.0, 30.0, 30.0, 60.0, 40.0, 60.0, 30.0, 140.0, 70.0, 0.0, 90.0, 60.0, 40.0, 94.0, 50.0, 60.0, 20.0, 50.0, 30.0, 70.0, 40.0, 40.0, 47.0, 49.0, 56.0, 23.0, 140.0, 50.0, 50.0, 40.0, -22.0, 47.0, 110.0, 50.0, 50.0, 20.0, 10.0, 60.0, 50.0, 34.0, 20.0, 35.0, 70.0, 60.0, 0.0, 50.0, 70.0, 20.0, 50.0, -7.0, 30.0, 40.0, 17.0, 26.0, 10.0, 20.0, 10.0, 30.0, 70.0, 60.0, 60.0, 40.0, 90.0, 0.0, 70.0, 50.0, 50.0, 40.0, 0.0, 60.0, 80.0, 40.0, 60.0, 0.0, 10.0, 26.0, 40.0, -1.0, 38.0, 20.0, 70.0, 59.0, 8.0, 110.0, 20.0, 10.0, 80.0, 60.0, 80.0, 40.0, 120.0, 80.0, 40.0, 40.0, 40.0, 40.0, 60.0, 30.0, 15.0, 60.0, 30.0, 160.0, 40.0, 80.0, 50.0, 60.0, 40.0, 80.0, 40.0, 50.0, 10.0, 80.0, 50.0, 80.0, 90.0, 50.0, 30.0, 20.0, 40.0, 89.0, 40.0, 20.0, 80.0, 40.0, 20.0, 40.0, 20.0, 40.0, 20.0, 30.0, 100.0, 110.0, 100.0, 70.0, 70.0, 80.0, 50.0, 80.0, 12.0, 100.0, 20.0, 30.0, 20.0, 80.0, 47.0, 40.0, 50.0, 60.0, 130.0, 60.0, 70.0, 80.0, 10.0, 110.0, 20.0, 80.0, 90.0, 70.0, 90.0, 80.0, 60.0, 90.0, 17.0, 0.0, 2.0, -39.0, 28.0, -1.0, 50.0, 70.0, 90.0, 50.0, 43.0, 50.0, 100.0, 50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0, 40.0, 20.0, 18.0, 80.0, 70.0, 39.0, 10.0, 50.0, 10.0, 100.0, 90.0, 50.0, 110.0, 60.0, 49.0, 60.0, 80.0, -12.0, -9.0, 120.0, 40.0, -13.0, 68.0, -7.0, 90.0, 100.0, 40.0, 30.0, 50.0, 30.0, 60.0, 0.0, 50.0, 40.0, 60.0, 70.0, 26.0, -19.0, 50.0, 27.0, 50.0, 50.0, 15.0, 40.0, 129.0, 0.0, 40.0, 90.0, 90.0, 60.0, 70.0, 30.0, 160.0, 50.0, 40.0, 40.0, 30.0, 20.0, 60.0, 50.0, 30.0, 23.0, 100.0, 60.0, 100.0, 19.0, 4.0, 19.0, 90.0, 70.0, 15.0, 60.0, 37.0, 90.0, 40.0, 90.0, 100.0, 40.0, 48.0, 24.0, 70.0, 150.0, 10.0, 5.0, 50.0, -15.0, 40.0, 50.0, 40.0, 70.0, 70.0, 20.0, 36.0, 60.0, 60.0, -40.0, 28.0, 170.0, 30.0, 100.0, 10.0, 120.0, 30.0, 60.0, 60.0, 90.0, 58.0, 130.0, 80.0, 70.0, 10.0, 50.0, 55.0, 80.0, 40.0, 80.0, 40.0, 10.0, 60.0, 50.0, 22.0, 20.0, 60.0, -8.0, 48.0, 50.0, 50.0, 40.0, 50.0, 20.0, 40.0, 30.0, 100.0, 160.0, 30.0, 120.0, 5.0, 20.0, 20.0, 40.0, 80.0, 50.0, 90.0, 100.0, 61.0, 30.0, 55.0, 50.0, 50.0, 100.0, 60.0, 34.0, 10.0, 24.0, 140.0, 180.0, 89.0, 18.0, 100.0, 100.0, 80.0, 40.0, 40.0, 80.0, 80.0, 20.0, 150.0, 80.0, 60.0, 80.0, 70.0, 48.0, 17.0, 20.0, 40.0, 36.0, 40.0, 30.0, 49.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5744349790579668, "mean_inference_ms": 1.5959190831722276, "mean_action_processing_ms": 0.5047653636906027, "mean_env_wait_ms": 1.392036924408506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016260147094726562, "StateBufferConnector_ms": 0.00931239128112793, "ViewRequirementAgentConnector_ms": 0.3815031051635742}, "num_episodes": 18, "episode_return_max": 764.0, "episode_return_min": 67.0, "episode_return_mean": 509.92}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.634412822818707, "num_env_steps_trained_throughput_per_sec": 21.634412822818707, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 185423.827, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185423.781, "sample_time_ms": 2422.19, "learn_time_ms": 182981.685, "learn_throughput": 21.86, "synch_weights_time_ms": 11.811}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "a22d3_00000", "date": "2024-08-06_03-22-33", "timestamp": 1722928953, "time_this_iter_s": 184.89833402633667, "time_total_s": 16744.760436058044, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a015d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16744.760436058044, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.315708812260535, "ram_util_percent": 78.46819923371648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.077189181013483, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.947858519142809, "policy_loss": -0.011114218336489365, "vf_loss": 5.957356694458138, "vf_explained_var": 0.018496694979957116, "kl": 0.008080216630564702, "entropy": 0.6307731879627108, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 773.0, "episode_reward_min": 182.0, "episode_reward_mean": 510.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 180.0}, "policy_reward_mean": {"policy_0": 51.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.0, 518.0, 633.0, 407.0, 764.0, 410.0, 390.0, 379.0, 459.0, 456.0, 755.0, 560.0, 600.0, 580.0, 610.0, 465.0, 668.0, 414.0, 721.0, 609.0, 332.0, 692.0, 468.0, 506.0, 565.0, 479.0, 557.0, 664.0, 567.0, 289.0, 544.0, 635.0, 430.0, 459.0, 480.0, 522.0, 523.0, 460.0, 470.0, 369.0, 369.0, 634.0, 462.0, 538.0, 359.0, 306.0, 450.0, 390.0, 390.0, 590.0, 565.0, 580.0, 429.0, 600.0, 519.0, 630.0, 579.0, 441.0, 350.0, 437.0, 598.0, 428.0, 364.0, 564.0, 550.0, 515.0, 544.0, 470.0, 534.0, 708.0, 475.0, 352.0, 565.0, 666.0, 755.0, 710.0, 370.0, 773.0, 336.0, 592.0, 611.0, 182.0, 387.0, 364.0, 610.0, 446.0, 572.0, 683.0, 280.0, 657.0, 370.0, 500.0, 524.0, 564.0, 421.0, 560.0, 602.0, 427.0, 359.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 70.0, 70.0, 80.0, 10.0, 100.0, 30.0, 0.0, 40.0, 50.0, 90.0, 65.0, 50.0, 60.0, 80.0, -12.0, 10.0, 60.0, 35.0, 80.0, 90.0, 65.0, 40.0, 38.0, 80.0, 30.0, 110.0, 90.0, 80.0, 10.0, 80.0, 34.0, -3.0, 20.0, 20.0, 10.0, 100.0, 17.0, 79.0, 50.0, 72.0, 100.0, 70.0, 110.0, 80.0, 100.0, 62.0, 40.0, 90.0, 40.0, 20.0, 90.0, 30.0, 70.0, 20.0, 70.0, 40.0, 10.0, 20.0, 40.0, 100.0, 30.0, 110.0, 9.0, 16.0, 20.0, 20.0, 35.0, 20.0, 30.0, 26.0, 80.0, 18.0, -3.0, 20.0, 19.0, 40.0, 80.0, 50.0, 49.0, 14.0, 30.0, 70.0, 20.0, 60.0, 30.0, 20.0, 60.0, 50.0, 105.0, 30.0, -11.0, 90.0, 17.0, 20.0, 100.0, 100.0, 50.0, 10.0, 50.0, 90.0, 80.0, 10.0, 80.0, 100.0, 10.0, 45.0, 80.0, 100.0, 160.0, 40.0, 40.0, 70.0, 20.0, 50.0, 60.0, 40.0, 90.0, 80.0, 70.0, 30.0, 100.0, 50.0, 70.0, 50.0, 70.0, 50.0, 60.0, 70.0, 50.0, 40.0, 30.0, 40.0, 60.0, 30.0, 90.0, 100.0, 120.0, 20.0, 50.0, 20.0, 70.0, 60.0, 20.0, 0.0, 110.0, 40.0, 130.0, 60.0, 100.0, 70.0, 70.0, 50.0, 70.0, 40.0, 37.0, 10.0, 78.0, 0.0, 40.0, 60.0, 80.0, 29.0, 130.0, 80.0, 50.0, 120.0, 60.0, 80.0, -21.0, 27.0, 20.0, 27.0, 90.0, 50.0, 80.0, 30.0, 40.0, 0.0, 50.0, 90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0, 2.0, 40.0, 40.0, 90.0, 50.0, 77.0, 20.0, 70.0, 110.0, 110.0, -38.0, 4.0, 30.0, 90.0, 100.0, 8.0, 40.0, 70.0, 30.0, -2.0, 150.0, 110.0, 30.0, 32.0, 90.0, 40.0, 50.0, 10.0, 110.0, 70.0, 10.0, 0.0, 3.0, 28.0, 49.0, 68.0, 102.0, 78.0, 70.0, 60.0, 20.0, 20.0, 50.0, 50.0, 38.0, 70.0, 48.0, 80.0, 80.0, 50.0, 97.0, 60.0, 110.0, 30.0, 48.0, 40.0, 50.0, 60.0, 30.0, 40.0, 20.0, 70.0, 70.0, 30.0, 19.0, 30.0, 70.0, 40.0, 110.0, 20.0, 40.0, 54.0, 40.0, 30.0, 0.0, 80.0, 120.0, 80.0, 73.0, 40.0, 29.0, 80.0, 80.0, 50.0, -2.0, 110.0, 57.0, 90.0, 100.0, 70.0, 70.0, 19.0, -2.0, 110.0, 130.0, 30.0, 50.0, 30.0, 70.0, 60.0, 9.0, 120.0, 30.0, 50.0, 10.0, -6.0, 6.0, 10.0, 40.0, 20.0, 15.0, 29.0, 110.0, -18.0, 68.0, 60.0, 50.0, 120.0, 10.0, 100.0, 80.0, 60.0, 60.0, 60.0, 120.0, 41.0, 30.0, 74.0, 90.0, 20.0, 30.0, 20.0, 90.0, 110.0, 40.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 30.0, 40.0, 39.0, 60.0, 20.0, 40.0, 100.0, 50.0, 40.0, 50.0, 60.0, 0.0, 30.0, 10.0, 50.0, 70.0, 50.0, 120.0, 40.0, 40.0, 50.0, 30.0, 12.0, 110.0, 20.0, 30.0, 100.0, 80.0, 50.0, 20.0, 5.0, 58.0, 20.0, 100.0, 20.0, 120.0, 50.0, 50.0, 80.0, 30.0, 50.0, 10.0, 50.0, 30.0, 20.0, 70.0, 10.0, 40.0, 150.0, 50.0, 10.0, 40.0, 110.0, 100.0, 40.0, 20.0, 20.0, 30.0, 50.0, 17.0, 42.0, 40.0, 10.0, 80.0, 40.0, 10.0, 80.0, 20.0, 30.0, 20.0, 50.0, 39.0, 0.0, 50.0, 50.0, 30.0, 30.0, 60.0, 40.0, 60.0, 30.0, 140.0, 70.0, 0.0, 90.0, 60.0, 40.0, 94.0, 50.0, 60.0, 20.0, 50.0, 30.0, 70.0, 40.0, 40.0, 47.0, 49.0, 56.0, 23.0, 140.0, 50.0, 50.0, 40.0, -22.0, 47.0, 110.0, 50.0, 50.0, 20.0, 10.0, 60.0, 50.0, 34.0, 20.0, 35.0, 70.0, 60.0, 0.0, 50.0, 70.0, 20.0, 50.0, -7.0, 30.0, 40.0, 17.0, 26.0, 10.0, 20.0, 10.0, 30.0, 70.0, 60.0, 60.0, 40.0, 90.0, 0.0, 70.0, 50.0, 50.0, 40.0, 0.0, 60.0, 80.0, 40.0, 60.0, 0.0, 10.0, 26.0, 40.0, -1.0, 38.0, 20.0, 70.0, 59.0, 8.0, 110.0, 20.0, 10.0, 80.0, 60.0, 80.0, 40.0, 120.0, 80.0, 40.0, 40.0, 40.0, 40.0, 60.0, 30.0, 15.0, 60.0, 30.0, 160.0, 40.0, 80.0, 50.0, 60.0, 40.0, 80.0, 40.0, 50.0, 10.0, 80.0, 50.0, 80.0, 90.0, 50.0, 30.0, 20.0, 40.0, 89.0, 40.0, 20.0, 80.0, 40.0, 20.0, 40.0, 20.0, 40.0, 20.0, 30.0, 100.0, 110.0, 100.0, 70.0, 70.0, 80.0, 50.0, 80.0, 12.0, 100.0, 20.0, 30.0, 20.0, 80.0, 47.0, 40.0, 50.0, 60.0, 130.0, 60.0, 70.0, 80.0, 10.0, 110.0, 20.0, 80.0, 90.0, 70.0, 90.0, 80.0, 60.0, 90.0, 17.0, 0.0, 2.0, -39.0, 28.0, -1.0, 50.0, 70.0, 90.0, 50.0, 43.0, 50.0, 100.0, 50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0, 40.0, 20.0, 18.0, 80.0, 70.0, 39.0, 10.0, 50.0, 10.0, 100.0, 90.0, 50.0, 110.0, 60.0, 49.0, 60.0, 80.0, -12.0, -9.0, 120.0, 40.0, -13.0, 68.0, -7.0, 90.0, 100.0, 40.0, 30.0, 50.0, 30.0, 60.0, 0.0, 50.0, 40.0, 60.0, 70.0, 26.0, -19.0, 50.0, 27.0, 50.0, 50.0, 15.0, 40.0, 129.0, 0.0, 40.0, 90.0, 90.0, 60.0, 70.0, 30.0, 160.0, 50.0, 40.0, 40.0, 30.0, 20.0, 60.0, 50.0, 30.0, 23.0, 100.0, 60.0, 100.0, 19.0, 4.0, 19.0, 90.0, 70.0, 15.0, 60.0, 37.0, 90.0, 40.0, 90.0, 100.0, 40.0, 48.0, 24.0, 70.0, 150.0, 10.0, 5.0, 50.0, -15.0, 40.0, 50.0, 40.0, 70.0, 70.0, 20.0, 36.0, 60.0, 60.0, -40.0, 28.0, 170.0, 30.0, 100.0, 10.0, 120.0, 30.0, 60.0, 60.0, 90.0, 58.0, 130.0, 80.0, 70.0, 10.0, 50.0, 55.0, 80.0, 40.0, 80.0, 40.0, 10.0, 60.0, 50.0, 22.0, 20.0, 60.0, -8.0, 48.0, 50.0, 50.0, 40.0, 50.0, 20.0, 40.0, 30.0, 100.0, 160.0, 30.0, 120.0, 5.0, 20.0, 20.0, 40.0, 80.0, 50.0, 90.0, 100.0, 61.0, 30.0, 55.0, 50.0, 50.0, 100.0, 60.0, 34.0, 10.0, 24.0, 140.0, 180.0, 89.0, 18.0, 100.0, 100.0, 80.0, 40.0, 40.0, 80.0, 80.0, 20.0, 150.0, 80.0, 60.0, 80.0, 70.0, 48.0, 17.0, 20.0, 40.0, 36.0, 40.0, 30.0, 49.0, 20.0, 100.0, 70.0, 110.0, 100.0, 78.0, 25.0, 90.0, 40.0, 90.0, 70.0, 20.0, 50.0, 10.0, 90.0, 19.0, 17.0, 20.0, 10.0, 20.0, 80.0, 60.0, 20.0, 90.0, 25.0, 90.0, 56.0, 127.0, 60.0, 14.0, 50.0, 50.0, 80.0, 100.0, 96.0, 40.0, 60.0, 80.0, 15.0, 60.0, 30.0, -29.0, 110.0, 20.0, -50.0, 40.0, 0.0, 30.0, 60.0, 10.0, -9.0, 0.0, 6.0, 40.0, 10.0, 20.0, 31.0, 60.0, 90.0, 70.0, 60.0, 3.0, 19.0, 75.0, 13.0, 20.0, 28.0, 90.0, 70.0, 27.0, 19.0, 30.0, 100.0, 60.0, 100.0, 90.0, 80.0, 20.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 60.0, 60.0, 32.0, 120.0, 20.0, 40.0, 4.0, 50.0, 70.0, 79.0, 80.0, 50.0, -15.0, 60.0, 58.0, 70.0, 70.0, 68.0, 90.0, 80.0, 49.0, 80.0, 30.0, 80.0, 100.0, 26.0, 80.0, 20.0, -65.0, 50.0, 30.0, 10.0, 60.0, 50.0, 120.0, -55.0, 60.0, 50.0, 120.0, 79.0, 30.0, 48.0, 100.0, 60.0, 100.0, 20.0, 50.0, 20.0, 110.0, 30.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 20.0, 50.0, 40.0, 60.0, 70.0, 80.0, 90.0, 40.0, 30.0, 10.0, 30.0, 18.0, 70.0, 35.0, 80.0, 75.0, 68.0, 50.0, 60.0, 90.0, -22.0, 30.0, 50.0, 100.0, 60.0, 12.0, 70.0, 42.0, 40.0, 80.0, 80.0, 40.0, 50.0, 60.0, 20.0, 20.0, 30.0, 45.0, 70.0, 36.0, 50.0, 30.0, 140.0, 50.0, 50.0, 70.0, 50.0, 30.0, 40.0, 10.0, 90.0, 130.0, 36.0, 110.0, 40.0, 40.0, 70.0, 76.0, 10.0, 40.0, 50.0, 54.0, 80.0, 70.0, 40.0, 40.0, 23.0, 50.0, 20.0, 40.0, 10.0, 110.0, 20.0, 30.0, 0.0, 60.0, 20.0, 0.0, 19.0, 20.0, 80.0, 40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5730856542793956, "mean_inference_ms": 1.594475817985883, "mean_action_processing_ms": 0.5057400514774202, "mean_env_wait_ms": 1.390186283979577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017243146896362305, "StateBufferConnector_ms": 0.010761737823486328, "ViewRequirementAgentConnector_ms": 0.39327239990234375}, "num_episodes": 23, "episode_return_max": 773.0, "episode_return_min": 182.0, "episode_return_mean": 510.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.71286270561507, "num_env_steps_trained_throughput_per_sec": 21.71286270561507, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 185296.606, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185296.56, "sample_time_ms": 2446.89, "learn_time_ms": 182829.854, "learn_throughput": 21.878, "synch_weights_time_ms": 11.811}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "a22d3_00000", "date": "2024-08-06_03-25-37", "timestamp": 1722929137, "time_this_iter_s": 184.2326419353485, "time_total_s": 16928.993077993393, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a013d670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16928.993077993393, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 17.33754789272031, "ram_util_percent": 78.49578544061302}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.722934185811125, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011190322485551064, "vf_loss": 6.014513236442948, "vf_explained_var": 0.03291093318607099, "kl": Infinity, "entropy": 0.5948415242540189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 796.0, "episode_reward_min": 182.0, "episode_reward_mean": 522.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -65.0}, "policy_reward_max": {"policy_0": 180.0}, "policy_reward_mean": {"policy_0": 52.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [721.0, 609.0, 332.0, 692.0, 468.0, 506.0, 565.0, 479.0, 557.0, 664.0, 567.0, 289.0, 544.0, 635.0, 430.0, 459.0, 480.0, 522.0, 523.0, 460.0, 470.0, 369.0, 369.0, 634.0, 462.0, 538.0, 359.0, 306.0, 450.0, 390.0, 390.0, 590.0, 565.0, 580.0, 429.0, 600.0, 519.0, 630.0, 579.0, 441.0, 350.0, 437.0, 598.0, 428.0, 364.0, 564.0, 550.0, 515.0, 544.0, 470.0, 534.0, 708.0, 475.0, 352.0, 565.0, 666.0, 755.0, 710.0, 370.0, 773.0, 336.0, 592.0, 611.0, 182.0, 387.0, 364.0, 610.0, 446.0, 572.0, 683.0, 280.0, 657.0, 370.0, 500.0, 524.0, 564.0, 421.0, 560.0, 602.0, 427.0, 359.0, 560.0, 570.0, 690.0, 680.0, 682.0, 795.0, 645.0, 710.0, 796.0, 620.0, 628.0, 446.0, 531.0, 496.0, 440.0, 509.0, 246.0, 611.0, 633.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 120.0, 110.0, 80.0, 50.0, 44.0, 100.0, 119.0, -10.0, 18.0, 2.0, 40.0, 40.0, 90.0, 50.0, 77.0, 20.0, 70.0, 110.0, 110.0, -38.0, 4.0, 30.0, 90.0, 100.0, 8.0, 40.0, 70.0, 30.0, -2.0, 150.0, 110.0, 30.0, 32.0, 90.0, 40.0, 50.0, 10.0, 110.0, 70.0, 10.0, 0.0, 3.0, 28.0, 49.0, 68.0, 102.0, 78.0, 70.0, 60.0, 20.0, 20.0, 50.0, 50.0, 38.0, 70.0, 48.0, 80.0, 80.0, 50.0, 97.0, 60.0, 110.0, 30.0, 48.0, 40.0, 50.0, 60.0, 30.0, 40.0, 20.0, 70.0, 70.0, 30.0, 19.0, 30.0, 70.0, 40.0, 110.0, 20.0, 40.0, 54.0, 40.0, 30.0, 0.0, 80.0, 120.0, 80.0, 73.0, 40.0, 29.0, 80.0, 80.0, 50.0, -2.0, 110.0, 57.0, 90.0, 100.0, 70.0, 70.0, 19.0, -2.0, 110.0, 130.0, 30.0, 50.0, 30.0, 70.0, 60.0, 9.0, 120.0, 30.0, 50.0, 10.0, -6.0, 6.0, 10.0, 40.0, 20.0, 15.0, 29.0, 110.0, -18.0, 68.0, 60.0, 50.0, 120.0, 10.0, 100.0, 80.0, 60.0, 60.0, 60.0, 120.0, 41.0, 30.0, 74.0, 90.0, 20.0, 30.0, 20.0, 90.0, 110.0, 40.0, 20.0, 0.0, 40.0, 30.0, 50.0, 40.0, 30.0, 40.0, 39.0, 60.0, 20.0, 40.0, 100.0, 50.0, 40.0, 50.0, 60.0, 0.0, 30.0, 10.0, 50.0, 70.0, 50.0, 120.0, 40.0, 40.0, 50.0, 30.0, 12.0, 110.0, 20.0, 30.0, 100.0, 80.0, 50.0, 20.0, 5.0, 58.0, 20.0, 100.0, 20.0, 120.0, 50.0, 50.0, 80.0, 30.0, 50.0, 10.0, 50.0, 30.0, 20.0, 70.0, 10.0, 40.0, 150.0, 50.0, 10.0, 40.0, 110.0, 100.0, 40.0, 20.0, 20.0, 30.0, 50.0, 17.0, 42.0, 40.0, 10.0, 80.0, 40.0, 10.0, 80.0, 20.0, 30.0, 20.0, 50.0, 39.0, 0.0, 50.0, 50.0, 30.0, 30.0, 60.0, 40.0, 60.0, 30.0, 140.0, 70.0, 0.0, 90.0, 60.0, 40.0, 94.0, 50.0, 60.0, 20.0, 50.0, 30.0, 70.0, 40.0, 40.0, 47.0, 49.0, 56.0, 23.0, 140.0, 50.0, 50.0, 40.0, -22.0, 47.0, 110.0, 50.0, 50.0, 20.0, 10.0, 60.0, 50.0, 34.0, 20.0, 35.0, 70.0, 60.0, 0.0, 50.0, 70.0, 20.0, 50.0, -7.0, 30.0, 40.0, 17.0, 26.0, 10.0, 20.0, 10.0, 30.0, 70.0, 60.0, 60.0, 40.0, 90.0, 0.0, 70.0, 50.0, 50.0, 40.0, 0.0, 60.0, 80.0, 40.0, 60.0, 0.0, 10.0, 26.0, 40.0, -1.0, 38.0, 20.0, 70.0, 59.0, 8.0, 110.0, 20.0, 10.0, 80.0, 60.0, 80.0, 40.0, 120.0, 80.0, 40.0, 40.0, 40.0, 40.0, 60.0, 30.0, 15.0, 60.0, 30.0, 160.0, 40.0, 80.0, 50.0, 60.0, 40.0, 80.0, 40.0, 50.0, 10.0, 80.0, 50.0, 80.0, 90.0, 50.0, 30.0, 20.0, 40.0, 89.0, 40.0, 20.0, 80.0, 40.0, 20.0, 40.0, 20.0, 40.0, 20.0, 30.0, 100.0, 110.0, 100.0, 70.0, 70.0, 80.0, 50.0, 80.0, 12.0, 100.0, 20.0, 30.0, 20.0, 80.0, 47.0, 40.0, 50.0, 60.0, 130.0, 60.0, 70.0, 80.0, 10.0, 110.0, 20.0, 80.0, 90.0, 70.0, 90.0, 80.0, 60.0, 90.0, 17.0, 0.0, 2.0, -39.0, 28.0, -1.0, 50.0, 70.0, 90.0, 50.0, 43.0, 50.0, 100.0, 50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0, 40.0, 20.0, 18.0, 80.0, 70.0, 39.0, 10.0, 50.0, 10.0, 100.0, 90.0, 50.0, 110.0, 60.0, 49.0, 60.0, 80.0, -12.0, -9.0, 120.0, 40.0, -13.0, 68.0, -7.0, 90.0, 100.0, 40.0, 30.0, 50.0, 30.0, 60.0, 0.0, 50.0, 40.0, 60.0, 70.0, 26.0, -19.0, 50.0, 27.0, 50.0, 50.0, 15.0, 40.0, 129.0, 0.0, 40.0, 90.0, 90.0, 60.0, 70.0, 30.0, 160.0, 50.0, 40.0, 40.0, 30.0, 20.0, 60.0, 50.0, 30.0, 23.0, 100.0, 60.0, 100.0, 19.0, 4.0, 19.0, 90.0, 70.0, 15.0, 60.0, 37.0, 90.0, 40.0, 90.0, 100.0, 40.0, 48.0, 24.0, 70.0, 150.0, 10.0, 5.0, 50.0, -15.0, 40.0, 50.0, 40.0, 70.0, 70.0, 20.0, 36.0, 60.0, 60.0, -40.0, 28.0, 170.0, 30.0, 100.0, 10.0, 120.0, 30.0, 60.0, 60.0, 90.0, 58.0, 130.0, 80.0, 70.0, 10.0, 50.0, 55.0, 80.0, 40.0, 80.0, 40.0, 10.0, 60.0, 50.0, 22.0, 20.0, 60.0, -8.0, 48.0, 50.0, 50.0, 40.0, 50.0, 20.0, 40.0, 30.0, 100.0, 160.0, 30.0, 120.0, 5.0, 20.0, 20.0, 40.0, 80.0, 50.0, 90.0, 100.0, 61.0, 30.0, 55.0, 50.0, 50.0, 100.0, 60.0, 34.0, 10.0, 24.0, 140.0, 180.0, 89.0, 18.0, 100.0, 100.0, 80.0, 40.0, 40.0, 80.0, 80.0, 20.0, 150.0, 80.0, 60.0, 80.0, 70.0, 48.0, 17.0, 20.0, 40.0, 36.0, 40.0, 30.0, 49.0, 20.0, 100.0, 70.0, 110.0, 100.0, 78.0, 25.0, 90.0, 40.0, 90.0, 70.0, 20.0, 50.0, 10.0, 90.0, 19.0, 17.0, 20.0, 10.0, 20.0, 80.0, 60.0, 20.0, 90.0, 25.0, 90.0, 56.0, 127.0, 60.0, 14.0, 50.0, 50.0, 80.0, 100.0, 96.0, 40.0, 60.0, 80.0, 15.0, 60.0, 30.0, -29.0, 110.0, 20.0, -50.0, 40.0, 0.0, 30.0, 60.0, 10.0, -9.0, 0.0, 6.0, 40.0, 10.0, 20.0, 31.0, 60.0, 90.0, 70.0, 60.0, 3.0, 19.0, 75.0, 13.0, 20.0, 28.0, 90.0, 70.0, 27.0, 19.0, 30.0, 100.0, 60.0, 100.0, 90.0, 80.0, 20.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 60.0, 60.0, 32.0, 120.0, 20.0, 40.0, 4.0, 50.0, 70.0, 79.0, 80.0, 50.0, -15.0, 60.0, 58.0, 70.0, 70.0, 68.0, 90.0, 80.0, 49.0, 80.0, 30.0, 80.0, 100.0, 26.0, 80.0, 20.0, -65.0, 50.0, 30.0, 10.0, 60.0, 50.0, 120.0, -55.0, 60.0, 50.0, 120.0, 79.0, 30.0, 48.0, 100.0, 60.0, 100.0, 20.0, 50.0, 20.0, 110.0, 30.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 20.0, 50.0, 40.0, 60.0, 70.0, 80.0, 90.0, 40.0, 30.0, 10.0, 30.0, 18.0, 70.0, 35.0, 80.0, 75.0, 68.0, 50.0, 60.0, 90.0, -22.0, 30.0, 50.0, 100.0, 60.0, 12.0, 70.0, 42.0, 40.0, 80.0, 80.0, 40.0, 50.0, 60.0, 20.0, 20.0, 30.0, 45.0, 70.0, 36.0, 50.0, 30.0, 140.0, 50.0, 50.0, 70.0, 50.0, 30.0, 40.0, 10.0, 90.0, 130.0, 36.0, 110.0, 40.0, 40.0, 70.0, 76.0, 10.0, 40.0, 50.0, 54.0, 80.0, 70.0, 40.0, 40.0, 23.0, 50.0, 20.0, 40.0, 10.0, 110.0, 20.0, 30.0, 0.0, 60.0, 20.0, 0.0, 19.0, 20.0, 80.0, 40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0, 90.0, 20.0, 80.0, 30.0, 60.0, 50.0, 50.0, 50.0, 90.0, 50.0, 10.0, 80.0, -10.0, 50.0, 100.0, 130.0, 60.0, 100.0, 50.0, 120.0, 60.0, 70.0, 90.0, 60.0, 60.0, 110.0, 30.0, 110.0, 30.0, 60.0, 100.0, 20.0, 130.0, 54.0, 18.0, 40.0, 110.0, 40.0, 80.0, 90.0, 25.0, 130.0, 100.0, 130.0, 30.0, 70.0, 60.0, 90.0, 30.0, 130.0, 70.0, 80.0, 60.0, 40.0, 60.0, 80.0, 110.0, 0.0, 25.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 80.0, 50.0, 70.0, 110.0, 70.0, 70.0, 110.0, 69.0, 80.0, 50.0, 50.0, 50.0, 160.0, 47.0, 110.0, 60.0, 50.0, 70.0, 50.0, 70.0, 130.0, 50.0, 70.0, 50.0, 20.0, 60.0, 90.0, 60.0, 18.0, 120.0, 65.0, 75.0, 30.0, 50.0, 60.0, -1.0, 110.0, 50.0, 29.0, 20.0, 63.0, 30.0, 60.0, 15.0, 70.0, 100.0, 90.0, 10.0, 68.0, 24.0, 40.0, 60.0, 40.0, 29.0, 70.0, -22.0, 47.0, 50.0, 50.0, 54.0, 130.0, 70.0, 17.0, 80.0, 20.0, 10.0, 60.0, 20.0, 10.0, 50.0, 70.0, 10.0, 50.0, 70.0, 90.0, 60.0, 20.0, 0.0, 50.0, 60.0, 40.0, 40.0, 80.0, 120.0, 39.0, 20.0, 0.0, 60.0, 30.0, 30.0, 0.0, 36.0, 20.0, 10.0, 40.0, 20.0, 38.0, 80.0, 90.0, 60.0, 50.0, 148.0, 5.0, 60.0, 60.0, 50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.571790493541443, "mean_inference_ms": 1.5930812285639606, "mean_action_processing_ms": 0.5051260655165316, "mean_env_wait_ms": 1.3887659125256595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017187833786010742, "StateBufferConnector_ms": 0.01075291633605957, "ViewRequirementAgentConnector_ms": 0.39345431327819824}, "num_episodes": 18, "episode_return_max": 796.0, "episode_return_min": 182.0, "episode_return_mean": 522.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.801393674709516, "num_env_steps_trained_throughput_per_sec": 21.801393674709516, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 185051.852, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185051.806, "sample_time_ms": 2441.939, "learn_time_ms": 182590.123, "learn_throughput": 21.907, "synch_weights_time_ms": 11.802}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "a22d3_00000", "date": "2024-08-06_03-28-41", "timestamp": 1722929321, "time_this_iter_s": 183.4839050769806, "time_total_s": 17112.476983070374, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20a0ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17112.476983070374, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 16.827027027027025, "ram_util_percent": 78.53513513513514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.904952075407782, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.7464972877400875, "policy_loss": -0.010650754760885343, "vf_loss": 5.7550416772231, "vf_explained_var": 0.026429257415734923, "kl": 0.007021250340516624, "entropy": 0.6178673637655977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 830.0, "episode_reward_min": 182.0, "episode_reward_mean": 530.13, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 180.0}, "policy_reward_mean": {"policy_0": 53.013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.0, 634.0, 462.0, 538.0, 359.0, 306.0, 450.0, 390.0, 390.0, 590.0, 565.0, 580.0, 429.0, 600.0, 519.0, 630.0, 579.0, 441.0, 350.0, 437.0, 598.0, 428.0, 364.0, 564.0, 550.0, 515.0, 544.0, 470.0, 534.0, 708.0, 475.0, 352.0, 565.0, 666.0, 755.0, 710.0, 370.0, 773.0, 336.0, 592.0, 611.0, 182.0, 387.0, 364.0, 610.0, 446.0, 572.0, 683.0, 280.0, 657.0, 370.0, 500.0, 524.0, 564.0, 421.0, 560.0, 602.0, 427.0, 359.0, 560.0, 570.0, 690.0, 680.0, 682.0, 795.0, 645.0, 710.0, 796.0, 620.0, 628.0, 446.0, 531.0, 496.0, 440.0, 509.0, 246.0, 611.0, 633.0, 500.0, 495.0, 552.0, 540.0, 280.0, 635.0, 630.0, 400.0, 621.0, 326.0, 770.0, 420.0, 530.0, 716.0, 400.0, 550.0, 830.0, 789.0, 588.0, 243.0, 633.0, 671.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 50.0, 39.0, 0.0, 50.0, 50.0, 30.0, 30.0, 60.0, 40.0, 60.0, 30.0, 140.0, 70.0, 0.0, 90.0, 60.0, 40.0, 94.0, 50.0, 60.0, 20.0, 50.0, 30.0, 70.0, 40.0, 40.0, 47.0, 49.0, 56.0, 23.0, 140.0, 50.0, 50.0, 40.0, -22.0, 47.0, 110.0, 50.0, 50.0, 20.0, 10.0, 60.0, 50.0, 34.0, 20.0, 35.0, 70.0, 60.0, 0.0, 50.0, 70.0, 20.0, 50.0, -7.0, 30.0, 40.0, 17.0, 26.0, 10.0, 20.0, 10.0, 30.0, 70.0, 60.0, 60.0, 40.0, 90.0, 0.0, 70.0, 50.0, 50.0, 40.0, 0.0, 60.0, 80.0, 40.0, 60.0, 0.0, 10.0, 26.0, 40.0, -1.0, 38.0, 20.0, 70.0, 59.0, 8.0, 110.0, 20.0, 10.0, 80.0, 60.0, 80.0, 40.0, 120.0, 80.0, 40.0, 40.0, 40.0, 40.0, 60.0, 30.0, 15.0, 60.0, 30.0, 160.0, 40.0, 80.0, 50.0, 60.0, 40.0, 80.0, 40.0, 50.0, 10.0, 80.0, 50.0, 80.0, 90.0, 50.0, 30.0, 20.0, 40.0, 89.0, 40.0, 20.0, 80.0, 40.0, 20.0, 40.0, 20.0, 40.0, 20.0, 30.0, 100.0, 110.0, 100.0, 70.0, 70.0, 80.0, 50.0, 80.0, 12.0, 100.0, 20.0, 30.0, 20.0, 80.0, 47.0, 40.0, 50.0, 60.0, 130.0, 60.0, 70.0, 80.0, 10.0, 110.0, 20.0, 80.0, 90.0, 70.0, 90.0, 80.0, 60.0, 90.0, 17.0, 0.0, 2.0, -39.0, 28.0, -1.0, 50.0, 70.0, 90.0, 50.0, 43.0, 50.0, 100.0, 50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0, 40.0, 20.0, 18.0, 80.0, 70.0, 39.0, 10.0, 50.0, 10.0, 100.0, 90.0, 50.0, 110.0, 60.0, 49.0, 60.0, 80.0, -12.0, -9.0, 120.0, 40.0, -13.0, 68.0, -7.0, 90.0, 100.0, 40.0, 30.0, 50.0, 30.0, 60.0, 0.0, 50.0, 40.0, 60.0, 70.0, 26.0, -19.0, 50.0, 27.0, 50.0, 50.0, 15.0, 40.0, 129.0, 0.0, 40.0, 90.0, 90.0, 60.0, 70.0, 30.0, 160.0, 50.0, 40.0, 40.0, 30.0, 20.0, 60.0, 50.0, 30.0, 23.0, 100.0, 60.0, 100.0, 19.0, 4.0, 19.0, 90.0, 70.0, 15.0, 60.0, 37.0, 90.0, 40.0, 90.0, 100.0, 40.0, 48.0, 24.0, 70.0, 150.0, 10.0, 5.0, 50.0, -15.0, 40.0, 50.0, 40.0, 70.0, 70.0, 20.0, 36.0, 60.0, 60.0, -40.0, 28.0, 170.0, 30.0, 100.0, 10.0, 120.0, 30.0, 60.0, 60.0, 90.0, 58.0, 130.0, 80.0, 70.0, 10.0, 50.0, 55.0, 80.0, 40.0, 80.0, 40.0, 10.0, 60.0, 50.0, 22.0, 20.0, 60.0, -8.0, 48.0, 50.0, 50.0, 40.0, 50.0, 20.0, 40.0, 30.0, 100.0, 160.0, 30.0, 120.0, 5.0, 20.0, 20.0, 40.0, 80.0, 50.0, 90.0, 100.0, 61.0, 30.0, 55.0, 50.0, 50.0, 100.0, 60.0, 34.0, 10.0, 24.0, 140.0, 180.0, 89.0, 18.0, 100.0, 100.0, 80.0, 40.0, 40.0, 80.0, 80.0, 20.0, 150.0, 80.0, 60.0, 80.0, 70.0, 48.0, 17.0, 20.0, 40.0, 36.0, 40.0, 30.0, 49.0, 20.0, 100.0, 70.0, 110.0, 100.0, 78.0, 25.0, 90.0, 40.0, 90.0, 70.0, 20.0, 50.0, 10.0, 90.0, 19.0, 17.0, 20.0, 10.0, 20.0, 80.0, 60.0, 20.0, 90.0, 25.0, 90.0, 56.0, 127.0, 60.0, 14.0, 50.0, 50.0, 80.0, 100.0, 96.0, 40.0, 60.0, 80.0, 15.0, 60.0, 30.0, -29.0, 110.0, 20.0, -50.0, 40.0, 0.0, 30.0, 60.0, 10.0, -9.0, 0.0, 6.0, 40.0, 10.0, 20.0, 31.0, 60.0, 90.0, 70.0, 60.0, 3.0, 19.0, 75.0, 13.0, 20.0, 28.0, 90.0, 70.0, 27.0, 19.0, 30.0, 100.0, 60.0, 100.0, 90.0, 80.0, 20.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 60.0, 60.0, 32.0, 120.0, 20.0, 40.0, 4.0, 50.0, 70.0, 79.0, 80.0, 50.0, -15.0, 60.0, 58.0, 70.0, 70.0, 68.0, 90.0, 80.0, 49.0, 80.0, 30.0, 80.0, 100.0, 26.0, 80.0, 20.0, -65.0, 50.0, 30.0, 10.0, 60.0, 50.0, 120.0, -55.0, 60.0, 50.0, 120.0, 79.0, 30.0, 48.0, 100.0, 60.0, 100.0, 20.0, 50.0, 20.0, 110.0, 30.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 20.0, 50.0, 40.0, 60.0, 70.0, 80.0, 90.0, 40.0, 30.0, 10.0, 30.0, 18.0, 70.0, 35.0, 80.0, 75.0, 68.0, 50.0, 60.0, 90.0, -22.0, 30.0, 50.0, 100.0, 60.0, 12.0, 70.0, 42.0, 40.0, 80.0, 80.0, 40.0, 50.0, 60.0, 20.0, 20.0, 30.0, 45.0, 70.0, 36.0, 50.0, 30.0, 140.0, 50.0, 50.0, 70.0, 50.0, 30.0, 40.0, 10.0, 90.0, 130.0, 36.0, 110.0, 40.0, 40.0, 70.0, 76.0, 10.0, 40.0, 50.0, 54.0, 80.0, 70.0, 40.0, 40.0, 23.0, 50.0, 20.0, 40.0, 10.0, 110.0, 20.0, 30.0, 0.0, 60.0, 20.0, 0.0, 19.0, 20.0, 80.0, 40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0, 90.0, 20.0, 80.0, 30.0, 60.0, 50.0, 50.0, 50.0, 90.0, 50.0, 10.0, 80.0, -10.0, 50.0, 100.0, 130.0, 60.0, 100.0, 50.0, 120.0, 60.0, 70.0, 90.0, 60.0, 60.0, 110.0, 30.0, 110.0, 30.0, 60.0, 100.0, 20.0, 130.0, 54.0, 18.0, 40.0, 110.0, 40.0, 80.0, 90.0, 25.0, 130.0, 100.0, 130.0, 30.0, 70.0, 60.0, 90.0, 30.0, 130.0, 70.0, 80.0, 60.0, 40.0, 60.0, 80.0, 110.0, 0.0, 25.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 80.0, 50.0, 70.0, 110.0, 70.0, 70.0, 110.0, 69.0, 80.0, 50.0, 50.0, 50.0, 160.0, 47.0, 110.0, 60.0, 50.0, 70.0, 50.0, 70.0, 130.0, 50.0, 70.0, 50.0, 20.0, 60.0, 90.0, 60.0, 18.0, 120.0, 65.0, 75.0, 30.0, 50.0, 60.0, -1.0, 110.0, 50.0, 29.0, 20.0, 63.0, 30.0, 60.0, 15.0, 70.0, 100.0, 90.0, 10.0, 68.0, 24.0, 40.0, 60.0, 40.0, 29.0, 70.0, -22.0, 47.0, 50.0, 50.0, 54.0, 130.0, 70.0, 17.0, 80.0, 20.0, 10.0, 60.0, 20.0, 10.0, 50.0, 70.0, 10.0, 50.0, 70.0, 90.0, 60.0, 20.0, 0.0, 50.0, 60.0, 40.0, 40.0, 80.0, 120.0, 39.0, 20.0, 0.0, 60.0, 30.0, 30.0, 0.0, 36.0, 20.0, 10.0, 40.0, 20.0, 38.0, 80.0, 90.0, 60.0, 50.0, 148.0, 5.0, 60.0, 60.0, 50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0, 70.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, 70.0, 50.0, 0.0, 48.0, 70.0, 110.0, 70.0, 30.0, 29.0, 50.0, 30.0, 8.0, 50.0, 31.0, 40.0, 18.0, 70.0, 35.0, 58.0, 50.0, 100.0, 80.0, 70.0, 88.0, 80.0, 50.0, 17.0, -9.0, 100.0, 39.0, 80.0, 50.0, 45.0, 10.0, 80.0, 10.0, 20.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 50.0, 20.0, 100.0, 50.0, 60.0, 50.0, 65.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 90.0, 50.0, 40.0, 60.0, 70.0, 60.0, 100.0, 30.0, 90.0, 20.0, 30.0, 50.0, 10.0, 40.0, 60.0, 50.0, 20.0, 56.0, 30.0, 50.0, 50.0, 140.0, 70.0, 120.0, 20.0, 70.0, 15.0, 20.0, 70.0, -1.0, 50.0, 10.0, 9.0, 10.0, 38.0, 60.0, 60.0, 80.0, 70.0, 140.0, 100.0, 66.0, 110.0, 34.0, 80.0, 66.0, 24.0, 70.0, 90.0, 20.0, 20.0, 0.0, 100.0, 40.0, 30.0, 40.0, 10.0, 20.0, 60.0, 100.0, 40.0, 70.0, 0.0, 40.0, 50.0, 50.0, 100.0, 120.0, 24.0, 70.0, 140.0, 70.0, 22.0, 80.0, 80.0, 60.0, 50.0, 20.0, 70.0, 0.0, 90.0, 70.0, -50.0, 50.0, 30.0, 80.0, 40.0, 7.0, 70.0, 70.0, 160.0, 30.0, 60.0, 26.0, 80.0, 7.0, 40.0, 80.0, 90.0, 80.0, 160.0, 120.0, 100.0, 90.0, 40.0, 40.0, 30.0, 60.0, 72.0, 100.0, 50.0, 50.0, 70.0, 110.0, 130.0, 50.0, 97.0, 80.0, 50.0, 5.0, 90.0, 53.0, 60.0, 80.0, 100.0, 20.0, 50.0, -4.0, 28.0, -20.0, 30.0, 50.0, 60.0, 38.0, -85.0, 36.0, 110.0, 70.0, 80.0, 60.0, 90.0, 20.0, 23.0, 100.0, 40.0, 90.0, 60.0, 47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5696524327389954, "mean_inference_ms": 1.590700190178899, "mean_action_processing_ms": 0.504180361204898, "mean_env_wait_ms": 1.387072053227388, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0172269344329834, "StateBufferConnector_ms": 0.010740518569946289, "ViewRequirementAgentConnector_ms": 0.39318275451660156}, "num_episodes": 22, "episode_return_max": 830.0, "episode_return_min": 182.0, "episode_return_mean": 530.13}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5643945075864, "num_env_steps_trained_throughput_per_sec": 21.5643945075864, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 185014.923, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185014.877, "sample_time_ms": 2455.388, "learn_time_ms": 182539.907, "learn_throughput": 21.913, "synch_weights_time_ms": 11.611}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "a22d3_00000", "date": "2024-08-06_03-31-46", "timestamp": 1722929506, "time_this_iter_s": 185.50308394432068, "time_total_s": 17297.980067014694, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17297.980067014694, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 18.26768060836502, "ram_util_percent": 78.5041825095057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8647324701086783, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.662863287935877, "policy_loss": -0.010170808411029755, "vf_loss": 5.670919999984887, "vf_explained_var": 0.006923908991808582, "kl": 0.007046980362479386, "entropy": 0.6499450414960249, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 830.0, "episode_reward_min": 182.0, "episode_reward_mean": 533.09, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 180.0}, "policy_reward_mean": {"policy_0": 53.309}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 437.0, 598.0, 428.0, 364.0, 564.0, 550.0, 515.0, 544.0, 470.0, 534.0, 708.0, 475.0, 352.0, 565.0, 666.0, 755.0, 710.0, 370.0, 773.0, 336.0, 592.0, 611.0, 182.0, 387.0, 364.0, 610.0, 446.0, 572.0, 683.0, 280.0, 657.0, 370.0, 500.0, 524.0, 564.0, 421.0, 560.0, 602.0, 427.0, 359.0, 560.0, 570.0, 690.0, 680.0, 682.0, 795.0, 645.0, 710.0, 796.0, 620.0, 628.0, 446.0, 531.0, 496.0, 440.0, 509.0, 246.0, 611.0, 633.0, 500.0, 495.0, 552.0, 540.0, 280.0, 635.0, 630.0, 400.0, 621.0, 326.0, 770.0, 420.0, 530.0, 716.0, 400.0, 550.0, 830.0, 789.0, 588.0, 243.0, 633.0, 671.0, 503.0, 271.0, 519.0, 430.0, 790.0, 465.0, 480.0, 372.0, 524.0, 521.0, 363.0, 680.0, 312.0, 555.0, 500.0, 532.0, 700.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 8.0, 17.0, 54.0, 80.0, 34.0, 40.0, 30.0, 17.0, 20.0, 40.0, 20.0, 18.0, 80.0, 70.0, 39.0, 10.0, 50.0, 10.0, 100.0, 90.0, 50.0, 110.0, 60.0, 49.0, 60.0, 80.0, -12.0, -9.0, 120.0, 40.0, -13.0, 68.0, -7.0, 90.0, 100.0, 40.0, 30.0, 50.0, 30.0, 60.0, 0.0, 50.0, 40.0, 60.0, 70.0, 26.0, -19.0, 50.0, 27.0, 50.0, 50.0, 15.0, 40.0, 129.0, 0.0, 40.0, 90.0, 90.0, 60.0, 70.0, 30.0, 160.0, 50.0, 40.0, 40.0, 30.0, 20.0, 60.0, 50.0, 30.0, 23.0, 100.0, 60.0, 100.0, 19.0, 4.0, 19.0, 90.0, 70.0, 15.0, 60.0, 37.0, 90.0, 40.0, 90.0, 100.0, 40.0, 48.0, 24.0, 70.0, 150.0, 10.0, 5.0, 50.0, -15.0, 40.0, 50.0, 40.0, 70.0, 70.0, 20.0, 36.0, 60.0, 60.0, -40.0, 28.0, 170.0, 30.0, 100.0, 10.0, 120.0, 30.0, 60.0, 60.0, 90.0, 58.0, 130.0, 80.0, 70.0, 10.0, 50.0, 55.0, 80.0, 40.0, 80.0, 40.0, 10.0, 60.0, 50.0, 22.0, 20.0, 60.0, -8.0, 48.0, 50.0, 50.0, 40.0, 50.0, 20.0, 40.0, 30.0, 100.0, 160.0, 30.0, 120.0, 5.0, 20.0, 20.0, 40.0, 80.0, 50.0, 90.0, 100.0, 61.0, 30.0, 55.0, 50.0, 50.0, 100.0, 60.0, 34.0, 10.0, 24.0, 140.0, 180.0, 89.0, 18.0, 100.0, 100.0, 80.0, 40.0, 40.0, 80.0, 80.0, 20.0, 150.0, 80.0, 60.0, 80.0, 70.0, 48.0, 17.0, 20.0, 40.0, 36.0, 40.0, 30.0, 49.0, 20.0, 100.0, 70.0, 110.0, 100.0, 78.0, 25.0, 90.0, 40.0, 90.0, 70.0, 20.0, 50.0, 10.0, 90.0, 19.0, 17.0, 20.0, 10.0, 20.0, 80.0, 60.0, 20.0, 90.0, 25.0, 90.0, 56.0, 127.0, 60.0, 14.0, 50.0, 50.0, 80.0, 100.0, 96.0, 40.0, 60.0, 80.0, 15.0, 60.0, 30.0, -29.0, 110.0, 20.0, -50.0, 40.0, 0.0, 30.0, 60.0, 10.0, -9.0, 0.0, 6.0, 40.0, 10.0, 20.0, 31.0, 60.0, 90.0, 70.0, 60.0, 3.0, 19.0, 75.0, 13.0, 20.0, 28.0, 90.0, 70.0, 27.0, 19.0, 30.0, 100.0, 60.0, 100.0, 90.0, 80.0, 20.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 60.0, 60.0, 32.0, 120.0, 20.0, 40.0, 4.0, 50.0, 70.0, 79.0, 80.0, 50.0, -15.0, 60.0, 58.0, 70.0, 70.0, 68.0, 90.0, 80.0, 49.0, 80.0, 30.0, 80.0, 100.0, 26.0, 80.0, 20.0, -65.0, 50.0, 30.0, 10.0, 60.0, 50.0, 120.0, -55.0, 60.0, 50.0, 120.0, 79.0, 30.0, 48.0, 100.0, 60.0, 100.0, 20.0, 50.0, 20.0, 110.0, 30.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 20.0, 50.0, 40.0, 60.0, 70.0, 80.0, 90.0, 40.0, 30.0, 10.0, 30.0, 18.0, 70.0, 35.0, 80.0, 75.0, 68.0, 50.0, 60.0, 90.0, -22.0, 30.0, 50.0, 100.0, 60.0, 12.0, 70.0, 42.0, 40.0, 80.0, 80.0, 40.0, 50.0, 60.0, 20.0, 20.0, 30.0, 45.0, 70.0, 36.0, 50.0, 30.0, 140.0, 50.0, 50.0, 70.0, 50.0, 30.0, 40.0, 10.0, 90.0, 130.0, 36.0, 110.0, 40.0, 40.0, 70.0, 76.0, 10.0, 40.0, 50.0, 54.0, 80.0, 70.0, 40.0, 40.0, 23.0, 50.0, 20.0, 40.0, 10.0, 110.0, 20.0, 30.0, 0.0, 60.0, 20.0, 0.0, 19.0, 20.0, 80.0, 40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0, 90.0, 20.0, 80.0, 30.0, 60.0, 50.0, 50.0, 50.0, 90.0, 50.0, 10.0, 80.0, -10.0, 50.0, 100.0, 130.0, 60.0, 100.0, 50.0, 120.0, 60.0, 70.0, 90.0, 60.0, 60.0, 110.0, 30.0, 110.0, 30.0, 60.0, 100.0, 20.0, 130.0, 54.0, 18.0, 40.0, 110.0, 40.0, 80.0, 90.0, 25.0, 130.0, 100.0, 130.0, 30.0, 70.0, 60.0, 90.0, 30.0, 130.0, 70.0, 80.0, 60.0, 40.0, 60.0, 80.0, 110.0, 0.0, 25.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 80.0, 50.0, 70.0, 110.0, 70.0, 70.0, 110.0, 69.0, 80.0, 50.0, 50.0, 50.0, 160.0, 47.0, 110.0, 60.0, 50.0, 70.0, 50.0, 70.0, 130.0, 50.0, 70.0, 50.0, 20.0, 60.0, 90.0, 60.0, 18.0, 120.0, 65.0, 75.0, 30.0, 50.0, 60.0, -1.0, 110.0, 50.0, 29.0, 20.0, 63.0, 30.0, 60.0, 15.0, 70.0, 100.0, 90.0, 10.0, 68.0, 24.0, 40.0, 60.0, 40.0, 29.0, 70.0, -22.0, 47.0, 50.0, 50.0, 54.0, 130.0, 70.0, 17.0, 80.0, 20.0, 10.0, 60.0, 20.0, 10.0, 50.0, 70.0, 10.0, 50.0, 70.0, 90.0, 60.0, 20.0, 0.0, 50.0, 60.0, 40.0, 40.0, 80.0, 120.0, 39.0, 20.0, 0.0, 60.0, 30.0, 30.0, 0.0, 36.0, 20.0, 10.0, 40.0, 20.0, 38.0, 80.0, 90.0, 60.0, 50.0, 148.0, 5.0, 60.0, 60.0, 50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0, 70.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, 70.0, 50.0, 0.0, 48.0, 70.0, 110.0, 70.0, 30.0, 29.0, 50.0, 30.0, 8.0, 50.0, 31.0, 40.0, 18.0, 70.0, 35.0, 58.0, 50.0, 100.0, 80.0, 70.0, 88.0, 80.0, 50.0, 17.0, -9.0, 100.0, 39.0, 80.0, 50.0, 45.0, 10.0, 80.0, 10.0, 20.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 50.0, 20.0, 100.0, 50.0, 60.0, 50.0, 65.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 90.0, 50.0, 40.0, 60.0, 70.0, 60.0, 100.0, 30.0, 90.0, 20.0, 30.0, 50.0, 10.0, 40.0, 60.0, 50.0, 20.0, 56.0, 30.0, 50.0, 50.0, 140.0, 70.0, 120.0, 20.0, 70.0, 15.0, 20.0, 70.0, -1.0, 50.0, 10.0, 9.0, 10.0, 38.0, 60.0, 60.0, 80.0, 70.0, 140.0, 100.0, 66.0, 110.0, 34.0, 80.0, 66.0, 24.0, 70.0, 90.0, 20.0, 20.0, 0.0, 100.0, 40.0, 30.0, 40.0, 10.0, 20.0, 60.0, 100.0, 40.0, 70.0, 0.0, 40.0, 50.0, 50.0, 100.0, 120.0, 24.0, 70.0, 140.0, 70.0, 22.0, 80.0, 80.0, 60.0, 50.0, 20.0, 70.0, 0.0, 90.0, 70.0, -50.0, 50.0, 30.0, 80.0, 40.0, 7.0, 70.0, 70.0, 160.0, 30.0, 60.0, 26.0, 80.0, 7.0, 40.0, 80.0, 90.0, 80.0, 160.0, 120.0, 100.0, 90.0, 40.0, 40.0, 30.0, 60.0, 72.0, 100.0, 50.0, 50.0, 70.0, 110.0, 130.0, 50.0, 97.0, 80.0, 50.0, 5.0, 90.0, 53.0, 60.0, 80.0, 100.0, 20.0, 50.0, -4.0, 28.0, -20.0, 30.0, 50.0, 60.0, 38.0, -85.0, 36.0, 110.0, 70.0, 80.0, 60.0, 90.0, 20.0, 23.0, 100.0, 40.0, 90.0, 60.0, 47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0, 50.0, 120.0, 28.0, 50.0, 90.0, -25.0, 20.0, 50.0, 60.0, 60.0, 20.0, 17.0, 38.0, 0.0, 70.0, 40.0, 6.0, 20.0, 30.0, 30.0, 29.0, 60.0, 47.0, 40.0, 30.0, 50.0, 60.0, 60.0, 83.0, 60.0, 50.0, 50.0, 30.0, 10.0, 20.0, 40.0, 140.0, 10.0, 20.0, 60.0, 0.0, 90.0, 90.0, 110.0, 140.0, 50.0, 60.0, 110.0, 30.0, 110.0, 50.0, 30.0, 40.0, 80.0, 100.0, 60.0, 20.0, 5.0, 40.0, 40.0, 50.0, 40.0, 70.0, 50.0, 130.0, 50.0, 20.0, 20.0, 20.0, 30.0, 70.0, 40.0, 40.0, 30.0, 11.0, -29.0, 10.0, 40.0, 80.0, 80.0, 10.0, 90.0, 70.0, 40.0, 30.0, 50.0, 80.0, 69.0, 75.0, 10.0, 50.0, 68.0, 30.0, 90.0, 52.0, 61.0, 50.0, 19.0, 50.0, 51.0, 70.0, 5.0, -14.0, -7.0, 80.0, 15.0, 90.0, 60.0, 50.0, 14.0, 90.0, 50.0, 100.0, 20.0, 40.0, 120.0, 70.0, 60.0, 70.0, 60.0, 0.0, 30.0, 30.0, 90.0, 60.0, -10.0, 30.0, 40.0, 12.0, 30.0, 34.0, 15.0, 110.0, 30.0, 30.0, 130.0, 80.0, 36.0, 40.0, 50.0, 80.0, 60.0, 40.0, 20.0, 80.0, 60.0, 28.0, 27.0, 25.0, 80.0, 50.0, 60.0, 70.0, 60.0, 50.0, 50.0, 50.0, 100.0, 2.0, 40.0, 100.0, 40.0, 10.0, 80.0, 130.0, 60.0, 70.0, 30.0, 140.0, 40.0, 10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5687789106626309, "mean_inference_ms": 1.589177654889716, "mean_action_processing_ms": 0.503472713395131, "mean_env_wait_ms": 1.3851262184623874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013048887252807617, "StateBufferConnector_ms": 0.010399818420410156, "ViewRequirementAgentConnector_ms": 0.3875143527984619}, "num_episodes": 18, "episode_return_max": 830.0, "episode_return_min": 182.0, "episode_return_mean": 533.09}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.58088718331342, "num_env_steps_trained_throughput_per_sec": 21.58088718331342, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 184821.923, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184821.876, "sample_time_ms": 2461.887, "learn_time_ms": 182341.572, "learn_throughput": 21.937, "synch_weights_time_ms": 10.532}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "a22d3_00000", "date": "2024-08-06_03-34-52", "timestamp": 1722929692, "time_this_iter_s": 185.36036014556885, "time_total_s": 17483.340427160263, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d23a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17483.340427160263, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 18.749236641221376, "ram_util_percent": 77.5912213740458}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.698488527618912, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.916811762627956, "policy_loss": -0.010745960541904622, "vf_loss": 5.925390911102295, "vf_explained_var": 0.01897549305480128, "kl": 0.00722270616473029, "entropy": 0.6458044657184167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 182.0, "episode_reward_mean": 528.58, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 52.858}, "custom_metrics": {}, "hist_stats": {"episode_reward": [182.0, 387.0, 364.0, 610.0, 446.0, 572.0, 683.0, 280.0, 657.0, 370.0, 500.0, 524.0, 564.0, 421.0, 560.0, 602.0, 427.0, 359.0, 560.0, 570.0, 690.0, 680.0, 682.0, 795.0, 645.0, 710.0, 796.0, 620.0, 628.0, 446.0, 531.0, 496.0, 440.0, 509.0, 246.0, 611.0, 633.0, 500.0, 495.0, 552.0, 540.0, 280.0, 635.0, 630.0, 400.0, 621.0, 326.0, 770.0, 420.0, 530.0, 716.0, 400.0, 550.0, 830.0, 789.0, 588.0, 243.0, 633.0, 671.0, 503.0, 271.0, 519.0, 430.0, 790.0, 465.0, 480.0, 372.0, 524.0, 521.0, 363.0, 680.0, 312.0, 555.0, 500.0, 532.0, 700.0, 610.0, 260.0, 320.0, 320.0, 405.0, 480.0, 633.0, 710.0, 667.0, 365.0, 300.0, 617.0, 395.0, 498.0, 637.0, 524.0, 641.0, 476.0, 296.0, 490.0, 380.0, 830.0, 890.0, 682.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-29.0, 110.0, 20.0, -50.0, 40.0, 0.0, 30.0, 60.0, 10.0, -9.0, 0.0, 6.0, 40.0, 10.0, 20.0, 31.0, 60.0, 90.0, 70.0, 60.0, 3.0, 19.0, 75.0, 13.0, 20.0, 28.0, 90.0, 70.0, 27.0, 19.0, 30.0, 100.0, 60.0, 100.0, 90.0, 80.0, 20.0, 50.0, 30.0, 50.0, 40.0, 20.0, 50.0, 60.0, 60.0, 32.0, 120.0, 20.0, 40.0, 4.0, 50.0, 70.0, 79.0, 80.0, 50.0, -15.0, 60.0, 58.0, 70.0, 70.0, 68.0, 90.0, 80.0, 49.0, 80.0, 30.0, 80.0, 100.0, 26.0, 80.0, 20.0, -65.0, 50.0, 30.0, 10.0, 60.0, 50.0, 120.0, -55.0, 60.0, 50.0, 120.0, 79.0, 30.0, 48.0, 100.0, 60.0, 100.0, 20.0, 50.0, 20.0, 110.0, 30.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 20.0, 50.0, 40.0, 60.0, 70.0, 80.0, 90.0, 40.0, 30.0, 10.0, 30.0, 18.0, 70.0, 35.0, 80.0, 75.0, 68.0, 50.0, 60.0, 90.0, -22.0, 30.0, 50.0, 100.0, 60.0, 12.0, 70.0, 42.0, 40.0, 80.0, 80.0, 40.0, 50.0, 60.0, 20.0, 20.0, 30.0, 45.0, 70.0, 36.0, 50.0, 30.0, 140.0, 50.0, 50.0, 70.0, 50.0, 30.0, 40.0, 10.0, 90.0, 130.0, 36.0, 110.0, 40.0, 40.0, 70.0, 76.0, 10.0, 40.0, 50.0, 54.0, 80.0, 70.0, 40.0, 40.0, 23.0, 50.0, 20.0, 40.0, 10.0, 110.0, 20.0, 30.0, 0.0, 60.0, 20.0, 0.0, 19.0, 20.0, 80.0, 40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0, 90.0, 20.0, 80.0, 30.0, 60.0, 50.0, 50.0, 50.0, 90.0, 50.0, 10.0, 80.0, -10.0, 50.0, 100.0, 130.0, 60.0, 100.0, 50.0, 120.0, 60.0, 70.0, 90.0, 60.0, 60.0, 110.0, 30.0, 110.0, 30.0, 60.0, 100.0, 20.0, 130.0, 54.0, 18.0, 40.0, 110.0, 40.0, 80.0, 90.0, 25.0, 130.0, 100.0, 130.0, 30.0, 70.0, 60.0, 90.0, 30.0, 130.0, 70.0, 80.0, 60.0, 40.0, 60.0, 80.0, 110.0, 0.0, 25.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 80.0, 50.0, 70.0, 110.0, 70.0, 70.0, 110.0, 69.0, 80.0, 50.0, 50.0, 50.0, 160.0, 47.0, 110.0, 60.0, 50.0, 70.0, 50.0, 70.0, 130.0, 50.0, 70.0, 50.0, 20.0, 60.0, 90.0, 60.0, 18.0, 120.0, 65.0, 75.0, 30.0, 50.0, 60.0, -1.0, 110.0, 50.0, 29.0, 20.0, 63.0, 30.0, 60.0, 15.0, 70.0, 100.0, 90.0, 10.0, 68.0, 24.0, 40.0, 60.0, 40.0, 29.0, 70.0, -22.0, 47.0, 50.0, 50.0, 54.0, 130.0, 70.0, 17.0, 80.0, 20.0, 10.0, 60.0, 20.0, 10.0, 50.0, 70.0, 10.0, 50.0, 70.0, 90.0, 60.0, 20.0, 0.0, 50.0, 60.0, 40.0, 40.0, 80.0, 120.0, 39.0, 20.0, 0.0, 60.0, 30.0, 30.0, 0.0, 36.0, 20.0, 10.0, 40.0, 20.0, 38.0, 80.0, 90.0, 60.0, 50.0, 148.0, 5.0, 60.0, 60.0, 50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0, 70.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, 70.0, 50.0, 0.0, 48.0, 70.0, 110.0, 70.0, 30.0, 29.0, 50.0, 30.0, 8.0, 50.0, 31.0, 40.0, 18.0, 70.0, 35.0, 58.0, 50.0, 100.0, 80.0, 70.0, 88.0, 80.0, 50.0, 17.0, -9.0, 100.0, 39.0, 80.0, 50.0, 45.0, 10.0, 80.0, 10.0, 20.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 50.0, 20.0, 100.0, 50.0, 60.0, 50.0, 65.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 90.0, 50.0, 40.0, 60.0, 70.0, 60.0, 100.0, 30.0, 90.0, 20.0, 30.0, 50.0, 10.0, 40.0, 60.0, 50.0, 20.0, 56.0, 30.0, 50.0, 50.0, 140.0, 70.0, 120.0, 20.0, 70.0, 15.0, 20.0, 70.0, -1.0, 50.0, 10.0, 9.0, 10.0, 38.0, 60.0, 60.0, 80.0, 70.0, 140.0, 100.0, 66.0, 110.0, 34.0, 80.0, 66.0, 24.0, 70.0, 90.0, 20.0, 20.0, 0.0, 100.0, 40.0, 30.0, 40.0, 10.0, 20.0, 60.0, 100.0, 40.0, 70.0, 0.0, 40.0, 50.0, 50.0, 100.0, 120.0, 24.0, 70.0, 140.0, 70.0, 22.0, 80.0, 80.0, 60.0, 50.0, 20.0, 70.0, 0.0, 90.0, 70.0, -50.0, 50.0, 30.0, 80.0, 40.0, 7.0, 70.0, 70.0, 160.0, 30.0, 60.0, 26.0, 80.0, 7.0, 40.0, 80.0, 90.0, 80.0, 160.0, 120.0, 100.0, 90.0, 40.0, 40.0, 30.0, 60.0, 72.0, 100.0, 50.0, 50.0, 70.0, 110.0, 130.0, 50.0, 97.0, 80.0, 50.0, 5.0, 90.0, 53.0, 60.0, 80.0, 100.0, 20.0, 50.0, -4.0, 28.0, -20.0, 30.0, 50.0, 60.0, 38.0, -85.0, 36.0, 110.0, 70.0, 80.0, 60.0, 90.0, 20.0, 23.0, 100.0, 40.0, 90.0, 60.0, 47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0, 50.0, 120.0, 28.0, 50.0, 90.0, -25.0, 20.0, 50.0, 60.0, 60.0, 20.0, 17.0, 38.0, 0.0, 70.0, 40.0, 6.0, 20.0, 30.0, 30.0, 29.0, 60.0, 47.0, 40.0, 30.0, 50.0, 60.0, 60.0, 83.0, 60.0, 50.0, 50.0, 30.0, 10.0, 20.0, 40.0, 140.0, 10.0, 20.0, 60.0, 0.0, 90.0, 90.0, 110.0, 140.0, 50.0, 60.0, 110.0, 30.0, 110.0, 50.0, 30.0, 40.0, 80.0, 100.0, 60.0, 20.0, 5.0, 40.0, 40.0, 50.0, 40.0, 70.0, 50.0, 130.0, 50.0, 20.0, 20.0, 20.0, 30.0, 70.0, 40.0, 40.0, 30.0, 11.0, -29.0, 10.0, 40.0, 80.0, 80.0, 10.0, 90.0, 70.0, 40.0, 30.0, 50.0, 80.0, 69.0, 75.0, 10.0, 50.0, 68.0, 30.0, 90.0, 52.0, 61.0, 50.0, 19.0, 50.0, 51.0, 70.0, 5.0, -14.0, -7.0, 80.0, 15.0, 90.0, 60.0, 50.0, 14.0, 90.0, 50.0, 100.0, 20.0, 40.0, 120.0, 70.0, 60.0, 70.0, 60.0, 0.0, 30.0, 30.0, 90.0, 60.0, -10.0, 30.0, 40.0, 12.0, 30.0, 34.0, 15.0, 110.0, 30.0, 30.0, 130.0, 80.0, 36.0, 40.0, 50.0, 80.0, 60.0, 40.0, 20.0, 80.0, 60.0, 28.0, 27.0, 25.0, 80.0, 50.0, 60.0, 70.0, 60.0, 50.0, 50.0, 50.0, 100.0, 2.0, 40.0, 100.0, 40.0, 10.0, 80.0, 130.0, 60.0, 70.0, 30.0, 140.0, 40.0, 10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0, 50.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 110.0, 20.0, 80.0, 20.0, 50.0, 0.0, 30.0, 50.0, 20.0, 30.0, 40.0, 20.0, 60.0, 40.0, 30.0, 30.0, 50.0, 80.0, 70.0, -15.0, 80.0, 10.0, 30.0, 80.0, 36.0, 14.0, 68.0, 20.0, 90.0, 40.0, 30.0, 29.0, 73.0, 49.0, 60.0, 40.0, 110.0, 63.0, 42.0, 40.0, 150.0, 39.0, 40.0, 90.0, 87.0, 50.0, 120.0, 90.0, 50.0, 50.0, 88.0, 35.0, 50.0, 110.0, 90.0, 70.0, 80.0, 80.0, 33.0, 50.0, 79.0, 80.0, -5.0, 10.0, 41.0, 60.0, 80.0, -25.0, 30.0, 120.0, 10.0, 20.0, 19.0, 80.0, 50.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 10.0, 10.0, 80.0, 40.0, 80.0, 70.0, 28.0, 70.0, 140.0, 19.0, 60.0, 30.0, 50.0, 20.0, 38.0, 40.0, 50.0, 60.0, 27.0, 80.0, 20.0, 10.0, 70.0, 100.0, 0.0, 20.0, 60.0, 93.0, 25.0, 70.0, 40.0, 20.0, 50.0, 60.0, 82.0, 60.0, 90.0, 70.0, 7.0, 40.0, 68.0, 110.0, 40.0, 50.0, 110.0, 50.0, 36.0, 40.0, 110.0, 18.0, 40.0, 30.0, 100.0, 58.0, 47.0, 70.0, 50.0, 98.0, 100.0, -6.0, 70.0, 54.0, 24.0, 60.0, 10.0, -8.0, 30.0, 30.0, 80.0, 120.0, 60.0, 70.0, 0.0, 40.0, 30.0, 30.0, 20.0, 80.0, 33.0, 0.0, -7.0, 70.0, 80.0, 20.0, 50.0, 40.0, 60.0, 10.0, 50.0, 70.0, 50.0, 60.0, 73.0, 9.0, 40.0, 20.0, 40.0, 70.0, 29.0, 60.0, -1.0, 40.0, 90.0, 60.0, 60.0, 110.0, 100.0, 30.0, 90.0, 140.0, 80.0, 70.0, 60.0, 100.0, 140.0, 80.0, 40.0, 130.0, 63.0, 110.0, 47.0, 120.0, 65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5649682619163272, "mean_inference_ms": 1.5844261855293749, "mean_action_processing_ms": 0.5024072855963508, "mean_env_wait_ms": 1.3831000433647176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013901948928833008, "StateBufferConnector_ms": 0.01045370101928711, "ViewRequirementAgentConnector_ms": 0.4007575511932373}, "num_episodes": 23, "episode_return_max": 890.0, "episode_return_min": 182.0, "episode_return_mean": 528.58}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.67800070476047, "num_env_steps_trained_throughput_per_sec": 21.67800070476047, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 184820.839, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184820.792, "sample_time_ms": 2419.871, "learn_time_ms": 182381.976, "learn_throughput": 21.932, "synch_weights_time_ms": 10.953}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "a22d3_00000", "date": "2024-08-06_03-37-56", "timestamp": 1722929876, "time_this_iter_s": 184.53091406822205, "time_total_s": 17667.871341228485, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d2040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17667.871341228485, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.479693486590037, "ram_util_percent": 77.62490421455938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5617756797482794, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.0637255909343875, "policy_loss": -0.012486141363577372, "vf_loss": 6.07392841045595, "vf_explained_var": 0.013512573169824033, "kl": 0.0076110424654841835, "entropy": 0.6518252926195265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 243.0, "episode_reward_mean": 536.64, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -117.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 53.664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 570.0, 690.0, 680.0, 682.0, 795.0, 645.0, 710.0, 796.0, 620.0, 628.0, 446.0, 531.0, 496.0, 440.0, 509.0, 246.0, 611.0, 633.0, 500.0, 495.0, 552.0, 540.0, 280.0, 635.0, 630.0, 400.0, 621.0, 326.0, 770.0, 420.0, 530.0, 716.0, 400.0, 550.0, 830.0, 789.0, 588.0, 243.0, 633.0, 671.0, 503.0, 271.0, 519.0, 430.0, 790.0, 465.0, 480.0, 372.0, 524.0, 521.0, 363.0, 680.0, 312.0, 555.0, 500.0, 532.0, 700.0, 610.0, 260.0, 320.0, 320.0, 405.0, 480.0, 633.0, 710.0, 667.0, 365.0, 300.0, 617.0, 395.0, 498.0, 637.0, 524.0, 641.0, 476.0, 296.0, 490.0, 380.0, 830.0, 890.0, 682.0, 603.0, 761.0, 738.0, 670.0, 410.0, 380.0, 530.0, 733.0, 540.0, 324.0, 478.0, 590.0, 326.0, 317.0, 480.0, 300.0, 560.0, 574.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 70.0, 28.0, 80.0, 25.0, 50.0, 40.0, 67.0, 50.0, 110.0, 90.0, 20.0, 80.0, 30.0, 60.0, 50.0, 50.0, 50.0, 90.0, 50.0, 10.0, 80.0, -10.0, 50.0, 100.0, 130.0, 60.0, 100.0, 50.0, 120.0, 60.0, 70.0, 90.0, 60.0, 60.0, 110.0, 30.0, 110.0, 30.0, 60.0, 100.0, 20.0, 130.0, 54.0, 18.0, 40.0, 110.0, 40.0, 80.0, 90.0, 25.0, 130.0, 100.0, 130.0, 30.0, 70.0, 60.0, 90.0, 30.0, 130.0, 70.0, 80.0, 60.0, 40.0, 60.0, 80.0, 110.0, 0.0, 25.0, 120.0, 30.0, 60.0, 60.0, 90.0, 90.0, 80.0, 50.0, 70.0, 110.0, 70.0, 70.0, 110.0, 69.0, 80.0, 50.0, 50.0, 50.0, 160.0, 47.0, 110.0, 60.0, 50.0, 70.0, 50.0, 70.0, 130.0, 50.0, 70.0, 50.0, 20.0, 60.0, 90.0, 60.0, 18.0, 120.0, 65.0, 75.0, 30.0, 50.0, 60.0, -1.0, 110.0, 50.0, 29.0, 20.0, 63.0, 30.0, 60.0, 15.0, 70.0, 100.0, 90.0, 10.0, 68.0, 24.0, 40.0, 60.0, 40.0, 29.0, 70.0, -22.0, 47.0, 50.0, 50.0, 54.0, 130.0, 70.0, 17.0, 80.0, 20.0, 10.0, 60.0, 20.0, 10.0, 50.0, 70.0, 10.0, 50.0, 70.0, 90.0, 60.0, 20.0, 0.0, 50.0, 60.0, 40.0, 40.0, 80.0, 120.0, 39.0, 20.0, 0.0, 60.0, 30.0, 30.0, 0.0, 36.0, 20.0, 10.0, 40.0, 20.0, 38.0, 80.0, 90.0, 60.0, 50.0, 148.0, 5.0, 60.0, 60.0, 50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0, 70.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, 70.0, 50.0, 0.0, 48.0, 70.0, 110.0, 70.0, 30.0, 29.0, 50.0, 30.0, 8.0, 50.0, 31.0, 40.0, 18.0, 70.0, 35.0, 58.0, 50.0, 100.0, 80.0, 70.0, 88.0, 80.0, 50.0, 17.0, -9.0, 100.0, 39.0, 80.0, 50.0, 45.0, 10.0, 80.0, 10.0, 20.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 50.0, 20.0, 100.0, 50.0, 60.0, 50.0, 65.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 90.0, 50.0, 40.0, 60.0, 70.0, 60.0, 100.0, 30.0, 90.0, 20.0, 30.0, 50.0, 10.0, 40.0, 60.0, 50.0, 20.0, 56.0, 30.0, 50.0, 50.0, 140.0, 70.0, 120.0, 20.0, 70.0, 15.0, 20.0, 70.0, -1.0, 50.0, 10.0, 9.0, 10.0, 38.0, 60.0, 60.0, 80.0, 70.0, 140.0, 100.0, 66.0, 110.0, 34.0, 80.0, 66.0, 24.0, 70.0, 90.0, 20.0, 20.0, 0.0, 100.0, 40.0, 30.0, 40.0, 10.0, 20.0, 60.0, 100.0, 40.0, 70.0, 0.0, 40.0, 50.0, 50.0, 100.0, 120.0, 24.0, 70.0, 140.0, 70.0, 22.0, 80.0, 80.0, 60.0, 50.0, 20.0, 70.0, 0.0, 90.0, 70.0, -50.0, 50.0, 30.0, 80.0, 40.0, 7.0, 70.0, 70.0, 160.0, 30.0, 60.0, 26.0, 80.0, 7.0, 40.0, 80.0, 90.0, 80.0, 160.0, 120.0, 100.0, 90.0, 40.0, 40.0, 30.0, 60.0, 72.0, 100.0, 50.0, 50.0, 70.0, 110.0, 130.0, 50.0, 97.0, 80.0, 50.0, 5.0, 90.0, 53.0, 60.0, 80.0, 100.0, 20.0, 50.0, -4.0, 28.0, -20.0, 30.0, 50.0, 60.0, 38.0, -85.0, 36.0, 110.0, 70.0, 80.0, 60.0, 90.0, 20.0, 23.0, 100.0, 40.0, 90.0, 60.0, 47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0, 50.0, 120.0, 28.0, 50.0, 90.0, -25.0, 20.0, 50.0, 60.0, 60.0, 20.0, 17.0, 38.0, 0.0, 70.0, 40.0, 6.0, 20.0, 30.0, 30.0, 29.0, 60.0, 47.0, 40.0, 30.0, 50.0, 60.0, 60.0, 83.0, 60.0, 50.0, 50.0, 30.0, 10.0, 20.0, 40.0, 140.0, 10.0, 20.0, 60.0, 0.0, 90.0, 90.0, 110.0, 140.0, 50.0, 60.0, 110.0, 30.0, 110.0, 50.0, 30.0, 40.0, 80.0, 100.0, 60.0, 20.0, 5.0, 40.0, 40.0, 50.0, 40.0, 70.0, 50.0, 130.0, 50.0, 20.0, 20.0, 20.0, 30.0, 70.0, 40.0, 40.0, 30.0, 11.0, -29.0, 10.0, 40.0, 80.0, 80.0, 10.0, 90.0, 70.0, 40.0, 30.0, 50.0, 80.0, 69.0, 75.0, 10.0, 50.0, 68.0, 30.0, 90.0, 52.0, 61.0, 50.0, 19.0, 50.0, 51.0, 70.0, 5.0, -14.0, -7.0, 80.0, 15.0, 90.0, 60.0, 50.0, 14.0, 90.0, 50.0, 100.0, 20.0, 40.0, 120.0, 70.0, 60.0, 70.0, 60.0, 0.0, 30.0, 30.0, 90.0, 60.0, -10.0, 30.0, 40.0, 12.0, 30.0, 34.0, 15.0, 110.0, 30.0, 30.0, 130.0, 80.0, 36.0, 40.0, 50.0, 80.0, 60.0, 40.0, 20.0, 80.0, 60.0, 28.0, 27.0, 25.0, 80.0, 50.0, 60.0, 70.0, 60.0, 50.0, 50.0, 50.0, 100.0, 2.0, 40.0, 100.0, 40.0, 10.0, 80.0, 130.0, 60.0, 70.0, 30.0, 140.0, 40.0, 10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0, 50.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 110.0, 20.0, 80.0, 20.0, 50.0, 0.0, 30.0, 50.0, 20.0, 30.0, 40.0, 20.0, 60.0, 40.0, 30.0, 30.0, 50.0, 80.0, 70.0, -15.0, 80.0, 10.0, 30.0, 80.0, 36.0, 14.0, 68.0, 20.0, 90.0, 40.0, 30.0, 29.0, 73.0, 49.0, 60.0, 40.0, 110.0, 63.0, 42.0, 40.0, 150.0, 39.0, 40.0, 90.0, 87.0, 50.0, 120.0, 90.0, 50.0, 50.0, 88.0, 35.0, 50.0, 110.0, 90.0, 70.0, 80.0, 80.0, 33.0, 50.0, 79.0, 80.0, -5.0, 10.0, 41.0, 60.0, 80.0, -25.0, 30.0, 120.0, 10.0, 20.0, 19.0, 80.0, 50.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 10.0, 10.0, 80.0, 40.0, 80.0, 70.0, 28.0, 70.0, 140.0, 19.0, 60.0, 30.0, 50.0, 20.0, 38.0, 40.0, 50.0, 60.0, 27.0, 80.0, 20.0, 10.0, 70.0, 100.0, 0.0, 20.0, 60.0, 93.0, 25.0, 70.0, 40.0, 20.0, 50.0, 60.0, 82.0, 60.0, 90.0, 70.0, 7.0, 40.0, 68.0, 110.0, 40.0, 50.0, 110.0, 50.0, 36.0, 40.0, 110.0, 18.0, 40.0, 30.0, 100.0, 58.0, 47.0, 70.0, 50.0, 98.0, 100.0, -6.0, 70.0, 54.0, 24.0, 60.0, 10.0, -8.0, 30.0, 30.0, 80.0, 120.0, 60.0, 70.0, 0.0, 40.0, 30.0, 30.0, 20.0, 80.0, 33.0, 0.0, -7.0, 70.0, 80.0, 20.0, 50.0, 40.0, 60.0, 10.0, 50.0, 70.0, 50.0, 60.0, 73.0, 9.0, 40.0, 20.0, 40.0, 70.0, 29.0, 60.0, -1.0, 40.0, 90.0, 60.0, 60.0, 110.0, 100.0, 30.0, 90.0, 140.0, 80.0, 70.0, 60.0, 100.0, 140.0, 80.0, 40.0, 130.0, 63.0, 110.0, 47.0, 120.0, 65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0, 49.0, 70.0, 70.0, 70.0, 130.0, 50.0, 34.0, 60.0, 40.0, 30.0, 83.0, 60.0, 90.0, 40.0, 80.0, 158.0, 50.0, 50.0, 90.0, 60.0, 110.0, 80.0, 50.0, 60.0, 79.0, 50.0, 59.0, 110.0, 50.0, 90.0, 50.0, 100.0, 80.0, 40.0, 40.0, 130.0, 70.0, 60.0, 30.0, 70.0, 37.0, 78.0, 50.0, 100.0, 40.0, 30.0, 40.0, 36.0, 14.0, -15.0, 90.0, 5.0, 70.0, 30.0, 60.0, 40.0, -5.0, 20.0, 20.0, 50.0, 20.0, 60.0, 110.0, 40.0, 60.0, 50.0, 80.0, 20.0, 60.0, 30.0, 60.0, 100.0, 5.0, 60.0, 100.0, 69.0, 109.0, 110.0, 20.0, 100.0, 20.0, 70.0, 60.0, 80.0, 10.0, 40.0, 60.0, 50.0, 50.0, 100.0, 70.0, 20.0, 30.0, 30.0, 27.0, 17.0, 40.0, 40.0, 30.0, 20.0, 70.0, 40.0, 29.0, 19.0, 40.0, 90.0, 0.0, 120.0, 20.0, 50.0, 120.0, 90.0, 30.0, 130.0, 20.0, 0.0, 30.0, 50.0, 60.0, 60.0, -14.0, 140.0, 30.0, -117.0, 40.0, 40.0, 35.0, 120.0, 12.0, 40.0, 10.0, 0.0, 90.0, 70.0, 17.0, -7.0, 30.0, 50.0, 19.0, 38.0, 60.0, 30.0, 60.0, 30.0, 60.0, 50.0, 120.0, 20.0, 40.0, 10.0, 50.0, -10.0, 20.0, 10.0, 60.0, 60.0, 30.0, 20.0, 40.0, 20.0, 30.0, 10.0, 90.0, 50.0, 80.0, 50.0, 60.0, 80.0, 30.0, 80.0, 40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.564889809757184, "mean_inference_ms": 1.5844631477251343, "mean_action_processing_ms": 0.5017331656655198, "mean_env_wait_ms": 1.3811509232138832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012693643569946289, "StateBufferConnector_ms": 0.009094715118408203, "ViewRequirementAgentConnector_ms": 0.3955543041229248}, "num_episodes": 18, "episode_return_max": 890.0, "episode_return_min": 243.0, "episode_return_mean": 536.64}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.745170519363263, "num_env_steps_trained_throughput_per_sec": 21.745170519363263, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 184780.086, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184780.039, "sample_time_ms": 2426.924, "learn_time_ms": 182333.895, "learn_throughput": 21.938, "synch_weights_time_ms": 10.998}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "a22d3_00000", "date": "2024-08-06_03-41-00", "timestamp": 1722930060, "time_this_iter_s": 183.95840620994568, "time_total_s": 17851.82974743843, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d2ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17851.82974743843, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 17.043461538461536, "ram_util_percent": 77.91538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8406130040669466, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.123625734489693, "policy_loss": -0.010887879695340642, "vf_loss": 6.132397857438515, "vf_explained_var": 0.017380045505123523, "kl": 0.007052529008823231, "entropy": 0.6016419859422536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 243.0, "episode_reward_mean": 522.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -117.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 52.274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [633.0, 500.0, 495.0, 552.0, 540.0, 280.0, 635.0, 630.0, 400.0, 621.0, 326.0, 770.0, 420.0, 530.0, 716.0, 400.0, 550.0, 830.0, 789.0, 588.0, 243.0, 633.0, 671.0, 503.0, 271.0, 519.0, 430.0, 790.0, 465.0, 480.0, 372.0, 524.0, 521.0, 363.0, 680.0, 312.0, 555.0, 500.0, 532.0, 700.0, 610.0, 260.0, 320.0, 320.0, 405.0, 480.0, 633.0, 710.0, 667.0, 365.0, 300.0, 617.0, 395.0, 498.0, 637.0, 524.0, 641.0, 476.0, 296.0, 490.0, 380.0, 830.0, 890.0, 682.0, 603.0, 761.0, 738.0, 670.0, 410.0, 380.0, 530.0, 733.0, 540.0, 324.0, 478.0, 590.0, 326.0, 317.0, 480.0, 300.0, 560.0, 574.0, 246.0, 369.0, 440.0, 610.0, 470.0, 490.0, 429.0, 660.0, 600.0, 294.0, 500.0, 569.0, 729.0, 681.0, 481.0, 431.0, 504.0, 762.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 130.0, 50.0, 110.0, 38.0, 70.0, 60.0, 65.0, 20.0, 40.0, 70.0, 50.0, 40.0, 90.0, 40.0, 40.0, 50.0, 70.0, 50.0, 0.0, 48.0, 70.0, 110.0, 70.0, 30.0, 29.0, 50.0, 30.0, 8.0, 50.0, 31.0, 40.0, 18.0, 70.0, 35.0, 58.0, 50.0, 100.0, 80.0, 70.0, 88.0, 80.0, 50.0, 17.0, -9.0, 100.0, 39.0, 80.0, 50.0, 45.0, 10.0, 80.0, 10.0, 20.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 50.0, 20.0, 100.0, 50.0, 60.0, 50.0, 65.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 90.0, 50.0, 40.0, 60.0, 70.0, 60.0, 100.0, 30.0, 90.0, 20.0, 30.0, 50.0, 10.0, 40.0, 60.0, 50.0, 20.0, 56.0, 30.0, 50.0, 50.0, 140.0, 70.0, 120.0, 20.0, 70.0, 15.0, 20.0, 70.0, -1.0, 50.0, 10.0, 9.0, 10.0, 38.0, 60.0, 60.0, 80.0, 70.0, 140.0, 100.0, 66.0, 110.0, 34.0, 80.0, 66.0, 24.0, 70.0, 90.0, 20.0, 20.0, 0.0, 100.0, 40.0, 30.0, 40.0, 10.0, 20.0, 60.0, 100.0, 40.0, 70.0, 0.0, 40.0, 50.0, 50.0, 100.0, 120.0, 24.0, 70.0, 140.0, 70.0, 22.0, 80.0, 80.0, 60.0, 50.0, 20.0, 70.0, 0.0, 90.0, 70.0, -50.0, 50.0, 30.0, 80.0, 40.0, 7.0, 70.0, 70.0, 160.0, 30.0, 60.0, 26.0, 80.0, 7.0, 40.0, 80.0, 90.0, 80.0, 160.0, 120.0, 100.0, 90.0, 40.0, 40.0, 30.0, 60.0, 72.0, 100.0, 50.0, 50.0, 70.0, 110.0, 130.0, 50.0, 97.0, 80.0, 50.0, 5.0, 90.0, 53.0, 60.0, 80.0, 100.0, 20.0, 50.0, -4.0, 28.0, -20.0, 30.0, 50.0, 60.0, 38.0, -85.0, 36.0, 110.0, 70.0, 80.0, 60.0, 90.0, 20.0, 23.0, 100.0, 40.0, 90.0, 60.0, 47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0, 50.0, 120.0, 28.0, 50.0, 90.0, -25.0, 20.0, 50.0, 60.0, 60.0, 20.0, 17.0, 38.0, 0.0, 70.0, 40.0, 6.0, 20.0, 30.0, 30.0, 29.0, 60.0, 47.0, 40.0, 30.0, 50.0, 60.0, 60.0, 83.0, 60.0, 50.0, 50.0, 30.0, 10.0, 20.0, 40.0, 140.0, 10.0, 20.0, 60.0, 0.0, 90.0, 90.0, 110.0, 140.0, 50.0, 60.0, 110.0, 30.0, 110.0, 50.0, 30.0, 40.0, 80.0, 100.0, 60.0, 20.0, 5.0, 40.0, 40.0, 50.0, 40.0, 70.0, 50.0, 130.0, 50.0, 20.0, 20.0, 20.0, 30.0, 70.0, 40.0, 40.0, 30.0, 11.0, -29.0, 10.0, 40.0, 80.0, 80.0, 10.0, 90.0, 70.0, 40.0, 30.0, 50.0, 80.0, 69.0, 75.0, 10.0, 50.0, 68.0, 30.0, 90.0, 52.0, 61.0, 50.0, 19.0, 50.0, 51.0, 70.0, 5.0, -14.0, -7.0, 80.0, 15.0, 90.0, 60.0, 50.0, 14.0, 90.0, 50.0, 100.0, 20.0, 40.0, 120.0, 70.0, 60.0, 70.0, 60.0, 0.0, 30.0, 30.0, 90.0, 60.0, -10.0, 30.0, 40.0, 12.0, 30.0, 34.0, 15.0, 110.0, 30.0, 30.0, 130.0, 80.0, 36.0, 40.0, 50.0, 80.0, 60.0, 40.0, 20.0, 80.0, 60.0, 28.0, 27.0, 25.0, 80.0, 50.0, 60.0, 70.0, 60.0, 50.0, 50.0, 50.0, 100.0, 2.0, 40.0, 100.0, 40.0, 10.0, 80.0, 130.0, 60.0, 70.0, 30.0, 140.0, 40.0, 10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0, 50.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 110.0, 20.0, 80.0, 20.0, 50.0, 0.0, 30.0, 50.0, 20.0, 30.0, 40.0, 20.0, 60.0, 40.0, 30.0, 30.0, 50.0, 80.0, 70.0, -15.0, 80.0, 10.0, 30.0, 80.0, 36.0, 14.0, 68.0, 20.0, 90.0, 40.0, 30.0, 29.0, 73.0, 49.0, 60.0, 40.0, 110.0, 63.0, 42.0, 40.0, 150.0, 39.0, 40.0, 90.0, 87.0, 50.0, 120.0, 90.0, 50.0, 50.0, 88.0, 35.0, 50.0, 110.0, 90.0, 70.0, 80.0, 80.0, 33.0, 50.0, 79.0, 80.0, -5.0, 10.0, 41.0, 60.0, 80.0, -25.0, 30.0, 120.0, 10.0, 20.0, 19.0, 80.0, 50.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 10.0, 10.0, 80.0, 40.0, 80.0, 70.0, 28.0, 70.0, 140.0, 19.0, 60.0, 30.0, 50.0, 20.0, 38.0, 40.0, 50.0, 60.0, 27.0, 80.0, 20.0, 10.0, 70.0, 100.0, 0.0, 20.0, 60.0, 93.0, 25.0, 70.0, 40.0, 20.0, 50.0, 60.0, 82.0, 60.0, 90.0, 70.0, 7.0, 40.0, 68.0, 110.0, 40.0, 50.0, 110.0, 50.0, 36.0, 40.0, 110.0, 18.0, 40.0, 30.0, 100.0, 58.0, 47.0, 70.0, 50.0, 98.0, 100.0, -6.0, 70.0, 54.0, 24.0, 60.0, 10.0, -8.0, 30.0, 30.0, 80.0, 120.0, 60.0, 70.0, 0.0, 40.0, 30.0, 30.0, 20.0, 80.0, 33.0, 0.0, -7.0, 70.0, 80.0, 20.0, 50.0, 40.0, 60.0, 10.0, 50.0, 70.0, 50.0, 60.0, 73.0, 9.0, 40.0, 20.0, 40.0, 70.0, 29.0, 60.0, -1.0, 40.0, 90.0, 60.0, 60.0, 110.0, 100.0, 30.0, 90.0, 140.0, 80.0, 70.0, 60.0, 100.0, 140.0, 80.0, 40.0, 130.0, 63.0, 110.0, 47.0, 120.0, 65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0, 49.0, 70.0, 70.0, 70.0, 130.0, 50.0, 34.0, 60.0, 40.0, 30.0, 83.0, 60.0, 90.0, 40.0, 80.0, 158.0, 50.0, 50.0, 90.0, 60.0, 110.0, 80.0, 50.0, 60.0, 79.0, 50.0, 59.0, 110.0, 50.0, 90.0, 50.0, 100.0, 80.0, 40.0, 40.0, 130.0, 70.0, 60.0, 30.0, 70.0, 37.0, 78.0, 50.0, 100.0, 40.0, 30.0, 40.0, 36.0, 14.0, -15.0, 90.0, 5.0, 70.0, 30.0, 60.0, 40.0, -5.0, 20.0, 20.0, 50.0, 20.0, 60.0, 110.0, 40.0, 60.0, 50.0, 80.0, 20.0, 60.0, 30.0, 60.0, 100.0, 5.0, 60.0, 100.0, 69.0, 109.0, 110.0, 20.0, 100.0, 20.0, 70.0, 60.0, 80.0, 10.0, 40.0, 60.0, 50.0, 50.0, 100.0, 70.0, 20.0, 30.0, 30.0, 27.0, 17.0, 40.0, 40.0, 30.0, 20.0, 70.0, 40.0, 29.0, 19.0, 40.0, 90.0, 0.0, 120.0, 20.0, 50.0, 120.0, 90.0, 30.0, 130.0, 20.0, 0.0, 30.0, 50.0, 60.0, 60.0, -14.0, 140.0, 30.0, -117.0, 40.0, 40.0, 35.0, 120.0, 12.0, 40.0, 10.0, 0.0, 90.0, 70.0, 17.0, -7.0, 30.0, 50.0, 19.0, 38.0, 60.0, 30.0, 60.0, 30.0, 60.0, 50.0, 120.0, 20.0, 40.0, 10.0, 50.0, -10.0, 20.0, 10.0, 60.0, 60.0, 30.0, 20.0, 40.0, 20.0, 30.0, 10.0, 90.0, 50.0, 80.0, 50.0, 60.0, 80.0, 30.0, 80.0, 40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0, 60.0, -82.0, -37.0, 50.0, 50.0, 90.0, 40.0, 25.0, 10.0, 40.0, 9.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 120.0, 10.0, 30.0, 40.0, 100.0, 10.0, 60.0, 50.0, 20.0, 40.0, 20.0, 50.0, 50.0, 60.0, 70.0, 90.0, 50.0, 30.0, 60.0, 30.0, 100.0, 60.0, 60.0, 170.0, 40.0, -40.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 50.0, 60.0, 50.0, 30.0, 70.0, 50.0, 40.0, 70.0, 40.0, 50.0, 30.0, 30.0, 160.0, 20.0, 30.0, 50.0, 20.0, 40.0, 50.0, -1.0, 30.0, 50.0, 50.0, 60.0, 120.0, 130.0, 90.0, 20.0, 60.0, 80.0, 0.0, 59.0, 80.0, 20.0, 20.0, 30.0, 120.0, 40.0, 29.0, 117.0, 85.0, 0.0, 50.0, 70.0, -15.0, 30.0, 60.0, 22.0, 20.0, 30.0, 27.0, 22.0, 40.0, 29.0, 70.0, 50.0, 70.0, 50.0, 100.0, 49.0, 20.0, 70.0, 20.0, 80.0, 30.0, 70.0, 40.0, 20.0, 79.0, 90.0, 70.0, 30.0, 70.0, 80.0, 100.0, 38.0, 70.0, 71.0, 40.0, 80.0, 150.0, 53.0, 90.0, 35.0, 63.0, 40.0, 100.0, 50.0, 100.0, 50.0, 100.0, 50.0, 105.0, 96.0, 16.0, 4.0, 0.0, 100.0, 70.0, 0.0, 40.0, 20.0, 30.0, 37.0, 10.0, 70.0, 48.0, 76.0, 100.0, 40.0, 0.0, 70.0, 60.0, 80.0, 30.0, 60.0, 40.0, 20.0, 80.0, 4.0, 60.0, 80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5632883034058067, "mean_inference_ms": 1.5822863478126608, "mean_action_processing_ms": 0.5009592515746689, "mean_env_wait_ms": 1.379380763681616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01460576057434082, "StateBufferConnector_ms": 0.009211301803588867, "ViewRequirementAgentConnector_ms": 0.4031710624694824}, "num_episodes": 18, "episode_return_max": 890.0, "episode_return_min": 243.0, "episode_return_mean": 522.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.65069971671243, "num_env_steps_trained_throughput_per_sec": 21.65069971671243, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 184758.525, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184758.477, "sample_time_ms": 2398.137, "learn_time_ms": 182340.966, "learn_throughput": 21.937, "synch_weights_time_ms": 10.721}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "a22d3_00000", "date": "2024-08-06_03-44-05", "timestamp": 1722930245, "time_this_iter_s": 184.75935006141663, "time_total_s": 18036.589097499847, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c4700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18036.589097499847, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.964122137404576, "ram_util_percent": 77.99465648854961}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8266194616516813, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.059801800741047, "policy_loss": -0.011479598020413678, "vf_loss": 6.069092756998551, "vf_explained_var": 0.031859917991077555, "kl": 0.007295489482854513, "entropy": 0.630363081939939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 219.0, "episode_reward_mean": 519.07, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -117.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 51.907}, "custom_metrics": {}, "hist_stats": {"episode_reward": [671.0, 503.0, 271.0, 519.0, 430.0, 790.0, 465.0, 480.0, 372.0, 524.0, 521.0, 363.0, 680.0, 312.0, 555.0, 500.0, 532.0, 700.0, 610.0, 260.0, 320.0, 320.0, 405.0, 480.0, 633.0, 710.0, 667.0, 365.0, 300.0, 617.0, 395.0, 498.0, 637.0, 524.0, 641.0, 476.0, 296.0, 490.0, 380.0, 830.0, 890.0, 682.0, 603.0, 761.0, 738.0, 670.0, 410.0, 380.0, 530.0, 733.0, 540.0, 324.0, 478.0, 590.0, 326.0, 317.0, 480.0, 300.0, 560.0, 574.0, 246.0, 369.0, 440.0, 610.0, 470.0, 490.0, 429.0, 660.0, 600.0, 294.0, 500.0, 569.0, 729.0, 681.0, 481.0, 431.0, 504.0, 762.0, 709.0, 554.0, 590.0, 495.0, 675.0, 414.0, 430.0, 219.0, 865.0, 475.0, 560.0, 470.0, 410.0, 758.0, 750.0, 430.0, 599.0, 327.0, 507.0, 422.0, 505.0, 550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [47.0, 100.0, 40.0, 70.0, 120.0, 70.0, 70.0, 60.0, 50.0, 44.0, 50.0, 120.0, 28.0, 50.0, 90.0, -25.0, 20.0, 50.0, 60.0, 60.0, 20.0, 17.0, 38.0, 0.0, 70.0, 40.0, 6.0, 20.0, 30.0, 30.0, 29.0, 60.0, 47.0, 40.0, 30.0, 50.0, 60.0, 60.0, 83.0, 60.0, 50.0, 50.0, 30.0, 10.0, 20.0, 40.0, 140.0, 10.0, 20.0, 60.0, 0.0, 90.0, 90.0, 110.0, 140.0, 50.0, 60.0, 110.0, 30.0, 110.0, 50.0, 30.0, 40.0, 80.0, 100.0, 60.0, 20.0, 5.0, 40.0, 40.0, 50.0, 40.0, 70.0, 50.0, 130.0, 50.0, 20.0, 20.0, 20.0, 30.0, 70.0, 40.0, 40.0, 30.0, 11.0, -29.0, 10.0, 40.0, 80.0, 80.0, 10.0, 90.0, 70.0, 40.0, 30.0, 50.0, 80.0, 69.0, 75.0, 10.0, 50.0, 68.0, 30.0, 90.0, 52.0, 61.0, 50.0, 19.0, 50.0, 51.0, 70.0, 5.0, -14.0, -7.0, 80.0, 15.0, 90.0, 60.0, 50.0, 14.0, 90.0, 50.0, 100.0, 20.0, 40.0, 120.0, 70.0, 60.0, 70.0, 60.0, 0.0, 30.0, 30.0, 90.0, 60.0, -10.0, 30.0, 40.0, 12.0, 30.0, 34.0, 15.0, 110.0, 30.0, 30.0, 130.0, 80.0, 36.0, 40.0, 50.0, 80.0, 60.0, 40.0, 20.0, 80.0, 60.0, 28.0, 27.0, 25.0, 80.0, 50.0, 60.0, 70.0, 60.0, 50.0, 50.0, 50.0, 100.0, 2.0, 40.0, 100.0, 40.0, 10.0, 80.0, 130.0, 60.0, 70.0, 30.0, 140.0, 40.0, 10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0, 50.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 110.0, 20.0, 80.0, 20.0, 50.0, 0.0, 30.0, 50.0, 20.0, 30.0, 40.0, 20.0, 60.0, 40.0, 30.0, 30.0, 50.0, 80.0, 70.0, -15.0, 80.0, 10.0, 30.0, 80.0, 36.0, 14.0, 68.0, 20.0, 90.0, 40.0, 30.0, 29.0, 73.0, 49.0, 60.0, 40.0, 110.0, 63.0, 42.0, 40.0, 150.0, 39.0, 40.0, 90.0, 87.0, 50.0, 120.0, 90.0, 50.0, 50.0, 88.0, 35.0, 50.0, 110.0, 90.0, 70.0, 80.0, 80.0, 33.0, 50.0, 79.0, 80.0, -5.0, 10.0, 41.0, 60.0, 80.0, -25.0, 30.0, 120.0, 10.0, 20.0, 19.0, 80.0, 50.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 10.0, 10.0, 80.0, 40.0, 80.0, 70.0, 28.0, 70.0, 140.0, 19.0, 60.0, 30.0, 50.0, 20.0, 38.0, 40.0, 50.0, 60.0, 27.0, 80.0, 20.0, 10.0, 70.0, 100.0, 0.0, 20.0, 60.0, 93.0, 25.0, 70.0, 40.0, 20.0, 50.0, 60.0, 82.0, 60.0, 90.0, 70.0, 7.0, 40.0, 68.0, 110.0, 40.0, 50.0, 110.0, 50.0, 36.0, 40.0, 110.0, 18.0, 40.0, 30.0, 100.0, 58.0, 47.0, 70.0, 50.0, 98.0, 100.0, -6.0, 70.0, 54.0, 24.0, 60.0, 10.0, -8.0, 30.0, 30.0, 80.0, 120.0, 60.0, 70.0, 0.0, 40.0, 30.0, 30.0, 20.0, 80.0, 33.0, 0.0, -7.0, 70.0, 80.0, 20.0, 50.0, 40.0, 60.0, 10.0, 50.0, 70.0, 50.0, 60.0, 73.0, 9.0, 40.0, 20.0, 40.0, 70.0, 29.0, 60.0, -1.0, 40.0, 90.0, 60.0, 60.0, 110.0, 100.0, 30.0, 90.0, 140.0, 80.0, 70.0, 60.0, 100.0, 140.0, 80.0, 40.0, 130.0, 63.0, 110.0, 47.0, 120.0, 65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0, 49.0, 70.0, 70.0, 70.0, 130.0, 50.0, 34.0, 60.0, 40.0, 30.0, 83.0, 60.0, 90.0, 40.0, 80.0, 158.0, 50.0, 50.0, 90.0, 60.0, 110.0, 80.0, 50.0, 60.0, 79.0, 50.0, 59.0, 110.0, 50.0, 90.0, 50.0, 100.0, 80.0, 40.0, 40.0, 130.0, 70.0, 60.0, 30.0, 70.0, 37.0, 78.0, 50.0, 100.0, 40.0, 30.0, 40.0, 36.0, 14.0, -15.0, 90.0, 5.0, 70.0, 30.0, 60.0, 40.0, -5.0, 20.0, 20.0, 50.0, 20.0, 60.0, 110.0, 40.0, 60.0, 50.0, 80.0, 20.0, 60.0, 30.0, 60.0, 100.0, 5.0, 60.0, 100.0, 69.0, 109.0, 110.0, 20.0, 100.0, 20.0, 70.0, 60.0, 80.0, 10.0, 40.0, 60.0, 50.0, 50.0, 100.0, 70.0, 20.0, 30.0, 30.0, 27.0, 17.0, 40.0, 40.0, 30.0, 20.0, 70.0, 40.0, 29.0, 19.0, 40.0, 90.0, 0.0, 120.0, 20.0, 50.0, 120.0, 90.0, 30.0, 130.0, 20.0, 0.0, 30.0, 50.0, 60.0, 60.0, -14.0, 140.0, 30.0, -117.0, 40.0, 40.0, 35.0, 120.0, 12.0, 40.0, 10.0, 0.0, 90.0, 70.0, 17.0, -7.0, 30.0, 50.0, 19.0, 38.0, 60.0, 30.0, 60.0, 30.0, 60.0, 50.0, 120.0, 20.0, 40.0, 10.0, 50.0, -10.0, 20.0, 10.0, 60.0, 60.0, 30.0, 20.0, 40.0, 20.0, 30.0, 10.0, 90.0, 50.0, 80.0, 50.0, 60.0, 80.0, 30.0, 80.0, 40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0, 60.0, -82.0, -37.0, 50.0, 50.0, 90.0, 40.0, 25.0, 10.0, 40.0, 9.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 120.0, 10.0, 30.0, 40.0, 100.0, 10.0, 60.0, 50.0, 20.0, 40.0, 20.0, 50.0, 50.0, 60.0, 70.0, 90.0, 50.0, 30.0, 60.0, 30.0, 100.0, 60.0, 60.0, 170.0, 40.0, -40.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 50.0, 60.0, 50.0, 30.0, 70.0, 50.0, 40.0, 70.0, 40.0, 50.0, 30.0, 30.0, 160.0, 20.0, 30.0, 50.0, 20.0, 40.0, 50.0, -1.0, 30.0, 50.0, 50.0, 60.0, 120.0, 130.0, 90.0, 20.0, 60.0, 80.0, 0.0, 59.0, 80.0, 20.0, 20.0, 30.0, 120.0, 40.0, 29.0, 117.0, 85.0, 0.0, 50.0, 70.0, -15.0, 30.0, 60.0, 22.0, 20.0, 30.0, 27.0, 22.0, 40.0, 29.0, 70.0, 50.0, 70.0, 50.0, 100.0, 49.0, 20.0, 70.0, 20.0, 80.0, 30.0, 70.0, 40.0, 20.0, 79.0, 90.0, 70.0, 30.0, 70.0, 80.0, 100.0, 38.0, 70.0, 71.0, 40.0, 80.0, 150.0, 53.0, 90.0, 35.0, 63.0, 40.0, 100.0, 50.0, 100.0, 50.0, 100.0, 50.0, 105.0, 96.0, 16.0, 4.0, 0.0, 100.0, 70.0, 0.0, 40.0, 20.0, 30.0, 37.0, 10.0, 70.0, 48.0, 76.0, 100.0, 40.0, 0.0, 70.0, 60.0, 80.0, 30.0, 60.0, 40.0, 20.0, 80.0, 4.0, 60.0, 80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0, 120.0, 50.0, 30.0, 160.0, 40.0, 15.0, 100.0, 24.0, 70.0, 100.0, 15.0, 20.0, 46.0, 20.0, 90.0, 29.0, 70.0, 110.0, 50.0, 104.0, 100.0, 40.0, 80.0, 68.0, 30.0, 39.0, 58.0, 60.0, 35.0, 80.0, 80.0, 60.0, 60.0, 40.0, 35.0, 30.0, 30.0, 50.0, 60.0, 50.0, 90.0, 60.0, 30.0, 90.0, 0.0, 27.0, 110.0, 140.0, 38.0, 90.0, -3.0, 70.0, 70.0, 30.0, 70.0, 30.0, 39.0, 10.0, 70.0, 28.0, 0.0, 30.0, 60.0, 60.0, 50.0, 70.0, 80.0, 20.0, 60.0, 0.0, -44.0, 19.0, 40.0, 30.0, 30.0, 18.0, 30.0, -34.0, 40.0, 90.0, 150.0, 110.0, 150.0, 55.0, 30.0, 60.0, 100.0, 70.0, 80.0, 60.0, 50.0, 40.0, 90.0, 20.0, -35.0, 50.0, 150.0, 50.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 80.0, 30.0, 110.0, 40.0, 50.0, 0.0, 100.0, 70.0, 70.0, 90.0, 20.0, 0.0, 50.0, 30.0, 40.0, 20.0, 30.0, 20.0, 70.0, 10.0, 30.0, 40.0, 30.0, 110.0, 50.0, 140.0, 80.0, 70.0, 50.0, 70.0, 50.0, 70.0, 80.0, 70.0, 78.0, 20.0, 60.0, 60.0, 60.0, 80.0, 50.0, 60.0, 150.0, 120.0, 90.0, 80.0, 20.0, 20.0, 10.0, 110.0, 70.0, 60.0, 0.0, 50.0, 10.0, 40.0, 60.0, 60.0, 70.0, 60.0, 60.0, 19.0, 50.0, 70.0, 110.0, 0.0, 50.0, 30.0, 30.0, 50.0, 40.0, 30.0, 18.0, 50.0, 29.0, 70.0, 50.0, 90.0, 49.0, -8.0, 40.0, 30.0, 16.0, 50.0, 120.0, 40.0, 40.0, 14.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 138.0, 40.0, 28.0, 17.0, 30.0, 60.0, 60.0, 100.0, 70.0, 80.0, 20.0, 50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.561488649398163, "mean_inference_ms": 1.5797938107023708, "mean_action_processing_ms": 0.5000584733818146, "mean_env_wait_ms": 1.377376345314802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014318466186523438, "StateBufferConnector_ms": 0.00919795036315918, "ViewRequirementAgentConnector_ms": 0.3944094181060791}, "num_episodes": 22, "episode_return_max": 890.0, "episode_return_min": 219.0, "episode_return_mean": 519.07}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.604385751541308, "num_env_steps_trained_throughput_per_sec": 21.604385751541308, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 184665.408, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184665.359, "sample_time_ms": 2387.744, "learn_time_ms": 182258.747, "learn_throughput": 21.947, "synch_weights_time_ms": 10.531}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "a22d3_00000", "date": "2024-08-06_03-47-10", "timestamp": 1722930430, "time_this_iter_s": 185.15630173683167, "time_total_s": 18221.74539923668, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18221.74539923668, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.05287356321839, "ram_util_percent": 78.97739463601532}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.936181578328942, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.242407098593422, "policy_loss": -0.010518094599946215, "vf_loss": 6.250856127703406, "vf_explained_var": 0.01821928191235779, "kl": 0.006896885520507261, "entropy": 0.617458395515514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 945.0, "episode_reward_min": 169.0, "episode_reward_mean": 529.26, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 203.0}, "policy_reward_mean": {"policy_0": 52.926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 260.0, 320.0, 320.0, 405.0, 480.0, 633.0, 710.0, 667.0, 365.0, 300.0, 617.0, 395.0, 498.0, 637.0, 524.0, 641.0, 476.0, 296.0, 490.0, 380.0, 830.0, 890.0, 682.0, 603.0, 761.0, 738.0, 670.0, 410.0, 380.0, 530.0, 733.0, 540.0, 324.0, 478.0, 590.0, 326.0, 317.0, 480.0, 300.0, 560.0, 574.0, 246.0, 369.0, 440.0, 610.0, 470.0, 490.0, 429.0, 660.0, 600.0, 294.0, 500.0, 569.0, 729.0, 681.0, 481.0, 431.0, 504.0, 762.0, 709.0, 554.0, 590.0, 495.0, 675.0, 414.0, 430.0, 219.0, 865.0, 475.0, 560.0, 470.0, 410.0, 758.0, 750.0, 430.0, 599.0, 327.0, 507.0, 422.0, 505.0, 550.0, 500.0, 523.0, 500.0, 703.0, 370.0, 945.0, 551.0, 537.0, 605.0, 597.0, 600.0, 339.0, 550.0, 680.0, 470.0, 169.0, 790.0, 778.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 90.0, 50.0, 60.0, 70.0, 60.0, 100.0, 100.0, 20.0, 50.0, 10.0, 40.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 0.0, 110.0, 20.0, 80.0, 20.0, 50.0, 0.0, 30.0, 50.0, 20.0, 30.0, 40.0, 20.0, 60.0, 40.0, 30.0, 30.0, 50.0, 80.0, 70.0, -15.0, 80.0, 10.0, 30.0, 80.0, 36.0, 14.0, 68.0, 20.0, 90.0, 40.0, 30.0, 29.0, 73.0, 49.0, 60.0, 40.0, 110.0, 63.0, 42.0, 40.0, 150.0, 39.0, 40.0, 90.0, 87.0, 50.0, 120.0, 90.0, 50.0, 50.0, 88.0, 35.0, 50.0, 110.0, 90.0, 70.0, 80.0, 80.0, 33.0, 50.0, 79.0, 80.0, -5.0, 10.0, 41.0, 60.0, 80.0, -25.0, 30.0, 120.0, 10.0, 20.0, 19.0, 80.0, 50.0, 10.0, 40.0, 40.0, 20.0, 40.0, 0.0, 10.0, 10.0, 80.0, 40.0, 80.0, 70.0, 28.0, 70.0, 140.0, 19.0, 60.0, 30.0, 50.0, 20.0, 38.0, 40.0, 50.0, 60.0, 27.0, 80.0, 20.0, 10.0, 70.0, 100.0, 0.0, 20.0, 60.0, 93.0, 25.0, 70.0, 40.0, 20.0, 50.0, 60.0, 82.0, 60.0, 90.0, 70.0, 7.0, 40.0, 68.0, 110.0, 40.0, 50.0, 110.0, 50.0, 36.0, 40.0, 110.0, 18.0, 40.0, 30.0, 100.0, 58.0, 47.0, 70.0, 50.0, 98.0, 100.0, -6.0, 70.0, 54.0, 24.0, 60.0, 10.0, -8.0, 30.0, 30.0, 80.0, 120.0, 60.0, 70.0, 0.0, 40.0, 30.0, 30.0, 20.0, 80.0, 33.0, 0.0, -7.0, 70.0, 80.0, 20.0, 50.0, 40.0, 60.0, 10.0, 50.0, 70.0, 50.0, 60.0, 73.0, 9.0, 40.0, 20.0, 40.0, 70.0, 29.0, 60.0, -1.0, 40.0, 90.0, 60.0, 60.0, 110.0, 100.0, 30.0, 90.0, 140.0, 80.0, 70.0, 60.0, 100.0, 140.0, 80.0, 40.0, 130.0, 63.0, 110.0, 47.0, 120.0, 65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0, 49.0, 70.0, 70.0, 70.0, 130.0, 50.0, 34.0, 60.0, 40.0, 30.0, 83.0, 60.0, 90.0, 40.0, 80.0, 158.0, 50.0, 50.0, 90.0, 60.0, 110.0, 80.0, 50.0, 60.0, 79.0, 50.0, 59.0, 110.0, 50.0, 90.0, 50.0, 100.0, 80.0, 40.0, 40.0, 130.0, 70.0, 60.0, 30.0, 70.0, 37.0, 78.0, 50.0, 100.0, 40.0, 30.0, 40.0, 36.0, 14.0, -15.0, 90.0, 5.0, 70.0, 30.0, 60.0, 40.0, -5.0, 20.0, 20.0, 50.0, 20.0, 60.0, 110.0, 40.0, 60.0, 50.0, 80.0, 20.0, 60.0, 30.0, 60.0, 100.0, 5.0, 60.0, 100.0, 69.0, 109.0, 110.0, 20.0, 100.0, 20.0, 70.0, 60.0, 80.0, 10.0, 40.0, 60.0, 50.0, 50.0, 100.0, 70.0, 20.0, 30.0, 30.0, 27.0, 17.0, 40.0, 40.0, 30.0, 20.0, 70.0, 40.0, 29.0, 19.0, 40.0, 90.0, 0.0, 120.0, 20.0, 50.0, 120.0, 90.0, 30.0, 130.0, 20.0, 0.0, 30.0, 50.0, 60.0, 60.0, -14.0, 140.0, 30.0, -117.0, 40.0, 40.0, 35.0, 120.0, 12.0, 40.0, 10.0, 0.0, 90.0, 70.0, 17.0, -7.0, 30.0, 50.0, 19.0, 38.0, 60.0, 30.0, 60.0, 30.0, 60.0, 50.0, 120.0, 20.0, 40.0, 10.0, 50.0, -10.0, 20.0, 10.0, 60.0, 60.0, 30.0, 20.0, 40.0, 20.0, 30.0, 10.0, 90.0, 50.0, 80.0, 50.0, 60.0, 80.0, 30.0, 80.0, 40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0, 60.0, -82.0, -37.0, 50.0, 50.0, 90.0, 40.0, 25.0, 10.0, 40.0, 9.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 120.0, 10.0, 30.0, 40.0, 100.0, 10.0, 60.0, 50.0, 20.0, 40.0, 20.0, 50.0, 50.0, 60.0, 70.0, 90.0, 50.0, 30.0, 60.0, 30.0, 100.0, 60.0, 60.0, 170.0, 40.0, -40.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 50.0, 60.0, 50.0, 30.0, 70.0, 50.0, 40.0, 70.0, 40.0, 50.0, 30.0, 30.0, 160.0, 20.0, 30.0, 50.0, 20.0, 40.0, 50.0, -1.0, 30.0, 50.0, 50.0, 60.0, 120.0, 130.0, 90.0, 20.0, 60.0, 80.0, 0.0, 59.0, 80.0, 20.0, 20.0, 30.0, 120.0, 40.0, 29.0, 117.0, 85.0, 0.0, 50.0, 70.0, -15.0, 30.0, 60.0, 22.0, 20.0, 30.0, 27.0, 22.0, 40.0, 29.0, 70.0, 50.0, 70.0, 50.0, 100.0, 49.0, 20.0, 70.0, 20.0, 80.0, 30.0, 70.0, 40.0, 20.0, 79.0, 90.0, 70.0, 30.0, 70.0, 80.0, 100.0, 38.0, 70.0, 71.0, 40.0, 80.0, 150.0, 53.0, 90.0, 35.0, 63.0, 40.0, 100.0, 50.0, 100.0, 50.0, 100.0, 50.0, 105.0, 96.0, 16.0, 4.0, 0.0, 100.0, 70.0, 0.0, 40.0, 20.0, 30.0, 37.0, 10.0, 70.0, 48.0, 76.0, 100.0, 40.0, 0.0, 70.0, 60.0, 80.0, 30.0, 60.0, 40.0, 20.0, 80.0, 4.0, 60.0, 80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0, 120.0, 50.0, 30.0, 160.0, 40.0, 15.0, 100.0, 24.0, 70.0, 100.0, 15.0, 20.0, 46.0, 20.0, 90.0, 29.0, 70.0, 110.0, 50.0, 104.0, 100.0, 40.0, 80.0, 68.0, 30.0, 39.0, 58.0, 60.0, 35.0, 80.0, 80.0, 60.0, 60.0, 40.0, 35.0, 30.0, 30.0, 50.0, 60.0, 50.0, 90.0, 60.0, 30.0, 90.0, 0.0, 27.0, 110.0, 140.0, 38.0, 90.0, -3.0, 70.0, 70.0, 30.0, 70.0, 30.0, 39.0, 10.0, 70.0, 28.0, 0.0, 30.0, 60.0, 60.0, 50.0, 70.0, 80.0, 20.0, 60.0, 0.0, -44.0, 19.0, 40.0, 30.0, 30.0, 18.0, 30.0, -34.0, 40.0, 90.0, 150.0, 110.0, 150.0, 55.0, 30.0, 60.0, 100.0, 70.0, 80.0, 60.0, 50.0, 40.0, 90.0, 20.0, -35.0, 50.0, 150.0, 50.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 80.0, 30.0, 110.0, 40.0, 50.0, 0.0, 100.0, 70.0, 70.0, 90.0, 20.0, 0.0, 50.0, 30.0, 40.0, 20.0, 30.0, 20.0, 70.0, 10.0, 30.0, 40.0, 30.0, 110.0, 50.0, 140.0, 80.0, 70.0, 50.0, 70.0, 50.0, 70.0, 80.0, 70.0, 78.0, 20.0, 60.0, 60.0, 60.0, 80.0, 50.0, 60.0, 150.0, 120.0, 90.0, 80.0, 20.0, 20.0, 10.0, 110.0, 70.0, 60.0, 0.0, 50.0, 10.0, 40.0, 60.0, 60.0, 70.0, 60.0, 60.0, 19.0, 50.0, 70.0, 110.0, 0.0, 50.0, 30.0, 30.0, 50.0, 40.0, 30.0, 18.0, 50.0, 29.0, 70.0, 50.0, 90.0, 49.0, -8.0, 40.0, 30.0, 16.0, 50.0, 120.0, 40.0, 40.0, 14.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 138.0, 40.0, 28.0, 17.0, 30.0, 60.0, 60.0, 100.0, 70.0, 80.0, 20.0, 50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0, 90.0, 60.0, 50.0, 40.0, 30.0, 20.0, 50.0, 70.0, 30.0, 60.0, 99.0, 30.0, -70.0, 47.0, 20.0, 60.0, 78.0, 8.0, 203.0, 48.0, 30.0, 30.0, 50.0, 40.0, 70.0, 70.0, 40.0, 80.0, 40.0, 50.0, 100.0, 50.0, 62.0, 71.0, 70.0, 10.0, 110.0, 20.0, 100.0, 110.0, 70.0, 40.0, 20.0, 30.0, 30.0, 60.0, 30.0, 50.0, 10.0, 30.0, 60.0, 110.0, 90.0, 15.0, 80.0, 100.0, 130.0, 80.0, 150.0, 130.0, 20.0, 110.0, 100.0, 50.0, 25.0, 50.0, 40.0, 80.0, -24.0, 100.0, 80.0, 80.0, 60.0, 60.0, 30.0, 70.0, 20.0, 47.0, 50.0, 40.0, 80.0, 110.0, 10.0, 50.0, 115.0, 40.0, 80.0, 20.0, 60.0, 40.0, 105.0, 80.0, 11.0, 60.0, 50.0, 19.0, 140.0, 32.0, 30.0, 70.0, 80.0, 50.0, 30.0, 70.0, 110.0, 50.0, 30.0, 70.0, 70.0, 40.0, 35.0, 30.0, 30.0, 10.0, 50.0, 34.0, 0.0, 80.0, 40.0, 30.0, 20.0, 40.0, 70.0, 60.0, 50.0, 60.0, 120.0, 40.0, 60.0, 30.0, 80.0, 40.0, 70.0, 60.0, 40.0, 80.0, 70.0, 50.0, 70.0, 120.0, 30.0, 60.0, 30.0, 20.0, 80.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 0.0, 52.0, 30.0, -135.0, 60.0, 80.0, 20.0, 40.0, -8.0, 0.0, 60.0, 100.0, 100.0, 120.0, 100.0, 57.0, 98.0, 40.0, 115.0, 90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5601432884085384, "mean_inference_ms": 1.5778640875932646, "mean_action_processing_ms": 0.49934558281208724, "mean_env_wait_ms": 1.3758449844652667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014342069625854492, "StateBufferConnector_ms": 0.009235143661499023, "ViewRequirementAgentConnector_ms": 0.3961656093597412}, "num_episodes": 18, "episode_return_max": 945.0, "episode_return_min": 169.0, "episode_return_mean": 529.26}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.81237937234742, "num_env_steps_trained_throughput_per_sec": 21.81237937234742, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 184517.696, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184517.647, "sample_time_ms": 2363.632, "learn_time_ms": 182135.081, "learn_throughput": 21.962, "synch_weights_time_ms": 10.666}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "a22d3_00000", "date": "2024-08-06_03-50-14", "timestamp": 1722930614, "time_this_iter_s": 183.39390301704407, "time_total_s": 18405.139302253723, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18405.139302253723, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 16.868076923076924, "ram_util_percent": 79.35846153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985258764948962, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.249006161268273, "policy_loss": -0.009953318491079215, "vf_loss": 6.256940652615727, "vf_explained_var": 0.006034417782093897, "kl": 0.006729444906103536, "entropy": 0.5869409773645563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 945.0, "episode_reward_min": 169.0, "episode_reward_mean": 539.83, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 203.0}, "policy_reward_mean": {"policy_0": 53.983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [682.0, 603.0, 761.0, 738.0, 670.0, 410.0, 380.0, 530.0, 733.0, 540.0, 324.0, 478.0, 590.0, 326.0, 317.0, 480.0, 300.0, 560.0, 574.0, 246.0, 369.0, 440.0, 610.0, 470.0, 490.0, 429.0, 660.0, 600.0, 294.0, 500.0, 569.0, 729.0, 681.0, 481.0, 431.0, 504.0, 762.0, 709.0, 554.0, 590.0, 495.0, 675.0, 414.0, 430.0, 219.0, 865.0, 475.0, 560.0, 470.0, 410.0, 758.0, 750.0, 430.0, 599.0, 327.0, 507.0, 422.0, 505.0, 550.0, 500.0, 523.0, 500.0, 703.0, 370.0, 945.0, 551.0, 537.0, 605.0, 597.0, 600.0, 339.0, 550.0, 680.0, 470.0, 169.0, 790.0, 778.0, 582.0, 650.0, 634.0, 600.0, 393.0, 609.0, 706.0, 469.0, 596.0, 506.0, 736.0, 444.0, 420.0, 511.0, 630.0, 732.0, 525.0, 387.0, 540.0, 580.0, 650.0, 446.0, 455.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [65.0, 6.0, 130.0, 60.0, 50.0, 99.0, 90.0, 80.0, 58.0, 44.0, 49.0, 70.0, 70.0, 70.0, 130.0, 50.0, 34.0, 60.0, 40.0, 30.0, 83.0, 60.0, 90.0, 40.0, 80.0, 158.0, 50.0, 50.0, 90.0, 60.0, 110.0, 80.0, 50.0, 60.0, 79.0, 50.0, 59.0, 110.0, 50.0, 90.0, 50.0, 100.0, 80.0, 40.0, 40.0, 130.0, 70.0, 60.0, 30.0, 70.0, 37.0, 78.0, 50.0, 100.0, 40.0, 30.0, 40.0, 36.0, 14.0, -15.0, 90.0, 5.0, 70.0, 30.0, 60.0, 40.0, -5.0, 20.0, 20.0, 50.0, 20.0, 60.0, 110.0, 40.0, 60.0, 50.0, 80.0, 20.0, 60.0, 30.0, 60.0, 100.0, 5.0, 60.0, 100.0, 69.0, 109.0, 110.0, 20.0, 100.0, 20.0, 70.0, 60.0, 80.0, 10.0, 40.0, 60.0, 50.0, 50.0, 100.0, 70.0, 20.0, 30.0, 30.0, 27.0, 17.0, 40.0, 40.0, 30.0, 20.0, 70.0, 40.0, 29.0, 19.0, 40.0, 90.0, 0.0, 120.0, 20.0, 50.0, 120.0, 90.0, 30.0, 130.0, 20.0, 0.0, 30.0, 50.0, 60.0, 60.0, -14.0, 140.0, 30.0, -117.0, 40.0, 40.0, 35.0, 120.0, 12.0, 40.0, 10.0, 0.0, 90.0, 70.0, 17.0, -7.0, 30.0, 50.0, 19.0, 38.0, 60.0, 30.0, 60.0, 30.0, 60.0, 50.0, 120.0, 20.0, 40.0, 10.0, 50.0, -10.0, 20.0, 10.0, 60.0, 60.0, 30.0, 20.0, 40.0, 20.0, 30.0, 10.0, 90.0, 50.0, 80.0, 50.0, 60.0, 80.0, 30.0, 80.0, 40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0, 60.0, -82.0, -37.0, 50.0, 50.0, 90.0, 40.0, 25.0, 10.0, 40.0, 9.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 120.0, 10.0, 30.0, 40.0, 100.0, 10.0, 60.0, 50.0, 20.0, 40.0, 20.0, 50.0, 50.0, 60.0, 70.0, 90.0, 50.0, 30.0, 60.0, 30.0, 100.0, 60.0, 60.0, 170.0, 40.0, -40.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 50.0, 60.0, 50.0, 30.0, 70.0, 50.0, 40.0, 70.0, 40.0, 50.0, 30.0, 30.0, 160.0, 20.0, 30.0, 50.0, 20.0, 40.0, 50.0, -1.0, 30.0, 50.0, 50.0, 60.0, 120.0, 130.0, 90.0, 20.0, 60.0, 80.0, 0.0, 59.0, 80.0, 20.0, 20.0, 30.0, 120.0, 40.0, 29.0, 117.0, 85.0, 0.0, 50.0, 70.0, -15.0, 30.0, 60.0, 22.0, 20.0, 30.0, 27.0, 22.0, 40.0, 29.0, 70.0, 50.0, 70.0, 50.0, 100.0, 49.0, 20.0, 70.0, 20.0, 80.0, 30.0, 70.0, 40.0, 20.0, 79.0, 90.0, 70.0, 30.0, 70.0, 80.0, 100.0, 38.0, 70.0, 71.0, 40.0, 80.0, 150.0, 53.0, 90.0, 35.0, 63.0, 40.0, 100.0, 50.0, 100.0, 50.0, 100.0, 50.0, 105.0, 96.0, 16.0, 4.0, 0.0, 100.0, 70.0, 0.0, 40.0, 20.0, 30.0, 37.0, 10.0, 70.0, 48.0, 76.0, 100.0, 40.0, 0.0, 70.0, 60.0, 80.0, 30.0, 60.0, 40.0, 20.0, 80.0, 4.0, 60.0, 80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0, 120.0, 50.0, 30.0, 160.0, 40.0, 15.0, 100.0, 24.0, 70.0, 100.0, 15.0, 20.0, 46.0, 20.0, 90.0, 29.0, 70.0, 110.0, 50.0, 104.0, 100.0, 40.0, 80.0, 68.0, 30.0, 39.0, 58.0, 60.0, 35.0, 80.0, 80.0, 60.0, 60.0, 40.0, 35.0, 30.0, 30.0, 50.0, 60.0, 50.0, 90.0, 60.0, 30.0, 90.0, 0.0, 27.0, 110.0, 140.0, 38.0, 90.0, -3.0, 70.0, 70.0, 30.0, 70.0, 30.0, 39.0, 10.0, 70.0, 28.0, 0.0, 30.0, 60.0, 60.0, 50.0, 70.0, 80.0, 20.0, 60.0, 0.0, -44.0, 19.0, 40.0, 30.0, 30.0, 18.0, 30.0, -34.0, 40.0, 90.0, 150.0, 110.0, 150.0, 55.0, 30.0, 60.0, 100.0, 70.0, 80.0, 60.0, 50.0, 40.0, 90.0, 20.0, -35.0, 50.0, 150.0, 50.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 80.0, 30.0, 110.0, 40.0, 50.0, 0.0, 100.0, 70.0, 70.0, 90.0, 20.0, 0.0, 50.0, 30.0, 40.0, 20.0, 30.0, 20.0, 70.0, 10.0, 30.0, 40.0, 30.0, 110.0, 50.0, 140.0, 80.0, 70.0, 50.0, 70.0, 50.0, 70.0, 80.0, 70.0, 78.0, 20.0, 60.0, 60.0, 60.0, 80.0, 50.0, 60.0, 150.0, 120.0, 90.0, 80.0, 20.0, 20.0, 10.0, 110.0, 70.0, 60.0, 0.0, 50.0, 10.0, 40.0, 60.0, 60.0, 70.0, 60.0, 60.0, 19.0, 50.0, 70.0, 110.0, 0.0, 50.0, 30.0, 30.0, 50.0, 40.0, 30.0, 18.0, 50.0, 29.0, 70.0, 50.0, 90.0, 49.0, -8.0, 40.0, 30.0, 16.0, 50.0, 120.0, 40.0, 40.0, 14.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 138.0, 40.0, 28.0, 17.0, 30.0, 60.0, 60.0, 100.0, 70.0, 80.0, 20.0, 50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0, 90.0, 60.0, 50.0, 40.0, 30.0, 20.0, 50.0, 70.0, 30.0, 60.0, 99.0, 30.0, -70.0, 47.0, 20.0, 60.0, 78.0, 8.0, 203.0, 48.0, 30.0, 30.0, 50.0, 40.0, 70.0, 70.0, 40.0, 80.0, 40.0, 50.0, 100.0, 50.0, 62.0, 71.0, 70.0, 10.0, 110.0, 20.0, 100.0, 110.0, 70.0, 40.0, 20.0, 30.0, 30.0, 60.0, 30.0, 50.0, 10.0, 30.0, 60.0, 110.0, 90.0, 15.0, 80.0, 100.0, 130.0, 80.0, 150.0, 130.0, 20.0, 110.0, 100.0, 50.0, 25.0, 50.0, 40.0, 80.0, -24.0, 100.0, 80.0, 80.0, 60.0, 60.0, 30.0, 70.0, 20.0, 47.0, 50.0, 40.0, 80.0, 110.0, 10.0, 50.0, 115.0, 40.0, 80.0, 20.0, 60.0, 40.0, 105.0, 80.0, 11.0, 60.0, 50.0, 19.0, 140.0, 32.0, 30.0, 70.0, 80.0, 50.0, 30.0, 70.0, 110.0, 50.0, 30.0, 70.0, 70.0, 40.0, 35.0, 30.0, 30.0, 10.0, 50.0, 34.0, 0.0, 80.0, 40.0, 30.0, 20.0, 40.0, 70.0, 60.0, 50.0, 60.0, 120.0, 40.0, 60.0, 30.0, 80.0, 40.0, 70.0, 60.0, 40.0, 80.0, 70.0, 50.0, 70.0, 120.0, 30.0, 60.0, 30.0, 20.0, 80.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 0.0, 52.0, 30.0, -135.0, 60.0, 80.0, 20.0, 40.0, -8.0, 0.0, 60.0, 100.0, 100.0, 120.0, 100.0, 57.0, 98.0, 40.0, 115.0, 90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0, 18.0, 50.0, 48.0, 140.0, 18.0, 19.0, 79.0, 60.0, 110.0, 40.0, 50.0, 130.0, 80.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 60.0, 99.0, 100.0, 70.0, 70.0, 30.0, 25.0, 50.0, 30.0, 60.0, 100.0, 50.0, 70.0, 120.0, 70.0, 40.0, 30.0, 50.0, 50.0, 60.0, 60.0, 30.0, 20.0, 80.0, 40.0, -22.0, 70.0, 60.0, -5.0, 90.0, 30.0, 100.0, 30.0, 59.0, 50.0, 50.0, 90.0, 20.0, 90.0, 70.0, 50.0, 70.0, 140.0, 50.0, 40.0, 80.0, 110.0, 60.0, 6.0, 100.0, 50.0, 70.0, 39.0, 70.0, 70.0, 36.0, 10.0, 69.0, 60.0, 49.0, -4.0, 60.0, 109.0, 27.0, 50.0, 50.0, 40.0, 80.0, 30.0, 50.0, 100.0, -1.0, 70.0, 110.0, 50.0, 80.0, 80.0, 0.0, 50.0, 0.0, 67.0, 28.0, 100.0, 11.0, 40.0, 60.0, 110.0, 47.0, 150.0, 100.0, 90.0, 60.0, 80.0, 20.0, 80.0, 50.0, 40.0, 30.0, -6.0, 70.0, 20.0, 30.0, 100.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 40.0, 40.0, 68.0, 60.0, 80.0, 80.0, 8.0, 20.0, 20.0, 70.0, 90.0, 15.0, 30.0, 70.0, 70.0, 50.0, 30.0, 38.0, 100.0, 80.0, 100.0, 62.0, 80.0, 70.0, 60.0, 80.0, 90.0, 80.0, 80.0, 47.0, 45.0, 100.0, 50.0, 60.0, 50.0, 15.0, 70.0, 120.0, 12.0, 80.0, 18.0, 50.0, 30.0, 14.0, 40.0, 19.0, 30.0, 79.0, 70.0, 50.0, 20.0, 35.0, 20.0, 40.0, 40.0, 60.0, 90.0, 10.0, 40.0, 70.0, 100.0, 70.0, 20.0, 110.0, 50.0, 70.0, 100.0, 20.0, 20.0, 70.0, 60.0, 60.0, 20.0, 100.0, 50.0, 20.0, 70.0, 90.0, 90.0, 60.0, 90.0, 60.0, 110.0, 90.0, 20.0, 20.0, 100.0, 40.0, 20.0, 30.0, -13.0, 29.0, 50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5584590999290295, "mean_inference_ms": 1.575482858866128, "mean_action_processing_ms": 0.4984440114714305, "mean_env_wait_ms": 1.3738855828255452, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013499736785888672, "StateBufferConnector_ms": 0.009055376052856445, "ViewRequirementAgentConnector_ms": 0.385498046875}, "num_episodes": 23, "episode_return_max": 945.0, "episode_return_min": 169.0, "episode_return_mean": 539.83}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.76834083760526, "num_env_steps_trained_throughput_per_sec": 21.76834083760526, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 184403.944, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184403.894, "sample_time_ms": 2363.507, "learn_time_ms": 182021.664, "learn_throughput": 21.975, "synch_weights_time_ms": 10.466}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "a22d3_00000", "date": "2024-08-06_03-53-17", "timestamp": 1722930797, "time_this_iter_s": 183.76330494880676, "time_total_s": 18588.90260720253, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16fc3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18588.90260720253, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.12346153846154, "ram_util_percent": 78.42076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.058628813362223, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.690118477367364, "policy_loss": -0.010991408112974633, "vf_loss": 6.699039208368498, "vf_explained_var": 0.013757972950879504, "kl": 0.006902238677093777, "entropy": 0.5720225152782739, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 945.0, "episode_reward_min": 169.0, "episode_reward_mean": 550.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 203.0}, "policy_reward_mean": {"policy_0": 55.004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [574.0, 246.0, 369.0, 440.0, 610.0, 470.0, 490.0, 429.0, 660.0, 600.0, 294.0, 500.0, 569.0, 729.0, 681.0, 481.0, 431.0, 504.0, 762.0, 709.0, 554.0, 590.0, 495.0, 675.0, 414.0, 430.0, 219.0, 865.0, 475.0, 560.0, 470.0, 410.0, 758.0, 750.0, 430.0, 599.0, 327.0, 507.0, 422.0, 505.0, 550.0, 500.0, 523.0, 500.0, 703.0, 370.0, 945.0, 551.0, 537.0, 605.0, 597.0, 600.0, 339.0, 550.0, 680.0, 470.0, 169.0, 790.0, 778.0, 582.0, 650.0, 634.0, 600.0, 393.0, 609.0, 706.0, 469.0, 596.0, 506.0, 736.0, 444.0, 420.0, 511.0, 630.0, 732.0, 525.0, 387.0, 540.0, 580.0, 650.0, 446.0, 455.0, 470.0, 574.0, 550.0, 691.0, 450.0, 546.0, 680.0, 670.0, 488.0, 687.0, 585.0, 473.0, 580.0, 659.0, 774.0, 489.0, 670.0, 407.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 40.0, 50.0, 37.0, 67.0, 50.0, 90.0, 70.0, 50.0, 80.0, 60.0, -82.0, -37.0, 50.0, 50.0, 90.0, 40.0, 25.0, 10.0, 40.0, 9.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 120.0, 10.0, 30.0, 40.0, 100.0, 10.0, 60.0, 50.0, 20.0, 40.0, 20.0, 50.0, 50.0, 60.0, 70.0, 90.0, 50.0, 30.0, 60.0, 30.0, 100.0, 60.0, 60.0, 170.0, 40.0, -40.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 50.0, 60.0, 50.0, 30.0, 70.0, 50.0, 40.0, 70.0, 40.0, 50.0, 30.0, 30.0, 160.0, 20.0, 30.0, 50.0, 20.0, 40.0, 50.0, -1.0, 30.0, 50.0, 50.0, 60.0, 120.0, 130.0, 90.0, 20.0, 60.0, 80.0, 0.0, 59.0, 80.0, 20.0, 20.0, 30.0, 120.0, 40.0, 29.0, 117.0, 85.0, 0.0, 50.0, 70.0, -15.0, 30.0, 60.0, 22.0, 20.0, 30.0, 27.0, 22.0, 40.0, 29.0, 70.0, 50.0, 70.0, 50.0, 100.0, 49.0, 20.0, 70.0, 20.0, 80.0, 30.0, 70.0, 40.0, 20.0, 79.0, 90.0, 70.0, 30.0, 70.0, 80.0, 100.0, 38.0, 70.0, 71.0, 40.0, 80.0, 150.0, 53.0, 90.0, 35.0, 63.0, 40.0, 100.0, 50.0, 100.0, 50.0, 100.0, 50.0, 105.0, 96.0, 16.0, 4.0, 0.0, 100.0, 70.0, 0.0, 40.0, 20.0, 30.0, 37.0, 10.0, 70.0, 48.0, 76.0, 100.0, 40.0, 0.0, 70.0, 60.0, 80.0, 30.0, 60.0, 40.0, 20.0, 80.0, 4.0, 60.0, 80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0, 120.0, 50.0, 30.0, 160.0, 40.0, 15.0, 100.0, 24.0, 70.0, 100.0, 15.0, 20.0, 46.0, 20.0, 90.0, 29.0, 70.0, 110.0, 50.0, 104.0, 100.0, 40.0, 80.0, 68.0, 30.0, 39.0, 58.0, 60.0, 35.0, 80.0, 80.0, 60.0, 60.0, 40.0, 35.0, 30.0, 30.0, 50.0, 60.0, 50.0, 90.0, 60.0, 30.0, 90.0, 0.0, 27.0, 110.0, 140.0, 38.0, 90.0, -3.0, 70.0, 70.0, 30.0, 70.0, 30.0, 39.0, 10.0, 70.0, 28.0, 0.0, 30.0, 60.0, 60.0, 50.0, 70.0, 80.0, 20.0, 60.0, 0.0, -44.0, 19.0, 40.0, 30.0, 30.0, 18.0, 30.0, -34.0, 40.0, 90.0, 150.0, 110.0, 150.0, 55.0, 30.0, 60.0, 100.0, 70.0, 80.0, 60.0, 50.0, 40.0, 90.0, 20.0, -35.0, 50.0, 150.0, 50.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 80.0, 30.0, 110.0, 40.0, 50.0, 0.0, 100.0, 70.0, 70.0, 90.0, 20.0, 0.0, 50.0, 30.0, 40.0, 20.0, 30.0, 20.0, 70.0, 10.0, 30.0, 40.0, 30.0, 110.0, 50.0, 140.0, 80.0, 70.0, 50.0, 70.0, 50.0, 70.0, 80.0, 70.0, 78.0, 20.0, 60.0, 60.0, 60.0, 80.0, 50.0, 60.0, 150.0, 120.0, 90.0, 80.0, 20.0, 20.0, 10.0, 110.0, 70.0, 60.0, 0.0, 50.0, 10.0, 40.0, 60.0, 60.0, 70.0, 60.0, 60.0, 19.0, 50.0, 70.0, 110.0, 0.0, 50.0, 30.0, 30.0, 50.0, 40.0, 30.0, 18.0, 50.0, 29.0, 70.0, 50.0, 90.0, 49.0, -8.0, 40.0, 30.0, 16.0, 50.0, 120.0, 40.0, 40.0, 14.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 138.0, 40.0, 28.0, 17.0, 30.0, 60.0, 60.0, 100.0, 70.0, 80.0, 20.0, 50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0, 90.0, 60.0, 50.0, 40.0, 30.0, 20.0, 50.0, 70.0, 30.0, 60.0, 99.0, 30.0, -70.0, 47.0, 20.0, 60.0, 78.0, 8.0, 203.0, 48.0, 30.0, 30.0, 50.0, 40.0, 70.0, 70.0, 40.0, 80.0, 40.0, 50.0, 100.0, 50.0, 62.0, 71.0, 70.0, 10.0, 110.0, 20.0, 100.0, 110.0, 70.0, 40.0, 20.0, 30.0, 30.0, 60.0, 30.0, 50.0, 10.0, 30.0, 60.0, 110.0, 90.0, 15.0, 80.0, 100.0, 130.0, 80.0, 150.0, 130.0, 20.0, 110.0, 100.0, 50.0, 25.0, 50.0, 40.0, 80.0, -24.0, 100.0, 80.0, 80.0, 60.0, 60.0, 30.0, 70.0, 20.0, 47.0, 50.0, 40.0, 80.0, 110.0, 10.0, 50.0, 115.0, 40.0, 80.0, 20.0, 60.0, 40.0, 105.0, 80.0, 11.0, 60.0, 50.0, 19.0, 140.0, 32.0, 30.0, 70.0, 80.0, 50.0, 30.0, 70.0, 110.0, 50.0, 30.0, 70.0, 70.0, 40.0, 35.0, 30.0, 30.0, 10.0, 50.0, 34.0, 0.0, 80.0, 40.0, 30.0, 20.0, 40.0, 70.0, 60.0, 50.0, 60.0, 120.0, 40.0, 60.0, 30.0, 80.0, 40.0, 70.0, 60.0, 40.0, 80.0, 70.0, 50.0, 70.0, 120.0, 30.0, 60.0, 30.0, 20.0, 80.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 0.0, 52.0, 30.0, -135.0, 60.0, 80.0, 20.0, 40.0, -8.0, 0.0, 60.0, 100.0, 100.0, 120.0, 100.0, 57.0, 98.0, 40.0, 115.0, 90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0, 18.0, 50.0, 48.0, 140.0, 18.0, 19.0, 79.0, 60.0, 110.0, 40.0, 50.0, 130.0, 80.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 60.0, 99.0, 100.0, 70.0, 70.0, 30.0, 25.0, 50.0, 30.0, 60.0, 100.0, 50.0, 70.0, 120.0, 70.0, 40.0, 30.0, 50.0, 50.0, 60.0, 60.0, 30.0, 20.0, 80.0, 40.0, -22.0, 70.0, 60.0, -5.0, 90.0, 30.0, 100.0, 30.0, 59.0, 50.0, 50.0, 90.0, 20.0, 90.0, 70.0, 50.0, 70.0, 140.0, 50.0, 40.0, 80.0, 110.0, 60.0, 6.0, 100.0, 50.0, 70.0, 39.0, 70.0, 70.0, 36.0, 10.0, 69.0, 60.0, 49.0, -4.0, 60.0, 109.0, 27.0, 50.0, 50.0, 40.0, 80.0, 30.0, 50.0, 100.0, -1.0, 70.0, 110.0, 50.0, 80.0, 80.0, 0.0, 50.0, 0.0, 67.0, 28.0, 100.0, 11.0, 40.0, 60.0, 110.0, 47.0, 150.0, 100.0, 90.0, 60.0, 80.0, 20.0, 80.0, 50.0, 40.0, 30.0, -6.0, 70.0, 20.0, 30.0, 100.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 40.0, 40.0, 68.0, 60.0, 80.0, 80.0, 8.0, 20.0, 20.0, 70.0, 90.0, 15.0, 30.0, 70.0, 70.0, 50.0, 30.0, 38.0, 100.0, 80.0, 100.0, 62.0, 80.0, 70.0, 60.0, 80.0, 90.0, 80.0, 80.0, 47.0, 45.0, 100.0, 50.0, 60.0, 50.0, 15.0, 70.0, 120.0, 12.0, 80.0, 18.0, 50.0, 30.0, 14.0, 40.0, 19.0, 30.0, 79.0, 70.0, 50.0, 20.0, 35.0, 20.0, 40.0, 40.0, 60.0, 90.0, 10.0, 40.0, 70.0, 100.0, 70.0, 20.0, 110.0, 50.0, 70.0, 100.0, 20.0, 20.0, 70.0, 60.0, 60.0, 20.0, 100.0, 50.0, 20.0, 70.0, 90.0, 90.0, 60.0, 90.0, 60.0, 110.0, 90.0, 20.0, 20.0, 100.0, 40.0, 20.0, 30.0, -13.0, 29.0, 50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0, 60.0, -20.0, 50.0, 30.0, 70.0, 50.0, 20.0, 80.0, 80.0, 50.0, 30.0, 80.0, 47.0, 80.0, 80.0, 20.0, 170.0, 59.0, 23.0, -15.0, 50.0, 40.0, 60.0, 20.0, 50.0, 50.0, 60.0, 80.0, 90.0, 50.0, 67.0, 66.0, 59.0, 30.0, 110.0, 79.0, 95.0, 80.0, 25.0, 80.0, 30.0, 50.0, 30.0, 50.0, 30.0, 80.0, 40.0, 70.0, 50.0, 20.0, 29.0, 90.0, 10.0, 46.0, 80.0, 120.0, 55.0, 20.0, 46.0, 50.0, 60.0, 30.0, 70.0, 110.0, 70.0, 50.0, 80.0, 100.0, 40.0, 70.0, 100.0, 60.0, 100.0, 50.0, 100.0, -40.0, 30.0, 30.0, 130.0, 110.0, 20.0, 80.0, 60.0, 89.0, 10.0, 90.0, 60.0, 20.0, 30.0, 29.0, 9.0, 110.0, 80.0, 44.0, 30.0, 130.0, 40.0, 100.0, 80.0, 64.0, 70.0, 70.0, 90.0, 80.0, 20.0, 40.0, 50.0, 80.0, 25.0, 60.0, 90.0, -8.0, 12.0, 20.0, 110.0, 50.0, 9.0, 30.0, 50.0, 110.0, 40.0, 26.0, 20.0, 34.0, 40.0, 50.0, 60.0, 80.0, 90.0, 140.0, 40.0, 60.0, 120.0, 90.0, 70.0, 110.0, 39.0, 20.0, 50.0, 60.0, 30.0, 100.0, 190.0, 60.0, 18.0, 40.0, 26.0, 120.0, 90.0, 100.0, 40.0, 40.0, 50.0, 10.0, 60.0, 40.0, 60.0, 50.0, 110.0, 29.0, 50.0, 70.0, 60.0, 100.0, 40.0, 80.0, 60.0, 40.0, 50.0, 120.0, 20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5572885396081266, "mean_inference_ms": 1.573586201623093, "mean_action_processing_ms": 0.49776204318987893, "mean_env_wait_ms": 1.3723760145562793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013494729995727539, "StateBufferConnector_ms": 0.008995771408081055, "ViewRequirementAgentConnector_ms": 0.38062238693237305}, "num_episodes": 18, "episode_return_max": 945.0, "episode_return_min": 169.0, "episode_return_mean": 550.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.748684050440712, "num_env_steps_trained_throughput_per_sec": 21.748684050440712, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 184373.601, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184373.552, "sample_time_ms": 2346.923, "learn_time_ms": 182007.604, "learn_throughput": 21.977, "synch_weights_time_ms": 10.547}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "a22d3_00000", "date": "2024-08-06_03-56-21", "timestamp": 1722930981, "time_this_iter_s": 183.92642784118652, "time_total_s": 18772.829035043716, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16fc0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18772.829035043716, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.43076923076923, "ram_util_percent": 78.80576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9644813725806145, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.146229352686986, "policy_loss": -0.011505500296566187, "vf_loss": 6.155446703466998, "vf_explained_var": 0.013790656202517378, "kl": 0.007627140043437403, "entropy": 0.6249145301798789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 945.0, "episode_reward_min": 169.0, "episode_reward_mean": 557.32, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 203.0}, "policy_reward_mean": {"policy_0": 55.732}, "custom_metrics": {}, "hist_stats": {"episode_reward": [762.0, 709.0, 554.0, 590.0, 495.0, 675.0, 414.0, 430.0, 219.0, 865.0, 475.0, 560.0, 470.0, 410.0, 758.0, 750.0, 430.0, 599.0, 327.0, 507.0, 422.0, 505.0, 550.0, 500.0, 523.0, 500.0, 703.0, 370.0, 945.0, 551.0, 537.0, 605.0, 597.0, 600.0, 339.0, 550.0, 680.0, 470.0, 169.0, 790.0, 778.0, 582.0, 650.0, 634.0, 600.0, 393.0, 609.0, 706.0, 469.0, 596.0, 506.0, 736.0, 444.0, 420.0, 511.0, 630.0, 732.0, 525.0, 387.0, 540.0, 580.0, 650.0, 446.0, 455.0, 470.0, 574.0, 550.0, 691.0, 450.0, 546.0, 680.0, 670.0, 488.0, 687.0, 585.0, 473.0, 580.0, 659.0, 774.0, 489.0, 670.0, 407.0, 350.0, 219.0, 646.0, 649.0, 780.0, 430.0, 722.0, 356.0, 738.0, 786.0, 417.0, 690.0, 488.0, 455.0, 784.0, 508.0, 267.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 2.0, 84.0, 160.0, 80.0, 13.0, 90.0, 43.0, 70.0, 140.0, 120.0, 50.0, 30.0, 160.0, 40.0, 15.0, 100.0, 24.0, 70.0, 100.0, 15.0, 20.0, 46.0, 20.0, 90.0, 29.0, 70.0, 110.0, 50.0, 104.0, 100.0, 40.0, 80.0, 68.0, 30.0, 39.0, 58.0, 60.0, 35.0, 80.0, 80.0, 60.0, 60.0, 40.0, 35.0, 30.0, 30.0, 50.0, 60.0, 50.0, 90.0, 60.0, 30.0, 90.0, 0.0, 27.0, 110.0, 140.0, 38.0, 90.0, -3.0, 70.0, 70.0, 30.0, 70.0, 30.0, 39.0, 10.0, 70.0, 28.0, 0.0, 30.0, 60.0, 60.0, 50.0, 70.0, 80.0, 20.0, 60.0, 0.0, -44.0, 19.0, 40.0, 30.0, 30.0, 18.0, 30.0, -34.0, 40.0, 90.0, 150.0, 110.0, 150.0, 55.0, 30.0, 60.0, 100.0, 70.0, 80.0, 60.0, 50.0, 40.0, 90.0, 20.0, -35.0, 50.0, 150.0, 50.0, 30.0, 30.0, 20.0, 70.0, 70.0, 50.0, 40.0, 80.0, 30.0, 110.0, 40.0, 50.0, 0.0, 100.0, 70.0, 70.0, 90.0, 20.0, 0.0, 50.0, 30.0, 40.0, 20.0, 30.0, 20.0, 70.0, 10.0, 30.0, 40.0, 30.0, 110.0, 50.0, 140.0, 80.0, 70.0, 50.0, 70.0, 50.0, 70.0, 80.0, 70.0, 78.0, 20.0, 60.0, 60.0, 60.0, 80.0, 50.0, 60.0, 150.0, 120.0, 90.0, 80.0, 20.0, 20.0, 10.0, 110.0, 70.0, 60.0, 0.0, 50.0, 10.0, 40.0, 60.0, 60.0, 70.0, 60.0, 60.0, 19.0, 50.0, 70.0, 110.0, 0.0, 50.0, 30.0, 30.0, 50.0, 40.0, 30.0, 18.0, 50.0, 29.0, 70.0, 50.0, 90.0, 49.0, -8.0, 40.0, 30.0, 16.0, 50.0, 120.0, 40.0, 40.0, 14.0, 40.0, 40.0, 30.0, 30.0, 20.0, 30.0, 138.0, 40.0, 28.0, 17.0, 30.0, 60.0, 60.0, 100.0, 70.0, 80.0, 20.0, 50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0, 90.0, 60.0, 50.0, 40.0, 30.0, 20.0, 50.0, 70.0, 30.0, 60.0, 99.0, 30.0, -70.0, 47.0, 20.0, 60.0, 78.0, 8.0, 203.0, 48.0, 30.0, 30.0, 50.0, 40.0, 70.0, 70.0, 40.0, 80.0, 40.0, 50.0, 100.0, 50.0, 62.0, 71.0, 70.0, 10.0, 110.0, 20.0, 100.0, 110.0, 70.0, 40.0, 20.0, 30.0, 30.0, 60.0, 30.0, 50.0, 10.0, 30.0, 60.0, 110.0, 90.0, 15.0, 80.0, 100.0, 130.0, 80.0, 150.0, 130.0, 20.0, 110.0, 100.0, 50.0, 25.0, 50.0, 40.0, 80.0, -24.0, 100.0, 80.0, 80.0, 60.0, 60.0, 30.0, 70.0, 20.0, 47.0, 50.0, 40.0, 80.0, 110.0, 10.0, 50.0, 115.0, 40.0, 80.0, 20.0, 60.0, 40.0, 105.0, 80.0, 11.0, 60.0, 50.0, 19.0, 140.0, 32.0, 30.0, 70.0, 80.0, 50.0, 30.0, 70.0, 110.0, 50.0, 30.0, 70.0, 70.0, 40.0, 35.0, 30.0, 30.0, 10.0, 50.0, 34.0, 0.0, 80.0, 40.0, 30.0, 20.0, 40.0, 70.0, 60.0, 50.0, 60.0, 120.0, 40.0, 60.0, 30.0, 80.0, 40.0, 70.0, 60.0, 40.0, 80.0, 70.0, 50.0, 70.0, 120.0, 30.0, 60.0, 30.0, 20.0, 80.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 0.0, 52.0, 30.0, -135.0, 60.0, 80.0, 20.0, 40.0, -8.0, 0.0, 60.0, 100.0, 100.0, 120.0, 100.0, 57.0, 98.0, 40.0, 115.0, 90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0, 18.0, 50.0, 48.0, 140.0, 18.0, 19.0, 79.0, 60.0, 110.0, 40.0, 50.0, 130.0, 80.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 60.0, 99.0, 100.0, 70.0, 70.0, 30.0, 25.0, 50.0, 30.0, 60.0, 100.0, 50.0, 70.0, 120.0, 70.0, 40.0, 30.0, 50.0, 50.0, 60.0, 60.0, 30.0, 20.0, 80.0, 40.0, -22.0, 70.0, 60.0, -5.0, 90.0, 30.0, 100.0, 30.0, 59.0, 50.0, 50.0, 90.0, 20.0, 90.0, 70.0, 50.0, 70.0, 140.0, 50.0, 40.0, 80.0, 110.0, 60.0, 6.0, 100.0, 50.0, 70.0, 39.0, 70.0, 70.0, 36.0, 10.0, 69.0, 60.0, 49.0, -4.0, 60.0, 109.0, 27.0, 50.0, 50.0, 40.0, 80.0, 30.0, 50.0, 100.0, -1.0, 70.0, 110.0, 50.0, 80.0, 80.0, 0.0, 50.0, 0.0, 67.0, 28.0, 100.0, 11.0, 40.0, 60.0, 110.0, 47.0, 150.0, 100.0, 90.0, 60.0, 80.0, 20.0, 80.0, 50.0, 40.0, 30.0, -6.0, 70.0, 20.0, 30.0, 100.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 40.0, 40.0, 68.0, 60.0, 80.0, 80.0, 8.0, 20.0, 20.0, 70.0, 90.0, 15.0, 30.0, 70.0, 70.0, 50.0, 30.0, 38.0, 100.0, 80.0, 100.0, 62.0, 80.0, 70.0, 60.0, 80.0, 90.0, 80.0, 80.0, 47.0, 45.0, 100.0, 50.0, 60.0, 50.0, 15.0, 70.0, 120.0, 12.0, 80.0, 18.0, 50.0, 30.0, 14.0, 40.0, 19.0, 30.0, 79.0, 70.0, 50.0, 20.0, 35.0, 20.0, 40.0, 40.0, 60.0, 90.0, 10.0, 40.0, 70.0, 100.0, 70.0, 20.0, 110.0, 50.0, 70.0, 100.0, 20.0, 20.0, 70.0, 60.0, 60.0, 20.0, 100.0, 50.0, 20.0, 70.0, 90.0, 90.0, 60.0, 90.0, 60.0, 110.0, 90.0, 20.0, 20.0, 100.0, 40.0, 20.0, 30.0, -13.0, 29.0, 50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0, 60.0, -20.0, 50.0, 30.0, 70.0, 50.0, 20.0, 80.0, 80.0, 50.0, 30.0, 80.0, 47.0, 80.0, 80.0, 20.0, 170.0, 59.0, 23.0, -15.0, 50.0, 40.0, 60.0, 20.0, 50.0, 50.0, 60.0, 80.0, 90.0, 50.0, 67.0, 66.0, 59.0, 30.0, 110.0, 79.0, 95.0, 80.0, 25.0, 80.0, 30.0, 50.0, 30.0, 50.0, 30.0, 80.0, 40.0, 70.0, 50.0, 20.0, 29.0, 90.0, 10.0, 46.0, 80.0, 120.0, 55.0, 20.0, 46.0, 50.0, 60.0, 30.0, 70.0, 110.0, 70.0, 50.0, 80.0, 100.0, 40.0, 70.0, 100.0, 60.0, 100.0, 50.0, 100.0, -40.0, 30.0, 30.0, 130.0, 110.0, 20.0, 80.0, 60.0, 89.0, 10.0, 90.0, 60.0, 20.0, 30.0, 29.0, 9.0, 110.0, 80.0, 44.0, 30.0, 130.0, 40.0, 100.0, 80.0, 64.0, 70.0, 70.0, 90.0, 80.0, 20.0, 40.0, 50.0, 80.0, 25.0, 60.0, 90.0, -8.0, 12.0, 20.0, 110.0, 50.0, 9.0, 30.0, 50.0, 110.0, 40.0, 26.0, 20.0, 34.0, 40.0, 50.0, 60.0, 80.0, 90.0, 140.0, 40.0, 60.0, 120.0, 90.0, 70.0, 110.0, 39.0, 20.0, 50.0, 60.0, 30.0, 100.0, 190.0, 60.0, 18.0, 40.0, 26.0, 120.0, 90.0, 100.0, 40.0, 40.0, 50.0, 10.0, 60.0, 40.0, 60.0, 50.0, 110.0, 29.0, 50.0, 70.0, 60.0, 100.0, 40.0, 80.0, 60.0, 40.0, 50.0, 120.0, 20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0, 80.0, 40.0, 50.0, 20.0, 40.0, 0.0, 40.0, 40.0, 20.0, 20.0, -80.0, 60.0, 30.0, 120.0, 7.0, 20.0, 50.0, -98.0, 60.0, 50.0, 50.0, 50.0, 15.0, 90.0, 80.0, 30.0, 110.0, 51.0, 60.0, 110.0, 70.0, 10.0, 69.0, 100.0, 75.0, 30.0, 110.0, 50.0, 70.0, 65.0, 50.0, 70.0, 50.0, 100.0, 140.0, 90.0, 110.0, 70.0, 70.0, 30.0, 20.0, 80.0, 30.0, 20.0, 70.0, 80.0, 10.0, 40.0, 50.0, 30.0, 100.0, 70.0, 61.0, 43.0, 90.0, 60.0, 60.0, 88.0, 60.0, 90.0, 69.0, 50.0, -150.0, 50.0, 70.0, 40.0, 90.0, 30.0, 30.0, 77.0, 100.0, 80.0, 90.0, 78.0, 60.0, 20.0, 140.0, 90.0, 50.0, 30.0, 80.0, 60.0, 70.0, 88.0, 70.0, 40.0, 98.0, 120.0, 80.0, 80.0, 17.0, 20.0, 20.0, 140.0, 70.0, -7.0, 47.0, 40.0, 40.0, 30.0, 60.0, 100.0, 100.0, 70.0, 80.0, 40.0, 60.0, 70.0, 80.0, 30.0, 20.0, 80.0, 60.0, 10.0, 50.0, 60.0, 39.0, 80.0, 20.0, 69.0, 90.0, 40.0, 54.0, 40.0, 50.0, -47.0, -12.0, 100.0, 50.0, 90.0, 140.0, 80.0, 58.0, 90.0, 40.0, 137.0, 25.0, 150.0, 44.0, 20.0, 70.0, 30.0, 60.0, 100.0, 40.0, 38.0, 36.0, 69.0, 60.0, 5.0, 0.0, -53.0, 15.0, -54.0, 20.0, 100.0, 60.0, 30.0, 89.0, 60.0, 80.0, 30.0, 90.0, 20.0, 50.0, 60.0, 40.0, 140.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5561562122476646, "mean_inference_ms": 1.5720369309898052, "mean_action_processing_ms": 0.4971659950345266, "mean_env_wait_ms": 1.3710145739624784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011645317077636719, "StateBufferConnector_ms": 0.009081602096557617, "ViewRequirementAgentConnector_ms": 0.37474989891052246}, "num_episodes": 18, "episode_return_max": 945.0, "episode_return_min": 169.0, "episode_return_mean": 557.32}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.500525569396707, "num_env_steps_trained_throughput_per_sec": 21.500525569396707, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 184630.347, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184630.297, "sample_time_ms": 2369.477, "learn_time_ms": 182241.818, "learn_throughput": 21.949, "synch_weights_time_ms": 10.5}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "a22d3_00000", "date": "2024-08-06_03-59-27", "timestamp": 1722931167, "time_this_iter_s": 186.04906010627747, "time_total_s": 18958.878095149994, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16fcb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18958.878095149994, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 19.854372623574147, "ram_util_percent": 79.31977186311788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.748425854337863, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.551585642395182, "policy_loss": -0.010971589119389804, "vf_loss": 5.560397089276705, "vf_explained_var": 0.013527181620795886, "kl": 0.007200453438175138, "entropy": 0.6455403528813991, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 945.0, "episode_reward_min": 169.0, "episode_reward_mean": 552.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 203.0}, "policy_reward_mean": {"policy_0": 55.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.0, 500.0, 523.0, 500.0, 703.0, 370.0, 945.0, 551.0, 537.0, 605.0, 597.0, 600.0, 339.0, 550.0, 680.0, 470.0, 169.0, 790.0, 778.0, 582.0, 650.0, 634.0, 600.0, 393.0, 609.0, 706.0, 469.0, 596.0, 506.0, 736.0, 444.0, 420.0, 511.0, 630.0, 732.0, 525.0, 387.0, 540.0, 580.0, 650.0, 446.0, 455.0, 470.0, 574.0, 550.0, 691.0, 450.0, 546.0, 680.0, 670.0, 488.0, 687.0, 585.0, 473.0, 580.0, 659.0, 774.0, 489.0, 670.0, 407.0, 350.0, 219.0, 646.0, 649.0, 780.0, 430.0, 722.0, 356.0, 738.0, 786.0, 417.0, 690.0, 488.0, 455.0, 784.0, 508.0, 267.0, 520.0, 515.0, 680.0, 804.0, 240.0, 750.0, 570.0, 481.0, 599.0, 492.0, 435.0, 494.0, 655.0, 692.0, 433.0, 350.0, 475.0, 533.0, 650.0, 421.0, 327.0, 410.0, 418.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 70.0, 50.0, 10.0, 60.0, 70.0, 70.0, 60.0, 40.0, 70.0, 90.0, 60.0, 50.0, 40.0, 30.0, 20.0, 50.0, 70.0, 30.0, 60.0, 99.0, 30.0, -70.0, 47.0, 20.0, 60.0, 78.0, 8.0, 203.0, 48.0, 30.0, 30.0, 50.0, 40.0, 70.0, 70.0, 40.0, 80.0, 40.0, 50.0, 100.0, 50.0, 62.0, 71.0, 70.0, 10.0, 110.0, 20.0, 100.0, 110.0, 70.0, 40.0, 20.0, 30.0, 30.0, 60.0, 30.0, 50.0, 10.0, 30.0, 60.0, 110.0, 90.0, 15.0, 80.0, 100.0, 130.0, 80.0, 150.0, 130.0, 20.0, 110.0, 100.0, 50.0, 25.0, 50.0, 40.0, 80.0, -24.0, 100.0, 80.0, 80.0, 60.0, 60.0, 30.0, 70.0, 20.0, 47.0, 50.0, 40.0, 80.0, 110.0, 10.0, 50.0, 115.0, 40.0, 80.0, 20.0, 60.0, 40.0, 105.0, 80.0, 11.0, 60.0, 50.0, 19.0, 140.0, 32.0, 30.0, 70.0, 80.0, 50.0, 30.0, 70.0, 110.0, 50.0, 30.0, 70.0, 70.0, 40.0, 35.0, 30.0, 30.0, 10.0, 50.0, 34.0, 0.0, 80.0, 40.0, 30.0, 20.0, 40.0, 70.0, 60.0, 50.0, 60.0, 120.0, 40.0, 60.0, 30.0, 80.0, 40.0, 70.0, 60.0, 40.0, 80.0, 70.0, 50.0, 70.0, 120.0, 30.0, 60.0, 30.0, 20.0, 80.0, 30.0, 60.0, 20.0, 30.0, 110.0, 30.0, 0.0, 52.0, 30.0, -135.0, 60.0, 80.0, 20.0, 40.0, -8.0, 0.0, 60.0, 100.0, 100.0, 120.0, 100.0, 57.0, 98.0, 40.0, 115.0, 90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0, 18.0, 50.0, 48.0, 140.0, 18.0, 19.0, 79.0, 60.0, 110.0, 40.0, 50.0, 130.0, 80.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 60.0, 99.0, 100.0, 70.0, 70.0, 30.0, 25.0, 50.0, 30.0, 60.0, 100.0, 50.0, 70.0, 120.0, 70.0, 40.0, 30.0, 50.0, 50.0, 60.0, 60.0, 30.0, 20.0, 80.0, 40.0, -22.0, 70.0, 60.0, -5.0, 90.0, 30.0, 100.0, 30.0, 59.0, 50.0, 50.0, 90.0, 20.0, 90.0, 70.0, 50.0, 70.0, 140.0, 50.0, 40.0, 80.0, 110.0, 60.0, 6.0, 100.0, 50.0, 70.0, 39.0, 70.0, 70.0, 36.0, 10.0, 69.0, 60.0, 49.0, -4.0, 60.0, 109.0, 27.0, 50.0, 50.0, 40.0, 80.0, 30.0, 50.0, 100.0, -1.0, 70.0, 110.0, 50.0, 80.0, 80.0, 0.0, 50.0, 0.0, 67.0, 28.0, 100.0, 11.0, 40.0, 60.0, 110.0, 47.0, 150.0, 100.0, 90.0, 60.0, 80.0, 20.0, 80.0, 50.0, 40.0, 30.0, -6.0, 70.0, 20.0, 30.0, 100.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 40.0, 40.0, 68.0, 60.0, 80.0, 80.0, 8.0, 20.0, 20.0, 70.0, 90.0, 15.0, 30.0, 70.0, 70.0, 50.0, 30.0, 38.0, 100.0, 80.0, 100.0, 62.0, 80.0, 70.0, 60.0, 80.0, 90.0, 80.0, 80.0, 47.0, 45.0, 100.0, 50.0, 60.0, 50.0, 15.0, 70.0, 120.0, 12.0, 80.0, 18.0, 50.0, 30.0, 14.0, 40.0, 19.0, 30.0, 79.0, 70.0, 50.0, 20.0, 35.0, 20.0, 40.0, 40.0, 60.0, 90.0, 10.0, 40.0, 70.0, 100.0, 70.0, 20.0, 110.0, 50.0, 70.0, 100.0, 20.0, 20.0, 70.0, 60.0, 60.0, 20.0, 100.0, 50.0, 20.0, 70.0, 90.0, 90.0, 60.0, 90.0, 60.0, 110.0, 90.0, 20.0, 20.0, 100.0, 40.0, 20.0, 30.0, -13.0, 29.0, 50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0, 60.0, -20.0, 50.0, 30.0, 70.0, 50.0, 20.0, 80.0, 80.0, 50.0, 30.0, 80.0, 47.0, 80.0, 80.0, 20.0, 170.0, 59.0, 23.0, -15.0, 50.0, 40.0, 60.0, 20.0, 50.0, 50.0, 60.0, 80.0, 90.0, 50.0, 67.0, 66.0, 59.0, 30.0, 110.0, 79.0, 95.0, 80.0, 25.0, 80.0, 30.0, 50.0, 30.0, 50.0, 30.0, 80.0, 40.0, 70.0, 50.0, 20.0, 29.0, 90.0, 10.0, 46.0, 80.0, 120.0, 55.0, 20.0, 46.0, 50.0, 60.0, 30.0, 70.0, 110.0, 70.0, 50.0, 80.0, 100.0, 40.0, 70.0, 100.0, 60.0, 100.0, 50.0, 100.0, -40.0, 30.0, 30.0, 130.0, 110.0, 20.0, 80.0, 60.0, 89.0, 10.0, 90.0, 60.0, 20.0, 30.0, 29.0, 9.0, 110.0, 80.0, 44.0, 30.0, 130.0, 40.0, 100.0, 80.0, 64.0, 70.0, 70.0, 90.0, 80.0, 20.0, 40.0, 50.0, 80.0, 25.0, 60.0, 90.0, -8.0, 12.0, 20.0, 110.0, 50.0, 9.0, 30.0, 50.0, 110.0, 40.0, 26.0, 20.0, 34.0, 40.0, 50.0, 60.0, 80.0, 90.0, 140.0, 40.0, 60.0, 120.0, 90.0, 70.0, 110.0, 39.0, 20.0, 50.0, 60.0, 30.0, 100.0, 190.0, 60.0, 18.0, 40.0, 26.0, 120.0, 90.0, 100.0, 40.0, 40.0, 50.0, 10.0, 60.0, 40.0, 60.0, 50.0, 110.0, 29.0, 50.0, 70.0, 60.0, 100.0, 40.0, 80.0, 60.0, 40.0, 50.0, 120.0, 20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0, 80.0, 40.0, 50.0, 20.0, 40.0, 0.0, 40.0, 40.0, 20.0, 20.0, -80.0, 60.0, 30.0, 120.0, 7.0, 20.0, 50.0, -98.0, 60.0, 50.0, 50.0, 50.0, 15.0, 90.0, 80.0, 30.0, 110.0, 51.0, 60.0, 110.0, 70.0, 10.0, 69.0, 100.0, 75.0, 30.0, 110.0, 50.0, 70.0, 65.0, 50.0, 70.0, 50.0, 100.0, 140.0, 90.0, 110.0, 70.0, 70.0, 30.0, 20.0, 80.0, 30.0, 20.0, 70.0, 80.0, 10.0, 40.0, 50.0, 30.0, 100.0, 70.0, 61.0, 43.0, 90.0, 60.0, 60.0, 88.0, 60.0, 90.0, 69.0, 50.0, -150.0, 50.0, 70.0, 40.0, 90.0, 30.0, 30.0, 77.0, 100.0, 80.0, 90.0, 78.0, 60.0, 20.0, 140.0, 90.0, 50.0, 30.0, 80.0, 60.0, 70.0, 88.0, 70.0, 40.0, 98.0, 120.0, 80.0, 80.0, 17.0, 20.0, 20.0, 140.0, 70.0, -7.0, 47.0, 40.0, 40.0, 30.0, 60.0, 100.0, 100.0, 70.0, 80.0, 40.0, 60.0, 70.0, 80.0, 30.0, 20.0, 80.0, 60.0, 10.0, 50.0, 60.0, 39.0, 80.0, 20.0, 69.0, 90.0, 40.0, 54.0, 40.0, 50.0, -47.0, -12.0, 100.0, 50.0, 90.0, 140.0, 80.0, 58.0, 90.0, 40.0, 137.0, 25.0, 150.0, 44.0, 20.0, 70.0, 30.0, 60.0, 100.0, 40.0, 38.0, 36.0, 69.0, 60.0, 5.0, 0.0, -53.0, 15.0, -54.0, 20.0, 100.0, 60.0, 30.0, 89.0, 60.0, 80.0, 30.0, 90.0, 20.0, 50.0, 60.0, 40.0, 140.0, 0.0, 10.0, 70.0, 100.0, 70.0, 70.0, 17.0, 40.0, 18.0, 70.0, 20.0, 40.0, 70.0, 80.0, 110.0, 50.0, 0.0, 60.0, 70.0, 90.0, 80.0, 70.0, 120.0, 49.0, 80.0, 50.0, 80.0, 65.0, 70.0, 100.0, 100.0, 90.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 70.0, 50.0, 90.0, 150.0, 90.0, 20.0, 30.0, 10.0, 100.0, 60.0, 150.0, 30.0, 100.0, 30.0, 70.0, 30.0, 50.0, 40.0, 110.0, 60.0, 50.0, 48.0, 49.0, 100.0, 32.0, 49.0, 0.0, 80.0, 40.0, 80.0, 3.0, 40.0, 60.0, 90.0, 70.0, 60.0, 79.0, 70.0, 40.0, 40.0, 50.0, 40.0, -16.0, 60.0, 38.0, 20.0, 70.0, 70.0, 110.0, 80.0, 20.0, 32.0, 24.0, 130.0, 10.0, 50.0, 45.0, 50.0, 80.0, 6.0, 8.0, 120.0, 56.0, 30.0, 20.0, 10.0, 48.0, 50.0, 50.0, 70.0, 40.0, 50.0, 60.0, 48.0, 50.0, 110.0, 100.0, 60.0, 87.0, 60.0, 30.0, 46.0, 120.0, 46.0, 60.0, 30.0, 100.0, 50.0, 70.0, 50.0, 120.0, 20.0, 20.0, 80.0, 29.0, 9.0, 51.0, -14.0, 100.0, 90.0, 48.0, 20.0, 50.0, 20.0, 0.0, 80.0, 60.0, 0.0, 30.0, 40.0, 50.0, 50.0, 65.0, 10.0, 80.0, 80.0, 60.0, 50.0, 40.0, 40.0, 0.0, 40.0, 20.0, 80.0, 10.0, 70.0, 100.0, 70.0, 100.0, 11.0, 32.0, 120.0, 60.0, 110.0, 63.0, 70.0, 90.0, 20.0, 29.0, 40.0, 48.0, 19.0, 2.0, 20.0, 70.0, 70.0, 20.0, 60.0, 20.0, 70.0, 70.0, 4.0, 13.0, 60.0, 80.0, 80.0, 20.0, 25.0, 60.0, 0.0, -15.0, 60.0, 70.0, 80.0, 70.0, 35.0, 20.0, 40.0, 60.0, 30.0, -55.0, 90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5547599693569365, "mean_inference_ms": 1.5702485073767076, "mean_action_processing_ms": 0.49644485946786915, "mean_env_wait_ms": 1.3693597236247166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012937784194946289, "StateBufferConnector_ms": 0.00934290885925293, "ViewRequirementAgentConnector_ms": 0.3811969757080078}, "num_episodes": 22, "episode_return_max": 945.0, "episode_return_min": 169.0, "episode_return_mean": 552.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.604649575968722, "num_env_steps_trained_throughput_per_sec": 21.604649575968722, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 184595.785, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184595.735, "sample_time_ms": 2375.853, "learn_time_ms": 182199.721, "learn_throughput": 21.954, "synch_weights_time_ms": 11.757}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "a22d3_00000", "date": "2024-08-06_04-02-32", "timestamp": 1722931352, "time_this_iter_s": 185.15293288230896, "time_total_s": 19144.031028032303, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a6280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19144.031028032303, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 18.990458015267176, "ram_util_percent": 78.73282442748094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.806501863647701, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.862126399914677, "policy_loss": -0.010877298765158215, "vf_loss": 5.870822542747116, "vf_explained_var": 0.007451121348796434, "kl": 0.007270520968486781, "entropy": 0.6153085774887865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 849.0, "episode_reward_min": 219.0, "episode_reward_mean": 540.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 54.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.0, 582.0, 650.0, 634.0, 600.0, 393.0, 609.0, 706.0, 469.0, 596.0, 506.0, 736.0, 444.0, 420.0, 511.0, 630.0, 732.0, 525.0, 387.0, 540.0, 580.0, 650.0, 446.0, 455.0, 470.0, 574.0, 550.0, 691.0, 450.0, 546.0, 680.0, 670.0, 488.0, 687.0, 585.0, 473.0, 580.0, 659.0, 774.0, 489.0, 670.0, 407.0, 350.0, 219.0, 646.0, 649.0, 780.0, 430.0, 722.0, 356.0, 738.0, 786.0, 417.0, 690.0, 488.0, 455.0, 784.0, 508.0, 267.0, 520.0, 515.0, 680.0, 804.0, 240.0, 750.0, 570.0, 481.0, 599.0, 492.0, 435.0, 494.0, 655.0, 692.0, 433.0, 350.0, 475.0, 533.0, 650.0, 421.0, 327.0, 410.0, 418.0, 630.0, 587.0, 429.0, 390.0, 479.0, 310.0, 461.0, 849.0, 540.0, 608.0, 583.0, 270.0, 330.0, 590.0, 298.0, 740.0, 290.0, 460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 42.0, 100.0, 70.0, 50.0, 140.0, 80.0, 50.0, 70.0, 86.0, 18.0, 50.0, 48.0, 140.0, 18.0, 19.0, 79.0, 60.0, 110.0, 40.0, 50.0, 130.0, 80.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 60.0, 99.0, 100.0, 70.0, 70.0, 30.0, 25.0, 50.0, 30.0, 60.0, 100.0, 50.0, 70.0, 120.0, 70.0, 40.0, 30.0, 50.0, 50.0, 60.0, 60.0, 30.0, 20.0, 80.0, 40.0, -22.0, 70.0, 60.0, -5.0, 90.0, 30.0, 100.0, 30.0, 59.0, 50.0, 50.0, 90.0, 20.0, 90.0, 70.0, 50.0, 70.0, 140.0, 50.0, 40.0, 80.0, 110.0, 60.0, 6.0, 100.0, 50.0, 70.0, 39.0, 70.0, 70.0, 36.0, 10.0, 69.0, 60.0, 49.0, -4.0, 60.0, 109.0, 27.0, 50.0, 50.0, 40.0, 80.0, 30.0, 50.0, 100.0, -1.0, 70.0, 110.0, 50.0, 80.0, 80.0, 0.0, 50.0, 0.0, 67.0, 28.0, 100.0, 11.0, 40.0, 60.0, 110.0, 47.0, 150.0, 100.0, 90.0, 60.0, 80.0, 20.0, 80.0, 50.0, 40.0, 30.0, -6.0, 70.0, 20.0, 30.0, 100.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 40.0, 40.0, 68.0, 60.0, 80.0, 80.0, 8.0, 20.0, 20.0, 70.0, 90.0, 15.0, 30.0, 70.0, 70.0, 50.0, 30.0, 38.0, 100.0, 80.0, 100.0, 62.0, 80.0, 70.0, 60.0, 80.0, 90.0, 80.0, 80.0, 47.0, 45.0, 100.0, 50.0, 60.0, 50.0, 15.0, 70.0, 120.0, 12.0, 80.0, 18.0, 50.0, 30.0, 14.0, 40.0, 19.0, 30.0, 79.0, 70.0, 50.0, 20.0, 35.0, 20.0, 40.0, 40.0, 60.0, 90.0, 10.0, 40.0, 70.0, 100.0, 70.0, 20.0, 110.0, 50.0, 70.0, 100.0, 20.0, 20.0, 70.0, 60.0, 60.0, 20.0, 100.0, 50.0, 20.0, 70.0, 90.0, 90.0, 60.0, 90.0, 60.0, 110.0, 90.0, 20.0, 20.0, 100.0, 40.0, 20.0, 30.0, -13.0, 29.0, 50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0, 60.0, -20.0, 50.0, 30.0, 70.0, 50.0, 20.0, 80.0, 80.0, 50.0, 30.0, 80.0, 47.0, 80.0, 80.0, 20.0, 170.0, 59.0, 23.0, -15.0, 50.0, 40.0, 60.0, 20.0, 50.0, 50.0, 60.0, 80.0, 90.0, 50.0, 67.0, 66.0, 59.0, 30.0, 110.0, 79.0, 95.0, 80.0, 25.0, 80.0, 30.0, 50.0, 30.0, 50.0, 30.0, 80.0, 40.0, 70.0, 50.0, 20.0, 29.0, 90.0, 10.0, 46.0, 80.0, 120.0, 55.0, 20.0, 46.0, 50.0, 60.0, 30.0, 70.0, 110.0, 70.0, 50.0, 80.0, 100.0, 40.0, 70.0, 100.0, 60.0, 100.0, 50.0, 100.0, -40.0, 30.0, 30.0, 130.0, 110.0, 20.0, 80.0, 60.0, 89.0, 10.0, 90.0, 60.0, 20.0, 30.0, 29.0, 9.0, 110.0, 80.0, 44.0, 30.0, 130.0, 40.0, 100.0, 80.0, 64.0, 70.0, 70.0, 90.0, 80.0, 20.0, 40.0, 50.0, 80.0, 25.0, 60.0, 90.0, -8.0, 12.0, 20.0, 110.0, 50.0, 9.0, 30.0, 50.0, 110.0, 40.0, 26.0, 20.0, 34.0, 40.0, 50.0, 60.0, 80.0, 90.0, 140.0, 40.0, 60.0, 120.0, 90.0, 70.0, 110.0, 39.0, 20.0, 50.0, 60.0, 30.0, 100.0, 190.0, 60.0, 18.0, 40.0, 26.0, 120.0, 90.0, 100.0, 40.0, 40.0, 50.0, 10.0, 60.0, 40.0, 60.0, 50.0, 110.0, 29.0, 50.0, 70.0, 60.0, 100.0, 40.0, 80.0, 60.0, 40.0, 50.0, 120.0, 20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0, 80.0, 40.0, 50.0, 20.0, 40.0, 0.0, 40.0, 40.0, 20.0, 20.0, -80.0, 60.0, 30.0, 120.0, 7.0, 20.0, 50.0, -98.0, 60.0, 50.0, 50.0, 50.0, 15.0, 90.0, 80.0, 30.0, 110.0, 51.0, 60.0, 110.0, 70.0, 10.0, 69.0, 100.0, 75.0, 30.0, 110.0, 50.0, 70.0, 65.0, 50.0, 70.0, 50.0, 100.0, 140.0, 90.0, 110.0, 70.0, 70.0, 30.0, 20.0, 80.0, 30.0, 20.0, 70.0, 80.0, 10.0, 40.0, 50.0, 30.0, 100.0, 70.0, 61.0, 43.0, 90.0, 60.0, 60.0, 88.0, 60.0, 90.0, 69.0, 50.0, -150.0, 50.0, 70.0, 40.0, 90.0, 30.0, 30.0, 77.0, 100.0, 80.0, 90.0, 78.0, 60.0, 20.0, 140.0, 90.0, 50.0, 30.0, 80.0, 60.0, 70.0, 88.0, 70.0, 40.0, 98.0, 120.0, 80.0, 80.0, 17.0, 20.0, 20.0, 140.0, 70.0, -7.0, 47.0, 40.0, 40.0, 30.0, 60.0, 100.0, 100.0, 70.0, 80.0, 40.0, 60.0, 70.0, 80.0, 30.0, 20.0, 80.0, 60.0, 10.0, 50.0, 60.0, 39.0, 80.0, 20.0, 69.0, 90.0, 40.0, 54.0, 40.0, 50.0, -47.0, -12.0, 100.0, 50.0, 90.0, 140.0, 80.0, 58.0, 90.0, 40.0, 137.0, 25.0, 150.0, 44.0, 20.0, 70.0, 30.0, 60.0, 100.0, 40.0, 38.0, 36.0, 69.0, 60.0, 5.0, 0.0, -53.0, 15.0, -54.0, 20.0, 100.0, 60.0, 30.0, 89.0, 60.0, 80.0, 30.0, 90.0, 20.0, 50.0, 60.0, 40.0, 140.0, 0.0, 10.0, 70.0, 100.0, 70.0, 70.0, 17.0, 40.0, 18.0, 70.0, 20.0, 40.0, 70.0, 80.0, 110.0, 50.0, 0.0, 60.0, 70.0, 90.0, 80.0, 70.0, 120.0, 49.0, 80.0, 50.0, 80.0, 65.0, 70.0, 100.0, 100.0, 90.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 70.0, 50.0, 90.0, 150.0, 90.0, 20.0, 30.0, 10.0, 100.0, 60.0, 150.0, 30.0, 100.0, 30.0, 70.0, 30.0, 50.0, 40.0, 110.0, 60.0, 50.0, 48.0, 49.0, 100.0, 32.0, 49.0, 0.0, 80.0, 40.0, 80.0, 3.0, 40.0, 60.0, 90.0, 70.0, 60.0, 79.0, 70.0, 40.0, 40.0, 50.0, 40.0, -16.0, 60.0, 38.0, 20.0, 70.0, 70.0, 110.0, 80.0, 20.0, 32.0, 24.0, 130.0, 10.0, 50.0, 45.0, 50.0, 80.0, 6.0, 8.0, 120.0, 56.0, 30.0, 20.0, 10.0, 48.0, 50.0, 50.0, 70.0, 40.0, 50.0, 60.0, 48.0, 50.0, 110.0, 100.0, 60.0, 87.0, 60.0, 30.0, 46.0, 120.0, 46.0, 60.0, 30.0, 100.0, 50.0, 70.0, 50.0, 120.0, 20.0, 20.0, 80.0, 29.0, 9.0, 51.0, -14.0, 100.0, 90.0, 48.0, 20.0, 50.0, 20.0, 0.0, 80.0, 60.0, 0.0, 30.0, 40.0, 50.0, 50.0, 65.0, 10.0, 80.0, 80.0, 60.0, 50.0, 40.0, 40.0, 0.0, 40.0, 20.0, 80.0, 10.0, 70.0, 100.0, 70.0, 100.0, 11.0, 32.0, 120.0, 60.0, 110.0, 63.0, 70.0, 90.0, 20.0, 29.0, 40.0, 48.0, 19.0, 2.0, 20.0, 70.0, 70.0, 20.0, 60.0, 20.0, 70.0, 70.0, 4.0, 13.0, 60.0, 80.0, 80.0, 20.0, 25.0, 60.0, 0.0, -15.0, 60.0, 70.0, 80.0, 70.0, 35.0, 20.0, 40.0, 60.0, 30.0, -55.0, 90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0, 30.0, 110.0, 20.0, 60.0, 50.0, 100.0, 80.0, 50.0, 70.0, 60.0, 70.0, 15.0, 20.0, 58.0, 38.0, 80.0, 60.0, 120.0, 36.0, 90.0, 30.0, 25.0, 40.0, 90.0, 70.0, 40.0, 2.0, 70.0, 22.0, 40.0, 50.0, 50.0, 30.0, 0.0, 40.0, 30.0, 20.0, 80.0, 50.0, 40.0, 80.0, 20.0, 40.0, 150.0, 30.0, 34.0, 40.0, 20.0, 25.0, 40.0, 30.0, 70.0, 20.0, 10.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 100.0, 6.0, 50.0, 70.0, 150.0, 20.0, -28.0, 10.0, 3.0, 110.0, 120.0, 117.0, 10.0, 110.0, 90.0, 80.0, 72.0, 60.0, 80.0, 110.0, 50.0, 100.0, 0.0, 50.0, 70.0, 30.0, 80.0, 10.0, 40.0, 70.0, 30.0, 50.0, 40.0, 90.0, 110.0, 40.0, 98.0, 60.0, 20.0, 60.0, 50.0, 100.0, 50.0, 40.0, 120.0, 38.0, 40.0, 15.0, 70.0, 0.0, 30.0, 40.0, 10.0, 30.0, 20.0, 70.0, 20.0, 10.0, 40.0, 40.0, 120.0, 30.0, 10.0, 40.0, 40.0, 30.0, -70.0, 50.0, 40.0, 60.0, 100.0, 90.0, 80.0, 40.0, 40.0, 40.0, 30.0, 60.0, 50.0, 0.0, 40.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 8.0, 0.0, 50.0, 80.0, 100.0, 80.0, 20.0, 140.0, 80.0, 50.0, 100.0, 40.0, 50.0, 60.0, 30.0, 0.0, 20.0, 0.0, 50.0, 40.0, 20.0, 20.0, 70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5538321760738267, "mean_inference_ms": 1.568796670278155, "mean_action_processing_ms": 0.49589445999094567, "mean_env_wait_ms": 1.3680530340890034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013096094131469727, "StateBufferConnector_ms": 0.009395122528076172, "ViewRequirementAgentConnector_ms": 0.39789533615112305}, "num_episodes": 18, "episode_return_max": 849.0, "episode_return_min": 219.0, "episode_return_mean": 540.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.70457582429514, "num_env_steps_trained_throughput_per_sec": 21.70457582429514, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 184490.159, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184490.11, "sample_time_ms": 2408.241, "learn_time_ms": 182061.453, "learn_throughput": 21.971, "synch_weights_time_ms": 12.06}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "a22d3_00000", "date": "2024-08-06_04-05-37", "timestamp": 1722931537, "time_this_iter_s": 184.3045938014984, "time_total_s": 19328.3356218338, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a60d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19328.3356218338, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 17.284615384615385, "ram_util_percent": 76.95500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7063468755370637, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.074294722143708, "policy_loss": -0.010630470559499856, "vf_loss": 6.08281101190244, "vf_explained_var": 0.007835190174297783, "kl": 0.007047248688189172, "entropy": 0.5904826933583512, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 941.0, "episode_reward_min": 30.0, "episode_reward_mean": 538.36, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 53.836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [455.0, 470.0, 574.0, 550.0, 691.0, 450.0, 546.0, 680.0, 670.0, 488.0, 687.0, 585.0, 473.0, 580.0, 659.0, 774.0, 489.0, 670.0, 407.0, 350.0, 219.0, 646.0, 649.0, 780.0, 430.0, 722.0, 356.0, 738.0, 786.0, 417.0, 690.0, 488.0, 455.0, 784.0, 508.0, 267.0, 520.0, 515.0, 680.0, 804.0, 240.0, 750.0, 570.0, 481.0, 599.0, 492.0, 435.0, 494.0, 655.0, 692.0, 433.0, 350.0, 475.0, 533.0, 650.0, 421.0, 327.0, 410.0, 418.0, 630.0, 587.0, 429.0, 390.0, 479.0, 310.0, 461.0, 849.0, 540.0, 608.0, 583.0, 270.0, 330.0, 590.0, 298.0, 740.0, 290.0, 460.0, 444.0, 400.0, 500.0, 30.0, 529.0, 551.0, 571.0, 899.0, 760.0, 510.0, 570.0, 660.0, 598.0, 566.0, 619.0, 398.0, 710.0, 560.0, 715.0, 440.0, 941.0, 382.0, 512.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, -5.0, 70.0, 50.0, 20.0, 50.0, 50.0, 30.0, 60.0, 80.0, 60.0, -20.0, 50.0, 30.0, 70.0, 50.0, 20.0, 80.0, 80.0, 50.0, 30.0, 80.0, 47.0, 80.0, 80.0, 20.0, 170.0, 59.0, 23.0, -15.0, 50.0, 40.0, 60.0, 20.0, 50.0, 50.0, 60.0, 80.0, 90.0, 50.0, 67.0, 66.0, 59.0, 30.0, 110.0, 79.0, 95.0, 80.0, 25.0, 80.0, 30.0, 50.0, 30.0, 50.0, 30.0, 80.0, 40.0, 70.0, 50.0, 20.0, 29.0, 90.0, 10.0, 46.0, 80.0, 120.0, 55.0, 20.0, 46.0, 50.0, 60.0, 30.0, 70.0, 110.0, 70.0, 50.0, 80.0, 100.0, 40.0, 70.0, 100.0, 60.0, 100.0, 50.0, 100.0, -40.0, 30.0, 30.0, 130.0, 110.0, 20.0, 80.0, 60.0, 89.0, 10.0, 90.0, 60.0, 20.0, 30.0, 29.0, 9.0, 110.0, 80.0, 44.0, 30.0, 130.0, 40.0, 100.0, 80.0, 64.0, 70.0, 70.0, 90.0, 80.0, 20.0, 40.0, 50.0, 80.0, 25.0, 60.0, 90.0, -8.0, 12.0, 20.0, 110.0, 50.0, 9.0, 30.0, 50.0, 110.0, 40.0, 26.0, 20.0, 34.0, 40.0, 50.0, 60.0, 80.0, 90.0, 140.0, 40.0, 60.0, 120.0, 90.0, 70.0, 110.0, 39.0, 20.0, 50.0, 60.0, 30.0, 100.0, 190.0, 60.0, 18.0, 40.0, 26.0, 120.0, 90.0, 100.0, 40.0, 40.0, 50.0, 10.0, 60.0, 40.0, 60.0, 50.0, 110.0, 29.0, 50.0, 70.0, 60.0, 100.0, 40.0, 80.0, 60.0, 40.0, 50.0, 120.0, 20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0, 80.0, 40.0, 50.0, 20.0, 40.0, 0.0, 40.0, 40.0, 20.0, 20.0, -80.0, 60.0, 30.0, 120.0, 7.0, 20.0, 50.0, -98.0, 60.0, 50.0, 50.0, 50.0, 15.0, 90.0, 80.0, 30.0, 110.0, 51.0, 60.0, 110.0, 70.0, 10.0, 69.0, 100.0, 75.0, 30.0, 110.0, 50.0, 70.0, 65.0, 50.0, 70.0, 50.0, 100.0, 140.0, 90.0, 110.0, 70.0, 70.0, 30.0, 20.0, 80.0, 30.0, 20.0, 70.0, 80.0, 10.0, 40.0, 50.0, 30.0, 100.0, 70.0, 61.0, 43.0, 90.0, 60.0, 60.0, 88.0, 60.0, 90.0, 69.0, 50.0, -150.0, 50.0, 70.0, 40.0, 90.0, 30.0, 30.0, 77.0, 100.0, 80.0, 90.0, 78.0, 60.0, 20.0, 140.0, 90.0, 50.0, 30.0, 80.0, 60.0, 70.0, 88.0, 70.0, 40.0, 98.0, 120.0, 80.0, 80.0, 17.0, 20.0, 20.0, 140.0, 70.0, -7.0, 47.0, 40.0, 40.0, 30.0, 60.0, 100.0, 100.0, 70.0, 80.0, 40.0, 60.0, 70.0, 80.0, 30.0, 20.0, 80.0, 60.0, 10.0, 50.0, 60.0, 39.0, 80.0, 20.0, 69.0, 90.0, 40.0, 54.0, 40.0, 50.0, -47.0, -12.0, 100.0, 50.0, 90.0, 140.0, 80.0, 58.0, 90.0, 40.0, 137.0, 25.0, 150.0, 44.0, 20.0, 70.0, 30.0, 60.0, 100.0, 40.0, 38.0, 36.0, 69.0, 60.0, 5.0, 0.0, -53.0, 15.0, -54.0, 20.0, 100.0, 60.0, 30.0, 89.0, 60.0, 80.0, 30.0, 90.0, 20.0, 50.0, 60.0, 40.0, 140.0, 0.0, 10.0, 70.0, 100.0, 70.0, 70.0, 17.0, 40.0, 18.0, 70.0, 20.0, 40.0, 70.0, 80.0, 110.0, 50.0, 0.0, 60.0, 70.0, 90.0, 80.0, 70.0, 120.0, 49.0, 80.0, 50.0, 80.0, 65.0, 70.0, 100.0, 100.0, 90.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 70.0, 50.0, 90.0, 150.0, 90.0, 20.0, 30.0, 10.0, 100.0, 60.0, 150.0, 30.0, 100.0, 30.0, 70.0, 30.0, 50.0, 40.0, 110.0, 60.0, 50.0, 48.0, 49.0, 100.0, 32.0, 49.0, 0.0, 80.0, 40.0, 80.0, 3.0, 40.0, 60.0, 90.0, 70.0, 60.0, 79.0, 70.0, 40.0, 40.0, 50.0, 40.0, -16.0, 60.0, 38.0, 20.0, 70.0, 70.0, 110.0, 80.0, 20.0, 32.0, 24.0, 130.0, 10.0, 50.0, 45.0, 50.0, 80.0, 6.0, 8.0, 120.0, 56.0, 30.0, 20.0, 10.0, 48.0, 50.0, 50.0, 70.0, 40.0, 50.0, 60.0, 48.0, 50.0, 110.0, 100.0, 60.0, 87.0, 60.0, 30.0, 46.0, 120.0, 46.0, 60.0, 30.0, 100.0, 50.0, 70.0, 50.0, 120.0, 20.0, 20.0, 80.0, 29.0, 9.0, 51.0, -14.0, 100.0, 90.0, 48.0, 20.0, 50.0, 20.0, 0.0, 80.0, 60.0, 0.0, 30.0, 40.0, 50.0, 50.0, 65.0, 10.0, 80.0, 80.0, 60.0, 50.0, 40.0, 40.0, 0.0, 40.0, 20.0, 80.0, 10.0, 70.0, 100.0, 70.0, 100.0, 11.0, 32.0, 120.0, 60.0, 110.0, 63.0, 70.0, 90.0, 20.0, 29.0, 40.0, 48.0, 19.0, 2.0, 20.0, 70.0, 70.0, 20.0, 60.0, 20.0, 70.0, 70.0, 4.0, 13.0, 60.0, 80.0, 80.0, 20.0, 25.0, 60.0, 0.0, -15.0, 60.0, 70.0, 80.0, 70.0, 35.0, 20.0, 40.0, 60.0, 30.0, -55.0, 90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0, 30.0, 110.0, 20.0, 60.0, 50.0, 100.0, 80.0, 50.0, 70.0, 60.0, 70.0, 15.0, 20.0, 58.0, 38.0, 80.0, 60.0, 120.0, 36.0, 90.0, 30.0, 25.0, 40.0, 90.0, 70.0, 40.0, 2.0, 70.0, 22.0, 40.0, 50.0, 50.0, 30.0, 0.0, 40.0, 30.0, 20.0, 80.0, 50.0, 40.0, 80.0, 20.0, 40.0, 150.0, 30.0, 34.0, 40.0, 20.0, 25.0, 40.0, 30.0, 70.0, 20.0, 10.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 100.0, 6.0, 50.0, 70.0, 150.0, 20.0, -28.0, 10.0, 3.0, 110.0, 120.0, 117.0, 10.0, 110.0, 90.0, 80.0, 72.0, 60.0, 80.0, 110.0, 50.0, 100.0, 0.0, 50.0, 70.0, 30.0, 80.0, 10.0, 40.0, 70.0, 30.0, 50.0, 40.0, 90.0, 110.0, 40.0, 98.0, 60.0, 20.0, 60.0, 50.0, 100.0, 50.0, 40.0, 120.0, 38.0, 40.0, 15.0, 70.0, 0.0, 30.0, 40.0, 10.0, 30.0, 20.0, 70.0, 20.0, 10.0, 40.0, 40.0, 120.0, 30.0, 10.0, 40.0, 40.0, 30.0, -70.0, 50.0, 40.0, 60.0, 100.0, 90.0, 80.0, 40.0, 40.0, 40.0, 30.0, 60.0, 50.0, 0.0, 40.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 8.0, 0.0, 50.0, 80.0, 100.0, 80.0, 20.0, 140.0, 80.0, 50.0, 100.0, 40.0, 50.0, 60.0, 30.0, 0.0, 20.0, 0.0, 50.0, 40.0, 20.0, 20.0, 70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0, 10.0, 37.0, 110.0, 27.0, 90.0, 20.0, 20.0, 33.0, 27.0, 70.0, 10.0, 20.0, 10.0, 50.0, 0.0, 100.0, 50.0, 80.0, 50.0, 30.0, 15.0, 60.0, 20.0, 20.0, 90.0, 110.0, 90.0, 35.0, 40.0, 20.0, -64.0, -78.0, -31.0, 10.0, 84.0, 0.0, 9.0, 30.0, 40.0, 30.0, 30.0, 100.0, 50.0, 60.0, 10.0, 60.0, 50.0, 80.0, 49.0, 40.0, 50.0, 110.0, 24.0, 30.0, 30.0, 17.0, 130.0, 40.0, 80.0, 40.0, 56.0, 73.0, 60.0, 80.0, 80.0, 3.0, 29.0, 90.0, 60.0, 40.0, 120.0, 100.0, 90.0, 100.0, 190.0, 110.0, 60.0, 39.0, 60.0, 30.0, 60.0, 110.0, 90.0, 110.0, 60.0, 70.0, 50.0, 60.0, 80.0, 70.0, 10.0, 30.0, 40.0, 30.0, 60.0, 20.0, 70.0, 70.0, 70.0, 110.0, 10.0, 70.0, 50.0, 30.0, 30.0, 70.0, 150.0, 30.0, 60.0, 70.0, 90.0, 40.0, 20.0, 110.0, 100.0, 40.0, 70.0, 60.0, 90.0, 40.0, -4.0, -13.0, 9.0, 80.0, 78.0, 110.0, 70.0, 120.0, 40.0, 108.0, 100.0, 48.0, 20.0, 70.0, 49.0, 71.0, 60.0, 60.0, 90.0, -2.0, 50.0, 40.0, 130.0, 80.0, 40.0, 40.0, 20.0, 90.0, 49.0, 80.0, 30.0, 10.0, 19.0, 30.0, 39.0, 100.0, 50.0, 50.0, 40.0, 30.0, 140.0, 70.0, 20.0, 80.0, 60.0, 60.0, 120.0, 50.0, 60.0, 50.0, 70.0, 90.0, 30.0, 30.0, 110.0, 30.0, 30.0, 80.0, 20.0, 70.0, 100.0, 25.0, 50.0, 80.0, 90.0, 100.0, 30.0, 50.0, 100.0, 90.0, 20.0, 70.0, 30.0, 30.0, 40.0, 90.0, 60.0, 80.0, 10.0, 10.0, 90.0, 87.0, 100.0, 150.0, 130.0, 40.0, 100.0, 90.0, 84.0, 70.0, 30.0, 40.0, 118.0, 9.0, 70.0, 20.0, 55.0, 20.0, 20.0, 0.0, 70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5525392108584586, "mean_inference_ms": 1.5669647058937166, "mean_action_processing_ms": 0.4952376578763967, "mean_env_wait_ms": 1.3665013235773693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013131141662597656, "StateBufferConnector_ms": 0.009615421295166016, "ViewRequirementAgentConnector_ms": 0.39656591415405273}, "num_episodes": 23, "episode_return_max": 941.0, "episode_return_min": 30.0, "episode_return_mean": 538.36}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.702982678689235, "num_env_steps_trained_throughput_per_sec": 21.702982678689235, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 184468.92, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184468.87, "sample_time_ms": 2401.508, "learn_time_ms": 182047.558, "learn_throughput": 21.972, "synch_weights_time_ms": 11.471}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "a22d3_00000", "date": "2024-08-06_04-08-41", "timestamp": 1722931721, "time_this_iter_s": 184.31556916236877, "time_total_s": 19512.65119099617, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19512.65119099617, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.966283524904213, "ram_util_percent": 77.68582375478927}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7656470613421216, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.230431027762806, "policy_loss": -0.011927404561991525, "vf_loss": 6.240128854948619, "vf_explained_var": 0.008914584460984658, "kl": 0.007431920980918744, "entropy": 0.5702633906413699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 941.0, "episode_reward_min": 30.0, "episode_reward_mean": 532.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 53.214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [407.0, 350.0, 219.0, 646.0, 649.0, 780.0, 430.0, 722.0, 356.0, 738.0, 786.0, 417.0, 690.0, 488.0, 455.0, 784.0, 508.0, 267.0, 520.0, 515.0, 680.0, 804.0, 240.0, 750.0, 570.0, 481.0, 599.0, 492.0, 435.0, 494.0, 655.0, 692.0, 433.0, 350.0, 475.0, 533.0, 650.0, 421.0, 327.0, 410.0, 418.0, 630.0, 587.0, 429.0, 390.0, 479.0, 310.0, 461.0, 849.0, 540.0, 608.0, 583.0, 270.0, 330.0, 590.0, 298.0, 740.0, 290.0, 460.0, 444.0, 400.0, 500.0, 30.0, 529.0, 551.0, 571.0, 899.0, 760.0, 510.0, 570.0, 660.0, 598.0, 566.0, 619.0, 398.0, 710.0, 560.0, 715.0, 440.0, 941.0, 382.0, 512.0, 561.0, 549.0, 368.0, 553.0, 507.0, 680.0, 612.0, 604.0, 573.0, 540.0, 590.0, 617.0, 368.0, 396.0, 720.0, 517.0, 499.0, 615.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 70.0, 10.0, 80.0, -18.0, 90.0, 90.0, 90.0, -25.0, 80.0, 40.0, 50.0, 20.0, 40.0, 0.0, 40.0, 40.0, 20.0, 20.0, -80.0, 60.0, 30.0, 120.0, 7.0, 20.0, 50.0, -98.0, 60.0, 50.0, 50.0, 50.0, 15.0, 90.0, 80.0, 30.0, 110.0, 51.0, 60.0, 110.0, 70.0, 10.0, 69.0, 100.0, 75.0, 30.0, 110.0, 50.0, 70.0, 65.0, 50.0, 70.0, 50.0, 100.0, 140.0, 90.0, 110.0, 70.0, 70.0, 30.0, 20.0, 80.0, 30.0, 20.0, 70.0, 80.0, 10.0, 40.0, 50.0, 30.0, 100.0, 70.0, 61.0, 43.0, 90.0, 60.0, 60.0, 88.0, 60.0, 90.0, 69.0, 50.0, -150.0, 50.0, 70.0, 40.0, 90.0, 30.0, 30.0, 77.0, 100.0, 80.0, 90.0, 78.0, 60.0, 20.0, 140.0, 90.0, 50.0, 30.0, 80.0, 60.0, 70.0, 88.0, 70.0, 40.0, 98.0, 120.0, 80.0, 80.0, 17.0, 20.0, 20.0, 140.0, 70.0, -7.0, 47.0, 40.0, 40.0, 30.0, 60.0, 100.0, 100.0, 70.0, 80.0, 40.0, 60.0, 70.0, 80.0, 30.0, 20.0, 80.0, 60.0, 10.0, 50.0, 60.0, 39.0, 80.0, 20.0, 69.0, 90.0, 40.0, 54.0, 40.0, 50.0, -47.0, -12.0, 100.0, 50.0, 90.0, 140.0, 80.0, 58.0, 90.0, 40.0, 137.0, 25.0, 150.0, 44.0, 20.0, 70.0, 30.0, 60.0, 100.0, 40.0, 38.0, 36.0, 69.0, 60.0, 5.0, 0.0, -53.0, 15.0, -54.0, 20.0, 100.0, 60.0, 30.0, 89.0, 60.0, 80.0, 30.0, 90.0, 20.0, 50.0, 60.0, 40.0, 140.0, 0.0, 10.0, 70.0, 100.0, 70.0, 70.0, 17.0, 40.0, 18.0, 70.0, 20.0, 40.0, 70.0, 80.0, 110.0, 50.0, 0.0, 60.0, 70.0, 90.0, 80.0, 70.0, 120.0, 49.0, 80.0, 50.0, 80.0, 65.0, 70.0, 100.0, 100.0, 90.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 70.0, 50.0, 90.0, 150.0, 90.0, 20.0, 30.0, 10.0, 100.0, 60.0, 150.0, 30.0, 100.0, 30.0, 70.0, 30.0, 50.0, 40.0, 110.0, 60.0, 50.0, 48.0, 49.0, 100.0, 32.0, 49.0, 0.0, 80.0, 40.0, 80.0, 3.0, 40.0, 60.0, 90.0, 70.0, 60.0, 79.0, 70.0, 40.0, 40.0, 50.0, 40.0, -16.0, 60.0, 38.0, 20.0, 70.0, 70.0, 110.0, 80.0, 20.0, 32.0, 24.0, 130.0, 10.0, 50.0, 45.0, 50.0, 80.0, 6.0, 8.0, 120.0, 56.0, 30.0, 20.0, 10.0, 48.0, 50.0, 50.0, 70.0, 40.0, 50.0, 60.0, 48.0, 50.0, 110.0, 100.0, 60.0, 87.0, 60.0, 30.0, 46.0, 120.0, 46.0, 60.0, 30.0, 100.0, 50.0, 70.0, 50.0, 120.0, 20.0, 20.0, 80.0, 29.0, 9.0, 51.0, -14.0, 100.0, 90.0, 48.0, 20.0, 50.0, 20.0, 0.0, 80.0, 60.0, 0.0, 30.0, 40.0, 50.0, 50.0, 65.0, 10.0, 80.0, 80.0, 60.0, 50.0, 40.0, 40.0, 0.0, 40.0, 20.0, 80.0, 10.0, 70.0, 100.0, 70.0, 100.0, 11.0, 32.0, 120.0, 60.0, 110.0, 63.0, 70.0, 90.0, 20.0, 29.0, 40.0, 48.0, 19.0, 2.0, 20.0, 70.0, 70.0, 20.0, 60.0, 20.0, 70.0, 70.0, 4.0, 13.0, 60.0, 80.0, 80.0, 20.0, 25.0, 60.0, 0.0, -15.0, 60.0, 70.0, 80.0, 70.0, 35.0, 20.0, 40.0, 60.0, 30.0, -55.0, 90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0, 30.0, 110.0, 20.0, 60.0, 50.0, 100.0, 80.0, 50.0, 70.0, 60.0, 70.0, 15.0, 20.0, 58.0, 38.0, 80.0, 60.0, 120.0, 36.0, 90.0, 30.0, 25.0, 40.0, 90.0, 70.0, 40.0, 2.0, 70.0, 22.0, 40.0, 50.0, 50.0, 30.0, 0.0, 40.0, 30.0, 20.0, 80.0, 50.0, 40.0, 80.0, 20.0, 40.0, 150.0, 30.0, 34.0, 40.0, 20.0, 25.0, 40.0, 30.0, 70.0, 20.0, 10.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 100.0, 6.0, 50.0, 70.0, 150.0, 20.0, -28.0, 10.0, 3.0, 110.0, 120.0, 117.0, 10.0, 110.0, 90.0, 80.0, 72.0, 60.0, 80.0, 110.0, 50.0, 100.0, 0.0, 50.0, 70.0, 30.0, 80.0, 10.0, 40.0, 70.0, 30.0, 50.0, 40.0, 90.0, 110.0, 40.0, 98.0, 60.0, 20.0, 60.0, 50.0, 100.0, 50.0, 40.0, 120.0, 38.0, 40.0, 15.0, 70.0, 0.0, 30.0, 40.0, 10.0, 30.0, 20.0, 70.0, 20.0, 10.0, 40.0, 40.0, 120.0, 30.0, 10.0, 40.0, 40.0, 30.0, -70.0, 50.0, 40.0, 60.0, 100.0, 90.0, 80.0, 40.0, 40.0, 40.0, 30.0, 60.0, 50.0, 0.0, 40.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 8.0, 0.0, 50.0, 80.0, 100.0, 80.0, 20.0, 140.0, 80.0, 50.0, 100.0, 40.0, 50.0, 60.0, 30.0, 0.0, 20.0, 0.0, 50.0, 40.0, 20.0, 20.0, 70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0, 10.0, 37.0, 110.0, 27.0, 90.0, 20.0, 20.0, 33.0, 27.0, 70.0, 10.0, 20.0, 10.0, 50.0, 0.0, 100.0, 50.0, 80.0, 50.0, 30.0, 15.0, 60.0, 20.0, 20.0, 90.0, 110.0, 90.0, 35.0, 40.0, 20.0, -64.0, -78.0, -31.0, 10.0, 84.0, 0.0, 9.0, 30.0, 40.0, 30.0, 30.0, 100.0, 50.0, 60.0, 10.0, 60.0, 50.0, 80.0, 49.0, 40.0, 50.0, 110.0, 24.0, 30.0, 30.0, 17.0, 130.0, 40.0, 80.0, 40.0, 56.0, 73.0, 60.0, 80.0, 80.0, 3.0, 29.0, 90.0, 60.0, 40.0, 120.0, 100.0, 90.0, 100.0, 190.0, 110.0, 60.0, 39.0, 60.0, 30.0, 60.0, 110.0, 90.0, 110.0, 60.0, 70.0, 50.0, 60.0, 80.0, 70.0, 10.0, 30.0, 40.0, 30.0, 60.0, 20.0, 70.0, 70.0, 70.0, 110.0, 10.0, 70.0, 50.0, 30.0, 30.0, 70.0, 150.0, 30.0, 60.0, 70.0, 90.0, 40.0, 20.0, 110.0, 100.0, 40.0, 70.0, 60.0, 90.0, 40.0, -4.0, -13.0, 9.0, 80.0, 78.0, 110.0, 70.0, 120.0, 40.0, 108.0, 100.0, 48.0, 20.0, 70.0, 49.0, 71.0, 60.0, 60.0, 90.0, -2.0, 50.0, 40.0, 130.0, 80.0, 40.0, 40.0, 20.0, 90.0, 49.0, 80.0, 30.0, 10.0, 19.0, 30.0, 39.0, 100.0, 50.0, 50.0, 40.0, 30.0, 140.0, 70.0, 20.0, 80.0, 60.0, 60.0, 120.0, 50.0, 60.0, 50.0, 70.0, 90.0, 30.0, 30.0, 110.0, 30.0, 30.0, 80.0, 20.0, 70.0, 100.0, 25.0, 50.0, 80.0, 90.0, 100.0, 30.0, 50.0, 100.0, 90.0, 20.0, 70.0, 30.0, 30.0, 40.0, 90.0, 60.0, 80.0, 10.0, 10.0, 90.0, 87.0, 100.0, 150.0, 130.0, 40.0, 100.0, 90.0, 84.0, 70.0, 30.0, 40.0, 118.0, 9.0, 70.0, 20.0, 55.0, 20.0, 20.0, 0.0, 70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0, 80.0, 57.0, 70.0, 60.0, 80.0, 20.0, 68.0, 70.0, 47.0, 9.0, 40.0, 50.0, 30.0, 39.0, 90.0, 10.0, 50.0, 110.0, 100.0, 30.0, 40.0, 39.0, 30.0, 20.0, 30.0, 100.0, 0.0, 9.0, 20.0, 80.0, 60.0, 100.0, 90.0, 16.0, 27.0, 40.0, 20.0, 10.0, 80.0, 110.0, 120.0, 86.0, 70.0, -27.0, 30.0, 20.0, 98.0, 0.0, 90.0, 20.0, 120.0, 40.0, 70.0, 30.0, 70.0, 60.0, 40.0, 90.0, 100.0, 60.0, 64.0, 80.0, 30.0, 10.0, 143.0, 60.0, 100.0, 40.0, 0.0, 85.0, 77.0, 70.0, 50.0, 50.0, 60.0, 50.0, 100.0, 10.0, 110.0, 27.0, 50.0, 30.0, 40.0, 20.0, 60.0, 40.0, 7.0, 56.0, 150.0, 120.0, 80.0, 80.0, 60.0, 60.0, 30.0, 30.0, 90.0, 50.0, 10.0, 50.0, 100.0, 60.0, 40.0, 30.0, 40.0, 40.0, 70.0, 70.0, 120.0, 20.0, 60.0, 57.0, 90.0, 100.0, 80.0, 44.0, 48.0, 58.0, 50.0, 30.0, 30.0, 38.0, 0.0, 80.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 10.0, 35.0, 40.0, 20.0, 25.0, 38.0, 80.0, 90.0, 30.0, 28.0, 70.0, 60.0, 40.0, 90.0, 50.0, 150.0, 70.0, 50.0, 70.0, 70.0, 100.0, 60.0, 60.0, 40.0, 70.0, 60.0, 10.0, 28.0, -51.0, 140.0, 13.0, 40.0, 80.0, 50.0, 110.0, 40.0, 40.0, 50.0, 40.0, 36.0, 76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5517541758618707, "mean_inference_ms": 1.5655561213899452, "mean_action_processing_ms": 0.4947184380217074, "mean_env_wait_ms": 1.3653836760438134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013226032257080078, "StateBufferConnector_ms": 0.009617328643798828, "ViewRequirementAgentConnector_ms": 0.3973979949951172}, "num_episodes": 18, "episode_return_max": 941.0, "episode_return_min": 30.0, "episode_return_mean": 532.14}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.65208330238129, "num_env_steps_trained_throughput_per_sec": 21.65208330238129, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 184548.003, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184547.953, "sample_time_ms": 2426.686, "learn_time_ms": 182101.638, "learn_throughput": 21.966, "synch_weights_time_ms": 11.498}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "a22d3_00000", "date": "2024-08-06_04-11-46", "timestamp": 1722931906, "time_this_iter_s": 184.7476668357849, "time_total_s": 19697.398857831955, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a7280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19697.398857831955, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.28544061302682, "ram_util_percent": 77.92643678160921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0457478227706765, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.687270165759281, "policy_loss": -0.010155569836403084, "vf_loss": 5.695443847004217, "vf_explained_var": 0.021438168990599336, "kl": 0.0066062948635481076, "entropy": 0.6369781538415641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 941.0, "episode_reward_min": 30.0, "episode_reward_mean": 520.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -78.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 52.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 750.0, 570.0, 481.0, 599.0, 492.0, 435.0, 494.0, 655.0, 692.0, 433.0, 350.0, 475.0, 533.0, 650.0, 421.0, 327.0, 410.0, 418.0, 630.0, 587.0, 429.0, 390.0, 479.0, 310.0, 461.0, 849.0, 540.0, 608.0, 583.0, 270.0, 330.0, 590.0, 298.0, 740.0, 290.0, 460.0, 444.0, 400.0, 500.0, 30.0, 529.0, 551.0, 571.0, 899.0, 760.0, 510.0, 570.0, 660.0, 598.0, 566.0, 619.0, 398.0, 710.0, 560.0, 715.0, 440.0, 941.0, 382.0, 512.0, 561.0, 549.0, 368.0, 553.0, 507.0, 680.0, 612.0, 604.0, 573.0, 540.0, 590.0, 617.0, 368.0, 396.0, 720.0, 517.0, 499.0, 615.0, 590.0, 330.0, 424.0, 690.0, 393.0, 764.0, 670.0, 429.0, 286.0, 450.0, 551.0, 530.0, 380.0, 289.0, 524.0, 360.0, 330.0, 717.0, 585.0, 610.0, 740.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 20.0, 70.0, 50.0, 90.0, 150.0, 90.0, 20.0, 30.0, 10.0, 100.0, 60.0, 150.0, 30.0, 100.0, 30.0, 70.0, 30.0, 50.0, 40.0, 110.0, 60.0, 50.0, 48.0, 49.0, 100.0, 32.0, 49.0, 0.0, 80.0, 40.0, 80.0, 3.0, 40.0, 60.0, 90.0, 70.0, 60.0, 79.0, 70.0, 40.0, 40.0, 50.0, 40.0, -16.0, 60.0, 38.0, 20.0, 70.0, 70.0, 110.0, 80.0, 20.0, 32.0, 24.0, 130.0, 10.0, 50.0, 45.0, 50.0, 80.0, 6.0, 8.0, 120.0, 56.0, 30.0, 20.0, 10.0, 48.0, 50.0, 50.0, 70.0, 40.0, 50.0, 60.0, 48.0, 50.0, 110.0, 100.0, 60.0, 87.0, 60.0, 30.0, 46.0, 120.0, 46.0, 60.0, 30.0, 100.0, 50.0, 70.0, 50.0, 120.0, 20.0, 20.0, 80.0, 29.0, 9.0, 51.0, -14.0, 100.0, 90.0, 48.0, 20.0, 50.0, 20.0, 0.0, 80.0, 60.0, 0.0, 30.0, 40.0, 50.0, 50.0, 65.0, 10.0, 80.0, 80.0, 60.0, 50.0, 40.0, 40.0, 0.0, 40.0, 20.0, 80.0, 10.0, 70.0, 100.0, 70.0, 100.0, 11.0, 32.0, 120.0, 60.0, 110.0, 63.0, 70.0, 90.0, 20.0, 29.0, 40.0, 48.0, 19.0, 2.0, 20.0, 70.0, 70.0, 20.0, 60.0, 20.0, 70.0, 70.0, 4.0, 13.0, 60.0, 80.0, 80.0, 20.0, 25.0, 60.0, 0.0, -15.0, 60.0, 70.0, 80.0, 70.0, 35.0, 20.0, 40.0, 60.0, 30.0, -55.0, 90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0, 30.0, 110.0, 20.0, 60.0, 50.0, 100.0, 80.0, 50.0, 70.0, 60.0, 70.0, 15.0, 20.0, 58.0, 38.0, 80.0, 60.0, 120.0, 36.0, 90.0, 30.0, 25.0, 40.0, 90.0, 70.0, 40.0, 2.0, 70.0, 22.0, 40.0, 50.0, 50.0, 30.0, 0.0, 40.0, 30.0, 20.0, 80.0, 50.0, 40.0, 80.0, 20.0, 40.0, 150.0, 30.0, 34.0, 40.0, 20.0, 25.0, 40.0, 30.0, 70.0, 20.0, 10.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 100.0, 6.0, 50.0, 70.0, 150.0, 20.0, -28.0, 10.0, 3.0, 110.0, 120.0, 117.0, 10.0, 110.0, 90.0, 80.0, 72.0, 60.0, 80.0, 110.0, 50.0, 100.0, 0.0, 50.0, 70.0, 30.0, 80.0, 10.0, 40.0, 70.0, 30.0, 50.0, 40.0, 90.0, 110.0, 40.0, 98.0, 60.0, 20.0, 60.0, 50.0, 100.0, 50.0, 40.0, 120.0, 38.0, 40.0, 15.0, 70.0, 0.0, 30.0, 40.0, 10.0, 30.0, 20.0, 70.0, 20.0, 10.0, 40.0, 40.0, 120.0, 30.0, 10.0, 40.0, 40.0, 30.0, -70.0, 50.0, 40.0, 60.0, 100.0, 90.0, 80.0, 40.0, 40.0, 40.0, 30.0, 60.0, 50.0, 0.0, 40.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 8.0, 0.0, 50.0, 80.0, 100.0, 80.0, 20.0, 140.0, 80.0, 50.0, 100.0, 40.0, 50.0, 60.0, 30.0, 0.0, 20.0, 0.0, 50.0, 40.0, 20.0, 20.0, 70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0, 10.0, 37.0, 110.0, 27.0, 90.0, 20.0, 20.0, 33.0, 27.0, 70.0, 10.0, 20.0, 10.0, 50.0, 0.0, 100.0, 50.0, 80.0, 50.0, 30.0, 15.0, 60.0, 20.0, 20.0, 90.0, 110.0, 90.0, 35.0, 40.0, 20.0, -64.0, -78.0, -31.0, 10.0, 84.0, 0.0, 9.0, 30.0, 40.0, 30.0, 30.0, 100.0, 50.0, 60.0, 10.0, 60.0, 50.0, 80.0, 49.0, 40.0, 50.0, 110.0, 24.0, 30.0, 30.0, 17.0, 130.0, 40.0, 80.0, 40.0, 56.0, 73.0, 60.0, 80.0, 80.0, 3.0, 29.0, 90.0, 60.0, 40.0, 120.0, 100.0, 90.0, 100.0, 190.0, 110.0, 60.0, 39.0, 60.0, 30.0, 60.0, 110.0, 90.0, 110.0, 60.0, 70.0, 50.0, 60.0, 80.0, 70.0, 10.0, 30.0, 40.0, 30.0, 60.0, 20.0, 70.0, 70.0, 70.0, 110.0, 10.0, 70.0, 50.0, 30.0, 30.0, 70.0, 150.0, 30.0, 60.0, 70.0, 90.0, 40.0, 20.0, 110.0, 100.0, 40.0, 70.0, 60.0, 90.0, 40.0, -4.0, -13.0, 9.0, 80.0, 78.0, 110.0, 70.0, 120.0, 40.0, 108.0, 100.0, 48.0, 20.0, 70.0, 49.0, 71.0, 60.0, 60.0, 90.0, -2.0, 50.0, 40.0, 130.0, 80.0, 40.0, 40.0, 20.0, 90.0, 49.0, 80.0, 30.0, 10.0, 19.0, 30.0, 39.0, 100.0, 50.0, 50.0, 40.0, 30.0, 140.0, 70.0, 20.0, 80.0, 60.0, 60.0, 120.0, 50.0, 60.0, 50.0, 70.0, 90.0, 30.0, 30.0, 110.0, 30.0, 30.0, 80.0, 20.0, 70.0, 100.0, 25.0, 50.0, 80.0, 90.0, 100.0, 30.0, 50.0, 100.0, 90.0, 20.0, 70.0, 30.0, 30.0, 40.0, 90.0, 60.0, 80.0, 10.0, 10.0, 90.0, 87.0, 100.0, 150.0, 130.0, 40.0, 100.0, 90.0, 84.0, 70.0, 30.0, 40.0, 118.0, 9.0, 70.0, 20.0, 55.0, 20.0, 20.0, 0.0, 70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0, 80.0, 57.0, 70.0, 60.0, 80.0, 20.0, 68.0, 70.0, 47.0, 9.0, 40.0, 50.0, 30.0, 39.0, 90.0, 10.0, 50.0, 110.0, 100.0, 30.0, 40.0, 39.0, 30.0, 20.0, 30.0, 100.0, 0.0, 9.0, 20.0, 80.0, 60.0, 100.0, 90.0, 16.0, 27.0, 40.0, 20.0, 10.0, 80.0, 110.0, 120.0, 86.0, 70.0, -27.0, 30.0, 20.0, 98.0, 0.0, 90.0, 20.0, 120.0, 40.0, 70.0, 30.0, 70.0, 60.0, 40.0, 90.0, 100.0, 60.0, 64.0, 80.0, 30.0, 10.0, 143.0, 60.0, 100.0, 40.0, 0.0, 85.0, 77.0, 70.0, 50.0, 50.0, 60.0, 50.0, 100.0, 10.0, 110.0, 27.0, 50.0, 30.0, 40.0, 20.0, 60.0, 40.0, 7.0, 56.0, 150.0, 120.0, 80.0, 80.0, 60.0, 60.0, 30.0, 30.0, 90.0, 50.0, 10.0, 50.0, 100.0, 60.0, 40.0, 30.0, 40.0, 40.0, 70.0, 70.0, 120.0, 20.0, 60.0, 57.0, 90.0, 100.0, 80.0, 44.0, 48.0, 58.0, 50.0, 30.0, 30.0, 38.0, 0.0, 80.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 10.0, 35.0, 40.0, 20.0, 25.0, 38.0, 80.0, 90.0, 30.0, 28.0, 70.0, 60.0, 40.0, 90.0, 50.0, 150.0, 70.0, 50.0, 70.0, 70.0, 100.0, 60.0, 60.0, 40.0, 70.0, 60.0, 10.0, 28.0, -51.0, 140.0, 13.0, 40.0, 80.0, 50.0, 110.0, 40.0, 40.0, 50.0, 40.0, 36.0, 76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0, 60.0, 70.0, 50.0, 50.0, 80.0, 0.0, 90.0, 30.0, 80.0, 80.0, 36.0, 70.0, 30.0, 10.0, 40.0, 40.0, 14.0, 40.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 40.0, 60.0, 140.0, 4.0, 30.0, 30.0, 30.0, 70.0, 70.0, 50.0, 110.0, 70.0, 60.0, 80.0, 70.0, 80.0, 130.0, 40.0, 10.0, 20.0, 60.0, 20.0, 0.0, 30.0, 43.0, 40.0, 140.0, 130.0, 3.0, 160.0, 25.0, 90.0, 59.0, 80.0, 55.0, 22.0, 20.0, 50.0, 60.0, 120.0, 60.0, 40.0, 30.0, 60.0, 120.0, 110.0, 50.0, 40.0, 60.0, 20.0, 30.0, 70.0, 5.0, 50.0, 80.0, 24.0, 10.0, 36.0, 40.0, 50.0, 40.0, 40.0, -6.0, 5.0, 11.0, 60.0, 10.0, 90.0, 50.0, 0.0, 110.0, 20.0, 80.0, 30.0, 30.0, 30.0, 50.0, 55.0, 16.0, -1.0, 50.0, -9.0, 110.0, 210.0, -9.0, 79.0, 30.0, 30.0, 50.0, 80.0, 30.0, 90.0, 50.0, 50.0, 60.0, 60.0, 80.0, -18.0, 25.0, 90.0, 16.0, 13.0, 50.0, 50.0, 29.0, 45.0, 30.0, 20.0, 40.0, 0.0, 9.0, 10.0, 60.0, 40.0, 50.0, 30.0, 90.0, 50.0, -40.0, 36.0, 120.0, 100.0, 60.0, -11.0, 56.0, 63.0, 60.0, 0.0, 60.0, 10.0, 10.0, 10.0, 60.0, 30.0, 60.0, 60.0, 100.0, 0.0, 20.0, 30.0, 20.0, 40.0, 10.0, 50.0, 20.0, 40.0, 38.0, 120.0, 40.0, 80.0, 60.0, 150.0, 60.0, 59.0, 60.0, 50.0, 50.0, 58.0, 28.0, 89.0, 10.0, 110.0, 30.0, 90.0, 20.0, 100.0, 30.0, 60.0, 100.0, 60.0, 20.0, 60.0, 80.0, 70.0, 90.0, 40.0, 120.0, 40.0, 120.0, 10.0, 60.0, 60.0, 100.0, 80.0, 50.0, 100.0, 70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5499601692352791, "mean_inference_ms": 1.5630147426147059, "mean_action_processing_ms": 0.49398531357929804, "mean_env_wait_ms": 1.364100640831685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013406991958618164, "StateBufferConnector_ms": 0.009563922882080078, "ViewRequirementAgentConnector_ms": 0.39669084548950195}, "num_episodes": 22, "episode_return_max": 941.0, "episode_return_min": 30.0, "episode_return_mean": 520.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.585589438620612, "num_env_steps_trained_throughput_per_sec": 21.585589438620612, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 184603.731, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184603.682, "sample_time_ms": 2431.417, "learn_time_ms": 182152.532, "learn_throughput": 21.96, "synch_weights_time_ms": 11.824}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "a22d3_00000", "date": "2024-08-06_04-14-51", "timestamp": 1722932091, "time_this_iter_s": 185.31793689727783, "time_total_s": 19882.716794729233, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a7430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19882.716794729233, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.77748091603053, "ram_util_percent": 78.0530534351145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.134778430616767, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011046717239393038, "vf_loss": 6.348761028222763, "vf_explained_var": 0.015081376567308387, "kl": Infinity, "entropy": 0.572255104085127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 941.0, "episode_reward_min": 30.0, "episode_reward_mean": 527.14, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -78.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 52.714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [418.0, 630.0, 587.0, 429.0, 390.0, 479.0, 310.0, 461.0, 849.0, 540.0, 608.0, 583.0, 270.0, 330.0, 590.0, 298.0, 740.0, 290.0, 460.0, 444.0, 400.0, 500.0, 30.0, 529.0, 551.0, 571.0, 899.0, 760.0, 510.0, 570.0, 660.0, 598.0, 566.0, 619.0, 398.0, 710.0, 560.0, 715.0, 440.0, 941.0, 382.0, 512.0, 561.0, 549.0, 368.0, 553.0, 507.0, 680.0, 612.0, 604.0, 573.0, 540.0, 590.0, 617.0, 368.0, 396.0, 720.0, 517.0, 499.0, 615.0, 590.0, 330.0, 424.0, 690.0, 393.0, 764.0, 670.0, 429.0, 286.0, 450.0, 551.0, 530.0, 380.0, 289.0, 524.0, 360.0, 330.0, 717.0, 585.0, 610.0, 740.0, 370.0, 647.0, 455.0, 361.0, 598.0, 778.0, 448.0, 595.0, 522.0, 627.0, 640.0, 490.0, 575.0, 591.0, 470.0, 590.0, 571.0, 456.0, 292.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 17.0, 14.0, 70.0, 50.0, 29.0, 20.0, 50.0, 40.0, 38.0, 30.0, 110.0, 20.0, 60.0, 50.0, 100.0, 80.0, 50.0, 70.0, 60.0, 70.0, 15.0, 20.0, 58.0, 38.0, 80.0, 60.0, 120.0, 36.0, 90.0, 30.0, 25.0, 40.0, 90.0, 70.0, 40.0, 2.0, 70.0, 22.0, 40.0, 50.0, 50.0, 30.0, 0.0, 40.0, 30.0, 20.0, 80.0, 50.0, 40.0, 80.0, 20.0, 40.0, 150.0, 30.0, 34.0, 40.0, 20.0, 25.0, 40.0, 30.0, 70.0, 20.0, 10.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 100.0, 6.0, 50.0, 70.0, 150.0, 20.0, -28.0, 10.0, 3.0, 110.0, 120.0, 117.0, 10.0, 110.0, 90.0, 80.0, 72.0, 60.0, 80.0, 110.0, 50.0, 100.0, 0.0, 50.0, 70.0, 30.0, 80.0, 10.0, 40.0, 70.0, 30.0, 50.0, 40.0, 90.0, 110.0, 40.0, 98.0, 60.0, 20.0, 60.0, 50.0, 100.0, 50.0, 40.0, 120.0, 38.0, 40.0, 15.0, 70.0, 0.0, 30.0, 40.0, 10.0, 30.0, 20.0, 70.0, 20.0, 10.0, 40.0, 40.0, 120.0, 30.0, 10.0, 40.0, 40.0, 30.0, -70.0, 50.0, 40.0, 60.0, 100.0, 90.0, 80.0, 40.0, 40.0, 40.0, 30.0, 60.0, 50.0, 0.0, 40.0, 80.0, 40.0, 10.0, 20.0, 80.0, 20.0, 8.0, 0.0, 50.0, 80.0, 100.0, 80.0, 20.0, 140.0, 80.0, 50.0, 100.0, 40.0, 50.0, 60.0, 30.0, 0.0, 20.0, 0.0, 50.0, 40.0, 20.0, 20.0, 70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0, 10.0, 37.0, 110.0, 27.0, 90.0, 20.0, 20.0, 33.0, 27.0, 70.0, 10.0, 20.0, 10.0, 50.0, 0.0, 100.0, 50.0, 80.0, 50.0, 30.0, 15.0, 60.0, 20.0, 20.0, 90.0, 110.0, 90.0, 35.0, 40.0, 20.0, -64.0, -78.0, -31.0, 10.0, 84.0, 0.0, 9.0, 30.0, 40.0, 30.0, 30.0, 100.0, 50.0, 60.0, 10.0, 60.0, 50.0, 80.0, 49.0, 40.0, 50.0, 110.0, 24.0, 30.0, 30.0, 17.0, 130.0, 40.0, 80.0, 40.0, 56.0, 73.0, 60.0, 80.0, 80.0, 3.0, 29.0, 90.0, 60.0, 40.0, 120.0, 100.0, 90.0, 100.0, 190.0, 110.0, 60.0, 39.0, 60.0, 30.0, 60.0, 110.0, 90.0, 110.0, 60.0, 70.0, 50.0, 60.0, 80.0, 70.0, 10.0, 30.0, 40.0, 30.0, 60.0, 20.0, 70.0, 70.0, 70.0, 110.0, 10.0, 70.0, 50.0, 30.0, 30.0, 70.0, 150.0, 30.0, 60.0, 70.0, 90.0, 40.0, 20.0, 110.0, 100.0, 40.0, 70.0, 60.0, 90.0, 40.0, -4.0, -13.0, 9.0, 80.0, 78.0, 110.0, 70.0, 120.0, 40.0, 108.0, 100.0, 48.0, 20.0, 70.0, 49.0, 71.0, 60.0, 60.0, 90.0, -2.0, 50.0, 40.0, 130.0, 80.0, 40.0, 40.0, 20.0, 90.0, 49.0, 80.0, 30.0, 10.0, 19.0, 30.0, 39.0, 100.0, 50.0, 50.0, 40.0, 30.0, 140.0, 70.0, 20.0, 80.0, 60.0, 60.0, 120.0, 50.0, 60.0, 50.0, 70.0, 90.0, 30.0, 30.0, 110.0, 30.0, 30.0, 80.0, 20.0, 70.0, 100.0, 25.0, 50.0, 80.0, 90.0, 100.0, 30.0, 50.0, 100.0, 90.0, 20.0, 70.0, 30.0, 30.0, 40.0, 90.0, 60.0, 80.0, 10.0, 10.0, 90.0, 87.0, 100.0, 150.0, 130.0, 40.0, 100.0, 90.0, 84.0, 70.0, 30.0, 40.0, 118.0, 9.0, 70.0, 20.0, 55.0, 20.0, 20.0, 0.0, 70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0, 80.0, 57.0, 70.0, 60.0, 80.0, 20.0, 68.0, 70.0, 47.0, 9.0, 40.0, 50.0, 30.0, 39.0, 90.0, 10.0, 50.0, 110.0, 100.0, 30.0, 40.0, 39.0, 30.0, 20.0, 30.0, 100.0, 0.0, 9.0, 20.0, 80.0, 60.0, 100.0, 90.0, 16.0, 27.0, 40.0, 20.0, 10.0, 80.0, 110.0, 120.0, 86.0, 70.0, -27.0, 30.0, 20.0, 98.0, 0.0, 90.0, 20.0, 120.0, 40.0, 70.0, 30.0, 70.0, 60.0, 40.0, 90.0, 100.0, 60.0, 64.0, 80.0, 30.0, 10.0, 143.0, 60.0, 100.0, 40.0, 0.0, 85.0, 77.0, 70.0, 50.0, 50.0, 60.0, 50.0, 100.0, 10.0, 110.0, 27.0, 50.0, 30.0, 40.0, 20.0, 60.0, 40.0, 7.0, 56.0, 150.0, 120.0, 80.0, 80.0, 60.0, 60.0, 30.0, 30.0, 90.0, 50.0, 10.0, 50.0, 100.0, 60.0, 40.0, 30.0, 40.0, 40.0, 70.0, 70.0, 120.0, 20.0, 60.0, 57.0, 90.0, 100.0, 80.0, 44.0, 48.0, 58.0, 50.0, 30.0, 30.0, 38.0, 0.0, 80.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 10.0, 35.0, 40.0, 20.0, 25.0, 38.0, 80.0, 90.0, 30.0, 28.0, 70.0, 60.0, 40.0, 90.0, 50.0, 150.0, 70.0, 50.0, 70.0, 70.0, 100.0, 60.0, 60.0, 40.0, 70.0, 60.0, 10.0, 28.0, -51.0, 140.0, 13.0, 40.0, 80.0, 50.0, 110.0, 40.0, 40.0, 50.0, 40.0, 36.0, 76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0, 60.0, 70.0, 50.0, 50.0, 80.0, 0.0, 90.0, 30.0, 80.0, 80.0, 36.0, 70.0, 30.0, 10.0, 40.0, 40.0, 14.0, 40.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 40.0, 60.0, 140.0, 4.0, 30.0, 30.0, 30.0, 70.0, 70.0, 50.0, 110.0, 70.0, 60.0, 80.0, 70.0, 80.0, 130.0, 40.0, 10.0, 20.0, 60.0, 20.0, 0.0, 30.0, 43.0, 40.0, 140.0, 130.0, 3.0, 160.0, 25.0, 90.0, 59.0, 80.0, 55.0, 22.0, 20.0, 50.0, 60.0, 120.0, 60.0, 40.0, 30.0, 60.0, 120.0, 110.0, 50.0, 40.0, 60.0, 20.0, 30.0, 70.0, 5.0, 50.0, 80.0, 24.0, 10.0, 36.0, 40.0, 50.0, 40.0, 40.0, -6.0, 5.0, 11.0, 60.0, 10.0, 90.0, 50.0, 0.0, 110.0, 20.0, 80.0, 30.0, 30.0, 30.0, 50.0, 55.0, 16.0, -1.0, 50.0, -9.0, 110.0, 210.0, -9.0, 79.0, 30.0, 30.0, 50.0, 80.0, 30.0, 90.0, 50.0, 50.0, 60.0, 60.0, 80.0, -18.0, 25.0, 90.0, 16.0, 13.0, 50.0, 50.0, 29.0, 45.0, 30.0, 20.0, 40.0, 0.0, 9.0, 10.0, 60.0, 40.0, 50.0, 30.0, 90.0, 50.0, -40.0, 36.0, 120.0, 100.0, 60.0, -11.0, 56.0, 63.0, 60.0, 0.0, 60.0, 10.0, 10.0, 10.0, 60.0, 30.0, 60.0, 60.0, 100.0, 0.0, 20.0, 30.0, 20.0, 40.0, 10.0, 50.0, 20.0, 40.0, 38.0, 120.0, 40.0, 80.0, 60.0, 150.0, 60.0, 59.0, 60.0, 50.0, 50.0, 58.0, 28.0, 89.0, 10.0, 110.0, 30.0, 90.0, 20.0, 100.0, 30.0, 60.0, 100.0, 60.0, 20.0, 60.0, 80.0, 70.0, 90.0, 40.0, 120.0, 40.0, 120.0, 10.0, 60.0, 60.0, 100.0, 80.0, 50.0, 100.0, 70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0, 90.0, 40.0, 70.0, 110.0, 58.0, 30.0, 49.0, 140.0, 10.0, 50.0, 50.0, 55.0, 40.0, 60.0, 20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 30.0, 15.0, 20.0, 20.0, 70.0, 80.0, 20.0, 70.0, 16.0, 20.0, 14.0, 22.0, 64.0, 90.0, 18.0, 70.0, 140.0, 70.0, 60.0, 50.0, 90.0, 78.0, 50.0, 40.0, 150.0, 110.0, 70.0, 100.0, 70.0, 20.0, 40.0, 80.0, 21.0, 40.0, 27.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 30.0, 10.0, 120.0, 90.0, 60.0, 80.0, 40.0, 35.0, 50.0, 46.0, 100.0, 30.0, 80.0, 30.0, 36.0, 50.0, 70.0, 30.0, 50.0, 50.0, 60.0, 100.0, 50.0, 60.0, 120.0, 100.0, 40.0, -13.0, 60.0, 50.0, 60.0, 60.0, 70.0, 50.0, 100.0, 70.0, 30.0, 90.0, 60.0, 100.0, 90.0, 40.0, 70.0, 0.0, 10.0, 0.0, 110.0, 70.0, 0.0, 60.0, 100.0, 50.0, 60.0, 30.0, 100.0, 55.0, 40.0, 30.0, 50.0, 100.0, 99.0, 70.0, 30.0, 16.0, 10.0, 109.0, 60.0, 70.0, 27.0, 10.0, 90.0, 30.0, 80.0, 30.0, 0.0, 100.0, 40.0, 70.0, 20.0, 90.0, 40.0, 50.0, 100.0, 60.0, 20.0, 40.0, 60.0, 20.0, 110.0, 90.0, 10.0, 50.0, 60.0, 60.0, 110.0, 50.0, 90.0, 15.0, 36.0, 30.0, 100.0, 110.0, 28.0, 10.0, 20.0, 38.0, 50.0, -10.0, 80.0, 50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5500957284957964, "mean_inference_ms": 1.5622492129480696, "mean_action_processing_ms": 0.4935426138210958, "mean_env_wait_ms": 1.3629598660579483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012676000595092773, "StateBufferConnector_ms": 0.009463310241699219, "ViewRequirementAgentConnector_ms": 0.40045714378356934}, "num_episodes": 18, "episode_return_max": 941.0, "episode_return_min": 30.0, "episode_return_mean": 527.14}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.666228048607795, "num_env_steps_trained_throughput_per_sec": 21.666228048607795, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 184550.884, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184550.835, "sample_time_ms": 2430.551, "learn_time_ms": 182100.599, "learn_throughput": 21.966, "synch_weights_time_ms": 11.773}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "a22d3_00000", "date": "2024-08-06_04-17-56", "timestamp": 1722932276, "time_this_iter_s": 184.62969303131104, "time_total_s": 20067.346487760544, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20067.346487760544, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.526819923371647, "ram_util_percent": 77.22681992337164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.916432938522424, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.023177011477681, "policy_loss": -0.01125067805930133, "vf_loss": 6.031718752051567, "vf_explained_var": 0.013063041426249332, "kl": 0.006019853469428835, "entropy": 0.5818297489731711, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 941.0, "episode_reward_min": 30.0, "episode_reward_mean": 541.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 54.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 444.0, 400.0, 500.0, 30.0, 529.0, 551.0, 571.0, 899.0, 760.0, 510.0, 570.0, 660.0, 598.0, 566.0, 619.0, 398.0, 710.0, 560.0, 715.0, 440.0, 941.0, 382.0, 512.0, 561.0, 549.0, 368.0, 553.0, 507.0, 680.0, 612.0, 604.0, 573.0, 540.0, 590.0, 617.0, 368.0, 396.0, 720.0, 517.0, 499.0, 615.0, 590.0, 330.0, 424.0, 690.0, 393.0, 764.0, 670.0, 429.0, 286.0, 450.0, 551.0, 530.0, 380.0, 289.0, 524.0, 360.0, 330.0, 717.0, 585.0, 610.0, 740.0, 370.0, 647.0, 455.0, 361.0, 598.0, 778.0, 448.0, 595.0, 522.0, 627.0, 640.0, 490.0, 575.0, 591.0, 470.0, 590.0, 571.0, 456.0, 292.0, 311.0, 743.0, 603.0, 370.0, 572.0, 575.0, 587.0, 423.0, 603.0, 816.0, 506.0, 541.0, 450.0, 640.0, 428.0, 720.0, 670.0, 710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 70.0, 10.0, 30.0, 20.0, 50.0, 50.0, 70.0, 40.0, 50.0, 10.0, 37.0, 110.0, 27.0, 90.0, 20.0, 20.0, 33.0, 27.0, 70.0, 10.0, 20.0, 10.0, 50.0, 0.0, 100.0, 50.0, 80.0, 50.0, 30.0, 15.0, 60.0, 20.0, 20.0, 90.0, 110.0, 90.0, 35.0, 40.0, 20.0, -64.0, -78.0, -31.0, 10.0, 84.0, 0.0, 9.0, 30.0, 40.0, 30.0, 30.0, 100.0, 50.0, 60.0, 10.0, 60.0, 50.0, 80.0, 49.0, 40.0, 50.0, 110.0, 24.0, 30.0, 30.0, 17.0, 130.0, 40.0, 80.0, 40.0, 56.0, 73.0, 60.0, 80.0, 80.0, 3.0, 29.0, 90.0, 60.0, 40.0, 120.0, 100.0, 90.0, 100.0, 190.0, 110.0, 60.0, 39.0, 60.0, 30.0, 60.0, 110.0, 90.0, 110.0, 60.0, 70.0, 50.0, 60.0, 80.0, 70.0, 10.0, 30.0, 40.0, 30.0, 60.0, 20.0, 70.0, 70.0, 70.0, 110.0, 10.0, 70.0, 50.0, 30.0, 30.0, 70.0, 150.0, 30.0, 60.0, 70.0, 90.0, 40.0, 20.0, 110.0, 100.0, 40.0, 70.0, 60.0, 90.0, 40.0, -4.0, -13.0, 9.0, 80.0, 78.0, 110.0, 70.0, 120.0, 40.0, 108.0, 100.0, 48.0, 20.0, 70.0, 49.0, 71.0, 60.0, 60.0, 90.0, -2.0, 50.0, 40.0, 130.0, 80.0, 40.0, 40.0, 20.0, 90.0, 49.0, 80.0, 30.0, 10.0, 19.0, 30.0, 39.0, 100.0, 50.0, 50.0, 40.0, 30.0, 140.0, 70.0, 20.0, 80.0, 60.0, 60.0, 120.0, 50.0, 60.0, 50.0, 70.0, 90.0, 30.0, 30.0, 110.0, 30.0, 30.0, 80.0, 20.0, 70.0, 100.0, 25.0, 50.0, 80.0, 90.0, 100.0, 30.0, 50.0, 100.0, 90.0, 20.0, 70.0, 30.0, 30.0, 40.0, 90.0, 60.0, 80.0, 10.0, 10.0, 90.0, 87.0, 100.0, 150.0, 130.0, 40.0, 100.0, 90.0, 84.0, 70.0, 30.0, 40.0, 118.0, 9.0, 70.0, 20.0, 55.0, 20.0, 20.0, 0.0, 70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0, 80.0, 57.0, 70.0, 60.0, 80.0, 20.0, 68.0, 70.0, 47.0, 9.0, 40.0, 50.0, 30.0, 39.0, 90.0, 10.0, 50.0, 110.0, 100.0, 30.0, 40.0, 39.0, 30.0, 20.0, 30.0, 100.0, 0.0, 9.0, 20.0, 80.0, 60.0, 100.0, 90.0, 16.0, 27.0, 40.0, 20.0, 10.0, 80.0, 110.0, 120.0, 86.0, 70.0, -27.0, 30.0, 20.0, 98.0, 0.0, 90.0, 20.0, 120.0, 40.0, 70.0, 30.0, 70.0, 60.0, 40.0, 90.0, 100.0, 60.0, 64.0, 80.0, 30.0, 10.0, 143.0, 60.0, 100.0, 40.0, 0.0, 85.0, 77.0, 70.0, 50.0, 50.0, 60.0, 50.0, 100.0, 10.0, 110.0, 27.0, 50.0, 30.0, 40.0, 20.0, 60.0, 40.0, 7.0, 56.0, 150.0, 120.0, 80.0, 80.0, 60.0, 60.0, 30.0, 30.0, 90.0, 50.0, 10.0, 50.0, 100.0, 60.0, 40.0, 30.0, 40.0, 40.0, 70.0, 70.0, 120.0, 20.0, 60.0, 57.0, 90.0, 100.0, 80.0, 44.0, 48.0, 58.0, 50.0, 30.0, 30.0, 38.0, 0.0, 80.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 10.0, 35.0, 40.0, 20.0, 25.0, 38.0, 80.0, 90.0, 30.0, 28.0, 70.0, 60.0, 40.0, 90.0, 50.0, 150.0, 70.0, 50.0, 70.0, 70.0, 100.0, 60.0, 60.0, 40.0, 70.0, 60.0, 10.0, 28.0, -51.0, 140.0, 13.0, 40.0, 80.0, 50.0, 110.0, 40.0, 40.0, 50.0, 40.0, 36.0, 76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0, 60.0, 70.0, 50.0, 50.0, 80.0, 0.0, 90.0, 30.0, 80.0, 80.0, 36.0, 70.0, 30.0, 10.0, 40.0, 40.0, 14.0, 40.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 40.0, 60.0, 140.0, 4.0, 30.0, 30.0, 30.0, 70.0, 70.0, 50.0, 110.0, 70.0, 60.0, 80.0, 70.0, 80.0, 130.0, 40.0, 10.0, 20.0, 60.0, 20.0, 0.0, 30.0, 43.0, 40.0, 140.0, 130.0, 3.0, 160.0, 25.0, 90.0, 59.0, 80.0, 55.0, 22.0, 20.0, 50.0, 60.0, 120.0, 60.0, 40.0, 30.0, 60.0, 120.0, 110.0, 50.0, 40.0, 60.0, 20.0, 30.0, 70.0, 5.0, 50.0, 80.0, 24.0, 10.0, 36.0, 40.0, 50.0, 40.0, 40.0, -6.0, 5.0, 11.0, 60.0, 10.0, 90.0, 50.0, 0.0, 110.0, 20.0, 80.0, 30.0, 30.0, 30.0, 50.0, 55.0, 16.0, -1.0, 50.0, -9.0, 110.0, 210.0, -9.0, 79.0, 30.0, 30.0, 50.0, 80.0, 30.0, 90.0, 50.0, 50.0, 60.0, 60.0, 80.0, -18.0, 25.0, 90.0, 16.0, 13.0, 50.0, 50.0, 29.0, 45.0, 30.0, 20.0, 40.0, 0.0, 9.0, 10.0, 60.0, 40.0, 50.0, 30.0, 90.0, 50.0, -40.0, 36.0, 120.0, 100.0, 60.0, -11.0, 56.0, 63.0, 60.0, 0.0, 60.0, 10.0, 10.0, 10.0, 60.0, 30.0, 60.0, 60.0, 100.0, 0.0, 20.0, 30.0, 20.0, 40.0, 10.0, 50.0, 20.0, 40.0, 38.0, 120.0, 40.0, 80.0, 60.0, 150.0, 60.0, 59.0, 60.0, 50.0, 50.0, 58.0, 28.0, 89.0, 10.0, 110.0, 30.0, 90.0, 20.0, 100.0, 30.0, 60.0, 100.0, 60.0, 20.0, 60.0, 80.0, 70.0, 90.0, 40.0, 120.0, 40.0, 120.0, 10.0, 60.0, 60.0, 100.0, 80.0, 50.0, 100.0, 70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0, 90.0, 40.0, 70.0, 110.0, 58.0, 30.0, 49.0, 140.0, 10.0, 50.0, 50.0, 55.0, 40.0, 60.0, 20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 30.0, 15.0, 20.0, 20.0, 70.0, 80.0, 20.0, 70.0, 16.0, 20.0, 14.0, 22.0, 64.0, 90.0, 18.0, 70.0, 140.0, 70.0, 60.0, 50.0, 90.0, 78.0, 50.0, 40.0, 150.0, 110.0, 70.0, 100.0, 70.0, 20.0, 40.0, 80.0, 21.0, 40.0, 27.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 30.0, 10.0, 120.0, 90.0, 60.0, 80.0, 40.0, 35.0, 50.0, 46.0, 100.0, 30.0, 80.0, 30.0, 36.0, 50.0, 70.0, 30.0, 50.0, 50.0, 60.0, 100.0, 50.0, 60.0, 120.0, 100.0, 40.0, -13.0, 60.0, 50.0, 60.0, 60.0, 70.0, 50.0, 100.0, 70.0, 30.0, 90.0, 60.0, 100.0, 90.0, 40.0, 70.0, 0.0, 10.0, 0.0, 110.0, 70.0, 0.0, 60.0, 100.0, 50.0, 60.0, 30.0, 100.0, 55.0, 40.0, 30.0, 50.0, 100.0, 99.0, 70.0, 30.0, 16.0, 10.0, 109.0, 60.0, 70.0, 27.0, 10.0, 90.0, 30.0, 80.0, 30.0, 0.0, 100.0, 40.0, 70.0, 20.0, 90.0, 40.0, 50.0, 100.0, 60.0, 20.0, 40.0, 60.0, 20.0, 110.0, 90.0, 10.0, 50.0, 60.0, 60.0, 110.0, 50.0, 90.0, 15.0, 36.0, 30.0, 100.0, 110.0, 28.0, 10.0, 20.0, 38.0, 50.0, -10.0, 80.0, 50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 51.0, 30.0, 10.0, 30.0, 30.0, 70.0, 50.0, 90.0, 110.0, 61.0, 130.0, 20.0, 40.0, 80.0, 40.0, 64.0, 108.0, -9.0, 70.0, 70.0, 20.0, 95.0, 160.0, -13.0, 110.0, 20.0, 80.0, 10.0, 50.0, 60.0, 20.0, 50.0, 10.0, 20.0, 50.0, 40.0, 60.0, 40.0, 50.0, 50.0, 60.0, 110.0, 40.0, 80.0, 50.0, 37.0, 55.0, 10.0, 70.0, -25.0, 70.0, 60.0, 40.0, 100.0, 130.0, 60.0, 60.0, 92.0, 33.0, 80.0, 100.0, 52.0, 40.0, 80.0, 30.0, 60.0, 20.0, -1.0, 80.0, 100.0, 40.0, 50.0, 50.0, 30.0, 6.0, 35.0, 33.0, 90.0, -8.0, 76.0, 100.0, 50.0, 80.0, 45.0, 20.0, 80.0, 70.0, 30.0, 150.0, 90.0, 40.0, 36.0, 80.0, 30.0, 120.0, 150.0, 90.0, 13.0, 80.0, 60.0, 50.0, 14.0, 110.0, 27.0, 90.0, 50.0, 12.0, 39.0, 90.0, 2.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 80.0, 70.0, 60.0, 100.0, 60.0, 40.0, -80.0, 40.0, 60.0, 40.0, 60.0, 40.0, 70.0, 120.0, 30.0, 70.0, 80.0, 40.0, 60.0, 60.0, 70.0, 88.0, 40.0, 30.0, 10.0, 50.0, 60.0, 10.0, 30.0, 70.0, 40.0, 40.0, 80.0, 30.0, 80.0, 100.0, 50.0, 120.0, 80.0, 50.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 60.0, 110.0, 110.0, 50.0, 30.0, 30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5492980851623193, "mean_inference_ms": 1.5606425746523471, "mean_action_processing_ms": 0.49300021956740936, "mean_env_wait_ms": 1.3618597620579849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01241445541381836, "StateBufferConnector_ms": 0.009303092956542969, "ViewRequirementAgentConnector_ms": 0.37634968757629395}, "num_episodes": 18, "episode_return_max": 941.0, "episode_return_min": 30.0, "episode_return_mean": 541.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.840007158462583, "num_env_steps_trained_throughput_per_sec": 21.840007158462583, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 184527.686, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184527.637, "sample_time_ms": 2436.922, "learn_time_ms": 182070.975, "learn_throughput": 21.969, "synch_weights_time_ms": 11.816}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "a22d3_00000", "date": "2024-08-06_04-20-59", "timestamp": 1722932459, "time_this_iter_s": 183.15965509414673, "time_total_s": 20250.50614285469, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a1310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20250.50614285469, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 16.565637065637066, "ram_util_percent": 77.57258687258687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9039441036594056, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5161411731260905, "policy_loss": -0.012388075109575186, "vf_loss": 6.525384969020677, "vf_explained_var": 0.0055917061936741055, "kl": 0.006987279947961154, "entropy": 0.5489247111911083, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 816.0, "episode_reward_min": 90.0, "episode_reward_mean": 531.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 53.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [512.0, 561.0, 549.0, 368.0, 553.0, 507.0, 680.0, 612.0, 604.0, 573.0, 540.0, 590.0, 617.0, 368.0, 396.0, 720.0, 517.0, 499.0, 615.0, 590.0, 330.0, 424.0, 690.0, 393.0, 764.0, 670.0, 429.0, 286.0, 450.0, 551.0, 530.0, 380.0, 289.0, 524.0, 360.0, 330.0, 717.0, 585.0, 610.0, 740.0, 370.0, 647.0, 455.0, 361.0, 598.0, 778.0, 448.0, 595.0, 522.0, 627.0, 640.0, 490.0, 575.0, 591.0, 470.0, 590.0, 571.0, 456.0, 292.0, 311.0, 743.0, 603.0, 370.0, 572.0, 575.0, 587.0, 423.0, 603.0, 816.0, 506.0, 541.0, 450.0, 640.0, 428.0, 720.0, 670.0, 710.0, 469.0, 427.0, 720.0, 389.0, 577.0, 117.0, 702.0, 90.0, 629.0, 380.0, 506.0, 409.0, 740.0, 585.0, 473.0, 570.0, 610.0, 520.0, 674.0, 596.0, 500.0, 542.0, 558.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 50.0, 130.0, 20.0, 35.0, 60.0, 30.0, 69.0, 28.0, 20.0, 80.0, 57.0, 70.0, 60.0, 80.0, 20.0, 68.0, 70.0, 47.0, 9.0, 40.0, 50.0, 30.0, 39.0, 90.0, 10.0, 50.0, 110.0, 100.0, 30.0, 40.0, 39.0, 30.0, 20.0, 30.0, 100.0, 0.0, 9.0, 20.0, 80.0, 60.0, 100.0, 90.0, 16.0, 27.0, 40.0, 20.0, 10.0, 80.0, 110.0, 120.0, 86.0, 70.0, -27.0, 30.0, 20.0, 98.0, 0.0, 90.0, 20.0, 120.0, 40.0, 70.0, 30.0, 70.0, 60.0, 40.0, 90.0, 100.0, 60.0, 64.0, 80.0, 30.0, 10.0, 143.0, 60.0, 100.0, 40.0, 0.0, 85.0, 77.0, 70.0, 50.0, 50.0, 60.0, 50.0, 100.0, 10.0, 110.0, 27.0, 50.0, 30.0, 40.0, 20.0, 60.0, 40.0, 7.0, 56.0, 150.0, 120.0, 80.0, 80.0, 60.0, 60.0, 30.0, 30.0, 90.0, 50.0, 10.0, 50.0, 100.0, 60.0, 40.0, 30.0, 40.0, 40.0, 70.0, 70.0, 120.0, 20.0, 60.0, 57.0, 90.0, 100.0, 80.0, 44.0, 48.0, 58.0, 50.0, 30.0, 30.0, 38.0, 0.0, 80.0, 30.0, 40.0, 30.0, 10.0, 80.0, 30.0, 10.0, 35.0, 40.0, 20.0, 25.0, 38.0, 80.0, 90.0, 30.0, 28.0, 70.0, 60.0, 40.0, 90.0, 50.0, 150.0, 70.0, 50.0, 70.0, 70.0, 100.0, 60.0, 60.0, 40.0, 70.0, 60.0, 10.0, 28.0, -51.0, 140.0, 13.0, 40.0, 80.0, 50.0, 110.0, 40.0, 40.0, 50.0, 40.0, 36.0, 76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0, 60.0, 70.0, 50.0, 50.0, 80.0, 0.0, 90.0, 30.0, 80.0, 80.0, 36.0, 70.0, 30.0, 10.0, 40.0, 40.0, 14.0, 40.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 40.0, 60.0, 140.0, 4.0, 30.0, 30.0, 30.0, 70.0, 70.0, 50.0, 110.0, 70.0, 60.0, 80.0, 70.0, 80.0, 130.0, 40.0, 10.0, 20.0, 60.0, 20.0, 0.0, 30.0, 43.0, 40.0, 140.0, 130.0, 3.0, 160.0, 25.0, 90.0, 59.0, 80.0, 55.0, 22.0, 20.0, 50.0, 60.0, 120.0, 60.0, 40.0, 30.0, 60.0, 120.0, 110.0, 50.0, 40.0, 60.0, 20.0, 30.0, 70.0, 5.0, 50.0, 80.0, 24.0, 10.0, 36.0, 40.0, 50.0, 40.0, 40.0, -6.0, 5.0, 11.0, 60.0, 10.0, 90.0, 50.0, 0.0, 110.0, 20.0, 80.0, 30.0, 30.0, 30.0, 50.0, 55.0, 16.0, -1.0, 50.0, -9.0, 110.0, 210.0, -9.0, 79.0, 30.0, 30.0, 50.0, 80.0, 30.0, 90.0, 50.0, 50.0, 60.0, 60.0, 80.0, -18.0, 25.0, 90.0, 16.0, 13.0, 50.0, 50.0, 29.0, 45.0, 30.0, 20.0, 40.0, 0.0, 9.0, 10.0, 60.0, 40.0, 50.0, 30.0, 90.0, 50.0, -40.0, 36.0, 120.0, 100.0, 60.0, -11.0, 56.0, 63.0, 60.0, 0.0, 60.0, 10.0, 10.0, 10.0, 60.0, 30.0, 60.0, 60.0, 100.0, 0.0, 20.0, 30.0, 20.0, 40.0, 10.0, 50.0, 20.0, 40.0, 38.0, 120.0, 40.0, 80.0, 60.0, 150.0, 60.0, 59.0, 60.0, 50.0, 50.0, 58.0, 28.0, 89.0, 10.0, 110.0, 30.0, 90.0, 20.0, 100.0, 30.0, 60.0, 100.0, 60.0, 20.0, 60.0, 80.0, 70.0, 90.0, 40.0, 120.0, 40.0, 120.0, 10.0, 60.0, 60.0, 100.0, 80.0, 50.0, 100.0, 70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0, 90.0, 40.0, 70.0, 110.0, 58.0, 30.0, 49.0, 140.0, 10.0, 50.0, 50.0, 55.0, 40.0, 60.0, 20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 30.0, 15.0, 20.0, 20.0, 70.0, 80.0, 20.0, 70.0, 16.0, 20.0, 14.0, 22.0, 64.0, 90.0, 18.0, 70.0, 140.0, 70.0, 60.0, 50.0, 90.0, 78.0, 50.0, 40.0, 150.0, 110.0, 70.0, 100.0, 70.0, 20.0, 40.0, 80.0, 21.0, 40.0, 27.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 30.0, 10.0, 120.0, 90.0, 60.0, 80.0, 40.0, 35.0, 50.0, 46.0, 100.0, 30.0, 80.0, 30.0, 36.0, 50.0, 70.0, 30.0, 50.0, 50.0, 60.0, 100.0, 50.0, 60.0, 120.0, 100.0, 40.0, -13.0, 60.0, 50.0, 60.0, 60.0, 70.0, 50.0, 100.0, 70.0, 30.0, 90.0, 60.0, 100.0, 90.0, 40.0, 70.0, 0.0, 10.0, 0.0, 110.0, 70.0, 0.0, 60.0, 100.0, 50.0, 60.0, 30.0, 100.0, 55.0, 40.0, 30.0, 50.0, 100.0, 99.0, 70.0, 30.0, 16.0, 10.0, 109.0, 60.0, 70.0, 27.0, 10.0, 90.0, 30.0, 80.0, 30.0, 0.0, 100.0, 40.0, 70.0, 20.0, 90.0, 40.0, 50.0, 100.0, 60.0, 20.0, 40.0, 60.0, 20.0, 110.0, 90.0, 10.0, 50.0, 60.0, 60.0, 110.0, 50.0, 90.0, 15.0, 36.0, 30.0, 100.0, 110.0, 28.0, 10.0, 20.0, 38.0, 50.0, -10.0, 80.0, 50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 51.0, 30.0, 10.0, 30.0, 30.0, 70.0, 50.0, 90.0, 110.0, 61.0, 130.0, 20.0, 40.0, 80.0, 40.0, 64.0, 108.0, -9.0, 70.0, 70.0, 20.0, 95.0, 160.0, -13.0, 110.0, 20.0, 80.0, 10.0, 50.0, 60.0, 20.0, 50.0, 10.0, 20.0, 50.0, 40.0, 60.0, 40.0, 50.0, 50.0, 60.0, 110.0, 40.0, 80.0, 50.0, 37.0, 55.0, 10.0, 70.0, -25.0, 70.0, 60.0, 40.0, 100.0, 130.0, 60.0, 60.0, 92.0, 33.0, 80.0, 100.0, 52.0, 40.0, 80.0, 30.0, 60.0, 20.0, -1.0, 80.0, 100.0, 40.0, 50.0, 50.0, 30.0, 6.0, 35.0, 33.0, 90.0, -8.0, 76.0, 100.0, 50.0, 80.0, 45.0, 20.0, 80.0, 70.0, 30.0, 150.0, 90.0, 40.0, 36.0, 80.0, 30.0, 120.0, 150.0, 90.0, 13.0, 80.0, 60.0, 50.0, 14.0, 110.0, 27.0, 90.0, 50.0, 12.0, 39.0, 90.0, 2.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 80.0, 70.0, 60.0, 100.0, 60.0, 40.0, -80.0, 40.0, 60.0, 40.0, 60.0, 40.0, 70.0, 120.0, 30.0, 70.0, 80.0, 40.0, 60.0, 60.0, 70.0, 88.0, 40.0, 30.0, 10.0, 50.0, 60.0, 10.0, 30.0, 70.0, 40.0, 40.0, 80.0, 30.0, 80.0, 100.0, 50.0, 120.0, 80.0, 50.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 60.0, 110.0, 110.0, 50.0, 30.0, 30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0, -3.0, 70.0, 90.0, 40.0, 70.0, 17.0, 60.0, 50.0, 25.0, 50.0, -31.0, 60.0, 28.0, 50.0, 50.0, 50.0, 60.0, 50.0, 60.0, 50.0, 30.0, 60.0, 40.0, 50.0, 40.0, 170.0, 80.0, 90.0, 120.0, 40.0, 8.0, 40.0, 3.0, 90.0, 40.0, 110.0, 50.0, 30.0, -2.0, 20.0, 70.0, 30.0, 60.0, 100.0, 7.0, 30.0, 110.0, 30.0, 90.0, 50.0, 10.0, 35.0, 50.0, 51.0, 26.0, -62.0, -72.0, 52.0, 10.0, 17.0, 110.0, 90.0, 80.0, 50.0, 110.0, 70.0, 40.0, 20.0, 130.0, 2.0, -105.0, -73.0, 27.0, 28.0, 60.0, 50.0, 30.0, 14.0, 29.0, 30.0, 20.0, 50.0, 150.0, 100.0, 40.0, 20.0, 20.0, 39.0, 40.0, 150.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 80.0, 120.0, 20.0, 30.0, 107.0, 17.0, 50.0, 16.0, 40.0, 20.0, 50.0, 70.0, 80.0, 56.0, 40.0, 23.0, 54.0, 20.0, 50.0, 80.0, 30.0, 60.0, -8.0, 60.0, 90.0, 100.0, 100.0, 30.0, 90.0, 100.0, 90.0, 40.0, 80.0, 20.0, 33.0, 25.0, 40.0, 17.0, 90.0, 20.0, 110.0, 60.0, 90.0, 100.0, 40.0, 27.0, 70.0, 0.0, 80.0, 100.0, 20.0, 16.0, 50.0, 70.0, 40.0, 40.0, 90.0, 30.0, 10.0, 70.0, 100.0, 50.0, 70.0, 70.0, 70.0, 50.0, 80.0, 100.0, 20.0, 20.0, 90.0, 60.0, 100.0, 20.0, 10.0, 30.0, 90.0, 40.0, 0.0, 70.0, 40.0, 70.0, 100.0, 70.0, 90.0, 70.0, 120.0, 70.0, 40.0, 60.0, 38.0, 100.0, 26.0, 60.0, 50.0, 0.0, 50.0, 80.0, 140.0, 30.0, 110.0, 55.0, 1.0, 80.0, 50.0, 90.0, 60.0, 30.0, 30.0, 70.0, 50.0, 10.0, 60.0, 50.0, 66.0, 40.0, 130.0, 44.0, 15.0, 50.0, 60.0, 80.0, 7.0, 50.0, 90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5483305803489347, "mean_inference_ms": 1.558705753649889, "mean_action_processing_ms": 0.49235147528728385, "mean_env_wait_ms": 1.3604631186879486, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012673377990722656, "StateBufferConnector_ms": 0.009423255920410156, "ViewRequirementAgentConnector_ms": 0.3803238868713379}, "num_episodes": 23, "episode_return_max": 816.0, "episode_return_min": 90.0, "episode_return_mean": 531.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.737731646595698, "num_env_steps_trained_throughput_per_sec": 21.737731646595698, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 184553.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184553.512, "sample_time_ms": 2435.89, "learn_time_ms": 182097.766, "learn_throughput": 21.966, "synch_weights_time_ms": 11.965}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "a22d3_00000", "date": "2024-08-06_04-24-03", "timestamp": 1722932643, "time_this_iter_s": 184.0233190059662, "time_total_s": 20434.529461860657, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d9940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20434.529461860657, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.260536398467433, "ram_util_percent": 77.08007662835249}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.807781119582752, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.285745922368936, "policy_loss": -0.01059871500974652, "vf_loss": 6.293887142124522, "vf_explained_var": 0.005772041817442677, "kl": 0.005461111992013594, "entropy": 0.5549810200707473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 816.0, "episode_reward_min": 90.0, "episode_reward_mean": 535.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 53.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [615.0, 590.0, 330.0, 424.0, 690.0, 393.0, 764.0, 670.0, 429.0, 286.0, 450.0, 551.0, 530.0, 380.0, 289.0, 524.0, 360.0, 330.0, 717.0, 585.0, 610.0, 740.0, 370.0, 647.0, 455.0, 361.0, 598.0, 778.0, 448.0, 595.0, 522.0, 627.0, 640.0, 490.0, 575.0, 591.0, 470.0, 590.0, 571.0, 456.0, 292.0, 311.0, 743.0, 603.0, 370.0, 572.0, 575.0, 587.0, 423.0, 603.0, 816.0, 506.0, 541.0, 450.0, 640.0, 428.0, 720.0, 670.0, 710.0, 469.0, 427.0, 720.0, 389.0, 577.0, 117.0, 702.0, 90.0, 629.0, 380.0, 506.0, 409.0, 740.0, 585.0, 473.0, 570.0, 610.0, 520.0, 674.0, 596.0, 500.0, 542.0, 558.0, 767.0, 500.0, 738.0, 465.0, 307.0, 455.0, 316.0, 370.0, 456.0, 515.0, 580.0, 760.0, 780.0, 529.0, 700.0, 607.0, 589.0, 687.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [76.0, 60.0, 90.0, 70.0, 50.0, 80.0, 30.0, 50.0, 70.0, 39.0, 60.0, 70.0, 50.0, 50.0, 80.0, 0.0, 90.0, 30.0, 80.0, 80.0, 36.0, 70.0, 30.0, 10.0, 40.0, 40.0, 14.0, 40.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 40.0, 60.0, 140.0, 4.0, 30.0, 30.0, 30.0, 70.0, 70.0, 50.0, 110.0, 70.0, 60.0, 80.0, 70.0, 80.0, 130.0, 40.0, 10.0, 20.0, 60.0, 20.0, 0.0, 30.0, 43.0, 40.0, 140.0, 130.0, 3.0, 160.0, 25.0, 90.0, 59.0, 80.0, 55.0, 22.0, 20.0, 50.0, 60.0, 120.0, 60.0, 40.0, 30.0, 60.0, 120.0, 110.0, 50.0, 40.0, 60.0, 20.0, 30.0, 70.0, 5.0, 50.0, 80.0, 24.0, 10.0, 36.0, 40.0, 50.0, 40.0, 40.0, -6.0, 5.0, 11.0, 60.0, 10.0, 90.0, 50.0, 0.0, 110.0, 20.0, 80.0, 30.0, 30.0, 30.0, 50.0, 55.0, 16.0, -1.0, 50.0, -9.0, 110.0, 210.0, -9.0, 79.0, 30.0, 30.0, 50.0, 80.0, 30.0, 90.0, 50.0, 50.0, 60.0, 60.0, 80.0, -18.0, 25.0, 90.0, 16.0, 13.0, 50.0, 50.0, 29.0, 45.0, 30.0, 20.0, 40.0, 0.0, 9.0, 10.0, 60.0, 40.0, 50.0, 30.0, 90.0, 50.0, -40.0, 36.0, 120.0, 100.0, 60.0, -11.0, 56.0, 63.0, 60.0, 0.0, 60.0, 10.0, 10.0, 10.0, 60.0, 30.0, 60.0, 60.0, 100.0, 0.0, 20.0, 30.0, 20.0, 40.0, 10.0, 50.0, 20.0, 40.0, 38.0, 120.0, 40.0, 80.0, 60.0, 150.0, 60.0, 59.0, 60.0, 50.0, 50.0, 58.0, 28.0, 89.0, 10.0, 110.0, 30.0, 90.0, 20.0, 100.0, 30.0, 60.0, 100.0, 60.0, 20.0, 60.0, 80.0, 70.0, 90.0, 40.0, 120.0, 40.0, 120.0, 10.0, 60.0, 60.0, 100.0, 80.0, 50.0, 100.0, 70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0, 90.0, 40.0, 70.0, 110.0, 58.0, 30.0, 49.0, 140.0, 10.0, 50.0, 50.0, 55.0, 40.0, 60.0, 20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 30.0, 15.0, 20.0, 20.0, 70.0, 80.0, 20.0, 70.0, 16.0, 20.0, 14.0, 22.0, 64.0, 90.0, 18.0, 70.0, 140.0, 70.0, 60.0, 50.0, 90.0, 78.0, 50.0, 40.0, 150.0, 110.0, 70.0, 100.0, 70.0, 20.0, 40.0, 80.0, 21.0, 40.0, 27.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 30.0, 10.0, 120.0, 90.0, 60.0, 80.0, 40.0, 35.0, 50.0, 46.0, 100.0, 30.0, 80.0, 30.0, 36.0, 50.0, 70.0, 30.0, 50.0, 50.0, 60.0, 100.0, 50.0, 60.0, 120.0, 100.0, 40.0, -13.0, 60.0, 50.0, 60.0, 60.0, 70.0, 50.0, 100.0, 70.0, 30.0, 90.0, 60.0, 100.0, 90.0, 40.0, 70.0, 0.0, 10.0, 0.0, 110.0, 70.0, 0.0, 60.0, 100.0, 50.0, 60.0, 30.0, 100.0, 55.0, 40.0, 30.0, 50.0, 100.0, 99.0, 70.0, 30.0, 16.0, 10.0, 109.0, 60.0, 70.0, 27.0, 10.0, 90.0, 30.0, 80.0, 30.0, 0.0, 100.0, 40.0, 70.0, 20.0, 90.0, 40.0, 50.0, 100.0, 60.0, 20.0, 40.0, 60.0, 20.0, 110.0, 90.0, 10.0, 50.0, 60.0, 60.0, 110.0, 50.0, 90.0, 15.0, 36.0, 30.0, 100.0, 110.0, 28.0, 10.0, 20.0, 38.0, 50.0, -10.0, 80.0, 50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 51.0, 30.0, 10.0, 30.0, 30.0, 70.0, 50.0, 90.0, 110.0, 61.0, 130.0, 20.0, 40.0, 80.0, 40.0, 64.0, 108.0, -9.0, 70.0, 70.0, 20.0, 95.0, 160.0, -13.0, 110.0, 20.0, 80.0, 10.0, 50.0, 60.0, 20.0, 50.0, 10.0, 20.0, 50.0, 40.0, 60.0, 40.0, 50.0, 50.0, 60.0, 110.0, 40.0, 80.0, 50.0, 37.0, 55.0, 10.0, 70.0, -25.0, 70.0, 60.0, 40.0, 100.0, 130.0, 60.0, 60.0, 92.0, 33.0, 80.0, 100.0, 52.0, 40.0, 80.0, 30.0, 60.0, 20.0, -1.0, 80.0, 100.0, 40.0, 50.0, 50.0, 30.0, 6.0, 35.0, 33.0, 90.0, -8.0, 76.0, 100.0, 50.0, 80.0, 45.0, 20.0, 80.0, 70.0, 30.0, 150.0, 90.0, 40.0, 36.0, 80.0, 30.0, 120.0, 150.0, 90.0, 13.0, 80.0, 60.0, 50.0, 14.0, 110.0, 27.0, 90.0, 50.0, 12.0, 39.0, 90.0, 2.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 80.0, 70.0, 60.0, 100.0, 60.0, 40.0, -80.0, 40.0, 60.0, 40.0, 60.0, 40.0, 70.0, 120.0, 30.0, 70.0, 80.0, 40.0, 60.0, 60.0, 70.0, 88.0, 40.0, 30.0, 10.0, 50.0, 60.0, 10.0, 30.0, 70.0, 40.0, 40.0, 80.0, 30.0, 80.0, 100.0, 50.0, 120.0, 80.0, 50.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 60.0, 110.0, 110.0, 50.0, 30.0, 30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0, -3.0, 70.0, 90.0, 40.0, 70.0, 17.0, 60.0, 50.0, 25.0, 50.0, -31.0, 60.0, 28.0, 50.0, 50.0, 50.0, 60.0, 50.0, 60.0, 50.0, 30.0, 60.0, 40.0, 50.0, 40.0, 170.0, 80.0, 90.0, 120.0, 40.0, 8.0, 40.0, 3.0, 90.0, 40.0, 110.0, 50.0, 30.0, -2.0, 20.0, 70.0, 30.0, 60.0, 100.0, 7.0, 30.0, 110.0, 30.0, 90.0, 50.0, 10.0, 35.0, 50.0, 51.0, 26.0, -62.0, -72.0, 52.0, 10.0, 17.0, 110.0, 90.0, 80.0, 50.0, 110.0, 70.0, 40.0, 20.0, 130.0, 2.0, -105.0, -73.0, 27.0, 28.0, 60.0, 50.0, 30.0, 14.0, 29.0, 30.0, 20.0, 50.0, 150.0, 100.0, 40.0, 20.0, 20.0, 39.0, 40.0, 150.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 80.0, 120.0, 20.0, 30.0, 107.0, 17.0, 50.0, 16.0, 40.0, 20.0, 50.0, 70.0, 80.0, 56.0, 40.0, 23.0, 54.0, 20.0, 50.0, 80.0, 30.0, 60.0, -8.0, 60.0, 90.0, 100.0, 100.0, 30.0, 90.0, 100.0, 90.0, 40.0, 80.0, 20.0, 33.0, 25.0, 40.0, 17.0, 90.0, 20.0, 110.0, 60.0, 90.0, 100.0, 40.0, 27.0, 70.0, 0.0, 80.0, 100.0, 20.0, 16.0, 50.0, 70.0, 40.0, 40.0, 90.0, 30.0, 10.0, 70.0, 100.0, 50.0, 70.0, 70.0, 70.0, 50.0, 80.0, 100.0, 20.0, 20.0, 90.0, 60.0, 100.0, 20.0, 10.0, 30.0, 90.0, 40.0, 0.0, 70.0, 40.0, 70.0, 100.0, 70.0, 90.0, 70.0, 120.0, 70.0, 40.0, 60.0, 38.0, 100.0, 26.0, 60.0, 50.0, 0.0, 50.0, 80.0, 140.0, 30.0, 110.0, 55.0, 1.0, 80.0, 50.0, 90.0, 60.0, 30.0, 30.0, 70.0, 50.0, 10.0, 60.0, 50.0, 66.0, 40.0, 130.0, 44.0, 15.0, 50.0, 60.0, 80.0, 7.0, 50.0, 90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0, 63.0, 74.0, 70.0, 30.0, 100.0, 60.0, 70.0, 100.0, 110.0, 90.0, 40.0, 120.0, 30.0, 50.0, 50.0, 30.0, 50.0, 20.0, 30.0, 80.0, 60.0, 100.0, 30.0, 60.0, 90.0, 80.0, 100.0, 68.0, 95.0, 55.0, 80.0, 40.0, 20.0, 64.0, 10.0, 70.0, 21.0, 10.0, 110.0, 40.0, 10.0, 20.0, 110.0, 10.0, 38.0, 20.0, 50.0, 0.0, 30.0, 19.0, 39.0, 40.0, -38.0, 50.0, 30.0, 110.0, 47.0, -3.0, 110.0, 70.0, 10.0, 64.0, 30.0, 50.0, 69.0, -22.0, 30.0, 50.0, -35.0, 70.0, 60.0, 7.0, 100.0, 18.0, 50.0, 17.0, 19.0, 40.0, 50.0, 9.0, 50.0, 30.0, 43.0, 40.0, 30.0, 70.0, 40.0, 23.0, 90.0, 40.0, 110.0, 30.0, 10.0, 30.0, 25.0, 70.0, 50.0, 10.0, 90.0, 90.0, 20.0, 50.0, 30.0, 40.0, 140.0, 10.0, 70.0, 140.0, 10.0, 70.0, 40.0, 50.0, 90.0, 120.0, 50.0, 60.0, 80.0, 70.0, 100.0, 100.0, 40.0, 120.0, 80.0, 110.0, 50.0, 40.0, 100.0, 60.0, 150.0, 30.0, 70.0, 86.0, 70.0, 74.0, 18.0, 36.0, 80.0, 26.0, 50.0, 19.0, 60.0, 50.0, 90.0, 150.0, 100.0, 30.0, 90.0, 50.0, 50.0, 30.0, 89.0, 50.0, 50.0, 50.0, 38.0, 30.0, 110.0, 110.0, 60.0, 20.0, 38.0, 60.0, 10.0, 3.0, 110.0, 110.0, 22.0, 60.0, 56.0, 120.0, 130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5473530268365858, "mean_inference_ms": 1.55721143522133, "mean_action_processing_ms": 0.491858638010234, "mean_env_wait_ms": 1.3594168984827568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012487411499023438, "StateBufferConnector_ms": 0.009345054626464844, "ViewRequirementAgentConnector_ms": 0.378704309463501}, "num_episodes": 18, "episode_return_max": 816.0, "episode_return_min": 90.0, "episode_return_mean": 535.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.84030756005928, "num_env_steps_trained_throughput_per_sec": 21.84030756005928, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 184476.403, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184476.354, "sample_time_ms": 2429.605, "learn_time_ms": 182027.192, "learn_throughput": 21.975, "synch_weights_time_ms": 11.994}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "a22d3_00000", "date": "2024-08-06_04-27-06", "timestamp": 1722932826, "time_this_iter_s": 183.15535187721252, "time_total_s": 20617.68481373787, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20617.68481373787, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.85096525096525, "ram_util_percent": 77.38841698841698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7973762382651035, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.544440495142667, "policy_loss": -0.011271356100031037, "vf_loss": 6.553025372772298, "vf_explained_var": 0.0014815925028377449, "kl": 0.005969925375194256, "entropy": 0.5435493200287398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 90.0, "episode_reward_mean": 560.04, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 56.004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 647.0, 455.0, 361.0, 598.0, 778.0, 448.0, 595.0, 522.0, 627.0, 640.0, 490.0, 575.0, 591.0, 470.0, 590.0, 571.0, 456.0, 292.0, 311.0, 743.0, 603.0, 370.0, 572.0, 575.0, 587.0, 423.0, 603.0, 816.0, 506.0, 541.0, 450.0, 640.0, 428.0, 720.0, 670.0, 710.0, 469.0, 427.0, 720.0, 389.0, 577.0, 117.0, 702.0, 90.0, 629.0, 380.0, 506.0, 409.0, 740.0, 585.0, 473.0, 570.0, 610.0, 520.0, 674.0, 596.0, 500.0, 542.0, 558.0, 767.0, 500.0, 738.0, 465.0, 307.0, 455.0, 316.0, 370.0, 456.0, 515.0, 580.0, 760.0, 780.0, 529.0, 700.0, 607.0, 589.0, 687.0, 710.0, 624.0, 530.0, 700.0, 439.0, 675.0, 660.0, 790.0, 617.0, 580.0, 397.0, 488.0, 813.0, 660.0, 692.0, 527.0, 890.0, 494.0, 688.0, 580.0, 475.0, 727.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 20.0, 30.0, 40.0, 20.0, 70.0, 30.0, 60.0, 20.0, 10.0, 90.0, 40.0, 70.0, 110.0, 58.0, 30.0, 49.0, 140.0, 10.0, 50.0, 50.0, 55.0, 40.0, 60.0, 20.0, 80.0, 50.0, 40.0, 40.0, 20.0, 30.0, 15.0, 20.0, 20.0, 70.0, 80.0, 20.0, 70.0, 16.0, 20.0, 14.0, 22.0, 64.0, 90.0, 18.0, 70.0, 140.0, 70.0, 60.0, 50.0, 90.0, 78.0, 50.0, 40.0, 150.0, 110.0, 70.0, 100.0, 70.0, 20.0, 40.0, 80.0, 21.0, 40.0, 27.0, 40.0, 60.0, 70.0, 30.0, 40.0, 80.0, 30.0, 10.0, 120.0, 90.0, 60.0, 80.0, 40.0, 35.0, 50.0, 46.0, 100.0, 30.0, 80.0, 30.0, 36.0, 50.0, 70.0, 30.0, 50.0, 50.0, 60.0, 100.0, 50.0, 60.0, 120.0, 100.0, 40.0, -13.0, 60.0, 50.0, 60.0, 60.0, 70.0, 50.0, 100.0, 70.0, 30.0, 90.0, 60.0, 100.0, 90.0, 40.0, 70.0, 0.0, 10.0, 0.0, 110.0, 70.0, 0.0, 60.0, 100.0, 50.0, 60.0, 30.0, 100.0, 55.0, 40.0, 30.0, 50.0, 100.0, 99.0, 70.0, 30.0, 16.0, 10.0, 109.0, 60.0, 70.0, 27.0, 10.0, 90.0, 30.0, 80.0, 30.0, 0.0, 100.0, 40.0, 70.0, 20.0, 90.0, 40.0, 50.0, 100.0, 60.0, 20.0, 40.0, 60.0, 20.0, 110.0, 90.0, 10.0, 50.0, 60.0, 60.0, 110.0, 50.0, 90.0, 15.0, 36.0, 30.0, 100.0, 110.0, 28.0, 10.0, 20.0, 38.0, 50.0, -10.0, 80.0, 50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 51.0, 30.0, 10.0, 30.0, 30.0, 70.0, 50.0, 90.0, 110.0, 61.0, 130.0, 20.0, 40.0, 80.0, 40.0, 64.0, 108.0, -9.0, 70.0, 70.0, 20.0, 95.0, 160.0, -13.0, 110.0, 20.0, 80.0, 10.0, 50.0, 60.0, 20.0, 50.0, 10.0, 20.0, 50.0, 40.0, 60.0, 40.0, 50.0, 50.0, 60.0, 110.0, 40.0, 80.0, 50.0, 37.0, 55.0, 10.0, 70.0, -25.0, 70.0, 60.0, 40.0, 100.0, 130.0, 60.0, 60.0, 92.0, 33.0, 80.0, 100.0, 52.0, 40.0, 80.0, 30.0, 60.0, 20.0, -1.0, 80.0, 100.0, 40.0, 50.0, 50.0, 30.0, 6.0, 35.0, 33.0, 90.0, -8.0, 76.0, 100.0, 50.0, 80.0, 45.0, 20.0, 80.0, 70.0, 30.0, 150.0, 90.0, 40.0, 36.0, 80.0, 30.0, 120.0, 150.0, 90.0, 13.0, 80.0, 60.0, 50.0, 14.0, 110.0, 27.0, 90.0, 50.0, 12.0, 39.0, 90.0, 2.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 80.0, 70.0, 60.0, 100.0, 60.0, 40.0, -80.0, 40.0, 60.0, 40.0, 60.0, 40.0, 70.0, 120.0, 30.0, 70.0, 80.0, 40.0, 60.0, 60.0, 70.0, 88.0, 40.0, 30.0, 10.0, 50.0, 60.0, 10.0, 30.0, 70.0, 40.0, 40.0, 80.0, 30.0, 80.0, 100.0, 50.0, 120.0, 80.0, 50.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 60.0, 110.0, 110.0, 50.0, 30.0, 30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0, -3.0, 70.0, 90.0, 40.0, 70.0, 17.0, 60.0, 50.0, 25.0, 50.0, -31.0, 60.0, 28.0, 50.0, 50.0, 50.0, 60.0, 50.0, 60.0, 50.0, 30.0, 60.0, 40.0, 50.0, 40.0, 170.0, 80.0, 90.0, 120.0, 40.0, 8.0, 40.0, 3.0, 90.0, 40.0, 110.0, 50.0, 30.0, -2.0, 20.0, 70.0, 30.0, 60.0, 100.0, 7.0, 30.0, 110.0, 30.0, 90.0, 50.0, 10.0, 35.0, 50.0, 51.0, 26.0, -62.0, -72.0, 52.0, 10.0, 17.0, 110.0, 90.0, 80.0, 50.0, 110.0, 70.0, 40.0, 20.0, 130.0, 2.0, -105.0, -73.0, 27.0, 28.0, 60.0, 50.0, 30.0, 14.0, 29.0, 30.0, 20.0, 50.0, 150.0, 100.0, 40.0, 20.0, 20.0, 39.0, 40.0, 150.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 80.0, 120.0, 20.0, 30.0, 107.0, 17.0, 50.0, 16.0, 40.0, 20.0, 50.0, 70.0, 80.0, 56.0, 40.0, 23.0, 54.0, 20.0, 50.0, 80.0, 30.0, 60.0, -8.0, 60.0, 90.0, 100.0, 100.0, 30.0, 90.0, 100.0, 90.0, 40.0, 80.0, 20.0, 33.0, 25.0, 40.0, 17.0, 90.0, 20.0, 110.0, 60.0, 90.0, 100.0, 40.0, 27.0, 70.0, 0.0, 80.0, 100.0, 20.0, 16.0, 50.0, 70.0, 40.0, 40.0, 90.0, 30.0, 10.0, 70.0, 100.0, 50.0, 70.0, 70.0, 70.0, 50.0, 80.0, 100.0, 20.0, 20.0, 90.0, 60.0, 100.0, 20.0, 10.0, 30.0, 90.0, 40.0, 0.0, 70.0, 40.0, 70.0, 100.0, 70.0, 90.0, 70.0, 120.0, 70.0, 40.0, 60.0, 38.0, 100.0, 26.0, 60.0, 50.0, 0.0, 50.0, 80.0, 140.0, 30.0, 110.0, 55.0, 1.0, 80.0, 50.0, 90.0, 60.0, 30.0, 30.0, 70.0, 50.0, 10.0, 60.0, 50.0, 66.0, 40.0, 130.0, 44.0, 15.0, 50.0, 60.0, 80.0, 7.0, 50.0, 90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0, 63.0, 74.0, 70.0, 30.0, 100.0, 60.0, 70.0, 100.0, 110.0, 90.0, 40.0, 120.0, 30.0, 50.0, 50.0, 30.0, 50.0, 20.0, 30.0, 80.0, 60.0, 100.0, 30.0, 60.0, 90.0, 80.0, 100.0, 68.0, 95.0, 55.0, 80.0, 40.0, 20.0, 64.0, 10.0, 70.0, 21.0, 10.0, 110.0, 40.0, 10.0, 20.0, 110.0, 10.0, 38.0, 20.0, 50.0, 0.0, 30.0, 19.0, 39.0, 40.0, -38.0, 50.0, 30.0, 110.0, 47.0, -3.0, 110.0, 70.0, 10.0, 64.0, 30.0, 50.0, 69.0, -22.0, 30.0, 50.0, -35.0, 70.0, 60.0, 7.0, 100.0, 18.0, 50.0, 17.0, 19.0, 40.0, 50.0, 9.0, 50.0, 30.0, 43.0, 40.0, 30.0, 70.0, 40.0, 23.0, 90.0, 40.0, 110.0, 30.0, 10.0, 30.0, 25.0, 70.0, 50.0, 10.0, 90.0, 90.0, 20.0, 50.0, 30.0, 40.0, 140.0, 10.0, 70.0, 140.0, 10.0, 70.0, 40.0, 50.0, 90.0, 120.0, 50.0, 60.0, 80.0, 70.0, 100.0, 100.0, 40.0, 120.0, 80.0, 110.0, 50.0, 40.0, 100.0, 60.0, 150.0, 30.0, 70.0, 86.0, 70.0, 74.0, 18.0, 36.0, 80.0, 26.0, 50.0, 19.0, 60.0, 50.0, 90.0, 150.0, 100.0, 30.0, 90.0, 50.0, 50.0, 30.0, 89.0, 50.0, 50.0, 50.0, 38.0, 30.0, 110.0, 110.0, 60.0, 20.0, 38.0, 60.0, 10.0, 3.0, 110.0, 110.0, 22.0, 60.0, 56.0, 120.0, 130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0, 40.0, 90.0, 50.0, 40.0, 80.0, 70.0, 50.0, 130.0, 50.0, 110.0, 87.0, 30.0, 40.0, 50.0, 40.0, 140.0, 60.0, 40.0, 17.0, 120.0, 60.0, 20.0, 50.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 70.0, 50.0, 50.0, 60.0, 110.0, 20.0, 20.0, 80.0, 170.0, 70.0, 70.0, 0.0, 40.0, 70.0, 90.0, 50.0, 40.0, 29.0, 0.0, 70.0, 50.0, 100.0, 0.0, 110.0, 70.0, 55.0, 150.0, 90.0, -10.0, 70.0, 40.0, 45.0, 100.0, 70.0, 60.0, 60.0, 70.0, 130.0, 40.0, 70.0, 15.0, 90.0, 150.0, 130.0, 80.0, 35.0, 100.0, 60.0, 30.0, 85.0, 30.0, 40.0, 61.0, 80.0, 70.0, 23.0, 58.0, 36.0, 50.0, 100.0, 99.0, 20.0, 30.0, 50.0, 100.0, 80.0, 40.0, 60.0, 40.0, 60.0, 100.0, 10.0, 80.0, 40.0, 58.0, 2.0, 40.0, 70.0, 72.0, -5.0, 30.0, 90.0, 60.0, 21.0, 30.0, -1.0, 50.0, 50.0, 48.0, 40.0, 100.0, 79.0, 70.0, 10.0, 49.0, 78.0, 158.0, 60.0, 100.0, 126.0, 83.0, 80.0, 110.0, 80.0, 50.0, 0.0, 20.0, 70.0, 100.0, 80.0, 70.0, 80.0, 98.0, 100.0, 150.0, 39.0, 67.0, 90.0, -25.0, 50.0, 43.0, 30.0, 20.0, 60.0, 40.0, 28.0, 50.0, 110.0, 49.0, 90.0, 50.0, 100.0, 60.0, 30.0, 80.0, 112.0, 108.0, 140.0, 130.0, 70.0, 60.0, 90.0, 27.0, 90.0, 60.0, 29.0, 80.0, -1.0, 50.0, 19.0, 50.0, 80.0, 50.0, 70.0, 4.0, 114.0, 80.0, 80.0, 80.0, 70.0, 60.0, 60.0, 10.0, 40.0, 90.0, 90.0, 90.0, 30.0, 34.0, 50.0, 86.0, 50.0, 19.0, 33.0, 70.0, 29.0, 70.0, 75.0, 9.0, 100.0, 20.0, 100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5461103119166415, "mean_inference_ms": 1.5553338225479951, "mean_action_processing_ms": 0.4912494693762731, "mean_env_wait_ms": 1.358115739835644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012084007263183594, "StateBufferConnector_ms": 0.009121894836425781, "ViewRequirementAgentConnector_ms": 0.3702855110168457}, "num_episodes": 22, "episode_return_max": 890.0, "episode_return_min": 90.0, "episode_return_mean": 560.04}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.719651467167516, "num_env_steps_trained_throughput_per_sec": 21.719651467167516, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 184288.708, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184288.66, "sample_time_ms": 2409.834, "learn_time_ms": 181859.228, "learn_throughput": 21.995, "synch_weights_time_ms": 12.128}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "a22d3_00000", "date": "2024-08-06_04-30-10", "timestamp": 1722933010, "time_this_iter_s": 184.1736397743225, "time_total_s": 20801.85845351219, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20801.85845351219, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.149615384615384, "ram_util_percent": 77.77115384615385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.805169319763732, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.951151908523104, "policy_loss": -0.011372603783686472, "vf_loss": 5.959760492068891, "vf_explained_var": 0.009330689875335613, "kl": 0.006142253591390119, "entropy": 0.587900295053808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 78.0, "episode_reward_mean": 557.94, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 55.794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.0, 311.0, 743.0, 603.0, 370.0, 572.0, 575.0, 587.0, 423.0, 603.0, 816.0, 506.0, 541.0, 450.0, 640.0, 428.0, 720.0, 670.0, 710.0, 469.0, 427.0, 720.0, 389.0, 577.0, 117.0, 702.0, 90.0, 629.0, 380.0, 506.0, 409.0, 740.0, 585.0, 473.0, 570.0, 610.0, 520.0, 674.0, 596.0, 500.0, 542.0, 558.0, 767.0, 500.0, 738.0, 465.0, 307.0, 455.0, 316.0, 370.0, 456.0, 515.0, 580.0, 760.0, 780.0, 529.0, 700.0, 607.0, 589.0, 687.0, 710.0, 624.0, 530.0, 700.0, 439.0, 675.0, 660.0, 790.0, 617.0, 580.0, 397.0, 488.0, 813.0, 660.0, 692.0, 527.0, 890.0, 494.0, 688.0, 580.0, 475.0, 727.0, 780.0, 613.0, 586.0, 560.0, 478.0, 649.0, 386.0, 488.0, 703.0, 556.0, 557.0, 366.0, 78.0, 640.0, 639.0, 499.0, 538.0, 458.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 19.0, 30.0, -6.0, 20.0, 60.0, 19.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 51.0, 30.0, 10.0, 30.0, 30.0, 70.0, 50.0, 90.0, 110.0, 61.0, 130.0, 20.0, 40.0, 80.0, 40.0, 64.0, 108.0, -9.0, 70.0, 70.0, 20.0, 95.0, 160.0, -13.0, 110.0, 20.0, 80.0, 10.0, 50.0, 60.0, 20.0, 50.0, 10.0, 20.0, 50.0, 40.0, 60.0, 40.0, 50.0, 50.0, 60.0, 110.0, 40.0, 80.0, 50.0, 37.0, 55.0, 10.0, 70.0, -25.0, 70.0, 60.0, 40.0, 100.0, 130.0, 60.0, 60.0, 92.0, 33.0, 80.0, 100.0, 52.0, 40.0, 80.0, 30.0, 60.0, 20.0, -1.0, 80.0, 100.0, 40.0, 50.0, 50.0, 30.0, 6.0, 35.0, 33.0, 90.0, -8.0, 76.0, 100.0, 50.0, 80.0, 45.0, 20.0, 80.0, 70.0, 30.0, 150.0, 90.0, 40.0, 36.0, 80.0, 30.0, 120.0, 150.0, 90.0, 13.0, 80.0, 60.0, 50.0, 14.0, 110.0, 27.0, 90.0, 50.0, 12.0, 39.0, 90.0, 2.0, 90.0, 60.0, 100.0, 20.0, 20.0, 40.0, 80.0, 70.0, 60.0, 100.0, 60.0, 40.0, -80.0, 40.0, 60.0, 40.0, 60.0, 40.0, 70.0, 120.0, 30.0, 70.0, 80.0, 40.0, 60.0, 60.0, 70.0, 88.0, 40.0, 30.0, 10.0, 50.0, 60.0, 10.0, 30.0, 70.0, 40.0, 40.0, 80.0, 30.0, 80.0, 100.0, 50.0, 120.0, 80.0, 50.0, 90.0, 60.0, 90.0, 30.0, 60.0, 70.0, 60.0, 110.0, 110.0, 50.0, 30.0, 30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0, -3.0, 70.0, 90.0, 40.0, 70.0, 17.0, 60.0, 50.0, 25.0, 50.0, -31.0, 60.0, 28.0, 50.0, 50.0, 50.0, 60.0, 50.0, 60.0, 50.0, 30.0, 60.0, 40.0, 50.0, 40.0, 170.0, 80.0, 90.0, 120.0, 40.0, 8.0, 40.0, 3.0, 90.0, 40.0, 110.0, 50.0, 30.0, -2.0, 20.0, 70.0, 30.0, 60.0, 100.0, 7.0, 30.0, 110.0, 30.0, 90.0, 50.0, 10.0, 35.0, 50.0, 51.0, 26.0, -62.0, -72.0, 52.0, 10.0, 17.0, 110.0, 90.0, 80.0, 50.0, 110.0, 70.0, 40.0, 20.0, 130.0, 2.0, -105.0, -73.0, 27.0, 28.0, 60.0, 50.0, 30.0, 14.0, 29.0, 30.0, 20.0, 50.0, 150.0, 100.0, 40.0, 20.0, 20.0, 39.0, 40.0, 150.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 80.0, 120.0, 20.0, 30.0, 107.0, 17.0, 50.0, 16.0, 40.0, 20.0, 50.0, 70.0, 80.0, 56.0, 40.0, 23.0, 54.0, 20.0, 50.0, 80.0, 30.0, 60.0, -8.0, 60.0, 90.0, 100.0, 100.0, 30.0, 90.0, 100.0, 90.0, 40.0, 80.0, 20.0, 33.0, 25.0, 40.0, 17.0, 90.0, 20.0, 110.0, 60.0, 90.0, 100.0, 40.0, 27.0, 70.0, 0.0, 80.0, 100.0, 20.0, 16.0, 50.0, 70.0, 40.0, 40.0, 90.0, 30.0, 10.0, 70.0, 100.0, 50.0, 70.0, 70.0, 70.0, 50.0, 80.0, 100.0, 20.0, 20.0, 90.0, 60.0, 100.0, 20.0, 10.0, 30.0, 90.0, 40.0, 0.0, 70.0, 40.0, 70.0, 100.0, 70.0, 90.0, 70.0, 120.0, 70.0, 40.0, 60.0, 38.0, 100.0, 26.0, 60.0, 50.0, 0.0, 50.0, 80.0, 140.0, 30.0, 110.0, 55.0, 1.0, 80.0, 50.0, 90.0, 60.0, 30.0, 30.0, 70.0, 50.0, 10.0, 60.0, 50.0, 66.0, 40.0, 130.0, 44.0, 15.0, 50.0, 60.0, 80.0, 7.0, 50.0, 90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0, 63.0, 74.0, 70.0, 30.0, 100.0, 60.0, 70.0, 100.0, 110.0, 90.0, 40.0, 120.0, 30.0, 50.0, 50.0, 30.0, 50.0, 20.0, 30.0, 80.0, 60.0, 100.0, 30.0, 60.0, 90.0, 80.0, 100.0, 68.0, 95.0, 55.0, 80.0, 40.0, 20.0, 64.0, 10.0, 70.0, 21.0, 10.0, 110.0, 40.0, 10.0, 20.0, 110.0, 10.0, 38.0, 20.0, 50.0, 0.0, 30.0, 19.0, 39.0, 40.0, -38.0, 50.0, 30.0, 110.0, 47.0, -3.0, 110.0, 70.0, 10.0, 64.0, 30.0, 50.0, 69.0, -22.0, 30.0, 50.0, -35.0, 70.0, 60.0, 7.0, 100.0, 18.0, 50.0, 17.0, 19.0, 40.0, 50.0, 9.0, 50.0, 30.0, 43.0, 40.0, 30.0, 70.0, 40.0, 23.0, 90.0, 40.0, 110.0, 30.0, 10.0, 30.0, 25.0, 70.0, 50.0, 10.0, 90.0, 90.0, 20.0, 50.0, 30.0, 40.0, 140.0, 10.0, 70.0, 140.0, 10.0, 70.0, 40.0, 50.0, 90.0, 120.0, 50.0, 60.0, 80.0, 70.0, 100.0, 100.0, 40.0, 120.0, 80.0, 110.0, 50.0, 40.0, 100.0, 60.0, 150.0, 30.0, 70.0, 86.0, 70.0, 74.0, 18.0, 36.0, 80.0, 26.0, 50.0, 19.0, 60.0, 50.0, 90.0, 150.0, 100.0, 30.0, 90.0, 50.0, 50.0, 30.0, 89.0, 50.0, 50.0, 50.0, 38.0, 30.0, 110.0, 110.0, 60.0, 20.0, 38.0, 60.0, 10.0, 3.0, 110.0, 110.0, 22.0, 60.0, 56.0, 120.0, 130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0, 40.0, 90.0, 50.0, 40.0, 80.0, 70.0, 50.0, 130.0, 50.0, 110.0, 87.0, 30.0, 40.0, 50.0, 40.0, 140.0, 60.0, 40.0, 17.0, 120.0, 60.0, 20.0, 50.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 70.0, 50.0, 50.0, 60.0, 110.0, 20.0, 20.0, 80.0, 170.0, 70.0, 70.0, 0.0, 40.0, 70.0, 90.0, 50.0, 40.0, 29.0, 0.0, 70.0, 50.0, 100.0, 0.0, 110.0, 70.0, 55.0, 150.0, 90.0, -10.0, 70.0, 40.0, 45.0, 100.0, 70.0, 60.0, 60.0, 70.0, 130.0, 40.0, 70.0, 15.0, 90.0, 150.0, 130.0, 80.0, 35.0, 100.0, 60.0, 30.0, 85.0, 30.0, 40.0, 61.0, 80.0, 70.0, 23.0, 58.0, 36.0, 50.0, 100.0, 99.0, 20.0, 30.0, 50.0, 100.0, 80.0, 40.0, 60.0, 40.0, 60.0, 100.0, 10.0, 80.0, 40.0, 58.0, 2.0, 40.0, 70.0, 72.0, -5.0, 30.0, 90.0, 60.0, 21.0, 30.0, -1.0, 50.0, 50.0, 48.0, 40.0, 100.0, 79.0, 70.0, 10.0, 49.0, 78.0, 158.0, 60.0, 100.0, 126.0, 83.0, 80.0, 110.0, 80.0, 50.0, 0.0, 20.0, 70.0, 100.0, 80.0, 70.0, 80.0, 98.0, 100.0, 150.0, 39.0, 67.0, 90.0, -25.0, 50.0, 43.0, 30.0, 20.0, 60.0, 40.0, 28.0, 50.0, 110.0, 49.0, 90.0, 50.0, 100.0, 60.0, 30.0, 80.0, 112.0, 108.0, 140.0, 130.0, 70.0, 60.0, 90.0, 27.0, 90.0, 60.0, 29.0, 80.0, -1.0, 50.0, 19.0, 50.0, 80.0, 50.0, 70.0, 4.0, 114.0, 80.0, 80.0, 80.0, 70.0, 60.0, 60.0, 10.0, 40.0, 90.0, 90.0, 90.0, 30.0, 34.0, 50.0, 86.0, 50.0, 19.0, 33.0, 70.0, 29.0, 70.0, 75.0, 9.0, 100.0, 20.0, 100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0, 60.0, 110.0, 30.0, 80.0, 80.0, 100.0, 50.0, 140.0, 20.0, 110.0, 67.0, 10.0, 70.0, 110.0, 70.0, 66.0, 30.0, 90.0, 40.0, 60.0, 40.0, 70.0, 19.0, 100.0, 62.0, 40.0, 60.0, 76.0, 69.0, 50.0, 60.0, 100.0, 20.0, 120.0, 20.0, 30.0, 80.0, 50.0, 40.0, 40.0, 10.0, 8.0, 20.0, 80.0, -10.0, 60.0, 120.0, 40.0, 50.0, 100.0, 30.0, 50.0, 100.0, 39.0, 30.0, 30.0, 140.0, 90.0, 50.0, 90.0, -2.0, 30.0, 10.0, 30.0, 100.0, 50.0, 60.0, 20.0, 40.0, 48.0, 30.0, 71.0, 60.0, 30.0, 20.0, 60.0, 90.0, 79.0, 8.0, 40.0, 210.0, 51.0, 90.0, 32.0, 70.0, 80.0, 60.0, 30.0, 50.0, 30.0, 80.0, 60.0, 50.0, -5.0, 60.0, 60.0, 40.0, 80.0, 110.0, 21.0, 70.0, 70.0, 7.0, 40.0, 50.0, 144.0, 90.0, 76.0, 20.0, -10.0, 27.0, 69.0, 20.0, 50.0, 10.0, 20.0, 60.0, 60.0, 20.0, 30.0, 9.0, 30.0, -57.0, 30.0, 40.0, 10.0, 10.0, 49.0, 20.0, -63.0, 60.0, 20.0, 49.0, 90.0, 50.0, 90.0, 121.0, 10.0, 90.0, 60.0, 60.0, 80.0, 30.0, 70.0, 21.0, 80.0, 121.0, 30.0, 90.0, 57.0, -10.0, 90.0, 50.0, 70.0, 40.0, 79.0, 70.0, 10.0, 40.0, 60.0, 50.0, 140.0, 50.0, 56.0, 50.0, 37.0, 50.0, 60.0, 60.0, -15.0, 50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5450181233822549, "mean_inference_ms": 1.5537733794551152, "mean_action_processing_ms": 0.49074540690261914, "mean_env_wait_ms": 1.357007454394971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01239776611328125, "StateBufferConnector_ms": 0.00892186164855957, "ViewRequirementAgentConnector_ms": 0.3595123291015625}, "num_episodes": 18, "episode_return_max": 890.0, "episode_return_min": 78.0, "episode_return_mean": 557.94}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.430825752194895, "num_env_steps_trained_throughput_per_sec": 21.430825752194895, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 184438.879, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184438.83, "sample_time_ms": 2406.196, "learn_time_ms": 182013.934, "learn_throughput": 21.976, "synch_weights_time_ms": 11.154}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "a22d3_00000", "date": "2024-08-06_04-33-17", "timestamp": 1722933197, "time_this_iter_s": 186.6554639339447, "time_total_s": 20988.513917446136, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17d8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20988.513917446136, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 20.977651515151518, "ram_util_percent": 77.60643939393938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.834769033458921, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.226791357968689, "policy_loss": -0.010517075297564538, "vf_loss": 6.234661262865646, "vf_explained_var": 0.0028429148042290863, "kl": 0.005882595354219832, "entropy": 0.5925392596929853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": -14.0, "episode_reward_mean": 556.82, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -176.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 55.682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [710.0, 469.0, 427.0, 720.0, 389.0, 577.0, 117.0, 702.0, 90.0, 629.0, 380.0, 506.0, 409.0, 740.0, 585.0, 473.0, 570.0, 610.0, 520.0, 674.0, 596.0, 500.0, 542.0, 558.0, 767.0, 500.0, 738.0, 465.0, 307.0, 455.0, 316.0, 370.0, 456.0, 515.0, 580.0, 760.0, 780.0, 529.0, 700.0, 607.0, 589.0, 687.0, 710.0, 624.0, 530.0, 700.0, 439.0, 675.0, 660.0, 790.0, 617.0, 580.0, 397.0, 488.0, 813.0, 660.0, 692.0, 527.0, 890.0, 494.0, 688.0, 580.0, 475.0, 727.0, 780.0, 613.0, 586.0, 560.0, 478.0, 649.0, 386.0, 488.0, 703.0, 556.0, 557.0, 366.0, 78.0, 640.0, 639.0, 499.0, 538.0, 458.0, 590.0, 466.0, 482.0, -14.0, 385.0, 527.0, 530.0, 286.0, 421.0, 545.0, 759.0, 521.0, 493.0, 829.0, 775.0, 790.0, 693.0, 660.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 110.0, 60.0, 50.0, 90.0, 50.0, 90.0, 100.0, 50.0, 80.0, -3.0, 70.0, 90.0, 40.0, 70.0, 17.0, 60.0, 50.0, 25.0, 50.0, -31.0, 60.0, 28.0, 50.0, 50.0, 50.0, 60.0, 50.0, 60.0, 50.0, 30.0, 60.0, 40.0, 50.0, 40.0, 170.0, 80.0, 90.0, 120.0, 40.0, 8.0, 40.0, 3.0, 90.0, 40.0, 110.0, 50.0, 30.0, -2.0, 20.0, 70.0, 30.0, 60.0, 100.0, 7.0, 30.0, 110.0, 30.0, 90.0, 50.0, 10.0, 35.0, 50.0, 51.0, 26.0, -62.0, -72.0, 52.0, 10.0, 17.0, 110.0, 90.0, 80.0, 50.0, 110.0, 70.0, 40.0, 20.0, 130.0, 2.0, -105.0, -73.0, 27.0, 28.0, 60.0, 50.0, 30.0, 14.0, 29.0, 30.0, 20.0, 50.0, 150.0, 100.0, 40.0, 20.0, 20.0, 39.0, 40.0, 150.0, 10.0, 20.0, 10.0, 10.0, 40.0, 40.0, 80.0, 120.0, 20.0, 30.0, 107.0, 17.0, 50.0, 16.0, 40.0, 20.0, 50.0, 70.0, 80.0, 56.0, 40.0, 23.0, 54.0, 20.0, 50.0, 80.0, 30.0, 60.0, -8.0, 60.0, 90.0, 100.0, 100.0, 30.0, 90.0, 100.0, 90.0, 40.0, 80.0, 20.0, 33.0, 25.0, 40.0, 17.0, 90.0, 20.0, 110.0, 60.0, 90.0, 100.0, 40.0, 27.0, 70.0, 0.0, 80.0, 100.0, 20.0, 16.0, 50.0, 70.0, 40.0, 40.0, 90.0, 30.0, 10.0, 70.0, 100.0, 50.0, 70.0, 70.0, 70.0, 50.0, 80.0, 100.0, 20.0, 20.0, 90.0, 60.0, 100.0, 20.0, 10.0, 30.0, 90.0, 40.0, 0.0, 70.0, 40.0, 70.0, 100.0, 70.0, 90.0, 70.0, 120.0, 70.0, 40.0, 60.0, 38.0, 100.0, 26.0, 60.0, 50.0, 0.0, 50.0, 80.0, 140.0, 30.0, 110.0, 55.0, 1.0, 80.0, 50.0, 90.0, 60.0, 30.0, 30.0, 70.0, 50.0, 10.0, 60.0, 50.0, 66.0, 40.0, 130.0, 44.0, 15.0, 50.0, 60.0, 80.0, 7.0, 50.0, 90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0, 63.0, 74.0, 70.0, 30.0, 100.0, 60.0, 70.0, 100.0, 110.0, 90.0, 40.0, 120.0, 30.0, 50.0, 50.0, 30.0, 50.0, 20.0, 30.0, 80.0, 60.0, 100.0, 30.0, 60.0, 90.0, 80.0, 100.0, 68.0, 95.0, 55.0, 80.0, 40.0, 20.0, 64.0, 10.0, 70.0, 21.0, 10.0, 110.0, 40.0, 10.0, 20.0, 110.0, 10.0, 38.0, 20.0, 50.0, 0.0, 30.0, 19.0, 39.0, 40.0, -38.0, 50.0, 30.0, 110.0, 47.0, -3.0, 110.0, 70.0, 10.0, 64.0, 30.0, 50.0, 69.0, -22.0, 30.0, 50.0, -35.0, 70.0, 60.0, 7.0, 100.0, 18.0, 50.0, 17.0, 19.0, 40.0, 50.0, 9.0, 50.0, 30.0, 43.0, 40.0, 30.0, 70.0, 40.0, 23.0, 90.0, 40.0, 110.0, 30.0, 10.0, 30.0, 25.0, 70.0, 50.0, 10.0, 90.0, 90.0, 20.0, 50.0, 30.0, 40.0, 140.0, 10.0, 70.0, 140.0, 10.0, 70.0, 40.0, 50.0, 90.0, 120.0, 50.0, 60.0, 80.0, 70.0, 100.0, 100.0, 40.0, 120.0, 80.0, 110.0, 50.0, 40.0, 100.0, 60.0, 150.0, 30.0, 70.0, 86.0, 70.0, 74.0, 18.0, 36.0, 80.0, 26.0, 50.0, 19.0, 60.0, 50.0, 90.0, 150.0, 100.0, 30.0, 90.0, 50.0, 50.0, 30.0, 89.0, 50.0, 50.0, 50.0, 38.0, 30.0, 110.0, 110.0, 60.0, 20.0, 38.0, 60.0, 10.0, 3.0, 110.0, 110.0, 22.0, 60.0, 56.0, 120.0, 130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0, 40.0, 90.0, 50.0, 40.0, 80.0, 70.0, 50.0, 130.0, 50.0, 110.0, 87.0, 30.0, 40.0, 50.0, 40.0, 140.0, 60.0, 40.0, 17.0, 120.0, 60.0, 20.0, 50.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 70.0, 50.0, 50.0, 60.0, 110.0, 20.0, 20.0, 80.0, 170.0, 70.0, 70.0, 0.0, 40.0, 70.0, 90.0, 50.0, 40.0, 29.0, 0.0, 70.0, 50.0, 100.0, 0.0, 110.0, 70.0, 55.0, 150.0, 90.0, -10.0, 70.0, 40.0, 45.0, 100.0, 70.0, 60.0, 60.0, 70.0, 130.0, 40.0, 70.0, 15.0, 90.0, 150.0, 130.0, 80.0, 35.0, 100.0, 60.0, 30.0, 85.0, 30.0, 40.0, 61.0, 80.0, 70.0, 23.0, 58.0, 36.0, 50.0, 100.0, 99.0, 20.0, 30.0, 50.0, 100.0, 80.0, 40.0, 60.0, 40.0, 60.0, 100.0, 10.0, 80.0, 40.0, 58.0, 2.0, 40.0, 70.0, 72.0, -5.0, 30.0, 90.0, 60.0, 21.0, 30.0, -1.0, 50.0, 50.0, 48.0, 40.0, 100.0, 79.0, 70.0, 10.0, 49.0, 78.0, 158.0, 60.0, 100.0, 126.0, 83.0, 80.0, 110.0, 80.0, 50.0, 0.0, 20.0, 70.0, 100.0, 80.0, 70.0, 80.0, 98.0, 100.0, 150.0, 39.0, 67.0, 90.0, -25.0, 50.0, 43.0, 30.0, 20.0, 60.0, 40.0, 28.0, 50.0, 110.0, 49.0, 90.0, 50.0, 100.0, 60.0, 30.0, 80.0, 112.0, 108.0, 140.0, 130.0, 70.0, 60.0, 90.0, 27.0, 90.0, 60.0, 29.0, 80.0, -1.0, 50.0, 19.0, 50.0, 80.0, 50.0, 70.0, 4.0, 114.0, 80.0, 80.0, 80.0, 70.0, 60.0, 60.0, 10.0, 40.0, 90.0, 90.0, 90.0, 30.0, 34.0, 50.0, 86.0, 50.0, 19.0, 33.0, 70.0, 29.0, 70.0, 75.0, 9.0, 100.0, 20.0, 100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0, 60.0, 110.0, 30.0, 80.0, 80.0, 100.0, 50.0, 140.0, 20.0, 110.0, 67.0, 10.0, 70.0, 110.0, 70.0, 66.0, 30.0, 90.0, 40.0, 60.0, 40.0, 70.0, 19.0, 100.0, 62.0, 40.0, 60.0, 76.0, 69.0, 50.0, 60.0, 100.0, 20.0, 120.0, 20.0, 30.0, 80.0, 50.0, 40.0, 40.0, 10.0, 8.0, 20.0, 80.0, -10.0, 60.0, 120.0, 40.0, 50.0, 100.0, 30.0, 50.0, 100.0, 39.0, 30.0, 30.0, 140.0, 90.0, 50.0, 90.0, -2.0, 30.0, 10.0, 30.0, 100.0, 50.0, 60.0, 20.0, 40.0, 48.0, 30.0, 71.0, 60.0, 30.0, 20.0, 60.0, 90.0, 79.0, 8.0, 40.0, 210.0, 51.0, 90.0, 32.0, 70.0, 80.0, 60.0, 30.0, 50.0, 30.0, 80.0, 60.0, 50.0, -5.0, 60.0, 60.0, 40.0, 80.0, 110.0, 21.0, 70.0, 70.0, 7.0, 40.0, 50.0, 144.0, 90.0, 76.0, 20.0, -10.0, 27.0, 69.0, 20.0, 50.0, 10.0, 20.0, 60.0, 60.0, 20.0, 30.0, 9.0, 30.0, -57.0, 30.0, 40.0, 10.0, 10.0, 49.0, 20.0, -63.0, 60.0, 20.0, 49.0, 90.0, 50.0, 90.0, 121.0, 10.0, 90.0, 60.0, 60.0, 80.0, 30.0, 70.0, 21.0, 80.0, 121.0, 30.0, 90.0, 57.0, -10.0, 90.0, 50.0, 70.0, 40.0, 79.0, 70.0, 10.0, 40.0, 60.0, 50.0, 140.0, 50.0, 56.0, 50.0, 37.0, 50.0, 60.0, 60.0, -15.0, 50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0, 40.0, 30.0, 80.0, 109.0, 10.0, 36.0, 80.0, 100.0, 45.0, 60.0, 30.0, 40.0, 50.0, 9.0, 7.0, 40.0, 70.0, 90.0, 50.0, 80.0, 120.0, 30.0, -14.0, 10.0, 50.0, 110.0, -24.0, 10.0, 50.0, 140.0, 25.0, 30.0, 8.0, -176.0, 20.0, 40.0, 90.0, 40.0, -131.0, 40.0, 40.0, 70.0, 100.0, 20.0, -13.0, 25.0, 35.0, 28.0, 50.0, 30.0, 20.0, 80.0, 20.0, 60.0, 20.0, 90.0, 70.0, 100.0, -2.0, 69.0, 70.0, 24.0, 40.0, 28.0, 40.0, 50.0, 120.0, 50.0, 70.0, 38.0, 30.0, 39.0, 30.0, -10.0, 0.0, 20.0, -13.0, 0.0, 130.0, 60.0, 43.0, 60.0, 30.0, 0.0, 70.0, 23.0, 50.0, 15.0, 80.0, 50.0, 30.0, 120.0, 20.0, 47.0, 70.0, 80.0, 50.0, 30.0, 20.0, 78.0, 70.0, 80.0, 90.0, 29.0, 90.0, 80.0, 50.0, 110.0, 30.0, 130.0, 60.0, 86.0, 60.0, 90.0, 3.0, 110.0, -1.0, 60.0, 50.0, 3.0, 70.0, 16.0, 80.0, 17.0, 70.0, 40.0, 50.0, 60.0, 50.0, 40.0, 100.0, 31.0, 50.0, 100.0, 98.0, 100.0, 70.0, 70.0, 90.0, 120.0, 40.0, 120.0, 90.0, 56.0, 60.0, 89.0, 100.0, 110.0, 10.0, 100.0, 130.0, 50.0, 50.0, 80.0, 60.0, 210.0, 50.0, 40.0, 80.0, 40.0, 67.0, 40.0, 90.0, -35.0, 120.0, 65.0, 140.0, 55.0, 31.0, 120.0, 130.0, 50.0, 90.0, 100.0, 60.0, 20.0, 70.0, 30.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543992393486959, "mean_inference_ms": 1.5522900957868484, "mean_action_processing_ms": 0.49024899758927076, "mean_env_wait_ms": 1.3558876547521124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012347221374511719, "StateBufferConnector_ms": 0.008914947509765625, "ViewRequirementAgentConnector_ms": 0.3649301528930664}, "num_episodes": 18, "episode_return_max": 890.0, "episode_return_min": -14.0, "episode_return_mean": 556.82}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.629917883100422, "num_env_steps_trained_throughput_per_sec": 21.629917883100422, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 184502.489, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184502.441, "sample_time_ms": 2426.623, "learn_time_ms": 182057.13, "learn_throughput": 21.971, "synch_weights_time_ms": 11.078}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "a22d3_00000", "date": "2024-08-06_04-36-22", "timestamp": 1722933382, "time_this_iter_s": 184.93763279914856, "time_total_s": 21173.451550245285, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16d1d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21173.451550245285, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 18.476335877862592, "ram_util_percent": 77.56297709923665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.920507627516128, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011678411597306657, "vf_loss": 6.3567791234444, "vf_explained_var": 0.0033403822789176965, "kl": Infinity, "entropy": 0.5582704479638507, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": -14.0, "episode_reward_mean": 558.19, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -176.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 55.819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [558.0, 767.0, 500.0, 738.0, 465.0, 307.0, 455.0, 316.0, 370.0, 456.0, 515.0, 580.0, 760.0, 780.0, 529.0, 700.0, 607.0, 589.0, 687.0, 710.0, 624.0, 530.0, 700.0, 439.0, 675.0, 660.0, 790.0, 617.0, 580.0, 397.0, 488.0, 813.0, 660.0, 692.0, 527.0, 890.0, 494.0, 688.0, 580.0, 475.0, 727.0, 780.0, 613.0, 586.0, 560.0, 478.0, 649.0, 386.0, 488.0, 703.0, 556.0, 557.0, 366.0, 78.0, 640.0, 639.0, 499.0, 538.0, 458.0, 590.0, 466.0, 482.0, -14.0, 385.0, 527.0, 530.0, 286.0, 421.0, 545.0, 759.0, 521.0, 493.0, 829.0, 775.0, 790.0, 693.0, 660.0, 477.0, 780.0, 409.0, 351.0, 545.0, 613.0, 483.0, 600.0, 585.0, 342.0, 294.0, 620.0, 620.0, 350.0, 340.0, 717.0, 679.0, 561.0, 858.0, 603.0, 479.0, 356.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 50.0, 58.0, 30.0, 110.0, 80.0, 30.0, 70.0, 10.0, 30.0, 63.0, 74.0, 70.0, 30.0, 100.0, 60.0, 70.0, 100.0, 110.0, 90.0, 40.0, 120.0, 30.0, 50.0, 50.0, 30.0, 50.0, 20.0, 30.0, 80.0, 60.0, 100.0, 30.0, 60.0, 90.0, 80.0, 100.0, 68.0, 95.0, 55.0, 80.0, 40.0, 20.0, 64.0, 10.0, 70.0, 21.0, 10.0, 110.0, 40.0, 10.0, 20.0, 110.0, 10.0, 38.0, 20.0, 50.0, 0.0, 30.0, 19.0, 39.0, 40.0, -38.0, 50.0, 30.0, 110.0, 47.0, -3.0, 110.0, 70.0, 10.0, 64.0, 30.0, 50.0, 69.0, -22.0, 30.0, 50.0, -35.0, 70.0, 60.0, 7.0, 100.0, 18.0, 50.0, 17.0, 19.0, 40.0, 50.0, 9.0, 50.0, 30.0, 43.0, 40.0, 30.0, 70.0, 40.0, 23.0, 90.0, 40.0, 110.0, 30.0, 10.0, 30.0, 25.0, 70.0, 50.0, 10.0, 90.0, 90.0, 20.0, 50.0, 30.0, 40.0, 140.0, 10.0, 70.0, 140.0, 10.0, 70.0, 40.0, 50.0, 90.0, 120.0, 50.0, 60.0, 80.0, 70.0, 100.0, 100.0, 40.0, 120.0, 80.0, 110.0, 50.0, 40.0, 100.0, 60.0, 150.0, 30.0, 70.0, 86.0, 70.0, 74.0, 18.0, 36.0, 80.0, 26.0, 50.0, 19.0, 60.0, 50.0, 90.0, 150.0, 100.0, 30.0, 90.0, 50.0, 50.0, 30.0, 89.0, 50.0, 50.0, 50.0, 38.0, 30.0, 110.0, 110.0, 60.0, 20.0, 38.0, 60.0, 10.0, 3.0, 110.0, 110.0, 22.0, 60.0, 56.0, 120.0, 130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0, 40.0, 90.0, 50.0, 40.0, 80.0, 70.0, 50.0, 130.0, 50.0, 110.0, 87.0, 30.0, 40.0, 50.0, 40.0, 140.0, 60.0, 40.0, 17.0, 120.0, 60.0, 20.0, 50.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 70.0, 50.0, 50.0, 60.0, 110.0, 20.0, 20.0, 80.0, 170.0, 70.0, 70.0, 0.0, 40.0, 70.0, 90.0, 50.0, 40.0, 29.0, 0.0, 70.0, 50.0, 100.0, 0.0, 110.0, 70.0, 55.0, 150.0, 90.0, -10.0, 70.0, 40.0, 45.0, 100.0, 70.0, 60.0, 60.0, 70.0, 130.0, 40.0, 70.0, 15.0, 90.0, 150.0, 130.0, 80.0, 35.0, 100.0, 60.0, 30.0, 85.0, 30.0, 40.0, 61.0, 80.0, 70.0, 23.0, 58.0, 36.0, 50.0, 100.0, 99.0, 20.0, 30.0, 50.0, 100.0, 80.0, 40.0, 60.0, 40.0, 60.0, 100.0, 10.0, 80.0, 40.0, 58.0, 2.0, 40.0, 70.0, 72.0, -5.0, 30.0, 90.0, 60.0, 21.0, 30.0, -1.0, 50.0, 50.0, 48.0, 40.0, 100.0, 79.0, 70.0, 10.0, 49.0, 78.0, 158.0, 60.0, 100.0, 126.0, 83.0, 80.0, 110.0, 80.0, 50.0, 0.0, 20.0, 70.0, 100.0, 80.0, 70.0, 80.0, 98.0, 100.0, 150.0, 39.0, 67.0, 90.0, -25.0, 50.0, 43.0, 30.0, 20.0, 60.0, 40.0, 28.0, 50.0, 110.0, 49.0, 90.0, 50.0, 100.0, 60.0, 30.0, 80.0, 112.0, 108.0, 140.0, 130.0, 70.0, 60.0, 90.0, 27.0, 90.0, 60.0, 29.0, 80.0, -1.0, 50.0, 19.0, 50.0, 80.0, 50.0, 70.0, 4.0, 114.0, 80.0, 80.0, 80.0, 70.0, 60.0, 60.0, 10.0, 40.0, 90.0, 90.0, 90.0, 30.0, 34.0, 50.0, 86.0, 50.0, 19.0, 33.0, 70.0, 29.0, 70.0, 75.0, 9.0, 100.0, 20.0, 100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0, 60.0, 110.0, 30.0, 80.0, 80.0, 100.0, 50.0, 140.0, 20.0, 110.0, 67.0, 10.0, 70.0, 110.0, 70.0, 66.0, 30.0, 90.0, 40.0, 60.0, 40.0, 70.0, 19.0, 100.0, 62.0, 40.0, 60.0, 76.0, 69.0, 50.0, 60.0, 100.0, 20.0, 120.0, 20.0, 30.0, 80.0, 50.0, 40.0, 40.0, 10.0, 8.0, 20.0, 80.0, -10.0, 60.0, 120.0, 40.0, 50.0, 100.0, 30.0, 50.0, 100.0, 39.0, 30.0, 30.0, 140.0, 90.0, 50.0, 90.0, -2.0, 30.0, 10.0, 30.0, 100.0, 50.0, 60.0, 20.0, 40.0, 48.0, 30.0, 71.0, 60.0, 30.0, 20.0, 60.0, 90.0, 79.0, 8.0, 40.0, 210.0, 51.0, 90.0, 32.0, 70.0, 80.0, 60.0, 30.0, 50.0, 30.0, 80.0, 60.0, 50.0, -5.0, 60.0, 60.0, 40.0, 80.0, 110.0, 21.0, 70.0, 70.0, 7.0, 40.0, 50.0, 144.0, 90.0, 76.0, 20.0, -10.0, 27.0, 69.0, 20.0, 50.0, 10.0, 20.0, 60.0, 60.0, 20.0, 30.0, 9.0, 30.0, -57.0, 30.0, 40.0, 10.0, 10.0, 49.0, 20.0, -63.0, 60.0, 20.0, 49.0, 90.0, 50.0, 90.0, 121.0, 10.0, 90.0, 60.0, 60.0, 80.0, 30.0, 70.0, 21.0, 80.0, 121.0, 30.0, 90.0, 57.0, -10.0, 90.0, 50.0, 70.0, 40.0, 79.0, 70.0, 10.0, 40.0, 60.0, 50.0, 140.0, 50.0, 56.0, 50.0, 37.0, 50.0, 60.0, 60.0, -15.0, 50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0, 40.0, 30.0, 80.0, 109.0, 10.0, 36.0, 80.0, 100.0, 45.0, 60.0, 30.0, 40.0, 50.0, 9.0, 7.0, 40.0, 70.0, 90.0, 50.0, 80.0, 120.0, 30.0, -14.0, 10.0, 50.0, 110.0, -24.0, 10.0, 50.0, 140.0, 25.0, 30.0, 8.0, -176.0, 20.0, 40.0, 90.0, 40.0, -131.0, 40.0, 40.0, 70.0, 100.0, 20.0, -13.0, 25.0, 35.0, 28.0, 50.0, 30.0, 20.0, 80.0, 20.0, 60.0, 20.0, 90.0, 70.0, 100.0, -2.0, 69.0, 70.0, 24.0, 40.0, 28.0, 40.0, 50.0, 120.0, 50.0, 70.0, 38.0, 30.0, 39.0, 30.0, -10.0, 0.0, 20.0, -13.0, 0.0, 130.0, 60.0, 43.0, 60.0, 30.0, 0.0, 70.0, 23.0, 50.0, 15.0, 80.0, 50.0, 30.0, 120.0, 20.0, 47.0, 70.0, 80.0, 50.0, 30.0, 20.0, 78.0, 70.0, 80.0, 90.0, 29.0, 90.0, 80.0, 50.0, 110.0, 30.0, 130.0, 60.0, 86.0, 60.0, 90.0, 3.0, 110.0, -1.0, 60.0, 50.0, 3.0, 70.0, 16.0, 80.0, 17.0, 70.0, 40.0, 50.0, 60.0, 50.0, 40.0, 100.0, 31.0, 50.0, 100.0, 98.0, 100.0, 70.0, 70.0, 90.0, 120.0, 40.0, 120.0, 90.0, 56.0, 60.0, 89.0, 100.0, 110.0, 10.0, 100.0, 130.0, 50.0, 50.0, 80.0, 60.0, 210.0, 50.0, 40.0, 80.0, 40.0, 67.0, 40.0, 90.0, -35.0, 120.0, 65.0, 140.0, 55.0, 31.0, 120.0, 130.0, 50.0, 90.0, 100.0, 60.0, 20.0, 70.0, 30.0, 60.0, 50.0, 50.0, 100.0, 60.0, 130.0, 100.0, -50.0, 15.0, 60.0, -8.0, 20.0, 80.0, 110.0, 20.0, 40.0, 50.0, 160.0, 140.0, 20.0, 80.0, 80.0, 60.0, 8.0, 60.0, 80.0, 69.0, 80.0, 39.0, 0.0, -14.0, 27.0, 24.0, -30.0, 54.0, 49.0, 40.0, 30.0, 120.0, 34.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, 50.0, 0.0, 130.0, 90.0, 20.0, 65.0, 70.0, 46.0, 120.0, 59.0, 50.0, 19.0, 70.0, 60.0, 19.0, 100.0, 101.0, 10.0, 18.0, 17.0, 50.0, 42.0, 30.0, 26.0, 110.0, 79.0, 100.0, 10.0, 20.0, 90.0, 90.0, 70.0, 60.0, 50.0, 60.0, 50.0, 30.0, 37.0, 100.0, 90.0, 60.0, 70.0, 60.0, 60.0, 30.0, 48.0, 50.0, 0.0, 30.0, 90.0, -41.0, 20.0, 70.0, 50.0, 53.0, 20.0, 80.0, 50.0, 10.0, 30.0, -14.0, 37.0, 29.0, 2.0, 10.0, 60.0, 30.0, 50.0, 100.0, 50.0, 60.0, 60.0, 70.0, 60.0, 30.0, 110.0, 40.0, 90.0, 100.0, 70.0, 10.0, 80.0, 20.0, 80.0, 110.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 100.0, 80.0, 9.0, 27.0, 20.0, 60.0, -15.0, 40.0, 39.0, 40.0, 40.0, 75.0, 10.0, 79.0, 58.0, 90.0, 130.0, 70.0, 35.0, 90.0, 80.0, 50.0, 60.0, 20.0, 60.0, 70.0, 89.0, 80.0, 100.0, 100.0, 50.0, 40.0, 70.0, 100.0, 110.0, 80.0, 50.0, 30.0, 55.0, 18.0, 8.0, 60.0, 140.0, 70.0, 90.0, 70.0, 70.0, 140.0, 70.0, 90.0, 58.0, 80.0, 70.0, 49.0, 30.0, 28.0, 90.0, 80.0, 40.0, 86.0, 50.0, 30.0, 60.0, 30.0, 40.0, 60.0, 50.0, 60.0, 40.0, 29.0, 80.0, 89.0, 48.0, 49.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 40.0, 100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5429003146018239, "mean_inference_ms": 1.5505188494234314, "mean_action_processing_ms": 0.4896441634300501, "mean_env_wait_ms": 1.3546106988381386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012956857681274414, "StateBufferConnector_ms": 0.009159326553344727, "ViewRequirementAgentConnector_ms": 0.372450590133667}, "num_episodes": 23, "episode_return_max": 890.0, "episode_return_min": -14.0, "episode_return_mean": 558.19}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.594518762073754, "num_env_steps_trained_throughput_per_sec": 21.594518762073754, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 184595.062, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184595.014, "sample_time_ms": 2459.181, "learn_time_ms": 182116.959, "learn_throughput": 21.964, "synch_weights_time_ms": 11.411}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "a22d3_00000", "date": "2024-08-06_04-39-27", "timestamp": 1722933567, "time_this_iter_s": 185.23875093460083, "time_total_s": 21358.690301179886, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21358.690301179886, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 17.673664122137403, "ram_util_percent": 78.20381679389314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.803478243505866, "cur_kl_coeff": 0.675, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010691485752245457, "vf_loss": 6.596339404824189, "vf_explained_var": 0.006160783412230536, "kl": Infinity, "entropy": 0.5505934366402916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 998.0, "episode_reward_min": -14.0, "episode_reward_mean": 581.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -176.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 58.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [687.0, 710.0, 624.0, 530.0, 700.0, 439.0, 675.0, 660.0, 790.0, 617.0, 580.0, 397.0, 488.0, 813.0, 660.0, 692.0, 527.0, 890.0, 494.0, 688.0, 580.0, 475.0, 727.0, 780.0, 613.0, 586.0, 560.0, 478.0, 649.0, 386.0, 488.0, 703.0, 556.0, 557.0, 366.0, 78.0, 640.0, 639.0, 499.0, 538.0, 458.0, 590.0, 466.0, 482.0, -14.0, 385.0, 527.0, 530.0, 286.0, 421.0, 545.0, 759.0, 521.0, 493.0, 829.0, 775.0, 790.0, 693.0, 660.0, 477.0, 780.0, 409.0, 351.0, 545.0, 613.0, 483.0, 600.0, 585.0, 342.0, 294.0, 620.0, 620.0, 350.0, 340.0, 717.0, 679.0, 561.0, 858.0, 603.0, 479.0, 356.0, 410.0, 715.0, 750.0, 842.0, 720.0, 815.0, 820.0, 699.0, 998.0, 525.0, 696.0, 549.0, 454.0, 564.0, 465.0, 670.0, 625.0, 636.0, 735.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [130.0, 50.0, 33.0, 84.0, 40.0, 130.0, 30.0, 30.0, 70.0, 90.0, 40.0, 90.0, 50.0, 40.0, 80.0, 70.0, 50.0, 130.0, 50.0, 110.0, 87.0, 30.0, 40.0, 50.0, 40.0, 140.0, 60.0, 40.0, 17.0, 120.0, 60.0, 20.0, 50.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 70.0, 50.0, 50.0, 60.0, 110.0, 20.0, 20.0, 80.0, 170.0, 70.0, 70.0, 0.0, 40.0, 70.0, 90.0, 50.0, 40.0, 29.0, 0.0, 70.0, 50.0, 100.0, 0.0, 110.0, 70.0, 55.0, 150.0, 90.0, -10.0, 70.0, 40.0, 45.0, 100.0, 70.0, 60.0, 60.0, 70.0, 130.0, 40.0, 70.0, 15.0, 90.0, 150.0, 130.0, 80.0, 35.0, 100.0, 60.0, 30.0, 85.0, 30.0, 40.0, 61.0, 80.0, 70.0, 23.0, 58.0, 36.0, 50.0, 100.0, 99.0, 20.0, 30.0, 50.0, 100.0, 80.0, 40.0, 60.0, 40.0, 60.0, 100.0, 10.0, 80.0, 40.0, 58.0, 2.0, 40.0, 70.0, 72.0, -5.0, 30.0, 90.0, 60.0, 21.0, 30.0, -1.0, 50.0, 50.0, 48.0, 40.0, 100.0, 79.0, 70.0, 10.0, 49.0, 78.0, 158.0, 60.0, 100.0, 126.0, 83.0, 80.0, 110.0, 80.0, 50.0, 0.0, 20.0, 70.0, 100.0, 80.0, 70.0, 80.0, 98.0, 100.0, 150.0, 39.0, 67.0, 90.0, -25.0, 50.0, 43.0, 30.0, 20.0, 60.0, 40.0, 28.0, 50.0, 110.0, 49.0, 90.0, 50.0, 100.0, 60.0, 30.0, 80.0, 112.0, 108.0, 140.0, 130.0, 70.0, 60.0, 90.0, 27.0, 90.0, 60.0, 29.0, 80.0, -1.0, 50.0, 19.0, 50.0, 80.0, 50.0, 70.0, 4.0, 114.0, 80.0, 80.0, 80.0, 70.0, 60.0, 60.0, 10.0, 40.0, 90.0, 90.0, 90.0, 30.0, 34.0, 50.0, 86.0, 50.0, 19.0, 33.0, 70.0, 29.0, 70.0, 75.0, 9.0, 100.0, 20.0, 100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0, 60.0, 110.0, 30.0, 80.0, 80.0, 100.0, 50.0, 140.0, 20.0, 110.0, 67.0, 10.0, 70.0, 110.0, 70.0, 66.0, 30.0, 90.0, 40.0, 60.0, 40.0, 70.0, 19.0, 100.0, 62.0, 40.0, 60.0, 76.0, 69.0, 50.0, 60.0, 100.0, 20.0, 120.0, 20.0, 30.0, 80.0, 50.0, 40.0, 40.0, 10.0, 8.0, 20.0, 80.0, -10.0, 60.0, 120.0, 40.0, 50.0, 100.0, 30.0, 50.0, 100.0, 39.0, 30.0, 30.0, 140.0, 90.0, 50.0, 90.0, -2.0, 30.0, 10.0, 30.0, 100.0, 50.0, 60.0, 20.0, 40.0, 48.0, 30.0, 71.0, 60.0, 30.0, 20.0, 60.0, 90.0, 79.0, 8.0, 40.0, 210.0, 51.0, 90.0, 32.0, 70.0, 80.0, 60.0, 30.0, 50.0, 30.0, 80.0, 60.0, 50.0, -5.0, 60.0, 60.0, 40.0, 80.0, 110.0, 21.0, 70.0, 70.0, 7.0, 40.0, 50.0, 144.0, 90.0, 76.0, 20.0, -10.0, 27.0, 69.0, 20.0, 50.0, 10.0, 20.0, 60.0, 60.0, 20.0, 30.0, 9.0, 30.0, -57.0, 30.0, 40.0, 10.0, 10.0, 49.0, 20.0, -63.0, 60.0, 20.0, 49.0, 90.0, 50.0, 90.0, 121.0, 10.0, 90.0, 60.0, 60.0, 80.0, 30.0, 70.0, 21.0, 80.0, 121.0, 30.0, 90.0, 57.0, -10.0, 90.0, 50.0, 70.0, 40.0, 79.0, 70.0, 10.0, 40.0, 60.0, 50.0, 140.0, 50.0, 56.0, 50.0, 37.0, 50.0, 60.0, 60.0, -15.0, 50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0, 40.0, 30.0, 80.0, 109.0, 10.0, 36.0, 80.0, 100.0, 45.0, 60.0, 30.0, 40.0, 50.0, 9.0, 7.0, 40.0, 70.0, 90.0, 50.0, 80.0, 120.0, 30.0, -14.0, 10.0, 50.0, 110.0, -24.0, 10.0, 50.0, 140.0, 25.0, 30.0, 8.0, -176.0, 20.0, 40.0, 90.0, 40.0, -131.0, 40.0, 40.0, 70.0, 100.0, 20.0, -13.0, 25.0, 35.0, 28.0, 50.0, 30.0, 20.0, 80.0, 20.0, 60.0, 20.0, 90.0, 70.0, 100.0, -2.0, 69.0, 70.0, 24.0, 40.0, 28.0, 40.0, 50.0, 120.0, 50.0, 70.0, 38.0, 30.0, 39.0, 30.0, -10.0, 0.0, 20.0, -13.0, 0.0, 130.0, 60.0, 43.0, 60.0, 30.0, 0.0, 70.0, 23.0, 50.0, 15.0, 80.0, 50.0, 30.0, 120.0, 20.0, 47.0, 70.0, 80.0, 50.0, 30.0, 20.0, 78.0, 70.0, 80.0, 90.0, 29.0, 90.0, 80.0, 50.0, 110.0, 30.0, 130.0, 60.0, 86.0, 60.0, 90.0, 3.0, 110.0, -1.0, 60.0, 50.0, 3.0, 70.0, 16.0, 80.0, 17.0, 70.0, 40.0, 50.0, 60.0, 50.0, 40.0, 100.0, 31.0, 50.0, 100.0, 98.0, 100.0, 70.0, 70.0, 90.0, 120.0, 40.0, 120.0, 90.0, 56.0, 60.0, 89.0, 100.0, 110.0, 10.0, 100.0, 130.0, 50.0, 50.0, 80.0, 60.0, 210.0, 50.0, 40.0, 80.0, 40.0, 67.0, 40.0, 90.0, -35.0, 120.0, 65.0, 140.0, 55.0, 31.0, 120.0, 130.0, 50.0, 90.0, 100.0, 60.0, 20.0, 70.0, 30.0, 60.0, 50.0, 50.0, 100.0, 60.0, 130.0, 100.0, -50.0, 15.0, 60.0, -8.0, 20.0, 80.0, 110.0, 20.0, 40.0, 50.0, 160.0, 140.0, 20.0, 80.0, 80.0, 60.0, 8.0, 60.0, 80.0, 69.0, 80.0, 39.0, 0.0, -14.0, 27.0, 24.0, -30.0, 54.0, 49.0, 40.0, 30.0, 120.0, 34.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, 50.0, 0.0, 130.0, 90.0, 20.0, 65.0, 70.0, 46.0, 120.0, 59.0, 50.0, 19.0, 70.0, 60.0, 19.0, 100.0, 101.0, 10.0, 18.0, 17.0, 50.0, 42.0, 30.0, 26.0, 110.0, 79.0, 100.0, 10.0, 20.0, 90.0, 90.0, 70.0, 60.0, 50.0, 60.0, 50.0, 30.0, 37.0, 100.0, 90.0, 60.0, 70.0, 60.0, 60.0, 30.0, 48.0, 50.0, 0.0, 30.0, 90.0, -41.0, 20.0, 70.0, 50.0, 53.0, 20.0, 80.0, 50.0, 10.0, 30.0, -14.0, 37.0, 29.0, 2.0, 10.0, 60.0, 30.0, 50.0, 100.0, 50.0, 60.0, 60.0, 70.0, 60.0, 30.0, 110.0, 40.0, 90.0, 100.0, 70.0, 10.0, 80.0, 20.0, 80.0, 110.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 100.0, 80.0, 9.0, 27.0, 20.0, 60.0, -15.0, 40.0, 39.0, 40.0, 40.0, 75.0, 10.0, 79.0, 58.0, 90.0, 130.0, 70.0, 35.0, 90.0, 80.0, 50.0, 60.0, 20.0, 60.0, 70.0, 89.0, 80.0, 100.0, 100.0, 50.0, 40.0, 70.0, 100.0, 110.0, 80.0, 50.0, 30.0, 55.0, 18.0, 8.0, 60.0, 140.0, 70.0, 90.0, 70.0, 70.0, 140.0, 70.0, 90.0, 58.0, 80.0, 70.0, 49.0, 30.0, 28.0, 90.0, 80.0, 40.0, 86.0, 50.0, 30.0, 60.0, 30.0, 40.0, 60.0, 50.0, 60.0, 40.0, 29.0, 80.0, 89.0, 48.0, 49.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 40.0, 100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0, 70.0, 100.0, 70.0, 80.0, 80.0, 60.0, 70.0, 75.0, 10.0, 100.0, 70.0, 40.0, 60.0, 100.0, 60.0, 90.0, 80.0, 60.0, 70.0, 120.0, 70.0, 80.0, 120.0, 130.0, 120.0, 30.0, 97.0, 58.0, 80.0, 57.0, 60.0, 60.0, 80.0, 50.0, 120.0, 50.0, 60.0, 90.0, 100.0, 50.0, 110.0, 49.0, 56.0, 40.0, 70.0, 40.0, 70.0, 110.0, 180.0, 90.0, 20.0, 80.0, 130.0, 60.0, 120.0, 50.0, 120.0, 60.0, 80.0, 100.0, 50.0, 60.0, 90.0, 50.0, 110.0, 70.0, 110.0, 30.0, 39.0, 90.0, 110.0, 80.0, 69.0, 190.0, 90.0, 70.0, 59.0, 110.0, 100.0, 120.0, 80.0, 40.0, 47.0, 70.0, 40.0, 48.0, 30.0, 80.0, 70.0, 20.0, 80.0, 100.0, 90.0, 2.0, 70.0, 120.0, 80.0, 90.0, 30.0, 34.0, 110.0, 20.0, 50.0, 34.0, 30.0, -15.0, 100.0, 30.0, 150.0, 40.0, 30.0, 100.0, 30.0, 100.0, 39.0, 29.0, 30.0, 16.0, 60.0, 20.0, -2.0, 40.0, -4.0, 60.0, 90.0, 110.0, 110.0, 100.0, 20.0, 40.0, 55.0, 20.0, 70.0, 40.0, 120.0, 30.0, 20.0, 20.0, 30.0, 60.0, 150.0, 60.0, 80.0, 10.0, 60.0, 50.0, 70.0, 40.0, 40.0, 110.0, 70.0, 180.0, 27.0, 60.0, 30.0, 60.0, 40.0, 28.0, 30.0, 100.0, 87.0, -75.0, 130.0, 80.0, 120.0, 36.0, 98.0, 10.0, 30.0, 120.0, 120.0, 80.0, 90.0, 50.0, 60.0, 61.0, 70.0, 80.0, 70.0, 54.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5422583651149029, "mean_inference_ms": 1.549653612183431, "mean_action_processing_ms": 0.4900147626979695, "mean_env_wait_ms": 1.3537305198824054, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01320791244506836, "StateBufferConnector_ms": 0.009328365325927734, "ViewRequirementAgentConnector_ms": 0.3742251396179199}, "num_episodes": 18, "episode_return_max": 998.0, "episode_return_min": -14.0, "episode_return_mean": 581.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.665053010965835, "num_env_steps_trained_throughput_per_sec": 21.665053010965835, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 184584.002, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184583.955, "sample_time_ms": 2470.287, "learn_time_ms": 182094.568, "learn_throughput": 21.967, "synch_weights_time_ms": 11.684}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "a22d3_00000", "date": "2024-08-06_04-42-32", "timestamp": 1722933752, "time_this_iter_s": 184.63868379592896, "time_total_s": 21543.328984975815, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17c1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21543.328984975815, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 17.236781609195404, "ram_util_percent": 78.38544061302682}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9766915195729657, "cur_kl_coeff": 1.0124999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.203160678388212, "policy_loss": -0.009416613676257955, "vf_loss": 6.209096199661271, "vf_explained_var": 0.005781145763600342, "kl": 0.0034381167565177163, "entropy": 0.5917590851283556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 998.0, "episode_reward_min": -14.0, "episode_reward_mean": 562.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -176.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 56.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [727.0, 780.0, 613.0, 586.0, 560.0, 478.0, 649.0, 386.0, 488.0, 703.0, 556.0, 557.0, 366.0, 78.0, 640.0, 639.0, 499.0, 538.0, 458.0, 590.0, 466.0, 482.0, -14.0, 385.0, 527.0, 530.0, 286.0, 421.0, 545.0, 759.0, 521.0, 493.0, 829.0, 775.0, 790.0, 693.0, 660.0, 477.0, 780.0, 409.0, 351.0, 545.0, 613.0, 483.0, 600.0, 585.0, 342.0, 294.0, 620.0, 620.0, 350.0, 340.0, 717.0, 679.0, 561.0, 858.0, 603.0, 479.0, 356.0, 410.0, 715.0, 750.0, 842.0, 720.0, 815.0, 820.0, 699.0, 998.0, 525.0, 696.0, 549.0, 454.0, 564.0, 465.0, 670.0, 625.0, 636.0, 735.0, 398.0, 444.0, 505.0, 461.0, 628.0, 569.0, 430.0, 750.0, 426.0, 286.0, 532.0, 675.0, 635.0, 394.0, 498.0, 327.0, 745.0, 577.0, 660.0, 728.0, 640.0, 583.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 40.0, 80.0, 59.0, 30.0, 110.0, 30.0, 120.0, 70.0, 88.0, 60.0, 110.0, 30.0, 80.0, 80.0, 100.0, 50.0, 140.0, 20.0, 110.0, 67.0, 10.0, 70.0, 110.0, 70.0, 66.0, 30.0, 90.0, 40.0, 60.0, 40.0, 70.0, 19.0, 100.0, 62.0, 40.0, 60.0, 76.0, 69.0, 50.0, 60.0, 100.0, 20.0, 120.0, 20.0, 30.0, 80.0, 50.0, 40.0, 40.0, 10.0, 8.0, 20.0, 80.0, -10.0, 60.0, 120.0, 40.0, 50.0, 100.0, 30.0, 50.0, 100.0, 39.0, 30.0, 30.0, 140.0, 90.0, 50.0, 90.0, -2.0, 30.0, 10.0, 30.0, 100.0, 50.0, 60.0, 20.0, 40.0, 48.0, 30.0, 71.0, 60.0, 30.0, 20.0, 60.0, 90.0, 79.0, 8.0, 40.0, 210.0, 51.0, 90.0, 32.0, 70.0, 80.0, 60.0, 30.0, 50.0, 30.0, 80.0, 60.0, 50.0, -5.0, 60.0, 60.0, 40.0, 80.0, 110.0, 21.0, 70.0, 70.0, 7.0, 40.0, 50.0, 144.0, 90.0, 76.0, 20.0, -10.0, 27.0, 69.0, 20.0, 50.0, 10.0, 20.0, 60.0, 60.0, 20.0, 30.0, 9.0, 30.0, -57.0, 30.0, 40.0, 10.0, 10.0, 49.0, 20.0, -63.0, 60.0, 20.0, 49.0, 90.0, 50.0, 90.0, 121.0, 10.0, 90.0, 60.0, 60.0, 80.0, 30.0, 70.0, 21.0, 80.0, 121.0, 30.0, 90.0, 57.0, -10.0, 90.0, 50.0, 70.0, 40.0, 79.0, 70.0, 10.0, 40.0, 60.0, 50.0, 140.0, 50.0, 56.0, 50.0, 37.0, 50.0, 60.0, 60.0, -15.0, 50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0, 40.0, 30.0, 80.0, 109.0, 10.0, 36.0, 80.0, 100.0, 45.0, 60.0, 30.0, 40.0, 50.0, 9.0, 7.0, 40.0, 70.0, 90.0, 50.0, 80.0, 120.0, 30.0, -14.0, 10.0, 50.0, 110.0, -24.0, 10.0, 50.0, 140.0, 25.0, 30.0, 8.0, -176.0, 20.0, 40.0, 90.0, 40.0, -131.0, 40.0, 40.0, 70.0, 100.0, 20.0, -13.0, 25.0, 35.0, 28.0, 50.0, 30.0, 20.0, 80.0, 20.0, 60.0, 20.0, 90.0, 70.0, 100.0, -2.0, 69.0, 70.0, 24.0, 40.0, 28.0, 40.0, 50.0, 120.0, 50.0, 70.0, 38.0, 30.0, 39.0, 30.0, -10.0, 0.0, 20.0, -13.0, 0.0, 130.0, 60.0, 43.0, 60.0, 30.0, 0.0, 70.0, 23.0, 50.0, 15.0, 80.0, 50.0, 30.0, 120.0, 20.0, 47.0, 70.0, 80.0, 50.0, 30.0, 20.0, 78.0, 70.0, 80.0, 90.0, 29.0, 90.0, 80.0, 50.0, 110.0, 30.0, 130.0, 60.0, 86.0, 60.0, 90.0, 3.0, 110.0, -1.0, 60.0, 50.0, 3.0, 70.0, 16.0, 80.0, 17.0, 70.0, 40.0, 50.0, 60.0, 50.0, 40.0, 100.0, 31.0, 50.0, 100.0, 98.0, 100.0, 70.0, 70.0, 90.0, 120.0, 40.0, 120.0, 90.0, 56.0, 60.0, 89.0, 100.0, 110.0, 10.0, 100.0, 130.0, 50.0, 50.0, 80.0, 60.0, 210.0, 50.0, 40.0, 80.0, 40.0, 67.0, 40.0, 90.0, -35.0, 120.0, 65.0, 140.0, 55.0, 31.0, 120.0, 130.0, 50.0, 90.0, 100.0, 60.0, 20.0, 70.0, 30.0, 60.0, 50.0, 50.0, 100.0, 60.0, 130.0, 100.0, -50.0, 15.0, 60.0, -8.0, 20.0, 80.0, 110.0, 20.0, 40.0, 50.0, 160.0, 140.0, 20.0, 80.0, 80.0, 60.0, 8.0, 60.0, 80.0, 69.0, 80.0, 39.0, 0.0, -14.0, 27.0, 24.0, -30.0, 54.0, 49.0, 40.0, 30.0, 120.0, 34.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, 50.0, 0.0, 130.0, 90.0, 20.0, 65.0, 70.0, 46.0, 120.0, 59.0, 50.0, 19.0, 70.0, 60.0, 19.0, 100.0, 101.0, 10.0, 18.0, 17.0, 50.0, 42.0, 30.0, 26.0, 110.0, 79.0, 100.0, 10.0, 20.0, 90.0, 90.0, 70.0, 60.0, 50.0, 60.0, 50.0, 30.0, 37.0, 100.0, 90.0, 60.0, 70.0, 60.0, 60.0, 30.0, 48.0, 50.0, 0.0, 30.0, 90.0, -41.0, 20.0, 70.0, 50.0, 53.0, 20.0, 80.0, 50.0, 10.0, 30.0, -14.0, 37.0, 29.0, 2.0, 10.0, 60.0, 30.0, 50.0, 100.0, 50.0, 60.0, 60.0, 70.0, 60.0, 30.0, 110.0, 40.0, 90.0, 100.0, 70.0, 10.0, 80.0, 20.0, 80.0, 110.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 100.0, 80.0, 9.0, 27.0, 20.0, 60.0, -15.0, 40.0, 39.0, 40.0, 40.0, 75.0, 10.0, 79.0, 58.0, 90.0, 130.0, 70.0, 35.0, 90.0, 80.0, 50.0, 60.0, 20.0, 60.0, 70.0, 89.0, 80.0, 100.0, 100.0, 50.0, 40.0, 70.0, 100.0, 110.0, 80.0, 50.0, 30.0, 55.0, 18.0, 8.0, 60.0, 140.0, 70.0, 90.0, 70.0, 70.0, 140.0, 70.0, 90.0, 58.0, 80.0, 70.0, 49.0, 30.0, 28.0, 90.0, 80.0, 40.0, 86.0, 50.0, 30.0, 60.0, 30.0, 40.0, 60.0, 50.0, 60.0, 40.0, 29.0, 80.0, 89.0, 48.0, 49.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 40.0, 100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0, 70.0, 100.0, 70.0, 80.0, 80.0, 60.0, 70.0, 75.0, 10.0, 100.0, 70.0, 40.0, 60.0, 100.0, 60.0, 90.0, 80.0, 60.0, 70.0, 120.0, 70.0, 80.0, 120.0, 130.0, 120.0, 30.0, 97.0, 58.0, 80.0, 57.0, 60.0, 60.0, 80.0, 50.0, 120.0, 50.0, 60.0, 90.0, 100.0, 50.0, 110.0, 49.0, 56.0, 40.0, 70.0, 40.0, 70.0, 110.0, 180.0, 90.0, 20.0, 80.0, 130.0, 60.0, 120.0, 50.0, 120.0, 60.0, 80.0, 100.0, 50.0, 60.0, 90.0, 50.0, 110.0, 70.0, 110.0, 30.0, 39.0, 90.0, 110.0, 80.0, 69.0, 190.0, 90.0, 70.0, 59.0, 110.0, 100.0, 120.0, 80.0, 40.0, 47.0, 70.0, 40.0, 48.0, 30.0, 80.0, 70.0, 20.0, 80.0, 100.0, 90.0, 2.0, 70.0, 120.0, 80.0, 90.0, 30.0, 34.0, 110.0, 20.0, 50.0, 34.0, 30.0, -15.0, 100.0, 30.0, 150.0, 40.0, 30.0, 100.0, 30.0, 100.0, 39.0, 29.0, 30.0, 16.0, 60.0, 20.0, -2.0, 40.0, -4.0, 60.0, 90.0, 110.0, 110.0, 100.0, 20.0, 40.0, 55.0, 20.0, 70.0, 40.0, 120.0, 30.0, 20.0, 20.0, 30.0, 60.0, 150.0, 60.0, 80.0, 10.0, 60.0, 50.0, 70.0, 40.0, 40.0, 110.0, 70.0, 180.0, 27.0, 60.0, 30.0, 60.0, 40.0, 28.0, 30.0, 100.0, 87.0, -75.0, 130.0, 80.0, 120.0, 36.0, 98.0, 10.0, 30.0, 120.0, 120.0, 80.0, 90.0, 50.0, 60.0, 61.0, 70.0, 80.0, 70.0, 54.0, 60.0, 38.0, 80.0, 60.0, 30.0, 30.0, 10.0, 50.0, 20.0, 20.0, 10.0, -32.0, 29.0, -10.0, 50.0, 20.0, 120.0, 70.0, 100.0, 87.0, 70.0, 30.0, 70.0, 5.0, 90.0, 40.0, 40.0, 80.0, 50.0, 30.0, 100.0, 12.0, 70.0, 40.0, -15.0, 30.0, 30.0, 34.0, 30.0, 130.0, 70.0, 20.0, 80.0, 40.0, 28.0, 100.0, 40.0, 90.0, 30.0, 130.0, 50.0, 100.0, 100.0, 30.0, 70.0, 40.0, 30.0, 70.0, 50.0, 29.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, -10.0, 60.0, 70.0, 20.0, 70.0, 100.0, 80.0, 90.0, 70.0, 100.0, 90.0, 20.0, 70.0, 60.0, 48.0, 110.0, 40.0, 0.0, 90.0, 80.0, 0.0, 20.0, 18.0, 20.0, 40.0, 40.0, 50.0, 30.0, 35.0, 30.0, 40.0, -14.0, 35.0, 0.0, 40.0, 70.0, 26.0, 40.0, 6.0, 40.0, 100.0, 30.0, 90.0, 90.0, 50.0, 90.0, 83.0, 40.0, 80.0, 110.0, 30.0, 10.0, 160.0, 22.0, 80.0, 50.0, 50.0, 25.0, 0.0, 90.0, 20.0, 130.0, 40.0, 150.0, -3.0, 140.0, 50.0, 20.0, 120.0, -6.0, 13.0, 30.0, 10.0, 20.0, 60.0, 20.0, -1.0, 37.0, 70.0, 90.0, 60.0, 52.0, 10.0, 100.0, 31.0, 0.0, 13.0, 60.0, 70.0, 20.0, 30.0, 56.0, 27.0, 20.0, 80.0, 150.0, 69.0, 90.0, 46.0, 90.0, 40.0, 90.0, 10.0, 80.0, 50.0, 64.0, 73.0, 90.0, 30.0, 50.0, 20.0, 90.0, 0.0, 110.0, 90.0, 130.0, 30.0, 20.0, 110.0, 60.0, 70.0, 60.0, 50.0, 40.0, 100.0, 24.0, 110.0, 50.0, 60.0, 110.0, 60.0, 74.0, 40.0, 100.0, 80.0, 50.0, 20.0, 80.0, 40.0, 60.0, 70.0, 80.0, 90.0, 70.0, 58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.541938774561113, "mean_inference_ms": 1.548887002198109, "mean_action_processing_ms": 0.4905109554920287, "mean_env_wait_ms": 1.352752610439015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01401829719543457, "StateBufferConnector_ms": 0.009694814682006836, "ViewRequirementAgentConnector_ms": 0.38540029525756836}, "num_episodes": 22, "episode_return_max": 998.0, "episode_return_min": -14.0, "episode_return_mean": 562.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.566588906555072, "num_env_steps_trained_throughput_per_sec": 21.566588906555072, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 184600.328, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184600.281, "sample_time_ms": 2507.631, "learn_time_ms": 182073.555, "learn_throughput": 21.969, "synch_weights_time_ms": 11.508}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "a22d3_00000", "date": "2024-08-06_04-45-38", "timestamp": 1722933938, "time_this_iter_s": 185.48480987548828, "time_total_s": 21728.813794851303, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2096790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21728.813794851303, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.86030534351145, "ram_util_percent": 75.65381679389314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.880047290171551, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010824848889337041, "vf_loss": 6.3507790426857555, "vf_explained_var": 0.0019065263426214997, "kl": Infinity, "entropy": 0.5779814635317165, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 998.0, "episode_reward_min": -14.0, "episode_reward_mean": 562.39, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -176.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 56.239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [458.0, 590.0, 466.0, 482.0, -14.0, 385.0, 527.0, 530.0, 286.0, 421.0, 545.0, 759.0, 521.0, 493.0, 829.0, 775.0, 790.0, 693.0, 660.0, 477.0, 780.0, 409.0, 351.0, 545.0, 613.0, 483.0, 600.0, 585.0, 342.0, 294.0, 620.0, 620.0, 350.0, 340.0, 717.0, 679.0, 561.0, 858.0, 603.0, 479.0, 356.0, 410.0, 715.0, 750.0, 842.0, 720.0, 815.0, 820.0, 699.0, 998.0, 525.0, 696.0, 549.0, 454.0, 564.0, 465.0, 670.0, 625.0, 636.0, 735.0, 398.0, 444.0, 505.0, 461.0, 628.0, 569.0, 430.0, 750.0, 426.0, 286.0, 532.0, 675.0, 635.0, 394.0, 498.0, 327.0, 745.0, 577.0, 660.0, 728.0, 640.0, 583.0, 590.0, 358.0, 590.0, 402.0, 599.0, 904.0, 640.0, 898.0, 375.0, 347.0, 398.0, 480.0, 491.0, 547.0, 417.0, 591.0, 657.0, 518.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 43.0, 80.0, 65.0, 60.0, 40.0, 60.0, 57.0, -10.0, 13.0, 40.0, 30.0, 80.0, 109.0, 10.0, 36.0, 80.0, 100.0, 45.0, 60.0, 30.0, 40.0, 50.0, 9.0, 7.0, 40.0, 70.0, 90.0, 50.0, 80.0, 120.0, 30.0, -14.0, 10.0, 50.0, 110.0, -24.0, 10.0, 50.0, 140.0, 25.0, 30.0, 8.0, -176.0, 20.0, 40.0, 90.0, 40.0, -131.0, 40.0, 40.0, 70.0, 100.0, 20.0, -13.0, 25.0, 35.0, 28.0, 50.0, 30.0, 20.0, 80.0, 20.0, 60.0, 20.0, 90.0, 70.0, 100.0, -2.0, 69.0, 70.0, 24.0, 40.0, 28.0, 40.0, 50.0, 120.0, 50.0, 70.0, 38.0, 30.0, 39.0, 30.0, -10.0, 0.0, 20.0, -13.0, 0.0, 130.0, 60.0, 43.0, 60.0, 30.0, 0.0, 70.0, 23.0, 50.0, 15.0, 80.0, 50.0, 30.0, 120.0, 20.0, 47.0, 70.0, 80.0, 50.0, 30.0, 20.0, 78.0, 70.0, 80.0, 90.0, 29.0, 90.0, 80.0, 50.0, 110.0, 30.0, 130.0, 60.0, 86.0, 60.0, 90.0, 3.0, 110.0, -1.0, 60.0, 50.0, 3.0, 70.0, 16.0, 80.0, 17.0, 70.0, 40.0, 50.0, 60.0, 50.0, 40.0, 100.0, 31.0, 50.0, 100.0, 98.0, 100.0, 70.0, 70.0, 90.0, 120.0, 40.0, 120.0, 90.0, 56.0, 60.0, 89.0, 100.0, 110.0, 10.0, 100.0, 130.0, 50.0, 50.0, 80.0, 60.0, 210.0, 50.0, 40.0, 80.0, 40.0, 67.0, 40.0, 90.0, -35.0, 120.0, 65.0, 140.0, 55.0, 31.0, 120.0, 130.0, 50.0, 90.0, 100.0, 60.0, 20.0, 70.0, 30.0, 60.0, 50.0, 50.0, 100.0, 60.0, 130.0, 100.0, -50.0, 15.0, 60.0, -8.0, 20.0, 80.0, 110.0, 20.0, 40.0, 50.0, 160.0, 140.0, 20.0, 80.0, 80.0, 60.0, 8.0, 60.0, 80.0, 69.0, 80.0, 39.0, 0.0, -14.0, 27.0, 24.0, -30.0, 54.0, 49.0, 40.0, 30.0, 120.0, 34.0, 20.0, 10.0, 50.0, 50.0, 70.0, 20.0, 50.0, 0.0, 130.0, 90.0, 20.0, 65.0, 70.0, 46.0, 120.0, 59.0, 50.0, 19.0, 70.0, 60.0, 19.0, 100.0, 101.0, 10.0, 18.0, 17.0, 50.0, 42.0, 30.0, 26.0, 110.0, 79.0, 100.0, 10.0, 20.0, 90.0, 90.0, 70.0, 60.0, 50.0, 60.0, 50.0, 30.0, 37.0, 100.0, 90.0, 60.0, 70.0, 60.0, 60.0, 30.0, 48.0, 50.0, 0.0, 30.0, 90.0, -41.0, 20.0, 70.0, 50.0, 53.0, 20.0, 80.0, 50.0, 10.0, 30.0, -14.0, 37.0, 29.0, 2.0, 10.0, 60.0, 30.0, 50.0, 100.0, 50.0, 60.0, 60.0, 70.0, 60.0, 30.0, 110.0, 40.0, 90.0, 100.0, 70.0, 10.0, 80.0, 20.0, 80.0, 110.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 100.0, 80.0, 9.0, 27.0, 20.0, 60.0, -15.0, 40.0, 39.0, 40.0, 40.0, 75.0, 10.0, 79.0, 58.0, 90.0, 130.0, 70.0, 35.0, 90.0, 80.0, 50.0, 60.0, 20.0, 60.0, 70.0, 89.0, 80.0, 100.0, 100.0, 50.0, 40.0, 70.0, 100.0, 110.0, 80.0, 50.0, 30.0, 55.0, 18.0, 8.0, 60.0, 140.0, 70.0, 90.0, 70.0, 70.0, 140.0, 70.0, 90.0, 58.0, 80.0, 70.0, 49.0, 30.0, 28.0, 90.0, 80.0, 40.0, 86.0, 50.0, 30.0, 60.0, 30.0, 40.0, 60.0, 50.0, 60.0, 40.0, 29.0, 80.0, 89.0, 48.0, 49.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 40.0, 100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0, 70.0, 100.0, 70.0, 80.0, 80.0, 60.0, 70.0, 75.0, 10.0, 100.0, 70.0, 40.0, 60.0, 100.0, 60.0, 90.0, 80.0, 60.0, 70.0, 120.0, 70.0, 80.0, 120.0, 130.0, 120.0, 30.0, 97.0, 58.0, 80.0, 57.0, 60.0, 60.0, 80.0, 50.0, 120.0, 50.0, 60.0, 90.0, 100.0, 50.0, 110.0, 49.0, 56.0, 40.0, 70.0, 40.0, 70.0, 110.0, 180.0, 90.0, 20.0, 80.0, 130.0, 60.0, 120.0, 50.0, 120.0, 60.0, 80.0, 100.0, 50.0, 60.0, 90.0, 50.0, 110.0, 70.0, 110.0, 30.0, 39.0, 90.0, 110.0, 80.0, 69.0, 190.0, 90.0, 70.0, 59.0, 110.0, 100.0, 120.0, 80.0, 40.0, 47.0, 70.0, 40.0, 48.0, 30.0, 80.0, 70.0, 20.0, 80.0, 100.0, 90.0, 2.0, 70.0, 120.0, 80.0, 90.0, 30.0, 34.0, 110.0, 20.0, 50.0, 34.0, 30.0, -15.0, 100.0, 30.0, 150.0, 40.0, 30.0, 100.0, 30.0, 100.0, 39.0, 29.0, 30.0, 16.0, 60.0, 20.0, -2.0, 40.0, -4.0, 60.0, 90.0, 110.0, 110.0, 100.0, 20.0, 40.0, 55.0, 20.0, 70.0, 40.0, 120.0, 30.0, 20.0, 20.0, 30.0, 60.0, 150.0, 60.0, 80.0, 10.0, 60.0, 50.0, 70.0, 40.0, 40.0, 110.0, 70.0, 180.0, 27.0, 60.0, 30.0, 60.0, 40.0, 28.0, 30.0, 100.0, 87.0, -75.0, 130.0, 80.0, 120.0, 36.0, 98.0, 10.0, 30.0, 120.0, 120.0, 80.0, 90.0, 50.0, 60.0, 61.0, 70.0, 80.0, 70.0, 54.0, 60.0, 38.0, 80.0, 60.0, 30.0, 30.0, 10.0, 50.0, 20.0, 20.0, 10.0, -32.0, 29.0, -10.0, 50.0, 20.0, 120.0, 70.0, 100.0, 87.0, 70.0, 30.0, 70.0, 5.0, 90.0, 40.0, 40.0, 80.0, 50.0, 30.0, 100.0, 12.0, 70.0, 40.0, -15.0, 30.0, 30.0, 34.0, 30.0, 130.0, 70.0, 20.0, 80.0, 40.0, 28.0, 100.0, 40.0, 90.0, 30.0, 130.0, 50.0, 100.0, 100.0, 30.0, 70.0, 40.0, 30.0, 70.0, 50.0, 29.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, -10.0, 60.0, 70.0, 20.0, 70.0, 100.0, 80.0, 90.0, 70.0, 100.0, 90.0, 20.0, 70.0, 60.0, 48.0, 110.0, 40.0, 0.0, 90.0, 80.0, 0.0, 20.0, 18.0, 20.0, 40.0, 40.0, 50.0, 30.0, 35.0, 30.0, 40.0, -14.0, 35.0, 0.0, 40.0, 70.0, 26.0, 40.0, 6.0, 40.0, 100.0, 30.0, 90.0, 90.0, 50.0, 90.0, 83.0, 40.0, 80.0, 110.0, 30.0, 10.0, 160.0, 22.0, 80.0, 50.0, 50.0, 25.0, 0.0, 90.0, 20.0, 130.0, 40.0, 150.0, -3.0, 140.0, 50.0, 20.0, 120.0, -6.0, 13.0, 30.0, 10.0, 20.0, 60.0, 20.0, -1.0, 37.0, 70.0, 90.0, 60.0, 52.0, 10.0, 100.0, 31.0, 0.0, 13.0, 60.0, 70.0, 20.0, 30.0, 56.0, 27.0, 20.0, 80.0, 150.0, 69.0, 90.0, 46.0, 90.0, 40.0, 90.0, 10.0, 80.0, 50.0, 64.0, 73.0, 90.0, 30.0, 50.0, 20.0, 90.0, 0.0, 110.0, 90.0, 130.0, 30.0, 20.0, 110.0, 60.0, 70.0, 60.0, 50.0, 40.0, 100.0, 24.0, 110.0, 50.0, 60.0, 110.0, 60.0, 74.0, 40.0, 100.0, 80.0, 50.0, 20.0, 80.0, 40.0, 60.0, 70.0, 80.0, 90.0, 70.0, 58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0, 60.0, 70.0, 70.0, 50.0, 50.0, 40.0, 30.0, 60.0, 100.0, 60.0, 120.0, -9.0, 40.0, 70.0, 50.0, -3.0, 40.0, 30.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 40.0, 20.0, 60.0, 110.0, 60.0, 90.0, 80.0, 0.0, 40.0, 50.0, 80.0, 80.0, 50.0, -9.0, 10.0, 21.0, 100.0, 10.0, -10.0, 90.0, 60.0, 19.0, 130.0, 130.0, 70.0, 0.0, 74.0, 90.0, 100.0, 60.0, 80.0, 100.0, 104.0, 86.0, 140.0, 70.0, 90.0, 70.0, 90.0, 10.0, 140.0, 50.0, 50.0, 60.0, 30.0, 50.0, 90.0, 78.0, 50.0, 150.0, 100.0, 70.0, 60.0, 140.0, 110.0, 50.0, 50.0, 70.0, 40.0, 20.0, 24.0, 10.0, 20.0, 80.0, 21.0, 40.0, 80.0, 52.0, 20.0, 10.0, 20.0, 32.0, 12.0, 20.0, 41.0, 60.0, 78.0, 30.0, 70.0, 5.0, 80.0, 40.0, 50.0, 0.0, -15.0, 60.0, 60.0, 50.0, 50.0, 80.0, 40.0, 30.0, 50.0, 80.0, 20.0, 20.0, 80.0, 100.0, -3.0, 50.0, 90.0, 40.0, 80.0, 15.0, 29.0, 10.0, 11.0, 130.0, 16.0, 40.0, 31.0, 60.0, 70.0, 40.0, 100.0, 49.0, 49.0, 40.0, 20.0, 80.0, 10.0, 20.0, 60.0, 30.0, -2.0, 110.0, 36.0, 30.0, 125.0, 80.0, 130.0, 50.0, 90.0, 20.0, -10.0, 40.0, 58.0, 150.0, 50.0, 50.0, 60.0, 40.0, 50.0, 79.0, 20.0, 100.0, 50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.541397544429735, "mean_inference_ms": 1.5481647513243022, "mean_action_processing_ms": 0.49090102576993766, "mean_env_wait_ms": 1.3519055563005815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014029979705810547, "StateBufferConnector_ms": 0.009751081466674805, "ViewRequirementAgentConnector_ms": 0.38701820373535156}, "num_episodes": 18, "episode_return_max": 998.0, "episode_return_min": -14.0, "episode_return_mean": 562.39}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.433142057214177, "num_env_steps_trained_throughput_per_sec": 21.433142057214177, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 184801.102, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184801.053, "sample_time_ms": 2495.367, "learn_time_ms": 182286.64, "learn_throughput": 21.943, "synch_weights_time_ms": 11.43}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "a22d3_00000", "date": "2024-08-06_04-48-44", "timestamp": 1722934124, "time_this_iter_s": 186.63867282867432, "time_total_s": 21915.452467679977, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a13c1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21915.452467679977, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 20.551136363636363, "ram_util_percent": 75.09734848484847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.989307838506973, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009726050451022986, "vf_loss": 6.287114134230934, "vf_explained_var": 0.006456567932622502, "kl": Infinity, "entropy": 0.5742281732213891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 998.0, "episode_reward_min": 155.0, "episode_reward_mean": 568.78, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 56.878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [545.0, 613.0, 483.0, 600.0, 585.0, 342.0, 294.0, 620.0, 620.0, 350.0, 340.0, 717.0, 679.0, 561.0, 858.0, 603.0, 479.0, 356.0, 410.0, 715.0, 750.0, 842.0, 720.0, 815.0, 820.0, 699.0, 998.0, 525.0, 696.0, 549.0, 454.0, 564.0, 465.0, 670.0, 625.0, 636.0, 735.0, 398.0, 444.0, 505.0, 461.0, 628.0, 569.0, 430.0, 750.0, 426.0, 286.0, 532.0, 675.0, 635.0, 394.0, 498.0, 327.0, 745.0, 577.0, 660.0, 728.0, 640.0, 583.0, 590.0, 358.0, 590.0, 402.0, 599.0, 904.0, 640.0, 898.0, 375.0, 347.0, 398.0, 480.0, 491.0, 547.0, 417.0, 591.0, 657.0, 518.0, 726.0, 883.0, 620.0, 462.0, 596.0, 650.0, 767.0, 485.0, 539.0, 644.0, 590.0, 679.0, 650.0, 155.0, 577.0, 273.0, 394.0, 690.0, 560.0, 465.0, 554.0, 190.0, 703.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 50.0, 70.0, 20.0, 50.0, 0.0, 130.0, 90.0, 20.0, 65.0, 70.0, 46.0, 120.0, 59.0, 50.0, 19.0, 70.0, 60.0, 19.0, 100.0, 101.0, 10.0, 18.0, 17.0, 50.0, 42.0, 30.0, 26.0, 110.0, 79.0, 100.0, 10.0, 20.0, 90.0, 90.0, 70.0, 60.0, 50.0, 60.0, 50.0, 30.0, 37.0, 100.0, 90.0, 60.0, 70.0, 60.0, 60.0, 30.0, 48.0, 50.0, 0.0, 30.0, 90.0, -41.0, 20.0, 70.0, 50.0, 53.0, 20.0, 80.0, 50.0, 10.0, 30.0, -14.0, 37.0, 29.0, 2.0, 10.0, 60.0, 30.0, 50.0, 100.0, 50.0, 60.0, 60.0, 70.0, 60.0, 30.0, 110.0, 40.0, 90.0, 100.0, 70.0, 10.0, 80.0, 20.0, 80.0, 110.0, 20.0, 60.0, 10.0, 80.0, 30.0, 20.0, 20.0, 20.0, 10.0, 0.0, 100.0, 80.0, 9.0, 27.0, 20.0, 60.0, -15.0, 40.0, 39.0, 40.0, 40.0, 75.0, 10.0, 79.0, 58.0, 90.0, 130.0, 70.0, 35.0, 90.0, 80.0, 50.0, 60.0, 20.0, 60.0, 70.0, 89.0, 80.0, 100.0, 100.0, 50.0, 40.0, 70.0, 100.0, 110.0, 80.0, 50.0, 30.0, 55.0, 18.0, 8.0, 60.0, 140.0, 70.0, 90.0, 70.0, 70.0, 140.0, 70.0, 90.0, 58.0, 80.0, 70.0, 49.0, 30.0, 28.0, 90.0, 80.0, 40.0, 86.0, 50.0, 30.0, 60.0, 30.0, 40.0, 60.0, 50.0, 60.0, 40.0, 29.0, 80.0, 89.0, 48.0, 49.0, 40.0, 40.0, 30.0, 10.0, 0.0, 10.0, 40.0, 100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0, 70.0, 100.0, 70.0, 80.0, 80.0, 60.0, 70.0, 75.0, 10.0, 100.0, 70.0, 40.0, 60.0, 100.0, 60.0, 90.0, 80.0, 60.0, 70.0, 120.0, 70.0, 80.0, 120.0, 130.0, 120.0, 30.0, 97.0, 58.0, 80.0, 57.0, 60.0, 60.0, 80.0, 50.0, 120.0, 50.0, 60.0, 90.0, 100.0, 50.0, 110.0, 49.0, 56.0, 40.0, 70.0, 40.0, 70.0, 110.0, 180.0, 90.0, 20.0, 80.0, 130.0, 60.0, 120.0, 50.0, 120.0, 60.0, 80.0, 100.0, 50.0, 60.0, 90.0, 50.0, 110.0, 70.0, 110.0, 30.0, 39.0, 90.0, 110.0, 80.0, 69.0, 190.0, 90.0, 70.0, 59.0, 110.0, 100.0, 120.0, 80.0, 40.0, 47.0, 70.0, 40.0, 48.0, 30.0, 80.0, 70.0, 20.0, 80.0, 100.0, 90.0, 2.0, 70.0, 120.0, 80.0, 90.0, 30.0, 34.0, 110.0, 20.0, 50.0, 34.0, 30.0, -15.0, 100.0, 30.0, 150.0, 40.0, 30.0, 100.0, 30.0, 100.0, 39.0, 29.0, 30.0, 16.0, 60.0, 20.0, -2.0, 40.0, -4.0, 60.0, 90.0, 110.0, 110.0, 100.0, 20.0, 40.0, 55.0, 20.0, 70.0, 40.0, 120.0, 30.0, 20.0, 20.0, 30.0, 60.0, 150.0, 60.0, 80.0, 10.0, 60.0, 50.0, 70.0, 40.0, 40.0, 110.0, 70.0, 180.0, 27.0, 60.0, 30.0, 60.0, 40.0, 28.0, 30.0, 100.0, 87.0, -75.0, 130.0, 80.0, 120.0, 36.0, 98.0, 10.0, 30.0, 120.0, 120.0, 80.0, 90.0, 50.0, 60.0, 61.0, 70.0, 80.0, 70.0, 54.0, 60.0, 38.0, 80.0, 60.0, 30.0, 30.0, 10.0, 50.0, 20.0, 20.0, 10.0, -32.0, 29.0, -10.0, 50.0, 20.0, 120.0, 70.0, 100.0, 87.0, 70.0, 30.0, 70.0, 5.0, 90.0, 40.0, 40.0, 80.0, 50.0, 30.0, 100.0, 12.0, 70.0, 40.0, -15.0, 30.0, 30.0, 34.0, 30.0, 130.0, 70.0, 20.0, 80.0, 40.0, 28.0, 100.0, 40.0, 90.0, 30.0, 130.0, 50.0, 100.0, 100.0, 30.0, 70.0, 40.0, 30.0, 70.0, 50.0, 29.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, -10.0, 60.0, 70.0, 20.0, 70.0, 100.0, 80.0, 90.0, 70.0, 100.0, 90.0, 20.0, 70.0, 60.0, 48.0, 110.0, 40.0, 0.0, 90.0, 80.0, 0.0, 20.0, 18.0, 20.0, 40.0, 40.0, 50.0, 30.0, 35.0, 30.0, 40.0, -14.0, 35.0, 0.0, 40.0, 70.0, 26.0, 40.0, 6.0, 40.0, 100.0, 30.0, 90.0, 90.0, 50.0, 90.0, 83.0, 40.0, 80.0, 110.0, 30.0, 10.0, 160.0, 22.0, 80.0, 50.0, 50.0, 25.0, 0.0, 90.0, 20.0, 130.0, 40.0, 150.0, -3.0, 140.0, 50.0, 20.0, 120.0, -6.0, 13.0, 30.0, 10.0, 20.0, 60.0, 20.0, -1.0, 37.0, 70.0, 90.0, 60.0, 52.0, 10.0, 100.0, 31.0, 0.0, 13.0, 60.0, 70.0, 20.0, 30.0, 56.0, 27.0, 20.0, 80.0, 150.0, 69.0, 90.0, 46.0, 90.0, 40.0, 90.0, 10.0, 80.0, 50.0, 64.0, 73.0, 90.0, 30.0, 50.0, 20.0, 90.0, 0.0, 110.0, 90.0, 130.0, 30.0, 20.0, 110.0, 60.0, 70.0, 60.0, 50.0, 40.0, 100.0, 24.0, 110.0, 50.0, 60.0, 110.0, 60.0, 74.0, 40.0, 100.0, 80.0, 50.0, 20.0, 80.0, 40.0, 60.0, 70.0, 80.0, 90.0, 70.0, 58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0, 60.0, 70.0, 70.0, 50.0, 50.0, 40.0, 30.0, 60.0, 100.0, 60.0, 120.0, -9.0, 40.0, 70.0, 50.0, -3.0, 40.0, 30.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 40.0, 20.0, 60.0, 110.0, 60.0, 90.0, 80.0, 0.0, 40.0, 50.0, 80.0, 80.0, 50.0, -9.0, 10.0, 21.0, 100.0, 10.0, -10.0, 90.0, 60.0, 19.0, 130.0, 130.0, 70.0, 0.0, 74.0, 90.0, 100.0, 60.0, 80.0, 100.0, 104.0, 86.0, 140.0, 70.0, 90.0, 70.0, 90.0, 10.0, 140.0, 50.0, 50.0, 60.0, 30.0, 50.0, 90.0, 78.0, 50.0, 150.0, 100.0, 70.0, 60.0, 140.0, 110.0, 50.0, 50.0, 70.0, 40.0, 20.0, 24.0, 10.0, 20.0, 80.0, 21.0, 40.0, 80.0, 52.0, 20.0, 10.0, 20.0, 32.0, 12.0, 20.0, 41.0, 60.0, 78.0, 30.0, 70.0, 5.0, 80.0, 40.0, 50.0, 0.0, -15.0, 60.0, 60.0, 50.0, 50.0, 80.0, 40.0, 30.0, 50.0, 80.0, 20.0, 20.0, 80.0, 100.0, -3.0, 50.0, 90.0, 40.0, 80.0, 15.0, 29.0, 10.0, 11.0, 130.0, 16.0, 40.0, 31.0, 60.0, 70.0, 40.0, 100.0, 49.0, 49.0, 40.0, 20.0, 80.0, 10.0, 20.0, 60.0, 30.0, -2.0, 110.0, 36.0, 30.0, 125.0, 80.0, 130.0, 50.0, 90.0, 20.0, -10.0, 40.0, 58.0, 150.0, 50.0, 50.0, 60.0, 40.0, 50.0, 79.0, 20.0, 100.0, 50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0, 100.0, 80.0, 90.0, 60.0, 35.0, 18.0, 123.0, 20.0, 120.0, 80.0, 60.0, 40.0, 120.0, 60.0, 22.0, 158.0, 145.0, 160.0, 30.0, 88.0, 70.0, 50.0, 65.0, 118.0, 80.0, 17.0, 60.0, 20.0, 80.0, 60.0, 150.0, 108.0, 11.0, 30.0, 20.0, 24.0, 30.0, 19.0, 50.0, 20.0, 20.0, 110.0, 99.0, 20.0, 90.0, 57.0, 40.0, 0.0, 50.0, 110.0, 50.0, 100.0, 40.0, 30.0, 120.0, 50.0, 60.0, 70.0, 60.0, 70.0, 130.0, 70.0, 80.0, 90.0, 60.0, 109.0, -12.0, 120.0, 40.0, 80.0, 25.0, 90.0, 50.0, 30.0, 20.0, 20.0, 100.0, 20.0, 60.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 20.0, 70.0, 50.0, 20.0, -1.0, 60.0, 140.0, 50.0, 70.0, -14.0, 100.0, 60.0, 48.0, 50.0, 80.0, 80.0, 80.0, 100.0, 110.0, 90.0, 10.0, 20.0, 0.0, 50.0, 50.0, 40.0, 50.0, 40.0, 20.0, 128.0, 130.0, 56.0, 98.0, 70.0, 47.0, 25.0, 80.0, 70.0, 110.0, 70.0, 90.0, 70.0, 25.0, 30.0, 80.0, 13.0, 0.0, 10.0, 0.0, 0.0, 32.0, 10.0, 30.0, 30.0, 30.0, 40.0, 59.0, 30.0, 70.0, 110.0, 80.0, 30.0, 60.0, 30.0, 68.0, 40.0, 60.0, 38.0, 15.0, -7.0, 30.0, 20.0, -13.0, 50.0, 40.0, 50.0, 60.0, 20.0, 39.0, 90.0, 20.0, 30.0, 90.0, -5.0, 0.0, 90.0, 60.0, 100.0, 100.0, 30.0, 100.0, 60.0, 80.0, 40.0, 30.0, 100.0, 80.0, 40.0, -7.0, 29.0, 110.0, 60.0, -12.0, 60.0, 100.0, 40.0, 2.0, 70.0, 100.0, 120.0, -39.0, 30.0, 32.0, 60.0, 50.0, 100.0, 50.0, 50.0, 90.0, 100.0, 50.0, 20.0, 22.0, 60.0, 12.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 0.0, 70.0, 30.0, 10.0, 90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5380645777352473, "mean_inference_ms": 1.544764914091461, "mean_action_processing_ms": 0.4913952569425362, "mean_env_wait_ms": 1.351057258349985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01412820816040039, "StateBufferConnector_ms": 0.009773731231689453, "ViewRequirementAgentConnector_ms": 0.3837287425994873}, "num_episodes": 23, "episode_return_max": 998.0, "episode_return_min": 155.0, "episode_return_mean": 568.78}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.418371894427924, "num_env_steps_trained_throughput_per_sec": 21.418371894427924, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 185161.646, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185161.597, "sample_time_ms": 2535.201, "learn_time_ms": 182606.981, "learn_throughput": 21.905, "synch_weights_time_ms": 11.869}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "a22d3_00000", "date": "2024-08-06_04-51-51", "timestamp": 1722934311, "time_this_iter_s": 186.76742601394653, "time_total_s": 22102.219893693924, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22102.219893693924, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 21.053030303030305, "ram_util_percent": 74.64583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8705920078376104, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.27537491882698, "policy_loss": -0.009604530971045026, "vf_loss": 6.2814241817076235, "vf_explained_var": 0.004068355089305435, "kl": 0.003121225236678925, "entropy": 0.5473334747444961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 998.0, "episode_reward_min": 155.0, "episode_reward_mean": 577.73, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 57.773}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 715.0, 750.0, 842.0, 720.0, 815.0, 820.0, 699.0, 998.0, 525.0, 696.0, 549.0, 454.0, 564.0, 465.0, 670.0, 625.0, 636.0, 735.0, 398.0, 444.0, 505.0, 461.0, 628.0, 569.0, 430.0, 750.0, 426.0, 286.0, 532.0, 675.0, 635.0, 394.0, 498.0, 327.0, 745.0, 577.0, 660.0, 728.0, 640.0, 583.0, 590.0, 358.0, 590.0, 402.0, 599.0, 904.0, 640.0, 898.0, 375.0, 347.0, 398.0, 480.0, 491.0, 547.0, 417.0, 591.0, 657.0, 518.0, 726.0, 883.0, 620.0, 462.0, 596.0, 650.0, 767.0, 485.0, 539.0, 644.0, 590.0, 679.0, 650.0, 155.0, 577.0, 273.0, 394.0, 690.0, 560.0, 465.0, 554.0, 190.0, 703.0, 692.0, 276.0, 549.0, 652.0, 750.0, 585.0, 777.0, 428.0, 507.0, 595.0, 640.0, 547.0, 668.0, 585.0, 836.0, 640.0, 439.0, 374.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 8.0, 40.0, 2.0, 10.0, 80.0, 60.0, 0.0, 30.0, 80.0, 70.0, 100.0, 70.0, 80.0, 80.0, 60.0, 70.0, 75.0, 10.0, 100.0, 70.0, 40.0, 60.0, 100.0, 60.0, 90.0, 80.0, 60.0, 70.0, 120.0, 70.0, 80.0, 120.0, 130.0, 120.0, 30.0, 97.0, 58.0, 80.0, 57.0, 60.0, 60.0, 80.0, 50.0, 120.0, 50.0, 60.0, 90.0, 100.0, 50.0, 110.0, 49.0, 56.0, 40.0, 70.0, 40.0, 70.0, 110.0, 180.0, 90.0, 20.0, 80.0, 130.0, 60.0, 120.0, 50.0, 120.0, 60.0, 80.0, 100.0, 50.0, 60.0, 90.0, 50.0, 110.0, 70.0, 110.0, 30.0, 39.0, 90.0, 110.0, 80.0, 69.0, 190.0, 90.0, 70.0, 59.0, 110.0, 100.0, 120.0, 80.0, 40.0, 47.0, 70.0, 40.0, 48.0, 30.0, 80.0, 70.0, 20.0, 80.0, 100.0, 90.0, 2.0, 70.0, 120.0, 80.0, 90.0, 30.0, 34.0, 110.0, 20.0, 50.0, 34.0, 30.0, -15.0, 100.0, 30.0, 150.0, 40.0, 30.0, 100.0, 30.0, 100.0, 39.0, 29.0, 30.0, 16.0, 60.0, 20.0, -2.0, 40.0, -4.0, 60.0, 90.0, 110.0, 110.0, 100.0, 20.0, 40.0, 55.0, 20.0, 70.0, 40.0, 120.0, 30.0, 20.0, 20.0, 30.0, 60.0, 150.0, 60.0, 80.0, 10.0, 60.0, 50.0, 70.0, 40.0, 40.0, 110.0, 70.0, 180.0, 27.0, 60.0, 30.0, 60.0, 40.0, 28.0, 30.0, 100.0, 87.0, -75.0, 130.0, 80.0, 120.0, 36.0, 98.0, 10.0, 30.0, 120.0, 120.0, 80.0, 90.0, 50.0, 60.0, 61.0, 70.0, 80.0, 70.0, 54.0, 60.0, 38.0, 80.0, 60.0, 30.0, 30.0, 10.0, 50.0, 20.0, 20.0, 10.0, -32.0, 29.0, -10.0, 50.0, 20.0, 120.0, 70.0, 100.0, 87.0, 70.0, 30.0, 70.0, 5.0, 90.0, 40.0, 40.0, 80.0, 50.0, 30.0, 100.0, 12.0, 70.0, 40.0, -15.0, 30.0, 30.0, 34.0, 30.0, 130.0, 70.0, 20.0, 80.0, 40.0, 28.0, 100.0, 40.0, 90.0, 30.0, 130.0, 50.0, 100.0, 100.0, 30.0, 70.0, 40.0, 30.0, 70.0, 50.0, 29.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, -10.0, 60.0, 70.0, 20.0, 70.0, 100.0, 80.0, 90.0, 70.0, 100.0, 90.0, 20.0, 70.0, 60.0, 48.0, 110.0, 40.0, 0.0, 90.0, 80.0, 0.0, 20.0, 18.0, 20.0, 40.0, 40.0, 50.0, 30.0, 35.0, 30.0, 40.0, -14.0, 35.0, 0.0, 40.0, 70.0, 26.0, 40.0, 6.0, 40.0, 100.0, 30.0, 90.0, 90.0, 50.0, 90.0, 83.0, 40.0, 80.0, 110.0, 30.0, 10.0, 160.0, 22.0, 80.0, 50.0, 50.0, 25.0, 0.0, 90.0, 20.0, 130.0, 40.0, 150.0, -3.0, 140.0, 50.0, 20.0, 120.0, -6.0, 13.0, 30.0, 10.0, 20.0, 60.0, 20.0, -1.0, 37.0, 70.0, 90.0, 60.0, 52.0, 10.0, 100.0, 31.0, 0.0, 13.0, 60.0, 70.0, 20.0, 30.0, 56.0, 27.0, 20.0, 80.0, 150.0, 69.0, 90.0, 46.0, 90.0, 40.0, 90.0, 10.0, 80.0, 50.0, 64.0, 73.0, 90.0, 30.0, 50.0, 20.0, 90.0, 0.0, 110.0, 90.0, 130.0, 30.0, 20.0, 110.0, 60.0, 70.0, 60.0, 50.0, 40.0, 100.0, 24.0, 110.0, 50.0, 60.0, 110.0, 60.0, 74.0, 40.0, 100.0, 80.0, 50.0, 20.0, 80.0, 40.0, 60.0, 70.0, 80.0, 90.0, 70.0, 58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0, 60.0, 70.0, 70.0, 50.0, 50.0, 40.0, 30.0, 60.0, 100.0, 60.0, 120.0, -9.0, 40.0, 70.0, 50.0, -3.0, 40.0, 30.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 40.0, 20.0, 60.0, 110.0, 60.0, 90.0, 80.0, 0.0, 40.0, 50.0, 80.0, 80.0, 50.0, -9.0, 10.0, 21.0, 100.0, 10.0, -10.0, 90.0, 60.0, 19.0, 130.0, 130.0, 70.0, 0.0, 74.0, 90.0, 100.0, 60.0, 80.0, 100.0, 104.0, 86.0, 140.0, 70.0, 90.0, 70.0, 90.0, 10.0, 140.0, 50.0, 50.0, 60.0, 30.0, 50.0, 90.0, 78.0, 50.0, 150.0, 100.0, 70.0, 60.0, 140.0, 110.0, 50.0, 50.0, 70.0, 40.0, 20.0, 24.0, 10.0, 20.0, 80.0, 21.0, 40.0, 80.0, 52.0, 20.0, 10.0, 20.0, 32.0, 12.0, 20.0, 41.0, 60.0, 78.0, 30.0, 70.0, 5.0, 80.0, 40.0, 50.0, 0.0, -15.0, 60.0, 60.0, 50.0, 50.0, 80.0, 40.0, 30.0, 50.0, 80.0, 20.0, 20.0, 80.0, 100.0, -3.0, 50.0, 90.0, 40.0, 80.0, 15.0, 29.0, 10.0, 11.0, 130.0, 16.0, 40.0, 31.0, 60.0, 70.0, 40.0, 100.0, 49.0, 49.0, 40.0, 20.0, 80.0, 10.0, 20.0, 60.0, 30.0, -2.0, 110.0, 36.0, 30.0, 125.0, 80.0, 130.0, 50.0, 90.0, 20.0, -10.0, 40.0, 58.0, 150.0, 50.0, 50.0, 60.0, 40.0, 50.0, 79.0, 20.0, 100.0, 50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0, 100.0, 80.0, 90.0, 60.0, 35.0, 18.0, 123.0, 20.0, 120.0, 80.0, 60.0, 40.0, 120.0, 60.0, 22.0, 158.0, 145.0, 160.0, 30.0, 88.0, 70.0, 50.0, 65.0, 118.0, 80.0, 17.0, 60.0, 20.0, 80.0, 60.0, 150.0, 108.0, 11.0, 30.0, 20.0, 24.0, 30.0, 19.0, 50.0, 20.0, 20.0, 110.0, 99.0, 20.0, 90.0, 57.0, 40.0, 0.0, 50.0, 110.0, 50.0, 100.0, 40.0, 30.0, 120.0, 50.0, 60.0, 70.0, 60.0, 70.0, 130.0, 70.0, 80.0, 90.0, 60.0, 109.0, -12.0, 120.0, 40.0, 80.0, 25.0, 90.0, 50.0, 30.0, 20.0, 20.0, 100.0, 20.0, 60.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 20.0, 70.0, 50.0, 20.0, -1.0, 60.0, 140.0, 50.0, 70.0, -14.0, 100.0, 60.0, 48.0, 50.0, 80.0, 80.0, 80.0, 100.0, 110.0, 90.0, 10.0, 20.0, 0.0, 50.0, 50.0, 40.0, 50.0, 40.0, 20.0, 128.0, 130.0, 56.0, 98.0, 70.0, 47.0, 25.0, 80.0, 70.0, 110.0, 70.0, 90.0, 70.0, 25.0, 30.0, 80.0, 13.0, 0.0, 10.0, 0.0, 0.0, 32.0, 10.0, 30.0, 30.0, 30.0, 40.0, 59.0, 30.0, 70.0, 110.0, 80.0, 30.0, 60.0, 30.0, 68.0, 40.0, 60.0, 38.0, 15.0, -7.0, 30.0, 20.0, -13.0, 50.0, 40.0, 50.0, 60.0, 20.0, 39.0, 90.0, 20.0, 30.0, 90.0, -5.0, 0.0, 90.0, 60.0, 100.0, 100.0, 30.0, 100.0, 60.0, 80.0, 40.0, 30.0, 100.0, 80.0, 40.0, -7.0, 29.0, 110.0, 60.0, -12.0, 60.0, 100.0, 40.0, 2.0, 70.0, 100.0, 120.0, -39.0, 30.0, 32.0, 60.0, 50.0, 100.0, 50.0, 50.0, 90.0, 100.0, 50.0, 20.0, 22.0, 60.0, 12.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 0.0, 70.0, 30.0, 10.0, 90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0, 63.0, 100.0, 50.0, 30.0, 80.0, 120.0, 70.0, 40.0, 20.0, 119.0, 40.0, 29.0, 50.0, 20.0, 8.0, 20.0, 30.0, 40.0, 39.0, 0.0, 4.0, 90.0, 32.0, 100.0, 65.0, 50.0, 51.0, 58.0, 29.0, 70.0, 100.0, 130.0, -25.0, 50.0, 100.0, 40.0, 70.0, 20.0, 107.0, 60.0, 80.0, 100.0, 40.0, 80.0, 150.0, 80.0, 20.0, 110.0, 50.0, 40.0, 30.0, 130.0, 15.0, 90.0, 70.0, 20.0, 70.0, 70.0, 70.0, 20.0, 50.0, 140.0, 100.0, 110.0, 90.0, 30.0, 8.0, 39.0, 70.0, 140.0, 60.0, 30.0, 30.0, 80.0, 49.0, 70.0, 70.0, -10.0, 30.0, 19.0, 20.0, 44.0, 60.0, 70.0, 10.0, 40.0, 50.0, 60.0, 83.0, 70.0, 50.0, 80.0, 90.0, 90.0, 90.0, 40.0, 60.0, 60.0, 17.0, 18.0, 130.0, 40.0, 90.0, 70.0, 60.0, 110.0, 20.0, 40.0, 20.0, 60.0, 100.0, 100.0, 90.0, 30.0, 50.0, 100.0, 50.0, 19.0, 25.0, -17.0, 80.0, 60.0, 60.0, 100.0, 40.0, 9.0, 29.0, 140.0, 80.0, 70.0, 10.0, 120.0, 110.0, 68.0, 39.0, 42.0, 30.0, 30.0, 90.0, 46.0, 9.0, 90.0, 50.0, 110.0, 150.0, 30.0, 67.0, 140.0, 100.0, 90.0, 60.0, 40.0, 60.0, 60.0, 120.0, 40.0, 30.0, 70.0, 80.0, 80.0, 50.0, 80.0, 30.0, 30.0, 20.0, 80.0, 70.0, -1.0, 40.0, 40.0, 47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.539486419046079, "mean_inference_ms": 1.546567952984485, "mean_action_processing_ms": 0.49186722382683196, "mean_env_wait_ms": 1.3500984976770494, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013086318969726562, "StateBufferConnector_ms": 0.00926351547241211, "ViewRequirementAgentConnector_ms": 0.37091565132141113}, "num_episodes": 18, "episode_return_max": 998.0, "episode_return_min": 155.0, "episode_return_mean": 577.73}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.589227523629688, "num_env_steps_trained_throughput_per_sec": 21.589227523629688, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 185288.221, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185288.172, "sample_time_ms": 2533.966, "learn_time_ms": 182734.642, "learn_throughput": 21.89, "synch_weights_time_ms": 11.902}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "a22d3_00000", "date": "2024-08-06_04-54-56", "timestamp": 1722934496, "time_this_iter_s": 185.28851079940796, "time_total_s": 22287.508404493332, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a20b25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22287.508404493332, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 17.967557251908396, "ram_util_percent": 75.11412213740459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.896513594225192, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.450921799351994, "policy_loss": -0.010516761966035786, "vf_loss": 6.458586903400441, "vf_explained_var": 0.00485083241813099, "kl": 0.005007037036828984, "entropy": 0.5445263304046422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1073.0, "episode_reward_min": 155.0, "episode_reward_mean": 569.68, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -47.0}, "policy_reward_max": {"policy_0": 170.0}, "policy_reward_mean": {"policy_0": 56.968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [461.0, 628.0, 569.0, 430.0, 750.0, 426.0, 286.0, 532.0, 675.0, 635.0, 394.0, 498.0, 327.0, 745.0, 577.0, 660.0, 728.0, 640.0, 583.0, 590.0, 358.0, 590.0, 402.0, 599.0, 904.0, 640.0, 898.0, 375.0, 347.0, 398.0, 480.0, 491.0, 547.0, 417.0, 591.0, 657.0, 518.0, 726.0, 883.0, 620.0, 462.0, 596.0, 650.0, 767.0, 485.0, 539.0, 644.0, 590.0, 679.0, 650.0, 155.0, 577.0, 273.0, 394.0, 690.0, 560.0, 465.0, 554.0, 190.0, 703.0, 692.0, 276.0, 549.0, 652.0, 750.0, 585.0, 777.0, 428.0, 507.0, 595.0, 640.0, 547.0, 668.0, 585.0, 836.0, 640.0, 439.0, 374.0, 650.0, 450.0, 498.0, 470.0, 645.0, 398.0, 660.0, 1073.0, 620.0, 488.0, 708.0, 260.0, 650.0, 558.0, 762.0, 628.0, 660.0, 694.0, 550.0, 720.0, 554.0, 534.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 12.0, 70.0, 40.0, -15.0, 30.0, 30.0, 34.0, 30.0, 130.0, 70.0, 20.0, 80.0, 40.0, 28.0, 100.0, 40.0, 90.0, 30.0, 130.0, 50.0, 100.0, 100.0, 30.0, 70.0, 40.0, 30.0, 70.0, 50.0, 29.0, 30.0, 50.0, 10.0, 80.0, 50.0, 70.0, -10.0, 60.0, 70.0, 20.0, 70.0, 100.0, 80.0, 90.0, 70.0, 100.0, 90.0, 20.0, 70.0, 60.0, 48.0, 110.0, 40.0, 0.0, 90.0, 80.0, 0.0, 20.0, 18.0, 20.0, 40.0, 40.0, 50.0, 30.0, 35.0, 30.0, 40.0, -14.0, 35.0, 0.0, 40.0, 70.0, 26.0, 40.0, 6.0, 40.0, 100.0, 30.0, 90.0, 90.0, 50.0, 90.0, 83.0, 40.0, 80.0, 110.0, 30.0, 10.0, 160.0, 22.0, 80.0, 50.0, 50.0, 25.0, 0.0, 90.0, 20.0, 130.0, 40.0, 150.0, -3.0, 140.0, 50.0, 20.0, 120.0, -6.0, 13.0, 30.0, 10.0, 20.0, 60.0, 20.0, -1.0, 37.0, 70.0, 90.0, 60.0, 52.0, 10.0, 100.0, 31.0, 0.0, 13.0, 60.0, 70.0, 20.0, 30.0, 56.0, 27.0, 20.0, 80.0, 150.0, 69.0, 90.0, 46.0, 90.0, 40.0, 90.0, 10.0, 80.0, 50.0, 64.0, 73.0, 90.0, 30.0, 50.0, 20.0, 90.0, 0.0, 110.0, 90.0, 130.0, 30.0, 20.0, 110.0, 60.0, 70.0, 60.0, 50.0, 40.0, 100.0, 24.0, 110.0, 50.0, 60.0, 110.0, 60.0, 74.0, 40.0, 100.0, 80.0, 50.0, 20.0, 80.0, 40.0, 60.0, 70.0, 80.0, 90.0, 70.0, 58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0, 60.0, 70.0, 70.0, 50.0, 50.0, 40.0, 30.0, 60.0, 100.0, 60.0, 120.0, -9.0, 40.0, 70.0, 50.0, -3.0, 40.0, 30.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 40.0, 20.0, 60.0, 110.0, 60.0, 90.0, 80.0, 0.0, 40.0, 50.0, 80.0, 80.0, 50.0, -9.0, 10.0, 21.0, 100.0, 10.0, -10.0, 90.0, 60.0, 19.0, 130.0, 130.0, 70.0, 0.0, 74.0, 90.0, 100.0, 60.0, 80.0, 100.0, 104.0, 86.0, 140.0, 70.0, 90.0, 70.0, 90.0, 10.0, 140.0, 50.0, 50.0, 60.0, 30.0, 50.0, 90.0, 78.0, 50.0, 150.0, 100.0, 70.0, 60.0, 140.0, 110.0, 50.0, 50.0, 70.0, 40.0, 20.0, 24.0, 10.0, 20.0, 80.0, 21.0, 40.0, 80.0, 52.0, 20.0, 10.0, 20.0, 32.0, 12.0, 20.0, 41.0, 60.0, 78.0, 30.0, 70.0, 5.0, 80.0, 40.0, 50.0, 0.0, -15.0, 60.0, 60.0, 50.0, 50.0, 80.0, 40.0, 30.0, 50.0, 80.0, 20.0, 20.0, 80.0, 100.0, -3.0, 50.0, 90.0, 40.0, 80.0, 15.0, 29.0, 10.0, 11.0, 130.0, 16.0, 40.0, 31.0, 60.0, 70.0, 40.0, 100.0, 49.0, 49.0, 40.0, 20.0, 80.0, 10.0, 20.0, 60.0, 30.0, -2.0, 110.0, 36.0, 30.0, 125.0, 80.0, 130.0, 50.0, 90.0, 20.0, -10.0, 40.0, 58.0, 150.0, 50.0, 50.0, 60.0, 40.0, 50.0, 79.0, 20.0, 100.0, 50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0, 100.0, 80.0, 90.0, 60.0, 35.0, 18.0, 123.0, 20.0, 120.0, 80.0, 60.0, 40.0, 120.0, 60.0, 22.0, 158.0, 145.0, 160.0, 30.0, 88.0, 70.0, 50.0, 65.0, 118.0, 80.0, 17.0, 60.0, 20.0, 80.0, 60.0, 150.0, 108.0, 11.0, 30.0, 20.0, 24.0, 30.0, 19.0, 50.0, 20.0, 20.0, 110.0, 99.0, 20.0, 90.0, 57.0, 40.0, 0.0, 50.0, 110.0, 50.0, 100.0, 40.0, 30.0, 120.0, 50.0, 60.0, 70.0, 60.0, 70.0, 130.0, 70.0, 80.0, 90.0, 60.0, 109.0, -12.0, 120.0, 40.0, 80.0, 25.0, 90.0, 50.0, 30.0, 20.0, 20.0, 100.0, 20.0, 60.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 20.0, 70.0, 50.0, 20.0, -1.0, 60.0, 140.0, 50.0, 70.0, -14.0, 100.0, 60.0, 48.0, 50.0, 80.0, 80.0, 80.0, 100.0, 110.0, 90.0, 10.0, 20.0, 0.0, 50.0, 50.0, 40.0, 50.0, 40.0, 20.0, 128.0, 130.0, 56.0, 98.0, 70.0, 47.0, 25.0, 80.0, 70.0, 110.0, 70.0, 90.0, 70.0, 25.0, 30.0, 80.0, 13.0, 0.0, 10.0, 0.0, 0.0, 32.0, 10.0, 30.0, 30.0, 30.0, 40.0, 59.0, 30.0, 70.0, 110.0, 80.0, 30.0, 60.0, 30.0, 68.0, 40.0, 60.0, 38.0, 15.0, -7.0, 30.0, 20.0, -13.0, 50.0, 40.0, 50.0, 60.0, 20.0, 39.0, 90.0, 20.0, 30.0, 90.0, -5.0, 0.0, 90.0, 60.0, 100.0, 100.0, 30.0, 100.0, 60.0, 80.0, 40.0, 30.0, 100.0, 80.0, 40.0, -7.0, 29.0, 110.0, 60.0, -12.0, 60.0, 100.0, 40.0, 2.0, 70.0, 100.0, 120.0, -39.0, 30.0, 32.0, 60.0, 50.0, 100.0, 50.0, 50.0, 90.0, 100.0, 50.0, 20.0, 22.0, 60.0, 12.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 0.0, 70.0, 30.0, 10.0, 90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0, 63.0, 100.0, 50.0, 30.0, 80.0, 120.0, 70.0, 40.0, 20.0, 119.0, 40.0, 29.0, 50.0, 20.0, 8.0, 20.0, 30.0, 40.0, 39.0, 0.0, 4.0, 90.0, 32.0, 100.0, 65.0, 50.0, 51.0, 58.0, 29.0, 70.0, 100.0, 130.0, -25.0, 50.0, 100.0, 40.0, 70.0, 20.0, 107.0, 60.0, 80.0, 100.0, 40.0, 80.0, 150.0, 80.0, 20.0, 110.0, 50.0, 40.0, 30.0, 130.0, 15.0, 90.0, 70.0, 20.0, 70.0, 70.0, 70.0, 20.0, 50.0, 140.0, 100.0, 110.0, 90.0, 30.0, 8.0, 39.0, 70.0, 140.0, 60.0, 30.0, 30.0, 80.0, 49.0, 70.0, 70.0, -10.0, 30.0, 19.0, 20.0, 44.0, 60.0, 70.0, 10.0, 40.0, 50.0, 60.0, 83.0, 70.0, 50.0, 80.0, 90.0, 90.0, 90.0, 40.0, 60.0, 60.0, 17.0, 18.0, 130.0, 40.0, 90.0, 70.0, 60.0, 110.0, 20.0, 40.0, 20.0, 60.0, 100.0, 100.0, 90.0, 30.0, 50.0, 100.0, 50.0, 19.0, 25.0, -17.0, 80.0, 60.0, 60.0, 100.0, 40.0, 9.0, 29.0, 140.0, 80.0, 70.0, 10.0, 120.0, 110.0, 68.0, 39.0, 42.0, 30.0, 30.0, 90.0, 46.0, 9.0, 90.0, 50.0, 110.0, 150.0, 30.0, 67.0, 140.0, 100.0, 90.0, 60.0, 40.0, 60.0, 60.0, 120.0, 40.0, 30.0, 70.0, 80.0, 80.0, 50.0, 80.0, 30.0, 30.0, 20.0, 80.0, 70.0, -1.0, 40.0, 40.0, 47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0, 120.0, 40.0, 110.0, 40.0, 30.0, 50.0, 40.0, 20.0, 100.0, 100.0, 14.0, -4.0, 110.0, 60.0, 80.0, 20.0, 40.0, 80.0, 20.0, 30.0, 50.0, 40.0, 39.0, 19.0, 20.0, 60.0, 70.0, 110.0, 30.0, 60.0, 10.0, 100.0, 30.0, 30.0, 30.0, 40.0, 40.0, 70.0, 30.0, 90.0, 30.0, 61.0, 50.0, 40.0, 70.0, 120.0, 24.0, 140.0, 70.0, 40.0, 40.0, 8.0, -9.0, 30.0, 49.0, 40.0, 20.0, 60.0, 90.0, 70.0, 80.0, 50.0, 100.0, 20.0, 100.0, 70.0, 90.0, 40.0, 50.0, 60.0, 150.0, 75.0, 130.0, 90.0, 80.0, 100.0, 110.0, 158.0, 150.0, 30.0, 90.0, 90.0, 100.0, 50.0, 80.0, 40.0, 10.0, 80.0, 60.0, 20.0, 120.0, 70.0, 51.0, 70.0, 50.0, 100.0, -28.0, 42.0, -47.0, 60.0, 60.0, 1.0, 59.0, 120.0, 68.0, 100.0, 100.0, 60.0, 90.0, 50.0, 10.0, -14.0, 38.0, 40.0, 9.0, 50.0, 2.0, 15.0, 90.0, 20.0, 110.0, 20.0, 170.0, 50.0, 40.0, 30.0, 30.0, 70.0, 50.0, 80.0, 120.0, 4.0, 50.0, 49.0, 60.0, 70.0, 70.0, 55.0, 30.0, 50.0, 66.0, 30.0, 130.0, 91.0, 45.0, 20.0, 80.0, 130.0, 70.0, 100.0, 40.0, 110.0, 40.0, 120.0, 50.0, 80.0, 50.0, 90.0, 18.0, 30.0, 110.0, 100.0, 0.0, 60.0, 40.0, 110.0, 20.0, 10.0, 110.0, 100.0, 59.0, 28.0, 90.0, 107.0, 70.0, 70.0, 90.0, 60.0, 80.0, 40.0, 20.0, 30.0, 50.0, 110.0, 80.0, 40.0, 50.0, 80.0, 70.0, 20.0, 60.0, 30.0, 70.0, 150.0, 40.0, 120.0, 30.0, 140.0, 30.0, 50.0, 30.0, 28.0, 30.0, 26.0, 50.0, 30.0, 60.0, 90.0, 120.0, 90.0, 105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5372930909494773, "mean_inference_ms": 1.5449347636842674, "mean_action_processing_ms": 0.49139228976873556, "mean_env_wait_ms": 1.3491746086639673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012768983840942383, "StateBufferConnector_ms": 0.00917816162109375, "ViewRequirementAgentConnector_ms": 0.3804168701171875}, "num_episodes": 22, "episode_return_max": 1073.0, "episode_return_min": 155.0, "episode_return_mean": 569.68}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.655745822525592, "num_env_steps_trained_throughput_per_sec": 21.655745822525592, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 185444.308, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185444.261, "sample_time_ms": 2546.028, "learn_time_ms": 182878.582, "learn_throughput": 21.872, "synch_weights_time_ms": 11.906}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "a22d3_00000", "date": "2024-08-06_04-58-01", "timestamp": 1722934681, "time_this_iter_s": 184.71742510795593, "time_total_s": 22472.225829601288, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a2231280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22472.225829601288, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 18.76221374045802, "ram_util_percent": 75.42786259541985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.887227994520951, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010078428276984122, "vf_loss": 6.795532924908038, "vf_explained_var": 0.010660948229039185, "kl": Infinity, "entropy": 0.5293827969489641, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1073.0, "episode_reward_min": 155.0, "episode_reward_mean": 578.79, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -54.0}, "policy_reward_max": {"policy_0": 184.0}, "policy_reward_mean": {"policy_0": 57.879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [583.0, 590.0, 358.0, 590.0, 402.0, 599.0, 904.0, 640.0, 898.0, 375.0, 347.0, 398.0, 480.0, 491.0, 547.0, 417.0, 591.0, 657.0, 518.0, 726.0, 883.0, 620.0, 462.0, 596.0, 650.0, 767.0, 485.0, 539.0, 644.0, 590.0, 679.0, 650.0, 155.0, 577.0, 273.0, 394.0, 690.0, 560.0, 465.0, 554.0, 190.0, 703.0, 692.0, 276.0, 549.0, 652.0, 750.0, 585.0, 777.0, 428.0, 507.0, 595.0, 640.0, 547.0, 668.0, 585.0, 836.0, 640.0, 439.0, 374.0, 650.0, 450.0, 498.0, 470.0, 645.0, 398.0, 660.0, 1073.0, 620.0, 488.0, 708.0, 260.0, 650.0, 558.0, 762.0, 628.0, 660.0, 694.0, 550.0, 720.0, 554.0, 534.0, 556.0, 632.0, 620.0, 711.0, 630.0, 446.0, 585.0, 551.0, 740.0, 722.0, 667.0, 640.0, 690.0, 530.0, 645.0, 370.0, 707.0, 430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [58.0, 80.0, 40.0, 40.0, 70.0, 40.0, 40.0, 30.0, 65.0, 120.0, 60.0, 70.0, 70.0, 50.0, 50.0, 40.0, 30.0, 60.0, 100.0, 60.0, 120.0, -9.0, 40.0, 70.0, 50.0, -3.0, 40.0, 30.0, 0.0, 20.0, 80.0, 60.0, 20.0, 50.0, 40.0, 20.0, 60.0, 110.0, 60.0, 90.0, 80.0, 0.0, 40.0, 50.0, 80.0, 80.0, 50.0, -9.0, 10.0, 21.0, 100.0, 10.0, -10.0, 90.0, 60.0, 19.0, 130.0, 130.0, 70.0, 0.0, 74.0, 90.0, 100.0, 60.0, 80.0, 100.0, 104.0, 86.0, 140.0, 70.0, 90.0, 70.0, 90.0, 10.0, 140.0, 50.0, 50.0, 60.0, 30.0, 50.0, 90.0, 78.0, 50.0, 150.0, 100.0, 70.0, 60.0, 140.0, 110.0, 50.0, 50.0, 70.0, 40.0, 20.0, 24.0, 10.0, 20.0, 80.0, 21.0, 40.0, 80.0, 52.0, 20.0, 10.0, 20.0, 32.0, 12.0, 20.0, 41.0, 60.0, 78.0, 30.0, 70.0, 5.0, 80.0, 40.0, 50.0, 0.0, -15.0, 60.0, 60.0, 50.0, 50.0, 80.0, 40.0, 30.0, 50.0, 80.0, 20.0, 20.0, 80.0, 100.0, -3.0, 50.0, 90.0, 40.0, 80.0, 15.0, 29.0, 10.0, 11.0, 130.0, 16.0, 40.0, 31.0, 60.0, 70.0, 40.0, 100.0, 49.0, 49.0, 40.0, 20.0, 80.0, 10.0, 20.0, 60.0, 30.0, -2.0, 110.0, 36.0, 30.0, 125.0, 80.0, 130.0, 50.0, 90.0, 20.0, -10.0, 40.0, 58.0, 150.0, 50.0, 50.0, 60.0, 40.0, 50.0, 79.0, 20.0, 100.0, 50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0, 100.0, 80.0, 90.0, 60.0, 35.0, 18.0, 123.0, 20.0, 120.0, 80.0, 60.0, 40.0, 120.0, 60.0, 22.0, 158.0, 145.0, 160.0, 30.0, 88.0, 70.0, 50.0, 65.0, 118.0, 80.0, 17.0, 60.0, 20.0, 80.0, 60.0, 150.0, 108.0, 11.0, 30.0, 20.0, 24.0, 30.0, 19.0, 50.0, 20.0, 20.0, 110.0, 99.0, 20.0, 90.0, 57.0, 40.0, 0.0, 50.0, 110.0, 50.0, 100.0, 40.0, 30.0, 120.0, 50.0, 60.0, 70.0, 60.0, 70.0, 130.0, 70.0, 80.0, 90.0, 60.0, 109.0, -12.0, 120.0, 40.0, 80.0, 25.0, 90.0, 50.0, 30.0, 20.0, 20.0, 100.0, 20.0, 60.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 20.0, 70.0, 50.0, 20.0, -1.0, 60.0, 140.0, 50.0, 70.0, -14.0, 100.0, 60.0, 48.0, 50.0, 80.0, 80.0, 80.0, 100.0, 110.0, 90.0, 10.0, 20.0, 0.0, 50.0, 50.0, 40.0, 50.0, 40.0, 20.0, 128.0, 130.0, 56.0, 98.0, 70.0, 47.0, 25.0, 80.0, 70.0, 110.0, 70.0, 90.0, 70.0, 25.0, 30.0, 80.0, 13.0, 0.0, 10.0, 0.0, 0.0, 32.0, 10.0, 30.0, 30.0, 30.0, 40.0, 59.0, 30.0, 70.0, 110.0, 80.0, 30.0, 60.0, 30.0, 68.0, 40.0, 60.0, 38.0, 15.0, -7.0, 30.0, 20.0, -13.0, 50.0, 40.0, 50.0, 60.0, 20.0, 39.0, 90.0, 20.0, 30.0, 90.0, -5.0, 0.0, 90.0, 60.0, 100.0, 100.0, 30.0, 100.0, 60.0, 80.0, 40.0, 30.0, 100.0, 80.0, 40.0, -7.0, 29.0, 110.0, 60.0, -12.0, 60.0, 100.0, 40.0, 2.0, 70.0, 100.0, 120.0, -39.0, 30.0, 32.0, 60.0, 50.0, 100.0, 50.0, 50.0, 90.0, 100.0, 50.0, 20.0, 22.0, 60.0, 12.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 0.0, 70.0, 30.0, 10.0, 90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0, 63.0, 100.0, 50.0, 30.0, 80.0, 120.0, 70.0, 40.0, 20.0, 119.0, 40.0, 29.0, 50.0, 20.0, 8.0, 20.0, 30.0, 40.0, 39.0, 0.0, 4.0, 90.0, 32.0, 100.0, 65.0, 50.0, 51.0, 58.0, 29.0, 70.0, 100.0, 130.0, -25.0, 50.0, 100.0, 40.0, 70.0, 20.0, 107.0, 60.0, 80.0, 100.0, 40.0, 80.0, 150.0, 80.0, 20.0, 110.0, 50.0, 40.0, 30.0, 130.0, 15.0, 90.0, 70.0, 20.0, 70.0, 70.0, 70.0, 20.0, 50.0, 140.0, 100.0, 110.0, 90.0, 30.0, 8.0, 39.0, 70.0, 140.0, 60.0, 30.0, 30.0, 80.0, 49.0, 70.0, 70.0, -10.0, 30.0, 19.0, 20.0, 44.0, 60.0, 70.0, 10.0, 40.0, 50.0, 60.0, 83.0, 70.0, 50.0, 80.0, 90.0, 90.0, 90.0, 40.0, 60.0, 60.0, 17.0, 18.0, 130.0, 40.0, 90.0, 70.0, 60.0, 110.0, 20.0, 40.0, 20.0, 60.0, 100.0, 100.0, 90.0, 30.0, 50.0, 100.0, 50.0, 19.0, 25.0, -17.0, 80.0, 60.0, 60.0, 100.0, 40.0, 9.0, 29.0, 140.0, 80.0, 70.0, 10.0, 120.0, 110.0, 68.0, 39.0, 42.0, 30.0, 30.0, 90.0, 46.0, 9.0, 90.0, 50.0, 110.0, 150.0, 30.0, 67.0, 140.0, 100.0, 90.0, 60.0, 40.0, 60.0, 60.0, 120.0, 40.0, 30.0, 70.0, 80.0, 80.0, 50.0, 80.0, 30.0, 30.0, 20.0, 80.0, 70.0, -1.0, 40.0, 40.0, 47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0, 120.0, 40.0, 110.0, 40.0, 30.0, 50.0, 40.0, 20.0, 100.0, 100.0, 14.0, -4.0, 110.0, 60.0, 80.0, 20.0, 40.0, 80.0, 20.0, 30.0, 50.0, 40.0, 39.0, 19.0, 20.0, 60.0, 70.0, 110.0, 30.0, 60.0, 10.0, 100.0, 30.0, 30.0, 30.0, 40.0, 40.0, 70.0, 30.0, 90.0, 30.0, 61.0, 50.0, 40.0, 70.0, 120.0, 24.0, 140.0, 70.0, 40.0, 40.0, 8.0, -9.0, 30.0, 49.0, 40.0, 20.0, 60.0, 90.0, 70.0, 80.0, 50.0, 100.0, 20.0, 100.0, 70.0, 90.0, 40.0, 50.0, 60.0, 150.0, 75.0, 130.0, 90.0, 80.0, 100.0, 110.0, 158.0, 150.0, 30.0, 90.0, 90.0, 100.0, 50.0, 80.0, 40.0, 10.0, 80.0, 60.0, 20.0, 120.0, 70.0, 51.0, 70.0, 50.0, 100.0, -28.0, 42.0, -47.0, 60.0, 60.0, 1.0, 59.0, 120.0, 68.0, 100.0, 100.0, 60.0, 90.0, 50.0, 10.0, -14.0, 38.0, 40.0, 9.0, 50.0, 2.0, 15.0, 90.0, 20.0, 110.0, 20.0, 170.0, 50.0, 40.0, 30.0, 30.0, 70.0, 50.0, 80.0, 120.0, 4.0, 50.0, 49.0, 60.0, 70.0, 70.0, 55.0, 30.0, 50.0, 66.0, 30.0, 130.0, 91.0, 45.0, 20.0, 80.0, 130.0, 70.0, 100.0, 40.0, 110.0, 40.0, 120.0, 50.0, 80.0, 50.0, 90.0, 18.0, 30.0, 110.0, 100.0, 0.0, 60.0, 40.0, 110.0, 20.0, 10.0, 110.0, 100.0, 59.0, 28.0, 90.0, 107.0, 70.0, 70.0, 90.0, 60.0, 80.0, 40.0, 20.0, 30.0, 50.0, 110.0, 80.0, 40.0, 50.0, 80.0, 70.0, 20.0, 60.0, 30.0, 70.0, 150.0, 40.0, 120.0, 30.0, 140.0, 30.0, 50.0, 30.0, 28.0, 30.0, 26.0, 50.0, 30.0, 60.0, 90.0, 120.0, 90.0, 105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0, 90.0, 63.0, 60.0, 83.0, 50.0, 30.0, 30.0, 40.0, 10.0, 100.0, 40.0, 34.0, 48.0, 80.0, 60.0, 50.0, 120.0, 110.0, 30.0, 60.0, 10.0, 100.0, 70.0, 20.0, 30.0, 100.0, 16.0, 50.0, 184.0, 40.0, 140.0, 30.0, 110.0, 110.0, 23.0, 80.0, 40.0, 70.0, -2.0, 110.0, 110.0, 20.0, 40.0, 80.0, 90.0, 80.0, 110.0, 10.0, 60.0, 30.0, 81.0, 60.0, 50.0, 47.0, 11.0, 20.0, 11.0, 70.0, -54.0, 150.0, 100.0, 50.0, 30.0, 60.0, 70.0, 85.0, 0.0, 70.0, 60.0, 60.0, 30.0, 24.0, 130.0, 110.0, 30.0, 20.0, 90.0, 20.0, 17.0, 80.0, 70.0, 30.0, 130.0, 60.0, 80.0, 100.0, 10.0, 100.0, 90.0, 70.0, 50.0, 44.0, 130.0, 100.0, 60.0, 60.0, 24.0, 150.0, 44.0, 60.0, 120.0, 110.0, 13.0, 50.0, 90.0, 100.0, 15.0, 150.0, 18.0, 1.0, 70.0, 70.0, 20.0, 80.0, 120.0, 20.0, 120.0, 40.0, 50.0, 50.0, 90.0, 70.0, 50.0, 40.0, 80.0, 30.0, 90.0, 60.0, 140.0, 40.0, -4.0, 30.0, 30.0, 50.0, 80.0, 44.0, 60.0, 110.0, 90.0, 40.0, 30.0, 45.0, 60.0, 40.0, 70.0, 110.0, 150.0, 50.0, 80.0, 10.0, 40.0, 40.0, 30.0, 0.0, 120.0, 30.0, 30.0, 40.0, 20.0, 20.0, 50.0, 50.0, 110.0, 120.0, 80.0, 80.0, 80.0, 7.0, 110.0, 20.0, 100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5369176760772947, "mean_inference_ms": 1.544493103155995, "mean_action_processing_ms": 0.49104185816158813, "mean_env_wait_ms": 1.3481265172057761, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227259635925293, "StateBufferConnector_ms": 0.008895635604858398, "ViewRequirementAgentConnector_ms": 0.3708007335662842}, "num_episodes": 18, "episode_return_max": 1073.0, "episode_return_min": 155.0, "episode_return_mean": 578.79}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.527671958954972, "num_env_steps_trained_throughput_per_sec": 21.527671958954972, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 185608.543, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185608.495, "sample_time_ms": 2550.733, "learn_time_ms": 183038.518, "learn_throughput": 21.853, "synch_weights_time_ms": 11.566}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "a22d3_00000", "date": "2024-08-06_05-01-07", "timestamp": 1722934867, "time_this_iter_s": 185.8140459060669, "time_total_s": 22658.039875507355, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22658.039875507355, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 20.41793893129771, "ram_util_percent": 75.9648854961832}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9039822484484623, "cur_kl_coeff": 0.8542968749999998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010612007917457433, "vf_loss": 6.4191777552278655, "vf_explained_var": 0.011903271666223122, "kl": Infinity, "entropy": 0.5498060623836467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1073.0, "episode_reward_min": 155.0, "episode_reward_mean": 595.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 184.0}, "policy_reward_mean": {"policy_0": 59.581}, "custom_metrics": {}, "hist_stats": {"episode_reward": [518.0, 726.0, 883.0, 620.0, 462.0, 596.0, 650.0, 767.0, 485.0, 539.0, 644.0, 590.0, 679.0, 650.0, 155.0, 577.0, 273.0, 394.0, 690.0, 560.0, 465.0, 554.0, 190.0, 703.0, 692.0, 276.0, 549.0, 652.0, 750.0, 585.0, 777.0, 428.0, 507.0, 595.0, 640.0, 547.0, 668.0, 585.0, 836.0, 640.0, 439.0, 374.0, 650.0, 450.0, 498.0, 470.0, 645.0, 398.0, 660.0, 1073.0, 620.0, 488.0, 708.0, 260.0, 650.0, 558.0, 762.0, 628.0, 660.0, 694.0, 550.0, 720.0, 554.0, 534.0, 556.0, 632.0, 620.0, 711.0, 630.0, 446.0, 585.0, 551.0, 740.0, 722.0, 667.0, 640.0, 690.0, 530.0, 645.0, 370.0, 707.0, 430.0, 566.0, 559.0, 787.0, 585.0, 633.0, 441.0, 690.0, 738.0, 339.0, 494.0, 550.0, 461.0, 605.0, 940.0, 611.0, 1020.0, 969.0, 581.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 40.0, 79.0, 40.0, 20.0, 50.0, 70.0, 60.0, 40.0, 69.0, 100.0, 80.0, 90.0, 60.0, 35.0, 18.0, 123.0, 20.0, 120.0, 80.0, 60.0, 40.0, 120.0, 60.0, 22.0, 158.0, 145.0, 160.0, 30.0, 88.0, 70.0, 50.0, 65.0, 118.0, 80.0, 17.0, 60.0, 20.0, 80.0, 60.0, 150.0, 108.0, 11.0, 30.0, 20.0, 24.0, 30.0, 19.0, 50.0, 20.0, 20.0, 110.0, 99.0, 20.0, 90.0, 57.0, 40.0, 0.0, 50.0, 110.0, 50.0, 100.0, 40.0, 30.0, 120.0, 50.0, 60.0, 70.0, 60.0, 70.0, 130.0, 70.0, 80.0, 90.0, 60.0, 109.0, -12.0, 120.0, 40.0, 80.0, 25.0, 90.0, 50.0, 30.0, 20.0, 20.0, 100.0, 20.0, 60.0, 70.0, 40.0, 60.0, 110.0, 120.0, 50.0, 20.0, 70.0, 50.0, 20.0, -1.0, 60.0, 140.0, 50.0, 70.0, -14.0, 100.0, 60.0, 48.0, 50.0, 80.0, 80.0, 80.0, 100.0, 110.0, 90.0, 10.0, 20.0, 0.0, 50.0, 50.0, 40.0, 50.0, 40.0, 20.0, 128.0, 130.0, 56.0, 98.0, 70.0, 47.0, 25.0, 80.0, 70.0, 110.0, 70.0, 90.0, 70.0, 25.0, 30.0, 80.0, 13.0, 0.0, 10.0, 0.0, 0.0, 32.0, 10.0, 30.0, 30.0, 30.0, 40.0, 59.0, 30.0, 70.0, 110.0, 80.0, 30.0, 60.0, 30.0, 68.0, 40.0, 60.0, 38.0, 15.0, -7.0, 30.0, 20.0, -13.0, 50.0, 40.0, 50.0, 60.0, 20.0, 39.0, 90.0, 20.0, 30.0, 90.0, -5.0, 0.0, 90.0, 60.0, 100.0, 100.0, 30.0, 100.0, 60.0, 80.0, 40.0, 30.0, 100.0, 80.0, 40.0, -7.0, 29.0, 110.0, 60.0, -12.0, 60.0, 100.0, 40.0, 2.0, 70.0, 100.0, 120.0, -39.0, 30.0, 32.0, 60.0, 50.0, 100.0, 50.0, 50.0, 90.0, 100.0, 50.0, 20.0, 22.0, 60.0, 12.0, 10.0, 20.0, 10.0, 0.0, 30.0, 10.0, 0.0, 70.0, 30.0, 10.0, 90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0, 63.0, 100.0, 50.0, 30.0, 80.0, 120.0, 70.0, 40.0, 20.0, 119.0, 40.0, 29.0, 50.0, 20.0, 8.0, 20.0, 30.0, 40.0, 39.0, 0.0, 4.0, 90.0, 32.0, 100.0, 65.0, 50.0, 51.0, 58.0, 29.0, 70.0, 100.0, 130.0, -25.0, 50.0, 100.0, 40.0, 70.0, 20.0, 107.0, 60.0, 80.0, 100.0, 40.0, 80.0, 150.0, 80.0, 20.0, 110.0, 50.0, 40.0, 30.0, 130.0, 15.0, 90.0, 70.0, 20.0, 70.0, 70.0, 70.0, 20.0, 50.0, 140.0, 100.0, 110.0, 90.0, 30.0, 8.0, 39.0, 70.0, 140.0, 60.0, 30.0, 30.0, 80.0, 49.0, 70.0, 70.0, -10.0, 30.0, 19.0, 20.0, 44.0, 60.0, 70.0, 10.0, 40.0, 50.0, 60.0, 83.0, 70.0, 50.0, 80.0, 90.0, 90.0, 90.0, 40.0, 60.0, 60.0, 17.0, 18.0, 130.0, 40.0, 90.0, 70.0, 60.0, 110.0, 20.0, 40.0, 20.0, 60.0, 100.0, 100.0, 90.0, 30.0, 50.0, 100.0, 50.0, 19.0, 25.0, -17.0, 80.0, 60.0, 60.0, 100.0, 40.0, 9.0, 29.0, 140.0, 80.0, 70.0, 10.0, 120.0, 110.0, 68.0, 39.0, 42.0, 30.0, 30.0, 90.0, 46.0, 9.0, 90.0, 50.0, 110.0, 150.0, 30.0, 67.0, 140.0, 100.0, 90.0, 60.0, 40.0, 60.0, 60.0, 120.0, 40.0, 30.0, 70.0, 80.0, 80.0, 50.0, 80.0, 30.0, 30.0, 20.0, 80.0, 70.0, -1.0, 40.0, 40.0, 47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0, 120.0, 40.0, 110.0, 40.0, 30.0, 50.0, 40.0, 20.0, 100.0, 100.0, 14.0, -4.0, 110.0, 60.0, 80.0, 20.0, 40.0, 80.0, 20.0, 30.0, 50.0, 40.0, 39.0, 19.0, 20.0, 60.0, 70.0, 110.0, 30.0, 60.0, 10.0, 100.0, 30.0, 30.0, 30.0, 40.0, 40.0, 70.0, 30.0, 90.0, 30.0, 61.0, 50.0, 40.0, 70.0, 120.0, 24.0, 140.0, 70.0, 40.0, 40.0, 8.0, -9.0, 30.0, 49.0, 40.0, 20.0, 60.0, 90.0, 70.0, 80.0, 50.0, 100.0, 20.0, 100.0, 70.0, 90.0, 40.0, 50.0, 60.0, 150.0, 75.0, 130.0, 90.0, 80.0, 100.0, 110.0, 158.0, 150.0, 30.0, 90.0, 90.0, 100.0, 50.0, 80.0, 40.0, 10.0, 80.0, 60.0, 20.0, 120.0, 70.0, 51.0, 70.0, 50.0, 100.0, -28.0, 42.0, -47.0, 60.0, 60.0, 1.0, 59.0, 120.0, 68.0, 100.0, 100.0, 60.0, 90.0, 50.0, 10.0, -14.0, 38.0, 40.0, 9.0, 50.0, 2.0, 15.0, 90.0, 20.0, 110.0, 20.0, 170.0, 50.0, 40.0, 30.0, 30.0, 70.0, 50.0, 80.0, 120.0, 4.0, 50.0, 49.0, 60.0, 70.0, 70.0, 55.0, 30.0, 50.0, 66.0, 30.0, 130.0, 91.0, 45.0, 20.0, 80.0, 130.0, 70.0, 100.0, 40.0, 110.0, 40.0, 120.0, 50.0, 80.0, 50.0, 90.0, 18.0, 30.0, 110.0, 100.0, 0.0, 60.0, 40.0, 110.0, 20.0, 10.0, 110.0, 100.0, 59.0, 28.0, 90.0, 107.0, 70.0, 70.0, 90.0, 60.0, 80.0, 40.0, 20.0, 30.0, 50.0, 110.0, 80.0, 40.0, 50.0, 80.0, 70.0, 20.0, 60.0, 30.0, 70.0, 150.0, 40.0, 120.0, 30.0, 140.0, 30.0, 50.0, 30.0, 28.0, 30.0, 26.0, 50.0, 30.0, 60.0, 90.0, 120.0, 90.0, 105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0, 90.0, 63.0, 60.0, 83.0, 50.0, 30.0, 30.0, 40.0, 10.0, 100.0, 40.0, 34.0, 48.0, 80.0, 60.0, 50.0, 120.0, 110.0, 30.0, 60.0, 10.0, 100.0, 70.0, 20.0, 30.0, 100.0, 16.0, 50.0, 184.0, 40.0, 140.0, 30.0, 110.0, 110.0, 23.0, 80.0, 40.0, 70.0, -2.0, 110.0, 110.0, 20.0, 40.0, 80.0, 90.0, 80.0, 110.0, 10.0, 60.0, 30.0, 81.0, 60.0, 50.0, 47.0, 11.0, 20.0, 11.0, 70.0, -54.0, 150.0, 100.0, 50.0, 30.0, 60.0, 70.0, 85.0, 0.0, 70.0, 60.0, 60.0, 30.0, 24.0, 130.0, 110.0, 30.0, 20.0, 90.0, 20.0, 17.0, 80.0, 70.0, 30.0, 130.0, 60.0, 80.0, 100.0, 10.0, 100.0, 90.0, 70.0, 50.0, 44.0, 130.0, 100.0, 60.0, 60.0, 24.0, 150.0, 44.0, 60.0, 120.0, 110.0, 13.0, 50.0, 90.0, 100.0, 15.0, 150.0, 18.0, 1.0, 70.0, 70.0, 20.0, 80.0, 120.0, 20.0, 120.0, 40.0, 50.0, 50.0, 90.0, 70.0, 50.0, 40.0, 80.0, 30.0, 90.0, 60.0, 140.0, 40.0, -4.0, 30.0, 30.0, 50.0, 80.0, 44.0, 60.0, 110.0, 90.0, 40.0, 30.0, 45.0, 60.0, 40.0, 70.0, 110.0, 150.0, 50.0, 80.0, 10.0, 40.0, 40.0, 30.0, 0.0, 120.0, 30.0, 30.0, 40.0, 20.0, 20.0, 50.0, 50.0, 110.0, 120.0, 80.0, 80.0, 80.0, 7.0, 110.0, 20.0, 100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0, 7.0, 90.0, 80.0, 50.0, -1.0, 70.0, 90.0, 20.0, 100.0, 60.0, 40.0, 9.0, 120.0, 90.0, 60.0, 0.0, 70.0, 90.0, 70.0, 10.0, 60.0, 27.0, 100.0, 70.0, 90.0, 80.0, 100.0, 90.0, 90.0, 80.0, 40.0, 110.0, 70.0, 5.0, 50.0, 60.0, 50.0, 60.0, 90.0, 50.0, 50.0, 80.0, 70.0, 77.0, 80.0, 100.0, 90.0, 40.0, 20.0, 26.0, 50.0, 36.0, 60.0, 10.0, 0.0, 100.0, 50.0, 25.0, 70.0, 40.0, 50.0, 40.0, 90.0, 60.0, 80.0, 70.0, 110.0, 80.0, 80.0, 30.0, 110.0, 90.0, 60.0, 20.0, 40.0, 108.0, 110.0, 70.0, 50.0, 80.0, 50.0, 60.0, 10.0, -5.0, 43.0, 11.0, 20.0, 20.0, 60.0, 70.0, 50.0, 50.0, 60.0, 20.0, 60.0, 70.0, 40.0, -1.0, 100.0, 45.0, 100.0, 100.0, 30.0, 70.0, 70.0, -140.0, 120.0, 50.0, 80.0, 70.0, 20.0, 70.0, 16.0, 110.0, 60.0, 60.0, -15.0, 30.0, 70.0, 40.0, 60.0, -5.0, 120.0, 50.0, 110.0, 70.0, 70.0, 40.0, 70.0, 20.0, 60.0, 140.0, 50.0, 50.0, 120.0, 120.0, 100.0, 130.0, 110.0, 60.0, 30.0, 50.0, 26.0, 86.0, 37.0, 70.0, 70.0, 120.0, 72.0, 50.0, 90.0, 100.0, 140.0, 50.0, 80.0, 90.0, 120.0, 100.0, 100.0, 150.0, 55.0, 65.0, 150.0, 120.0, 100.0, 120.0, 45.0, 64.0, 100.0, 150.0, 50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5357613190640427, "mean_inference_ms": 1.5433927212308833, "mean_action_processing_ms": 0.49064837614134454, "mean_env_wait_ms": 1.3472172491850294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011601448059082031, "StateBufferConnector_ms": 0.008868932723999023, "ViewRequirementAgentConnector_ms": 0.372173547744751}, "num_episodes": 18, "episode_return_max": 1073.0, "episode_return_min": 155.0, "episode_return_mean": 595.81}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.64003893320117, "num_env_steps_trained_throughput_per_sec": 21.64003893320117, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 185428.095, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185428.047, "sample_time_ms": 2546.504, "learn_time_ms": 182862.356, "learn_throughput": 21.874, "synch_weights_time_ms": 11.506}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "a22d3_00000", "date": "2024-08-06_05-04-12", "timestamp": 1722935052, "time_this_iter_s": 184.85233163833618, "time_total_s": 22842.89220714569, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22d29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22842.89220714569, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 17.514503816793898, "ram_util_percent": 75.68358778625957}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.233565288407607, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.702973592624116, "policy_loss": -0.008834592077392128, "vf_loss": 5.7082480160446085, "vf_explained_var": 0.005553618228981416, "kl": 0.002778249256726142, "entropy": 0.5930485762378024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1073.0, "episode_reward_min": 195.0, "episode_reward_mean": 584.02, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 184.0}, "policy_reward_mean": {"policy_0": 58.402}, "custom_metrics": {}, "hist_stats": {"episode_reward": [703.0, 692.0, 276.0, 549.0, 652.0, 750.0, 585.0, 777.0, 428.0, 507.0, 595.0, 640.0, 547.0, 668.0, 585.0, 836.0, 640.0, 439.0, 374.0, 650.0, 450.0, 498.0, 470.0, 645.0, 398.0, 660.0, 1073.0, 620.0, 488.0, 708.0, 260.0, 650.0, 558.0, 762.0, 628.0, 660.0, 694.0, 550.0, 720.0, 554.0, 534.0, 556.0, 632.0, 620.0, 711.0, 630.0, 446.0, 585.0, 551.0, 740.0, 722.0, 667.0, 640.0, 690.0, 530.0, 645.0, 370.0, 707.0, 430.0, 566.0, 559.0, 787.0, 585.0, 633.0, 441.0, 690.0, 738.0, 339.0, 494.0, 550.0, 461.0, 605.0, 940.0, 611.0, 1020.0, 969.0, 581.0, 365.0, 521.0, 512.0, 710.0, 610.0, 388.0, 560.0, 671.0, 565.0, 590.0, 517.0, 354.0, 318.0, 457.0, 410.0, 195.0, 678.0, 434.0, 430.0, 265.0, 836.0, 402.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, -5.0, 100.0, 77.0, 60.0, 24.0, 89.0, 100.0, 100.0, 68.0, 63.0, 100.0, 50.0, 30.0, 80.0, 120.0, 70.0, 40.0, 20.0, 119.0, 40.0, 29.0, 50.0, 20.0, 8.0, 20.0, 30.0, 40.0, 39.0, 0.0, 4.0, 90.0, 32.0, 100.0, 65.0, 50.0, 51.0, 58.0, 29.0, 70.0, 100.0, 130.0, -25.0, 50.0, 100.0, 40.0, 70.0, 20.0, 107.0, 60.0, 80.0, 100.0, 40.0, 80.0, 150.0, 80.0, 20.0, 110.0, 50.0, 40.0, 30.0, 130.0, 15.0, 90.0, 70.0, 20.0, 70.0, 70.0, 70.0, 20.0, 50.0, 140.0, 100.0, 110.0, 90.0, 30.0, 8.0, 39.0, 70.0, 140.0, 60.0, 30.0, 30.0, 80.0, 49.0, 70.0, 70.0, -10.0, 30.0, 19.0, 20.0, 44.0, 60.0, 70.0, 10.0, 40.0, 50.0, 60.0, 83.0, 70.0, 50.0, 80.0, 90.0, 90.0, 90.0, 40.0, 60.0, 60.0, 17.0, 18.0, 130.0, 40.0, 90.0, 70.0, 60.0, 110.0, 20.0, 40.0, 20.0, 60.0, 100.0, 100.0, 90.0, 30.0, 50.0, 100.0, 50.0, 19.0, 25.0, -17.0, 80.0, 60.0, 60.0, 100.0, 40.0, 9.0, 29.0, 140.0, 80.0, 70.0, 10.0, 120.0, 110.0, 68.0, 39.0, 42.0, 30.0, 30.0, 90.0, 46.0, 9.0, 90.0, 50.0, 110.0, 150.0, 30.0, 67.0, 140.0, 100.0, 90.0, 60.0, 40.0, 60.0, 60.0, 120.0, 40.0, 30.0, 70.0, 80.0, 80.0, 50.0, 80.0, 30.0, 30.0, 20.0, 80.0, 70.0, -1.0, 40.0, 40.0, 47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0, 120.0, 40.0, 110.0, 40.0, 30.0, 50.0, 40.0, 20.0, 100.0, 100.0, 14.0, -4.0, 110.0, 60.0, 80.0, 20.0, 40.0, 80.0, 20.0, 30.0, 50.0, 40.0, 39.0, 19.0, 20.0, 60.0, 70.0, 110.0, 30.0, 60.0, 10.0, 100.0, 30.0, 30.0, 30.0, 40.0, 40.0, 70.0, 30.0, 90.0, 30.0, 61.0, 50.0, 40.0, 70.0, 120.0, 24.0, 140.0, 70.0, 40.0, 40.0, 8.0, -9.0, 30.0, 49.0, 40.0, 20.0, 60.0, 90.0, 70.0, 80.0, 50.0, 100.0, 20.0, 100.0, 70.0, 90.0, 40.0, 50.0, 60.0, 150.0, 75.0, 130.0, 90.0, 80.0, 100.0, 110.0, 158.0, 150.0, 30.0, 90.0, 90.0, 100.0, 50.0, 80.0, 40.0, 10.0, 80.0, 60.0, 20.0, 120.0, 70.0, 51.0, 70.0, 50.0, 100.0, -28.0, 42.0, -47.0, 60.0, 60.0, 1.0, 59.0, 120.0, 68.0, 100.0, 100.0, 60.0, 90.0, 50.0, 10.0, -14.0, 38.0, 40.0, 9.0, 50.0, 2.0, 15.0, 90.0, 20.0, 110.0, 20.0, 170.0, 50.0, 40.0, 30.0, 30.0, 70.0, 50.0, 80.0, 120.0, 4.0, 50.0, 49.0, 60.0, 70.0, 70.0, 55.0, 30.0, 50.0, 66.0, 30.0, 130.0, 91.0, 45.0, 20.0, 80.0, 130.0, 70.0, 100.0, 40.0, 110.0, 40.0, 120.0, 50.0, 80.0, 50.0, 90.0, 18.0, 30.0, 110.0, 100.0, 0.0, 60.0, 40.0, 110.0, 20.0, 10.0, 110.0, 100.0, 59.0, 28.0, 90.0, 107.0, 70.0, 70.0, 90.0, 60.0, 80.0, 40.0, 20.0, 30.0, 50.0, 110.0, 80.0, 40.0, 50.0, 80.0, 70.0, 20.0, 60.0, 30.0, 70.0, 150.0, 40.0, 120.0, 30.0, 140.0, 30.0, 50.0, 30.0, 28.0, 30.0, 26.0, 50.0, 30.0, 60.0, 90.0, 120.0, 90.0, 105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0, 90.0, 63.0, 60.0, 83.0, 50.0, 30.0, 30.0, 40.0, 10.0, 100.0, 40.0, 34.0, 48.0, 80.0, 60.0, 50.0, 120.0, 110.0, 30.0, 60.0, 10.0, 100.0, 70.0, 20.0, 30.0, 100.0, 16.0, 50.0, 184.0, 40.0, 140.0, 30.0, 110.0, 110.0, 23.0, 80.0, 40.0, 70.0, -2.0, 110.0, 110.0, 20.0, 40.0, 80.0, 90.0, 80.0, 110.0, 10.0, 60.0, 30.0, 81.0, 60.0, 50.0, 47.0, 11.0, 20.0, 11.0, 70.0, -54.0, 150.0, 100.0, 50.0, 30.0, 60.0, 70.0, 85.0, 0.0, 70.0, 60.0, 60.0, 30.0, 24.0, 130.0, 110.0, 30.0, 20.0, 90.0, 20.0, 17.0, 80.0, 70.0, 30.0, 130.0, 60.0, 80.0, 100.0, 10.0, 100.0, 90.0, 70.0, 50.0, 44.0, 130.0, 100.0, 60.0, 60.0, 24.0, 150.0, 44.0, 60.0, 120.0, 110.0, 13.0, 50.0, 90.0, 100.0, 15.0, 150.0, 18.0, 1.0, 70.0, 70.0, 20.0, 80.0, 120.0, 20.0, 120.0, 40.0, 50.0, 50.0, 90.0, 70.0, 50.0, 40.0, 80.0, 30.0, 90.0, 60.0, 140.0, 40.0, -4.0, 30.0, 30.0, 50.0, 80.0, 44.0, 60.0, 110.0, 90.0, 40.0, 30.0, 45.0, 60.0, 40.0, 70.0, 110.0, 150.0, 50.0, 80.0, 10.0, 40.0, 40.0, 30.0, 0.0, 120.0, 30.0, 30.0, 40.0, 20.0, 20.0, 50.0, 50.0, 110.0, 120.0, 80.0, 80.0, 80.0, 7.0, 110.0, 20.0, 100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0, 7.0, 90.0, 80.0, 50.0, -1.0, 70.0, 90.0, 20.0, 100.0, 60.0, 40.0, 9.0, 120.0, 90.0, 60.0, 0.0, 70.0, 90.0, 70.0, 10.0, 60.0, 27.0, 100.0, 70.0, 90.0, 80.0, 100.0, 90.0, 90.0, 80.0, 40.0, 110.0, 70.0, 5.0, 50.0, 60.0, 50.0, 60.0, 90.0, 50.0, 50.0, 80.0, 70.0, 77.0, 80.0, 100.0, 90.0, 40.0, 20.0, 26.0, 50.0, 36.0, 60.0, 10.0, 0.0, 100.0, 50.0, 25.0, 70.0, 40.0, 50.0, 40.0, 90.0, 60.0, 80.0, 70.0, 110.0, 80.0, 80.0, 30.0, 110.0, 90.0, 60.0, 20.0, 40.0, 108.0, 110.0, 70.0, 50.0, 80.0, 50.0, 60.0, 10.0, -5.0, 43.0, 11.0, 20.0, 20.0, 60.0, 70.0, 50.0, 50.0, 60.0, 20.0, 60.0, 70.0, 40.0, -1.0, 100.0, 45.0, 100.0, 100.0, 30.0, 70.0, 70.0, -140.0, 120.0, 50.0, 80.0, 70.0, 20.0, 70.0, 16.0, 110.0, 60.0, 60.0, -15.0, 30.0, 70.0, 40.0, 60.0, -5.0, 120.0, 50.0, 110.0, 70.0, 70.0, 40.0, 70.0, 20.0, 60.0, 140.0, 50.0, 50.0, 120.0, 120.0, 100.0, 130.0, 110.0, 60.0, 30.0, 50.0, 26.0, 86.0, 37.0, 70.0, 70.0, 120.0, 72.0, 50.0, 90.0, 100.0, 140.0, 50.0, 80.0, 90.0, 120.0, 100.0, 100.0, 150.0, 55.0, 65.0, 150.0, 120.0, 100.0, 120.0, 45.0, 64.0, 100.0, 150.0, 50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0, 30.0, 31.0, 3.0, 50.0, 20.0, 100.0, -37.0, 28.0, 90.0, 50.0, 80.0, 40.0, 50.0, 55.0, 0.0, 50.0, 100.0, 100.0, -4.0, 50.0, 80.0, 30.0, -3.0, 70.0, 20.0, 80.0, 80.0, 60.0, 60.0, 35.0, 50.0, 60.0, 100.0, 70.0, 50.0, 90.0, 70.0, 40.0, 110.0, 70.0, 120.0, 90.0, 40.0, 40.0, 60.0, 60.0, 50.0, 70.0, 10.0, 70.0, 30.0, 20.0, -7.0, 20.0, 108.0, 70.0, 69.0, 50.0, 20.0, 8.0, 50.0, 60.0, 40.0, 60.0, 110.0, 10.0, 50.0, 100.0, 60.0, 20.0, 80.0, 60.0, 20.0, 35.0, 140.0, 26.0, 110.0, 40.0, 70.0, 90.0, 70.0, 76.0, 110.0, -6.0, 50.0, 80.0, 80.0, 25.0, 50.0, 30.0, 90.0, 30.0, 80.0, 60.0, 50.0, 20.0, 30.0, 100.0, 50.0, 80.0, 60.0, 27.0, 5.0, 30.0, 80.0, 110.0, 80.0, 30.0, 15.0, 80.0, 10.0, 20.0, 20.0, 7.0, 30.0, 40.0, 110.0, 27.0, 30.0, 60.0, 60.0, 20.0, 10.0, 120.0, 20.0, 10.0, 10.0, 20.0, 18.0, 30.0, 50.0, 70.0, 90.0, 14.0, 9.0, 50.0, 50.0, 70.0, -15.0, 69.0, 40.0, 10.0, 30.0, 100.0, 30.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 27.0, -20.0, 0.0, 68.0, 60.0, 40.0, 120.0, 28.0, 30.0, 40.0, 130.0, 140.0, 50.0, 40.0, 30.0, 30.0, 90.0, 0.0, 40.0, 90.0, 110.0, 40.0, -3.0, 7.0, 40.0, 10.0, 30.0, 100.0, 20.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 20.0, 0.0, 30.0, 40.0, 20.0, 18.0, 40.0, 7.0, 50.0, 130.0, 80.0, 35.0, 70.0, 90.0, 80.0, 64.0, 130.0, 132.0, 25.0, 40.0, 50.0, 15.0, 10.0, 40.0, 50.0, 50.0, 30.0, 17.0, 100.0, 40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5343540872359023, "mean_inference_ms": 1.5418900911306324, "mean_action_processing_ms": 0.4901380576514974, "mean_env_wait_ms": 1.3460840725945864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011955022811889648, "StateBufferConnector_ms": 0.00909423828125, "ViewRequirementAgentConnector_ms": 0.38089680671691895}, "num_episodes": 23, "episode_return_max": 1073.0, "episode_return_min": 195.0, "episode_return_mean": 584.02}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.676866821019164, "num_env_steps_trained_throughput_per_sec": 21.676866821019164, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 185388.042, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185387.994, "sample_time_ms": 2507.261, "learn_time_ms": 182861.387, "learn_throughput": 21.874, "synch_weights_time_ms": 11.394}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "a22d3_00000", "date": "2024-08-06_05-07-16", "timestamp": 1722935236, "time_this_iter_s": 184.53680181503296, "time_total_s": 23027.429008960724, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22d2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23027.429008960724, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.39846743295019, "ram_util_percent": 75.90842911877394}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1856623829871067, "cur_kl_coeff": 0.6407226562500001, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.620433885830279, "policy_loss": -0.010354903454845722, "vf_loss": 6.627776609518277, "vf_explained_var": 0.005215593578970343, "kl": 0.004701214856131747, "entropy": 0.5321138028487865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1073.0, "episode_reward_min": 195.0, "episode_reward_mean": 583.46, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 184.0}, "policy_reward_mean": {"policy_0": 58.346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.0, 650.0, 450.0, 498.0, 470.0, 645.0, 398.0, 660.0, 1073.0, 620.0, 488.0, 708.0, 260.0, 650.0, 558.0, 762.0, 628.0, 660.0, 694.0, 550.0, 720.0, 554.0, 534.0, 556.0, 632.0, 620.0, 711.0, 630.0, 446.0, 585.0, 551.0, 740.0, 722.0, 667.0, 640.0, 690.0, 530.0, 645.0, 370.0, 707.0, 430.0, 566.0, 559.0, 787.0, 585.0, 633.0, 441.0, 690.0, 738.0, 339.0, 494.0, 550.0, 461.0, 605.0, 940.0, 611.0, 1020.0, 969.0, 581.0, 365.0, 521.0, 512.0, 710.0, 610.0, 388.0, 560.0, 671.0, 565.0, 590.0, 517.0, 354.0, 318.0, 457.0, 410.0, 195.0, 678.0, 434.0, 430.0, 265.0, 836.0, 402.0, 700.0, 473.0, 730.0, 551.0, 420.0, 520.0, 630.0, 599.0, 510.0, 604.0, 620.0, 844.0, 501.0, 576.0, 754.0, 733.0, 800.0, 630.0, 318.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [47.0, 30.0, 30.0, 13.0, 37.0, 20.0, 40.0, 20.0, 73.0, 64.0, 120.0, 40.0, 110.0, 40.0, 30.0, 50.0, 40.0, 20.0, 100.0, 100.0, 14.0, -4.0, 110.0, 60.0, 80.0, 20.0, 40.0, 80.0, 20.0, 30.0, 50.0, 40.0, 39.0, 19.0, 20.0, 60.0, 70.0, 110.0, 30.0, 60.0, 10.0, 100.0, 30.0, 30.0, 30.0, 40.0, 40.0, 70.0, 30.0, 90.0, 30.0, 61.0, 50.0, 40.0, 70.0, 120.0, 24.0, 140.0, 70.0, 40.0, 40.0, 8.0, -9.0, 30.0, 49.0, 40.0, 20.0, 60.0, 90.0, 70.0, 80.0, 50.0, 100.0, 20.0, 100.0, 70.0, 90.0, 40.0, 50.0, 60.0, 150.0, 75.0, 130.0, 90.0, 80.0, 100.0, 110.0, 158.0, 150.0, 30.0, 90.0, 90.0, 100.0, 50.0, 80.0, 40.0, 10.0, 80.0, 60.0, 20.0, 120.0, 70.0, 51.0, 70.0, 50.0, 100.0, -28.0, 42.0, -47.0, 60.0, 60.0, 1.0, 59.0, 120.0, 68.0, 100.0, 100.0, 60.0, 90.0, 50.0, 10.0, -14.0, 38.0, 40.0, 9.0, 50.0, 2.0, 15.0, 90.0, 20.0, 110.0, 20.0, 170.0, 50.0, 40.0, 30.0, 30.0, 70.0, 50.0, 80.0, 120.0, 4.0, 50.0, 49.0, 60.0, 70.0, 70.0, 55.0, 30.0, 50.0, 66.0, 30.0, 130.0, 91.0, 45.0, 20.0, 80.0, 130.0, 70.0, 100.0, 40.0, 110.0, 40.0, 120.0, 50.0, 80.0, 50.0, 90.0, 18.0, 30.0, 110.0, 100.0, 0.0, 60.0, 40.0, 110.0, 20.0, 10.0, 110.0, 100.0, 59.0, 28.0, 90.0, 107.0, 70.0, 70.0, 90.0, 60.0, 80.0, 40.0, 20.0, 30.0, 50.0, 110.0, 80.0, 40.0, 50.0, 80.0, 70.0, 20.0, 60.0, 30.0, 70.0, 150.0, 40.0, 120.0, 30.0, 140.0, 30.0, 50.0, 30.0, 28.0, 30.0, 26.0, 50.0, 30.0, 60.0, 90.0, 120.0, 90.0, 105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0, 90.0, 63.0, 60.0, 83.0, 50.0, 30.0, 30.0, 40.0, 10.0, 100.0, 40.0, 34.0, 48.0, 80.0, 60.0, 50.0, 120.0, 110.0, 30.0, 60.0, 10.0, 100.0, 70.0, 20.0, 30.0, 100.0, 16.0, 50.0, 184.0, 40.0, 140.0, 30.0, 110.0, 110.0, 23.0, 80.0, 40.0, 70.0, -2.0, 110.0, 110.0, 20.0, 40.0, 80.0, 90.0, 80.0, 110.0, 10.0, 60.0, 30.0, 81.0, 60.0, 50.0, 47.0, 11.0, 20.0, 11.0, 70.0, -54.0, 150.0, 100.0, 50.0, 30.0, 60.0, 70.0, 85.0, 0.0, 70.0, 60.0, 60.0, 30.0, 24.0, 130.0, 110.0, 30.0, 20.0, 90.0, 20.0, 17.0, 80.0, 70.0, 30.0, 130.0, 60.0, 80.0, 100.0, 10.0, 100.0, 90.0, 70.0, 50.0, 44.0, 130.0, 100.0, 60.0, 60.0, 24.0, 150.0, 44.0, 60.0, 120.0, 110.0, 13.0, 50.0, 90.0, 100.0, 15.0, 150.0, 18.0, 1.0, 70.0, 70.0, 20.0, 80.0, 120.0, 20.0, 120.0, 40.0, 50.0, 50.0, 90.0, 70.0, 50.0, 40.0, 80.0, 30.0, 90.0, 60.0, 140.0, 40.0, -4.0, 30.0, 30.0, 50.0, 80.0, 44.0, 60.0, 110.0, 90.0, 40.0, 30.0, 45.0, 60.0, 40.0, 70.0, 110.0, 150.0, 50.0, 80.0, 10.0, 40.0, 40.0, 30.0, 0.0, 120.0, 30.0, 30.0, 40.0, 20.0, 20.0, 50.0, 50.0, 110.0, 120.0, 80.0, 80.0, 80.0, 7.0, 110.0, 20.0, 100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0, 7.0, 90.0, 80.0, 50.0, -1.0, 70.0, 90.0, 20.0, 100.0, 60.0, 40.0, 9.0, 120.0, 90.0, 60.0, 0.0, 70.0, 90.0, 70.0, 10.0, 60.0, 27.0, 100.0, 70.0, 90.0, 80.0, 100.0, 90.0, 90.0, 80.0, 40.0, 110.0, 70.0, 5.0, 50.0, 60.0, 50.0, 60.0, 90.0, 50.0, 50.0, 80.0, 70.0, 77.0, 80.0, 100.0, 90.0, 40.0, 20.0, 26.0, 50.0, 36.0, 60.0, 10.0, 0.0, 100.0, 50.0, 25.0, 70.0, 40.0, 50.0, 40.0, 90.0, 60.0, 80.0, 70.0, 110.0, 80.0, 80.0, 30.0, 110.0, 90.0, 60.0, 20.0, 40.0, 108.0, 110.0, 70.0, 50.0, 80.0, 50.0, 60.0, 10.0, -5.0, 43.0, 11.0, 20.0, 20.0, 60.0, 70.0, 50.0, 50.0, 60.0, 20.0, 60.0, 70.0, 40.0, -1.0, 100.0, 45.0, 100.0, 100.0, 30.0, 70.0, 70.0, -140.0, 120.0, 50.0, 80.0, 70.0, 20.0, 70.0, 16.0, 110.0, 60.0, 60.0, -15.0, 30.0, 70.0, 40.0, 60.0, -5.0, 120.0, 50.0, 110.0, 70.0, 70.0, 40.0, 70.0, 20.0, 60.0, 140.0, 50.0, 50.0, 120.0, 120.0, 100.0, 130.0, 110.0, 60.0, 30.0, 50.0, 26.0, 86.0, 37.0, 70.0, 70.0, 120.0, 72.0, 50.0, 90.0, 100.0, 140.0, 50.0, 80.0, 90.0, 120.0, 100.0, 100.0, 150.0, 55.0, 65.0, 150.0, 120.0, 100.0, 120.0, 45.0, 64.0, 100.0, 150.0, 50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0, 30.0, 31.0, 3.0, 50.0, 20.0, 100.0, -37.0, 28.0, 90.0, 50.0, 80.0, 40.0, 50.0, 55.0, 0.0, 50.0, 100.0, 100.0, -4.0, 50.0, 80.0, 30.0, -3.0, 70.0, 20.0, 80.0, 80.0, 60.0, 60.0, 35.0, 50.0, 60.0, 100.0, 70.0, 50.0, 90.0, 70.0, 40.0, 110.0, 70.0, 120.0, 90.0, 40.0, 40.0, 60.0, 60.0, 50.0, 70.0, 10.0, 70.0, 30.0, 20.0, -7.0, 20.0, 108.0, 70.0, 69.0, 50.0, 20.0, 8.0, 50.0, 60.0, 40.0, 60.0, 110.0, 10.0, 50.0, 100.0, 60.0, 20.0, 80.0, 60.0, 20.0, 35.0, 140.0, 26.0, 110.0, 40.0, 70.0, 90.0, 70.0, 76.0, 110.0, -6.0, 50.0, 80.0, 80.0, 25.0, 50.0, 30.0, 90.0, 30.0, 80.0, 60.0, 50.0, 20.0, 30.0, 100.0, 50.0, 80.0, 60.0, 27.0, 5.0, 30.0, 80.0, 110.0, 80.0, 30.0, 15.0, 80.0, 10.0, 20.0, 20.0, 7.0, 30.0, 40.0, 110.0, 27.0, 30.0, 60.0, 60.0, 20.0, 10.0, 120.0, 20.0, 10.0, 10.0, 20.0, 18.0, 30.0, 50.0, 70.0, 90.0, 14.0, 9.0, 50.0, 50.0, 70.0, -15.0, 69.0, 40.0, 10.0, 30.0, 100.0, 30.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 27.0, -20.0, 0.0, 68.0, 60.0, 40.0, 120.0, 28.0, 30.0, 40.0, 130.0, 140.0, 50.0, 40.0, 30.0, 30.0, 90.0, 0.0, 40.0, 90.0, 110.0, 40.0, -3.0, 7.0, 40.0, 10.0, 30.0, 100.0, 20.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 20.0, 0.0, 30.0, 40.0, 20.0, 18.0, 40.0, 7.0, 50.0, 130.0, 80.0, 35.0, 70.0, 90.0, 80.0, 64.0, 130.0, 132.0, 25.0, 40.0, 50.0, 15.0, 10.0, 40.0, 50.0, 50.0, 30.0, 17.0, 100.0, 40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0, 60.0, 30.0, 40.0, 60.0, 26.0, 60.0, -11.0, 90.0, 100.0, 18.0, 40.0, 100.0, 120.0, 30.0, 60.0, 70.0, 60.0, 130.0, 80.0, 40.0, 110.0, 57.0, 60.0, 55.0, 70.0, 50.0, 40.0, 49.0, 30.0, 30.0, 85.0, 40.0, 45.0, 40.0, 60.0, 20.0, 30.0, 20.0, 50.0, 30.0, 60.0, 10.0, -30.0, 90.0, 90.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 25.0, 105.0, 70.0, 50.0, 70.0, 30.0, 110.0, 70.0, 60.0, 70.0, 50.0, 65.0, 80.0, 25.0, 90.0, 80.0, 8.0, 31.0, 100.0, 50.0, 50.0, -1.0, 118.0, 130.0, 100.0, 47.0, -7.0, -17.0, 40.0, 40.0, 60.0, 70.0, 4.0, 30.0, 100.0, 60.0, 90.0, 100.0, 50.0, 40.0, 30.0, 0.0, 50.0, 20.0, 90.0, 40.0, 100.0, 90.0, 160.0, 92.0, 40.0, 70.0, 130.0, 109.0, 90.0, 89.0, 64.0, 90.0, 70.0, 87.0, 90.0, 56.0, 50.0, 10.0, 70.0, 46.0, 22.0, 30.0, 40.0, 50.0, 60.0, 25.0, 100.0, 90.0, 73.0, 20.0, 58.0, 40.0, 60.0, 40.0, 40.0, 85.0, 75.0, 100.0, 90.0, 60.0, 120.0, 20.0, 124.0, 50.0, 37.0, 140.0, 3.0, 90.0, 63.0, 70.0, 120.0, 90.0, 70.0, 20.0, 80.0, 60.0, 70.0, 70.0, 100.0, 60.0, 90.0, 100.0, 150.0, 80.0, 40.0, 130.0, 60.0, 80.0, 50.0, 30.0, 80.0, 40.0, 40.0, 10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.533610564012628, "mean_inference_ms": 1.5408106418631968, "mean_action_processing_ms": 0.48978131984475626, "mean_env_wait_ms": 1.3453287688256141, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011989593505859375, "StateBufferConnector_ms": 0.009116411209106445, "ViewRequirementAgentConnector_ms": 0.3870546817779541}, "num_episodes": 18, "episode_return_max": 1073.0, "episode_return_min": 195.0, "episode_return_mean": 583.46}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.645475612033298, "num_env_steps_trained_throughput_per_sec": 21.645475612033298, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 185344.436, "restore_workers_time_ms": 0.013, "training_step_time_ms": 185344.387, "sample_time_ms": 2494.028, "learn_time_ms": 182830.784, "learn_throughput": 21.878, "synch_weights_time_ms": 11.408}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "a22d3_00000", "date": "2024-08-06_05-10-21", "timestamp": 1722935421, "time_this_iter_s": 184.80481100082397, "time_total_s": 23212.233819961548, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23212.233819961548, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 17.540613026819926, "ram_util_percent": 76.4287356321839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.939122691588661, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.41412252135678, "policy_loss": -0.011071770072689516, "vf_loss": 6.423071808251329, "vf_explained_var": 0.007550740108703272, "kl": 0.0066253000879336, "entropy": 0.5364244825193804, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1020.0, "episode_reward_min": 195.0, "episode_reward_mean": 585.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 58.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [534.0, 556.0, 632.0, 620.0, 711.0, 630.0, 446.0, 585.0, 551.0, 740.0, 722.0, 667.0, 640.0, 690.0, 530.0, 645.0, 370.0, 707.0, 430.0, 566.0, 559.0, 787.0, 585.0, 633.0, 441.0, 690.0, 738.0, 339.0, 494.0, 550.0, 461.0, 605.0, 940.0, 611.0, 1020.0, 969.0, 581.0, 365.0, 521.0, 512.0, 710.0, 610.0, 388.0, 560.0, 671.0, 565.0, 590.0, 517.0, 354.0, 318.0, 457.0, 410.0, 195.0, 678.0, 434.0, 430.0, 265.0, 836.0, 402.0, 700.0, 473.0, 730.0, 551.0, 420.0, 520.0, 630.0, 599.0, 510.0, 604.0, 620.0, 844.0, 501.0, 576.0, 754.0, 733.0, 800.0, 630.0, 318.0, 212.0, 505.0, 934.0, 480.0, 502.0, 704.0, 760.0, 703.0, 445.0, 687.0, 299.0, 602.0, 710.0, 779.0, 649.0, 739.0, 779.0, 624.0, 380.0, 700.0, 466.0, 600.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [105.0, 30.0, 16.0, 20.0, 40.0, 20.0, 70.0, 50.0, 97.0, 86.0, 90.0, 63.0, 60.0, 83.0, 50.0, 30.0, 30.0, 40.0, 10.0, 100.0, 40.0, 34.0, 48.0, 80.0, 60.0, 50.0, 120.0, 110.0, 30.0, 60.0, 10.0, 100.0, 70.0, 20.0, 30.0, 100.0, 16.0, 50.0, 184.0, 40.0, 140.0, 30.0, 110.0, 110.0, 23.0, 80.0, 40.0, 70.0, -2.0, 110.0, 110.0, 20.0, 40.0, 80.0, 90.0, 80.0, 110.0, 10.0, 60.0, 30.0, 81.0, 60.0, 50.0, 47.0, 11.0, 20.0, 11.0, 70.0, -54.0, 150.0, 100.0, 50.0, 30.0, 60.0, 70.0, 85.0, 0.0, 70.0, 60.0, 60.0, 30.0, 24.0, 130.0, 110.0, 30.0, 20.0, 90.0, 20.0, 17.0, 80.0, 70.0, 30.0, 130.0, 60.0, 80.0, 100.0, 10.0, 100.0, 90.0, 70.0, 50.0, 44.0, 130.0, 100.0, 60.0, 60.0, 24.0, 150.0, 44.0, 60.0, 120.0, 110.0, 13.0, 50.0, 90.0, 100.0, 15.0, 150.0, 18.0, 1.0, 70.0, 70.0, 20.0, 80.0, 120.0, 20.0, 120.0, 40.0, 50.0, 50.0, 90.0, 70.0, 50.0, 40.0, 80.0, 30.0, 90.0, 60.0, 140.0, 40.0, -4.0, 30.0, 30.0, 50.0, 80.0, 44.0, 60.0, 110.0, 90.0, 40.0, 30.0, 45.0, 60.0, 40.0, 70.0, 110.0, 150.0, 50.0, 80.0, 10.0, 40.0, 40.0, 30.0, 0.0, 120.0, 30.0, 30.0, 40.0, 20.0, 20.0, 50.0, 50.0, 110.0, 120.0, 80.0, 80.0, 80.0, 7.0, 110.0, 20.0, 100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0, 7.0, 90.0, 80.0, 50.0, -1.0, 70.0, 90.0, 20.0, 100.0, 60.0, 40.0, 9.0, 120.0, 90.0, 60.0, 0.0, 70.0, 90.0, 70.0, 10.0, 60.0, 27.0, 100.0, 70.0, 90.0, 80.0, 100.0, 90.0, 90.0, 80.0, 40.0, 110.0, 70.0, 5.0, 50.0, 60.0, 50.0, 60.0, 90.0, 50.0, 50.0, 80.0, 70.0, 77.0, 80.0, 100.0, 90.0, 40.0, 20.0, 26.0, 50.0, 36.0, 60.0, 10.0, 0.0, 100.0, 50.0, 25.0, 70.0, 40.0, 50.0, 40.0, 90.0, 60.0, 80.0, 70.0, 110.0, 80.0, 80.0, 30.0, 110.0, 90.0, 60.0, 20.0, 40.0, 108.0, 110.0, 70.0, 50.0, 80.0, 50.0, 60.0, 10.0, -5.0, 43.0, 11.0, 20.0, 20.0, 60.0, 70.0, 50.0, 50.0, 60.0, 20.0, 60.0, 70.0, 40.0, -1.0, 100.0, 45.0, 100.0, 100.0, 30.0, 70.0, 70.0, -140.0, 120.0, 50.0, 80.0, 70.0, 20.0, 70.0, 16.0, 110.0, 60.0, 60.0, -15.0, 30.0, 70.0, 40.0, 60.0, -5.0, 120.0, 50.0, 110.0, 70.0, 70.0, 40.0, 70.0, 20.0, 60.0, 140.0, 50.0, 50.0, 120.0, 120.0, 100.0, 130.0, 110.0, 60.0, 30.0, 50.0, 26.0, 86.0, 37.0, 70.0, 70.0, 120.0, 72.0, 50.0, 90.0, 100.0, 140.0, 50.0, 80.0, 90.0, 120.0, 100.0, 100.0, 150.0, 55.0, 65.0, 150.0, 120.0, 100.0, 120.0, 45.0, 64.0, 100.0, 150.0, 50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0, 30.0, 31.0, 3.0, 50.0, 20.0, 100.0, -37.0, 28.0, 90.0, 50.0, 80.0, 40.0, 50.0, 55.0, 0.0, 50.0, 100.0, 100.0, -4.0, 50.0, 80.0, 30.0, -3.0, 70.0, 20.0, 80.0, 80.0, 60.0, 60.0, 35.0, 50.0, 60.0, 100.0, 70.0, 50.0, 90.0, 70.0, 40.0, 110.0, 70.0, 120.0, 90.0, 40.0, 40.0, 60.0, 60.0, 50.0, 70.0, 10.0, 70.0, 30.0, 20.0, -7.0, 20.0, 108.0, 70.0, 69.0, 50.0, 20.0, 8.0, 50.0, 60.0, 40.0, 60.0, 110.0, 10.0, 50.0, 100.0, 60.0, 20.0, 80.0, 60.0, 20.0, 35.0, 140.0, 26.0, 110.0, 40.0, 70.0, 90.0, 70.0, 76.0, 110.0, -6.0, 50.0, 80.0, 80.0, 25.0, 50.0, 30.0, 90.0, 30.0, 80.0, 60.0, 50.0, 20.0, 30.0, 100.0, 50.0, 80.0, 60.0, 27.0, 5.0, 30.0, 80.0, 110.0, 80.0, 30.0, 15.0, 80.0, 10.0, 20.0, 20.0, 7.0, 30.0, 40.0, 110.0, 27.0, 30.0, 60.0, 60.0, 20.0, 10.0, 120.0, 20.0, 10.0, 10.0, 20.0, 18.0, 30.0, 50.0, 70.0, 90.0, 14.0, 9.0, 50.0, 50.0, 70.0, -15.0, 69.0, 40.0, 10.0, 30.0, 100.0, 30.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 27.0, -20.0, 0.0, 68.0, 60.0, 40.0, 120.0, 28.0, 30.0, 40.0, 130.0, 140.0, 50.0, 40.0, 30.0, 30.0, 90.0, 0.0, 40.0, 90.0, 110.0, 40.0, -3.0, 7.0, 40.0, 10.0, 30.0, 100.0, 20.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 20.0, 0.0, 30.0, 40.0, 20.0, 18.0, 40.0, 7.0, 50.0, 130.0, 80.0, 35.0, 70.0, 90.0, 80.0, 64.0, 130.0, 132.0, 25.0, 40.0, 50.0, 15.0, 10.0, 40.0, 50.0, 50.0, 30.0, 17.0, 100.0, 40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0, 60.0, 30.0, 40.0, 60.0, 26.0, 60.0, -11.0, 90.0, 100.0, 18.0, 40.0, 100.0, 120.0, 30.0, 60.0, 70.0, 60.0, 130.0, 80.0, 40.0, 110.0, 57.0, 60.0, 55.0, 70.0, 50.0, 40.0, 49.0, 30.0, 30.0, 85.0, 40.0, 45.0, 40.0, 60.0, 20.0, 30.0, 20.0, 50.0, 30.0, 60.0, 10.0, -30.0, 90.0, 90.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 25.0, 105.0, 70.0, 50.0, 70.0, 30.0, 110.0, 70.0, 60.0, 70.0, 50.0, 65.0, 80.0, 25.0, 90.0, 80.0, 8.0, 31.0, 100.0, 50.0, 50.0, -1.0, 118.0, 130.0, 100.0, 47.0, -7.0, -17.0, 40.0, 40.0, 60.0, 70.0, 4.0, 30.0, 100.0, 60.0, 90.0, 100.0, 50.0, 40.0, 30.0, 0.0, 50.0, 20.0, 90.0, 40.0, 100.0, 90.0, 160.0, 92.0, 40.0, 70.0, 130.0, 109.0, 90.0, 89.0, 64.0, 90.0, 70.0, 87.0, 90.0, 56.0, 50.0, 10.0, 70.0, 46.0, 22.0, 30.0, 40.0, 50.0, 60.0, 25.0, 100.0, 90.0, 73.0, 20.0, 58.0, 40.0, 60.0, 40.0, 40.0, 85.0, 75.0, 100.0, 90.0, 60.0, 120.0, 20.0, 124.0, 50.0, 37.0, 140.0, 3.0, 90.0, 63.0, 70.0, 120.0, 90.0, 70.0, 20.0, 80.0, 60.0, 70.0, 70.0, 100.0, 60.0, 90.0, 100.0, 150.0, 80.0, 40.0, 130.0, 60.0, 80.0, 50.0, 30.0, 80.0, 40.0, 40.0, 10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0, 0.0, 0.0, 40.0, 50.0, 0.0, 30.0, 23.0, 40.0, 0.0, 29.0, 20.0, 70.0, 70.0, 50.0, 45.0, 30.0, 50.0, 70.0, 40.0, 60.0, 49.0, 100.0, 110.0, 75.0, 70.0, 140.0, 50.0, 140.0, 100.0, 100.0, 70.0, 50.0, 20.0, 50.0, 30.0, 60.0, 60.0, 60.0, 60.0, 20.0, 5.0, 40.0, 100.0, 70.0, 80.0, 14.0, 40.0, 47.0, 100.0, 6.0, 70.0, 90.0, 40.0, 40.0, 50.0, 160.0, 19.0, 90.0, 35.0, 110.0, 30.0, 60.0, 60.0, 130.0, 60.0, 70.0, 30.0, 190.0, 60.0, 70.0, 120.0, 110.0, 76.0, 32.0, 65.0, 90.0, 90.0, 30.0, 30.0, 60.0, 40.0, 49.0, 40.0, 20.0, 50.0, 80.0, 50.0, 30.0, 50.0, 36.0, 40.0, 60.0, 70.0, 80.0, 60.0, 20.0, 150.0, 90.0, 50.0, 67.0, 30.0, 0.0, 20.0, 10.0, 40.0, 100.0, 20.0, 38.0, 30.0, 11.0, 30.0, 40.0, 50.0, 0.0, 90.0, 11.0, 136.0, 110.0, 50.0, 85.0, 70.0, 30.0, 110.0, 100.0, 50.0, 70.0, 90.0, 70.0, 50.0, 70.0, 130.0, 80.0, 60.0, 20.0, 50.0, 95.0, 80.0, 75.0, 79.0, 110.0, 120.0, 50.0, 40.0, 110.0, 40.0, 90.0, 70.0, 50.0, 19.0, 60.0, 80.0, 139.0, 90.0, 70.0, 20.0, 70.0, 40.0, 30.0, 130.0, 70.0, 90.0, 120.0, 130.0, 30.0, 80.0, 60.0, 140.0, 69.0, 40.0, 20.0, 60.0, 34.0, 110.0, 30.0, 95.0, 25.0, 37.0, 73.0, 70.0, 90.0, 47.0, 50.0, 4.0, 31.0, 90.0, 60.0, 10.0, 58.0, 40.0, -10.0, 80.0, 80.0, 50.0, 20.0, 70.0, 60.0, 100.0, 60.0, 70.0, 110.0, 40.0, 30.0, 30.0, 68.0, 30.0, 48.0, 30.0, 50.0, 50.0, 90.0, 60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5330410973420094, "mean_inference_ms": 1.539481338094609, "mean_action_processing_ms": 0.4893514164372281, "mean_env_wait_ms": 1.3444222096106027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012188196182250977, "StateBufferConnector_ms": 0.009276628494262695, "ViewRequirementAgentConnector_ms": 0.3924884796142578}, "num_episodes": 22, "episode_return_max": 1020.0, "episode_return_min": 195.0, "episode_return_mean": 585.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.663736609873226, "num_env_steps_trained_throughput_per_sec": 21.663736609873226, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 185345.557, "restore_workers_time_ms": 0.013, "training_step_time_ms": 185345.509, "sample_time_ms": 2465.808, "learn_time_ms": 182859.32, "learn_throughput": 21.875, "synch_weights_time_ms": 11.924}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "a22d3_00000", "date": "2024-08-06_05-13-26", "timestamp": 1722935606, "time_this_iter_s": 184.64957070350647, "time_total_s": 23396.883390665054, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23396.883390665054, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.41647509578544, "ram_util_percent": 76.48620689655174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0457348180909, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011705738349487417, "vf_loss": 6.899432604406842, "vf_explained_var": 0.012172056945622031, "kl": Infinity, "entropy": 0.5177829752048364, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1034.0, "episode_reward_min": 195.0, "episode_reward_mean": 589.81, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 58.981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [430.0, 566.0, 559.0, 787.0, 585.0, 633.0, 441.0, 690.0, 738.0, 339.0, 494.0, 550.0, 461.0, 605.0, 940.0, 611.0, 1020.0, 969.0, 581.0, 365.0, 521.0, 512.0, 710.0, 610.0, 388.0, 560.0, 671.0, 565.0, 590.0, 517.0, 354.0, 318.0, 457.0, 410.0, 195.0, 678.0, 434.0, 430.0, 265.0, 836.0, 402.0, 700.0, 473.0, 730.0, 551.0, 420.0, 520.0, 630.0, 599.0, 510.0, 604.0, 620.0, 844.0, 501.0, 576.0, 754.0, 733.0, 800.0, 630.0, 318.0, 212.0, 505.0, 934.0, 480.0, 502.0, 704.0, 760.0, 703.0, 445.0, 687.0, 299.0, 602.0, 710.0, 779.0, 649.0, 739.0, 779.0, 624.0, 380.0, 700.0, 466.0, 600.0, 655.0, 628.0, 661.0, 490.0, 1034.0, 468.0, 687.0, 499.0, 761.0, 570.0, 370.0, 763.0, 750.0, 709.0, 375.0, 559.0, 630.0, 813.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, -10.0, 20.0, 50.0, 70.0, 20.0, 60.0, 80.0, 30.0, 10.0, 7.0, 90.0, 80.0, 50.0, -1.0, 70.0, 90.0, 20.0, 100.0, 60.0, 40.0, 9.0, 120.0, 90.0, 60.0, 0.0, 70.0, 90.0, 70.0, 10.0, 60.0, 27.0, 100.0, 70.0, 90.0, 80.0, 100.0, 90.0, 90.0, 80.0, 40.0, 110.0, 70.0, 5.0, 50.0, 60.0, 50.0, 60.0, 90.0, 50.0, 50.0, 80.0, 70.0, 77.0, 80.0, 100.0, 90.0, 40.0, 20.0, 26.0, 50.0, 36.0, 60.0, 10.0, 0.0, 100.0, 50.0, 25.0, 70.0, 40.0, 50.0, 40.0, 90.0, 60.0, 80.0, 70.0, 110.0, 80.0, 80.0, 30.0, 110.0, 90.0, 60.0, 20.0, 40.0, 108.0, 110.0, 70.0, 50.0, 80.0, 50.0, 60.0, 10.0, -5.0, 43.0, 11.0, 20.0, 20.0, 60.0, 70.0, 50.0, 50.0, 60.0, 20.0, 60.0, 70.0, 40.0, -1.0, 100.0, 45.0, 100.0, 100.0, 30.0, 70.0, 70.0, -140.0, 120.0, 50.0, 80.0, 70.0, 20.0, 70.0, 16.0, 110.0, 60.0, 60.0, -15.0, 30.0, 70.0, 40.0, 60.0, -5.0, 120.0, 50.0, 110.0, 70.0, 70.0, 40.0, 70.0, 20.0, 60.0, 140.0, 50.0, 50.0, 120.0, 120.0, 100.0, 130.0, 110.0, 60.0, 30.0, 50.0, 26.0, 86.0, 37.0, 70.0, 70.0, 120.0, 72.0, 50.0, 90.0, 100.0, 140.0, 50.0, 80.0, 90.0, 120.0, 100.0, 100.0, 150.0, 55.0, 65.0, 150.0, 120.0, 100.0, 120.0, 45.0, 64.0, 100.0, 150.0, 50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0, 30.0, 31.0, 3.0, 50.0, 20.0, 100.0, -37.0, 28.0, 90.0, 50.0, 80.0, 40.0, 50.0, 55.0, 0.0, 50.0, 100.0, 100.0, -4.0, 50.0, 80.0, 30.0, -3.0, 70.0, 20.0, 80.0, 80.0, 60.0, 60.0, 35.0, 50.0, 60.0, 100.0, 70.0, 50.0, 90.0, 70.0, 40.0, 110.0, 70.0, 120.0, 90.0, 40.0, 40.0, 60.0, 60.0, 50.0, 70.0, 10.0, 70.0, 30.0, 20.0, -7.0, 20.0, 108.0, 70.0, 69.0, 50.0, 20.0, 8.0, 50.0, 60.0, 40.0, 60.0, 110.0, 10.0, 50.0, 100.0, 60.0, 20.0, 80.0, 60.0, 20.0, 35.0, 140.0, 26.0, 110.0, 40.0, 70.0, 90.0, 70.0, 76.0, 110.0, -6.0, 50.0, 80.0, 80.0, 25.0, 50.0, 30.0, 90.0, 30.0, 80.0, 60.0, 50.0, 20.0, 30.0, 100.0, 50.0, 80.0, 60.0, 27.0, 5.0, 30.0, 80.0, 110.0, 80.0, 30.0, 15.0, 80.0, 10.0, 20.0, 20.0, 7.0, 30.0, 40.0, 110.0, 27.0, 30.0, 60.0, 60.0, 20.0, 10.0, 120.0, 20.0, 10.0, 10.0, 20.0, 18.0, 30.0, 50.0, 70.0, 90.0, 14.0, 9.0, 50.0, 50.0, 70.0, -15.0, 69.0, 40.0, 10.0, 30.0, 100.0, 30.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 27.0, -20.0, 0.0, 68.0, 60.0, 40.0, 120.0, 28.0, 30.0, 40.0, 130.0, 140.0, 50.0, 40.0, 30.0, 30.0, 90.0, 0.0, 40.0, 90.0, 110.0, 40.0, -3.0, 7.0, 40.0, 10.0, 30.0, 100.0, 20.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 20.0, 0.0, 30.0, 40.0, 20.0, 18.0, 40.0, 7.0, 50.0, 130.0, 80.0, 35.0, 70.0, 90.0, 80.0, 64.0, 130.0, 132.0, 25.0, 40.0, 50.0, 15.0, 10.0, 40.0, 50.0, 50.0, 30.0, 17.0, 100.0, 40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0, 60.0, 30.0, 40.0, 60.0, 26.0, 60.0, -11.0, 90.0, 100.0, 18.0, 40.0, 100.0, 120.0, 30.0, 60.0, 70.0, 60.0, 130.0, 80.0, 40.0, 110.0, 57.0, 60.0, 55.0, 70.0, 50.0, 40.0, 49.0, 30.0, 30.0, 85.0, 40.0, 45.0, 40.0, 60.0, 20.0, 30.0, 20.0, 50.0, 30.0, 60.0, 10.0, -30.0, 90.0, 90.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 25.0, 105.0, 70.0, 50.0, 70.0, 30.0, 110.0, 70.0, 60.0, 70.0, 50.0, 65.0, 80.0, 25.0, 90.0, 80.0, 8.0, 31.0, 100.0, 50.0, 50.0, -1.0, 118.0, 130.0, 100.0, 47.0, -7.0, -17.0, 40.0, 40.0, 60.0, 70.0, 4.0, 30.0, 100.0, 60.0, 90.0, 100.0, 50.0, 40.0, 30.0, 0.0, 50.0, 20.0, 90.0, 40.0, 100.0, 90.0, 160.0, 92.0, 40.0, 70.0, 130.0, 109.0, 90.0, 89.0, 64.0, 90.0, 70.0, 87.0, 90.0, 56.0, 50.0, 10.0, 70.0, 46.0, 22.0, 30.0, 40.0, 50.0, 60.0, 25.0, 100.0, 90.0, 73.0, 20.0, 58.0, 40.0, 60.0, 40.0, 40.0, 85.0, 75.0, 100.0, 90.0, 60.0, 120.0, 20.0, 124.0, 50.0, 37.0, 140.0, 3.0, 90.0, 63.0, 70.0, 120.0, 90.0, 70.0, 20.0, 80.0, 60.0, 70.0, 70.0, 100.0, 60.0, 90.0, 100.0, 150.0, 80.0, 40.0, 130.0, 60.0, 80.0, 50.0, 30.0, 80.0, 40.0, 40.0, 10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0, 0.0, 0.0, 40.0, 50.0, 0.0, 30.0, 23.0, 40.0, 0.0, 29.0, 20.0, 70.0, 70.0, 50.0, 45.0, 30.0, 50.0, 70.0, 40.0, 60.0, 49.0, 100.0, 110.0, 75.0, 70.0, 140.0, 50.0, 140.0, 100.0, 100.0, 70.0, 50.0, 20.0, 50.0, 30.0, 60.0, 60.0, 60.0, 60.0, 20.0, 5.0, 40.0, 100.0, 70.0, 80.0, 14.0, 40.0, 47.0, 100.0, 6.0, 70.0, 90.0, 40.0, 40.0, 50.0, 160.0, 19.0, 90.0, 35.0, 110.0, 30.0, 60.0, 60.0, 130.0, 60.0, 70.0, 30.0, 190.0, 60.0, 70.0, 120.0, 110.0, 76.0, 32.0, 65.0, 90.0, 90.0, 30.0, 30.0, 60.0, 40.0, 49.0, 40.0, 20.0, 50.0, 80.0, 50.0, 30.0, 50.0, 36.0, 40.0, 60.0, 70.0, 80.0, 60.0, 20.0, 150.0, 90.0, 50.0, 67.0, 30.0, 0.0, 20.0, 10.0, 40.0, 100.0, 20.0, 38.0, 30.0, 11.0, 30.0, 40.0, 50.0, 0.0, 90.0, 11.0, 136.0, 110.0, 50.0, 85.0, 70.0, 30.0, 110.0, 100.0, 50.0, 70.0, 90.0, 70.0, 50.0, 70.0, 130.0, 80.0, 60.0, 20.0, 50.0, 95.0, 80.0, 75.0, 79.0, 110.0, 120.0, 50.0, 40.0, 110.0, 40.0, 90.0, 70.0, 50.0, 19.0, 60.0, 80.0, 139.0, 90.0, 70.0, 20.0, 70.0, 40.0, 30.0, 130.0, 70.0, 90.0, 120.0, 130.0, 30.0, 80.0, 60.0, 140.0, 69.0, 40.0, 20.0, 60.0, 34.0, 110.0, 30.0, 95.0, 25.0, 37.0, 73.0, 70.0, 90.0, 47.0, 50.0, 4.0, 31.0, 90.0, 60.0, 10.0, 58.0, 40.0, -10.0, 80.0, 80.0, 50.0, 20.0, 70.0, 60.0, 100.0, 60.0, 70.0, 110.0, 40.0, 30.0, 30.0, 68.0, 30.0, 48.0, 30.0, 50.0, 50.0, 90.0, 60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0, 85.0, 20.0, 80.0, 60.0, 90.0, 40.0, 70.0, 50.0, 150.0, 10.0, 30.0, 49.0, 70.0, 50.0, 70.0, 160.0, 70.0, 59.0, 20.0, 50.0, 100.0, 160.0, 12.0, -55.0, 70.0, 90.0, 74.0, 60.0, 100.0, 50.0, 60.0, 80.0, 25.0, 60.0, 40.0, 70.0, 20.0, 50.0, 30.0, 55.0, 110.0, 140.0, 75.0, 64.0, 80.0, 160.0, 100.0, 75.0, 110.0, 120.0, 52.0, 80.0, 60.0, 20.0, 23.0, 19.0, 4.0, 110.0, 70.0, 30.0, 60.0, 120.0, 4.0, 50.0, 30.0, 140.0, 118.0, 80.0, 45.0, 40.0, 90.0, 0.0, 50.0, -6.0, 40.0, 120.0, 70.0, -5.0, 60.0, 80.0, 150.0, 64.0, 80.0, 60.0, 100.0, 80.0, 67.0, 70.0, 0.0, 90.0, 60.0, 20.0, 60.0, 160.0, 30.0, 50.0, 80.0, 10.0, 40.0, 60.0, 0.0, 14.0, 10.0, 66.0, 10.0, 7.0, 60.0, 60.0, 63.0, 80.0, 10.0, 80.0, 77.0, 79.0, 150.0, 110.0, 30.0, 109.0, 30.0, 88.0, 60.0, 40.0, 100.0, 70.0, 60.0, 10.0, 90.0, 50.0, 90.0, 180.0, 150.0, 30.0, 45.0, 54.0, 100.0, 100.0, 90.0, 51.0, 60.0, 29.0, 0.0, 90.0, 40.0, 80.0, 30.0, 18.0, 30.0, 0.0, 80.0, 7.0, 90.0, 30.0, 10.0, 50.0, 110.0, 80.0, 9.0, 20.0, 110.0, 50.0, 25.0, 90.0, 36.0, 140.0, 57.0, 113.0, 60.0, 58.0, 60.0, -9.0, -2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5324868540446288, "mean_inference_ms": 1.5383552165030605, "mean_action_processing_ms": 0.48902278674830363, "mean_env_wait_ms": 1.343734111781181, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013147115707397461, "StateBufferConnector_ms": 0.009325027465820312, "ViewRequirementAgentConnector_ms": 0.3910868167877197}, "num_episodes": 18, "episode_return_max": 1034.0, "episode_return_min": 195.0, "episode_return_mean": 589.81}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.539133377828826, "num_env_steps_trained_throughput_per_sec": 21.539133377828826, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 185369.199, "restore_workers_time_ms": 0.013, "training_step_time_ms": 185369.15, "sample_time_ms": 2418.174, "learn_time_ms": 182930.538, "learn_throughput": 21.866, "synch_weights_time_ms": 12.221}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "a22d3_00000", "date": "2024-08-06_05-16-32", "timestamp": 1722935792, "time_this_iter_s": 185.71760988235474, "time_total_s": 23582.60100054741, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23582.60100054741, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 18.74220532319391, "ram_util_percent": 77.53992395437263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8656816955826407, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.012355683278416395, "vf_loss": 7.2755569733242895, "vf_explained_var": 0.021440532298895497, "kl": Infinity, "entropy": 0.498512604061407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1050.0, "episode_reward_min": 195.0, "episode_reward_mean": 591.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -74.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 59.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [581.0, 365.0, 521.0, 512.0, 710.0, 610.0, 388.0, 560.0, 671.0, 565.0, 590.0, 517.0, 354.0, 318.0, 457.0, 410.0, 195.0, 678.0, 434.0, 430.0, 265.0, 836.0, 402.0, 700.0, 473.0, 730.0, 551.0, 420.0, 520.0, 630.0, 599.0, 510.0, 604.0, 620.0, 844.0, 501.0, 576.0, 754.0, 733.0, 800.0, 630.0, 318.0, 212.0, 505.0, 934.0, 480.0, 502.0, 704.0, 760.0, 703.0, 445.0, 687.0, 299.0, 602.0, 710.0, 779.0, 649.0, 739.0, 779.0, 624.0, 380.0, 700.0, 466.0, 600.0, 655.0, 628.0, 661.0, 490.0, 1034.0, 468.0, 687.0, 499.0, 761.0, 570.0, 370.0, 763.0, 750.0, 709.0, 375.0, 559.0, 630.0, 813.0, 539.0, 890.0, 631.0, 505.0, 595.0, 760.0, 1050.0, 865.0, 510.0, 462.0, 460.0, 752.0, 588.0, 546.0, 745.0, 365.0, 674.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 60.0, 70.0, 100.0, 90.0, 30.0, 47.0, 30.0, 4.0, 100.0, 30.0, 31.0, 3.0, 50.0, 20.0, 100.0, -37.0, 28.0, 90.0, 50.0, 80.0, 40.0, 50.0, 55.0, 0.0, 50.0, 100.0, 100.0, -4.0, 50.0, 80.0, 30.0, -3.0, 70.0, 20.0, 80.0, 80.0, 60.0, 60.0, 35.0, 50.0, 60.0, 100.0, 70.0, 50.0, 90.0, 70.0, 40.0, 110.0, 70.0, 120.0, 90.0, 40.0, 40.0, 60.0, 60.0, 50.0, 70.0, 10.0, 70.0, 30.0, 20.0, -7.0, 20.0, 108.0, 70.0, 69.0, 50.0, 20.0, 8.0, 50.0, 60.0, 40.0, 60.0, 110.0, 10.0, 50.0, 100.0, 60.0, 20.0, 80.0, 60.0, 20.0, 35.0, 140.0, 26.0, 110.0, 40.0, 70.0, 90.0, 70.0, 76.0, 110.0, -6.0, 50.0, 80.0, 80.0, 25.0, 50.0, 30.0, 90.0, 30.0, 80.0, 60.0, 50.0, 20.0, 30.0, 100.0, 50.0, 80.0, 60.0, 27.0, 5.0, 30.0, 80.0, 110.0, 80.0, 30.0, 15.0, 80.0, 10.0, 20.0, 20.0, 7.0, 30.0, 40.0, 110.0, 27.0, 30.0, 60.0, 60.0, 20.0, 10.0, 120.0, 20.0, 10.0, 10.0, 20.0, 18.0, 30.0, 50.0, 70.0, 90.0, 14.0, 9.0, 50.0, 50.0, 70.0, -15.0, 69.0, 40.0, 10.0, 30.0, 100.0, 30.0, 20.0, 50.0, 80.0, 20.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 27.0, -20.0, 0.0, 68.0, 60.0, 40.0, 120.0, 28.0, 30.0, 40.0, 130.0, 140.0, 50.0, 40.0, 30.0, 30.0, 90.0, 0.0, 40.0, 90.0, 110.0, 40.0, -3.0, 7.0, 40.0, 10.0, 30.0, 100.0, 20.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 20.0, 0.0, 30.0, 40.0, 20.0, 18.0, 40.0, 7.0, 50.0, 130.0, 80.0, 35.0, 70.0, 90.0, 80.0, 64.0, 130.0, 132.0, 25.0, 40.0, 50.0, 15.0, 10.0, 40.0, 50.0, 50.0, 30.0, 17.0, 100.0, 40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0, 60.0, 30.0, 40.0, 60.0, 26.0, 60.0, -11.0, 90.0, 100.0, 18.0, 40.0, 100.0, 120.0, 30.0, 60.0, 70.0, 60.0, 130.0, 80.0, 40.0, 110.0, 57.0, 60.0, 55.0, 70.0, 50.0, 40.0, 49.0, 30.0, 30.0, 85.0, 40.0, 45.0, 40.0, 60.0, 20.0, 30.0, 20.0, 50.0, 30.0, 60.0, 10.0, -30.0, 90.0, 90.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 25.0, 105.0, 70.0, 50.0, 70.0, 30.0, 110.0, 70.0, 60.0, 70.0, 50.0, 65.0, 80.0, 25.0, 90.0, 80.0, 8.0, 31.0, 100.0, 50.0, 50.0, -1.0, 118.0, 130.0, 100.0, 47.0, -7.0, -17.0, 40.0, 40.0, 60.0, 70.0, 4.0, 30.0, 100.0, 60.0, 90.0, 100.0, 50.0, 40.0, 30.0, 0.0, 50.0, 20.0, 90.0, 40.0, 100.0, 90.0, 160.0, 92.0, 40.0, 70.0, 130.0, 109.0, 90.0, 89.0, 64.0, 90.0, 70.0, 87.0, 90.0, 56.0, 50.0, 10.0, 70.0, 46.0, 22.0, 30.0, 40.0, 50.0, 60.0, 25.0, 100.0, 90.0, 73.0, 20.0, 58.0, 40.0, 60.0, 40.0, 40.0, 85.0, 75.0, 100.0, 90.0, 60.0, 120.0, 20.0, 124.0, 50.0, 37.0, 140.0, 3.0, 90.0, 63.0, 70.0, 120.0, 90.0, 70.0, 20.0, 80.0, 60.0, 70.0, 70.0, 100.0, 60.0, 90.0, 100.0, 150.0, 80.0, 40.0, 130.0, 60.0, 80.0, 50.0, 30.0, 80.0, 40.0, 40.0, 10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0, 0.0, 0.0, 40.0, 50.0, 0.0, 30.0, 23.0, 40.0, 0.0, 29.0, 20.0, 70.0, 70.0, 50.0, 45.0, 30.0, 50.0, 70.0, 40.0, 60.0, 49.0, 100.0, 110.0, 75.0, 70.0, 140.0, 50.0, 140.0, 100.0, 100.0, 70.0, 50.0, 20.0, 50.0, 30.0, 60.0, 60.0, 60.0, 60.0, 20.0, 5.0, 40.0, 100.0, 70.0, 80.0, 14.0, 40.0, 47.0, 100.0, 6.0, 70.0, 90.0, 40.0, 40.0, 50.0, 160.0, 19.0, 90.0, 35.0, 110.0, 30.0, 60.0, 60.0, 130.0, 60.0, 70.0, 30.0, 190.0, 60.0, 70.0, 120.0, 110.0, 76.0, 32.0, 65.0, 90.0, 90.0, 30.0, 30.0, 60.0, 40.0, 49.0, 40.0, 20.0, 50.0, 80.0, 50.0, 30.0, 50.0, 36.0, 40.0, 60.0, 70.0, 80.0, 60.0, 20.0, 150.0, 90.0, 50.0, 67.0, 30.0, 0.0, 20.0, 10.0, 40.0, 100.0, 20.0, 38.0, 30.0, 11.0, 30.0, 40.0, 50.0, 0.0, 90.0, 11.0, 136.0, 110.0, 50.0, 85.0, 70.0, 30.0, 110.0, 100.0, 50.0, 70.0, 90.0, 70.0, 50.0, 70.0, 130.0, 80.0, 60.0, 20.0, 50.0, 95.0, 80.0, 75.0, 79.0, 110.0, 120.0, 50.0, 40.0, 110.0, 40.0, 90.0, 70.0, 50.0, 19.0, 60.0, 80.0, 139.0, 90.0, 70.0, 20.0, 70.0, 40.0, 30.0, 130.0, 70.0, 90.0, 120.0, 130.0, 30.0, 80.0, 60.0, 140.0, 69.0, 40.0, 20.0, 60.0, 34.0, 110.0, 30.0, 95.0, 25.0, 37.0, 73.0, 70.0, 90.0, 47.0, 50.0, 4.0, 31.0, 90.0, 60.0, 10.0, 58.0, 40.0, -10.0, 80.0, 80.0, 50.0, 20.0, 70.0, 60.0, 100.0, 60.0, 70.0, 110.0, 40.0, 30.0, 30.0, 68.0, 30.0, 48.0, 30.0, 50.0, 50.0, 90.0, 60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0, 85.0, 20.0, 80.0, 60.0, 90.0, 40.0, 70.0, 50.0, 150.0, 10.0, 30.0, 49.0, 70.0, 50.0, 70.0, 160.0, 70.0, 59.0, 20.0, 50.0, 100.0, 160.0, 12.0, -55.0, 70.0, 90.0, 74.0, 60.0, 100.0, 50.0, 60.0, 80.0, 25.0, 60.0, 40.0, 70.0, 20.0, 50.0, 30.0, 55.0, 110.0, 140.0, 75.0, 64.0, 80.0, 160.0, 100.0, 75.0, 110.0, 120.0, 52.0, 80.0, 60.0, 20.0, 23.0, 19.0, 4.0, 110.0, 70.0, 30.0, 60.0, 120.0, 4.0, 50.0, 30.0, 140.0, 118.0, 80.0, 45.0, 40.0, 90.0, 0.0, 50.0, -6.0, 40.0, 120.0, 70.0, -5.0, 60.0, 80.0, 150.0, 64.0, 80.0, 60.0, 100.0, 80.0, 67.0, 70.0, 0.0, 90.0, 60.0, 20.0, 60.0, 160.0, 30.0, 50.0, 80.0, 10.0, 40.0, 60.0, 0.0, 14.0, 10.0, 66.0, 10.0, 7.0, 60.0, 60.0, 63.0, 80.0, 10.0, 80.0, 77.0, 79.0, 150.0, 110.0, 30.0, 109.0, 30.0, 88.0, 60.0, 40.0, 100.0, 70.0, 60.0, 10.0, 90.0, 50.0, 90.0, 180.0, 150.0, 30.0, 45.0, 54.0, 100.0, 100.0, 90.0, 51.0, 60.0, 29.0, 0.0, 90.0, 40.0, 80.0, 30.0, 18.0, 30.0, 0.0, 80.0, 7.0, 90.0, 30.0, 10.0, 50.0, 110.0, 80.0, 9.0, 20.0, 110.0, 50.0, 25.0, 90.0, 36.0, 140.0, 57.0, 113.0, 60.0, 58.0, 60.0, -9.0, -2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0, 10.0, 80.0, 70.0, 37.0, 30.0, 100.0, 26.0, 69.0, 80.0, 37.0, 150.0, 80.0, 40.0, 70.0, 50.0, 110.0, 110.0, 90.0, 60.0, 130.0, 90.0, 40.0, 100.0, -4.0, 100.0, 70.0, 80.0, 45.0, 30.0, 80.0, 110.0, 30.0, 27.0, 50.0, 20.0, 30.0, 110.0, 70.0, 33.0, 25.0, 60.0, 40.0, 98.0, 30.0, 80.0, 20.0, 27.0, 20.0, 120.0, 100.0, 40.0, 70.0, 60.0, 30.0, 50.0, 70.0, 150.0, 100.0, 90.0, 100.0, 90.0, 60.0, 140.0, 70.0, 120.0, 120.0, 60.0, 150.0, 140.0, 100.0, 50.0, 111.0, 120.0, 90.0, 80.0, 120.0, 100.0, 125.0, 29.0, 40.0, 30.0, 70.0, 100.0, 60.0, 50.0, 80.0, 20.0, 30.0, 20.0, 50.0, 100.0, 16.0, 60.0, 50.0, 100.0, 50.0, 20.0, 56.0, -45.0, 55.0, 26.0, 8.0, 30.0, 40.0, 40.0, 80.0, 50.0, 26.0, 110.0, 50.0, -55.0, 110.0, 60.0, 50.0, 160.0, 70.0, 84.0, 33.0, 170.0, 70.0, 47.0, 70.0, 60.0, 140.0, -4.0, 20.0, 20.0, 130.0, 45.0, 60.0, 120.0, -74.0, 80.0, -34.0, 100.0, 100.0, 110.0, 78.0, 25.0, 41.0, 110.0, 90.0, 130.0, 30.0, 30.0, 160.0, 35.0, 60.0, 50.0, 50.0, 70.0, 0.0, 70.0, 30.0, 20.0, 40.0, 70.0, 40.0, -5.0, 30.0, 80.0, 100.0, 50.0, 30.0, 28.0, 100.0, 90.0, 26.0, 60.0, 110.0, 30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5319124283215462, "mean_inference_ms": 1.5372359199060235, "mean_action_processing_ms": 0.48869122803722426, "mean_env_wait_ms": 1.343072436789243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013162612915039062, "StateBufferConnector_ms": 0.009320259094238281, "ViewRequirementAgentConnector_ms": 0.3918919563293457}, "num_episodes": 18, "episode_return_max": 1050.0, "episode_return_min": 195.0, "episode_return_mean": 591.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.720625043416092, "num_env_steps_trained_throughput_per_sec": 21.720625043416092, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 185122.189, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185122.142, "sample_time_ms": 2421.047, "learn_time_ms": 182680.624, "learn_throughput": 21.896, "synch_weights_time_ms": 12.037}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "a22d3_00000", "date": "2024-08-06_05-19-36", "timestamp": 1722935976, "time_this_iter_s": 184.163743019104, "time_total_s": 23766.764743566513, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a357a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23766.764743566513, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.093869731800766, "ram_util_percent": 77.11532567049808}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0483703641337963, "cur_kl_coeff": 0.72081298828125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010245669052189293, "vf_loss": 7.100173127232268, "vf_explained_var": 0.005027246545044124, "kl": Infinity, "entropy": 0.5132035979162008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 1050.0, "episode_reward_min": 212.0, "episode_reward_mean": 637.72, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -74.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 63.772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 473.0, 730.0, 551.0, 420.0, 520.0, 630.0, 599.0, 510.0, 604.0, 620.0, 844.0, 501.0, 576.0, 754.0, 733.0, 800.0, 630.0, 318.0, 212.0, 505.0, 934.0, 480.0, 502.0, 704.0, 760.0, 703.0, 445.0, 687.0, 299.0, 602.0, 710.0, 779.0, 649.0, 739.0, 779.0, 624.0, 380.0, 700.0, 466.0, 600.0, 655.0, 628.0, 661.0, 490.0, 1034.0, 468.0, 687.0, 499.0, 761.0, 570.0, 370.0, 763.0, 750.0, 709.0, 375.0, 559.0, 630.0, 813.0, 539.0, 890.0, 631.0, 505.0, 595.0, 760.0, 1050.0, 865.0, 510.0, 462.0, 460.0, 752.0, 588.0, 546.0, 745.0, 365.0, 674.0, 610.0, 530.0, 468.0, 322.0, 998.0, 787.0, 680.0, 580.0, 627.0, 927.0, 830.0, 910.0, 599.0, 892.0, 609.0, 794.0, 852.0, 914.0, 547.0, 357.0, 628.0, 870.0, 760.0, 550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 80.0, 40.0, 50.0, 70.0, 70.0, 130.0, 60.0, 110.0, 50.0, 60.0, 30.0, 40.0, 60.0, 26.0, 60.0, -11.0, 90.0, 100.0, 18.0, 40.0, 100.0, 120.0, 30.0, 60.0, 70.0, 60.0, 130.0, 80.0, 40.0, 110.0, 57.0, 60.0, 55.0, 70.0, 50.0, 40.0, 49.0, 30.0, 30.0, 85.0, 40.0, 45.0, 40.0, 60.0, 20.0, 30.0, 20.0, 50.0, 30.0, 60.0, 10.0, -30.0, 90.0, 90.0, 40.0, 40.0, 80.0, 50.0, 90.0, 40.0, 25.0, 105.0, 70.0, 50.0, 70.0, 30.0, 110.0, 70.0, 60.0, 70.0, 50.0, 65.0, 80.0, 25.0, 90.0, 80.0, 8.0, 31.0, 100.0, 50.0, 50.0, -1.0, 118.0, 130.0, 100.0, 47.0, -7.0, -17.0, 40.0, 40.0, 60.0, 70.0, 4.0, 30.0, 100.0, 60.0, 90.0, 100.0, 50.0, 40.0, 30.0, 0.0, 50.0, 20.0, 90.0, 40.0, 100.0, 90.0, 160.0, 92.0, 40.0, 70.0, 130.0, 109.0, 90.0, 89.0, 64.0, 90.0, 70.0, 87.0, 90.0, 56.0, 50.0, 10.0, 70.0, 46.0, 22.0, 30.0, 40.0, 50.0, 60.0, 25.0, 100.0, 90.0, 73.0, 20.0, 58.0, 40.0, 60.0, 40.0, 40.0, 85.0, 75.0, 100.0, 90.0, 60.0, 120.0, 20.0, 124.0, 50.0, 37.0, 140.0, 3.0, 90.0, 63.0, 70.0, 120.0, 90.0, 70.0, 20.0, 80.0, 60.0, 70.0, 70.0, 100.0, 60.0, 90.0, 100.0, 150.0, 80.0, 40.0, 130.0, 60.0, 80.0, 50.0, 30.0, 80.0, 40.0, 40.0, 10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0, 0.0, 0.0, 40.0, 50.0, 0.0, 30.0, 23.0, 40.0, 0.0, 29.0, 20.0, 70.0, 70.0, 50.0, 45.0, 30.0, 50.0, 70.0, 40.0, 60.0, 49.0, 100.0, 110.0, 75.0, 70.0, 140.0, 50.0, 140.0, 100.0, 100.0, 70.0, 50.0, 20.0, 50.0, 30.0, 60.0, 60.0, 60.0, 60.0, 20.0, 5.0, 40.0, 100.0, 70.0, 80.0, 14.0, 40.0, 47.0, 100.0, 6.0, 70.0, 90.0, 40.0, 40.0, 50.0, 160.0, 19.0, 90.0, 35.0, 110.0, 30.0, 60.0, 60.0, 130.0, 60.0, 70.0, 30.0, 190.0, 60.0, 70.0, 120.0, 110.0, 76.0, 32.0, 65.0, 90.0, 90.0, 30.0, 30.0, 60.0, 40.0, 49.0, 40.0, 20.0, 50.0, 80.0, 50.0, 30.0, 50.0, 36.0, 40.0, 60.0, 70.0, 80.0, 60.0, 20.0, 150.0, 90.0, 50.0, 67.0, 30.0, 0.0, 20.0, 10.0, 40.0, 100.0, 20.0, 38.0, 30.0, 11.0, 30.0, 40.0, 50.0, 0.0, 90.0, 11.0, 136.0, 110.0, 50.0, 85.0, 70.0, 30.0, 110.0, 100.0, 50.0, 70.0, 90.0, 70.0, 50.0, 70.0, 130.0, 80.0, 60.0, 20.0, 50.0, 95.0, 80.0, 75.0, 79.0, 110.0, 120.0, 50.0, 40.0, 110.0, 40.0, 90.0, 70.0, 50.0, 19.0, 60.0, 80.0, 139.0, 90.0, 70.0, 20.0, 70.0, 40.0, 30.0, 130.0, 70.0, 90.0, 120.0, 130.0, 30.0, 80.0, 60.0, 140.0, 69.0, 40.0, 20.0, 60.0, 34.0, 110.0, 30.0, 95.0, 25.0, 37.0, 73.0, 70.0, 90.0, 47.0, 50.0, 4.0, 31.0, 90.0, 60.0, 10.0, 58.0, 40.0, -10.0, 80.0, 80.0, 50.0, 20.0, 70.0, 60.0, 100.0, 60.0, 70.0, 110.0, 40.0, 30.0, 30.0, 68.0, 30.0, 48.0, 30.0, 50.0, 50.0, 90.0, 60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0, 85.0, 20.0, 80.0, 60.0, 90.0, 40.0, 70.0, 50.0, 150.0, 10.0, 30.0, 49.0, 70.0, 50.0, 70.0, 160.0, 70.0, 59.0, 20.0, 50.0, 100.0, 160.0, 12.0, -55.0, 70.0, 90.0, 74.0, 60.0, 100.0, 50.0, 60.0, 80.0, 25.0, 60.0, 40.0, 70.0, 20.0, 50.0, 30.0, 55.0, 110.0, 140.0, 75.0, 64.0, 80.0, 160.0, 100.0, 75.0, 110.0, 120.0, 52.0, 80.0, 60.0, 20.0, 23.0, 19.0, 4.0, 110.0, 70.0, 30.0, 60.0, 120.0, 4.0, 50.0, 30.0, 140.0, 118.0, 80.0, 45.0, 40.0, 90.0, 0.0, 50.0, -6.0, 40.0, 120.0, 70.0, -5.0, 60.0, 80.0, 150.0, 64.0, 80.0, 60.0, 100.0, 80.0, 67.0, 70.0, 0.0, 90.0, 60.0, 20.0, 60.0, 160.0, 30.0, 50.0, 80.0, 10.0, 40.0, 60.0, 0.0, 14.0, 10.0, 66.0, 10.0, 7.0, 60.0, 60.0, 63.0, 80.0, 10.0, 80.0, 77.0, 79.0, 150.0, 110.0, 30.0, 109.0, 30.0, 88.0, 60.0, 40.0, 100.0, 70.0, 60.0, 10.0, 90.0, 50.0, 90.0, 180.0, 150.0, 30.0, 45.0, 54.0, 100.0, 100.0, 90.0, 51.0, 60.0, 29.0, 0.0, 90.0, 40.0, 80.0, 30.0, 18.0, 30.0, 0.0, 80.0, 7.0, 90.0, 30.0, 10.0, 50.0, 110.0, 80.0, 9.0, 20.0, 110.0, 50.0, 25.0, 90.0, 36.0, 140.0, 57.0, 113.0, 60.0, 58.0, 60.0, -9.0, -2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0, 10.0, 80.0, 70.0, 37.0, 30.0, 100.0, 26.0, 69.0, 80.0, 37.0, 150.0, 80.0, 40.0, 70.0, 50.0, 110.0, 110.0, 90.0, 60.0, 130.0, 90.0, 40.0, 100.0, -4.0, 100.0, 70.0, 80.0, 45.0, 30.0, 80.0, 110.0, 30.0, 27.0, 50.0, 20.0, 30.0, 110.0, 70.0, 33.0, 25.0, 60.0, 40.0, 98.0, 30.0, 80.0, 20.0, 27.0, 20.0, 120.0, 100.0, 40.0, 70.0, 60.0, 30.0, 50.0, 70.0, 150.0, 100.0, 90.0, 100.0, 90.0, 60.0, 140.0, 70.0, 120.0, 120.0, 60.0, 150.0, 140.0, 100.0, 50.0, 111.0, 120.0, 90.0, 80.0, 120.0, 100.0, 125.0, 29.0, 40.0, 30.0, 70.0, 100.0, 60.0, 50.0, 80.0, 20.0, 30.0, 20.0, 50.0, 100.0, 16.0, 60.0, 50.0, 100.0, 50.0, 20.0, 56.0, -45.0, 55.0, 26.0, 8.0, 30.0, 40.0, 40.0, 80.0, 50.0, 26.0, 110.0, 50.0, -55.0, 110.0, 60.0, 50.0, 160.0, 70.0, 84.0, 33.0, 170.0, 70.0, 47.0, 70.0, 60.0, 140.0, -4.0, 20.0, 20.0, 130.0, 45.0, 60.0, 120.0, -74.0, 80.0, -34.0, 100.0, 100.0, 110.0, 78.0, 25.0, 41.0, 110.0, 90.0, 130.0, 30.0, 30.0, 160.0, 35.0, 60.0, 50.0, 50.0, 70.0, 0.0, 70.0, 30.0, 20.0, 40.0, 70.0, 40.0, -5.0, 30.0, 80.0, 100.0, 50.0, 30.0, 28.0, 100.0, 90.0, 26.0, 60.0, 110.0, 30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0, 80.0, 20.0, 40.0, 90.0, 20.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 40.0, 50.0, 60.0, 130.0, 60.0, 30.0, 19.0, 39.0, 30.0, 20.0, 40.0, 20.0, -8.0, 17.0, 100.0, 20.0, 53.0, 30.0, 30.0, 70.0, 80.0, 130.0, 110.0, 119.0, 60.0, 80.0, 90.0, 179.0, 80.0, 70.0, 49.0, 90.0, 180.0, 29.0, 80.0, 39.0, 50.0, 130.0, 70.0, 90.0, 70.0, 50.0, 50.0, 60.0, 90.0, 80.0, 80.0, 80.0, 30.0, 45.0, 25.0, 60.0, 70.0, 80.0, 60.0, 80.0, 50.0, 50.0, 60.0, 36.0, 65.0, 40.0, 50.0, 60.0, 20.0, 60.0, 26.0, 120.0, 150.0, 60.0, 110.0, 140.0, 160.0, 70.0, 70.0, 70.0, 68.0, 80.0, 99.0, 40.0, 110.0, 150.0, 50.0, 100.0, 120.0, 110.0, 30.0, 60.0, 60.0, 100.0, 130.0, 120.0, 70.0, 40.0, 90.0, 80.0, 80.0, 130.0, 70.0, 35.0, 28.0, 90.0, 60.0, 38.0, 140.0, 50.0, 50.0, 80.0, 28.0, 90.0, 90.0, 100.0, 140.0, 78.0, 24.0, 140.0, 60.0, 120.0, 50.0, 50.0, 89.0, 50.0, 80.0, 40.0, 100.0, 40.0, 40.0, 50.0, 70.0, 40.0, 17.0, 110.0, 110.0, 80.0, 90.0, 70.0, 170.0, 37.0, 70.0, 90.0, 60.0, 70.0, 80.0, 37.0, 65.0, 120.0, 90.0, 140.0, 100.0, 79.0, 125.0, 140.0, 70.0, 50.0, 50.0, 100.0, 140.0, 90.0, 70.0, 80.0, 90.0, -27.0, 60.0, 10.0, 93.0, 60.0, 130.0, 60.0, -9.0, 10.0, 20.0, 40.0, 10.0, 29.0, 70.0, 120.0, 20.0, 9.0, 29.0, 42.0, 50.0, 120.0, 60.0, 50.0, 80.0, 41.0, 22.0, 120.0, 43.0, 120.0, 90.0, 100.0, 90.0, 60.0, 90.0, 90.0, 70.0, 100.0, 60.0, 40.0, 30.0, 120.0, 20.0, 40.0, 150.0, 120.0, 150.0, 70.0, 20.0, 50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5310678373286608, "mean_inference_ms": 1.5358374259239704, "mean_action_processing_ms": 0.4882374141226361, "mean_env_wait_ms": 1.342184109856163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013139724731445312, "StateBufferConnector_ms": 0.009513616561889648, "ViewRequirementAgentConnector_ms": 0.3909757137298584}, "num_episodes": 23, "episode_return_max": 1050.0, "episode_return_min": 212.0, "episode_return_mean": 637.72}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.764591798835855, "num_env_steps_trained_throughput_per_sec": 21.764591798835855, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 184825.108, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184825.061, "sample_time_ms": 2382.032, "learn_time_ms": 182422.599, "learn_throughput": 21.927, "synch_weights_time_ms": 12.038}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "a22d3_00000", "date": "2024-08-06_05-22-40", "timestamp": 1722936160, "time_this_iter_s": 183.79341411590576, "time_total_s": 23950.55815768242, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356adc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23950.55815768242, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.161389961389958, "ram_util_percent": 77.56100386100385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1087493189607565, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.8796703825108665, "policy_loss": -0.009750325602396958, "vf_loss": 6.88578858731019, "vf_explained_var": 0.0010063682818692078, "kl": 0.0033592800994213462, "entropy": 0.5222118582651892, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 1050.0, "episode_reward_min": 212.0, "episode_reward_mean": 643.99, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -74.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 64.399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.0, 212.0, 505.0, 934.0, 480.0, 502.0, 704.0, 760.0, 703.0, 445.0, 687.0, 299.0, 602.0, 710.0, 779.0, 649.0, 739.0, 779.0, 624.0, 380.0, 700.0, 466.0, 600.0, 655.0, 628.0, 661.0, 490.0, 1034.0, 468.0, 687.0, 499.0, 761.0, 570.0, 370.0, 763.0, 750.0, 709.0, 375.0, 559.0, 630.0, 813.0, 539.0, 890.0, 631.0, 505.0, 595.0, 760.0, 1050.0, 865.0, 510.0, 462.0, 460.0, 752.0, 588.0, 546.0, 745.0, 365.0, 674.0, 610.0, 530.0, 468.0, 322.0, 998.0, 787.0, 680.0, 580.0, 627.0, 927.0, 830.0, 910.0, 599.0, 892.0, 609.0, 794.0, 852.0, 914.0, 547.0, 357.0, 628.0, 870.0, 760.0, 550.0, 566.0, 271.0, 799.0, 430.0, 599.0, 700.0, 920.0, 710.0, 250.0, 361.0, 737.0, 762.0, 982.0, 678.0, 900.0, 667.0, 747.0, 743.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 20.0, 110.0, 40.0, 20.0, 70.0, 10.0, -2.0, 40.0, 0.0, 0.0, 40.0, 50.0, 0.0, 30.0, 23.0, 40.0, 0.0, 29.0, 20.0, 70.0, 70.0, 50.0, 45.0, 30.0, 50.0, 70.0, 40.0, 60.0, 49.0, 100.0, 110.0, 75.0, 70.0, 140.0, 50.0, 140.0, 100.0, 100.0, 70.0, 50.0, 20.0, 50.0, 30.0, 60.0, 60.0, 60.0, 60.0, 20.0, 5.0, 40.0, 100.0, 70.0, 80.0, 14.0, 40.0, 47.0, 100.0, 6.0, 70.0, 90.0, 40.0, 40.0, 50.0, 160.0, 19.0, 90.0, 35.0, 110.0, 30.0, 60.0, 60.0, 130.0, 60.0, 70.0, 30.0, 190.0, 60.0, 70.0, 120.0, 110.0, 76.0, 32.0, 65.0, 90.0, 90.0, 30.0, 30.0, 60.0, 40.0, 49.0, 40.0, 20.0, 50.0, 80.0, 50.0, 30.0, 50.0, 36.0, 40.0, 60.0, 70.0, 80.0, 60.0, 20.0, 150.0, 90.0, 50.0, 67.0, 30.0, 0.0, 20.0, 10.0, 40.0, 100.0, 20.0, 38.0, 30.0, 11.0, 30.0, 40.0, 50.0, 0.0, 90.0, 11.0, 136.0, 110.0, 50.0, 85.0, 70.0, 30.0, 110.0, 100.0, 50.0, 70.0, 90.0, 70.0, 50.0, 70.0, 130.0, 80.0, 60.0, 20.0, 50.0, 95.0, 80.0, 75.0, 79.0, 110.0, 120.0, 50.0, 40.0, 110.0, 40.0, 90.0, 70.0, 50.0, 19.0, 60.0, 80.0, 139.0, 90.0, 70.0, 20.0, 70.0, 40.0, 30.0, 130.0, 70.0, 90.0, 120.0, 130.0, 30.0, 80.0, 60.0, 140.0, 69.0, 40.0, 20.0, 60.0, 34.0, 110.0, 30.0, 95.0, 25.0, 37.0, 73.0, 70.0, 90.0, 47.0, 50.0, 4.0, 31.0, 90.0, 60.0, 10.0, 58.0, 40.0, -10.0, 80.0, 80.0, 50.0, 20.0, 70.0, 60.0, 100.0, 60.0, 70.0, 110.0, 40.0, 30.0, 30.0, 68.0, 30.0, 48.0, 30.0, 50.0, 50.0, 90.0, 60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0, 85.0, 20.0, 80.0, 60.0, 90.0, 40.0, 70.0, 50.0, 150.0, 10.0, 30.0, 49.0, 70.0, 50.0, 70.0, 160.0, 70.0, 59.0, 20.0, 50.0, 100.0, 160.0, 12.0, -55.0, 70.0, 90.0, 74.0, 60.0, 100.0, 50.0, 60.0, 80.0, 25.0, 60.0, 40.0, 70.0, 20.0, 50.0, 30.0, 55.0, 110.0, 140.0, 75.0, 64.0, 80.0, 160.0, 100.0, 75.0, 110.0, 120.0, 52.0, 80.0, 60.0, 20.0, 23.0, 19.0, 4.0, 110.0, 70.0, 30.0, 60.0, 120.0, 4.0, 50.0, 30.0, 140.0, 118.0, 80.0, 45.0, 40.0, 90.0, 0.0, 50.0, -6.0, 40.0, 120.0, 70.0, -5.0, 60.0, 80.0, 150.0, 64.0, 80.0, 60.0, 100.0, 80.0, 67.0, 70.0, 0.0, 90.0, 60.0, 20.0, 60.0, 160.0, 30.0, 50.0, 80.0, 10.0, 40.0, 60.0, 0.0, 14.0, 10.0, 66.0, 10.0, 7.0, 60.0, 60.0, 63.0, 80.0, 10.0, 80.0, 77.0, 79.0, 150.0, 110.0, 30.0, 109.0, 30.0, 88.0, 60.0, 40.0, 100.0, 70.0, 60.0, 10.0, 90.0, 50.0, 90.0, 180.0, 150.0, 30.0, 45.0, 54.0, 100.0, 100.0, 90.0, 51.0, 60.0, 29.0, 0.0, 90.0, 40.0, 80.0, 30.0, 18.0, 30.0, 0.0, 80.0, 7.0, 90.0, 30.0, 10.0, 50.0, 110.0, 80.0, 9.0, 20.0, 110.0, 50.0, 25.0, 90.0, 36.0, 140.0, 57.0, 113.0, 60.0, 58.0, 60.0, -9.0, -2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0, 10.0, 80.0, 70.0, 37.0, 30.0, 100.0, 26.0, 69.0, 80.0, 37.0, 150.0, 80.0, 40.0, 70.0, 50.0, 110.0, 110.0, 90.0, 60.0, 130.0, 90.0, 40.0, 100.0, -4.0, 100.0, 70.0, 80.0, 45.0, 30.0, 80.0, 110.0, 30.0, 27.0, 50.0, 20.0, 30.0, 110.0, 70.0, 33.0, 25.0, 60.0, 40.0, 98.0, 30.0, 80.0, 20.0, 27.0, 20.0, 120.0, 100.0, 40.0, 70.0, 60.0, 30.0, 50.0, 70.0, 150.0, 100.0, 90.0, 100.0, 90.0, 60.0, 140.0, 70.0, 120.0, 120.0, 60.0, 150.0, 140.0, 100.0, 50.0, 111.0, 120.0, 90.0, 80.0, 120.0, 100.0, 125.0, 29.0, 40.0, 30.0, 70.0, 100.0, 60.0, 50.0, 80.0, 20.0, 30.0, 20.0, 50.0, 100.0, 16.0, 60.0, 50.0, 100.0, 50.0, 20.0, 56.0, -45.0, 55.0, 26.0, 8.0, 30.0, 40.0, 40.0, 80.0, 50.0, 26.0, 110.0, 50.0, -55.0, 110.0, 60.0, 50.0, 160.0, 70.0, 84.0, 33.0, 170.0, 70.0, 47.0, 70.0, 60.0, 140.0, -4.0, 20.0, 20.0, 130.0, 45.0, 60.0, 120.0, -74.0, 80.0, -34.0, 100.0, 100.0, 110.0, 78.0, 25.0, 41.0, 110.0, 90.0, 130.0, 30.0, 30.0, 160.0, 35.0, 60.0, 50.0, 50.0, 70.0, 0.0, 70.0, 30.0, 20.0, 40.0, 70.0, 40.0, -5.0, 30.0, 80.0, 100.0, 50.0, 30.0, 28.0, 100.0, 90.0, 26.0, 60.0, 110.0, 30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0, 80.0, 20.0, 40.0, 90.0, 20.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 40.0, 50.0, 60.0, 130.0, 60.0, 30.0, 19.0, 39.0, 30.0, 20.0, 40.0, 20.0, -8.0, 17.0, 100.0, 20.0, 53.0, 30.0, 30.0, 70.0, 80.0, 130.0, 110.0, 119.0, 60.0, 80.0, 90.0, 179.0, 80.0, 70.0, 49.0, 90.0, 180.0, 29.0, 80.0, 39.0, 50.0, 130.0, 70.0, 90.0, 70.0, 50.0, 50.0, 60.0, 90.0, 80.0, 80.0, 80.0, 30.0, 45.0, 25.0, 60.0, 70.0, 80.0, 60.0, 80.0, 50.0, 50.0, 60.0, 36.0, 65.0, 40.0, 50.0, 60.0, 20.0, 60.0, 26.0, 120.0, 150.0, 60.0, 110.0, 140.0, 160.0, 70.0, 70.0, 70.0, 68.0, 80.0, 99.0, 40.0, 110.0, 150.0, 50.0, 100.0, 120.0, 110.0, 30.0, 60.0, 60.0, 100.0, 130.0, 120.0, 70.0, 40.0, 90.0, 80.0, 80.0, 130.0, 70.0, 35.0, 28.0, 90.0, 60.0, 38.0, 140.0, 50.0, 50.0, 80.0, 28.0, 90.0, 90.0, 100.0, 140.0, 78.0, 24.0, 140.0, 60.0, 120.0, 50.0, 50.0, 89.0, 50.0, 80.0, 40.0, 100.0, 40.0, 40.0, 50.0, 70.0, 40.0, 17.0, 110.0, 110.0, 80.0, 90.0, 70.0, 170.0, 37.0, 70.0, 90.0, 60.0, 70.0, 80.0, 37.0, 65.0, 120.0, 90.0, 140.0, 100.0, 79.0, 125.0, 140.0, 70.0, 50.0, 50.0, 100.0, 140.0, 90.0, 70.0, 80.0, 90.0, -27.0, 60.0, 10.0, 93.0, 60.0, 130.0, 60.0, -9.0, 10.0, 20.0, 40.0, 10.0, 29.0, 70.0, 120.0, 20.0, 9.0, 29.0, 42.0, 50.0, 120.0, 60.0, 50.0, 80.0, 41.0, 22.0, 120.0, 43.0, 120.0, 90.0, 100.0, 90.0, 60.0, 90.0, 90.0, 70.0, 100.0, 60.0, 40.0, 30.0, 120.0, 20.0, 40.0, 150.0, 120.0, 150.0, 70.0, 20.0, 50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0, 110.0, 80.0, 60.0, 10.0, 70.0, 80.0, 20.0, 30.0, 60.0, 46.0, 20.0, 27.0, 30.0, 50.0, 16.0, 30.0, 20.0, 50.0, -1.0, 29.0, 190.0, 60.0, 100.0, 39.0, 50.0, 0.0, 80.0, 90.0, 120.0, 70.0, -6.0, 20.0, 40.0, 80.0, 100.0, 60.0, 70.0, 10.0, -4.0, 60.0, 90.0, 50.0, 19.0, 30.0, 90.0, 40.0, 40.0, 90.0, 110.0, 40.0, 50.0, 60.0, 80.0, 70.0, 110.0, 140.0, 80.0, 30.0, 40.0, 40.0, 100.0, 120.0, 20.0, 70.0, 80.0, 100.0, 120.0, 120.0, 90.0, 100.0, 70.0, 130.0, 120.0, 70.0, 70.0, 10.0, 70.0, 30.0, 80.0, 60.0, 30.0, 0.0, 40.0, 0.0, 60.0, 0.0, 5.0, 20.0, 65.0, 30.0, 50.0, 20.0, 30.0, 95.0, 19.0, 47.0, 30.0, 30.0, 0.0, 40.0, 63.0, 140.0, 90.0, 64.0, 70.0, 60.0, 43.0, 90.0, 17.0, 100.0, 60.0, 100.0, 30.0, 80.0, -9.0, 70.0, 120.0, 100.0, 120.0, 91.0, 90.0, 180.0, 100.0, 110.0, 119.0, 107.0, 90.0, 60.0, 30.0, 96.0, 60.0, 26.0, 40.0, 37.0, 110.0, 120.0, 20.0, 65.0, 60.0, 140.0, 30.0, 130.0, 80.0, 120.0, 50.0, 140.0, 90.0, 120.0, 70.0, 70.0, 40.0, 94.0, 110.0, 60.0, 140.0, 24.0, 39.0, 70.0, 40.0, 50.0, 110.0, 100.0, 60.0, 50.0, 80.0, 48.0, 30.0, 110.0, 59.0, 100.0, 130.0, 110.0, 51.0, 120.0, 100.0, 2.0, 80.0, 70.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5303283608018439, "mean_inference_ms": 1.534694284291975, "mean_action_processing_ms": 0.48784304591668515, "mean_env_wait_ms": 1.341389255766589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01825714111328125, "StateBufferConnector_ms": 0.00956416130065918, "ViewRequirementAgentConnector_ms": 0.3850979804992676}, "num_episodes": 18, "episode_return_max": 1050.0, "episode_return_min": 212.0, "episode_return_mean": 643.99}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.690650189586798, "num_env_steps_trained_throughput_per_sec": 21.690650189586798, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 184738.475, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184738.427, "sample_time_ms": 2385.474, "learn_time_ms": 182332.473, "learn_throughput": 21.938, "synch_weights_time_ms": 12.057}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "a22d3_00000", "date": "2024-08-06_05-25-44", "timestamp": 1722936344, "time_this_iter_s": 184.4175910949707, "time_total_s": 24134.97574877739, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17c41f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24134.97574877739, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 17.16245210727969, "ram_util_percent": 77.76628352490424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7978034434481045, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.147228522905019, "policy_loss": -0.01160484558895986, "vf_loss": 7.155876599282376, "vf_explained_var": 0.00927827551849861, "kl": 0.005469314730731343, "entropy": 0.47718504067427053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 1050.0, "episode_reward_min": 36.0, "episode_reward_mean": 659.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -114.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 65.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 655.0, 628.0, 661.0, 490.0, 1034.0, 468.0, 687.0, 499.0, 761.0, 570.0, 370.0, 763.0, 750.0, 709.0, 375.0, 559.0, 630.0, 813.0, 539.0, 890.0, 631.0, 505.0, 595.0, 760.0, 1050.0, 865.0, 510.0, 462.0, 460.0, 752.0, 588.0, 546.0, 745.0, 365.0, 674.0, 610.0, 530.0, 468.0, 322.0, 998.0, 787.0, 680.0, 580.0, 627.0, 927.0, 830.0, 910.0, 599.0, 892.0, 609.0, 794.0, 852.0, 914.0, 547.0, 357.0, 628.0, 870.0, 760.0, 550.0, 566.0, 271.0, 799.0, 430.0, 599.0, 700.0, 920.0, 710.0, 250.0, 361.0, 737.0, 762.0, 982.0, 678.0, 900.0, 667.0, 747.0, 743.0, 762.0, 920.0, 838.0, 702.0, 36.0, 223.0, 361.0, 813.0, 710.0, 613.0, 740.0, 645.0, 630.0, 525.0, 514.0, 800.0, 870.0, 799.0, 927.0, 900.0, 575.0, 590.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 90.0, 60.0, 40.0, 80.0, 80.0, 70.0, 30.0, 10.0, 80.0, 85.0, 20.0, 80.0, 60.0, 90.0, 40.0, 70.0, 50.0, 150.0, 10.0, 30.0, 49.0, 70.0, 50.0, 70.0, 160.0, 70.0, 59.0, 20.0, 50.0, 100.0, 160.0, 12.0, -55.0, 70.0, 90.0, 74.0, 60.0, 100.0, 50.0, 60.0, 80.0, 25.0, 60.0, 40.0, 70.0, 20.0, 50.0, 30.0, 55.0, 110.0, 140.0, 75.0, 64.0, 80.0, 160.0, 100.0, 75.0, 110.0, 120.0, 52.0, 80.0, 60.0, 20.0, 23.0, 19.0, 4.0, 110.0, 70.0, 30.0, 60.0, 120.0, 4.0, 50.0, 30.0, 140.0, 118.0, 80.0, 45.0, 40.0, 90.0, 0.0, 50.0, -6.0, 40.0, 120.0, 70.0, -5.0, 60.0, 80.0, 150.0, 64.0, 80.0, 60.0, 100.0, 80.0, 67.0, 70.0, 0.0, 90.0, 60.0, 20.0, 60.0, 160.0, 30.0, 50.0, 80.0, 10.0, 40.0, 60.0, 0.0, 14.0, 10.0, 66.0, 10.0, 7.0, 60.0, 60.0, 63.0, 80.0, 10.0, 80.0, 77.0, 79.0, 150.0, 110.0, 30.0, 109.0, 30.0, 88.0, 60.0, 40.0, 100.0, 70.0, 60.0, 10.0, 90.0, 50.0, 90.0, 180.0, 150.0, 30.0, 45.0, 54.0, 100.0, 100.0, 90.0, 51.0, 60.0, 29.0, 0.0, 90.0, 40.0, 80.0, 30.0, 18.0, 30.0, 0.0, 80.0, 7.0, 90.0, 30.0, 10.0, 50.0, 110.0, 80.0, 9.0, 20.0, 110.0, 50.0, 25.0, 90.0, 36.0, 140.0, 57.0, 113.0, 60.0, 58.0, 60.0, -9.0, -2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0, 10.0, 80.0, 70.0, 37.0, 30.0, 100.0, 26.0, 69.0, 80.0, 37.0, 150.0, 80.0, 40.0, 70.0, 50.0, 110.0, 110.0, 90.0, 60.0, 130.0, 90.0, 40.0, 100.0, -4.0, 100.0, 70.0, 80.0, 45.0, 30.0, 80.0, 110.0, 30.0, 27.0, 50.0, 20.0, 30.0, 110.0, 70.0, 33.0, 25.0, 60.0, 40.0, 98.0, 30.0, 80.0, 20.0, 27.0, 20.0, 120.0, 100.0, 40.0, 70.0, 60.0, 30.0, 50.0, 70.0, 150.0, 100.0, 90.0, 100.0, 90.0, 60.0, 140.0, 70.0, 120.0, 120.0, 60.0, 150.0, 140.0, 100.0, 50.0, 111.0, 120.0, 90.0, 80.0, 120.0, 100.0, 125.0, 29.0, 40.0, 30.0, 70.0, 100.0, 60.0, 50.0, 80.0, 20.0, 30.0, 20.0, 50.0, 100.0, 16.0, 60.0, 50.0, 100.0, 50.0, 20.0, 56.0, -45.0, 55.0, 26.0, 8.0, 30.0, 40.0, 40.0, 80.0, 50.0, 26.0, 110.0, 50.0, -55.0, 110.0, 60.0, 50.0, 160.0, 70.0, 84.0, 33.0, 170.0, 70.0, 47.0, 70.0, 60.0, 140.0, -4.0, 20.0, 20.0, 130.0, 45.0, 60.0, 120.0, -74.0, 80.0, -34.0, 100.0, 100.0, 110.0, 78.0, 25.0, 41.0, 110.0, 90.0, 130.0, 30.0, 30.0, 160.0, 35.0, 60.0, 50.0, 50.0, 70.0, 0.0, 70.0, 30.0, 20.0, 40.0, 70.0, 40.0, -5.0, 30.0, 80.0, 100.0, 50.0, 30.0, 28.0, 100.0, 90.0, 26.0, 60.0, 110.0, 30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0, 80.0, 20.0, 40.0, 90.0, 20.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 40.0, 50.0, 60.0, 130.0, 60.0, 30.0, 19.0, 39.0, 30.0, 20.0, 40.0, 20.0, -8.0, 17.0, 100.0, 20.0, 53.0, 30.0, 30.0, 70.0, 80.0, 130.0, 110.0, 119.0, 60.0, 80.0, 90.0, 179.0, 80.0, 70.0, 49.0, 90.0, 180.0, 29.0, 80.0, 39.0, 50.0, 130.0, 70.0, 90.0, 70.0, 50.0, 50.0, 60.0, 90.0, 80.0, 80.0, 80.0, 30.0, 45.0, 25.0, 60.0, 70.0, 80.0, 60.0, 80.0, 50.0, 50.0, 60.0, 36.0, 65.0, 40.0, 50.0, 60.0, 20.0, 60.0, 26.0, 120.0, 150.0, 60.0, 110.0, 140.0, 160.0, 70.0, 70.0, 70.0, 68.0, 80.0, 99.0, 40.0, 110.0, 150.0, 50.0, 100.0, 120.0, 110.0, 30.0, 60.0, 60.0, 100.0, 130.0, 120.0, 70.0, 40.0, 90.0, 80.0, 80.0, 130.0, 70.0, 35.0, 28.0, 90.0, 60.0, 38.0, 140.0, 50.0, 50.0, 80.0, 28.0, 90.0, 90.0, 100.0, 140.0, 78.0, 24.0, 140.0, 60.0, 120.0, 50.0, 50.0, 89.0, 50.0, 80.0, 40.0, 100.0, 40.0, 40.0, 50.0, 70.0, 40.0, 17.0, 110.0, 110.0, 80.0, 90.0, 70.0, 170.0, 37.0, 70.0, 90.0, 60.0, 70.0, 80.0, 37.0, 65.0, 120.0, 90.0, 140.0, 100.0, 79.0, 125.0, 140.0, 70.0, 50.0, 50.0, 100.0, 140.0, 90.0, 70.0, 80.0, 90.0, -27.0, 60.0, 10.0, 93.0, 60.0, 130.0, 60.0, -9.0, 10.0, 20.0, 40.0, 10.0, 29.0, 70.0, 120.0, 20.0, 9.0, 29.0, 42.0, 50.0, 120.0, 60.0, 50.0, 80.0, 41.0, 22.0, 120.0, 43.0, 120.0, 90.0, 100.0, 90.0, 60.0, 90.0, 90.0, 70.0, 100.0, 60.0, 40.0, 30.0, 120.0, 20.0, 40.0, 150.0, 120.0, 150.0, 70.0, 20.0, 50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0, 110.0, 80.0, 60.0, 10.0, 70.0, 80.0, 20.0, 30.0, 60.0, 46.0, 20.0, 27.0, 30.0, 50.0, 16.0, 30.0, 20.0, 50.0, -1.0, 29.0, 190.0, 60.0, 100.0, 39.0, 50.0, 0.0, 80.0, 90.0, 120.0, 70.0, -6.0, 20.0, 40.0, 80.0, 100.0, 60.0, 70.0, 10.0, -4.0, 60.0, 90.0, 50.0, 19.0, 30.0, 90.0, 40.0, 40.0, 90.0, 110.0, 40.0, 50.0, 60.0, 80.0, 70.0, 110.0, 140.0, 80.0, 30.0, 40.0, 40.0, 100.0, 120.0, 20.0, 70.0, 80.0, 100.0, 120.0, 120.0, 90.0, 100.0, 70.0, 130.0, 120.0, 70.0, 70.0, 10.0, 70.0, 30.0, 80.0, 60.0, 30.0, 0.0, 40.0, 0.0, 60.0, 0.0, 5.0, 20.0, 65.0, 30.0, 50.0, 20.0, 30.0, 95.0, 19.0, 47.0, 30.0, 30.0, 0.0, 40.0, 63.0, 140.0, 90.0, 64.0, 70.0, 60.0, 43.0, 90.0, 17.0, 100.0, 60.0, 100.0, 30.0, 80.0, -9.0, 70.0, 120.0, 100.0, 120.0, 91.0, 90.0, 180.0, 100.0, 110.0, 119.0, 107.0, 90.0, 60.0, 30.0, 96.0, 60.0, 26.0, 40.0, 37.0, 110.0, 120.0, 20.0, 65.0, 60.0, 140.0, 30.0, 130.0, 80.0, 120.0, 50.0, 140.0, 90.0, 120.0, 70.0, 70.0, 40.0, 94.0, 110.0, 60.0, 140.0, 24.0, 39.0, 70.0, 40.0, 50.0, 110.0, 100.0, 60.0, 50.0, 80.0, 48.0, 30.0, 110.0, 59.0, 100.0, 130.0, 110.0, 51.0, 120.0, 100.0, 2.0, 80.0, 70.0, 20.0, 60.0, 38.0, 150.0, 180.0, 29.0, 70.0, -2.0, 100.0, 67.0, 40.0, 90.0, 80.0, 40.0, 70.0, 140.0, 100.0, 110.0, 80.0, 50.0, 110.0, 140.0, 69.0, 58.0, 130.0, 60.0, 90.0, 70.0, 67.0, 140.0, 77.0, 77.0, 50.0, 20.0, 19.0, 90.0, 59.0, 68.0, 70.0, 120.0, 146.0, 60.0, 10.0, 20.0, 20.0, 40.0, 20.0, -2.0, 8.0, 10.0, -90.0, 0.0, 50.0, 148.0, 10.0, 70.0, 60.0, 10.0, -114.0, -111.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 50.0, 6.0, 80.0, 28.0, 17.0, 10.0, 70.0, 32.0, 110.0, 60.0, 140.0, 110.0, 150.0, 40.0, 70.0, 31.0, 80.0, 70.0, 40.0, 100.0, 60.0, 40.0, 50.0, 110.0, 90.0, 70.0, 29.0, 80.0, 60.0, 40.0, 50.0, 84.0, 60.0, 70.0, 50.0, 90.0, 100.0, 10.0, 110.0, 110.0, 100.0, 30.0, 30.0, 130.0, 50.0, 70.0, 80.0, 30.0, 46.0, 70.0, 40.0, 150.0, 90.0, 20.0, 80.0, 39.0, 0.0, 50.0, 100.0, 50.0, 110.0, 20.0, 50.0, 70.0, 60.0, 120.0, 29.0, 42.0, 128.0, -75.0, 100.0, 79.0, 0.0, 60.0, 92.0, 70.0, 60.0, 15.0, 140.0, 109.0, 40.0, 60.0, 30.0, 0.0, 40.0, 20.0, 50.0, 60.0, 110.0, 100.0, 90.0, 70.0, 120.0, 50.0, 110.0, 40.0, 90.0, 70.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 100.0, 50.0, 100.0, 30.0, 40.0, 100.0, 140.0, 110.0, 80.0, 100.0, 35.0, 64.0, 60.0, 190.0, 110.0, 80.0, 34.0, 13.0, 120.0, 100.0, 50.0, 170.0, 110.0, 80.0, 60.0, 80.0, 50.0, 51.0, 140.0, 80.0, 120.0, 129.0, 30.0, 68.0, 40.0, 60.0, 80.0, 29.0, 10.0, 48.0, 170.0, 40.0, 50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5291960850465933, "mean_inference_ms": 1.5333236026245247, "mean_action_processing_ms": 0.48735595955962524, "mean_env_wait_ms": 1.3404003586313138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018681764602661133, "StateBufferConnector_ms": 0.009701728820800781, "ViewRequirementAgentConnector_ms": 0.3850533962249756}, "num_episodes": 22, "episode_return_max": 1050.0, "episode_return_min": 36.0, "episode_return_mean": 659.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.541508531149297, "num_env_steps_trained_throughput_per_sec": 21.541508531149297, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 184836.428, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184836.38, "sample_time_ms": 2374.378, "learn_time_ms": 182441.26, "learn_throughput": 21.925, "synch_weights_time_ms": 12.032}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "a22d3_00000", "date": "2024-08-06_05-28-50", "timestamp": 1722936530, "time_this_iter_s": 185.69643902778625, "time_total_s": 24320.672187805176, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a357aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24320.672187805176, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 18.19505703422053, "ram_util_percent": 77.632319391635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.708480364915789, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.931153180220892, "policy_loss": -0.01078729918950631, "vf_loss": 6.939192788923384, "vf_explained_var": 0.019549607665647967, "kl": 0.005082564808568259, "entropy": 0.5259798408506777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 1050.0, "episode_reward_min": 36.0, "episode_reward_mean": 655.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -212.0}, "policy_reward_max": {"policy_0": 200.0}, "policy_reward_mean": {"policy_0": 65.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [813.0, 539.0, 890.0, 631.0, 505.0, 595.0, 760.0, 1050.0, 865.0, 510.0, 462.0, 460.0, 752.0, 588.0, 546.0, 745.0, 365.0, 674.0, 610.0, 530.0, 468.0, 322.0, 998.0, 787.0, 680.0, 580.0, 627.0, 927.0, 830.0, 910.0, 599.0, 892.0, 609.0, 794.0, 852.0, 914.0, 547.0, 357.0, 628.0, 870.0, 760.0, 550.0, 566.0, 271.0, 799.0, 430.0, 599.0, 700.0, 920.0, 710.0, 250.0, 361.0, 737.0, 762.0, 982.0, 678.0, 900.0, 667.0, 747.0, 743.0, 762.0, 920.0, 838.0, 702.0, 36.0, 223.0, 361.0, 813.0, 710.0, 613.0, 740.0, 645.0, 630.0, 525.0, 514.0, 800.0, 870.0, 799.0, 927.0, 900.0, 575.0, 590.0, 440.0, 387.0, 696.0, 315.0, 328.0, 647.0, 351.0, 840.0, 790.0, 706.0, 917.0, 660.0, 386.0, 827.0, 653.0, 530.0, 766.0, 580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-2.0, 90.0, 60.0, 95.0, 50.0, 50.0, 110.0, 180.0, 50.0, 130.0, 10.0, 80.0, 70.0, 37.0, 30.0, 100.0, 26.0, 69.0, 80.0, 37.0, 150.0, 80.0, 40.0, 70.0, 50.0, 110.0, 110.0, 90.0, 60.0, 130.0, 90.0, 40.0, 100.0, -4.0, 100.0, 70.0, 80.0, 45.0, 30.0, 80.0, 110.0, 30.0, 27.0, 50.0, 20.0, 30.0, 110.0, 70.0, 33.0, 25.0, 60.0, 40.0, 98.0, 30.0, 80.0, 20.0, 27.0, 20.0, 120.0, 100.0, 40.0, 70.0, 60.0, 30.0, 50.0, 70.0, 150.0, 100.0, 90.0, 100.0, 90.0, 60.0, 140.0, 70.0, 120.0, 120.0, 60.0, 150.0, 140.0, 100.0, 50.0, 111.0, 120.0, 90.0, 80.0, 120.0, 100.0, 125.0, 29.0, 40.0, 30.0, 70.0, 100.0, 60.0, 50.0, 80.0, 20.0, 30.0, 20.0, 50.0, 100.0, 16.0, 60.0, 50.0, 100.0, 50.0, 20.0, 56.0, -45.0, 55.0, 26.0, 8.0, 30.0, 40.0, 40.0, 80.0, 50.0, 26.0, 110.0, 50.0, -55.0, 110.0, 60.0, 50.0, 160.0, 70.0, 84.0, 33.0, 170.0, 70.0, 47.0, 70.0, 60.0, 140.0, -4.0, 20.0, 20.0, 130.0, 45.0, 60.0, 120.0, -74.0, 80.0, -34.0, 100.0, 100.0, 110.0, 78.0, 25.0, 41.0, 110.0, 90.0, 130.0, 30.0, 30.0, 160.0, 35.0, 60.0, 50.0, 50.0, 70.0, 0.0, 70.0, 30.0, 20.0, 40.0, 70.0, 40.0, -5.0, 30.0, 80.0, 100.0, 50.0, 30.0, 28.0, 100.0, 90.0, 26.0, 60.0, 110.0, 30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0, 80.0, 20.0, 40.0, 90.0, 20.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 40.0, 50.0, 60.0, 130.0, 60.0, 30.0, 19.0, 39.0, 30.0, 20.0, 40.0, 20.0, -8.0, 17.0, 100.0, 20.0, 53.0, 30.0, 30.0, 70.0, 80.0, 130.0, 110.0, 119.0, 60.0, 80.0, 90.0, 179.0, 80.0, 70.0, 49.0, 90.0, 180.0, 29.0, 80.0, 39.0, 50.0, 130.0, 70.0, 90.0, 70.0, 50.0, 50.0, 60.0, 90.0, 80.0, 80.0, 80.0, 30.0, 45.0, 25.0, 60.0, 70.0, 80.0, 60.0, 80.0, 50.0, 50.0, 60.0, 36.0, 65.0, 40.0, 50.0, 60.0, 20.0, 60.0, 26.0, 120.0, 150.0, 60.0, 110.0, 140.0, 160.0, 70.0, 70.0, 70.0, 68.0, 80.0, 99.0, 40.0, 110.0, 150.0, 50.0, 100.0, 120.0, 110.0, 30.0, 60.0, 60.0, 100.0, 130.0, 120.0, 70.0, 40.0, 90.0, 80.0, 80.0, 130.0, 70.0, 35.0, 28.0, 90.0, 60.0, 38.0, 140.0, 50.0, 50.0, 80.0, 28.0, 90.0, 90.0, 100.0, 140.0, 78.0, 24.0, 140.0, 60.0, 120.0, 50.0, 50.0, 89.0, 50.0, 80.0, 40.0, 100.0, 40.0, 40.0, 50.0, 70.0, 40.0, 17.0, 110.0, 110.0, 80.0, 90.0, 70.0, 170.0, 37.0, 70.0, 90.0, 60.0, 70.0, 80.0, 37.0, 65.0, 120.0, 90.0, 140.0, 100.0, 79.0, 125.0, 140.0, 70.0, 50.0, 50.0, 100.0, 140.0, 90.0, 70.0, 80.0, 90.0, -27.0, 60.0, 10.0, 93.0, 60.0, 130.0, 60.0, -9.0, 10.0, 20.0, 40.0, 10.0, 29.0, 70.0, 120.0, 20.0, 9.0, 29.0, 42.0, 50.0, 120.0, 60.0, 50.0, 80.0, 41.0, 22.0, 120.0, 43.0, 120.0, 90.0, 100.0, 90.0, 60.0, 90.0, 90.0, 70.0, 100.0, 60.0, 40.0, 30.0, 120.0, 20.0, 40.0, 150.0, 120.0, 150.0, 70.0, 20.0, 50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0, 110.0, 80.0, 60.0, 10.0, 70.0, 80.0, 20.0, 30.0, 60.0, 46.0, 20.0, 27.0, 30.0, 50.0, 16.0, 30.0, 20.0, 50.0, -1.0, 29.0, 190.0, 60.0, 100.0, 39.0, 50.0, 0.0, 80.0, 90.0, 120.0, 70.0, -6.0, 20.0, 40.0, 80.0, 100.0, 60.0, 70.0, 10.0, -4.0, 60.0, 90.0, 50.0, 19.0, 30.0, 90.0, 40.0, 40.0, 90.0, 110.0, 40.0, 50.0, 60.0, 80.0, 70.0, 110.0, 140.0, 80.0, 30.0, 40.0, 40.0, 100.0, 120.0, 20.0, 70.0, 80.0, 100.0, 120.0, 120.0, 90.0, 100.0, 70.0, 130.0, 120.0, 70.0, 70.0, 10.0, 70.0, 30.0, 80.0, 60.0, 30.0, 0.0, 40.0, 0.0, 60.0, 0.0, 5.0, 20.0, 65.0, 30.0, 50.0, 20.0, 30.0, 95.0, 19.0, 47.0, 30.0, 30.0, 0.0, 40.0, 63.0, 140.0, 90.0, 64.0, 70.0, 60.0, 43.0, 90.0, 17.0, 100.0, 60.0, 100.0, 30.0, 80.0, -9.0, 70.0, 120.0, 100.0, 120.0, 91.0, 90.0, 180.0, 100.0, 110.0, 119.0, 107.0, 90.0, 60.0, 30.0, 96.0, 60.0, 26.0, 40.0, 37.0, 110.0, 120.0, 20.0, 65.0, 60.0, 140.0, 30.0, 130.0, 80.0, 120.0, 50.0, 140.0, 90.0, 120.0, 70.0, 70.0, 40.0, 94.0, 110.0, 60.0, 140.0, 24.0, 39.0, 70.0, 40.0, 50.0, 110.0, 100.0, 60.0, 50.0, 80.0, 48.0, 30.0, 110.0, 59.0, 100.0, 130.0, 110.0, 51.0, 120.0, 100.0, 2.0, 80.0, 70.0, 20.0, 60.0, 38.0, 150.0, 180.0, 29.0, 70.0, -2.0, 100.0, 67.0, 40.0, 90.0, 80.0, 40.0, 70.0, 140.0, 100.0, 110.0, 80.0, 50.0, 110.0, 140.0, 69.0, 58.0, 130.0, 60.0, 90.0, 70.0, 67.0, 140.0, 77.0, 77.0, 50.0, 20.0, 19.0, 90.0, 59.0, 68.0, 70.0, 120.0, 146.0, 60.0, 10.0, 20.0, 20.0, 40.0, 20.0, -2.0, 8.0, 10.0, -90.0, 0.0, 50.0, 148.0, 10.0, 70.0, 60.0, 10.0, -114.0, -111.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 50.0, 6.0, 80.0, 28.0, 17.0, 10.0, 70.0, 32.0, 110.0, 60.0, 140.0, 110.0, 150.0, 40.0, 70.0, 31.0, 80.0, 70.0, 40.0, 100.0, 60.0, 40.0, 50.0, 110.0, 90.0, 70.0, 29.0, 80.0, 60.0, 40.0, 50.0, 84.0, 60.0, 70.0, 50.0, 90.0, 100.0, 10.0, 110.0, 110.0, 100.0, 30.0, 30.0, 130.0, 50.0, 70.0, 80.0, 30.0, 46.0, 70.0, 40.0, 150.0, 90.0, 20.0, 80.0, 39.0, 0.0, 50.0, 100.0, 50.0, 110.0, 20.0, 50.0, 70.0, 60.0, 120.0, 29.0, 42.0, 128.0, -75.0, 100.0, 79.0, 0.0, 60.0, 92.0, 70.0, 60.0, 15.0, 140.0, 109.0, 40.0, 60.0, 30.0, 0.0, 40.0, 20.0, 50.0, 60.0, 110.0, 100.0, 90.0, 70.0, 120.0, 50.0, 110.0, 40.0, 90.0, 70.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 100.0, 50.0, 100.0, 30.0, 40.0, 100.0, 140.0, 110.0, 80.0, 100.0, 35.0, 64.0, 60.0, 190.0, 110.0, 80.0, 34.0, 13.0, 120.0, 100.0, 50.0, 170.0, 110.0, 80.0, 60.0, 80.0, 50.0, 51.0, 140.0, 80.0, 120.0, 129.0, 30.0, 68.0, 40.0, 60.0, 80.0, 29.0, 10.0, 48.0, 170.0, 40.0, 50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0, 80.0, 60.0, 50.0, 50.0, 40.0, 50.0, 20.0, 10.0, 20.0, 60.0, -10.0, 40.0, 20.0, 17.0, 20.0, 110.0, 60.0, 110.0, 20.0, 0.0, 90.0, 80.0, 38.0, 60.0, 90.0, 83.0, 80.0, 70.0, 80.0, 25.0, 3.0, 20.0, 70.0, 60.0, 70.0, 37.0, -1.0, 40.0, -34.0, 50.0, 80.0, 0.0, 19.0, 200.0, 20.0, -29.0, -9.0, 50.0, -23.0, 20.0, 190.0, 100.0, 19.0, 120.0, 70.0, 8.0, 20.0, 90.0, 10.0, 20.0, 88.0, 110.0, 57.0, -22.0, -38.0, 50.0, 148.0, -212.0, 140.0, 30.0, 110.0, 130.0, 100.0, 80.0, 50.0, 60.0, 40.0, 90.0, 120.0, 60.0, 170.0, 40.0, 120.0, 50.0, 90.0, 15.0, 50.0, 50.0, 55.0, 150.0, 80.0, 80.0, 90.0, -14.0, -23.0, 44.0, 150.0, 70.0, 90.0, 139.0, 60.0, 70.0, 170.0, 110.0, 90.0, 100.0, 77.0, 90.0, 50.0, 100.0, 80.0, 50.0, 120.0, 80.0, -36.0, -17.0, 55.0, 88.0, 70.0, 170.0, 18.0, 10.0, 10.0, 70.0, 10.0, 50.0, 118.0, 60.0, 10.0, 30.0, 46.0, 90.0, 40.0, 110.0, 80.0, 69.0, 95.0, 87.0, 60.0, 150.0, 90.0, 20.0, 50.0, 38.0, 60.0, 25.0, 140.0, 60.0, 10.0, 160.0, 50.0, 120.0, 10.0, 20.0, 10.0, 60.0, 40.0, 60.0, 100.0, 60.0, 90.0, 49.0, 147.0, 100.0, 60.0, 60.0, 70.0, 50.0, 100.0, 40.0, 40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5282515944085264, "mean_inference_ms": 1.5323424820832907, "mean_action_processing_ms": 0.4869500159530135, "mean_env_wait_ms": 1.339574401053233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017533302307128906, "StateBufferConnector_ms": 0.009578704833984375, "ViewRequirementAgentConnector_ms": 0.3788731098175049}, "num_episodes": 18, "episode_return_max": 1050.0, "episode_return_min": 36.0, "episode_return_mean": 655.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.541151794678914, "num_env_steps_trained_throughput_per_sec": 21.541151794678914, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 184824.801, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184824.752, "sample_time_ms": 2378.147, "learn_time_ms": 182425.388, "learn_throughput": 21.927, "synch_weights_time_ms": 12.282}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "a22d3_00000", "date": "2024-08-06_05-31-55", "timestamp": 1722936715, "time_this_iter_s": 185.70120906829834, "time_total_s": 24506.373396873474, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17d0f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24506.373396873474, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.7, "ram_util_percent": 77.80610687022902}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.749977422306459, "cur_kl_coeff": 0.5406097412109376, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010895028575179707, "vf_loss": 6.702514356393784, "vf_explained_var": 0.013825587736278042, "kl": Infinity, "entropy": 0.5507201442227196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 1080.0, "episode_reward_min": 36.0, "episode_reward_mean": 659.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -212.0}, "policy_reward_max": {"policy_0": 200.0}, "policy_reward_mean": {"policy_0": 65.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 530.0, 468.0, 322.0, 998.0, 787.0, 680.0, 580.0, 627.0, 927.0, 830.0, 910.0, 599.0, 892.0, 609.0, 794.0, 852.0, 914.0, 547.0, 357.0, 628.0, 870.0, 760.0, 550.0, 566.0, 271.0, 799.0, 430.0, 599.0, 700.0, 920.0, 710.0, 250.0, 361.0, 737.0, 762.0, 982.0, 678.0, 900.0, 667.0, 747.0, 743.0, 762.0, 920.0, 838.0, 702.0, 36.0, 223.0, 361.0, 813.0, 710.0, 613.0, 740.0, 645.0, 630.0, 525.0, 514.0, 800.0, 870.0, 799.0, 927.0, 900.0, 575.0, 590.0, 440.0, 387.0, 696.0, 315.0, 328.0, 647.0, 351.0, 840.0, 790.0, 706.0, 917.0, 660.0, 386.0, 827.0, 653.0, 530.0, 766.0, 580.0, 576.0, 890.0, 729.0, 1080.0, 622.0, 801.0, 690.0, 547.0, 517.0, 618.0, 710.0, 882.0, 565.0, 849.0, 719.0, 296.0, 657.0, 452.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 50.0, 70.0, 120.0, 30.0, 10.0, 50.0, 120.0, 100.0, 80.0, 20.0, 40.0, 90.0, 20.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 40.0, 50.0, 60.0, 130.0, 60.0, 30.0, 19.0, 39.0, 30.0, 20.0, 40.0, 20.0, -8.0, 17.0, 100.0, 20.0, 53.0, 30.0, 30.0, 70.0, 80.0, 130.0, 110.0, 119.0, 60.0, 80.0, 90.0, 179.0, 80.0, 70.0, 49.0, 90.0, 180.0, 29.0, 80.0, 39.0, 50.0, 130.0, 70.0, 90.0, 70.0, 50.0, 50.0, 60.0, 90.0, 80.0, 80.0, 80.0, 30.0, 45.0, 25.0, 60.0, 70.0, 80.0, 60.0, 80.0, 50.0, 50.0, 60.0, 36.0, 65.0, 40.0, 50.0, 60.0, 20.0, 60.0, 26.0, 120.0, 150.0, 60.0, 110.0, 140.0, 160.0, 70.0, 70.0, 70.0, 68.0, 80.0, 99.0, 40.0, 110.0, 150.0, 50.0, 100.0, 120.0, 110.0, 30.0, 60.0, 60.0, 100.0, 130.0, 120.0, 70.0, 40.0, 90.0, 80.0, 80.0, 130.0, 70.0, 35.0, 28.0, 90.0, 60.0, 38.0, 140.0, 50.0, 50.0, 80.0, 28.0, 90.0, 90.0, 100.0, 140.0, 78.0, 24.0, 140.0, 60.0, 120.0, 50.0, 50.0, 89.0, 50.0, 80.0, 40.0, 100.0, 40.0, 40.0, 50.0, 70.0, 40.0, 17.0, 110.0, 110.0, 80.0, 90.0, 70.0, 170.0, 37.0, 70.0, 90.0, 60.0, 70.0, 80.0, 37.0, 65.0, 120.0, 90.0, 140.0, 100.0, 79.0, 125.0, 140.0, 70.0, 50.0, 50.0, 100.0, 140.0, 90.0, 70.0, 80.0, 90.0, -27.0, 60.0, 10.0, 93.0, 60.0, 130.0, 60.0, -9.0, 10.0, 20.0, 40.0, 10.0, 29.0, 70.0, 120.0, 20.0, 9.0, 29.0, 42.0, 50.0, 120.0, 60.0, 50.0, 80.0, 41.0, 22.0, 120.0, 43.0, 120.0, 90.0, 100.0, 90.0, 60.0, 90.0, 90.0, 70.0, 100.0, 60.0, 40.0, 30.0, 120.0, 20.0, 40.0, 150.0, 120.0, 150.0, 70.0, 20.0, 50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0, 110.0, 80.0, 60.0, 10.0, 70.0, 80.0, 20.0, 30.0, 60.0, 46.0, 20.0, 27.0, 30.0, 50.0, 16.0, 30.0, 20.0, 50.0, -1.0, 29.0, 190.0, 60.0, 100.0, 39.0, 50.0, 0.0, 80.0, 90.0, 120.0, 70.0, -6.0, 20.0, 40.0, 80.0, 100.0, 60.0, 70.0, 10.0, -4.0, 60.0, 90.0, 50.0, 19.0, 30.0, 90.0, 40.0, 40.0, 90.0, 110.0, 40.0, 50.0, 60.0, 80.0, 70.0, 110.0, 140.0, 80.0, 30.0, 40.0, 40.0, 100.0, 120.0, 20.0, 70.0, 80.0, 100.0, 120.0, 120.0, 90.0, 100.0, 70.0, 130.0, 120.0, 70.0, 70.0, 10.0, 70.0, 30.0, 80.0, 60.0, 30.0, 0.0, 40.0, 0.0, 60.0, 0.0, 5.0, 20.0, 65.0, 30.0, 50.0, 20.0, 30.0, 95.0, 19.0, 47.0, 30.0, 30.0, 0.0, 40.0, 63.0, 140.0, 90.0, 64.0, 70.0, 60.0, 43.0, 90.0, 17.0, 100.0, 60.0, 100.0, 30.0, 80.0, -9.0, 70.0, 120.0, 100.0, 120.0, 91.0, 90.0, 180.0, 100.0, 110.0, 119.0, 107.0, 90.0, 60.0, 30.0, 96.0, 60.0, 26.0, 40.0, 37.0, 110.0, 120.0, 20.0, 65.0, 60.0, 140.0, 30.0, 130.0, 80.0, 120.0, 50.0, 140.0, 90.0, 120.0, 70.0, 70.0, 40.0, 94.0, 110.0, 60.0, 140.0, 24.0, 39.0, 70.0, 40.0, 50.0, 110.0, 100.0, 60.0, 50.0, 80.0, 48.0, 30.0, 110.0, 59.0, 100.0, 130.0, 110.0, 51.0, 120.0, 100.0, 2.0, 80.0, 70.0, 20.0, 60.0, 38.0, 150.0, 180.0, 29.0, 70.0, -2.0, 100.0, 67.0, 40.0, 90.0, 80.0, 40.0, 70.0, 140.0, 100.0, 110.0, 80.0, 50.0, 110.0, 140.0, 69.0, 58.0, 130.0, 60.0, 90.0, 70.0, 67.0, 140.0, 77.0, 77.0, 50.0, 20.0, 19.0, 90.0, 59.0, 68.0, 70.0, 120.0, 146.0, 60.0, 10.0, 20.0, 20.0, 40.0, 20.0, -2.0, 8.0, 10.0, -90.0, 0.0, 50.0, 148.0, 10.0, 70.0, 60.0, 10.0, -114.0, -111.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 50.0, 6.0, 80.0, 28.0, 17.0, 10.0, 70.0, 32.0, 110.0, 60.0, 140.0, 110.0, 150.0, 40.0, 70.0, 31.0, 80.0, 70.0, 40.0, 100.0, 60.0, 40.0, 50.0, 110.0, 90.0, 70.0, 29.0, 80.0, 60.0, 40.0, 50.0, 84.0, 60.0, 70.0, 50.0, 90.0, 100.0, 10.0, 110.0, 110.0, 100.0, 30.0, 30.0, 130.0, 50.0, 70.0, 80.0, 30.0, 46.0, 70.0, 40.0, 150.0, 90.0, 20.0, 80.0, 39.0, 0.0, 50.0, 100.0, 50.0, 110.0, 20.0, 50.0, 70.0, 60.0, 120.0, 29.0, 42.0, 128.0, -75.0, 100.0, 79.0, 0.0, 60.0, 92.0, 70.0, 60.0, 15.0, 140.0, 109.0, 40.0, 60.0, 30.0, 0.0, 40.0, 20.0, 50.0, 60.0, 110.0, 100.0, 90.0, 70.0, 120.0, 50.0, 110.0, 40.0, 90.0, 70.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 100.0, 50.0, 100.0, 30.0, 40.0, 100.0, 140.0, 110.0, 80.0, 100.0, 35.0, 64.0, 60.0, 190.0, 110.0, 80.0, 34.0, 13.0, 120.0, 100.0, 50.0, 170.0, 110.0, 80.0, 60.0, 80.0, 50.0, 51.0, 140.0, 80.0, 120.0, 129.0, 30.0, 68.0, 40.0, 60.0, 80.0, 29.0, 10.0, 48.0, 170.0, 40.0, 50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0, 80.0, 60.0, 50.0, 50.0, 40.0, 50.0, 20.0, 10.0, 20.0, 60.0, -10.0, 40.0, 20.0, 17.0, 20.0, 110.0, 60.0, 110.0, 20.0, 0.0, 90.0, 80.0, 38.0, 60.0, 90.0, 83.0, 80.0, 70.0, 80.0, 25.0, 3.0, 20.0, 70.0, 60.0, 70.0, 37.0, -1.0, 40.0, -34.0, 50.0, 80.0, 0.0, 19.0, 200.0, 20.0, -29.0, -9.0, 50.0, -23.0, 20.0, 190.0, 100.0, 19.0, 120.0, 70.0, 8.0, 20.0, 90.0, 10.0, 20.0, 88.0, 110.0, 57.0, -22.0, -38.0, 50.0, 148.0, -212.0, 140.0, 30.0, 110.0, 130.0, 100.0, 80.0, 50.0, 60.0, 40.0, 90.0, 120.0, 60.0, 170.0, 40.0, 120.0, 50.0, 90.0, 15.0, 50.0, 50.0, 55.0, 150.0, 80.0, 80.0, 90.0, -14.0, -23.0, 44.0, 150.0, 70.0, 90.0, 139.0, 60.0, 70.0, 170.0, 110.0, 90.0, 100.0, 77.0, 90.0, 50.0, 100.0, 80.0, 50.0, 120.0, 80.0, -36.0, -17.0, 55.0, 88.0, 70.0, 170.0, 18.0, 10.0, 10.0, 70.0, 10.0, 50.0, 118.0, 60.0, 10.0, 30.0, 46.0, 90.0, 40.0, 110.0, 80.0, 69.0, 95.0, 87.0, 60.0, 150.0, 90.0, 20.0, 50.0, 38.0, 60.0, 25.0, 140.0, 60.0, 10.0, 160.0, 50.0, 120.0, 10.0, 20.0, 10.0, 60.0, 40.0, 60.0, 100.0, 60.0, 90.0, 49.0, 147.0, 100.0, 60.0, 60.0, 70.0, 50.0, 100.0, 40.0, 40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0, 50.0, 70.0, 75.0, 20.0, 30.0, 50.0, 56.0, 130.0, 45.0, 50.0, 40.0, 100.0, 110.0, 90.0, 60.0, 80.0, 100.0, 70.0, 60.0, 180.0, 120.0, 60.0, 27.0, 70.0, 32.0, 74.0, 53.0, 90.0, 90.0, 113.0, 80.0, 110.0, 190.0, 140.0, 130.0, 100.0, 90.0, 50.0, 100.0, 90.0, 10.0, 70.0, 20.0, 40.0, 110.0, 72.0, 40.0, 90.0, 120.0, 50.0, 0.0, 120.0, 166.0, 95.0, 50.0, 120.0, 30.0, 110.0, 60.0, 50.0, 80.0, 30.0, 90.0, 50.0, 60.0, 100.0, 100.0, 80.0, 30.0, 70.0, 70.0, 30.0, 70.0, 130.0, 40.0, 50.0, 80.0, 7.0, 50.0, 20.0, 20.0, 14.0, 33.0, 70.0, 60.0, 80.0, 80.0, 78.0, 50.0, 32.0, 61.0, 110.0, 28.0, 20.0, 27.0, 50.0, 82.0, 90.0, 50.0, 100.0, 90.0, 40.0, 80.0, 50.0, 110.0, 120.0, 80.0, 30.0, 50.0, 60.0, 140.0, 60.0, 160.0, 50.0, 56.0, 80.0, 110.0, 110.0, 70.0, 46.0, 1.0, 60.0, 70.0, 120.0, 40.0, 80.0, 70.0, 70.0, 4.0, 50.0, 180.0, 50.0, 49.0, 30.0, 60.0, 70.0, 78.0, 110.0, 160.0, 62.0, 119.0, 40.0, 60.0, 50.0, 0.0, 90.0, 60.0, 100.0, 130.0, 70.0, -4.0, 10.0, 30.0, 50.0, 50.0, -30.0, 10.0, 100.0, 10.0, 70.0, 82.0, 40.0, 20.0, 160.0, 70.0, -20.0, 50.0, 85.0, 90.0, 80.0, 30.0, 10.0, 70.0, 64.0, 50.0, 90.0, -10.0, 60.0, 58.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5274689517761044, "mean_inference_ms": 1.5314395619555756, "mean_action_processing_ms": 0.4865552757733471, "mean_env_wait_ms": 1.338786399163543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017419815063476562, "StateBufferConnector_ms": 0.009490251541137695, "ViewRequirementAgentConnector_ms": 0.3735191822052002}, "num_episodes": 18, "episode_return_max": 1080.0, "episode_return_min": 36.0, "episode_return_mean": 659.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.572147006205977, "num_env_steps_trained_throughput_per_sec": 21.572147006205977, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 184882.974, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184882.926, "sample_time_ms": 2428.075, "learn_time_ms": 182433.578, "learn_throughput": 21.926, "synch_weights_time_ms": 12.439}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "a22d3_00000", "date": "2024-08-06_05-35-01", "timestamp": 1722936901, "time_this_iter_s": 185.43178486824036, "time_total_s": 24691.805181741714, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17d8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24691.805181741714, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 17.33422053231939, "ram_util_percent": 77.48859315589354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.75292233764427, "cur_kl_coeff": 0.810914611816406, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011251970517317168, "vf_loss": 7.1157121030159525, "vf_explained_var": 0.006771321399524189, "kl": Infinity, "entropy": 0.49351890160760686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 1080.0, "episode_reward_min": 36.0, "episode_reward_mean": 649.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -212.0}, "policy_reward_max": {"policy_0": 200.0}, "policy_reward_mean": {"policy_0": 64.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.0, 566.0, 271.0, 799.0, 430.0, 599.0, 700.0, 920.0, 710.0, 250.0, 361.0, 737.0, 762.0, 982.0, 678.0, 900.0, 667.0, 747.0, 743.0, 762.0, 920.0, 838.0, 702.0, 36.0, 223.0, 361.0, 813.0, 710.0, 613.0, 740.0, 645.0, 630.0, 525.0, 514.0, 800.0, 870.0, 799.0, 927.0, 900.0, 575.0, 590.0, 440.0, 387.0, 696.0, 315.0, 328.0, 647.0, 351.0, 840.0, 790.0, 706.0, 917.0, 660.0, 386.0, 827.0, 653.0, 530.0, 766.0, 580.0, 576.0, 890.0, 729.0, 1080.0, 622.0, 801.0, 690.0, 547.0, 517.0, 618.0, 710.0, 882.0, 565.0, 849.0, 719.0, 296.0, 657.0, 452.0, 578.0, 571.0, 721.0, 580.0, 599.0, 898.0, 560.0, 823.0, 593.0, 891.0, 371.0, 580.0, 709.0, 565.0, 729.0, 720.0, 621.0, 410.0, 935.0, 585.0, 692.0, 593.0, 752.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 40.0, 50.0, 40.0, 100.0, 40.0, 90.0, 50.0, 70.0, 110.0, 80.0, 60.0, 10.0, 70.0, 80.0, 20.0, 30.0, 60.0, 46.0, 20.0, 27.0, 30.0, 50.0, 16.0, 30.0, 20.0, 50.0, -1.0, 29.0, 190.0, 60.0, 100.0, 39.0, 50.0, 0.0, 80.0, 90.0, 120.0, 70.0, -6.0, 20.0, 40.0, 80.0, 100.0, 60.0, 70.0, 10.0, -4.0, 60.0, 90.0, 50.0, 19.0, 30.0, 90.0, 40.0, 40.0, 90.0, 110.0, 40.0, 50.0, 60.0, 80.0, 70.0, 110.0, 140.0, 80.0, 30.0, 40.0, 40.0, 100.0, 120.0, 20.0, 70.0, 80.0, 100.0, 120.0, 120.0, 90.0, 100.0, 70.0, 130.0, 120.0, 70.0, 70.0, 10.0, 70.0, 30.0, 80.0, 60.0, 30.0, 0.0, 40.0, 0.0, 60.0, 0.0, 5.0, 20.0, 65.0, 30.0, 50.0, 20.0, 30.0, 95.0, 19.0, 47.0, 30.0, 30.0, 0.0, 40.0, 63.0, 140.0, 90.0, 64.0, 70.0, 60.0, 43.0, 90.0, 17.0, 100.0, 60.0, 100.0, 30.0, 80.0, -9.0, 70.0, 120.0, 100.0, 120.0, 91.0, 90.0, 180.0, 100.0, 110.0, 119.0, 107.0, 90.0, 60.0, 30.0, 96.0, 60.0, 26.0, 40.0, 37.0, 110.0, 120.0, 20.0, 65.0, 60.0, 140.0, 30.0, 130.0, 80.0, 120.0, 50.0, 140.0, 90.0, 120.0, 70.0, 70.0, 40.0, 94.0, 110.0, 60.0, 140.0, 24.0, 39.0, 70.0, 40.0, 50.0, 110.0, 100.0, 60.0, 50.0, 80.0, 48.0, 30.0, 110.0, 59.0, 100.0, 130.0, 110.0, 51.0, 120.0, 100.0, 2.0, 80.0, 70.0, 20.0, 60.0, 38.0, 150.0, 180.0, 29.0, 70.0, -2.0, 100.0, 67.0, 40.0, 90.0, 80.0, 40.0, 70.0, 140.0, 100.0, 110.0, 80.0, 50.0, 110.0, 140.0, 69.0, 58.0, 130.0, 60.0, 90.0, 70.0, 67.0, 140.0, 77.0, 77.0, 50.0, 20.0, 19.0, 90.0, 59.0, 68.0, 70.0, 120.0, 146.0, 60.0, 10.0, 20.0, 20.0, 40.0, 20.0, -2.0, 8.0, 10.0, -90.0, 0.0, 50.0, 148.0, 10.0, 70.0, 60.0, 10.0, -114.0, -111.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 50.0, 6.0, 80.0, 28.0, 17.0, 10.0, 70.0, 32.0, 110.0, 60.0, 140.0, 110.0, 150.0, 40.0, 70.0, 31.0, 80.0, 70.0, 40.0, 100.0, 60.0, 40.0, 50.0, 110.0, 90.0, 70.0, 29.0, 80.0, 60.0, 40.0, 50.0, 84.0, 60.0, 70.0, 50.0, 90.0, 100.0, 10.0, 110.0, 110.0, 100.0, 30.0, 30.0, 130.0, 50.0, 70.0, 80.0, 30.0, 46.0, 70.0, 40.0, 150.0, 90.0, 20.0, 80.0, 39.0, 0.0, 50.0, 100.0, 50.0, 110.0, 20.0, 50.0, 70.0, 60.0, 120.0, 29.0, 42.0, 128.0, -75.0, 100.0, 79.0, 0.0, 60.0, 92.0, 70.0, 60.0, 15.0, 140.0, 109.0, 40.0, 60.0, 30.0, 0.0, 40.0, 20.0, 50.0, 60.0, 110.0, 100.0, 90.0, 70.0, 120.0, 50.0, 110.0, 40.0, 90.0, 70.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 100.0, 50.0, 100.0, 30.0, 40.0, 100.0, 140.0, 110.0, 80.0, 100.0, 35.0, 64.0, 60.0, 190.0, 110.0, 80.0, 34.0, 13.0, 120.0, 100.0, 50.0, 170.0, 110.0, 80.0, 60.0, 80.0, 50.0, 51.0, 140.0, 80.0, 120.0, 129.0, 30.0, 68.0, 40.0, 60.0, 80.0, 29.0, 10.0, 48.0, 170.0, 40.0, 50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0, 80.0, 60.0, 50.0, 50.0, 40.0, 50.0, 20.0, 10.0, 20.0, 60.0, -10.0, 40.0, 20.0, 17.0, 20.0, 110.0, 60.0, 110.0, 20.0, 0.0, 90.0, 80.0, 38.0, 60.0, 90.0, 83.0, 80.0, 70.0, 80.0, 25.0, 3.0, 20.0, 70.0, 60.0, 70.0, 37.0, -1.0, 40.0, -34.0, 50.0, 80.0, 0.0, 19.0, 200.0, 20.0, -29.0, -9.0, 50.0, -23.0, 20.0, 190.0, 100.0, 19.0, 120.0, 70.0, 8.0, 20.0, 90.0, 10.0, 20.0, 88.0, 110.0, 57.0, -22.0, -38.0, 50.0, 148.0, -212.0, 140.0, 30.0, 110.0, 130.0, 100.0, 80.0, 50.0, 60.0, 40.0, 90.0, 120.0, 60.0, 170.0, 40.0, 120.0, 50.0, 90.0, 15.0, 50.0, 50.0, 55.0, 150.0, 80.0, 80.0, 90.0, -14.0, -23.0, 44.0, 150.0, 70.0, 90.0, 139.0, 60.0, 70.0, 170.0, 110.0, 90.0, 100.0, 77.0, 90.0, 50.0, 100.0, 80.0, 50.0, 120.0, 80.0, -36.0, -17.0, 55.0, 88.0, 70.0, 170.0, 18.0, 10.0, 10.0, 70.0, 10.0, 50.0, 118.0, 60.0, 10.0, 30.0, 46.0, 90.0, 40.0, 110.0, 80.0, 69.0, 95.0, 87.0, 60.0, 150.0, 90.0, 20.0, 50.0, 38.0, 60.0, 25.0, 140.0, 60.0, 10.0, 160.0, 50.0, 120.0, 10.0, 20.0, 10.0, 60.0, 40.0, 60.0, 100.0, 60.0, 90.0, 49.0, 147.0, 100.0, 60.0, 60.0, 70.0, 50.0, 100.0, 40.0, 40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0, 50.0, 70.0, 75.0, 20.0, 30.0, 50.0, 56.0, 130.0, 45.0, 50.0, 40.0, 100.0, 110.0, 90.0, 60.0, 80.0, 100.0, 70.0, 60.0, 180.0, 120.0, 60.0, 27.0, 70.0, 32.0, 74.0, 53.0, 90.0, 90.0, 113.0, 80.0, 110.0, 190.0, 140.0, 130.0, 100.0, 90.0, 50.0, 100.0, 90.0, 10.0, 70.0, 20.0, 40.0, 110.0, 72.0, 40.0, 90.0, 120.0, 50.0, 0.0, 120.0, 166.0, 95.0, 50.0, 120.0, 30.0, 110.0, 60.0, 50.0, 80.0, 30.0, 90.0, 50.0, 60.0, 100.0, 100.0, 80.0, 30.0, 70.0, 70.0, 30.0, 70.0, 130.0, 40.0, 50.0, 80.0, 7.0, 50.0, 20.0, 20.0, 14.0, 33.0, 70.0, 60.0, 80.0, 80.0, 78.0, 50.0, 32.0, 61.0, 110.0, 28.0, 20.0, 27.0, 50.0, 82.0, 90.0, 50.0, 100.0, 90.0, 40.0, 80.0, 50.0, 110.0, 120.0, 80.0, 30.0, 50.0, 60.0, 140.0, 60.0, 160.0, 50.0, 56.0, 80.0, 110.0, 110.0, 70.0, 46.0, 1.0, 60.0, 70.0, 120.0, 40.0, 80.0, 70.0, 70.0, 4.0, 50.0, 180.0, 50.0, 49.0, 30.0, 60.0, 70.0, 78.0, 110.0, 160.0, 62.0, 119.0, 40.0, 60.0, 50.0, 0.0, 90.0, 60.0, 100.0, 130.0, 70.0, -4.0, 10.0, 30.0, 50.0, 50.0, -30.0, 10.0, 100.0, 10.0, 70.0, 82.0, 40.0, 20.0, 160.0, 70.0, -20.0, 50.0, 85.0, 90.0, 80.0, 30.0, 10.0, 70.0, 64.0, 50.0, 90.0, -10.0, 60.0, 58.0, 30.0, 30.0, 26.0, 60.0, 50.0, 58.0, 110.0, 120.0, 14.0, 60.0, 50.0, 88.0, -25.0, 120.0, 58.0, 60.0, 70.0, 70.0, -10.0, 110.0, 30.0, 140.0, 60.0, 100.0, 40.0, 77.0, 20.0, 100.0, 20.0, 44.0, 120.0, 80.0, 50.0, 60.0, 28.0, 2.0, 40.0, 70.0, 70.0, 90.0, 90.0, 50.0, 100.0, 70.0, 49.0, 20.0, 30.0, 130.0, 20.0, 30.0, 100.0, 69.0, 90.0, 160.0, 80.0, 69.0, 160.0, 70.0, 80.0, 50.0, 70.0, 30.0, 50.0, 60.0, 50.0, 60.0, 70.0, 50.0, 30.0, 110.0, 50.0, 50.0, 70.0, 100.0, 144.0, 60.0, 110.0, 80.0, 90.0, 70.0, 49.0, 80.0, 60.0, 100.0, 90.0, 120.0, 16.0, 20.0, 67.0, 10.0, 30.0, 36.0, 60.0, 100.0, 62.0, 60.0, 180.0, 76.0, 120.0, 58.0, 139.0, 19.0, 90.0, 50.0, 60.0, 13.0, 10.0, -4.0, 70.0, 28.0, 35.0, 40.0, 40.0, 40.0, 30.0, 70.0, 120.0, 70.0, 50.0, 40.0, 80.0, 40.0, 130.0, 59.0, 30.0, 60.0, 80.0, 80.0, 80.0, 50.0, 100.0, 30.0, 83.0, 50.0, 30.0, 82.0, 60.0, 60.0, 70.0, 40.0, 60.0, 20.0, 70.0, 100.0, 120.0, 50.0, 90.0, 90.0, 70.0, 19.0, 100.0, 80.0, 30.0, 110.0, 80.0, 90.0, 120.0, 30.0, 70.0, 80.0, 30.0, 60.0, 28.0, 40.0, 100.0, 66.0, 74.0, 40.0, 110.0, 73.0, 30.0, 50.0, 40.0, 35.0, 7.0, 50.0, -12.0, 40.0, 50.0, 50.0, 100.0, 120.0, 60.0, 90.0, 52.0, 130.0, 160.0, 90.0, 93.0, 80.0, 60.0, 100.0, 30.0, 130.0, 10.0, 70.0, 0.0, 60.0, 110.0, 70.0, 5.0, 170.0, 50.0, 110.0, 60.0, 80.0, 30.0, 70.0, 20.0, 52.0, 50.0, 14.0, 60.0, 29.0, 50.0, 60.0, 70.0, 100.0, 110.0, 50.0, 50.0, 60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5265965914492556, "mean_inference_ms": 1.5302889014961878, "mean_action_processing_ms": 0.48604139286927384, "mean_env_wait_ms": 1.3377533199639848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017622709274291992, "StateBufferConnector_ms": 0.009538650512695312, "ViewRequirementAgentConnector_ms": 0.3710315227508545}, "num_episodes": 23, "episode_return_max": 1080.0, "episode_return_min": 36.0, "episode_return_mean": 649.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.531219253806412, "num_env_steps_trained_throughput_per_sec": 21.531219253806412, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 185007.798, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185007.75, "sample_time_ms": 2436.556, "learn_time_ms": 182550.391, "learn_throughput": 21.912, "synch_weights_time_ms": 12.31}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "a22d3_00000", "date": "2024-08-06_05-38-07", "timestamp": 1722937087, "time_this_iter_s": 185.78880381584167, "time_total_s": 24877.593985557556, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24877.593985557556, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 17.219011406844107, "ram_util_percent": 77.69315589353613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.004178479456673, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.4232555368583935, "policy_loss": -0.009734261858959398, "vf_loss": 7.429538597364903, "vf_explained_var": 0.010429565061014681, "kl": 0.0028372895215245807, "entropy": 0.49320093069277127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 1100.0, "episode_reward_min": 36.0, "episode_reward_mean": 650.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -212.0}, "policy_reward_max": {"policy_0": 200.0}, "policy_reward_mean": {"policy_0": 65.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [702.0, 36.0, 223.0, 361.0, 813.0, 710.0, 613.0, 740.0, 645.0, 630.0, 525.0, 514.0, 800.0, 870.0, 799.0, 927.0, 900.0, 575.0, 590.0, 440.0, 387.0, 696.0, 315.0, 328.0, 647.0, 351.0, 840.0, 790.0, 706.0, 917.0, 660.0, 386.0, 827.0, 653.0, 530.0, 766.0, 580.0, 576.0, 890.0, 729.0, 1080.0, 622.0, 801.0, 690.0, 547.0, 517.0, 618.0, 710.0, 882.0, 565.0, 849.0, 719.0, 296.0, 657.0, 452.0, 578.0, 571.0, 721.0, 580.0, 599.0, 898.0, 560.0, 823.0, 593.0, 891.0, 371.0, 580.0, 709.0, 565.0, 729.0, 720.0, 621.0, 410.0, 935.0, 585.0, 692.0, 593.0, 752.0, 620.0, 476.0, 951.0, 659.0, 600.0, 749.0, 1100.0, 670.0, 504.0, 838.0, 862.0, 570.0, 555.0, 633.0, 967.0, 752.0, 519.0, 579.0, 720.0, 309.0, 650.0, 704.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 19.0, 90.0, 59.0, 68.0, 70.0, 120.0, 146.0, 60.0, 10.0, 20.0, 20.0, 40.0, 20.0, -2.0, 8.0, 10.0, -90.0, 0.0, 50.0, 148.0, 10.0, 70.0, 60.0, 10.0, -114.0, -111.0, 30.0, 70.0, 50.0, 60.0, 20.0, 40.0, 50.0, 6.0, 80.0, 28.0, 17.0, 10.0, 70.0, 32.0, 110.0, 60.0, 140.0, 110.0, 150.0, 40.0, 70.0, 31.0, 80.0, 70.0, 40.0, 100.0, 60.0, 40.0, 50.0, 110.0, 90.0, 70.0, 29.0, 80.0, 60.0, 40.0, 50.0, 84.0, 60.0, 70.0, 50.0, 90.0, 100.0, 10.0, 110.0, 110.0, 100.0, 30.0, 30.0, 130.0, 50.0, 70.0, 80.0, 30.0, 46.0, 70.0, 40.0, 150.0, 90.0, 20.0, 80.0, 39.0, 0.0, 50.0, 100.0, 50.0, 110.0, 20.0, 50.0, 70.0, 60.0, 120.0, 29.0, 42.0, 128.0, -75.0, 100.0, 79.0, 0.0, 60.0, 92.0, 70.0, 60.0, 15.0, 140.0, 109.0, 40.0, 60.0, 30.0, 0.0, 40.0, 20.0, 50.0, 60.0, 110.0, 100.0, 90.0, 70.0, 120.0, 50.0, 110.0, 40.0, 90.0, 70.0, 70.0, 90.0, 120.0, 110.0, 80.0, 90.0, 100.0, 50.0, 100.0, 30.0, 40.0, 100.0, 140.0, 110.0, 80.0, 100.0, 35.0, 64.0, 60.0, 190.0, 110.0, 80.0, 34.0, 13.0, 120.0, 100.0, 50.0, 170.0, 110.0, 80.0, 60.0, 80.0, 50.0, 51.0, 140.0, 80.0, 120.0, 129.0, 30.0, 68.0, 40.0, 60.0, 80.0, 29.0, 10.0, 48.0, 170.0, 40.0, 50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0, 80.0, 60.0, 50.0, 50.0, 40.0, 50.0, 20.0, 10.0, 20.0, 60.0, -10.0, 40.0, 20.0, 17.0, 20.0, 110.0, 60.0, 110.0, 20.0, 0.0, 90.0, 80.0, 38.0, 60.0, 90.0, 83.0, 80.0, 70.0, 80.0, 25.0, 3.0, 20.0, 70.0, 60.0, 70.0, 37.0, -1.0, 40.0, -34.0, 50.0, 80.0, 0.0, 19.0, 200.0, 20.0, -29.0, -9.0, 50.0, -23.0, 20.0, 190.0, 100.0, 19.0, 120.0, 70.0, 8.0, 20.0, 90.0, 10.0, 20.0, 88.0, 110.0, 57.0, -22.0, -38.0, 50.0, 148.0, -212.0, 140.0, 30.0, 110.0, 130.0, 100.0, 80.0, 50.0, 60.0, 40.0, 90.0, 120.0, 60.0, 170.0, 40.0, 120.0, 50.0, 90.0, 15.0, 50.0, 50.0, 55.0, 150.0, 80.0, 80.0, 90.0, -14.0, -23.0, 44.0, 150.0, 70.0, 90.0, 139.0, 60.0, 70.0, 170.0, 110.0, 90.0, 100.0, 77.0, 90.0, 50.0, 100.0, 80.0, 50.0, 120.0, 80.0, -36.0, -17.0, 55.0, 88.0, 70.0, 170.0, 18.0, 10.0, 10.0, 70.0, 10.0, 50.0, 118.0, 60.0, 10.0, 30.0, 46.0, 90.0, 40.0, 110.0, 80.0, 69.0, 95.0, 87.0, 60.0, 150.0, 90.0, 20.0, 50.0, 38.0, 60.0, 25.0, 140.0, 60.0, 10.0, 160.0, 50.0, 120.0, 10.0, 20.0, 10.0, 60.0, 40.0, 60.0, 100.0, 60.0, 90.0, 49.0, 147.0, 100.0, 60.0, 60.0, 70.0, 50.0, 100.0, 40.0, 40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0, 50.0, 70.0, 75.0, 20.0, 30.0, 50.0, 56.0, 130.0, 45.0, 50.0, 40.0, 100.0, 110.0, 90.0, 60.0, 80.0, 100.0, 70.0, 60.0, 180.0, 120.0, 60.0, 27.0, 70.0, 32.0, 74.0, 53.0, 90.0, 90.0, 113.0, 80.0, 110.0, 190.0, 140.0, 130.0, 100.0, 90.0, 50.0, 100.0, 90.0, 10.0, 70.0, 20.0, 40.0, 110.0, 72.0, 40.0, 90.0, 120.0, 50.0, 0.0, 120.0, 166.0, 95.0, 50.0, 120.0, 30.0, 110.0, 60.0, 50.0, 80.0, 30.0, 90.0, 50.0, 60.0, 100.0, 100.0, 80.0, 30.0, 70.0, 70.0, 30.0, 70.0, 130.0, 40.0, 50.0, 80.0, 7.0, 50.0, 20.0, 20.0, 14.0, 33.0, 70.0, 60.0, 80.0, 80.0, 78.0, 50.0, 32.0, 61.0, 110.0, 28.0, 20.0, 27.0, 50.0, 82.0, 90.0, 50.0, 100.0, 90.0, 40.0, 80.0, 50.0, 110.0, 120.0, 80.0, 30.0, 50.0, 60.0, 140.0, 60.0, 160.0, 50.0, 56.0, 80.0, 110.0, 110.0, 70.0, 46.0, 1.0, 60.0, 70.0, 120.0, 40.0, 80.0, 70.0, 70.0, 4.0, 50.0, 180.0, 50.0, 49.0, 30.0, 60.0, 70.0, 78.0, 110.0, 160.0, 62.0, 119.0, 40.0, 60.0, 50.0, 0.0, 90.0, 60.0, 100.0, 130.0, 70.0, -4.0, 10.0, 30.0, 50.0, 50.0, -30.0, 10.0, 100.0, 10.0, 70.0, 82.0, 40.0, 20.0, 160.0, 70.0, -20.0, 50.0, 85.0, 90.0, 80.0, 30.0, 10.0, 70.0, 64.0, 50.0, 90.0, -10.0, 60.0, 58.0, 30.0, 30.0, 26.0, 60.0, 50.0, 58.0, 110.0, 120.0, 14.0, 60.0, 50.0, 88.0, -25.0, 120.0, 58.0, 60.0, 70.0, 70.0, -10.0, 110.0, 30.0, 140.0, 60.0, 100.0, 40.0, 77.0, 20.0, 100.0, 20.0, 44.0, 120.0, 80.0, 50.0, 60.0, 28.0, 2.0, 40.0, 70.0, 70.0, 90.0, 90.0, 50.0, 100.0, 70.0, 49.0, 20.0, 30.0, 130.0, 20.0, 30.0, 100.0, 69.0, 90.0, 160.0, 80.0, 69.0, 160.0, 70.0, 80.0, 50.0, 70.0, 30.0, 50.0, 60.0, 50.0, 60.0, 70.0, 50.0, 30.0, 110.0, 50.0, 50.0, 70.0, 100.0, 144.0, 60.0, 110.0, 80.0, 90.0, 70.0, 49.0, 80.0, 60.0, 100.0, 90.0, 120.0, 16.0, 20.0, 67.0, 10.0, 30.0, 36.0, 60.0, 100.0, 62.0, 60.0, 180.0, 76.0, 120.0, 58.0, 139.0, 19.0, 90.0, 50.0, 60.0, 13.0, 10.0, -4.0, 70.0, 28.0, 35.0, 40.0, 40.0, 40.0, 30.0, 70.0, 120.0, 70.0, 50.0, 40.0, 80.0, 40.0, 130.0, 59.0, 30.0, 60.0, 80.0, 80.0, 80.0, 50.0, 100.0, 30.0, 83.0, 50.0, 30.0, 82.0, 60.0, 60.0, 70.0, 40.0, 60.0, 20.0, 70.0, 100.0, 120.0, 50.0, 90.0, 90.0, 70.0, 19.0, 100.0, 80.0, 30.0, 110.0, 80.0, 90.0, 120.0, 30.0, 70.0, 80.0, 30.0, 60.0, 28.0, 40.0, 100.0, 66.0, 74.0, 40.0, 110.0, 73.0, 30.0, 50.0, 40.0, 35.0, 7.0, 50.0, -12.0, 40.0, 50.0, 50.0, 100.0, 120.0, 60.0, 90.0, 52.0, 130.0, 160.0, 90.0, 93.0, 80.0, 60.0, 100.0, 30.0, 130.0, 10.0, 70.0, 0.0, 60.0, 110.0, 70.0, 5.0, 170.0, 50.0, 110.0, 60.0, 80.0, 30.0, 70.0, 20.0, 52.0, 50.0, 14.0, 60.0, 29.0, 50.0, 60.0, 70.0, 100.0, 110.0, 50.0, 50.0, 60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0, 30.0, 60.0, 80.0, 31.0, 49.0, 40.0, 90.0, 20.0, 110.0, 110.0, 5.0, 40.0, 40.0, 105.0, 20.0, 60.0, 98.0, 38.0, 40.0, 30.0, 100.0, 70.0, 140.0, 130.0, 98.0, 95.0, 88.0, 10.0, 110.0, 110.0, 110.0, 80.0, 20.0, 80.0, 60.0, 50.0, 130.0, 100.0, 10.0, 19.0, 50.0, 60.0, 90.0, 40.0, 70.0, 20.0, 130.0, 90.0, 30.0, 20.0, 100.0, 40.0, 50.0, 130.0, 39.0, 100.0, 110.0, 40.0, 30.0, 110.0, 90.0, 110.0, 100.0, 100.0, 120.0, 100.0, 140.0, 80.0, 140.0, 120.0, 80.0, 20.0, 70.0, 30.0, 130.0, 80.0, 20.0, 80.0, 120.0, 40.0, 54.0, 120.0, 86.0, 30.0, 24.0, 50.0, 10.0, 15.0, 85.0, 30.0, 100.0, 70.0, -16.0, 140.0, 120.0, 80.0, 90.0, 180.0, 14.0, 60.0, 88.0, 100.0, 90.0, 80.0, 80.0, 50.0, 120.0, 110.0, 75.0, 69.0, 40.0, 70.0, 50.0, 60.0, 30.0, 100.0, 30.0, 60.0, 30.0, 100.0, 30.0, 0.0, 20.0, 40.0, 85.0, 50.0, 80.0, 70.0, 60.0, 120.0, 110.0, 40.0, 110.0, 85.0, 40.0, 40.0, 110.0, 38.0, 0.0, 60.0, 60.0, 130.0, 160.0, 70.0, 100.0, 87.0, 70.0, 80.0, 120.0, 90.0, 60.0, 120.0, 100.0, 40.0, 90.0, 50.0, 33.0, 80.0, 80.0, 99.0, 120.0, 60.0, 120.0, 20.0, 2.0, 8.0, 100.0, 30.0, 50.0, 9.0, 20.0, 80.0, 40.0, -1.0, 50.0, 90.0, 90.0, 90.0, 100.0, 20.0, 80.0, 70.0, 90.0, 100.0, 100.0, 50.0, 30.0, 50.0, 90.0, 60.0, 5.0, 80.0, -11.0, 10.0, 8.0, 50.0, 7.0, 70.0, 80.0, 10.0, 130.0, 30.0, 125.0, 130.0, -5.0, 70.0, 40.0, 40.0, 10.0, 80.0, -1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5251445830566224, "mean_inference_ms": 1.5287371565365833, "mean_action_processing_ms": 0.4855257164695267, "mean_env_wait_ms": 1.3368910569127022, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012232542037963867, "StateBufferConnector_ms": 0.00939321517944336, "ViewRequirementAgentConnector_ms": 0.36359071731567383}, "num_episodes": 22, "episode_return_max": 1100.0, "episode_return_min": 36.0, "episode_return_mean": 650.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.68057462942848, "num_env_steps_trained_throughput_per_sec": 21.68057462942848, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 184977.881, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184977.833, "sample_time_ms": 2431.606, "learn_time_ms": 182525.367, "learn_throughput": 21.915, "synch_weights_time_ms": 12.357}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "a22d3_00000", "date": "2024-08-06_05-41-11", "timestamp": 1722937271, "time_this_iter_s": 184.50499296188354, "time_total_s": 25062.09897851944, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17c4160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25062.09897851944, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 16.930651340996167, "ram_util_percent": 78.06743295019156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.881466635271383, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.063662092982771, "policy_loss": -0.01181782650757835, "vf_loss": 7.072477572718367, "vf_explained_var": 0.007156697985209342, "kl": 0.004936563099826585, "entropy": 0.49420090738894207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 1100.0, "episode_reward_min": 296.0, "episode_reward_mean": 658.86, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -212.0}, "policy_reward_max": {"policy_0": 200.0}, "policy_reward_mean": {"policy_0": 65.886}, "custom_metrics": {}, "hist_stats": {"episode_reward": [590.0, 440.0, 387.0, 696.0, 315.0, 328.0, 647.0, 351.0, 840.0, 790.0, 706.0, 917.0, 660.0, 386.0, 827.0, 653.0, 530.0, 766.0, 580.0, 576.0, 890.0, 729.0, 1080.0, 622.0, 801.0, 690.0, 547.0, 517.0, 618.0, 710.0, 882.0, 565.0, 849.0, 719.0, 296.0, 657.0, 452.0, 578.0, 571.0, 721.0, 580.0, 599.0, 898.0, 560.0, 823.0, 593.0, 891.0, 371.0, 580.0, 709.0, 565.0, 729.0, 720.0, 621.0, 410.0, 935.0, 585.0, 692.0, 593.0, 752.0, 620.0, 476.0, 951.0, 659.0, 600.0, 749.0, 1100.0, 670.0, 504.0, 838.0, 862.0, 570.0, 555.0, 633.0, 967.0, 752.0, 519.0, 579.0, 720.0, 309.0, 650.0, 704.0, 840.0, 730.0, 452.0, 654.0, 346.0, 832.0, 900.0, 990.0, 450.0, 761.0, 620.0, 889.0, 723.0, 650.0, 627.0, 657.0, 509.0, 584.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 100.0, 60.0, 90.0, 40.0, 90.0, 50.0, 40.0, 20.0, 50.0, 80.0, 60.0, 50.0, 50.0, 40.0, 50.0, 20.0, 10.0, 20.0, 60.0, -10.0, 40.0, 20.0, 17.0, 20.0, 110.0, 60.0, 110.0, 20.0, 0.0, 90.0, 80.0, 38.0, 60.0, 90.0, 83.0, 80.0, 70.0, 80.0, 25.0, 3.0, 20.0, 70.0, 60.0, 70.0, 37.0, -1.0, 40.0, -34.0, 50.0, 80.0, 0.0, 19.0, 200.0, 20.0, -29.0, -9.0, 50.0, -23.0, 20.0, 190.0, 100.0, 19.0, 120.0, 70.0, 8.0, 20.0, 90.0, 10.0, 20.0, 88.0, 110.0, 57.0, -22.0, -38.0, 50.0, 148.0, -212.0, 140.0, 30.0, 110.0, 130.0, 100.0, 80.0, 50.0, 60.0, 40.0, 90.0, 120.0, 60.0, 170.0, 40.0, 120.0, 50.0, 90.0, 15.0, 50.0, 50.0, 55.0, 150.0, 80.0, 80.0, 90.0, -14.0, -23.0, 44.0, 150.0, 70.0, 90.0, 139.0, 60.0, 70.0, 170.0, 110.0, 90.0, 100.0, 77.0, 90.0, 50.0, 100.0, 80.0, 50.0, 120.0, 80.0, -36.0, -17.0, 55.0, 88.0, 70.0, 170.0, 18.0, 10.0, 10.0, 70.0, 10.0, 50.0, 118.0, 60.0, 10.0, 30.0, 46.0, 90.0, 40.0, 110.0, 80.0, 69.0, 95.0, 87.0, 60.0, 150.0, 90.0, 20.0, 50.0, 38.0, 60.0, 25.0, 140.0, 60.0, 10.0, 160.0, 50.0, 120.0, 10.0, 20.0, 10.0, 60.0, 40.0, 60.0, 100.0, 60.0, 90.0, 49.0, 147.0, 100.0, 60.0, 60.0, 70.0, 50.0, 100.0, 40.0, 40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0, 50.0, 70.0, 75.0, 20.0, 30.0, 50.0, 56.0, 130.0, 45.0, 50.0, 40.0, 100.0, 110.0, 90.0, 60.0, 80.0, 100.0, 70.0, 60.0, 180.0, 120.0, 60.0, 27.0, 70.0, 32.0, 74.0, 53.0, 90.0, 90.0, 113.0, 80.0, 110.0, 190.0, 140.0, 130.0, 100.0, 90.0, 50.0, 100.0, 90.0, 10.0, 70.0, 20.0, 40.0, 110.0, 72.0, 40.0, 90.0, 120.0, 50.0, 0.0, 120.0, 166.0, 95.0, 50.0, 120.0, 30.0, 110.0, 60.0, 50.0, 80.0, 30.0, 90.0, 50.0, 60.0, 100.0, 100.0, 80.0, 30.0, 70.0, 70.0, 30.0, 70.0, 130.0, 40.0, 50.0, 80.0, 7.0, 50.0, 20.0, 20.0, 14.0, 33.0, 70.0, 60.0, 80.0, 80.0, 78.0, 50.0, 32.0, 61.0, 110.0, 28.0, 20.0, 27.0, 50.0, 82.0, 90.0, 50.0, 100.0, 90.0, 40.0, 80.0, 50.0, 110.0, 120.0, 80.0, 30.0, 50.0, 60.0, 140.0, 60.0, 160.0, 50.0, 56.0, 80.0, 110.0, 110.0, 70.0, 46.0, 1.0, 60.0, 70.0, 120.0, 40.0, 80.0, 70.0, 70.0, 4.0, 50.0, 180.0, 50.0, 49.0, 30.0, 60.0, 70.0, 78.0, 110.0, 160.0, 62.0, 119.0, 40.0, 60.0, 50.0, 0.0, 90.0, 60.0, 100.0, 130.0, 70.0, -4.0, 10.0, 30.0, 50.0, 50.0, -30.0, 10.0, 100.0, 10.0, 70.0, 82.0, 40.0, 20.0, 160.0, 70.0, -20.0, 50.0, 85.0, 90.0, 80.0, 30.0, 10.0, 70.0, 64.0, 50.0, 90.0, -10.0, 60.0, 58.0, 30.0, 30.0, 26.0, 60.0, 50.0, 58.0, 110.0, 120.0, 14.0, 60.0, 50.0, 88.0, -25.0, 120.0, 58.0, 60.0, 70.0, 70.0, -10.0, 110.0, 30.0, 140.0, 60.0, 100.0, 40.0, 77.0, 20.0, 100.0, 20.0, 44.0, 120.0, 80.0, 50.0, 60.0, 28.0, 2.0, 40.0, 70.0, 70.0, 90.0, 90.0, 50.0, 100.0, 70.0, 49.0, 20.0, 30.0, 130.0, 20.0, 30.0, 100.0, 69.0, 90.0, 160.0, 80.0, 69.0, 160.0, 70.0, 80.0, 50.0, 70.0, 30.0, 50.0, 60.0, 50.0, 60.0, 70.0, 50.0, 30.0, 110.0, 50.0, 50.0, 70.0, 100.0, 144.0, 60.0, 110.0, 80.0, 90.0, 70.0, 49.0, 80.0, 60.0, 100.0, 90.0, 120.0, 16.0, 20.0, 67.0, 10.0, 30.0, 36.0, 60.0, 100.0, 62.0, 60.0, 180.0, 76.0, 120.0, 58.0, 139.0, 19.0, 90.0, 50.0, 60.0, 13.0, 10.0, -4.0, 70.0, 28.0, 35.0, 40.0, 40.0, 40.0, 30.0, 70.0, 120.0, 70.0, 50.0, 40.0, 80.0, 40.0, 130.0, 59.0, 30.0, 60.0, 80.0, 80.0, 80.0, 50.0, 100.0, 30.0, 83.0, 50.0, 30.0, 82.0, 60.0, 60.0, 70.0, 40.0, 60.0, 20.0, 70.0, 100.0, 120.0, 50.0, 90.0, 90.0, 70.0, 19.0, 100.0, 80.0, 30.0, 110.0, 80.0, 90.0, 120.0, 30.0, 70.0, 80.0, 30.0, 60.0, 28.0, 40.0, 100.0, 66.0, 74.0, 40.0, 110.0, 73.0, 30.0, 50.0, 40.0, 35.0, 7.0, 50.0, -12.0, 40.0, 50.0, 50.0, 100.0, 120.0, 60.0, 90.0, 52.0, 130.0, 160.0, 90.0, 93.0, 80.0, 60.0, 100.0, 30.0, 130.0, 10.0, 70.0, 0.0, 60.0, 110.0, 70.0, 5.0, 170.0, 50.0, 110.0, 60.0, 80.0, 30.0, 70.0, 20.0, 52.0, 50.0, 14.0, 60.0, 29.0, 50.0, 60.0, 70.0, 100.0, 110.0, 50.0, 50.0, 60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0, 30.0, 60.0, 80.0, 31.0, 49.0, 40.0, 90.0, 20.0, 110.0, 110.0, 5.0, 40.0, 40.0, 105.0, 20.0, 60.0, 98.0, 38.0, 40.0, 30.0, 100.0, 70.0, 140.0, 130.0, 98.0, 95.0, 88.0, 10.0, 110.0, 110.0, 110.0, 80.0, 20.0, 80.0, 60.0, 50.0, 130.0, 100.0, 10.0, 19.0, 50.0, 60.0, 90.0, 40.0, 70.0, 20.0, 130.0, 90.0, 30.0, 20.0, 100.0, 40.0, 50.0, 130.0, 39.0, 100.0, 110.0, 40.0, 30.0, 110.0, 90.0, 110.0, 100.0, 100.0, 120.0, 100.0, 140.0, 80.0, 140.0, 120.0, 80.0, 20.0, 70.0, 30.0, 130.0, 80.0, 20.0, 80.0, 120.0, 40.0, 54.0, 120.0, 86.0, 30.0, 24.0, 50.0, 10.0, 15.0, 85.0, 30.0, 100.0, 70.0, -16.0, 140.0, 120.0, 80.0, 90.0, 180.0, 14.0, 60.0, 88.0, 100.0, 90.0, 80.0, 80.0, 50.0, 120.0, 110.0, 75.0, 69.0, 40.0, 70.0, 50.0, 60.0, 30.0, 100.0, 30.0, 60.0, 30.0, 100.0, 30.0, 0.0, 20.0, 40.0, 85.0, 50.0, 80.0, 70.0, 60.0, 120.0, 110.0, 40.0, 110.0, 85.0, 40.0, 40.0, 110.0, 38.0, 0.0, 60.0, 60.0, 130.0, 160.0, 70.0, 100.0, 87.0, 70.0, 80.0, 120.0, 90.0, 60.0, 120.0, 100.0, 40.0, 90.0, 50.0, 33.0, 80.0, 80.0, 99.0, 120.0, 60.0, 120.0, 20.0, 2.0, 8.0, 100.0, 30.0, 50.0, 9.0, 20.0, 80.0, 40.0, -1.0, 50.0, 90.0, 90.0, 90.0, 100.0, 20.0, 80.0, 70.0, 90.0, 100.0, 100.0, 50.0, 30.0, 50.0, 90.0, 60.0, 5.0, 80.0, -11.0, 10.0, 8.0, 50.0, 7.0, 70.0, 80.0, 10.0, 130.0, 30.0, 125.0, 130.0, -5.0, 70.0, 40.0, 40.0, 10.0, 80.0, -1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0, 60.0, 50.0, 60.0, 150.0, 90.0, 135.0, 70.0, 100.0, 110.0, 15.0, 10.0, 120.0, 60.0, 170.0, 0.0, 60.0, 80.0, 100.0, 70.0, 60.0, 100.0, 110.0, 100.0, -31.0, 40.0, 22.0, 70.0, -39.0, 50.0, 30.0, 37.0, 120.0, 40.0, 30.0, 70.0, 70.0, 60.0, 107.0, 110.0, 10.0, 40.0, -39.0, 20.0, 50.0, 2.0, 60.0, 29.0, 60.0, 40.0, 84.0, 59.0, 38.0, 80.0, 40.0, 120.0, 120.0, 70.0, 100.0, 125.0, 80.0, 57.0, 90.0, 90.0, 90.0, 80.0, 130.0, 110.0, 13.0, 150.0, 90.0, 120.0, 40.0, 120.0, 140.0, 60.0, 80.0, 90.0, 100.0, 90.0, 150.0, 40.0, 30.0, 30.0, 30.0, 20.0, 120.0, 10.0, 70.0, 70.0, 30.0, 60.0, 110.0, 70.0, 70.0, 130.0, 80.0, 130.0, 6.0, 45.0, 60.0, 50.0, 50.0, 98.0, 15.0, 90.0, 30.0, 38.0, 39.0, 80.0, 130.0, 80.0, 120.0, 160.0, 109.0, 130.0, 70.0, 50.0, 40.0, 50.0, 80.0, 60.0, 70.0, 30.0, 130.0, 122.0, 20.0, 160.0, 30.0, 80.0, 21.0, 120.0, 60.0, 130.0, 60.0, 80.0, 30.0, 70.0, 30.0, 20.0, 50.0, 39.0, 140.0, 26.0, 50.0, 70.0, 100.0, 50.0, 51.0, 49.0, 52.0, 87.0, 40.0, 70.0, 0.0, 120.0, 47.0, 120.0, 79.0, 60.0, 34.0, 100.0, 10.0, 50.0, 120.0, -6.0, 30.0, 55.0, 60.0, 60.0, 30.0, 110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5254171955876563, "mean_inference_ms": 1.5283600225988148, "mean_action_processing_ms": 0.4851712560186593, "mean_env_wait_ms": 1.3359933131228963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011739253997802734, "StateBufferConnector_ms": 0.009058237075805664, "ViewRequirementAgentConnector_ms": 0.3536067008972168}, "num_episodes": 18, "episode_return_max": 1100.0, "episode_return_min": 296.0, "episode_return_mean": 658.86}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.56450077714815, "num_env_steps_trained_throughput_per_sec": 21.56450077714815, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 185062.85, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185062.802, "sample_time_ms": 2411.457, "learn_time_ms": 182631.372, "learn_throughput": 21.902, "synch_weights_time_ms": 11.733}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "a22d3_00000", "date": "2024-08-06_05-44-17", "timestamp": 1722937457, "time_this_iter_s": 185.501455783844, "time_total_s": 25247.600434303284, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17de8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25247.600434303284, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 18.43473282442748, "ram_util_percent": 78.15725190839694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.932662344435914, "cur_kl_coeff": 0.3040929794311523, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011880550585802212, "vf_loss": 6.952094981363152, "vf_explained_var": 0.015587630794959836, "kl": Infinity, "entropy": 0.5118356210799517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 1100.0, "episode_reward_min": 296.0, "episode_reward_mean": 674.42, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -39.0}, "policy_reward_max": {"policy_0": 190.0}, "policy_reward_mean": {"policy_0": 67.442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [580.0, 576.0, 890.0, 729.0, 1080.0, 622.0, 801.0, 690.0, 547.0, 517.0, 618.0, 710.0, 882.0, 565.0, 849.0, 719.0, 296.0, 657.0, 452.0, 578.0, 571.0, 721.0, 580.0, 599.0, 898.0, 560.0, 823.0, 593.0, 891.0, 371.0, 580.0, 709.0, 565.0, 729.0, 720.0, 621.0, 410.0, 935.0, 585.0, 692.0, 593.0, 752.0, 620.0, 476.0, 951.0, 659.0, 600.0, 749.0, 1100.0, 670.0, 504.0, 838.0, 862.0, 570.0, 555.0, 633.0, 967.0, 752.0, 519.0, 579.0, 720.0, 309.0, 650.0, 704.0, 840.0, 730.0, 452.0, 654.0, 346.0, 832.0, 900.0, 990.0, 450.0, 761.0, 620.0, 889.0, 723.0, 650.0, 627.0, 657.0, 509.0, 584.0, 937.0, 656.0, 669.0, 592.0, 523.0, 317.0, 926.0, 556.0, 680.0, 767.0, 905.0, 585.0, 527.0, 695.0, 895.0, 526.0, 780.0, 849.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 60.0, 40.0, 40.0, 60.0, 30.0, 80.0, 150.0, 20.0, 60.0, 50.0, 70.0, 75.0, 20.0, 30.0, 50.0, 56.0, 130.0, 45.0, 50.0, 40.0, 100.0, 110.0, 90.0, 60.0, 80.0, 100.0, 70.0, 60.0, 180.0, 120.0, 60.0, 27.0, 70.0, 32.0, 74.0, 53.0, 90.0, 90.0, 113.0, 80.0, 110.0, 190.0, 140.0, 130.0, 100.0, 90.0, 50.0, 100.0, 90.0, 10.0, 70.0, 20.0, 40.0, 110.0, 72.0, 40.0, 90.0, 120.0, 50.0, 0.0, 120.0, 166.0, 95.0, 50.0, 120.0, 30.0, 110.0, 60.0, 50.0, 80.0, 30.0, 90.0, 50.0, 60.0, 100.0, 100.0, 80.0, 30.0, 70.0, 70.0, 30.0, 70.0, 130.0, 40.0, 50.0, 80.0, 7.0, 50.0, 20.0, 20.0, 14.0, 33.0, 70.0, 60.0, 80.0, 80.0, 78.0, 50.0, 32.0, 61.0, 110.0, 28.0, 20.0, 27.0, 50.0, 82.0, 90.0, 50.0, 100.0, 90.0, 40.0, 80.0, 50.0, 110.0, 120.0, 80.0, 30.0, 50.0, 60.0, 140.0, 60.0, 160.0, 50.0, 56.0, 80.0, 110.0, 110.0, 70.0, 46.0, 1.0, 60.0, 70.0, 120.0, 40.0, 80.0, 70.0, 70.0, 4.0, 50.0, 180.0, 50.0, 49.0, 30.0, 60.0, 70.0, 78.0, 110.0, 160.0, 62.0, 119.0, 40.0, 60.0, 50.0, 0.0, 90.0, 60.0, 100.0, 130.0, 70.0, -4.0, 10.0, 30.0, 50.0, 50.0, -30.0, 10.0, 100.0, 10.0, 70.0, 82.0, 40.0, 20.0, 160.0, 70.0, -20.0, 50.0, 85.0, 90.0, 80.0, 30.0, 10.0, 70.0, 64.0, 50.0, 90.0, -10.0, 60.0, 58.0, 30.0, 30.0, 26.0, 60.0, 50.0, 58.0, 110.0, 120.0, 14.0, 60.0, 50.0, 88.0, -25.0, 120.0, 58.0, 60.0, 70.0, 70.0, -10.0, 110.0, 30.0, 140.0, 60.0, 100.0, 40.0, 77.0, 20.0, 100.0, 20.0, 44.0, 120.0, 80.0, 50.0, 60.0, 28.0, 2.0, 40.0, 70.0, 70.0, 90.0, 90.0, 50.0, 100.0, 70.0, 49.0, 20.0, 30.0, 130.0, 20.0, 30.0, 100.0, 69.0, 90.0, 160.0, 80.0, 69.0, 160.0, 70.0, 80.0, 50.0, 70.0, 30.0, 50.0, 60.0, 50.0, 60.0, 70.0, 50.0, 30.0, 110.0, 50.0, 50.0, 70.0, 100.0, 144.0, 60.0, 110.0, 80.0, 90.0, 70.0, 49.0, 80.0, 60.0, 100.0, 90.0, 120.0, 16.0, 20.0, 67.0, 10.0, 30.0, 36.0, 60.0, 100.0, 62.0, 60.0, 180.0, 76.0, 120.0, 58.0, 139.0, 19.0, 90.0, 50.0, 60.0, 13.0, 10.0, -4.0, 70.0, 28.0, 35.0, 40.0, 40.0, 40.0, 30.0, 70.0, 120.0, 70.0, 50.0, 40.0, 80.0, 40.0, 130.0, 59.0, 30.0, 60.0, 80.0, 80.0, 80.0, 50.0, 100.0, 30.0, 83.0, 50.0, 30.0, 82.0, 60.0, 60.0, 70.0, 40.0, 60.0, 20.0, 70.0, 100.0, 120.0, 50.0, 90.0, 90.0, 70.0, 19.0, 100.0, 80.0, 30.0, 110.0, 80.0, 90.0, 120.0, 30.0, 70.0, 80.0, 30.0, 60.0, 28.0, 40.0, 100.0, 66.0, 74.0, 40.0, 110.0, 73.0, 30.0, 50.0, 40.0, 35.0, 7.0, 50.0, -12.0, 40.0, 50.0, 50.0, 100.0, 120.0, 60.0, 90.0, 52.0, 130.0, 160.0, 90.0, 93.0, 80.0, 60.0, 100.0, 30.0, 130.0, 10.0, 70.0, 0.0, 60.0, 110.0, 70.0, 5.0, 170.0, 50.0, 110.0, 60.0, 80.0, 30.0, 70.0, 20.0, 52.0, 50.0, 14.0, 60.0, 29.0, 50.0, 60.0, 70.0, 100.0, 110.0, 50.0, 50.0, 60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0, 30.0, 60.0, 80.0, 31.0, 49.0, 40.0, 90.0, 20.0, 110.0, 110.0, 5.0, 40.0, 40.0, 105.0, 20.0, 60.0, 98.0, 38.0, 40.0, 30.0, 100.0, 70.0, 140.0, 130.0, 98.0, 95.0, 88.0, 10.0, 110.0, 110.0, 110.0, 80.0, 20.0, 80.0, 60.0, 50.0, 130.0, 100.0, 10.0, 19.0, 50.0, 60.0, 90.0, 40.0, 70.0, 20.0, 130.0, 90.0, 30.0, 20.0, 100.0, 40.0, 50.0, 130.0, 39.0, 100.0, 110.0, 40.0, 30.0, 110.0, 90.0, 110.0, 100.0, 100.0, 120.0, 100.0, 140.0, 80.0, 140.0, 120.0, 80.0, 20.0, 70.0, 30.0, 130.0, 80.0, 20.0, 80.0, 120.0, 40.0, 54.0, 120.0, 86.0, 30.0, 24.0, 50.0, 10.0, 15.0, 85.0, 30.0, 100.0, 70.0, -16.0, 140.0, 120.0, 80.0, 90.0, 180.0, 14.0, 60.0, 88.0, 100.0, 90.0, 80.0, 80.0, 50.0, 120.0, 110.0, 75.0, 69.0, 40.0, 70.0, 50.0, 60.0, 30.0, 100.0, 30.0, 60.0, 30.0, 100.0, 30.0, 0.0, 20.0, 40.0, 85.0, 50.0, 80.0, 70.0, 60.0, 120.0, 110.0, 40.0, 110.0, 85.0, 40.0, 40.0, 110.0, 38.0, 0.0, 60.0, 60.0, 130.0, 160.0, 70.0, 100.0, 87.0, 70.0, 80.0, 120.0, 90.0, 60.0, 120.0, 100.0, 40.0, 90.0, 50.0, 33.0, 80.0, 80.0, 99.0, 120.0, 60.0, 120.0, 20.0, 2.0, 8.0, 100.0, 30.0, 50.0, 9.0, 20.0, 80.0, 40.0, -1.0, 50.0, 90.0, 90.0, 90.0, 100.0, 20.0, 80.0, 70.0, 90.0, 100.0, 100.0, 50.0, 30.0, 50.0, 90.0, 60.0, 5.0, 80.0, -11.0, 10.0, 8.0, 50.0, 7.0, 70.0, 80.0, 10.0, 130.0, 30.0, 125.0, 130.0, -5.0, 70.0, 40.0, 40.0, 10.0, 80.0, -1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0, 60.0, 50.0, 60.0, 150.0, 90.0, 135.0, 70.0, 100.0, 110.0, 15.0, 10.0, 120.0, 60.0, 170.0, 0.0, 60.0, 80.0, 100.0, 70.0, 60.0, 100.0, 110.0, 100.0, -31.0, 40.0, 22.0, 70.0, -39.0, 50.0, 30.0, 37.0, 120.0, 40.0, 30.0, 70.0, 70.0, 60.0, 107.0, 110.0, 10.0, 40.0, -39.0, 20.0, 50.0, 2.0, 60.0, 29.0, 60.0, 40.0, 84.0, 59.0, 38.0, 80.0, 40.0, 120.0, 120.0, 70.0, 100.0, 125.0, 80.0, 57.0, 90.0, 90.0, 90.0, 80.0, 130.0, 110.0, 13.0, 150.0, 90.0, 120.0, 40.0, 120.0, 140.0, 60.0, 80.0, 90.0, 100.0, 90.0, 150.0, 40.0, 30.0, 30.0, 30.0, 20.0, 120.0, 10.0, 70.0, 70.0, 30.0, 60.0, 110.0, 70.0, 70.0, 130.0, 80.0, 130.0, 6.0, 45.0, 60.0, 50.0, 50.0, 98.0, 15.0, 90.0, 30.0, 38.0, 39.0, 80.0, 130.0, 80.0, 120.0, 160.0, 109.0, 130.0, 70.0, 50.0, 40.0, 50.0, 80.0, 60.0, 70.0, 30.0, 130.0, 122.0, 20.0, 160.0, 30.0, 80.0, 21.0, 120.0, 60.0, 130.0, 60.0, 80.0, 30.0, 70.0, 30.0, 20.0, 50.0, 39.0, 140.0, 26.0, 50.0, 70.0, 100.0, 50.0, 51.0, 49.0, 52.0, 87.0, 40.0, 70.0, 0.0, 120.0, 47.0, 120.0, 79.0, 60.0, 34.0, 100.0, 10.0, 50.0, 120.0, -6.0, 30.0, 55.0, 60.0, 60.0, 30.0, 110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0, 100.0, 100.0, 20.0, 140.0, 90.0, 140.0, 168.0, 30.0, 109.0, 40.0, 130.0, 37.0, 21.0, 50.0, 40.0, 60.0, 90.0, 40.0, 170.0, 18.0, -14.0, 34.0, 80.0, 62.0, 71.0, 63.0, 160.0, 33.0, 80.0, 100.0, 140.0, 23.0, 29.0, 80.0, 90.0, 80.0, 51.0, 30.0, 29.0, 40.0, 20.0, 50.0, 60.0, 40.0, 50.0, 110.0, 50.0, 40.0, 47.0, 56.0, 100.0, 100.0, 38.0, 17.0, 10.0, -14.0, 6.0, 50.0, -20.0, 30.0, 90.0, 100.0, 100.0, 49.0, 150.0, 40.0, 100.0, 170.0, 90.0, 37.0, 70.0, 0.0, 100.0, 4.0, 70.0, 130.0, 25.0, 27.0, 110.0, 20.0, 100.0, 10.0, 90.0, 100.0, 90.0, 30.0, 60.0, 80.0, 30.0, 90.0, 90.0, 80.0, 50.0, 70.0, 90.0, 87.0, 80.0, 60.0, 50.0, 110.0, 90.0, 35.0, 50.0, 110.0, 50.0, 170.0, 130.0, 50.0, 100.0, 120.0, 30.0, 88.0, 70.0, 50.0, 52.0, 80.0, 15.0, 50.0, 80.0, 70.0, 27.0, 10.0, 40.0, 180.0, 60.0, 40.0, 50.0, 30.0, 50.0, 40.0, 40.0, 100.0, 70.0, 56.0, 31.0, 42.0, 100.0, 50.0, 70.0, 136.0, 95.0, 150.0, 50.0, 80.0, 90.0, 70.0, 60.0, 100.0, 110.0, 90.0, 37.0, 90.0, 10.0, 110.0, 40.0, 9.0, 45.0, 55.0, 100.0, 30.0, 78.0, 110.0, 120.0, 30.0, 90.0, 27.0, 35.0, 90.0, 100.0, 100.0, 40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5249393141404683, "mean_inference_ms": 1.5273414795195952, "mean_action_processing_ms": 0.4847626221180183, "mean_env_wait_ms": 1.3351740128157592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011735200881958008, "StateBufferConnector_ms": 0.009023427963256836, "ViewRequirementAgentConnector_ms": 0.3556632995605469}, "num_episodes": 18, "episode_return_max": 1100.0, "episode_return_min": 296.0, "episode_return_mean": 674.42}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.590789174172535, "num_env_steps_trained_throughput_per_sec": 21.590789174172535, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 185018.419, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185018.371, "sample_time_ms": 2412.786, "learn_time_ms": 182585.622, "learn_throughput": 21.908, "synch_weights_time_ms": 11.598}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "a22d3_00000", "date": "2024-08-06_05-47-22", "timestamp": 1722937642, "time_this_iter_s": 185.27415084838867, "time_total_s": 25432.874585151672, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a1785e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25432.874585151672, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 17.50229007633588, "ram_util_percent": 79.07137404580153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.182572286933883, "cur_kl_coeff": 0.4561394691467286, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.01197961525400432, "vf_loss": 7.517238869580725, "vf_explained_var": -0.010264877262460791, "kl": Infinity, "entropy": 0.48378346891194995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 1100.0, "episode_reward_min": 309.0, "episode_reward_mean": 688.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -70.0}, "policy_reward_max": {"policy_0": 230.0}, "policy_reward_mean": {"policy_0": 68.874}, "custom_metrics": {}, "hist_stats": {"episode_reward": [599.0, 898.0, 560.0, 823.0, 593.0, 891.0, 371.0, 580.0, 709.0, 565.0, 729.0, 720.0, 621.0, 410.0, 935.0, 585.0, 692.0, 593.0, 752.0, 620.0, 476.0, 951.0, 659.0, 600.0, 749.0, 1100.0, 670.0, 504.0, 838.0, 862.0, 570.0, 555.0, 633.0, 967.0, 752.0, 519.0, 579.0, 720.0, 309.0, 650.0, 704.0, 840.0, 730.0, 452.0, 654.0, 346.0, 832.0, 900.0, 990.0, 450.0, 761.0, 620.0, 889.0, 723.0, 650.0, 627.0, 657.0, 509.0, 584.0, 937.0, 656.0, 669.0, 592.0, 523.0, 317.0, 926.0, 556.0, 680.0, 767.0, 905.0, 585.0, 527.0, 695.0, 895.0, 526.0, 780.0, 849.0, 595.0, 478.0, 668.0, 958.0, 810.0, 800.0, 725.0, 404.0, 482.0, 910.0, 831.0, 898.0, 1080.0, 844.0, 470.0, 760.0, 685.0, 767.0, 789.0, 888.0, 382.0, 799.0, 639.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 100.0, 70.0, 49.0, 20.0, 30.0, 130.0, 20.0, 30.0, 100.0, 69.0, 90.0, 160.0, 80.0, 69.0, 160.0, 70.0, 80.0, 50.0, 70.0, 30.0, 50.0, 60.0, 50.0, 60.0, 70.0, 50.0, 30.0, 110.0, 50.0, 50.0, 70.0, 100.0, 144.0, 60.0, 110.0, 80.0, 90.0, 70.0, 49.0, 80.0, 60.0, 100.0, 90.0, 120.0, 16.0, 20.0, 67.0, 10.0, 30.0, 36.0, 60.0, 100.0, 62.0, 60.0, 180.0, 76.0, 120.0, 58.0, 139.0, 19.0, 90.0, 50.0, 60.0, 13.0, 10.0, -4.0, 70.0, 28.0, 35.0, 40.0, 40.0, 40.0, 30.0, 70.0, 120.0, 70.0, 50.0, 40.0, 80.0, 40.0, 130.0, 59.0, 30.0, 60.0, 80.0, 80.0, 80.0, 50.0, 100.0, 30.0, 83.0, 50.0, 30.0, 82.0, 60.0, 60.0, 70.0, 40.0, 60.0, 20.0, 70.0, 100.0, 120.0, 50.0, 90.0, 90.0, 70.0, 19.0, 100.0, 80.0, 30.0, 110.0, 80.0, 90.0, 120.0, 30.0, 70.0, 80.0, 30.0, 60.0, 28.0, 40.0, 100.0, 66.0, 74.0, 40.0, 110.0, 73.0, 30.0, 50.0, 40.0, 35.0, 7.0, 50.0, -12.0, 40.0, 50.0, 50.0, 100.0, 120.0, 60.0, 90.0, 52.0, 130.0, 160.0, 90.0, 93.0, 80.0, 60.0, 100.0, 30.0, 130.0, 10.0, 70.0, 0.0, 60.0, 110.0, 70.0, 5.0, 170.0, 50.0, 110.0, 60.0, 80.0, 30.0, 70.0, 20.0, 52.0, 50.0, 14.0, 60.0, 29.0, 50.0, 60.0, 70.0, 100.0, 110.0, 50.0, 50.0, 60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0, 30.0, 60.0, 80.0, 31.0, 49.0, 40.0, 90.0, 20.0, 110.0, 110.0, 5.0, 40.0, 40.0, 105.0, 20.0, 60.0, 98.0, 38.0, 40.0, 30.0, 100.0, 70.0, 140.0, 130.0, 98.0, 95.0, 88.0, 10.0, 110.0, 110.0, 110.0, 80.0, 20.0, 80.0, 60.0, 50.0, 130.0, 100.0, 10.0, 19.0, 50.0, 60.0, 90.0, 40.0, 70.0, 20.0, 130.0, 90.0, 30.0, 20.0, 100.0, 40.0, 50.0, 130.0, 39.0, 100.0, 110.0, 40.0, 30.0, 110.0, 90.0, 110.0, 100.0, 100.0, 120.0, 100.0, 140.0, 80.0, 140.0, 120.0, 80.0, 20.0, 70.0, 30.0, 130.0, 80.0, 20.0, 80.0, 120.0, 40.0, 54.0, 120.0, 86.0, 30.0, 24.0, 50.0, 10.0, 15.0, 85.0, 30.0, 100.0, 70.0, -16.0, 140.0, 120.0, 80.0, 90.0, 180.0, 14.0, 60.0, 88.0, 100.0, 90.0, 80.0, 80.0, 50.0, 120.0, 110.0, 75.0, 69.0, 40.0, 70.0, 50.0, 60.0, 30.0, 100.0, 30.0, 60.0, 30.0, 100.0, 30.0, 0.0, 20.0, 40.0, 85.0, 50.0, 80.0, 70.0, 60.0, 120.0, 110.0, 40.0, 110.0, 85.0, 40.0, 40.0, 110.0, 38.0, 0.0, 60.0, 60.0, 130.0, 160.0, 70.0, 100.0, 87.0, 70.0, 80.0, 120.0, 90.0, 60.0, 120.0, 100.0, 40.0, 90.0, 50.0, 33.0, 80.0, 80.0, 99.0, 120.0, 60.0, 120.0, 20.0, 2.0, 8.0, 100.0, 30.0, 50.0, 9.0, 20.0, 80.0, 40.0, -1.0, 50.0, 90.0, 90.0, 90.0, 100.0, 20.0, 80.0, 70.0, 90.0, 100.0, 100.0, 50.0, 30.0, 50.0, 90.0, 60.0, 5.0, 80.0, -11.0, 10.0, 8.0, 50.0, 7.0, 70.0, 80.0, 10.0, 130.0, 30.0, 125.0, 130.0, -5.0, 70.0, 40.0, 40.0, 10.0, 80.0, -1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0, 60.0, 50.0, 60.0, 150.0, 90.0, 135.0, 70.0, 100.0, 110.0, 15.0, 10.0, 120.0, 60.0, 170.0, 0.0, 60.0, 80.0, 100.0, 70.0, 60.0, 100.0, 110.0, 100.0, -31.0, 40.0, 22.0, 70.0, -39.0, 50.0, 30.0, 37.0, 120.0, 40.0, 30.0, 70.0, 70.0, 60.0, 107.0, 110.0, 10.0, 40.0, -39.0, 20.0, 50.0, 2.0, 60.0, 29.0, 60.0, 40.0, 84.0, 59.0, 38.0, 80.0, 40.0, 120.0, 120.0, 70.0, 100.0, 125.0, 80.0, 57.0, 90.0, 90.0, 90.0, 80.0, 130.0, 110.0, 13.0, 150.0, 90.0, 120.0, 40.0, 120.0, 140.0, 60.0, 80.0, 90.0, 100.0, 90.0, 150.0, 40.0, 30.0, 30.0, 30.0, 20.0, 120.0, 10.0, 70.0, 70.0, 30.0, 60.0, 110.0, 70.0, 70.0, 130.0, 80.0, 130.0, 6.0, 45.0, 60.0, 50.0, 50.0, 98.0, 15.0, 90.0, 30.0, 38.0, 39.0, 80.0, 130.0, 80.0, 120.0, 160.0, 109.0, 130.0, 70.0, 50.0, 40.0, 50.0, 80.0, 60.0, 70.0, 30.0, 130.0, 122.0, 20.0, 160.0, 30.0, 80.0, 21.0, 120.0, 60.0, 130.0, 60.0, 80.0, 30.0, 70.0, 30.0, 20.0, 50.0, 39.0, 140.0, 26.0, 50.0, 70.0, 100.0, 50.0, 51.0, 49.0, 52.0, 87.0, 40.0, 70.0, 0.0, 120.0, 47.0, 120.0, 79.0, 60.0, 34.0, 100.0, 10.0, 50.0, 120.0, -6.0, 30.0, 55.0, 60.0, 60.0, 30.0, 110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0, 100.0, 100.0, 20.0, 140.0, 90.0, 140.0, 168.0, 30.0, 109.0, 40.0, 130.0, 37.0, 21.0, 50.0, 40.0, 60.0, 90.0, 40.0, 170.0, 18.0, -14.0, 34.0, 80.0, 62.0, 71.0, 63.0, 160.0, 33.0, 80.0, 100.0, 140.0, 23.0, 29.0, 80.0, 90.0, 80.0, 51.0, 30.0, 29.0, 40.0, 20.0, 50.0, 60.0, 40.0, 50.0, 110.0, 50.0, 40.0, 47.0, 56.0, 100.0, 100.0, 38.0, 17.0, 10.0, -14.0, 6.0, 50.0, -20.0, 30.0, 90.0, 100.0, 100.0, 49.0, 150.0, 40.0, 100.0, 170.0, 90.0, 37.0, 70.0, 0.0, 100.0, 4.0, 70.0, 130.0, 25.0, 27.0, 110.0, 20.0, 100.0, 10.0, 90.0, 100.0, 90.0, 30.0, 60.0, 80.0, 30.0, 90.0, 90.0, 80.0, 50.0, 70.0, 90.0, 87.0, 80.0, 60.0, 50.0, 110.0, 90.0, 35.0, 50.0, 110.0, 50.0, 170.0, 130.0, 50.0, 100.0, 120.0, 30.0, 88.0, 70.0, 50.0, 52.0, 80.0, 15.0, 50.0, 80.0, 70.0, 27.0, 10.0, 40.0, 180.0, 60.0, 40.0, 50.0, 30.0, 50.0, 40.0, 40.0, 100.0, 70.0, 56.0, 31.0, 42.0, 100.0, 50.0, 70.0, 136.0, 95.0, 150.0, 50.0, 80.0, 90.0, 70.0, 60.0, 100.0, 110.0, 90.0, 37.0, 90.0, 10.0, 110.0, 40.0, 9.0, 45.0, 55.0, 100.0, 30.0, 78.0, 110.0, 120.0, 30.0, 90.0, 27.0, 35.0, 90.0, 100.0, 100.0, 40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0, 90.0, 27.0, 30.0, 26.0, 67.0, 90.0, 60.0, 110.0, 55.0, 40.0, 40.0, 65.0, 25.0, 40.0, 18.0, 60.0, 50.0, 70.0, 30.0, 80.0, 10.0, 70.0, 40.0, 40.0, 50.0, 89.0, 90.0, 140.0, 100.0, 39.0, 30.0, 160.0, 140.0, 140.0, 88.0, 100.0, 60.0, 90.0, 90.0, 60.0, 10.0, 110.0, 110.0, 130.0, 30.0, 100.0, 30.0, 120.0, 110.0, 60.0, 30.0, 40.0, 60.0, 100.0, 60.0, 110.0, 50.0, 160.0, 110.0, 80.0, 70.0, 90.0, 80.0, 30.0, 110.0, 55.0, 110.0, 50.0, 80.0, 50.0, -1.0, 60.0, 20.0, 70.0, 20.0, 70.0, -5.0, 70.0, 50.0, 50.0, 43.0, 40.0, -23.0, 0.0, 90.0, 26.0, 60.0, 106.0, 50.0, 90.0, 110.0, 170.0, 109.0, 30.0, 90.0, 18.0, 120.0, 60.0, 132.0, 71.0, 230.0, 36.0, 60.0, 60.0, 50.0, 100.0, 60.0, 65.0, 90.0, 80.0, 130.0, 120.0, 110.0, 140.0, 100.0, 40.0, 60.0, 100.0, 30.0, 68.0, 100.0, 100.0, 70.0, 100.0, 190.0, 140.0, 110.0, 90.0, 110.0, 70.0, 120.0, 90.0, 70.0, 59.0, 40.0, 110.0, 80.0, 140.0, 90.0, 45.0, 40.0, 60.0, 30.0, 20.0, 100.0, 70.0, 50.0, 0.0, 60.0, 40.0, 70.0, 30.0, 50.0, 70.0, 80.0, 35.0, 155.0, 90.0, 90.0, 90.0, 100.0, 40.0, 100.0, 120.0, 30.0, 60.0, 110.0, -15.0, 60.0, 80.0, 40.0, 54.0, 89.0, 70.0, 100.0, 99.0, 100.0, 110.0, 85.0, 20.0, 80.0, 90.0, 85.0, 30.0, -70.0, 160.0, 64.0, 80.0, 110.0, 160.0, 160.0, 44.0, 90.0, 140.0, 110.0, 80.0, 55.0, 120.0, 70.0, 19.0, 36.0, 17.0, 0.0, 50.0, 80.0, 90.0, 1.0, 20.0, 90.0, -2.0, 100.0, 90.0, 76.0, 110.0, 90.0, 45.0, 18.0, 80.0, 80.0, 110.0, 90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5215349015155686, "mean_inference_ms": 1.5231354458251163, "mean_action_processing_ms": 0.48413843666127027, "mean_env_wait_ms": 1.3341563264970366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011993169784545898, "StateBufferConnector_ms": 0.009157419204711914, "ViewRequirementAgentConnector_ms": 0.3714027404785156}, "num_episodes": 23, "episode_return_max": 1100.0, "episode_return_min": 309.0, "episode_return_mean": 688.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.678634821642365, "num_env_steps_trained_throughput_per_sec": 21.678634821642365, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 185054.089, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185054.041, "sample_time_ms": 2438.421, "learn_time_ms": 182595.672, "learn_throughput": 21.906, "synch_weights_time_ms": 11.717}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "a22d3_00000", "date": "2024-08-06_05-50-27", "timestamp": 1722937827, "time_this_iter_s": 184.52615094184875, "time_total_s": 25617.40073609352, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17e0820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25617.40073609352, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.27777777777778, "ram_util_percent": 78.07624521072798}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1923819102862647, "cur_kl_coeff": 0.6842092037200926, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010703053589884482, "vf_loss": 7.203643469967908, "vf_explained_var": 0.0017891916540611031, "kl": Infinity, "entropy": 0.5126597834915653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 1100.0, "episode_reward_min": 253.0, "episode_reward_mean": 685.74, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 230.0}, "policy_reward_mean": {"policy_0": 68.574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [752.0, 620.0, 476.0, 951.0, 659.0, 600.0, 749.0, 1100.0, 670.0, 504.0, 838.0, 862.0, 570.0, 555.0, 633.0, 967.0, 752.0, 519.0, 579.0, 720.0, 309.0, 650.0, 704.0, 840.0, 730.0, 452.0, 654.0, 346.0, 832.0, 900.0, 990.0, 450.0, 761.0, 620.0, 889.0, 723.0, 650.0, 627.0, 657.0, 509.0, 584.0, 937.0, 656.0, 669.0, 592.0, 523.0, 317.0, 926.0, 556.0, 680.0, 767.0, 905.0, 585.0, 527.0, 695.0, 895.0, 526.0, 780.0, 849.0, 595.0, 478.0, 668.0, 958.0, 810.0, 800.0, 725.0, 404.0, 482.0, 910.0, 831.0, 898.0, 1080.0, 844.0, 470.0, 760.0, 685.0, 767.0, 789.0, 888.0, 382.0, 799.0, 639.0, 570.0, 832.0, 253.0, 540.0, 670.0, 703.0, 848.0, 685.0, 730.0, 680.0, 745.0, 912.0, 440.0, 511.0, 477.0, 714.0, 541.0, 723.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 14.0, 68.0, 130.0, 100.0, 30.0, 60.0, 60.0, 120.0, 110.0, 30.0, 60.0, 80.0, 31.0, 49.0, 40.0, 90.0, 20.0, 110.0, 110.0, 5.0, 40.0, 40.0, 105.0, 20.0, 60.0, 98.0, 38.0, 40.0, 30.0, 100.0, 70.0, 140.0, 130.0, 98.0, 95.0, 88.0, 10.0, 110.0, 110.0, 110.0, 80.0, 20.0, 80.0, 60.0, 50.0, 130.0, 100.0, 10.0, 19.0, 50.0, 60.0, 90.0, 40.0, 70.0, 20.0, 130.0, 90.0, 30.0, 20.0, 100.0, 40.0, 50.0, 130.0, 39.0, 100.0, 110.0, 40.0, 30.0, 110.0, 90.0, 110.0, 100.0, 100.0, 120.0, 100.0, 140.0, 80.0, 140.0, 120.0, 80.0, 20.0, 70.0, 30.0, 130.0, 80.0, 20.0, 80.0, 120.0, 40.0, 54.0, 120.0, 86.0, 30.0, 24.0, 50.0, 10.0, 15.0, 85.0, 30.0, 100.0, 70.0, -16.0, 140.0, 120.0, 80.0, 90.0, 180.0, 14.0, 60.0, 88.0, 100.0, 90.0, 80.0, 80.0, 50.0, 120.0, 110.0, 75.0, 69.0, 40.0, 70.0, 50.0, 60.0, 30.0, 100.0, 30.0, 60.0, 30.0, 100.0, 30.0, 0.0, 20.0, 40.0, 85.0, 50.0, 80.0, 70.0, 60.0, 120.0, 110.0, 40.0, 110.0, 85.0, 40.0, 40.0, 110.0, 38.0, 0.0, 60.0, 60.0, 130.0, 160.0, 70.0, 100.0, 87.0, 70.0, 80.0, 120.0, 90.0, 60.0, 120.0, 100.0, 40.0, 90.0, 50.0, 33.0, 80.0, 80.0, 99.0, 120.0, 60.0, 120.0, 20.0, 2.0, 8.0, 100.0, 30.0, 50.0, 9.0, 20.0, 80.0, 40.0, -1.0, 50.0, 90.0, 90.0, 90.0, 100.0, 20.0, 80.0, 70.0, 90.0, 100.0, 100.0, 50.0, 30.0, 50.0, 90.0, 60.0, 5.0, 80.0, -11.0, 10.0, 8.0, 50.0, 7.0, 70.0, 80.0, 10.0, 130.0, 30.0, 125.0, 130.0, -5.0, 70.0, 40.0, 40.0, 10.0, 80.0, -1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0, 60.0, 50.0, 60.0, 150.0, 90.0, 135.0, 70.0, 100.0, 110.0, 15.0, 10.0, 120.0, 60.0, 170.0, 0.0, 60.0, 80.0, 100.0, 70.0, 60.0, 100.0, 110.0, 100.0, -31.0, 40.0, 22.0, 70.0, -39.0, 50.0, 30.0, 37.0, 120.0, 40.0, 30.0, 70.0, 70.0, 60.0, 107.0, 110.0, 10.0, 40.0, -39.0, 20.0, 50.0, 2.0, 60.0, 29.0, 60.0, 40.0, 84.0, 59.0, 38.0, 80.0, 40.0, 120.0, 120.0, 70.0, 100.0, 125.0, 80.0, 57.0, 90.0, 90.0, 90.0, 80.0, 130.0, 110.0, 13.0, 150.0, 90.0, 120.0, 40.0, 120.0, 140.0, 60.0, 80.0, 90.0, 100.0, 90.0, 150.0, 40.0, 30.0, 30.0, 30.0, 20.0, 120.0, 10.0, 70.0, 70.0, 30.0, 60.0, 110.0, 70.0, 70.0, 130.0, 80.0, 130.0, 6.0, 45.0, 60.0, 50.0, 50.0, 98.0, 15.0, 90.0, 30.0, 38.0, 39.0, 80.0, 130.0, 80.0, 120.0, 160.0, 109.0, 130.0, 70.0, 50.0, 40.0, 50.0, 80.0, 60.0, 70.0, 30.0, 130.0, 122.0, 20.0, 160.0, 30.0, 80.0, 21.0, 120.0, 60.0, 130.0, 60.0, 80.0, 30.0, 70.0, 30.0, 20.0, 50.0, 39.0, 140.0, 26.0, 50.0, 70.0, 100.0, 50.0, 51.0, 49.0, 52.0, 87.0, 40.0, 70.0, 0.0, 120.0, 47.0, 120.0, 79.0, 60.0, 34.0, 100.0, 10.0, 50.0, 120.0, -6.0, 30.0, 55.0, 60.0, 60.0, 30.0, 110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0, 100.0, 100.0, 20.0, 140.0, 90.0, 140.0, 168.0, 30.0, 109.0, 40.0, 130.0, 37.0, 21.0, 50.0, 40.0, 60.0, 90.0, 40.0, 170.0, 18.0, -14.0, 34.0, 80.0, 62.0, 71.0, 63.0, 160.0, 33.0, 80.0, 100.0, 140.0, 23.0, 29.0, 80.0, 90.0, 80.0, 51.0, 30.0, 29.0, 40.0, 20.0, 50.0, 60.0, 40.0, 50.0, 110.0, 50.0, 40.0, 47.0, 56.0, 100.0, 100.0, 38.0, 17.0, 10.0, -14.0, 6.0, 50.0, -20.0, 30.0, 90.0, 100.0, 100.0, 49.0, 150.0, 40.0, 100.0, 170.0, 90.0, 37.0, 70.0, 0.0, 100.0, 4.0, 70.0, 130.0, 25.0, 27.0, 110.0, 20.0, 100.0, 10.0, 90.0, 100.0, 90.0, 30.0, 60.0, 80.0, 30.0, 90.0, 90.0, 80.0, 50.0, 70.0, 90.0, 87.0, 80.0, 60.0, 50.0, 110.0, 90.0, 35.0, 50.0, 110.0, 50.0, 170.0, 130.0, 50.0, 100.0, 120.0, 30.0, 88.0, 70.0, 50.0, 52.0, 80.0, 15.0, 50.0, 80.0, 70.0, 27.0, 10.0, 40.0, 180.0, 60.0, 40.0, 50.0, 30.0, 50.0, 40.0, 40.0, 100.0, 70.0, 56.0, 31.0, 42.0, 100.0, 50.0, 70.0, 136.0, 95.0, 150.0, 50.0, 80.0, 90.0, 70.0, 60.0, 100.0, 110.0, 90.0, 37.0, 90.0, 10.0, 110.0, 40.0, 9.0, 45.0, 55.0, 100.0, 30.0, 78.0, 110.0, 120.0, 30.0, 90.0, 27.0, 35.0, 90.0, 100.0, 100.0, 40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0, 90.0, 27.0, 30.0, 26.0, 67.0, 90.0, 60.0, 110.0, 55.0, 40.0, 40.0, 65.0, 25.0, 40.0, 18.0, 60.0, 50.0, 70.0, 30.0, 80.0, 10.0, 70.0, 40.0, 40.0, 50.0, 89.0, 90.0, 140.0, 100.0, 39.0, 30.0, 160.0, 140.0, 140.0, 88.0, 100.0, 60.0, 90.0, 90.0, 60.0, 10.0, 110.0, 110.0, 130.0, 30.0, 100.0, 30.0, 120.0, 110.0, 60.0, 30.0, 40.0, 60.0, 100.0, 60.0, 110.0, 50.0, 160.0, 110.0, 80.0, 70.0, 90.0, 80.0, 30.0, 110.0, 55.0, 110.0, 50.0, 80.0, 50.0, -1.0, 60.0, 20.0, 70.0, 20.0, 70.0, -5.0, 70.0, 50.0, 50.0, 43.0, 40.0, -23.0, 0.0, 90.0, 26.0, 60.0, 106.0, 50.0, 90.0, 110.0, 170.0, 109.0, 30.0, 90.0, 18.0, 120.0, 60.0, 132.0, 71.0, 230.0, 36.0, 60.0, 60.0, 50.0, 100.0, 60.0, 65.0, 90.0, 80.0, 130.0, 120.0, 110.0, 140.0, 100.0, 40.0, 60.0, 100.0, 30.0, 68.0, 100.0, 100.0, 70.0, 100.0, 190.0, 140.0, 110.0, 90.0, 110.0, 70.0, 120.0, 90.0, 70.0, 59.0, 40.0, 110.0, 80.0, 140.0, 90.0, 45.0, 40.0, 60.0, 30.0, 20.0, 100.0, 70.0, 50.0, 0.0, 60.0, 40.0, 70.0, 30.0, 50.0, 70.0, 80.0, 35.0, 155.0, 90.0, 90.0, 90.0, 100.0, 40.0, 100.0, 120.0, 30.0, 60.0, 110.0, -15.0, 60.0, 80.0, 40.0, 54.0, 89.0, 70.0, 100.0, 99.0, 100.0, 110.0, 85.0, 20.0, 80.0, 90.0, 85.0, 30.0, -70.0, 160.0, 64.0, 80.0, 110.0, 160.0, 160.0, 44.0, 90.0, 140.0, 110.0, 80.0, 55.0, 120.0, 70.0, 19.0, 36.0, 17.0, 0.0, 50.0, 80.0, 90.0, 1.0, 20.0, 90.0, -2.0, 100.0, 90.0, 76.0, 110.0, 90.0, 45.0, 18.0, 80.0, 80.0, 110.0, 90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0, 50.0, 190.0, 40.0, 40.0, 40.0, 40.0, 0.0, 40.0, 100.0, 30.0, 150.0, 2.0, 60.0, 50.0, 130.0, 0.0, 150.0, 50.0, 120.0, 120.0, 40.0, -3.0, 20.0, 20.0, 80.0, 0.0, 30.0, 7.0, 40.0, 19.0, 100.0, 120.0, -80.0, 60.0, 60.0, 60.0, 50.0, 80.0, 50.0, 40.0, 70.0, 80.0, 30.0, 130.0, 30.0, 120.0, 60.0, 10.0, 70.0, 70.0, 89.0, 35.0, 20.0, 50.0, 120.0, 70.0, 80.0, 70.0, 120.0, 49.0, 91.0, 131.0, 70.0, 100.0, 110.0, 130.0, 78.0, 50.0, 80.0, 8.0, 80.0, 90.0, 60.0, 160.0, 40.0, 60.0, -8.0, 40.0, 80.0, 83.0, 70.0, 120.0, 30.0, 100.0, 80.0, 70.0, 80.0, 90.0, 30.0, 60.0, 40.0, 90.0, 70.0, 60.0, 80.0, 70.0, 130.0, 60.0, 20.0, 60.0, 80.0, 7.0, 30.0, 99.0, 88.0, 110.0, 58.0, 63.0, 50.0, 160.0, 120.0, 60.0, 80.0, 120.0, 40.0, 35.0, 110.0, 107.0, 70.0, 170.0, 10.0, -19.0, 30.0, 85.0, 80.0, 0.0, 100.0, 50.0, 44.0, 60.0, 39.0, 80.0, 57.0, 40.0, 46.0, 30.0, 50.0, 99.0, 20.0, 50.0, 60.0, 40.0, 100.0, 60.0, 40.0, 100.0, -6.0, 50.0, 10.0, 23.0, 90.0, 12.0, 50.0, 110.0, 60.0, 70.0, 22.0, 140.0, 80.0, 80.0, 70.0, 21.0, 60.0, 40.0, 20.0, 80.0, 30.0, 60.0, 100.0, 60.0, 90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.523826336559243, "mean_inference_ms": 1.5250492430245663, "mean_action_processing_ms": 0.483894628133288, "mean_env_wait_ms": 1.3334657731340875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011518001556396484, "StateBufferConnector_ms": 0.008788824081420898, "ViewRequirementAgentConnector_ms": 0.36598944664001465}, "num_episodes": 18, "episode_return_max": 1100.0, "episode_return_min": 253.0, "episode_return_mean": 685.74}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.602801966704998, "num_env_steps_trained_throughput_per_sec": 21.602801966704998, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 185191.731, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185191.683, "sample_time_ms": 2420.689, "learn_time_ms": 182751.52, "learn_throughput": 21.888, "synch_weights_time_ms": 11.197}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "a22d3_00000", "date": "2024-08-06_05-53-32", "timestamp": 1722938012, "time_this_iter_s": 185.17115211486816, "time_total_s": 25802.57188820839, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a179cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25802.57188820839, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.438931297709924, "ram_util_percent": 77.15610687022901}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.961833814411752, "cur_kl_coeff": 1.0263138055801393, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.334394247006304, "policy_loss": -0.0103992380368195, "vf_loss": 7.3413983082492, "vf_explained_var": 0.01176480616624363, "kl": 0.0033081329638097656, "entropy": 0.49764186890361406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 1097.0, "episode_reward_min": 253.0, "episode_reward_mean": 687.87, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 234.0}, "policy_reward_mean": {"policy_0": 68.787}, "custom_metrics": {}, "hist_stats": {"episode_reward": [704.0, 840.0, 730.0, 452.0, 654.0, 346.0, 832.0, 900.0, 990.0, 450.0, 761.0, 620.0, 889.0, 723.0, 650.0, 627.0, 657.0, 509.0, 584.0, 937.0, 656.0, 669.0, 592.0, 523.0, 317.0, 926.0, 556.0, 680.0, 767.0, 905.0, 585.0, 527.0, 695.0, 895.0, 526.0, 780.0, 849.0, 595.0, 478.0, 668.0, 958.0, 810.0, 800.0, 725.0, 404.0, 482.0, 910.0, 831.0, 898.0, 1080.0, 844.0, 470.0, 760.0, 685.0, 767.0, 789.0, 888.0, 382.0, 799.0, 639.0, 570.0, 832.0, 253.0, 540.0, 670.0, 703.0, 848.0, 685.0, 730.0, 680.0, 745.0, 912.0, 440.0, 511.0, 477.0, 714.0, 541.0, 723.0, 600.0, 639.0, 649.0, 730.0, 760.0, 940.0, 894.0, 685.0, 759.0, 530.0, 448.0, 569.0, 675.0, 1097.0, 770.0, 640.0, 590.0, 945.0, 637.0, 595.0, 295.0, 801.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-1.0, 59.0, 90.0, 80.0, 50.0, 90.0, 120.0, 135.0, 19.0, 62.0, 60.0, 50.0, 60.0, 150.0, 90.0, 135.0, 70.0, 100.0, 110.0, 15.0, 10.0, 120.0, 60.0, 170.0, 0.0, 60.0, 80.0, 100.0, 70.0, 60.0, 100.0, 110.0, 100.0, -31.0, 40.0, 22.0, 70.0, -39.0, 50.0, 30.0, 37.0, 120.0, 40.0, 30.0, 70.0, 70.0, 60.0, 107.0, 110.0, 10.0, 40.0, -39.0, 20.0, 50.0, 2.0, 60.0, 29.0, 60.0, 40.0, 84.0, 59.0, 38.0, 80.0, 40.0, 120.0, 120.0, 70.0, 100.0, 125.0, 80.0, 57.0, 90.0, 90.0, 90.0, 80.0, 130.0, 110.0, 13.0, 150.0, 90.0, 120.0, 40.0, 120.0, 140.0, 60.0, 80.0, 90.0, 100.0, 90.0, 150.0, 40.0, 30.0, 30.0, 30.0, 20.0, 120.0, 10.0, 70.0, 70.0, 30.0, 60.0, 110.0, 70.0, 70.0, 130.0, 80.0, 130.0, 6.0, 45.0, 60.0, 50.0, 50.0, 98.0, 15.0, 90.0, 30.0, 38.0, 39.0, 80.0, 130.0, 80.0, 120.0, 160.0, 109.0, 130.0, 70.0, 50.0, 40.0, 50.0, 80.0, 60.0, 70.0, 30.0, 130.0, 122.0, 20.0, 160.0, 30.0, 80.0, 21.0, 120.0, 60.0, 130.0, 60.0, 80.0, 30.0, 70.0, 30.0, 20.0, 50.0, 39.0, 140.0, 26.0, 50.0, 70.0, 100.0, 50.0, 51.0, 49.0, 52.0, 87.0, 40.0, 70.0, 0.0, 120.0, 47.0, 120.0, 79.0, 60.0, 34.0, 100.0, 10.0, 50.0, 120.0, -6.0, 30.0, 55.0, 60.0, 60.0, 30.0, 110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0, 100.0, 100.0, 20.0, 140.0, 90.0, 140.0, 168.0, 30.0, 109.0, 40.0, 130.0, 37.0, 21.0, 50.0, 40.0, 60.0, 90.0, 40.0, 170.0, 18.0, -14.0, 34.0, 80.0, 62.0, 71.0, 63.0, 160.0, 33.0, 80.0, 100.0, 140.0, 23.0, 29.0, 80.0, 90.0, 80.0, 51.0, 30.0, 29.0, 40.0, 20.0, 50.0, 60.0, 40.0, 50.0, 110.0, 50.0, 40.0, 47.0, 56.0, 100.0, 100.0, 38.0, 17.0, 10.0, -14.0, 6.0, 50.0, -20.0, 30.0, 90.0, 100.0, 100.0, 49.0, 150.0, 40.0, 100.0, 170.0, 90.0, 37.0, 70.0, 0.0, 100.0, 4.0, 70.0, 130.0, 25.0, 27.0, 110.0, 20.0, 100.0, 10.0, 90.0, 100.0, 90.0, 30.0, 60.0, 80.0, 30.0, 90.0, 90.0, 80.0, 50.0, 70.0, 90.0, 87.0, 80.0, 60.0, 50.0, 110.0, 90.0, 35.0, 50.0, 110.0, 50.0, 170.0, 130.0, 50.0, 100.0, 120.0, 30.0, 88.0, 70.0, 50.0, 52.0, 80.0, 15.0, 50.0, 80.0, 70.0, 27.0, 10.0, 40.0, 180.0, 60.0, 40.0, 50.0, 30.0, 50.0, 40.0, 40.0, 100.0, 70.0, 56.0, 31.0, 42.0, 100.0, 50.0, 70.0, 136.0, 95.0, 150.0, 50.0, 80.0, 90.0, 70.0, 60.0, 100.0, 110.0, 90.0, 37.0, 90.0, 10.0, 110.0, 40.0, 9.0, 45.0, 55.0, 100.0, 30.0, 78.0, 110.0, 120.0, 30.0, 90.0, 27.0, 35.0, 90.0, 100.0, 100.0, 40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0, 90.0, 27.0, 30.0, 26.0, 67.0, 90.0, 60.0, 110.0, 55.0, 40.0, 40.0, 65.0, 25.0, 40.0, 18.0, 60.0, 50.0, 70.0, 30.0, 80.0, 10.0, 70.0, 40.0, 40.0, 50.0, 89.0, 90.0, 140.0, 100.0, 39.0, 30.0, 160.0, 140.0, 140.0, 88.0, 100.0, 60.0, 90.0, 90.0, 60.0, 10.0, 110.0, 110.0, 130.0, 30.0, 100.0, 30.0, 120.0, 110.0, 60.0, 30.0, 40.0, 60.0, 100.0, 60.0, 110.0, 50.0, 160.0, 110.0, 80.0, 70.0, 90.0, 80.0, 30.0, 110.0, 55.0, 110.0, 50.0, 80.0, 50.0, -1.0, 60.0, 20.0, 70.0, 20.0, 70.0, -5.0, 70.0, 50.0, 50.0, 43.0, 40.0, -23.0, 0.0, 90.0, 26.0, 60.0, 106.0, 50.0, 90.0, 110.0, 170.0, 109.0, 30.0, 90.0, 18.0, 120.0, 60.0, 132.0, 71.0, 230.0, 36.0, 60.0, 60.0, 50.0, 100.0, 60.0, 65.0, 90.0, 80.0, 130.0, 120.0, 110.0, 140.0, 100.0, 40.0, 60.0, 100.0, 30.0, 68.0, 100.0, 100.0, 70.0, 100.0, 190.0, 140.0, 110.0, 90.0, 110.0, 70.0, 120.0, 90.0, 70.0, 59.0, 40.0, 110.0, 80.0, 140.0, 90.0, 45.0, 40.0, 60.0, 30.0, 20.0, 100.0, 70.0, 50.0, 0.0, 60.0, 40.0, 70.0, 30.0, 50.0, 70.0, 80.0, 35.0, 155.0, 90.0, 90.0, 90.0, 100.0, 40.0, 100.0, 120.0, 30.0, 60.0, 110.0, -15.0, 60.0, 80.0, 40.0, 54.0, 89.0, 70.0, 100.0, 99.0, 100.0, 110.0, 85.0, 20.0, 80.0, 90.0, 85.0, 30.0, -70.0, 160.0, 64.0, 80.0, 110.0, 160.0, 160.0, 44.0, 90.0, 140.0, 110.0, 80.0, 55.0, 120.0, 70.0, 19.0, 36.0, 17.0, 0.0, 50.0, 80.0, 90.0, 1.0, 20.0, 90.0, -2.0, 100.0, 90.0, 76.0, 110.0, 90.0, 45.0, 18.0, 80.0, 80.0, 110.0, 90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0, 50.0, 190.0, 40.0, 40.0, 40.0, 40.0, 0.0, 40.0, 100.0, 30.0, 150.0, 2.0, 60.0, 50.0, 130.0, 0.0, 150.0, 50.0, 120.0, 120.0, 40.0, -3.0, 20.0, 20.0, 80.0, 0.0, 30.0, 7.0, 40.0, 19.0, 100.0, 120.0, -80.0, 60.0, 60.0, 60.0, 50.0, 80.0, 50.0, 40.0, 70.0, 80.0, 30.0, 130.0, 30.0, 120.0, 60.0, 10.0, 70.0, 70.0, 89.0, 35.0, 20.0, 50.0, 120.0, 70.0, 80.0, 70.0, 120.0, 49.0, 91.0, 131.0, 70.0, 100.0, 110.0, 130.0, 78.0, 50.0, 80.0, 8.0, 80.0, 90.0, 60.0, 160.0, 40.0, 60.0, -8.0, 40.0, 80.0, 83.0, 70.0, 120.0, 30.0, 100.0, 80.0, 70.0, 80.0, 90.0, 30.0, 60.0, 40.0, 90.0, 70.0, 60.0, 80.0, 70.0, 130.0, 60.0, 20.0, 60.0, 80.0, 7.0, 30.0, 99.0, 88.0, 110.0, 58.0, 63.0, 50.0, 160.0, 120.0, 60.0, 80.0, 120.0, 40.0, 35.0, 110.0, 107.0, 70.0, 170.0, 10.0, -19.0, 30.0, 85.0, 80.0, 0.0, 100.0, 50.0, 44.0, 60.0, 39.0, 80.0, 57.0, 40.0, 46.0, 30.0, 50.0, 99.0, 20.0, 50.0, 60.0, 40.0, 100.0, 60.0, 40.0, 100.0, -6.0, 50.0, 10.0, 23.0, 90.0, 12.0, 50.0, 110.0, 60.0, 70.0, 22.0, 140.0, 80.0, 80.0, 70.0, 21.0, 60.0, 40.0, 20.0, 80.0, 30.0, 60.0, 100.0, 60.0, 90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0, 55.0, 70.0, 20.0, 60.0, 20.0, 90.0, 30.0, 75.0, 50.0, 130.0, 40.0, 60.0, 49.0, 80.0, 30.0, 90.0, 210.0, 0.0, 30.0, 50.0, 40.0, 100.0, 60.0, 69.0, 88.0, 51.0, 50.0, 40.0, 130.0, 21.0, 100.0, 100.0, 40.0, 80.0, 40.0, 40.0, 80.0, 90.0, 90.0, 70.0, 130.0, 80.0, 100.0, 70.0, 50.0, 90.0, 40.0, -60.0, 100.0, 160.0, 130.0, 100.0, 100.0, 80.0, 130.0, 110.0, 80.0, 50.0, 80.0, 80.0, 30.0, 50.0, 110.0, 40.0, 234.0, 80.0, 80.0, 110.0, 80.0, 80.0, 70.0, 120.0, 20.0, 160.0, 30.0, 65.0, 100.0, 30.0, 40.0, 50.0, 70.0, 100.0, 70.0, 109.0, -60.0, 100.0, 40.0, 110.0, 90.0, 130.0, 60.0, 30.0, 20.0, 40.0, 20.0, 40.0, 110.0, 110.0, 50.0, 50.0, -27.0, -1.0, 90.0, 20.0, 68.0, 49.0, 80.0, 50.0, 59.0, 60.0, 0.0, 40.0, 45.0, 70.0, 25.0, 120.0, 50.0, 110.0, 19.0, 90.0, 70.0, 110.0, 170.0, 50.0, 86.0, 19.0, 80.0, 60.0, 0.0, 30.0, 80.0, 170.0, 89.0, 90.0, 90.0, 140.0, 210.0, 110.0, 30.0, 88.0, 70.0, 60.0, 110.0, 40.0, 30.0, 100.0, 100.0, 50.0, 110.0, 100.0, 50.0, 50.0, 110.0, 80.0, 28.0, 57.0, 70.0, 70.0, 55.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 40.0, 50.0, 80.0, 90.0, 160.0, 140.0, 100.0, 90.0, 100.0, 90.0, 130.0, 105.0, 60.0, 80.0, 50.0, 30.0, 80.0, 90.0, 94.0, -7.0, 50.0, 110.0, 10.0, 60.0, 120.0, 40.0, 20.0, 98.0, 50.0, 47.0, 40.0, 110.0, 70.0, 90.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 19.0, 60.0, 3.0, 13.0, 40.0, 190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.522973145172944, "mean_inference_ms": 1.5237113105750961, "mean_action_processing_ms": 0.4834411416872467, "mean_env_wait_ms": 1.3325323211680558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01175689697265625, "StateBufferConnector_ms": 0.008971214294433594, "ViewRequirementAgentConnector_ms": 0.37943077087402344}, "num_episodes": 22, "episode_return_max": 1097.0, "episode_return_min": 253.0, "episode_return_mean": 687.87}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.7207502933364, "num_env_steps_trained_throughput_per_sec": 21.7207502933364, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 185166.175, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185166.127, "sample_time_ms": 2418.072, "learn_time_ms": 182728.625, "learn_throughput": 21.89, "synch_weights_time_ms": 11.12}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "a22d3_00000", "date": "2024-08-06_05-56-36", "timestamp": 1722938196, "time_this_iter_s": 184.16428089141846, "time_total_s": 25986.736169099808, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25986.736169099808, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 16.945384615384615, "ram_util_percent": 77.84153846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.257328099088547, "cur_kl_coeff": 0.5131569027900696, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.012403834143110984, "vf_loss": 7.256955352149451, "vf_explained_var": 0.006458802941762093, "kl": Infinity, "entropy": 0.5203736555938142, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1097.0, "episode_reward_min": 253.0, "episode_reward_mean": 685.29, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 234.0}, "policy_reward_mean": {"policy_0": 68.529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [584.0, 937.0, 656.0, 669.0, 592.0, 523.0, 317.0, 926.0, 556.0, 680.0, 767.0, 905.0, 585.0, 527.0, 695.0, 895.0, 526.0, 780.0, 849.0, 595.0, 478.0, 668.0, 958.0, 810.0, 800.0, 725.0, 404.0, 482.0, 910.0, 831.0, 898.0, 1080.0, 844.0, 470.0, 760.0, 685.0, 767.0, 789.0, 888.0, 382.0, 799.0, 639.0, 570.0, 832.0, 253.0, 540.0, 670.0, 703.0, 848.0, 685.0, 730.0, 680.0, 745.0, 912.0, 440.0, 511.0, 477.0, 714.0, 541.0, 723.0, 600.0, 639.0, 649.0, 730.0, 760.0, 940.0, 894.0, 685.0, 759.0, 530.0, 448.0, 569.0, 675.0, 1097.0, 770.0, 640.0, 590.0, 945.0, 637.0, 595.0, 295.0, 801.0, 470.0, 910.0, 625.0, 689.0, 688.0, 711.0, 513.0, 486.0, 988.0, 681.0, 535.0, 770.0, 638.0, 655.0, 601.0, 650.0, 666.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 20.0, 40.0, 90.0, 70.0, 20.0, 79.0, 63.0, 40.0, 52.0, 100.0, 100.0, 20.0, 140.0, 90.0, 140.0, 168.0, 30.0, 109.0, 40.0, 130.0, 37.0, 21.0, 50.0, 40.0, 60.0, 90.0, 40.0, 170.0, 18.0, -14.0, 34.0, 80.0, 62.0, 71.0, 63.0, 160.0, 33.0, 80.0, 100.0, 140.0, 23.0, 29.0, 80.0, 90.0, 80.0, 51.0, 30.0, 29.0, 40.0, 20.0, 50.0, 60.0, 40.0, 50.0, 110.0, 50.0, 40.0, 47.0, 56.0, 100.0, 100.0, 38.0, 17.0, 10.0, -14.0, 6.0, 50.0, -20.0, 30.0, 90.0, 100.0, 100.0, 49.0, 150.0, 40.0, 100.0, 170.0, 90.0, 37.0, 70.0, 0.0, 100.0, 4.0, 70.0, 130.0, 25.0, 27.0, 110.0, 20.0, 100.0, 10.0, 90.0, 100.0, 90.0, 30.0, 60.0, 80.0, 30.0, 90.0, 90.0, 80.0, 50.0, 70.0, 90.0, 87.0, 80.0, 60.0, 50.0, 110.0, 90.0, 35.0, 50.0, 110.0, 50.0, 170.0, 130.0, 50.0, 100.0, 120.0, 30.0, 88.0, 70.0, 50.0, 52.0, 80.0, 15.0, 50.0, 80.0, 70.0, 27.0, 10.0, 40.0, 180.0, 60.0, 40.0, 50.0, 30.0, 50.0, 40.0, 40.0, 100.0, 70.0, 56.0, 31.0, 42.0, 100.0, 50.0, 70.0, 136.0, 95.0, 150.0, 50.0, 80.0, 90.0, 70.0, 60.0, 100.0, 110.0, 90.0, 37.0, 90.0, 10.0, 110.0, 40.0, 9.0, 45.0, 55.0, 100.0, 30.0, 78.0, 110.0, 120.0, 30.0, 90.0, 27.0, 35.0, 90.0, 100.0, 100.0, 40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0, 90.0, 27.0, 30.0, 26.0, 67.0, 90.0, 60.0, 110.0, 55.0, 40.0, 40.0, 65.0, 25.0, 40.0, 18.0, 60.0, 50.0, 70.0, 30.0, 80.0, 10.0, 70.0, 40.0, 40.0, 50.0, 89.0, 90.0, 140.0, 100.0, 39.0, 30.0, 160.0, 140.0, 140.0, 88.0, 100.0, 60.0, 90.0, 90.0, 60.0, 10.0, 110.0, 110.0, 130.0, 30.0, 100.0, 30.0, 120.0, 110.0, 60.0, 30.0, 40.0, 60.0, 100.0, 60.0, 110.0, 50.0, 160.0, 110.0, 80.0, 70.0, 90.0, 80.0, 30.0, 110.0, 55.0, 110.0, 50.0, 80.0, 50.0, -1.0, 60.0, 20.0, 70.0, 20.0, 70.0, -5.0, 70.0, 50.0, 50.0, 43.0, 40.0, -23.0, 0.0, 90.0, 26.0, 60.0, 106.0, 50.0, 90.0, 110.0, 170.0, 109.0, 30.0, 90.0, 18.0, 120.0, 60.0, 132.0, 71.0, 230.0, 36.0, 60.0, 60.0, 50.0, 100.0, 60.0, 65.0, 90.0, 80.0, 130.0, 120.0, 110.0, 140.0, 100.0, 40.0, 60.0, 100.0, 30.0, 68.0, 100.0, 100.0, 70.0, 100.0, 190.0, 140.0, 110.0, 90.0, 110.0, 70.0, 120.0, 90.0, 70.0, 59.0, 40.0, 110.0, 80.0, 140.0, 90.0, 45.0, 40.0, 60.0, 30.0, 20.0, 100.0, 70.0, 50.0, 0.0, 60.0, 40.0, 70.0, 30.0, 50.0, 70.0, 80.0, 35.0, 155.0, 90.0, 90.0, 90.0, 100.0, 40.0, 100.0, 120.0, 30.0, 60.0, 110.0, -15.0, 60.0, 80.0, 40.0, 54.0, 89.0, 70.0, 100.0, 99.0, 100.0, 110.0, 85.0, 20.0, 80.0, 90.0, 85.0, 30.0, -70.0, 160.0, 64.0, 80.0, 110.0, 160.0, 160.0, 44.0, 90.0, 140.0, 110.0, 80.0, 55.0, 120.0, 70.0, 19.0, 36.0, 17.0, 0.0, 50.0, 80.0, 90.0, 1.0, 20.0, 90.0, -2.0, 100.0, 90.0, 76.0, 110.0, 90.0, 45.0, 18.0, 80.0, 80.0, 110.0, 90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0, 50.0, 190.0, 40.0, 40.0, 40.0, 40.0, 0.0, 40.0, 100.0, 30.0, 150.0, 2.0, 60.0, 50.0, 130.0, 0.0, 150.0, 50.0, 120.0, 120.0, 40.0, -3.0, 20.0, 20.0, 80.0, 0.0, 30.0, 7.0, 40.0, 19.0, 100.0, 120.0, -80.0, 60.0, 60.0, 60.0, 50.0, 80.0, 50.0, 40.0, 70.0, 80.0, 30.0, 130.0, 30.0, 120.0, 60.0, 10.0, 70.0, 70.0, 89.0, 35.0, 20.0, 50.0, 120.0, 70.0, 80.0, 70.0, 120.0, 49.0, 91.0, 131.0, 70.0, 100.0, 110.0, 130.0, 78.0, 50.0, 80.0, 8.0, 80.0, 90.0, 60.0, 160.0, 40.0, 60.0, -8.0, 40.0, 80.0, 83.0, 70.0, 120.0, 30.0, 100.0, 80.0, 70.0, 80.0, 90.0, 30.0, 60.0, 40.0, 90.0, 70.0, 60.0, 80.0, 70.0, 130.0, 60.0, 20.0, 60.0, 80.0, 7.0, 30.0, 99.0, 88.0, 110.0, 58.0, 63.0, 50.0, 160.0, 120.0, 60.0, 80.0, 120.0, 40.0, 35.0, 110.0, 107.0, 70.0, 170.0, 10.0, -19.0, 30.0, 85.0, 80.0, 0.0, 100.0, 50.0, 44.0, 60.0, 39.0, 80.0, 57.0, 40.0, 46.0, 30.0, 50.0, 99.0, 20.0, 50.0, 60.0, 40.0, 100.0, 60.0, 40.0, 100.0, -6.0, 50.0, 10.0, 23.0, 90.0, 12.0, 50.0, 110.0, 60.0, 70.0, 22.0, 140.0, 80.0, 80.0, 70.0, 21.0, 60.0, 40.0, 20.0, 80.0, 30.0, 60.0, 100.0, 60.0, 90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0, 55.0, 70.0, 20.0, 60.0, 20.0, 90.0, 30.0, 75.0, 50.0, 130.0, 40.0, 60.0, 49.0, 80.0, 30.0, 90.0, 210.0, 0.0, 30.0, 50.0, 40.0, 100.0, 60.0, 69.0, 88.0, 51.0, 50.0, 40.0, 130.0, 21.0, 100.0, 100.0, 40.0, 80.0, 40.0, 40.0, 80.0, 90.0, 90.0, 70.0, 130.0, 80.0, 100.0, 70.0, 50.0, 90.0, 40.0, -60.0, 100.0, 160.0, 130.0, 100.0, 100.0, 80.0, 130.0, 110.0, 80.0, 50.0, 80.0, 80.0, 30.0, 50.0, 110.0, 40.0, 234.0, 80.0, 80.0, 110.0, 80.0, 80.0, 70.0, 120.0, 20.0, 160.0, 30.0, 65.0, 100.0, 30.0, 40.0, 50.0, 70.0, 100.0, 70.0, 109.0, -60.0, 100.0, 40.0, 110.0, 90.0, 130.0, 60.0, 30.0, 20.0, 40.0, 20.0, 40.0, 110.0, 110.0, 50.0, 50.0, -27.0, -1.0, 90.0, 20.0, 68.0, 49.0, 80.0, 50.0, 59.0, 60.0, 0.0, 40.0, 45.0, 70.0, 25.0, 120.0, 50.0, 110.0, 19.0, 90.0, 70.0, 110.0, 170.0, 50.0, 86.0, 19.0, 80.0, 60.0, 0.0, 30.0, 80.0, 170.0, 89.0, 90.0, 90.0, 140.0, 210.0, 110.0, 30.0, 88.0, 70.0, 60.0, 110.0, 40.0, 30.0, 100.0, 100.0, 50.0, 110.0, 100.0, 50.0, 50.0, 110.0, 80.0, 28.0, 57.0, 70.0, 70.0, 55.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 40.0, 50.0, 80.0, 90.0, 160.0, 140.0, 100.0, 90.0, 100.0, 90.0, 130.0, 105.0, 60.0, 80.0, 50.0, 30.0, 80.0, 90.0, 94.0, -7.0, 50.0, 110.0, 10.0, 60.0, 120.0, 40.0, 20.0, 98.0, 50.0, 47.0, 40.0, 110.0, 70.0, 90.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 19.0, 60.0, 3.0, 13.0, 40.0, 190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0, 150.0, 10.0, 40.0, 80.0, 60.0, 20.0, 20.0, 50.0, 40.0, 0.0, 130.0, 100.0, 58.0, 110.0, 80.0, 70.0, 70.0, 105.0, 57.0, 130.0, 90.0, 22.0, 50.0, 130.0, 80.0, 90.0, 23.0, 0.0, 40.0, 100.0, 20.0, 53.0, 40.0, 70.0, 60.0, 40.0, 126.0, 110.0, 110.0, 60.0, 60.0, 90.0, 110.0, 90.0, 90.0, 40.0, 50.0, 80.0, 40.0, 38.0, 15.0, 150.0, 40.0, 80.0, 35.0, 60.0, 70.0, 33.0, 68.0, 160.0, 70.0, 10.0, 27.0, 36.0, 80.0, 40.0, 70.0, 70.0, 80.0, 30.0, 90.0, -18.0, 40.0, 40.0, -64.0, 80.0, 38.0, 90.0, 130.0, 60.0, 120.0, 110.0, 70.0, 140.0, 50.0, 88.0, 80.0, 90.0, 150.0, 90.0, 50.0, 126.0, 60.0, 50.0, 80.0, 35.0, 90.0, 110.0, 50.0, 30.0, 40.0, 46.0, 116.0, 10.0, 36.0, 107.0, 10.0, 40.0, 80.0, 50.0, 50.0, 100.0, 70.0, 70.0, 50.0, 70.0, 80.0, 60.0, 100.0, 120.0, 150.0, 50.0, 70.0, 90.0, 110.0, 50.0, 98.0, 100.0, -180.0, 100.0, 120.0, 90.0, 80.0, 22.0, 70.0, 60.0, 60.0, 60.0, 70.0, 23.0, 40.0, 36.0, 10.0, 120.0, 60.0, 90.0, 110.0, 60.0, -5.0, 80.0, 70.0, 60.0, 30.0, 70.0, 70.0, 30.0, 50.0, 120.0, 100.0, 50.0, 80.0, 57.0, 78.0, 24.0, 100.0, 28.0, 39.0, 70.0, 80.0, 110.0, 100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5224467026811621, "mean_inference_ms": 1.5226860169064917, "mean_action_processing_ms": 0.48309975925591936, "mean_env_wait_ms": 1.331828494057105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011970758438110352, "StateBufferConnector_ms": 0.009107828140258789, "ViewRequirementAgentConnector_ms": 0.38495850563049316}, "num_episodes": 18, "episode_return_max": 1097.0, "episode_return_min": 253.0, "episode_return_mean": 685.29}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.237231049792577, "num_env_steps_trained_throughput_per_sec": 21.237231049792577, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 185432.221, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185432.174, "sample_time_ms": 2426.348, "learn_time_ms": 182986.873, "learn_throughput": 21.859, "synch_weights_time_ms": 10.871}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "a22d3_00000", "date": "2024-08-06_05-59-44", "timestamp": 1722938384, "time_this_iter_s": 188.35874581336975, "time_total_s": 26175.094914913177, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17a6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26175.094914913177, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 22.580524344569287, "ram_util_percent": 77.0756554307116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0442640749918133, "cur_kl_coeff": 0.7697353541851044, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011972668484776728, "vf_loss": 7.059700931350009, "vf_explained_var": 0.02083003129314183, "kl": Infinity, "entropy": 0.5333295812463354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 1097.0, "episode_reward_min": 55.0, "episode_reward_mean": 671.56, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 234.0}, "policy_reward_mean": {"policy_0": 67.156}, "custom_metrics": {}, "hist_stats": {"episode_reward": [849.0, 595.0, 478.0, 668.0, 958.0, 810.0, 800.0, 725.0, 404.0, 482.0, 910.0, 831.0, 898.0, 1080.0, 844.0, 470.0, 760.0, 685.0, 767.0, 789.0, 888.0, 382.0, 799.0, 639.0, 570.0, 832.0, 253.0, 540.0, 670.0, 703.0, 848.0, 685.0, 730.0, 680.0, 745.0, 912.0, 440.0, 511.0, 477.0, 714.0, 541.0, 723.0, 600.0, 639.0, 649.0, 730.0, 760.0, 940.0, 894.0, 685.0, 759.0, 530.0, 448.0, 569.0, 675.0, 1097.0, 770.0, 640.0, 590.0, 945.0, 637.0, 595.0, 295.0, 801.0, 470.0, 910.0, 625.0, 689.0, 688.0, 711.0, 513.0, 486.0, 988.0, 681.0, 535.0, 770.0, 638.0, 655.0, 601.0, 650.0, 666.0, 800.0, 657.0, 551.0, 585.0, 508.0, 727.0, 733.0, 722.0, 376.0, 718.0, 743.0, 584.0, 647.0, 55.0, 577.0, 929.0, 724.0, 260.0, 651.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 90.0, 110.0, 80.0, 90.0, 110.0, 80.0, 159.0, 70.0, 20.0, 90.0, 27.0, 30.0, 26.0, 67.0, 90.0, 60.0, 110.0, 55.0, 40.0, 40.0, 65.0, 25.0, 40.0, 18.0, 60.0, 50.0, 70.0, 30.0, 80.0, 10.0, 70.0, 40.0, 40.0, 50.0, 89.0, 90.0, 140.0, 100.0, 39.0, 30.0, 160.0, 140.0, 140.0, 88.0, 100.0, 60.0, 90.0, 90.0, 60.0, 10.0, 110.0, 110.0, 130.0, 30.0, 100.0, 30.0, 120.0, 110.0, 60.0, 30.0, 40.0, 60.0, 100.0, 60.0, 110.0, 50.0, 160.0, 110.0, 80.0, 70.0, 90.0, 80.0, 30.0, 110.0, 55.0, 110.0, 50.0, 80.0, 50.0, -1.0, 60.0, 20.0, 70.0, 20.0, 70.0, -5.0, 70.0, 50.0, 50.0, 43.0, 40.0, -23.0, 0.0, 90.0, 26.0, 60.0, 106.0, 50.0, 90.0, 110.0, 170.0, 109.0, 30.0, 90.0, 18.0, 120.0, 60.0, 132.0, 71.0, 230.0, 36.0, 60.0, 60.0, 50.0, 100.0, 60.0, 65.0, 90.0, 80.0, 130.0, 120.0, 110.0, 140.0, 100.0, 40.0, 60.0, 100.0, 30.0, 68.0, 100.0, 100.0, 70.0, 100.0, 190.0, 140.0, 110.0, 90.0, 110.0, 70.0, 120.0, 90.0, 70.0, 59.0, 40.0, 110.0, 80.0, 140.0, 90.0, 45.0, 40.0, 60.0, 30.0, 20.0, 100.0, 70.0, 50.0, 0.0, 60.0, 40.0, 70.0, 30.0, 50.0, 70.0, 80.0, 35.0, 155.0, 90.0, 90.0, 90.0, 100.0, 40.0, 100.0, 120.0, 30.0, 60.0, 110.0, -15.0, 60.0, 80.0, 40.0, 54.0, 89.0, 70.0, 100.0, 99.0, 100.0, 110.0, 85.0, 20.0, 80.0, 90.0, 85.0, 30.0, -70.0, 160.0, 64.0, 80.0, 110.0, 160.0, 160.0, 44.0, 90.0, 140.0, 110.0, 80.0, 55.0, 120.0, 70.0, 19.0, 36.0, 17.0, 0.0, 50.0, 80.0, 90.0, 1.0, 20.0, 90.0, -2.0, 100.0, 90.0, 76.0, 110.0, 90.0, 45.0, 18.0, 80.0, 80.0, 110.0, 90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0, 50.0, 190.0, 40.0, 40.0, 40.0, 40.0, 0.0, 40.0, 100.0, 30.0, 150.0, 2.0, 60.0, 50.0, 130.0, 0.0, 150.0, 50.0, 120.0, 120.0, 40.0, -3.0, 20.0, 20.0, 80.0, 0.0, 30.0, 7.0, 40.0, 19.0, 100.0, 120.0, -80.0, 60.0, 60.0, 60.0, 50.0, 80.0, 50.0, 40.0, 70.0, 80.0, 30.0, 130.0, 30.0, 120.0, 60.0, 10.0, 70.0, 70.0, 89.0, 35.0, 20.0, 50.0, 120.0, 70.0, 80.0, 70.0, 120.0, 49.0, 91.0, 131.0, 70.0, 100.0, 110.0, 130.0, 78.0, 50.0, 80.0, 8.0, 80.0, 90.0, 60.0, 160.0, 40.0, 60.0, -8.0, 40.0, 80.0, 83.0, 70.0, 120.0, 30.0, 100.0, 80.0, 70.0, 80.0, 90.0, 30.0, 60.0, 40.0, 90.0, 70.0, 60.0, 80.0, 70.0, 130.0, 60.0, 20.0, 60.0, 80.0, 7.0, 30.0, 99.0, 88.0, 110.0, 58.0, 63.0, 50.0, 160.0, 120.0, 60.0, 80.0, 120.0, 40.0, 35.0, 110.0, 107.0, 70.0, 170.0, 10.0, -19.0, 30.0, 85.0, 80.0, 0.0, 100.0, 50.0, 44.0, 60.0, 39.0, 80.0, 57.0, 40.0, 46.0, 30.0, 50.0, 99.0, 20.0, 50.0, 60.0, 40.0, 100.0, 60.0, 40.0, 100.0, -6.0, 50.0, 10.0, 23.0, 90.0, 12.0, 50.0, 110.0, 60.0, 70.0, 22.0, 140.0, 80.0, 80.0, 70.0, 21.0, 60.0, 40.0, 20.0, 80.0, 30.0, 60.0, 100.0, 60.0, 90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0, 55.0, 70.0, 20.0, 60.0, 20.0, 90.0, 30.0, 75.0, 50.0, 130.0, 40.0, 60.0, 49.0, 80.0, 30.0, 90.0, 210.0, 0.0, 30.0, 50.0, 40.0, 100.0, 60.0, 69.0, 88.0, 51.0, 50.0, 40.0, 130.0, 21.0, 100.0, 100.0, 40.0, 80.0, 40.0, 40.0, 80.0, 90.0, 90.0, 70.0, 130.0, 80.0, 100.0, 70.0, 50.0, 90.0, 40.0, -60.0, 100.0, 160.0, 130.0, 100.0, 100.0, 80.0, 130.0, 110.0, 80.0, 50.0, 80.0, 80.0, 30.0, 50.0, 110.0, 40.0, 234.0, 80.0, 80.0, 110.0, 80.0, 80.0, 70.0, 120.0, 20.0, 160.0, 30.0, 65.0, 100.0, 30.0, 40.0, 50.0, 70.0, 100.0, 70.0, 109.0, -60.0, 100.0, 40.0, 110.0, 90.0, 130.0, 60.0, 30.0, 20.0, 40.0, 20.0, 40.0, 110.0, 110.0, 50.0, 50.0, -27.0, -1.0, 90.0, 20.0, 68.0, 49.0, 80.0, 50.0, 59.0, 60.0, 0.0, 40.0, 45.0, 70.0, 25.0, 120.0, 50.0, 110.0, 19.0, 90.0, 70.0, 110.0, 170.0, 50.0, 86.0, 19.0, 80.0, 60.0, 0.0, 30.0, 80.0, 170.0, 89.0, 90.0, 90.0, 140.0, 210.0, 110.0, 30.0, 88.0, 70.0, 60.0, 110.0, 40.0, 30.0, 100.0, 100.0, 50.0, 110.0, 100.0, 50.0, 50.0, 110.0, 80.0, 28.0, 57.0, 70.0, 70.0, 55.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 40.0, 50.0, 80.0, 90.0, 160.0, 140.0, 100.0, 90.0, 100.0, 90.0, 130.0, 105.0, 60.0, 80.0, 50.0, 30.0, 80.0, 90.0, 94.0, -7.0, 50.0, 110.0, 10.0, 60.0, 120.0, 40.0, 20.0, 98.0, 50.0, 47.0, 40.0, 110.0, 70.0, 90.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 19.0, 60.0, 3.0, 13.0, 40.0, 190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0, 150.0, 10.0, 40.0, 80.0, 60.0, 20.0, 20.0, 50.0, 40.0, 0.0, 130.0, 100.0, 58.0, 110.0, 80.0, 70.0, 70.0, 105.0, 57.0, 130.0, 90.0, 22.0, 50.0, 130.0, 80.0, 90.0, 23.0, 0.0, 40.0, 100.0, 20.0, 53.0, 40.0, 70.0, 60.0, 40.0, 126.0, 110.0, 110.0, 60.0, 60.0, 90.0, 110.0, 90.0, 90.0, 40.0, 50.0, 80.0, 40.0, 38.0, 15.0, 150.0, 40.0, 80.0, 35.0, 60.0, 70.0, 33.0, 68.0, 160.0, 70.0, 10.0, 27.0, 36.0, 80.0, 40.0, 70.0, 70.0, 80.0, 30.0, 90.0, -18.0, 40.0, 40.0, -64.0, 80.0, 38.0, 90.0, 130.0, 60.0, 120.0, 110.0, 70.0, 140.0, 50.0, 88.0, 80.0, 90.0, 150.0, 90.0, 50.0, 126.0, 60.0, 50.0, 80.0, 35.0, 90.0, 110.0, 50.0, 30.0, 40.0, 46.0, 116.0, 10.0, 36.0, 107.0, 10.0, 40.0, 80.0, 50.0, 50.0, 100.0, 70.0, 70.0, 50.0, 70.0, 80.0, 60.0, 100.0, 120.0, 150.0, 50.0, 70.0, 90.0, 110.0, 50.0, 98.0, 100.0, -180.0, 100.0, 120.0, 90.0, 80.0, 22.0, 70.0, 60.0, 60.0, 60.0, 70.0, 23.0, 40.0, 36.0, 10.0, 120.0, 60.0, 90.0, 110.0, 60.0, -5.0, 80.0, 70.0, 60.0, 30.0, 70.0, 70.0, 30.0, 50.0, 120.0, 100.0, 50.0, 80.0, 57.0, 78.0, 24.0, 100.0, 28.0, 39.0, 70.0, 80.0, 110.0, 100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0, 110.0, 20.0, 110.0, 100.0, 120.0, 38.0, 30.0, 10.0, 59.0, 60.0, 30.0, 90.0, 50.0, 40.0, 20.0, 35.0, 90.0, 66.0, 60.0, 70.0, 70.0, 0.0, 110.0, 180.0, 50.0, 80.0, -10.0, -5.0, 40.0, 70.0, 60.0, 100.0, 8.0, 80.0, 50.0, 50.0, 0.0, 80.0, 40.0, 40.0, 100.0, 70.0, 140.0, 80.0, 64.0, 72.0, 70.0, 31.0, 50.0, 50.0, 100.0, 76.0, 70.0, 70.0, 90.0, 61.0, 36.0, 25.0, 165.0, 40.0, 110.0, 40.0, 74.0, -40.0, 130.0, 90.0, 50.0, 96.0, 70.0, 102.0, 50.0, -21.0, 80.0, 90.0, 18.0, 16.0, 20.0, 50.0, 40.0, 33.0, 160.0, 120.0, 61.0, -13.0, 110.0, 40.0, 30.0, 80.0, 60.0, 70.0, -21.0, 95.0, 100.0, 170.0, -1.0, 110.0, 10.0, 130.0, 50.0, 100.0, 70.0, 80.0, 89.0, 4.0, 110.0, 90.0, 0.0, 30.0, 51.0, 60.0, 68.0, 90.0, 24.0, 100.0, 49.0, 60.0, 86.0, 50.0, 70.0, 50.0, 50.0, 50.0, -160.0, 15.0, -160.0, 20.0, 60.0, -10.0, 120.0, 70.0, 120.0, 30.0, 30.0, 30.0, 118.0, 60.0, 60.0, 9.0, 80.0, 40.0, 100.0, 92.0, 100.0, 24.0, 80.0, 120.0, 130.0, 160.0, 13.0, 110.0, 69.0, 80.0, 58.0, 70.0, 60.0, 60.0, 100.0, 70.0, 17.0, 140.0, 10.0, 0.0, 30.0, 10.0, 50.0, 50.0, 40.0, 20.0, 20.0, 30.0, 94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5215960543522369, "mean_inference_ms": 1.5215538678762388, "mean_action_processing_ms": 0.4827451756291295, "mean_env_wait_ms": 1.3310711375255624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189422607421875, "StateBufferConnector_ms": 0.00910806655883789, "ViewRequirementAgentConnector_ms": 0.38655591011047363}, "num_episodes": 18, "episode_return_max": 1097.0, "episode_return_min": 55.0, "episode_return_mean": 671.56}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.673421671634802, "num_env_steps_trained_throughput_per_sec": 21.673421671634802, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 185318.896, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185318.849, "sample_time_ms": 2402.587, "learn_time_ms": 182897.041, "learn_throughput": 21.87, "synch_weights_time_ms": 11.095}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "a22d3_00000", "date": "2024-08-06_06-02-49", "timestamp": 1722938569, "time_this_iter_s": 184.56984496116638, "time_total_s": 26359.664759874344, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26359.664759874344, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 18.218007662835248, "ram_util_percent": 75.96704980842912}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.163613651329463, "cur_kl_coeff": 1.1546030312776563, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009743858752841639, "vf_loss": 7.149779763338538, "vf_explained_var": 0.0032210751336476545, "kl": Infinity, "entropy": 0.5206264285868603, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 1097.0, "episode_reward_min": 55.0, "episode_reward_mean": 658.31, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 234.0}, "policy_reward_mean": {"policy_0": 65.831}, "custom_metrics": {}, "hist_stats": {"episode_reward": [639.0, 570.0, 832.0, 253.0, 540.0, 670.0, 703.0, 848.0, 685.0, 730.0, 680.0, 745.0, 912.0, 440.0, 511.0, 477.0, 714.0, 541.0, 723.0, 600.0, 639.0, 649.0, 730.0, 760.0, 940.0, 894.0, 685.0, 759.0, 530.0, 448.0, 569.0, 675.0, 1097.0, 770.0, 640.0, 590.0, 945.0, 637.0, 595.0, 295.0, 801.0, 470.0, 910.0, 625.0, 689.0, 688.0, 711.0, 513.0, 486.0, 988.0, 681.0, 535.0, 770.0, 638.0, 655.0, 601.0, 650.0, 666.0, 800.0, 657.0, 551.0, 585.0, 508.0, 727.0, 733.0, 722.0, 376.0, 718.0, 743.0, 584.0, 647.0, 55.0, 577.0, 929.0, 724.0, 260.0, 651.0, 867.0, 549.0, 830.0, 222.0, 845.0, 830.0, 758.0, 729.0, 566.0, 663.0, 390.0, 759.0, 798.0, 1015.0, 759.0, 680.0, 637.0, 435.0, 449.0, 730.0, 650.0, 649.0, 737.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 80.0, 47.0, 10.0, 5.0, 47.0, 160.0, 80.0, 80.0, 40.0, 50.0, 190.0, 40.0, 40.0, 40.0, 40.0, 0.0, 40.0, 100.0, 30.0, 150.0, 2.0, 60.0, 50.0, 130.0, 0.0, 150.0, 50.0, 120.0, 120.0, 40.0, -3.0, 20.0, 20.0, 80.0, 0.0, 30.0, 7.0, 40.0, 19.0, 100.0, 120.0, -80.0, 60.0, 60.0, 60.0, 50.0, 80.0, 50.0, 40.0, 70.0, 80.0, 30.0, 130.0, 30.0, 120.0, 60.0, 10.0, 70.0, 70.0, 89.0, 35.0, 20.0, 50.0, 120.0, 70.0, 80.0, 70.0, 120.0, 49.0, 91.0, 131.0, 70.0, 100.0, 110.0, 130.0, 78.0, 50.0, 80.0, 8.0, 80.0, 90.0, 60.0, 160.0, 40.0, 60.0, -8.0, 40.0, 80.0, 83.0, 70.0, 120.0, 30.0, 100.0, 80.0, 70.0, 80.0, 90.0, 30.0, 60.0, 40.0, 90.0, 70.0, 60.0, 80.0, 70.0, 130.0, 60.0, 20.0, 60.0, 80.0, 7.0, 30.0, 99.0, 88.0, 110.0, 58.0, 63.0, 50.0, 160.0, 120.0, 60.0, 80.0, 120.0, 40.0, 35.0, 110.0, 107.0, 70.0, 170.0, 10.0, -19.0, 30.0, 85.0, 80.0, 0.0, 100.0, 50.0, 44.0, 60.0, 39.0, 80.0, 57.0, 40.0, 46.0, 30.0, 50.0, 99.0, 20.0, 50.0, 60.0, 40.0, 100.0, 60.0, 40.0, 100.0, -6.0, 50.0, 10.0, 23.0, 90.0, 12.0, 50.0, 110.0, 60.0, 70.0, 22.0, 140.0, 80.0, 80.0, 70.0, 21.0, 60.0, 40.0, 20.0, 80.0, 30.0, 60.0, 100.0, 60.0, 90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0, 55.0, 70.0, 20.0, 60.0, 20.0, 90.0, 30.0, 75.0, 50.0, 130.0, 40.0, 60.0, 49.0, 80.0, 30.0, 90.0, 210.0, 0.0, 30.0, 50.0, 40.0, 100.0, 60.0, 69.0, 88.0, 51.0, 50.0, 40.0, 130.0, 21.0, 100.0, 100.0, 40.0, 80.0, 40.0, 40.0, 80.0, 90.0, 90.0, 70.0, 130.0, 80.0, 100.0, 70.0, 50.0, 90.0, 40.0, -60.0, 100.0, 160.0, 130.0, 100.0, 100.0, 80.0, 130.0, 110.0, 80.0, 50.0, 80.0, 80.0, 30.0, 50.0, 110.0, 40.0, 234.0, 80.0, 80.0, 110.0, 80.0, 80.0, 70.0, 120.0, 20.0, 160.0, 30.0, 65.0, 100.0, 30.0, 40.0, 50.0, 70.0, 100.0, 70.0, 109.0, -60.0, 100.0, 40.0, 110.0, 90.0, 130.0, 60.0, 30.0, 20.0, 40.0, 20.0, 40.0, 110.0, 110.0, 50.0, 50.0, -27.0, -1.0, 90.0, 20.0, 68.0, 49.0, 80.0, 50.0, 59.0, 60.0, 0.0, 40.0, 45.0, 70.0, 25.0, 120.0, 50.0, 110.0, 19.0, 90.0, 70.0, 110.0, 170.0, 50.0, 86.0, 19.0, 80.0, 60.0, 0.0, 30.0, 80.0, 170.0, 89.0, 90.0, 90.0, 140.0, 210.0, 110.0, 30.0, 88.0, 70.0, 60.0, 110.0, 40.0, 30.0, 100.0, 100.0, 50.0, 110.0, 100.0, 50.0, 50.0, 110.0, 80.0, 28.0, 57.0, 70.0, 70.0, 55.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 40.0, 50.0, 80.0, 90.0, 160.0, 140.0, 100.0, 90.0, 100.0, 90.0, 130.0, 105.0, 60.0, 80.0, 50.0, 30.0, 80.0, 90.0, 94.0, -7.0, 50.0, 110.0, 10.0, 60.0, 120.0, 40.0, 20.0, 98.0, 50.0, 47.0, 40.0, 110.0, 70.0, 90.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 19.0, 60.0, 3.0, 13.0, 40.0, 190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0, 150.0, 10.0, 40.0, 80.0, 60.0, 20.0, 20.0, 50.0, 40.0, 0.0, 130.0, 100.0, 58.0, 110.0, 80.0, 70.0, 70.0, 105.0, 57.0, 130.0, 90.0, 22.0, 50.0, 130.0, 80.0, 90.0, 23.0, 0.0, 40.0, 100.0, 20.0, 53.0, 40.0, 70.0, 60.0, 40.0, 126.0, 110.0, 110.0, 60.0, 60.0, 90.0, 110.0, 90.0, 90.0, 40.0, 50.0, 80.0, 40.0, 38.0, 15.0, 150.0, 40.0, 80.0, 35.0, 60.0, 70.0, 33.0, 68.0, 160.0, 70.0, 10.0, 27.0, 36.0, 80.0, 40.0, 70.0, 70.0, 80.0, 30.0, 90.0, -18.0, 40.0, 40.0, -64.0, 80.0, 38.0, 90.0, 130.0, 60.0, 120.0, 110.0, 70.0, 140.0, 50.0, 88.0, 80.0, 90.0, 150.0, 90.0, 50.0, 126.0, 60.0, 50.0, 80.0, 35.0, 90.0, 110.0, 50.0, 30.0, 40.0, 46.0, 116.0, 10.0, 36.0, 107.0, 10.0, 40.0, 80.0, 50.0, 50.0, 100.0, 70.0, 70.0, 50.0, 70.0, 80.0, 60.0, 100.0, 120.0, 150.0, 50.0, 70.0, 90.0, 110.0, 50.0, 98.0, 100.0, -180.0, 100.0, 120.0, 90.0, 80.0, 22.0, 70.0, 60.0, 60.0, 60.0, 70.0, 23.0, 40.0, 36.0, 10.0, 120.0, 60.0, 90.0, 110.0, 60.0, -5.0, 80.0, 70.0, 60.0, 30.0, 70.0, 70.0, 30.0, 50.0, 120.0, 100.0, 50.0, 80.0, 57.0, 78.0, 24.0, 100.0, 28.0, 39.0, 70.0, 80.0, 110.0, 100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0, 110.0, 20.0, 110.0, 100.0, 120.0, 38.0, 30.0, 10.0, 59.0, 60.0, 30.0, 90.0, 50.0, 40.0, 20.0, 35.0, 90.0, 66.0, 60.0, 70.0, 70.0, 0.0, 110.0, 180.0, 50.0, 80.0, -10.0, -5.0, 40.0, 70.0, 60.0, 100.0, 8.0, 80.0, 50.0, 50.0, 0.0, 80.0, 40.0, 40.0, 100.0, 70.0, 140.0, 80.0, 64.0, 72.0, 70.0, 31.0, 50.0, 50.0, 100.0, 76.0, 70.0, 70.0, 90.0, 61.0, 36.0, 25.0, 165.0, 40.0, 110.0, 40.0, 74.0, -40.0, 130.0, 90.0, 50.0, 96.0, 70.0, 102.0, 50.0, -21.0, 80.0, 90.0, 18.0, 16.0, 20.0, 50.0, 40.0, 33.0, 160.0, 120.0, 61.0, -13.0, 110.0, 40.0, 30.0, 80.0, 60.0, 70.0, -21.0, 95.0, 100.0, 170.0, -1.0, 110.0, 10.0, 130.0, 50.0, 100.0, 70.0, 80.0, 89.0, 4.0, 110.0, 90.0, 0.0, 30.0, 51.0, 60.0, 68.0, 90.0, 24.0, 100.0, 49.0, 60.0, 86.0, 50.0, 70.0, 50.0, 50.0, 50.0, -160.0, 15.0, -160.0, 20.0, 60.0, -10.0, 120.0, 70.0, 120.0, 30.0, 30.0, 30.0, 118.0, 60.0, 60.0, 9.0, 80.0, 40.0, 100.0, 92.0, 100.0, 24.0, 80.0, 120.0, 130.0, 160.0, 13.0, 110.0, 69.0, 80.0, 58.0, 70.0, 60.0, 60.0, 100.0, 70.0, 17.0, 140.0, 10.0, 0.0, 30.0, 10.0, 50.0, 50.0, 40.0, 20.0, 20.0, 30.0, 94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0, 56.0, 100.0, 50.0, 110.0, 130.0, 40.0, 200.0, 76.0, 55.0, 50.0, 40.0, 10.0, 50.0, 60.0, 30.0, 110.0, 80.0, 30.0, 70.0, 69.0, 110.0, 50.0, 50.0, 100.0, 120.0, 140.0, 60.0, 60.0, 0.0, 140.0, 30.0, -64.0, -13.0, 20.0, -4.0, 36.0, 29.0, 50.0, 100.0, 38.0, 140.0, 90.0, 80.0, 90.0, 88.0, 130.0, 47.0, -30.0, 160.0, 50.0, 70.0, 130.0, 80.0, 80.0, 70.0, 60.0, 140.0, 40.0, 110.0, 50.0, 118.0, 50.0, 60.0, 110.0, 10.0, 70.0, 80.0, 110.0, 120.0, 30.0, 30.0, 110.0, 110.0, 110.0, 40.0, 120.0, 29.0, 0.0, 130.0, 50.0, 20.0, 60.0, 31.0, 90.0, 20.0, 110.0, 5.0, 30.0, 100.0, 100.0, 60.0, 100.0, 50.0, 90.0, 60.0, 48.0, 60.0, 80.0, 35.0, 80.0, 20.0, 66.0, 70.0, 70.0, 39.0, 30.0, 50.0, 40.0, 8.0, -3.0, 88.0, 50.0, 90.0, 30.0, 100.0, 60.0, 80.0, 80.0, 135.0, 46.0, 160.0, 110.0, 60.0, 90.0, 60.0, 100.0, 68.0, 20.0, 60.0, 70.0, 140.0, 120.0, 100.0, 43.0, 170.0, 100.0, 90.0, 80.0, 32.0, 140.0, 90.0, 39.0, 70.0, 32.0, 12.0, 60.0, 70.0, 140.0, 136.0, 110.0, 110.0, 20.0, 50.0, 110.0, 0.0, 60.0, 80.0, 90.0, 120.0, 40.0, 90.0, 40.0, 41.0, 40.0, 50.0, 120.0, 70.0, 137.0, 40.0, 9.0, 30.0, 10.0, 40.0, 130.0, 80.0, 60.0, 60.0, -5.0, 30.0, 0.0, 0.0, 20.0, 50.0, 120.0, 12.0, 50.0, 45.0, 40.0, 40.0, 72.0, 70.0, 30.0, 30.0, 130.0, 30.0, 90.0, 90.0, 110.0, 50.0, 100.0, 50.0, 50.0, 30.0, 80.0, 70.0, 100.0, 50.0, 30.0, 100.0, 90.0, 140.0, 70.0, 70.0, 17.0, 40.0, 35.0, 90.0, 37.0, 50.0, 100.0, 37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5205776606329082, "mean_inference_ms": 1.5199925127202447, "mean_action_processing_ms": 0.4822485394612158, "mean_env_wait_ms": 1.3299967153220842, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011885881423950195, "StateBufferConnector_ms": 0.009119987487792969, "ViewRequirementAgentConnector_ms": 0.379565954208374}, "num_episodes": 23, "episode_return_max": 1097.0, "episode_return_min": 55.0, "episode_return_mean": 658.31}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.69372652776477, "num_env_steps_trained_throughput_per_sec": 21.69372652776477, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 185214.978, "restore_workers_time_ms": 0.012, "training_step_time_ms": 185214.931, "sample_time_ms": 2364.963, "learn_time_ms": 182830.82, "learn_throughput": 21.878, "synch_weights_time_ms": 10.987}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "a22d3_00000", "date": "2024-08-06_06-05-53", "timestamp": 1722938753, "time_this_iter_s": 184.39425110816956, "time_total_s": 26544.059010982513, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17ac820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26544.059010982513, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 19.40615384615385, "ram_util_percent": 75.30038461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2579793437093465, "cur_kl_coeff": 1.7319045469164853, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.056521796215329, "policy_loss": -0.00922760841172859, "vf_loss": 7.06186530942988, "vf_explained_var": 0.004928949465766883, "kl": 0.0022426756546153766, "entropy": 0.5170114245023717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 1133.0, "episode_reward_min": 55.0, "episode_reward_mean": 655.49, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 234.0}, "policy_reward_mean": {"policy_0": 65.549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [723.0, 600.0, 639.0, 649.0, 730.0, 760.0, 940.0, 894.0, 685.0, 759.0, 530.0, 448.0, 569.0, 675.0, 1097.0, 770.0, 640.0, 590.0, 945.0, 637.0, 595.0, 295.0, 801.0, 470.0, 910.0, 625.0, 689.0, 688.0, 711.0, 513.0, 486.0, 988.0, 681.0, 535.0, 770.0, 638.0, 655.0, 601.0, 650.0, 666.0, 800.0, 657.0, 551.0, 585.0, 508.0, 727.0, 733.0, 722.0, 376.0, 718.0, 743.0, 584.0, 647.0, 55.0, 577.0, 929.0, 724.0, 260.0, 651.0, 867.0, 549.0, 830.0, 222.0, 845.0, 830.0, 758.0, 729.0, 566.0, 663.0, 390.0, 759.0, 798.0, 1015.0, 759.0, 680.0, 637.0, 435.0, 449.0, 730.0, 650.0, 649.0, 737.0, 525.0, 852.0, 543.0, 850.0, 511.0, 500.0, 1133.0, 540.0, 533.0, 644.0, 685.0, 625.0, 675.0, 513.0, 690.0, 300.0, 204.0, 885.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 120.0, 50.0, 71.0, 40.0, 43.0, 99.0, 70.0, 40.0, 100.0, 55.0, 70.0, 20.0, 60.0, 20.0, 90.0, 30.0, 75.0, 50.0, 130.0, 40.0, 60.0, 49.0, 80.0, 30.0, 90.0, 210.0, 0.0, 30.0, 50.0, 40.0, 100.0, 60.0, 69.0, 88.0, 51.0, 50.0, 40.0, 130.0, 21.0, 100.0, 100.0, 40.0, 80.0, 40.0, 40.0, 80.0, 90.0, 90.0, 70.0, 130.0, 80.0, 100.0, 70.0, 50.0, 90.0, 40.0, -60.0, 100.0, 160.0, 130.0, 100.0, 100.0, 80.0, 130.0, 110.0, 80.0, 50.0, 80.0, 80.0, 30.0, 50.0, 110.0, 40.0, 234.0, 80.0, 80.0, 110.0, 80.0, 80.0, 70.0, 120.0, 20.0, 160.0, 30.0, 65.0, 100.0, 30.0, 40.0, 50.0, 70.0, 100.0, 70.0, 109.0, -60.0, 100.0, 40.0, 110.0, 90.0, 130.0, 60.0, 30.0, 20.0, 40.0, 20.0, 40.0, 110.0, 110.0, 50.0, 50.0, -27.0, -1.0, 90.0, 20.0, 68.0, 49.0, 80.0, 50.0, 59.0, 60.0, 0.0, 40.0, 45.0, 70.0, 25.0, 120.0, 50.0, 110.0, 19.0, 90.0, 70.0, 110.0, 170.0, 50.0, 86.0, 19.0, 80.0, 60.0, 0.0, 30.0, 80.0, 170.0, 89.0, 90.0, 90.0, 140.0, 210.0, 110.0, 30.0, 88.0, 70.0, 60.0, 110.0, 40.0, 30.0, 100.0, 100.0, 50.0, 110.0, 100.0, 50.0, 50.0, 110.0, 80.0, 28.0, 57.0, 70.0, 70.0, 55.0, 70.0, 30.0, 10.0, 30.0, 70.0, 30.0, 40.0, 50.0, 80.0, 90.0, 160.0, 140.0, 100.0, 90.0, 100.0, 90.0, 130.0, 105.0, 60.0, 80.0, 50.0, 30.0, 80.0, 90.0, 94.0, -7.0, 50.0, 110.0, 10.0, 60.0, 120.0, 40.0, 20.0, 98.0, 50.0, 47.0, 40.0, 110.0, 70.0, 90.0, 30.0, 40.0, 20.0, 50.0, 30.0, 20.0, 19.0, 60.0, 3.0, 13.0, 40.0, 190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0, 150.0, 10.0, 40.0, 80.0, 60.0, 20.0, 20.0, 50.0, 40.0, 0.0, 130.0, 100.0, 58.0, 110.0, 80.0, 70.0, 70.0, 105.0, 57.0, 130.0, 90.0, 22.0, 50.0, 130.0, 80.0, 90.0, 23.0, 0.0, 40.0, 100.0, 20.0, 53.0, 40.0, 70.0, 60.0, 40.0, 126.0, 110.0, 110.0, 60.0, 60.0, 90.0, 110.0, 90.0, 90.0, 40.0, 50.0, 80.0, 40.0, 38.0, 15.0, 150.0, 40.0, 80.0, 35.0, 60.0, 70.0, 33.0, 68.0, 160.0, 70.0, 10.0, 27.0, 36.0, 80.0, 40.0, 70.0, 70.0, 80.0, 30.0, 90.0, -18.0, 40.0, 40.0, -64.0, 80.0, 38.0, 90.0, 130.0, 60.0, 120.0, 110.0, 70.0, 140.0, 50.0, 88.0, 80.0, 90.0, 150.0, 90.0, 50.0, 126.0, 60.0, 50.0, 80.0, 35.0, 90.0, 110.0, 50.0, 30.0, 40.0, 46.0, 116.0, 10.0, 36.0, 107.0, 10.0, 40.0, 80.0, 50.0, 50.0, 100.0, 70.0, 70.0, 50.0, 70.0, 80.0, 60.0, 100.0, 120.0, 150.0, 50.0, 70.0, 90.0, 110.0, 50.0, 98.0, 100.0, -180.0, 100.0, 120.0, 90.0, 80.0, 22.0, 70.0, 60.0, 60.0, 60.0, 70.0, 23.0, 40.0, 36.0, 10.0, 120.0, 60.0, 90.0, 110.0, 60.0, -5.0, 80.0, 70.0, 60.0, 30.0, 70.0, 70.0, 30.0, 50.0, 120.0, 100.0, 50.0, 80.0, 57.0, 78.0, 24.0, 100.0, 28.0, 39.0, 70.0, 80.0, 110.0, 100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0, 110.0, 20.0, 110.0, 100.0, 120.0, 38.0, 30.0, 10.0, 59.0, 60.0, 30.0, 90.0, 50.0, 40.0, 20.0, 35.0, 90.0, 66.0, 60.0, 70.0, 70.0, 0.0, 110.0, 180.0, 50.0, 80.0, -10.0, -5.0, 40.0, 70.0, 60.0, 100.0, 8.0, 80.0, 50.0, 50.0, 0.0, 80.0, 40.0, 40.0, 100.0, 70.0, 140.0, 80.0, 64.0, 72.0, 70.0, 31.0, 50.0, 50.0, 100.0, 76.0, 70.0, 70.0, 90.0, 61.0, 36.0, 25.0, 165.0, 40.0, 110.0, 40.0, 74.0, -40.0, 130.0, 90.0, 50.0, 96.0, 70.0, 102.0, 50.0, -21.0, 80.0, 90.0, 18.0, 16.0, 20.0, 50.0, 40.0, 33.0, 160.0, 120.0, 61.0, -13.0, 110.0, 40.0, 30.0, 80.0, 60.0, 70.0, -21.0, 95.0, 100.0, 170.0, -1.0, 110.0, 10.0, 130.0, 50.0, 100.0, 70.0, 80.0, 89.0, 4.0, 110.0, 90.0, 0.0, 30.0, 51.0, 60.0, 68.0, 90.0, 24.0, 100.0, 49.0, 60.0, 86.0, 50.0, 70.0, 50.0, 50.0, 50.0, -160.0, 15.0, -160.0, 20.0, 60.0, -10.0, 120.0, 70.0, 120.0, 30.0, 30.0, 30.0, 118.0, 60.0, 60.0, 9.0, 80.0, 40.0, 100.0, 92.0, 100.0, 24.0, 80.0, 120.0, 130.0, 160.0, 13.0, 110.0, 69.0, 80.0, 58.0, 70.0, 60.0, 60.0, 100.0, 70.0, 17.0, 140.0, 10.0, 0.0, 30.0, 10.0, 50.0, 50.0, 40.0, 20.0, 20.0, 30.0, 94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0, 56.0, 100.0, 50.0, 110.0, 130.0, 40.0, 200.0, 76.0, 55.0, 50.0, 40.0, 10.0, 50.0, 60.0, 30.0, 110.0, 80.0, 30.0, 70.0, 69.0, 110.0, 50.0, 50.0, 100.0, 120.0, 140.0, 60.0, 60.0, 0.0, 140.0, 30.0, -64.0, -13.0, 20.0, -4.0, 36.0, 29.0, 50.0, 100.0, 38.0, 140.0, 90.0, 80.0, 90.0, 88.0, 130.0, 47.0, -30.0, 160.0, 50.0, 70.0, 130.0, 80.0, 80.0, 70.0, 60.0, 140.0, 40.0, 110.0, 50.0, 118.0, 50.0, 60.0, 110.0, 10.0, 70.0, 80.0, 110.0, 120.0, 30.0, 30.0, 110.0, 110.0, 110.0, 40.0, 120.0, 29.0, 0.0, 130.0, 50.0, 20.0, 60.0, 31.0, 90.0, 20.0, 110.0, 5.0, 30.0, 100.0, 100.0, 60.0, 100.0, 50.0, 90.0, 60.0, 48.0, 60.0, 80.0, 35.0, 80.0, 20.0, 66.0, 70.0, 70.0, 39.0, 30.0, 50.0, 40.0, 8.0, -3.0, 88.0, 50.0, 90.0, 30.0, 100.0, 60.0, 80.0, 80.0, 135.0, 46.0, 160.0, 110.0, 60.0, 90.0, 60.0, 100.0, 68.0, 20.0, 60.0, 70.0, 140.0, 120.0, 100.0, 43.0, 170.0, 100.0, 90.0, 80.0, 32.0, 140.0, 90.0, 39.0, 70.0, 32.0, 12.0, 60.0, 70.0, 140.0, 136.0, 110.0, 110.0, 20.0, 50.0, 110.0, 0.0, 60.0, 80.0, 90.0, 120.0, 40.0, 90.0, 40.0, 41.0, 40.0, 50.0, 120.0, 70.0, 137.0, 40.0, 9.0, 30.0, 10.0, 40.0, 130.0, 80.0, 60.0, 60.0, -5.0, 30.0, 0.0, 0.0, 20.0, 50.0, 120.0, 12.0, 50.0, 45.0, 40.0, 40.0, 72.0, 70.0, 30.0, 30.0, 130.0, 30.0, 90.0, 90.0, 110.0, 50.0, 100.0, 50.0, 50.0, 30.0, 80.0, 70.0, 100.0, 50.0, 30.0, 100.0, 90.0, 140.0, 70.0, 70.0, 17.0, 40.0, 35.0, 90.0, 37.0, 50.0, 100.0, 37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0, 40.0, 10.0, 85.0, 17.0, 70.0, 50.0, 40.0, 97.0, 110.0, 6.0, 72.0, 69.0, 150.0, 70.0, 16.0, 45.0, 170.0, 50.0, 70.0, 140.0, 50.0, 30.0, 30.0, 6.0, 90.0, 60.0, 20.0, 160.0, 27.0, 70.0, 84.0, 110.0, 58.0, 120.0, 90.0, 75.0, 110.0, 60.0, 90.0, 53.0, 8.0, 31.0, 66.0, 80.0, 46.0, 96.0, 52.0, 12.0, 40.0, 80.0, 90.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 90.0, 30.0, 30.0, 150.0, 170.0, 120.0, 105.0, 101.0, 97.0, 120.0, 70.0, 110.0, 90.0, 110.0, 30.0, 30.0, 40.0, 40.0, 10.0, 70.0, 90.0, 40.0, 80.0, 58.0, 50.0, 29.0, 50.0, 100.0, 120.0, 17.0, 9.0, 30.0, 70.0, 5.0, 110.0, 110.0, 19.0, 20.0, 60.0, 60.0, 130.0, 80.0, 50.0, 50.0, 80.0, 80.0, 20.0, 110.0, 110.0, 90.0, 100.0, 70.0, -25.0, 70.0, 100.0, 66.0, 40.0, 70.0, 19.0, 60.0, 48.0, 137.0, 15.0, 40.0, 70.0, 67.0, 80.0, 80.0, 28.0, 90.0, 70.0, 40.0, 110.0, 140.0, 60.0, -37.0, 80.0, 56.0, 40.0, 45.0, 0.0, 90.0, 39.0, 100.0, 40.0, 100.0, 20.0, 10.0, 60.0, 80.0, 100.0, 70.0, 110.0, 20.0, 60.0, -14.0, -1.0, 10.0, 50.0, 0.0, 40.0, 50.0, 85.0, 0.0, 40.0, 0.0, 0.0, 26.0, 20.0, 38.0, 60.0, 0.0, 20.0, 50.0, 30.0, 140.0, 50.0, 100.0, 90.0, 90.0, 110.0, 110.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5197198712486262, "mean_inference_ms": 1.5188665583302523, "mean_action_processing_ms": 0.481873759108669, "mean_env_wait_ms": 1.329164663669018, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011938095092773438, "StateBufferConnector_ms": 0.009183883666992188, "ViewRequirementAgentConnector_ms": 0.3905935287475586}, "num_episodes": 18, "episode_return_max": 1133.0, "episode_return_min": 55.0, "episode_return_mean": 655.49}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.747458274395353, "num_env_steps_trained_throughput_per_sec": 21.747458274395353, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 185030.257, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185030.21, "sample_time_ms": 2337.838, "learn_time_ms": 182673.114, "learn_throughput": 21.897, "synch_weights_time_ms": 11.041}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "a22d3_00000", "date": "2024-08-06_06-08-57", "timestamp": 1722938937, "time_this_iter_s": 183.93989896774292, "time_total_s": 26727.998909950256, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a17ace50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26727.998909950256, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.80576923076923, "ram_util_percent": 75.01615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3238594831750037, "cur_kl_coeff": 0.8659522734582427, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010496577954800508, "vf_loss": 7.681650855112126, "vf_explained_var": 0.0073989768949941324, "kl": Infinity, "entropy": 0.4657972184740824, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 1133.0, "episode_reward_min": 55.0, "episode_reward_mean": 663.41, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 66.341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [801.0, 470.0, 910.0, 625.0, 689.0, 688.0, 711.0, 513.0, 486.0, 988.0, 681.0, 535.0, 770.0, 638.0, 655.0, 601.0, 650.0, 666.0, 800.0, 657.0, 551.0, 585.0, 508.0, 727.0, 733.0, 722.0, 376.0, 718.0, 743.0, 584.0, 647.0, 55.0, 577.0, 929.0, 724.0, 260.0, 651.0, 867.0, 549.0, 830.0, 222.0, 845.0, 830.0, 758.0, 729.0, 566.0, 663.0, 390.0, 759.0, 798.0, 1015.0, 759.0, 680.0, 637.0, 435.0, 449.0, 730.0, 650.0, 649.0, 737.0, 525.0, 852.0, 543.0, 850.0, 511.0, 500.0, 1133.0, 540.0, 533.0, 644.0, 685.0, 625.0, 675.0, 513.0, 690.0, 300.0, 204.0, 885.0, 907.0, 707.0, 750.0, 665.0, 750.0, 448.0, 677.0, 616.0, 706.0, 609.0, 293.0, 1070.0, 815.0, 678.0, 675.0, 681.0, 970.0, 852.0, 970.0, 1040.0, 553.0, 530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [190.0, 40.0, 100.0, 70.0, 75.0, 30.0, 46.0, 50.0, 110.0, 90.0, 150.0, 10.0, 40.0, 80.0, 60.0, 20.0, 20.0, 50.0, 40.0, 0.0, 130.0, 100.0, 58.0, 110.0, 80.0, 70.0, 70.0, 105.0, 57.0, 130.0, 90.0, 22.0, 50.0, 130.0, 80.0, 90.0, 23.0, 0.0, 40.0, 100.0, 20.0, 53.0, 40.0, 70.0, 60.0, 40.0, 126.0, 110.0, 110.0, 60.0, 60.0, 90.0, 110.0, 90.0, 90.0, 40.0, 50.0, 80.0, 40.0, 38.0, 15.0, 150.0, 40.0, 80.0, 35.0, 60.0, 70.0, 33.0, 68.0, 160.0, 70.0, 10.0, 27.0, 36.0, 80.0, 40.0, 70.0, 70.0, 80.0, 30.0, 90.0, -18.0, 40.0, 40.0, -64.0, 80.0, 38.0, 90.0, 130.0, 60.0, 120.0, 110.0, 70.0, 140.0, 50.0, 88.0, 80.0, 90.0, 150.0, 90.0, 50.0, 126.0, 60.0, 50.0, 80.0, 35.0, 90.0, 110.0, 50.0, 30.0, 40.0, 46.0, 116.0, 10.0, 36.0, 107.0, 10.0, 40.0, 80.0, 50.0, 50.0, 100.0, 70.0, 70.0, 50.0, 70.0, 80.0, 60.0, 100.0, 120.0, 150.0, 50.0, 70.0, 90.0, 110.0, 50.0, 98.0, 100.0, -180.0, 100.0, 120.0, 90.0, 80.0, 22.0, 70.0, 60.0, 60.0, 60.0, 70.0, 23.0, 40.0, 36.0, 10.0, 120.0, 60.0, 90.0, 110.0, 60.0, -5.0, 80.0, 70.0, 60.0, 30.0, 70.0, 70.0, 30.0, 50.0, 120.0, 100.0, 50.0, 80.0, 57.0, 78.0, 24.0, 100.0, 28.0, 39.0, 70.0, 80.0, 110.0, 100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0, 110.0, 20.0, 110.0, 100.0, 120.0, 38.0, 30.0, 10.0, 59.0, 60.0, 30.0, 90.0, 50.0, 40.0, 20.0, 35.0, 90.0, 66.0, 60.0, 70.0, 70.0, 0.0, 110.0, 180.0, 50.0, 80.0, -10.0, -5.0, 40.0, 70.0, 60.0, 100.0, 8.0, 80.0, 50.0, 50.0, 0.0, 80.0, 40.0, 40.0, 100.0, 70.0, 140.0, 80.0, 64.0, 72.0, 70.0, 31.0, 50.0, 50.0, 100.0, 76.0, 70.0, 70.0, 90.0, 61.0, 36.0, 25.0, 165.0, 40.0, 110.0, 40.0, 74.0, -40.0, 130.0, 90.0, 50.0, 96.0, 70.0, 102.0, 50.0, -21.0, 80.0, 90.0, 18.0, 16.0, 20.0, 50.0, 40.0, 33.0, 160.0, 120.0, 61.0, -13.0, 110.0, 40.0, 30.0, 80.0, 60.0, 70.0, -21.0, 95.0, 100.0, 170.0, -1.0, 110.0, 10.0, 130.0, 50.0, 100.0, 70.0, 80.0, 89.0, 4.0, 110.0, 90.0, 0.0, 30.0, 51.0, 60.0, 68.0, 90.0, 24.0, 100.0, 49.0, 60.0, 86.0, 50.0, 70.0, 50.0, 50.0, 50.0, -160.0, 15.0, -160.0, 20.0, 60.0, -10.0, 120.0, 70.0, 120.0, 30.0, 30.0, 30.0, 118.0, 60.0, 60.0, 9.0, 80.0, 40.0, 100.0, 92.0, 100.0, 24.0, 80.0, 120.0, 130.0, 160.0, 13.0, 110.0, 69.0, 80.0, 58.0, 70.0, 60.0, 60.0, 100.0, 70.0, 17.0, 140.0, 10.0, 0.0, 30.0, 10.0, 50.0, 50.0, 40.0, 20.0, 20.0, 30.0, 94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0, 56.0, 100.0, 50.0, 110.0, 130.0, 40.0, 200.0, 76.0, 55.0, 50.0, 40.0, 10.0, 50.0, 60.0, 30.0, 110.0, 80.0, 30.0, 70.0, 69.0, 110.0, 50.0, 50.0, 100.0, 120.0, 140.0, 60.0, 60.0, 0.0, 140.0, 30.0, -64.0, -13.0, 20.0, -4.0, 36.0, 29.0, 50.0, 100.0, 38.0, 140.0, 90.0, 80.0, 90.0, 88.0, 130.0, 47.0, -30.0, 160.0, 50.0, 70.0, 130.0, 80.0, 80.0, 70.0, 60.0, 140.0, 40.0, 110.0, 50.0, 118.0, 50.0, 60.0, 110.0, 10.0, 70.0, 80.0, 110.0, 120.0, 30.0, 30.0, 110.0, 110.0, 110.0, 40.0, 120.0, 29.0, 0.0, 130.0, 50.0, 20.0, 60.0, 31.0, 90.0, 20.0, 110.0, 5.0, 30.0, 100.0, 100.0, 60.0, 100.0, 50.0, 90.0, 60.0, 48.0, 60.0, 80.0, 35.0, 80.0, 20.0, 66.0, 70.0, 70.0, 39.0, 30.0, 50.0, 40.0, 8.0, -3.0, 88.0, 50.0, 90.0, 30.0, 100.0, 60.0, 80.0, 80.0, 135.0, 46.0, 160.0, 110.0, 60.0, 90.0, 60.0, 100.0, 68.0, 20.0, 60.0, 70.0, 140.0, 120.0, 100.0, 43.0, 170.0, 100.0, 90.0, 80.0, 32.0, 140.0, 90.0, 39.0, 70.0, 32.0, 12.0, 60.0, 70.0, 140.0, 136.0, 110.0, 110.0, 20.0, 50.0, 110.0, 0.0, 60.0, 80.0, 90.0, 120.0, 40.0, 90.0, 40.0, 41.0, 40.0, 50.0, 120.0, 70.0, 137.0, 40.0, 9.0, 30.0, 10.0, 40.0, 130.0, 80.0, 60.0, 60.0, -5.0, 30.0, 0.0, 0.0, 20.0, 50.0, 120.0, 12.0, 50.0, 45.0, 40.0, 40.0, 72.0, 70.0, 30.0, 30.0, 130.0, 30.0, 90.0, 90.0, 110.0, 50.0, 100.0, 50.0, 50.0, 30.0, 80.0, 70.0, 100.0, 50.0, 30.0, 100.0, 90.0, 140.0, 70.0, 70.0, 17.0, 40.0, 35.0, 90.0, 37.0, 50.0, 100.0, 37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0, 40.0, 10.0, 85.0, 17.0, 70.0, 50.0, 40.0, 97.0, 110.0, 6.0, 72.0, 69.0, 150.0, 70.0, 16.0, 45.0, 170.0, 50.0, 70.0, 140.0, 50.0, 30.0, 30.0, 6.0, 90.0, 60.0, 20.0, 160.0, 27.0, 70.0, 84.0, 110.0, 58.0, 120.0, 90.0, 75.0, 110.0, 60.0, 90.0, 53.0, 8.0, 31.0, 66.0, 80.0, 46.0, 96.0, 52.0, 12.0, 40.0, 80.0, 90.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 90.0, 30.0, 30.0, 150.0, 170.0, 120.0, 105.0, 101.0, 97.0, 120.0, 70.0, 110.0, 90.0, 110.0, 30.0, 30.0, 40.0, 40.0, 10.0, 70.0, 90.0, 40.0, 80.0, 58.0, 50.0, 29.0, 50.0, 100.0, 120.0, 17.0, 9.0, 30.0, 70.0, 5.0, 110.0, 110.0, 19.0, 20.0, 60.0, 60.0, 130.0, 80.0, 50.0, 50.0, 80.0, 80.0, 20.0, 110.0, 110.0, 90.0, 100.0, 70.0, -25.0, 70.0, 100.0, 66.0, 40.0, 70.0, 19.0, 60.0, 48.0, 137.0, 15.0, 40.0, 70.0, 67.0, 80.0, 80.0, 28.0, 90.0, 70.0, 40.0, 110.0, 140.0, 60.0, -37.0, 80.0, 56.0, 40.0, 45.0, 0.0, 90.0, 39.0, 100.0, 40.0, 100.0, 20.0, 10.0, 60.0, 80.0, 100.0, 70.0, 110.0, 20.0, 60.0, -14.0, -1.0, 10.0, 50.0, 0.0, 40.0, 50.0, 85.0, 0.0, 40.0, 0.0, 0.0, 26.0, 20.0, 38.0, 60.0, 0.0, 20.0, 50.0, 30.0, 140.0, 50.0, 100.0, 90.0, 90.0, 110.0, 110.0, 115.0, 80.0, 90.0, 140.0, 90.0, 48.0, 15.0, 74.0, 130.0, 80.0, 160.0, 70.0, 90.0, 40.0, 12.0, 70.0, -5.0, 90.0, 210.0, 70.0, 60.0, 60.0, 80.0, 40.0, 80.0, 140.0, 60.0, 40.0, 100.0, 80.0, 70.0, 20.0, 40.0, 130.0, 150.0, 70.0, 140.0, 18.0, 49.0, 10.0, 38.0, 60.0, 30.0, 80.0, 30.0, 100.0, 70.0, 150.0, 100.0, 30.0, 100.0, 60.0, 10.0, 120.0, 46.0, 50.0, -7.0, 40.0, 19.0, 70.0, 40.0, 41.0, 39.0, 110.0, 7.0, 90.0, 40.0, 110.0, 80.0, 90.0, 70.0, 60.0, 49.0, 40.0, 100.0, 80.0, 90.0, 20.0, 37.0, 80.0, 60.0, 86.0, 30.0, 10.0, 120.0, 60.0, 100.0, 50.0, 70.0, 50.0, 130.0, 140.0, 76.0, -9.0, 14.0, 70.0, 14.0, 90.0, 50.0, 160.0, 4.0, 28.0, 60.0, 10.0, 10.0, 20.0, 38.0, -13.0, 80.0, 30.0, 30.0, 80.0, 90.0, 100.0, 100.0, 120.0, 130.0, 100.0, 170.0, 80.0, 100.0, 90.0, 80.0, 50.0, 80.0, 150.0, 130.0, 5.0, 100.0, 70.0, 60.0, 2.0, -54.0, 60.0, 50.0, 90.0, 100.0, 140.0, 60.0, 120.0, 110.0, 30.0, 100.0, 70.0, 100.0, 90.0, 50.0, 45.0, 50.0, 40.0, 100.0, 60.0, 53.0, 70.0, 160.0, 60.0, 30.0, 110.0, 25.0, 90.0, 23.0, 80.0, 150.0, 0.0, 90.0, 140.0, 100.0, 90.0, 110.0, 90.0, 120.0, 59.0, 70.0, 60.0, 130.0, 120.0, 110.0, 90.0, 23.0, 100.0, 90.0, 70.0, 120.0, 70.0, 80.0, 110.0, 90.0, 90.0, 100.0, 60.0, 180.0, 140.0, 60.0, 140.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 100.0, 70.0, 70.0, 190.0, 25.0, -4.0, 23.0, 60.0, -11.0, 70.0, 60.0, 40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5188016484322608, "mean_inference_ms": 1.5175650820751352, "mean_action_processing_ms": 0.4814530735413639, "mean_env_wait_ms": 1.3282574763906905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013887405395507812, "StateBufferConnector_ms": 0.009466171264648438, "ViewRequirementAgentConnector_ms": 0.3841540813446045}, "num_episodes": 22, "episode_return_max": 1133.0, "episode_return_min": 55.0, "episode_return_mean": 663.41}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.48232822370756, "num_env_steps_trained_throughput_per_sec": 21.48232822370756, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 185200.517, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185200.469, "sample_time_ms": 2342.67, "learn_time_ms": 182837.341, "learn_throughput": 21.877, "synch_weights_time_ms": 11.993}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "a22d3_00000", "date": "2024-08-06_06-12-03", "timestamp": 1722939123, "time_this_iter_s": 186.21364307403564, "time_total_s": 26914.212553024292, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a18c95e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26914.212553024292, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 21.799242424242426, "ram_util_percent": 74.82613636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3431213253730148, "cur_kl_coeff": 1.2989284101873637, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00977105439716952, "vf_loss": 7.134642534845045, "vf_explained_var": 0.009137448449485218, "kl": Infinity, "entropy": 0.5448507867904263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 1133.0, "episode_reward_min": 55.0, "episode_reward_mean": 654.37, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 65.437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 657.0, 551.0, 585.0, 508.0, 727.0, 733.0, 722.0, 376.0, 718.0, 743.0, 584.0, 647.0, 55.0, 577.0, 929.0, 724.0, 260.0, 651.0, 867.0, 549.0, 830.0, 222.0, 845.0, 830.0, 758.0, 729.0, 566.0, 663.0, 390.0, 759.0, 798.0, 1015.0, 759.0, 680.0, 637.0, 435.0, 449.0, 730.0, 650.0, 649.0, 737.0, 525.0, 852.0, 543.0, 850.0, 511.0, 500.0, 1133.0, 540.0, 533.0, 644.0, 685.0, 625.0, 675.0, 513.0, 690.0, 300.0, 204.0, 885.0, 907.0, 707.0, 750.0, 665.0, 750.0, 448.0, 677.0, 616.0, 706.0, 609.0, 293.0, 1070.0, 815.0, 678.0, 675.0, 681.0, 970.0, 852.0, 970.0, 1040.0, 553.0, 530.0, 846.0, 793.0, 835.0, 597.0, 698.0, 566.0, 577.0, 484.0, 400.0, 447.0, 390.0, 415.0, 790.0, 901.0, 509.0, 694.0, 661.0, 570.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 100.0, 70.0, 120.0, 60.0, 70.0, 70.0, 60.0, 50.0, 100.0, 110.0, 20.0, 110.0, 100.0, 120.0, 38.0, 30.0, 10.0, 59.0, 60.0, 30.0, 90.0, 50.0, 40.0, 20.0, 35.0, 90.0, 66.0, 60.0, 70.0, 70.0, 0.0, 110.0, 180.0, 50.0, 80.0, -10.0, -5.0, 40.0, 70.0, 60.0, 100.0, 8.0, 80.0, 50.0, 50.0, 0.0, 80.0, 40.0, 40.0, 100.0, 70.0, 140.0, 80.0, 64.0, 72.0, 70.0, 31.0, 50.0, 50.0, 100.0, 76.0, 70.0, 70.0, 90.0, 61.0, 36.0, 25.0, 165.0, 40.0, 110.0, 40.0, 74.0, -40.0, 130.0, 90.0, 50.0, 96.0, 70.0, 102.0, 50.0, -21.0, 80.0, 90.0, 18.0, 16.0, 20.0, 50.0, 40.0, 33.0, 160.0, 120.0, 61.0, -13.0, 110.0, 40.0, 30.0, 80.0, 60.0, 70.0, -21.0, 95.0, 100.0, 170.0, -1.0, 110.0, 10.0, 130.0, 50.0, 100.0, 70.0, 80.0, 89.0, 4.0, 110.0, 90.0, 0.0, 30.0, 51.0, 60.0, 68.0, 90.0, 24.0, 100.0, 49.0, 60.0, 86.0, 50.0, 70.0, 50.0, 50.0, 50.0, -160.0, 15.0, -160.0, 20.0, 60.0, -10.0, 120.0, 70.0, 120.0, 30.0, 30.0, 30.0, 118.0, 60.0, 60.0, 9.0, 80.0, 40.0, 100.0, 92.0, 100.0, 24.0, 80.0, 120.0, 130.0, 160.0, 13.0, 110.0, 69.0, 80.0, 58.0, 70.0, 60.0, 60.0, 100.0, 70.0, 17.0, 140.0, 10.0, 0.0, 30.0, 10.0, 50.0, 50.0, 40.0, 20.0, 20.0, 30.0, 94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0, 56.0, 100.0, 50.0, 110.0, 130.0, 40.0, 200.0, 76.0, 55.0, 50.0, 40.0, 10.0, 50.0, 60.0, 30.0, 110.0, 80.0, 30.0, 70.0, 69.0, 110.0, 50.0, 50.0, 100.0, 120.0, 140.0, 60.0, 60.0, 0.0, 140.0, 30.0, -64.0, -13.0, 20.0, -4.0, 36.0, 29.0, 50.0, 100.0, 38.0, 140.0, 90.0, 80.0, 90.0, 88.0, 130.0, 47.0, -30.0, 160.0, 50.0, 70.0, 130.0, 80.0, 80.0, 70.0, 60.0, 140.0, 40.0, 110.0, 50.0, 118.0, 50.0, 60.0, 110.0, 10.0, 70.0, 80.0, 110.0, 120.0, 30.0, 30.0, 110.0, 110.0, 110.0, 40.0, 120.0, 29.0, 0.0, 130.0, 50.0, 20.0, 60.0, 31.0, 90.0, 20.0, 110.0, 5.0, 30.0, 100.0, 100.0, 60.0, 100.0, 50.0, 90.0, 60.0, 48.0, 60.0, 80.0, 35.0, 80.0, 20.0, 66.0, 70.0, 70.0, 39.0, 30.0, 50.0, 40.0, 8.0, -3.0, 88.0, 50.0, 90.0, 30.0, 100.0, 60.0, 80.0, 80.0, 135.0, 46.0, 160.0, 110.0, 60.0, 90.0, 60.0, 100.0, 68.0, 20.0, 60.0, 70.0, 140.0, 120.0, 100.0, 43.0, 170.0, 100.0, 90.0, 80.0, 32.0, 140.0, 90.0, 39.0, 70.0, 32.0, 12.0, 60.0, 70.0, 140.0, 136.0, 110.0, 110.0, 20.0, 50.0, 110.0, 0.0, 60.0, 80.0, 90.0, 120.0, 40.0, 90.0, 40.0, 41.0, 40.0, 50.0, 120.0, 70.0, 137.0, 40.0, 9.0, 30.0, 10.0, 40.0, 130.0, 80.0, 60.0, 60.0, -5.0, 30.0, 0.0, 0.0, 20.0, 50.0, 120.0, 12.0, 50.0, 45.0, 40.0, 40.0, 72.0, 70.0, 30.0, 30.0, 130.0, 30.0, 90.0, 90.0, 110.0, 50.0, 100.0, 50.0, 50.0, 30.0, 80.0, 70.0, 100.0, 50.0, 30.0, 100.0, 90.0, 140.0, 70.0, 70.0, 17.0, 40.0, 35.0, 90.0, 37.0, 50.0, 100.0, 37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0, 40.0, 10.0, 85.0, 17.0, 70.0, 50.0, 40.0, 97.0, 110.0, 6.0, 72.0, 69.0, 150.0, 70.0, 16.0, 45.0, 170.0, 50.0, 70.0, 140.0, 50.0, 30.0, 30.0, 6.0, 90.0, 60.0, 20.0, 160.0, 27.0, 70.0, 84.0, 110.0, 58.0, 120.0, 90.0, 75.0, 110.0, 60.0, 90.0, 53.0, 8.0, 31.0, 66.0, 80.0, 46.0, 96.0, 52.0, 12.0, 40.0, 80.0, 90.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 90.0, 30.0, 30.0, 150.0, 170.0, 120.0, 105.0, 101.0, 97.0, 120.0, 70.0, 110.0, 90.0, 110.0, 30.0, 30.0, 40.0, 40.0, 10.0, 70.0, 90.0, 40.0, 80.0, 58.0, 50.0, 29.0, 50.0, 100.0, 120.0, 17.0, 9.0, 30.0, 70.0, 5.0, 110.0, 110.0, 19.0, 20.0, 60.0, 60.0, 130.0, 80.0, 50.0, 50.0, 80.0, 80.0, 20.0, 110.0, 110.0, 90.0, 100.0, 70.0, -25.0, 70.0, 100.0, 66.0, 40.0, 70.0, 19.0, 60.0, 48.0, 137.0, 15.0, 40.0, 70.0, 67.0, 80.0, 80.0, 28.0, 90.0, 70.0, 40.0, 110.0, 140.0, 60.0, -37.0, 80.0, 56.0, 40.0, 45.0, 0.0, 90.0, 39.0, 100.0, 40.0, 100.0, 20.0, 10.0, 60.0, 80.0, 100.0, 70.0, 110.0, 20.0, 60.0, -14.0, -1.0, 10.0, 50.0, 0.0, 40.0, 50.0, 85.0, 0.0, 40.0, 0.0, 0.0, 26.0, 20.0, 38.0, 60.0, 0.0, 20.0, 50.0, 30.0, 140.0, 50.0, 100.0, 90.0, 90.0, 110.0, 110.0, 115.0, 80.0, 90.0, 140.0, 90.0, 48.0, 15.0, 74.0, 130.0, 80.0, 160.0, 70.0, 90.0, 40.0, 12.0, 70.0, -5.0, 90.0, 210.0, 70.0, 60.0, 60.0, 80.0, 40.0, 80.0, 140.0, 60.0, 40.0, 100.0, 80.0, 70.0, 20.0, 40.0, 130.0, 150.0, 70.0, 140.0, 18.0, 49.0, 10.0, 38.0, 60.0, 30.0, 80.0, 30.0, 100.0, 70.0, 150.0, 100.0, 30.0, 100.0, 60.0, 10.0, 120.0, 46.0, 50.0, -7.0, 40.0, 19.0, 70.0, 40.0, 41.0, 39.0, 110.0, 7.0, 90.0, 40.0, 110.0, 80.0, 90.0, 70.0, 60.0, 49.0, 40.0, 100.0, 80.0, 90.0, 20.0, 37.0, 80.0, 60.0, 86.0, 30.0, 10.0, 120.0, 60.0, 100.0, 50.0, 70.0, 50.0, 130.0, 140.0, 76.0, -9.0, 14.0, 70.0, 14.0, 90.0, 50.0, 160.0, 4.0, 28.0, 60.0, 10.0, 10.0, 20.0, 38.0, -13.0, 80.0, 30.0, 30.0, 80.0, 90.0, 100.0, 100.0, 120.0, 130.0, 100.0, 170.0, 80.0, 100.0, 90.0, 80.0, 50.0, 80.0, 150.0, 130.0, 5.0, 100.0, 70.0, 60.0, 2.0, -54.0, 60.0, 50.0, 90.0, 100.0, 140.0, 60.0, 120.0, 110.0, 30.0, 100.0, 70.0, 100.0, 90.0, 50.0, 45.0, 50.0, 40.0, 100.0, 60.0, 53.0, 70.0, 160.0, 60.0, 30.0, 110.0, 25.0, 90.0, 23.0, 80.0, 150.0, 0.0, 90.0, 140.0, 100.0, 90.0, 110.0, 90.0, 120.0, 59.0, 70.0, 60.0, 130.0, 120.0, 110.0, 90.0, 23.0, 100.0, 90.0, 70.0, 120.0, 70.0, 80.0, 110.0, 90.0, 90.0, 100.0, 60.0, 180.0, 140.0, 60.0, 140.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 100.0, 70.0, 70.0, 190.0, 25.0, -4.0, 23.0, 60.0, -11.0, 70.0, 60.0, 40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0, 80.0, 60.0, 60.0, 100.0, 120.0, 140.0, 60.0, 110.0, 16.0, 100.0, 60.0, 70.0, 70.0, 130.0, 70.0, 140.0, 89.0, 20.0, 44.0, 100.0, 70.0, 160.0, 66.0, 130.0, 50.0, 100.0, 69.0, 60.0, 70.0, 60.0, 60.0, 24.0, 59.0, 20.0, 60.0, 90.0, 25.0, 109.0, 130.0, 20.0, 90.0, 80.0, 74.0, 20.0, 60.0, 34.0, 50.0, 120.0, 50.0, 120.0, 47.0, 20.0, 80.0, 50.0, 110.0, 80.0, 60.0, 10.0, 30.0, 79.0, 21.0, 80.0, 60.0, -18.0, 60.0, 90.0, 100.0, 93.0, 75.0, 16.0, 110.0, 50.0, 20.0, 9.0, 51.0, 0.0, 30.0, 110.0, 28.0, 76.0, 20.0, 24.0, 110.0, 23.0, 30.0, 130.0, 20.0, 16.0, 30.0, -3.0, 15.0, 50.0, 80.0, 100.0, 10.0, 70.0, -19.0, 20.0, 140.0, -19.0, 90.0, 10.0, 13.0, 40.0, 15.0, 62.0, 7.0, 60.0, 53.0, 40.0, -13.0, 50.0, 40.0, -2.0, 90.0, 50.0, 10.0, 90.0, 80.0, 20.0, 120.0, 50.0, 140.0, 50.0, 110.0, 100.0, 90.0, 30.0, 50.0, 50.0, 110.0, 50.0, 58.0, 70.0, 190.0, 40.0, 100.0, 98.0, 140.0, 45.0, 30.0, 80.0, 20.0, 70.0, 40.0, 50.0, 50.0, 19.0, 60.0, 90.0, 60.0, 80.0, 70.0, 60.0, 100.0, 9.0, 35.0, 20.0, 120.0, 140.0, 80.0, 80.0, 100.0, 50.0, 100.0, 27.0, 27.0, 70.0, 17.0, 110.0, 40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5181964055519162, "mean_inference_ms": 1.5166410269037016, "mean_action_processing_ms": 0.48187602110649264, "mean_env_wait_ms": 1.3275374903446469, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014601707458496094, "StateBufferConnector_ms": 0.009733200073242188, "ViewRequirementAgentConnector_ms": 0.3880462646484375}, "num_episodes": 18, "episode_return_max": 1133.0, "episode_return_min": 55.0, "episode_return_mean": 654.37}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.40743513280727, "num_env_steps_trained_throughput_per_sec": 21.40743513280727, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 185336.611, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185336.562, "sample_time_ms": 2443.499, "learn_time_ms": 182872.637, "learn_throughput": 21.873, "synch_weights_time_ms": 11.885}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "a22d3_00000", "date": "2024-08-06_06-15-10", "timestamp": 1722939310, "time_this_iter_s": 186.85904002189636, "time_total_s": 27101.07159304619, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a179ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27101.07159304619, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 20.675000000000004, "ram_util_percent": 74.64318181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0383596442377985, "cur_kl_coeff": 1.9483926152810451, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.998814756192338, "policy_loss": -0.008694840664975344, "vf_loss": 7.003652398248577, "vf_explained_var": 0.01108306780917703, "kl": 0.001979685426840612, "entropy": 0.5095682435142347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 1133.0, "episode_reward_min": 204.0, "episode_reward_mean": 666.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -64.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 66.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [651.0, 867.0, 549.0, 830.0, 222.0, 845.0, 830.0, 758.0, 729.0, 566.0, 663.0, 390.0, 759.0, 798.0, 1015.0, 759.0, 680.0, 637.0, 435.0, 449.0, 730.0, 650.0, 649.0, 737.0, 525.0, 852.0, 543.0, 850.0, 511.0, 500.0, 1133.0, 540.0, 533.0, 644.0, 685.0, 625.0, 675.0, 513.0, 690.0, 300.0, 204.0, 885.0, 907.0, 707.0, 750.0, 665.0, 750.0, 448.0, 677.0, 616.0, 706.0, 609.0, 293.0, 1070.0, 815.0, 678.0, 675.0, 681.0, 970.0, 852.0, 970.0, 1040.0, 553.0, 530.0, 846.0, 793.0, 835.0, 597.0, 698.0, 566.0, 577.0, 484.0, 400.0, 447.0, 390.0, 415.0, 790.0, 901.0, 509.0, 694.0, 661.0, 570.0, 901.0, 450.0, 449.0, 289.0, 890.0, 428.0, 588.0, 693.0, 810.0, 816.0, 760.0, 668.0, 563.0, 577.0, 757.0, 1039.0, 664.0, 757.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [94.0, 20.0, 140.0, 80.0, 25.0, 50.0, 60.0, 50.0, 22.0, 110.0, 56.0, 100.0, 50.0, 110.0, 130.0, 40.0, 200.0, 76.0, 55.0, 50.0, 40.0, 10.0, 50.0, 60.0, 30.0, 110.0, 80.0, 30.0, 70.0, 69.0, 110.0, 50.0, 50.0, 100.0, 120.0, 140.0, 60.0, 60.0, 0.0, 140.0, 30.0, -64.0, -13.0, 20.0, -4.0, 36.0, 29.0, 50.0, 100.0, 38.0, 140.0, 90.0, 80.0, 90.0, 88.0, 130.0, 47.0, -30.0, 160.0, 50.0, 70.0, 130.0, 80.0, 80.0, 70.0, 60.0, 140.0, 40.0, 110.0, 50.0, 118.0, 50.0, 60.0, 110.0, 10.0, 70.0, 80.0, 110.0, 120.0, 30.0, 30.0, 110.0, 110.0, 110.0, 40.0, 120.0, 29.0, 0.0, 130.0, 50.0, 20.0, 60.0, 31.0, 90.0, 20.0, 110.0, 5.0, 30.0, 100.0, 100.0, 60.0, 100.0, 50.0, 90.0, 60.0, 48.0, 60.0, 80.0, 35.0, 80.0, 20.0, 66.0, 70.0, 70.0, 39.0, 30.0, 50.0, 40.0, 8.0, -3.0, 88.0, 50.0, 90.0, 30.0, 100.0, 60.0, 80.0, 80.0, 135.0, 46.0, 160.0, 110.0, 60.0, 90.0, 60.0, 100.0, 68.0, 20.0, 60.0, 70.0, 140.0, 120.0, 100.0, 43.0, 170.0, 100.0, 90.0, 80.0, 32.0, 140.0, 90.0, 39.0, 70.0, 32.0, 12.0, 60.0, 70.0, 140.0, 136.0, 110.0, 110.0, 20.0, 50.0, 110.0, 0.0, 60.0, 80.0, 90.0, 120.0, 40.0, 90.0, 40.0, 41.0, 40.0, 50.0, 120.0, 70.0, 137.0, 40.0, 9.0, 30.0, 10.0, 40.0, 130.0, 80.0, 60.0, 60.0, -5.0, 30.0, 0.0, 0.0, 20.0, 50.0, 120.0, 12.0, 50.0, 45.0, 40.0, 40.0, 72.0, 70.0, 30.0, 30.0, 130.0, 30.0, 90.0, 90.0, 110.0, 50.0, 100.0, 50.0, 50.0, 30.0, 80.0, 70.0, 100.0, 50.0, 30.0, 100.0, 90.0, 140.0, 70.0, 70.0, 17.0, 40.0, 35.0, 90.0, 37.0, 50.0, 100.0, 37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0, 40.0, 10.0, 85.0, 17.0, 70.0, 50.0, 40.0, 97.0, 110.0, 6.0, 72.0, 69.0, 150.0, 70.0, 16.0, 45.0, 170.0, 50.0, 70.0, 140.0, 50.0, 30.0, 30.0, 6.0, 90.0, 60.0, 20.0, 160.0, 27.0, 70.0, 84.0, 110.0, 58.0, 120.0, 90.0, 75.0, 110.0, 60.0, 90.0, 53.0, 8.0, 31.0, 66.0, 80.0, 46.0, 96.0, 52.0, 12.0, 40.0, 80.0, 90.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 90.0, 30.0, 30.0, 150.0, 170.0, 120.0, 105.0, 101.0, 97.0, 120.0, 70.0, 110.0, 90.0, 110.0, 30.0, 30.0, 40.0, 40.0, 10.0, 70.0, 90.0, 40.0, 80.0, 58.0, 50.0, 29.0, 50.0, 100.0, 120.0, 17.0, 9.0, 30.0, 70.0, 5.0, 110.0, 110.0, 19.0, 20.0, 60.0, 60.0, 130.0, 80.0, 50.0, 50.0, 80.0, 80.0, 20.0, 110.0, 110.0, 90.0, 100.0, 70.0, -25.0, 70.0, 100.0, 66.0, 40.0, 70.0, 19.0, 60.0, 48.0, 137.0, 15.0, 40.0, 70.0, 67.0, 80.0, 80.0, 28.0, 90.0, 70.0, 40.0, 110.0, 140.0, 60.0, -37.0, 80.0, 56.0, 40.0, 45.0, 0.0, 90.0, 39.0, 100.0, 40.0, 100.0, 20.0, 10.0, 60.0, 80.0, 100.0, 70.0, 110.0, 20.0, 60.0, -14.0, -1.0, 10.0, 50.0, 0.0, 40.0, 50.0, 85.0, 0.0, 40.0, 0.0, 0.0, 26.0, 20.0, 38.0, 60.0, 0.0, 20.0, 50.0, 30.0, 140.0, 50.0, 100.0, 90.0, 90.0, 110.0, 110.0, 115.0, 80.0, 90.0, 140.0, 90.0, 48.0, 15.0, 74.0, 130.0, 80.0, 160.0, 70.0, 90.0, 40.0, 12.0, 70.0, -5.0, 90.0, 210.0, 70.0, 60.0, 60.0, 80.0, 40.0, 80.0, 140.0, 60.0, 40.0, 100.0, 80.0, 70.0, 20.0, 40.0, 130.0, 150.0, 70.0, 140.0, 18.0, 49.0, 10.0, 38.0, 60.0, 30.0, 80.0, 30.0, 100.0, 70.0, 150.0, 100.0, 30.0, 100.0, 60.0, 10.0, 120.0, 46.0, 50.0, -7.0, 40.0, 19.0, 70.0, 40.0, 41.0, 39.0, 110.0, 7.0, 90.0, 40.0, 110.0, 80.0, 90.0, 70.0, 60.0, 49.0, 40.0, 100.0, 80.0, 90.0, 20.0, 37.0, 80.0, 60.0, 86.0, 30.0, 10.0, 120.0, 60.0, 100.0, 50.0, 70.0, 50.0, 130.0, 140.0, 76.0, -9.0, 14.0, 70.0, 14.0, 90.0, 50.0, 160.0, 4.0, 28.0, 60.0, 10.0, 10.0, 20.0, 38.0, -13.0, 80.0, 30.0, 30.0, 80.0, 90.0, 100.0, 100.0, 120.0, 130.0, 100.0, 170.0, 80.0, 100.0, 90.0, 80.0, 50.0, 80.0, 150.0, 130.0, 5.0, 100.0, 70.0, 60.0, 2.0, -54.0, 60.0, 50.0, 90.0, 100.0, 140.0, 60.0, 120.0, 110.0, 30.0, 100.0, 70.0, 100.0, 90.0, 50.0, 45.0, 50.0, 40.0, 100.0, 60.0, 53.0, 70.0, 160.0, 60.0, 30.0, 110.0, 25.0, 90.0, 23.0, 80.0, 150.0, 0.0, 90.0, 140.0, 100.0, 90.0, 110.0, 90.0, 120.0, 59.0, 70.0, 60.0, 130.0, 120.0, 110.0, 90.0, 23.0, 100.0, 90.0, 70.0, 120.0, 70.0, 80.0, 110.0, 90.0, 90.0, 100.0, 60.0, 180.0, 140.0, 60.0, 140.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 100.0, 70.0, 70.0, 190.0, 25.0, -4.0, 23.0, 60.0, -11.0, 70.0, 60.0, 40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0, 80.0, 60.0, 60.0, 100.0, 120.0, 140.0, 60.0, 110.0, 16.0, 100.0, 60.0, 70.0, 70.0, 130.0, 70.0, 140.0, 89.0, 20.0, 44.0, 100.0, 70.0, 160.0, 66.0, 130.0, 50.0, 100.0, 69.0, 60.0, 70.0, 60.0, 60.0, 24.0, 59.0, 20.0, 60.0, 90.0, 25.0, 109.0, 130.0, 20.0, 90.0, 80.0, 74.0, 20.0, 60.0, 34.0, 50.0, 120.0, 50.0, 120.0, 47.0, 20.0, 80.0, 50.0, 110.0, 80.0, 60.0, 10.0, 30.0, 79.0, 21.0, 80.0, 60.0, -18.0, 60.0, 90.0, 100.0, 93.0, 75.0, 16.0, 110.0, 50.0, 20.0, 9.0, 51.0, 0.0, 30.0, 110.0, 28.0, 76.0, 20.0, 24.0, 110.0, 23.0, 30.0, 130.0, 20.0, 16.0, 30.0, -3.0, 15.0, 50.0, 80.0, 100.0, 10.0, 70.0, -19.0, 20.0, 140.0, -19.0, 90.0, 10.0, 13.0, 40.0, 15.0, 62.0, 7.0, 60.0, 53.0, 40.0, -13.0, 50.0, 40.0, -2.0, 90.0, 50.0, 10.0, 90.0, 80.0, 20.0, 120.0, 50.0, 140.0, 50.0, 110.0, 100.0, 90.0, 30.0, 50.0, 50.0, 110.0, 50.0, 58.0, 70.0, 190.0, 40.0, 100.0, 98.0, 140.0, 45.0, 30.0, 80.0, 20.0, 70.0, 40.0, 50.0, 50.0, 19.0, 60.0, 90.0, 60.0, 80.0, 70.0, 60.0, 100.0, 9.0, 35.0, 20.0, 120.0, 140.0, 80.0, 80.0, 100.0, 50.0, 100.0, 27.0, 27.0, 70.0, 17.0, 110.0, 40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0, 20.0, 160.0, 120.0, 50.0, 120.0, 35.0, 100.0, 36.0, 190.0, 70.0, 10.0, 50.0, 50.0, 60.0, 20.0, 60.0, 10.0, 40.0, 10.0, 140.0, 10.0, 40.0, 140.0, 60.0, 10.0, 39.0, 60.0, 40.0, 30.0, 20.0, 20.0, 50.0, -21.0, 60.0, 0.0, 130.0, 20.0, 40.0, -10.0, 0.0, 100.0, 120.0, 60.0, 120.0, 80.0, 50.0, 30.0, 120.0, 90.0, 120.0, 60.0, 40.0, 60.0, 50.0, 18.0, 30.0, 20.0, 60.0, 60.0, 30.0, 90.0, 40.0, 50.0, 30.0, 50.0, 90.0, 90.0, 40.0, 28.0, 80.0, 0.0, 130.0, 19.0, 62.0, 26.0, 50.0, 150.0, 26.0, 140.0, 90.0, 60.0, 80.0, 80.0, 110.0, 80.0, 70.0, 80.0, 120.0, 60.0, 70.0, 5.0, 60.0, 120.0, 110.0, 170.0, 80.0, 44.0, 57.0, 100.0, 70.0, 70.0, 120.0, 30.0, 70.0, 110.0, 90.0, 60.0, 70.0, 90.0, 50.0, 50.0, 60.0, 50.0, 35.0, 110.0, 85.0, 40.0, 80.0, 68.0, 90.0, 47.0, 22.0, 20.0, 4.0, 60.0, 110.0, 70.0, 100.0, 50.0, 80.0, 20.0, 40.0, 60.0, 18.0, -4.0, 220.0, -27.0, 40.0, 120.0, 90.0, 90.0, 190.0, 20.0, 60.0, 130.0, 29.0, 75.0, 42.0, 81.0, 40.0, 110.0, 60.0, 50.0, 130.0, 100.0, 109.0, 100.0, 120.0, 200.0, 60.0, 24.0, 100.0, 90.0, 80.0, 120.0, 26.0, 30.0, 14.0, 50.0, 130.0, 40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5177124718579011, "mean_inference_ms": 1.5158249944066575, "mean_action_processing_ms": 0.4823149603782328, "mean_env_wait_ms": 1.3268949072381517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014752864837646484, "StateBufferConnector_ms": 0.009861946105957031, "ViewRequirementAgentConnector_ms": 0.38944244384765625}, "num_episodes": 18, "episode_return_max": 1133.0, "episode_return_min": 204.0, "episode_return_mean": 666.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.653593078594557, "num_env_steps_trained_throughput_per_sec": 21.653593078594557, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 185282.877, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185282.828, "sample_time_ms": 2453.701, "learn_time_ms": 182808.653, "learn_throughput": 21.881, "synch_weights_time_ms": 11.753}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "a22d3_00000", "date": "2024-08-06_06-18-15", "timestamp": 1722939495, "time_this_iter_s": 184.73496103286743, "time_total_s": 27285.806554079056, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a16c49d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27285.806554079056, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 18.332183908045977, "ram_util_percent": 76.01954022988505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.00215380431745, "cur_kl_coeff": 0.9741963076405226, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009856934106290832, "vf_loss": 6.64563975755653, "vf_explained_var": 0.008669588106254927, "kl": Infinity, "entropy": 0.527129526415699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 1133.0, "episode_reward_min": 204.0, "episode_reward_mean": 661.92, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -54.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 66.192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [737.0, 525.0, 852.0, 543.0, 850.0, 511.0, 500.0, 1133.0, 540.0, 533.0, 644.0, 685.0, 625.0, 675.0, 513.0, 690.0, 300.0, 204.0, 885.0, 907.0, 707.0, 750.0, 665.0, 750.0, 448.0, 677.0, 616.0, 706.0, 609.0, 293.0, 1070.0, 815.0, 678.0, 675.0, 681.0, 970.0, 852.0, 970.0, 1040.0, 553.0, 530.0, 846.0, 793.0, 835.0, 597.0, 698.0, 566.0, 577.0, 484.0, 400.0, 447.0, 390.0, 415.0, 790.0, 901.0, 509.0, 694.0, 661.0, 570.0, 901.0, 450.0, 449.0, 289.0, 890.0, 428.0, 588.0, 693.0, 810.0, 816.0, 760.0, 668.0, 563.0, 577.0, 757.0, 1039.0, 664.0, 757.0, 496.0, 208.0, 949.0, 863.0, 920.0, 780.0, 905.0, 670.0, 660.0, 670.0, 447.0, 404.0, 694.0, 756.0, 626.0, 677.0, 623.0, 425.0, 656.0, 318.0, 800.0, 566.0, 900.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [37.0, 120.0, 30.0, 110.0, 68.0, 90.0, 59.0, 40.0, 83.0, 100.0, 40.0, 10.0, 85.0, 17.0, 70.0, 50.0, 40.0, 97.0, 110.0, 6.0, 72.0, 69.0, 150.0, 70.0, 16.0, 45.0, 170.0, 50.0, 70.0, 140.0, 50.0, 30.0, 30.0, 6.0, 90.0, 60.0, 20.0, 160.0, 27.0, 70.0, 84.0, 110.0, 58.0, 120.0, 90.0, 75.0, 110.0, 60.0, 90.0, 53.0, 8.0, 31.0, 66.0, 80.0, 46.0, 96.0, 52.0, 12.0, 40.0, 80.0, 90.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 90.0, 30.0, 30.0, 150.0, 170.0, 120.0, 105.0, 101.0, 97.0, 120.0, 70.0, 110.0, 90.0, 110.0, 30.0, 30.0, 40.0, 40.0, 10.0, 70.0, 90.0, 40.0, 80.0, 58.0, 50.0, 29.0, 50.0, 100.0, 120.0, 17.0, 9.0, 30.0, 70.0, 5.0, 110.0, 110.0, 19.0, 20.0, 60.0, 60.0, 130.0, 80.0, 50.0, 50.0, 80.0, 80.0, 20.0, 110.0, 110.0, 90.0, 100.0, 70.0, -25.0, 70.0, 100.0, 66.0, 40.0, 70.0, 19.0, 60.0, 48.0, 137.0, 15.0, 40.0, 70.0, 67.0, 80.0, 80.0, 28.0, 90.0, 70.0, 40.0, 110.0, 140.0, 60.0, -37.0, 80.0, 56.0, 40.0, 45.0, 0.0, 90.0, 39.0, 100.0, 40.0, 100.0, 20.0, 10.0, 60.0, 80.0, 100.0, 70.0, 110.0, 20.0, 60.0, -14.0, -1.0, 10.0, 50.0, 0.0, 40.0, 50.0, 85.0, 0.0, 40.0, 0.0, 0.0, 26.0, 20.0, 38.0, 60.0, 0.0, 20.0, 50.0, 30.0, 140.0, 50.0, 100.0, 90.0, 90.0, 110.0, 110.0, 115.0, 80.0, 90.0, 140.0, 90.0, 48.0, 15.0, 74.0, 130.0, 80.0, 160.0, 70.0, 90.0, 40.0, 12.0, 70.0, -5.0, 90.0, 210.0, 70.0, 60.0, 60.0, 80.0, 40.0, 80.0, 140.0, 60.0, 40.0, 100.0, 80.0, 70.0, 20.0, 40.0, 130.0, 150.0, 70.0, 140.0, 18.0, 49.0, 10.0, 38.0, 60.0, 30.0, 80.0, 30.0, 100.0, 70.0, 150.0, 100.0, 30.0, 100.0, 60.0, 10.0, 120.0, 46.0, 50.0, -7.0, 40.0, 19.0, 70.0, 40.0, 41.0, 39.0, 110.0, 7.0, 90.0, 40.0, 110.0, 80.0, 90.0, 70.0, 60.0, 49.0, 40.0, 100.0, 80.0, 90.0, 20.0, 37.0, 80.0, 60.0, 86.0, 30.0, 10.0, 120.0, 60.0, 100.0, 50.0, 70.0, 50.0, 130.0, 140.0, 76.0, -9.0, 14.0, 70.0, 14.0, 90.0, 50.0, 160.0, 4.0, 28.0, 60.0, 10.0, 10.0, 20.0, 38.0, -13.0, 80.0, 30.0, 30.0, 80.0, 90.0, 100.0, 100.0, 120.0, 130.0, 100.0, 170.0, 80.0, 100.0, 90.0, 80.0, 50.0, 80.0, 150.0, 130.0, 5.0, 100.0, 70.0, 60.0, 2.0, -54.0, 60.0, 50.0, 90.0, 100.0, 140.0, 60.0, 120.0, 110.0, 30.0, 100.0, 70.0, 100.0, 90.0, 50.0, 45.0, 50.0, 40.0, 100.0, 60.0, 53.0, 70.0, 160.0, 60.0, 30.0, 110.0, 25.0, 90.0, 23.0, 80.0, 150.0, 0.0, 90.0, 140.0, 100.0, 90.0, 110.0, 90.0, 120.0, 59.0, 70.0, 60.0, 130.0, 120.0, 110.0, 90.0, 23.0, 100.0, 90.0, 70.0, 120.0, 70.0, 80.0, 110.0, 90.0, 90.0, 100.0, 60.0, 180.0, 140.0, 60.0, 140.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 100.0, 70.0, 70.0, 190.0, 25.0, -4.0, 23.0, 60.0, -11.0, 70.0, 60.0, 40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0, 80.0, 60.0, 60.0, 100.0, 120.0, 140.0, 60.0, 110.0, 16.0, 100.0, 60.0, 70.0, 70.0, 130.0, 70.0, 140.0, 89.0, 20.0, 44.0, 100.0, 70.0, 160.0, 66.0, 130.0, 50.0, 100.0, 69.0, 60.0, 70.0, 60.0, 60.0, 24.0, 59.0, 20.0, 60.0, 90.0, 25.0, 109.0, 130.0, 20.0, 90.0, 80.0, 74.0, 20.0, 60.0, 34.0, 50.0, 120.0, 50.0, 120.0, 47.0, 20.0, 80.0, 50.0, 110.0, 80.0, 60.0, 10.0, 30.0, 79.0, 21.0, 80.0, 60.0, -18.0, 60.0, 90.0, 100.0, 93.0, 75.0, 16.0, 110.0, 50.0, 20.0, 9.0, 51.0, 0.0, 30.0, 110.0, 28.0, 76.0, 20.0, 24.0, 110.0, 23.0, 30.0, 130.0, 20.0, 16.0, 30.0, -3.0, 15.0, 50.0, 80.0, 100.0, 10.0, 70.0, -19.0, 20.0, 140.0, -19.0, 90.0, 10.0, 13.0, 40.0, 15.0, 62.0, 7.0, 60.0, 53.0, 40.0, -13.0, 50.0, 40.0, -2.0, 90.0, 50.0, 10.0, 90.0, 80.0, 20.0, 120.0, 50.0, 140.0, 50.0, 110.0, 100.0, 90.0, 30.0, 50.0, 50.0, 110.0, 50.0, 58.0, 70.0, 190.0, 40.0, 100.0, 98.0, 140.0, 45.0, 30.0, 80.0, 20.0, 70.0, 40.0, 50.0, 50.0, 19.0, 60.0, 90.0, 60.0, 80.0, 70.0, 60.0, 100.0, 9.0, 35.0, 20.0, 120.0, 140.0, 80.0, 80.0, 100.0, 50.0, 100.0, 27.0, 27.0, 70.0, 17.0, 110.0, 40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0, 20.0, 160.0, 120.0, 50.0, 120.0, 35.0, 100.0, 36.0, 190.0, 70.0, 10.0, 50.0, 50.0, 60.0, 20.0, 60.0, 10.0, 40.0, 10.0, 140.0, 10.0, 40.0, 140.0, 60.0, 10.0, 39.0, 60.0, 40.0, 30.0, 20.0, 20.0, 50.0, -21.0, 60.0, 0.0, 130.0, 20.0, 40.0, -10.0, 0.0, 100.0, 120.0, 60.0, 120.0, 80.0, 50.0, 30.0, 120.0, 90.0, 120.0, 60.0, 40.0, 60.0, 50.0, 18.0, 30.0, 20.0, 60.0, 60.0, 30.0, 90.0, 40.0, 50.0, 30.0, 50.0, 90.0, 90.0, 40.0, 28.0, 80.0, 0.0, 130.0, 19.0, 62.0, 26.0, 50.0, 150.0, 26.0, 140.0, 90.0, 60.0, 80.0, 80.0, 110.0, 80.0, 70.0, 80.0, 120.0, 60.0, 70.0, 5.0, 60.0, 120.0, 110.0, 170.0, 80.0, 44.0, 57.0, 100.0, 70.0, 70.0, 120.0, 30.0, 70.0, 110.0, 90.0, 60.0, 70.0, 90.0, 50.0, 50.0, 60.0, 50.0, 35.0, 110.0, 85.0, 40.0, 80.0, 68.0, 90.0, 47.0, 22.0, 20.0, 4.0, 60.0, 110.0, 70.0, 100.0, 50.0, 80.0, 20.0, 40.0, 60.0, 18.0, -4.0, 220.0, -27.0, 40.0, 120.0, 90.0, 90.0, 190.0, 20.0, 60.0, 130.0, 29.0, 75.0, 42.0, 81.0, 40.0, 110.0, 60.0, 50.0, 130.0, 100.0, 109.0, 100.0, 120.0, 200.0, 60.0, 24.0, 100.0, 90.0, 80.0, 120.0, 26.0, 30.0, 14.0, 50.0, 130.0, 40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0, 34.0, 90.0, -5.0, 42.0, 30.0, 50.0, 150.0, 60.0, 11.0, 34.0, 20.0, -23.0, 0.0, 10.0, 60.0, 20.0, -48.0, 110.0, 9.0, 50.0, 100.0, 90.0, 80.0, 50.0, 110.0, 110.0, 129.0, 120.0, 40.0, 120.0, 100.0, 86.0, 76.0, 100.0, 45.0, 100.0, 80.0, 160.0, 90.0, 26.0, 70.0, 160.0, 110.0, 120.0, 20.0, 50.0, 60.0, 110.0, 160.0, 60.0, 50.0, 40.0, 60.0, 140.0, 40.0, 60.0, 100.0, 110.0, 90.0, 90.0, 30.0, 90.0, 130.0, 100.0, 70.0, 90.0, 100.0, 70.0, 110.0, 115.0, 10.0, 130.0, 60.0, 30.0, 170.0, 10.0, 80.0, 40.0, 90.0, 50.0, 80.0, 50.0, 40.0, 60.0, 150.0, 80.0, 70.0, 30.0, 40.0, 60.0, 40.0, 100.0, 130.0, 50.0, 40.0, 40.0, 20.0, 100.0, 130.0, 20.0, 30.0, 60.0, 70.0, 70.0, 32.0, 40.0, 15.0, 30.0, 50.0, 50.0, 130.0, 10.0, 10.0, 39.0, 67.0, 60.0, 30.0, 30.0, -2.0, 30.0, 120.0, 70.0, 110.0, 100.0, 50.0, 100.0, 70.0, 27.0, 7.0, 40.0, 26.0, 130.0, 27.0, 100.0, 140.0, 20.0, 79.0, 14.0, 110.0, 110.0, 70.0, 130.0, 80.0, 50.0, 60.0, 34.0, 120.0, -18.0, 40.0, 60.0, 80.0, 40.0, 94.0, 21.0, 90.0, 54.0, 40.0, 79.0, 79.0, 100.0, 30.0, 80.0, 70.0, 85.0, 110.0, 9.0, 69.0, 50.0, 90.0, 30.0, 51.0, 80.0, 60.0, 40.0, 26.0, 14.0, 70.0, 62.0, 29.0, -7.0, 130.0, 0.0, 110.0, 100.0, 100.0, 30.0, 0.0, 36.0, 90.0, 60.0, 20.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, -18.0, 190.0, 60.0, 100.0, 30.0, 110.0, 80.0, 50.0, 120.0, 60.0, 100.0, 90.0, 60.0, 140.0, 40.0, 50.0, 40.0, 60.0, 16.0, 80.0, 40.0, 40.0, 70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5169981945312505, "mean_inference_ms": 1.5149527907102125, "mean_action_processing_ms": 0.4829003177887921, "mean_env_wait_ms": 1.326110697587633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014586448669433594, "StateBufferConnector_ms": 0.011036396026611328, "ViewRequirementAgentConnector_ms": 0.38269567489624023}, "num_episodes": 23, "episode_return_max": 1133.0, "episode_return_min": 204.0, "episode_return_mean": 661.92}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.719938753487103, "num_env_steps_trained_throughput_per_sec": 21.719938753487103, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 185247.789, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185247.741, "sample_time_ms": 2432.086, "learn_time_ms": 182793.929, "learn_throughput": 21.883, "synch_weights_time_ms": 13.164}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "a22d3_00000", "date": "2024-08-06_06-21-19", "timestamp": 1722939679, "time_this_iter_s": 184.17391204833984, "time_total_s": 27469.980466127396, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22a6af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27469.980466127396, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 19.886973180076627, "ram_util_percent": 75.9888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.011236950916985, "cur_kl_coeff": 1.4612944614607846, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.537277995587918, "policy_loss": -0.009489041363946396, "vf_loss": 7.543042777724668, "vf_explained_var": 0.0013355464282762, "kl": 0.0025486071731946787, "entropy": 0.48546681092125665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 208.0, "episode_reward_mean": 676.62, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -54.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 67.662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [665.0, 750.0, 448.0, 677.0, 616.0, 706.0, 609.0, 293.0, 1070.0, 815.0, 678.0, 675.0, 681.0, 970.0, 852.0, 970.0, 1040.0, 553.0, 530.0, 846.0, 793.0, 835.0, 597.0, 698.0, 566.0, 577.0, 484.0, 400.0, 447.0, 390.0, 415.0, 790.0, 901.0, 509.0, 694.0, 661.0, 570.0, 901.0, 450.0, 449.0, 289.0, 890.0, 428.0, 588.0, 693.0, 810.0, 816.0, 760.0, 668.0, 563.0, 577.0, 757.0, 1039.0, 664.0, 757.0, 496.0, 208.0, 949.0, 863.0, 920.0, 780.0, 905.0, 670.0, 660.0, 670.0, 447.0, 404.0, 694.0, 756.0, 626.0, 677.0, 623.0, 425.0, 656.0, 318.0, 800.0, 566.0, 900.0, 628.0, 838.0, 1049.0, 609.0, 930.0, 805.0, 548.0, 842.0, 790.0, 630.0, 695.0, 296.0, 670.0, 670.0, 845.0, 792.0, 765.0, 830.0, 470.0, 707.0, 810.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 130.0, 150.0, 70.0, 140.0, 18.0, 49.0, 10.0, 38.0, 60.0, 30.0, 80.0, 30.0, 100.0, 70.0, 150.0, 100.0, 30.0, 100.0, 60.0, 10.0, 120.0, 46.0, 50.0, -7.0, 40.0, 19.0, 70.0, 40.0, 41.0, 39.0, 110.0, 7.0, 90.0, 40.0, 110.0, 80.0, 90.0, 70.0, 60.0, 49.0, 40.0, 100.0, 80.0, 90.0, 20.0, 37.0, 80.0, 60.0, 86.0, 30.0, 10.0, 120.0, 60.0, 100.0, 50.0, 70.0, 50.0, 130.0, 140.0, 76.0, -9.0, 14.0, 70.0, 14.0, 90.0, 50.0, 160.0, 4.0, 28.0, 60.0, 10.0, 10.0, 20.0, 38.0, -13.0, 80.0, 30.0, 30.0, 80.0, 90.0, 100.0, 100.0, 120.0, 130.0, 100.0, 170.0, 80.0, 100.0, 90.0, 80.0, 50.0, 80.0, 150.0, 130.0, 5.0, 100.0, 70.0, 60.0, 2.0, -54.0, 60.0, 50.0, 90.0, 100.0, 140.0, 60.0, 120.0, 110.0, 30.0, 100.0, 70.0, 100.0, 90.0, 50.0, 45.0, 50.0, 40.0, 100.0, 60.0, 53.0, 70.0, 160.0, 60.0, 30.0, 110.0, 25.0, 90.0, 23.0, 80.0, 150.0, 0.0, 90.0, 140.0, 100.0, 90.0, 110.0, 90.0, 120.0, 59.0, 70.0, 60.0, 130.0, 120.0, 110.0, 90.0, 23.0, 100.0, 90.0, 70.0, 120.0, 70.0, 80.0, 110.0, 90.0, 90.0, 100.0, 60.0, 180.0, 140.0, 60.0, 140.0, 120.0, 150.0, 90.0, 90.0, 60.0, 90.0, 100.0, 70.0, 70.0, 190.0, 25.0, -4.0, 23.0, 60.0, -11.0, 70.0, 60.0, 40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0, 80.0, 60.0, 60.0, 100.0, 120.0, 140.0, 60.0, 110.0, 16.0, 100.0, 60.0, 70.0, 70.0, 130.0, 70.0, 140.0, 89.0, 20.0, 44.0, 100.0, 70.0, 160.0, 66.0, 130.0, 50.0, 100.0, 69.0, 60.0, 70.0, 60.0, 60.0, 24.0, 59.0, 20.0, 60.0, 90.0, 25.0, 109.0, 130.0, 20.0, 90.0, 80.0, 74.0, 20.0, 60.0, 34.0, 50.0, 120.0, 50.0, 120.0, 47.0, 20.0, 80.0, 50.0, 110.0, 80.0, 60.0, 10.0, 30.0, 79.0, 21.0, 80.0, 60.0, -18.0, 60.0, 90.0, 100.0, 93.0, 75.0, 16.0, 110.0, 50.0, 20.0, 9.0, 51.0, 0.0, 30.0, 110.0, 28.0, 76.0, 20.0, 24.0, 110.0, 23.0, 30.0, 130.0, 20.0, 16.0, 30.0, -3.0, 15.0, 50.0, 80.0, 100.0, 10.0, 70.0, -19.0, 20.0, 140.0, -19.0, 90.0, 10.0, 13.0, 40.0, 15.0, 62.0, 7.0, 60.0, 53.0, 40.0, -13.0, 50.0, 40.0, -2.0, 90.0, 50.0, 10.0, 90.0, 80.0, 20.0, 120.0, 50.0, 140.0, 50.0, 110.0, 100.0, 90.0, 30.0, 50.0, 50.0, 110.0, 50.0, 58.0, 70.0, 190.0, 40.0, 100.0, 98.0, 140.0, 45.0, 30.0, 80.0, 20.0, 70.0, 40.0, 50.0, 50.0, 19.0, 60.0, 90.0, 60.0, 80.0, 70.0, 60.0, 100.0, 9.0, 35.0, 20.0, 120.0, 140.0, 80.0, 80.0, 100.0, 50.0, 100.0, 27.0, 27.0, 70.0, 17.0, 110.0, 40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0, 20.0, 160.0, 120.0, 50.0, 120.0, 35.0, 100.0, 36.0, 190.0, 70.0, 10.0, 50.0, 50.0, 60.0, 20.0, 60.0, 10.0, 40.0, 10.0, 140.0, 10.0, 40.0, 140.0, 60.0, 10.0, 39.0, 60.0, 40.0, 30.0, 20.0, 20.0, 50.0, -21.0, 60.0, 0.0, 130.0, 20.0, 40.0, -10.0, 0.0, 100.0, 120.0, 60.0, 120.0, 80.0, 50.0, 30.0, 120.0, 90.0, 120.0, 60.0, 40.0, 60.0, 50.0, 18.0, 30.0, 20.0, 60.0, 60.0, 30.0, 90.0, 40.0, 50.0, 30.0, 50.0, 90.0, 90.0, 40.0, 28.0, 80.0, 0.0, 130.0, 19.0, 62.0, 26.0, 50.0, 150.0, 26.0, 140.0, 90.0, 60.0, 80.0, 80.0, 110.0, 80.0, 70.0, 80.0, 120.0, 60.0, 70.0, 5.0, 60.0, 120.0, 110.0, 170.0, 80.0, 44.0, 57.0, 100.0, 70.0, 70.0, 120.0, 30.0, 70.0, 110.0, 90.0, 60.0, 70.0, 90.0, 50.0, 50.0, 60.0, 50.0, 35.0, 110.0, 85.0, 40.0, 80.0, 68.0, 90.0, 47.0, 22.0, 20.0, 4.0, 60.0, 110.0, 70.0, 100.0, 50.0, 80.0, 20.0, 40.0, 60.0, 18.0, -4.0, 220.0, -27.0, 40.0, 120.0, 90.0, 90.0, 190.0, 20.0, 60.0, 130.0, 29.0, 75.0, 42.0, 81.0, 40.0, 110.0, 60.0, 50.0, 130.0, 100.0, 109.0, 100.0, 120.0, 200.0, 60.0, 24.0, 100.0, 90.0, 80.0, 120.0, 26.0, 30.0, 14.0, 50.0, 130.0, 40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0, 34.0, 90.0, -5.0, 42.0, 30.0, 50.0, 150.0, 60.0, 11.0, 34.0, 20.0, -23.0, 0.0, 10.0, 60.0, 20.0, -48.0, 110.0, 9.0, 50.0, 100.0, 90.0, 80.0, 50.0, 110.0, 110.0, 129.0, 120.0, 40.0, 120.0, 100.0, 86.0, 76.0, 100.0, 45.0, 100.0, 80.0, 160.0, 90.0, 26.0, 70.0, 160.0, 110.0, 120.0, 20.0, 50.0, 60.0, 110.0, 160.0, 60.0, 50.0, 40.0, 60.0, 140.0, 40.0, 60.0, 100.0, 110.0, 90.0, 90.0, 30.0, 90.0, 130.0, 100.0, 70.0, 90.0, 100.0, 70.0, 110.0, 115.0, 10.0, 130.0, 60.0, 30.0, 170.0, 10.0, 80.0, 40.0, 90.0, 50.0, 80.0, 50.0, 40.0, 60.0, 150.0, 80.0, 70.0, 30.0, 40.0, 60.0, 40.0, 100.0, 130.0, 50.0, 40.0, 40.0, 20.0, 100.0, 130.0, 20.0, 30.0, 60.0, 70.0, 70.0, 32.0, 40.0, 15.0, 30.0, 50.0, 50.0, 130.0, 10.0, 10.0, 39.0, 67.0, 60.0, 30.0, 30.0, -2.0, 30.0, 120.0, 70.0, 110.0, 100.0, 50.0, 100.0, 70.0, 27.0, 7.0, 40.0, 26.0, 130.0, 27.0, 100.0, 140.0, 20.0, 79.0, 14.0, 110.0, 110.0, 70.0, 130.0, 80.0, 50.0, 60.0, 34.0, 120.0, -18.0, 40.0, 60.0, 80.0, 40.0, 94.0, 21.0, 90.0, 54.0, 40.0, 79.0, 79.0, 100.0, 30.0, 80.0, 70.0, 85.0, 110.0, 9.0, 69.0, 50.0, 90.0, 30.0, 51.0, 80.0, 60.0, 40.0, 26.0, 14.0, 70.0, 62.0, 29.0, -7.0, 130.0, 0.0, 110.0, 100.0, 100.0, 30.0, 0.0, 36.0, 90.0, 60.0, 20.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, -18.0, 190.0, 60.0, 100.0, 30.0, 110.0, 80.0, 50.0, 120.0, 60.0, 100.0, 90.0, 60.0, 140.0, 40.0, 50.0, 40.0, 60.0, 16.0, 80.0, 40.0, 40.0, 70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0, 26.0, 100.0, 25.0, 70.0, 120.0, 110.0, 40.0, 10.0, 17.0, 110.0, 50.0, 60.0, 80.0, 58.0, 80.0, 120.0, 110.0, 110.0, 90.0, 80.0, 130.0, 100.0, 100.0, 80.0, 49.0, 90.0, 160.0, 160.0, 100.0, 80.0, 45.0, 70.0, 110.0, 30.0, 20.0, 15.0, 130.0, 49.0, 90.0, 50.0, 100.0, 80.0, 40.0, 90.0, 110.0, 90.0, 90.0, 140.0, 80.0, 110.0, 50.0, 60.0, 110.0, 65.0, 50.0, 120.0, 90.0, 90.0, 110.0, 60.0, 1.0, 25.0, 60.0, 15.0, 60.0, 58.0, 120.0, 30.0, 39.0, 140.0, 60.0, 98.0, 110.0, 90.0, 39.0, 70.0, 90.0, 40.0, 115.0, 130.0, 110.0, 80.0, 51.0, 70.0, 50.0, 130.0, 9.0, 130.0, 60.0, 100.0, 100.0, 40.0, 70.0, 110.0, 60.0, 30.0, 70.0, 20.0, 50.0, 80.0, -7.0, 60.0, 42.0, 150.0, 90.0, 45.0, -15.0, 150.0, 110.0, 70.0, 16.0, 0.0, 30.0, 27.0, 50.0, 22.0, 50.0, 30.0, 21.0, 50.0, 110.0, 50.0, 60.0, 80.0, 80.0, 20.0, 60.0, 80.0, 60.0, 70.0, 60.0, 90.0, 40.0, 40.0, 120.0, 100.0, 20.0, 110.0, 10.0, 80.0, 80.0, 115.0, 70.0, 70.0, 50.0, 160.0, 60.0, 60.0, 60.0, 120.0, 116.0, 46.0, 80.0, 70.0, 70.0, 90.0, 100.0, 70.0, 100.0, 50.0, 40.0, 70.0, 110.0, 120.0, -15.0, 60.0, 170.0, 10.0, 90.0, 110.0, 60.0, 160.0, 80.0, 140.0, 50.0, 80.0, 70.0, 60.0, 40.0, 90.0, 50.0, 70.0, 60.0, 60.0, 40.0, -6.0, 20.0, 36.0, 70.0, 70.0, 70.0, 6.0, 60.0, 96.0, 70.0, 130.0, 20.0, 70.0, 45.0, 140.0, 70.0, 70.0, 50.0, 100.0, 90.0, 150.0, 140.0, 30.0, 60.0, 50.0, 80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.515252938707729, "mean_inference_ms": 1.513334708915093, "mean_action_processing_ms": 0.48341351227725454, "mean_env_wait_ms": 1.3255052527483733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014081716537475586, "StateBufferConnector_ms": 0.01088857650756836, "ViewRequirementAgentConnector_ms": 0.37363243103027344}, "num_episodes": 22, "episode_return_max": 1070.0, "episode_return_min": 208.0, "episode_return_mean": 676.62}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.632407657302316, "num_env_steps_trained_throughput_per_sec": 21.632407657302316, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 185222.449, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185222.4, "sample_time_ms": 2430.983, "learn_time_ms": 182769.493, "learn_throughput": 21.885, "synch_weights_time_ms": 13.364}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "a22d3_00000", "date": "2024-08-06_06-24-24", "timestamp": 1722939864, "time_this_iter_s": 184.92063188552856, "time_total_s": 27654.901098012924, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a22d20d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27654.901098012924, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 18.318390804597698, "ram_util_percent": 76.2168582375479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.152630683262381, "cur_kl_coeff": 0.7306472307303923, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.517779992005061, "policy_loss": -0.010732603336994847, "vf_loss": 7.525460630382339, "vf_explained_var": 0.00215305535557171, "kl": 0.004177061532920202, "entropy": 0.48108119545970607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 1049.0, "episode_reward_min": 208.0, "episode_reward_mean": 667.01, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 66.701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.0, 846.0, 793.0, 835.0, 597.0, 698.0, 566.0, 577.0, 484.0, 400.0, 447.0, 390.0, 415.0, 790.0, 901.0, 509.0, 694.0, 661.0, 570.0, 901.0, 450.0, 449.0, 289.0, 890.0, 428.0, 588.0, 693.0, 810.0, 816.0, 760.0, 668.0, 563.0, 577.0, 757.0, 1039.0, 664.0, 757.0, 496.0, 208.0, 949.0, 863.0, 920.0, 780.0, 905.0, 670.0, 660.0, 670.0, 447.0, 404.0, 694.0, 756.0, 626.0, 677.0, 623.0, 425.0, 656.0, 318.0, 800.0, 566.0, 900.0, 628.0, 838.0, 1049.0, 609.0, 930.0, 805.0, 548.0, 842.0, 790.0, 630.0, 695.0, 296.0, 670.0, 670.0, 845.0, 792.0, 765.0, 830.0, 470.0, 707.0, 810.0, 560.0, 615.0, 717.0, 1010.0, 760.0, 600.0, 682.0, 615.0, 390.0, 837.0, 610.0, 773.0, 649.0, 740.0, 990.0, 430.0, 625.0, 540.0, 524.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 110.0, 50.0, 30.0, 70.0, 0.0, 60.0, 40.0, 130.0, 0.0, 80.0, 60.0, 60.0, 100.0, 120.0, 140.0, 60.0, 110.0, 16.0, 100.0, 60.0, 70.0, 70.0, 130.0, 70.0, 140.0, 89.0, 20.0, 44.0, 100.0, 70.0, 160.0, 66.0, 130.0, 50.0, 100.0, 69.0, 60.0, 70.0, 60.0, 60.0, 24.0, 59.0, 20.0, 60.0, 90.0, 25.0, 109.0, 130.0, 20.0, 90.0, 80.0, 74.0, 20.0, 60.0, 34.0, 50.0, 120.0, 50.0, 120.0, 47.0, 20.0, 80.0, 50.0, 110.0, 80.0, 60.0, 10.0, 30.0, 79.0, 21.0, 80.0, 60.0, -18.0, 60.0, 90.0, 100.0, 93.0, 75.0, 16.0, 110.0, 50.0, 20.0, 9.0, 51.0, 0.0, 30.0, 110.0, 28.0, 76.0, 20.0, 24.0, 110.0, 23.0, 30.0, 130.0, 20.0, 16.0, 30.0, -3.0, 15.0, 50.0, 80.0, 100.0, 10.0, 70.0, -19.0, 20.0, 140.0, -19.0, 90.0, 10.0, 13.0, 40.0, 15.0, 62.0, 7.0, 60.0, 53.0, 40.0, -13.0, 50.0, 40.0, -2.0, 90.0, 50.0, 10.0, 90.0, 80.0, 20.0, 120.0, 50.0, 140.0, 50.0, 110.0, 100.0, 90.0, 30.0, 50.0, 50.0, 110.0, 50.0, 58.0, 70.0, 190.0, 40.0, 100.0, 98.0, 140.0, 45.0, 30.0, 80.0, 20.0, 70.0, 40.0, 50.0, 50.0, 19.0, 60.0, 90.0, 60.0, 80.0, 70.0, 60.0, 100.0, 9.0, 35.0, 20.0, 120.0, 140.0, 80.0, 80.0, 100.0, 50.0, 100.0, 27.0, 27.0, 70.0, 17.0, 110.0, 40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0, 20.0, 160.0, 120.0, 50.0, 120.0, 35.0, 100.0, 36.0, 190.0, 70.0, 10.0, 50.0, 50.0, 60.0, 20.0, 60.0, 10.0, 40.0, 10.0, 140.0, 10.0, 40.0, 140.0, 60.0, 10.0, 39.0, 60.0, 40.0, 30.0, 20.0, 20.0, 50.0, -21.0, 60.0, 0.0, 130.0, 20.0, 40.0, -10.0, 0.0, 100.0, 120.0, 60.0, 120.0, 80.0, 50.0, 30.0, 120.0, 90.0, 120.0, 60.0, 40.0, 60.0, 50.0, 18.0, 30.0, 20.0, 60.0, 60.0, 30.0, 90.0, 40.0, 50.0, 30.0, 50.0, 90.0, 90.0, 40.0, 28.0, 80.0, 0.0, 130.0, 19.0, 62.0, 26.0, 50.0, 150.0, 26.0, 140.0, 90.0, 60.0, 80.0, 80.0, 110.0, 80.0, 70.0, 80.0, 120.0, 60.0, 70.0, 5.0, 60.0, 120.0, 110.0, 170.0, 80.0, 44.0, 57.0, 100.0, 70.0, 70.0, 120.0, 30.0, 70.0, 110.0, 90.0, 60.0, 70.0, 90.0, 50.0, 50.0, 60.0, 50.0, 35.0, 110.0, 85.0, 40.0, 80.0, 68.0, 90.0, 47.0, 22.0, 20.0, 4.0, 60.0, 110.0, 70.0, 100.0, 50.0, 80.0, 20.0, 40.0, 60.0, 18.0, -4.0, 220.0, -27.0, 40.0, 120.0, 90.0, 90.0, 190.0, 20.0, 60.0, 130.0, 29.0, 75.0, 42.0, 81.0, 40.0, 110.0, 60.0, 50.0, 130.0, 100.0, 109.0, 100.0, 120.0, 200.0, 60.0, 24.0, 100.0, 90.0, 80.0, 120.0, 26.0, 30.0, 14.0, 50.0, 130.0, 40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0, 34.0, 90.0, -5.0, 42.0, 30.0, 50.0, 150.0, 60.0, 11.0, 34.0, 20.0, -23.0, 0.0, 10.0, 60.0, 20.0, -48.0, 110.0, 9.0, 50.0, 100.0, 90.0, 80.0, 50.0, 110.0, 110.0, 129.0, 120.0, 40.0, 120.0, 100.0, 86.0, 76.0, 100.0, 45.0, 100.0, 80.0, 160.0, 90.0, 26.0, 70.0, 160.0, 110.0, 120.0, 20.0, 50.0, 60.0, 110.0, 160.0, 60.0, 50.0, 40.0, 60.0, 140.0, 40.0, 60.0, 100.0, 110.0, 90.0, 90.0, 30.0, 90.0, 130.0, 100.0, 70.0, 90.0, 100.0, 70.0, 110.0, 115.0, 10.0, 130.0, 60.0, 30.0, 170.0, 10.0, 80.0, 40.0, 90.0, 50.0, 80.0, 50.0, 40.0, 60.0, 150.0, 80.0, 70.0, 30.0, 40.0, 60.0, 40.0, 100.0, 130.0, 50.0, 40.0, 40.0, 20.0, 100.0, 130.0, 20.0, 30.0, 60.0, 70.0, 70.0, 32.0, 40.0, 15.0, 30.0, 50.0, 50.0, 130.0, 10.0, 10.0, 39.0, 67.0, 60.0, 30.0, 30.0, -2.0, 30.0, 120.0, 70.0, 110.0, 100.0, 50.0, 100.0, 70.0, 27.0, 7.0, 40.0, 26.0, 130.0, 27.0, 100.0, 140.0, 20.0, 79.0, 14.0, 110.0, 110.0, 70.0, 130.0, 80.0, 50.0, 60.0, 34.0, 120.0, -18.0, 40.0, 60.0, 80.0, 40.0, 94.0, 21.0, 90.0, 54.0, 40.0, 79.0, 79.0, 100.0, 30.0, 80.0, 70.0, 85.0, 110.0, 9.0, 69.0, 50.0, 90.0, 30.0, 51.0, 80.0, 60.0, 40.0, 26.0, 14.0, 70.0, 62.0, 29.0, -7.0, 130.0, 0.0, 110.0, 100.0, 100.0, 30.0, 0.0, 36.0, 90.0, 60.0, 20.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, -18.0, 190.0, 60.0, 100.0, 30.0, 110.0, 80.0, 50.0, 120.0, 60.0, 100.0, 90.0, 60.0, 140.0, 40.0, 50.0, 40.0, 60.0, 16.0, 80.0, 40.0, 40.0, 70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0, 26.0, 100.0, 25.0, 70.0, 120.0, 110.0, 40.0, 10.0, 17.0, 110.0, 50.0, 60.0, 80.0, 58.0, 80.0, 120.0, 110.0, 110.0, 90.0, 80.0, 130.0, 100.0, 100.0, 80.0, 49.0, 90.0, 160.0, 160.0, 100.0, 80.0, 45.0, 70.0, 110.0, 30.0, 20.0, 15.0, 130.0, 49.0, 90.0, 50.0, 100.0, 80.0, 40.0, 90.0, 110.0, 90.0, 90.0, 140.0, 80.0, 110.0, 50.0, 60.0, 110.0, 65.0, 50.0, 120.0, 90.0, 90.0, 110.0, 60.0, 1.0, 25.0, 60.0, 15.0, 60.0, 58.0, 120.0, 30.0, 39.0, 140.0, 60.0, 98.0, 110.0, 90.0, 39.0, 70.0, 90.0, 40.0, 115.0, 130.0, 110.0, 80.0, 51.0, 70.0, 50.0, 130.0, 9.0, 130.0, 60.0, 100.0, 100.0, 40.0, 70.0, 110.0, 60.0, 30.0, 70.0, 20.0, 50.0, 80.0, -7.0, 60.0, 42.0, 150.0, 90.0, 45.0, -15.0, 150.0, 110.0, 70.0, 16.0, 0.0, 30.0, 27.0, 50.0, 22.0, 50.0, 30.0, 21.0, 50.0, 110.0, 50.0, 60.0, 80.0, 80.0, 20.0, 60.0, 80.0, 60.0, 70.0, 60.0, 90.0, 40.0, 40.0, 120.0, 100.0, 20.0, 110.0, 10.0, 80.0, 80.0, 115.0, 70.0, 70.0, 50.0, 160.0, 60.0, 60.0, 60.0, 120.0, 116.0, 46.0, 80.0, 70.0, 70.0, 90.0, 100.0, 70.0, 100.0, 50.0, 40.0, 70.0, 110.0, 120.0, -15.0, 60.0, 170.0, 10.0, 90.0, 110.0, 60.0, 160.0, 80.0, 140.0, 50.0, 80.0, 70.0, 60.0, 40.0, 90.0, 50.0, 70.0, 60.0, 60.0, 40.0, -6.0, 20.0, 36.0, 70.0, 70.0, 70.0, 6.0, 60.0, 96.0, 70.0, 130.0, 20.0, 70.0, 45.0, 140.0, 70.0, 70.0, 50.0, 100.0, 90.0, 150.0, 140.0, 30.0, 60.0, 50.0, 80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0, 60.0, 80.0, 50.0, 80.0, 50.0, 120.0, 10.0, 15.0, 100.0, 50.0, -17.0, 140.0, 70.0, 70.0, 107.0, 53.0, 94.0, 40.0, 80.0, 80.0, 80.0, 80.0, 100.0, 70.0, 110.0, 110.0, 70.0, 160.0, 140.0, 90.0, 70.0, 110.0, 60.0, 110.0, 80.0, 100.0, 60.0, 40.0, 70.0, 60.0, 70.0, 90.0, 19.0, 61.0, 138.0, 30.0, 30.0, 90.0, 22.0, 50.0, 50.0, 150.0, 70.0, 90.0, 50.0, 50.0, 31.0, 110.0, 41.0, 40.0, 70.0, 30.0, 30.0, 15.0, 100.0, 30.0, 60.0, 50.0, 170.0, 60.0, 70.0, 90.0, -85.0, 36.0, 20.0, 100.0, 70.0, 80.0, 30.0, -21.0, 70.0, 10.0, 70.0, 115.0, 110.0, 146.0, 68.0, 110.0, 110.0, 28.0, 110.0, 80.0, 40.0, 20.0, 50.0, 70.0, 30.0, 110.0, 30.0, 70.0, 82.0, 80.0, 60.0, 40.0, 52.0, 60.0, 65.0, 80.0, 114.0, 140.0, 20.0, 70.0, 20.0, 30.0, 60.0, 39.0, 40.0, 190.0, 20.0, 160.0, 40.0, 100.0, 100.0, 80.0, 50.0, 90.0, 50.0, 100.0, 50.0, 80.0, 60.0, 80.0, 100.0, 120.0, 120.0, 70.0, 80.0, 120.0, 100.0, 140.0, 50.0, 40.0, 30.0, 50.0, 80.0, 60.0, 40.0, 30.0, 20.0, 30.0, 40.0, 90.0, 30.0, 20.0, 78.0, 50.0, 120.0, 100.0, 19.0, 78.0, 70.0, 50.0, 60.0, 110.0, 40.0, 30.0, 40.0, 30.0, 50.0, 60.0, 60.0, 40.0, 37.0, -3.0, 60.0, 80.0, 30.0, 40.0, 40.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5154459682483128, "mean_inference_ms": 1.5136319570457828, "mean_action_processing_ms": 0.4839422349098109, "mean_env_wait_ms": 1.324982618984885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012384653091430664, "StateBufferConnector_ms": 0.010517597198486328, "ViewRequirementAgentConnector_ms": 0.3699045181274414}, "num_episodes": 18, "episode_return_max": 1049.0, "episode_return_min": 208.0, "episode_return_mean": 667.01}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.87576468680189, "num_env_steps_trained_throughput_per_sec": 21.87576468680189, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 185091.954, "restore_workers_time_ms": 0.011, "training_step_time_ms": 185091.904, "sample_time_ms": 2453.065, "learn_time_ms": 182617.444, "learn_throughput": 21.904, "synch_weights_time_ms": 13.183}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "a22d3_00000", "date": "2024-08-06_06-27-27", "timestamp": 1722940047, "time_this_iter_s": 182.85877513885498, "time_total_s": 27837.75987315178, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x30f0209d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27837.75987315178, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.382625482625485, "ram_util_percent": 76.69575289575289}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.95216448267047, "cur_kl_coeff": 0.36532361536519614, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.012389767006375847, "vf_loss": 7.754675607102366, "vf_explained_var": 0.002210494783866647, "kl": Infinity, "entropy": 0.4306854147118882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 1085.0, "episode_reward_min": 208.0, "episode_reward_mean": 699.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 220.0}, "policy_reward_mean": {"policy_0": 69.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [570.0, 901.0, 450.0, 449.0, 289.0, 890.0, 428.0, 588.0, 693.0, 810.0, 816.0, 760.0, 668.0, 563.0, 577.0, 757.0, 1039.0, 664.0, 757.0, 496.0, 208.0, 949.0, 863.0, 920.0, 780.0, 905.0, 670.0, 660.0, 670.0, 447.0, 404.0, 694.0, 756.0, 626.0, 677.0, 623.0, 425.0, 656.0, 318.0, 800.0, 566.0, 900.0, 628.0, 838.0, 1049.0, 609.0, 930.0, 805.0, 548.0, 842.0, 790.0, 630.0, 695.0, 296.0, 670.0, 670.0, 845.0, 792.0, 765.0, 830.0, 470.0, 707.0, 810.0, 560.0, 615.0, 717.0, 1010.0, 760.0, 600.0, 682.0, 615.0, 390.0, 837.0, 610.0, 773.0, 649.0, 740.0, 990.0, 430.0, 625.0, 540.0, 524.0, 774.0, 1085.0, 1015.0, 678.0, 1018.0, 794.0, 910.0, 613.0, 873.0, 602.0, 791.0, 630.0, 848.0, 617.0, 962.0, 727.0, 755.0, 715.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 40.0, 50.0, 100.0, 100.0, 70.0, 40.0, 10.0, 60.0, 60.0, 20.0, 160.0, 120.0, 50.0, 120.0, 35.0, 100.0, 36.0, 190.0, 70.0, 10.0, 50.0, 50.0, 60.0, 20.0, 60.0, 10.0, 40.0, 10.0, 140.0, 10.0, 40.0, 140.0, 60.0, 10.0, 39.0, 60.0, 40.0, 30.0, 20.0, 20.0, 50.0, -21.0, 60.0, 0.0, 130.0, 20.0, 40.0, -10.0, 0.0, 100.0, 120.0, 60.0, 120.0, 80.0, 50.0, 30.0, 120.0, 90.0, 120.0, 60.0, 40.0, 60.0, 50.0, 18.0, 30.0, 20.0, 60.0, 60.0, 30.0, 90.0, 40.0, 50.0, 30.0, 50.0, 90.0, 90.0, 40.0, 28.0, 80.0, 0.0, 130.0, 19.0, 62.0, 26.0, 50.0, 150.0, 26.0, 140.0, 90.0, 60.0, 80.0, 80.0, 110.0, 80.0, 70.0, 80.0, 120.0, 60.0, 70.0, 5.0, 60.0, 120.0, 110.0, 170.0, 80.0, 44.0, 57.0, 100.0, 70.0, 70.0, 120.0, 30.0, 70.0, 110.0, 90.0, 60.0, 70.0, 90.0, 50.0, 50.0, 60.0, 50.0, 35.0, 110.0, 85.0, 40.0, 80.0, 68.0, 90.0, 47.0, 22.0, 20.0, 4.0, 60.0, 110.0, 70.0, 100.0, 50.0, 80.0, 20.0, 40.0, 60.0, 18.0, -4.0, 220.0, -27.0, 40.0, 120.0, 90.0, 90.0, 190.0, 20.0, 60.0, 130.0, 29.0, 75.0, 42.0, 81.0, 40.0, 110.0, 60.0, 50.0, 130.0, 100.0, 109.0, 100.0, 120.0, 200.0, 60.0, 24.0, 100.0, 90.0, 80.0, 120.0, 26.0, 30.0, 14.0, 50.0, 130.0, 40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0, 34.0, 90.0, -5.0, 42.0, 30.0, 50.0, 150.0, 60.0, 11.0, 34.0, 20.0, -23.0, 0.0, 10.0, 60.0, 20.0, -48.0, 110.0, 9.0, 50.0, 100.0, 90.0, 80.0, 50.0, 110.0, 110.0, 129.0, 120.0, 40.0, 120.0, 100.0, 86.0, 76.0, 100.0, 45.0, 100.0, 80.0, 160.0, 90.0, 26.0, 70.0, 160.0, 110.0, 120.0, 20.0, 50.0, 60.0, 110.0, 160.0, 60.0, 50.0, 40.0, 60.0, 140.0, 40.0, 60.0, 100.0, 110.0, 90.0, 90.0, 30.0, 90.0, 130.0, 100.0, 70.0, 90.0, 100.0, 70.0, 110.0, 115.0, 10.0, 130.0, 60.0, 30.0, 170.0, 10.0, 80.0, 40.0, 90.0, 50.0, 80.0, 50.0, 40.0, 60.0, 150.0, 80.0, 70.0, 30.0, 40.0, 60.0, 40.0, 100.0, 130.0, 50.0, 40.0, 40.0, 20.0, 100.0, 130.0, 20.0, 30.0, 60.0, 70.0, 70.0, 32.0, 40.0, 15.0, 30.0, 50.0, 50.0, 130.0, 10.0, 10.0, 39.0, 67.0, 60.0, 30.0, 30.0, -2.0, 30.0, 120.0, 70.0, 110.0, 100.0, 50.0, 100.0, 70.0, 27.0, 7.0, 40.0, 26.0, 130.0, 27.0, 100.0, 140.0, 20.0, 79.0, 14.0, 110.0, 110.0, 70.0, 130.0, 80.0, 50.0, 60.0, 34.0, 120.0, -18.0, 40.0, 60.0, 80.0, 40.0, 94.0, 21.0, 90.0, 54.0, 40.0, 79.0, 79.0, 100.0, 30.0, 80.0, 70.0, 85.0, 110.0, 9.0, 69.0, 50.0, 90.0, 30.0, 51.0, 80.0, 60.0, 40.0, 26.0, 14.0, 70.0, 62.0, 29.0, -7.0, 130.0, 0.0, 110.0, 100.0, 100.0, 30.0, 0.0, 36.0, 90.0, 60.0, 20.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, -18.0, 190.0, 60.0, 100.0, 30.0, 110.0, 80.0, 50.0, 120.0, 60.0, 100.0, 90.0, 60.0, 140.0, 40.0, 50.0, 40.0, 60.0, 16.0, 80.0, 40.0, 40.0, 70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0, 26.0, 100.0, 25.0, 70.0, 120.0, 110.0, 40.0, 10.0, 17.0, 110.0, 50.0, 60.0, 80.0, 58.0, 80.0, 120.0, 110.0, 110.0, 90.0, 80.0, 130.0, 100.0, 100.0, 80.0, 49.0, 90.0, 160.0, 160.0, 100.0, 80.0, 45.0, 70.0, 110.0, 30.0, 20.0, 15.0, 130.0, 49.0, 90.0, 50.0, 100.0, 80.0, 40.0, 90.0, 110.0, 90.0, 90.0, 140.0, 80.0, 110.0, 50.0, 60.0, 110.0, 65.0, 50.0, 120.0, 90.0, 90.0, 110.0, 60.0, 1.0, 25.0, 60.0, 15.0, 60.0, 58.0, 120.0, 30.0, 39.0, 140.0, 60.0, 98.0, 110.0, 90.0, 39.0, 70.0, 90.0, 40.0, 115.0, 130.0, 110.0, 80.0, 51.0, 70.0, 50.0, 130.0, 9.0, 130.0, 60.0, 100.0, 100.0, 40.0, 70.0, 110.0, 60.0, 30.0, 70.0, 20.0, 50.0, 80.0, -7.0, 60.0, 42.0, 150.0, 90.0, 45.0, -15.0, 150.0, 110.0, 70.0, 16.0, 0.0, 30.0, 27.0, 50.0, 22.0, 50.0, 30.0, 21.0, 50.0, 110.0, 50.0, 60.0, 80.0, 80.0, 20.0, 60.0, 80.0, 60.0, 70.0, 60.0, 90.0, 40.0, 40.0, 120.0, 100.0, 20.0, 110.0, 10.0, 80.0, 80.0, 115.0, 70.0, 70.0, 50.0, 160.0, 60.0, 60.0, 60.0, 120.0, 116.0, 46.0, 80.0, 70.0, 70.0, 90.0, 100.0, 70.0, 100.0, 50.0, 40.0, 70.0, 110.0, 120.0, -15.0, 60.0, 170.0, 10.0, 90.0, 110.0, 60.0, 160.0, 80.0, 140.0, 50.0, 80.0, 70.0, 60.0, 40.0, 90.0, 50.0, 70.0, 60.0, 60.0, 40.0, -6.0, 20.0, 36.0, 70.0, 70.0, 70.0, 6.0, 60.0, 96.0, 70.0, 130.0, 20.0, 70.0, 45.0, 140.0, 70.0, 70.0, 50.0, 100.0, 90.0, 150.0, 140.0, 30.0, 60.0, 50.0, 80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0, 60.0, 80.0, 50.0, 80.0, 50.0, 120.0, 10.0, 15.0, 100.0, 50.0, -17.0, 140.0, 70.0, 70.0, 107.0, 53.0, 94.0, 40.0, 80.0, 80.0, 80.0, 80.0, 100.0, 70.0, 110.0, 110.0, 70.0, 160.0, 140.0, 90.0, 70.0, 110.0, 60.0, 110.0, 80.0, 100.0, 60.0, 40.0, 70.0, 60.0, 70.0, 90.0, 19.0, 61.0, 138.0, 30.0, 30.0, 90.0, 22.0, 50.0, 50.0, 150.0, 70.0, 90.0, 50.0, 50.0, 31.0, 110.0, 41.0, 40.0, 70.0, 30.0, 30.0, 15.0, 100.0, 30.0, 60.0, 50.0, 170.0, 60.0, 70.0, 90.0, -85.0, 36.0, 20.0, 100.0, 70.0, 80.0, 30.0, -21.0, 70.0, 10.0, 70.0, 115.0, 110.0, 146.0, 68.0, 110.0, 110.0, 28.0, 110.0, 80.0, 40.0, 20.0, 50.0, 70.0, 30.0, 110.0, 30.0, 70.0, 82.0, 80.0, 60.0, 40.0, 52.0, 60.0, 65.0, 80.0, 114.0, 140.0, 20.0, 70.0, 20.0, 30.0, 60.0, 39.0, 40.0, 190.0, 20.0, 160.0, 40.0, 100.0, 100.0, 80.0, 50.0, 90.0, 50.0, 100.0, 50.0, 80.0, 60.0, 80.0, 100.0, 120.0, 120.0, 70.0, 80.0, 120.0, 100.0, 140.0, 50.0, 40.0, 30.0, 50.0, 80.0, 60.0, 40.0, 30.0, 20.0, 30.0, 40.0, 90.0, 30.0, 20.0, 78.0, 50.0, 120.0, 100.0, 19.0, 78.0, 70.0, 50.0, 60.0, 110.0, 40.0, 30.0, 40.0, 30.0, 50.0, 60.0, 60.0, 40.0, 37.0, -3.0, 60.0, 80.0, 30.0, 40.0, 40.0, 140.0, 100.0, 49.0, 100.0, 110.0, 40.0, 130.0, 70.0, 90.0, 45.0, 40.0, 160.0, 95.0, 110.0, 60.0, 170.0, 60.0, 110.0, 120.0, 100.0, 100.0, 120.0, 110.0, 110.0, 120.0, 140.0, 80.0, 50.0, 130.0, 55.0, 100.0, 90.0, 70.0, 50.0, 150.0, 38.0, 23.0, 50.0, 70.0, 34.0, 103.0, 120.0, 50.0, 160.0, 88.0, 74.0, 110.0, 130.0, 50.0, 96.0, 140.0, 110.0, 30.0, 70.0, 47.0, 130.0, 60.0, 90.0, 92.0, 35.0, 130.0, 60.0, 60.0, 110.0, 20.0, 90.0, 170.0, 100.0, 80.0, 130.0, 90.0, 10.0, 47.0, 50.0, 70.0, 100.0, 26.0, 80.0, 100.0, 60.0, 70.0, 120.0, 90.0, 48.0, 140.0, 50.0, 66.0, 40.0, 99.0, 80.0, 140.0, 120.0, 30.0, 40.0, 37.0, 38.0, 66.0, 120.0, 7.0, 120.0, 24.0, 50.0, 57.0, 60.0, 70.0, 90.0, 145.0, 30.0, 99.0, 80.0, 110.0, 80.0, 80.0, 70.0, 70.0, 70.0, 30.0, 50.0, 60.0, 10.0, 110.0, 50.0, 50.0, 60.0, 150.0, 27.0, 118.0, 130.0, 50.0, 120.0, 93.0, 30.0, 40.0, 27.0, 130.0, 70.0, 10.0, 140.0, 110.0, 30.0, 30.0, 160.0, 140.0, 100.0, 180.0, 40.0, 104.0, 14.0, 140.0, 50.0, 34.0, 70.0, 70.0, 110.0, 40.0, 59.0, 70.0, 100.0, 50.0, 100.0, 58.0, 34.0, 100.0, 0.0, 60.0, 82.0, 190.0, 39.0, 130.0, 90.0, 30.0, 70.0, 30.0, 5.0, 30.0, 60.0, 90.0, 110.0, 120.0, 130.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5145111039388255, "mean_inference_ms": 1.5131141517328843, "mean_action_processing_ms": 0.48368860114464185, "mean_env_wait_ms": 1.3244859444058001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011495828628540039, "StateBufferConnector_ms": 0.010144948959350586, "ViewRequirementAgentConnector_ms": 0.3624539375305176}, "num_episodes": 18, "episode_return_max": 1085.0, "episode_return_min": 208.0, "episode_return_mean": 699.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.88508839429542, "num_env_steps_trained_throughput_per_sec": 21.88508839429542, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 184534.392, "restore_workers_time_ms": 0.011, "training_step_time_ms": 184534.342, "sample_time_ms": 2448.341, "learn_time_ms": 182064.112, "learn_throughput": 21.97, "synch_weights_time_ms": 13.887}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "a22d3_00000", "date": "2024-08-06_06-30-30", "timestamp": 1722940230, "time_this_iter_s": 182.78295612335205, "time_total_s": 28020.54282927513, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a0134b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28020.54282927513, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.127131782945735, "ram_util_percent": 77.27751937984496}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7879268080662616, "cur_kl_coeff": 0.547985423047794, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5241455151758, "policy_loss": -0.011725901704900467, "vf_loss": 7.532894227400629, "vf_explained_var": 0.01588280878889675, "kl": 0.005432962977511447, "entropy": 0.4797803951972844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 1197.0, "episode_reward_min": 208.0, "episode_reward_mean": 721.11, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 210.0}, "policy_reward_mean": {"policy_0": 72.111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [757.0, 496.0, 208.0, 949.0, 863.0, 920.0, 780.0, 905.0, 670.0, 660.0, 670.0, 447.0, 404.0, 694.0, 756.0, 626.0, 677.0, 623.0, 425.0, 656.0, 318.0, 800.0, 566.0, 900.0, 628.0, 838.0, 1049.0, 609.0, 930.0, 805.0, 548.0, 842.0, 790.0, 630.0, 695.0, 296.0, 670.0, 670.0, 845.0, 792.0, 765.0, 830.0, 470.0, 707.0, 810.0, 560.0, 615.0, 717.0, 1010.0, 760.0, 600.0, 682.0, 615.0, 390.0, 837.0, 610.0, 773.0, 649.0, 740.0, 990.0, 430.0, 625.0, 540.0, 524.0, 774.0, 1085.0, 1015.0, 678.0, 1018.0, 794.0, 910.0, 613.0, 873.0, 602.0, 791.0, 630.0, 848.0, 617.0, 962.0, 727.0, 755.0, 715.0, 1197.0, 652.0, 823.0, 973.0, 718.0, 970.0, 432.0, 608.0, 843.0, 754.0, 538.0, 532.0, 510.0, 1064.0, 1140.0, 836.0, 638.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 90.0, 80.0, 130.0, 50.0, 90.0, 30.0, 40.0, 127.0, 80.0, 34.0, 90.0, -5.0, 42.0, 30.0, 50.0, 150.0, 60.0, 11.0, 34.0, 20.0, -23.0, 0.0, 10.0, 60.0, 20.0, -48.0, 110.0, 9.0, 50.0, 100.0, 90.0, 80.0, 50.0, 110.0, 110.0, 129.0, 120.0, 40.0, 120.0, 100.0, 86.0, 76.0, 100.0, 45.0, 100.0, 80.0, 160.0, 90.0, 26.0, 70.0, 160.0, 110.0, 120.0, 20.0, 50.0, 60.0, 110.0, 160.0, 60.0, 50.0, 40.0, 60.0, 140.0, 40.0, 60.0, 100.0, 110.0, 90.0, 90.0, 30.0, 90.0, 130.0, 100.0, 70.0, 90.0, 100.0, 70.0, 110.0, 115.0, 10.0, 130.0, 60.0, 30.0, 170.0, 10.0, 80.0, 40.0, 90.0, 50.0, 80.0, 50.0, 40.0, 60.0, 150.0, 80.0, 70.0, 30.0, 40.0, 60.0, 40.0, 100.0, 130.0, 50.0, 40.0, 40.0, 20.0, 100.0, 130.0, 20.0, 30.0, 60.0, 70.0, 70.0, 32.0, 40.0, 15.0, 30.0, 50.0, 50.0, 130.0, 10.0, 10.0, 39.0, 67.0, 60.0, 30.0, 30.0, -2.0, 30.0, 120.0, 70.0, 110.0, 100.0, 50.0, 100.0, 70.0, 27.0, 7.0, 40.0, 26.0, 130.0, 27.0, 100.0, 140.0, 20.0, 79.0, 14.0, 110.0, 110.0, 70.0, 130.0, 80.0, 50.0, 60.0, 34.0, 120.0, -18.0, 40.0, 60.0, 80.0, 40.0, 94.0, 21.0, 90.0, 54.0, 40.0, 79.0, 79.0, 100.0, 30.0, 80.0, 70.0, 85.0, 110.0, 9.0, 69.0, 50.0, 90.0, 30.0, 51.0, 80.0, 60.0, 40.0, 26.0, 14.0, 70.0, 62.0, 29.0, -7.0, 130.0, 0.0, 110.0, 100.0, 100.0, 30.0, 0.0, 36.0, 90.0, 60.0, 20.0, 20.0, -4.0, 20.0, 20.0, 10.0, 30.0, 30.0, -18.0, 190.0, 60.0, 100.0, 30.0, 110.0, 80.0, 50.0, 120.0, 60.0, 100.0, 90.0, 60.0, 140.0, 40.0, 50.0, 40.0, 60.0, 16.0, 80.0, 40.0, 40.0, 70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0, 26.0, 100.0, 25.0, 70.0, 120.0, 110.0, 40.0, 10.0, 17.0, 110.0, 50.0, 60.0, 80.0, 58.0, 80.0, 120.0, 110.0, 110.0, 90.0, 80.0, 130.0, 100.0, 100.0, 80.0, 49.0, 90.0, 160.0, 160.0, 100.0, 80.0, 45.0, 70.0, 110.0, 30.0, 20.0, 15.0, 130.0, 49.0, 90.0, 50.0, 100.0, 80.0, 40.0, 90.0, 110.0, 90.0, 90.0, 140.0, 80.0, 110.0, 50.0, 60.0, 110.0, 65.0, 50.0, 120.0, 90.0, 90.0, 110.0, 60.0, 1.0, 25.0, 60.0, 15.0, 60.0, 58.0, 120.0, 30.0, 39.0, 140.0, 60.0, 98.0, 110.0, 90.0, 39.0, 70.0, 90.0, 40.0, 115.0, 130.0, 110.0, 80.0, 51.0, 70.0, 50.0, 130.0, 9.0, 130.0, 60.0, 100.0, 100.0, 40.0, 70.0, 110.0, 60.0, 30.0, 70.0, 20.0, 50.0, 80.0, -7.0, 60.0, 42.0, 150.0, 90.0, 45.0, -15.0, 150.0, 110.0, 70.0, 16.0, 0.0, 30.0, 27.0, 50.0, 22.0, 50.0, 30.0, 21.0, 50.0, 110.0, 50.0, 60.0, 80.0, 80.0, 20.0, 60.0, 80.0, 60.0, 70.0, 60.0, 90.0, 40.0, 40.0, 120.0, 100.0, 20.0, 110.0, 10.0, 80.0, 80.0, 115.0, 70.0, 70.0, 50.0, 160.0, 60.0, 60.0, 60.0, 120.0, 116.0, 46.0, 80.0, 70.0, 70.0, 90.0, 100.0, 70.0, 100.0, 50.0, 40.0, 70.0, 110.0, 120.0, -15.0, 60.0, 170.0, 10.0, 90.0, 110.0, 60.0, 160.0, 80.0, 140.0, 50.0, 80.0, 70.0, 60.0, 40.0, 90.0, 50.0, 70.0, 60.0, 60.0, 40.0, -6.0, 20.0, 36.0, 70.0, 70.0, 70.0, 6.0, 60.0, 96.0, 70.0, 130.0, 20.0, 70.0, 45.0, 140.0, 70.0, 70.0, 50.0, 100.0, 90.0, 150.0, 140.0, 30.0, 60.0, 50.0, 80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0, 60.0, 80.0, 50.0, 80.0, 50.0, 120.0, 10.0, 15.0, 100.0, 50.0, -17.0, 140.0, 70.0, 70.0, 107.0, 53.0, 94.0, 40.0, 80.0, 80.0, 80.0, 80.0, 100.0, 70.0, 110.0, 110.0, 70.0, 160.0, 140.0, 90.0, 70.0, 110.0, 60.0, 110.0, 80.0, 100.0, 60.0, 40.0, 70.0, 60.0, 70.0, 90.0, 19.0, 61.0, 138.0, 30.0, 30.0, 90.0, 22.0, 50.0, 50.0, 150.0, 70.0, 90.0, 50.0, 50.0, 31.0, 110.0, 41.0, 40.0, 70.0, 30.0, 30.0, 15.0, 100.0, 30.0, 60.0, 50.0, 170.0, 60.0, 70.0, 90.0, -85.0, 36.0, 20.0, 100.0, 70.0, 80.0, 30.0, -21.0, 70.0, 10.0, 70.0, 115.0, 110.0, 146.0, 68.0, 110.0, 110.0, 28.0, 110.0, 80.0, 40.0, 20.0, 50.0, 70.0, 30.0, 110.0, 30.0, 70.0, 82.0, 80.0, 60.0, 40.0, 52.0, 60.0, 65.0, 80.0, 114.0, 140.0, 20.0, 70.0, 20.0, 30.0, 60.0, 39.0, 40.0, 190.0, 20.0, 160.0, 40.0, 100.0, 100.0, 80.0, 50.0, 90.0, 50.0, 100.0, 50.0, 80.0, 60.0, 80.0, 100.0, 120.0, 120.0, 70.0, 80.0, 120.0, 100.0, 140.0, 50.0, 40.0, 30.0, 50.0, 80.0, 60.0, 40.0, 30.0, 20.0, 30.0, 40.0, 90.0, 30.0, 20.0, 78.0, 50.0, 120.0, 100.0, 19.0, 78.0, 70.0, 50.0, 60.0, 110.0, 40.0, 30.0, 40.0, 30.0, 50.0, 60.0, 60.0, 40.0, 37.0, -3.0, 60.0, 80.0, 30.0, 40.0, 40.0, 140.0, 100.0, 49.0, 100.0, 110.0, 40.0, 130.0, 70.0, 90.0, 45.0, 40.0, 160.0, 95.0, 110.0, 60.0, 170.0, 60.0, 110.0, 120.0, 100.0, 100.0, 120.0, 110.0, 110.0, 120.0, 140.0, 80.0, 50.0, 130.0, 55.0, 100.0, 90.0, 70.0, 50.0, 150.0, 38.0, 23.0, 50.0, 70.0, 34.0, 103.0, 120.0, 50.0, 160.0, 88.0, 74.0, 110.0, 130.0, 50.0, 96.0, 140.0, 110.0, 30.0, 70.0, 47.0, 130.0, 60.0, 90.0, 92.0, 35.0, 130.0, 60.0, 60.0, 110.0, 20.0, 90.0, 170.0, 100.0, 80.0, 130.0, 90.0, 10.0, 47.0, 50.0, 70.0, 100.0, 26.0, 80.0, 100.0, 60.0, 70.0, 120.0, 90.0, 48.0, 140.0, 50.0, 66.0, 40.0, 99.0, 80.0, 140.0, 120.0, 30.0, 40.0, 37.0, 38.0, 66.0, 120.0, 7.0, 120.0, 24.0, 50.0, 57.0, 60.0, 70.0, 90.0, 145.0, 30.0, 99.0, 80.0, 110.0, 80.0, 80.0, 70.0, 70.0, 70.0, 30.0, 50.0, 60.0, 10.0, 110.0, 50.0, 50.0, 60.0, 150.0, 27.0, 118.0, 130.0, 50.0, 120.0, 93.0, 30.0, 40.0, 27.0, 130.0, 70.0, 10.0, 140.0, 110.0, 30.0, 30.0, 160.0, 140.0, 100.0, 180.0, 40.0, 104.0, 14.0, 140.0, 50.0, 34.0, 70.0, 70.0, 110.0, 40.0, 59.0, 70.0, 100.0, 50.0, 100.0, 58.0, 34.0, 100.0, 0.0, 60.0, 82.0, 190.0, 39.0, 130.0, 90.0, 30.0, 70.0, 30.0, 5.0, 30.0, 60.0, 90.0, 110.0, 120.0, 130.0, 70.0, 66.0, 50.0, 190.0, 56.0, 130.0, 160.0, 140.0, 180.0, 140.0, 85.0, 100.0, 50.0, 30.0, 70.0, 70.0, 0.0, 60.0, 110.0, 10.0, 152.0, 40.0, 90.0, 147.0, 160.0, 80.0, 26.0, 80.0, 50.0, 80.0, 70.0, -2.0, 100.0, 210.0, 90.0, 140.0, 140.0, 120.0, 60.0, 80.0, 35.0, 110.0, -13.0, 80.0, 80.0, 80.0, 90.0, 100.0, 50.0, 60.0, 81.0, 110.0, 140.0, 160.0, 80.0, 110.0, 50.0, 80.0, 130.0, 10.0, 100.0, 16.0, 128.0, 10.0, 60.0, 37.0, 29.0, 100.0, 32.0, 10.0, 10.0, 80.0, 29.0, 170.0, 28.0, 50.0, 50.0, 36.0, 35.0, 110.0, 20.0, 78.0, 80.0, 60.0, 100.0, 80.0, 60.0, 100.0, 140.0, 38.0, 107.0, 50.0, 60.0, 60.0, 100.0, 90.0, 50.0, 27.0, 67.0, 120.0, 130.0, 50.0, 3.0, 40.0, 49.0, 60.0, 30.0, 100.0, 110.0, 36.0, 60.0, 64.0, 30.0, 90.0, 60.0, 50.0, 20.0, 13.0, 46.0, 39.0, 120.0, 60.0, 30.0, 100.0, 50.0, 10.0, 50.0, 100.0, 40.0, 10.0, 60.0, 130.0, 100.0, 160.0, 109.0, 77.0, 101.0, 120.0, 110.0, 110.0, 47.0, 100.0, 113.0, 170.0, 69.0, 138.0, 90.0, 170.0, 90.0, 80.0, 120.0, 130.0, 90.0, 40.0, 90.0, 160.0, 59.0, 60.0, 130.0, 50.0, 27.0, 24.0, 30.0, 60.0, 40.0, 75.0, 90.0, 173.0, 20.0, 23.0, 103.0, 70.0, 80.0, 70.0, 140.0, 10.0, 120.0, 50.0, 100.0, 40.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5134719307944624, "mean_inference_ms": 1.5125237711019617, "mean_action_processing_ms": 0.4833943745896919, "mean_env_wait_ms": 1.3239835302954446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01138615608215332, "StateBufferConnector_ms": 0.010217666625976562, "ViewRequirementAgentConnector_ms": 0.35836052894592285}, "num_episodes": 18, "episode_return_max": 1197.0, "episode_return_min": 208.0, "episode_return_mean": 721.11}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.69370007569927, "num_env_steps_trained_throughput_per_sec": 21.69370007569927, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 184517.14, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184517.09, "sample_time_ms": 2457.838, "learn_time_ms": 182037.703, "learn_throughput": 21.973, "synch_weights_time_ms": 13.86}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "a22d3_00000", "date": "2024-08-06_06-33-34", "timestamp": 1722940414, "time_this_iter_s": 184.39456796646118, "time_total_s": 28204.937397241592, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28204.937397241592, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.75134099616858, "ram_util_percent": 77.43371647509578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.172660586247429, "cur_kl_coeff": 0.547985423047794, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.011001752860372027, "vf_loss": 7.70292223477389, "vf_explained_var": 0.012626328413732771, "kl": Infinity, "entropy": 0.460393747585777, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 1197.0, "episode_reward_min": 296.0, "episode_reward_mean": 748.18, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 263.0}, "policy_reward_mean": {"policy_0": 74.818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [900.0, 628.0, 838.0, 1049.0, 609.0, 930.0, 805.0, 548.0, 842.0, 790.0, 630.0, 695.0, 296.0, 670.0, 670.0, 845.0, 792.0, 765.0, 830.0, 470.0, 707.0, 810.0, 560.0, 615.0, 717.0, 1010.0, 760.0, 600.0, 682.0, 615.0, 390.0, 837.0, 610.0, 773.0, 649.0, 740.0, 990.0, 430.0, 625.0, 540.0, 524.0, 774.0, 1085.0, 1015.0, 678.0, 1018.0, 794.0, 910.0, 613.0, 873.0, 602.0, 791.0, 630.0, 848.0, 617.0, 962.0, 727.0, 755.0, 715.0, 1197.0, 652.0, 823.0, 973.0, 718.0, 970.0, 432.0, 608.0, 843.0, 754.0, 538.0, 532.0, 510.0, 1064.0, 1140.0, 836.0, 638.0, 820.0, 1089.0, 541.0, 533.0, 711.0, 879.0, 945.0, 600.0, 644.0, 750.0, 881.0, 1090.0, 820.0, 702.0, 485.0, 852.0, 1093.0, 645.0, 660.0, 1109.0, 830.0, 727.0, 396.0, 595.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 120.0, 70.0, 90.0, 180.0, 50.0, 80.0, 90.0, 100.0, 50.0, 26.0, 100.0, 25.0, 70.0, 120.0, 110.0, 40.0, 10.0, 17.0, 110.0, 50.0, 60.0, 80.0, 58.0, 80.0, 120.0, 110.0, 110.0, 90.0, 80.0, 130.0, 100.0, 100.0, 80.0, 49.0, 90.0, 160.0, 160.0, 100.0, 80.0, 45.0, 70.0, 110.0, 30.0, 20.0, 15.0, 130.0, 49.0, 90.0, 50.0, 100.0, 80.0, 40.0, 90.0, 110.0, 90.0, 90.0, 140.0, 80.0, 110.0, 50.0, 60.0, 110.0, 65.0, 50.0, 120.0, 90.0, 90.0, 110.0, 60.0, 1.0, 25.0, 60.0, 15.0, 60.0, 58.0, 120.0, 30.0, 39.0, 140.0, 60.0, 98.0, 110.0, 90.0, 39.0, 70.0, 90.0, 40.0, 115.0, 130.0, 110.0, 80.0, 51.0, 70.0, 50.0, 130.0, 9.0, 130.0, 60.0, 100.0, 100.0, 40.0, 70.0, 110.0, 60.0, 30.0, 70.0, 20.0, 50.0, 80.0, -7.0, 60.0, 42.0, 150.0, 90.0, 45.0, -15.0, 150.0, 110.0, 70.0, 16.0, 0.0, 30.0, 27.0, 50.0, 22.0, 50.0, 30.0, 21.0, 50.0, 110.0, 50.0, 60.0, 80.0, 80.0, 20.0, 60.0, 80.0, 60.0, 70.0, 60.0, 90.0, 40.0, 40.0, 120.0, 100.0, 20.0, 110.0, 10.0, 80.0, 80.0, 115.0, 70.0, 70.0, 50.0, 160.0, 60.0, 60.0, 60.0, 120.0, 116.0, 46.0, 80.0, 70.0, 70.0, 90.0, 100.0, 70.0, 100.0, 50.0, 40.0, 70.0, 110.0, 120.0, -15.0, 60.0, 170.0, 10.0, 90.0, 110.0, 60.0, 160.0, 80.0, 140.0, 50.0, 80.0, 70.0, 60.0, 40.0, 90.0, 50.0, 70.0, 60.0, 60.0, 40.0, -6.0, 20.0, 36.0, 70.0, 70.0, 70.0, 6.0, 60.0, 96.0, 70.0, 130.0, 20.0, 70.0, 45.0, 140.0, 70.0, 70.0, 50.0, 100.0, 90.0, 150.0, 140.0, 30.0, 60.0, 50.0, 80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0, 60.0, 80.0, 50.0, 80.0, 50.0, 120.0, 10.0, 15.0, 100.0, 50.0, -17.0, 140.0, 70.0, 70.0, 107.0, 53.0, 94.0, 40.0, 80.0, 80.0, 80.0, 80.0, 100.0, 70.0, 110.0, 110.0, 70.0, 160.0, 140.0, 90.0, 70.0, 110.0, 60.0, 110.0, 80.0, 100.0, 60.0, 40.0, 70.0, 60.0, 70.0, 90.0, 19.0, 61.0, 138.0, 30.0, 30.0, 90.0, 22.0, 50.0, 50.0, 150.0, 70.0, 90.0, 50.0, 50.0, 31.0, 110.0, 41.0, 40.0, 70.0, 30.0, 30.0, 15.0, 100.0, 30.0, 60.0, 50.0, 170.0, 60.0, 70.0, 90.0, -85.0, 36.0, 20.0, 100.0, 70.0, 80.0, 30.0, -21.0, 70.0, 10.0, 70.0, 115.0, 110.0, 146.0, 68.0, 110.0, 110.0, 28.0, 110.0, 80.0, 40.0, 20.0, 50.0, 70.0, 30.0, 110.0, 30.0, 70.0, 82.0, 80.0, 60.0, 40.0, 52.0, 60.0, 65.0, 80.0, 114.0, 140.0, 20.0, 70.0, 20.0, 30.0, 60.0, 39.0, 40.0, 190.0, 20.0, 160.0, 40.0, 100.0, 100.0, 80.0, 50.0, 90.0, 50.0, 100.0, 50.0, 80.0, 60.0, 80.0, 100.0, 120.0, 120.0, 70.0, 80.0, 120.0, 100.0, 140.0, 50.0, 40.0, 30.0, 50.0, 80.0, 60.0, 40.0, 30.0, 20.0, 30.0, 40.0, 90.0, 30.0, 20.0, 78.0, 50.0, 120.0, 100.0, 19.0, 78.0, 70.0, 50.0, 60.0, 110.0, 40.0, 30.0, 40.0, 30.0, 50.0, 60.0, 60.0, 40.0, 37.0, -3.0, 60.0, 80.0, 30.0, 40.0, 40.0, 140.0, 100.0, 49.0, 100.0, 110.0, 40.0, 130.0, 70.0, 90.0, 45.0, 40.0, 160.0, 95.0, 110.0, 60.0, 170.0, 60.0, 110.0, 120.0, 100.0, 100.0, 120.0, 110.0, 110.0, 120.0, 140.0, 80.0, 50.0, 130.0, 55.0, 100.0, 90.0, 70.0, 50.0, 150.0, 38.0, 23.0, 50.0, 70.0, 34.0, 103.0, 120.0, 50.0, 160.0, 88.0, 74.0, 110.0, 130.0, 50.0, 96.0, 140.0, 110.0, 30.0, 70.0, 47.0, 130.0, 60.0, 90.0, 92.0, 35.0, 130.0, 60.0, 60.0, 110.0, 20.0, 90.0, 170.0, 100.0, 80.0, 130.0, 90.0, 10.0, 47.0, 50.0, 70.0, 100.0, 26.0, 80.0, 100.0, 60.0, 70.0, 120.0, 90.0, 48.0, 140.0, 50.0, 66.0, 40.0, 99.0, 80.0, 140.0, 120.0, 30.0, 40.0, 37.0, 38.0, 66.0, 120.0, 7.0, 120.0, 24.0, 50.0, 57.0, 60.0, 70.0, 90.0, 145.0, 30.0, 99.0, 80.0, 110.0, 80.0, 80.0, 70.0, 70.0, 70.0, 30.0, 50.0, 60.0, 10.0, 110.0, 50.0, 50.0, 60.0, 150.0, 27.0, 118.0, 130.0, 50.0, 120.0, 93.0, 30.0, 40.0, 27.0, 130.0, 70.0, 10.0, 140.0, 110.0, 30.0, 30.0, 160.0, 140.0, 100.0, 180.0, 40.0, 104.0, 14.0, 140.0, 50.0, 34.0, 70.0, 70.0, 110.0, 40.0, 59.0, 70.0, 100.0, 50.0, 100.0, 58.0, 34.0, 100.0, 0.0, 60.0, 82.0, 190.0, 39.0, 130.0, 90.0, 30.0, 70.0, 30.0, 5.0, 30.0, 60.0, 90.0, 110.0, 120.0, 130.0, 70.0, 66.0, 50.0, 190.0, 56.0, 130.0, 160.0, 140.0, 180.0, 140.0, 85.0, 100.0, 50.0, 30.0, 70.0, 70.0, 0.0, 60.0, 110.0, 10.0, 152.0, 40.0, 90.0, 147.0, 160.0, 80.0, 26.0, 80.0, 50.0, 80.0, 70.0, -2.0, 100.0, 210.0, 90.0, 140.0, 140.0, 120.0, 60.0, 80.0, 35.0, 110.0, -13.0, 80.0, 80.0, 80.0, 90.0, 100.0, 50.0, 60.0, 81.0, 110.0, 140.0, 160.0, 80.0, 110.0, 50.0, 80.0, 130.0, 10.0, 100.0, 16.0, 128.0, 10.0, 60.0, 37.0, 29.0, 100.0, 32.0, 10.0, 10.0, 80.0, 29.0, 170.0, 28.0, 50.0, 50.0, 36.0, 35.0, 110.0, 20.0, 78.0, 80.0, 60.0, 100.0, 80.0, 60.0, 100.0, 140.0, 38.0, 107.0, 50.0, 60.0, 60.0, 100.0, 90.0, 50.0, 27.0, 67.0, 120.0, 130.0, 50.0, 3.0, 40.0, 49.0, 60.0, 30.0, 100.0, 110.0, 36.0, 60.0, 64.0, 30.0, 90.0, 60.0, 50.0, 20.0, 13.0, 46.0, 39.0, 120.0, 60.0, 30.0, 100.0, 50.0, 10.0, 50.0, 100.0, 40.0, 10.0, 60.0, 130.0, 100.0, 160.0, 109.0, 77.0, 101.0, 120.0, 110.0, 110.0, 47.0, 100.0, 113.0, 170.0, 69.0, 138.0, 90.0, 170.0, 90.0, 80.0, 120.0, 130.0, 90.0, 40.0, 90.0, 160.0, 59.0, 60.0, 130.0, 50.0, 27.0, 24.0, 30.0, 60.0, 40.0, 75.0, 90.0, 173.0, 20.0, 23.0, 103.0, 70.0, 80.0, 70.0, 140.0, 10.0, 120.0, 50.0, 100.0, 40.0, 140.0, 100.0, 210.0, 130.0, 80.0, 130.0, 60.0, 90.0, 100.0, 89.0, 100.0, 30.0, 80.0, 110.0, 54.0, 40.0, 10.0, 29.0, 100.0, 58.0, 30.0, 10.0, 150.0, 25.0, 67.0, 30.0, 32.0, 20.0, 27.0, 140.0, 32.0, 50.0, 80.0, 90.0, 150.0, 30.0, 50.0, 1.0, 100.0, 150.0, 10.0, 40.0, 120.0, 50.0, 90.0, 100.0, 150.0, 30.0, 110.0, 29.0, 160.0, 71.0, 100.0, 110.0, 90.0, 80.0, 70.0, 90.0, 11.0, 60.0, 263.0, 40.0, 70.0, 60.0, 70.0, 30.0, 110.0, 40.0, 40.0, 60.0, 80.0, 20.0, 85.0, 70.0, 100.0, 39.0, 50.0, 50.0, 90.0, 90.0, 50.0, 50.0, 110.0, 80.0, 30.0, 80.0, 150.0, 50.0, 70.0, 30.0, 100.0, 160.0, 180.0, 60.0, 80.0, 115.0, 19.0, 120.0, 70.0, 47.0, 30.0, 110.0, 60.0, 70.0, 50.0, 130.0, 160.0, 40.0, 190.0, 120.0, 160.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 90.0, 40.0, 130.0, 40.0, 120.0, 32.0, 120.0, 30.0, 90.0, 30.0, 80.0, 130.0, 30.0, 40.0, 60.0, 30.0, 30.0, 25.0, 100.0, 30.0, 40.0, 40.0, 110.0, 20.0, 140.0, 21.0, 70.0, 120.0, 11.0, 100.0, 40.0, 90.0, 90.0, 170.0, 120.0, 70.0, 80.0, 110.0, 70.0, 170.0, 100.0, 78.0, 185.0, 110.0, 60.0, 10.0, 60.0, 45.0, 120.0, 60.0, 50.0, 40.0, 130.0, 70.0, 60.0, 70.0, 80.0, 60.0, 80.0, 110.0, 70.0, 50.0, 60.0, 20.0, 60.0, 150.0, 60.0, 100.0, 90.0, 140.0, 150.0, 89.0, 100.0, 170.0, 90.0, 120.0, 120.0, 90.0, 50.0, 50.0, 90.0, 130.0, 30.0, 60.0, 90.0, 60.0, 80.0, 90.0, 93.0, 50.0, 45.0, 60.0, 29.0, 130.0, 60.0, 50.0, 90.0, 80.0, -8.0, 9.0, -1.0, 36.0, 50.0, 30.0, 40.0, 60.0, 90.0, 70.0, 90.0, 20.0, 15.0, 100.0, 40.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5122219728106812, "mean_inference_ms": 1.5119724775210437, "mean_action_processing_ms": 0.4830668064584513, "mean_env_wait_ms": 1.3234835160714784, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01174616813659668, "StateBufferConnector_ms": 0.00914907455444336, "ViewRequirementAgentConnector_ms": 0.3602721691131592}, "num_episodes": 23, "episode_return_max": 1197.0, "episode_return_min": 296.0, "episode_return_mean": 748.18}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.78237896806879, "num_env_steps_trained_throughput_per_sec": 21.78237896806879, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 184442.097, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184442.045, "sample_time_ms": 2454.135, "learn_time_ms": 181966.356, "learn_throughput": 21.982, "synch_weights_time_ms": 13.786}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "a22d3_00000", "date": "2024-08-06_06-36-38", "timestamp": 1722940598, "time_this_iter_s": 183.64641690254211, "time_total_s": 28388.583814144135, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28388.583814144135, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 17.24153846153846, "ram_util_percent": 75.8026923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1027315783678406, "cur_kl_coeff": 0.8219781345716909, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.010657551362059208, "vf_loss": 7.468017339401732, "vf_explained_var": 0.0026673934647577385, "kl": Infinity, "entropy": 0.4832345459598322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 1197.0, "episode_reward_min": 315.0, "episode_reward_mean": 745.59, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 263.0}, "policy_reward_mean": {"policy_0": 74.559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 615.0, 717.0, 1010.0, 760.0, 600.0, 682.0, 615.0, 390.0, 837.0, 610.0, 773.0, 649.0, 740.0, 990.0, 430.0, 625.0, 540.0, 524.0, 774.0, 1085.0, 1015.0, 678.0, 1018.0, 794.0, 910.0, 613.0, 873.0, 602.0, 791.0, 630.0, 848.0, 617.0, 962.0, 727.0, 755.0, 715.0, 1197.0, 652.0, 823.0, 973.0, 718.0, 970.0, 432.0, 608.0, 843.0, 754.0, 538.0, 532.0, 510.0, 1064.0, 1140.0, 836.0, 638.0, 820.0, 1089.0, 541.0, 533.0, 711.0, 879.0, 945.0, 600.0, 644.0, 750.0, 881.0, 1090.0, 820.0, 702.0, 485.0, 852.0, 1093.0, 645.0, 660.0, 1109.0, 830.0, 727.0, 396.0, 595.0, 853.0, 580.0, 750.0, 422.0, 778.0, 700.0, 659.0, 974.0, 852.0, 830.0, 815.0, 710.0, 785.0, 594.0, 614.0, 857.0, 315.0, 584.0, 705.0, 863.0, 818.0, 802.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 40.0, 43.0, 90.0, 79.0, 18.0, 30.0, 70.0, 80.0, 30.0, 60.0, 80.0, 50.0, 80.0, 50.0, 120.0, 10.0, 15.0, 100.0, 50.0, -17.0, 140.0, 70.0, 70.0, 107.0, 53.0, 94.0, 40.0, 80.0, 80.0, 80.0, 80.0, 100.0, 70.0, 110.0, 110.0, 70.0, 160.0, 140.0, 90.0, 70.0, 110.0, 60.0, 110.0, 80.0, 100.0, 60.0, 40.0, 70.0, 60.0, 70.0, 90.0, 19.0, 61.0, 138.0, 30.0, 30.0, 90.0, 22.0, 50.0, 50.0, 150.0, 70.0, 90.0, 50.0, 50.0, 31.0, 110.0, 41.0, 40.0, 70.0, 30.0, 30.0, 15.0, 100.0, 30.0, 60.0, 50.0, 170.0, 60.0, 70.0, 90.0, -85.0, 36.0, 20.0, 100.0, 70.0, 80.0, 30.0, -21.0, 70.0, 10.0, 70.0, 115.0, 110.0, 146.0, 68.0, 110.0, 110.0, 28.0, 110.0, 80.0, 40.0, 20.0, 50.0, 70.0, 30.0, 110.0, 30.0, 70.0, 82.0, 80.0, 60.0, 40.0, 52.0, 60.0, 65.0, 80.0, 114.0, 140.0, 20.0, 70.0, 20.0, 30.0, 60.0, 39.0, 40.0, 190.0, 20.0, 160.0, 40.0, 100.0, 100.0, 80.0, 50.0, 90.0, 50.0, 100.0, 50.0, 80.0, 60.0, 80.0, 100.0, 120.0, 120.0, 70.0, 80.0, 120.0, 100.0, 140.0, 50.0, 40.0, 30.0, 50.0, 80.0, 60.0, 40.0, 30.0, 20.0, 30.0, 40.0, 90.0, 30.0, 20.0, 78.0, 50.0, 120.0, 100.0, 19.0, 78.0, 70.0, 50.0, 60.0, 110.0, 40.0, 30.0, 40.0, 30.0, 50.0, 60.0, 60.0, 40.0, 37.0, -3.0, 60.0, 80.0, 30.0, 40.0, 40.0, 140.0, 100.0, 49.0, 100.0, 110.0, 40.0, 130.0, 70.0, 90.0, 45.0, 40.0, 160.0, 95.0, 110.0, 60.0, 170.0, 60.0, 110.0, 120.0, 100.0, 100.0, 120.0, 110.0, 110.0, 120.0, 140.0, 80.0, 50.0, 130.0, 55.0, 100.0, 90.0, 70.0, 50.0, 150.0, 38.0, 23.0, 50.0, 70.0, 34.0, 103.0, 120.0, 50.0, 160.0, 88.0, 74.0, 110.0, 130.0, 50.0, 96.0, 140.0, 110.0, 30.0, 70.0, 47.0, 130.0, 60.0, 90.0, 92.0, 35.0, 130.0, 60.0, 60.0, 110.0, 20.0, 90.0, 170.0, 100.0, 80.0, 130.0, 90.0, 10.0, 47.0, 50.0, 70.0, 100.0, 26.0, 80.0, 100.0, 60.0, 70.0, 120.0, 90.0, 48.0, 140.0, 50.0, 66.0, 40.0, 99.0, 80.0, 140.0, 120.0, 30.0, 40.0, 37.0, 38.0, 66.0, 120.0, 7.0, 120.0, 24.0, 50.0, 57.0, 60.0, 70.0, 90.0, 145.0, 30.0, 99.0, 80.0, 110.0, 80.0, 80.0, 70.0, 70.0, 70.0, 30.0, 50.0, 60.0, 10.0, 110.0, 50.0, 50.0, 60.0, 150.0, 27.0, 118.0, 130.0, 50.0, 120.0, 93.0, 30.0, 40.0, 27.0, 130.0, 70.0, 10.0, 140.0, 110.0, 30.0, 30.0, 160.0, 140.0, 100.0, 180.0, 40.0, 104.0, 14.0, 140.0, 50.0, 34.0, 70.0, 70.0, 110.0, 40.0, 59.0, 70.0, 100.0, 50.0, 100.0, 58.0, 34.0, 100.0, 0.0, 60.0, 82.0, 190.0, 39.0, 130.0, 90.0, 30.0, 70.0, 30.0, 5.0, 30.0, 60.0, 90.0, 110.0, 120.0, 130.0, 70.0, 66.0, 50.0, 190.0, 56.0, 130.0, 160.0, 140.0, 180.0, 140.0, 85.0, 100.0, 50.0, 30.0, 70.0, 70.0, 0.0, 60.0, 110.0, 10.0, 152.0, 40.0, 90.0, 147.0, 160.0, 80.0, 26.0, 80.0, 50.0, 80.0, 70.0, -2.0, 100.0, 210.0, 90.0, 140.0, 140.0, 120.0, 60.0, 80.0, 35.0, 110.0, -13.0, 80.0, 80.0, 80.0, 90.0, 100.0, 50.0, 60.0, 81.0, 110.0, 140.0, 160.0, 80.0, 110.0, 50.0, 80.0, 130.0, 10.0, 100.0, 16.0, 128.0, 10.0, 60.0, 37.0, 29.0, 100.0, 32.0, 10.0, 10.0, 80.0, 29.0, 170.0, 28.0, 50.0, 50.0, 36.0, 35.0, 110.0, 20.0, 78.0, 80.0, 60.0, 100.0, 80.0, 60.0, 100.0, 140.0, 38.0, 107.0, 50.0, 60.0, 60.0, 100.0, 90.0, 50.0, 27.0, 67.0, 120.0, 130.0, 50.0, 3.0, 40.0, 49.0, 60.0, 30.0, 100.0, 110.0, 36.0, 60.0, 64.0, 30.0, 90.0, 60.0, 50.0, 20.0, 13.0, 46.0, 39.0, 120.0, 60.0, 30.0, 100.0, 50.0, 10.0, 50.0, 100.0, 40.0, 10.0, 60.0, 130.0, 100.0, 160.0, 109.0, 77.0, 101.0, 120.0, 110.0, 110.0, 47.0, 100.0, 113.0, 170.0, 69.0, 138.0, 90.0, 170.0, 90.0, 80.0, 120.0, 130.0, 90.0, 40.0, 90.0, 160.0, 59.0, 60.0, 130.0, 50.0, 27.0, 24.0, 30.0, 60.0, 40.0, 75.0, 90.0, 173.0, 20.0, 23.0, 103.0, 70.0, 80.0, 70.0, 140.0, 10.0, 120.0, 50.0, 100.0, 40.0, 140.0, 100.0, 210.0, 130.0, 80.0, 130.0, 60.0, 90.0, 100.0, 89.0, 100.0, 30.0, 80.0, 110.0, 54.0, 40.0, 10.0, 29.0, 100.0, 58.0, 30.0, 10.0, 150.0, 25.0, 67.0, 30.0, 32.0, 20.0, 27.0, 140.0, 32.0, 50.0, 80.0, 90.0, 150.0, 30.0, 50.0, 1.0, 100.0, 150.0, 10.0, 40.0, 120.0, 50.0, 90.0, 100.0, 150.0, 30.0, 110.0, 29.0, 160.0, 71.0, 100.0, 110.0, 90.0, 80.0, 70.0, 90.0, 11.0, 60.0, 263.0, 40.0, 70.0, 60.0, 70.0, 30.0, 110.0, 40.0, 40.0, 60.0, 80.0, 20.0, 85.0, 70.0, 100.0, 39.0, 50.0, 50.0, 90.0, 90.0, 50.0, 50.0, 110.0, 80.0, 30.0, 80.0, 150.0, 50.0, 70.0, 30.0, 100.0, 160.0, 180.0, 60.0, 80.0, 115.0, 19.0, 120.0, 70.0, 47.0, 30.0, 110.0, 60.0, 70.0, 50.0, 130.0, 160.0, 40.0, 190.0, 120.0, 160.0, 50.0, 70.0, 130.0, 80.0, 110.0, 80.0, 90.0, 40.0, 130.0, 40.0, 120.0, 32.0, 120.0, 30.0, 90.0, 30.0, 80.0, 130.0, 30.0, 40.0, 60.0, 30.0, 30.0, 25.0, 100.0, 30.0, 40.0, 40.0, 110.0, 20.0, 140.0, 21.0, 70.0, 120.0, 11.0, 100.0, 40.0, 90.0, 90.0, 170.0, 120.0, 70.0, 80.0, 110.0, 70.0, 170.0, 100.0, 78.0, 185.0, 110.0, 60.0, 10.0, 60.0, 45.0, 120.0, 60.0, 50.0, 40.0, 130.0, 70.0, 60.0, 70.0, 80.0, 60.0, 80.0, 110.0, 70.0, 50.0, 60.0, 20.0, 60.0, 150.0, 60.0, 100.0, 90.0, 140.0, 150.0, 89.0, 100.0, 170.0, 90.0, 120.0, 120.0, 90.0, 50.0, 50.0, 90.0, 130.0, 30.0, 60.0, 90.0, 60.0, 80.0, 90.0, 93.0, 50.0, 45.0, 60.0, 29.0, 130.0, 60.0, 50.0, 90.0, 80.0, -8.0, 9.0, -1.0, 36.0, 50.0, 30.0, 40.0, 60.0, 90.0, 70.0, 90.0, 20.0, 15.0, 100.0, 40.0, 70.0, 70.0, 200.0, 39.0, 49.0, 45.0, 170.0, 50.0, 60.0, 90.0, 80.0, 40.0, 85.0, 50.0, 10.0, 20.0, 55.0, 90.0, 90.0, 20.0, 120.0, 150.0, 20.0, 10.0, 60.0, 80.0, 40.0, 130.0, 90.0, 60.0, 110.0, 80.0, 10.0, 34.0, 20.0, 78.0, 50.0, 60.0, 20.0, 0.0, 70.0, 120.0, 108.0, 100.0, 50.0, 40.0, 50.0, 70.0, 110.0, 30.0, 100.0, 16.0, 30.0, 50.0, 90.0, 40.0, 4.0, 90.0, 120.0, 110.0, 150.0, 25.0, 29.0, 79.0, 150.0, 16.0, 30.0, 110.0, 50.0, 150.0, 20.0, 90.0, 146.0, 20.0, 98.0, 110.0, 100.0, 50.0, 70.0, 150.0, 140.0, 7.0, 120.0, 60.0, 110.0, 30.0, 160.0, 65.0, 130.0, 90.0, 80.0, 110.0, 60.0, 60.0, 40.0, 110.0, 60.0, 85.0, 130.0, 75.0, 100.0, 60.0, 60.0, 110.0, 40.0, 130.0, 130.0, 45.0, 70.0, 110.0, 60.0, 15.0, 15.0, 100.0, 50.0, 60.0, 120.0, 20.0, 130.0, 100.0, 100.0, 30.0, 78.0, 33.0, 80.0, 60.0, 54.0, 60.0, 120.0, 140.0, 130.0, 40.0, 5.0, 40.0, 70.0, 21.0, 100.0, 120.0, 103.0, 65.0, 30.0, 90.0, 59.0, 50.0, 10.0, 100.0, 110.0, 0.0, 80.0, 80.0, 35.0, 80.0, 90.0, 80.0, 10.0, 100.0, 103.0, 69.0, 85.0, 110.0, 130.0, 0.0, 30.0, 50.0, 10.0, 18.0, 33.0, 60.0, 34.0, 50.0, 30.0, 140.0, 40.0, 4.0, 22.0, 60.0, 70.0, 60.0, 70.0, 60.0, 58.0, 130.0, 69.0, 40.0, 46.0, 60.0, 50.0, 160.0, 20.0, 50.0, 80.0, 106.0, 70.0, 40.0, 120.0, 35.0, 190.0, 87.0, 75.0, 100.0, 40.0, 60.0, 150.0, 40.0, 63.0, 64.0, 130.0, 110.0, -19.0, 130.0, 90.0, 80.0, 40.0, 90.0, 60.0, 98.0, 150.0, 77.0, 100.0, 70.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5107939986913268, "mean_inference_ms": 1.5113201384797077, "mean_action_processing_ms": 0.4827100858557856, "mean_env_wait_ms": 1.3228868496470212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011986732482910156, "StateBufferConnector_ms": 0.00917816162109375, "ViewRequirementAgentConnector_ms": 0.3610968589782715}, "num_episodes": 22, "episode_return_max": 1197.0, "episode_return_min": 315.0, "episode_return_mean": 745.59}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.79772452017797, "num_env_steps_trained_throughput_per_sec": 21.79772452017797, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 184399.682, "restore_workers_time_ms": 0.012, "training_step_time_ms": 184399.629, "sample_time_ms": 2454.946, "learn_time_ms": 181922.734, "learn_throughput": 21.987, "synch_weights_time_ms": 14.108}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "a22d3_00000", "date": "2024-08-06_06-39-42", "timestamp": 1722940782, "time_this_iter_s": 183.5148799419403, "time_total_s": 28572.098694086075, "pid": 3243, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 20, "kill_penalty": 10, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3a356a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28572.098694086075, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.24576923076923, "ram_util_percent": 75.44076923076922}}
