{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9988065309290942, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6466404194014266, "policy_loss": -0.010399496048060073, "vf_loss": 2.6554019931533213, "vf_explained_var": -0.0014520826177221264, "kl": 0.00818961923812207, "entropy": 1.5839417178536883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 25.0, "episode_reward_min": -470.0, "episode_reward_mean": -213.61111111111111, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -440.0}, "policy_reward_max": {"policy_0": 20.0}, "policy_reward_mean": {"policy_0": -21.36111111111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -65.0, -165.0, -360.0, -120.0, -160.0, -145.0, -160.0, -215.0, -395.0, -25.0, -175.0, -255.0, -185.0, -470.0, -380.0, -250.0, 25.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, -155.0, 20.0, 10.0, 0.0, -60.0, -165.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, -125.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -60.0, -20.0, 0.0, -5.0, -80.0, 0.0, -20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -440.0, 20.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -80.0, -25.0, 0.0, -15.0, 0.0, 20.0, 0.0, 10.0, 0.0, -50.0, 0.0, -125.0, 0.0, -15.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, -100.0, 0.0, 0.0, 10.0, -100.0, 0.0, -15.0, 0.0, 10.0, -85.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, -250.0, 10.0, 10.0, -165.0, 0.0, 0.0, 0.0, 0.0, -255.0, 0.0, -5.0, 20.0, 10.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, -105.0, -100.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, -140.0, -125.0, 0.0, 0.0, 0.0, -170.0, 0.0, -35.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -145.0, -325.0, 0.0, 0.0, 0.0, -135.0, -110.0, 0.0, 0.0, 10.0, 0.0, 0.0, -145.0, 0.0, 0.0, 10.0, 10.0, -270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.91917434276109, "mean_inference_ms": 1.479509634903359, "mean_action_processing_ms": 0.48215516147205734, "mean_env_wait_ms": 1.6136655716838313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012274583180745443, "StateBufferConnector_ms": 0.009244018130832247, "ViewRequirementAgentConnector_ms": 0.3999723328484429}, "num_episodes": 18, "episode_return_max": 25.0, "episode_return_min": -470.0, "episode_return_mean": -213.61111111111111}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.89983169629685, "num_env_steps_trained_throughput_per_sec": 20.89983169629685, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 191389.109, "restore_workers_time_ms": 0.018, "training_step_time_ms": 191389.059, "sample_time_ms": 3268.124, "learn_time_ms": 188106.153, "learn_throughput": 21.265, "synch_weights_time_ms": 9.814}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "33e63_00000", "date": "2024-06-18_21-10-07", "timestamp": 1718759407, "time_this_iter_s": 191.4370129108429, "time_total_s": 191.4370129108429, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32726c8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.4370129108429, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 20.46666666666667, "ram_util_percent": 82.27765567765567}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1914889396062167, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3062172931128035, "policy_loss": -0.009258475935984705, "vf_loss": 1.3140320433690524, "vf_explained_var": 0.012391019076965869, "kl": 0.0072186280476443454, "entropy": 1.573906955602197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -470.0, "episode_reward_mean": -111.52777777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -440.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -11.152777777777779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -65.0, -165.0, -360.0, -120.0, -160.0, -145.0, -160.0, -215.0, -395.0, -25.0, -175.0, -255.0, -185.0, -470.0, -380.0, -250.0, 25.0, -130.0, -90.0, -80.0, 40.0, -25.0, 30.0, 60.0, 50.0, -30.0, 20.0, 15.0, 10.0, 0.0, -15.0, -30.0, 30.0, -85.0, 60.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, -155.0, 20.0, 10.0, 0.0, -60.0, -165.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, -125.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -60.0, -20.0, 0.0, -5.0, -80.0, 0.0, -20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -440.0, 20.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -80.0, -25.0, 0.0, -15.0, 0.0, 20.0, 0.0, 10.0, 0.0, -50.0, 0.0, -125.0, 0.0, -15.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, -100.0, 0.0, 0.0, 10.0, -100.0, 0.0, -15.0, 0.0, 10.0, -85.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, -250.0, 10.0, 10.0, -165.0, 0.0, 0.0, 0.0, 0.0, -255.0, 0.0, -5.0, 20.0, 10.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, -105.0, -100.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, -140.0, -125.0, 0.0, 0.0, 0.0, -170.0, 0.0, -35.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -145.0, -325.0, 0.0, 0.0, 0.0, -135.0, -110.0, 0.0, 0.0, 10.0, 0.0, 0.0, -145.0, 0.0, 0.0, 10.0, 10.0, -270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, -35.0, 10.0, -5.0, 0.0, 0.0, -25.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 5.0, 30.0, -90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, -45.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -60.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -5.0, 10.0, -160.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8474766255320698, "mean_inference_ms": 1.4745475488885447, "mean_action_processing_ms": 0.4734697032554575, "mean_env_wait_ms": 1.5749638986741756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012453397115071615, "StateBufferConnector_ms": 0.009324153264363607, "ViewRequirementAgentConnector_ms": 0.4242764578925239}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -470.0, "episode_return_mean": -111.52777777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.49260850764906, "num_env_steps_trained_throughput_per_sec": 20.49260850764906, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 193290.722, "restore_workers_time_ms": 0.015, "training_step_time_ms": 193290.679, "sample_time_ms": 2965.711, "learn_time_ms": 190307.462, "learn_throughput": 21.019, "synch_weights_time_ms": 10.35}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "33e63_00000", "date": "2024-06-18_21-13-23", "timestamp": 1718759603, "time_this_iter_s": 195.199688911438, "time_total_s": 386.6367018222809, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32726c0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 386.6367018222809, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.469675090252707, "ram_util_percent": 82.04981949458485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3780454731089111, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1841077998550302, "policy_loss": -0.007815618046643203, "vf_loss": 1.1908151379487892, "vf_explained_var": 0.007659950360449485, "kl": 0.0055414005921821, "entropy": 1.570062066825688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -470.0, "episode_reward_mean": -67.77777777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -440.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -6.777777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -65.0, -165.0, -360.0, -120.0, -160.0, -145.0, -160.0, -215.0, -395.0, -25.0, -175.0, -255.0, -185.0, -470.0, -380.0, -250.0, 25.0, -130.0, -90.0, -80.0, 40.0, -25.0, 30.0, 60.0, 50.0, -30.0, 20.0, 15.0, 10.0, 0.0, -15.0, -30.0, 30.0, -85.0, 60.0, -50.0, 60.0, -70.0, 50.0, 45.0, 50.0, 70.0, 20.0, 40.0, 30.0, -30.0, 40.0, 30.0, 20.0, 55.0, -60.0, 20.0, 35.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, -155.0, 20.0, 10.0, 0.0, -60.0, -165.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, -125.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -60.0, -20.0, 0.0, -5.0, -80.0, 0.0, -20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -440.0, 20.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -80.0, -25.0, 0.0, -15.0, 0.0, 20.0, 0.0, 10.0, 0.0, -50.0, 0.0, -125.0, 0.0, -15.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, -100.0, 0.0, 0.0, 10.0, -100.0, 0.0, -15.0, 0.0, 10.0, -85.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, -250.0, 10.0, 10.0, -165.0, 0.0, 0.0, 0.0, 0.0, -255.0, 0.0, -5.0, 20.0, 10.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, -105.0, -100.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, -140.0, -125.0, 0.0, 0.0, 0.0, -170.0, 0.0, -35.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -145.0, -325.0, 0.0, 0.0, 0.0, -135.0, -110.0, 0.0, 0.0, 10.0, 0.0, 0.0, -145.0, 0.0, 0.0, 10.0, 10.0, -270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, -35.0, 10.0, -5.0, 0.0, 0.0, -25.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 5.0, 30.0, -90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, -45.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -60.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -5.0, 10.0, -160.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, -75.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -130.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -70.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8261558063466343, "mean_inference_ms": 1.4432034423442985, "mean_action_processing_ms": 0.4642611382267507, "mean_env_wait_ms": 1.5362807665864142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012386728216100621, "StateBufferConnector_ms": 0.009245342678493924, "ViewRequirementAgentConnector_ms": 0.40979076314855506}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -470.0, "episode_return_mean": -67.77777777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.407879644480364, "num_env_steps_trained_throughput_per_sec": 20.407879644480364, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 194194.726, "restore_workers_time_ms": 0.014, "training_step_time_ms": 194194.682, "sample_time_ms": 2925.063, "learn_time_ms": 191247.896, "learn_throughput": 20.915, "synch_weights_time_ms": 10.349}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "33e63_00000", "date": "2024-06-18_21-16-39", "timestamp": 1718759799, "time_this_iter_s": 196.01267886161804, "time_total_s": 582.6493806838989, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327268550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 582.6493806838989, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.325089605734767, "ram_util_percent": 81.82544802867385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.506959899460165, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.082551454228207, "policy_loss": -0.010347946121628149, "vf_loss": 2.0914821352377233, "vf_explained_var": 0.006289867439462989, "kl": 0.007086326458127982, "entropy": 1.5565307752392925, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 140.0, "episode_reward_min": -470.0, "episode_reward_mean": -36.388888888888886, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -440.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -3.638888888888889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -65.0, -165.0, -360.0, -120.0, -160.0, -145.0, -160.0, -215.0, -395.0, -25.0, -175.0, -255.0, -185.0, -470.0, -380.0, -250.0, 25.0, -130.0, -90.0, -80.0, 40.0, -25.0, 30.0, 60.0, 50.0, -30.0, 20.0, 15.0, 10.0, 0.0, -15.0, -30.0, 30.0, -85.0, 60.0, -50.0, 60.0, -70.0, 50.0, 45.0, 50.0, 70.0, 20.0, 40.0, 30.0, -30.0, 40.0, 30.0, 20.0, 55.0, -60.0, 20.0, 35.0, 20.0, 140.0, 50.0, 60.0, 30.0, 110.0, 30.0, 5.0, 60.0, 70.0, 45.0, 50.0, 110.0, 60.0, 45.0, 60.0, 40.0, 55.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, -155.0, 20.0, 10.0, 0.0, -60.0, -165.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, -125.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -60.0, -20.0, 0.0, -5.0, -80.0, 0.0, -20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -440.0, 20.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -80.0, -25.0, 0.0, -15.0, 0.0, 20.0, 0.0, 10.0, 0.0, -50.0, 0.0, -125.0, 0.0, -15.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, -100.0, 0.0, 0.0, 10.0, -100.0, 0.0, -15.0, 0.0, 10.0, -85.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, -250.0, 10.0, 10.0, -165.0, 0.0, 0.0, 0.0, 0.0, -255.0, 0.0, -5.0, 20.0, 10.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, -105.0, -100.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, -140.0, -125.0, 0.0, 0.0, 0.0, -170.0, 0.0, -35.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -145.0, -325.0, 0.0, 0.0, 0.0, -135.0, -110.0, 0.0, 0.0, 10.0, 0.0, 0.0, -145.0, 0.0, 0.0, 10.0, 10.0, -270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, -35.0, 10.0, -5.0, 0.0, 0.0, -25.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 5.0, 30.0, -90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, -45.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -60.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -5.0, 10.0, -160.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, -75.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -130.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -70.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 20.0, 0.0, 10.0, -5.0, 10.0, 0.0, 20.0, 20.0, -15.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.810172745186408, "mean_inference_ms": 1.4226414297815535, "mean_action_processing_ms": 0.4578169198294623, "mean_env_wait_ms": 1.510505042312675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013740857442220053, "StateBufferConnector_ms": 0.009395347701178657, "ViewRequirementAgentConnector_ms": 0.4145062632030911}, "num_episodes": 18, "episode_return_max": 140.0, "episode_return_min": -470.0, "episode_return_mean": -36.388888888888886}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.1447136802347, "num_env_steps_trained_throughput_per_sec": 21.1447136802347, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 192939.192, "restore_workers_time_ms": 0.014, "training_step_time_ms": 192939.148, "sample_time_ms": 2871.241, "learn_time_ms": 190047.188, "learn_throughput": 21.047, "synch_weights_time_ms": 10.202}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "33e63_00000", "date": "2024-06-18_21-19-48", "timestamp": 1718759988, "time_this_iter_s": 189.1825349330902, "time_total_s": 771.8319156169891, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272ebf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 771.8319156169891, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.429368029739777, "ram_util_percent": 80.52044609665427}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5266319591778155, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1042172761136095, "policy_loss": -0.010867039120510118, "vf_loss": 3.1134416786245644, "vf_explained_var": 0.01753760663211282, "kl": 0.008213181494757416, "entropy": 1.536845723000832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 290.0, "episode_reward_min": -470.0, "episode_reward_mean": 1.3131313131313131, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -440.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 0.13131313131313133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0, -65.0, -165.0, -360.0, -120.0, -160.0, -145.0, -160.0, -215.0, -395.0, -25.0, -175.0, -255.0, -185.0, -470.0, -380.0, -250.0, 25.0, -130.0, -90.0, -80.0, 40.0, -25.0, 30.0, 60.0, 50.0, -30.0, 20.0, 15.0, 10.0, 0.0, -15.0, -30.0, 30.0, -85.0, 60.0, -50.0, 60.0, -70.0, 50.0, 45.0, 50.0, 70.0, 20.0, 40.0, 30.0, -30.0, 40.0, 30.0, 20.0, 55.0, -60.0, 20.0, 35.0, 20.0, 140.0, 50.0, 60.0, 30.0, 110.0, 30.0, 5.0, 60.0, 70.0, 45.0, 50.0, 110.0, 60.0, 45.0, 60.0, 40.0, 55.0, 60.0, 240.0, 165.0, 40.0, 80.0, 75.0, 40.0, 90.0, 30.0, 90.0, 70.0, 180.0, 30.0, 90.0, 290.0, 105.0, 150.0, 160.0, 75.0, 110.0, 100.0, 40.0, 70.0, 60.0, 75.0, 150.0, 85.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, -155.0, 20.0, 10.0, 0.0, -60.0, -165.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, -125.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, -60.0, -20.0, 0.0, -5.0, -80.0, 0.0, -20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, -440.0, 20.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -80.0, -25.0, 0.0, -15.0, 0.0, 20.0, 0.0, 10.0, 0.0, -50.0, 0.0, -125.0, 0.0, -15.0, 0.0, 10.0, 0.0, -20.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, -100.0, 0.0, 0.0, 10.0, -100.0, 0.0, -15.0, 0.0, 10.0, -85.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, -250.0, 10.0, 10.0, -165.0, 0.0, 0.0, 0.0, 0.0, -255.0, 0.0, -5.0, 20.0, 10.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, -105.0, -100.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, -20.0, 0.0, -140.0, -125.0, 0.0, 0.0, 0.0, -170.0, 0.0, -35.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -145.0, -325.0, 0.0, 0.0, 0.0, -135.0, -110.0, 0.0, 0.0, 10.0, 0.0, 0.0, -145.0, 0.0, 0.0, 10.0, 10.0, -270.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, -35.0, 10.0, -5.0, 0.0, 0.0, -25.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 5.0, 30.0, -90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, -45.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -60.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -5.0, 10.0, -160.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, -75.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -130.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -70.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 20.0, 0.0, 10.0, -5.0, 10.0, 0.0, 20.0, 20.0, -15.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 40.0, 10.0, 50.0, 0.0, 40.0, 0.0, 25.0, 20.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 50.0, 0.0, 0.0, 60.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 70.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 20.0, 0.0, 40.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, -15.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, -25.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7940363514682298, "mean_inference_ms": 1.3991653912790258, "mean_action_processing_ms": 0.4507395943763343, "mean_env_wait_ms": 1.482854163706362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013208148455378986, "StateBufferConnector_ms": 0.009348898222952179, "ViewRequirementAgentConnector_ms": 0.4150424340758661}, "num_episodes": 27, "episode_return_max": 290.0, "episode_return_min": -470.0, "episode_return_mean": 1.3131313131313131}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.691766081077862, "num_env_steps_trained_throughput_per_sec": 20.691766081077862, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 193014.078, "restore_workers_time_ms": 0.014, "training_step_time_ms": 193014.033, "sample_time_ms": 2833.608, "learn_time_ms": 190160.269, "learn_throughput": 21.035, "synch_weights_time_ms": 10.211}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "33e63_00000", "date": "2024-06-18_21-23-01", "timestamp": 1718760181, "time_this_iter_s": 193.32138919830322, "time_total_s": 965.1533048152924, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3271d6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 965.1533048152924, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.47007299270073, "ram_util_percent": 81.46277372262772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2331842365991066, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6533001335030293, "policy_loss": -0.010356141569705817, "vf_loss": 3.662019455369415, "vf_explained_var": 0.009151742106682449, "kl": 0.008184098457600304, "entropy": 1.523683744294448, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 360.0, "episode_reward_min": -130.0, "episode_reward_mean": 68.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -160.0}, "policy_reward_max": {"policy_0": 70.0}, "policy_reward_mean": {"policy_0": 6.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25.0, -130.0, -90.0, -80.0, 40.0, -25.0, 30.0, 60.0, 50.0, -30.0, 20.0, 15.0, 10.0, 0.0, -15.0, -30.0, 30.0, -85.0, 60.0, -50.0, 60.0, -70.0, 50.0, 45.0, 50.0, 70.0, 20.0, 40.0, 30.0, -30.0, 40.0, 30.0, 20.0, 55.0, -60.0, 20.0, 35.0, 20.0, 140.0, 50.0, 60.0, 30.0, 110.0, 30.0, 5.0, 60.0, 70.0, 45.0, 50.0, 110.0, 60.0, 45.0, 60.0, 40.0, 55.0, 60.0, 240.0, 165.0, 40.0, 80.0, 75.0, 40.0, 90.0, 30.0, 90.0, 70.0, 180.0, 30.0, 90.0, 290.0, 105.0, 150.0, 160.0, 75.0, 110.0, 100.0, 40.0, 70.0, 60.0, 75.0, 150.0, 85.0, 140.0, 110.0, 210.0, 100.0, 120.0, 120.0, 120.0, 140.0, 145.0, 100.0, 100.0, 220.0, 150.0, 220.0, 360.0, 90.0, 170.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 0.0, -135.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, -35.0, 10.0, -5.0, 0.0, 0.0, -25.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 5.0, 30.0, -90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, -50.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, -10.0, -15.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, -5.0, 10.0, 10.0, 0.0, 0.0, 10.0, -45.0, 20.0, 0.0, 0.0, 0.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -60.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, -5.0, 10.0, -160.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, -75.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -130.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -70.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 20.0, 0.0, 10.0, -5.0, 10.0, 0.0, 20.0, 20.0, -15.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 40.0, 10.0, 50.0, 0.0, 40.0, 0.0, 25.0, 20.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 50.0, 0.0, 0.0, 60.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 70.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 20.0, 0.0, 40.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, -15.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, -25.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0, 40.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 50.0, 20.0, 40.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 15.0, 20.0, 10.0, 10.0, 10.0, 0.0, 70.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, 40.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 20.0, 40.0, 30.0, 20.0, 20.0, 40.0, 50.0, 20.0, 70.0, 0.0, 50.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, -20.0, 50.0, 20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7627893880141017, "mean_inference_ms": 1.3740407092198432, "mean_action_processing_ms": 0.44167210277635166, "mean_env_wait_ms": 1.4452430998035968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01336979866027832, "StateBufferConnector_ms": 0.009287357330322266, "ViewRequirementAgentConnector_ms": 0.4116699695587158}, "num_episodes": 18, "episode_return_max": 360.0, "episode_return_min": -130.0, "episode_return_mean": 68.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.647847127191802, "num_env_steps_trained_throughput_per_sec": 21.647847127191802, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 191641.048, "restore_workers_time_ms": 0.013, "training_step_time_ms": 191640.965, "sample_time_ms": 2823.221, "learn_time_ms": 188795.077, "learn_throughput": 21.187, "synch_weights_time_ms": 11.556}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "33e63_00000", "date": "2024-06-18_21-26-06", "timestamp": 1718760366, "time_this_iter_s": 184.78976106643677, "time_total_s": 1149.9430658817291, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3271d6b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1149.9430658817291, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.712927756653993, "ram_util_percent": 80.32889733840304}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7020029476719796, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.096363198719086, "policy_loss": -0.01036540382334425, "vf_loss": 4.10512440448371, "vf_explained_var": 0.005289691216902484, "kl": 0.008021008927656942, "entropy": 1.4918021220876514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": -70.0, "episode_reward_mean": 109.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 160.0}, "policy_reward_mean": {"policy_0": 10.905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, -50.0, 60.0, -70.0, 50.0, 45.0, 50.0, 70.0, 20.0, 40.0, 30.0, -30.0, 40.0, 30.0, 20.0, 55.0, -60.0, 20.0, 35.0, 20.0, 140.0, 50.0, 60.0, 30.0, 110.0, 30.0, 5.0, 60.0, 70.0, 45.0, 50.0, 110.0, 60.0, 45.0, 60.0, 40.0, 55.0, 60.0, 240.0, 165.0, 40.0, 80.0, 75.0, 40.0, 90.0, 30.0, 90.0, 70.0, 180.0, 30.0, 90.0, 290.0, 105.0, 150.0, 160.0, 75.0, 110.0, 100.0, 40.0, 70.0, 60.0, 75.0, 150.0, 85.0, 140.0, 110.0, 210.0, 100.0, 120.0, 120.0, 120.0, 140.0, 145.0, 100.0, 100.0, 220.0, 150.0, 220.0, 360.0, 90.0, 170.0, 210.0, 300.0, 140.0, 200.0, 150.0, 270.0, 240.0, 230.0, 200.0, 70.0, 255.0, 125.0, 325.0, 380.0, 310.0, 160.0, 170.0, 180.0, 170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, -75.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, -130.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, -5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, -70.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, -10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 20.0, 0.0, 10.0, -5.0, 10.0, 0.0, 20.0, 20.0, -15.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 40.0, 10.0, 50.0, 0.0, 40.0, 0.0, 25.0, 20.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 50.0, 0.0, 0.0, 60.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 70.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 20.0, 0.0, 40.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, -15.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, -25.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0, 40.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 50.0, 20.0, 40.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 15.0, 20.0, 10.0, 10.0, 10.0, 0.0, 70.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, 40.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 20.0, 40.0, 30.0, 20.0, 20.0, 40.0, 50.0, 20.0, 70.0, 0.0, 50.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, -20.0, 50.0, 20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 40.0, 10.0, 10.0, 90.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, -10.0, -5.0, 20.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 150.0, 0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 10.0, 35.0, 10.0, 50.0, 30.0, 40.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 20.0, 160.0, 40.0, 40.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, -30.0, 30.0, 30.0, 20.0, 10.0, 50.0, 0.0, 40.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.744165805308051, "mean_inference_ms": 1.3514820404105508, "mean_action_processing_ms": 0.4339749092718776, "mean_env_wait_ms": 1.414370838694512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013591766357421875, "StateBufferConnector_ms": 0.009331226348876953, "ViewRequirementAgentConnector_ms": 0.4124917984008789}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": -70.0, "episode_return_mean": 109.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.220895979747766, "num_env_steps_trained_throughput_per_sec": 21.220895979747766, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 191191.394, "restore_workers_time_ms": 0.014, "training_step_time_ms": 191191.315, "sample_time_ms": 2774.341, "learn_time_ms": 188394.64, "learn_throughput": 21.232, "synch_weights_time_ms": 11.611}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "33e63_00000", "date": "2024-06-18_21-29-15", "timestamp": 1718760555, "time_this_iter_s": 188.49974083900452, "time_total_s": 1338.4428067207336, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272ebee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1338.4428067207336, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 22.912734082397, "ram_util_percent": 81.84531835205993}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4486887105451987, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.194385298067769, "policy_loss": -0.010267506096352396, "vf_loss": 4.2028808044295465, "vf_explained_var": 0.0027218487760383354, "kl": 0.00885999073943135, "entropy": 1.4666682346433368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 380.0, "episode_reward_min": 5.0, "episode_reward_mean": 146.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -55.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 14.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [35.0, 20.0, 140.0, 50.0, 60.0, 30.0, 110.0, 30.0, 5.0, 60.0, 70.0, 45.0, 50.0, 110.0, 60.0, 45.0, 60.0, 40.0, 55.0, 60.0, 240.0, 165.0, 40.0, 80.0, 75.0, 40.0, 90.0, 30.0, 90.0, 70.0, 180.0, 30.0, 90.0, 290.0, 105.0, 150.0, 160.0, 75.0, 110.0, 100.0, 40.0, 70.0, 60.0, 75.0, 150.0, 85.0, 140.0, 110.0, 210.0, 100.0, 120.0, 120.0, 120.0, 140.0, 145.0, 100.0, 100.0, 220.0, 150.0, 220.0, 360.0, 90.0, 170.0, 210.0, 300.0, 140.0, 200.0, 150.0, 270.0, 240.0, 230.0, 200.0, 70.0, 255.0, 125.0, 325.0, 380.0, 310.0, 160.0, 170.0, 180.0, 170.0, 270.0, 130.0, 235.0, 205.0, 380.0, 330.0, 230.0, 185.0, 220.0, 210.0, 280.0, 310.0, 180.0, 130.0, 140.0, 290.0, 220.0, 150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 0.0, 0.0, -5.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, -30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, -40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, -55.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 5.0, 20.0, 0.0, 10.0, -5.0, 10.0, 0.0, 20.0, 20.0, -15.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 5.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 40.0, 10.0, 50.0, 0.0, 40.0, 0.0, 25.0, 20.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 50.0, 0.0, 0.0, 60.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 70.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 20.0, 0.0, 40.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, -15.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, -25.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0, 40.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 50.0, 20.0, 40.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 15.0, 20.0, 10.0, 10.0, 10.0, 0.0, 70.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, 40.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 20.0, 40.0, 30.0, 20.0, 20.0, 40.0, 50.0, 20.0, 70.0, 0.0, 50.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, -20.0, 50.0, 20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 40.0, 10.0, 10.0, 90.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, -10.0, -5.0, 20.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 150.0, 0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 10.0, 35.0, 10.0, 50.0, 30.0, 40.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 20.0, 160.0, 40.0, 40.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, -30.0, 30.0, 30.0, 20.0, 10.0, 50.0, 0.0, 40.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 0.0, -25.0, 20.0, 30.0, 0.0, 30.0, 70.0, 30.0, 10.0, 30.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 35.0, 0.0, 20.0, 20.0, 10.0, 0.0, 250.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 30.0, 90.0, 50.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, -15.0, 0.0, 0.0, 40.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 40.0, 0.0, 30.0, 10.0, 50.0, 0.0, 30.0, 20.0, 30.0, 0.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, -50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 40.0, 160.0, 20.0, 150.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 30.0, 70.0, 60.0, 50.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.724078167587158, "mean_inference_ms": 1.3436317067460255, "mean_action_processing_ms": 0.4289141816176294, "mean_env_wait_ms": 1.3946229270321362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013484001159667969, "StateBufferConnector_ms": 0.009219884872436523, "ViewRequirementAgentConnector_ms": 0.40245604515075684}, "num_episodes": 18, "episode_return_max": 380.0, "episode_return_min": 5.0, "episode_return_mean": 146.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.035218612355727, "num_env_steps_trained_throughput_per_sec": 21.035218612355727, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 191062.131, "restore_workers_time_ms": 0.014, "training_step_time_ms": 191062.046, "sample_time_ms": 2757.511, "learn_time_ms": 188280.682, "learn_throughput": 21.245, "synch_weights_time_ms": 11.748}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "33e63_00000", "date": "2024-06-18_21-32-25", "timestamp": 1718760745, "time_this_iter_s": 190.16724705696106, "time_total_s": 1528.6100537776947, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327240ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1528.6100537776947, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.41301115241636, "ram_util_percent": 80.5275092936803}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7754740386280896, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.575701996312736, "policy_loss": -0.011662375365524762, "vf_loss": 4.585675718812262, "vf_explained_var": 0.003359754328021861, "kl": 0.008443283954842947, "entropy": 1.4449745748116694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 570.0, "episode_reward_min": 30.0, "episode_reward_mean": 186.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 18.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [55.0, 60.0, 240.0, 165.0, 40.0, 80.0, 75.0, 40.0, 90.0, 30.0, 90.0, 70.0, 180.0, 30.0, 90.0, 290.0, 105.0, 150.0, 160.0, 75.0, 110.0, 100.0, 40.0, 70.0, 60.0, 75.0, 150.0, 85.0, 140.0, 110.0, 210.0, 100.0, 120.0, 120.0, 120.0, 140.0, 145.0, 100.0, 100.0, 220.0, 150.0, 220.0, 360.0, 90.0, 170.0, 210.0, 300.0, 140.0, 200.0, 150.0, 270.0, 240.0, 230.0, 200.0, 70.0, 255.0, 125.0, 325.0, 380.0, 310.0, 160.0, 170.0, 180.0, 170.0, 270.0, 130.0, 235.0, 205.0, 380.0, 330.0, 230.0, 185.0, 220.0, 210.0, 280.0, 310.0, 180.0, 130.0, 140.0, 290.0, 220.0, 150.0, 270.0, 260.0, 150.0, 340.0, 225.0, 140.0, 230.0, 440.0, 160.0, 340.0, 330.0, 420.0, 570.0, 300.0, 190.0, 320.0, 170.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, -25.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 40.0, 10.0, 50.0, 0.0, 40.0, 0.0, 25.0, 20.0, 30.0, 0.0, 20.0, 40.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 40.0, 40.0, 20.0, 50.0, 0.0, 0.0, 60.0, 20.0, 30.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, 0.0, 40.0, 0.0, 10.0, 70.0, 0.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 20.0, 0.0, 40.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, -15.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 10.0, -25.0, 20.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0, 40.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 50.0, 20.0, 40.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 15.0, 20.0, 10.0, 10.0, 10.0, 0.0, 70.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, 40.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 20.0, 40.0, 30.0, 20.0, 20.0, 40.0, 50.0, 20.0, 70.0, 0.0, 50.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, -20.0, 50.0, 20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 40.0, 10.0, 10.0, 90.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, -10.0, -5.0, 20.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 150.0, 0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 10.0, 35.0, 10.0, 50.0, 30.0, 40.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 20.0, 160.0, 40.0, 40.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, -30.0, 30.0, 30.0, 20.0, 10.0, 50.0, 0.0, 40.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 0.0, -25.0, 20.0, 30.0, 0.0, 30.0, 70.0, 30.0, 10.0, 30.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 35.0, 0.0, 20.0, 20.0, 10.0, 0.0, 250.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 30.0, 90.0, 50.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, -15.0, 0.0, 0.0, 40.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 40.0, 0.0, 30.0, 10.0, 50.0, 0.0, 30.0, 20.0, 30.0, 0.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, -50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 40.0, 160.0, 20.0, 150.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 30.0, 70.0, 60.0, 50.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 50.0, 10.0, 10.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 90.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 40.0, 40.0, 40.0, 40.0, 10.0, 0.0, 35.0, 20.0, 30.0, 10.0, 0.0, 40.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 60.0, 10.0, 0.0, 10.0, 40.0, 50.0, 30.0, 40.0, 150.0, 160.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -10.0, 90.0, 10.0, 0.0, 10.0, 20.0, 0.0, 60.0, 20.0, 30.0, 30.0, 50.0, 30.0, 20.0, 10.0, 30.0, 60.0, 60.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 20.0, 70.0, 10.0, 30.0, 20.0, 60.0, 170.0, 80.0, 20.0, 0.0, 20.0, 10.0, 10.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 30.0, 20.0, 20.0, 210.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, -10.0, 20.0, 80.0, 50.0, 40.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7071398383173944, "mean_inference_ms": 1.3417990588819242, "mean_action_processing_ms": 0.4245958855918097, "mean_env_wait_ms": 1.3776127872276616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012991189956665039, "StateBufferConnector_ms": 0.009110689163208008, "ViewRequirementAgentConnector_ms": 0.3966550827026367}, "num_episodes": 18, "episode_return_max": 570.0, "episode_return_min": 30.0, "episode_return_mean": 186.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.232093172449012, "num_env_steps_trained_throughput_per_sec": 21.232093172449012, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 190765.68, "restore_workers_time_ms": 0.014, "training_step_time_ms": 190765.598, "sample_time_ms": 2741.122, "learn_time_ms": 188001.356, "learn_throughput": 21.276, "synch_weights_time_ms": 11.6}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "33e63_00000", "date": "2024-06-18_21-35-33", "timestamp": 1718760933, "time_this_iter_s": 188.41477727890015, "time_total_s": 1717.0248310565948, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272ae670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1717.0248310565948, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.549624060150375, "ram_util_percent": 80.65075187969926}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3298892508997833, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.605616862197526, "policy_loss": -0.012295410769180264, "vf_loss": 4.6160803656735485, "vf_explained_var": 0.005958926296843507, "kl": 0.009159529827600963, "entropy": 1.404285907478759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 570.0, "episode_reward_min": 70.0, "episode_reward_mean": 231.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 23.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [85.0, 140.0, 110.0, 210.0, 100.0, 120.0, 120.0, 120.0, 140.0, 145.0, 100.0, 100.0, 220.0, 150.0, 220.0, 360.0, 90.0, 170.0, 210.0, 300.0, 140.0, 200.0, 150.0, 270.0, 240.0, 230.0, 200.0, 70.0, 255.0, 125.0, 325.0, 380.0, 310.0, 160.0, 170.0, 180.0, 170.0, 270.0, 130.0, 235.0, 205.0, 380.0, 330.0, 230.0, 185.0, 220.0, 210.0, 280.0, 310.0, 180.0, 130.0, 140.0, 290.0, 220.0, 150.0, 270.0, 260.0, 150.0, 340.0, 225.0, 140.0, 230.0, 440.0, 160.0, 340.0, 330.0, 420.0, 570.0, 300.0, 190.0, 320.0, 170.0, 240.0, 110.0, 140.0, 550.0, 440.0, 210.0, 290.0, 240.0, 265.0, 180.0, 250.0, 160.0, 150.0, 310.0, 430.0, 390.0, 280.0, 315.0, 280.0, 200.0, 220.0, 200.0, 120.0, 200.0, 350.0, 230.0, 350.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 25.0, 10.0, 40.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 50.0, 20.0, 40.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 15.0, 20.0, 10.0, 10.0, 10.0, 0.0, 70.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 40.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 30.0, 40.0, 30.0, 50.0, 0.0, 10.0, 10.0, 40.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 20.0, 40.0, 30.0, 20.0, 20.0, 40.0, 50.0, 20.0, 70.0, 0.0, 50.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 10.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 0.0, 10.0, -20.0, 50.0, 20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 40.0, 10.0, 10.0, 90.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, -10.0, -5.0, 20.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 150.0, 0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 10.0, 35.0, 10.0, 50.0, 30.0, 40.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 20.0, 160.0, 40.0, 40.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, -30.0, 30.0, 30.0, 20.0, 10.0, 50.0, 0.0, 40.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 0.0, -25.0, 20.0, 30.0, 0.0, 30.0, 70.0, 30.0, 10.0, 30.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 35.0, 0.0, 20.0, 20.0, 10.0, 0.0, 250.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 30.0, 90.0, 50.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, -15.0, 0.0, 0.0, 40.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 40.0, 0.0, 30.0, 10.0, 50.0, 0.0, 30.0, 20.0, 30.0, 0.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, -50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 40.0, 160.0, 20.0, 150.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 30.0, 70.0, 60.0, 50.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 50.0, 10.0, 10.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 90.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 40.0, 40.0, 40.0, 40.0, 10.0, 0.0, 35.0, 20.0, 30.0, 10.0, 0.0, 40.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 60.0, 10.0, 0.0, 10.0, 40.0, 50.0, 30.0, 40.0, 150.0, 160.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -10.0, 90.0, 10.0, 0.0, 10.0, 20.0, 0.0, 60.0, 20.0, 30.0, 30.0, 50.0, 30.0, 20.0, 10.0, 30.0, 60.0, 60.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 20.0, 70.0, 10.0, 30.0, 20.0, 60.0, 170.0, 80.0, 20.0, 0.0, 20.0, 10.0, 10.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 30.0, 20.0, 20.0, 210.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, -10.0, 20.0, 80.0, 50.0, 40.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 0.0, 60.0, 70.0, 60.0, 0.0, 0.0, 180.0, 10.0, 40.0, 40.0, 90.0, 30.0, 20.0, 10.0, 50.0, 20.0, 160.0, 50.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 30.0, 50.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 10.0, 40.0, 30.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 40.0, 30.0, 40.0, 20.0, 10.0, 40.0, -15.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 30.0, 50.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 70.0, 20.0, 20.0, 10.0, 0.0, 30.0, 50.0, 40.0, 60.0, 30.0, 20.0, 10.0, 50.0, 20.0, 0.0, 70.0, 40.0, 50.0, 0.0, 90.0, 20.0, 50.0, 30.0, 30.0, 50.0, 30.0, 30.0, 0.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 50.0, 30.0, 0.0, 10.0, 10.0, 30.0, 20.0, 60.0, 20.0, 60.0, 40.0, 40.0, 25.0, 30.0, 50.0, 30.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 30.0, 0.0, 0.0, 70.0, 20.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 30.0, 40.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 60.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 10.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 50.0, 80.0, 40.0, 40.0, 30.0, 20.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 20.0, 70.0, 20.0, 60.0, 30.0, 10.0, 40.0, 30.0, 30.0, 50.0, 10.0, 60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6863134648601146, "mean_inference_ms": 1.3492024326034464, "mean_action_processing_ms": 0.41917608485215246, "mean_env_wait_ms": 1.356852494391241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013083934783935547, "StateBufferConnector_ms": 0.009121179580688477, "ViewRequirementAgentConnector_ms": 0.38774681091308594}, "num_episodes": 27, "episode_return_max": 570.0, "episode_return_min": 70.0, "episode_return_mean": 231.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.33145356191667, "num_env_steps_trained_throughput_per_sec": 21.33145356191667, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 190440.766, "restore_workers_time_ms": 0.013, "training_step_time_ms": 190440.687, "sample_time_ms": 2773.427, "learn_time_ms": 187643.354, "learn_throughput": 21.317, "synch_weights_time_ms": 11.427}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "33e63_00000", "date": "2024-06-18_21-38-41", "timestamp": 1718761121, "time_this_iter_s": 187.54063940048218, "time_total_s": 1904.565470457077, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1904.565470457077, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 16.325563909774438, "ram_util_percent": 80.86278195488721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.76369420508988, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.089739207820263, "policy_loss": -0.010986157395148945, "vf_loss": 5.099081387738196, "vf_explained_var": 0.001163784053505927, "kl": 0.008219867990891966, "entropy": 1.3874073298975302, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 670.0, "episode_reward_min": 70.0, "episode_reward_mean": 266.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 310.0}, "policy_reward_mean": {"policy_0": 26.69}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 300.0, 140.0, 200.0, 150.0, 270.0, 240.0, 230.0, 200.0, 70.0, 255.0, 125.0, 325.0, 380.0, 310.0, 160.0, 170.0, 180.0, 170.0, 270.0, 130.0, 235.0, 205.0, 380.0, 330.0, 230.0, 185.0, 220.0, 210.0, 280.0, 310.0, 180.0, 130.0, 140.0, 290.0, 220.0, 150.0, 270.0, 260.0, 150.0, 340.0, 225.0, 140.0, 230.0, 440.0, 160.0, 340.0, 330.0, 420.0, 570.0, 300.0, 190.0, 320.0, 170.0, 240.0, 110.0, 140.0, 550.0, 440.0, 210.0, 290.0, 240.0, 265.0, 180.0, 250.0, 160.0, 150.0, 310.0, 430.0, 390.0, 280.0, 315.0, 280.0, 200.0, 220.0, 200.0, 120.0, 200.0, 350.0, 230.0, 350.0, 280.0, 370.0, 325.0, 440.0, 220.0, 670.0, 530.0, 350.0, 490.0, 300.0, 230.0, 400.0, 165.0, 260.0, 290.0, 385.0, 330.0, 230.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 40.0, 30.0, 10.0, 20.0, 20.0, 20.0, 10.0, 0.0, 30.0, 40.0, 10.0, 10.0, 90.0, 30.0, 30.0, 30.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 20.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 30.0, 30.0, 0.0, 20.0, 30.0, 50.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, -10.0, -5.0, 20.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 150.0, 0.0, 40.0, 40.0, 0.0, 0.0, 0.0, 20.0, 10.0, 5.0, 10.0, 35.0, 10.0, 50.0, 30.0, 40.0, 50.0, 20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 20.0, 160.0, 40.0, 40.0, 20.0, 10.0, 10.0, 30.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, -30.0, 30.0, 30.0, 20.0, 10.0, 50.0, 0.0, 40.0, 10.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 40.0, 30.0, 10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 0.0, -25.0, 20.0, 30.0, 0.0, 30.0, 70.0, 30.0, 10.0, 30.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 35.0, 0.0, 20.0, 20.0, 10.0, 0.0, 250.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 30.0, 90.0, 50.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, -15.0, 0.0, 0.0, 40.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 40.0, 0.0, 30.0, 10.0, 50.0, 0.0, 30.0, 20.0, 30.0, 0.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, -50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 40.0, 160.0, 20.0, 150.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 30.0, 70.0, 60.0, 50.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 50.0, 10.0, 10.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 90.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 40.0, 40.0, 40.0, 40.0, 10.0, 0.0, 35.0, 20.0, 30.0, 10.0, 0.0, 40.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 60.0, 10.0, 0.0, 10.0, 40.0, 50.0, 30.0, 40.0, 150.0, 160.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -10.0, 90.0, 10.0, 0.0, 10.0, 20.0, 0.0, 60.0, 20.0, 30.0, 30.0, 50.0, 30.0, 20.0, 10.0, 30.0, 60.0, 60.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 20.0, 70.0, 10.0, 30.0, 20.0, 60.0, 170.0, 80.0, 20.0, 0.0, 20.0, 10.0, 10.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 30.0, 20.0, 20.0, 210.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, -10.0, 20.0, 80.0, 50.0, 40.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 0.0, 60.0, 70.0, 60.0, 0.0, 0.0, 180.0, 10.0, 40.0, 40.0, 90.0, 30.0, 20.0, 10.0, 50.0, 20.0, 160.0, 50.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 30.0, 50.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 10.0, 40.0, 30.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 40.0, 30.0, 40.0, 20.0, 10.0, 40.0, -15.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 30.0, 50.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 70.0, 20.0, 20.0, 10.0, 0.0, 30.0, 50.0, 40.0, 60.0, 30.0, 20.0, 10.0, 50.0, 20.0, 0.0, 70.0, 40.0, 50.0, 0.0, 90.0, 20.0, 50.0, 30.0, 30.0, 50.0, 30.0, 30.0, 0.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 50.0, 30.0, 0.0, 10.0, 10.0, 30.0, 20.0, 60.0, 20.0, 60.0, 40.0, 40.0, 25.0, 30.0, 50.0, 30.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 30.0, 0.0, 0.0, 70.0, 20.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 30.0, 40.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 60.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 10.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 50.0, 80.0, 40.0, 40.0, 30.0, 20.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 20.0, 70.0, 20.0, 60.0, 30.0, 10.0, 40.0, 30.0, 30.0, 50.0, 10.0, 60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0, 30.0, 30.0, 20.0, 10.0, 60.0, 40.0, 10.0, 40.0, 50.0, 80.0, 0.0, 50.0, 40.0, 20.0, 30.0, 40.0, 150.0, -115.0, 70.0, 40.0, 30.0, 0.0, 40.0, 20.0, 30.0, 70.0, 160.0, 40.0, 30.0, 20.0, 10.0, 10.0, 60.0, 20.0, 50.0, 10.0, 0.0, 10.0, 40.0, 10.0, 150.0, -50.0, 260.0, 150.0, -80.0, 0.0, 20.0, 180.0, 40.0, 0.0, 310.0, 20.0, 30.0, 10.0, 50.0, 40.0, 20.0, 0.0, 10.0, 40.0, 10.0, 0.0, 20.0, 150.0, -20.0, 30.0, 50.0, 20.0, 40.0, 50.0, 70.0, 20.0, 20.0, 50.0, 100.0, 80.0, 20.0, 30.0, 40.0, 60.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 50.0, 20.0, 40.0, 110.0, 50.0, 40.0, 70.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, -5.0, 20.0, 40.0, 30.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 50.0, 20.0, 70.0, 40.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 40.0, 50.0, 20.0, 40.0, 60.0, 5.0, 20.0, 30.0, 70.0, 50.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 80.0, 40.0, 20.0, 0.0, 30.0, 20.0, 10.0, 160.0, 0.0, -100.0, 20.0, 40.0, 50.0, 0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6731251520630992, "mean_inference_ms": 1.3584824821136197, "mean_action_processing_ms": 0.41575461187744567, "mean_env_wait_ms": 1.3453650780260136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012974023818969727, "StateBufferConnector_ms": 0.009255409240722656, "ViewRequirementAgentConnector_ms": 0.39025425910949707}, "num_episodes": 18, "episode_return_max": 670.0, "episode_return_min": 70.0, "episode_return_mean": 266.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.501412473513536, "num_env_steps_trained_throughput_per_sec": 21.501412473513536, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 189905.285, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189905.206, "sample_time_ms": 2692.015, "learn_time_ms": 187188.929, "learn_throughput": 21.369, "synch_weights_time_ms": 11.344}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "33e63_00000", "date": "2024-06-18_21-41-47", "timestamp": 1718761307, "time_this_iter_s": 186.04175806045532, "time_total_s": 2090.6072285175323, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272ae700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2090.6072285175323, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.090494296577948, "ram_util_percent": 79.42281368821291}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1797397065467345, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.966291802328108, "policy_loss": -0.011566283134669184, "vf_loss": 4.9760500740319396, "vf_explained_var": 0.0032007228896513786, "kl": 0.009040063234020438, "entropy": 1.3667401400617898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 670.0, "episode_reward_min": 110.0, "episode_reward_mean": 288.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 310.0}, "policy_reward_mean": {"policy_0": 28.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 270.0, 130.0, 235.0, 205.0, 380.0, 330.0, 230.0, 185.0, 220.0, 210.0, 280.0, 310.0, 180.0, 130.0, 140.0, 290.0, 220.0, 150.0, 270.0, 260.0, 150.0, 340.0, 225.0, 140.0, 230.0, 440.0, 160.0, 340.0, 330.0, 420.0, 570.0, 300.0, 190.0, 320.0, 170.0, 240.0, 110.0, 140.0, 550.0, 440.0, 210.0, 290.0, 240.0, 265.0, 180.0, 250.0, 160.0, 150.0, 310.0, 430.0, 390.0, 280.0, 315.0, 280.0, 200.0, 220.0, 200.0, 120.0, 200.0, 350.0, 230.0, 350.0, 280.0, 370.0, 325.0, 440.0, 220.0, 670.0, 530.0, 350.0, 490.0, 300.0, 230.0, 400.0, 165.0, 260.0, 290.0, 385.0, 330.0, 230.0, 290.0, 280.0, 360.0, 240.0, 280.0, 430.0, 180.0, 310.0, 220.0, 255.0, 500.0, 570.0, 420.0, 270.0, 500.0, 450.0, 370.0, 290.0, 190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 20.0, 30.0, 50.0, 30.0, 30.0, 10.0, 40.0, 10.0, 0.0, 10.0, 30.0, 0.0, 30.0, 30.0, 10.0, 10.0, 0.0, -25.0, 20.0, 30.0, 0.0, 30.0, 70.0, 30.0, 10.0, 30.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 60.0, 0.0, 35.0, 0.0, 20.0, 20.0, 10.0, 0.0, 250.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 20.0, 20.0, 30.0, 90.0, 50.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 60.0, 20.0, 10.0, 30.0, 20.0, -15.0, 0.0, 0.0, 40.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 40.0, 0.0, 30.0, 10.0, 50.0, 0.0, 30.0, 20.0, 30.0, 0.0, 10.0, 40.0, 10.0, 20.0, 20.0, 20.0, 40.0, 20.0, -50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 40.0, 160.0, 20.0, 150.0, 40.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 20.0, 30.0, 10.0, 20.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 20.0, 20.0, 10.0, 10.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 30.0, 70.0, 60.0, 50.0, 10.0, 0.0, 20.0, 10.0, 10.0, 40.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 50.0, 10.0, 10.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 90.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 40.0, 40.0, 40.0, 40.0, 10.0, 0.0, 35.0, 20.0, 30.0, 10.0, 0.0, 40.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 60.0, 10.0, 0.0, 10.0, 40.0, 50.0, 30.0, 40.0, 150.0, 160.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -10.0, 90.0, 10.0, 0.0, 10.0, 20.0, 0.0, 60.0, 20.0, 30.0, 30.0, 50.0, 30.0, 20.0, 10.0, 30.0, 60.0, 60.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 20.0, 70.0, 10.0, 30.0, 20.0, 60.0, 170.0, 80.0, 20.0, 0.0, 20.0, 10.0, 10.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 30.0, 20.0, 20.0, 210.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, -10.0, 20.0, 80.0, 50.0, 40.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 0.0, 60.0, 70.0, 60.0, 0.0, 0.0, 180.0, 10.0, 40.0, 40.0, 90.0, 30.0, 20.0, 10.0, 50.0, 20.0, 160.0, 50.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 30.0, 50.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 10.0, 40.0, 30.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 40.0, 30.0, 40.0, 20.0, 10.0, 40.0, -15.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 30.0, 50.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 70.0, 20.0, 20.0, 10.0, 0.0, 30.0, 50.0, 40.0, 60.0, 30.0, 20.0, 10.0, 50.0, 20.0, 0.0, 70.0, 40.0, 50.0, 0.0, 90.0, 20.0, 50.0, 30.0, 30.0, 50.0, 30.0, 30.0, 0.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 50.0, 30.0, 0.0, 10.0, 10.0, 30.0, 20.0, 60.0, 20.0, 60.0, 40.0, 40.0, 25.0, 30.0, 50.0, 30.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 30.0, 0.0, 0.0, 70.0, 20.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 30.0, 40.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 60.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 10.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 50.0, 80.0, 40.0, 40.0, 30.0, 20.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 20.0, 70.0, 20.0, 60.0, 30.0, 10.0, 40.0, 30.0, 30.0, 50.0, 10.0, 60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0, 30.0, 30.0, 20.0, 10.0, 60.0, 40.0, 10.0, 40.0, 50.0, 80.0, 0.0, 50.0, 40.0, 20.0, 30.0, 40.0, 150.0, -115.0, 70.0, 40.0, 30.0, 0.0, 40.0, 20.0, 30.0, 70.0, 160.0, 40.0, 30.0, 20.0, 10.0, 10.0, 60.0, 20.0, 50.0, 10.0, 0.0, 10.0, 40.0, 10.0, 150.0, -50.0, 260.0, 150.0, -80.0, 0.0, 20.0, 180.0, 40.0, 0.0, 310.0, 20.0, 30.0, 10.0, 50.0, 40.0, 20.0, 0.0, 10.0, 40.0, 10.0, 0.0, 20.0, 150.0, -20.0, 30.0, 50.0, 20.0, 40.0, 50.0, 70.0, 20.0, 20.0, 50.0, 100.0, 80.0, 20.0, 30.0, 40.0, 60.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 50.0, 20.0, 40.0, 110.0, 50.0, 40.0, 70.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, -5.0, 20.0, 40.0, 30.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 50.0, 20.0, 70.0, 40.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 40.0, 50.0, 20.0, 40.0, 60.0, 5.0, 20.0, 30.0, 70.0, 50.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 80.0, 40.0, 20.0, 0.0, 30.0, 20.0, 10.0, 160.0, 0.0, -100.0, 20.0, 40.0, 50.0, 0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0, 20.0, 10.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 10.0, 30.0, 40.0, 0.0, 90.0, 40.0, 80.0, 30.0, 0.0, 30.0, 10.0, 40.0, 10.0, 30.0, 30.0, 90.0, 20.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 60.0, 20.0, 60.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 40.0, 30.0, 10.0, 0.0, 40.0, 20.0, 90.0, 10.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 20.0, 40.0, 35.0, 30.0, 30.0, 30.0, 20.0, 20.0, 80.0, 20.0, 50.0, 10.0, 190.0, 30.0, 50.0, 40.0, 190.0, 20.0, 40.0, 20.0, 190.0, 10.0, -20.0, 40.0, 40.0, 30.0, 10.0, 60.0, 50.0, 30.0, 70.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 20.0, 20.0, 50.0, 100.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 170.0, 90.0, 20.0, 40.0, 10.0, 40.0, 40.0, 40.0, 170.0, 80.0, 80.0, 30.0, -40.0, 0.0, 10.0, 40.0, 20.0, 60.0, 70.0, 70.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 50.0, 50.0, 60.0, 0.0, 30.0, 40.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6656996540687117, "mean_inference_ms": 1.3647486393374901, "mean_action_processing_ms": 0.4128148365134943, "mean_env_wait_ms": 1.3356317396639616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01277470588684082, "StateBufferConnector_ms": 0.009323596954345703, "ViewRequirementAgentConnector_ms": 0.38834381103515625}, "num_episodes": 18, "episode_return_max": 670.0, "episode_return_min": 110.0, "episode_return_mean": 288.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.347667339489348, "num_env_steps_trained_throughput_per_sec": 21.347667339489348, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 189123.463, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189123.383, "sample_time_ms": 2670.807, "learn_time_ms": 186428.492, "learn_throughput": 21.456, "synch_weights_time_ms": 11.344}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "33e63_00000", "date": "2024-06-18_21-44-54", "timestamp": 1718761494, "time_this_iter_s": 187.38898301124573, "time_total_s": 2277.996211528778, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2277.996211528778, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.40754716981132, "ram_util_percent": 80.98075471698114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.221307147920322, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.766752892561233, "policy_loss": -0.012096756764293844, "vf_loss": 4.777116315585737, "vf_explained_var": 0.003556365720507182, "kl": 0.00866666941800717, "entropy": 1.3477599829657516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 670.0, "episode_reward_min": 110.0, "episode_reward_mean": 310.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 310.0}, "policy_reward_mean": {"policy_0": 31.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 270.0, 260.0, 150.0, 340.0, 225.0, 140.0, 230.0, 440.0, 160.0, 340.0, 330.0, 420.0, 570.0, 300.0, 190.0, 320.0, 170.0, 240.0, 110.0, 140.0, 550.0, 440.0, 210.0, 290.0, 240.0, 265.0, 180.0, 250.0, 160.0, 150.0, 310.0, 430.0, 390.0, 280.0, 315.0, 280.0, 200.0, 220.0, 200.0, 120.0, 200.0, 350.0, 230.0, 350.0, 280.0, 370.0, 325.0, 440.0, 220.0, 670.0, 530.0, 350.0, 490.0, 300.0, 230.0, 400.0, 165.0, 260.0, 290.0, 385.0, 330.0, 230.0, 290.0, 280.0, 360.0, 240.0, 280.0, 430.0, 180.0, 310.0, 220.0, 255.0, 500.0, 570.0, 420.0, 270.0, 500.0, 450.0, 370.0, 290.0, 190.0, 260.0, 220.0, 450.0, 440.0, 440.0, 250.0, 380.0, 420.0, 430.0, 670.0, 340.0, 265.0, 155.0, 385.0, 130.0, 340.0, 250.0, 430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 0.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 50.0, 10.0, 10.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 60.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 90.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 40.0, 40.0, 40.0, 40.0, 10.0, 0.0, 35.0, 20.0, 30.0, 10.0, 0.0, 40.0, 20.0, 0.0, 10.0, 10.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 0.0, 60.0, 10.0, 0.0, 10.0, 40.0, 50.0, 30.0, 40.0, 150.0, 160.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, 0.0, -10.0, 90.0, 10.0, 0.0, 10.0, 20.0, 0.0, 60.0, 20.0, 30.0, 30.0, 50.0, 30.0, 20.0, 10.0, 30.0, 60.0, 60.0, 40.0, 10.0, 20.0, 20.0, 20.0, 60.0, 20.0, 70.0, 10.0, 30.0, 20.0, 60.0, 170.0, 80.0, 20.0, 0.0, 20.0, 10.0, 10.0, 100.0, 30.0, 60.0, 40.0, 50.0, 10.0, 30.0, 20.0, 20.0, 210.0, 40.0, 70.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 10.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 50.0, -10.0, 20.0, 80.0, 50.0, 40.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 0.0, 60.0, 70.0, 60.0, 0.0, 0.0, 180.0, 10.0, 40.0, 40.0, 90.0, 30.0, 20.0, 10.0, 50.0, 20.0, 160.0, 50.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 30.0, 50.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 10.0, 40.0, 30.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 40.0, 30.0, 40.0, 20.0, 10.0, 40.0, -15.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 30.0, 50.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 70.0, 20.0, 20.0, 10.0, 0.0, 30.0, 50.0, 40.0, 60.0, 30.0, 20.0, 10.0, 50.0, 20.0, 0.0, 70.0, 40.0, 50.0, 0.0, 90.0, 20.0, 50.0, 30.0, 30.0, 50.0, 30.0, 30.0, 0.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 50.0, 30.0, 0.0, 10.0, 10.0, 30.0, 20.0, 60.0, 20.0, 60.0, 40.0, 40.0, 25.0, 30.0, 50.0, 30.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 30.0, 0.0, 0.0, 70.0, 20.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 30.0, 40.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 60.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 10.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 50.0, 80.0, 40.0, 40.0, 30.0, 20.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 20.0, 70.0, 20.0, 60.0, 30.0, 10.0, 40.0, 30.0, 30.0, 50.0, 10.0, 60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0, 30.0, 30.0, 20.0, 10.0, 60.0, 40.0, 10.0, 40.0, 50.0, 80.0, 0.0, 50.0, 40.0, 20.0, 30.0, 40.0, 150.0, -115.0, 70.0, 40.0, 30.0, 0.0, 40.0, 20.0, 30.0, 70.0, 160.0, 40.0, 30.0, 20.0, 10.0, 10.0, 60.0, 20.0, 50.0, 10.0, 0.0, 10.0, 40.0, 10.0, 150.0, -50.0, 260.0, 150.0, -80.0, 0.0, 20.0, 180.0, 40.0, 0.0, 310.0, 20.0, 30.0, 10.0, 50.0, 40.0, 20.0, 0.0, 10.0, 40.0, 10.0, 0.0, 20.0, 150.0, -20.0, 30.0, 50.0, 20.0, 40.0, 50.0, 70.0, 20.0, 20.0, 50.0, 100.0, 80.0, 20.0, 30.0, 40.0, 60.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 50.0, 20.0, 40.0, 110.0, 50.0, 40.0, 70.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, -5.0, 20.0, 40.0, 30.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 50.0, 20.0, 70.0, 40.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 40.0, 50.0, 20.0, 40.0, 60.0, 5.0, 20.0, 30.0, 70.0, 50.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 80.0, 40.0, 20.0, 0.0, 30.0, 20.0, 10.0, 160.0, 0.0, -100.0, 20.0, 40.0, 50.0, 0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0, 20.0, 10.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 10.0, 30.0, 40.0, 0.0, 90.0, 40.0, 80.0, 30.0, 0.0, 30.0, 10.0, 40.0, 10.0, 30.0, 30.0, 90.0, 20.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 60.0, 20.0, 60.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 40.0, 30.0, 10.0, 0.0, 40.0, 20.0, 90.0, 10.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 20.0, 40.0, 35.0, 30.0, 30.0, 30.0, 20.0, 20.0, 80.0, 20.0, 50.0, 10.0, 190.0, 30.0, 50.0, 40.0, 190.0, 20.0, 40.0, 20.0, 190.0, 10.0, -20.0, 40.0, 40.0, 30.0, 10.0, 60.0, 50.0, 30.0, 70.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 20.0, 20.0, 50.0, 100.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 170.0, 90.0, 20.0, 40.0, 10.0, 40.0, 40.0, 40.0, 170.0, 80.0, 80.0, 30.0, -40.0, 0.0, 10.0, 40.0, 20.0, 60.0, 70.0, 70.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 50.0, 50.0, 60.0, 0.0, 30.0, 40.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0, 10.0, 30.0, 40.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 90.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 180.0, 200.0, -50.0, 10.0, 80.0, 20.0, 10.0, 50.0, 10.0, 10.0, 40.0, 50.0, 170.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 20.0, 90.0, 170.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 30.0, 60.0, 30.0, 20.0, 20.0, 60.0, 40.0, 30.0, 80.0, 10.0, 30.0, 0.0, 70.0, 60.0, 0.0, 60.0, 70.0, 90.0, 50.0, 0.0, 10.0, 10.0, 70.0, 50.0, 10.0, 40.0, 50.0, 80.0, 60.0, 10.0, 0.0, 60.0, 10.0, 60.0, 60.0, 20.0, 0.0, 70.0, 50.0, 50.0, 180.0, 80.0, 170.0, 50.0, 0.0, 30.0, 30.0, 40.0, 10.0, 40.0, 0.0, 50.0, 0.0, 60.0, 80.0, 20.0, 30.0, 30.0, 40.0, 40.0, 0.0, 40.0, 30.0, 5.0, 30.0, 5.0, 10.0, 30.0, 30.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 35.0, 80.0, 50.0, 30.0, 80.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 0.0, 0.0, 90.0, 70.0, 0.0, 10.0, 0.0, 30.0, 60.0, 40.0, 0.0, 40.0, 40.0, 30.0, 50.0, 50.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6591725058431268, "mean_inference_ms": 1.3706262394707318, "mean_action_processing_ms": 0.4104976505481234, "mean_env_wait_ms": 1.3280648669556974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013266801834106445, "StateBufferConnector_ms": 0.009530305862426758, "ViewRequirementAgentConnector_ms": 0.3930838108062744}, "num_episodes": 18, "episode_return_max": 670.0, "episode_return_min": 110.0, "episode_return_mean": 310.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.31942703958504, "num_env_steps_trained_throughput_per_sec": 21.31942703958504, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 188285.42, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188285.341, "sample_time_ms": 2651.125, "learn_time_ms": 185611.137, "learn_throughput": 21.55, "synch_weights_time_ms": 11.61}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "33e63_00000", "date": "2024-06-18_21-48-02", "timestamp": 1718761682, "time_this_iter_s": 187.63108110427856, "time_total_s": 2465.6272926330566, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327268310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2465.6272926330566, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 16.576603773584907, "ram_util_percent": 80.8188679245283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.058302383294629, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.624690704173046, "policy_loss": -0.011764271190046324, "vf_loss": 5.634592685760401, "vf_explained_var": 0.004530142220699241, "kl": 0.009311441765464923, "entropy": 1.3037185525995727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 730.0, "episode_reward_min": 110.0, "episode_reward_mean": 322.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 350.0}, "policy_reward_mean": {"policy_0": 32.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 110.0, 140.0, 550.0, 440.0, 210.0, 290.0, 240.0, 265.0, 180.0, 250.0, 160.0, 150.0, 310.0, 430.0, 390.0, 280.0, 315.0, 280.0, 200.0, 220.0, 200.0, 120.0, 200.0, 350.0, 230.0, 350.0, 280.0, 370.0, 325.0, 440.0, 220.0, 670.0, 530.0, 350.0, 490.0, 300.0, 230.0, 400.0, 165.0, 260.0, 290.0, 385.0, 330.0, 230.0, 290.0, 280.0, 360.0, 240.0, 280.0, 430.0, 180.0, 310.0, 220.0, 255.0, 500.0, 570.0, 420.0, 270.0, 500.0, 450.0, 370.0, 290.0, 190.0, 260.0, 220.0, 450.0, 440.0, 440.0, 250.0, 380.0, 420.0, 430.0, 670.0, 340.0, 265.0, 155.0, 385.0, 130.0, 340.0, 250.0, 430.0, 510.0, 670.0, 370.0, 220.0, 340.0, 190.0, 235.0, 310.0, 275.0, 210.0, 150.0, 350.0, 230.0, 345.0, 540.0, 730.0, 255.0, 320.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 40.0, 30.0, 0.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 30.0, 0.0, 60.0, 70.0, 60.0, 0.0, 0.0, 180.0, 10.0, 40.0, 40.0, 90.0, 30.0, 20.0, 10.0, 50.0, 20.0, 160.0, 50.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 30.0, 60.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 30.0, 50.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 10.0, 40.0, 30.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 30.0, 50.0, 40.0, 30.0, 40.0, 20.0, 10.0, 40.0, -15.0, 20.0, 10.0, 30.0, 40.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 0.0, 30.0, 0.0, 40.0, 30.0, 10.0, 30.0, 50.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 0.0, -10.0, 20.0, 0.0, 70.0, 20.0, 20.0, 10.0, 0.0, 30.0, 50.0, 40.0, 60.0, 30.0, 20.0, 10.0, 50.0, 20.0, 0.0, 70.0, 40.0, 50.0, 0.0, 90.0, 20.0, 50.0, 30.0, 30.0, 50.0, 30.0, 30.0, 0.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 50.0, 30.0, 0.0, 10.0, 10.0, 30.0, 20.0, 60.0, 20.0, 60.0, 40.0, 40.0, 25.0, 30.0, 50.0, 30.0, 50.0, 60.0, 10.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 30.0, 0.0, 0.0, 70.0, 20.0, 20.0, 50.0, 0.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 30.0, 40.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 0.0, 60.0, 20.0, 0.0, 0.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 10.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 10.0, 10.0, 50.0, 80.0, 40.0, 40.0, 30.0, 20.0, 50.0, 30.0, 50.0, 30.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 20.0, 70.0, 20.0, 60.0, 30.0, 10.0, 40.0, 30.0, 30.0, 50.0, 10.0, 60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0, 30.0, 30.0, 20.0, 10.0, 60.0, 40.0, 10.0, 40.0, 50.0, 80.0, 0.0, 50.0, 40.0, 20.0, 30.0, 40.0, 150.0, -115.0, 70.0, 40.0, 30.0, 0.0, 40.0, 20.0, 30.0, 70.0, 160.0, 40.0, 30.0, 20.0, 10.0, 10.0, 60.0, 20.0, 50.0, 10.0, 0.0, 10.0, 40.0, 10.0, 150.0, -50.0, 260.0, 150.0, -80.0, 0.0, 20.0, 180.0, 40.0, 0.0, 310.0, 20.0, 30.0, 10.0, 50.0, 40.0, 20.0, 0.0, 10.0, 40.0, 10.0, 0.0, 20.0, 150.0, -20.0, 30.0, 50.0, 20.0, 40.0, 50.0, 70.0, 20.0, 20.0, 50.0, 100.0, 80.0, 20.0, 30.0, 40.0, 60.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 50.0, 20.0, 40.0, 110.0, 50.0, 40.0, 70.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, -5.0, 20.0, 40.0, 30.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 50.0, 20.0, 70.0, 40.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 40.0, 50.0, 20.0, 40.0, 60.0, 5.0, 20.0, 30.0, 70.0, 50.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 80.0, 40.0, 20.0, 0.0, 30.0, 20.0, 10.0, 160.0, 0.0, -100.0, 20.0, 40.0, 50.0, 0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0, 20.0, 10.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 10.0, 30.0, 40.0, 0.0, 90.0, 40.0, 80.0, 30.0, 0.0, 30.0, 10.0, 40.0, 10.0, 30.0, 30.0, 90.0, 20.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 60.0, 20.0, 60.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 40.0, 30.0, 10.0, 0.0, 40.0, 20.0, 90.0, 10.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 20.0, 40.0, 35.0, 30.0, 30.0, 30.0, 20.0, 20.0, 80.0, 20.0, 50.0, 10.0, 190.0, 30.0, 50.0, 40.0, 190.0, 20.0, 40.0, 20.0, 190.0, 10.0, -20.0, 40.0, 40.0, 30.0, 10.0, 60.0, 50.0, 30.0, 70.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 20.0, 20.0, 50.0, 100.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 170.0, 90.0, 20.0, 40.0, 10.0, 40.0, 40.0, 40.0, 170.0, 80.0, 80.0, 30.0, -40.0, 0.0, 10.0, 40.0, 20.0, 60.0, 70.0, 70.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 50.0, 50.0, 60.0, 0.0, 30.0, 40.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0, 10.0, 30.0, 40.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 90.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 180.0, 200.0, -50.0, 10.0, 80.0, 20.0, 10.0, 50.0, 10.0, 10.0, 40.0, 50.0, 170.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 20.0, 90.0, 170.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 30.0, 60.0, 30.0, 20.0, 20.0, 60.0, 40.0, 30.0, 80.0, 10.0, 30.0, 0.0, 70.0, 60.0, 0.0, 60.0, 70.0, 90.0, 50.0, 0.0, 10.0, 10.0, 70.0, 50.0, 10.0, 40.0, 50.0, 80.0, 60.0, 10.0, 0.0, 60.0, 10.0, 60.0, 60.0, 20.0, 0.0, 70.0, 50.0, 50.0, 180.0, 80.0, 170.0, 50.0, 0.0, 30.0, 30.0, 40.0, 10.0, 40.0, 0.0, 50.0, 0.0, 60.0, 80.0, 20.0, 30.0, 30.0, 40.0, 40.0, 0.0, 40.0, 30.0, 5.0, 30.0, 5.0, 10.0, 30.0, 30.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 35.0, 80.0, 50.0, 30.0, 80.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 0.0, 0.0, 90.0, 70.0, 0.0, 10.0, 0.0, 30.0, 60.0, 40.0, 0.0, 40.0, 40.0, 30.0, 50.0, 50.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0, 20.0, -10.0, 20.0, 0.0, 150.0, 40.0, 150.0, 10.0, 40.0, 90.0, 190.0, 30.0, -50.0, 80.0, 60.0, 90.0, 80.0, 0.0, 50.0, 140.0, 40.0, 20.0, 40.0, 10.0, 70.0, 5.0, 170.0, -40.0, 40.0, 15.0, 50.0, 60.0, -100.0, 30.0, 40.0, 20.0, 20.0, 20.0, 70.0, 10.0, 50.0, 20.0, 90.0, 0.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 15.0, 50.0, 10.0, 40.0, 80.0, 30.0, 80.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 10.0, 170.0, 0.0, 10.0, 20.0, -15.0, 40.0, 0.0, 30.0, 70.0, 10.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 130.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 10.0, 10.0, 20.0, 0.0, 50.0, 40.0, 10.0, 40.0, 60.0, 20.0, 60.0, 30.0, 20.0, 15.0, 50.0, 70.0, 220.0, 20.0, 50.0, 30.0, 10.0, 40.0, 10.0, 40.0, 40.0, 70.0, 60.0, 0.0, 350.0, 70.0, 80.0, -30.0, 50.0, 40.0, 20.0, 50.0, 5.0, 40.0, 50.0, 10.0, 0.0, 30.0, 10.0, 40.0, -50.0, 80.0, -30.0, 10.0, 20.0, 20.0, 190.0, 60.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6519479244793915, "mean_inference_ms": 1.375155254880288, "mean_action_processing_ms": 0.4086866466866396, "mean_env_wait_ms": 1.3219070504937331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01319122314453125, "StateBufferConnector_ms": 0.009470224380493164, "ViewRequirementAgentConnector_ms": 0.3914005756378174}, "num_episodes": 18, "episode_return_max": 730.0, "episode_return_min": 110.0, "episode_return_mean": 322.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.477296616700073, "num_env_steps_trained_throughput_per_sec": 21.477296616700073, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 187992.48, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187992.401, "sample_time_ms": 2646.502, "learn_time_ms": 185322.59, "learn_throughput": 21.584, "synch_weights_time_ms": 11.83}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "33e63_00000", "date": "2024-06-18_21-51-08", "timestamp": 1718761868, "time_this_iter_s": 186.25277495384216, "time_total_s": 2651.880067586899, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2651.880067586899, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 16.422053231939163, "ram_util_percent": 79.71673003802282}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6832396924178314, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.720819092660158, "policy_loss": -0.011867164900026525, "vf_loss": 5.7308954073344305, "vf_explained_var": 0.004051504576929842, "kl": 0.00895423422683982, "entropy": 1.2639180581917524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 730.0, "episode_reward_min": 130.0, "episode_reward_mean": 372.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 350.0}, "policy_reward_mean": {"policy_0": 37.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 370.0, 325.0, 440.0, 220.0, 670.0, 530.0, 350.0, 490.0, 300.0, 230.0, 400.0, 165.0, 260.0, 290.0, 385.0, 330.0, 230.0, 290.0, 280.0, 360.0, 240.0, 280.0, 430.0, 180.0, 310.0, 220.0, 255.0, 500.0, 570.0, 420.0, 270.0, 500.0, 450.0, 370.0, 290.0, 190.0, 260.0, 220.0, 450.0, 440.0, 440.0, 250.0, 380.0, 420.0, 430.0, 670.0, 340.0, 265.0, 155.0, 385.0, 130.0, 340.0, 250.0, 430.0, 510.0, 670.0, 370.0, 220.0, 340.0, 190.0, 235.0, 310.0, 275.0, 210.0, 150.0, 350.0, 230.0, 345.0, 540.0, 730.0, 255.0, 320.0, 410.0, 180.0, 545.0, 660.0, 440.0, 380.0, 610.0, 535.0, 620.0, 630.0, 400.0, 610.0, 500.0, 350.0, 360.0, 520.0, 170.0, 250.0, 200.0, 320.0, 710.0, 520.0, 545.0, 540.0, 370.0, 220.0, 490.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 30.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 50.0, 0.0, 30.0, 30.0, 20.0, 10.0, 60.0, 40.0, 10.0, 40.0, 50.0, 80.0, 0.0, 50.0, 40.0, 20.0, 30.0, 40.0, 150.0, -115.0, 70.0, 40.0, 30.0, 0.0, 40.0, 20.0, 30.0, 70.0, 160.0, 40.0, 30.0, 20.0, 10.0, 10.0, 60.0, 20.0, 50.0, 10.0, 0.0, 10.0, 40.0, 10.0, 150.0, -50.0, 260.0, 150.0, -80.0, 0.0, 20.0, 180.0, 40.0, 0.0, 310.0, 20.0, 30.0, 10.0, 50.0, 40.0, 20.0, 0.0, 10.0, 40.0, 10.0, 0.0, 20.0, 150.0, -20.0, 30.0, 50.0, 20.0, 40.0, 50.0, 70.0, 20.0, 20.0, 50.0, 100.0, 80.0, 20.0, 30.0, 40.0, 60.0, 30.0, 60.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 30.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 50.0, 20.0, 40.0, 110.0, 50.0, 40.0, 70.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 20.0, -5.0, 20.0, 40.0, 30.0, 10.0, 20.0, 50.0, 30.0, 0.0, 10.0, 50.0, 20.0, 70.0, 40.0, 50.0, 30.0, 30.0, 30.0, 10.0, 20.0, 10.0, 0.0, 40.0, 50.0, 20.0, 40.0, 60.0, 5.0, 20.0, 30.0, 70.0, 50.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 80.0, 40.0, 20.0, 0.0, 30.0, 20.0, 10.0, 160.0, 0.0, -100.0, 20.0, 40.0, 50.0, 0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0, 20.0, 10.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 10.0, 30.0, 40.0, 0.0, 90.0, 40.0, 80.0, 30.0, 0.0, 30.0, 10.0, 40.0, 10.0, 30.0, 30.0, 90.0, 20.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 60.0, 20.0, 60.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 40.0, 30.0, 10.0, 0.0, 40.0, 20.0, 90.0, 10.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 20.0, 40.0, 35.0, 30.0, 30.0, 30.0, 20.0, 20.0, 80.0, 20.0, 50.0, 10.0, 190.0, 30.0, 50.0, 40.0, 190.0, 20.0, 40.0, 20.0, 190.0, 10.0, -20.0, 40.0, 40.0, 30.0, 10.0, 60.0, 50.0, 30.0, 70.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 20.0, 20.0, 50.0, 100.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 170.0, 90.0, 20.0, 40.0, 10.0, 40.0, 40.0, 40.0, 170.0, 80.0, 80.0, 30.0, -40.0, 0.0, 10.0, 40.0, 20.0, 60.0, 70.0, 70.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 50.0, 50.0, 60.0, 0.0, 30.0, 40.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0, 10.0, 30.0, 40.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 90.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 180.0, 200.0, -50.0, 10.0, 80.0, 20.0, 10.0, 50.0, 10.0, 10.0, 40.0, 50.0, 170.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 20.0, 90.0, 170.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 30.0, 60.0, 30.0, 20.0, 20.0, 60.0, 40.0, 30.0, 80.0, 10.0, 30.0, 0.0, 70.0, 60.0, 0.0, 60.0, 70.0, 90.0, 50.0, 0.0, 10.0, 10.0, 70.0, 50.0, 10.0, 40.0, 50.0, 80.0, 60.0, 10.0, 0.0, 60.0, 10.0, 60.0, 60.0, 20.0, 0.0, 70.0, 50.0, 50.0, 180.0, 80.0, 170.0, 50.0, 0.0, 30.0, 30.0, 40.0, 10.0, 40.0, 0.0, 50.0, 0.0, 60.0, 80.0, 20.0, 30.0, 30.0, 40.0, 40.0, 0.0, 40.0, 30.0, 5.0, 30.0, 5.0, 10.0, 30.0, 30.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 35.0, 80.0, 50.0, 30.0, 80.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 0.0, 0.0, 90.0, 70.0, 0.0, 10.0, 0.0, 30.0, 60.0, 40.0, 0.0, 40.0, 40.0, 30.0, 50.0, 50.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0, 20.0, -10.0, 20.0, 0.0, 150.0, 40.0, 150.0, 10.0, 40.0, 90.0, 190.0, 30.0, -50.0, 80.0, 60.0, 90.0, 80.0, 0.0, 50.0, 140.0, 40.0, 20.0, 40.0, 10.0, 70.0, 5.0, 170.0, -40.0, 40.0, 15.0, 50.0, 60.0, -100.0, 30.0, 40.0, 20.0, 20.0, 20.0, 70.0, 10.0, 50.0, 20.0, 90.0, 0.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 15.0, 50.0, 10.0, 40.0, 80.0, 30.0, 80.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 10.0, 170.0, 0.0, 10.0, 20.0, -15.0, 40.0, 0.0, 30.0, 70.0, 10.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 130.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 10.0, 10.0, 20.0, 0.0, 50.0, 40.0, 10.0, 40.0, 60.0, 20.0, 60.0, 30.0, 20.0, 15.0, 50.0, 70.0, 220.0, 20.0, 50.0, 30.0, 10.0, 40.0, 10.0, 40.0, 40.0, 70.0, 60.0, 0.0, 350.0, 70.0, 80.0, -30.0, 50.0, 40.0, 20.0, 50.0, 5.0, 40.0, 50.0, 10.0, 0.0, 30.0, 10.0, 40.0, -50.0, 80.0, -30.0, 10.0, 20.0, 20.0, 190.0, 60.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 30.0, 50.0, 50.0, 20.0, 90.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 60.0, 40.0, 40.0, 40.0, 100.0, 25.0, 60.0, 100.0, 160.0, 30.0, 50.0, 20.0, 70.0, 0.0, 260.0, 30.0, 30.0, 10.0, 80.0, 30.0, 0.0, 60.0, 50.0, 0.0, 40.0, 30.0, 20.0, 130.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 10.0, 70.0, 170.0, 10.0, 100.0, 160.0, 50.0, 60.0, 70.0, 40.0, -40.0, 70.0, 70.0, 30.0, 20.0, 70.0, 80.0, 80.0, 40.0, 95.0, 30.0, 70.0, 30.0, 20.0, 280.0, 140.0, 50.0, 30.0, 30.0, -10.0, 10.0, 10.0, 20.0, 60.0, 20.0, 50.0, 80.0, 40.0, 40.0, 90.0, 70.0, 170.0, 60.0, 10.0, 10.0, 50.0, 40.0, 30.0, 10.0, 80.0, 30.0, 40.0, 30.0, 80.0, 90.0, 70.0, 20.0, 50.0, 20.0, 0.0, 210.0, 20.0, 60.0, 70.0, 40.0, 80.0, 10.0, 100.0, 90.0, 30.0, 30.0, 40.0, 50.0, 30.0, 10.0, 80.0, 50.0, 40.0, 10.0, 10.0, 10.0, 80.0, 40.0, 20.0, 40.0, 0.0, 90.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 100.0, 30.0, 80.0, 10.0, 60.0, 20.0, 0.0, 80.0, 20.0, 50.0, 170.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 70.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 70.0, 20.0, 20.0, 30.0, 0.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 40.0, 80.0, 80.0, 50.0, 100.0, 60.0, 70.0, 90.0, 60.0, 80.0, 0.0, 70.0, 80.0, 40.0, 100.0, 40.0, 30.0, 70.0, 60.0, 30.0, 50.0, -40.0, 250.0, 80.0, 60.0, 40.0, 20.0, 40.0, 50.0, -5.0, 60.0, 70.0, 60.0, 20.0, 120.0, 20.0, 30.0, 0.0, 120.0, 40.0, 20.0, 50.0, 10.0, 70.0, 40.0, 10.0, 90.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, -25.0, 10.0, 50.0, 10.0, 25.0, 60.0, 110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6388921175326892, "mean_inference_ms": 1.3788277881550093, "mean_action_processing_ms": 0.4062144756591996, "mean_env_wait_ms": 1.3127245204739766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012920379638671875, "StateBufferConnector_ms": 0.009536266326904297, "ViewRequirementAgentConnector_ms": 0.39365434646606445}, "num_episodes": 27, "episode_return_max": 730.0, "episode_return_min": 130.0, "episode_return_mean": 372.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.444510826233174, "num_env_steps_trained_throughput_per_sec": 21.444510826233174, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 187313.911, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187313.832, "sample_time_ms": 2640.297, "learn_time_ms": 184649.809, "learn_throughput": 21.663, "synch_weights_time_ms": 12.146}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "33e63_00000", "date": "2024-06-18_21-54-15", "timestamp": 1718762055, "time_this_iter_s": 186.5423378944397, "time_total_s": 2838.4224054813385, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327268280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2838.4224054813385, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.786742424242426, "ram_util_percent": 79.48636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.038333755801407, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.746139727055201, "policy_loss": -0.01086324078866, "vf_loss": 5.755291791718862, "vf_explained_var": 0.0034259097708172945, "kl": 0.008555887872999948, "entropy": 1.2501781527226725, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 930.0, "episode_reward_min": 130.0, "episode_reward_mean": 397.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 410.0}, "policy_reward_mean": {"policy_0": 39.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 280.0, 360.0, 240.0, 280.0, 430.0, 180.0, 310.0, 220.0, 255.0, 500.0, 570.0, 420.0, 270.0, 500.0, 450.0, 370.0, 290.0, 190.0, 260.0, 220.0, 450.0, 440.0, 440.0, 250.0, 380.0, 420.0, 430.0, 670.0, 340.0, 265.0, 155.0, 385.0, 130.0, 340.0, 250.0, 430.0, 510.0, 670.0, 370.0, 220.0, 340.0, 190.0, 235.0, 310.0, 275.0, 210.0, 150.0, 350.0, 230.0, 345.0, 540.0, 730.0, 255.0, 320.0, 410.0, 180.0, 545.0, 660.0, 440.0, 380.0, 610.0, 535.0, 620.0, 630.0, 400.0, 610.0, 500.0, 350.0, 360.0, 520.0, 170.0, 250.0, 200.0, 320.0, 710.0, 520.0, 545.0, 540.0, 370.0, 220.0, 490.0, 360.0, 450.0, 525.0, 885.0, 570.0, 580.0, 160.0, 430.0, 230.0, 210.0, 470.0, 620.0, 530.0, 595.0, 310.0, 570.0, 930.0, 340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 10.0, 80.0, 80.0, 10.0, 10.0, 40.0, 20.0, 20.0, 20.0, 10.0, 80.0, 30.0, 40.0, 10.0, 10.0, 40.0, 10.0, 30.0, 40.0, 0.0, 90.0, 40.0, 80.0, 30.0, 0.0, 30.0, 10.0, 40.0, 10.0, 30.0, 30.0, 90.0, 20.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 30.0, 60.0, 30.0, 30.0, 60.0, 10.0, 60.0, 70.0, 30.0, 20.0, 40.0, 60.0, 20.0, 60.0, 10.0, 30.0, 10.0, 10.0, 30.0, 10.0, 40.0, 30.0, 10.0, 0.0, 40.0, 20.0, 90.0, 10.0, 20.0, 20.0, 30.0, 40.0, 20.0, 20.0, 20.0, 40.0, 40.0, 0.0, 30.0, 0.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 20.0, 40.0, 35.0, 30.0, 30.0, 30.0, 20.0, 20.0, 80.0, 20.0, 50.0, 10.0, 190.0, 30.0, 50.0, 40.0, 190.0, 20.0, 40.0, 20.0, 190.0, 10.0, -20.0, 40.0, 40.0, 30.0, 10.0, 60.0, 50.0, 30.0, 70.0, 20.0, 30.0, 80.0, 40.0, 30.0, 10.0, 20.0, 20.0, 50.0, 100.0, 0.0, 10.0, 10.0, 20.0, 30.0, 20.0, 170.0, 90.0, 20.0, 40.0, 10.0, 40.0, 40.0, 40.0, 170.0, 80.0, 80.0, 30.0, -40.0, 0.0, 10.0, 40.0, 20.0, 60.0, 70.0, 70.0, 30.0, 10.0, 10.0, 30.0, 30.0, 20.0, 50.0, 50.0, 60.0, 0.0, 30.0, 40.0, 30.0, 0.0, 10.0, 10.0, 70.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0, 10.0, 30.0, 40.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 90.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 180.0, 200.0, -50.0, 10.0, 80.0, 20.0, 10.0, 50.0, 10.0, 10.0, 40.0, 50.0, 170.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 20.0, 90.0, 170.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 30.0, 60.0, 30.0, 20.0, 20.0, 60.0, 40.0, 30.0, 80.0, 10.0, 30.0, 0.0, 70.0, 60.0, 0.0, 60.0, 70.0, 90.0, 50.0, 0.0, 10.0, 10.0, 70.0, 50.0, 10.0, 40.0, 50.0, 80.0, 60.0, 10.0, 0.0, 60.0, 10.0, 60.0, 60.0, 20.0, 0.0, 70.0, 50.0, 50.0, 180.0, 80.0, 170.0, 50.0, 0.0, 30.0, 30.0, 40.0, 10.0, 40.0, 0.0, 50.0, 0.0, 60.0, 80.0, 20.0, 30.0, 30.0, 40.0, 40.0, 0.0, 40.0, 30.0, 5.0, 30.0, 5.0, 10.0, 30.0, 30.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 35.0, 80.0, 50.0, 30.0, 80.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 0.0, 0.0, 90.0, 70.0, 0.0, 10.0, 0.0, 30.0, 60.0, 40.0, 0.0, 40.0, 40.0, 30.0, 50.0, 50.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0, 20.0, -10.0, 20.0, 0.0, 150.0, 40.0, 150.0, 10.0, 40.0, 90.0, 190.0, 30.0, -50.0, 80.0, 60.0, 90.0, 80.0, 0.0, 50.0, 140.0, 40.0, 20.0, 40.0, 10.0, 70.0, 5.0, 170.0, -40.0, 40.0, 15.0, 50.0, 60.0, -100.0, 30.0, 40.0, 20.0, 20.0, 20.0, 70.0, 10.0, 50.0, 20.0, 90.0, 0.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 15.0, 50.0, 10.0, 40.0, 80.0, 30.0, 80.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 10.0, 170.0, 0.0, 10.0, 20.0, -15.0, 40.0, 0.0, 30.0, 70.0, 10.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 130.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 10.0, 10.0, 20.0, 0.0, 50.0, 40.0, 10.0, 40.0, 60.0, 20.0, 60.0, 30.0, 20.0, 15.0, 50.0, 70.0, 220.0, 20.0, 50.0, 30.0, 10.0, 40.0, 10.0, 40.0, 40.0, 70.0, 60.0, 0.0, 350.0, 70.0, 80.0, -30.0, 50.0, 40.0, 20.0, 50.0, 5.0, 40.0, 50.0, 10.0, 0.0, 30.0, 10.0, 40.0, -50.0, 80.0, -30.0, 10.0, 20.0, 20.0, 190.0, 60.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 30.0, 50.0, 50.0, 20.0, 90.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 60.0, 40.0, 40.0, 40.0, 100.0, 25.0, 60.0, 100.0, 160.0, 30.0, 50.0, 20.0, 70.0, 0.0, 260.0, 30.0, 30.0, 10.0, 80.0, 30.0, 0.0, 60.0, 50.0, 0.0, 40.0, 30.0, 20.0, 130.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 10.0, 70.0, 170.0, 10.0, 100.0, 160.0, 50.0, 60.0, 70.0, 40.0, -40.0, 70.0, 70.0, 30.0, 20.0, 70.0, 80.0, 80.0, 40.0, 95.0, 30.0, 70.0, 30.0, 20.0, 280.0, 140.0, 50.0, 30.0, 30.0, -10.0, 10.0, 10.0, 20.0, 60.0, 20.0, 50.0, 80.0, 40.0, 40.0, 90.0, 70.0, 170.0, 60.0, 10.0, 10.0, 50.0, 40.0, 30.0, 10.0, 80.0, 30.0, 40.0, 30.0, 80.0, 90.0, 70.0, 20.0, 50.0, 20.0, 0.0, 210.0, 20.0, 60.0, 70.0, 40.0, 80.0, 10.0, 100.0, 90.0, 30.0, 30.0, 40.0, 50.0, 30.0, 10.0, 80.0, 50.0, 40.0, 10.0, 10.0, 10.0, 80.0, 40.0, 20.0, 40.0, 0.0, 90.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 100.0, 30.0, 80.0, 10.0, 60.0, 20.0, 0.0, 80.0, 20.0, 50.0, 170.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 70.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 70.0, 20.0, 20.0, 30.0, 0.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 40.0, 80.0, 80.0, 50.0, 100.0, 60.0, 70.0, 90.0, 60.0, 80.0, 0.0, 70.0, 80.0, 40.0, 100.0, 40.0, 30.0, 70.0, 60.0, 30.0, 50.0, -40.0, 250.0, 80.0, 60.0, 40.0, 20.0, 40.0, 50.0, -5.0, 60.0, 70.0, 60.0, 20.0, 120.0, 20.0, 30.0, 0.0, 120.0, 40.0, 20.0, 50.0, 10.0, 70.0, 40.0, 10.0, 90.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, -25.0, 10.0, 50.0, 10.0, 25.0, 60.0, 110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0, 90.0, 40.0, 40.0, 30.0, 80.0, 10.0, 40.0, 0.0, 20.0, 10.0, 50.0, 40.0, 10.0, 250.0, -40.0, 20.0, 40.0, 20.0, 20.0, 40.0, -5.0, 40.0, 70.0, 70.0, 20.0, 50.0, 170.0, 10.0, 90.0, 10.0, 155.0, 410.0, 10.0, 30.0, 10.0, 180.0, 30.0, 10.0, 20.0, 30.0, 170.0, 40.0, 30.0, 110.0, 90.0, 10.0, 20.0, 20.0, 10.0, 70.0, 30.0, 20.0, 40.0, 0.0, 20.0, 60.0, 10.0, 30.0, 350.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 70.0, 40.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 0.0, 30.0, 40.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 40.0, 10.0, 0.0, 70.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 90.0, 50.0, 160.0, 60.0, -20.0, 10.0, 30.0, 120.0, 70.0, 0.0, 250.0, -10.0, 60.0, 110.0, 60.0, 90.0, 0.0, 50.0, 140.0, 20.0, 20.0, 70.0, 30.0, 50.0, 55.0, 70.0, 60.0, 0.0, 40.0, 70.0, 170.0, 80.0, 30.0, 20.0, 10.0, 20.0, 50.0, 50.0, 30.0, 60.0, 30.0, 20.0, 30.0, 10.0, 120.0, 30.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 10.0, 180.0, 0.0, 170.0, 70.0, 300.0, 50.0, 30.0, 80.0, 40.0, 140.0, 50.0, 10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.632908868127426, "mean_inference_ms": 1.3802175701830353, "mean_action_processing_ms": 0.40479959050083364, "mean_env_wait_ms": 1.3069002033265245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012674808502197266, "StateBufferConnector_ms": 0.009356498718261719, "ViewRequirementAgentConnector_ms": 0.3881664276123047}, "num_episodes": 18, "episode_return_max": 930.0, "episode_return_min": 130.0, "episode_return_mean": 397.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.176353306743387, "num_env_steps_trained_throughput_per_sec": 21.176353306743387, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 187725.316, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187725.246, "sample_time_ms": 2631.687, "learn_time_ms": 185071.303, "learn_throughput": 21.613, "synch_weights_time_ms": 11.612}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "33e63_00000", "date": "2024-06-18_21-57-24", "timestamp": 1718762244, "time_this_iter_s": 188.9166181087494, "time_total_s": 3027.339023590088, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327240ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3027.339023590088, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 25.40186567164179, "ram_util_percent": 79.67723880597015}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2873616398079073, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.631012012148563, "policy_loss": -0.01087437771814672, "vf_loss": 5.640106871282965, "vf_explained_var": 0.004759339872386636, "kl": 0.00889757909066467, "entropy": 1.2154018721260582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 930.0, "episode_reward_min": 130.0, "episode_reward_mean": 421.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 42.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 260.0, 220.0, 450.0, 440.0, 440.0, 250.0, 380.0, 420.0, 430.0, 670.0, 340.0, 265.0, 155.0, 385.0, 130.0, 340.0, 250.0, 430.0, 510.0, 670.0, 370.0, 220.0, 340.0, 190.0, 235.0, 310.0, 275.0, 210.0, 150.0, 350.0, 230.0, 345.0, 540.0, 730.0, 255.0, 320.0, 410.0, 180.0, 545.0, 660.0, 440.0, 380.0, 610.0, 535.0, 620.0, 630.0, 400.0, 610.0, 500.0, 350.0, 360.0, 520.0, 170.0, 250.0, 200.0, 320.0, 710.0, 520.0, 545.0, 540.0, 370.0, 220.0, 490.0, 360.0, 450.0, 525.0, 885.0, 570.0, 580.0, 160.0, 430.0, 230.0, 210.0, 470.0, 620.0, 530.0, 595.0, 310.0, 570.0, 930.0, 340.0, 170.0, 290.0, 640.0, 320.0, 360.0, 710.0, 370.0, 530.0, 630.0, 520.0, 450.0, 350.0, 620.0, 530.0, 480.0, 430.0, 310.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 0.0, 70.0, 30.0, 20.0, 10.0, 30.0, 40.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 10.0, 40.0, 90.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 180.0, 200.0, -50.0, 10.0, 80.0, 20.0, 10.0, 50.0, 10.0, 10.0, 40.0, 50.0, 170.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 20.0, 90.0, 170.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 30.0, 60.0, 30.0, 20.0, 20.0, 60.0, 40.0, 30.0, 80.0, 10.0, 30.0, 0.0, 70.0, 60.0, 0.0, 60.0, 70.0, 90.0, 50.0, 0.0, 10.0, 10.0, 70.0, 50.0, 10.0, 40.0, 50.0, 80.0, 60.0, 10.0, 0.0, 60.0, 10.0, 60.0, 60.0, 20.0, 0.0, 70.0, 50.0, 50.0, 180.0, 80.0, 170.0, 50.0, 0.0, 30.0, 30.0, 40.0, 10.0, 40.0, 0.0, 50.0, 0.0, 60.0, 80.0, 20.0, 30.0, 30.0, 40.0, 40.0, 0.0, 40.0, 30.0, 5.0, 30.0, 5.0, 10.0, 30.0, 30.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 35.0, 80.0, 50.0, 30.0, 80.0, 30.0, 0.0, 10.0, 10.0, 20.0, 20.0, 10.0, 20.0, 30.0, 10.0, 0.0, 0.0, 90.0, 70.0, 0.0, 10.0, 0.0, 30.0, 60.0, 40.0, 0.0, 40.0, 40.0, 30.0, 50.0, 50.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0, 20.0, -10.0, 20.0, 0.0, 150.0, 40.0, 150.0, 10.0, 40.0, 90.0, 190.0, 30.0, -50.0, 80.0, 60.0, 90.0, 80.0, 0.0, 50.0, 140.0, 40.0, 20.0, 40.0, 10.0, 70.0, 5.0, 170.0, -40.0, 40.0, 15.0, 50.0, 60.0, -100.0, 30.0, 40.0, 20.0, 20.0, 20.0, 70.0, 10.0, 50.0, 20.0, 90.0, 0.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 15.0, 50.0, 10.0, 40.0, 80.0, 30.0, 80.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 10.0, 170.0, 0.0, 10.0, 20.0, -15.0, 40.0, 0.0, 30.0, 70.0, 10.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 130.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 10.0, 10.0, 20.0, 0.0, 50.0, 40.0, 10.0, 40.0, 60.0, 20.0, 60.0, 30.0, 20.0, 15.0, 50.0, 70.0, 220.0, 20.0, 50.0, 30.0, 10.0, 40.0, 10.0, 40.0, 40.0, 70.0, 60.0, 0.0, 350.0, 70.0, 80.0, -30.0, 50.0, 40.0, 20.0, 50.0, 5.0, 40.0, 50.0, 10.0, 0.0, 30.0, 10.0, 40.0, -50.0, 80.0, -30.0, 10.0, 20.0, 20.0, 190.0, 60.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 30.0, 50.0, 50.0, 20.0, 90.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 60.0, 40.0, 40.0, 40.0, 100.0, 25.0, 60.0, 100.0, 160.0, 30.0, 50.0, 20.0, 70.0, 0.0, 260.0, 30.0, 30.0, 10.0, 80.0, 30.0, 0.0, 60.0, 50.0, 0.0, 40.0, 30.0, 20.0, 130.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 10.0, 70.0, 170.0, 10.0, 100.0, 160.0, 50.0, 60.0, 70.0, 40.0, -40.0, 70.0, 70.0, 30.0, 20.0, 70.0, 80.0, 80.0, 40.0, 95.0, 30.0, 70.0, 30.0, 20.0, 280.0, 140.0, 50.0, 30.0, 30.0, -10.0, 10.0, 10.0, 20.0, 60.0, 20.0, 50.0, 80.0, 40.0, 40.0, 90.0, 70.0, 170.0, 60.0, 10.0, 10.0, 50.0, 40.0, 30.0, 10.0, 80.0, 30.0, 40.0, 30.0, 80.0, 90.0, 70.0, 20.0, 50.0, 20.0, 0.0, 210.0, 20.0, 60.0, 70.0, 40.0, 80.0, 10.0, 100.0, 90.0, 30.0, 30.0, 40.0, 50.0, 30.0, 10.0, 80.0, 50.0, 40.0, 10.0, 10.0, 10.0, 80.0, 40.0, 20.0, 40.0, 0.0, 90.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 100.0, 30.0, 80.0, 10.0, 60.0, 20.0, 0.0, 80.0, 20.0, 50.0, 170.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 70.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 70.0, 20.0, 20.0, 30.0, 0.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 40.0, 80.0, 80.0, 50.0, 100.0, 60.0, 70.0, 90.0, 60.0, 80.0, 0.0, 70.0, 80.0, 40.0, 100.0, 40.0, 30.0, 70.0, 60.0, 30.0, 50.0, -40.0, 250.0, 80.0, 60.0, 40.0, 20.0, 40.0, 50.0, -5.0, 60.0, 70.0, 60.0, 20.0, 120.0, 20.0, 30.0, 0.0, 120.0, 40.0, 20.0, 50.0, 10.0, 70.0, 40.0, 10.0, 90.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, -25.0, 10.0, 50.0, 10.0, 25.0, 60.0, 110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0, 90.0, 40.0, 40.0, 30.0, 80.0, 10.0, 40.0, 0.0, 20.0, 10.0, 50.0, 40.0, 10.0, 250.0, -40.0, 20.0, 40.0, 20.0, 20.0, 40.0, -5.0, 40.0, 70.0, 70.0, 20.0, 50.0, 170.0, 10.0, 90.0, 10.0, 155.0, 410.0, 10.0, 30.0, 10.0, 180.0, 30.0, 10.0, 20.0, 30.0, 170.0, 40.0, 30.0, 110.0, 90.0, 10.0, 20.0, 20.0, 10.0, 70.0, 30.0, 20.0, 40.0, 0.0, 20.0, 60.0, 10.0, 30.0, 350.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 70.0, 40.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 0.0, 30.0, 40.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 40.0, 10.0, 0.0, 70.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 90.0, 50.0, 160.0, 60.0, -20.0, 10.0, 30.0, 120.0, 70.0, 0.0, 250.0, -10.0, 60.0, 110.0, 60.0, 90.0, 0.0, 50.0, 140.0, 20.0, 20.0, 70.0, 30.0, 50.0, 55.0, 70.0, 60.0, 0.0, 40.0, 70.0, 170.0, 80.0, 30.0, 20.0, 10.0, 20.0, 50.0, 50.0, 30.0, 60.0, 30.0, 20.0, 30.0, 10.0, 120.0, 30.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 10.0, 180.0, 0.0, 170.0, 70.0, 300.0, 50.0, 30.0, 80.0, 40.0, 140.0, 50.0, 10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 90.0, 0.0, 10.0, 160.0, 50.0, 70.0, 180.0, 30.0, 20.0, 30.0, 10.0, 10.0, 40.0, 130.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 10.0, 50.0, 100.0, 40.0, 30.0, 30.0, 0.0, 30.0, 140.0, 40.0, 100.0, 30.0, 20.0, 30.0, 50.0, 30.0, 110.0, 160.0, 50.0, 60.0, 20.0, 10.0, 0.0, 40.0, 90.0, 20.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 90.0, 70.0, 30.0, 100.0, 50.0, 70.0, 60.0, 100.0, 40.0, 60.0, 40.0, 70.0, 80.0, 20.0, 80.0, 80.0, 40.0, 30.0, 30.0, 90.0, 10.0, 10.0, 80.0, 30.0, 160.0, 40.0, 70.0, 40.0, 150.0, 10.0, 50.0, 30.0, 10.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 100.0, 20.0, 30.0, 60.0, 10.0, 30.0, 30.0, 100.0, 30.0, 40.0, 40.0, 0.0, 70.0, 20.0, 130.0, 50.0, 140.0, 40.0, 20.0, 70.0, 170.0, 0.0, 150.0, 0.0, 70.0, 0.0, 10.0, 140.0, 0.0, 10.0, 50.0, 10.0, 70.0, 10.0, 40.0, 130.0, 20.0, 0.0, 30.0, 70.0, 10.0, 120.0, 30.0, 0.0, 30.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 0.0, 190.0, 10.0, 20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628788769183032, "mean_inference_ms": 1.3811703197907894, "mean_action_processing_ms": 0.4036366396196551, "mean_env_wait_ms": 1.3019616609008766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012659311294555664, "StateBufferConnector_ms": 0.009196281433105469, "ViewRequirementAgentConnector_ms": 0.3822159767150879}, "num_episodes": 18, "episode_return_max": 930.0, "episode_return_min": 130.0, "episode_return_mean": 421.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.00600884691286, "num_env_steps_trained_throughput_per_sec": 21.00600884691286, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 187918.14, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187918.071, "sample_time_ms": 2657.904, "learn_time_ms": 185237.859, "learn_throughput": 21.594, "synch_weights_time_ms": 11.749}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "33e63_00000", "date": "2024-06-18_22-00-34", "timestamp": 1718762434, "time_this_iter_s": 190.45452117919922, "time_total_s": 3217.793544769287, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327157d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3217.793544769287, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 27.07881040892193, "ram_util_percent": 80.06505576208178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.457450325566486, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.963204718651736, "policy_loss": -0.011628425468544895, "vf_loss": 5.973120119828132, "vf_explained_var": 5.4840938732646903e-05, "kl": 0.008565115142143316, "entropy": 1.195590719450523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 930.0, "episode_reward_min": 150.0, "episode_reward_mean": 468.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 46.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [430.0, 510.0, 670.0, 370.0, 220.0, 340.0, 190.0, 235.0, 310.0, 275.0, 210.0, 150.0, 350.0, 230.0, 345.0, 540.0, 730.0, 255.0, 320.0, 410.0, 180.0, 545.0, 660.0, 440.0, 380.0, 610.0, 535.0, 620.0, 630.0, 400.0, 610.0, 500.0, 350.0, 360.0, 520.0, 170.0, 250.0, 200.0, 320.0, 710.0, 520.0, 545.0, 540.0, 370.0, 220.0, 490.0, 360.0, 450.0, 525.0, 885.0, 570.0, 580.0, 160.0, 430.0, 230.0, 210.0, 470.0, 620.0, 530.0, 595.0, 310.0, 570.0, 930.0, 340.0, 170.0, 290.0, 640.0, 320.0, 360.0, 710.0, 370.0, 530.0, 630.0, 520.0, 450.0, 350.0, 620.0, 530.0, 480.0, 430.0, 310.0, 930.0, 770.0, 760.0, 420.0, 785.0, 440.0, 410.0, 680.0, 405.0, 340.0, 455.0, 830.0, 690.0, 740.0, 560.0, 290.0, 780.0, 850.0, 425.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 40.0, 30.0, 20.0, 40.0, 0.0, 0.0, 170.0, 40.0, 50.0, 20.0, -10.0, 20.0, 0.0, 150.0, 40.0, 150.0, 10.0, 40.0, 90.0, 190.0, 30.0, -50.0, 80.0, 60.0, 90.0, 80.0, 0.0, 50.0, 140.0, 40.0, 20.0, 40.0, 10.0, 70.0, 5.0, 170.0, -40.0, 40.0, 15.0, 50.0, 60.0, -100.0, 30.0, 40.0, 20.0, 20.0, 20.0, 70.0, 10.0, 50.0, 20.0, 90.0, 0.0, 30.0, 30.0, 50.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 15.0, 50.0, 10.0, 40.0, 80.0, 30.0, 80.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 10.0, 170.0, 0.0, 10.0, 20.0, -15.0, 40.0, 0.0, 30.0, 70.0, 10.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 40.0, 30.0, 20.0, 30.0, 20.0, 50.0, 40.0, 20.0, 10.0, 130.0, 20.0, 10.0, 20.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 10.0, 10.0, 20.0, 0.0, 50.0, 40.0, 10.0, 40.0, 60.0, 20.0, 60.0, 30.0, 20.0, 15.0, 50.0, 70.0, 220.0, 20.0, 50.0, 30.0, 10.0, 40.0, 10.0, 40.0, 40.0, 70.0, 60.0, 0.0, 350.0, 70.0, 80.0, -30.0, 50.0, 40.0, 20.0, 50.0, 5.0, 40.0, 50.0, 10.0, 0.0, 30.0, 10.0, 40.0, -50.0, 80.0, -30.0, 10.0, 20.0, 20.0, 190.0, 60.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 30.0, 50.0, 50.0, 20.0, 90.0, 30.0, 20.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 10.0, 10.0, 10.0, 50.0, 30.0, 60.0, 40.0, 40.0, 40.0, 100.0, 25.0, 60.0, 100.0, 160.0, 30.0, 50.0, 20.0, 70.0, 0.0, 260.0, 30.0, 30.0, 10.0, 80.0, 30.0, 0.0, 60.0, 50.0, 0.0, 40.0, 30.0, 20.0, 130.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 10.0, 70.0, 170.0, 10.0, 100.0, 160.0, 50.0, 60.0, 70.0, 40.0, -40.0, 70.0, 70.0, 30.0, 20.0, 70.0, 80.0, 80.0, 40.0, 95.0, 30.0, 70.0, 30.0, 20.0, 280.0, 140.0, 50.0, 30.0, 30.0, -10.0, 10.0, 10.0, 20.0, 60.0, 20.0, 50.0, 80.0, 40.0, 40.0, 90.0, 70.0, 170.0, 60.0, 10.0, 10.0, 50.0, 40.0, 30.0, 10.0, 80.0, 30.0, 40.0, 30.0, 80.0, 90.0, 70.0, 20.0, 50.0, 20.0, 0.0, 210.0, 20.0, 60.0, 70.0, 40.0, 80.0, 10.0, 100.0, 90.0, 30.0, 30.0, 40.0, 50.0, 30.0, 10.0, 80.0, 50.0, 40.0, 10.0, 10.0, 10.0, 80.0, 40.0, 20.0, 40.0, 0.0, 90.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 100.0, 30.0, 80.0, 10.0, 60.0, 20.0, 0.0, 80.0, 20.0, 50.0, 170.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 70.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 70.0, 20.0, 20.0, 30.0, 0.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 40.0, 80.0, 80.0, 50.0, 100.0, 60.0, 70.0, 90.0, 60.0, 80.0, 0.0, 70.0, 80.0, 40.0, 100.0, 40.0, 30.0, 70.0, 60.0, 30.0, 50.0, -40.0, 250.0, 80.0, 60.0, 40.0, 20.0, 40.0, 50.0, -5.0, 60.0, 70.0, 60.0, 20.0, 120.0, 20.0, 30.0, 0.0, 120.0, 40.0, 20.0, 50.0, 10.0, 70.0, 40.0, 10.0, 90.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, -25.0, 10.0, 50.0, 10.0, 25.0, 60.0, 110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0, 90.0, 40.0, 40.0, 30.0, 80.0, 10.0, 40.0, 0.0, 20.0, 10.0, 50.0, 40.0, 10.0, 250.0, -40.0, 20.0, 40.0, 20.0, 20.0, 40.0, -5.0, 40.0, 70.0, 70.0, 20.0, 50.0, 170.0, 10.0, 90.0, 10.0, 155.0, 410.0, 10.0, 30.0, 10.0, 180.0, 30.0, 10.0, 20.0, 30.0, 170.0, 40.0, 30.0, 110.0, 90.0, 10.0, 20.0, 20.0, 10.0, 70.0, 30.0, 20.0, 40.0, 0.0, 20.0, 60.0, 10.0, 30.0, 350.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 70.0, 40.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 0.0, 30.0, 40.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 40.0, 10.0, 0.0, 70.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 90.0, 50.0, 160.0, 60.0, -20.0, 10.0, 30.0, 120.0, 70.0, 0.0, 250.0, -10.0, 60.0, 110.0, 60.0, 90.0, 0.0, 50.0, 140.0, 20.0, 20.0, 70.0, 30.0, 50.0, 55.0, 70.0, 60.0, 0.0, 40.0, 70.0, 170.0, 80.0, 30.0, 20.0, 10.0, 20.0, 50.0, 50.0, 30.0, 60.0, 30.0, 20.0, 30.0, 10.0, 120.0, 30.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 10.0, 180.0, 0.0, 170.0, 70.0, 300.0, 50.0, 30.0, 80.0, 40.0, 140.0, 50.0, 10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 90.0, 0.0, 10.0, 160.0, 50.0, 70.0, 180.0, 30.0, 20.0, 30.0, 10.0, 10.0, 40.0, 130.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 10.0, 50.0, 100.0, 40.0, 30.0, 30.0, 0.0, 30.0, 140.0, 40.0, 100.0, 30.0, 20.0, 30.0, 50.0, 30.0, 110.0, 160.0, 50.0, 60.0, 20.0, 10.0, 0.0, 40.0, 90.0, 20.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 90.0, 70.0, 30.0, 100.0, 50.0, 70.0, 60.0, 100.0, 40.0, 60.0, 40.0, 70.0, 80.0, 20.0, 80.0, 80.0, 40.0, 30.0, 30.0, 90.0, 10.0, 10.0, 80.0, 30.0, 160.0, 40.0, 70.0, 40.0, 150.0, 10.0, 50.0, 30.0, 10.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 100.0, 20.0, 30.0, 60.0, 10.0, 30.0, 30.0, 100.0, 30.0, 40.0, 40.0, 0.0, 70.0, 20.0, 130.0, 50.0, 140.0, 40.0, 20.0, 70.0, 170.0, 0.0, 150.0, 0.0, 70.0, 0.0, 10.0, 140.0, 0.0, 10.0, 50.0, 10.0, 70.0, 10.0, 40.0, 130.0, 20.0, 0.0, 30.0, 70.0, 10.0, 120.0, 30.0, 0.0, 30.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 0.0, 190.0, 10.0, 20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0, 70.0, 60.0, 50.0, 70.0, 20.0, 80.0, 140.0, 190.0, 60.0, 30.0, 30.0, 80.0, 110.0, 20.0, 50.0, 60.0, 40.0, 210.0, 50.0, 110.0, 10.0, 40.0, 40.0, 40.0, 60.0, 80.0, 50.0, 50.0, 10.0, 40.0, 20.0, 60.0, 80.0, 40.0, 10.0, 260.0, 240.0, 0.0, 60.0, 15.0, 30.0, 10.0, 20.0, 110.0, 80.0, 60.0, 30.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 100.0, 40.0, 80.0, 40.0, 80.0, 150.0, 10.0, 140.0, 40.0, 50.0, 40.0, 90.0, 60.0, 20.0, 80.0, 10.0, 60.0, 50.0, 80.0, 10.0, 15.0, 20.0, 70.0, 70.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 80.0, 20.0, 20.0, 0.0, 55.0, 90.0, 50.0, 60.0, 30.0, 40.0, 90.0, 90.0, 180.0, 10.0, 50.0, 40.0, 170.0, 120.0, 70.0, 70.0, 30.0, 20.0, 0.0, 10.0, 80.0, 120.0, 130.0, 140.0, 50.0, 40.0, 100.0, 80.0, 40.0, 130.0, 240.0, 20.0, 20.0, 100.0, 40.0, 40.0, 30.0, 100.0, 40.0, 10.0, 130.0, 50.0, 20.0, 50.0, 80.0, 10.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 80.0, 70.0, 10.0, 20.0, 20.0, 80.0, 90.0, 10.0, 40.0, 50.0, 20.0, 40.0, 140.0, 170.0, 140.0, 60.0, 150.0, 30.0, 60.0, 60.0, 80.0, 270.0, 5.0, 35.0, 100.0, 10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.630433867139821, "mean_inference_ms": 1.38639298232367, "mean_action_processing_ms": 0.403259215736672, "mean_env_wait_ms": 1.3007008124117079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01242518424987793, "StateBufferConnector_ms": 0.009203672409057617, "ViewRequirementAgentConnector_ms": 0.4027903079986572}, "num_episodes": 18, "episode_return_max": 930.0, "episode_return_min": 150.0, "episode_return_mean": 468.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.032388784762542, "num_env_steps_trained_throughput_per_sec": 21.032388784762542, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 187920.699, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187920.639, "sample_time_ms": 2763.879, "learn_time_ms": 185135.197, "learn_throughput": 21.606, "synch_weights_time_ms": 12.106}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "33e63_00000", "date": "2024-06-18_22-03-44", "timestamp": 1718762624, "time_this_iter_s": 190.1964569091797, "time_total_s": 3407.990001678467, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3407.990001678467, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 29.229739776951675, "ram_util_percent": 79.75390334572491}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1530733592594014, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.515820344187581, "policy_loss": -0.011565053143862861, "vf_loss": 6.525569840818168, "vf_explained_var": 0.0028577505336148034, "kl": 0.00907779943963193, "entropy": 1.14811382894191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 160.0, "episode_reward_mean": 522.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -40.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 52.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [660.0, 440.0, 380.0, 610.0, 535.0, 620.0, 630.0, 400.0, 610.0, 500.0, 350.0, 360.0, 520.0, 170.0, 250.0, 200.0, 320.0, 710.0, 520.0, 545.0, 540.0, 370.0, 220.0, 490.0, 360.0, 450.0, 525.0, 885.0, 570.0, 580.0, 160.0, 430.0, 230.0, 210.0, 470.0, 620.0, 530.0, 595.0, 310.0, 570.0, 930.0, 340.0, 170.0, 290.0, 640.0, 320.0, 360.0, 710.0, 370.0, 530.0, 630.0, 520.0, 450.0, 350.0, 620.0, 530.0, 480.0, 430.0, 310.0, 930.0, 770.0, 760.0, 420.0, 785.0, 440.0, 410.0, 680.0, 405.0, 340.0, 455.0, 830.0, 690.0, 740.0, 560.0, 290.0, 780.0, 850.0, 425.0, 410.0, 990.0, 605.0, 460.0, 530.0, 855.0, 690.0, 260.0, 610.0, 670.0, 880.0, 500.0, 550.0, 1070.0, 355.0, 640.0, 540.0, 410.0, 470.0, 490.0, 530.0, 765.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [160.0, 30.0, 50.0, 20.0, 70.0, 0.0, 260.0, 30.0, 30.0, 10.0, 80.0, 30.0, 0.0, 60.0, 50.0, 0.0, 40.0, 30.0, 20.0, 130.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 10.0, 70.0, 170.0, 10.0, 100.0, 160.0, 50.0, 60.0, 70.0, 40.0, -40.0, 70.0, 70.0, 30.0, 20.0, 70.0, 80.0, 80.0, 40.0, 95.0, 30.0, 70.0, 30.0, 20.0, 280.0, 140.0, 50.0, 30.0, 30.0, -10.0, 10.0, 10.0, 20.0, 60.0, 20.0, 50.0, 80.0, 40.0, 40.0, 90.0, 70.0, 170.0, 60.0, 10.0, 10.0, 50.0, 40.0, 30.0, 10.0, 80.0, 30.0, 40.0, 30.0, 80.0, 90.0, 70.0, 20.0, 50.0, 20.0, 0.0, 210.0, 20.0, 60.0, 70.0, 40.0, 80.0, 10.0, 100.0, 90.0, 30.0, 30.0, 40.0, 50.0, 30.0, 10.0, 80.0, 50.0, 40.0, 10.0, 10.0, 10.0, 80.0, 40.0, 20.0, 40.0, 0.0, 90.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 100.0, 30.0, 80.0, 10.0, 60.0, 20.0, 0.0, 80.0, 20.0, 50.0, 170.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 10.0, 10.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 70.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 70.0, 20.0, 20.0, 30.0, 0.0, 30.0, 40.0, 30.0, 30.0, 70.0, 50.0, 40.0, 80.0, 80.0, 50.0, 100.0, 60.0, 70.0, 90.0, 60.0, 80.0, 0.0, 70.0, 80.0, 40.0, 100.0, 40.0, 30.0, 70.0, 60.0, 30.0, 50.0, -40.0, 250.0, 80.0, 60.0, 40.0, 20.0, 40.0, 50.0, -5.0, 60.0, 70.0, 60.0, 20.0, 120.0, 20.0, 30.0, 0.0, 120.0, 40.0, 20.0, 50.0, 10.0, 70.0, 40.0, 10.0, 90.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 30.0, -25.0, 10.0, 50.0, 10.0, 25.0, 60.0, 110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0, 90.0, 40.0, 40.0, 30.0, 80.0, 10.0, 40.0, 0.0, 20.0, 10.0, 50.0, 40.0, 10.0, 250.0, -40.0, 20.0, 40.0, 20.0, 20.0, 40.0, -5.0, 40.0, 70.0, 70.0, 20.0, 50.0, 170.0, 10.0, 90.0, 10.0, 155.0, 410.0, 10.0, 30.0, 10.0, 180.0, 30.0, 10.0, 20.0, 30.0, 170.0, 40.0, 30.0, 110.0, 90.0, 10.0, 20.0, 20.0, 10.0, 70.0, 30.0, 20.0, 40.0, 0.0, 20.0, 60.0, 10.0, 30.0, 350.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 70.0, 40.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 0.0, 30.0, 40.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 40.0, 10.0, 0.0, 70.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 90.0, 50.0, 160.0, 60.0, -20.0, 10.0, 30.0, 120.0, 70.0, 0.0, 250.0, -10.0, 60.0, 110.0, 60.0, 90.0, 0.0, 50.0, 140.0, 20.0, 20.0, 70.0, 30.0, 50.0, 55.0, 70.0, 60.0, 0.0, 40.0, 70.0, 170.0, 80.0, 30.0, 20.0, 10.0, 20.0, 50.0, 50.0, 30.0, 60.0, 30.0, 20.0, 30.0, 10.0, 120.0, 30.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 10.0, 180.0, 0.0, 170.0, 70.0, 300.0, 50.0, 30.0, 80.0, 40.0, 140.0, 50.0, 10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 90.0, 0.0, 10.0, 160.0, 50.0, 70.0, 180.0, 30.0, 20.0, 30.0, 10.0, 10.0, 40.0, 130.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 10.0, 50.0, 100.0, 40.0, 30.0, 30.0, 0.0, 30.0, 140.0, 40.0, 100.0, 30.0, 20.0, 30.0, 50.0, 30.0, 110.0, 160.0, 50.0, 60.0, 20.0, 10.0, 0.0, 40.0, 90.0, 20.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 90.0, 70.0, 30.0, 100.0, 50.0, 70.0, 60.0, 100.0, 40.0, 60.0, 40.0, 70.0, 80.0, 20.0, 80.0, 80.0, 40.0, 30.0, 30.0, 90.0, 10.0, 10.0, 80.0, 30.0, 160.0, 40.0, 70.0, 40.0, 150.0, 10.0, 50.0, 30.0, 10.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 100.0, 20.0, 30.0, 60.0, 10.0, 30.0, 30.0, 100.0, 30.0, 40.0, 40.0, 0.0, 70.0, 20.0, 130.0, 50.0, 140.0, 40.0, 20.0, 70.0, 170.0, 0.0, 150.0, 0.0, 70.0, 0.0, 10.0, 140.0, 0.0, 10.0, 50.0, 10.0, 70.0, 10.0, 40.0, 130.0, 20.0, 0.0, 30.0, 70.0, 10.0, 120.0, 30.0, 0.0, 30.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 0.0, 190.0, 10.0, 20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0, 70.0, 60.0, 50.0, 70.0, 20.0, 80.0, 140.0, 190.0, 60.0, 30.0, 30.0, 80.0, 110.0, 20.0, 50.0, 60.0, 40.0, 210.0, 50.0, 110.0, 10.0, 40.0, 40.0, 40.0, 60.0, 80.0, 50.0, 50.0, 10.0, 40.0, 20.0, 60.0, 80.0, 40.0, 10.0, 260.0, 240.0, 0.0, 60.0, 15.0, 30.0, 10.0, 20.0, 110.0, 80.0, 60.0, 30.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 100.0, 40.0, 80.0, 40.0, 80.0, 150.0, 10.0, 140.0, 40.0, 50.0, 40.0, 90.0, 60.0, 20.0, 80.0, 10.0, 60.0, 50.0, 80.0, 10.0, 15.0, 20.0, 70.0, 70.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 80.0, 20.0, 20.0, 0.0, 55.0, 90.0, 50.0, 60.0, 30.0, 40.0, 90.0, 90.0, 180.0, 10.0, 50.0, 40.0, 170.0, 120.0, 70.0, 70.0, 30.0, 20.0, 0.0, 10.0, 80.0, 120.0, 130.0, 140.0, 50.0, 40.0, 100.0, 80.0, 40.0, 130.0, 240.0, 20.0, 20.0, 100.0, 40.0, 40.0, 30.0, 100.0, 40.0, 10.0, 130.0, 50.0, 20.0, 50.0, 80.0, 10.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 80.0, 70.0, 10.0, 20.0, 20.0, 80.0, 90.0, 10.0, 40.0, 50.0, 20.0, 40.0, 140.0, 170.0, 140.0, 60.0, 150.0, 30.0, 60.0, 60.0, 80.0, 270.0, 5.0, 35.0, 100.0, 10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0, 30.0, 20.0, 120.0, 40.0, 60.0, 40.0, 20.0, 40.0, 20.0, 20.0, 50.0, 70.0, 100.0, 60.0, 170.0, 160.0, 70.0, 280.0, 20.0, 10.0, 110.0, 40.0, 30.0, 10.0, 65.0, 100.0, 80.0, 50.0, 60.0, 60.0, 35.0, 10.0, 30.0, 35.0, 50.0, 140.0, -30.0, 60.0, 20.0, 110.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 90.0, 190.0, 0.0, 50.0, -5.0, 60.0, 20.0, 180.0, 160.0, 20.0, 20.0, 160.0, 190.0, 50.0, 50.0, -30.0, 40.0, 260.0, 20.0, 30.0, 160.0, 70.0, 20.0, 70.0, 40.0, 20.0, 40.0, 0.0, 20.0, 30.0, 40.0, 10.0, 40.0, 20.0, 140.0, 50.0, 50.0, 120.0, 60.0, 30.0, 30.0, 50.0, 70.0, 10.0, 50.0, 30.0, 30.0, 30.0, 40.0, 270.0, 60.0, 70.0, 80.0, 10.0, 70.0, 50.0, 380.0, 50.0, 160.0, 20.0, 10.0, 70.0, 40.0, 30.0, 20.0, 40.0, 10.0, 70.0, 40.0, 50.0, 120.0, 50.0, 20.0, 80.0, 0.0, 10.0, 30.0, 0.0, 170.0, 30.0, 110.0, 20.0, 90.0, 90.0, 60.0, 120.0, 100.0, 70.0, 330.0, 40.0, 40.0, 170.0, 60.0, 80.0, 70.0, 10.0, -10.0, 0.0, 120.0, 5.0, 70.0, 0.0, 20.0, 70.0, 70.0, 50.0, 70.0, 50.0, 40.0, 140.0, 90.0, 30.0, 20.0, 80.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 30.0, 0.0, 150.0, 40.0, 160.0, 40.0, 140.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 150.0, 20.0, 50.0, 40.0, 10.0, 30.0, 150.0, 30.0, 30.0, -40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 50.0, 80.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 70.0, 10.0, 110.0, 60.0, 20.0, 80.0, 45.0, 90.0, 150.0, 170.0, 0.0, 70.0, 90.0, 40.0, 50.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6345980436159573, "mean_inference_ms": 1.3927714232544435, "mean_action_processing_ms": 0.40301472036990377, "mean_env_wait_ms": 1.299971255163948, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012487411499023438, "StateBufferConnector_ms": 0.009260892868041992, "ViewRequirementAgentConnector_ms": 0.4056694507598877}, "num_episodes": 22, "episode_return_max": 1070.0, "episode_return_min": 160.0, "episode_return_mean": 522.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.17506614384149, "num_env_steps_trained_throughput_per_sec": 21.17506614384149, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 187971.435, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187971.375, "sample_time_ms": 2772.159, "learn_time_ms": 185177.314, "learn_throughput": 21.601, "synch_weights_time_ms": 12.355}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "33e63_00000", "date": "2024-06-18_22-06-53", "timestamp": 1718762813, "time_this_iter_s": 188.91770887374878, "time_total_s": 3596.9077105522156, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3596.9077105522156, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 28.95805243445693, "ram_util_percent": 79.80524344569288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1135901885228163, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5290093539748835, "policy_loss": -0.010942260490698666, "vf_loss": 5.5383618286496406, "vf_explained_var": 0.002596241426163207, "kl": 0.007948913317193848, "entropy": 1.1376805443479356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 160.0, "episode_reward_mean": 541.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -75.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 54.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.0, 360.0, 450.0, 525.0, 885.0, 570.0, 580.0, 160.0, 430.0, 230.0, 210.0, 470.0, 620.0, 530.0, 595.0, 310.0, 570.0, 930.0, 340.0, 170.0, 290.0, 640.0, 320.0, 360.0, 710.0, 370.0, 530.0, 630.0, 520.0, 450.0, 350.0, 620.0, 530.0, 480.0, 430.0, 310.0, 930.0, 770.0, 760.0, 420.0, 785.0, 440.0, 410.0, 680.0, 405.0, 340.0, 455.0, 830.0, 690.0, 740.0, 560.0, 290.0, 780.0, 850.0, 425.0, 410.0, 990.0, 605.0, 460.0, 530.0, 855.0, 690.0, 260.0, 610.0, 670.0, 880.0, 500.0, 550.0, 1070.0, 355.0, 640.0, 540.0, 410.0, 470.0, 490.0, 530.0, 765.0, 820.0, 270.0, 280.0, 380.0, 300.0, 595.0, 745.0, 910.0, 520.0, 860.0, 275.0, 770.0, 350.0, 340.0, 730.0, 675.0, 290.0, 440.0, 660.0, 230.0, 930.0, 510.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 30.0, 30.0, 30.0, 60.0, 30.0, 60.0, 20.0, 80.0, 40.0, 90.0, 40.0, 40.0, 30.0, 80.0, 10.0, 40.0, 0.0, 20.0, 10.0, 50.0, 40.0, 10.0, 250.0, -40.0, 20.0, 40.0, 20.0, 20.0, 40.0, -5.0, 40.0, 70.0, 70.0, 20.0, 50.0, 170.0, 10.0, 90.0, 10.0, 155.0, 410.0, 10.0, 30.0, 10.0, 180.0, 30.0, 10.0, 20.0, 30.0, 170.0, 40.0, 30.0, 110.0, 90.0, 10.0, 20.0, 20.0, 10.0, 70.0, 30.0, 20.0, 40.0, 0.0, 20.0, 60.0, 10.0, 30.0, 350.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 70.0, 40.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 0.0, 30.0, 40.0, 10.0, 30.0, 10.0, 40.0, 0.0, 30.0, 40.0, 10.0, 0.0, 70.0, 30.0, 10.0, 30.0, 10.0, 20.0, 10.0, 20.0, -20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 90.0, 50.0, 160.0, 60.0, -20.0, 10.0, 30.0, 120.0, 70.0, 0.0, 250.0, -10.0, 60.0, 110.0, 60.0, 90.0, 0.0, 50.0, 140.0, 20.0, 20.0, 70.0, 30.0, 50.0, 55.0, 70.0, 60.0, 0.0, 40.0, 70.0, 170.0, 80.0, 30.0, 20.0, 10.0, 20.0, 50.0, 50.0, 30.0, 60.0, 30.0, 20.0, 30.0, 10.0, 120.0, 30.0, 40.0, 30.0, 20.0, 40.0, 60.0, 40.0, 10.0, 180.0, 0.0, 170.0, 70.0, 300.0, 50.0, 30.0, 80.0, 40.0, 140.0, 50.0, 10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 90.0, 0.0, 10.0, 160.0, 50.0, 70.0, 180.0, 30.0, 20.0, 30.0, 10.0, 10.0, 40.0, 130.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 10.0, 50.0, 100.0, 40.0, 30.0, 30.0, 0.0, 30.0, 140.0, 40.0, 100.0, 30.0, 20.0, 30.0, 50.0, 30.0, 110.0, 160.0, 50.0, 60.0, 20.0, 10.0, 0.0, 40.0, 90.0, 20.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 90.0, 70.0, 30.0, 100.0, 50.0, 70.0, 60.0, 100.0, 40.0, 60.0, 40.0, 70.0, 80.0, 20.0, 80.0, 80.0, 40.0, 30.0, 30.0, 90.0, 10.0, 10.0, 80.0, 30.0, 160.0, 40.0, 70.0, 40.0, 150.0, 10.0, 50.0, 30.0, 10.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 100.0, 20.0, 30.0, 60.0, 10.0, 30.0, 30.0, 100.0, 30.0, 40.0, 40.0, 0.0, 70.0, 20.0, 130.0, 50.0, 140.0, 40.0, 20.0, 70.0, 170.0, 0.0, 150.0, 0.0, 70.0, 0.0, 10.0, 140.0, 0.0, 10.0, 50.0, 10.0, 70.0, 10.0, 40.0, 130.0, 20.0, 0.0, 30.0, 70.0, 10.0, 120.0, 30.0, 0.0, 30.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 0.0, 190.0, 10.0, 20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0, 70.0, 60.0, 50.0, 70.0, 20.0, 80.0, 140.0, 190.0, 60.0, 30.0, 30.0, 80.0, 110.0, 20.0, 50.0, 60.0, 40.0, 210.0, 50.0, 110.0, 10.0, 40.0, 40.0, 40.0, 60.0, 80.0, 50.0, 50.0, 10.0, 40.0, 20.0, 60.0, 80.0, 40.0, 10.0, 260.0, 240.0, 0.0, 60.0, 15.0, 30.0, 10.0, 20.0, 110.0, 80.0, 60.0, 30.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 100.0, 40.0, 80.0, 40.0, 80.0, 150.0, 10.0, 140.0, 40.0, 50.0, 40.0, 90.0, 60.0, 20.0, 80.0, 10.0, 60.0, 50.0, 80.0, 10.0, 15.0, 20.0, 70.0, 70.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 80.0, 20.0, 20.0, 0.0, 55.0, 90.0, 50.0, 60.0, 30.0, 40.0, 90.0, 90.0, 180.0, 10.0, 50.0, 40.0, 170.0, 120.0, 70.0, 70.0, 30.0, 20.0, 0.0, 10.0, 80.0, 120.0, 130.0, 140.0, 50.0, 40.0, 100.0, 80.0, 40.0, 130.0, 240.0, 20.0, 20.0, 100.0, 40.0, 40.0, 30.0, 100.0, 40.0, 10.0, 130.0, 50.0, 20.0, 50.0, 80.0, 10.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 80.0, 70.0, 10.0, 20.0, 20.0, 80.0, 90.0, 10.0, 40.0, 50.0, 20.0, 40.0, 140.0, 170.0, 140.0, 60.0, 150.0, 30.0, 60.0, 60.0, 80.0, 270.0, 5.0, 35.0, 100.0, 10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0, 30.0, 20.0, 120.0, 40.0, 60.0, 40.0, 20.0, 40.0, 20.0, 20.0, 50.0, 70.0, 100.0, 60.0, 170.0, 160.0, 70.0, 280.0, 20.0, 10.0, 110.0, 40.0, 30.0, 10.0, 65.0, 100.0, 80.0, 50.0, 60.0, 60.0, 35.0, 10.0, 30.0, 35.0, 50.0, 140.0, -30.0, 60.0, 20.0, 110.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 90.0, 190.0, 0.0, 50.0, -5.0, 60.0, 20.0, 180.0, 160.0, 20.0, 20.0, 160.0, 190.0, 50.0, 50.0, -30.0, 40.0, 260.0, 20.0, 30.0, 160.0, 70.0, 20.0, 70.0, 40.0, 20.0, 40.0, 0.0, 20.0, 30.0, 40.0, 10.0, 40.0, 20.0, 140.0, 50.0, 50.0, 120.0, 60.0, 30.0, 30.0, 50.0, 70.0, 10.0, 50.0, 30.0, 30.0, 30.0, 40.0, 270.0, 60.0, 70.0, 80.0, 10.0, 70.0, 50.0, 380.0, 50.0, 160.0, 20.0, 10.0, 70.0, 40.0, 30.0, 20.0, 40.0, 10.0, 70.0, 40.0, 50.0, 120.0, 50.0, 20.0, 80.0, 0.0, 10.0, 30.0, 0.0, 170.0, 30.0, 110.0, 20.0, 90.0, 90.0, 60.0, 120.0, 100.0, 70.0, 330.0, 40.0, 40.0, 170.0, 60.0, 80.0, 70.0, 10.0, -10.0, 0.0, 120.0, 5.0, 70.0, 0.0, 20.0, 70.0, 70.0, 50.0, 70.0, 50.0, 40.0, 140.0, 90.0, 30.0, 20.0, 80.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 30.0, 0.0, 150.0, 40.0, 160.0, 40.0, 140.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 150.0, 20.0, 50.0, 40.0, 10.0, 30.0, 150.0, 30.0, 30.0, -40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 50.0, 80.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 70.0, 10.0, 110.0, 60.0, 20.0, 80.0, 45.0, 90.0, 150.0, 170.0, 0.0, 70.0, 90.0, 40.0, 50.0, 60.0, 30.0, 150.0, 0.0, 320.0, 30.0, 110.0, 30.0, 60.0, 60.0, 30.0, 10.0, 50.0, 30.0, 0.0, 20.0, 10.0, 50.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 80.0, 40.0, 40.0, 10.0, 20.0, 40.0, 20.0, 60.0, 0.0, 110.0, 10.0, 30.0, 10.0, 40.0, 60.0, 40.0, 10.0, 60.0, 40.0, 50.0, 40.0, 0.0, 30.0, 0.0, 30.0, -75.0, 0.0, -50.0, 470.0, 60.0, 40.0, 80.0, 10.0, 60.0, 0.0, 20.0, 15.0, 30.0, 60.0, 40.0, 80.0, 270.0, 20.0, 160.0, 50.0, 90.0, 140.0, 90.0, -25.0, 30.0, 5.0, 190.0, 80.0, 150.0, 160.0, 60.0, 130.0, 10.0, 60.0, 20.0, 50.0, 20.0, 10.0, 100.0, 60.0, 300.0, 40.0, 50.0, 50.0, 70.0, 20.0, -50.0, 210.0, 70.0, 100.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 40.0, -5.0, 30.0, 30.0, 50.0, 30.0, 270.0, 50.0, 60.0, 20.0, 0.0, 40.0, 160.0, 90.0, 30.0, 40.0, 40.0, 0.0, 0.0, 80.0, 100.0, 0.0, 50.0, 10.0, 10.0, 100.0, 10.0, 0.0, 20.0, 60.0, 10.0, 40.0, 20.0, 70.0, 60.0, 240.0, 40.0, 80.0, 90.0, 40.0, 30.0, 90.0, 0.0, 60.0, 50.0, 90.0, 90.0, 10.0, 70.0, 20.0, 95.0, 110.0, 110.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 20.0, 120.0, 80.0, 50.0, 10.0, 20.0, 50.0, 50.0, 10.0, 30.0, 20.0, 20.0, 10.0, 40.0, 90.0, 50.0, 90.0, 50.0, 200.0, 90.0, 0.0, 110.0, 40.0, 0.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 100.0, 150.0, 130.0, 50.0, 70.0, 90.0, 70.0, 200.0, 50.0, 20.0, 100.0, 80.0, 20.0, 30.0, 10.0, 70.0, 40.0, 40.0, 90.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6348466236788395, "mean_inference_ms": 1.3999175638989911, "mean_action_processing_ms": 0.4024920917153743, "mean_env_wait_ms": 1.299262405871412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015488147735595703, "StateBufferConnector_ms": 0.009914398193359375, "ViewRequirementAgentConnector_ms": 0.4192953109741211}, "num_episodes": 23, "episode_return_max": 1070.0, "episode_return_min": 160.0, "episode_return_mean": 541.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.14539253638986, "num_env_steps_trained_throughput_per_sec": 21.14539253638986, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 188136.433, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188136.373, "sample_time_ms": 2699.415, "learn_time_ms": 185416.27, "learn_throughput": 21.573, "synch_weights_time_ms": 12.565}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "33e63_00000", "date": "2024-06-18_22-10-02", "timestamp": 1718763002, "time_this_iter_s": 189.17333889007568, "time_total_s": 3786.0810494422913, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3786.0810494422913, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 28.819850187265917, "ram_util_percent": 79.9749063670412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2744900961780448, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.824144161039521, "policy_loss": -0.01115802051105236, "vf_loss": 5.833595241703038, "vf_explained_var": 0.001980720084315291, "kl": 0.008534667572749054, "entropy": 1.1056941672826346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 1070.0, "episode_reward_min": 95.0, "episode_reward_mean": 550.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 55.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 170.0, 290.0, 640.0, 320.0, 360.0, 710.0, 370.0, 530.0, 630.0, 520.0, 450.0, 350.0, 620.0, 530.0, 480.0, 430.0, 310.0, 930.0, 770.0, 760.0, 420.0, 785.0, 440.0, 410.0, 680.0, 405.0, 340.0, 455.0, 830.0, 690.0, 740.0, 560.0, 290.0, 780.0, 850.0, 425.0, 410.0, 990.0, 605.0, 460.0, 530.0, 855.0, 690.0, 260.0, 610.0, 670.0, 880.0, 500.0, 550.0, 1070.0, 355.0, 640.0, 540.0, 410.0, 470.0, 490.0, 530.0, 765.0, 820.0, 270.0, 280.0, 380.0, 300.0, 595.0, 745.0, 910.0, 520.0, 860.0, 275.0, 770.0, 350.0, 340.0, 730.0, 675.0, 290.0, 440.0, 660.0, 230.0, 930.0, 510.0, 480.0, 390.0, 95.0, 470.0, 910.0, 640.0, 460.0, 495.0, 440.0, 580.0, 330.0, 950.0, 230.0, 740.0, 555.0, 685.0, 830.0, 680.0, 305.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 50.0, 20.0, 30.0, 30.0, 50.0, 20.0, 50.0, 20.0, 60.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 50.0, 0.0, 20.0, 30.0, 20.0, 90.0, 0.0, 10.0, 160.0, 50.0, 70.0, 180.0, 30.0, 20.0, 30.0, 10.0, 10.0, 40.0, 130.0, 20.0, 10.0, 20.0, 30.0, 60.0, 10.0, 10.0, 50.0, 100.0, 40.0, 30.0, 30.0, 0.0, 30.0, 140.0, 40.0, 100.0, 30.0, 20.0, 30.0, 50.0, 30.0, 110.0, 160.0, 50.0, 60.0, 20.0, 10.0, 0.0, 40.0, 90.0, 20.0, 30.0, 50.0, 20.0, 40.0, 40.0, 20.0, 90.0, 70.0, 30.0, 100.0, 50.0, 70.0, 60.0, 100.0, 40.0, 60.0, 40.0, 70.0, 80.0, 20.0, 80.0, 80.0, 40.0, 30.0, 30.0, 90.0, 10.0, 10.0, 80.0, 30.0, 160.0, 40.0, 70.0, 40.0, 150.0, 10.0, 50.0, 30.0, 10.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 100.0, 20.0, 30.0, 60.0, 10.0, 30.0, 30.0, 100.0, 30.0, 40.0, 40.0, 0.0, 70.0, 20.0, 130.0, 50.0, 140.0, 40.0, 20.0, 70.0, 170.0, 0.0, 150.0, 0.0, 70.0, 0.0, 10.0, 140.0, 0.0, 10.0, 50.0, 10.0, 70.0, 10.0, 40.0, 130.0, 20.0, 0.0, 30.0, 70.0, 10.0, 120.0, 30.0, 0.0, 30.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 70.0, 0.0, 190.0, 10.0, 20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0, 70.0, 60.0, 50.0, 70.0, 20.0, 80.0, 140.0, 190.0, 60.0, 30.0, 30.0, 80.0, 110.0, 20.0, 50.0, 60.0, 40.0, 210.0, 50.0, 110.0, 10.0, 40.0, 40.0, 40.0, 60.0, 80.0, 50.0, 50.0, 10.0, 40.0, 20.0, 60.0, 80.0, 40.0, 10.0, 260.0, 240.0, 0.0, 60.0, 15.0, 30.0, 10.0, 20.0, 110.0, 80.0, 60.0, 30.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 100.0, 40.0, 80.0, 40.0, 80.0, 150.0, 10.0, 140.0, 40.0, 50.0, 40.0, 90.0, 60.0, 20.0, 80.0, 10.0, 60.0, 50.0, 80.0, 10.0, 15.0, 20.0, 70.0, 70.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 80.0, 20.0, 20.0, 0.0, 55.0, 90.0, 50.0, 60.0, 30.0, 40.0, 90.0, 90.0, 180.0, 10.0, 50.0, 40.0, 170.0, 120.0, 70.0, 70.0, 30.0, 20.0, 0.0, 10.0, 80.0, 120.0, 130.0, 140.0, 50.0, 40.0, 100.0, 80.0, 40.0, 130.0, 240.0, 20.0, 20.0, 100.0, 40.0, 40.0, 30.0, 100.0, 40.0, 10.0, 130.0, 50.0, 20.0, 50.0, 80.0, 10.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 80.0, 70.0, 10.0, 20.0, 20.0, 80.0, 90.0, 10.0, 40.0, 50.0, 20.0, 40.0, 140.0, 170.0, 140.0, 60.0, 150.0, 30.0, 60.0, 60.0, 80.0, 270.0, 5.0, 35.0, 100.0, 10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0, 30.0, 20.0, 120.0, 40.0, 60.0, 40.0, 20.0, 40.0, 20.0, 20.0, 50.0, 70.0, 100.0, 60.0, 170.0, 160.0, 70.0, 280.0, 20.0, 10.0, 110.0, 40.0, 30.0, 10.0, 65.0, 100.0, 80.0, 50.0, 60.0, 60.0, 35.0, 10.0, 30.0, 35.0, 50.0, 140.0, -30.0, 60.0, 20.0, 110.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 90.0, 190.0, 0.0, 50.0, -5.0, 60.0, 20.0, 180.0, 160.0, 20.0, 20.0, 160.0, 190.0, 50.0, 50.0, -30.0, 40.0, 260.0, 20.0, 30.0, 160.0, 70.0, 20.0, 70.0, 40.0, 20.0, 40.0, 0.0, 20.0, 30.0, 40.0, 10.0, 40.0, 20.0, 140.0, 50.0, 50.0, 120.0, 60.0, 30.0, 30.0, 50.0, 70.0, 10.0, 50.0, 30.0, 30.0, 30.0, 40.0, 270.0, 60.0, 70.0, 80.0, 10.0, 70.0, 50.0, 380.0, 50.0, 160.0, 20.0, 10.0, 70.0, 40.0, 30.0, 20.0, 40.0, 10.0, 70.0, 40.0, 50.0, 120.0, 50.0, 20.0, 80.0, 0.0, 10.0, 30.0, 0.0, 170.0, 30.0, 110.0, 20.0, 90.0, 90.0, 60.0, 120.0, 100.0, 70.0, 330.0, 40.0, 40.0, 170.0, 60.0, 80.0, 70.0, 10.0, -10.0, 0.0, 120.0, 5.0, 70.0, 0.0, 20.0, 70.0, 70.0, 50.0, 70.0, 50.0, 40.0, 140.0, 90.0, 30.0, 20.0, 80.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 30.0, 0.0, 150.0, 40.0, 160.0, 40.0, 140.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 150.0, 20.0, 50.0, 40.0, 10.0, 30.0, 150.0, 30.0, 30.0, -40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 50.0, 80.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 70.0, 10.0, 110.0, 60.0, 20.0, 80.0, 45.0, 90.0, 150.0, 170.0, 0.0, 70.0, 90.0, 40.0, 50.0, 60.0, 30.0, 150.0, 0.0, 320.0, 30.0, 110.0, 30.0, 60.0, 60.0, 30.0, 10.0, 50.0, 30.0, 0.0, 20.0, 10.0, 50.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 80.0, 40.0, 40.0, 10.0, 20.0, 40.0, 20.0, 60.0, 0.0, 110.0, 10.0, 30.0, 10.0, 40.0, 60.0, 40.0, 10.0, 60.0, 40.0, 50.0, 40.0, 0.0, 30.0, 0.0, 30.0, -75.0, 0.0, -50.0, 470.0, 60.0, 40.0, 80.0, 10.0, 60.0, 0.0, 20.0, 15.0, 30.0, 60.0, 40.0, 80.0, 270.0, 20.0, 160.0, 50.0, 90.0, 140.0, 90.0, -25.0, 30.0, 5.0, 190.0, 80.0, 150.0, 160.0, 60.0, 130.0, 10.0, 60.0, 20.0, 50.0, 20.0, 10.0, 100.0, 60.0, 300.0, 40.0, 50.0, 50.0, 70.0, 20.0, -50.0, 210.0, 70.0, 100.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 40.0, -5.0, 30.0, 30.0, 50.0, 30.0, 270.0, 50.0, 60.0, 20.0, 0.0, 40.0, 160.0, 90.0, 30.0, 40.0, 40.0, 0.0, 0.0, 80.0, 100.0, 0.0, 50.0, 10.0, 10.0, 100.0, 10.0, 0.0, 20.0, 60.0, 10.0, 40.0, 20.0, 70.0, 60.0, 240.0, 40.0, 80.0, 90.0, 40.0, 30.0, 90.0, 0.0, 60.0, 50.0, 90.0, 90.0, 10.0, 70.0, 20.0, 95.0, 110.0, 110.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 20.0, 120.0, 80.0, 50.0, 10.0, 20.0, 50.0, 50.0, 10.0, 30.0, 20.0, 20.0, 10.0, 40.0, 90.0, 50.0, 90.0, 50.0, 200.0, 90.0, 0.0, 110.0, 40.0, 0.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 100.0, 150.0, 130.0, 50.0, 70.0, 90.0, 70.0, 200.0, 50.0, 20.0, 100.0, 80.0, 20.0, 30.0, 10.0, 70.0, 40.0, 40.0, 90.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0, 0.0, 40.0, 20.0, 230.0, -10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 10.0, 30.0, 0.0, 10.0, 70.0, 10.0, 0.0, 0.0, -45.0, 10.0, 40.0, 50.0, 10.0, 40.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 170.0, 30.0, 280.0, 80.0, 30.0, 50.0, 70.0, 160.0, 20.0, 20.0, 250.0, -30.0, 0.0, 60.0, 20.0, 80.0, 80.0, 70.0, 50.0, 60.0, 80.0, 70.0, 30.0, 50.0, 60.0, 30.0, 60.0, 0.0, 20.0, 60.0, 60.0, -10.0, 20.0, 40.0, 50.0, 190.0, 40.0, 110.0, 0.0, -5.0, 30.0, 40.0, 190.0, 20.0, 10.0, 20.0, -10.0, 50.0, 50.0, 40.0, 60.0, 90.0, 160.0, 40.0, 70.0, 30.0, 20.0, 45.0, 35.0, 30.0, 20.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 10.0, 130.0, 80.0, 80.0, 40.0, 180.0, 70.0, 310.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, 40.0, 180.0, 50.0, 180.0, 50.0, 50.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 170.0, 120.0, 110.0, -10.0, 80.0, -55.0, 20.0, 70.0, 10.0, 170.0, 120.0, -80.0, 0.0, 110.0, 30.0, 90.0, 50.0, 35.0, 160.0, 70.0, 100.0, 140.0, 200.0, 30.0, 80.0, 60.0, 50.0, 20.0, 80.0, 70.0, 200.0, 30.0, 80.0, 30.0, 80.0, 20.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6342804002061064, "mean_inference_ms": 1.4035605973817986, "mean_action_processing_ms": 0.4021611023650706, "mean_env_wait_ms": 1.2985519553791947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015669822692871094, "StateBufferConnector_ms": 0.01004171371459961, "ViewRequirementAgentConnector_ms": 0.4205329418182373}, "num_episodes": 18, "episode_return_max": 1070.0, "episode_return_min": 95.0, "episode_return_mean": 550.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.27500429289364, "num_env_steps_trained_throughput_per_sec": 21.27500429289364, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 188334.41, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188334.351, "sample_time_ms": 2694.395, "learn_time_ms": 185619.519, "learn_throughput": 21.549, "synch_weights_time_ms": 12.642}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "33e63_00000", "date": "2024-06-18_22-13-10", "timestamp": 1718763190, "time_this_iter_s": 188.05679488182068, "time_total_s": 3974.137844324112, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3974.137844324112, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 28.525563909774437, "ram_util_percent": 78.86428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8347477491734763, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.071638855157188, "policy_loss": -0.010341707937006816, "vf_loss": 6.080401977766563, "vf_explained_var": 0.0010671100106102208, "kl": 0.007892918979166778, "entropy": 1.0749206931255877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 1120.0, "episode_reward_min": 95.0, "episode_reward_mean": 582.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 58.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [930.0, 770.0, 760.0, 420.0, 785.0, 440.0, 410.0, 680.0, 405.0, 340.0, 455.0, 830.0, 690.0, 740.0, 560.0, 290.0, 780.0, 850.0, 425.0, 410.0, 990.0, 605.0, 460.0, 530.0, 855.0, 690.0, 260.0, 610.0, 670.0, 880.0, 500.0, 550.0, 1070.0, 355.0, 640.0, 540.0, 410.0, 470.0, 490.0, 530.0, 765.0, 820.0, 270.0, 280.0, 380.0, 300.0, 595.0, 745.0, 910.0, 520.0, 860.0, 275.0, 770.0, 350.0, 340.0, 730.0, 675.0, 290.0, 440.0, 660.0, 230.0, 930.0, 510.0, 480.0, 390.0, 95.0, 470.0, 910.0, 640.0, 460.0, 495.0, 440.0, 580.0, 330.0, 950.0, 230.0, 740.0, 555.0, 685.0, 830.0, 680.0, 305.0, 480.0, 390.0, 450.0, 480.0, 910.0, 560.0, 785.0, 225.0, 625.0, 630.0, 1120.0, 600.0, 320.0, 1000.0, 640.0, 450.0, 1050.0, 580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 30.0, -40.0, 40.0, 460.0, 50.0, 260.0, 30.0, 80.0, 70.0, 60.0, 50.0, 70.0, 20.0, 80.0, 140.0, 190.0, 60.0, 30.0, 30.0, 80.0, 110.0, 20.0, 50.0, 60.0, 40.0, 210.0, 50.0, 110.0, 10.0, 40.0, 40.0, 40.0, 60.0, 80.0, 50.0, 50.0, 10.0, 40.0, 20.0, 60.0, 80.0, 40.0, 10.0, 260.0, 240.0, 0.0, 60.0, 15.0, 30.0, 10.0, 20.0, 110.0, 80.0, 60.0, 30.0, 70.0, 10.0, 20.0, 10.0, 20.0, 10.0, 0.0, 30.0, 100.0, 40.0, 80.0, 40.0, 80.0, 150.0, 10.0, 140.0, 40.0, 50.0, 40.0, 90.0, 60.0, 20.0, 80.0, 10.0, 60.0, 50.0, 80.0, 10.0, 15.0, 20.0, 70.0, 70.0, 20.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 80.0, 20.0, 20.0, 0.0, 55.0, 90.0, 50.0, 60.0, 30.0, 40.0, 90.0, 90.0, 180.0, 10.0, 50.0, 40.0, 170.0, 120.0, 70.0, 70.0, 30.0, 20.0, 0.0, 10.0, 80.0, 120.0, 130.0, 140.0, 50.0, 40.0, 100.0, 80.0, 40.0, 130.0, 240.0, 20.0, 20.0, 100.0, 40.0, 40.0, 30.0, 100.0, 40.0, 10.0, 130.0, 50.0, 20.0, 50.0, 80.0, 10.0, 70.0, 30.0, 10.0, 30.0, 10.0, 10.0, 80.0, 70.0, 10.0, 20.0, 20.0, 80.0, 90.0, 10.0, 40.0, 50.0, 20.0, 40.0, 140.0, 170.0, 140.0, 60.0, 150.0, 30.0, 60.0, 60.0, 80.0, 270.0, 5.0, 35.0, 100.0, 10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0, 30.0, 20.0, 120.0, 40.0, 60.0, 40.0, 20.0, 40.0, 20.0, 20.0, 50.0, 70.0, 100.0, 60.0, 170.0, 160.0, 70.0, 280.0, 20.0, 10.0, 110.0, 40.0, 30.0, 10.0, 65.0, 100.0, 80.0, 50.0, 60.0, 60.0, 35.0, 10.0, 30.0, 35.0, 50.0, 140.0, -30.0, 60.0, 20.0, 110.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 90.0, 190.0, 0.0, 50.0, -5.0, 60.0, 20.0, 180.0, 160.0, 20.0, 20.0, 160.0, 190.0, 50.0, 50.0, -30.0, 40.0, 260.0, 20.0, 30.0, 160.0, 70.0, 20.0, 70.0, 40.0, 20.0, 40.0, 0.0, 20.0, 30.0, 40.0, 10.0, 40.0, 20.0, 140.0, 50.0, 50.0, 120.0, 60.0, 30.0, 30.0, 50.0, 70.0, 10.0, 50.0, 30.0, 30.0, 30.0, 40.0, 270.0, 60.0, 70.0, 80.0, 10.0, 70.0, 50.0, 380.0, 50.0, 160.0, 20.0, 10.0, 70.0, 40.0, 30.0, 20.0, 40.0, 10.0, 70.0, 40.0, 50.0, 120.0, 50.0, 20.0, 80.0, 0.0, 10.0, 30.0, 0.0, 170.0, 30.0, 110.0, 20.0, 90.0, 90.0, 60.0, 120.0, 100.0, 70.0, 330.0, 40.0, 40.0, 170.0, 60.0, 80.0, 70.0, 10.0, -10.0, 0.0, 120.0, 5.0, 70.0, 0.0, 20.0, 70.0, 70.0, 50.0, 70.0, 50.0, 40.0, 140.0, 90.0, 30.0, 20.0, 80.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 30.0, 0.0, 150.0, 40.0, 160.0, 40.0, 140.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 150.0, 20.0, 50.0, 40.0, 10.0, 30.0, 150.0, 30.0, 30.0, -40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 50.0, 80.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 70.0, 10.0, 110.0, 60.0, 20.0, 80.0, 45.0, 90.0, 150.0, 170.0, 0.0, 70.0, 90.0, 40.0, 50.0, 60.0, 30.0, 150.0, 0.0, 320.0, 30.0, 110.0, 30.0, 60.0, 60.0, 30.0, 10.0, 50.0, 30.0, 0.0, 20.0, 10.0, 50.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 80.0, 40.0, 40.0, 10.0, 20.0, 40.0, 20.0, 60.0, 0.0, 110.0, 10.0, 30.0, 10.0, 40.0, 60.0, 40.0, 10.0, 60.0, 40.0, 50.0, 40.0, 0.0, 30.0, 0.0, 30.0, -75.0, 0.0, -50.0, 470.0, 60.0, 40.0, 80.0, 10.0, 60.0, 0.0, 20.0, 15.0, 30.0, 60.0, 40.0, 80.0, 270.0, 20.0, 160.0, 50.0, 90.0, 140.0, 90.0, -25.0, 30.0, 5.0, 190.0, 80.0, 150.0, 160.0, 60.0, 130.0, 10.0, 60.0, 20.0, 50.0, 20.0, 10.0, 100.0, 60.0, 300.0, 40.0, 50.0, 50.0, 70.0, 20.0, -50.0, 210.0, 70.0, 100.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 40.0, -5.0, 30.0, 30.0, 50.0, 30.0, 270.0, 50.0, 60.0, 20.0, 0.0, 40.0, 160.0, 90.0, 30.0, 40.0, 40.0, 0.0, 0.0, 80.0, 100.0, 0.0, 50.0, 10.0, 10.0, 100.0, 10.0, 0.0, 20.0, 60.0, 10.0, 40.0, 20.0, 70.0, 60.0, 240.0, 40.0, 80.0, 90.0, 40.0, 30.0, 90.0, 0.0, 60.0, 50.0, 90.0, 90.0, 10.0, 70.0, 20.0, 95.0, 110.0, 110.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 20.0, 120.0, 80.0, 50.0, 10.0, 20.0, 50.0, 50.0, 10.0, 30.0, 20.0, 20.0, 10.0, 40.0, 90.0, 50.0, 90.0, 50.0, 200.0, 90.0, 0.0, 110.0, 40.0, 0.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 100.0, 150.0, 130.0, 50.0, 70.0, 90.0, 70.0, 200.0, 50.0, 20.0, 100.0, 80.0, 20.0, 30.0, 10.0, 70.0, 40.0, 40.0, 90.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0, 0.0, 40.0, 20.0, 230.0, -10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 10.0, 30.0, 0.0, 10.0, 70.0, 10.0, 0.0, 0.0, -45.0, 10.0, 40.0, 50.0, 10.0, 40.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 170.0, 30.0, 280.0, 80.0, 30.0, 50.0, 70.0, 160.0, 20.0, 20.0, 250.0, -30.0, 0.0, 60.0, 20.0, 80.0, 80.0, 70.0, 50.0, 60.0, 80.0, 70.0, 30.0, 50.0, 60.0, 30.0, 60.0, 0.0, 20.0, 60.0, 60.0, -10.0, 20.0, 40.0, 50.0, 190.0, 40.0, 110.0, 0.0, -5.0, 30.0, 40.0, 190.0, 20.0, 10.0, 20.0, -10.0, 50.0, 50.0, 40.0, 60.0, 90.0, 160.0, 40.0, 70.0, 30.0, 20.0, 45.0, 35.0, 30.0, 20.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 10.0, 130.0, 80.0, 80.0, 40.0, 180.0, 70.0, 310.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, 40.0, 180.0, 50.0, 180.0, 50.0, 50.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 170.0, 120.0, 110.0, -10.0, 80.0, -55.0, 20.0, 70.0, 10.0, 170.0, 120.0, -80.0, 0.0, 110.0, 30.0, 90.0, 50.0, 35.0, 160.0, 70.0, 100.0, 140.0, 200.0, 30.0, 80.0, 60.0, 50.0, 20.0, 80.0, 70.0, 200.0, 30.0, 80.0, 30.0, 80.0, 20.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 40.0, 80.0, 70.0, 60.0, 20.0, 20.0, 20.0, 70.0, 70.0, 70.0, 60.0, 30.0, 30.0, 30.0, 0.0, 10.0, 10.0, 60.0, 30.0, 30.0, 20.0, 30.0, -10.0, 40.0, 160.0, 80.0, 100.0, 40.0, 160.0, 40.0, 40.0, 0.0, 10.0, 70.0, 10.0, 10.0, 290.0, 140.0, -30.0, 50.0, 170.0, 60.0, 50.0, 10.0, 70.0, 100.0, 90.0, 50.0, 90.0, 20.0, 30.0, 40.0, 50.0, 30.0, 90.0, 70.0, 70.0, 60.0, 70.0, 70.0, 170.0, 70.0, 50.0, 35.0, 230.0, -40.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 35.0, 10.0, 20.0, 20.0, 70.0, 110.0, 50.0, 80.0, 40.0, 50.0, 85.0, 80.0, 0.0, 60.0, 190.0, 40.0, 20.0, 40.0, -20.0, 120.0, 80.0, 70.0, 50.0, 40.0, 100.0, 30.0, 100.0, 170.0, 80.0, 100.0, 290.0, 150.0, 30.0, 70.0, 40.0, 60.0, 50.0, 30.0, 150.0, 30.0, 100.0, 90.0, 30.0, 20.0, 30.0, 80.0, 10.0, 30.0, 50.0, 20.0, 10.0, 20.0, 10.0, 60.0, 170.0, 300.0, 50.0, -50.0, 130.0, 60.0, 70.0, 140.0, 60.0, 70.0, 20.0, 20.0, 10.0, 90.0, 40.0, 40.0, 110.0, 110.0, 90.0, 110.0, 150.0, 110.0, 30.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 40.0, 60.0, 10.0, 360.0, 110.0, 10.0, 140.0, 60.0, -10.0, 210.0, 100.0, 30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.631524101579212, "mean_inference_ms": 1.4070990972600004, "mean_action_processing_ms": 0.4018456232250769, "mean_env_wait_ms": 1.298136381294914, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015564441680908203, "StateBufferConnector_ms": 0.010110616683959961, "ViewRequirementAgentConnector_ms": 0.4239695072174072}, "num_episodes": 18, "episode_return_max": 1120.0, "episode_return_min": 95.0, "episode_return_mean": 582.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.994098155346414, "num_env_steps_trained_throughput_per_sec": 20.994098155346414, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 188649.973, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188649.914, "sample_time_ms": 2680.556, "learn_time_ms": 185948.998, "learn_throughput": 21.511, "synch_weights_time_ms": 12.525}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "33e63_00000", "date": "2024-06-18_22-16-21", "timestamp": 1718763381, "time_this_iter_s": 190.53806114196777, "time_total_s": 4164.67590546608, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4164.67590546608, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 25.408518518518516, "ram_util_percent": 80.47074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7526245467579022, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.974523708893976, "policy_loss": -0.012398017402349042, "vf_loss": 5.985174843500724, "vf_explained_var": 0.000586332356967865, "kl": 0.008734411697225422, "entropy": 1.0630325386128106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 1120.0, "episode_reward_min": 95.0, "episode_reward_mean": 580.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 470.0}, "policy_reward_mean": {"policy_0": 58.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [425.0, 410.0, 990.0, 605.0, 460.0, 530.0, 855.0, 690.0, 260.0, 610.0, 670.0, 880.0, 500.0, 550.0, 1070.0, 355.0, 640.0, 540.0, 410.0, 470.0, 490.0, 530.0, 765.0, 820.0, 270.0, 280.0, 380.0, 300.0, 595.0, 745.0, 910.0, 520.0, 860.0, 275.0, 770.0, 350.0, 340.0, 730.0, 675.0, 290.0, 440.0, 660.0, 230.0, 930.0, 510.0, 480.0, 390.0, 95.0, 470.0, 910.0, 640.0, 460.0, 495.0, 440.0, 580.0, 330.0, 950.0, 230.0, 740.0, 555.0, 685.0, 830.0, 680.0, 305.0, 480.0, 390.0, 450.0, 480.0, 910.0, 560.0, 785.0, 225.0, 625.0, 630.0, 1120.0, 600.0, 320.0, 1000.0, 640.0, 450.0, 1050.0, 580.0, 430.0, 750.0, 540.0, 330.0, 570.0, 1100.0, 420.0, 570.0, 580.0, 630.0, 720.0, 370.0, 465.0, 460.0, 550.0, 1070.0, 430.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 0.0, 150.0, 170.0, 40.0, -40.0, 0.0, 5.0, 60.0, 30.0, 20.0, 120.0, 40.0, 60.0, 40.0, 20.0, 40.0, 20.0, 20.0, 50.0, 70.0, 100.0, 60.0, 170.0, 160.0, 70.0, 280.0, 20.0, 10.0, 110.0, 40.0, 30.0, 10.0, 65.0, 100.0, 80.0, 50.0, 60.0, 60.0, 35.0, 10.0, 30.0, 35.0, 50.0, 140.0, -30.0, 60.0, 20.0, 110.0, 10.0, 20.0, 90.0, 10.0, 20.0, 50.0, 90.0, 190.0, 0.0, 50.0, -5.0, 60.0, 20.0, 180.0, 160.0, 20.0, 20.0, 160.0, 190.0, 50.0, 50.0, -30.0, 40.0, 260.0, 20.0, 30.0, 160.0, 70.0, 20.0, 70.0, 40.0, 20.0, 40.0, 0.0, 20.0, 30.0, 40.0, 10.0, 40.0, 20.0, 140.0, 50.0, 50.0, 120.0, 60.0, 30.0, 30.0, 50.0, 70.0, 10.0, 50.0, 30.0, 30.0, 30.0, 40.0, 270.0, 60.0, 70.0, 80.0, 10.0, 70.0, 50.0, 380.0, 50.0, 160.0, 20.0, 10.0, 70.0, 40.0, 30.0, 20.0, 40.0, 10.0, 70.0, 40.0, 50.0, 120.0, 50.0, 20.0, 80.0, 0.0, 10.0, 30.0, 0.0, 170.0, 30.0, 110.0, 20.0, 90.0, 90.0, 60.0, 120.0, 100.0, 70.0, 330.0, 40.0, 40.0, 170.0, 60.0, 80.0, 70.0, 10.0, -10.0, 0.0, 120.0, 5.0, 70.0, 0.0, 20.0, 70.0, 70.0, 50.0, 70.0, 50.0, 40.0, 140.0, 90.0, 30.0, 20.0, 80.0, 60.0, 0.0, 0.0, 160.0, 20.0, 80.0, 30.0, 0.0, 150.0, 40.0, 160.0, 40.0, 140.0, 10.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 150.0, 20.0, 50.0, 40.0, 10.0, 30.0, 150.0, 30.0, 30.0, -40.0, 30.0, 60.0, 60.0, 70.0, 40.0, 30.0, 50.0, 80.0, 40.0, 30.0, 30.0, 20.0, 100.0, 30.0, 70.0, 10.0, 110.0, 60.0, 20.0, 80.0, 45.0, 90.0, 150.0, 170.0, 0.0, 70.0, 90.0, 40.0, 50.0, 60.0, 30.0, 150.0, 0.0, 320.0, 30.0, 110.0, 30.0, 60.0, 60.0, 30.0, 10.0, 50.0, 30.0, 0.0, 20.0, 10.0, 50.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 80.0, 40.0, 40.0, 10.0, 20.0, 40.0, 20.0, 60.0, 0.0, 110.0, 10.0, 30.0, 10.0, 40.0, 60.0, 40.0, 10.0, 60.0, 40.0, 50.0, 40.0, 0.0, 30.0, 0.0, 30.0, -75.0, 0.0, -50.0, 470.0, 60.0, 40.0, 80.0, 10.0, 60.0, 0.0, 20.0, 15.0, 30.0, 60.0, 40.0, 80.0, 270.0, 20.0, 160.0, 50.0, 90.0, 140.0, 90.0, -25.0, 30.0, 5.0, 190.0, 80.0, 150.0, 160.0, 60.0, 130.0, 10.0, 60.0, 20.0, 50.0, 20.0, 10.0, 100.0, 60.0, 300.0, 40.0, 50.0, 50.0, 70.0, 20.0, -50.0, 210.0, 70.0, 100.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 40.0, -5.0, 30.0, 30.0, 50.0, 30.0, 270.0, 50.0, 60.0, 20.0, 0.0, 40.0, 160.0, 90.0, 30.0, 40.0, 40.0, 0.0, 0.0, 80.0, 100.0, 0.0, 50.0, 10.0, 10.0, 100.0, 10.0, 0.0, 20.0, 60.0, 10.0, 40.0, 20.0, 70.0, 60.0, 240.0, 40.0, 80.0, 90.0, 40.0, 30.0, 90.0, 0.0, 60.0, 50.0, 90.0, 90.0, 10.0, 70.0, 20.0, 95.0, 110.0, 110.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 20.0, 120.0, 80.0, 50.0, 10.0, 20.0, 50.0, 50.0, 10.0, 30.0, 20.0, 20.0, 10.0, 40.0, 90.0, 50.0, 90.0, 50.0, 200.0, 90.0, 0.0, 110.0, 40.0, 0.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 100.0, 150.0, 130.0, 50.0, 70.0, 90.0, 70.0, 200.0, 50.0, 20.0, 100.0, 80.0, 20.0, 30.0, 10.0, 70.0, 40.0, 40.0, 90.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0, 0.0, 40.0, 20.0, 230.0, -10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 10.0, 30.0, 0.0, 10.0, 70.0, 10.0, 0.0, 0.0, -45.0, 10.0, 40.0, 50.0, 10.0, 40.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 170.0, 30.0, 280.0, 80.0, 30.0, 50.0, 70.0, 160.0, 20.0, 20.0, 250.0, -30.0, 0.0, 60.0, 20.0, 80.0, 80.0, 70.0, 50.0, 60.0, 80.0, 70.0, 30.0, 50.0, 60.0, 30.0, 60.0, 0.0, 20.0, 60.0, 60.0, -10.0, 20.0, 40.0, 50.0, 190.0, 40.0, 110.0, 0.0, -5.0, 30.0, 40.0, 190.0, 20.0, 10.0, 20.0, -10.0, 50.0, 50.0, 40.0, 60.0, 90.0, 160.0, 40.0, 70.0, 30.0, 20.0, 45.0, 35.0, 30.0, 20.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 10.0, 130.0, 80.0, 80.0, 40.0, 180.0, 70.0, 310.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, 40.0, 180.0, 50.0, 180.0, 50.0, 50.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 170.0, 120.0, 110.0, -10.0, 80.0, -55.0, 20.0, 70.0, 10.0, 170.0, 120.0, -80.0, 0.0, 110.0, 30.0, 90.0, 50.0, 35.0, 160.0, 70.0, 100.0, 140.0, 200.0, 30.0, 80.0, 60.0, 50.0, 20.0, 80.0, 70.0, 200.0, 30.0, 80.0, 30.0, 80.0, 20.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 40.0, 80.0, 70.0, 60.0, 20.0, 20.0, 20.0, 70.0, 70.0, 70.0, 60.0, 30.0, 30.0, 30.0, 0.0, 10.0, 10.0, 60.0, 30.0, 30.0, 20.0, 30.0, -10.0, 40.0, 160.0, 80.0, 100.0, 40.0, 160.0, 40.0, 40.0, 0.0, 10.0, 70.0, 10.0, 10.0, 290.0, 140.0, -30.0, 50.0, 170.0, 60.0, 50.0, 10.0, 70.0, 100.0, 90.0, 50.0, 90.0, 20.0, 30.0, 40.0, 50.0, 30.0, 90.0, 70.0, 70.0, 60.0, 70.0, 70.0, 170.0, 70.0, 50.0, 35.0, 230.0, -40.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 35.0, 10.0, 20.0, 20.0, 70.0, 110.0, 50.0, 80.0, 40.0, 50.0, 85.0, 80.0, 0.0, 60.0, 190.0, 40.0, 20.0, 40.0, -20.0, 120.0, 80.0, 70.0, 50.0, 40.0, 100.0, 30.0, 100.0, 170.0, 80.0, 100.0, 290.0, 150.0, 30.0, 70.0, 40.0, 60.0, 50.0, 30.0, 150.0, 30.0, 100.0, 90.0, 30.0, 20.0, 30.0, 80.0, 10.0, 30.0, 50.0, 20.0, 10.0, 20.0, 10.0, 60.0, 170.0, 300.0, 50.0, -50.0, 130.0, 60.0, 70.0, 140.0, 60.0, 70.0, 20.0, 20.0, 10.0, 90.0, 40.0, 40.0, 110.0, 110.0, 90.0, 110.0, 150.0, 110.0, 30.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 40.0, 60.0, 10.0, 360.0, 110.0, 10.0, 140.0, 60.0, -10.0, 210.0, 100.0, 30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0, 30.0, 30.0, 10.0, 40.0, 70.0, 90.0, 10.0, 30.0, 80.0, 40.0, 20.0, 10.0, 50.0, 180.0, 10.0, 200.0, 110.0, 110.0, 60.0, 0.0, 90.0, 20.0, 0.0, 0.0, 180.0, 30.0, 30.0, 100.0, 70.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 150.0, 20.0, 20.0, 30.0, 120.0, 50.0, 150.0, 0.0, 30.0, 60.0, 60.0, 50.0, 20.0, 80.0, 30.0, 170.0, 50.0, 60.0, 10.0, 410.0, 160.0, 100.0, 30.0, 110.0, 150.0, 50.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 190.0, 20.0, 50.0, 10.0, 110.0, 240.0, 30.0, 60.0, 70.0, 80.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 50.0, 100.0, 190.0, 30.0, 60.0, 0.0, 40.0, 30.0, 130.0, 150.0, 90.0, 100.0, 40.0, 100.0, 70.0, 0.0, 30.0, 70.0, 70.0, 40.0, 20.0, 40.0, 40.0, 0.0, 70.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 20.0, 15.0, 60.0, 70.0, 30.0, 0.0, 150.0, 80.0, 40.0, 0.0, 100.0, 80.0, 50.0, 90.0, 50.0, 30.0, 10.0, 10.0, 60.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 30.0, 170.0, 110.0, 70.0, 50.0, 40.0, 320.0, 160.0, 160.0, 70.0, 30.0, 160.0, 10.0, 70.0, 70.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 20.0, 10.0, 70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.62390675997755, "mean_inference_ms": 1.4066642077698186, "mean_action_processing_ms": 0.4009984272595075, "mean_env_wait_ms": 1.2951229146919707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015379905700683594, "StateBufferConnector_ms": 0.010109663009643555, "ViewRequirementAgentConnector_ms": 0.405444860458374}, "num_episodes": 18, "episode_return_max": 1120.0, "episode_return_min": 95.0, "episode_return_mean": 580.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.269084461499723, "num_env_steps_trained_throughput_per_sec": 21.269084461499723, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 188694.382, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188694.324, "sample_time_ms": 2655.37, "learn_time_ms": 186018.759, "learn_throughput": 21.503, "synch_weights_time_ms": 12.226}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "33e63_00000", "date": "2024-06-18_22-19-29", "timestamp": 1718763569, "time_this_iter_s": 188.0720090866089, "time_total_s": 4352.747914552689, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272994c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4352.747914552689, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 25.39661654135338, "ram_util_percent": 79.59774436090225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1222102444964097, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.950069626959495, "policy_loss": -0.010445831870611587, "vf_loss": 5.958911910783241, "vf_explained_var": 0.000847686955723138, "kl": 0.008017799044947767, "entropy": 1.027881433223637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1160.0, "episode_reward_min": 95.0, "episode_reward_mean": 593.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 59.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 595.0, 745.0, 910.0, 520.0, 860.0, 275.0, 770.0, 350.0, 340.0, 730.0, 675.0, 290.0, 440.0, 660.0, 230.0, 930.0, 510.0, 480.0, 390.0, 95.0, 470.0, 910.0, 640.0, 460.0, 495.0, 440.0, 580.0, 330.0, 950.0, 230.0, 740.0, 555.0, 685.0, 830.0, 680.0, 305.0, 480.0, 390.0, 450.0, 480.0, 910.0, 560.0, 785.0, 225.0, 625.0, 630.0, 1120.0, 600.0, 320.0, 1000.0, 640.0, 450.0, 1050.0, 580.0, 430.0, 750.0, 540.0, 330.0, 570.0, 1100.0, 420.0, 570.0, 580.0, 630.0, 720.0, 370.0, 465.0, 460.0, 550.0, 1070.0, 430.0, 880.0, 520.0, 585.0, 225.0, 470.0, 450.0, 470.0, 610.0, 680.0, 490.0, 890.0, 680.0, 700.0, 800.0, 220.0, 490.0, 800.0, 870.0, 750.0, 620.0, 960.0, 930.0, 340.0, 1160.0, 840.0, 165.0, 260.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 60.0, 40.0, 50.0, 40.0, 0.0, 30.0, 0.0, 30.0, -75.0, 0.0, -50.0, 470.0, 60.0, 40.0, 80.0, 10.0, 60.0, 0.0, 20.0, 15.0, 30.0, 60.0, 40.0, 80.0, 270.0, 20.0, 160.0, 50.0, 90.0, 140.0, 90.0, -25.0, 30.0, 5.0, 190.0, 80.0, 150.0, 160.0, 60.0, 130.0, 10.0, 60.0, 20.0, 50.0, 20.0, 10.0, 100.0, 60.0, 300.0, 40.0, 50.0, 50.0, 70.0, 20.0, -50.0, 210.0, 70.0, 100.0, 20.0, 40.0, 50.0, 20.0, 20.0, 30.0, 40.0, -5.0, 30.0, 30.0, 50.0, 30.0, 270.0, 50.0, 60.0, 20.0, 0.0, 40.0, 160.0, 90.0, 30.0, 40.0, 40.0, 0.0, 0.0, 80.0, 100.0, 0.0, 50.0, 10.0, 10.0, 100.0, 10.0, 0.0, 20.0, 60.0, 10.0, 40.0, 20.0, 70.0, 60.0, 240.0, 40.0, 80.0, 90.0, 40.0, 30.0, 90.0, 0.0, 60.0, 50.0, 90.0, 90.0, 10.0, 70.0, 20.0, 95.0, 110.0, 110.0, 30.0, 10.0, 30.0, 20.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 40.0, 20.0, 120.0, 80.0, 50.0, 10.0, 20.0, 50.0, 50.0, 10.0, 30.0, 20.0, 20.0, 10.0, 40.0, 90.0, 50.0, 90.0, 50.0, 200.0, 90.0, 0.0, 110.0, 40.0, 0.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 100.0, 150.0, 130.0, 50.0, 70.0, 90.0, 70.0, 200.0, 50.0, 20.0, 100.0, 80.0, 20.0, 30.0, 10.0, 70.0, 40.0, 40.0, 90.0, 30.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0, 0.0, 40.0, 20.0, 230.0, -10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 10.0, 30.0, 0.0, 10.0, 70.0, 10.0, 0.0, 0.0, -45.0, 10.0, 40.0, 50.0, 10.0, 40.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 170.0, 30.0, 280.0, 80.0, 30.0, 50.0, 70.0, 160.0, 20.0, 20.0, 250.0, -30.0, 0.0, 60.0, 20.0, 80.0, 80.0, 70.0, 50.0, 60.0, 80.0, 70.0, 30.0, 50.0, 60.0, 30.0, 60.0, 0.0, 20.0, 60.0, 60.0, -10.0, 20.0, 40.0, 50.0, 190.0, 40.0, 110.0, 0.0, -5.0, 30.0, 40.0, 190.0, 20.0, 10.0, 20.0, -10.0, 50.0, 50.0, 40.0, 60.0, 90.0, 160.0, 40.0, 70.0, 30.0, 20.0, 45.0, 35.0, 30.0, 20.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 10.0, 130.0, 80.0, 80.0, 40.0, 180.0, 70.0, 310.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, 40.0, 180.0, 50.0, 180.0, 50.0, 50.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 170.0, 120.0, 110.0, -10.0, 80.0, -55.0, 20.0, 70.0, 10.0, 170.0, 120.0, -80.0, 0.0, 110.0, 30.0, 90.0, 50.0, 35.0, 160.0, 70.0, 100.0, 140.0, 200.0, 30.0, 80.0, 60.0, 50.0, 20.0, 80.0, 70.0, 200.0, 30.0, 80.0, 30.0, 80.0, 20.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 40.0, 80.0, 70.0, 60.0, 20.0, 20.0, 20.0, 70.0, 70.0, 70.0, 60.0, 30.0, 30.0, 30.0, 0.0, 10.0, 10.0, 60.0, 30.0, 30.0, 20.0, 30.0, -10.0, 40.0, 160.0, 80.0, 100.0, 40.0, 160.0, 40.0, 40.0, 0.0, 10.0, 70.0, 10.0, 10.0, 290.0, 140.0, -30.0, 50.0, 170.0, 60.0, 50.0, 10.0, 70.0, 100.0, 90.0, 50.0, 90.0, 20.0, 30.0, 40.0, 50.0, 30.0, 90.0, 70.0, 70.0, 60.0, 70.0, 70.0, 170.0, 70.0, 50.0, 35.0, 230.0, -40.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 35.0, 10.0, 20.0, 20.0, 70.0, 110.0, 50.0, 80.0, 40.0, 50.0, 85.0, 80.0, 0.0, 60.0, 190.0, 40.0, 20.0, 40.0, -20.0, 120.0, 80.0, 70.0, 50.0, 40.0, 100.0, 30.0, 100.0, 170.0, 80.0, 100.0, 290.0, 150.0, 30.0, 70.0, 40.0, 60.0, 50.0, 30.0, 150.0, 30.0, 100.0, 90.0, 30.0, 20.0, 30.0, 80.0, 10.0, 30.0, 50.0, 20.0, 10.0, 20.0, 10.0, 60.0, 170.0, 300.0, 50.0, -50.0, 130.0, 60.0, 70.0, 140.0, 60.0, 70.0, 20.0, 20.0, 10.0, 90.0, 40.0, 40.0, 110.0, 110.0, 90.0, 110.0, 150.0, 110.0, 30.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 40.0, 60.0, 10.0, 360.0, 110.0, 10.0, 140.0, 60.0, -10.0, 210.0, 100.0, 30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0, 30.0, 30.0, 10.0, 40.0, 70.0, 90.0, 10.0, 30.0, 80.0, 40.0, 20.0, 10.0, 50.0, 180.0, 10.0, 200.0, 110.0, 110.0, 60.0, 0.0, 90.0, 20.0, 0.0, 0.0, 180.0, 30.0, 30.0, 100.0, 70.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 150.0, 20.0, 20.0, 30.0, 120.0, 50.0, 150.0, 0.0, 30.0, 60.0, 60.0, 50.0, 20.0, 80.0, 30.0, 170.0, 50.0, 60.0, 10.0, 410.0, 160.0, 100.0, 30.0, 110.0, 150.0, 50.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 190.0, 20.0, 50.0, 10.0, 110.0, 240.0, 30.0, 60.0, 70.0, 80.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 50.0, 100.0, 190.0, 30.0, 60.0, 0.0, 40.0, 30.0, 130.0, 150.0, 90.0, 100.0, 40.0, 100.0, 70.0, 0.0, 30.0, 70.0, 70.0, 40.0, 20.0, 40.0, 40.0, 0.0, 70.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 20.0, 15.0, 60.0, 70.0, 30.0, 0.0, 150.0, 80.0, 40.0, 0.0, 100.0, 80.0, 50.0, 90.0, 50.0, 30.0, 10.0, 10.0, 60.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 30.0, 170.0, 110.0, 70.0, 50.0, 40.0, 320.0, 160.0, 160.0, 70.0, 30.0, 160.0, 10.0, 70.0, 70.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 20.0, 10.0, 70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0, 40.0, 80.0, 10.0, 10.0, 50.0, 60.0, 20.0, 50.0, 130.0, 70.0, 0.0, 50.0, -5.0, 0.0, 10.0, 110.0, 70.0, 30.0, 20.0, 300.0, 15.0, 20.0, 50.0, 30.0, 40.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 40.0, 40.0, 70.0, 40.0, 170.0, 40.0, 10.0, 50.0, 10.0, -10.0, 20.0, 20.0, -20.0, 10.0, 40.0, 0.0, 10.0, 350.0, 30.0, -50.0, 10.0, 60.0, 20.0, 60.0, 10.0, 30.0, 0.0, 360.0, -30.0, 60.0, 0.0, 140.0, 110.0, 60.0, 40.0, 110.0, 20.0, 40.0, 30.0, 180.0, 160.0, 20.0, 30.0, 30.0, 30.0, 30.0, 110.0, 90.0, 0.0, 30.0, 90.0, 10.0, 100.0, 10.0, 10.0, 80.0, 60.0, 90.0, 10.0, 90.0, 160.0, 140.0, 90.0, 50.0, 170.0, 130.0, 40.0, 10.0, 10.0, 30.0, 50.0, 40.0, 40.0, 70.0, 0.0, 130.0, 170.0, 60.0, 90.0, 90.0, 30.0, 20.0, 100.0, -20.0, 110.0, 60.0, -10.0, 20.0, 300.0, 110.0, 0.0, 40.0, 90.0, 0.0, 70.0, 150.0, 180.0, 70.0, 90.0, 40.0, 0.0, 20.0, 10.0, 10.0, 10.0, 70.0, 10.0, 30.0, 20.0, 80.0, 70.0, 40.0, 60.0, 30.0, 10.0, 20.0, 40.0, 80.0, 60.0, 60.0, 90.0, 100.0, 10.0, 10.0, 30.0, 50.0, 170.0, 140.0, 140.0, 120.0, 30.0, 140.0, 110.0, 150.0, 10.0, 70.0, 60.0, 180.0, 0.0, 30.0, 100.0, 40.0, 60.0, 90.0, 130.0, 90.0, 80.0, 40.0, 90.0, 130.0, 60.0, 40.0, 10.0, 50.0, 50.0, 40.0, 100.0, 30.0, 110.0, 30.0, 240.0, -20.0, 120.0, 80.0, 320.0, 90.0, 90.0, 50.0, -40.0, 200.0, 60.0, 100.0, 70.0, 90.0, 170.0, 80.0, 10.0, 50.0, 100.0, 40.0, 70.0, 90.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 60.0, 290.0, 110.0, 120.0, 60.0, 90.0, 210.0, 30.0, 100.0, 70.0, 80.0, -40.0, -20.0, 50.0, 110.0, 10.0, 30.0, 80.0, 480.0, 170.0, -30.0, 10.0, 0.0, 10.0, 15.0, 0.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 20.0, 20.0, 100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.614540640977458, "mean_inference_ms": 1.4048910271273822, "mean_action_processing_ms": 0.40029583860474444, "mean_env_wait_ms": 1.2920563901361029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01605820655822754, "StateBufferConnector_ms": 0.010243415832519531, "ViewRequirementAgentConnector_ms": 0.4109077453613281}, "num_episodes": 27, "episode_return_max": 1160.0, "episode_return_min": 95.0, "episode_return_mean": 593.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.401753539163387, "num_env_steps_trained_throughput_per_sec": 21.401753539163387, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 188760.122, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188760.062, "sample_time_ms": 2660.781, "learn_time_ms": 186079.171, "learn_throughput": 21.496, "synch_weights_time_ms": 12.042}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "33e63_00000", "date": "2024-06-18_22-22-36", "timestamp": 1718763756, "time_this_iter_s": 186.91212916374207, "time_total_s": 4539.660043716431, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4539.660043716431, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 24.994318181818183, "ram_util_percent": 79.23560606060605}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.145542505335884, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.705014301488956, "policy_loss": -0.010871293269672072, "vf_loss": 6.714162171001251, "vf_explained_var": 0.002411062978961851, "kl": 0.008617087442875704, "entropy": 0.9686991803498821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 1200.0, "episode_reward_min": 95.0, "episode_reward_mean": 610.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 61.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 390.0, 95.0, 470.0, 910.0, 640.0, 460.0, 495.0, 440.0, 580.0, 330.0, 950.0, 230.0, 740.0, 555.0, 685.0, 830.0, 680.0, 305.0, 480.0, 390.0, 450.0, 480.0, 910.0, 560.0, 785.0, 225.0, 625.0, 630.0, 1120.0, 600.0, 320.0, 1000.0, 640.0, 450.0, 1050.0, 580.0, 430.0, 750.0, 540.0, 330.0, 570.0, 1100.0, 420.0, 570.0, 580.0, 630.0, 720.0, 370.0, 465.0, 460.0, 550.0, 1070.0, 430.0, 880.0, 520.0, 585.0, 225.0, 470.0, 450.0, 470.0, 610.0, 680.0, 490.0, 890.0, 680.0, 700.0, 800.0, 220.0, 490.0, 800.0, 870.0, 750.0, 620.0, 960.0, 930.0, 340.0, 1160.0, 840.0, 165.0, 260.0, 800.0, 400.0, 840.0, 710.0, 670.0, 720.0, 530.0, 340.0, 275.0, 920.0, 740.0, 590.0, 1200.0, 320.0, 710.0, 755.0, 650.0, 560.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 30.0, 150.0, 20.0, 60.0, 0.0, 40.0, 20.0, 230.0, -10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 10.0, 30.0, 0.0, 10.0, 70.0, 10.0, 0.0, 0.0, -45.0, 10.0, 40.0, 50.0, 10.0, 40.0, 90.0, 30.0, 30.0, 60.0, 30.0, 90.0, 170.0, 30.0, 280.0, 80.0, 30.0, 50.0, 70.0, 160.0, 20.0, 20.0, 250.0, -30.0, 0.0, 60.0, 20.0, 80.0, 80.0, 70.0, 50.0, 60.0, 80.0, 70.0, 30.0, 50.0, 60.0, 30.0, 60.0, 0.0, 20.0, 60.0, 60.0, -10.0, 20.0, 40.0, 50.0, 190.0, 40.0, 110.0, 0.0, -5.0, 30.0, 40.0, 190.0, 20.0, 10.0, 20.0, -10.0, 50.0, 50.0, 40.0, 60.0, 90.0, 160.0, 40.0, 70.0, 30.0, 20.0, 45.0, 35.0, 30.0, 20.0, 30.0, 40.0, 20.0, 10.0, 30.0, 30.0, 10.0, 10.0, 130.0, 80.0, 80.0, 40.0, 180.0, 70.0, 310.0, 40.0, 50.0, 50.0, 50.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, 40.0, 180.0, 50.0, 180.0, 50.0, 50.0, 40.0, 50.0, 60.0, 40.0, 40.0, 40.0, 170.0, 120.0, 110.0, -10.0, 80.0, -55.0, 20.0, 70.0, 10.0, 170.0, 120.0, -80.0, 0.0, 110.0, 30.0, 90.0, 50.0, 35.0, 160.0, 70.0, 100.0, 140.0, 200.0, 30.0, 80.0, 60.0, 50.0, 20.0, 80.0, 70.0, 200.0, 30.0, 80.0, 30.0, 80.0, 20.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 40.0, 80.0, 70.0, 60.0, 20.0, 20.0, 20.0, 70.0, 70.0, 70.0, 60.0, 30.0, 30.0, 30.0, 0.0, 10.0, 10.0, 60.0, 30.0, 30.0, 20.0, 30.0, -10.0, 40.0, 160.0, 80.0, 100.0, 40.0, 160.0, 40.0, 40.0, 0.0, 10.0, 70.0, 10.0, 10.0, 290.0, 140.0, -30.0, 50.0, 170.0, 60.0, 50.0, 10.0, 70.0, 100.0, 90.0, 50.0, 90.0, 20.0, 30.0, 40.0, 50.0, 30.0, 90.0, 70.0, 70.0, 60.0, 70.0, 70.0, 170.0, 70.0, 50.0, 35.0, 230.0, -40.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 35.0, 10.0, 20.0, 20.0, 70.0, 110.0, 50.0, 80.0, 40.0, 50.0, 85.0, 80.0, 0.0, 60.0, 190.0, 40.0, 20.0, 40.0, -20.0, 120.0, 80.0, 70.0, 50.0, 40.0, 100.0, 30.0, 100.0, 170.0, 80.0, 100.0, 290.0, 150.0, 30.0, 70.0, 40.0, 60.0, 50.0, 30.0, 150.0, 30.0, 100.0, 90.0, 30.0, 20.0, 30.0, 80.0, 10.0, 30.0, 50.0, 20.0, 10.0, 20.0, 10.0, 60.0, 170.0, 300.0, 50.0, -50.0, 130.0, 60.0, 70.0, 140.0, 60.0, 70.0, 20.0, 20.0, 10.0, 90.0, 40.0, 40.0, 110.0, 110.0, 90.0, 110.0, 150.0, 110.0, 30.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 40.0, 60.0, 10.0, 360.0, 110.0, 10.0, 140.0, 60.0, -10.0, 210.0, 100.0, 30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0, 30.0, 30.0, 10.0, 40.0, 70.0, 90.0, 10.0, 30.0, 80.0, 40.0, 20.0, 10.0, 50.0, 180.0, 10.0, 200.0, 110.0, 110.0, 60.0, 0.0, 90.0, 20.0, 0.0, 0.0, 180.0, 30.0, 30.0, 100.0, 70.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 150.0, 20.0, 20.0, 30.0, 120.0, 50.0, 150.0, 0.0, 30.0, 60.0, 60.0, 50.0, 20.0, 80.0, 30.0, 170.0, 50.0, 60.0, 10.0, 410.0, 160.0, 100.0, 30.0, 110.0, 150.0, 50.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 190.0, 20.0, 50.0, 10.0, 110.0, 240.0, 30.0, 60.0, 70.0, 80.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 50.0, 100.0, 190.0, 30.0, 60.0, 0.0, 40.0, 30.0, 130.0, 150.0, 90.0, 100.0, 40.0, 100.0, 70.0, 0.0, 30.0, 70.0, 70.0, 40.0, 20.0, 40.0, 40.0, 0.0, 70.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 20.0, 15.0, 60.0, 70.0, 30.0, 0.0, 150.0, 80.0, 40.0, 0.0, 100.0, 80.0, 50.0, 90.0, 50.0, 30.0, 10.0, 10.0, 60.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 30.0, 170.0, 110.0, 70.0, 50.0, 40.0, 320.0, 160.0, 160.0, 70.0, 30.0, 160.0, 10.0, 70.0, 70.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 20.0, 10.0, 70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0, 40.0, 80.0, 10.0, 10.0, 50.0, 60.0, 20.0, 50.0, 130.0, 70.0, 0.0, 50.0, -5.0, 0.0, 10.0, 110.0, 70.0, 30.0, 20.0, 300.0, 15.0, 20.0, 50.0, 30.0, 40.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 40.0, 40.0, 70.0, 40.0, 170.0, 40.0, 10.0, 50.0, 10.0, -10.0, 20.0, 20.0, -20.0, 10.0, 40.0, 0.0, 10.0, 350.0, 30.0, -50.0, 10.0, 60.0, 20.0, 60.0, 10.0, 30.0, 0.0, 360.0, -30.0, 60.0, 0.0, 140.0, 110.0, 60.0, 40.0, 110.0, 20.0, 40.0, 30.0, 180.0, 160.0, 20.0, 30.0, 30.0, 30.0, 30.0, 110.0, 90.0, 0.0, 30.0, 90.0, 10.0, 100.0, 10.0, 10.0, 80.0, 60.0, 90.0, 10.0, 90.0, 160.0, 140.0, 90.0, 50.0, 170.0, 130.0, 40.0, 10.0, 10.0, 30.0, 50.0, 40.0, 40.0, 70.0, 0.0, 130.0, 170.0, 60.0, 90.0, 90.0, 30.0, 20.0, 100.0, -20.0, 110.0, 60.0, -10.0, 20.0, 300.0, 110.0, 0.0, 40.0, 90.0, 0.0, 70.0, 150.0, 180.0, 70.0, 90.0, 40.0, 0.0, 20.0, 10.0, 10.0, 10.0, 70.0, 10.0, 30.0, 20.0, 80.0, 70.0, 40.0, 60.0, 30.0, 10.0, 20.0, 40.0, 80.0, 60.0, 60.0, 90.0, 100.0, 10.0, 10.0, 30.0, 50.0, 170.0, 140.0, 140.0, 120.0, 30.0, 140.0, 110.0, 150.0, 10.0, 70.0, 60.0, 180.0, 0.0, 30.0, 100.0, 40.0, 60.0, 90.0, 130.0, 90.0, 80.0, 40.0, 90.0, 130.0, 60.0, 40.0, 10.0, 50.0, 50.0, 40.0, 100.0, 30.0, 110.0, 30.0, 240.0, -20.0, 120.0, 80.0, 320.0, 90.0, 90.0, 50.0, -40.0, 200.0, 60.0, 100.0, 70.0, 90.0, 170.0, 80.0, 10.0, 50.0, 100.0, 40.0, 70.0, 90.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 60.0, 290.0, 110.0, 120.0, 60.0, 90.0, 210.0, 30.0, 100.0, 70.0, 80.0, -40.0, -20.0, 50.0, 110.0, 10.0, 30.0, 80.0, 480.0, 170.0, -30.0, 10.0, 0.0, 10.0, 15.0, 0.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 20.0, 20.0, 100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0, 60.0, 0.0, 40.0, 40.0, 50.0, 0.0, 10.0, 40.0, 160.0, 0.0, 170.0, 40.0, 40.0, 70.0, 200.0, 80.0, 50.0, 90.0, 60.0, 40.0, 60.0, 40.0, 70.0, 90.0, 40.0, 60.0, 260.0, 40.0, 10.0, 40.0, 20.0, 190.0, 20.0, 50.0, 100.0, 170.0, 20.0, 40.0, 40.0, 20.0, 70.0, 50.0, 40.0, 90.0, 100.0, 30.0, 60.0, 100.0, 20.0, 160.0, 30.0, 100.0, 30.0, 40.0, 100.0, 30.0, 40.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 40.0, 150.0, 0.0, 30.0, 40.0, 40.0, 40.0, 10.0, 30.0, 0.0, 90.0, 40.0, 30.0, 30.0, -25.0, 40.0, 30.0, 40.0, 40.0, 60.0, 200.0, 120.0, 170.0, 80.0, 60.0, 30.0, 120.0, 40.0, 70.0, 20.0, 70.0, 90.0, 80.0, 40.0, 100.0, 140.0, 90.0, 60.0, 160.0, 70.0, 0.0, 40.0, 20.0, 80.0, 10.0, 60.0, 90.0, 240.0, 120.0, 110.0, 70.0, 70.0, 60.0, 200.0, 220.0, 60.0, 50.0, 30.0, 20.0, 40.0, 40.0, 20.0, 70.0, 30.0, 20.0, 0.0, 50.0, 70.0, 60.0, 50.0, 160.0, 30.0, -20.0, 70.0, 70.0, 180.0, 40.0, 90.0, 25.0, 20.0, 50.0, 0.0, 30.0, 70.0, 230.0, 50.0, 190.0, 100.0, 90.0, 10.0, 10.0, 80.0, 50.0, 70.0, 190.0, 20.0, 30.0, 30.0, 40.0, 150.0, 40.0, 40.0, 20.0, 60.0, 60.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6088107465062087, "mean_inference_ms": 1.4054686192164212, "mean_action_processing_ms": 0.39953378912256793, "mean_env_wait_ms": 1.2890109622875943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013056039810180664, "StateBufferConnector_ms": 0.009888648986816406, "ViewRequirementAgentConnector_ms": 0.40957045555114746}, "num_episodes": 18, "episode_return_max": 1200.0, "episode_return_min": 95.0, "episode_return_mean": 610.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.169148261736957, "num_env_steps_trained_throughput_per_sec": 21.169148261736957, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 189002.752, "restore_workers_time_ms": 0.012, "training_step_time_ms": 189002.692, "sample_time_ms": 2647.384, "learn_time_ms": 186335.458, "learn_throughput": 21.467, "synch_weights_time_ms": 11.873}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "33e63_00000", "date": "2024-06-18_22-25-45", "timestamp": 1718763945, "time_this_iter_s": 188.96575736999512, "time_total_s": 4728.625801086426, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3271a8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4728.625801086426, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 25.794756554307117, "ram_util_percent": 79.85917602996255}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2229154895860166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.697370118759691, "policy_loss": -0.010952995583554878, "vf_loss": 6.7067506870395714, "vf_explained_var": 8.079612090056951e-05, "kl": 0.007862149855791596, "entropy": 0.9618916940828736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1280.0, "episode_reward_min": 165.0, "episode_reward_mean": 649.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 480.0}, "policy_reward_mean": {"policy_0": 64.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.0, 480.0, 390.0, 450.0, 480.0, 910.0, 560.0, 785.0, 225.0, 625.0, 630.0, 1120.0, 600.0, 320.0, 1000.0, 640.0, 450.0, 1050.0, 580.0, 430.0, 750.0, 540.0, 330.0, 570.0, 1100.0, 420.0, 570.0, 580.0, 630.0, 720.0, 370.0, 465.0, 460.0, 550.0, 1070.0, 430.0, 880.0, 520.0, 585.0, 225.0, 470.0, 450.0, 470.0, 610.0, 680.0, 490.0, 890.0, 680.0, 700.0, 800.0, 220.0, 490.0, 800.0, 870.0, 750.0, 620.0, 960.0, 930.0, 340.0, 1160.0, 840.0, 165.0, 260.0, 800.0, 400.0, 840.0, 710.0, 670.0, 720.0, 530.0, 340.0, 275.0, 920.0, 740.0, 590.0, 1200.0, 320.0, 710.0, 755.0, 650.0, 560.0, 930.0, 1040.0, 1190.0, 410.0, 720.0, 530.0, 845.0, 880.0, 1280.0, 560.0, 670.0, 650.0, 530.0, 540.0, 1085.0, 740.0, 450.0, 995.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 40.0, 70.0, 10.0, 80.0, 40.0, -5.0, 40.0, 20.0, 30.0, 90.0, 30.0, 40.0, 40.0, 80.0, 70.0, 60.0, 20.0, 20.0, 20.0, 70.0, 70.0, 70.0, 60.0, 30.0, 30.0, 30.0, 0.0, 10.0, 10.0, 60.0, 30.0, 30.0, 20.0, 30.0, -10.0, 40.0, 160.0, 80.0, 100.0, 40.0, 160.0, 40.0, 40.0, 0.0, 10.0, 70.0, 10.0, 10.0, 290.0, 140.0, -30.0, 50.0, 170.0, 60.0, 50.0, 10.0, 70.0, 100.0, 90.0, 50.0, 90.0, 20.0, 30.0, 40.0, 50.0, 30.0, 90.0, 70.0, 70.0, 60.0, 70.0, 70.0, 170.0, 70.0, 50.0, 35.0, 230.0, -40.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 35.0, 10.0, 20.0, 20.0, 70.0, 110.0, 50.0, 80.0, 40.0, 50.0, 85.0, 80.0, 0.0, 60.0, 190.0, 40.0, 20.0, 40.0, -20.0, 120.0, 80.0, 70.0, 50.0, 40.0, 100.0, 30.0, 100.0, 170.0, 80.0, 100.0, 290.0, 150.0, 30.0, 70.0, 40.0, 60.0, 50.0, 30.0, 150.0, 30.0, 100.0, 90.0, 30.0, 20.0, 30.0, 80.0, 10.0, 30.0, 50.0, 20.0, 10.0, 20.0, 10.0, 60.0, 170.0, 300.0, 50.0, -50.0, 130.0, 60.0, 70.0, 140.0, 60.0, 70.0, 20.0, 20.0, 10.0, 90.0, 40.0, 40.0, 110.0, 110.0, 90.0, 110.0, 150.0, 110.0, 30.0, 20.0, 10.0, 20.0, 40.0, 0.0, 30.0, 40.0, 60.0, 10.0, 360.0, 110.0, 10.0, 140.0, 60.0, -10.0, 210.0, 100.0, 30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0, 30.0, 30.0, 10.0, 40.0, 70.0, 90.0, 10.0, 30.0, 80.0, 40.0, 20.0, 10.0, 50.0, 180.0, 10.0, 200.0, 110.0, 110.0, 60.0, 0.0, 90.0, 20.0, 0.0, 0.0, 180.0, 30.0, 30.0, 100.0, 70.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 150.0, 20.0, 20.0, 30.0, 120.0, 50.0, 150.0, 0.0, 30.0, 60.0, 60.0, 50.0, 20.0, 80.0, 30.0, 170.0, 50.0, 60.0, 10.0, 410.0, 160.0, 100.0, 30.0, 110.0, 150.0, 50.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 190.0, 20.0, 50.0, 10.0, 110.0, 240.0, 30.0, 60.0, 70.0, 80.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 50.0, 100.0, 190.0, 30.0, 60.0, 0.0, 40.0, 30.0, 130.0, 150.0, 90.0, 100.0, 40.0, 100.0, 70.0, 0.0, 30.0, 70.0, 70.0, 40.0, 20.0, 40.0, 40.0, 0.0, 70.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 20.0, 15.0, 60.0, 70.0, 30.0, 0.0, 150.0, 80.0, 40.0, 0.0, 100.0, 80.0, 50.0, 90.0, 50.0, 30.0, 10.0, 10.0, 60.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 30.0, 170.0, 110.0, 70.0, 50.0, 40.0, 320.0, 160.0, 160.0, 70.0, 30.0, 160.0, 10.0, 70.0, 70.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 20.0, 10.0, 70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0, 40.0, 80.0, 10.0, 10.0, 50.0, 60.0, 20.0, 50.0, 130.0, 70.0, 0.0, 50.0, -5.0, 0.0, 10.0, 110.0, 70.0, 30.0, 20.0, 300.0, 15.0, 20.0, 50.0, 30.0, 40.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 40.0, 40.0, 70.0, 40.0, 170.0, 40.0, 10.0, 50.0, 10.0, -10.0, 20.0, 20.0, -20.0, 10.0, 40.0, 0.0, 10.0, 350.0, 30.0, -50.0, 10.0, 60.0, 20.0, 60.0, 10.0, 30.0, 0.0, 360.0, -30.0, 60.0, 0.0, 140.0, 110.0, 60.0, 40.0, 110.0, 20.0, 40.0, 30.0, 180.0, 160.0, 20.0, 30.0, 30.0, 30.0, 30.0, 110.0, 90.0, 0.0, 30.0, 90.0, 10.0, 100.0, 10.0, 10.0, 80.0, 60.0, 90.0, 10.0, 90.0, 160.0, 140.0, 90.0, 50.0, 170.0, 130.0, 40.0, 10.0, 10.0, 30.0, 50.0, 40.0, 40.0, 70.0, 0.0, 130.0, 170.0, 60.0, 90.0, 90.0, 30.0, 20.0, 100.0, -20.0, 110.0, 60.0, -10.0, 20.0, 300.0, 110.0, 0.0, 40.0, 90.0, 0.0, 70.0, 150.0, 180.0, 70.0, 90.0, 40.0, 0.0, 20.0, 10.0, 10.0, 10.0, 70.0, 10.0, 30.0, 20.0, 80.0, 70.0, 40.0, 60.0, 30.0, 10.0, 20.0, 40.0, 80.0, 60.0, 60.0, 90.0, 100.0, 10.0, 10.0, 30.0, 50.0, 170.0, 140.0, 140.0, 120.0, 30.0, 140.0, 110.0, 150.0, 10.0, 70.0, 60.0, 180.0, 0.0, 30.0, 100.0, 40.0, 60.0, 90.0, 130.0, 90.0, 80.0, 40.0, 90.0, 130.0, 60.0, 40.0, 10.0, 50.0, 50.0, 40.0, 100.0, 30.0, 110.0, 30.0, 240.0, -20.0, 120.0, 80.0, 320.0, 90.0, 90.0, 50.0, -40.0, 200.0, 60.0, 100.0, 70.0, 90.0, 170.0, 80.0, 10.0, 50.0, 100.0, 40.0, 70.0, 90.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 60.0, 290.0, 110.0, 120.0, 60.0, 90.0, 210.0, 30.0, 100.0, 70.0, 80.0, -40.0, -20.0, 50.0, 110.0, 10.0, 30.0, 80.0, 480.0, 170.0, -30.0, 10.0, 0.0, 10.0, 15.0, 0.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 20.0, 20.0, 100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0, 60.0, 0.0, 40.0, 40.0, 50.0, 0.0, 10.0, 40.0, 160.0, 0.0, 170.0, 40.0, 40.0, 70.0, 200.0, 80.0, 50.0, 90.0, 60.0, 40.0, 60.0, 40.0, 70.0, 90.0, 40.0, 60.0, 260.0, 40.0, 10.0, 40.0, 20.0, 190.0, 20.0, 50.0, 100.0, 170.0, 20.0, 40.0, 40.0, 20.0, 70.0, 50.0, 40.0, 90.0, 100.0, 30.0, 60.0, 100.0, 20.0, 160.0, 30.0, 100.0, 30.0, 40.0, 100.0, 30.0, 40.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 40.0, 150.0, 0.0, 30.0, 40.0, 40.0, 40.0, 10.0, 30.0, 0.0, 90.0, 40.0, 30.0, 30.0, -25.0, 40.0, 30.0, 40.0, 40.0, 60.0, 200.0, 120.0, 170.0, 80.0, 60.0, 30.0, 120.0, 40.0, 70.0, 20.0, 70.0, 90.0, 80.0, 40.0, 100.0, 140.0, 90.0, 60.0, 160.0, 70.0, 0.0, 40.0, 20.0, 80.0, 10.0, 60.0, 90.0, 240.0, 120.0, 110.0, 70.0, 70.0, 60.0, 200.0, 220.0, 60.0, 50.0, 30.0, 20.0, 40.0, 40.0, 20.0, 70.0, 30.0, 20.0, 0.0, 50.0, 70.0, 60.0, 50.0, 160.0, 30.0, -20.0, 70.0, 70.0, 180.0, 40.0, 90.0, 25.0, 20.0, 50.0, 0.0, 30.0, 70.0, 230.0, 50.0, 190.0, 100.0, 90.0, 10.0, 10.0, 80.0, 50.0, 70.0, 190.0, 20.0, 30.0, 30.0, 40.0, 150.0, 40.0, 40.0, 20.0, 60.0, 60.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0, 60.0, 90.0, 70.0, 310.0, 40.0, 70.0, 100.0, 80.0, 160.0, 60.0, 100.0, 20.0, 210.0, 190.0, 150.0, 140.0, 60.0, 60.0, 210.0, 50.0, 70.0, 10.0, 20.0, 0.0, 100.0, 50.0, 50.0, 50.0, 40.0, 20.0, 30.0, 60.0, 100.0, 70.0, 100.0, 60.0, 120.0, 50.0, 70.0, 60.0, 80.0, 60.0, 30.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 50.0, 120.0, 150.0, 70.0, 30.0, 140.0, 180.0, 10.0, 130.0, -60.0, 75.0, 140.0, 80.0, 80.0, 70.0, 40.0, 160.0, 60.0, 60.0, 30.0, 160.0, 250.0, 360.0, 190.0, 30.0, 90.0, 60.0, 90.0, 40.0, 70.0, 100.0, 90.0, 70.0, 10.0, 70.0, 160.0, 30.0, 60.0, 20.0, 0.0, 50.0, 160.0, 20.0, 40.0, 50.0, 220.0, 60.0, 20.0, 10.0, 0.0, 90.0, 160.0, 170.0, 40.0, 10.0, 20.0, 40.0, 50.0, 50.0, 80.0, 30.0, 40.0, 40.0, 20.0, 110.0, 10.0, 100.0, 10.0, 80.0, 40.0, 80.0, 50.0, 40.0, 30.0, 20.0, 140.0, 30.0, 30.0, 110.0, 30.0, 60.0, 50.0, 105.0, -20.0, 30.0, 40.0, 170.0, 320.0, 100.0, 160.0, 130.0, 10.0, 90.0, 90.0, 100.0, 190.0, 20.0, 100.0, 30.0, 10.0, 100.0, 40.0, 70.0, 60.0, 150.0, -30.0, 30.0, 0.0, 10.0, 0.0, 120.0, 10.0, 160.0, 85.0, 70.0, 20.0, 0.0, 370.0, 120.0, 100.0, 60.0, -30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6056227197924209, "mean_inference_ms": 1.4067267226624367, "mean_action_processing_ms": 0.4145024811691676, "mean_env_wait_ms": 1.2878338589492815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013289928436279297, "StateBufferConnector_ms": 0.01001286506652832, "ViewRequirementAgentConnector_ms": 0.4195094108581543}, "num_episodes": 18, "episode_return_max": 1280.0, "episode_return_min": 165.0, "episode_return_mean": 649.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.25221629754773, "num_env_steps_trained_throughput_per_sec": 21.25221629754773, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 188935.325, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188935.278, "sample_time_ms": 2736.218, "learn_time_ms": 186179.396, "learn_throughput": 21.485, "synch_weights_time_ms": 11.474}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "33e63_00000", "date": "2024-06-18_22-28-53", "timestamp": 1718764133, "time_this_iter_s": 188.224928855896, "time_total_s": 4916.850729942322, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327299940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4916.850729942322, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 25.617228464419473, "ram_util_percent": 79.83408239700374}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5114568282494023, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.760457412884258, "policy_loss": -0.011101195059669094, "vf_loss": 6.769957932318869, "vf_explained_var": 0.0007801204253309451, "kl": 0.008003367540212209, "entropy": 0.9426386582648284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 1280.0, "episode_reward_min": 165.0, "episode_reward_mean": 679.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 510.0}, "policy_reward_mean": {"policy_0": 67.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [580.0, 430.0, 750.0, 540.0, 330.0, 570.0, 1100.0, 420.0, 570.0, 580.0, 630.0, 720.0, 370.0, 465.0, 460.0, 550.0, 1070.0, 430.0, 880.0, 520.0, 585.0, 225.0, 470.0, 450.0, 470.0, 610.0, 680.0, 490.0, 890.0, 680.0, 700.0, 800.0, 220.0, 490.0, 800.0, 870.0, 750.0, 620.0, 960.0, 930.0, 340.0, 1160.0, 840.0, 165.0, 260.0, 800.0, 400.0, 840.0, 710.0, 670.0, 720.0, 530.0, 340.0, 275.0, 920.0, 740.0, 590.0, 1200.0, 320.0, 710.0, 755.0, 650.0, 560.0, 930.0, 1040.0, 1190.0, 410.0, 720.0, 530.0, 845.0, 880.0, 1280.0, 560.0, 670.0, 650.0, 530.0, 540.0, 1085.0, 740.0, 450.0, 995.0, 760.0, 520.0, 1095.0, 560.0, 530.0, 990.0, 620.0, 750.0, 520.0, 1230.0, 860.0, 825.0, 450.0, 830.0, 700.0, 1090.0, 475.0, 980.0, 980.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 50.0, 0.0, 0.0, 10.0, 30.0, 200.0, 60.0, 170.0, 30.0, 30.0, 10.0, 40.0, 70.0, 90.0, 10.0, 30.0, 80.0, 40.0, 20.0, 10.0, 50.0, 180.0, 10.0, 200.0, 110.0, 110.0, 60.0, 0.0, 90.0, 20.0, 0.0, 0.0, 180.0, 30.0, 30.0, 100.0, 70.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 0.0, 150.0, 20.0, 20.0, 30.0, 120.0, 50.0, 150.0, 0.0, 30.0, 60.0, 60.0, 50.0, 20.0, 80.0, 30.0, 170.0, 50.0, 60.0, 10.0, 410.0, 160.0, 100.0, 30.0, 110.0, 150.0, 50.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 70.0, 40.0, 20.0, 30.0, 190.0, 20.0, 50.0, 10.0, 110.0, 240.0, 30.0, 60.0, 70.0, 80.0, 20.0, 30.0, 30.0, 0.0, 20.0, 0.0, 50.0, 100.0, 190.0, 30.0, 60.0, 0.0, 40.0, 30.0, 130.0, 150.0, 90.0, 100.0, 40.0, 100.0, 70.0, 0.0, 30.0, 70.0, 70.0, 40.0, 20.0, 40.0, 40.0, 0.0, 70.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 20.0, 15.0, 60.0, 70.0, 30.0, 0.0, 150.0, 80.0, 40.0, 0.0, 100.0, 80.0, 50.0, 90.0, 50.0, 30.0, 10.0, 10.0, 60.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 30.0, 170.0, 110.0, 70.0, 50.0, 40.0, 320.0, 160.0, 160.0, 70.0, 30.0, 160.0, 10.0, 70.0, 70.0, 20.0, 60.0, 40.0, 20.0, 30.0, 90.0, 20.0, 10.0, 70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0, 40.0, 80.0, 10.0, 10.0, 50.0, 60.0, 20.0, 50.0, 130.0, 70.0, 0.0, 50.0, -5.0, 0.0, 10.0, 110.0, 70.0, 30.0, 20.0, 300.0, 15.0, 20.0, 50.0, 30.0, 40.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 40.0, 40.0, 70.0, 40.0, 170.0, 40.0, 10.0, 50.0, 10.0, -10.0, 20.0, 20.0, -20.0, 10.0, 40.0, 0.0, 10.0, 350.0, 30.0, -50.0, 10.0, 60.0, 20.0, 60.0, 10.0, 30.0, 0.0, 360.0, -30.0, 60.0, 0.0, 140.0, 110.0, 60.0, 40.0, 110.0, 20.0, 40.0, 30.0, 180.0, 160.0, 20.0, 30.0, 30.0, 30.0, 30.0, 110.0, 90.0, 0.0, 30.0, 90.0, 10.0, 100.0, 10.0, 10.0, 80.0, 60.0, 90.0, 10.0, 90.0, 160.0, 140.0, 90.0, 50.0, 170.0, 130.0, 40.0, 10.0, 10.0, 30.0, 50.0, 40.0, 40.0, 70.0, 0.0, 130.0, 170.0, 60.0, 90.0, 90.0, 30.0, 20.0, 100.0, -20.0, 110.0, 60.0, -10.0, 20.0, 300.0, 110.0, 0.0, 40.0, 90.0, 0.0, 70.0, 150.0, 180.0, 70.0, 90.0, 40.0, 0.0, 20.0, 10.0, 10.0, 10.0, 70.0, 10.0, 30.0, 20.0, 80.0, 70.0, 40.0, 60.0, 30.0, 10.0, 20.0, 40.0, 80.0, 60.0, 60.0, 90.0, 100.0, 10.0, 10.0, 30.0, 50.0, 170.0, 140.0, 140.0, 120.0, 30.0, 140.0, 110.0, 150.0, 10.0, 70.0, 60.0, 180.0, 0.0, 30.0, 100.0, 40.0, 60.0, 90.0, 130.0, 90.0, 80.0, 40.0, 90.0, 130.0, 60.0, 40.0, 10.0, 50.0, 50.0, 40.0, 100.0, 30.0, 110.0, 30.0, 240.0, -20.0, 120.0, 80.0, 320.0, 90.0, 90.0, 50.0, -40.0, 200.0, 60.0, 100.0, 70.0, 90.0, 170.0, 80.0, 10.0, 50.0, 100.0, 40.0, 70.0, 90.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 60.0, 290.0, 110.0, 120.0, 60.0, 90.0, 210.0, 30.0, 100.0, 70.0, 80.0, -40.0, -20.0, 50.0, 110.0, 10.0, 30.0, 80.0, 480.0, 170.0, -30.0, 10.0, 0.0, 10.0, 15.0, 0.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 20.0, 20.0, 100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0, 60.0, 0.0, 40.0, 40.0, 50.0, 0.0, 10.0, 40.0, 160.0, 0.0, 170.0, 40.0, 40.0, 70.0, 200.0, 80.0, 50.0, 90.0, 60.0, 40.0, 60.0, 40.0, 70.0, 90.0, 40.0, 60.0, 260.0, 40.0, 10.0, 40.0, 20.0, 190.0, 20.0, 50.0, 100.0, 170.0, 20.0, 40.0, 40.0, 20.0, 70.0, 50.0, 40.0, 90.0, 100.0, 30.0, 60.0, 100.0, 20.0, 160.0, 30.0, 100.0, 30.0, 40.0, 100.0, 30.0, 40.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 40.0, 150.0, 0.0, 30.0, 40.0, 40.0, 40.0, 10.0, 30.0, 0.0, 90.0, 40.0, 30.0, 30.0, -25.0, 40.0, 30.0, 40.0, 40.0, 60.0, 200.0, 120.0, 170.0, 80.0, 60.0, 30.0, 120.0, 40.0, 70.0, 20.0, 70.0, 90.0, 80.0, 40.0, 100.0, 140.0, 90.0, 60.0, 160.0, 70.0, 0.0, 40.0, 20.0, 80.0, 10.0, 60.0, 90.0, 240.0, 120.0, 110.0, 70.0, 70.0, 60.0, 200.0, 220.0, 60.0, 50.0, 30.0, 20.0, 40.0, 40.0, 20.0, 70.0, 30.0, 20.0, 0.0, 50.0, 70.0, 60.0, 50.0, 160.0, 30.0, -20.0, 70.0, 70.0, 180.0, 40.0, 90.0, 25.0, 20.0, 50.0, 0.0, 30.0, 70.0, 230.0, 50.0, 190.0, 100.0, 90.0, 10.0, 10.0, 80.0, 50.0, 70.0, 190.0, 20.0, 30.0, 30.0, 40.0, 150.0, 40.0, 40.0, 20.0, 60.0, 60.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0, 60.0, 90.0, 70.0, 310.0, 40.0, 70.0, 100.0, 80.0, 160.0, 60.0, 100.0, 20.0, 210.0, 190.0, 150.0, 140.0, 60.0, 60.0, 210.0, 50.0, 70.0, 10.0, 20.0, 0.0, 100.0, 50.0, 50.0, 50.0, 40.0, 20.0, 30.0, 60.0, 100.0, 70.0, 100.0, 60.0, 120.0, 50.0, 70.0, 60.0, 80.0, 60.0, 30.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 50.0, 120.0, 150.0, 70.0, 30.0, 140.0, 180.0, 10.0, 130.0, -60.0, 75.0, 140.0, 80.0, 80.0, 70.0, 40.0, 160.0, 60.0, 60.0, 30.0, 160.0, 250.0, 360.0, 190.0, 30.0, 90.0, 60.0, 90.0, 40.0, 70.0, 100.0, 90.0, 70.0, 10.0, 70.0, 160.0, 30.0, 60.0, 20.0, 0.0, 50.0, 160.0, 20.0, 40.0, 50.0, 220.0, 60.0, 20.0, 10.0, 0.0, 90.0, 160.0, 170.0, 40.0, 10.0, 20.0, 40.0, 50.0, 50.0, 80.0, 30.0, 40.0, 40.0, 20.0, 110.0, 10.0, 100.0, 10.0, 80.0, 40.0, 80.0, 50.0, 40.0, 30.0, 20.0, 140.0, 30.0, 30.0, 110.0, 30.0, 60.0, 50.0, 105.0, -20.0, 30.0, 40.0, 170.0, 320.0, 100.0, 160.0, 130.0, 10.0, 90.0, 90.0, 100.0, 190.0, 20.0, 100.0, 30.0, 10.0, 100.0, 40.0, 70.0, 60.0, 150.0, -30.0, 30.0, 0.0, 10.0, 0.0, 120.0, 10.0, 160.0, 85.0, 70.0, 20.0, 0.0, 370.0, 120.0, 100.0, 60.0, -30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0, 30.0, 130.0, 70.0, 60.0, 20.0, 20.0, 30.0, 90.0, 0.0, 70.0, 50.0, 25.0, 235.0, 10.0, 210.0, 100.0, -5.0, 120.0, 310.0, 40.0, 70.0, 90.0, 120.0, 50.0, 40.0, 20.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 40.0, 30.0, 50.0, 10.0, 300.0, 50.0, 110.0, -80.0, 60.0, 40.0, 60.0, 90.0, 130.0, 240.0, 70.0, 230.0, 20.0, 50.0, 110.0, 60.0, 20.0, 10.0, 0.0, 50.0, 40.0, 160.0, 110.0, 60.0, 150.0, 170.0, 40.0, 60.0, 20.0, 180.0, 30.0, 20.0, 70.0, 10.0, 50.0, -20.0, 190.0, 40.0, 30.0, 20.0, 20.0, 40.0, 90.0, 60.0, 160.0, 30.0, 10.0, 80.0, 40.0, 510.0, 130.0, 130.0, 70.0, 70.0, 40.0, 90.0, 70.0, 220.0, 60.0, 40.0, 60.0, 40.0, 40.0, 200.0, 80.0, 170.0, 110.0, 130.0, 30.0, 60.0, 35.0, 50.0, 80.0, 80.0, 20.0, 60.0, 70.0, 40.0, 0.0, 20.0, 80.0, 10.0, 120.0, 30.0, 70.0, 200.0, 190.0, 90.0, 70.0, 80.0, 20.0, 30.0, 50.0, 30.0, 0.0, 160.0, 50.0, 50.0, 10.0, 20.0, 120.0, 40.0, 200.0, 50.0, 290.0, 10.0, 160.0, 20.0, 120.0, 180.0, 30.0, 40.0, 150.0, 90.0, 80.0, 0.0, 80.0, 80.0, 60.0, 0.0, -5.0, 0.0, 120.0, 60.0, 100.0, 80.0, 40.0, 410.0, 40.0, 120.0, 80.0, 0.0, 40.0, 70.0, 40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.603356943762504, "mean_inference_ms": 1.407613144010053, "mean_action_processing_ms": 0.4288974962030666, "mean_env_wait_ms": 1.2864786588445989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013353824615478516, "StateBufferConnector_ms": 0.010261058807373047, "ViewRequirementAgentConnector_ms": 0.4179966449737549}, "num_episodes": 18, "episode_return_max": 1280.0, "episode_return_min": 165.0, "episode_return_mean": 679.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.396376972128778, "num_env_steps_trained_throughput_per_sec": 21.396376972128778, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 188587.908, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188587.862, "sample_time_ms": 2699.194, "learn_time_ms": 185868.853, "learn_throughput": 21.521, "synch_weights_time_ms": 11.554}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "33e63_00000", "date": "2024-06-18_22-32-00", "timestamp": 1718764320, "time_this_iter_s": 186.95586681365967, "time_total_s": 5103.806596755981, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272c6e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5103.806596755981, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 25.35530303030303, "ram_util_percent": 79.64015151515152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5979878164074037, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.313717415081427, "policy_loss": -0.010713666215495835, "vf_loss": 6.322884957909711, "vf_explained_var": 0.0019346094867799736, "kl": 0.007730655920476033, "entropy": 0.956355551339059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1280.0, "episode_reward_min": 165.0, "episode_reward_mean": 700.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 510.0}, "policy_reward_mean": {"policy_0": 70.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [880.0, 520.0, 585.0, 225.0, 470.0, 450.0, 470.0, 610.0, 680.0, 490.0, 890.0, 680.0, 700.0, 800.0, 220.0, 490.0, 800.0, 870.0, 750.0, 620.0, 960.0, 930.0, 340.0, 1160.0, 840.0, 165.0, 260.0, 800.0, 400.0, 840.0, 710.0, 670.0, 720.0, 530.0, 340.0, 275.0, 920.0, 740.0, 590.0, 1200.0, 320.0, 710.0, 755.0, 650.0, 560.0, 930.0, 1040.0, 1190.0, 410.0, 720.0, 530.0, 845.0, 880.0, 1280.0, 560.0, 670.0, 650.0, 530.0, 540.0, 1085.0, 740.0, 450.0, 995.0, 760.0, 520.0, 1095.0, 560.0, 530.0, 990.0, 620.0, 750.0, 520.0, 1230.0, 860.0, 825.0, 450.0, 830.0, 700.0, 1090.0, 475.0, 980.0, 980.0, 650.0, 770.0, 730.0, 365.0, 860.0, 700.0, 1100.0, 860.0, 420.0, 530.0, 725.0, 720.0, 880.0, 650.0, 465.0, 580.0, 850.0, 790.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 120.0, 60.0, 80.0, 110.0, 70.0, 190.0, 110.0, -20.0, 90.0, 40.0, 80.0, 10.0, 10.0, 50.0, 60.0, 20.0, 50.0, 130.0, 70.0, 0.0, 50.0, -5.0, 0.0, 10.0, 110.0, 70.0, 30.0, 20.0, 300.0, 15.0, 20.0, 50.0, 30.0, 40.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 40.0, 40.0, 70.0, 40.0, 170.0, 40.0, 10.0, 50.0, 10.0, -10.0, 20.0, 20.0, -20.0, 10.0, 40.0, 0.0, 10.0, 350.0, 30.0, -50.0, 10.0, 60.0, 20.0, 60.0, 10.0, 30.0, 0.0, 360.0, -30.0, 60.0, 0.0, 140.0, 110.0, 60.0, 40.0, 110.0, 20.0, 40.0, 30.0, 180.0, 160.0, 20.0, 30.0, 30.0, 30.0, 30.0, 110.0, 90.0, 0.0, 30.0, 90.0, 10.0, 100.0, 10.0, 10.0, 80.0, 60.0, 90.0, 10.0, 90.0, 160.0, 140.0, 90.0, 50.0, 170.0, 130.0, 40.0, 10.0, 10.0, 30.0, 50.0, 40.0, 40.0, 70.0, 0.0, 130.0, 170.0, 60.0, 90.0, 90.0, 30.0, 20.0, 100.0, -20.0, 110.0, 60.0, -10.0, 20.0, 300.0, 110.0, 0.0, 40.0, 90.0, 0.0, 70.0, 150.0, 180.0, 70.0, 90.0, 40.0, 0.0, 20.0, 10.0, 10.0, 10.0, 70.0, 10.0, 30.0, 20.0, 80.0, 70.0, 40.0, 60.0, 30.0, 10.0, 20.0, 40.0, 80.0, 60.0, 60.0, 90.0, 100.0, 10.0, 10.0, 30.0, 50.0, 170.0, 140.0, 140.0, 120.0, 30.0, 140.0, 110.0, 150.0, 10.0, 70.0, 60.0, 180.0, 0.0, 30.0, 100.0, 40.0, 60.0, 90.0, 130.0, 90.0, 80.0, 40.0, 90.0, 130.0, 60.0, 40.0, 10.0, 50.0, 50.0, 40.0, 100.0, 30.0, 110.0, 30.0, 240.0, -20.0, 120.0, 80.0, 320.0, 90.0, 90.0, 50.0, -40.0, 200.0, 60.0, 100.0, 70.0, 90.0, 170.0, 80.0, 10.0, 50.0, 100.0, 40.0, 70.0, 90.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 60.0, 290.0, 110.0, 120.0, 60.0, 90.0, 210.0, 30.0, 100.0, 70.0, 80.0, -40.0, -20.0, 50.0, 110.0, 10.0, 30.0, 80.0, 480.0, 170.0, -30.0, 10.0, 0.0, 10.0, 15.0, 0.0, 30.0, 20.0, 20.0, 20.0, 40.0, 20.0, 20.0, 60.0, 20.0, 50.0, 30.0, 10.0, 10.0, 20.0, 20.0, 100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0, 60.0, 0.0, 40.0, 40.0, 50.0, 0.0, 10.0, 40.0, 160.0, 0.0, 170.0, 40.0, 40.0, 70.0, 200.0, 80.0, 50.0, 90.0, 60.0, 40.0, 60.0, 40.0, 70.0, 90.0, 40.0, 60.0, 260.0, 40.0, 10.0, 40.0, 20.0, 190.0, 20.0, 50.0, 100.0, 170.0, 20.0, 40.0, 40.0, 20.0, 70.0, 50.0, 40.0, 90.0, 100.0, 30.0, 60.0, 100.0, 20.0, 160.0, 30.0, 100.0, 30.0, 40.0, 100.0, 30.0, 40.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 40.0, 150.0, 0.0, 30.0, 40.0, 40.0, 40.0, 10.0, 30.0, 0.0, 90.0, 40.0, 30.0, 30.0, -25.0, 40.0, 30.0, 40.0, 40.0, 60.0, 200.0, 120.0, 170.0, 80.0, 60.0, 30.0, 120.0, 40.0, 70.0, 20.0, 70.0, 90.0, 80.0, 40.0, 100.0, 140.0, 90.0, 60.0, 160.0, 70.0, 0.0, 40.0, 20.0, 80.0, 10.0, 60.0, 90.0, 240.0, 120.0, 110.0, 70.0, 70.0, 60.0, 200.0, 220.0, 60.0, 50.0, 30.0, 20.0, 40.0, 40.0, 20.0, 70.0, 30.0, 20.0, 0.0, 50.0, 70.0, 60.0, 50.0, 160.0, 30.0, -20.0, 70.0, 70.0, 180.0, 40.0, 90.0, 25.0, 20.0, 50.0, 0.0, 30.0, 70.0, 230.0, 50.0, 190.0, 100.0, 90.0, 10.0, 10.0, 80.0, 50.0, 70.0, 190.0, 20.0, 30.0, 30.0, 40.0, 150.0, 40.0, 40.0, 20.0, 60.0, 60.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0, 60.0, 90.0, 70.0, 310.0, 40.0, 70.0, 100.0, 80.0, 160.0, 60.0, 100.0, 20.0, 210.0, 190.0, 150.0, 140.0, 60.0, 60.0, 210.0, 50.0, 70.0, 10.0, 20.0, 0.0, 100.0, 50.0, 50.0, 50.0, 40.0, 20.0, 30.0, 60.0, 100.0, 70.0, 100.0, 60.0, 120.0, 50.0, 70.0, 60.0, 80.0, 60.0, 30.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 50.0, 120.0, 150.0, 70.0, 30.0, 140.0, 180.0, 10.0, 130.0, -60.0, 75.0, 140.0, 80.0, 80.0, 70.0, 40.0, 160.0, 60.0, 60.0, 30.0, 160.0, 250.0, 360.0, 190.0, 30.0, 90.0, 60.0, 90.0, 40.0, 70.0, 100.0, 90.0, 70.0, 10.0, 70.0, 160.0, 30.0, 60.0, 20.0, 0.0, 50.0, 160.0, 20.0, 40.0, 50.0, 220.0, 60.0, 20.0, 10.0, 0.0, 90.0, 160.0, 170.0, 40.0, 10.0, 20.0, 40.0, 50.0, 50.0, 80.0, 30.0, 40.0, 40.0, 20.0, 110.0, 10.0, 100.0, 10.0, 80.0, 40.0, 80.0, 50.0, 40.0, 30.0, 20.0, 140.0, 30.0, 30.0, 110.0, 30.0, 60.0, 50.0, 105.0, -20.0, 30.0, 40.0, 170.0, 320.0, 100.0, 160.0, 130.0, 10.0, 90.0, 90.0, 100.0, 190.0, 20.0, 100.0, 30.0, 10.0, 100.0, 40.0, 70.0, 60.0, 150.0, -30.0, 30.0, 0.0, 10.0, 0.0, 120.0, 10.0, 160.0, 85.0, 70.0, 20.0, 0.0, 370.0, 120.0, 100.0, 60.0, -30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0, 30.0, 130.0, 70.0, 60.0, 20.0, 20.0, 30.0, 90.0, 0.0, 70.0, 50.0, 25.0, 235.0, 10.0, 210.0, 100.0, -5.0, 120.0, 310.0, 40.0, 70.0, 90.0, 120.0, 50.0, 40.0, 20.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 40.0, 30.0, 50.0, 10.0, 300.0, 50.0, 110.0, -80.0, 60.0, 40.0, 60.0, 90.0, 130.0, 240.0, 70.0, 230.0, 20.0, 50.0, 110.0, 60.0, 20.0, 10.0, 0.0, 50.0, 40.0, 160.0, 110.0, 60.0, 150.0, 170.0, 40.0, 60.0, 20.0, 180.0, 30.0, 20.0, 70.0, 10.0, 50.0, -20.0, 190.0, 40.0, 30.0, 20.0, 20.0, 40.0, 90.0, 60.0, 160.0, 30.0, 10.0, 80.0, 40.0, 510.0, 130.0, 130.0, 70.0, 70.0, 40.0, 90.0, 70.0, 220.0, 60.0, 40.0, 60.0, 40.0, 40.0, 200.0, 80.0, 170.0, 110.0, 130.0, 30.0, 60.0, 35.0, 50.0, 80.0, 80.0, 20.0, 60.0, 70.0, 40.0, 0.0, 20.0, 80.0, 10.0, 120.0, 30.0, 70.0, 200.0, 190.0, 90.0, 70.0, 80.0, 20.0, 30.0, 50.0, 30.0, 0.0, 160.0, 50.0, 50.0, 10.0, 20.0, 120.0, 40.0, 200.0, 50.0, 290.0, 10.0, 160.0, 20.0, 120.0, 180.0, 30.0, 40.0, 150.0, 90.0, 80.0, 0.0, 80.0, 80.0, 60.0, 0.0, -5.0, 0.0, 120.0, 60.0, 100.0, 80.0, 40.0, 410.0, 40.0, 120.0, 80.0, 0.0, 40.0, 70.0, 40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0, 30.0, 170.0, 0.0, 150.0, 0.0, 120.0, 10.0, 20.0, 50.0, 100.0, 40.0, 60.0, 60.0, 110.0, 40.0, 40.0, 70.0, 60.0, 130.0, 160.0, 70.0, 100.0, 200.0, 60.0, 150.0, 30.0, 80.0, 120.0, 0.0, -80.0, 20.0, 20.0, 120.0, 30.0, 50.0, 15.0, 10.0, 50.0, 20.0, 30.0, 50.0, 180.0, 40.0, 60.0, 110.0, 60.0, 140.0, -30.0, 280.0, -30.0, 160.0, 30.0, 50.0, 10.0, 40.0, 70.0, 120.0, 60.0, 90.0, 70.0, 70.0, 90.0, 70.0, 70.0, 70.0, 120.0, 100.0, 60.0, 150.0, 300.0, 180.0, 30.0, 260.0, 130.0, 50.0, 0.0, 120.0, 70.0, 10.0, 10.0, 90.0, 80.0, 50.0, 0.0, 30.0, 0.0, 30.0, 10.0, 130.0, 0.0, -10.0, 10.0, 40.0, 120.0, 80.0, 50.0, 60.0, 80.0, 60.0, 40.0, 55.0, 290.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 40.0, 0.0, 0.0, 30.0, 60.0, 50.0, 160.0, 20.0, 120.0, 60.0, 60.0, 160.0, 50.0, 40.0, 80.0, 130.0, 90.0, 30.0, 170.0, 290.0, 300.0, -300.0, 20.0, 110.0, 180.0, 50.0, 30.0, 50.0, 40.0, 110.0, 40.0, 20.0, 200.0, 40.0, 70.0, 30.0, 40.0, 25.0, 30.0, 20.0, 0.0, 10.0, 50.0, 50.0, 0.0, 20.0, 70.0, 250.0, 60.0, 10.0, 0.0, 70.0, 40.0, 100.0, 120.0, 70.0, 270.0, 30.0, 0.0, 80.0, 20.0, 120.0, 180.0, 60.0, 30.0, 30.0, 30.0, 40.0, 10.0, 80.0, 80.0, 250.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6017437038285292, "mean_inference_ms": 1.4084071603789858, "mean_action_processing_ms": 0.4427238437445681, "mean_env_wait_ms": 1.2851291657823631, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013722658157348633, "StateBufferConnector_ms": 0.010287046432495117, "ViewRequirementAgentConnector_ms": 0.4184248447418213}, "num_episodes": 18, "episode_return_max": 1280.0, "episode_return_min": 165.0, "episode_return_mean": 700.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.37481721912721, "num_env_steps_trained_throughput_per_sec": 21.37481721912721, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 188283.231, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188283.185, "sample_time_ms": 2579.124, "learn_time_ms": 185685.25, "learn_throughput": 21.542, "synch_weights_time_ms": 10.825}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "33e63_00000", "date": "2024-06-18_22-35-07", "timestamp": 1718764507, "time_this_iter_s": 187.14624285697937, "time_total_s": 5290.952839612961, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3271a8ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5290.952839612961, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 25.947348484848487, "ram_util_percent": 79.49772727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5389941335676576, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.055265178619482, "policy_loss": -0.010160272026432557, "vf_loss": 7.063968278297855, "vf_explained_var": 0.0021128752614997318, "kl": 0.0072858653675532395, "entropy": 0.8899998178179906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 250.0, "episode_reward_mean": 743.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 74.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 400.0, 840.0, 710.0, 670.0, 720.0, 530.0, 340.0, 275.0, 920.0, 740.0, 590.0, 1200.0, 320.0, 710.0, 755.0, 650.0, 560.0, 930.0, 1040.0, 1190.0, 410.0, 720.0, 530.0, 845.0, 880.0, 1280.0, 560.0, 670.0, 650.0, 530.0, 540.0, 1085.0, 740.0, 450.0, 995.0, 760.0, 520.0, 1095.0, 560.0, 530.0, 990.0, 620.0, 750.0, 520.0, 1230.0, 860.0, 825.0, 450.0, 830.0, 700.0, 1090.0, 475.0, 980.0, 980.0, 650.0, 770.0, 730.0, 365.0, 860.0, 700.0, 1100.0, 860.0, 420.0, 530.0, 725.0, 720.0, 880.0, 650.0, 465.0, 580.0, 850.0, 790.0, 450.0, 970.0, 710.0, 500.0, 760.0, 1330.0, 900.0, 755.0, 725.0, 495.0, 1100.0, 805.0, 345.0, 250.0, 1000.0, 870.0, 580.0, 890.0, 790.0, 1120.0, 1130.0, 690.0, 460.0, 720.0, 1130.0, 500.0, 1180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 110.0, 20.0, 120.0, 40.0, 110.0, 70.0, 50.0, 50.0, 130.0, 60.0, 0.0, 40.0, 40.0, 50.0, 0.0, 10.0, 40.0, 160.0, 0.0, 170.0, 40.0, 40.0, 70.0, 200.0, 80.0, 50.0, 90.0, 60.0, 40.0, 60.0, 40.0, 70.0, 90.0, 40.0, 60.0, 260.0, 40.0, 10.0, 40.0, 20.0, 190.0, 20.0, 50.0, 100.0, 170.0, 20.0, 40.0, 40.0, 20.0, 70.0, 50.0, 40.0, 90.0, 100.0, 30.0, 60.0, 100.0, 20.0, 160.0, 30.0, 100.0, 30.0, 40.0, 100.0, 30.0, 40.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 40.0, 150.0, 0.0, 30.0, 40.0, 40.0, 40.0, 10.0, 30.0, 0.0, 90.0, 40.0, 30.0, 30.0, -25.0, 40.0, 30.0, 40.0, 40.0, 60.0, 200.0, 120.0, 170.0, 80.0, 60.0, 30.0, 120.0, 40.0, 70.0, 20.0, 70.0, 90.0, 80.0, 40.0, 100.0, 140.0, 90.0, 60.0, 160.0, 70.0, 0.0, 40.0, 20.0, 80.0, 10.0, 60.0, 90.0, 240.0, 120.0, 110.0, 70.0, 70.0, 60.0, 200.0, 220.0, 60.0, 50.0, 30.0, 20.0, 40.0, 40.0, 20.0, 70.0, 30.0, 20.0, 0.0, 50.0, 70.0, 60.0, 50.0, 160.0, 30.0, -20.0, 70.0, 70.0, 180.0, 40.0, 90.0, 25.0, 20.0, 50.0, 0.0, 30.0, 70.0, 230.0, 50.0, 190.0, 100.0, 90.0, 10.0, 10.0, 80.0, 50.0, 70.0, 190.0, 20.0, 30.0, 30.0, 40.0, 150.0, 40.0, 40.0, 20.0, 60.0, 60.0, 40.0, 80.0, 170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0, 60.0, 90.0, 70.0, 310.0, 40.0, 70.0, 100.0, 80.0, 160.0, 60.0, 100.0, 20.0, 210.0, 190.0, 150.0, 140.0, 60.0, 60.0, 210.0, 50.0, 70.0, 10.0, 20.0, 0.0, 100.0, 50.0, 50.0, 50.0, 40.0, 20.0, 30.0, 60.0, 100.0, 70.0, 100.0, 60.0, 120.0, 50.0, 70.0, 60.0, 80.0, 60.0, 30.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 50.0, 120.0, 150.0, 70.0, 30.0, 140.0, 180.0, 10.0, 130.0, -60.0, 75.0, 140.0, 80.0, 80.0, 70.0, 40.0, 160.0, 60.0, 60.0, 30.0, 160.0, 250.0, 360.0, 190.0, 30.0, 90.0, 60.0, 90.0, 40.0, 70.0, 100.0, 90.0, 70.0, 10.0, 70.0, 160.0, 30.0, 60.0, 20.0, 0.0, 50.0, 160.0, 20.0, 40.0, 50.0, 220.0, 60.0, 20.0, 10.0, 0.0, 90.0, 160.0, 170.0, 40.0, 10.0, 20.0, 40.0, 50.0, 50.0, 80.0, 30.0, 40.0, 40.0, 20.0, 110.0, 10.0, 100.0, 10.0, 80.0, 40.0, 80.0, 50.0, 40.0, 30.0, 20.0, 140.0, 30.0, 30.0, 110.0, 30.0, 60.0, 50.0, 105.0, -20.0, 30.0, 40.0, 170.0, 320.0, 100.0, 160.0, 130.0, 10.0, 90.0, 90.0, 100.0, 190.0, 20.0, 100.0, 30.0, 10.0, 100.0, 40.0, 70.0, 60.0, 150.0, -30.0, 30.0, 0.0, 10.0, 0.0, 120.0, 10.0, 160.0, 85.0, 70.0, 20.0, 0.0, 370.0, 120.0, 100.0, 60.0, -30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0, 30.0, 130.0, 70.0, 60.0, 20.0, 20.0, 30.0, 90.0, 0.0, 70.0, 50.0, 25.0, 235.0, 10.0, 210.0, 100.0, -5.0, 120.0, 310.0, 40.0, 70.0, 90.0, 120.0, 50.0, 40.0, 20.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 40.0, 30.0, 50.0, 10.0, 300.0, 50.0, 110.0, -80.0, 60.0, 40.0, 60.0, 90.0, 130.0, 240.0, 70.0, 230.0, 20.0, 50.0, 110.0, 60.0, 20.0, 10.0, 0.0, 50.0, 40.0, 160.0, 110.0, 60.0, 150.0, 170.0, 40.0, 60.0, 20.0, 180.0, 30.0, 20.0, 70.0, 10.0, 50.0, -20.0, 190.0, 40.0, 30.0, 20.0, 20.0, 40.0, 90.0, 60.0, 160.0, 30.0, 10.0, 80.0, 40.0, 510.0, 130.0, 130.0, 70.0, 70.0, 40.0, 90.0, 70.0, 220.0, 60.0, 40.0, 60.0, 40.0, 40.0, 200.0, 80.0, 170.0, 110.0, 130.0, 30.0, 60.0, 35.0, 50.0, 80.0, 80.0, 20.0, 60.0, 70.0, 40.0, 0.0, 20.0, 80.0, 10.0, 120.0, 30.0, 70.0, 200.0, 190.0, 90.0, 70.0, 80.0, 20.0, 30.0, 50.0, 30.0, 0.0, 160.0, 50.0, 50.0, 10.0, 20.0, 120.0, 40.0, 200.0, 50.0, 290.0, 10.0, 160.0, 20.0, 120.0, 180.0, 30.0, 40.0, 150.0, 90.0, 80.0, 0.0, 80.0, 80.0, 60.0, 0.0, -5.0, 0.0, 120.0, 60.0, 100.0, 80.0, 40.0, 410.0, 40.0, 120.0, 80.0, 0.0, 40.0, 70.0, 40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0, 30.0, 170.0, 0.0, 150.0, 0.0, 120.0, 10.0, 20.0, 50.0, 100.0, 40.0, 60.0, 60.0, 110.0, 40.0, 40.0, 70.0, 60.0, 130.0, 160.0, 70.0, 100.0, 200.0, 60.0, 150.0, 30.0, 80.0, 120.0, 0.0, -80.0, 20.0, 20.0, 120.0, 30.0, 50.0, 15.0, 10.0, 50.0, 20.0, 30.0, 50.0, 180.0, 40.0, 60.0, 110.0, 60.0, 140.0, -30.0, 280.0, -30.0, 160.0, 30.0, 50.0, 10.0, 40.0, 70.0, 120.0, 60.0, 90.0, 70.0, 70.0, 90.0, 70.0, 70.0, 70.0, 120.0, 100.0, 60.0, 150.0, 300.0, 180.0, 30.0, 260.0, 130.0, 50.0, 0.0, 120.0, 70.0, 10.0, 10.0, 90.0, 80.0, 50.0, 0.0, 30.0, 0.0, 30.0, 10.0, 130.0, 0.0, -10.0, 10.0, 40.0, 120.0, 80.0, 50.0, 60.0, 80.0, 60.0, 40.0, 55.0, 290.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 40.0, 0.0, 0.0, 30.0, 60.0, 50.0, 160.0, 20.0, 120.0, 60.0, 60.0, 160.0, 50.0, 40.0, 80.0, 130.0, 90.0, 30.0, 170.0, 290.0, 300.0, -300.0, 20.0, 110.0, 180.0, 50.0, 30.0, 50.0, 40.0, 110.0, 40.0, 20.0, 200.0, 40.0, 70.0, 30.0, 40.0, 25.0, 30.0, 20.0, 0.0, 10.0, 50.0, 50.0, 0.0, 20.0, 70.0, 250.0, 60.0, 10.0, 0.0, 70.0, 40.0, 100.0, 120.0, 70.0, 270.0, 30.0, 0.0, 80.0, 20.0, 120.0, 180.0, 60.0, 30.0, 30.0, 30.0, 40.0, 10.0, 80.0, 80.0, 250.0, 80.0, 40.0, 20.0, 100.0, 50.0, 120.0, 0.0, 10.0, 0.0, 30.0, 160.0, 20.0, 150.0, 210.0, 50.0, 170.0, 40.0, 90.0, 70.0, 10.0, 160.0, 50.0, 0.0, 50.0, 30.0, 30.0, 170.0, 20.0, 160.0, 40.0, 60.0, 60.0, 20.0, 10.0, 20.0, 120.0, 70.0, 20.0, 80.0, 40.0, 20.0, 40.0, 270.0, 40.0, 40.0, 190.0, 60.0, 20.0, 40.0, 40.0, 400.0, 160.0, 80.0, 100.0, 70.0, 150.0, 290.0, 50.0, 60.0, -30.0, 250.0, 40.0, 110.0, 70.0, 20.0, 190.0, 50.0, 30.0, 40.0, 100.0, 200.0, 0.0, 120.0, 40.0, 20.0, 190.0, 45.0, 50.0, 50.0, 40.0, 120.0, 40.0, 40.0, 30.0, 0.0, 75.0, 20.0, 10.0, 0.0, 390.0, 80.0, 30.0, 40.0, 130.0, 75.0, 20.0, 40.0, 20.0, 10.0, 50.0, 40.0, 30.0, 70.0, 530.0, 120.0, 50.0, 50.0, 30.0, 60.0, 120.0, 70.0, 45.0, 80.0, 270.0, 40.0, 40.0, 10.0, -20.0, 70.0, 200.0, 20.0, 10.0, 10.0, 180.0, 15.0, 50.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 10.0, 10.0, 70.0, 0.0, 30.0, 20.0, 10.0, 210.0, 20.0, 40.0, 80.0, 90.0, 40.0, 200.0, 70.0, 60.0, 190.0, 40.0, 140.0, 60.0, 0.0, 160.0, 80.0, 0.0, 210.0, 140.0, 40.0, 50.0, 30.0, 30.0, 0.0, 50.0, 160.0, 0.0, 80.0, 10.0, 170.0, 90.0, 190.0, 70.0, 10.0, 70.0, 50.0, 80.0, 60.0, 200.0, 70.0, 60.0, 0.0, 260.0, 40.0, 100.0, 0.0, 240.0, 20.0, 70.0, 0.0, 130.0, 50.0, 60.0, 110.0, 350.0, 170.0, 100.0, 30.0, 30.0, 90.0, 60.0, 0.0, 40.0, 250.0, 70.0, 40.0, 30.0, 450.0, 50.0, 140.0, 40.0, 60.0, 30.0, 80.0, 80.0, 370.0, -20.0, 30.0, 20.0, 0.0, 60.0, 50.0, 30.0, 180.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, -30.0, 20.0, 50.0, 160.0, 270.0, 40.0, 10.0, 60.0, 100.0, 40.0, 50.0, 30.0, 400.0, 70.0, 170.0, 110.0, 80.0, 120.0, 30.0, 70.0, 10.0, 40.0, 110.0, 20.0, 40.0, 30.0, 20.0, 50.0, 120.0, 60.0, 60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5980569337619517, "mean_inference_ms": 1.4085592147121404, "mean_action_processing_ms": 0.4627071422653918, "mean_env_wait_ms": 1.2830295541701744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013394594192504883, "StateBufferConnector_ms": 0.010318756103515625, "ViewRequirementAgentConnector_ms": 0.41841864585876465}, "num_episodes": 27, "episode_return_max": 1330.0, "episode_return_min": 250.0, "episode_return_mean": 743.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.328358175503766, "num_env_steps_trained_throughput_per_sec": 21.328358175503766, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 188147.463, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188147.417, "sample_time_ms": 2571.662, "learn_time_ms": 185556.867, "learn_throughput": 21.557, "synch_weights_time_ms": 10.843}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "33e63_00000", "date": "2024-06-18_22-38-15", "timestamp": 1718764695, "time_this_iter_s": 187.55345487594604, "time_total_s": 5478.506294488907, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327157d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5478.506294488907, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 25.50075471698113, "ram_util_percent": 79.28981132075471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4182146191977845, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.097307025992706, "policy_loss": -0.010798427837536819, "vf_loss": 7.106612861042206, "vf_explained_var": 0.0011715015156454425, "kl": 0.007463003179055723, "entropy": 0.8614400665790509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 250.0, "episode_reward_mean": 780.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 78.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [930.0, 1040.0, 1190.0, 410.0, 720.0, 530.0, 845.0, 880.0, 1280.0, 560.0, 670.0, 650.0, 530.0, 540.0, 1085.0, 740.0, 450.0, 995.0, 760.0, 520.0, 1095.0, 560.0, 530.0, 990.0, 620.0, 750.0, 520.0, 1230.0, 860.0, 825.0, 450.0, 830.0, 700.0, 1090.0, 475.0, 980.0, 980.0, 650.0, 770.0, 730.0, 365.0, 860.0, 700.0, 1100.0, 860.0, 420.0, 530.0, 725.0, 720.0, 880.0, 650.0, 465.0, 580.0, 850.0, 790.0, 450.0, 970.0, 710.0, 500.0, 760.0, 1330.0, 900.0, 755.0, 725.0, 495.0, 1100.0, 805.0, 345.0, 250.0, 1000.0, 870.0, 580.0, 890.0, 790.0, 1120.0, 1130.0, 690.0, 460.0, 720.0, 1130.0, 500.0, 1180.0, 1515.0, 600.0, 1020.0, 945.0, 950.0, 735.0, 780.0, 530.0, 530.0, 1270.0, 950.0, 1410.0, 840.0, 415.0, 640.0, 650.0, 725.0, 970.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 60.0, 180.0, 70.0, 190.0, 50.0, 50.0, 30.0, 100.0, 30.0, 60.0, 90.0, 70.0, 310.0, 40.0, 70.0, 100.0, 80.0, 160.0, 60.0, 100.0, 20.0, 210.0, 190.0, 150.0, 140.0, 60.0, 60.0, 210.0, 50.0, 70.0, 10.0, 20.0, 0.0, 100.0, 50.0, 50.0, 50.0, 40.0, 20.0, 30.0, 60.0, 100.0, 70.0, 100.0, 60.0, 120.0, 50.0, 70.0, 60.0, 80.0, 60.0, 30.0, 70.0, 20.0, 70.0, 70.0, 10.0, 70.0, 50.0, 120.0, 150.0, 70.0, 30.0, 140.0, 180.0, 10.0, 130.0, -60.0, 75.0, 140.0, 80.0, 80.0, 70.0, 40.0, 160.0, 60.0, 60.0, 30.0, 160.0, 250.0, 360.0, 190.0, 30.0, 90.0, 60.0, 90.0, 40.0, 70.0, 100.0, 90.0, 70.0, 10.0, 70.0, 160.0, 30.0, 60.0, 20.0, 0.0, 50.0, 160.0, 20.0, 40.0, 50.0, 220.0, 60.0, 20.0, 10.0, 0.0, 90.0, 160.0, 170.0, 40.0, 10.0, 20.0, 40.0, 50.0, 50.0, 80.0, 30.0, 40.0, 40.0, 20.0, 110.0, 10.0, 100.0, 10.0, 80.0, 40.0, 80.0, 50.0, 40.0, 30.0, 20.0, 140.0, 30.0, 30.0, 110.0, 30.0, 60.0, 50.0, 105.0, -20.0, 30.0, 40.0, 170.0, 320.0, 100.0, 160.0, 130.0, 10.0, 90.0, 90.0, 100.0, 190.0, 20.0, 100.0, 30.0, 10.0, 100.0, 40.0, 70.0, 60.0, 150.0, -30.0, 30.0, 0.0, 10.0, 0.0, 120.0, 10.0, 160.0, 85.0, 70.0, 20.0, 0.0, 370.0, 120.0, 100.0, 60.0, -30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0, 30.0, 130.0, 70.0, 60.0, 20.0, 20.0, 30.0, 90.0, 0.0, 70.0, 50.0, 25.0, 235.0, 10.0, 210.0, 100.0, -5.0, 120.0, 310.0, 40.0, 70.0, 90.0, 120.0, 50.0, 40.0, 20.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 40.0, 30.0, 50.0, 10.0, 300.0, 50.0, 110.0, -80.0, 60.0, 40.0, 60.0, 90.0, 130.0, 240.0, 70.0, 230.0, 20.0, 50.0, 110.0, 60.0, 20.0, 10.0, 0.0, 50.0, 40.0, 160.0, 110.0, 60.0, 150.0, 170.0, 40.0, 60.0, 20.0, 180.0, 30.0, 20.0, 70.0, 10.0, 50.0, -20.0, 190.0, 40.0, 30.0, 20.0, 20.0, 40.0, 90.0, 60.0, 160.0, 30.0, 10.0, 80.0, 40.0, 510.0, 130.0, 130.0, 70.0, 70.0, 40.0, 90.0, 70.0, 220.0, 60.0, 40.0, 60.0, 40.0, 40.0, 200.0, 80.0, 170.0, 110.0, 130.0, 30.0, 60.0, 35.0, 50.0, 80.0, 80.0, 20.0, 60.0, 70.0, 40.0, 0.0, 20.0, 80.0, 10.0, 120.0, 30.0, 70.0, 200.0, 190.0, 90.0, 70.0, 80.0, 20.0, 30.0, 50.0, 30.0, 0.0, 160.0, 50.0, 50.0, 10.0, 20.0, 120.0, 40.0, 200.0, 50.0, 290.0, 10.0, 160.0, 20.0, 120.0, 180.0, 30.0, 40.0, 150.0, 90.0, 80.0, 0.0, 80.0, 80.0, 60.0, 0.0, -5.0, 0.0, 120.0, 60.0, 100.0, 80.0, 40.0, 410.0, 40.0, 120.0, 80.0, 0.0, 40.0, 70.0, 40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0, 30.0, 170.0, 0.0, 150.0, 0.0, 120.0, 10.0, 20.0, 50.0, 100.0, 40.0, 60.0, 60.0, 110.0, 40.0, 40.0, 70.0, 60.0, 130.0, 160.0, 70.0, 100.0, 200.0, 60.0, 150.0, 30.0, 80.0, 120.0, 0.0, -80.0, 20.0, 20.0, 120.0, 30.0, 50.0, 15.0, 10.0, 50.0, 20.0, 30.0, 50.0, 180.0, 40.0, 60.0, 110.0, 60.0, 140.0, -30.0, 280.0, -30.0, 160.0, 30.0, 50.0, 10.0, 40.0, 70.0, 120.0, 60.0, 90.0, 70.0, 70.0, 90.0, 70.0, 70.0, 70.0, 120.0, 100.0, 60.0, 150.0, 300.0, 180.0, 30.0, 260.0, 130.0, 50.0, 0.0, 120.0, 70.0, 10.0, 10.0, 90.0, 80.0, 50.0, 0.0, 30.0, 0.0, 30.0, 10.0, 130.0, 0.0, -10.0, 10.0, 40.0, 120.0, 80.0, 50.0, 60.0, 80.0, 60.0, 40.0, 55.0, 290.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 40.0, 0.0, 0.0, 30.0, 60.0, 50.0, 160.0, 20.0, 120.0, 60.0, 60.0, 160.0, 50.0, 40.0, 80.0, 130.0, 90.0, 30.0, 170.0, 290.0, 300.0, -300.0, 20.0, 110.0, 180.0, 50.0, 30.0, 50.0, 40.0, 110.0, 40.0, 20.0, 200.0, 40.0, 70.0, 30.0, 40.0, 25.0, 30.0, 20.0, 0.0, 10.0, 50.0, 50.0, 0.0, 20.0, 70.0, 250.0, 60.0, 10.0, 0.0, 70.0, 40.0, 100.0, 120.0, 70.0, 270.0, 30.0, 0.0, 80.0, 20.0, 120.0, 180.0, 60.0, 30.0, 30.0, 30.0, 40.0, 10.0, 80.0, 80.0, 250.0, 80.0, 40.0, 20.0, 100.0, 50.0, 120.0, 0.0, 10.0, 0.0, 30.0, 160.0, 20.0, 150.0, 210.0, 50.0, 170.0, 40.0, 90.0, 70.0, 10.0, 160.0, 50.0, 0.0, 50.0, 30.0, 30.0, 170.0, 20.0, 160.0, 40.0, 60.0, 60.0, 20.0, 10.0, 20.0, 120.0, 70.0, 20.0, 80.0, 40.0, 20.0, 40.0, 270.0, 40.0, 40.0, 190.0, 60.0, 20.0, 40.0, 40.0, 400.0, 160.0, 80.0, 100.0, 70.0, 150.0, 290.0, 50.0, 60.0, -30.0, 250.0, 40.0, 110.0, 70.0, 20.0, 190.0, 50.0, 30.0, 40.0, 100.0, 200.0, 0.0, 120.0, 40.0, 20.0, 190.0, 45.0, 50.0, 50.0, 40.0, 120.0, 40.0, 40.0, 30.0, 0.0, 75.0, 20.0, 10.0, 0.0, 390.0, 80.0, 30.0, 40.0, 130.0, 75.0, 20.0, 40.0, 20.0, 10.0, 50.0, 40.0, 30.0, 70.0, 530.0, 120.0, 50.0, 50.0, 30.0, 60.0, 120.0, 70.0, 45.0, 80.0, 270.0, 40.0, 40.0, 10.0, -20.0, 70.0, 200.0, 20.0, 10.0, 10.0, 180.0, 15.0, 50.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 10.0, 10.0, 70.0, 0.0, 30.0, 20.0, 10.0, 210.0, 20.0, 40.0, 80.0, 90.0, 40.0, 200.0, 70.0, 60.0, 190.0, 40.0, 140.0, 60.0, 0.0, 160.0, 80.0, 0.0, 210.0, 140.0, 40.0, 50.0, 30.0, 30.0, 0.0, 50.0, 160.0, 0.0, 80.0, 10.0, 170.0, 90.0, 190.0, 70.0, 10.0, 70.0, 50.0, 80.0, 60.0, 200.0, 70.0, 60.0, 0.0, 260.0, 40.0, 100.0, 0.0, 240.0, 20.0, 70.0, 0.0, 130.0, 50.0, 60.0, 110.0, 350.0, 170.0, 100.0, 30.0, 30.0, 90.0, 60.0, 0.0, 40.0, 250.0, 70.0, 40.0, 30.0, 450.0, 50.0, 140.0, 40.0, 60.0, 30.0, 80.0, 80.0, 370.0, -20.0, 30.0, 20.0, 0.0, 60.0, 50.0, 30.0, 180.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, -30.0, 20.0, 50.0, 160.0, 270.0, 40.0, 10.0, 60.0, 100.0, 40.0, 50.0, 30.0, 400.0, 70.0, 170.0, 110.0, 80.0, 120.0, 30.0, 70.0, 10.0, 40.0, 110.0, 20.0, 40.0, 30.0, 20.0, 50.0, 120.0, 60.0, 60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0, 390.0, 85.0, 90.0, 150.0, 70.0, 110.0, 160.0, 60.0, 330.0, 70.0, 0.0, 30.0, 70.0, 10.0, 210.0, 40.0, 180.0, 10.0, 40.0, 10.0, 60.0, 90.0, 80.0, 80.0, 230.0, 100.0, 90.0, 10.0, 100.0, 180.0, -20.0, 150.0, 160.0, 40.0, 80.0, -45.0, 150.0, 40.0, 270.0, 120.0, 60.0, 180.0, 50.0, 90.0, 10.0, 130.0, 200.0, 40.0, 70.0, 120.0, 100.0, 90.0, 40.0, 20.0, 80.0, 130.0, 45.0, 60.0, 110.0, 60.0, 200.0, 20.0, 20.0, 40.0, 170.0, 50.0, 70.0, 150.0, -40.0, 100.0, 40.0, 60.0, 20.0, 40.0, 60.0, 90.0, 80.0, 110.0, 10.0, 20.0, 60.0, 20.0, 0.0, 20.0, 50.0, 10.0, 40.0, 170.0, 40.0, 120.0, 80.0, 130.0, 60.0, 260.0, 70.0, 410.0, 90.0, 70.0, 30.0, 70.0, 200.0, -50.0, 40.0, 160.0, 40.0, 80.0, 260.0, 110.0, 30.0, 80.0, 0.0, 450.0, 90.0, 240.0, 100.0, 110.0, 90.0, 170.0, 50.0, 110.0, 210.0, -10.0, 180.0, 20.0, 120.0, 110.0, 110.0, 0.0, 70.0, 30.0, 40.0, 60.0, 30.0, 0.0, 15.0, 40.0, 0.0, 110.0, 40.0, 80.0, 100.0, 20.0, 40.0, 150.0, 30.0, 130.0, 0.0, 40.0, 120.0, 10.0, 40.0, 90.0, 50.0, 60.0, 30.0, 40.0, 60.0, 40.0, 190.0, 50.0, 40.0, 70.0, 20.0, 15.0, 200.0, 190.0, 20.0, 10.0, 50.0, 110.0, 20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5945838367958987, "mean_inference_ms": 1.4084839537430835, "mean_action_processing_ms": 0.47554430527344044, "mean_env_wait_ms": 1.2818076989819087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0135955810546875, "StateBufferConnector_ms": 0.010126829147338867, "ViewRequirementAgentConnector_ms": 0.4158205986022949}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": 250.0, "episode_return_mean": 780.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.467453489570058, "num_env_steps_trained_throughput_per_sec": 21.467453489570058, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 187863.67, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187863.62, "sample_time_ms": 2569.312, "learn_time_ms": 185275.165, "learn_throughput": 21.59, "synch_weights_time_ms": 10.923}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "33e63_00000", "date": "2024-06-18_22-41-21", "timestamp": 1718764881, "time_this_iter_s": 186.34861493110657, "time_total_s": 5664.854909420013, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272c6ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5664.854909420013, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 25.145454545454545, "ram_util_percent": 79.36628787878787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4041661411365127, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.2984480150972315, "policy_loss": -0.010004460895200943, "vf_loss": 6.306937539818696, "vf_explained_var": 0.001756807415884016, "kl": 0.007574609871539024, "entropy": 0.8738748096937315, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 250.0, "episode_reward_mean": 777.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 77.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 520.0, 1095.0, 560.0, 530.0, 990.0, 620.0, 750.0, 520.0, 1230.0, 860.0, 825.0, 450.0, 830.0, 700.0, 1090.0, 475.0, 980.0, 980.0, 650.0, 770.0, 730.0, 365.0, 860.0, 700.0, 1100.0, 860.0, 420.0, 530.0, 725.0, 720.0, 880.0, 650.0, 465.0, 580.0, 850.0, 790.0, 450.0, 970.0, 710.0, 500.0, 760.0, 1330.0, 900.0, 755.0, 725.0, 495.0, 1100.0, 805.0, 345.0, 250.0, 1000.0, 870.0, 580.0, 890.0, 790.0, 1120.0, 1130.0, 690.0, 460.0, 720.0, 1130.0, 500.0, 1180.0, 1515.0, 600.0, 1020.0, 945.0, 950.0, 735.0, 780.0, 530.0, 530.0, 1270.0, 950.0, 1410.0, 840.0, 415.0, 640.0, 650.0, 725.0, 970.0, 575.0, 340.0, 1430.0, 630.0, 1120.0, 1390.0, 730.0, 450.0, 620.0, 1165.0, 980.0, 685.0, 1040.0, 720.0, 350.0, 445.0, 665.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-30.0, 220.0, 70.0, 70.0, 90.0, 90.0, 50.0, 60.0, 90.0, 50.0, 30.0, 130.0, 70.0, 60.0, 20.0, 20.0, 30.0, 90.0, 0.0, 70.0, 50.0, 25.0, 235.0, 10.0, 210.0, 100.0, -5.0, 120.0, 310.0, 40.0, 70.0, 90.0, 120.0, 50.0, 40.0, 20.0, 90.0, 20.0, 20.0, 40.0, 0.0, 20.0, 40.0, 30.0, 50.0, 10.0, 300.0, 50.0, 110.0, -80.0, 60.0, 40.0, 60.0, 90.0, 130.0, 240.0, 70.0, 230.0, 20.0, 50.0, 110.0, 60.0, 20.0, 10.0, 0.0, 50.0, 40.0, 160.0, 110.0, 60.0, 150.0, 170.0, 40.0, 60.0, 20.0, 180.0, 30.0, 20.0, 70.0, 10.0, 50.0, -20.0, 190.0, 40.0, 30.0, 20.0, 20.0, 40.0, 90.0, 60.0, 160.0, 30.0, 10.0, 80.0, 40.0, 510.0, 130.0, 130.0, 70.0, 70.0, 40.0, 90.0, 70.0, 220.0, 60.0, 40.0, 60.0, 40.0, 40.0, 200.0, 80.0, 170.0, 110.0, 130.0, 30.0, 60.0, 35.0, 50.0, 80.0, 80.0, 20.0, 60.0, 70.0, 40.0, 0.0, 20.0, 80.0, 10.0, 120.0, 30.0, 70.0, 200.0, 190.0, 90.0, 70.0, 80.0, 20.0, 30.0, 50.0, 30.0, 0.0, 160.0, 50.0, 50.0, 10.0, 20.0, 120.0, 40.0, 200.0, 50.0, 290.0, 10.0, 160.0, 20.0, 120.0, 180.0, 30.0, 40.0, 150.0, 90.0, 80.0, 0.0, 80.0, 80.0, 60.0, 0.0, -5.0, 0.0, 120.0, 60.0, 100.0, 80.0, 40.0, 410.0, 40.0, 120.0, 80.0, 0.0, 40.0, 70.0, 40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0, 30.0, 170.0, 0.0, 150.0, 0.0, 120.0, 10.0, 20.0, 50.0, 100.0, 40.0, 60.0, 60.0, 110.0, 40.0, 40.0, 70.0, 60.0, 130.0, 160.0, 70.0, 100.0, 200.0, 60.0, 150.0, 30.0, 80.0, 120.0, 0.0, -80.0, 20.0, 20.0, 120.0, 30.0, 50.0, 15.0, 10.0, 50.0, 20.0, 30.0, 50.0, 180.0, 40.0, 60.0, 110.0, 60.0, 140.0, -30.0, 280.0, -30.0, 160.0, 30.0, 50.0, 10.0, 40.0, 70.0, 120.0, 60.0, 90.0, 70.0, 70.0, 90.0, 70.0, 70.0, 70.0, 120.0, 100.0, 60.0, 150.0, 300.0, 180.0, 30.0, 260.0, 130.0, 50.0, 0.0, 120.0, 70.0, 10.0, 10.0, 90.0, 80.0, 50.0, 0.0, 30.0, 0.0, 30.0, 10.0, 130.0, 0.0, -10.0, 10.0, 40.0, 120.0, 80.0, 50.0, 60.0, 80.0, 60.0, 40.0, 55.0, 290.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 40.0, 0.0, 0.0, 30.0, 60.0, 50.0, 160.0, 20.0, 120.0, 60.0, 60.0, 160.0, 50.0, 40.0, 80.0, 130.0, 90.0, 30.0, 170.0, 290.0, 300.0, -300.0, 20.0, 110.0, 180.0, 50.0, 30.0, 50.0, 40.0, 110.0, 40.0, 20.0, 200.0, 40.0, 70.0, 30.0, 40.0, 25.0, 30.0, 20.0, 0.0, 10.0, 50.0, 50.0, 0.0, 20.0, 70.0, 250.0, 60.0, 10.0, 0.0, 70.0, 40.0, 100.0, 120.0, 70.0, 270.0, 30.0, 0.0, 80.0, 20.0, 120.0, 180.0, 60.0, 30.0, 30.0, 30.0, 40.0, 10.0, 80.0, 80.0, 250.0, 80.0, 40.0, 20.0, 100.0, 50.0, 120.0, 0.0, 10.0, 0.0, 30.0, 160.0, 20.0, 150.0, 210.0, 50.0, 170.0, 40.0, 90.0, 70.0, 10.0, 160.0, 50.0, 0.0, 50.0, 30.0, 30.0, 170.0, 20.0, 160.0, 40.0, 60.0, 60.0, 20.0, 10.0, 20.0, 120.0, 70.0, 20.0, 80.0, 40.0, 20.0, 40.0, 270.0, 40.0, 40.0, 190.0, 60.0, 20.0, 40.0, 40.0, 400.0, 160.0, 80.0, 100.0, 70.0, 150.0, 290.0, 50.0, 60.0, -30.0, 250.0, 40.0, 110.0, 70.0, 20.0, 190.0, 50.0, 30.0, 40.0, 100.0, 200.0, 0.0, 120.0, 40.0, 20.0, 190.0, 45.0, 50.0, 50.0, 40.0, 120.0, 40.0, 40.0, 30.0, 0.0, 75.0, 20.0, 10.0, 0.0, 390.0, 80.0, 30.0, 40.0, 130.0, 75.0, 20.0, 40.0, 20.0, 10.0, 50.0, 40.0, 30.0, 70.0, 530.0, 120.0, 50.0, 50.0, 30.0, 60.0, 120.0, 70.0, 45.0, 80.0, 270.0, 40.0, 40.0, 10.0, -20.0, 70.0, 200.0, 20.0, 10.0, 10.0, 180.0, 15.0, 50.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 10.0, 10.0, 70.0, 0.0, 30.0, 20.0, 10.0, 210.0, 20.0, 40.0, 80.0, 90.0, 40.0, 200.0, 70.0, 60.0, 190.0, 40.0, 140.0, 60.0, 0.0, 160.0, 80.0, 0.0, 210.0, 140.0, 40.0, 50.0, 30.0, 30.0, 0.0, 50.0, 160.0, 0.0, 80.0, 10.0, 170.0, 90.0, 190.0, 70.0, 10.0, 70.0, 50.0, 80.0, 60.0, 200.0, 70.0, 60.0, 0.0, 260.0, 40.0, 100.0, 0.0, 240.0, 20.0, 70.0, 0.0, 130.0, 50.0, 60.0, 110.0, 350.0, 170.0, 100.0, 30.0, 30.0, 90.0, 60.0, 0.0, 40.0, 250.0, 70.0, 40.0, 30.0, 450.0, 50.0, 140.0, 40.0, 60.0, 30.0, 80.0, 80.0, 370.0, -20.0, 30.0, 20.0, 0.0, 60.0, 50.0, 30.0, 180.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, -30.0, 20.0, 50.0, 160.0, 270.0, 40.0, 10.0, 60.0, 100.0, 40.0, 50.0, 30.0, 400.0, 70.0, 170.0, 110.0, 80.0, 120.0, 30.0, 70.0, 10.0, 40.0, 110.0, 20.0, 40.0, 30.0, 20.0, 50.0, 120.0, 60.0, 60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0, 390.0, 85.0, 90.0, 150.0, 70.0, 110.0, 160.0, 60.0, 330.0, 70.0, 0.0, 30.0, 70.0, 10.0, 210.0, 40.0, 180.0, 10.0, 40.0, 10.0, 60.0, 90.0, 80.0, 80.0, 230.0, 100.0, 90.0, 10.0, 100.0, 180.0, -20.0, 150.0, 160.0, 40.0, 80.0, -45.0, 150.0, 40.0, 270.0, 120.0, 60.0, 180.0, 50.0, 90.0, 10.0, 130.0, 200.0, 40.0, 70.0, 120.0, 100.0, 90.0, 40.0, 20.0, 80.0, 130.0, 45.0, 60.0, 110.0, 60.0, 200.0, 20.0, 20.0, 40.0, 170.0, 50.0, 70.0, 150.0, -40.0, 100.0, 40.0, 60.0, 20.0, 40.0, 60.0, 90.0, 80.0, 110.0, 10.0, 20.0, 60.0, 20.0, 0.0, 20.0, 50.0, 10.0, 40.0, 170.0, 40.0, 120.0, 80.0, 130.0, 60.0, 260.0, 70.0, 410.0, 90.0, 70.0, 30.0, 70.0, 200.0, -50.0, 40.0, 160.0, 40.0, 80.0, 260.0, 110.0, 30.0, 80.0, 0.0, 450.0, 90.0, 240.0, 100.0, 110.0, 90.0, 170.0, 50.0, 110.0, 210.0, -10.0, 180.0, 20.0, 120.0, 110.0, 110.0, 0.0, 70.0, 30.0, 40.0, 60.0, 30.0, 0.0, 15.0, 40.0, 0.0, 110.0, 40.0, 80.0, 100.0, 20.0, 40.0, 150.0, 30.0, 130.0, 0.0, 40.0, 120.0, 10.0, 40.0, 90.0, 50.0, 60.0, 30.0, 40.0, 60.0, 40.0, 190.0, 50.0, 40.0, 70.0, 20.0, 15.0, 200.0, 190.0, 20.0, 10.0, 50.0, 110.0, 20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0, 40.0, 55.0, 150.0, 170.0, 0.0, 10.0, 30.0, 100.0, 30.0, -10.0, 10.0, 60.0, 70.0, 60.0, 70.0, 0.0, 50.0, 10.0, 10.0, 0.0, 190.0, 90.0, 10.0, 160.0, 0.0, 530.0, 40.0, 50.0, 30.0, 330.0, 270.0, 40.0, -40.0, 50.0, 70.0, 100.0, -50.0, 70.0, 20.0, 100.0, 150.0, 160.0, 20.0, 100.0, 100.0, 100.0, 120.0, 180.0, 70.0, 120.0, 180.0, 70.0, 120.0, 60.0, 110.0, 250.0, 290.0, 100.0, 70.0, 140.0, 10.0, 50.0, 130.0, -90.0, 50.0, 240.0, 10.0, 210.0, 30.0, 90.0, 20.0, 20.0, 60.0, 20.0, 20.0, 40.0, 180.0, 20.0, 30.0, 40.0, 100.0, 30.0, 40.0, 30.0, 40.0, 210.0, 60.0, 50.0, 60.0, 0.0, 60.0, 290.0, 80.0, 110.0, 45.0, 110.0, 180.0, 90.0, 110.0, 90.0, 150.0, 180.0, 60.0, 50.0, 90.0, 120.0, 70.0, 80.0, 110.0, 70.0, 10.0, 180.0, 10.0, 90.0, 170.0, 40.0, 45.0, 100.0, 20.0, 20.0, 100.0, 260.0, 60.0, 110.0, 110.0, 90.0, 70.0, 160.0, 0.0, 80.0, 210.0, 40.0, 20.0, 80.0, 30.0, 90.0, 10.0, 40.0, 90.0, 110.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 20.0, 0.0, 40.0, 150.0, 10.0, 40.0, 70.0, 0.0, 25.0, -50.0, 20.0, 210.0, 40.0, 80.0, 50.0, 280.0, 160.0, 130.0, 10.0, 10.0, 10.0, 0.0, 5.0, 10.0, 20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5893808231035527, "mean_inference_ms": 1.407711099016011, "mean_action_processing_ms": 0.4733399983418353, "mean_env_wait_ms": 1.2800145567117602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013473033905029297, "StateBufferConnector_ms": 0.01010441780090332, "ViewRequirementAgentConnector_ms": 0.411177396774292}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": 250.0, "episode_return_mean": 777.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.473930080872517, "num_env_steps_trained_throughput_per_sec": 21.473930080872517, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 187689.501, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187689.451, "sample_time_ms": 2557.18, "learn_time_ms": 185112.957, "learn_throughput": 21.608, "synch_weights_time_ms": 10.871}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "33e63_00000", "date": "2024-06-18_22-44-28", "timestamp": 1718765068, "time_this_iter_s": 186.28150820732117, "time_total_s": 5851.136417627335, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5851.136417627335, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 24.727376425855514, "ram_util_percent": 79.87262357414448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.453590156799688, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.048103124112748, "policy_loss": -0.010516013435055368, "vf_loss": 7.0570917849088755, "vf_explained_var": 0.0014135993136384617, "kl": 0.007636750281816075, "entropy": 0.8307679581883363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 250.0, "episode_reward_mean": 784.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 78.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [980.0, 650.0, 770.0, 730.0, 365.0, 860.0, 700.0, 1100.0, 860.0, 420.0, 530.0, 725.0, 720.0, 880.0, 650.0, 465.0, 580.0, 850.0, 790.0, 450.0, 970.0, 710.0, 500.0, 760.0, 1330.0, 900.0, 755.0, 725.0, 495.0, 1100.0, 805.0, 345.0, 250.0, 1000.0, 870.0, 580.0, 890.0, 790.0, 1120.0, 1130.0, 690.0, 460.0, 720.0, 1130.0, 500.0, 1180.0, 1515.0, 600.0, 1020.0, 945.0, 950.0, 735.0, 780.0, 530.0, 530.0, 1270.0, 950.0, 1410.0, 840.0, 415.0, 640.0, 650.0, 725.0, 970.0, 575.0, 340.0, 1430.0, 630.0, 1120.0, 1390.0, 730.0, 450.0, 620.0, 1165.0, 980.0, 685.0, 1040.0, 720.0, 350.0, 445.0, 665.0, 410.0, 920.0, 720.0, 540.0, 615.0, 870.0, 645.0, 720.0, 660.0, 1310.0, 730.0, 1040.0, 670.0, 530.0, 450.0, 920.0, 960.0, 900.0, 1200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 80.0, 120.0, 230.0, 40.0, 50.0, 290.0, 160.0, 10.0, -40.0, 30.0, 170.0, 0.0, 150.0, 0.0, 120.0, 10.0, 20.0, 50.0, 100.0, 40.0, 60.0, 60.0, 110.0, 40.0, 40.0, 70.0, 60.0, 130.0, 160.0, 70.0, 100.0, 200.0, 60.0, 150.0, 30.0, 80.0, 120.0, 0.0, -80.0, 20.0, 20.0, 120.0, 30.0, 50.0, 15.0, 10.0, 50.0, 20.0, 30.0, 50.0, 180.0, 40.0, 60.0, 110.0, 60.0, 140.0, -30.0, 280.0, -30.0, 160.0, 30.0, 50.0, 10.0, 40.0, 70.0, 120.0, 60.0, 90.0, 70.0, 70.0, 90.0, 70.0, 70.0, 70.0, 120.0, 100.0, 60.0, 150.0, 300.0, 180.0, 30.0, 260.0, 130.0, 50.0, 0.0, 120.0, 70.0, 10.0, 10.0, 90.0, 80.0, 50.0, 0.0, 30.0, 0.0, 30.0, 10.0, 130.0, 0.0, -10.0, 10.0, 40.0, 120.0, 80.0, 50.0, 60.0, 80.0, 60.0, 40.0, 55.0, 290.0, 60.0, 40.0, 80.0, 70.0, 40.0, 50.0, 40.0, 0.0, 0.0, 30.0, 60.0, 50.0, 160.0, 20.0, 120.0, 60.0, 60.0, 160.0, 50.0, 40.0, 80.0, 130.0, 90.0, 30.0, 170.0, 290.0, 300.0, -300.0, 20.0, 110.0, 180.0, 50.0, 30.0, 50.0, 40.0, 110.0, 40.0, 20.0, 200.0, 40.0, 70.0, 30.0, 40.0, 25.0, 30.0, 20.0, 0.0, 10.0, 50.0, 50.0, 0.0, 20.0, 70.0, 250.0, 60.0, 10.0, 0.0, 70.0, 40.0, 100.0, 120.0, 70.0, 270.0, 30.0, 0.0, 80.0, 20.0, 120.0, 180.0, 60.0, 30.0, 30.0, 30.0, 40.0, 10.0, 80.0, 80.0, 250.0, 80.0, 40.0, 20.0, 100.0, 50.0, 120.0, 0.0, 10.0, 0.0, 30.0, 160.0, 20.0, 150.0, 210.0, 50.0, 170.0, 40.0, 90.0, 70.0, 10.0, 160.0, 50.0, 0.0, 50.0, 30.0, 30.0, 170.0, 20.0, 160.0, 40.0, 60.0, 60.0, 20.0, 10.0, 20.0, 120.0, 70.0, 20.0, 80.0, 40.0, 20.0, 40.0, 270.0, 40.0, 40.0, 190.0, 60.0, 20.0, 40.0, 40.0, 400.0, 160.0, 80.0, 100.0, 70.0, 150.0, 290.0, 50.0, 60.0, -30.0, 250.0, 40.0, 110.0, 70.0, 20.0, 190.0, 50.0, 30.0, 40.0, 100.0, 200.0, 0.0, 120.0, 40.0, 20.0, 190.0, 45.0, 50.0, 50.0, 40.0, 120.0, 40.0, 40.0, 30.0, 0.0, 75.0, 20.0, 10.0, 0.0, 390.0, 80.0, 30.0, 40.0, 130.0, 75.0, 20.0, 40.0, 20.0, 10.0, 50.0, 40.0, 30.0, 70.0, 530.0, 120.0, 50.0, 50.0, 30.0, 60.0, 120.0, 70.0, 45.0, 80.0, 270.0, 40.0, 40.0, 10.0, -20.0, 70.0, 200.0, 20.0, 10.0, 10.0, 180.0, 15.0, 50.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 10.0, 10.0, 70.0, 0.0, 30.0, 20.0, 10.0, 210.0, 20.0, 40.0, 80.0, 90.0, 40.0, 200.0, 70.0, 60.0, 190.0, 40.0, 140.0, 60.0, 0.0, 160.0, 80.0, 0.0, 210.0, 140.0, 40.0, 50.0, 30.0, 30.0, 0.0, 50.0, 160.0, 0.0, 80.0, 10.0, 170.0, 90.0, 190.0, 70.0, 10.0, 70.0, 50.0, 80.0, 60.0, 200.0, 70.0, 60.0, 0.0, 260.0, 40.0, 100.0, 0.0, 240.0, 20.0, 70.0, 0.0, 130.0, 50.0, 60.0, 110.0, 350.0, 170.0, 100.0, 30.0, 30.0, 90.0, 60.0, 0.0, 40.0, 250.0, 70.0, 40.0, 30.0, 450.0, 50.0, 140.0, 40.0, 60.0, 30.0, 80.0, 80.0, 370.0, -20.0, 30.0, 20.0, 0.0, 60.0, 50.0, 30.0, 180.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, -30.0, 20.0, 50.0, 160.0, 270.0, 40.0, 10.0, 60.0, 100.0, 40.0, 50.0, 30.0, 400.0, 70.0, 170.0, 110.0, 80.0, 120.0, 30.0, 70.0, 10.0, 40.0, 110.0, 20.0, 40.0, 30.0, 20.0, 50.0, 120.0, 60.0, 60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0, 390.0, 85.0, 90.0, 150.0, 70.0, 110.0, 160.0, 60.0, 330.0, 70.0, 0.0, 30.0, 70.0, 10.0, 210.0, 40.0, 180.0, 10.0, 40.0, 10.0, 60.0, 90.0, 80.0, 80.0, 230.0, 100.0, 90.0, 10.0, 100.0, 180.0, -20.0, 150.0, 160.0, 40.0, 80.0, -45.0, 150.0, 40.0, 270.0, 120.0, 60.0, 180.0, 50.0, 90.0, 10.0, 130.0, 200.0, 40.0, 70.0, 120.0, 100.0, 90.0, 40.0, 20.0, 80.0, 130.0, 45.0, 60.0, 110.0, 60.0, 200.0, 20.0, 20.0, 40.0, 170.0, 50.0, 70.0, 150.0, -40.0, 100.0, 40.0, 60.0, 20.0, 40.0, 60.0, 90.0, 80.0, 110.0, 10.0, 20.0, 60.0, 20.0, 0.0, 20.0, 50.0, 10.0, 40.0, 170.0, 40.0, 120.0, 80.0, 130.0, 60.0, 260.0, 70.0, 410.0, 90.0, 70.0, 30.0, 70.0, 200.0, -50.0, 40.0, 160.0, 40.0, 80.0, 260.0, 110.0, 30.0, 80.0, 0.0, 450.0, 90.0, 240.0, 100.0, 110.0, 90.0, 170.0, 50.0, 110.0, 210.0, -10.0, 180.0, 20.0, 120.0, 110.0, 110.0, 0.0, 70.0, 30.0, 40.0, 60.0, 30.0, 0.0, 15.0, 40.0, 0.0, 110.0, 40.0, 80.0, 100.0, 20.0, 40.0, 150.0, 30.0, 130.0, 0.0, 40.0, 120.0, 10.0, 40.0, 90.0, 50.0, 60.0, 30.0, 40.0, 60.0, 40.0, 190.0, 50.0, 40.0, 70.0, 20.0, 15.0, 200.0, 190.0, 20.0, 10.0, 50.0, 110.0, 20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0, 40.0, 55.0, 150.0, 170.0, 0.0, 10.0, 30.0, 100.0, 30.0, -10.0, 10.0, 60.0, 70.0, 60.0, 70.0, 0.0, 50.0, 10.0, 10.0, 0.0, 190.0, 90.0, 10.0, 160.0, 0.0, 530.0, 40.0, 50.0, 30.0, 330.0, 270.0, 40.0, -40.0, 50.0, 70.0, 100.0, -50.0, 70.0, 20.0, 100.0, 150.0, 160.0, 20.0, 100.0, 100.0, 100.0, 120.0, 180.0, 70.0, 120.0, 180.0, 70.0, 120.0, 60.0, 110.0, 250.0, 290.0, 100.0, 70.0, 140.0, 10.0, 50.0, 130.0, -90.0, 50.0, 240.0, 10.0, 210.0, 30.0, 90.0, 20.0, 20.0, 60.0, 20.0, 20.0, 40.0, 180.0, 20.0, 30.0, 40.0, 100.0, 30.0, 40.0, 30.0, 40.0, 210.0, 60.0, 50.0, 60.0, 0.0, 60.0, 290.0, 80.0, 110.0, 45.0, 110.0, 180.0, 90.0, 110.0, 90.0, 150.0, 180.0, 60.0, 50.0, 90.0, 120.0, 70.0, 80.0, 110.0, 70.0, 10.0, 180.0, 10.0, 90.0, 170.0, 40.0, 45.0, 100.0, 20.0, 20.0, 100.0, 260.0, 60.0, 110.0, 110.0, 90.0, 70.0, 160.0, 0.0, 80.0, 210.0, 40.0, 20.0, 80.0, 30.0, 90.0, 10.0, 40.0, 90.0, 110.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 20.0, 0.0, 40.0, 150.0, 10.0, 40.0, 70.0, 0.0, 25.0, -50.0, 20.0, 210.0, 40.0, 80.0, 50.0, 280.0, 160.0, 130.0, 10.0, 10.0, 10.0, 0.0, 5.0, 10.0, 20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0, 60.0, 140.0, 60.0, 70.0, 70.0, 60.0, 180.0, 60.0, 40.0, 180.0, 30.0, 80.0, 70.0, 40.0, 40.0, 0.0, 150.0, 10.0, 110.0, 190.0, -50.0, 50.0, 10.0, 80.0, 20.0, 10.0, 90.0, 180.0, 30.0, 120.0, 50.0, 5.0, 40.0, 10.0, 60.0, 110.0, 270.0, 30.0, 30.0, 10.0, 30.0, 70.0, 30.0, 50.0, 40.0, 150.0, 120.0, 100.0, 220.0, 60.0, 190.0, 30.0, 160.0, 110.0, 20.0, 10.0, 10.0, 35.0, 50.0, 30.0, 170.0, 30.0, 20.0, 10.0, 160.0, 40.0, 100.0, 100.0, -30.0, 120.0, 40.0, 50.0, 70.0, 130.0, -30.0, 0.0, 60.0, 80.0, 170.0, 90.0, 240.0, 170.0, 40.0, 230.0, 295.0, 80.0, 40.0, 100.0, 45.0, 70.0, 30.0, 10.0, 100.0, 30.0, 60.0, 30.0, 270.0, 30.0, 130.0, 40.0, 50.0, 30.0, 210.0, 70.0, 90.0, 160.0, 50.0, 50.0, 60.0, 270.0, 0.0, 10.0, -40.0, 50.0, 130.0, 40.0, 360.0, 10.0, 70.0, 40.0, 80.0, 0.0, 30.0, 110.0, 50.0, 40.0, 30.0, 70.0, 100.0, 20.0, 10.0, -50.0, 0.0, 50.0, 120.0, 40.0, 20.0, 150.0, 10.0, 100.0, 220.0, 40.0, 60.0, 180.0, 50.0, 120.0, 90.0, 30.0, 20.0, 110.0, 70.0, 70.0, 110.0, 120.0, 110.0, 210.0, 10.0, 120.0, 50.0, 90.0, 80.0, 140.0, -10.0, 60.0, 190.0, 100.0, 130.0, 120.0, 80.0, 10.0, 80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5849702729220616, "mean_inference_ms": 1.4072331538025256, "mean_action_processing_ms": 0.47050269440544695, "mean_env_wait_ms": 1.2783921898184267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01361536979675293, "StateBufferConnector_ms": 0.010005712509155273, "ViewRequirementAgentConnector_ms": 0.4180331230163574}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": 250.0, "episode_return_mean": 784.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.463822166832674, "num_env_steps_trained_throughput_per_sec": 21.463822166832674, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 187272.538, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187272.488, "sample_time_ms": 2577.813, "learn_time_ms": 184675.032, "learn_throughput": 21.66, "synch_weights_time_ms": 11.212}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "33e63_00000", "date": "2024-06-18_22-47-34", "timestamp": 1718765254, "time_this_iter_s": 186.36739420890808, "time_total_s": 6037.503811836243, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272c6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6037.503811836243, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 25.018181818181816, "ram_util_percent": 79.22386363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8840140311608806, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.82237156079854, "policy_loss": -0.010486678873993164, "vf_loss": 6.831378478364061, "vf_explained_var": 0.0005695741968794753, "kl": 0.007398790917080458, "entropy": 0.8342485725943146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 250.0, "episode_reward_mean": 820.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 82.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 760.0, 1330.0, 900.0, 755.0, 725.0, 495.0, 1100.0, 805.0, 345.0, 250.0, 1000.0, 870.0, 580.0, 890.0, 790.0, 1120.0, 1130.0, 690.0, 460.0, 720.0, 1130.0, 500.0, 1180.0, 1515.0, 600.0, 1020.0, 945.0, 950.0, 735.0, 780.0, 530.0, 530.0, 1270.0, 950.0, 1410.0, 840.0, 415.0, 640.0, 650.0, 725.0, 970.0, 575.0, 340.0, 1430.0, 630.0, 1120.0, 1390.0, 730.0, 450.0, 620.0, 1165.0, 980.0, 685.0, 1040.0, 720.0, 350.0, 445.0, 665.0, 410.0, 920.0, 720.0, 540.0, 615.0, 870.0, 645.0, 720.0, 660.0, 1310.0, 730.0, 1040.0, 670.0, 530.0, 450.0, 920.0, 960.0, 900.0, 1200.0, 1220.0, 645.0, 1060.0, 970.0, 460.0, 880.0, 1110.0, 1010.0, 665.0, 950.0, 1570.0, 1140.0, 660.0, 890.0, 980.0, 440.0, 430.0, 920.0, 775.0, 1145.0, 765.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 60.0, 20.0, 10.0, 20.0, 120.0, 70.0, 20.0, 80.0, 40.0, 20.0, 40.0, 270.0, 40.0, 40.0, 190.0, 60.0, 20.0, 40.0, 40.0, 400.0, 160.0, 80.0, 100.0, 70.0, 150.0, 290.0, 50.0, 60.0, -30.0, 250.0, 40.0, 110.0, 70.0, 20.0, 190.0, 50.0, 30.0, 40.0, 100.0, 200.0, 0.0, 120.0, 40.0, 20.0, 190.0, 45.0, 50.0, 50.0, 40.0, 120.0, 40.0, 40.0, 30.0, 0.0, 75.0, 20.0, 10.0, 0.0, 390.0, 80.0, 30.0, 40.0, 130.0, 75.0, 20.0, 40.0, 20.0, 10.0, 50.0, 40.0, 30.0, 70.0, 530.0, 120.0, 50.0, 50.0, 30.0, 60.0, 120.0, 70.0, 45.0, 80.0, 270.0, 40.0, 40.0, 10.0, -20.0, 70.0, 200.0, 20.0, 10.0, 10.0, 180.0, 15.0, 50.0, 20.0, 0.0, 20.0, 20.0, 20.0, 50.0, 30.0, 10.0, 10.0, 70.0, 0.0, 30.0, 20.0, 10.0, 210.0, 20.0, 40.0, 80.0, 90.0, 40.0, 200.0, 70.0, 60.0, 190.0, 40.0, 140.0, 60.0, 0.0, 160.0, 80.0, 0.0, 210.0, 140.0, 40.0, 50.0, 30.0, 30.0, 0.0, 50.0, 160.0, 0.0, 80.0, 10.0, 170.0, 90.0, 190.0, 70.0, 10.0, 70.0, 50.0, 80.0, 60.0, 200.0, 70.0, 60.0, 0.0, 260.0, 40.0, 100.0, 0.0, 240.0, 20.0, 70.0, 0.0, 130.0, 50.0, 60.0, 110.0, 350.0, 170.0, 100.0, 30.0, 30.0, 90.0, 60.0, 0.0, 40.0, 250.0, 70.0, 40.0, 30.0, 450.0, 50.0, 140.0, 40.0, 60.0, 30.0, 80.0, 80.0, 370.0, -20.0, 30.0, 20.0, 0.0, 60.0, 50.0, 30.0, 180.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, -30.0, 20.0, 50.0, 160.0, 270.0, 40.0, 10.0, 60.0, 100.0, 40.0, 50.0, 30.0, 400.0, 70.0, 170.0, 110.0, 80.0, 120.0, 30.0, 70.0, 10.0, 40.0, 110.0, 20.0, 40.0, 30.0, 20.0, 50.0, 120.0, 60.0, 60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0, 390.0, 85.0, 90.0, 150.0, 70.0, 110.0, 160.0, 60.0, 330.0, 70.0, 0.0, 30.0, 70.0, 10.0, 210.0, 40.0, 180.0, 10.0, 40.0, 10.0, 60.0, 90.0, 80.0, 80.0, 230.0, 100.0, 90.0, 10.0, 100.0, 180.0, -20.0, 150.0, 160.0, 40.0, 80.0, -45.0, 150.0, 40.0, 270.0, 120.0, 60.0, 180.0, 50.0, 90.0, 10.0, 130.0, 200.0, 40.0, 70.0, 120.0, 100.0, 90.0, 40.0, 20.0, 80.0, 130.0, 45.0, 60.0, 110.0, 60.0, 200.0, 20.0, 20.0, 40.0, 170.0, 50.0, 70.0, 150.0, -40.0, 100.0, 40.0, 60.0, 20.0, 40.0, 60.0, 90.0, 80.0, 110.0, 10.0, 20.0, 60.0, 20.0, 0.0, 20.0, 50.0, 10.0, 40.0, 170.0, 40.0, 120.0, 80.0, 130.0, 60.0, 260.0, 70.0, 410.0, 90.0, 70.0, 30.0, 70.0, 200.0, -50.0, 40.0, 160.0, 40.0, 80.0, 260.0, 110.0, 30.0, 80.0, 0.0, 450.0, 90.0, 240.0, 100.0, 110.0, 90.0, 170.0, 50.0, 110.0, 210.0, -10.0, 180.0, 20.0, 120.0, 110.0, 110.0, 0.0, 70.0, 30.0, 40.0, 60.0, 30.0, 0.0, 15.0, 40.0, 0.0, 110.0, 40.0, 80.0, 100.0, 20.0, 40.0, 150.0, 30.0, 130.0, 0.0, 40.0, 120.0, 10.0, 40.0, 90.0, 50.0, 60.0, 30.0, 40.0, 60.0, 40.0, 190.0, 50.0, 40.0, 70.0, 20.0, 15.0, 200.0, 190.0, 20.0, 10.0, 50.0, 110.0, 20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0, 40.0, 55.0, 150.0, 170.0, 0.0, 10.0, 30.0, 100.0, 30.0, -10.0, 10.0, 60.0, 70.0, 60.0, 70.0, 0.0, 50.0, 10.0, 10.0, 0.0, 190.0, 90.0, 10.0, 160.0, 0.0, 530.0, 40.0, 50.0, 30.0, 330.0, 270.0, 40.0, -40.0, 50.0, 70.0, 100.0, -50.0, 70.0, 20.0, 100.0, 150.0, 160.0, 20.0, 100.0, 100.0, 100.0, 120.0, 180.0, 70.0, 120.0, 180.0, 70.0, 120.0, 60.0, 110.0, 250.0, 290.0, 100.0, 70.0, 140.0, 10.0, 50.0, 130.0, -90.0, 50.0, 240.0, 10.0, 210.0, 30.0, 90.0, 20.0, 20.0, 60.0, 20.0, 20.0, 40.0, 180.0, 20.0, 30.0, 40.0, 100.0, 30.0, 40.0, 30.0, 40.0, 210.0, 60.0, 50.0, 60.0, 0.0, 60.0, 290.0, 80.0, 110.0, 45.0, 110.0, 180.0, 90.0, 110.0, 90.0, 150.0, 180.0, 60.0, 50.0, 90.0, 120.0, 70.0, 80.0, 110.0, 70.0, 10.0, 180.0, 10.0, 90.0, 170.0, 40.0, 45.0, 100.0, 20.0, 20.0, 100.0, 260.0, 60.0, 110.0, 110.0, 90.0, 70.0, 160.0, 0.0, 80.0, 210.0, 40.0, 20.0, 80.0, 30.0, 90.0, 10.0, 40.0, 90.0, 110.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 20.0, 0.0, 40.0, 150.0, 10.0, 40.0, 70.0, 0.0, 25.0, -50.0, 20.0, 210.0, 40.0, 80.0, 50.0, 280.0, 160.0, 130.0, 10.0, 10.0, 10.0, 0.0, 5.0, 10.0, 20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0, 60.0, 140.0, 60.0, 70.0, 70.0, 60.0, 180.0, 60.0, 40.0, 180.0, 30.0, 80.0, 70.0, 40.0, 40.0, 0.0, 150.0, 10.0, 110.0, 190.0, -50.0, 50.0, 10.0, 80.0, 20.0, 10.0, 90.0, 180.0, 30.0, 120.0, 50.0, 5.0, 40.0, 10.0, 60.0, 110.0, 270.0, 30.0, 30.0, 10.0, 30.0, 70.0, 30.0, 50.0, 40.0, 150.0, 120.0, 100.0, 220.0, 60.0, 190.0, 30.0, 160.0, 110.0, 20.0, 10.0, 10.0, 35.0, 50.0, 30.0, 170.0, 30.0, 20.0, 10.0, 160.0, 40.0, 100.0, 100.0, -30.0, 120.0, 40.0, 50.0, 70.0, 130.0, -30.0, 0.0, 60.0, 80.0, 170.0, 90.0, 240.0, 170.0, 40.0, 230.0, 295.0, 80.0, 40.0, 100.0, 45.0, 70.0, 30.0, 10.0, 100.0, 30.0, 60.0, 30.0, 270.0, 30.0, 130.0, 40.0, 50.0, 30.0, 210.0, 70.0, 90.0, 160.0, 50.0, 50.0, 60.0, 270.0, 0.0, 10.0, -40.0, 50.0, 130.0, 40.0, 360.0, 10.0, 70.0, 40.0, 80.0, 0.0, 30.0, 110.0, 50.0, 40.0, 30.0, 70.0, 100.0, 20.0, 10.0, -50.0, 0.0, 50.0, 120.0, 40.0, 20.0, 150.0, 10.0, 100.0, 220.0, 40.0, 60.0, 180.0, 50.0, 120.0, 90.0, 30.0, 20.0, 110.0, 70.0, 70.0, 110.0, 120.0, 110.0, 210.0, 10.0, 120.0, 50.0, 90.0, 80.0, 140.0, -10.0, 60.0, 190.0, 100.0, 130.0, 120.0, 80.0, 10.0, 80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0, 270.0, 170.0, 60.0, 170.0, 50.0, 80.0, 190.0, 80.0, 90.0, 60.0, 90.0, -5.0, 160.0, 50.0, 90.0, 30.0, 20.0, 60.0, 50.0, 100.0, 110.0, 60.0, 220.0, 80.0, 30.0, 170.0, 10.0, 290.0, 100.0, -10.0, 170.0, 190.0, 50.0, 50.0, 120.0, 140.0, 100.0, 110.0, 20.0, 20.0, 20.0, 80.0, 10.0, 20.0, 160.0, 40.0, 80.0, 20.0, 10.0, 20.0, 110.0, 190.0, 70.0, -40.0, 20.0, 100.0, 20.0, 130.0, 120.0, 160.0, 70.0, 100.0, 120.0, 30.0, 180.0, 360.0, 30.0, 150.0, 100.0, -30.0, 110.0, 0.0, 120.0, 40.0, 90.0, 30.0, 100.0, 270.0, 40.0, 210.0, 60.0, 20.0, 150.0, 20.0, 60.0, 320.0, 60.0, 60.0, 30.0, -115.0, 210.0, 70.0, 50.0, 210.0, 100.0, 60.0, 110.0, 40.0, 50.0, 50.0, 30.0, 290.0, 210.0, 90.0, 480.0, 40.0, 140.0, 90.0, 40.0, 160.0, 260.0, 50.0, 60.0, 120.0, 10.0, 10.0, 20.0, 160.0, 400.0, 50.0, 100.0, 30.0, 90.0, 120.0, 20.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 30.0, 30.0, 170.0, 70.0, 10.0, 100.0, 70.0, 30.0, 350.0, 20.0, 110.0, 40.0, 50.0, 170.0, 100.0, 100.0, 160.0, 90.0, 140.0, 40.0, 10.0, 20.0, 30.0, 80.0, 90.0, 10.0, 110.0, 10.0, 40.0, 60.0, 50.0, 0.0, 30.0, 40.0, 50.0, 50.0, 10.0, 80.0, 60.0, 90.0, 90.0, 170.0, 60.0, 80.0, 80.0, 160.0, 100.0, 0.0, 90.0, 80.0, 5.0, 250.0, 30.0, 110.0, 80.0, 0.0, 80.0, -50.0, 190.0, 370.0, 85.0, 140.0, 50.0, 130.0, 80.0, 160.0, 110.0, 10.0, 10.0, 100.0, 40.0, 0.0, 25.0, 40.0, 100.0, 160.0, 220.0, 10.0, 70.0, 180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5813664342917502, "mean_inference_ms": 1.4083201847180247, "mean_action_processing_ms": 0.467759141071316, "mean_env_wait_ms": 1.2775105400400433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013103485107421875, "StateBufferConnector_ms": 0.009737491607666016, "ViewRequirementAgentConnector_ms": 0.4086611270904541}, "num_episodes": 22, "episode_return_max": 1570.0, "episode_return_min": 250.0, "episode_return_mean": 820.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.341821111103183, "num_env_steps_trained_throughput_per_sec": 21.341821111103183, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 187208.442, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187208.379, "sample_time_ms": 2619.924, "learn_time_ms": 184568.459, "learn_throughput": 21.672, "synch_weights_time_ms": 11.206}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "33e63_00000", "date": "2024-06-18_22-50-42", "timestamp": 1718765442, "time_this_iter_s": 187.45067811012268, "time_total_s": 6224.954489946365, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32724a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6224.954489946365, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 25.102641509433962, "ram_util_percent": 80.00943396226415}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.751294557272563, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.985678080476511, "policy_loss": -0.009822062012011482, "vf_loss": 6.993909240911563, "vf_explained_var": -0.00015698610403286383, "kl": 0.007954468458899657, "entropy": 0.817621668973289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 220.0, "episode_reward_mean": 833.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 83.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1180.0, 1515.0, 600.0, 1020.0, 945.0, 950.0, 735.0, 780.0, 530.0, 530.0, 1270.0, 950.0, 1410.0, 840.0, 415.0, 640.0, 650.0, 725.0, 970.0, 575.0, 340.0, 1430.0, 630.0, 1120.0, 1390.0, 730.0, 450.0, 620.0, 1165.0, 980.0, 685.0, 1040.0, 720.0, 350.0, 445.0, 665.0, 410.0, 920.0, 720.0, 540.0, 615.0, 870.0, 645.0, 720.0, 660.0, 1310.0, 730.0, 1040.0, 670.0, 530.0, 450.0, 920.0, 960.0, 900.0, 1200.0, 1220.0, 645.0, 1060.0, 970.0, 460.0, 880.0, 1110.0, 1010.0, 665.0, 950.0, 1570.0, 1140.0, 660.0, 890.0, 980.0, 440.0, 430.0, 920.0, 775.0, 1145.0, 765.0, 700.0, 1320.0, 220.0, 440.0, 1030.0, 1190.0, 1010.0, 1190.0, 740.0, 1050.0, 650.0, 785.0, 660.0, 1015.0, 1390.0, 370.0, 1010.0, 575.0, 735.0, 820.0, 460.0, 370.0, 1180.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 330.0, 40.0, 140.0, 120.0, 10.0, 60.0, 190.0, 40.0, 190.0, 390.0, 85.0, 90.0, 150.0, 70.0, 110.0, 160.0, 60.0, 330.0, 70.0, 0.0, 30.0, 70.0, 10.0, 210.0, 40.0, 180.0, 10.0, 40.0, 10.0, 60.0, 90.0, 80.0, 80.0, 230.0, 100.0, 90.0, 10.0, 100.0, 180.0, -20.0, 150.0, 160.0, 40.0, 80.0, -45.0, 150.0, 40.0, 270.0, 120.0, 60.0, 180.0, 50.0, 90.0, 10.0, 130.0, 200.0, 40.0, 70.0, 120.0, 100.0, 90.0, 40.0, 20.0, 80.0, 130.0, 45.0, 60.0, 110.0, 60.0, 200.0, 20.0, 20.0, 40.0, 170.0, 50.0, 70.0, 150.0, -40.0, 100.0, 40.0, 60.0, 20.0, 40.0, 60.0, 90.0, 80.0, 110.0, 10.0, 20.0, 60.0, 20.0, 0.0, 20.0, 50.0, 10.0, 40.0, 170.0, 40.0, 120.0, 80.0, 130.0, 60.0, 260.0, 70.0, 410.0, 90.0, 70.0, 30.0, 70.0, 200.0, -50.0, 40.0, 160.0, 40.0, 80.0, 260.0, 110.0, 30.0, 80.0, 0.0, 450.0, 90.0, 240.0, 100.0, 110.0, 90.0, 170.0, 50.0, 110.0, 210.0, -10.0, 180.0, 20.0, 120.0, 110.0, 110.0, 0.0, 70.0, 30.0, 40.0, 60.0, 30.0, 0.0, 15.0, 40.0, 0.0, 110.0, 40.0, 80.0, 100.0, 20.0, 40.0, 150.0, 30.0, 130.0, 0.0, 40.0, 120.0, 10.0, 40.0, 90.0, 50.0, 60.0, 30.0, 40.0, 60.0, 40.0, 190.0, 50.0, 40.0, 70.0, 20.0, 15.0, 200.0, 190.0, 20.0, 10.0, 50.0, 110.0, 20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0, 40.0, 55.0, 150.0, 170.0, 0.0, 10.0, 30.0, 100.0, 30.0, -10.0, 10.0, 60.0, 70.0, 60.0, 70.0, 0.0, 50.0, 10.0, 10.0, 0.0, 190.0, 90.0, 10.0, 160.0, 0.0, 530.0, 40.0, 50.0, 30.0, 330.0, 270.0, 40.0, -40.0, 50.0, 70.0, 100.0, -50.0, 70.0, 20.0, 100.0, 150.0, 160.0, 20.0, 100.0, 100.0, 100.0, 120.0, 180.0, 70.0, 120.0, 180.0, 70.0, 120.0, 60.0, 110.0, 250.0, 290.0, 100.0, 70.0, 140.0, 10.0, 50.0, 130.0, -90.0, 50.0, 240.0, 10.0, 210.0, 30.0, 90.0, 20.0, 20.0, 60.0, 20.0, 20.0, 40.0, 180.0, 20.0, 30.0, 40.0, 100.0, 30.0, 40.0, 30.0, 40.0, 210.0, 60.0, 50.0, 60.0, 0.0, 60.0, 290.0, 80.0, 110.0, 45.0, 110.0, 180.0, 90.0, 110.0, 90.0, 150.0, 180.0, 60.0, 50.0, 90.0, 120.0, 70.0, 80.0, 110.0, 70.0, 10.0, 180.0, 10.0, 90.0, 170.0, 40.0, 45.0, 100.0, 20.0, 20.0, 100.0, 260.0, 60.0, 110.0, 110.0, 90.0, 70.0, 160.0, 0.0, 80.0, 210.0, 40.0, 20.0, 80.0, 30.0, 90.0, 10.0, 40.0, 90.0, 110.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 20.0, 0.0, 40.0, 150.0, 10.0, 40.0, 70.0, 0.0, 25.0, -50.0, 20.0, 210.0, 40.0, 80.0, 50.0, 280.0, 160.0, 130.0, 10.0, 10.0, 10.0, 0.0, 5.0, 10.0, 20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0, 60.0, 140.0, 60.0, 70.0, 70.0, 60.0, 180.0, 60.0, 40.0, 180.0, 30.0, 80.0, 70.0, 40.0, 40.0, 0.0, 150.0, 10.0, 110.0, 190.0, -50.0, 50.0, 10.0, 80.0, 20.0, 10.0, 90.0, 180.0, 30.0, 120.0, 50.0, 5.0, 40.0, 10.0, 60.0, 110.0, 270.0, 30.0, 30.0, 10.0, 30.0, 70.0, 30.0, 50.0, 40.0, 150.0, 120.0, 100.0, 220.0, 60.0, 190.0, 30.0, 160.0, 110.0, 20.0, 10.0, 10.0, 35.0, 50.0, 30.0, 170.0, 30.0, 20.0, 10.0, 160.0, 40.0, 100.0, 100.0, -30.0, 120.0, 40.0, 50.0, 70.0, 130.0, -30.0, 0.0, 60.0, 80.0, 170.0, 90.0, 240.0, 170.0, 40.0, 230.0, 295.0, 80.0, 40.0, 100.0, 45.0, 70.0, 30.0, 10.0, 100.0, 30.0, 60.0, 30.0, 270.0, 30.0, 130.0, 40.0, 50.0, 30.0, 210.0, 70.0, 90.0, 160.0, 50.0, 50.0, 60.0, 270.0, 0.0, 10.0, -40.0, 50.0, 130.0, 40.0, 360.0, 10.0, 70.0, 40.0, 80.0, 0.0, 30.0, 110.0, 50.0, 40.0, 30.0, 70.0, 100.0, 20.0, 10.0, -50.0, 0.0, 50.0, 120.0, 40.0, 20.0, 150.0, 10.0, 100.0, 220.0, 40.0, 60.0, 180.0, 50.0, 120.0, 90.0, 30.0, 20.0, 110.0, 70.0, 70.0, 110.0, 120.0, 110.0, 210.0, 10.0, 120.0, 50.0, 90.0, 80.0, 140.0, -10.0, 60.0, 190.0, 100.0, 130.0, 120.0, 80.0, 10.0, 80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0, 270.0, 170.0, 60.0, 170.0, 50.0, 80.0, 190.0, 80.0, 90.0, 60.0, 90.0, -5.0, 160.0, 50.0, 90.0, 30.0, 20.0, 60.0, 50.0, 100.0, 110.0, 60.0, 220.0, 80.0, 30.0, 170.0, 10.0, 290.0, 100.0, -10.0, 170.0, 190.0, 50.0, 50.0, 120.0, 140.0, 100.0, 110.0, 20.0, 20.0, 20.0, 80.0, 10.0, 20.0, 160.0, 40.0, 80.0, 20.0, 10.0, 20.0, 110.0, 190.0, 70.0, -40.0, 20.0, 100.0, 20.0, 130.0, 120.0, 160.0, 70.0, 100.0, 120.0, 30.0, 180.0, 360.0, 30.0, 150.0, 100.0, -30.0, 110.0, 0.0, 120.0, 40.0, 90.0, 30.0, 100.0, 270.0, 40.0, 210.0, 60.0, 20.0, 150.0, 20.0, 60.0, 320.0, 60.0, 60.0, 30.0, -115.0, 210.0, 70.0, 50.0, 210.0, 100.0, 60.0, 110.0, 40.0, 50.0, 50.0, 30.0, 290.0, 210.0, 90.0, 480.0, 40.0, 140.0, 90.0, 40.0, 160.0, 260.0, 50.0, 60.0, 120.0, 10.0, 10.0, 20.0, 160.0, 400.0, 50.0, 100.0, 30.0, 90.0, 120.0, 20.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 30.0, 30.0, 170.0, 70.0, 10.0, 100.0, 70.0, 30.0, 350.0, 20.0, 110.0, 40.0, 50.0, 170.0, 100.0, 100.0, 160.0, 90.0, 140.0, 40.0, 10.0, 20.0, 30.0, 80.0, 90.0, 10.0, 110.0, 10.0, 40.0, 60.0, 50.0, 0.0, 30.0, 40.0, 50.0, 50.0, 10.0, 80.0, 60.0, 90.0, 90.0, 170.0, 60.0, 80.0, 80.0, 160.0, 100.0, 0.0, 90.0, 80.0, 5.0, 250.0, 30.0, 110.0, 80.0, 0.0, 80.0, -50.0, 190.0, 370.0, 85.0, 140.0, 50.0, 130.0, 80.0, 160.0, 110.0, 10.0, 10.0, 100.0, 40.0, 0.0, 25.0, 40.0, 100.0, 160.0, 220.0, 10.0, 70.0, 180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0, 120.0, 340.0, 80.0, 90.0, 170.0, 70.0, 80.0, 120.0, 80.0, 170.0, 10.0, 20.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 30.0, 60.0, 30.0, 0.0, 50.0, 30.0, 60.0, 30.0, 150.0, 80.0, 280.0, 40.0, 70.0, 100.0, 120.0, 80.0, 20.0, 240.0, 0.0, 50.0, 250.0, -10.0, 40.0, 330.0, 70.0, 90.0, 80.0, 210.0, 80.0, 60.0, 30.0, 110.0, 60.0, 120.0, 230.0, 140.0, 110.0, 130.0, 20.0, 10.0, 140.0, 70.0, 190.0, 160.0, -30.0, 480.0, 70.0, 60.0, 40.0, 140.0, 20.0, 40.0, 80.0, 100.0, 40.0, 30.0, 110.0, 40.0, 140.0, 50.0, 160.0, 70.0, 160.0, 60.0, -20.0, 60.0, 170.0, 230.0, 110.0, 70.0, 90.0, 10.0, 70.0, 10.0, 70.0, 230.0, 0.0, 90.0, 10.0, 120.0, 50.0, 40.0, 100.0, 30.0, 20.0, 50.0, 15.0, 200.0, 160.0, 200.0, 50.0, 150.0, 30.0, 20.0, 150.0, 10.0, 20.0, 20.0, 10.0, 270.0, 80.0, 80.0, 30.0, 140.0, 40.0, 35.0, 80.0, 50.0, 210.0, 20.0, 60.0, 90.0, 460.0, 80.0, 230.0, 10.0, 220.0, 150.0, 70.0, 150.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 100.0, 80.0, 250.0, 40.0, 90.0, 120.0, 80.0, 40.0, 130.0, 130.0, 50.0, 65.0, 90.0, 60.0, 40.0, 40.0, 140.0, 0.0, 90.0, 30.0, 20.0, 80.0, 60.0, 55.0, 170.0, 20.0, 40.0, 40.0, 80.0, 190.0, 0.0, 20.0, 90.0, 180.0, 0.0, 30.0, 40.0, 190.0, 30.0, 160.0, 80.0, 40.0, 30.0, 40.0, 60.0, 60.0, 80.0, 70.0, 30.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 10.0, 40.0, 0.0, 20.0, 90.0, 70.0, 50.0, 60.0, 230.0, 200.0, 30.0, 30.0, 10.0, 50.0, 280.0, 240.0, 30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5776467328947623, "mean_inference_ms": 1.4109929986515888, "mean_action_processing_ms": 0.4646351630435006, "mean_env_wait_ms": 1.2765886774603603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012559175491333008, "StateBufferConnector_ms": 0.01129293441772461, "ViewRequirementAgentConnector_ms": 0.4012753963470459}, "num_episodes": 23, "episode_return_max": 1570.0, "episode_return_min": 220.0, "episode_return_mean": 833.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.547784356054276, "num_env_steps_trained_throughput_per_sec": 21.547784356054276, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 187081.778, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187081.717, "sample_time_ms": 2608.392, "learn_time_ms": 184453.234, "learn_throughput": 21.686, "synch_weights_time_ms": 11.145}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "33e63_00000", "date": "2024-06-18_22-53-47", "timestamp": 1718765627, "time_this_iter_s": 185.64138507843018, "time_total_s": 6410.5958750247955, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272c6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6410.5958750247955, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 24.679467680608365, "ram_util_percent": 79.05589353612166}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9457306615460794, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.666525262308578, "policy_loss": -0.009603076105683455, "vf_loss": 6.674692572470798, "vf_explained_var": 0.0014818041913679486, "kl": 0.00717883068306412, "entropy": 0.8149485231398013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 140.0, "episode_reward_mean": 807.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 80.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [970.0, 575.0, 340.0, 1430.0, 630.0, 1120.0, 1390.0, 730.0, 450.0, 620.0, 1165.0, 980.0, 685.0, 1040.0, 720.0, 350.0, 445.0, 665.0, 410.0, 920.0, 720.0, 540.0, 615.0, 870.0, 645.0, 720.0, 660.0, 1310.0, 730.0, 1040.0, 670.0, 530.0, 450.0, 920.0, 960.0, 900.0, 1200.0, 1220.0, 645.0, 1060.0, 970.0, 460.0, 880.0, 1110.0, 1010.0, 665.0, 950.0, 1570.0, 1140.0, 660.0, 890.0, 980.0, 440.0, 430.0, 920.0, 775.0, 1145.0, 765.0, 700.0, 1320.0, 220.0, 440.0, 1030.0, 1190.0, 1010.0, 1190.0, 740.0, 1050.0, 650.0, 785.0, 660.0, 1015.0, 1390.0, 370.0, 1010.0, 575.0, 735.0, 820.0, 460.0, 370.0, 1180.0, 910.0, 140.0, 610.0, 485.0, 650.0, 685.0, 470.0, 1140.0, 885.0, 960.0, 680.0, 300.0, 1280.0, 490.0, 880.0, 1120.0, 460.0, 1085.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 140.0, 40.0, 30.0, 280.0, 40.0, 120.0, 70.0, 180.0, 50.0, 40.0, 55.0, 150.0, 170.0, 0.0, 10.0, 30.0, 100.0, 30.0, -10.0, 10.0, 60.0, 70.0, 60.0, 70.0, 0.0, 50.0, 10.0, 10.0, 0.0, 190.0, 90.0, 10.0, 160.0, 0.0, 530.0, 40.0, 50.0, 30.0, 330.0, 270.0, 40.0, -40.0, 50.0, 70.0, 100.0, -50.0, 70.0, 20.0, 100.0, 150.0, 160.0, 20.0, 100.0, 100.0, 100.0, 120.0, 180.0, 70.0, 120.0, 180.0, 70.0, 120.0, 60.0, 110.0, 250.0, 290.0, 100.0, 70.0, 140.0, 10.0, 50.0, 130.0, -90.0, 50.0, 240.0, 10.0, 210.0, 30.0, 90.0, 20.0, 20.0, 60.0, 20.0, 20.0, 40.0, 180.0, 20.0, 30.0, 40.0, 100.0, 30.0, 40.0, 30.0, 40.0, 210.0, 60.0, 50.0, 60.0, 0.0, 60.0, 290.0, 80.0, 110.0, 45.0, 110.0, 180.0, 90.0, 110.0, 90.0, 150.0, 180.0, 60.0, 50.0, 90.0, 120.0, 70.0, 80.0, 110.0, 70.0, 10.0, 180.0, 10.0, 90.0, 170.0, 40.0, 45.0, 100.0, 20.0, 20.0, 100.0, 260.0, 60.0, 110.0, 110.0, 90.0, 70.0, 160.0, 0.0, 80.0, 210.0, 40.0, 20.0, 80.0, 30.0, 90.0, 10.0, 40.0, 90.0, 110.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 20.0, 0.0, 40.0, 150.0, 10.0, 40.0, 70.0, 0.0, 25.0, -50.0, 20.0, 210.0, 40.0, 80.0, 50.0, 280.0, 160.0, 130.0, 10.0, 10.0, 10.0, 0.0, 5.0, 10.0, 20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0, 60.0, 140.0, 60.0, 70.0, 70.0, 60.0, 180.0, 60.0, 40.0, 180.0, 30.0, 80.0, 70.0, 40.0, 40.0, 0.0, 150.0, 10.0, 110.0, 190.0, -50.0, 50.0, 10.0, 80.0, 20.0, 10.0, 90.0, 180.0, 30.0, 120.0, 50.0, 5.0, 40.0, 10.0, 60.0, 110.0, 270.0, 30.0, 30.0, 10.0, 30.0, 70.0, 30.0, 50.0, 40.0, 150.0, 120.0, 100.0, 220.0, 60.0, 190.0, 30.0, 160.0, 110.0, 20.0, 10.0, 10.0, 35.0, 50.0, 30.0, 170.0, 30.0, 20.0, 10.0, 160.0, 40.0, 100.0, 100.0, -30.0, 120.0, 40.0, 50.0, 70.0, 130.0, -30.0, 0.0, 60.0, 80.0, 170.0, 90.0, 240.0, 170.0, 40.0, 230.0, 295.0, 80.0, 40.0, 100.0, 45.0, 70.0, 30.0, 10.0, 100.0, 30.0, 60.0, 30.0, 270.0, 30.0, 130.0, 40.0, 50.0, 30.0, 210.0, 70.0, 90.0, 160.0, 50.0, 50.0, 60.0, 270.0, 0.0, 10.0, -40.0, 50.0, 130.0, 40.0, 360.0, 10.0, 70.0, 40.0, 80.0, 0.0, 30.0, 110.0, 50.0, 40.0, 30.0, 70.0, 100.0, 20.0, 10.0, -50.0, 0.0, 50.0, 120.0, 40.0, 20.0, 150.0, 10.0, 100.0, 220.0, 40.0, 60.0, 180.0, 50.0, 120.0, 90.0, 30.0, 20.0, 110.0, 70.0, 70.0, 110.0, 120.0, 110.0, 210.0, 10.0, 120.0, 50.0, 90.0, 80.0, 140.0, -10.0, 60.0, 190.0, 100.0, 130.0, 120.0, 80.0, 10.0, 80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0, 270.0, 170.0, 60.0, 170.0, 50.0, 80.0, 190.0, 80.0, 90.0, 60.0, 90.0, -5.0, 160.0, 50.0, 90.0, 30.0, 20.0, 60.0, 50.0, 100.0, 110.0, 60.0, 220.0, 80.0, 30.0, 170.0, 10.0, 290.0, 100.0, -10.0, 170.0, 190.0, 50.0, 50.0, 120.0, 140.0, 100.0, 110.0, 20.0, 20.0, 20.0, 80.0, 10.0, 20.0, 160.0, 40.0, 80.0, 20.0, 10.0, 20.0, 110.0, 190.0, 70.0, -40.0, 20.0, 100.0, 20.0, 130.0, 120.0, 160.0, 70.0, 100.0, 120.0, 30.0, 180.0, 360.0, 30.0, 150.0, 100.0, -30.0, 110.0, 0.0, 120.0, 40.0, 90.0, 30.0, 100.0, 270.0, 40.0, 210.0, 60.0, 20.0, 150.0, 20.0, 60.0, 320.0, 60.0, 60.0, 30.0, -115.0, 210.0, 70.0, 50.0, 210.0, 100.0, 60.0, 110.0, 40.0, 50.0, 50.0, 30.0, 290.0, 210.0, 90.0, 480.0, 40.0, 140.0, 90.0, 40.0, 160.0, 260.0, 50.0, 60.0, 120.0, 10.0, 10.0, 20.0, 160.0, 400.0, 50.0, 100.0, 30.0, 90.0, 120.0, 20.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 30.0, 30.0, 170.0, 70.0, 10.0, 100.0, 70.0, 30.0, 350.0, 20.0, 110.0, 40.0, 50.0, 170.0, 100.0, 100.0, 160.0, 90.0, 140.0, 40.0, 10.0, 20.0, 30.0, 80.0, 90.0, 10.0, 110.0, 10.0, 40.0, 60.0, 50.0, 0.0, 30.0, 40.0, 50.0, 50.0, 10.0, 80.0, 60.0, 90.0, 90.0, 170.0, 60.0, 80.0, 80.0, 160.0, 100.0, 0.0, 90.0, 80.0, 5.0, 250.0, 30.0, 110.0, 80.0, 0.0, 80.0, -50.0, 190.0, 370.0, 85.0, 140.0, 50.0, 130.0, 80.0, 160.0, 110.0, 10.0, 10.0, 100.0, 40.0, 0.0, 25.0, 40.0, 100.0, 160.0, 220.0, 10.0, 70.0, 180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0, 120.0, 340.0, 80.0, 90.0, 170.0, 70.0, 80.0, 120.0, 80.0, 170.0, 10.0, 20.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 30.0, 60.0, 30.0, 0.0, 50.0, 30.0, 60.0, 30.0, 150.0, 80.0, 280.0, 40.0, 70.0, 100.0, 120.0, 80.0, 20.0, 240.0, 0.0, 50.0, 250.0, -10.0, 40.0, 330.0, 70.0, 90.0, 80.0, 210.0, 80.0, 60.0, 30.0, 110.0, 60.0, 120.0, 230.0, 140.0, 110.0, 130.0, 20.0, 10.0, 140.0, 70.0, 190.0, 160.0, -30.0, 480.0, 70.0, 60.0, 40.0, 140.0, 20.0, 40.0, 80.0, 100.0, 40.0, 30.0, 110.0, 40.0, 140.0, 50.0, 160.0, 70.0, 160.0, 60.0, -20.0, 60.0, 170.0, 230.0, 110.0, 70.0, 90.0, 10.0, 70.0, 10.0, 70.0, 230.0, 0.0, 90.0, 10.0, 120.0, 50.0, 40.0, 100.0, 30.0, 20.0, 50.0, 15.0, 200.0, 160.0, 200.0, 50.0, 150.0, 30.0, 20.0, 150.0, 10.0, 20.0, 20.0, 10.0, 270.0, 80.0, 80.0, 30.0, 140.0, 40.0, 35.0, 80.0, 50.0, 210.0, 20.0, 60.0, 90.0, 460.0, 80.0, 230.0, 10.0, 220.0, 150.0, 70.0, 150.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 100.0, 80.0, 250.0, 40.0, 90.0, 120.0, 80.0, 40.0, 130.0, 130.0, 50.0, 65.0, 90.0, 60.0, 40.0, 40.0, 140.0, 0.0, 90.0, 30.0, 20.0, 80.0, 60.0, 55.0, 170.0, 20.0, 40.0, 40.0, 80.0, 190.0, 0.0, 20.0, 90.0, 180.0, 0.0, 30.0, 40.0, 190.0, 30.0, 160.0, 80.0, 40.0, 30.0, 40.0, 60.0, 60.0, 80.0, 70.0, 30.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 10.0, 40.0, 0.0, 20.0, 90.0, 70.0, 50.0, 60.0, 230.0, 200.0, 30.0, 30.0, 10.0, 50.0, 280.0, 240.0, 30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0, 20.0, 10.0, 0.0, 45.0, 60.0, -70.0, 10.0, 70.0, -25.0, 20.0, 80.0, 20.0, 70.0, 110.0, 170.0, 50.0, 20.0, 40.0, 40.0, 10.0, 5.0, 60.0, 20.0, 100.0, 20.0, 20.0, 0.0, 30.0, 90.0, 140.0, 50.0, 10.0, 30.0, 20.0, 60.0, 150.0, 70.0, 50.0, 200.0, 10.0, 40.0, 20.0, 60.0, 60.0, 25.0, 180.0, 0.0, 210.0, 50.0, 40.0, 70.0, 10.0, 30.0, 90.0, 40.0, 60.0, 30.0, 40.0, 60.0, 40.0, 400.0, 90.0, 30.0, 120.0, 60.0, -20.0, 100.0, 150.0, 50.0, 160.0, 20.0, 80.0, 70.0, 210.0, 270.0, 160.0, 20.0, 60.0, 25.0, -30.0, 50.0, 120.0, 100.0, 160.0, 260.0, 80.0, 20.0, 20.0, 130.0, 20.0, 40.0, 80.0, 90.0, 20.0, 180.0, 90.0, 100.0, 20.0, 10.0, 50.0, 10.0, 0.0, 20.0, 50.0, 70.0, 30.0, 60.0, 10.0, 40.0, 10.0, 90.0, 70.0, 200.0, 140.0, 100.0, 210.0, 150.0, 40.0, 130.0, 150.0, -50.0, 20.0, 70.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 340.0, 90.0, 40.0, 70.0, 110.0, 190.0, 120.0, 20.0, 110.0, 130.0, 0.0, 280.0, -20.0, 150.0, 80.0, 70.0, 70.0, 30.0, 140.0, 120.0, 200.0, 0.0, 30.0, 60.0, 90.0, 80.0, 10.0, 10.0, 40.0, 90.0, 50.0, 30.0, 60.0, 95.0, 50.0, 420.0, 130.0, 80.0, 20.0, 50.0, 150.0, 30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5753830448520132, "mean_inference_ms": 1.4127446082831006, "mean_action_processing_ms": 0.4624637821795767, "mean_env_wait_ms": 1.2758373696983651, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012278556823730469, "StateBufferConnector_ms": 0.011238813400268555, "ViewRequirementAgentConnector_ms": 0.3898334503173828}, "num_episodes": 18, "episode_return_max": 1570.0, "episode_return_min": 140.0, "episode_return_mean": 807.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.20159252656076, "num_env_steps_trained_throughput_per_sec": 21.20159252656076, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 187052.863, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187052.801, "sample_time_ms": 2627.183, "learn_time_ms": 184405.548, "learn_throughput": 21.691, "synch_weights_time_ms": 11.135}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "33e63_00000", "date": "2024-06-18_22-56-56", "timestamp": 1718765816, "time_this_iter_s": 188.67651391029358, "time_total_s": 6599.272388935089, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3271848b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6599.272388935089, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 26.587218045112778, "ram_util_percent": 79.86541353383457}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4722582614713837, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.247448821824452, "policy_loss": -0.008626171373263799, "vf_loss": 6.254623540344076, "vf_explained_var": 0.00035762927783563876, "kl": 0.007257238726295056, "entropy": 0.7896560605976402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 140.0, "episode_reward_mean": 790.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 610.0}, "policy_reward_mean": {"policy_0": 79.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 920.0, 720.0, 540.0, 615.0, 870.0, 645.0, 720.0, 660.0, 1310.0, 730.0, 1040.0, 670.0, 530.0, 450.0, 920.0, 960.0, 900.0, 1200.0, 1220.0, 645.0, 1060.0, 970.0, 460.0, 880.0, 1110.0, 1010.0, 665.0, 950.0, 1570.0, 1140.0, 660.0, 890.0, 980.0, 440.0, 430.0, 920.0, 775.0, 1145.0, 765.0, 700.0, 1320.0, 220.0, 440.0, 1030.0, 1190.0, 1010.0, 1190.0, 740.0, 1050.0, 650.0, 785.0, 660.0, 1015.0, 1390.0, 370.0, 1010.0, 575.0, 735.0, 820.0, 460.0, 370.0, 1180.0, 910.0, 140.0, 610.0, 485.0, 650.0, 685.0, 470.0, 1140.0, 885.0, 960.0, 680.0, 300.0, 1280.0, 490.0, 880.0, 1120.0, 460.0, 1085.0, 850.0, 570.0, 340.0, 990.0, 380.0, 660.0, 560.0, 310.0, 740.0, 590.0, 890.0, 510.0, 1060.0, 970.0, 490.0, 720.0, 1070.0, 950.0, 780.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 40.0, 40.0, 30.0, 20.0, 20.0, 0.0, 160.0, 40.0, 60.0, 140.0, 60.0, 70.0, 70.0, 60.0, 180.0, 60.0, 40.0, 180.0, 30.0, 80.0, 70.0, 40.0, 40.0, 0.0, 150.0, 10.0, 110.0, 190.0, -50.0, 50.0, 10.0, 80.0, 20.0, 10.0, 90.0, 180.0, 30.0, 120.0, 50.0, 5.0, 40.0, 10.0, 60.0, 110.0, 270.0, 30.0, 30.0, 10.0, 30.0, 70.0, 30.0, 50.0, 40.0, 150.0, 120.0, 100.0, 220.0, 60.0, 190.0, 30.0, 160.0, 110.0, 20.0, 10.0, 10.0, 35.0, 50.0, 30.0, 170.0, 30.0, 20.0, 10.0, 160.0, 40.0, 100.0, 100.0, -30.0, 120.0, 40.0, 50.0, 70.0, 130.0, -30.0, 0.0, 60.0, 80.0, 170.0, 90.0, 240.0, 170.0, 40.0, 230.0, 295.0, 80.0, 40.0, 100.0, 45.0, 70.0, 30.0, 10.0, 100.0, 30.0, 60.0, 30.0, 270.0, 30.0, 130.0, 40.0, 50.0, 30.0, 210.0, 70.0, 90.0, 160.0, 50.0, 50.0, 60.0, 270.0, 0.0, 10.0, -40.0, 50.0, 130.0, 40.0, 360.0, 10.0, 70.0, 40.0, 80.0, 0.0, 30.0, 110.0, 50.0, 40.0, 30.0, 70.0, 100.0, 20.0, 10.0, -50.0, 0.0, 50.0, 120.0, 40.0, 20.0, 150.0, 10.0, 100.0, 220.0, 40.0, 60.0, 180.0, 50.0, 120.0, 90.0, 30.0, 20.0, 110.0, 70.0, 70.0, 110.0, 120.0, 110.0, 210.0, 10.0, 120.0, 50.0, 90.0, 80.0, 140.0, -10.0, 60.0, 190.0, 100.0, 130.0, 120.0, 80.0, 10.0, 80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0, 270.0, 170.0, 60.0, 170.0, 50.0, 80.0, 190.0, 80.0, 90.0, 60.0, 90.0, -5.0, 160.0, 50.0, 90.0, 30.0, 20.0, 60.0, 50.0, 100.0, 110.0, 60.0, 220.0, 80.0, 30.0, 170.0, 10.0, 290.0, 100.0, -10.0, 170.0, 190.0, 50.0, 50.0, 120.0, 140.0, 100.0, 110.0, 20.0, 20.0, 20.0, 80.0, 10.0, 20.0, 160.0, 40.0, 80.0, 20.0, 10.0, 20.0, 110.0, 190.0, 70.0, -40.0, 20.0, 100.0, 20.0, 130.0, 120.0, 160.0, 70.0, 100.0, 120.0, 30.0, 180.0, 360.0, 30.0, 150.0, 100.0, -30.0, 110.0, 0.0, 120.0, 40.0, 90.0, 30.0, 100.0, 270.0, 40.0, 210.0, 60.0, 20.0, 150.0, 20.0, 60.0, 320.0, 60.0, 60.0, 30.0, -115.0, 210.0, 70.0, 50.0, 210.0, 100.0, 60.0, 110.0, 40.0, 50.0, 50.0, 30.0, 290.0, 210.0, 90.0, 480.0, 40.0, 140.0, 90.0, 40.0, 160.0, 260.0, 50.0, 60.0, 120.0, 10.0, 10.0, 20.0, 160.0, 400.0, 50.0, 100.0, 30.0, 90.0, 120.0, 20.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 30.0, 30.0, 170.0, 70.0, 10.0, 100.0, 70.0, 30.0, 350.0, 20.0, 110.0, 40.0, 50.0, 170.0, 100.0, 100.0, 160.0, 90.0, 140.0, 40.0, 10.0, 20.0, 30.0, 80.0, 90.0, 10.0, 110.0, 10.0, 40.0, 60.0, 50.0, 0.0, 30.0, 40.0, 50.0, 50.0, 10.0, 80.0, 60.0, 90.0, 90.0, 170.0, 60.0, 80.0, 80.0, 160.0, 100.0, 0.0, 90.0, 80.0, 5.0, 250.0, 30.0, 110.0, 80.0, 0.0, 80.0, -50.0, 190.0, 370.0, 85.0, 140.0, 50.0, 130.0, 80.0, 160.0, 110.0, 10.0, 10.0, 100.0, 40.0, 0.0, 25.0, 40.0, 100.0, 160.0, 220.0, 10.0, 70.0, 180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0, 120.0, 340.0, 80.0, 90.0, 170.0, 70.0, 80.0, 120.0, 80.0, 170.0, 10.0, 20.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 30.0, 60.0, 30.0, 0.0, 50.0, 30.0, 60.0, 30.0, 150.0, 80.0, 280.0, 40.0, 70.0, 100.0, 120.0, 80.0, 20.0, 240.0, 0.0, 50.0, 250.0, -10.0, 40.0, 330.0, 70.0, 90.0, 80.0, 210.0, 80.0, 60.0, 30.0, 110.0, 60.0, 120.0, 230.0, 140.0, 110.0, 130.0, 20.0, 10.0, 140.0, 70.0, 190.0, 160.0, -30.0, 480.0, 70.0, 60.0, 40.0, 140.0, 20.0, 40.0, 80.0, 100.0, 40.0, 30.0, 110.0, 40.0, 140.0, 50.0, 160.0, 70.0, 160.0, 60.0, -20.0, 60.0, 170.0, 230.0, 110.0, 70.0, 90.0, 10.0, 70.0, 10.0, 70.0, 230.0, 0.0, 90.0, 10.0, 120.0, 50.0, 40.0, 100.0, 30.0, 20.0, 50.0, 15.0, 200.0, 160.0, 200.0, 50.0, 150.0, 30.0, 20.0, 150.0, 10.0, 20.0, 20.0, 10.0, 270.0, 80.0, 80.0, 30.0, 140.0, 40.0, 35.0, 80.0, 50.0, 210.0, 20.0, 60.0, 90.0, 460.0, 80.0, 230.0, 10.0, 220.0, 150.0, 70.0, 150.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 100.0, 80.0, 250.0, 40.0, 90.0, 120.0, 80.0, 40.0, 130.0, 130.0, 50.0, 65.0, 90.0, 60.0, 40.0, 40.0, 140.0, 0.0, 90.0, 30.0, 20.0, 80.0, 60.0, 55.0, 170.0, 20.0, 40.0, 40.0, 80.0, 190.0, 0.0, 20.0, 90.0, 180.0, 0.0, 30.0, 40.0, 190.0, 30.0, 160.0, 80.0, 40.0, 30.0, 40.0, 60.0, 60.0, 80.0, 70.0, 30.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 10.0, 40.0, 0.0, 20.0, 90.0, 70.0, 50.0, 60.0, 230.0, 200.0, 30.0, 30.0, 10.0, 50.0, 280.0, 240.0, 30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0, 20.0, 10.0, 0.0, 45.0, 60.0, -70.0, 10.0, 70.0, -25.0, 20.0, 80.0, 20.0, 70.0, 110.0, 170.0, 50.0, 20.0, 40.0, 40.0, 10.0, 5.0, 60.0, 20.0, 100.0, 20.0, 20.0, 0.0, 30.0, 90.0, 140.0, 50.0, 10.0, 30.0, 20.0, 60.0, 150.0, 70.0, 50.0, 200.0, 10.0, 40.0, 20.0, 60.0, 60.0, 25.0, 180.0, 0.0, 210.0, 50.0, 40.0, 70.0, 10.0, 30.0, 90.0, 40.0, 60.0, 30.0, 40.0, 60.0, 40.0, 400.0, 90.0, 30.0, 120.0, 60.0, -20.0, 100.0, 150.0, 50.0, 160.0, 20.0, 80.0, 70.0, 210.0, 270.0, 160.0, 20.0, 60.0, 25.0, -30.0, 50.0, 120.0, 100.0, 160.0, 260.0, 80.0, 20.0, 20.0, 130.0, 20.0, 40.0, 80.0, 90.0, 20.0, 180.0, 90.0, 100.0, 20.0, 10.0, 50.0, 10.0, 0.0, 20.0, 50.0, 70.0, 30.0, 60.0, 10.0, 40.0, 10.0, 90.0, 70.0, 200.0, 140.0, 100.0, 210.0, 150.0, 40.0, 130.0, 150.0, -50.0, 20.0, 70.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 340.0, 90.0, 40.0, 70.0, 110.0, 190.0, 120.0, 20.0, 110.0, 130.0, 0.0, 280.0, -20.0, 150.0, 80.0, 70.0, 70.0, 30.0, 140.0, 120.0, 200.0, 0.0, 30.0, 60.0, 90.0, 80.0, 10.0, 10.0, 40.0, 90.0, 50.0, 30.0, 60.0, 95.0, 50.0, 420.0, 130.0, 80.0, 20.0, 50.0, 150.0, 30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0, 50.0, 70.0, 40.0, 20.0, 50.0, 70.0, 70.0, 20.0, 100.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 60.0, 150.0, 0.0, 50.0, 160.0, 270.0, 20.0, 200.0, 20.0, 110.0, 30.0, 70.0, 60.0, 0.0, 10.0, 30.0, 80.0, 20.0, 30.0, 60.0, 40.0, 90.0, 20.0, 30.0, 20.0, 50.0, 40.0, 40.0, 50.0, 80.0, 120.0, 30.0, 200.0, 120.0, 20.0, 180.0, 60.0, 10.0, 30.0, 30.0, 30.0, 10.0, 70.0, 70.0, 20.0, 50.0, 70.0, 40.0, 10.0, 10.0, 10.0, 30.0, 0.0, 50.0, 150.0, 210.0, 50.0, 20.0, -20.0, 70.0, 50.0, 30.0, 130.0, 0.0, 30.0, 30.0, 20.0, 80.0, 60.0, 150.0, 150.0, 70.0, 0.0, 230.0, 110.0, 90.0, 60.0, 60.0, -40.0, 100.0, 40.0, 200.0, 40.0, 0.0, 160.0, 0.0, 40.0, 40.0, 0.0, 40.0, 80.0, 110.0, 40.0, 30.0, 50.0, 100.0, 30.0, 70.0, 60.0, 300.0, 310.0, 30.0, 80.0, 300.0, 100.0, 130.0, -100.0, 50.0, 30.0, 20.0, 110.0, 100.0, 230.0, 60.0, 20.0, 20.0, 0.0, 90.0, 40.0, 170.0, 20.0, 70.0, 0.0, 90.0, 10.0, 250.0, 50.0, 10.0, 150.0, 0.0, 10.0, 90.0, 60.0, 350.0, 50.0, 80.0, 80.0, 70.0, 190.0, 20.0, 140.0, 80.0, 10.0, 150.0, 150.0, -20.0, 110.0, 60.0, 120.0, 20.0, 190.0, 130.0, 40.0, 20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5747588387787048, "mean_inference_ms": 1.413607446984512, "mean_action_processing_ms": 0.46036588107702336, "mean_env_wait_ms": 1.2748026636931307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012113571166992188, "StateBufferConnector_ms": 0.011185407638549805, "ViewRequirementAgentConnector_ms": 0.3855304718017578}, "num_episodes": 18, "episode_return_max": 1570.0, "episode_return_min": 140.0, "episode_return_mean": 790.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.25071486702303, "num_env_steps_trained_throughput_per_sec": 21.25071486702303, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 187054.193, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187054.131, "sample_time_ms": 2538.954, "learn_time_ms": 184494.706, "learn_throughput": 21.681, "synch_weights_time_ms": 11.468}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "33e63_00000", "date": "2024-06-18_23-00-04", "timestamp": 1718766004, "time_this_iter_s": 188.24195408821106, "time_total_s": 6787.5143430233, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6787.5143430233, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 26.2890977443609, "ram_util_percent": 78.90563909774437}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7916666037358415, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.872478254407612, "policy_loss": -0.00948004667410137, "vf_loss": 6.880536627896424, "vf_explained_var": 0.0018283730116895975, "kl": 0.007108362458265084, "entropy": 0.7448036773961446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1570.0, "episode_reward_min": 140.0, "episode_reward_mean": 819.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 81.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1200.0, 1220.0, 645.0, 1060.0, 970.0, 460.0, 880.0, 1110.0, 1010.0, 665.0, 950.0, 1570.0, 1140.0, 660.0, 890.0, 980.0, 440.0, 430.0, 920.0, 775.0, 1145.0, 765.0, 700.0, 1320.0, 220.0, 440.0, 1030.0, 1190.0, 1010.0, 1190.0, 740.0, 1050.0, 650.0, 785.0, 660.0, 1015.0, 1390.0, 370.0, 1010.0, 575.0, 735.0, 820.0, 460.0, 370.0, 1180.0, 910.0, 140.0, 610.0, 485.0, 650.0, 685.0, 470.0, 1140.0, 885.0, 960.0, 680.0, 300.0, 1280.0, 490.0, 880.0, 1120.0, 460.0, 1085.0, 850.0, 570.0, 340.0, 990.0, 380.0, 660.0, 560.0, 310.0, 740.0, 590.0, 890.0, 510.0, 1060.0, 970.0, 490.0, 720.0, 1070.0, 950.0, 780.0, 700.0, 510.0, 790.0, 680.0, 800.0, 1100.0, 910.0, 1050.0, 850.0, 1060.0, 940.0, 670.0, 1290.0, 1255.0, 880.0, 390.0, 1130.0, 1455.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 220.0, 310.0, 60.0, 180.0, 30.0, 80.0, 50.0, 90.0, 100.0, 270.0, 170.0, 60.0, 170.0, 50.0, 80.0, 190.0, 80.0, 90.0, 60.0, 90.0, -5.0, 160.0, 50.0, 90.0, 30.0, 20.0, 60.0, 50.0, 100.0, 110.0, 60.0, 220.0, 80.0, 30.0, 170.0, 10.0, 290.0, 100.0, -10.0, 170.0, 190.0, 50.0, 50.0, 120.0, 140.0, 100.0, 110.0, 20.0, 20.0, 20.0, 80.0, 10.0, 20.0, 160.0, 40.0, 80.0, 20.0, 10.0, 20.0, 110.0, 190.0, 70.0, -40.0, 20.0, 100.0, 20.0, 130.0, 120.0, 160.0, 70.0, 100.0, 120.0, 30.0, 180.0, 360.0, 30.0, 150.0, 100.0, -30.0, 110.0, 0.0, 120.0, 40.0, 90.0, 30.0, 100.0, 270.0, 40.0, 210.0, 60.0, 20.0, 150.0, 20.0, 60.0, 320.0, 60.0, 60.0, 30.0, -115.0, 210.0, 70.0, 50.0, 210.0, 100.0, 60.0, 110.0, 40.0, 50.0, 50.0, 30.0, 290.0, 210.0, 90.0, 480.0, 40.0, 140.0, 90.0, 40.0, 160.0, 260.0, 50.0, 60.0, 120.0, 10.0, 10.0, 20.0, 160.0, 400.0, 50.0, 100.0, 30.0, 90.0, 120.0, 20.0, 90.0, 90.0, 90.0, 0.0, 30.0, 30.0, 30.0, 30.0, 170.0, 70.0, 10.0, 100.0, 70.0, 30.0, 350.0, 20.0, 110.0, 40.0, 50.0, 170.0, 100.0, 100.0, 160.0, 90.0, 140.0, 40.0, 10.0, 20.0, 30.0, 80.0, 90.0, 10.0, 110.0, 10.0, 40.0, 60.0, 50.0, 0.0, 30.0, 40.0, 50.0, 50.0, 10.0, 80.0, 60.0, 90.0, 90.0, 170.0, 60.0, 80.0, 80.0, 160.0, 100.0, 0.0, 90.0, 80.0, 5.0, 250.0, 30.0, 110.0, 80.0, 0.0, 80.0, -50.0, 190.0, 370.0, 85.0, 140.0, 50.0, 130.0, 80.0, 160.0, 110.0, 10.0, 10.0, 100.0, 40.0, 0.0, 25.0, 40.0, 100.0, 160.0, 220.0, 10.0, 70.0, 180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0, 120.0, 340.0, 80.0, 90.0, 170.0, 70.0, 80.0, 120.0, 80.0, 170.0, 10.0, 20.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 30.0, 60.0, 30.0, 0.0, 50.0, 30.0, 60.0, 30.0, 150.0, 80.0, 280.0, 40.0, 70.0, 100.0, 120.0, 80.0, 20.0, 240.0, 0.0, 50.0, 250.0, -10.0, 40.0, 330.0, 70.0, 90.0, 80.0, 210.0, 80.0, 60.0, 30.0, 110.0, 60.0, 120.0, 230.0, 140.0, 110.0, 130.0, 20.0, 10.0, 140.0, 70.0, 190.0, 160.0, -30.0, 480.0, 70.0, 60.0, 40.0, 140.0, 20.0, 40.0, 80.0, 100.0, 40.0, 30.0, 110.0, 40.0, 140.0, 50.0, 160.0, 70.0, 160.0, 60.0, -20.0, 60.0, 170.0, 230.0, 110.0, 70.0, 90.0, 10.0, 70.0, 10.0, 70.0, 230.0, 0.0, 90.0, 10.0, 120.0, 50.0, 40.0, 100.0, 30.0, 20.0, 50.0, 15.0, 200.0, 160.0, 200.0, 50.0, 150.0, 30.0, 20.0, 150.0, 10.0, 20.0, 20.0, 10.0, 270.0, 80.0, 80.0, 30.0, 140.0, 40.0, 35.0, 80.0, 50.0, 210.0, 20.0, 60.0, 90.0, 460.0, 80.0, 230.0, 10.0, 220.0, 150.0, 70.0, 150.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 100.0, 80.0, 250.0, 40.0, 90.0, 120.0, 80.0, 40.0, 130.0, 130.0, 50.0, 65.0, 90.0, 60.0, 40.0, 40.0, 140.0, 0.0, 90.0, 30.0, 20.0, 80.0, 60.0, 55.0, 170.0, 20.0, 40.0, 40.0, 80.0, 190.0, 0.0, 20.0, 90.0, 180.0, 0.0, 30.0, 40.0, 190.0, 30.0, 160.0, 80.0, 40.0, 30.0, 40.0, 60.0, 60.0, 80.0, 70.0, 30.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 10.0, 40.0, 0.0, 20.0, 90.0, 70.0, 50.0, 60.0, 230.0, 200.0, 30.0, 30.0, 10.0, 50.0, 280.0, 240.0, 30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0, 20.0, 10.0, 0.0, 45.0, 60.0, -70.0, 10.0, 70.0, -25.0, 20.0, 80.0, 20.0, 70.0, 110.0, 170.0, 50.0, 20.0, 40.0, 40.0, 10.0, 5.0, 60.0, 20.0, 100.0, 20.0, 20.0, 0.0, 30.0, 90.0, 140.0, 50.0, 10.0, 30.0, 20.0, 60.0, 150.0, 70.0, 50.0, 200.0, 10.0, 40.0, 20.0, 60.0, 60.0, 25.0, 180.0, 0.0, 210.0, 50.0, 40.0, 70.0, 10.0, 30.0, 90.0, 40.0, 60.0, 30.0, 40.0, 60.0, 40.0, 400.0, 90.0, 30.0, 120.0, 60.0, -20.0, 100.0, 150.0, 50.0, 160.0, 20.0, 80.0, 70.0, 210.0, 270.0, 160.0, 20.0, 60.0, 25.0, -30.0, 50.0, 120.0, 100.0, 160.0, 260.0, 80.0, 20.0, 20.0, 130.0, 20.0, 40.0, 80.0, 90.0, 20.0, 180.0, 90.0, 100.0, 20.0, 10.0, 50.0, 10.0, 0.0, 20.0, 50.0, 70.0, 30.0, 60.0, 10.0, 40.0, 10.0, 90.0, 70.0, 200.0, 140.0, 100.0, 210.0, 150.0, 40.0, 130.0, 150.0, -50.0, 20.0, 70.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 340.0, 90.0, 40.0, 70.0, 110.0, 190.0, 120.0, 20.0, 110.0, 130.0, 0.0, 280.0, -20.0, 150.0, 80.0, 70.0, 70.0, 30.0, 140.0, 120.0, 200.0, 0.0, 30.0, 60.0, 90.0, 80.0, 10.0, 10.0, 40.0, 90.0, 50.0, 30.0, 60.0, 95.0, 50.0, 420.0, 130.0, 80.0, 20.0, 50.0, 150.0, 30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0, 50.0, 70.0, 40.0, 20.0, 50.0, 70.0, 70.0, 20.0, 100.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 60.0, 150.0, 0.0, 50.0, 160.0, 270.0, 20.0, 200.0, 20.0, 110.0, 30.0, 70.0, 60.0, 0.0, 10.0, 30.0, 80.0, 20.0, 30.0, 60.0, 40.0, 90.0, 20.0, 30.0, 20.0, 50.0, 40.0, 40.0, 50.0, 80.0, 120.0, 30.0, 200.0, 120.0, 20.0, 180.0, 60.0, 10.0, 30.0, 30.0, 30.0, 10.0, 70.0, 70.0, 20.0, 50.0, 70.0, 40.0, 10.0, 10.0, 10.0, 30.0, 0.0, 50.0, 150.0, 210.0, 50.0, 20.0, -20.0, 70.0, 50.0, 30.0, 130.0, 0.0, 30.0, 30.0, 20.0, 80.0, 60.0, 150.0, 150.0, 70.0, 0.0, 230.0, 110.0, 90.0, 60.0, 60.0, -40.0, 100.0, 40.0, 200.0, 40.0, 0.0, 160.0, 0.0, 40.0, 40.0, 0.0, 40.0, 80.0, 110.0, 40.0, 30.0, 50.0, 100.0, 30.0, 70.0, 60.0, 300.0, 310.0, 30.0, 80.0, 300.0, 100.0, 130.0, -100.0, 50.0, 30.0, 20.0, 110.0, 100.0, 230.0, 60.0, 20.0, 20.0, 0.0, 90.0, 40.0, 170.0, 20.0, 70.0, 0.0, 90.0, 10.0, 250.0, 50.0, 10.0, 150.0, 0.0, 10.0, 90.0, 60.0, 350.0, 50.0, 80.0, 80.0, 70.0, 190.0, 20.0, 140.0, 80.0, 10.0, 150.0, 150.0, -20.0, 110.0, 60.0, 120.0, 20.0, 190.0, 130.0, 40.0, 20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0, 40.0, 0.0, 0.0, 60.0, 20.0, 40.0, 80.0, 460.0, -40.0, 40.0, 20.0, 70.0, 40.0, 0.0, 10.0, 170.0, 230.0, 10.0, 50.0, -90.0, 190.0, 0.0, 70.0, 20.0, 50.0, 40.0, 90.0, 180.0, 60.0, 90.0, 40.0, 110.0, 0.0, 40.0, 130.0, 150.0, 110.0, 40.0, 30.0, 30.0, 130.0, 160.0, 230.0, 70.0, 150.0, 40.0, 20.0, -210.0, 90.0, 120.0, 50.0, 40.0, 20.0, 70.0, -50.0, 40.0, 110.0, 30.0, 640.0, 150.0, 10.0, 200.0, 80.0, 10.0, 70.0, 130.0, 180.0, 70.0, 70.0, 90.0, 90.0, 40.0, 180.0, 240.0, 240.0, 40.0, 40.0, 140.0, 30.0, 10.0, 40.0, 110.0, 90.0, 50.0, 30.0, 20.0, -30.0, 160.0, 0.0, 380.0, 210.0, 10.0, 80.0, 150.0, 160.0, 40.0, 140.0, 90.0, 70.0, 110.0, 30.0, -20.0, 100.0, 280.0, 110.0, 70.0, 10.0, 50.0, 250.0, 60.0, 30.0, 20.0, 20.0, 120.0, 70.0, 20.0, 150.0, 0.0, 90.0, 150.0, 80.0, 40.0, 310.0, 250.0, 120.0, 170.0, 10.0, 110.0, 110.0, 90.0, 80.0, 10.0, 160.0, 75.0, 320.0, 110.0, 210.0, 70.0, 80.0, 140.0, 50.0, 50.0, 30.0, 110.0, 80.0, 90.0, 160.0, 30.0, 180.0, 100.0, 20.0, 30.0, 60.0, 40.0, 80.0, 0.0, 30.0, 40.0, 30.0, 60.0, 80.0, 110.0, 40.0, 120.0, 100.0, 260.0, 280.0, 70.0, 10.0, 60.0, 50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5740918890524933, "mean_inference_ms": 1.4143103600827016, "mean_action_processing_ms": 0.4584034358572082, "mean_env_wait_ms": 1.2737126758727013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011777877807617188, "StateBufferConnector_ms": 0.010815620422363281, "ViewRequirementAgentConnector_ms": 0.3728458881378174}, "num_episodes": 18, "episode_return_max": 1570.0, "episode_return_min": 140.0, "episode_return_mean": 819.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.368008526531845, "num_env_steps_trained_throughput_per_sec": 21.368008526531845, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 187079.013, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187078.95, "sample_time_ms": 2568.226, "learn_time_ms": 184489.297, "learn_throughput": 21.681, "synch_weights_time_ms": 11.463}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "33e63_00000", "date": "2024-06-18_23-03-11", "timestamp": 1718766191, "time_this_iter_s": 187.20443296432495, "time_total_s": 6974.718775987625, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327184b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6974.718775987625, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 25.397735849056605, "ram_util_percent": 79.29433962264152}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.438673202837872, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.563726534096959, "policy_loss": -0.009999279995474675, "vf_loss": 6.5722619578226436, "vf_explained_var": 0.0008614440822499755, "kl": 0.007319277848465001, "entropy": 0.7461297355965176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1455.0, "episode_reward_min": 140.0, "episode_reward_mean": 783.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 78.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 1320.0, 220.0, 440.0, 1030.0, 1190.0, 1010.0, 1190.0, 740.0, 1050.0, 650.0, 785.0, 660.0, 1015.0, 1390.0, 370.0, 1010.0, 575.0, 735.0, 820.0, 460.0, 370.0, 1180.0, 910.0, 140.0, 610.0, 485.0, 650.0, 685.0, 470.0, 1140.0, 885.0, 960.0, 680.0, 300.0, 1280.0, 490.0, 880.0, 1120.0, 460.0, 1085.0, 850.0, 570.0, 340.0, 990.0, 380.0, 660.0, 560.0, 310.0, 740.0, 590.0, 890.0, 510.0, 1060.0, 970.0, 490.0, 720.0, 1070.0, 950.0, 780.0, 700.0, 510.0, 790.0, 680.0, 800.0, 1100.0, 910.0, 1050.0, 850.0, 1060.0, 940.0, 670.0, 1290.0, 1255.0, 880.0, 390.0, 1130.0, 1455.0, 320.0, 1110.0, 1090.0, 450.0, 830.0, 820.0, 450.0, 820.0, 1020.0, 800.0, 895.0, 530.0, 1150.0, 1060.0, 755.0, 200.0, 630.0, 1000.0, 1050.0, 290.0, 450.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 100.0, 40.0, 180.0, 10.0, 30.0, 30.0, 40.0, 80.0, 10.0, 120.0, 340.0, 80.0, 90.0, 170.0, 70.0, 80.0, 120.0, 80.0, 170.0, 10.0, 20.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 30.0, 60.0, 30.0, 0.0, 50.0, 30.0, 60.0, 30.0, 150.0, 80.0, 280.0, 40.0, 70.0, 100.0, 120.0, 80.0, 20.0, 240.0, 0.0, 50.0, 250.0, -10.0, 40.0, 330.0, 70.0, 90.0, 80.0, 210.0, 80.0, 60.0, 30.0, 110.0, 60.0, 120.0, 230.0, 140.0, 110.0, 130.0, 20.0, 10.0, 140.0, 70.0, 190.0, 160.0, -30.0, 480.0, 70.0, 60.0, 40.0, 140.0, 20.0, 40.0, 80.0, 100.0, 40.0, 30.0, 110.0, 40.0, 140.0, 50.0, 160.0, 70.0, 160.0, 60.0, -20.0, 60.0, 170.0, 230.0, 110.0, 70.0, 90.0, 10.0, 70.0, 10.0, 70.0, 230.0, 0.0, 90.0, 10.0, 120.0, 50.0, 40.0, 100.0, 30.0, 20.0, 50.0, 15.0, 200.0, 160.0, 200.0, 50.0, 150.0, 30.0, 20.0, 150.0, 10.0, 20.0, 20.0, 10.0, 270.0, 80.0, 80.0, 30.0, 140.0, 40.0, 35.0, 80.0, 50.0, 210.0, 20.0, 60.0, 90.0, 460.0, 80.0, 230.0, 10.0, 220.0, 150.0, 70.0, 150.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 70.0, 100.0, 80.0, 250.0, 40.0, 90.0, 120.0, 80.0, 40.0, 130.0, 130.0, 50.0, 65.0, 90.0, 60.0, 40.0, 40.0, 140.0, 0.0, 90.0, 30.0, 20.0, 80.0, 60.0, 55.0, 170.0, 20.0, 40.0, 40.0, 80.0, 190.0, 0.0, 20.0, 90.0, 180.0, 0.0, 30.0, 40.0, 190.0, 30.0, 160.0, 80.0, 40.0, 30.0, 40.0, 60.0, 60.0, 80.0, 70.0, 30.0, 20.0, 30.0, 20.0, 50.0, 20.0, 50.0, 10.0, 40.0, 0.0, 20.0, 90.0, 70.0, 50.0, 60.0, 230.0, 200.0, 30.0, 30.0, 10.0, 50.0, 280.0, 240.0, 30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0, 20.0, 10.0, 0.0, 45.0, 60.0, -70.0, 10.0, 70.0, -25.0, 20.0, 80.0, 20.0, 70.0, 110.0, 170.0, 50.0, 20.0, 40.0, 40.0, 10.0, 5.0, 60.0, 20.0, 100.0, 20.0, 20.0, 0.0, 30.0, 90.0, 140.0, 50.0, 10.0, 30.0, 20.0, 60.0, 150.0, 70.0, 50.0, 200.0, 10.0, 40.0, 20.0, 60.0, 60.0, 25.0, 180.0, 0.0, 210.0, 50.0, 40.0, 70.0, 10.0, 30.0, 90.0, 40.0, 60.0, 30.0, 40.0, 60.0, 40.0, 400.0, 90.0, 30.0, 120.0, 60.0, -20.0, 100.0, 150.0, 50.0, 160.0, 20.0, 80.0, 70.0, 210.0, 270.0, 160.0, 20.0, 60.0, 25.0, -30.0, 50.0, 120.0, 100.0, 160.0, 260.0, 80.0, 20.0, 20.0, 130.0, 20.0, 40.0, 80.0, 90.0, 20.0, 180.0, 90.0, 100.0, 20.0, 10.0, 50.0, 10.0, 0.0, 20.0, 50.0, 70.0, 30.0, 60.0, 10.0, 40.0, 10.0, 90.0, 70.0, 200.0, 140.0, 100.0, 210.0, 150.0, 40.0, 130.0, 150.0, -50.0, 20.0, 70.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 340.0, 90.0, 40.0, 70.0, 110.0, 190.0, 120.0, 20.0, 110.0, 130.0, 0.0, 280.0, -20.0, 150.0, 80.0, 70.0, 70.0, 30.0, 140.0, 120.0, 200.0, 0.0, 30.0, 60.0, 90.0, 80.0, 10.0, 10.0, 40.0, 90.0, 50.0, 30.0, 60.0, 95.0, 50.0, 420.0, 130.0, 80.0, 20.0, 50.0, 150.0, 30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0, 50.0, 70.0, 40.0, 20.0, 50.0, 70.0, 70.0, 20.0, 100.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 60.0, 150.0, 0.0, 50.0, 160.0, 270.0, 20.0, 200.0, 20.0, 110.0, 30.0, 70.0, 60.0, 0.0, 10.0, 30.0, 80.0, 20.0, 30.0, 60.0, 40.0, 90.0, 20.0, 30.0, 20.0, 50.0, 40.0, 40.0, 50.0, 80.0, 120.0, 30.0, 200.0, 120.0, 20.0, 180.0, 60.0, 10.0, 30.0, 30.0, 30.0, 10.0, 70.0, 70.0, 20.0, 50.0, 70.0, 40.0, 10.0, 10.0, 10.0, 30.0, 0.0, 50.0, 150.0, 210.0, 50.0, 20.0, -20.0, 70.0, 50.0, 30.0, 130.0, 0.0, 30.0, 30.0, 20.0, 80.0, 60.0, 150.0, 150.0, 70.0, 0.0, 230.0, 110.0, 90.0, 60.0, 60.0, -40.0, 100.0, 40.0, 200.0, 40.0, 0.0, 160.0, 0.0, 40.0, 40.0, 0.0, 40.0, 80.0, 110.0, 40.0, 30.0, 50.0, 100.0, 30.0, 70.0, 60.0, 300.0, 310.0, 30.0, 80.0, 300.0, 100.0, 130.0, -100.0, 50.0, 30.0, 20.0, 110.0, 100.0, 230.0, 60.0, 20.0, 20.0, 0.0, 90.0, 40.0, 170.0, 20.0, 70.0, 0.0, 90.0, 10.0, 250.0, 50.0, 10.0, 150.0, 0.0, 10.0, 90.0, 60.0, 350.0, 50.0, 80.0, 80.0, 70.0, 190.0, 20.0, 140.0, 80.0, 10.0, 150.0, 150.0, -20.0, 110.0, 60.0, 120.0, 20.0, 190.0, 130.0, 40.0, 20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0, 40.0, 0.0, 0.0, 60.0, 20.0, 40.0, 80.0, 460.0, -40.0, 40.0, 20.0, 70.0, 40.0, 0.0, 10.0, 170.0, 230.0, 10.0, 50.0, -90.0, 190.0, 0.0, 70.0, 20.0, 50.0, 40.0, 90.0, 180.0, 60.0, 90.0, 40.0, 110.0, 0.0, 40.0, 130.0, 150.0, 110.0, 40.0, 30.0, 30.0, 130.0, 160.0, 230.0, 70.0, 150.0, 40.0, 20.0, -210.0, 90.0, 120.0, 50.0, 40.0, 20.0, 70.0, -50.0, 40.0, 110.0, 30.0, 640.0, 150.0, 10.0, 200.0, 80.0, 10.0, 70.0, 130.0, 180.0, 70.0, 70.0, 90.0, 90.0, 40.0, 180.0, 240.0, 240.0, 40.0, 40.0, 140.0, 30.0, 10.0, 40.0, 110.0, 90.0, 50.0, 30.0, 20.0, -30.0, 160.0, 0.0, 380.0, 210.0, 10.0, 80.0, 150.0, 160.0, 40.0, 140.0, 90.0, 70.0, 110.0, 30.0, -20.0, 100.0, 280.0, 110.0, 70.0, 10.0, 50.0, 250.0, 60.0, 30.0, 20.0, 20.0, 120.0, 70.0, 20.0, 150.0, 0.0, 90.0, 150.0, 80.0, 40.0, 310.0, 250.0, 120.0, 170.0, 10.0, 110.0, 110.0, 90.0, 80.0, 10.0, 160.0, 75.0, 320.0, 110.0, 210.0, 70.0, 80.0, 140.0, 50.0, 50.0, 30.0, 110.0, 80.0, 90.0, 160.0, 30.0, 180.0, 100.0, 20.0, 30.0, 60.0, 40.0, 80.0, 0.0, 30.0, 40.0, 30.0, 60.0, 80.0, 110.0, 40.0, 120.0, 100.0, 260.0, 280.0, 70.0, 10.0, 60.0, 50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 30.0, 140.0, 30.0, 30.0, 390.0, 230.0, 50.0, 100.0, 40.0, 30.0, 130.0, 60.0, 150.0, -70.0, 40.0, 240.0, 70.0, 80.0, 180.0, 140.0, 70.0, 110.0, 70.0, 90.0, 70.0, 40.0, 30.0, 10.0, 70.0, 10.0, 10.0, 30.0, 160.0, 20.0, 50.0, -20.0, 110.0, 170.0, 10.0, 20.0, 120.0, 30.0, 160.0, 180.0, 190.0, 10.0, 30.0, 40.0, 70.0, 0.0, 110.0, 10.0, 200.0, 160.0, 0.0, 10.0, 50.0, 100.0, 50.0, 90.0, 50.0, 30.0, 20.0, 50.0, 150.0, 160.0, 70.0, 60.0, 60.0, 350.0, -180.0, 50.0, 90.0, 10.0, -50.0, 30.0, 50.0, 370.0, 310.0, 120.0, 50.0, 90.0, 40.0, 10.0, 60.0, 40.0, 40.0, 80.0, 120.0, 30.0, 70.0, 130.0, 170.0, 60.0, 150.0, 90.0, 90.0, 40.0, 65.0, 30.0, 80.0, 200.0, 90.0, 60.0, 0.0, 20.0, 50.0, 30.0, 50.0, 130.0, 30.0, 200.0, 10.0, 10.0, 90.0, 310.0, 110.0, 300.0, 160.0, 30.0, 90.0, 40.0, 20.0, 0.0, 110.0, 0.0, 150.0, 60.0, -20.0, 210.0, 80.0, 60.0, 310.0, 100.0, 40.0, 50.0, 190.0, 30.0, 60.0, 90.0, 55.0, 90.0, 60.0, 90.0, 20.0, 10.0, 30.0, 0.0, 50.0, 40.0, 20.0, 30.0, 0.0, 0.0, 80.0, 50.0, -80.0, 10.0, 90.0, 90.0, 40.0, 80.0, 200.0, 70.0, 60.0, 130.0, 90.0, 130.0, 40.0, 60.0, 150.0, 220.0, 80.0, 40.0, 80.0, 70.0, 230.0, 150.0, 50.0, 30.0, -30.0, 150.0, 270.0, 50.0, 50.0, 80.0, 0.0, 50.0, 40.0, 5.0, 30.0, 40.0, 10.0, -15.0, 60.0, 90.0, 20.0, 40.0, 0.0, 150.0, 20.0, 20.0, 30.0, 20.0, 50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5721489156069937, "mean_inference_ms": 1.413595173382405, "mean_action_processing_ms": 0.45598990568506886, "mean_env_wait_ms": 1.2718273372679858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01177358627319336, "StateBufferConnector_ms": 0.010843515396118164, "ViewRequirementAgentConnector_ms": 0.3718600273132324}, "num_episodes": 22, "episode_return_max": 1455.0, "episode_return_min": 140.0, "episode_return_mean": 783.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.43467934559899, "num_env_steps_trained_throughput_per_sec": 21.43467934559899, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 187026.75, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187026.687, "sample_time_ms": 2579.634, "learn_time_ms": 184425.474, "learn_throughput": 21.689, "synch_weights_time_ms": 11.482}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "33e63_00000", "date": "2024-06-18_23-06-18", "timestamp": 1718766378, "time_this_iter_s": 186.62259006500244, "time_total_s": 7161.341366052628, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272e4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7161.341366052628, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 24.990530303030305, "ram_util_percent": 79.24507575757576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6017542207393403, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7524378124517375, "policy_loss": -0.009996146604238242, "vf_loss": 6.7609777227123455, "vf_explained_var": 0.0004723064244364778, "kl": 0.007281148478316848, "entropy": 0.7243308408445698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1595.0, "episode_reward_min": 140.0, "episode_reward_mean": 786.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 78.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 140.0, 610.0, 485.0, 650.0, 685.0, 470.0, 1140.0, 885.0, 960.0, 680.0, 300.0, 1280.0, 490.0, 880.0, 1120.0, 460.0, 1085.0, 850.0, 570.0, 340.0, 990.0, 380.0, 660.0, 560.0, 310.0, 740.0, 590.0, 890.0, 510.0, 1060.0, 970.0, 490.0, 720.0, 1070.0, 950.0, 780.0, 700.0, 510.0, 790.0, 680.0, 800.0, 1100.0, 910.0, 1050.0, 850.0, 1060.0, 940.0, 670.0, 1290.0, 1255.0, 880.0, 390.0, 1130.0, 1455.0, 320.0, 1110.0, 1090.0, 450.0, 830.0, 820.0, 450.0, 820.0, 1020.0, 800.0, 895.0, 530.0, 1150.0, 1060.0, 755.0, 200.0, 630.0, 1000.0, 1050.0, 290.0, 450.0, 630.0, 845.0, 1150.0, 700.0, 1140.0, 670.0, 530.0, 980.0, 490.0, 805.0, 1150.0, 770.0, 680.0, 750.0, 390.0, 1230.0, 385.0, 1020.0, 850.0, 920.0, 900.0, 660.0, 1595.0, 590.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 70.0, 220.0, 80.0, 20.0, 160.0, 60.0, 50.0, 190.0, 20.0, 10.0, 0.0, 45.0, 60.0, -70.0, 10.0, 70.0, -25.0, 20.0, 80.0, 20.0, 70.0, 110.0, 170.0, 50.0, 20.0, 40.0, 40.0, 10.0, 5.0, 60.0, 20.0, 100.0, 20.0, 20.0, 0.0, 30.0, 90.0, 140.0, 50.0, 10.0, 30.0, 20.0, 60.0, 150.0, 70.0, 50.0, 200.0, 10.0, 40.0, 20.0, 60.0, 60.0, 25.0, 180.0, 0.0, 210.0, 50.0, 40.0, 70.0, 10.0, 30.0, 90.0, 40.0, 60.0, 30.0, 40.0, 60.0, 40.0, 400.0, 90.0, 30.0, 120.0, 60.0, -20.0, 100.0, 150.0, 50.0, 160.0, 20.0, 80.0, 70.0, 210.0, 270.0, 160.0, 20.0, 60.0, 25.0, -30.0, 50.0, 120.0, 100.0, 160.0, 260.0, 80.0, 20.0, 20.0, 130.0, 20.0, 40.0, 80.0, 90.0, 20.0, 180.0, 90.0, 100.0, 20.0, 10.0, 50.0, 10.0, 0.0, 20.0, 50.0, 70.0, 30.0, 60.0, 10.0, 40.0, 10.0, 90.0, 70.0, 200.0, 140.0, 100.0, 210.0, 150.0, 40.0, 130.0, 150.0, -50.0, 20.0, 70.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 340.0, 90.0, 40.0, 70.0, 110.0, 190.0, 120.0, 20.0, 110.0, 130.0, 0.0, 280.0, -20.0, 150.0, 80.0, 70.0, 70.0, 30.0, 140.0, 120.0, 200.0, 0.0, 30.0, 60.0, 90.0, 80.0, 10.0, 10.0, 40.0, 90.0, 50.0, 30.0, 60.0, 95.0, 50.0, 420.0, 130.0, 80.0, 20.0, 50.0, 150.0, 30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0, 50.0, 70.0, 40.0, 20.0, 50.0, 70.0, 70.0, 20.0, 100.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 60.0, 150.0, 0.0, 50.0, 160.0, 270.0, 20.0, 200.0, 20.0, 110.0, 30.0, 70.0, 60.0, 0.0, 10.0, 30.0, 80.0, 20.0, 30.0, 60.0, 40.0, 90.0, 20.0, 30.0, 20.0, 50.0, 40.0, 40.0, 50.0, 80.0, 120.0, 30.0, 200.0, 120.0, 20.0, 180.0, 60.0, 10.0, 30.0, 30.0, 30.0, 10.0, 70.0, 70.0, 20.0, 50.0, 70.0, 40.0, 10.0, 10.0, 10.0, 30.0, 0.0, 50.0, 150.0, 210.0, 50.0, 20.0, -20.0, 70.0, 50.0, 30.0, 130.0, 0.0, 30.0, 30.0, 20.0, 80.0, 60.0, 150.0, 150.0, 70.0, 0.0, 230.0, 110.0, 90.0, 60.0, 60.0, -40.0, 100.0, 40.0, 200.0, 40.0, 0.0, 160.0, 0.0, 40.0, 40.0, 0.0, 40.0, 80.0, 110.0, 40.0, 30.0, 50.0, 100.0, 30.0, 70.0, 60.0, 300.0, 310.0, 30.0, 80.0, 300.0, 100.0, 130.0, -100.0, 50.0, 30.0, 20.0, 110.0, 100.0, 230.0, 60.0, 20.0, 20.0, 0.0, 90.0, 40.0, 170.0, 20.0, 70.0, 0.0, 90.0, 10.0, 250.0, 50.0, 10.0, 150.0, 0.0, 10.0, 90.0, 60.0, 350.0, 50.0, 80.0, 80.0, 70.0, 190.0, 20.0, 140.0, 80.0, 10.0, 150.0, 150.0, -20.0, 110.0, 60.0, 120.0, 20.0, 190.0, 130.0, 40.0, 20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0, 40.0, 0.0, 0.0, 60.0, 20.0, 40.0, 80.0, 460.0, -40.0, 40.0, 20.0, 70.0, 40.0, 0.0, 10.0, 170.0, 230.0, 10.0, 50.0, -90.0, 190.0, 0.0, 70.0, 20.0, 50.0, 40.0, 90.0, 180.0, 60.0, 90.0, 40.0, 110.0, 0.0, 40.0, 130.0, 150.0, 110.0, 40.0, 30.0, 30.0, 130.0, 160.0, 230.0, 70.0, 150.0, 40.0, 20.0, -210.0, 90.0, 120.0, 50.0, 40.0, 20.0, 70.0, -50.0, 40.0, 110.0, 30.0, 640.0, 150.0, 10.0, 200.0, 80.0, 10.0, 70.0, 130.0, 180.0, 70.0, 70.0, 90.0, 90.0, 40.0, 180.0, 240.0, 240.0, 40.0, 40.0, 140.0, 30.0, 10.0, 40.0, 110.0, 90.0, 50.0, 30.0, 20.0, -30.0, 160.0, 0.0, 380.0, 210.0, 10.0, 80.0, 150.0, 160.0, 40.0, 140.0, 90.0, 70.0, 110.0, 30.0, -20.0, 100.0, 280.0, 110.0, 70.0, 10.0, 50.0, 250.0, 60.0, 30.0, 20.0, 20.0, 120.0, 70.0, 20.0, 150.0, 0.0, 90.0, 150.0, 80.0, 40.0, 310.0, 250.0, 120.0, 170.0, 10.0, 110.0, 110.0, 90.0, 80.0, 10.0, 160.0, 75.0, 320.0, 110.0, 210.0, 70.0, 80.0, 140.0, 50.0, 50.0, 30.0, 110.0, 80.0, 90.0, 160.0, 30.0, 180.0, 100.0, 20.0, 30.0, 60.0, 40.0, 80.0, 0.0, 30.0, 40.0, 30.0, 60.0, 80.0, 110.0, 40.0, 120.0, 100.0, 260.0, 280.0, 70.0, 10.0, 60.0, 50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 30.0, 140.0, 30.0, 30.0, 390.0, 230.0, 50.0, 100.0, 40.0, 30.0, 130.0, 60.0, 150.0, -70.0, 40.0, 240.0, 70.0, 80.0, 180.0, 140.0, 70.0, 110.0, 70.0, 90.0, 70.0, 40.0, 30.0, 10.0, 70.0, 10.0, 10.0, 30.0, 160.0, 20.0, 50.0, -20.0, 110.0, 170.0, 10.0, 20.0, 120.0, 30.0, 160.0, 180.0, 190.0, 10.0, 30.0, 40.0, 70.0, 0.0, 110.0, 10.0, 200.0, 160.0, 0.0, 10.0, 50.0, 100.0, 50.0, 90.0, 50.0, 30.0, 20.0, 50.0, 150.0, 160.0, 70.0, 60.0, 60.0, 350.0, -180.0, 50.0, 90.0, 10.0, -50.0, 30.0, 50.0, 370.0, 310.0, 120.0, 50.0, 90.0, 40.0, 10.0, 60.0, 40.0, 40.0, 80.0, 120.0, 30.0, 70.0, 130.0, 170.0, 60.0, 150.0, 90.0, 90.0, 40.0, 65.0, 30.0, 80.0, 200.0, 90.0, 60.0, 0.0, 20.0, 50.0, 30.0, 50.0, 130.0, 30.0, 200.0, 10.0, 10.0, 90.0, 310.0, 110.0, 300.0, 160.0, 30.0, 90.0, 40.0, 20.0, 0.0, 110.0, 0.0, 150.0, 60.0, -20.0, 210.0, 80.0, 60.0, 310.0, 100.0, 40.0, 50.0, 190.0, 30.0, 60.0, 90.0, 55.0, 90.0, 60.0, 90.0, 20.0, 10.0, 30.0, 0.0, 50.0, 40.0, 20.0, 30.0, 0.0, 0.0, 80.0, 50.0, -80.0, 10.0, 90.0, 90.0, 40.0, 80.0, 200.0, 70.0, 60.0, 130.0, 90.0, 130.0, 40.0, 60.0, 150.0, 220.0, 80.0, 40.0, 80.0, 70.0, 230.0, 150.0, 50.0, 30.0, -30.0, 150.0, 270.0, 50.0, 50.0, 80.0, 0.0, 50.0, 40.0, 5.0, 30.0, 40.0, 10.0, -15.0, 60.0, 90.0, 20.0, 40.0, 0.0, 150.0, 20.0, 20.0, 30.0, 20.0, 50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0, 0.0, 150.0, 90.0, 50.0, 10.0, -40.0, 20.0, 20.0, 365.0, 180.0, 60.0, 90.0, 110.0, 70.0, 70.0, 190.0, 110.0, 310.0, 80.0, 60.0, 20.0, 110.0, 210.0, 50.0, 90.0, 40.0, 80.0, 30.0, 60.0, 10.0, 190.0, 0.0, 150.0, 30.0, 350.0, 30.0, 40.0, 300.0, 20.0, 30.0, 80.0, 60.0, 50.0, 250.0, 40.0, 30.0, 30.0, 40.0, 20.0, 70.0, 30.0, 30.0, 40.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 180.0, 30.0, -50.0, 300.0, 30.0, 210.0, 50.0, 320.0, 20.0, 60.0, 10.0, 30.0, 30.0, 10.0, 10.0, -40.0, 10.0, 70.0, 20.0, 370.0, -20.0, 70.0, 50.0, 50.0, 20.0, 60.0, 40.0, 10.0, -5.0, 100.0, 410.0, 240.0, 60.0, 160.0, 350.0, 30.0, 80.0, 150.0, 50.0, 20.0, 10.0, 10.0, 40.0, -10.0, 380.0, 30.0, 80.0, 40.0, 20.0, 160.0, 20.0, 80.0, 0.0, 30.0, 70.0, 80.0, 230.0, 80.0, 0.0, 30.0, 80.0, 40.0, 190.0, 50.0, 60.0, 0.0, 20.0, 70.0, 190.0, 40.0, 90.0, 50.0, 50.0, 50.0, 40.0, 40.0, 40.0, 70.0, 30.0, 20.0, 0.0, 0.0, 90.0, 130.0, 100.0, 10.0, 570.0, 90.0, 90.0, 80.0, 70.0, 70.0, 20.0, 0.0, 20.0, 40.0, 45.0, 20.0, 20.0, 100.0, 50.0, 50.0, 60.0, 100.0, 440.0, 30.0, 30.0, 190.0, 30.0, 40.0, 50.0, 20.0, 60.0, 100.0, 20.0, 150.0, 80.0, 60.0, 260.0, 30.0, 70.0, 10.0, 160.0, 50.0, 20.0, 100.0, 130.0, 290.0, 100.0, 20.0, 40.0, 60.0, 40.0, 180.0, 160.0, 70.0, 70.0, 100.0, 70.0, 120.0, 30.0, 0.0, 150.0, 40.0, 20.0, 160.0, 60.0, 40.0, 10.0, 10.0, 170.0, 190.0, 150.0, 60.0, 295.0, 70.0, 80.0, 450.0, 70.0, 130.0, 100.0, -70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.569771597545618, "mean_inference_ms": 1.4120976957569311, "mean_action_processing_ms": 0.4535698801897458, "mean_env_wait_ms": 1.269499470015925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012081146240234375, "StateBufferConnector_ms": 0.009032249450683594, "ViewRequirementAgentConnector_ms": 0.3652949333190918}, "num_episodes": 23, "episode_return_max": 1595.0, "episode_return_min": 140.0, "episode_return_mean": 786.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.41575875545288, "num_env_steps_trained_throughput_per_sec": 21.41575875545288, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 186950.211, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186950.149, "sample_time_ms": 2544.064, "learn_time_ms": 184384.951, "learn_throughput": 21.694, "synch_weights_time_ms": 11.14}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "33e63_00000", "date": "2024-06-18_23-09-25", "timestamp": 1718766565, "time_this_iter_s": 186.78704118728638, "time_total_s": 7348.128407239914, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272eb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7348.128407239914, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 24.96818181818182, "ram_util_percent": 79.89772727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5487522106010694, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.380257947858784, "policy_loss": -0.009495906871150886, "vf_loss": 7.388330587005209, "vf_explained_var": -0.00030936440720725746, "kl": 0.0071163365529579295, "entropy": 0.700815552244552, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1595.0, "episode_reward_min": 200.0, "episode_reward_mean": 803.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 80.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0, 570.0, 340.0, 990.0, 380.0, 660.0, 560.0, 310.0, 740.0, 590.0, 890.0, 510.0, 1060.0, 970.0, 490.0, 720.0, 1070.0, 950.0, 780.0, 700.0, 510.0, 790.0, 680.0, 800.0, 1100.0, 910.0, 1050.0, 850.0, 1060.0, 940.0, 670.0, 1290.0, 1255.0, 880.0, 390.0, 1130.0, 1455.0, 320.0, 1110.0, 1090.0, 450.0, 830.0, 820.0, 450.0, 820.0, 1020.0, 800.0, 895.0, 530.0, 1150.0, 1060.0, 755.0, 200.0, 630.0, 1000.0, 1050.0, 290.0, 450.0, 630.0, 845.0, 1150.0, 700.0, 1140.0, 670.0, 530.0, 980.0, 490.0, 805.0, 1150.0, 770.0, 680.0, 750.0, 390.0, 1230.0, 385.0, 1020.0, 850.0, 920.0, 900.0, 660.0, 1595.0, 590.0, 955.0, 1145.0, 650.0, 640.0, 980.0, 580.0, 475.0, 830.0, 1030.0, 780.0, 440.0, 1080.0, 880.0, 530.0, 1330.0, 690.0, 1060.0, 825.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 10.0, 60.0, 110.0, 310.0, 10.0, 50.0, 100.0, 100.0, 50.0, 70.0, 40.0, 20.0, 50.0, 70.0, 70.0, 20.0, 100.0, 80.0, 50.0, 0.0, 40.0, 0.0, 10.0, 0.0, 30.0, 60.0, 150.0, 0.0, 50.0, 160.0, 270.0, 20.0, 200.0, 20.0, 110.0, 30.0, 70.0, 60.0, 0.0, 10.0, 30.0, 80.0, 20.0, 30.0, 60.0, 40.0, 90.0, 20.0, 30.0, 20.0, 50.0, 40.0, 40.0, 50.0, 80.0, 120.0, 30.0, 200.0, 120.0, 20.0, 180.0, 60.0, 10.0, 30.0, 30.0, 30.0, 10.0, 70.0, 70.0, 20.0, 50.0, 70.0, 40.0, 10.0, 10.0, 10.0, 30.0, 0.0, 50.0, 150.0, 210.0, 50.0, 20.0, -20.0, 70.0, 50.0, 30.0, 130.0, 0.0, 30.0, 30.0, 20.0, 80.0, 60.0, 150.0, 150.0, 70.0, 0.0, 230.0, 110.0, 90.0, 60.0, 60.0, -40.0, 100.0, 40.0, 200.0, 40.0, 0.0, 160.0, 0.0, 40.0, 40.0, 0.0, 40.0, 80.0, 110.0, 40.0, 30.0, 50.0, 100.0, 30.0, 70.0, 60.0, 300.0, 310.0, 30.0, 80.0, 300.0, 100.0, 130.0, -100.0, 50.0, 30.0, 20.0, 110.0, 100.0, 230.0, 60.0, 20.0, 20.0, 0.0, 90.0, 40.0, 170.0, 20.0, 70.0, 0.0, 90.0, 10.0, 250.0, 50.0, 10.0, 150.0, 0.0, 10.0, 90.0, 60.0, 350.0, 50.0, 80.0, 80.0, 70.0, 190.0, 20.0, 140.0, 80.0, 10.0, 150.0, 150.0, -20.0, 110.0, 60.0, 120.0, 20.0, 190.0, 130.0, 40.0, 20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0, 40.0, 0.0, 0.0, 60.0, 20.0, 40.0, 80.0, 460.0, -40.0, 40.0, 20.0, 70.0, 40.0, 0.0, 10.0, 170.0, 230.0, 10.0, 50.0, -90.0, 190.0, 0.0, 70.0, 20.0, 50.0, 40.0, 90.0, 180.0, 60.0, 90.0, 40.0, 110.0, 0.0, 40.0, 130.0, 150.0, 110.0, 40.0, 30.0, 30.0, 130.0, 160.0, 230.0, 70.0, 150.0, 40.0, 20.0, -210.0, 90.0, 120.0, 50.0, 40.0, 20.0, 70.0, -50.0, 40.0, 110.0, 30.0, 640.0, 150.0, 10.0, 200.0, 80.0, 10.0, 70.0, 130.0, 180.0, 70.0, 70.0, 90.0, 90.0, 40.0, 180.0, 240.0, 240.0, 40.0, 40.0, 140.0, 30.0, 10.0, 40.0, 110.0, 90.0, 50.0, 30.0, 20.0, -30.0, 160.0, 0.0, 380.0, 210.0, 10.0, 80.0, 150.0, 160.0, 40.0, 140.0, 90.0, 70.0, 110.0, 30.0, -20.0, 100.0, 280.0, 110.0, 70.0, 10.0, 50.0, 250.0, 60.0, 30.0, 20.0, 20.0, 120.0, 70.0, 20.0, 150.0, 0.0, 90.0, 150.0, 80.0, 40.0, 310.0, 250.0, 120.0, 170.0, 10.0, 110.0, 110.0, 90.0, 80.0, 10.0, 160.0, 75.0, 320.0, 110.0, 210.0, 70.0, 80.0, 140.0, 50.0, 50.0, 30.0, 110.0, 80.0, 90.0, 160.0, 30.0, 180.0, 100.0, 20.0, 30.0, 60.0, 40.0, 80.0, 0.0, 30.0, 40.0, 30.0, 60.0, 80.0, 110.0, 40.0, 120.0, 100.0, 260.0, 280.0, 70.0, 10.0, 60.0, 50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 30.0, 140.0, 30.0, 30.0, 390.0, 230.0, 50.0, 100.0, 40.0, 30.0, 130.0, 60.0, 150.0, -70.0, 40.0, 240.0, 70.0, 80.0, 180.0, 140.0, 70.0, 110.0, 70.0, 90.0, 70.0, 40.0, 30.0, 10.0, 70.0, 10.0, 10.0, 30.0, 160.0, 20.0, 50.0, -20.0, 110.0, 170.0, 10.0, 20.0, 120.0, 30.0, 160.0, 180.0, 190.0, 10.0, 30.0, 40.0, 70.0, 0.0, 110.0, 10.0, 200.0, 160.0, 0.0, 10.0, 50.0, 100.0, 50.0, 90.0, 50.0, 30.0, 20.0, 50.0, 150.0, 160.0, 70.0, 60.0, 60.0, 350.0, -180.0, 50.0, 90.0, 10.0, -50.0, 30.0, 50.0, 370.0, 310.0, 120.0, 50.0, 90.0, 40.0, 10.0, 60.0, 40.0, 40.0, 80.0, 120.0, 30.0, 70.0, 130.0, 170.0, 60.0, 150.0, 90.0, 90.0, 40.0, 65.0, 30.0, 80.0, 200.0, 90.0, 60.0, 0.0, 20.0, 50.0, 30.0, 50.0, 130.0, 30.0, 200.0, 10.0, 10.0, 90.0, 310.0, 110.0, 300.0, 160.0, 30.0, 90.0, 40.0, 20.0, 0.0, 110.0, 0.0, 150.0, 60.0, -20.0, 210.0, 80.0, 60.0, 310.0, 100.0, 40.0, 50.0, 190.0, 30.0, 60.0, 90.0, 55.0, 90.0, 60.0, 90.0, 20.0, 10.0, 30.0, 0.0, 50.0, 40.0, 20.0, 30.0, 0.0, 0.0, 80.0, 50.0, -80.0, 10.0, 90.0, 90.0, 40.0, 80.0, 200.0, 70.0, 60.0, 130.0, 90.0, 130.0, 40.0, 60.0, 150.0, 220.0, 80.0, 40.0, 80.0, 70.0, 230.0, 150.0, 50.0, 30.0, -30.0, 150.0, 270.0, 50.0, 50.0, 80.0, 0.0, 50.0, 40.0, 5.0, 30.0, 40.0, 10.0, -15.0, 60.0, 90.0, 20.0, 40.0, 0.0, 150.0, 20.0, 20.0, 30.0, 20.0, 50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0, 0.0, 150.0, 90.0, 50.0, 10.0, -40.0, 20.0, 20.0, 365.0, 180.0, 60.0, 90.0, 110.0, 70.0, 70.0, 190.0, 110.0, 310.0, 80.0, 60.0, 20.0, 110.0, 210.0, 50.0, 90.0, 40.0, 80.0, 30.0, 60.0, 10.0, 190.0, 0.0, 150.0, 30.0, 350.0, 30.0, 40.0, 300.0, 20.0, 30.0, 80.0, 60.0, 50.0, 250.0, 40.0, 30.0, 30.0, 40.0, 20.0, 70.0, 30.0, 30.0, 40.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 180.0, 30.0, -50.0, 300.0, 30.0, 210.0, 50.0, 320.0, 20.0, 60.0, 10.0, 30.0, 30.0, 10.0, 10.0, -40.0, 10.0, 70.0, 20.0, 370.0, -20.0, 70.0, 50.0, 50.0, 20.0, 60.0, 40.0, 10.0, -5.0, 100.0, 410.0, 240.0, 60.0, 160.0, 350.0, 30.0, 80.0, 150.0, 50.0, 20.0, 10.0, 10.0, 40.0, -10.0, 380.0, 30.0, 80.0, 40.0, 20.0, 160.0, 20.0, 80.0, 0.0, 30.0, 70.0, 80.0, 230.0, 80.0, 0.0, 30.0, 80.0, 40.0, 190.0, 50.0, 60.0, 0.0, 20.0, 70.0, 190.0, 40.0, 90.0, 50.0, 50.0, 50.0, 40.0, 40.0, 40.0, 70.0, 30.0, 20.0, 0.0, 0.0, 90.0, 130.0, 100.0, 10.0, 570.0, 90.0, 90.0, 80.0, 70.0, 70.0, 20.0, 0.0, 20.0, 40.0, 45.0, 20.0, 20.0, 100.0, 50.0, 50.0, 60.0, 100.0, 440.0, 30.0, 30.0, 190.0, 30.0, 40.0, 50.0, 20.0, 60.0, 100.0, 20.0, 150.0, 80.0, 60.0, 260.0, 30.0, 70.0, 10.0, 160.0, 50.0, 20.0, 100.0, 130.0, 290.0, 100.0, 20.0, 40.0, 60.0, 40.0, 180.0, 160.0, 70.0, 70.0, 100.0, 70.0, 120.0, 30.0, 0.0, 150.0, 40.0, 20.0, 160.0, 60.0, 40.0, 10.0, 10.0, 170.0, 190.0, 150.0, 60.0, 295.0, 70.0, 80.0, 450.0, 70.0, 130.0, 100.0, -70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0, 330.0, 130.0, 100.0, 40.0, 70.0, 30.0, 80.0, 0.0, 85.0, 90.0, 220.0, 270.0, 40.0, 50.0, 30.0, 30.0, 90.0, -15.0, 360.0, 70.0, 60.0, 40.0, 50.0, 160.0, 40.0, -30.0, 40.0, 150.0, 90.0, 50.0, 0.0, 10.0, 150.0, 30.0, 0.0, 100.0, 60.0, 0.0, 210.0, 80.0, 140.0, 200.0, 60.0, 150.0, 110.0, 50.0, 90.0, 60.0, 60.0, 60.0, -30.0, 70.0, 50.0, 270.0, 50.0, 30.0, 20.0, 10.0, 70.0, 40.0, 150.0, 30.0, 40.0, 30.0, 60.0, 30.0, 70.0, 35.0, 20.0, 10.0, 190.0, 70.0, 100.0, 30.0, 30.0, 40.0, 110.0, 30.0, 230.0, 0.0, 50.0, 310.0, 60.0, 70.0, 30.0, 90.0, 0.0, 130.0, 100.0, 190.0, 190.0, 50.0, 30.0, 50.0, 40.0, 20.0, 20.0, 190.0, 190.0, 0.0, 160.0, 30.0, 20.0, 40.0, 10.0, 30.0, 10.0, 90.0, 30.0, 20.0, 160.0, 170.0, 60.0, 110.0, 40.0, 280.0, 70.0, 90.0, 40.0, 60.0, 50.0, 50.0, 70.0, 30.0, 30.0, 20.0, 70.0, 110.0, 180.0, 270.0, 20.0, 30.0, 50.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 270.0, 510.0, 20.0, 50.0, 130.0, 20.0, 110.0, 130.0, 90.0, 170.0, 100.0, 50.0, 50.0, 60.0, 20.0, 90.0, 40.0, 110.0, 60.0, 100.0, 110.0, 50.0, 320.0, 200.0, -20.0, 20.0, 10.0, -20.0, 40.0, 370.0, 90.0, 180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5683899596017312, "mean_inference_ms": 1.4108281540671814, "mean_action_processing_ms": 0.4518127006421213, "mean_env_wait_ms": 1.267962541801949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011934518814086914, "StateBufferConnector_ms": 0.008973836898803711, "ViewRequirementAgentConnector_ms": 0.35771894454956055}, "num_episodes": 18, "episode_return_max": 1595.0, "episode_return_min": 200.0, "episode_return_mean": 803.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.46162545881677, "num_env_steps_trained_throughput_per_sec": 21.46162545881677, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 186955.271, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186955.214, "sample_time_ms": 2579.441, "learn_time_ms": 184354.647, "learn_throughput": 21.697, "synch_weights_time_ms": 11.095}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "33e63_00000", "date": "2024-06-18_23-12-31", "timestamp": 1718766751, "time_this_iter_s": 186.38749504089355, "time_total_s": 7534.5159022808075, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276fa9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7534.5159022808075, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 24.87186311787072, "ram_util_percent": 78.9916349809886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.455172969567509, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.1466031134953765, "policy_loss": -0.010178848189481308, "vf_loss": 6.1552620368770645, "vf_explained_var": 5.4703384669571005e-05, "kl": 0.00759962544613135, "entropy": 0.7429070763567639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1595.0, "episode_reward_min": 200.0, "episode_reward_mean": 818.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 81.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [780.0, 700.0, 510.0, 790.0, 680.0, 800.0, 1100.0, 910.0, 1050.0, 850.0, 1060.0, 940.0, 670.0, 1290.0, 1255.0, 880.0, 390.0, 1130.0, 1455.0, 320.0, 1110.0, 1090.0, 450.0, 830.0, 820.0, 450.0, 820.0, 1020.0, 800.0, 895.0, 530.0, 1150.0, 1060.0, 755.0, 200.0, 630.0, 1000.0, 1050.0, 290.0, 450.0, 630.0, 845.0, 1150.0, 700.0, 1140.0, 670.0, 530.0, 980.0, 490.0, 805.0, 1150.0, 770.0, 680.0, 750.0, 390.0, 1230.0, 385.0, 1020.0, 850.0, 920.0, 900.0, 660.0, 1595.0, 590.0, 955.0, 1145.0, 650.0, 640.0, 980.0, 580.0, 475.0, 830.0, 1030.0, 780.0, 440.0, 1080.0, 880.0, 530.0, 1330.0, 690.0, 1060.0, 825.0, 1210.0, 825.0, 1310.0, 930.0, 560.0, 610.0, 1150.0, 530.0, 250.0, 440.0, 500.0, 600.0, 1045.0, 305.0, 1040.0, 930.0, 1360.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, -100.0, 20.0, 30.0, 30.0, 610.0, -50.0, 30.0, -20.0, 210.0, 40.0, 0.0, 0.0, 60.0, 20.0, 40.0, 80.0, 460.0, -40.0, 40.0, 20.0, 70.0, 40.0, 0.0, 10.0, 170.0, 230.0, 10.0, 50.0, -90.0, 190.0, 0.0, 70.0, 20.0, 50.0, 40.0, 90.0, 180.0, 60.0, 90.0, 40.0, 110.0, 0.0, 40.0, 130.0, 150.0, 110.0, 40.0, 30.0, 30.0, 130.0, 160.0, 230.0, 70.0, 150.0, 40.0, 20.0, -210.0, 90.0, 120.0, 50.0, 40.0, 20.0, 70.0, -50.0, 40.0, 110.0, 30.0, 640.0, 150.0, 10.0, 200.0, 80.0, 10.0, 70.0, 130.0, 180.0, 70.0, 70.0, 90.0, 90.0, 40.0, 180.0, 240.0, 240.0, 40.0, 40.0, 140.0, 30.0, 10.0, 40.0, 110.0, 90.0, 50.0, 30.0, 20.0, -30.0, 160.0, 0.0, 380.0, 210.0, 10.0, 80.0, 150.0, 160.0, 40.0, 140.0, 90.0, 70.0, 110.0, 30.0, -20.0, 100.0, 280.0, 110.0, 70.0, 10.0, 50.0, 250.0, 60.0, 30.0, 20.0, 20.0, 120.0, 70.0, 20.0, 150.0, 0.0, 90.0, 150.0, 80.0, 40.0, 310.0, 250.0, 120.0, 170.0, 10.0, 110.0, 110.0, 90.0, 80.0, 10.0, 160.0, 75.0, 320.0, 110.0, 210.0, 70.0, 80.0, 140.0, 50.0, 50.0, 30.0, 110.0, 80.0, 90.0, 160.0, 30.0, 180.0, 100.0, 20.0, 30.0, 60.0, 40.0, 80.0, 0.0, 30.0, 40.0, 30.0, 60.0, 80.0, 110.0, 40.0, 120.0, 100.0, 260.0, 280.0, 70.0, 10.0, 60.0, 50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 30.0, 140.0, 30.0, 30.0, 390.0, 230.0, 50.0, 100.0, 40.0, 30.0, 130.0, 60.0, 150.0, -70.0, 40.0, 240.0, 70.0, 80.0, 180.0, 140.0, 70.0, 110.0, 70.0, 90.0, 70.0, 40.0, 30.0, 10.0, 70.0, 10.0, 10.0, 30.0, 160.0, 20.0, 50.0, -20.0, 110.0, 170.0, 10.0, 20.0, 120.0, 30.0, 160.0, 180.0, 190.0, 10.0, 30.0, 40.0, 70.0, 0.0, 110.0, 10.0, 200.0, 160.0, 0.0, 10.0, 50.0, 100.0, 50.0, 90.0, 50.0, 30.0, 20.0, 50.0, 150.0, 160.0, 70.0, 60.0, 60.0, 350.0, -180.0, 50.0, 90.0, 10.0, -50.0, 30.0, 50.0, 370.0, 310.0, 120.0, 50.0, 90.0, 40.0, 10.0, 60.0, 40.0, 40.0, 80.0, 120.0, 30.0, 70.0, 130.0, 170.0, 60.0, 150.0, 90.0, 90.0, 40.0, 65.0, 30.0, 80.0, 200.0, 90.0, 60.0, 0.0, 20.0, 50.0, 30.0, 50.0, 130.0, 30.0, 200.0, 10.0, 10.0, 90.0, 310.0, 110.0, 300.0, 160.0, 30.0, 90.0, 40.0, 20.0, 0.0, 110.0, 0.0, 150.0, 60.0, -20.0, 210.0, 80.0, 60.0, 310.0, 100.0, 40.0, 50.0, 190.0, 30.0, 60.0, 90.0, 55.0, 90.0, 60.0, 90.0, 20.0, 10.0, 30.0, 0.0, 50.0, 40.0, 20.0, 30.0, 0.0, 0.0, 80.0, 50.0, -80.0, 10.0, 90.0, 90.0, 40.0, 80.0, 200.0, 70.0, 60.0, 130.0, 90.0, 130.0, 40.0, 60.0, 150.0, 220.0, 80.0, 40.0, 80.0, 70.0, 230.0, 150.0, 50.0, 30.0, -30.0, 150.0, 270.0, 50.0, 50.0, 80.0, 0.0, 50.0, 40.0, 5.0, 30.0, 40.0, 10.0, -15.0, 60.0, 90.0, 20.0, 40.0, 0.0, 150.0, 20.0, 20.0, 30.0, 20.0, 50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0, 0.0, 150.0, 90.0, 50.0, 10.0, -40.0, 20.0, 20.0, 365.0, 180.0, 60.0, 90.0, 110.0, 70.0, 70.0, 190.0, 110.0, 310.0, 80.0, 60.0, 20.0, 110.0, 210.0, 50.0, 90.0, 40.0, 80.0, 30.0, 60.0, 10.0, 190.0, 0.0, 150.0, 30.0, 350.0, 30.0, 40.0, 300.0, 20.0, 30.0, 80.0, 60.0, 50.0, 250.0, 40.0, 30.0, 30.0, 40.0, 20.0, 70.0, 30.0, 30.0, 40.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 180.0, 30.0, -50.0, 300.0, 30.0, 210.0, 50.0, 320.0, 20.0, 60.0, 10.0, 30.0, 30.0, 10.0, 10.0, -40.0, 10.0, 70.0, 20.0, 370.0, -20.0, 70.0, 50.0, 50.0, 20.0, 60.0, 40.0, 10.0, -5.0, 100.0, 410.0, 240.0, 60.0, 160.0, 350.0, 30.0, 80.0, 150.0, 50.0, 20.0, 10.0, 10.0, 40.0, -10.0, 380.0, 30.0, 80.0, 40.0, 20.0, 160.0, 20.0, 80.0, 0.0, 30.0, 70.0, 80.0, 230.0, 80.0, 0.0, 30.0, 80.0, 40.0, 190.0, 50.0, 60.0, 0.0, 20.0, 70.0, 190.0, 40.0, 90.0, 50.0, 50.0, 50.0, 40.0, 40.0, 40.0, 70.0, 30.0, 20.0, 0.0, 0.0, 90.0, 130.0, 100.0, 10.0, 570.0, 90.0, 90.0, 80.0, 70.0, 70.0, 20.0, 0.0, 20.0, 40.0, 45.0, 20.0, 20.0, 100.0, 50.0, 50.0, 60.0, 100.0, 440.0, 30.0, 30.0, 190.0, 30.0, 40.0, 50.0, 20.0, 60.0, 100.0, 20.0, 150.0, 80.0, 60.0, 260.0, 30.0, 70.0, 10.0, 160.0, 50.0, 20.0, 100.0, 130.0, 290.0, 100.0, 20.0, 40.0, 60.0, 40.0, 180.0, 160.0, 70.0, 70.0, 100.0, 70.0, 120.0, 30.0, 0.0, 150.0, 40.0, 20.0, 160.0, 60.0, 40.0, 10.0, 10.0, 170.0, 190.0, 150.0, 60.0, 295.0, 70.0, 80.0, 450.0, 70.0, 130.0, 100.0, -70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0, 330.0, 130.0, 100.0, 40.0, 70.0, 30.0, 80.0, 0.0, 85.0, 90.0, 220.0, 270.0, 40.0, 50.0, 30.0, 30.0, 90.0, -15.0, 360.0, 70.0, 60.0, 40.0, 50.0, 160.0, 40.0, -30.0, 40.0, 150.0, 90.0, 50.0, 0.0, 10.0, 150.0, 30.0, 0.0, 100.0, 60.0, 0.0, 210.0, 80.0, 140.0, 200.0, 60.0, 150.0, 110.0, 50.0, 90.0, 60.0, 60.0, 60.0, -30.0, 70.0, 50.0, 270.0, 50.0, 30.0, 20.0, 10.0, 70.0, 40.0, 150.0, 30.0, 40.0, 30.0, 60.0, 30.0, 70.0, 35.0, 20.0, 10.0, 190.0, 70.0, 100.0, 30.0, 30.0, 40.0, 110.0, 30.0, 230.0, 0.0, 50.0, 310.0, 60.0, 70.0, 30.0, 90.0, 0.0, 130.0, 100.0, 190.0, 190.0, 50.0, 30.0, 50.0, 40.0, 20.0, 20.0, 190.0, 190.0, 0.0, 160.0, 30.0, 20.0, 40.0, 10.0, 30.0, 10.0, 90.0, 30.0, 20.0, 160.0, 170.0, 60.0, 110.0, 40.0, 280.0, 70.0, 90.0, 40.0, 60.0, 50.0, 50.0, 70.0, 30.0, 30.0, 20.0, 70.0, 110.0, 180.0, 270.0, 20.0, 30.0, 50.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 270.0, 510.0, 20.0, 50.0, 130.0, 20.0, 110.0, 130.0, 90.0, 170.0, 100.0, 50.0, 50.0, 60.0, 20.0, 90.0, 40.0, 110.0, 60.0, 100.0, 110.0, 50.0, 320.0, 200.0, -20.0, 20.0, 10.0, -20.0, 40.0, 370.0, 90.0, 180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0, 30.0, 70.0, 30.0, 140.0, 90.0, 520.0, 100.0, 20.0, 140.0, 70.0, 250.0, 40.0, 10.0, -10.0, 80.0, 60.0, 100.0, 90.0, 100.0, 105.0, 70.0, 140.0, 90.0, 80.0, 70.0, 180.0, 50.0, 90.0, 220.0, 320.0, 140.0, 50.0, 40.0, 80.0, 130.0, 190.0, 60.0, 40.0, 270.0, -70.0, 30.0, 20.0, 0.0, 100.0, 40.0, 0.0, 280.0, 70.0, 10.0, 10.0, 10.0, 100.0, 80.0, 140.0, 20.0, 40.0, 0.0, 20.0, 10.0, 190.0, 110.0, 30.0, 30.0, 30.0, 170.0, 120.0, 130.0, 50.0, 420.0, 60.0, 20.0, 80.0, 70.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 180.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 100.0, 180.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 60.0, 0.0, 80.0, 60.0, 100.0, 60.0, 110.0, 50.0, 80.0, 40.0, 20.0, 40.0, 200.0, 0.0, 30.0, 30.0, 70.0, 65.0, 70.0, 80.0, 150.0, 70.0, 350.0, 60.0, 90.0, 40.0, 60.0, -5.0, -40.0, 20.0, 100.0, 50.0, 30.0, 0.0, 20.0, 70.0, 30.0, -40.0, 120.0, 80.0, -40.0, 170.0, 250.0, 360.0, -40.0, 150.0, 80.0, 110.0, -10.0, 70.0, 80.0, 30.0, 220.0, -70.0, 170.0, 250.0, 50.0, 40.0, -40.0, 510.0, 40.0, 50.0, 140.0, 110.0, 420.0, 40.0, 30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5666579535139196, "mean_inference_ms": 1.4098003864939859, "mean_action_processing_ms": 0.4501794510226761, "mean_env_wait_ms": 1.2666001800632858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011887788772583008, "StateBufferConnector_ms": 0.009039640426635742, "ViewRequirementAgentConnector_ms": 0.35965704917907715}, "num_episodes": 18, "episode_return_max": 1595.0, "episode_return_min": 200.0, "episode_return_mean": 818.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.33218994843711, "num_env_steps_trained_throughput_per_sec": 21.33218994843711, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 187079.038, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187078.969, "sample_time_ms": 2591.168, "learn_time_ms": 184465.645, "learn_throughput": 21.684, "synch_weights_time_ms": 11.534}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "33e63_00000", "date": "2024-06-18_23-15-39", "timestamp": 1718766939, "time_this_iter_s": 187.53399801254272, "time_total_s": 7722.04990029335, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321236ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7722.04990029335, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 24.656226415094338, "ram_util_percent": 79.33962264150944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.090565412341596, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.614002525006621, "policy_loss": -0.009781363271786787, "vf_loss": 6.6223914950800395, "vf_explained_var": 0.0002613342798556002, "kl": 0.006961943307229745, "entropy": 0.6988935726074873, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1595.0, "episode_reward_min": 200.0, "episode_reward_mean": 784.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 570.0}, "policy_reward_mean": {"policy_0": 78.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1455.0, 320.0, 1110.0, 1090.0, 450.0, 830.0, 820.0, 450.0, 820.0, 1020.0, 800.0, 895.0, 530.0, 1150.0, 1060.0, 755.0, 200.0, 630.0, 1000.0, 1050.0, 290.0, 450.0, 630.0, 845.0, 1150.0, 700.0, 1140.0, 670.0, 530.0, 980.0, 490.0, 805.0, 1150.0, 770.0, 680.0, 750.0, 390.0, 1230.0, 385.0, 1020.0, 850.0, 920.0, 900.0, 660.0, 1595.0, 590.0, 955.0, 1145.0, 650.0, 640.0, 980.0, 580.0, 475.0, 830.0, 1030.0, 780.0, 440.0, 1080.0, 880.0, 530.0, 1330.0, 690.0, 1060.0, 825.0, 1210.0, 825.0, 1310.0, 930.0, 560.0, 610.0, 1150.0, 530.0, 250.0, 440.0, 500.0, 600.0, 1045.0, 305.0, 1040.0, 930.0, 1360.0, 520.0, 300.0, 690.0, 530.0, 740.0, 360.0, 460.0, 1050.0, 460.0, 550.0, 425.0, 580.0, 685.0, 780.0, 715.0, 1270.0, 1470.0, 460.0, 880.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 60.0, 90.0, 195.0, 320.0, -80.0, 100.0, 110.0, 400.0, 210.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 30.0, 140.0, 30.0, 30.0, 390.0, 230.0, 50.0, 100.0, 40.0, 30.0, 130.0, 60.0, 150.0, -70.0, 40.0, 240.0, 70.0, 80.0, 180.0, 140.0, 70.0, 110.0, 70.0, 90.0, 70.0, 40.0, 30.0, 10.0, 70.0, 10.0, 10.0, 30.0, 160.0, 20.0, 50.0, -20.0, 110.0, 170.0, 10.0, 20.0, 120.0, 30.0, 160.0, 180.0, 190.0, 10.0, 30.0, 40.0, 70.0, 0.0, 110.0, 10.0, 200.0, 160.0, 0.0, 10.0, 50.0, 100.0, 50.0, 90.0, 50.0, 30.0, 20.0, 50.0, 150.0, 160.0, 70.0, 60.0, 60.0, 350.0, -180.0, 50.0, 90.0, 10.0, -50.0, 30.0, 50.0, 370.0, 310.0, 120.0, 50.0, 90.0, 40.0, 10.0, 60.0, 40.0, 40.0, 80.0, 120.0, 30.0, 70.0, 130.0, 170.0, 60.0, 150.0, 90.0, 90.0, 40.0, 65.0, 30.0, 80.0, 200.0, 90.0, 60.0, 0.0, 20.0, 50.0, 30.0, 50.0, 130.0, 30.0, 200.0, 10.0, 10.0, 90.0, 310.0, 110.0, 300.0, 160.0, 30.0, 90.0, 40.0, 20.0, 0.0, 110.0, 0.0, 150.0, 60.0, -20.0, 210.0, 80.0, 60.0, 310.0, 100.0, 40.0, 50.0, 190.0, 30.0, 60.0, 90.0, 55.0, 90.0, 60.0, 90.0, 20.0, 10.0, 30.0, 0.0, 50.0, 40.0, 20.0, 30.0, 0.0, 0.0, 80.0, 50.0, -80.0, 10.0, 90.0, 90.0, 40.0, 80.0, 200.0, 70.0, 60.0, 130.0, 90.0, 130.0, 40.0, 60.0, 150.0, 220.0, 80.0, 40.0, 80.0, 70.0, 230.0, 150.0, 50.0, 30.0, -30.0, 150.0, 270.0, 50.0, 50.0, 80.0, 0.0, 50.0, 40.0, 5.0, 30.0, 40.0, 10.0, -15.0, 60.0, 90.0, 20.0, 40.0, 0.0, 150.0, 20.0, 20.0, 30.0, 20.0, 50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0, 0.0, 150.0, 90.0, 50.0, 10.0, -40.0, 20.0, 20.0, 365.0, 180.0, 60.0, 90.0, 110.0, 70.0, 70.0, 190.0, 110.0, 310.0, 80.0, 60.0, 20.0, 110.0, 210.0, 50.0, 90.0, 40.0, 80.0, 30.0, 60.0, 10.0, 190.0, 0.0, 150.0, 30.0, 350.0, 30.0, 40.0, 300.0, 20.0, 30.0, 80.0, 60.0, 50.0, 250.0, 40.0, 30.0, 30.0, 40.0, 20.0, 70.0, 30.0, 30.0, 40.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 180.0, 30.0, -50.0, 300.0, 30.0, 210.0, 50.0, 320.0, 20.0, 60.0, 10.0, 30.0, 30.0, 10.0, 10.0, -40.0, 10.0, 70.0, 20.0, 370.0, -20.0, 70.0, 50.0, 50.0, 20.0, 60.0, 40.0, 10.0, -5.0, 100.0, 410.0, 240.0, 60.0, 160.0, 350.0, 30.0, 80.0, 150.0, 50.0, 20.0, 10.0, 10.0, 40.0, -10.0, 380.0, 30.0, 80.0, 40.0, 20.0, 160.0, 20.0, 80.0, 0.0, 30.0, 70.0, 80.0, 230.0, 80.0, 0.0, 30.0, 80.0, 40.0, 190.0, 50.0, 60.0, 0.0, 20.0, 70.0, 190.0, 40.0, 90.0, 50.0, 50.0, 50.0, 40.0, 40.0, 40.0, 70.0, 30.0, 20.0, 0.0, 0.0, 90.0, 130.0, 100.0, 10.0, 570.0, 90.0, 90.0, 80.0, 70.0, 70.0, 20.0, 0.0, 20.0, 40.0, 45.0, 20.0, 20.0, 100.0, 50.0, 50.0, 60.0, 100.0, 440.0, 30.0, 30.0, 190.0, 30.0, 40.0, 50.0, 20.0, 60.0, 100.0, 20.0, 150.0, 80.0, 60.0, 260.0, 30.0, 70.0, 10.0, 160.0, 50.0, 20.0, 100.0, 130.0, 290.0, 100.0, 20.0, 40.0, 60.0, 40.0, 180.0, 160.0, 70.0, 70.0, 100.0, 70.0, 120.0, 30.0, 0.0, 150.0, 40.0, 20.0, 160.0, 60.0, 40.0, 10.0, 10.0, 170.0, 190.0, 150.0, 60.0, 295.0, 70.0, 80.0, 450.0, 70.0, 130.0, 100.0, -70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0, 330.0, 130.0, 100.0, 40.0, 70.0, 30.0, 80.0, 0.0, 85.0, 90.0, 220.0, 270.0, 40.0, 50.0, 30.0, 30.0, 90.0, -15.0, 360.0, 70.0, 60.0, 40.0, 50.0, 160.0, 40.0, -30.0, 40.0, 150.0, 90.0, 50.0, 0.0, 10.0, 150.0, 30.0, 0.0, 100.0, 60.0, 0.0, 210.0, 80.0, 140.0, 200.0, 60.0, 150.0, 110.0, 50.0, 90.0, 60.0, 60.0, 60.0, -30.0, 70.0, 50.0, 270.0, 50.0, 30.0, 20.0, 10.0, 70.0, 40.0, 150.0, 30.0, 40.0, 30.0, 60.0, 30.0, 70.0, 35.0, 20.0, 10.0, 190.0, 70.0, 100.0, 30.0, 30.0, 40.0, 110.0, 30.0, 230.0, 0.0, 50.0, 310.0, 60.0, 70.0, 30.0, 90.0, 0.0, 130.0, 100.0, 190.0, 190.0, 50.0, 30.0, 50.0, 40.0, 20.0, 20.0, 190.0, 190.0, 0.0, 160.0, 30.0, 20.0, 40.0, 10.0, 30.0, 10.0, 90.0, 30.0, 20.0, 160.0, 170.0, 60.0, 110.0, 40.0, 280.0, 70.0, 90.0, 40.0, 60.0, 50.0, 50.0, 70.0, 30.0, 30.0, 20.0, 70.0, 110.0, 180.0, 270.0, 20.0, 30.0, 50.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 270.0, 510.0, 20.0, 50.0, 130.0, 20.0, 110.0, 130.0, 90.0, 170.0, 100.0, 50.0, 50.0, 60.0, 20.0, 90.0, 40.0, 110.0, 60.0, 100.0, 110.0, 50.0, 320.0, 200.0, -20.0, 20.0, 10.0, -20.0, 40.0, 370.0, 90.0, 180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0, 30.0, 70.0, 30.0, 140.0, 90.0, 520.0, 100.0, 20.0, 140.0, 70.0, 250.0, 40.0, 10.0, -10.0, 80.0, 60.0, 100.0, 90.0, 100.0, 105.0, 70.0, 140.0, 90.0, 80.0, 70.0, 180.0, 50.0, 90.0, 220.0, 320.0, 140.0, 50.0, 40.0, 80.0, 130.0, 190.0, 60.0, 40.0, 270.0, -70.0, 30.0, 20.0, 0.0, 100.0, 40.0, 0.0, 280.0, 70.0, 10.0, 10.0, 10.0, 100.0, 80.0, 140.0, 20.0, 40.0, 0.0, 20.0, 10.0, 190.0, 110.0, 30.0, 30.0, 30.0, 170.0, 120.0, 130.0, 50.0, 420.0, 60.0, 20.0, 80.0, 70.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 180.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 100.0, 180.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 60.0, 0.0, 80.0, 60.0, 100.0, 60.0, 110.0, 50.0, 80.0, 40.0, 20.0, 40.0, 200.0, 0.0, 30.0, 30.0, 70.0, 65.0, 70.0, 80.0, 150.0, 70.0, 350.0, 60.0, 90.0, 40.0, 60.0, -5.0, -40.0, 20.0, 100.0, 50.0, 30.0, 0.0, 20.0, 70.0, 30.0, -40.0, 120.0, 80.0, -40.0, 170.0, 250.0, 360.0, -40.0, 150.0, 80.0, 110.0, -10.0, 70.0, 80.0, 30.0, 220.0, -70.0, 170.0, 250.0, 50.0, 40.0, -40.0, 510.0, 40.0, 50.0, 140.0, 110.0, 420.0, 40.0, 30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0, 20.0, 60.0, -120.0, 40.0, 100.0, 120.0, 10.0, 30.0, 20.0, 20.0, 90.0, 10.0, 0.0, 80.0, 40.0, 0.0, 20.0, 170.0, 180.0, 100.0, 20.0, 60.0, 50.0, 20.0, 160.0, 50.0, 40.0, 10.0, 100.0, 20.0, 30.0, 120.0, 30.0, 10.0, 110.0, 120.0, 80.0, 100.0, 120.0, 20.0, 30.0, 30.0, 30.0, 10.0, 60.0, 10.0, 10.0, 20.0, 30.0, 130.0, 30.0, 10.0, 30.0, 100.0, 80.0, 100.0, 30.0, 40.0, 30.0, 10.0, 320.0, 90.0, 160.0, -90.0, 30.0, 70.0, 70.0, 80.0, 280.0, 40.0, 30.0, 30.0, 80.0, 60.0, 40.0, 10.0, 120.0, 20.0, 30.0, 40.0, 40.0, 0.0, 40.0, 50.0, 80.0, 120.0, 100.0, 30.0, 70.0, 20.0, -20.0, 10.0, 40.0, 30.0, 20.0, 260.0, 20.0, 20.0, 10.0, 35.0, 120.0, 90.0, 180.0, 20.0, 20.0, 10.0, 50.0, 80.0, 0.0, 10.0, -10.0, 250.0, 10.0, 30.0, 50.0, 220.0, 70.0, 30.0, 5.0, 30.0, 20.0, 50.0, 20.0, 180.0, 40.0, 100.0, 110.0, 40.0, 70.0, 150.0, 80.0, 90.0, 40.0, 260.0, 50.0, 100.0, 45.0, 20.0, 20.0, 10.0, 140.0, 190.0, 410.0, 60.0, 60.0, 60.0, 120.0, 60.0, 30.0, 140.0, 260.0, 70.0, 30.0, 150.0, 360.0, 40.0, 260.0, 310.0, -40.0, 30.0, 150.0, 10.0, 30.0, 0.0, 30.0, 80.0, 40.0, 40.0, 30.0, 50.0, 90.0, 190.0, 0.0, 280.0, 50.0, 50.0, 20.0, 60.0, 60.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5655246171089727, "mean_inference_ms": 1.4091477793518612, "mean_action_processing_ms": 0.44868163961678337, "mean_env_wait_ms": 1.265668981388614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012343406677246094, "StateBufferConnector_ms": 0.009328603744506836, "ViewRequirementAgentConnector_ms": 0.37897443771362305}, "num_episodes": 18, "episode_return_max": 1595.0, "episode_return_min": 200.0, "episode_return_mean": 784.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.410553024516574, "num_env_steps_trained_throughput_per_sec": 21.410553024516574, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 187125.404, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187125.335, "sample_time_ms": 2606.627, "learn_time_ms": 184496.504, "learn_throughput": 21.681, "synch_weights_time_ms": 11.151}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "33e63_00000", "date": "2024-06-18_23-18-46", "timestamp": 1718767126, "time_this_iter_s": 186.82906579971313, "time_total_s": 7908.878966093063, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276faf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7908.878966093063, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 16.518560606060603, "ram_util_percent": 79.39128787878786}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0566371697206467, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.793800155296366, "policy_loss": -0.010234548343348995, "vf_loss": 6.802562398169115, "vf_explained_var": -0.00017804954125604435, "kl": 0.0073615364052259605, "entropy": 0.6823483213099936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1595.0, "episode_reward_min": 250.0, "episode_reward_mean": 802.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 80.28}, "custom_metrics": {}, "hist_stats": {"episode_reward": [630.0, 845.0, 1150.0, 700.0, 1140.0, 670.0, 530.0, 980.0, 490.0, 805.0, 1150.0, 770.0, 680.0, 750.0, 390.0, 1230.0, 385.0, 1020.0, 850.0, 920.0, 900.0, 660.0, 1595.0, 590.0, 955.0, 1145.0, 650.0, 640.0, 980.0, 580.0, 475.0, 830.0, 1030.0, 780.0, 440.0, 1080.0, 880.0, 530.0, 1330.0, 690.0, 1060.0, 825.0, 1210.0, 825.0, 1310.0, 930.0, 560.0, 610.0, 1150.0, 530.0, 250.0, 440.0, 500.0, 600.0, 1045.0, 305.0, 1040.0, 930.0, 1360.0, 520.0, 300.0, 690.0, 530.0, 740.0, 360.0, 460.0, 1050.0, 460.0, 550.0, 425.0, 580.0, 685.0, 780.0, 715.0, 1270.0, 1470.0, 460.0, 880.0, 1495.0, 1250.0, 965.0, 1040.0, 710.0, 1375.0, 620.0, 550.0, 450.0, 510.0, 1160.0, 480.0, 390.0, 810.0, 710.0, 1140.0, 1050.0, 1060.0, 640.0, 820.0, 580.0, 1225.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 70.0, 20.0, 80.0, 40.0, 60.0, 150.0, 80.0, 10.0, 70.0, 0.0, 150.0, 90.0, 50.0, 10.0, -40.0, 20.0, 20.0, 365.0, 180.0, 60.0, 90.0, 110.0, 70.0, 70.0, 190.0, 110.0, 310.0, 80.0, 60.0, 20.0, 110.0, 210.0, 50.0, 90.0, 40.0, 80.0, 30.0, 60.0, 10.0, 190.0, 0.0, 150.0, 30.0, 350.0, 30.0, 40.0, 300.0, 20.0, 30.0, 80.0, 60.0, 50.0, 250.0, 40.0, 30.0, 30.0, 40.0, 20.0, 70.0, 30.0, 30.0, 40.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 180.0, 30.0, -50.0, 300.0, 30.0, 210.0, 50.0, 320.0, 20.0, 60.0, 10.0, 30.0, 30.0, 10.0, 10.0, -40.0, 10.0, 70.0, 20.0, 370.0, -20.0, 70.0, 50.0, 50.0, 20.0, 60.0, 40.0, 10.0, -5.0, 100.0, 410.0, 240.0, 60.0, 160.0, 350.0, 30.0, 80.0, 150.0, 50.0, 20.0, 10.0, 10.0, 40.0, -10.0, 380.0, 30.0, 80.0, 40.0, 20.0, 160.0, 20.0, 80.0, 0.0, 30.0, 70.0, 80.0, 230.0, 80.0, 0.0, 30.0, 80.0, 40.0, 190.0, 50.0, 60.0, 0.0, 20.0, 70.0, 190.0, 40.0, 90.0, 50.0, 50.0, 50.0, 40.0, 40.0, 40.0, 70.0, 30.0, 20.0, 0.0, 0.0, 90.0, 130.0, 100.0, 10.0, 570.0, 90.0, 90.0, 80.0, 70.0, 70.0, 20.0, 0.0, 20.0, 40.0, 45.0, 20.0, 20.0, 100.0, 50.0, 50.0, 60.0, 100.0, 440.0, 30.0, 30.0, 190.0, 30.0, 40.0, 50.0, 20.0, 60.0, 100.0, 20.0, 150.0, 80.0, 60.0, 260.0, 30.0, 70.0, 10.0, 160.0, 50.0, 20.0, 100.0, 130.0, 290.0, 100.0, 20.0, 40.0, 60.0, 40.0, 180.0, 160.0, 70.0, 70.0, 100.0, 70.0, 120.0, 30.0, 0.0, 150.0, 40.0, 20.0, 160.0, 60.0, 40.0, 10.0, 10.0, 170.0, 190.0, 150.0, 60.0, 295.0, 70.0, 80.0, 450.0, 70.0, 130.0, 100.0, -70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0, 330.0, 130.0, 100.0, 40.0, 70.0, 30.0, 80.0, 0.0, 85.0, 90.0, 220.0, 270.0, 40.0, 50.0, 30.0, 30.0, 90.0, -15.0, 360.0, 70.0, 60.0, 40.0, 50.0, 160.0, 40.0, -30.0, 40.0, 150.0, 90.0, 50.0, 0.0, 10.0, 150.0, 30.0, 0.0, 100.0, 60.0, 0.0, 210.0, 80.0, 140.0, 200.0, 60.0, 150.0, 110.0, 50.0, 90.0, 60.0, 60.0, 60.0, -30.0, 70.0, 50.0, 270.0, 50.0, 30.0, 20.0, 10.0, 70.0, 40.0, 150.0, 30.0, 40.0, 30.0, 60.0, 30.0, 70.0, 35.0, 20.0, 10.0, 190.0, 70.0, 100.0, 30.0, 30.0, 40.0, 110.0, 30.0, 230.0, 0.0, 50.0, 310.0, 60.0, 70.0, 30.0, 90.0, 0.0, 130.0, 100.0, 190.0, 190.0, 50.0, 30.0, 50.0, 40.0, 20.0, 20.0, 190.0, 190.0, 0.0, 160.0, 30.0, 20.0, 40.0, 10.0, 30.0, 10.0, 90.0, 30.0, 20.0, 160.0, 170.0, 60.0, 110.0, 40.0, 280.0, 70.0, 90.0, 40.0, 60.0, 50.0, 50.0, 70.0, 30.0, 30.0, 20.0, 70.0, 110.0, 180.0, 270.0, 20.0, 30.0, 50.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 270.0, 510.0, 20.0, 50.0, 130.0, 20.0, 110.0, 130.0, 90.0, 170.0, 100.0, 50.0, 50.0, 60.0, 20.0, 90.0, 40.0, 110.0, 60.0, 100.0, 110.0, 50.0, 320.0, 200.0, -20.0, 20.0, 10.0, -20.0, 40.0, 370.0, 90.0, 180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0, 30.0, 70.0, 30.0, 140.0, 90.0, 520.0, 100.0, 20.0, 140.0, 70.0, 250.0, 40.0, 10.0, -10.0, 80.0, 60.0, 100.0, 90.0, 100.0, 105.0, 70.0, 140.0, 90.0, 80.0, 70.0, 180.0, 50.0, 90.0, 220.0, 320.0, 140.0, 50.0, 40.0, 80.0, 130.0, 190.0, 60.0, 40.0, 270.0, -70.0, 30.0, 20.0, 0.0, 100.0, 40.0, 0.0, 280.0, 70.0, 10.0, 10.0, 10.0, 100.0, 80.0, 140.0, 20.0, 40.0, 0.0, 20.0, 10.0, 190.0, 110.0, 30.0, 30.0, 30.0, 170.0, 120.0, 130.0, 50.0, 420.0, 60.0, 20.0, 80.0, 70.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 180.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 100.0, 180.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 60.0, 0.0, 80.0, 60.0, 100.0, 60.0, 110.0, 50.0, 80.0, 40.0, 20.0, 40.0, 200.0, 0.0, 30.0, 30.0, 70.0, 65.0, 70.0, 80.0, 150.0, 70.0, 350.0, 60.0, 90.0, 40.0, 60.0, -5.0, -40.0, 20.0, 100.0, 50.0, 30.0, 0.0, 20.0, 70.0, 30.0, -40.0, 120.0, 80.0, -40.0, 170.0, 250.0, 360.0, -40.0, 150.0, 80.0, 110.0, -10.0, 70.0, 80.0, 30.0, 220.0, -70.0, 170.0, 250.0, 50.0, 40.0, -40.0, 510.0, 40.0, 50.0, 140.0, 110.0, 420.0, 40.0, 30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0, 20.0, 60.0, -120.0, 40.0, 100.0, 120.0, 10.0, 30.0, 20.0, 20.0, 90.0, 10.0, 0.0, 80.0, 40.0, 0.0, 20.0, 170.0, 180.0, 100.0, 20.0, 60.0, 50.0, 20.0, 160.0, 50.0, 40.0, 10.0, 100.0, 20.0, 30.0, 120.0, 30.0, 10.0, 110.0, 120.0, 80.0, 100.0, 120.0, 20.0, 30.0, 30.0, 30.0, 10.0, 60.0, 10.0, 10.0, 20.0, 30.0, 130.0, 30.0, 10.0, 30.0, 100.0, 80.0, 100.0, 30.0, 40.0, 30.0, 10.0, 320.0, 90.0, 160.0, -90.0, 30.0, 70.0, 70.0, 80.0, 280.0, 40.0, 30.0, 30.0, 80.0, 60.0, 40.0, 10.0, 120.0, 20.0, 30.0, 40.0, 40.0, 0.0, 40.0, 50.0, 80.0, 120.0, 100.0, 30.0, 70.0, 20.0, -20.0, 10.0, 40.0, 30.0, 20.0, 260.0, 20.0, 20.0, 10.0, 35.0, 120.0, 90.0, 180.0, 20.0, 20.0, 10.0, 50.0, 80.0, 0.0, 10.0, -10.0, 250.0, 10.0, 30.0, 50.0, 220.0, 70.0, 30.0, 5.0, 30.0, 20.0, 50.0, 20.0, 180.0, 40.0, 100.0, 110.0, 40.0, 70.0, 150.0, 80.0, 90.0, 40.0, 260.0, 50.0, 100.0, 45.0, 20.0, 20.0, 10.0, 140.0, 190.0, 410.0, 60.0, 60.0, 60.0, 120.0, 60.0, 30.0, 140.0, 260.0, 70.0, 30.0, 150.0, 360.0, 40.0, 260.0, 310.0, -40.0, 30.0, 150.0, 10.0, 30.0, 0.0, 30.0, 80.0, 40.0, 40.0, 30.0, 50.0, 90.0, 190.0, 0.0, 280.0, 50.0, 50.0, 20.0, 60.0, 60.0, 80.0, 105.0, 100.0, 450.0, 50.0, 120.0, 50.0, 280.0, 70.0, 100.0, 170.0, 80.0, 170.0, 110.0, 600.0, 100.0, -10.0, -10.0, 50.0, 60.0, 100.0, 40.0, 30.0, 60.0, 320.0, 80.0, 200.0, 200.0, 0.0, 55.0, -20.0, 20.0, 120.0, 170.0, 90.0, 40.0, 30.0, 390.0, 30.0, 60.0, 90.0, 50.0, 50.0, -70.0, 60.0, 50.0, 190.0, 10.0, 70.0, 270.0, 30.0, 30.0, 800.0, 5.0, 170.0, 10.0, 270.0, 20.0, 30.0, 40.0, 0.0, 50.0, 90.0, 180.0, 20.0, 50.0, 20.0, -50.0, 50.0, 60.0, 150.0, 80.0, 40.0, 90.0, 110.0, 40.0, 30.0, 40.0, 70.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 70.0, 60.0, 20.0, 0.0, 190.0, 0.0, 20.0, 20.0, 80.0, 20.0, 30.0, 170.0, 40.0, 30.0, 40.0, 60.0, 30.0, 80.0, 270.0, 220.0, 0.0, 170.0, 80.0, 60.0, 210.0, 40.0, 40.0, 30.0, 80.0, 0.0, 40.0, 30.0, 40.0, 10.0, 150.0, 60.0, 0.0, 10.0, 20.0, 110.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 50.0, 420.0, 90.0, 40.0, 40.0, 90.0, 60.0, 90.0, 20.0, 80.0, 0.0, 100.0, 100.0, 80.0, 40.0, 100.0, 100.0, 150.0, 120.0, 100.0, 90.0, 40.0, 350.0, 90.0, 50.0, 100.0, 50.0, 40.0, 120.0, 160.0, 330.0, 180.0, 70.0, 90.0, 0.0, 20.0, 40.0, 0.0, 60.0, 50.0, 100.0, 190.0, 130.0, 10.0, 300.0, 140.0, 80.0, 80.0, 40.0, 80.0, 90.0, 90.0, 30.0, 20.0, 30.0, 70.0, 110.0, 0.0, 50.0, 170.0, 30.0, 120.0, 80.0, 90.0, 110.0, 0.0, 170.0, 0.0, 80.0, 50.0, 30.0, 40.0, 120.0, 40.0, 10.0, 90.0, 120.0, 0.0, 30.0, 320.0, 75.0, 50.0, 50.0, 310.0, 110.0, 110.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5641414863324963, "mean_inference_ms": 1.4079131128050664, "mean_action_processing_ms": 0.44689143293727485, "mean_env_wait_ms": 1.2645776071951362, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266336441040039, "StateBufferConnector_ms": 0.009563684463500977, "ViewRequirementAgentConnector_ms": 0.3823399543762207}, "num_episodes": 22, "episode_return_max": 1595.0, "episode_return_min": 250.0, "episode_return_mean": 802.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.432993542849925, "num_env_steps_trained_throughput_per_sec": 21.432993542849925, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 187045.676, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187045.619, "sample_time_ms": 2574.798, "learn_time_ms": 184447.91, "learn_throughput": 21.686, "synch_weights_time_ms": 11.449}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "33e63_00000", "date": "2024-06-18_23-21-52", "timestamp": 1718767312, "time_this_iter_s": 186.63825273513794, "time_total_s": 8095.517218828201, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327184ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8095.517218828201, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 23.37007575757576, "ram_util_percent": 79.51742424242424}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1174680318758763, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.835792682473017, "policy_loss": -0.012170914094671964, "vf_loss": 6.846292533610448, "vf_explained_var": 0.0007579427240247797, "kl": 0.008355314958848847, "entropy": 0.6547709453124969, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1520.0, "episode_reward_min": 150.0, "episode_reward_mean": 805.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 80.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [590.0, 955.0, 1145.0, 650.0, 640.0, 980.0, 580.0, 475.0, 830.0, 1030.0, 780.0, 440.0, 1080.0, 880.0, 530.0, 1330.0, 690.0, 1060.0, 825.0, 1210.0, 825.0, 1310.0, 930.0, 560.0, 610.0, 1150.0, 530.0, 250.0, 440.0, 500.0, 600.0, 1045.0, 305.0, 1040.0, 930.0, 1360.0, 520.0, 300.0, 690.0, 530.0, 740.0, 360.0, 460.0, 1050.0, 460.0, 550.0, 425.0, 580.0, 685.0, 780.0, 715.0, 1270.0, 1470.0, 460.0, 880.0, 1495.0, 1250.0, 965.0, 1040.0, 710.0, 1375.0, 620.0, 550.0, 450.0, 510.0, 1160.0, 480.0, 390.0, 810.0, 710.0, 1140.0, 1050.0, 1060.0, 640.0, 820.0, 580.0, 1225.0, 630.0, 635.0, 930.0, 685.0, 190.0, 1430.0, 1440.0, 1140.0, 860.0, 780.0, 150.0, 670.0, 1085.0, 685.0, 950.0, 1520.0, 1270.0, 970.0, 1125.0, 625.0, 750.0, 240.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-70.0, 20.0, 30.0, 40.0, 40.0, 200.0, 30.0, 200.0, 90.0, 10.0, 330.0, 130.0, 100.0, 40.0, 70.0, 30.0, 80.0, 0.0, 85.0, 90.0, 220.0, 270.0, 40.0, 50.0, 30.0, 30.0, 90.0, -15.0, 360.0, 70.0, 60.0, 40.0, 50.0, 160.0, 40.0, -30.0, 40.0, 150.0, 90.0, 50.0, 0.0, 10.0, 150.0, 30.0, 0.0, 100.0, 60.0, 0.0, 210.0, 80.0, 140.0, 200.0, 60.0, 150.0, 110.0, 50.0, 90.0, 60.0, 60.0, 60.0, -30.0, 70.0, 50.0, 270.0, 50.0, 30.0, 20.0, 10.0, 70.0, 40.0, 150.0, 30.0, 40.0, 30.0, 60.0, 30.0, 70.0, 35.0, 20.0, 10.0, 190.0, 70.0, 100.0, 30.0, 30.0, 40.0, 110.0, 30.0, 230.0, 0.0, 50.0, 310.0, 60.0, 70.0, 30.0, 90.0, 0.0, 130.0, 100.0, 190.0, 190.0, 50.0, 30.0, 50.0, 40.0, 20.0, 20.0, 190.0, 190.0, 0.0, 160.0, 30.0, 20.0, 40.0, 10.0, 30.0, 10.0, 90.0, 30.0, 20.0, 160.0, 170.0, 60.0, 110.0, 40.0, 280.0, 70.0, 90.0, 40.0, 60.0, 50.0, 50.0, 70.0, 30.0, 30.0, 20.0, 70.0, 110.0, 180.0, 270.0, 20.0, 30.0, 50.0, 20.0, 40.0, 20.0, 30.0, 30.0, 20.0, 270.0, 510.0, 20.0, 50.0, 130.0, 20.0, 110.0, 130.0, 90.0, 170.0, 100.0, 50.0, 50.0, 60.0, 20.0, 90.0, 40.0, 110.0, 60.0, 100.0, 110.0, 50.0, 320.0, 200.0, -20.0, 20.0, 10.0, -20.0, 40.0, 370.0, 90.0, 180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0, 30.0, 70.0, 30.0, 140.0, 90.0, 520.0, 100.0, 20.0, 140.0, 70.0, 250.0, 40.0, 10.0, -10.0, 80.0, 60.0, 100.0, 90.0, 100.0, 105.0, 70.0, 140.0, 90.0, 80.0, 70.0, 180.0, 50.0, 90.0, 220.0, 320.0, 140.0, 50.0, 40.0, 80.0, 130.0, 190.0, 60.0, 40.0, 270.0, -70.0, 30.0, 20.0, 0.0, 100.0, 40.0, 0.0, 280.0, 70.0, 10.0, 10.0, 10.0, 100.0, 80.0, 140.0, 20.0, 40.0, 0.0, 20.0, 10.0, 190.0, 110.0, 30.0, 30.0, 30.0, 170.0, 120.0, 130.0, 50.0, 420.0, 60.0, 20.0, 80.0, 70.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 180.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 100.0, 180.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 60.0, 0.0, 80.0, 60.0, 100.0, 60.0, 110.0, 50.0, 80.0, 40.0, 20.0, 40.0, 200.0, 0.0, 30.0, 30.0, 70.0, 65.0, 70.0, 80.0, 150.0, 70.0, 350.0, 60.0, 90.0, 40.0, 60.0, -5.0, -40.0, 20.0, 100.0, 50.0, 30.0, 0.0, 20.0, 70.0, 30.0, -40.0, 120.0, 80.0, -40.0, 170.0, 250.0, 360.0, -40.0, 150.0, 80.0, 110.0, -10.0, 70.0, 80.0, 30.0, 220.0, -70.0, 170.0, 250.0, 50.0, 40.0, -40.0, 510.0, 40.0, 50.0, 140.0, 110.0, 420.0, 40.0, 30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0, 20.0, 60.0, -120.0, 40.0, 100.0, 120.0, 10.0, 30.0, 20.0, 20.0, 90.0, 10.0, 0.0, 80.0, 40.0, 0.0, 20.0, 170.0, 180.0, 100.0, 20.0, 60.0, 50.0, 20.0, 160.0, 50.0, 40.0, 10.0, 100.0, 20.0, 30.0, 120.0, 30.0, 10.0, 110.0, 120.0, 80.0, 100.0, 120.0, 20.0, 30.0, 30.0, 30.0, 10.0, 60.0, 10.0, 10.0, 20.0, 30.0, 130.0, 30.0, 10.0, 30.0, 100.0, 80.0, 100.0, 30.0, 40.0, 30.0, 10.0, 320.0, 90.0, 160.0, -90.0, 30.0, 70.0, 70.0, 80.0, 280.0, 40.0, 30.0, 30.0, 80.0, 60.0, 40.0, 10.0, 120.0, 20.0, 30.0, 40.0, 40.0, 0.0, 40.0, 50.0, 80.0, 120.0, 100.0, 30.0, 70.0, 20.0, -20.0, 10.0, 40.0, 30.0, 20.0, 260.0, 20.0, 20.0, 10.0, 35.0, 120.0, 90.0, 180.0, 20.0, 20.0, 10.0, 50.0, 80.0, 0.0, 10.0, -10.0, 250.0, 10.0, 30.0, 50.0, 220.0, 70.0, 30.0, 5.0, 30.0, 20.0, 50.0, 20.0, 180.0, 40.0, 100.0, 110.0, 40.0, 70.0, 150.0, 80.0, 90.0, 40.0, 260.0, 50.0, 100.0, 45.0, 20.0, 20.0, 10.0, 140.0, 190.0, 410.0, 60.0, 60.0, 60.0, 120.0, 60.0, 30.0, 140.0, 260.0, 70.0, 30.0, 150.0, 360.0, 40.0, 260.0, 310.0, -40.0, 30.0, 150.0, 10.0, 30.0, 0.0, 30.0, 80.0, 40.0, 40.0, 30.0, 50.0, 90.0, 190.0, 0.0, 280.0, 50.0, 50.0, 20.0, 60.0, 60.0, 80.0, 105.0, 100.0, 450.0, 50.0, 120.0, 50.0, 280.0, 70.0, 100.0, 170.0, 80.0, 170.0, 110.0, 600.0, 100.0, -10.0, -10.0, 50.0, 60.0, 100.0, 40.0, 30.0, 60.0, 320.0, 80.0, 200.0, 200.0, 0.0, 55.0, -20.0, 20.0, 120.0, 170.0, 90.0, 40.0, 30.0, 390.0, 30.0, 60.0, 90.0, 50.0, 50.0, -70.0, 60.0, 50.0, 190.0, 10.0, 70.0, 270.0, 30.0, 30.0, 800.0, 5.0, 170.0, 10.0, 270.0, 20.0, 30.0, 40.0, 0.0, 50.0, 90.0, 180.0, 20.0, 50.0, 20.0, -50.0, 50.0, 60.0, 150.0, 80.0, 40.0, 90.0, 110.0, 40.0, 30.0, 40.0, 70.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 70.0, 60.0, 20.0, 0.0, 190.0, 0.0, 20.0, 20.0, 80.0, 20.0, 30.0, 170.0, 40.0, 30.0, 40.0, 60.0, 30.0, 80.0, 270.0, 220.0, 0.0, 170.0, 80.0, 60.0, 210.0, 40.0, 40.0, 30.0, 80.0, 0.0, 40.0, 30.0, 40.0, 10.0, 150.0, 60.0, 0.0, 10.0, 20.0, 110.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 50.0, 420.0, 90.0, 40.0, 40.0, 90.0, 60.0, 90.0, 20.0, 80.0, 0.0, 100.0, 100.0, 80.0, 40.0, 100.0, 100.0, 150.0, 120.0, 100.0, 90.0, 40.0, 350.0, 90.0, 50.0, 100.0, 50.0, 40.0, 120.0, 160.0, 330.0, 180.0, 70.0, 90.0, 0.0, 20.0, 40.0, 0.0, 60.0, 50.0, 100.0, 190.0, 130.0, 10.0, 300.0, 140.0, 80.0, 80.0, 40.0, 80.0, 90.0, 90.0, 30.0, 20.0, 30.0, 70.0, 110.0, 0.0, 50.0, 170.0, 30.0, 120.0, 80.0, 90.0, 110.0, 0.0, 170.0, 0.0, 80.0, 50.0, 30.0, 40.0, 120.0, 40.0, 10.0, 90.0, 120.0, 0.0, 30.0, 320.0, 75.0, 50.0, 50.0, 310.0, 110.0, 110.0, 170.0, 30.0, 20.0, 60.0, 100.0, 100.0, 70.0, 50.0, 110.0, 90.0, 0.0, 70.0, 160.0, 20.0, -15.0, 90.0, 30.0, 80.0, 20.0, 130.0, 50.0, 90.0, 100.0, 50.0, 50.0, 0.0, 100.0, 40.0, 130.0, 80.0, 290.0, 50.0, 150.0, 10.0, 0.0, 220.0, 70.0, 60.0, -15.0, 80.0, 60.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 50.0, 20.0, -20.0, 320.0, 150.0, 140.0, 70.0, 520.0, 10.0, 210.0, 10.0, 20.0, 120.0, 40.0, 30.0, 80.0, 280.0, 360.0, 220.0, 40.0, 250.0, 0.0, 110.0, 50.0, 140.0, 170.0, 230.0, 70.0, 70.0, 0.0, 300.0, 30.0, 180.0, 80.0, 160.0, 80.0, 10.0, 70.0, 100.0, 130.0, 20.0, 60.0, 80.0, 90.0, 30.0, 90.0, 60.0, 200.0, 50.0, 50.0, 70.0, -30.0, -65.0, -35.0, -30.0, 80.0, -40.0, 70.0, 170.0, 70.0, -40.0, 30.0, 30.0, 0.0, 90.0, 30.0, 210.0, 10.0, 20.0, 200.0, 50.0, -20.0, 5.0, -10.0, 70.0, 70.0, 290.0, 220.0, 90.0, 100.0, 270.0, 40.0, 50.0, 50.0, 20.0, 180.0, 40.0, 170.0, 20.0, 60.0, 55.0, 110.0, 90.0, 80.0, 80.0, 220.0, 40.0, 10.0, 40.0, 170.0, 110.0, 70.0, 230.0, 80.0, 140.0, 70.0, 60.0, 500.0, 170.0, 160.0, 40.0, 50.0, 140.0, 200.0, 250.0, 70.0, 20.0, 50.0, 180.0, 70.0, 240.0, 230.0, 50.0, 170.0, 0.0, 30.0, 80.0, 30.0, 260.0, 0.0, 120.0, 100.0, 30.0, 210.0, 300.0, 100.0, 120.0, 55.0, 50.0, 40.0, 120.0, 20.0, 70.0, 70.0, 70.0, 20.0, 40.0, 80.0, 150.0, 25.0, 80.0, 110.0, 0.0, 30.0, 40.0, 140.0, 360.0, 20.0, 20.0, 0.0, 30.0, 20.0, 70.0, 10.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 20.0, 60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5635294908032333, "mean_inference_ms": 1.40741671886636, "mean_action_processing_ms": 0.44518625440624915, "mean_env_wait_ms": 1.2637534677402344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012995719909667969, "StateBufferConnector_ms": 0.010586261749267578, "ViewRequirementAgentConnector_ms": 0.3925607204437256}, "num_episodes": 23, "episode_return_max": 1520.0, "episode_return_min": 150.0, "episode_return_mean": 805.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.325337524890532, "num_env_steps_trained_throughput_per_sec": 21.325337524890532, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 187239.313, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187239.256, "sample_time_ms": 2548.918, "learn_time_ms": 184667.457, "learn_throughput": 21.661, "synch_weights_time_ms": 11.622}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "33e63_00000", "date": "2024-06-18_23-25-00", "timestamp": 1718767500, "time_this_iter_s": 187.57659006118774, "time_total_s": 8283.093808889389, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3212400d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8283.093808889389, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 24.959022556390977, "ram_util_percent": 79.84624060150375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.297922859525782, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.473608288089562, "policy_loss": -0.010614287708682644, "vf_loss": 7.482797987138628, "vf_explained_var": 0.0004380703543702634, "kl": 0.007122931716303543, "entropy": 0.6626720465473728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1765.0, "episode_reward_min": 150.0, "episode_reward_mean": 833.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 83.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [825.0, 1210.0, 825.0, 1310.0, 930.0, 560.0, 610.0, 1150.0, 530.0, 250.0, 440.0, 500.0, 600.0, 1045.0, 305.0, 1040.0, 930.0, 1360.0, 520.0, 300.0, 690.0, 530.0, 740.0, 360.0, 460.0, 1050.0, 460.0, 550.0, 425.0, 580.0, 685.0, 780.0, 715.0, 1270.0, 1470.0, 460.0, 880.0, 1495.0, 1250.0, 965.0, 1040.0, 710.0, 1375.0, 620.0, 550.0, 450.0, 510.0, 1160.0, 480.0, 390.0, 810.0, 710.0, 1140.0, 1050.0, 1060.0, 640.0, 820.0, 580.0, 1225.0, 630.0, 635.0, 930.0, 685.0, 190.0, 1430.0, 1440.0, 1140.0, 860.0, 780.0, 150.0, 670.0, 1085.0, 685.0, 950.0, 1520.0, 1270.0, 970.0, 1125.0, 625.0, 750.0, 240.0, 770.0, 1095.0, 560.0, 1120.0, 1170.0, 645.0, 625.0, 1330.0, 665.0, 1020.0, 1100.0, 1765.0, 1000.0, 1050.0, 830.0, 1130.0, 560.0, 1425.0, 325.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 10.0, 140.0, 20.0, 10.0, 130.0, 15.0, 240.0, 40.0, 40.0, 30.0, 70.0, 30.0, 140.0, 90.0, 520.0, 100.0, 20.0, 140.0, 70.0, 250.0, 40.0, 10.0, -10.0, 80.0, 60.0, 100.0, 90.0, 100.0, 105.0, 70.0, 140.0, 90.0, 80.0, 70.0, 180.0, 50.0, 90.0, 220.0, 320.0, 140.0, 50.0, 40.0, 80.0, 130.0, 190.0, 60.0, 40.0, 270.0, -70.0, 30.0, 20.0, 0.0, 100.0, 40.0, 0.0, 280.0, 70.0, 10.0, 10.0, 10.0, 100.0, 80.0, 140.0, 20.0, 40.0, 0.0, 20.0, 10.0, 190.0, 110.0, 30.0, 30.0, 30.0, 170.0, 120.0, 130.0, 50.0, 420.0, 60.0, 20.0, 80.0, 70.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 180.0, 40.0, 40.0, 30.0, 20.0, 10.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 100.0, 180.0, 40.0, 20.0, 20.0, 30.0, 10.0, 30.0, 10.0, 50.0, 60.0, 20.0, 60.0, 0.0, 80.0, 60.0, 100.0, 60.0, 110.0, 50.0, 80.0, 40.0, 20.0, 40.0, 200.0, 0.0, 30.0, 30.0, 70.0, 65.0, 70.0, 80.0, 150.0, 70.0, 350.0, 60.0, 90.0, 40.0, 60.0, -5.0, -40.0, 20.0, 100.0, 50.0, 30.0, 0.0, 20.0, 70.0, 30.0, -40.0, 120.0, 80.0, -40.0, 170.0, 250.0, 360.0, -40.0, 150.0, 80.0, 110.0, -10.0, 70.0, 80.0, 30.0, 220.0, -70.0, 170.0, 250.0, 50.0, 40.0, -40.0, 510.0, 40.0, 50.0, 140.0, 110.0, 420.0, 40.0, 30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0, 20.0, 60.0, -120.0, 40.0, 100.0, 120.0, 10.0, 30.0, 20.0, 20.0, 90.0, 10.0, 0.0, 80.0, 40.0, 0.0, 20.0, 170.0, 180.0, 100.0, 20.0, 60.0, 50.0, 20.0, 160.0, 50.0, 40.0, 10.0, 100.0, 20.0, 30.0, 120.0, 30.0, 10.0, 110.0, 120.0, 80.0, 100.0, 120.0, 20.0, 30.0, 30.0, 30.0, 10.0, 60.0, 10.0, 10.0, 20.0, 30.0, 130.0, 30.0, 10.0, 30.0, 100.0, 80.0, 100.0, 30.0, 40.0, 30.0, 10.0, 320.0, 90.0, 160.0, -90.0, 30.0, 70.0, 70.0, 80.0, 280.0, 40.0, 30.0, 30.0, 80.0, 60.0, 40.0, 10.0, 120.0, 20.0, 30.0, 40.0, 40.0, 0.0, 40.0, 50.0, 80.0, 120.0, 100.0, 30.0, 70.0, 20.0, -20.0, 10.0, 40.0, 30.0, 20.0, 260.0, 20.0, 20.0, 10.0, 35.0, 120.0, 90.0, 180.0, 20.0, 20.0, 10.0, 50.0, 80.0, 0.0, 10.0, -10.0, 250.0, 10.0, 30.0, 50.0, 220.0, 70.0, 30.0, 5.0, 30.0, 20.0, 50.0, 20.0, 180.0, 40.0, 100.0, 110.0, 40.0, 70.0, 150.0, 80.0, 90.0, 40.0, 260.0, 50.0, 100.0, 45.0, 20.0, 20.0, 10.0, 140.0, 190.0, 410.0, 60.0, 60.0, 60.0, 120.0, 60.0, 30.0, 140.0, 260.0, 70.0, 30.0, 150.0, 360.0, 40.0, 260.0, 310.0, -40.0, 30.0, 150.0, 10.0, 30.0, 0.0, 30.0, 80.0, 40.0, 40.0, 30.0, 50.0, 90.0, 190.0, 0.0, 280.0, 50.0, 50.0, 20.0, 60.0, 60.0, 80.0, 105.0, 100.0, 450.0, 50.0, 120.0, 50.0, 280.0, 70.0, 100.0, 170.0, 80.0, 170.0, 110.0, 600.0, 100.0, -10.0, -10.0, 50.0, 60.0, 100.0, 40.0, 30.0, 60.0, 320.0, 80.0, 200.0, 200.0, 0.0, 55.0, -20.0, 20.0, 120.0, 170.0, 90.0, 40.0, 30.0, 390.0, 30.0, 60.0, 90.0, 50.0, 50.0, -70.0, 60.0, 50.0, 190.0, 10.0, 70.0, 270.0, 30.0, 30.0, 800.0, 5.0, 170.0, 10.0, 270.0, 20.0, 30.0, 40.0, 0.0, 50.0, 90.0, 180.0, 20.0, 50.0, 20.0, -50.0, 50.0, 60.0, 150.0, 80.0, 40.0, 90.0, 110.0, 40.0, 30.0, 40.0, 70.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 70.0, 60.0, 20.0, 0.0, 190.0, 0.0, 20.0, 20.0, 80.0, 20.0, 30.0, 170.0, 40.0, 30.0, 40.0, 60.0, 30.0, 80.0, 270.0, 220.0, 0.0, 170.0, 80.0, 60.0, 210.0, 40.0, 40.0, 30.0, 80.0, 0.0, 40.0, 30.0, 40.0, 10.0, 150.0, 60.0, 0.0, 10.0, 20.0, 110.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 50.0, 420.0, 90.0, 40.0, 40.0, 90.0, 60.0, 90.0, 20.0, 80.0, 0.0, 100.0, 100.0, 80.0, 40.0, 100.0, 100.0, 150.0, 120.0, 100.0, 90.0, 40.0, 350.0, 90.0, 50.0, 100.0, 50.0, 40.0, 120.0, 160.0, 330.0, 180.0, 70.0, 90.0, 0.0, 20.0, 40.0, 0.0, 60.0, 50.0, 100.0, 190.0, 130.0, 10.0, 300.0, 140.0, 80.0, 80.0, 40.0, 80.0, 90.0, 90.0, 30.0, 20.0, 30.0, 70.0, 110.0, 0.0, 50.0, 170.0, 30.0, 120.0, 80.0, 90.0, 110.0, 0.0, 170.0, 0.0, 80.0, 50.0, 30.0, 40.0, 120.0, 40.0, 10.0, 90.0, 120.0, 0.0, 30.0, 320.0, 75.0, 50.0, 50.0, 310.0, 110.0, 110.0, 170.0, 30.0, 20.0, 60.0, 100.0, 100.0, 70.0, 50.0, 110.0, 90.0, 0.0, 70.0, 160.0, 20.0, -15.0, 90.0, 30.0, 80.0, 20.0, 130.0, 50.0, 90.0, 100.0, 50.0, 50.0, 0.0, 100.0, 40.0, 130.0, 80.0, 290.0, 50.0, 150.0, 10.0, 0.0, 220.0, 70.0, 60.0, -15.0, 80.0, 60.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 50.0, 20.0, -20.0, 320.0, 150.0, 140.0, 70.0, 520.0, 10.0, 210.0, 10.0, 20.0, 120.0, 40.0, 30.0, 80.0, 280.0, 360.0, 220.0, 40.0, 250.0, 0.0, 110.0, 50.0, 140.0, 170.0, 230.0, 70.0, 70.0, 0.0, 300.0, 30.0, 180.0, 80.0, 160.0, 80.0, 10.0, 70.0, 100.0, 130.0, 20.0, 60.0, 80.0, 90.0, 30.0, 90.0, 60.0, 200.0, 50.0, 50.0, 70.0, -30.0, -65.0, -35.0, -30.0, 80.0, -40.0, 70.0, 170.0, 70.0, -40.0, 30.0, 30.0, 0.0, 90.0, 30.0, 210.0, 10.0, 20.0, 200.0, 50.0, -20.0, 5.0, -10.0, 70.0, 70.0, 290.0, 220.0, 90.0, 100.0, 270.0, 40.0, 50.0, 50.0, 20.0, 180.0, 40.0, 170.0, 20.0, 60.0, 55.0, 110.0, 90.0, 80.0, 80.0, 220.0, 40.0, 10.0, 40.0, 170.0, 110.0, 70.0, 230.0, 80.0, 140.0, 70.0, 60.0, 500.0, 170.0, 160.0, 40.0, 50.0, 140.0, 200.0, 250.0, 70.0, 20.0, 50.0, 180.0, 70.0, 240.0, 230.0, 50.0, 170.0, 0.0, 30.0, 80.0, 30.0, 260.0, 0.0, 120.0, 100.0, 30.0, 210.0, 300.0, 100.0, 120.0, 55.0, 50.0, 40.0, 120.0, 20.0, 70.0, 70.0, 70.0, 20.0, 40.0, 80.0, 150.0, 25.0, 80.0, 110.0, 0.0, 30.0, 40.0, 140.0, 360.0, 20.0, 20.0, 0.0, 30.0, 20.0, 70.0, 10.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 20.0, 60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0, 85.0, 20.0, 50.0, 90.0, 110.0, 60.0, 160.0, 280.0, 180.0, 60.0, 120.0, -80.0, 0.0, 40.0, -50.0, 60.0, 10.0, 60.0, 260.0, 140.0, 10.0, 50.0, 60.0, 320.0, 180.0, 90.0, 120.0, 260.0, 10.0, 20.0, 70.0, 10.0, 490.0, 190.0, 90.0, 60.0, 70.0, 70.0, -10.0, 130.0, 40.0, 10.0, 70.0, 25.0, 0.0, 160.0, 0.0, 170.0, 40.0, 130.0, 30.0, 130.0, 40.0, 40.0, 50.0, 25.0, 140.0, 100.0, 70.0, 0.0, 130.0, 130.0, -10.0, 200.0, 260.0, 90.0, 70.0, -20.0, 150.0, 330.0, 60.0, 10.0, -40.0, 15.0, 110.0, 200.0, 50.0, 50.0, 150.0, 60.0, 100.0, 170.0, 60.0, 50.0, 110.0, 90.0, 140.0, 230.0, -10.0, 80.0, 70.0, 140.0, 110.0, 250.0, 50.0, 50.0, 30.0, 10.0, 320.0, 70.0, 510.0, 180.0, 95.0, 220.0, 40.0, 120.0, 100.0, 180.0, 150.0, 170.0, 70.0, 170.0, 25.0, 45.0, 50.0, 30.0, 190.0, 80.0, 110.0, 230.0, 190.0, 250.0, 70.0, 0.0, -10.0, 50.0, 60.0, 40.0, 200.0, 200.0, 60.0, 60.0, 80.0, 150.0, 40.0, 70.0, 100.0, 100.0, 110.0, 60.0, 20.0, 160.0, 60.0, 50.0, 320.0, 70.0, 170.0, 80.0, 140.0, 60.0, 10.0, 200.0, 0.0, 10.0, 80.0, 30.0, 70.0, 60.0, 90.0, 10.0, 90.0, -35.0, 140.0, 90.0, 130.0, 100.0, 190.0, 130.0, 150.0, 440.0, 20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5628577790974183, "mean_inference_ms": 1.4068394483883606, "mean_action_processing_ms": 0.44387240395248506, "mean_env_wait_ms": 1.2630330431442538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013111114501953125, "StateBufferConnector_ms": 0.010660409927368164, "ViewRequirementAgentConnector_ms": 0.4014909267425537}, "num_episodes": 18, "episode_return_max": 1765.0, "episode_return_min": 150.0, "episode_return_mean": 833.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.407068264425675, "num_env_steps_trained_throughput_per_sec": 21.407068264425675, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 187058.222, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187058.166, "sample_time_ms": 2547.783, "learn_time_ms": 184487.696, "learn_throughput": 21.682, "synch_weights_time_ms": 11.596}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "33e63_00000", "date": "2024-06-18_23-28-07", "timestamp": 1718767687, "time_this_iter_s": 186.88003873825073, "time_total_s": 8469.97384762764, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x321236ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8469.97384762764, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 25.131060606060608, "ram_util_percent": 78.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.07414009812287, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.7005629249528065, "policy_loss": -0.00906784147287236, "vf_loss": 6.708288419284759, "vf_explained_var": 0.0011653629481728973, "kl": 0.006711756042017329, "entropy": 0.632698307739406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1765.0, "episode_reward_min": 150.0, "episode_reward_mean": 835.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 83.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 300.0, 690.0, 530.0, 740.0, 360.0, 460.0, 1050.0, 460.0, 550.0, 425.0, 580.0, 685.0, 780.0, 715.0, 1270.0, 1470.0, 460.0, 880.0, 1495.0, 1250.0, 965.0, 1040.0, 710.0, 1375.0, 620.0, 550.0, 450.0, 510.0, 1160.0, 480.0, 390.0, 810.0, 710.0, 1140.0, 1050.0, 1060.0, 640.0, 820.0, 580.0, 1225.0, 630.0, 635.0, 930.0, 685.0, 190.0, 1430.0, 1440.0, 1140.0, 860.0, 780.0, 150.0, 670.0, 1085.0, 685.0, 950.0, 1520.0, 1270.0, 970.0, 1125.0, 625.0, 750.0, 240.0, 770.0, 1095.0, 560.0, 1120.0, 1170.0, 645.0, 625.0, 1330.0, 665.0, 1020.0, 1100.0, 1765.0, 1000.0, 1050.0, 830.0, 1130.0, 560.0, 1425.0, 325.0, 1030.0, 490.0, 600.0, 1220.0, 250.0, 585.0, 865.0, 620.0, 980.0, 670.0, 1255.0, 690.0, 765.0, 500.0, 1270.0, 620.0, 900.0, 1300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 50.0, 60.0, 70.0, 10.0, 10.0, 30.0, 70.0, 0.0, 190.0, 20.0, 60.0, -120.0, 40.0, 100.0, 120.0, 10.0, 30.0, 20.0, 20.0, 90.0, 10.0, 0.0, 80.0, 40.0, 0.0, 20.0, 170.0, 180.0, 100.0, 20.0, 60.0, 50.0, 20.0, 160.0, 50.0, 40.0, 10.0, 100.0, 20.0, 30.0, 120.0, 30.0, 10.0, 110.0, 120.0, 80.0, 100.0, 120.0, 20.0, 30.0, 30.0, 30.0, 10.0, 60.0, 10.0, 10.0, 20.0, 30.0, 130.0, 30.0, 10.0, 30.0, 100.0, 80.0, 100.0, 30.0, 40.0, 30.0, 10.0, 320.0, 90.0, 160.0, -90.0, 30.0, 70.0, 70.0, 80.0, 280.0, 40.0, 30.0, 30.0, 80.0, 60.0, 40.0, 10.0, 120.0, 20.0, 30.0, 40.0, 40.0, 0.0, 40.0, 50.0, 80.0, 120.0, 100.0, 30.0, 70.0, 20.0, -20.0, 10.0, 40.0, 30.0, 20.0, 260.0, 20.0, 20.0, 10.0, 35.0, 120.0, 90.0, 180.0, 20.0, 20.0, 10.0, 50.0, 80.0, 0.0, 10.0, -10.0, 250.0, 10.0, 30.0, 50.0, 220.0, 70.0, 30.0, 5.0, 30.0, 20.0, 50.0, 20.0, 180.0, 40.0, 100.0, 110.0, 40.0, 70.0, 150.0, 80.0, 90.0, 40.0, 260.0, 50.0, 100.0, 45.0, 20.0, 20.0, 10.0, 140.0, 190.0, 410.0, 60.0, 60.0, 60.0, 120.0, 60.0, 30.0, 140.0, 260.0, 70.0, 30.0, 150.0, 360.0, 40.0, 260.0, 310.0, -40.0, 30.0, 150.0, 10.0, 30.0, 0.0, 30.0, 80.0, 40.0, 40.0, 30.0, 50.0, 90.0, 190.0, 0.0, 280.0, 50.0, 50.0, 20.0, 60.0, 60.0, 80.0, 105.0, 100.0, 450.0, 50.0, 120.0, 50.0, 280.0, 70.0, 100.0, 170.0, 80.0, 170.0, 110.0, 600.0, 100.0, -10.0, -10.0, 50.0, 60.0, 100.0, 40.0, 30.0, 60.0, 320.0, 80.0, 200.0, 200.0, 0.0, 55.0, -20.0, 20.0, 120.0, 170.0, 90.0, 40.0, 30.0, 390.0, 30.0, 60.0, 90.0, 50.0, 50.0, -70.0, 60.0, 50.0, 190.0, 10.0, 70.0, 270.0, 30.0, 30.0, 800.0, 5.0, 170.0, 10.0, 270.0, 20.0, 30.0, 40.0, 0.0, 50.0, 90.0, 180.0, 20.0, 50.0, 20.0, -50.0, 50.0, 60.0, 150.0, 80.0, 40.0, 90.0, 110.0, 40.0, 30.0, 40.0, 70.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 70.0, 60.0, 20.0, 0.0, 190.0, 0.0, 20.0, 20.0, 80.0, 20.0, 30.0, 170.0, 40.0, 30.0, 40.0, 60.0, 30.0, 80.0, 270.0, 220.0, 0.0, 170.0, 80.0, 60.0, 210.0, 40.0, 40.0, 30.0, 80.0, 0.0, 40.0, 30.0, 40.0, 10.0, 150.0, 60.0, 0.0, 10.0, 20.0, 110.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 50.0, 420.0, 90.0, 40.0, 40.0, 90.0, 60.0, 90.0, 20.0, 80.0, 0.0, 100.0, 100.0, 80.0, 40.0, 100.0, 100.0, 150.0, 120.0, 100.0, 90.0, 40.0, 350.0, 90.0, 50.0, 100.0, 50.0, 40.0, 120.0, 160.0, 330.0, 180.0, 70.0, 90.0, 0.0, 20.0, 40.0, 0.0, 60.0, 50.0, 100.0, 190.0, 130.0, 10.0, 300.0, 140.0, 80.0, 80.0, 40.0, 80.0, 90.0, 90.0, 30.0, 20.0, 30.0, 70.0, 110.0, 0.0, 50.0, 170.0, 30.0, 120.0, 80.0, 90.0, 110.0, 0.0, 170.0, 0.0, 80.0, 50.0, 30.0, 40.0, 120.0, 40.0, 10.0, 90.0, 120.0, 0.0, 30.0, 320.0, 75.0, 50.0, 50.0, 310.0, 110.0, 110.0, 170.0, 30.0, 20.0, 60.0, 100.0, 100.0, 70.0, 50.0, 110.0, 90.0, 0.0, 70.0, 160.0, 20.0, -15.0, 90.0, 30.0, 80.0, 20.0, 130.0, 50.0, 90.0, 100.0, 50.0, 50.0, 0.0, 100.0, 40.0, 130.0, 80.0, 290.0, 50.0, 150.0, 10.0, 0.0, 220.0, 70.0, 60.0, -15.0, 80.0, 60.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 50.0, 20.0, -20.0, 320.0, 150.0, 140.0, 70.0, 520.0, 10.0, 210.0, 10.0, 20.0, 120.0, 40.0, 30.0, 80.0, 280.0, 360.0, 220.0, 40.0, 250.0, 0.0, 110.0, 50.0, 140.0, 170.0, 230.0, 70.0, 70.0, 0.0, 300.0, 30.0, 180.0, 80.0, 160.0, 80.0, 10.0, 70.0, 100.0, 130.0, 20.0, 60.0, 80.0, 90.0, 30.0, 90.0, 60.0, 200.0, 50.0, 50.0, 70.0, -30.0, -65.0, -35.0, -30.0, 80.0, -40.0, 70.0, 170.0, 70.0, -40.0, 30.0, 30.0, 0.0, 90.0, 30.0, 210.0, 10.0, 20.0, 200.0, 50.0, -20.0, 5.0, -10.0, 70.0, 70.0, 290.0, 220.0, 90.0, 100.0, 270.0, 40.0, 50.0, 50.0, 20.0, 180.0, 40.0, 170.0, 20.0, 60.0, 55.0, 110.0, 90.0, 80.0, 80.0, 220.0, 40.0, 10.0, 40.0, 170.0, 110.0, 70.0, 230.0, 80.0, 140.0, 70.0, 60.0, 500.0, 170.0, 160.0, 40.0, 50.0, 140.0, 200.0, 250.0, 70.0, 20.0, 50.0, 180.0, 70.0, 240.0, 230.0, 50.0, 170.0, 0.0, 30.0, 80.0, 30.0, 260.0, 0.0, 120.0, 100.0, 30.0, 210.0, 300.0, 100.0, 120.0, 55.0, 50.0, 40.0, 120.0, 20.0, 70.0, 70.0, 70.0, 20.0, 40.0, 80.0, 150.0, 25.0, 80.0, 110.0, 0.0, 30.0, 40.0, 140.0, 360.0, 20.0, 20.0, 0.0, 30.0, 20.0, 70.0, 10.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 20.0, 60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0, 85.0, 20.0, 50.0, 90.0, 110.0, 60.0, 160.0, 280.0, 180.0, 60.0, 120.0, -80.0, 0.0, 40.0, -50.0, 60.0, 10.0, 60.0, 260.0, 140.0, 10.0, 50.0, 60.0, 320.0, 180.0, 90.0, 120.0, 260.0, 10.0, 20.0, 70.0, 10.0, 490.0, 190.0, 90.0, 60.0, 70.0, 70.0, -10.0, 130.0, 40.0, 10.0, 70.0, 25.0, 0.0, 160.0, 0.0, 170.0, 40.0, 130.0, 30.0, 130.0, 40.0, 40.0, 50.0, 25.0, 140.0, 100.0, 70.0, 0.0, 130.0, 130.0, -10.0, 200.0, 260.0, 90.0, 70.0, -20.0, 150.0, 330.0, 60.0, 10.0, -40.0, 15.0, 110.0, 200.0, 50.0, 50.0, 150.0, 60.0, 100.0, 170.0, 60.0, 50.0, 110.0, 90.0, 140.0, 230.0, -10.0, 80.0, 70.0, 140.0, 110.0, 250.0, 50.0, 50.0, 30.0, 10.0, 320.0, 70.0, 510.0, 180.0, 95.0, 220.0, 40.0, 120.0, 100.0, 180.0, 150.0, 170.0, 70.0, 170.0, 25.0, 45.0, 50.0, 30.0, 190.0, 80.0, 110.0, 230.0, 190.0, 250.0, 70.0, 0.0, -10.0, 50.0, 60.0, 40.0, 200.0, 200.0, 60.0, 60.0, 80.0, 150.0, 40.0, 70.0, 100.0, 100.0, 110.0, 60.0, 20.0, 160.0, 60.0, 50.0, 320.0, 70.0, 170.0, 80.0, 140.0, 60.0, 10.0, 200.0, 0.0, 10.0, 80.0, 30.0, 70.0, 60.0, 90.0, 10.0, 90.0, -35.0, 140.0, 90.0, 130.0, 100.0, 190.0, 130.0, 150.0, 440.0, 20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0, 60.0, -50.0, 110.0, 100.0, 60.0, 150.0, 140.0, 80.0, 300.0, 80.0, 40.0, 60.0, 40.0, 20.0, 60.0, 80.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 130.0, 60.0, 30.0, 110.0, 70.0, 20.0, 110.0, 40.0, 60.0, -10.0, 50.0, 20.0, 40.0, 70.0, 690.0, 250.0, 30.0, 20.0, 60.0, 40.0, 10.0, 0.0, 70.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 45.0, 0.0, 20.0, 180.0, 230.0, 30.0, 30.0, 0.0, 30.0, 210.0, 100.0, 55.0, 20.0, 30.0, 80.0, 70.0, 30.0, 100.0, 170.0, 30.0, 70.0, 60.0, 190.0, 30.0, 50.0, 100.0, 90.0, 0.0, 0.0, 110.0, -30.0, 80.0, -20.0, 80.0, 70.0, 380.0, 60.0, 270.0, -20.0, 30.0, 50.0, -30.0, 0.0, 100.0, 50.0, 40.0, 240.0, 180.0, 10.0, 80.0, 380.0, 170.0, 210.0, 110.0, 80.0, 60.0, 95.0, 50.0, 20.0, 170.0, 20.0, 10.0, 210.0, 20.0, 40.0, 10.0, 20.0, 140.0, 50.0, 20.0, 70.0, 30.0, 40.0, 140.0, 40.0, 40.0, 30.0, 180.0, 175.0, 20.0, 90.0, 50.0, 80.0, 10.0, 25.0, 60.0, 90.0, 60.0, 15.0, 100.0, 80.0, 40.0, 220.0, 180.0, 90.0, 260.0, 70.0, 30.0, 200.0, 30.0, 0.0, 90.0, 40.0, 20.0, 90.0, 110.0, 150.0, 30.0, 60.0, 80.0, 100.0, 80.0, 50.0, 160.0, 270.0, 70.0, 30.0, 60.0, 0.0, 60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5623560464639639, "mean_inference_ms": 1.4064107174348068, "mean_action_processing_ms": 0.4425948197800932, "mean_env_wait_ms": 1.2623346016037156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013158321380615234, "StateBufferConnector_ms": 0.010970592498779297, "ViewRequirementAgentConnector_ms": 0.4081902503967285}, "num_episodes": 18, "episode_return_max": 1765.0, "episode_return_min": 150.0, "episode_return_mean": 835.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.304836781285722, "num_env_steps_trained_throughput_per_sec": 21.304836781285722, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 187010.405, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187010.35, "sample_time_ms": 2534.074, "learn_time_ms": 184453.579, "learn_throughput": 21.686, "synch_weights_time_ms": 11.793}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "33e63_00000", "date": "2024-06-18_23-31-15", "timestamp": 1718767875, "time_this_iter_s": 187.7596468925476, "time_total_s": 8657.733494520187, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276cad30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8657.733494520187, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 24.994736842105265, "ram_util_percent": 78.6657894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.158779618058342, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.956747802352499, "policy_loss": -0.010902367706392734, "vf_loss": 6.966136254949438, "vf_explained_var": 0.0007938536020894401, "kl": 0.00756958044592472, "entropy": 0.6531696638772789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1765.0, "episode_reward_min": 150.0, "episode_reward_mean": 862.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 86.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 710.0, 1375.0, 620.0, 550.0, 450.0, 510.0, 1160.0, 480.0, 390.0, 810.0, 710.0, 1140.0, 1050.0, 1060.0, 640.0, 820.0, 580.0, 1225.0, 630.0, 635.0, 930.0, 685.0, 190.0, 1430.0, 1440.0, 1140.0, 860.0, 780.0, 150.0, 670.0, 1085.0, 685.0, 950.0, 1520.0, 1270.0, 970.0, 1125.0, 625.0, 750.0, 240.0, 770.0, 1095.0, 560.0, 1120.0, 1170.0, 645.0, 625.0, 1330.0, 665.0, 1020.0, 1100.0, 1765.0, 1000.0, 1050.0, 830.0, 1130.0, 560.0, 1425.0, 325.0, 1030.0, 490.0, 600.0, 1220.0, 250.0, 585.0, 865.0, 620.0, 980.0, 670.0, 1255.0, 690.0, 765.0, 500.0, 1270.0, 620.0, 900.0, 1300.0, 1310.0, 430.0, 460.0, 740.0, 950.0, 610.0, 1310.0, 875.0, 700.0, 955.0, 1150.0, 1145.0, 1285.0, 740.0, 535.0, 1110.0, 1100.0, 670.0, 890.0, 365.0, 875.0, 1160.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 120.0, 170.0, 90.0, 40.0, 30.0, 390.0, 30.0, 60.0, 90.0, 50.0, 50.0, -70.0, 60.0, 50.0, 190.0, 10.0, 70.0, 270.0, 30.0, 30.0, 800.0, 5.0, 170.0, 10.0, 270.0, 20.0, 30.0, 40.0, 0.0, 50.0, 90.0, 180.0, 20.0, 50.0, 20.0, -50.0, 50.0, 60.0, 150.0, 80.0, 40.0, 90.0, 110.0, 40.0, 30.0, 40.0, 70.0, 10.0, 40.0, 20.0, 30.0, 40.0, 20.0, 70.0, 60.0, 20.0, 0.0, 190.0, 0.0, 20.0, 20.0, 80.0, 20.0, 30.0, 170.0, 40.0, 30.0, 40.0, 60.0, 30.0, 80.0, 270.0, 220.0, 0.0, 170.0, 80.0, 60.0, 210.0, 40.0, 40.0, 30.0, 80.0, 0.0, 40.0, 30.0, 40.0, 10.0, 150.0, 60.0, 0.0, 10.0, 20.0, 110.0, 50.0, 60.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 50.0, 420.0, 90.0, 40.0, 40.0, 90.0, 60.0, 90.0, 20.0, 80.0, 0.0, 100.0, 100.0, 80.0, 40.0, 100.0, 100.0, 150.0, 120.0, 100.0, 90.0, 40.0, 350.0, 90.0, 50.0, 100.0, 50.0, 40.0, 120.0, 160.0, 330.0, 180.0, 70.0, 90.0, 0.0, 20.0, 40.0, 0.0, 60.0, 50.0, 100.0, 190.0, 130.0, 10.0, 300.0, 140.0, 80.0, 80.0, 40.0, 80.0, 90.0, 90.0, 30.0, 20.0, 30.0, 70.0, 110.0, 0.0, 50.0, 170.0, 30.0, 120.0, 80.0, 90.0, 110.0, 0.0, 170.0, 0.0, 80.0, 50.0, 30.0, 40.0, 120.0, 40.0, 10.0, 90.0, 120.0, 0.0, 30.0, 320.0, 75.0, 50.0, 50.0, 310.0, 110.0, 110.0, 170.0, 30.0, 20.0, 60.0, 100.0, 100.0, 70.0, 50.0, 110.0, 90.0, 0.0, 70.0, 160.0, 20.0, -15.0, 90.0, 30.0, 80.0, 20.0, 130.0, 50.0, 90.0, 100.0, 50.0, 50.0, 0.0, 100.0, 40.0, 130.0, 80.0, 290.0, 50.0, 150.0, 10.0, 0.0, 220.0, 70.0, 60.0, -15.0, 80.0, 60.0, 10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 50.0, 20.0, -20.0, 320.0, 150.0, 140.0, 70.0, 520.0, 10.0, 210.0, 10.0, 20.0, 120.0, 40.0, 30.0, 80.0, 280.0, 360.0, 220.0, 40.0, 250.0, 0.0, 110.0, 50.0, 140.0, 170.0, 230.0, 70.0, 70.0, 0.0, 300.0, 30.0, 180.0, 80.0, 160.0, 80.0, 10.0, 70.0, 100.0, 130.0, 20.0, 60.0, 80.0, 90.0, 30.0, 90.0, 60.0, 200.0, 50.0, 50.0, 70.0, -30.0, -65.0, -35.0, -30.0, 80.0, -40.0, 70.0, 170.0, 70.0, -40.0, 30.0, 30.0, 0.0, 90.0, 30.0, 210.0, 10.0, 20.0, 200.0, 50.0, -20.0, 5.0, -10.0, 70.0, 70.0, 290.0, 220.0, 90.0, 100.0, 270.0, 40.0, 50.0, 50.0, 20.0, 180.0, 40.0, 170.0, 20.0, 60.0, 55.0, 110.0, 90.0, 80.0, 80.0, 220.0, 40.0, 10.0, 40.0, 170.0, 110.0, 70.0, 230.0, 80.0, 140.0, 70.0, 60.0, 500.0, 170.0, 160.0, 40.0, 50.0, 140.0, 200.0, 250.0, 70.0, 20.0, 50.0, 180.0, 70.0, 240.0, 230.0, 50.0, 170.0, 0.0, 30.0, 80.0, 30.0, 260.0, 0.0, 120.0, 100.0, 30.0, 210.0, 300.0, 100.0, 120.0, 55.0, 50.0, 40.0, 120.0, 20.0, 70.0, 70.0, 70.0, 20.0, 40.0, 80.0, 150.0, 25.0, 80.0, 110.0, 0.0, 30.0, 40.0, 140.0, 360.0, 20.0, 20.0, 0.0, 30.0, 20.0, 70.0, 10.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 20.0, 60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0, 85.0, 20.0, 50.0, 90.0, 110.0, 60.0, 160.0, 280.0, 180.0, 60.0, 120.0, -80.0, 0.0, 40.0, -50.0, 60.0, 10.0, 60.0, 260.0, 140.0, 10.0, 50.0, 60.0, 320.0, 180.0, 90.0, 120.0, 260.0, 10.0, 20.0, 70.0, 10.0, 490.0, 190.0, 90.0, 60.0, 70.0, 70.0, -10.0, 130.0, 40.0, 10.0, 70.0, 25.0, 0.0, 160.0, 0.0, 170.0, 40.0, 130.0, 30.0, 130.0, 40.0, 40.0, 50.0, 25.0, 140.0, 100.0, 70.0, 0.0, 130.0, 130.0, -10.0, 200.0, 260.0, 90.0, 70.0, -20.0, 150.0, 330.0, 60.0, 10.0, -40.0, 15.0, 110.0, 200.0, 50.0, 50.0, 150.0, 60.0, 100.0, 170.0, 60.0, 50.0, 110.0, 90.0, 140.0, 230.0, -10.0, 80.0, 70.0, 140.0, 110.0, 250.0, 50.0, 50.0, 30.0, 10.0, 320.0, 70.0, 510.0, 180.0, 95.0, 220.0, 40.0, 120.0, 100.0, 180.0, 150.0, 170.0, 70.0, 170.0, 25.0, 45.0, 50.0, 30.0, 190.0, 80.0, 110.0, 230.0, 190.0, 250.0, 70.0, 0.0, -10.0, 50.0, 60.0, 40.0, 200.0, 200.0, 60.0, 60.0, 80.0, 150.0, 40.0, 70.0, 100.0, 100.0, 110.0, 60.0, 20.0, 160.0, 60.0, 50.0, 320.0, 70.0, 170.0, 80.0, 140.0, 60.0, 10.0, 200.0, 0.0, 10.0, 80.0, 30.0, 70.0, 60.0, 90.0, 10.0, 90.0, -35.0, 140.0, 90.0, 130.0, 100.0, 190.0, 130.0, 150.0, 440.0, 20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0, 60.0, -50.0, 110.0, 100.0, 60.0, 150.0, 140.0, 80.0, 300.0, 80.0, 40.0, 60.0, 40.0, 20.0, 60.0, 80.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 130.0, 60.0, 30.0, 110.0, 70.0, 20.0, 110.0, 40.0, 60.0, -10.0, 50.0, 20.0, 40.0, 70.0, 690.0, 250.0, 30.0, 20.0, 60.0, 40.0, 10.0, 0.0, 70.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 45.0, 0.0, 20.0, 180.0, 230.0, 30.0, 30.0, 0.0, 30.0, 210.0, 100.0, 55.0, 20.0, 30.0, 80.0, 70.0, 30.0, 100.0, 170.0, 30.0, 70.0, 60.0, 190.0, 30.0, 50.0, 100.0, 90.0, 0.0, 0.0, 110.0, -30.0, 80.0, -20.0, 80.0, 70.0, 380.0, 60.0, 270.0, -20.0, 30.0, 50.0, -30.0, 0.0, 100.0, 50.0, 40.0, 240.0, 180.0, 10.0, 80.0, 380.0, 170.0, 210.0, 110.0, 80.0, 60.0, 95.0, 50.0, 20.0, 170.0, 20.0, 10.0, 210.0, 20.0, 40.0, 10.0, 20.0, 140.0, 50.0, 20.0, 70.0, 30.0, 40.0, 140.0, 40.0, 40.0, 30.0, 180.0, 175.0, 20.0, 90.0, 50.0, 80.0, 10.0, 25.0, 60.0, 90.0, 60.0, 15.0, 100.0, 80.0, 40.0, 220.0, 180.0, 90.0, 260.0, 70.0, 30.0, 200.0, 30.0, 0.0, 90.0, 40.0, 20.0, 90.0, 110.0, 150.0, 30.0, 60.0, 80.0, 100.0, 80.0, 50.0, 160.0, 270.0, 70.0, 30.0, 60.0, 0.0, 60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0, 150.0, 180.0, 200.0, 70.0, 50.0, 140.0, 110.0, 140.0, 220.0, 50.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 80.0, 30.0, 90.0, 30.0, 140.0, 60.0, 20.0, 20.0, 70.0, 50.0, 0.0, 10.0, 60.0, 80.0, 80.0, 40.0, 150.0, 290.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 120.0, 160.0, 40.0, 220.0, 160.0, 80.0, 110.0, 100.0, -40.0, 10.0, 180.0, 120.0, 20.0, 70.0, 80.0, 40.0, 40.0, 10.0, 40.0, 280.0, 190.0, 320.0, 100.0, 80.0, 30.0, 10.0, 150.0, 20.0, 130.0, 40.0, 40.0, 70.0, 0.0, 20.0, 0.0, 170.0, -10.0, 130.0, 415.0, -30.0, -30.0, 140.0, 50.0, 110.0, 60.0, 130.0, 110.0, 70.0, 90.0, 20.0, 200.0, 160.0, 50.0, 40.0, 30.0, 60.0, 5.0, 330.0, 60.0, 60.0, 50.0, 210.0, 320.0, 30.0, 70.0, 160.0, 110.0, 40.0, 100.0, 230.0, 130.0, -25.0, 170.0, 300.0, 60.0, 60.0, 40.0, 100.0, 80.0, 180.0, -20.0, 120.0, 80.0, 450.0, 120.0, 90.0, 80.0, 60.0, 125.0, 200.0, 110.0, 70.0, 50.0, 60.0, 30.0, -10.0, 60.0, 10.0, 160.0, 10.0, 60.0, 80.0, -10.0, 10.0, 90.0, 80.0, -5.0, 90.0, 130.0, 300.0, 110.0, 10.0, 20.0, 20.0, 50.0, 300.0, 10.0, 100.0, 190.0, 30.0, 20.0, 230.0, 40.0, 90.0, 160.0, 150.0, 40.0, 150.0, 190.0, 170.0, 40.0, 90.0, 130.0, 200.0, 100.0, -50.0, 50.0, 10.0, -70.0, 70.0, 30.0, 0.0, 190.0, 0.0, 450.0, -30.0, 50.0, 80.0, 50.0, 90.0, -15.0, 40.0, 30.0, 40.0, 20.0, 100.0, 30.0, 10.0, 20.0, 50.0, 70.0, 45.0, 60.0, 70.0, 80.0, 70.0, 200.0, 180.0, 50.0, 295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5604380990008924, "mean_inference_ms": 1.4045169002194724, "mean_action_processing_ms": 0.44128053305568543, "mean_env_wait_ms": 1.2612760165918986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012711286544799805, "StateBufferConnector_ms": 0.010746002197265625, "ViewRequirementAgentConnector_ms": 0.3894374370574951}, "num_episodes": 22, "episode_return_max": 1765.0, "episode_return_min": 150.0, "episode_return_mean": 862.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.49595730017143, "num_env_steps_trained_throughput_per_sec": 21.49595730017143, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 186898.982, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186898.927, "sample_time_ms": 2526.871, "learn_time_ms": 184350.773, "learn_throughput": 21.698, "synch_weights_time_ms": 11.329}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "33e63_00000", "date": "2024-06-18_23-34-21", "timestamp": 1718768061, "time_this_iter_s": 186.09069204330444, "time_total_s": 8843.824186563492, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276df550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8843.824186563492, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 24.6361216730038, "ram_util_percent": 78.80608365019012}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5147424328251007, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5975699506501675, "policy_loss": -0.008521805297029408, "vf_loss": 6.604849114737952, "vf_explained_var": 0.003518766647202773, "kl": 0.006213203137165131, "entropy": 0.643979877316025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1765.0, "episode_reward_min": 150.0, "episode_reward_mean": 869.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 86.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 1430.0, 1440.0, 1140.0, 860.0, 780.0, 150.0, 670.0, 1085.0, 685.0, 950.0, 1520.0, 1270.0, 970.0, 1125.0, 625.0, 750.0, 240.0, 770.0, 1095.0, 560.0, 1120.0, 1170.0, 645.0, 625.0, 1330.0, 665.0, 1020.0, 1100.0, 1765.0, 1000.0, 1050.0, 830.0, 1130.0, 560.0, 1425.0, 325.0, 1030.0, 490.0, 600.0, 1220.0, 250.0, 585.0, 865.0, 620.0, 980.0, 670.0, 1255.0, 690.0, 765.0, 500.0, 1270.0, 620.0, 900.0, 1300.0, 1310.0, 430.0, 460.0, 740.0, 950.0, 610.0, 1310.0, 875.0, 700.0, 955.0, 1150.0, 1145.0, 1285.0, 740.0, 535.0, 1110.0, 1100.0, 670.0, 890.0, 365.0, 875.0, 1160.0, 1220.0, 1280.0, 700.0, 640.0, 1360.0, 355.0, 445.0, 1240.0, 1470.0, 645.0, 210.0, 380.0, 1040.0, 1100.0, 685.0, 760.0, 450.0, 1110.0, 520.0, 410.0, 595.0, 910.0, 1360.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 0.0, 10.0, 50.0, 20.0, -20.0, 320.0, 150.0, 140.0, 70.0, 520.0, 10.0, 210.0, 10.0, 20.0, 120.0, 40.0, 30.0, 80.0, 280.0, 360.0, 220.0, 40.0, 250.0, 0.0, 110.0, 50.0, 140.0, 170.0, 230.0, 70.0, 70.0, 0.0, 300.0, 30.0, 180.0, 80.0, 160.0, 80.0, 10.0, 70.0, 100.0, 130.0, 20.0, 60.0, 80.0, 90.0, 30.0, 90.0, 60.0, 200.0, 50.0, 50.0, 70.0, -30.0, -65.0, -35.0, -30.0, 80.0, -40.0, 70.0, 170.0, 70.0, -40.0, 30.0, 30.0, 0.0, 90.0, 30.0, 210.0, 10.0, 20.0, 200.0, 50.0, -20.0, 5.0, -10.0, 70.0, 70.0, 290.0, 220.0, 90.0, 100.0, 270.0, 40.0, 50.0, 50.0, 20.0, 180.0, 40.0, 170.0, 20.0, 60.0, 55.0, 110.0, 90.0, 80.0, 80.0, 220.0, 40.0, 10.0, 40.0, 170.0, 110.0, 70.0, 230.0, 80.0, 140.0, 70.0, 60.0, 500.0, 170.0, 160.0, 40.0, 50.0, 140.0, 200.0, 250.0, 70.0, 20.0, 50.0, 180.0, 70.0, 240.0, 230.0, 50.0, 170.0, 0.0, 30.0, 80.0, 30.0, 260.0, 0.0, 120.0, 100.0, 30.0, 210.0, 300.0, 100.0, 120.0, 55.0, 50.0, 40.0, 120.0, 20.0, 70.0, 70.0, 70.0, 20.0, 40.0, 80.0, 150.0, 25.0, 80.0, 110.0, 0.0, 30.0, 40.0, 140.0, 360.0, 20.0, 20.0, 0.0, 30.0, 20.0, 70.0, 10.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 20.0, 60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0, 85.0, 20.0, 50.0, 90.0, 110.0, 60.0, 160.0, 280.0, 180.0, 60.0, 120.0, -80.0, 0.0, 40.0, -50.0, 60.0, 10.0, 60.0, 260.0, 140.0, 10.0, 50.0, 60.0, 320.0, 180.0, 90.0, 120.0, 260.0, 10.0, 20.0, 70.0, 10.0, 490.0, 190.0, 90.0, 60.0, 70.0, 70.0, -10.0, 130.0, 40.0, 10.0, 70.0, 25.0, 0.0, 160.0, 0.0, 170.0, 40.0, 130.0, 30.0, 130.0, 40.0, 40.0, 50.0, 25.0, 140.0, 100.0, 70.0, 0.0, 130.0, 130.0, -10.0, 200.0, 260.0, 90.0, 70.0, -20.0, 150.0, 330.0, 60.0, 10.0, -40.0, 15.0, 110.0, 200.0, 50.0, 50.0, 150.0, 60.0, 100.0, 170.0, 60.0, 50.0, 110.0, 90.0, 140.0, 230.0, -10.0, 80.0, 70.0, 140.0, 110.0, 250.0, 50.0, 50.0, 30.0, 10.0, 320.0, 70.0, 510.0, 180.0, 95.0, 220.0, 40.0, 120.0, 100.0, 180.0, 150.0, 170.0, 70.0, 170.0, 25.0, 45.0, 50.0, 30.0, 190.0, 80.0, 110.0, 230.0, 190.0, 250.0, 70.0, 0.0, -10.0, 50.0, 60.0, 40.0, 200.0, 200.0, 60.0, 60.0, 80.0, 150.0, 40.0, 70.0, 100.0, 100.0, 110.0, 60.0, 20.0, 160.0, 60.0, 50.0, 320.0, 70.0, 170.0, 80.0, 140.0, 60.0, 10.0, 200.0, 0.0, 10.0, 80.0, 30.0, 70.0, 60.0, 90.0, 10.0, 90.0, -35.0, 140.0, 90.0, 130.0, 100.0, 190.0, 130.0, 150.0, 440.0, 20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0, 60.0, -50.0, 110.0, 100.0, 60.0, 150.0, 140.0, 80.0, 300.0, 80.0, 40.0, 60.0, 40.0, 20.0, 60.0, 80.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 130.0, 60.0, 30.0, 110.0, 70.0, 20.0, 110.0, 40.0, 60.0, -10.0, 50.0, 20.0, 40.0, 70.0, 690.0, 250.0, 30.0, 20.0, 60.0, 40.0, 10.0, 0.0, 70.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 45.0, 0.0, 20.0, 180.0, 230.0, 30.0, 30.0, 0.0, 30.0, 210.0, 100.0, 55.0, 20.0, 30.0, 80.0, 70.0, 30.0, 100.0, 170.0, 30.0, 70.0, 60.0, 190.0, 30.0, 50.0, 100.0, 90.0, 0.0, 0.0, 110.0, -30.0, 80.0, -20.0, 80.0, 70.0, 380.0, 60.0, 270.0, -20.0, 30.0, 50.0, -30.0, 0.0, 100.0, 50.0, 40.0, 240.0, 180.0, 10.0, 80.0, 380.0, 170.0, 210.0, 110.0, 80.0, 60.0, 95.0, 50.0, 20.0, 170.0, 20.0, 10.0, 210.0, 20.0, 40.0, 10.0, 20.0, 140.0, 50.0, 20.0, 70.0, 30.0, 40.0, 140.0, 40.0, 40.0, 30.0, 180.0, 175.0, 20.0, 90.0, 50.0, 80.0, 10.0, 25.0, 60.0, 90.0, 60.0, 15.0, 100.0, 80.0, 40.0, 220.0, 180.0, 90.0, 260.0, 70.0, 30.0, 200.0, 30.0, 0.0, 90.0, 40.0, 20.0, 90.0, 110.0, 150.0, 30.0, 60.0, 80.0, 100.0, 80.0, 50.0, 160.0, 270.0, 70.0, 30.0, 60.0, 0.0, 60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0, 150.0, 180.0, 200.0, 70.0, 50.0, 140.0, 110.0, 140.0, 220.0, 50.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 80.0, 30.0, 90.0, 30.0, 140.0, 60.0, 20.0, 20.0, 70.0, 50.0, 0.0, 10.0, 60.0, 80.0, 80.0, 40.0, 150.0, 290.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 120.0, 160.0, 40.0, 220.0, 160.0, 80.0, 110.0, 100.0, -40.0, 10.0, 180.0, 120.0, 20.0, 70.0, 80.0, 40.0, 40.0, 10.0, 40.0, 280.0, 190.0, 320.0, 100.0, 80.0, 30.0, 10.0, 150.0, 20.0, 130.0, 40.0, 40.0, 70.0, 0.0, 20.0, 0.0, 170.0, -10.0, 130.0, 415.0, -30.0, -30.0, 140.0, 50.0, 110.0, 60.0, 130.0, 110.0, 70.0, 90.0, 20.0, 200.0, 160.0, 50.0, 40.0, 30.0, 60.0, 5.0, 330.0, 60.0, 60.0, 50.0, 210.0, 320.0, 30.0, 70.0, 160.0, 110.0, 40.0, 100.0, 230.0, 130.0, -25.0, 170.0, 300.0, 60.0, 60.0, 40.0, 100.0, 80.0, 180.0, -20.0, 120.0, 80.0, 450.0, 120.0, 90.0, 80.0, 60.0, 125.0, 200.0, 110.0, 70.0, 50.0, 60.0, 30.0, -10.0, 60.0, 10.0, 160.0, 10.0, 60.0, 80.0, -10.0, 10.0, 90.0, 80.0, -5.0, 90.0, 130.0, 300.0, 110.0, 10.0, 20.0, 20.0, 50.0, 300.0, 10.0, 100.0, 190.0, 30.0, 20.0, 230.0, 40.0, 90.0, 160.0, 150.0, 40.0, 150.0, 190.0, 170.0, 40.0, 90.0, 130.0, 200.0, 100.0, -50.0, 50.0, 10.0, -70.0, 70.0, 30.0, 0.0, 190.0, 0.0, 450.0, -30.0, 50.0, 80.0, 50.0, 90.0, -15.0, 40.0, 30.0, 40.0, 20.0, 100.0, 30.0, 10.0, 20.0, 50.0, 70.0, 45.0, 60.0, 70.0, 80.0, 70.0, 200.0, 180.0, 50.0, 295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0, 150.0, 60.0, 90.0, 80.0, 110.0, 150.0, 190.0, 80.0, 190.0, 120.0, 40.0, 240.0, 150.0, 70.0, 10.0, 520.0, 0.0, 50.0, 20.0, 180.0, 10.0, -30.0, 160.0, 180.0, 0.0, 10.0, 30.0, 40.0, 10.0, 290.0, 190.0, 10.0, 20.0, 60.0, 120.0, 40.0, 30.0, 100.0, 30.0, 40.0, 100.0, 150.0, 350.0, 150.0, 60.0, 310.0, 170.0, -30.0, 30.0, 70.0, 20.0, 0.0, 60.0, 40.0, -5.0, 70.0, 40.0, 10.0, 50.0, 70.0, 100.0, 0.0, 65.0, 80.0, 20.0, 10.0, 10.0, 130.0, 20.0, 10.0, 100.0, 90.0, 80.0, 50.0, 220.0, 150.0, 220.0, 20.0, 60.0, 250.0, 0.0, 270.0, 190.0, 50.0, 80.0, 30.0, 210.0, 180.0, 120.0, 340.0, 30.0, 60.0, 20.0, 50.0, 60.0, 160.0, 50.0, 35.0, 160.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 60.0, 10.0, 40.0, 10.0, 30.0, 40.0, 20.0, 170.0, 20.0, 0.0, 20.0, 50.0, 20.0, 50.0, -60.0, 170.0, 190.0, -50.0, 140.0, 70.0, 50.0, 120.0, 360.0, 190.0, 140.0, 140.0, 70.0, 90.0, 40.0, 180.0, 80.0, 120.0, 50.0, 40.0, 70.0, 50.0, 300.0, 10.0, 60.0, 60.0, 0.0, 5.0, 90.0, 100.0, 50.0, 80.0, 60.0, 160.0, 0.0, 120.0, 50.0, 120.0, 20.0, -50.0, 30.0, 10.0, 20.0, 10.0, 110.0, 190.0, 10.0, 60.0, 60.0, 0.0, 60.0, 410.0, 40.0, 120.0, 120.0, 40.0, 130.0, 90.0, 100.0, 370.0, 130.0, 80.0, -60.0, -35.0, 40.0, -45.0, -10.0, -30.0, 80.0, 170.0, 10.0, 10.0, 0.0, 20.0, 60.0, 80.0, 10.0, 10.0, 40.0, -25.0, 200.0, 110.0, 20.0, 60.0, 0.0, 40.0, 50.0, 80.0, 60.0, 50.0, 20.0, 130.0, 10.0, 60.0, 160.0, 70.0, 200.0, 160.0, 50.0, 100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5598427096073175, "mean_inference_ms": 1.4039538862824406, "mean_action_processing_ms": 0.43969170881413144, "mean_env_wait_ms": 1.2605291608326146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012411832809448242, "StateBufferConnector_ms": 0.010647296905517578, "ViewRequirementAgentConnector_ms": 0.3908963203430176}, "num_episodes": 23, "episode_return_max": 1765.0, "episode_return_min": 150.0, "episode_return_mean": 869.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.35651784475185, "num_env_steps_trained_throughput_per_sec": 21.35651784475185, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 186967.28, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186967.224, "sample_time_ms": 2499.376, "learn_time_ms": 184446.282, "learn_throughput": 21.687, "synch_weights_time_ms": 11.67}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "33e63_00000", "date": "2024-06-18_23-37-28", "timestamp": 1718768248, "time_this_iter_s": 187.3035590648651, "time_total_s": 9031.127745628357, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276df5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9031.127745628357, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 24.703787878787875, "ram_util_percent": 79.46287878787878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.953247667920475, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.277955215553633, "policy_loss": -0.01032353644214642, "vf_loss": 7.286816099632028, "vf_explained_var": 0.0018216045075458206, "kl": 0.007313298688719961, "entropy": 0.5864307539404645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1765.0, "episode_reward_min": 210.0, "episode_reward_mean": 874.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 87.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 1095.0, 560.0, 1120.0, 1170.0, 645.0, 625.0, 1330.0, 665.0, 1020.0, 1100.0, 1765.0, 1000.0, 1050.0, 830.0, 1130.0, 560.0, 1425.0, 325.0, 1030.0, 490.0, 600.0, 1220.0, 250.0, 585.0, 865.0, 620.0, 980.0, 670.0, 1255.0, 690.0, 765.0, 500.0, 1270.0, 620.0, 900.0, 1300.0, 1310.0, 430.0, 460.0, 740.0, 950.0, 610.0, 1310.0, 875.0, 700.0, 955.0, 1150.0, 1145.0, 1285.0, 740.0, 535.0, 1110.0, 1100.0, 670.0, 890.0, 365.0, 875.0, 1160.0, 1220.0, 1280.0, 700.0, 640.0, 1360.0, 355.0, 445.0, 1240.0, 1470.0, 645.0, 210.0, 380.0, 1040.0, 1100.0, 685.0, 760.0, 450.0, 1110.0, 520.0, 410.0, 595.0, 910.0, 1360.0, 1050.0, 1110.0, 1120.0, 620.0, 325.0, 810.0, 905.0, 1700.0, 600.0, 1065.0, 500.0, 710.0, 1275.0, 830.0, 820.0, 980.0, 890.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 100.0, 50.0, 20.0, 10.0, 200.0, 90.0, 90.0, 70.0, 80.0, 85.0, 20.0, 50.0, 90.0, 110.0, 60.0, 160.0, 280.0, 180.0, 60.0, 120.0, -80.0, 0.0, 40.0, -50.0, 60.0, 10.0, 60.0, 260.0, 140.0, 10.0, 50.0, 60.0, 320.0, 180.0, 90.0, 120.0, 260.0, 10.0, 20.0, 70.0, 10.0, 490.0, 190.0, 90.0, 60.0, 70.0, 70.0, -10.0, 130.0, 40.0, 10.0, 70.0, 25.0, 0.0, 160.0, 0.0, 170.0, 40.0, 130.0, 30.0, 130.0, 40.0, 40.0, 50.0, 25.0, 140.0, 100.0, 70.0, 0.0, 130.0, 130.0, -10.0, 200.0, 260.0, 90.0, 70.0, -20.0, 150.0, 330.0, 60.0, 10.0, -40.0, 15.0, 110.0, 200.0, 50.0, 50.0, 150.0, 60.0, 100.0, 170.0, 60.0, 50.0, 110.0, 90.0, 140.0, 230.0, -10.0, 80.0, 70.0, 140.0, 110.0, 250.0, 50.0, 50.0, 30.0, 10.0, 320.0, 70.0, 510.0, 180.0, 95.0, 220.0, 40.0, 120.0, 100.0, 180.0, 150.0, 170.0, 70.0, 170.0, 25.0, 45.0, 50.0, 30.0, 190.0, 80.0, 110.0, 230.0, 190.0, 250.0, 70.0, 0.0, -10.0, 50.0, 60.0, 40.0, 200.0, 200.0, 60.0, 60.0, 80.0, 150.0, 40.0, 70.0, 100.0, 100.0, 110.0, 60.0, 20.0, 160.0, 60.0, 50.0, 320.0, 70.0, 170.0, 80.0, 140.0, 60.0, 10.0, 200.0, 0.0, 10.0, 80.0, 30.0, 70.0, 60.0, 90.0, 10.0, 90.0, -35.0, 140.0, 90.0, 130.0, 100.0, 190.0, 130.0, 150.0, 440.0, 20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0, 60.0, -50.0, 110.0, 100.0, 60.0, 150.0, 140.0, 80.0, 300.0, 80.0, 40.0, 60.0, 40.0, 20.0, 60.0, 80.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 130.0, 60.0, 30.0, 110.0, 70.0, 20.0, 110.0, 40.0, 60.0, -10.0, 50.0, 20.0, 40.0, 70.0, 690.0, 250.0, 30.0, 20.0, 60.0, 40.0, 10.0, 0.0, 70.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 45.0, 0.0, 20.0, 180.0, 230.0, 30.0, 30.0, 0.0, 30.0, 210.0, 100.0, 55.0, 20.0, 30.0, 80.0, 70.0, 30.0, 100.0, 170.0, 30.0, 70.0, 60.0, 190.0, 30.0, 50.0, 100.0, 90.0, 0.0, 0.0, 110.0, -30.0, 80.0, -20.0, 80.0, 70.0, 380.0, 60.0, 270.0, -20.0, 30.0, 50.0, -30.0, 0.0, 100.0, 50.0, 40.0, 240.0, 180.0, 10.0, 80.0, 380.0, 170.0, 210.0, 110.0, 80.0, 60.0, 95.0, 50.0, 20.0, 170.0, 20.0, 10.0, 210.0, 20.0, 40.0, 10.0, 20.0, 140.0, 50.0, 20.0, 70.0, 30.0, 40.0, 140.0, 40.0, 40.0, 30.0, 180.0, 175.0, 20.0, 90.0, 50.0, 80.0, 10.0, 25.0, 60.0, 90.0, 60.0, 15.0, 100.0, 80.0, 40.0, 220.0, 180.0, 90.0, 260.0, 70.0, 30.0, 200.0, 30.0, 0.0, 90.0, 40.0, 20.0, 90.0, 110.0, 150.0, 30.0, 60.0, 80.0, 100.0, 80.0, 50.0, 160.0, 270.0, 70.0, 30.0, 60.0, 0.0, 60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0, 150.0, 180.0, 200.0, 70.0, 50.0, 140.0, 110.0, 140.0, 220.0, 50.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 80.0, 30.0, 90.0, 30.0, 140.0, 60.0, 20.0, 20.0, 70.0, 50.0, 0.0, 10.0, 60.0, 80.0, 80.0, 40.0, 150.0, 290.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 120.0, 160.0, 40.0, 220.0, 160.0, 80.0, 110.0, 100.0, -40.0, 10.0, 180.0, 120.0, 20.0, 70.0, 80.0, 40.0, 40.0, 10.0, 40.0, 280.0, 190.0, 320.0, 100.0, 80.0, 30.0, 10.0, 150.0, 20.0, 130.0, 40.0, 40.0, 70.0, 0.0, 20.0, 0.0, 170.0, -10.0, 130.0, 415.0, -30.0, -30.0, 140.0, 50.0, 110.0, 60.0, 130.0, 110.0, 70.0, 90.0, 20.0, 200.0, 160.0, 50.0, 40.0, 30.0, 60.0, 5.0, 330.0, 60.0, 60.0, 50.0, 210.0, 320.0, 30.0, 70.0, 160.0, 110.0, 40.0, 100.0, 230.0, 130.0, -25.0, 170.0, 300.0, 60.0, 60.0, 40.0, 100.0, 80.0, 180.0, -20.0, 120.0, 80.0, 450.0, 120.0, 90.0, 80.0, 60.0, 125.0, 200.0, 110.0, 70.0, 50.0, 60.0, 30.0, -10.0, 60.0, 10.0, 160.0, 10.0, 60.0, 80.0, -10.0, 10.0, 90.0, 80.0, -5.0, 90.0, 130.0, 300.0, 110.0, 10.0, 20.0, 20.0, 50.0, 300.0, 10.0, 100.0, 190.0, 30.0, 20.0, 230.0, 40.0, 90.0, 160.0, 150.0, 40.0, 150.0, 190.0, 170.0, 40.0, 90.0, 130.0, 200.0, 100.0, -50.0, 50.0, 10.0, -70.0, 70.0, 30.0, 0.0, 190.0, 0.0, 450.0, -30.0, 50.0, 80.0, 50.0, 90.0, -15.0, 40.0, 30.0, 40.0, 20.0, 100.0, 30.0, 10.0, 20.0, 50.0, 70.0, 45.0, 60.0, 70.0, 80.0, 70.0, 200.0, 180.0, 50.0, 295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0, 150.0, 60.0, 90.0, 80.0, 110.0, 150.0, 190.0, 80.0, 190.0, 120.0, 40.0, 240.0, 150.0, 70.0, 10.0, 520.0, 0.0, 50.0, 20.0, 180.0, 10.0, -30.0, 160.0, 180.0, 0.0, 10.0, 30.0, 40.0, 10.0, 290.0, 190.0, 10.0, 20.0, 60.0, 120.0, 40.0, 30.0, 100.0, 30.0, 40.0, 100.0, 150.0, 350.0, 150.0, 60.0, 310.0, 170.0, -30.0, 30.0, 70.0, 20.0, 0.0, 60.0, 40.0, -5.0, 70.0, 40.0, 10.0, 50.0, 70.0, 100.0, 0.0, 65.0, 80.0, 20.0, 10.0, 10.0, 130.0, 20.0, 10.0, 100.0, 90.0, 80.0, 50.0, 220.0, 150.0, 220.0, 20.0, 60.0, 250.0, 0.0, 270.0, 190.0, 50.0, 80.0, 30.0, 210.0, 180.0, 120.0, 340.0, 30.0, 60.0, 20.0, 50.0, 60.0, 160.0, 50.0, 35.0, 160.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 60.0, 10.0, 40.0, 10.0, 30.0, 40.0, 20.0, 170.0, 20.0, 0.0, 20.0, 50.0, 20.0, 50.0, -60.0, 170.0, 190.0, -50.0, 140.0, 70.0, 50.0, 120.0, 360.0, 190.0, 140.0, 140.0, 70.0, 90.0, 40.0, 180.0, 80.0, 120.0, 50.0, 40.0, 70.0, 50.0, 300.0, 10.0, 60.0, 60.0, 0.0, 5.0, 90.0, 100.0, 50.0, 80.0, 60.0, 160.0, 0.0, 120.0, 50.0, 120.0, 20.0, -50.0, 30.0, 10.0, 20.0, 10.0, 110.0, 190.0, 10.0, 60.0, 60.0, 0.0, 60.0, 410.0, 40.0, 120.0, 120.0, 40.0, 130.0, 90.0, 100.0, 370.0, 130.0, 80.0, -60.0, -35.0, 40.0, -45.0, -10.0, -30.0, 80.0, 170.0, 10.0, 10.0, 0.0, 20.0, 60.0, 80.0, 10.0, 10.0, 40.0, -25.0, 200.0, 110.0, 20.0, 60.0, 0.0, 40.0, 50.0, 80.0, 60.0, 50.0, 20.0, 130.0, 10.0, 60.0, 160.0, 70.0, 200.0, 160.0, 50.0, 100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0, 30.0, 90.0, 50.0, 80.0, 20.0, 240.0, 400.0, 50.0, 70.0, 20.0, 0.0, 90.0, 210.0, 250.0, 70.0, 40.0, 190.0, 120.0, 100.0, 40.0, 130.0, 220.0, 180.0, 30.0, 140.0, 20.0, 200.0, 100.0, 40.0, 60.0, 150.0, 0.0, 10.0, 30.0, 0.0, 40.0, 115.0, 65.0, 150.0, 60.0, 0.0, 0.0, -15.0, 30.0, 80.0, 0.0, 130.0, 50.0, 10.0, 40.0, 60.0, 70.0, 60.0, 20.0, 140.0, 40.0, 160.0, 30.0, 140.0, 90.0, 155.0, 130.0, 100.0, 80.0, 60.0, 160.0, 180.0, 0.0, 0.0, 40.0, 140.0, 230.0, 40.0, 130.0, 130.0, 20.0, 460.0, 290.0, 100.0, 160.0, 50.0, 120.0, 160.0, 0.0, 80.0, 100.0, 40.0, 10.0, 30.0, 10.0, 30.0, 60.0, 40.0, 430.0, 190.0, 160.0, 25.0, 90.0, 20.0, 20.0, -20.0, 70.0, 0.0, 70.0, 40.0, 180.0, 70.0, 80.0, -30.0, 40.0, 100.0, 80.0, 40.0, 40.0, 30.0, 10.0, 100.0, 120.0, 100.0, 90.0, 120.0, 85.0, 70.0, 70.0, 200.0, 190.0, 120.0, 180.0, 130.0, 110.0, 40.0, 170.0, 130.0, 160.0, 30.0, 60.0, 40.0, 10.0, 150.0, 40.0, 40.0, 120.0, 30.0, 30.0, 180.0, 30.0, -30.0, 220.0, 80.0, 120.0, -30.0, 220.0, 50.0, 10.0, 10.0, 80.0, 170.0, 350.0, 90.0, 30.0, 10.0, 230.0, 120.0, 130.0, 50.0, 20.0, 170.0, 40.0, 30.0, 90.0, 90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5577718313248132, "mean_inference_ms": 1.4050431611393563, "mean_action_processing_ms": 0.43871245534716463, "mean_env_wait_ms": 1.2595931062954064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012200355529785156, "StateBufferConnector_ms": 0.010363340377807617, "ViewRequirementAgentConnector_ms": 0.3887033462524414}, "num_episodes": 18, "episode_return_max": 1765.0, "episode_return_min": 210.0, "episode_return_mean": 874.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.369307713130596, "num_env_steps_trained_throughput_per_sec": 21.369307713130596, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 187007.88, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187007.825, "sample_time_ms": 2525.609, "learn_time_ms": 184460.426, "learn_throughput": 21.685, "synch_weights_time_ms": 11.908}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "33e63_00000", "date": "2024-06-18_23-40-35", "timestamp": 1718768435, "time_this_iter_s": 187.20236229896545, "time_total_s": 9218.330107927322, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276dfb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9218.330107927322, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 24.395471698113205, "ram_util_percent": 78.67132075471699}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2631856002746678, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.140049354413066, "policy_loss": -0.00936815634257526, "vf_loss": 7.148084306361449, "vf_explained_var": 0.0015576907494070685, "kl": 0.006665996827568796, "entropy": 0.597420139752003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 210.0, "episode_reward_mean": 856.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 85.64}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.0, 1030.0, 490.0, 600.0, 1220.0, 250.0, 585.0, 865.0, 620.0, 980.0, 670.0, 1255.0, 690.0, 765.0, 500.0, 1270.0, 620.0, 900.0, 1300.0, 1310.0, 430.0, 460.0, 740.0, 950.0, 610.0, 1310.0, 875.0, 700.0, 955.0, 1150.0, 1145.0, 1285.0, 740.0, 535.0, 1110.0, 1100.0, 670.0, 890.0, 365.0, 875.0, 1160.0, 1220.0, 1280.0, 700.0, 640.0, 1360.0, 355.0, 445.0, 1240.0, 1470.0, 645.0, 210.0, 380.0, 1040.0, 1100.0, 685.0, 760.0, 450.0, 1110.0, 520.0, 410.0, 595.0, 910.0, 1360.0, 1050.0, 1110.0, 1120.0, 620.0, 325.0, 810.0, 905.0, 1700.0, 600.0, 1065.0, 500.0, 710.0, 1275.0, 830.0, 820.0, 980.0, 890.0, 1070.0, 500.0, 770.0, 640.0, 1090.0, 950.0, 800.0, 895.0, 720.0, 800.0, 1265.0, 805.0, 980.0, 960.0, 1025.0, 760.0, 500.0, 1145.0, 1470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, -15.0, 50.0, 0.0, 40.0, 150.0, 20.0, 0.0, 20.0, 40.0, 60.0, -50.0, 110.0, 100.0, 60.0, 150.0, 140.0, 80.0, 300.0, 80.0, 40.0, 60.0, 40.0, 20.0, 60.0, 80.0, 20.0, 120.0, 40.0, 10.0, 30.0, 0.0, 130.0, 60.0, 30.0, 110.0, 70.0, 20.0, 110.0, 40.0, 60.0, -10.0, 50.0, 20.0, 40.0, 70.0, 690.0, 250.0, 30.0, 20.0, 60.0, 40.0, 10.0, 0.0, 70.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 45.0, 0.0, 20.0, 180.0, 230.0, 30.0, 30.0, 0.0, 30.0, 210.0, 100.0, 55.0, 20.0, 30.0, 80.0, 70.0, 30.0, 100.0, 170.0, 30.0, 70.0, 60.0, 190.0, 30.0, 50.0, 100.0, 90.0, 0.0, 0.0, 110.0, -30.0, 80.0, -20.0, 80.0, 70.0, 380.0, 60.0, 270.0, -20.0, 30.0, 50.0, -30.0, 0.0, 100.0, 50.0, 40.0, 240.0, 180.0, 10.0, 80.0, 380.0, 170.0, 210.0, 110.0, 80.0, 60.0, 95.0, 50.0, 20.0, 170.0, 20.0, 10.0, 210.0, 20.0, 40.0, 10.0, 20.0, 140.0, 50.0, 20.0, 70.0, 30.0, 40.0, 140.0, 40.0, 40.0, 30.0, 180.0, 175.0, 20.0, 90.0, 50.0, 80.0, 10.0, 25.0, 60.0, 90.0, 60.0, 15.0, 100.0, 80.0, 40.0, 220.0, 180.0, 90.0, 260.0, 70.0, 30.0, 200.0, 30.0, 0.0, 90.0, 40.0, 20.0, 90.0, 110.0, 150.0, 30.0, 60.0, 80.0, 100.0, 80.0, 50.0, 160.0, 270.0, 70.0, 30.0, 60.0, 0.0, 60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0, 150.0, 180.0, 200.0, 70.0, 50.0, 140.0, 110.0, 140.0, 220.0, 50.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 80.0, 30.0, 90.0, 30.0, 140.0, 60.0, 20.0, 20.0, 70.0, 50.0, 0.0, 10.0, 60.0, 80.0, 80.0, 40.0, 150.0, 290.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 120.0, 160.0, 40.0, 220.0, 160.0, 80.0, 110.0, 100.0, -40.0, 10.0, 180.0, 120.0, 20.0, 70.0, 80.0, 40.0, 40.0, 10.0, 40.0, 280.0, 190.0, 320.0, 100.0, 80.0, 30.0, 10.0, 150.0, 20.0, 130.0, 40.0, 40.0, 70.0, 0.0, 20.0, 0.0, 170.0, -10.0, 130.0, 415.0, -30.0, -30.0, 140.0, 50.0, 110.0, 60.0, 130.0, 110.0, 70.0, 90.0, 20.0, 200.0, 160.0, 50.0, 40.0, 30.0, 60.0, 5.0, 330.0, 60.0, 60.0, 50.0, 210.0, 320.0, 30.0, 70.0, 160.0, 110.0, 40.0, 100.0, 230.0, 130.0, -25.0, 170.0, 300.0, 60.0, 60.0, 40.0, 100.0, 80.0, 180.0, -20.0, 120.0, 80.0, 450.0, 120.0, 90.0, 80.0, 60.0, 125.0, 200.0, 110.0, 70.0, 50.0, 60.0, 30.0, -10.0, 60.0, 10.0, 160.0, 10.0, 60.0, 80.0, -10.0, 10.0, 90.0, 80.0, -5.0, 90.0, 130.0, 300.0, 110.0, 10.0, 20.0, 20.0, 50.0, 300.0, 10.0, 100.0, 190.0, 30.0, 20.0, 230.0, 40.0, 90.0, 160.0, 150.0, 40.0, 150.0, 190.0, 170.0, 40.0, 90.0, 130.0, 200.0, 100.0, -50.0, 50.0, 10.0, -70.0, 70.0, 30.0, 0.0, 190.0, 0.0, 450.0, -30.0, 50.0, 80.0, 50.0, 90.0, -15.0, 40.0, 30.0, 40.0, 20.0, 100.0, 30.0, 10.0, 20.0, 50.0, 70.0, 45.0, 60.0, 70.0, 80.0, 70.0, 200.0, 180.0, 50.0, 295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0, 150.0, 60.0, 90.0, 80.0, 110.0, 150.0, 190.0, 80.0, 190.0, 120.0, 40.0, 240.0, 150.0, 70.0, 10.0, 520.0, 0.0, 50.0, 20.0, 180.0, 10.0, -30.0, 160.0, 180.0, 0.0, 10.0, 30.0, 40.0, 10.0, 290.0, 190.0, 10.0, 20.0, 60.0, 120.0, 40.0, 30.0, 100.0, 30.0, 40.0, 100.0, 150.0, 350.0, 150.0, 60.0, 310.0, 170.0, -30.0, 30.0, 70.0, 20.0, 0.0, 60.0, 40.0, -5.0, 70.0, 40.0, 10.0, 50.0, 70.0, 100.0, 0.0, 65.0, 80.0, 20.0, 10.0, 10.0, 130.0, 20.0, 10.0, 100.0, 90.0, 80.0, 50.0, 220.0, 150.0, 220.0, 20.0, 60.0, 250.0, 0.0, 270.0, 190.0, 50.0, 80.0, 30.0, 210.0, 180.0, 120.0, 340.0, 30.0, 60.0, 20.0, 50.0, 60.0, 160.0, 50.0, 35.0, 160.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 60.0, 10.0, 40.0, 10.0, 30.0, 40.0, 20.0, 170.0, 20.0, 0.0, 20.0, 50.0, 20.0, 50.0, -60.0, 170.0, 190.0, -50.0, 140.0, 70.0, 50.0, 120.0, 360.0, 190.0, 140.0, 140.0, 70.0, 90.0, 40.0, 180.0, 80.0, 120.0, 50.0, 40.0, 70.0, 50.0, 300.0, 10.0, 60.0, 60.0, 0.0, 5.0, 90.0, 100.0, 50.0, 80.0, 60.0, 160.0, 0.0, 120.0, 50.0, 120.0, 20.0, -50.0, 30.0, 10.0, 20.0, 10.0, 110.0, 190.0, 10.0, 60.0, 60.0, 0.0, 60.0, 410.0, 40.0, 120.0, 120.0, 40.0, 130.0, 90.0, 100.0, 370.0, 130.0, 80.0, -60.0, -35.0, 40.0, -45.0, -10.0, -30.0, 80.0, 170.0, 10.0, 10.0, 0.0, 20.0, 60.0, 80.0, 10.0, 10.0, 40.0, -25.0, 200.0, 110.0, 20.0, 60.0, 0.0, 40.0, 50.0, 80.0, 60.0, 50.0, 20.0, 130.0, 10.0, 60.0, 160.0, 70.0, 200.0, 160.0, 50.0, 100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0, 30.0, 90.0, 50.0, 80.0, 20.0, 240.0, 400.0, 50.0, 70.0, 20.0, 0.0, 90.0, 210.0, 250.0, 70.0, 40.0, 190.0, 120.0, 100.0, 40.0, 130.0, 220.0, 180.0, 30.0, 140.0, 20.0, 200.0, 100.0, 40.0, 60.0, 150.0, 0.0, 10.0, 30.0, 0.0, 40.0, 115.0, 65.0, 150.0, 60.0, 0.0, 0.0, -15.0, 30.0, 80.0, 0.0, 130.0, 50.0, 10.0, 40.0, 60.0, 70.0, 60.0, 20.0, 140.0, 40.0, 160.0, 30.0, 140.0, 90.0, 155.0, 130.0, 100.0, 80.0, 60.0, 160.0, 180.0, 0.0, 0.0, 40.0, 140.0, 230.0, 40.0, 130.0, 130.0, 20.0, 460.0, 290.0, 100.0, 160.0, 50.0, 120.0, 160.0, 0.0, 80.0, 100.0, 40.0, 10.0, 30.0, 10.0, 30.0, 60.0, 40.0, 430.0, 190.0, 160.0, 25.0, 90.0, 20.0, 20.0, -20.0, 70.0, 0.0, 70.0, 40.0, 180.0, 70.0, 80.0, -30.0, 40.0, 100.0, 80.0, 40.0, 40.0, 30.0, 10.0, 100.0, 120.0, 100.0, 90.0, 120.0, 85.0, 70.0, 70.0, 200.0, 190.0, 120.0, 180.0, 130.0, 110.0, 40.0, 170.0, 130.0, 160.0, 30.0, 60.0, 40.0, 10.0, 150.0, 40.0, 40.0, 120.0, 30.0, 30.0, 180.0, 30.0, -30.0, 220.0, 80.0, 120.0, -30.0, 220.0, 50.0, 10.0, 10.0, 80.0, 170.0, 350.0, 90.0, 30.0, 10.0, 230.0, 120.0, 130.0, 50.0, 20.0, 170.0, 40.0, 30.0, 90.0, 90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0, 20.0, 50.0, 20.0, 20.0, 40.0, 10.0, 20.0, 90.0, 30.0, 200.0, 30.0, 30.0, 60.0, 10.0, 50.0, 190.0, -10.0, 140.0, 150.0, 120.0, 10.0, 20.0, 0.0, 380.0, 60.0, 100.0, 200.0, -140.0, 30.0, -20.0, 50.0, 150.0, 380.0, 60.0, 210.0, 40.0, 70.0, 10.0, 60.0, 60.0, 90.0, 20.0, 200.0, 30.0, 50.0, 30.0, 180.0, 330.0, 20.0, 0.0, 50.0, 190.0, 65.0, 80.0, 290.0, 20.0, 40.0, 70.0, 80.0, -85.0, 100.0, 120.0, 175.0, 220.0, 190.0, 70.0, -120.0, 60.0, 40.0, 40.0, 100.0, 70.0, 200.0, -10.0, 0.0, 70.0, 70.0, 60.0, 90.0, 70.0, 30.0, 70.0, 0.0, 60.0, -40.0, 280.0, 10.0, 260.0, 60.0, 70.0, 660.0, 40.0, 30.0, -30.0, 55.0, 50.0, 60.0, 110.0, 120.0, 170.0, 120.0, 90.0, 150.0, 30.0, 80.0, 90.0, 55.0, 10.0, 30.0, 150.0, 20.0, 60.0, 170.0, 30.0, 150.0, 0.0, 70.0, 150.0, 170.0, 160.0, 0.0, 60.0, 40.0, 300.0, 40.0, 20.0, 80.0, 120.0, 220.0, 80.0, -150.0, 80.0, 160.0, 70.0, 25.0, 100.0, 100.0, 260.0, 330.0, 50.0, 70.0, 70.0, 90.0, 120.0, 10.0, 120.0, 50.0, 30.0, 140.0, 60.0, 20.0, 10.0, 30.0, 280.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 50.0, 110.0, 60.0, 130.0, 210.0, 120.0, 280.0, 110.0, 65.0, 180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5562432569300404, "mean_inference_ms": 1.405339955707193, "mean_action_processing_ms": 0.4377091306940899, "mean_env_wait_ms": 1.2593020075817822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012159585952758789, "StateBufferConnector_ms": 0.010344982147216797, "ViewRequirementAgentConnector_ms": 0.3897693157196045}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 210.0, "episode_return_mean": 856.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.429000964673254, "num_env_steps_trained_throughput_per_sec": 21.429000964673254, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 187036.255, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187036.198, "sample_time_ms": 2517.4, "learn_time_ms": 184496.939, "learn_throughput": 21.681, "synch_weights_time_ms": 12.028}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "33e63_00000", "date": "2024-06-18_23-43-42", "timestamp": 1718768622, "time_this_iter_s": 186.67056894302368, "time_total_s": 9405.000676870346, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276dff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9405.000676870346, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 24.513636363636365, "ram_util_percent": 78.65530303030303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3026874574038168, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.309461442197854, "policy_loss": -0.009246147706627615, "vf_loss": 6.317374290216464, "vf_explained_var": -0.0004540108009395254, "kl": 0.006666506148240001, "entropy": 0.620183051695712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 210.0, "episode_reward_mean": 842.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 84.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1300.0, 1310.0, 430.0, 460.0, 740.0, 950.0, 610.0, 1310.0, 875.0, 700.0, 955.0, 1150.0, 1145.0, 1285.0, 740.0, 535.0, 1110.0, 1100.0, 670.0, 890.0, 365.0, 875.0, 1160.0, 1220.0, 1280.0, 700.0, 640.0, 1360.0, 355.0, 445.0, 1240.0, 1470.0, 645.0, 210.0, 380.0, 1040.0, 1100.0, 685.0, 760.0, 450.0, 1110.0, 520.0, 410.0, 595.0, 910.0, 1360.0, 1050.0, 1110.0, 1120.0, 620.0, 325.0, 810.0, 905.0, 1700.0, 600.0, 1065.0, 500.0, 710.0, 1275.0, 830.0, 820.0, 980.0, 890.0, 1070.0, 500.0, 770.0, 640.0, 1090.0, 950.0, 800.0, 895.0, 720.0, 800.0, 1265.0, 805.0, 980.0, 960.0, 1025.0, 760.0, 500.0, 1145.0, 1470.0, 620.0, 860.0, 330.0, 300.0, 1195.0, 550.0, 410.0, 490.0, 1210.0, 490.0, 815.0, 500.0, 480.0, 1270.0, 585.0, 840.0, 550.0, 775.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 120.0, 70.0, 210.0, 110.0, 140.0, 70.0, 140.0, 310.0, 70.0, 150.0, 180.0, 200.0, 70.0, 50.0, 140.0, 110.0, 140.0, 220.0, 50.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 80.0, 30.0, 90.0, 30.0, 140.0, 60.0, 20.0, 20.0, 70.0, 50.0, 0.0, 10.0, 60.0, 80.0, 80.0, 40.0, 150.0, 290.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 120.0, 160.0, 40.0, 220.0, 160.0, 80.0, 110.0, 100.0, -40.0, 10.0, 180.0, 120.0, 20.0, 70.0, 80.0, 40.0, 40.0, 10.0, 40.0, 280.0, 190.0, 320.0, 100.0, 80.0, 30.0, 10.0, 150.0, 20.0, 130.0, 40.0, 40.0, 70.0, 0.0, 20.0, 0.0, 170.0, -10.0, 130.0, 415.0, -30.0, -30.0, 140.0, 50.0, 110.0, 60.0, 130.0, 110.0, 70.0, 90.0, 20.0, 200.0, 160.0, 50.0, 40.0, 30.0, 60.0, 5.0, 330.0, 60.0, 60.0, 50.0, 210.0, 320.0, 30.0, 70.0, 160.0, 110.0, 40.0, 100.0, 230.0, 130.0, -25.0, 170.0, 300.0, 60.0, 60.0, 40.0, 100.0, 80.0, 180.0, -20.0, 120.0, 80.0, 450.0, 120.0, 90.0, 80.0, 60.0, 125.0, 200.0, 110.0, 70.0, 50.0, 60.0, 30.0, -10.0, 60.0, 10.0, 160.0, 10.0, 60.0, 80.0, -10.0, 10.0, 90.0, 80.0, -5.0, 90.0, 130.0, 300.0, 110.0, 10.0, 20.0, 20.0, 50.0, 300.0, 10.0, 100.0, 190.0, 30.0, 20.0, 230.0, 40.0, 90.0, 160.0, 150.0, 40.0, 150.0, 190.0, 170.0, 40.0, 90.0, 130.0, 200.0, 100.0, -50.0, 50.0, 10.0, -70.0, 70.0, 30.0, 0.0, 190.0, 0.0, 450.0, -30.0, 50.0, 80.0, 50.0, 90.0, -15.0, 40.0, 30.0, 40.0, 20.0, 100.0, 30.0, 10.0, 20.0, 50.0, 70.0, 45.0, 60.0, 70.0, 80.0, 70.0, 200.0, 180.0, 50.0, 295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0, 150.0, 60.0, 90.0, 80.0, 110.0, 150.0, 190.0, 80.0, 190.0, 120.0, 40.0, 240.0, 150.0, 70.0, 10.0, 520.0, 0.0, 50.0, 20.0, 180.0, 10.0, -30.0, 160.0, 180.0, 0.0, 10.0, 30.0, 40.0, 10.0, 290.0, 190.0, 10.0, 20.0, 60.0, 120.0, 40.0, 30.0, 100.0, 30.0, 40.0, 100.0, 150.0, 350.0, 150.0, 60.0, 310.0, 170.0, -30.0, 30.0, 70.0, 20.0, 0.0, 60.0, 40.0, -5.0, 70.0, 40.0, 10.0, 50.0, 70.0, 100.0, 0.0, 65.0, 80.0, 20.0, 10.0, 10.0, 130.0, 20.0, 10.0, 100.0, 90.0, 80.0, 50.0, 220.0, 150.0, 220.0, 20.0, 60.0, 250.0, 0.0, 270.0, 190.0, 50.0, 80.0, 30.0, 210.0, 180.0, 120.0, 340.0, 30.0, 60.0, 20.0, 50.0, 60.0, 160.0, 50.0, 35.0, 160.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 60.0, 10.0, 40.0, 10.0, 30.0, 40.0, 20.0, 170.0, 20.0, 0.0, 20.0, 50.0, 20.0, 50.0, -60.0, 170.0, 190.0, -50.0, 140.0, 70.0, 50.0, 120.0, 360.0, 190.0, 140.0, 140.0, 70.0, 90.0, 40.0, 180.0, 80.0, 120.0, 50.0, 40.0, 70.0, 50.0, 300.0, 10.0, 60.0, 60.0, 0.0, 5.0, 90.0, 100.0, 50.0, 80.0, 60.0, 160.0, 0.0, 120.0, 50.0, 120.0, 20.0, -50.0, 30.0, 10.0, 20.0, 10.0, 110.0, 190.0, 10.0, 60.0, 60.0, 0.0, 60.0, 410.0, 40.0, 120.0, 120.0, 40.0, 130.0, 90.0, 100.0, 370.0, 130.0, 80.0, -60.0, -35.0, 40.0, -45.0, -10.0, -30.0, 80.0, 170.0, 10.0, 10.0, 0.0, 20.0, 60.0, 80.0, 10.0, 10.0, 40.0, -25.0, 200.0, 110.0, 20.0, 60.0, 0.0, 40.0, 50.0, 80.0, 60.0, 50.0, 20.0, 130.0, 10.0, 60.0, 160.0, 70.0, 200.0, 160.0, 50.0, 100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0, 30.0, 90.0, 50.0, 80.0, 20.0, 240.0, 400.0, 50.0, 70.0, 20.0, 0.0, 90.0, 210.0, 250.0, 70.0, 40.0, 190.0, 120.0, 100.0, 40.0, 130.0, 220.0, 180.0, 30.0, 140.0, 20.0, 200.0, 100.0, 40.0, 60.0, 150.0, 0.0, 10.0, 30.0, 0.0, 40.0, 115.0, 65.0, 150.0, 60.0, 0.0, 0.0, -15.0, 30.0, 80.0, 0.0, 130.0, 50.0, 10.0, 40.0, 60.0, 70.0, 60.0, 20.0, 140.0, 40.0, 160.0, 30.0, 140.0, 90.0, 155.0, 130.0, 100.0, 80.0, 60.0, 160.0, 180.0, 0.0, 0.0, 40.0, 140.0, 230.0, 40.0, 130.0, 130.0, 20.0, 460.0, 290.0, 100.0, 160.0, 50.0, 120.0, 160.0, 0.0, 80.0, 100.0, 40.0, 10.0, 30.0, 10.0, 30.0, 60.0, 40.0, 430.0, 190.0, 160.0, 25.0, 90.0, 20.0, 20.0, -20.0, 70.0, 0.0, 70.0, 40.0, 180.0, 70.0, 80.0, -30.0, 40.0, 100.0, 80.0, 40.0, 40.0, 30.0, 10.0, 100.0, 120.0, 100.0, 90.0, 120.0, 85.0, 70.0, 70.0, 200.0, 190.0, 120.0, 180.0, 130.0, 110.0, 40.0, 170.0, 130.0, 160.0, 30.0, 60.0, 40.0, 10.0, 150.0, 40.0, 40.0, 120.0, 30.0, 30.0, 180.0, 30.0, -30.0, 220.0, 80.0, 120.0, -30.0, 220.0, 50.0, 10.0, 10.0, 80.0, 170.0, 350.0, 90.0, 30.0, 10.0, 230.0, 120.0, 130.0, 50.0, 20.0, 170.0, 40.0, 30.0, 90.0, 90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0, 20.0, 50.0, 20.0, 20.0, 40.0, 10.0, 20.0, 90.0, 30.0, 200.0, 30.0, 30.0, 60.0, 10.0, 50.0, 190.0, -10.0, 140.0, 150.0, 120.0, 10.0, 20.0, 0.0, 380.0, 60.0, 100.0, 200.0, -140.0, 30.0, -20.0, 50.0, 150.0, 380.0, 60.0, 210.0, 40.0, 70.0, 10.0, 60.0, 60.0, 90.0, 20.0, 200.0, 30.0, 50.0, 30.0, 180.0, 330.0, 20.0, 0.0, 50.0, 190.0, 65.0, 80.0, 290.0, 20.0, 40.0, 70.0, 80.0, -85.0, 100.0, 120.0, 175.0, 220.0, 190.0, 70.0, -120.0, 60.0, 40.0, 40.0, 100.0, 70.0, 200.0, -10.0, 0.0, 70.0, 70.0, 60.0, 90.0, 70.0, 30.0, 70.0, 0.0, 60.0, -40.0, 280.0, 10.0, 260.0, 60.0, 70.0, 660.0, 40.0, 30.0, -30.0, 55.0, 50.0, 60.0, 110.0, 120.0, 170.0, 120.0, 90.0, 150.0, 30.0, 80.0, 90.0, 55.0, 10.0, 30.0, 150.0, 20.0, 60.0, 170.0, 30.0, 150.0, 0.0, 70.0, 150.0, 170.0, 160.0, 0.0, 60.0, 40.0, 300.0, 40.0, 20.0, 80.0, 120.0, 220.0, 80.0, -150.0, 80.0, 160.0, 70.0, 25.0, 100.0, 100.0, 260.0, 330.0, 50.0, 70.0, 70.0, 90.0, 120.0, 10.0, 120.0, 50.0, 30.0, 140.0, 60.0, 20.0, 10.0, 30.0, 280.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 50.0, 110.0, 60.0, 130.0, 210.0, 120.0, 280.0, 110.0, 65.0, 180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0, 10.0, -100.0, 160.0, 20.0, 160.0, 0.0, 90.0, 30.0, 80.0, 170.0, 90.0, 30.0, 100.0, 20.0, 300.0, 40.0, -40.0, 20.0, 70.0, 230.0, 10.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 70.0, 40.0, 40.0, 0.0, 0.0, -40.0, 0.0, 0.0, 180.0, 80.0, 210.0, 180.0, 140.0, 110.0, 60.0, 190.0, 75.0, 20.0, 130.0, 30.0, 30.0, 20.0, 5.0, 10.0, -35.0, 250.0, 170.0, 70.0, 0.0, 10.0, 20.0, 30.0, 10.0, 40.0, 200.0, 0.0, 80.0, -20.0, 40.0, 20.0, 40.0, 30.0, 160.0, 30.0, 160.0, 20.0, 0.0, 20.0, 10.0, 170.0, 240.0, 110.0, -60.0, 80.0, 70.0, 120.0, 300.0, 50.0, 130.0, 100.0, 100.0, 30.0, 10.0, 30.0, 30.0, 0.0, 0.0, 120.0, 70.0, -15.0, 140.0, 40.0, 20.0, 30.0, 20.0, 70.0, 390.0, 120.0, 0.0, 30.0, 70.0, 50.0, 10.0, 30.0, 0.0, -50.0, 300.0, 40.0, 20.0, 90.0, 40.0, 70.0, 20.0, 80.0, 30.0, 20.0, 30.0, 80.0, 20.0, 190.0, 90.0, 180.0, -20.0, 260.0, 140.0, 20.0, 80.0, 40.0, 290.0, 30.0, 120.0, 50.0, 40.0, 35.0, 30.0, 60.0, 160.0, 40.0, 20.0, 20.0, 180.0, 40.0, 110.0, 40.0, 280.0, 100.0, 30.0, -10.0, 50.0, 100.0, 50.0, 160.0, -10.0, 10.0, 5.0, 80.0, 130.0, 5.0, 20.0, 0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.554958880897523, "mean_inference_ms": 1.4059240271243534, "mean_action_processing_ms": 0.4368411137311966, "mean_env_wait_ms": 1.259373763164211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012345075607299805, "StateBufferConnector_ms": 0.010061025619506836, "ViewRequirementAgentConnector_ms": 0.39116501808166504}, "num_episodes": 18, "episode_return_max": 1700.0, "episode_return_min": 210.0, "episode_return_mean": 842.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.418394644187003, "num_env_steps_trained_throughput_per_sec": 21.418394644187003, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 186960.786, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186960.741, "sample_time_ms": 2526.967, "learn_time_ms": 184412.733, "learn_throughput": 21.69, "synch_weights_time_ms": 11.658}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "33e63_00000", "date": "2024-06-18_23-46-49", "timestamp": 1718768809, "time_this_iter_s": 186.7632441520691, "time_total_s": 9591.763921022415, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d14c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9591.763921022415, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 24.94128787878788, "ram_util_percent": 79.02083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.677572150917226, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.98954915441771, "policy_loss": -0.009953719008112915, "vf_loss": 6.997984834372426, "vf_explained_var": -0.0004672713300036673, "kl": 0.007590193750329452, "entropy": 0.5905385229185113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 210.0, "episode_reward_mean": 830.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 83.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 1220.0, 1280.0, 700.0, 640.0, 1360.0, 355.0, 445.0, 1240.0, 1470.0, 645.0, 210.0, 380.0, 1040.0, 1100.0, 685.0, 760.0, 450.0, 1110.0, 520.0, 410.0, 595.0, 910.0, 1360.0, 1050.0, 1110.0, 1120.0, 620.0, 325.0, 810.0, 905.0, 1700.0, 600.0, 1065.0, 500.0, 710.0, 1275.0, 830.0, 820.0, 980.0, 890.0, 1070.0, 500.0, 770.0, 640.0, 1090.0, 950.0, 800.0, 895.0, 720.0, 800.0, 1265.0, 805.0, 980.0, 960.0, 1025.0, 760.0, 500.0, 1145.0, 1470.0, 620.0, 860.0, 330.0, 300.0, 1195.0, 550.0, 410.0, 490.0, 1210.0, 490.0, 815.0, 500.0, 480.0, 1270.0, 585.0, 840.0, 550.0, 775.0, 560.0, 970.0, 430.0, 1350.0, 770.0, 640.0, 1280.0, 1080.0, 1070.0, 870.0, 485.0, 795.0, 840.0, 440.0, 770.0, 590.0, 780.0, 990.0, 585.0, 750.0, 1025.0, 1220.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [295.0, -30.0, 25.0, 10.0, 70.0, 200.0, 350.0, 130.0, 0.0, 110.0, 150.0, 60.0, 90.0, 80.0, 110.0, 150.0, 190.0, 80.0, 190.0, 120.0, 40.0, 240.0, 150.0, 70.0, 10.0, 520.0, 0.0, 50.0, 20.0, 180.0, 10.0, -30.0, 160.0, 180.0, 0.0, 10.0, 30.0, 40.0, 10.0, 290.0, 190.0, 10.0, 20.0, 60.0, 120.0, 40.0, 30.0, 100.0, 30.0, 40.0, 100.0, 150.0, 350.0, 150.0, 60.0, 310.0, 170.0, -30.0, 30.0, 70.0, 20.0, 0.0, 60.0, 40.0, -5.0, 70.0, 40.0, 10.0, 50.0, 70.0, 100.0, 0.0, 65.0, 80.0, 20.0, 10.0, 10.0, 130.0, 20.0, 10.0, 100.0, 90.0, 80.0, 50.0, 220.0, 150.0, 220.0, 20.0, 60.0, 250.0, 0.0, 270.0, 190.0, 50.0, 80.0, 30.0, 210.0, 180.0, 120.0, 340.0, 30.0, 60.0, 20.0, 50.0, 60.0, 160.0, 50.0, 35.0, 160.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 60.0, 10.0, 40.0, 10.0, 30.0, 40.0, 20.0, 170.0, 20.0, 0.0, 20.0, 50.0, 20.0, 50.0, -60.0, 170.0, 190.0, -50.0, 140.0, 70.0, 50.0, 120.0, 360.0, 190.0, 140.0, 140.0, 70.0, 90.0, 40.0, 180.0, 80.0, 120.0, 50.0, 40.0, 70.0, 50.0, 300.0, 10.0, 60.0, 60.0, 0.0, 5.0, 90.0, 100.0, 50.0, 80.0, 60.0, 160.0, 0.0, 120.0, 50.0, 120.0, 20.0, -50.0, 30.0, 10.0, 20.0, 10.0, 110.0, 190.0, 10.0, 60.0, 60.0, 0.0, 60.0, 410.0, 40.0, 120.0, 120.0, 40.0, 130.0, 90.0, 100.0, 370.0, 130.0, 80.0, -60.0, -35.0, 40.0, -45.0, -10.0, -30.0, 80.0, 170.0, 10.0, 10.0, 0.0, 20.0, 60.0, 80.0, 10.0, 10.0, 40.0, -25.0, 200.0, 110.0, 20.0, 60.0, 0.0, 40.0, 50.0, 80.0, 60.0, 50.0, 20.0, 130.0, 10.0, 60.0, 160.0, 70.0, 200.0, 160.0, 50.0, 100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0, 30.0, 90.0, 50.0, 80.0, 20.0, 240.0, 400.0, 50.0, 70.0, 20.0, 0.0, 90.0, 210.0, 250.0, 70.0, 40.0, 190.0, 120.0, 100.0, 40.0, 130.0, 220.0, 180.0, 30.0, 140.0, 20.0, 200.0, 100.0, 40.0, 60.0, 150.0, 0.0, 10.0, 30.0, 0.0, 40.0, 115.0, 65.0, 150.0, 60.0, 0.0, 0.0, -15.0, 30.0, 80.0, 0.0, 130.0, 50.0, 10.0, 40.0, 60.0, 70.0, 60.0, 20.0, 140.0, 40.0, 160.0, 30.0, 140.0, 90.0, 155.0, 130.0, 100.0, 80.0, 60.0, 160.0, 180.0, 0.0, 0.0, 40.0, 140.0, 230.0, 40.0, 130.0, 130.0, 20.0, 460.0, 290.0, 100.0, 160.0, 50.0, 120.0, 160.0, 0.0, 80.0, 100.0, 40.0, 10.0, 30.0, 10.0, 30.0, 60.0, 40.0, 430.0, 190.0, 160.0, 25.0, 90.0, 20.0, 20.0, -20.0, 70.0, 0.0, 70.0, 40.0, 180.0, 70.0, 80.0, -30.0, 40.0, 100.0, 80.0, 40.0, 40.0, 30.0, 10.0, 100.0, 120.0, 100.0, 90.0, 120.0, 85.0, 70.0, 70.0, 200.0, 190.0, 120.0, 180.0, 130.0, 110.0, 40.0, 170.0, 130.0, 160.0, 30.0, 60.0, 40.0, 10.0, 150.0, 40.0, 40.0, 120.0, 30.0, 30.0, 180.0, 30.0, -30.0, 220.0, 80.0, 120.0, -30.0, 220.0, 50.0, 10.0, 10.0, 80.0, 170.0, 350.0, 90.0, 30.0, 10.0, 230.0, 120.0, 130.0, 50.0, 20.0, 170.0, 40.0, 30.0, 90.0, 90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0, 20.0, 50.0, 20.0, 20.0, 40.0, 10.0, 20.0, 90.0, 30.0, 200.0, 30.0, 30.0, 60.0, 10.0, 50.0, 190.0, -10.0, 140.0, 150.0, 120.0, 10.0, 20.0, 0.0, 380.0, 60.0, 100.0, 200.0, -140.0, 30.0, -20.0, 50.0, 150.0, 380.0, 60.0, 210.0, 40.0, 70.0, 10.0, 60.0, 60.0, 90.0, 20.0, 200.0, 30.0, 50.0, 30.0, 180.0, 330.0, 20.0, 0.0, 50.0, 190.0, 65.0, 80.0, 290.0, 20.0, 40.0, 70.0, 80.0, -85.0, 100.0, 120.0, 175.0, 220.0, 190.0, 70.0, -120.0, 60.0, 40.0, 40.0, 100.0, 70.0, 200.0, -10.0, 0.0, 70.0, 70.0, 60.0, 90.0, 70.0, 30.0, 70.0, 0.0, 60.0, -40.0, 280.0, 10.0, 260.0, 60.0, 70.0, 660.0, 40.0, 30.0, -30.0, 55.0, 50.0, 60.0, 110.0, 120.0, 170.0, 120.0, 90.0, 150.0, 30.0, 80.0, 90.0, 55.0, 10.0, 30.0, 150.0, 20.0, 60.0, 170.0, 30.0, 150.0, 0.0, 70.0, 150.0, 170.0, 160.0, 0.0, 60.0, 40.0, 300.0, 40.0, 20.0, 80.0, 120.0, 220.0, 80.0, -150.0, 80.0, 160.0, 70.0, 25.0, 100.0, 100.0, 260.0, 330.0, 50.0, 70.0, 70.0, 90.0, 120.0, 10.0, 120.0, 50.0, 30.0, 140.0, 60.0, 20.0, 10.0, 30.0, 280.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 50.0, 110.0, 60.0, 130.0, 210.0, 120.0, 280.0, 110.0, 65.0, 180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0, 10.0, -100.0, 160.0, 20.0, 160.0, 0.0, 90.0, 30.0, 80.0, 170.0, 90.0, 30.0, 100.0, 20.0, 300.0, 40.0, -40.0, 20.0, 70.0, 230.0, 10.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 70.0, 40.0, 40.0, 0.0, 0.0, -40.0, 0.0, 0.0, 180.0, 80.0, 210.0, 180.0, 140.0, 110.0, 60.0, 190.0, 75.0, 20.0, 130.0, 30.0, 30.0, 20.0, 5.0, 10.0, -35.0, 250.0, 170.0, 70.0, 0.0, 10.0, 20.0, 30.0, 10.0, 40.0, 200.0, 0.0, 80.0, -20.0, 40.0, 20.0, 40.0, 30.0, 160.0, 30.0, 160.0, 20.0, 0.0, 20.0, 10.0, 170.0, 240.0, 110.0, -60.0, 80.0, 70.0, 120.0, 300.0, 50.0, 130.0, 100.0, 100.0, 30.0, 10.0, 30.0, 30.0, 0.0, 0.0, 120.0, 70.0, -15.0, 140.0, 40.0, 20.0, 30.0, 20.0, 70.0, 390.0, 120.0, 0.0, 30.0, 70.0, 50.0, 10.0, 30.0, 0.0, -50.0, 300.0, 40.0, 20.0, 90.0, 40.0, 70.0, 20.0, 80.0, 30.0, 20.0, 30.0, 80.0, 20.0, 190.0, 90.0, 180.0, -20.0, 260.0, 140.0, 20.0, 80.0, 40.0, 290.0, 30.0, 120.0, 50.0, 40.0, 35.0, 30.0, 60.0, 160.0, 40.0, 20.0, 20.0, 180.0, 40.0, 110.0, 40.0, 280.0, 100.0, 30.0, -10.0, 50.0, 100.0, 50.0, 160.0, -10.0, 10.0, 5.0, 80.0, 130.0, 5.0, 20.0, 0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0, -10.0, 50.0, 20.0, 100.0, 0.0, 260.0, 70.0, 50.0, 10.0, 10.0, 170.0, 140.0, 60.0, 80.0, 90.0, 70.0, 120.0, 90.0, 70.0, 80.0, 90.0, 10.0, 0.0, 30.0, 80.0, 90.0, 40.0, 60.0, 0.0, 30.0, -40.0, 610.0, 190.0, 20.0, 20.0, 120.0, 80.0, 130.0, -50.0, 270.0, 330.0, 50.0, 20.0, 50.0, 60.0, 100.0, 30.0, -20.0, 130.0, 20.0, 20.0, 80.0, 30.0, 20.0, 260.0, 150.0, 10.0, 10.0, 30.0, 30.0, 180.0, 80.0, 150.0, 290.0, 40.0, 20.0, 280.0, 150.0, 50.0, 40.0, -50.0, 100.0, 160.0, 80.0, 310.0, 10.0, 290.0, 20.0, 40.0, 120.0, 120.0, 290.0, 60.0, 210.0, 80.0, 70.0, 110.0, 100.0, -130.0, 160.0, 50.0, 30.0, 300.0, 80.0, 40.0, 30.0, 20.0, 60.0, 110.0, 150.0, 60.0, 20.0, 10.0, 20.0, 60.0, 25.0, 160.0, -10.0, 20.0, 120.0, 20.0, 50.0, 160.0, 190.0, 60.0, 30.0, 160.0, 0.0, 25.0, 100.0, 100.0, 0.0, 80.0, 50.0, 160.0, 190.0, 40.0, 10.0, 20.0, 190.0, -40.0, 140.0, -40.0, 90.0, 0.0, 160.0, 40.0, 30.0, 20.0, 40.0, 40.0, 160.0, 70.0, 160.0, 70.0, 30.0, 30.0, 130.0, 10.0, 70.0, 0.0, 100.0, 30.0, 170.0, 20.0, 80.0, 40.0, 40.0, 70.0, 40.0, 160.0, 50.0, 10.0, 90.0, 120.0, -40.0, -20.0, 280.0, 20.0, 110.0, 70.0, 50.0, 60.0, 60.0, 30.0, 40.0, 220.0, 80.0, 280.0, 100.0, 50.0, 160.0, 20.0, 95.0, 0.0, 0.0, 40.0, 40.0, 10.0, 170.0, 40.0, 120.0, 110.0, 0.0, 60.0, 70.0, 30.0, 40.0, 200.0, 80.0, 100.0, 35.0, 250.0, 220.0, 200.0, -45.0, 10.0, 250.0, 30.0, -25.0, 440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.553631363866042, "mean_inference_ms": 1.406610241146418, "mean_action_processing_ms": 0.4357256179180323, "mean_env_wait_ms": 1.2594298579822332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012567281723022461, "StateBufferConnector_ms": 0.010090827941894531, "ViewRequirementAgentConnector_ms": 0.39281511306762695}, "num_episodes": 22, "episode_return_max": 1700.0, "episode_return_min": 210.0, "episode_return_mean": 830.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.541291688841103, "num_env_steps_trained_throughput_per_sec": 21.541291688841103, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 186847.399, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186847.353, "sample_time_ms": 2500.211, "learn_time_ms": 184325.835, "learn_throughput": 21.701, "synch_weights_time_ms": 12.02}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "33e63_00000", "date": "2024-06-18_23-49-54", "timestamp": 1718768994, "time_this_iter_s": 185.6982979774475, "time_total_s": 9777.462218999863, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276fadc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9777.462218999863, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 24.54790874524715, "ram_util_percent": 79.18174904942964}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5148469827997797, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.69165272804114, "policy_loss": -0.009468151391912807, "vf_loss": 6.699720851199442, "vf_explained_var": -0.0003271929689616568, "kl": 0.00700016586704014, "entropy": 0.5845902710550002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1700.0, "episode_reward_min": 230.0, "episode_reward_mean": 841.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 84.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1360.0, 1050.0, 1110.0, 1120.0, 620.0, 325.0, 810.0, 905.0, 1700.0, 600.0, 1065.0, 500.0, 710.0, 1275.0, 830.0, 820.0, 980.0, 890.0, 1070.0, 500.0, 770.0, 640.0, 1090.0, 950.0, 800.0, 895.0, 720.0, 800.0, 1265.0, 805.0, 980.0, 960.0, 1025.0, 760.0, 500.0, 1145.0, 1470.0, 620.0, 860.0, 330.0, 300.0, 1195.0, 550.0, 410.0, 490.0, 1210.0, 490.0, 815.0, 500.0, 480.0, 1270.0, 585.0, 840.0, 550.0, 775.0, 560.0, 970.0, 430.0, 1350.0, 770.0, 640.0, 1280.0, 1080.0, 1070.0, 870.0, 485.0, 795.0, 840.0, 440.0, 770.0, 590.0, 780.0, 990.0, 585.0, 750.0, 1025.0, 1220.0, 410.0, 1190.0, 1665.0, 750.0, 370.0, 1070.0, 515.0, 895.0, 725.0, 735.0, 230.0, 1645.0, 1300.0, 900.0, 720.0, 715.0, 1040.0, 1050.0, 1260.0, 520.0, 910.0, 905.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 130.0, 460.0, 40.0, -10.0, 320.0, 70.0, 90.0, 70.0, 90.0, 30.0, 90.0, 50.0, 80.0, 20.0, 240.0, 400.0, 50.0, 70.0, 20.0, 0.0, 90.0, 210.0, 250.0, 70.0, 40.0, 190.0, 120.0, 100.0, 40.0, 130.0, 220.0, 180.0, 30.0, 140.0, 20.0, 200.0, 100.0, 40.0, 60.0, 150.0, 0.0, 10.0, 30.0, 0.0, 40.0, 115.0, 65.0, 150.0, 60.0, 0.0, 0.0, -15.0, 30.0, 80.0, 0.0, 130.0, 50.0, 10.0, 40.0, 60.0, 70.0, 60.0, 20.0, 140.0, 40.0, 160.0, 30.0, 140.0, 90.0, 155.0, 130.0, 100.0, 80.0, 60.0, 160.0, 180.0, 0.0, 0.0, 40.0, 140.0, 230.0, 40.0, 130.0, 130.0, 20.0, 460.0, 290.0, 100.0, 160.0, 50.0, 120.0, 160.0, 0.0, 80.0, 100.0, 40.0, 10.0, 30.0, 10.0, 30.0, 60.0, 40.0, 430.0, 190.0, 160.0, 25.0, 90.0, 20.0, 20.0, -20.0, 70.0, 0.0, 70.0, 40.0, 180.0, 70.0, 80.0, -30.0, 40.0, 100.0, 80.0, 40.0, 40.0, 30.0, 10.0, 100.0, 120.0, 100.0, 90.0, 120.0, 85.0, 70.0, 70.0, 200.0, 190.0, 120.0, 180.0, 130.0, 110.0, 40.0, 170.0, 130.0, 160.0, 30.0, 60.0, 40.0, 10.0, 150.0, 40.0, 40.0, 120.0, 30.0, 30.0, 180.0, 30.0, -30.0, 220.0, 80.0, 120.0, -30.0, 220.0, 50.0, 10.0, 10.0, 80.0, 170.0, 350.0, 90.0, 30.0, 10.0, 230.0, 120.0, 130.0, 50.0, 20.0, 170.0, 40.0, 30.0, 90.0, 90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0, 20.0, 50.0, 20.0, 20.0, 40.0, 10.0, 20.0, 90.0, 30.0, 200.0, 30.0, 30.0, 60.0, 10.0, 50.0, 190.0, -10.0, 140.0, 150.0, 120.0, 10.0, 20.0, 0.0, 380.0, 60.0, 100.0, 200.0, -140.0, 30.0, -20.0, 50.0, 150.0, 380.0, 60.0, 210.0, 40.0, 70.0, 10.0, 60.0, 60.0, 90.0, 20.0, 200.0, 30.0, 50.0, 30.0, 180.0, 330.0, 20.0, 0.0, 50.0, 190.0, 65.0, 80.0, 290.0, 20.0, 40.0, 70.0, 80.0, -85.0, 100.0, 120.0, 175.0, 220.0, 190.0, 70.0, -120.0, 60.0, 40.0, 40.0, 100.0, 70.0, 200.0, -10.0, 0.0, 70.0, 70.0, 60.0, 90.0, 70.0, 30.0, 70.0, 0.0, 60.0, -40.0, 280.0, 10.0, 260.0, 60.0, 70.0, 660.0, 40.0, 30.0, -30.0, 55.0, 50.0, 60.0, 110.0, 120.0, 170.0, 120.0, 90.0, 150.0, 30.0, 80.0, 90.0, 55.0, 10.0, 30.0, 150.0, 20.0, 60.0, 170.0, 30.0, 150.0, 0.0, 70.0, 150.0, 170.0, 160.0, 0.0, 60.0, 40.0, 300.0, 40.0, 20.0, 80.0, 120.0, 220.0, 80.0, -150.0, 80.0, 160.0, 70.0, 25.0, 100.0, 100.0, 260.0, 330.0, 50.0, 70.0, 70.0, 90.0, 120.0, 10.0, 120.0, 50.0, 30.0, 140.0, 60.0, 20.0, 10.0, 30.0, 280.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 50.0, 110.0, 60.0, 130.0, 210.0, 120.0, 280.0, 110.0, 65.0, 180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0, 10.0, -100.0, 160.0, 20.0, 160.0, 0.0, 90.0, 30.0, 80.0, 170.0, 90.0, 30.0, 100.0, 20.0, 300.0, 40.0, -40.0, 20.0, 70.0, 230.0, 10.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 70.0, 40.0, 40.0, 0.0, 0.0, -40.0, 0.0, 0.0, 180.0, 80.0, 210.0, 180.0, 140.0, 110.0, 60.0, 190.0, 75.0, 20.0, 130.0, 30.0, 30.0, 20.0, 5.0, 10.0, -35.0, 250.0, 170.0, 70.0, 0.0, 10.0, 20.0, 30.0, 10.0, 40.0, 200.0, 0.0, 80.0, -20.0, 40.0, 20.0, 40.0, 30.0, 160.0, 30.0, 160.0, 20.0, 0.0, 20.0, 10.0, 170.0, 240.0, 110.0, -60.0, 80.0, 70.0, 120.0, 300.0, 50.0, 130.0, 100.0, 100.0, 30.0, 10.0, 30.0, 30.0, 0.0, 0.0, 120.0, 70.0, -15.0, 140.0, 40.0, 20.0, 30.0, 20.0, 70.0, 390.0, 120.0, 0.0, 30.0, 70.0, 50.0, 10.0, 30.0, 0.0, -50.0, 300.0, 40.0, 20.0, 90.0, 40.0, 70.0, 20.0, 80.0, 30.0, 20.0, 30.0, 80.0, 20.0, 190.0, 90.0, 180.0, -20.0, 260.0, 140.0, 20.0, 80.0, 40.0, 290.0, 30.0, 120.0, 50.0, 40.0, 35.0, 30.0, 60.0, 160.0, 40.0, 20.0, 20.0, 180.0, 40.0, 110.0, 40.0, 280.0, 100.0, 30.0, -10.0, 50.0, 100.0, 50.0, 160.0, -10.0, 10.0, 5.0, 80.0, 130.0, 5.0, 20.0, 0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0, -10.0, 50.0, 20.0, 100.0, 0.0, 260.0, 70.0, 50.0, 10.0, 10.0, 170.0, 140.0, 60.0, 80.0, 90.0, 70.0, 120.0, 90.0, 70.0, 80.0, 90.0, 10.0, 0.0, 30.0, 80.0, 90.0, 40.0, 60.0, 0.0, 30.0, -40.0, 610.0, 190.0, 20.0, 20.0, 120.0, 80.0, 130.0, -50.0, 270.0, 330.0, 50.0, 20.0, 50.0, 60.0, 100.0, 30.0, -20.0, 130.0, 20.0, 20.0, 80.0, 30.0, 20.0, 260.0, 150.0, 10.0, 10.0, 30.0, 30.0, 180.0, 80.0, 150.0, 290.0, 40.0, 20.0, 280.0, 150.0, 50.0, 40.0, -50.0, 100.0, 160.0, 80.0, 310.0, 10.0, 290.0, 20.0, 40.0, 120.0, 120.0, 290.0, 60.0, 210.0, 80.0, 70.0, 110.0, 100.0, -130.0, 160.0, 50.0, 30.0, 300.0, 80.0, 40.0, 30.0, 20.0, 60.0, 110.0, 150.0, 60.0, 20.0, 10.0, 20.0, 60.0, 25.0, 160.0, -10.0, 20.0, 120.0, 20.0, 50.0, 160.0, 190.0, 60.0, 30.0, 160.0, 0.0, 25.0, 100.0, 100.0, 0.0, 80.0, 50.0, 160.0, 190.0, 40.0, 10.0, 20.0, 190.0, -40.0, 140.0, -40.0, 90.0, 0.0, 160.0, 40.0, 30.0, 20.0, 40.0, 40.0, 160.0, 70.0, 160.0, 70.0, 30.0, 30.0, 130.0, 10.0, 70.0, 0.0, 100.0, 30.0, 170.0, 20.0, 80.0, 40.0, 40.0, 70.0, 40.0, 160.0, 50.0, 10.0, 90.0, 120.0, -40.0, -20.0, 280.0, 20.0, 110.0, 70.0, 50.0, 60.0, 60.0, 30.0, 40.0, 220.0, 80.0, 280.0, 100.0, 50.0, 160.0, 20.0, 95.0, 0.0, 0.0, 40.0, 40.0, 10.0, 170.0, 40.0, 120.0, 110.0, 0.0, 60.0, 70.0, 30.0, 40.0, 200.0, 80.0, 100.0, 35.0, 250.0, 220.0, 200.0, -45.0, 10.0, 250.0, 30.0, -25.0, 440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0, 60.0, 80.0, 70.0, 0.0, 70.0, 40.0, 30.0, 0.0, 50.0, 10.0, 140.0, 40.0, 10.0, 10.0, 120.0, 300.0, 20.0, 170.0, 130.0, 250.0, -45.0, 30.0, 160.0, 140.0, 190.0, 120.0, 650.0, 10.0, 120.0, 290.0, 10.0, 150.0, 40.0, 320.0, 40.0, 30.0, 90.0, 0.0, 20.0, 50.0, 100.0, 40.0, 90.0, 0.0, 40.0, 0.0, 0.0, 40.0, 30.0, 30.0, 180.0, 450.0, 40.0, 90.0, 80.0, 10.0, 20.0, 80.0, 50.0, 70.0, 40.0, 40.0, 50.0, 80.0, 80.0, 90.0, 40.0, 10.0, 65.0, 20.0, 270.0, 40.0, 15.0, 130.0, 80.0, 90.0, 30.0, 80.0, 110.0, 50.0, 150.0, 5.0, 0.0, 90.0, 0.0, 70.0, 60.0, 30.0, 140.0, 180.0, 100.0, -5.0, 0.0, 30.0, 230.0, 190.0, 10.0, 170.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 40.0, 20.0, 260.0, 290.0, 30.0, 460.0, 50.0, 190.0, 10.0, 40.0, 45.0, 270.0, 80.0, 130.0, 20.0, 340.0, 100.0, 40.0, 50.0, 100.0, 140.0, 300.0, 80.0, 50.0, 40.0, 200.0, 60.0, 230.0, 70.0, 30.0, 70.0, 70.0, 30.0, 160.0, 40.0, 10.0, 110.0, -20.0, 180.0, 130.0, 20.0, 60.0, 40.0, 50.0, 100.0, 50.0, 15.0, 90.0, 170.0, 40.0, 110.0, 50.0, 240.0, 110.0, 60.0, 100.0, 20.0, 30.0, 110.0, 110.0, 200.0, 60.0, 20.0, 180.0, 50.0, 50.0, 70.0, 340.0, 50.0, 80.0, 100.0, 110.0, 60.0, 310.0, 155.0, 400.0, 10.0, 50.0, 70.0, 15.0, 100.0, 90.0, 90.0, 60.0, 30.0, 10.0, 100.0, 40.0, 20.0, 50.0, 40.0, 80.0, 130.0, 70.0, 50.0, 100.0, 10.0, 30.0, 260.0, 210.0, 40.0, 10.0, 200.0, 80.0, -40.0, 40.0, 180.0, 50.0, -30.0, 30.0, 125.0, 270.0, 20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5524591977488889, "mean_inference_ms": 1.4071983697795836, "mean_action_processing_ms": 0.4346452884667229, "mean_env_wait_ms": 1.2595239134709393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012672901153564453, "StateBufferConnector_ms": 0.010154008865356445, "ViewRequirementAgentConnector_ms": 0.3923068046569824}, "num_episodes": 23, "episode_return_max": 1700.0, "episode_return_min": 230.0, "episode_return_mean": 841.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.481255065265497, "num_env_steps_trained_throughput_per_sec": 21.481255065265497, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 186805.47, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186805.423, "sample_time_ms": 2489.641, "learn_time_ms": 184295.413, "learn_throughput": 21.704, "synch_weights_time_ms": 11.772}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "33e63_00000", "date": "2024-06-18_23-53-01", "timestamp": 1718769181, "time_this_iter_s": 186.21971893310547, "time_total_s": 9963.681937932968, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9963.681937932968, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 24.67642585551331, "ram_util_percent": 79.57680608365018}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4492736018884678, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.703822297867114, "policy_loss": -0.01003215855916841, "vf_loss": 6.7124589176096725, "vf_explained_var": -0.001299050713753421, "kl": 0.006977694539553656, "entropy": 0.5821894911341012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1665.0, "episode_reward_min": 180.0, "episode_reward_mean": 832.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 83.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 500.0, 770.0, 640.0, 1090.0, 950.0, 800.0, 895.0, 720.0, 800.0, 1265.0, 805.0, 980.0, 960.0, 1025.0, 760.0, 500.0, 1145.0, 1470.0, 620.0, 860.0, 330.0, 300.0, 1195.0, 550.0, 410.0, 490.0, 1210.0, 490.0, 815.0, 500.0, 480.0, 1270.0, 585.0, 840.0, 550.0, 775.0, 560.0, 970.0, 430.0, 1350.0, 770.0, 640.0, 1280.0, 1080.0, 1070.0, 870.0, 485.0, 795.0, 840.0, 440.0, 770.0, 590.0, 780.0, 990.0, 585.0, 750.0, 1025.0, 1220.0, 410.0, 1190.0, 1665.0, 750.0, 370.0, 1070.0, 515.0, 895.0, 725.0, 735.0, 230.0, 1645.0, 1300.0, 900.0, 720.0, 715.0, 1040.0, 1050.0, 1260.0, 520.0, 910.0, 905.0, 240.0, 970.0, 1040.0, 900.0, 1290.0, 220.0, 630.0, 1080.0, 540.0, 855.0, 750.0, 730.0, 180.0, 1460.0, 770.0, 910.0, 1000.0, 1240.0, 1190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 10.0, 190.0, 100.0, 140.0, 200.0, 380.0, 0.0, 10.0, -50.0, 20.0, 50.0, 20.0, 20.0, 40.0, 10.0, 20.0, 90.0, 30.0, 200.0, 30.0, 30.0, 60.0, 10.0, 50.0, 190.0, -10.0, 140.0, 150.0, 120.0, 10.0, 20.0, 0.0, 380.0, 60.0, 100.0, 200.0, -140.0, 30.0, -20.0, 50.0, 150.0, 380.0, 60.0, 210.0, 40.0, 70.0, 10.0, 60.0, 60.0, 90.0, 20.0, 200.0, 30.0, 50.0, 30.0, 180.0, 330.0, 20.0, 0.0, 50.0, 190.0, 65.0, 80.0, 290.0, 20.0, 40.0, 70.0, 80.0, -85.0, 100.0, 120.0, 175.0, 220.0, 190.0, 70.0, -120.0, 60.0, 40.0, 40.0, 100.0, 70.0, 200.0, -10.0, 0.0, 70.0, 70.0, 60.0, 90.0, 70.0, 30.0, 70.0, 0.0, 60.0, -40.0, 280.0, 10.0, 260.0, 60.0, 70.0, 660.0, 40.0, 30.0, -30.0, 55.0, 50.0, 60.0, 110.0, 120.0, 170.0, 120.0, 90.0, 150.0, 30.0, 80.0, 90.0, 55.0, 10.0, 30.0, 150.0, 20.0, 60.0, 170.0, 30.0, 150.0, 0.0, 70.0, 150.0, 170.0, 160.0, 0.0, 60.0, 40.0, 300.0, 40.0, 20.0, 80.0, 120.0, 220.0, 80.0, -150.0, 80.0, 160.0, 70.0, 25.0, 100.0, 100.0, 260.0, 330.0, 50.0, 70.0, 70.0, 90.0, 120.0, 10.0, 120.0, 50.0, 30.0, 140.0, 60.0, 20.0, 10.0, 30.0, 280.0, 40.0, 30.0, 20.0, 30.0, 40.0, 0.0, 10.0, 50.0, 110.0, 60.0, 130.0, 210.0, 120.0, 280.0, 110.0, 65.0, 180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0, 10.0, -100.0, 160.0, 20.0, 160.0, 0.0, 90.0, 30.0, 80.0, 170.0, 90.0, 30.0, 100.0, 20.0, 300.0, 40.0, -40.0, 20.0, 70.0, 230.0, 10.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 70.0, 40.0, 40.0, 0.0, 0.0, -40.0, 0.0, 0.0, 180.0, 80.0, 210.0, 180.0, 140.0, 110.0, 60.0, 190.0, 75.0, 20.0, 130.0, 30.0, 30.0, 20.0, 5.0, 10.0, -35.0, 250.0, 170.0, 70.0, 0.0, 10.0, 20.0, 30.0, 10.0, 40.0, 200.0, 0.0, 80.0, -20.0, 40.0, 20.0, 40.0, 30.0, 160.0, 30.0, 160.0, 20.0, 0.0, 20.0, 10.0, 170.0, 240.0, 110.0, -60.0, 80.0, 70.0, 120.0, 300.0, 50.0, 130.0, 100.0, 100.0, 30.0, 10.0, 30.0, 30.0, 0.0, 0.0, 120.0, 70.0, -15.0, 140.0, 40.0, 20.0, 30.0, 20.0, 70.0, 390.0, 120.0, 0.0, 30.0, 70.0, 50.0, 10.0, 30.0, 0.0, -50.0, 300.0, 40.0, 20.0, 90.0, 40.0, 70.0, 20.0, 80.0, 30.0, 20.0, 30.0, 80.0, 20.0, 190.0, 90.0, 180.0, -20.0, 260.0, 140.0, 20.0, 80.0, 40.0, 290.0, 30.0, 120.0, 50.0, 40.0, 35.0, 30.0, 60.0, 160.0, 40.0, 20.0, 20.0, 180.0, 40.0, 110.0, 40.0, 280.0, 100.0, 30.0, -10.0, 50.0, 100.0, 50.0, 160.0, -10.0, 10.0, 5.0, 80.0, 130.0, 5.0, 20.0, 0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0, -10.0, 50.0, 20.0, 100.0, 0.0, 260.0, 70.0, 50.0, 10.0, 10.0, 170.0, 140.0, 60.0, 80.0, 90.0, 70.0, 120.0, 90.0, 70.0, 80.0, 90.0, 10.0, 0.0, 30.0, 80.0, 90.0, 40.0, 60.0, 0.0, 30.0, -40.0, 610.0, 190.0, 20.0, 20.0, 120.0, 80.0, 130.0, -50.0, 270.0, 330.0, 50.0, 20.0, 50.0, 60.0, 100.0, 30.0, -20.0, 130.0, 20.0, 20.0, 80.0, 30.0, 20.0, 260.0, 150.0, 10.0, 10.0, 30.0, 30.0, 180.0, 80.0, 150.0, 290.0, 40.0, 20.0, 280.0, 150.0, 50.0, 40.0, -50.0, 100.0, 160.0, 80.0, 310.0, 10.0, 290.0, 20.0, 40.0, 120.0, 120.0, 290.0, 60.0, 210.0, 80.0, 70.0, 110.0, 100.0, -130.0, 160.0, 50.0, 30.0, 300.0, 80.0, 40.0, 30.0, 20.0, 60.0, 110.0, 150.0, 60.0, 20.0, 10.0, 20.0, 60.0, 25.0, 160.0, -10.0, 20.0, 120.0, 20.0, 50.0, 160.0, 190.0, 60.0, 30.0, 160.0, 0.0, 25.0, 100.0, 100.0, 0.0, 80.0, 50.0, 160.0, 190.0, 40.0, 10.0, 20.0, 190.0, -40.0, 140.0, -40.0, 90.0, 0.0, 160.0, 40.0, 30.0, 20.0, 40.0, 40.0, 160.0, 70.0, 160.0, 70.0, 30.0, 30.0, 130.0, 10.0, 70.0, 0.0, 100.0, 30.0, 170.0, 20.0, 80.0, 40.0, 40.0, 70.0, 40.0, 160.0, 50.0, 10.0, 90.0, 120.0, -40.0, -20.0, 280.0, 20.0, 110.0, 70.0, 50.0, 60.0, 60.0, 30.0, 40.0, 220.0, 80.0, 280.0, 100.0, 50.0, 160.0, 20.0, 95.0, 0.0, 0.0, 40.0, 40.0, 10.0, 170.0, 40.0, 120.0, 110.0, 0.0, 60.0, 70.0, 30.0, 40.0, 200.0, 80.0, 100.0, 35.0, 250.0, 220.0, 200.0, -45.0, 10.0, 250.0, 30.0, -25.0, 440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0, 60.0, 80.0, 70.0, 0.0, 70.0, 40.0, 30.0, 0.0, 50.0, 10.0, 140.0, 40.0, 10.0, 10.0, 120.0, 300.0, 20.0, 170.0, 130.0, 250.0, -45.0, 30.0, 160.0, 140.0, 190.0, 120.0, 650.0, 10.0, 120.0, 290.0, 10.0, 150.0, 40.0, 320.0, 40.0, 30.0, 90.0, 0.0, 20.0, 50.0, 100.0, 40.0, 90.0, 0.0, 40.0, 0.0, 0.0, 40.0, 30.0, 30.0, 180.0, 450.0, 40.0, 90.0, 80.0, 10.0, 20.0, 80.0, 50.0, 70.0, 40.0, 40.0, 50.0, 80.0, 80.0, 90.0, 40.0, 10.0, 65.0, 20.0, 270.0, 40.0, 15.0, 130.0, 80.0, 90.0, 30.0, 80.0, 110.0, 50.0, 150.0, 5.0, 0.0, 90.0, 0.0, 70.0, 60.0, 30.0, 140.0, 180.0, 100.0, -5.0, 0.0, 30.0, 230.0, 190.0, 10.0, 170.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 40.0, 20.0, 260.0, 290.0, 30.0, 460.0, 50.0, 190.0, 10.0, 40.0, 45.0, 270.0, 80.0, 130.0, 20.0, 340.0, 100.0, 40.0, 50.0, 100.0, 140.0, 300.0, 80.0, 50.0, 40.0, 200.0, 60.0, 230.0, 70.0, 30.0, 70.0, 70.0, 30.0, 160.0, 40.0, 10.0, 110.0, -20.0, 180.0, 130.0, 20.0, 60.0, 40.0, 50.0, 100.0, 50.0, 15.0, 90.0, 170.0, 40.0, 110.0, 50.0, 240.0, 110.0, 60.0, 100.0, 20.0, 30.0, 110.0, 110.0, 200.0, 60.0, 20.0, 180.0, 50.0, 50.0, 70.0, 340.0, 50.0, 80.0, 100.0, 110.0, 60.0, 310.0, 155.0, 400.0, 10.0, 50.0, 70.0, 15.0, 100.0, 90.0, 90.0, 60.0, 30.0, 10.0, 100.0, 40.0, 20.0, 50.0, 40.0, 80.0, 130.0, 70.0, 50.0, 100.0, 10.0, 30.0, 260.0, 210.0, 40.0, 10.0, 200.0, 80.0, -40.0, 40.0, 180.0, 50.0, -30.0, 30.0, 125.0, 270.0, 20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0, 110.0, 80.0, 40.0, 30.0, 130.0, 30.0, 30.0, 310.0, 90.0, 120.0, 120.0, 390.0, -5.0, 70.0, 10.0, 170.0, -45.0, 270.0, 80.0, -20.0, 110.0, 30.0, 30.0, 80.0, 270.0, 40.0, 120.0, 40.0, 50.0, 130.0, 100.0, 100.0, 200.0, 120.0, 50.0, 340.0, 60.0, 80.0, 100.0, 140.0, 20.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 370.0, -45.0, 55.0, 30.0, 20.0, 20.0, 50.0, 80.0, 30.0, -40.0, 180.0, 200.0, 100.0, 200.0, 70.0, 120.0, 170.0, 20.0, 60.0, 110.0, 0.0, 20.0, 30.0, 0.0, 110.0, 20.0, 80.0, 150.0, 20.0, 120.0, 70.0, 40.0, 60.0, 120.0, 50.0, 300.0, 20.0, 15.0, 60.0, 160.0, 70.0, 200.0, 40.0, 10.0, 0.0, 160.0, 40.0, 30.0, 40.0, 60.0, 60.0, 130.0, 40.0, 20.0, 110.0, 180.0, 0.0, 90.0, 40.0, 40.0, 10.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 90.0, 300.0, 160.0, 80.0, 290.0, 50.0, 160.0, 140.0, 130.0, 60.0, 90.0, 20.0, 80.0, 20.0, 100.0, 120.0, 190.0, 50.0, 70.0, 30.0, 0.0, 100.0, 60.0, 80.0, 85.0, 130.0, 230.0, 30.0, 25.0, 170.0, 70.0, 40.0, 170.0, -30.0, 60.0, 210.0, 180.0, 60.0, 70.0, 170.0, 50.0, 120.0, 0.0, 70.0, 280.0, 90.0, 150.0, 310.0, 40.0, 130.0, 0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5516601555602227, "mean_inference_ms": 1.407693976073158, "mean_action_processing_ms": 0.4338520499613143, "mean_env_wait_ms": 1.2596858991814779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012419939041137695, "StateBufferConnector_ms": 0.009473800659179688, "ViewRequirementAgentConnector_ms": 0.38477373123168945}, "num_episodes": 18, "episode_return_max": 1665.0, "episode_return_min": 180.0, "episode_return_mean": 832.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.941123200558675, "num_env_steps_trained_throughput_per_sec": 20.941123200558675, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 187149.612, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187149.566, "sample_time_ms": 2493.044, "learn_time_ms": 184636.153, "learn_throughput": 21.664, "synch_weights_time_ms": 11.806}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "33e63_00000", "date": "2024-06-18_23-56-12", "timestamp": 1718769372, "time_this_iter_s": 191.0333387851715, "time_total_s": 10154.71527671814, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276df700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10154.71527671814, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 27.281851851851847, "ram_util_percent": 81.46185185185186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.605779131088521, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.192634319218076, "policy_loss": -0.00944726075369595, "vf_loss": 7.2008522024042945, "vf_explained_var": -0.00030298751002302566, "kl": 0.006146943969242609, "entropy": 0.5491316951660556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1665.0, "episode_reward_min": 180.0, "episode_reward_mean": 852.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 85.29}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1470.0, 620.0, 860.0, 330.0, 300.0, 1195.0, 550.0, 410.0, 490.0, 1210.0, 490.0, 815.0, 500.0, 480.0, 1270.0, 585.0, 840.0, 550.0, 775.0, 560.0, 970.0, 430.0, 1350.0, 770.0, 640.0, 1280.0, 1080.0, 1070.0, 870.0, 485.0, 795.0, 840.0, 440.0, 770.0, 590.0, 780.0, 990.0, 585.0, 750.0, 1025.0, 1220.0, 410.0, 1190.0, 1665.0, 750.0, 370.0, 1070.0, 515.0, 895.0, 725.0, 735.0, 230.0, 1645.0, 1300.0, 900.0, 720.0, 715.0, 1040.0, 1050.0, 1260.0, 520.0, 910.0, 905.0, 240.0, 970.0, 1040.0, 900.0, 1290.0, 220.0, 630.0, 1080.0, 540.0, 855.0, 750.0, 730.0, 180.0, 1460.0, 770.0, 910.0, 1000.0, 1240.0, 1190.0, 530.0, 490.0, 1315.0, 1075.0, 920.0, 1420.0, 890.0, 1000.0, 660.0, 880.0, 750.0, 1480.0, 1410.0, 440.0, 890.0, 1210.0, 1325.0, 1060.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, 110.0, 90.0, 450.0, 130.0, 110.0, 50.0, 140.0, 150.0, 60.0, 10.0, -100.0, 160.0, 20.0, 160.0, 0.0, 90.0, 30.0, 80.0, 170.0, 90.0, 30.0, 100.0, 20.0, 300.0, 40.0, -40.0, 20.0, 70.0, 230.0, 10.0, 50.0, 20.0, 60.0, 30.0, 30.0, 10.0, 50.0, 40.0, 30.0, 10.0, 70.0, 40.0, 40.0, 0.0, 0.0, -40.0, 0.0, 0.0, 180.0, 80.0, 210.0, 180.0, 140.0, 110.0, 60.0, 190.0, 75.0, 20.0, 130.0, 30.0, 30.0, 20.0, 5.0, 10.0, -35.0, 250.0, 170.0, 70.0, 0.0, 10.0, 20.0, 30.0, 10.0, 40.0, 200.0, 0.0, 80.0, -20.0, 40.0, 20.0, 40.0, 30.0, 160.0, 30.0, 160.0, 20.0, 0.0, 20.0, 10.0, 170.0, 240.0, 110.0, -60.0, 80.0, 70.0, 120.0, 300.0, 50.0, 130.0, 100.0, 100.0, 30.0, 10.0, 30.0, 30.0, 0.0, 0.0, 120.0, 70.0, -15.0, 140.0, 40.0, 20.0, 30.0, 20.0, 70.0, 390.0, 120.0, 0.0, 30.0, 70.0, 50.0, 10.0, 30.0, 0.0, -50.0, 300.0, 40.0, 20.0, 90.0, 40.0, 70.0, 20.0, 80.0, 30.0, 20.0, 30.0, 80.0, 20.0, 190.0, 90.0, 180.0, -20.0, 260.0, 140.0, 20.0, 80.0, 40.0, 290.0, 30.0, 120.0, 50.0, 40.0, 35.0, 30.0, 60.0, 160.0, 40.0, 20.0, 20.0, 180.0, 40.0, 110.0, 40.0, 280.0, 100.0, 30.0, -10.0, 50.0, 100.0, 50.0, 160.0, -10.0, 10.0, 5.0, 80.0, 130.0, 5.0, 20.0, 0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0, -10.0, 50.0, 20.0, 100.0, 0.0, 260.0, 70.0, 50.0, 10.0, 10.0, 170.0, 140.0, 60.0, 80.0, 90.0, 70.0, 120.0, 90.0, 70.0, 80.0, 90.0, 10.0, 0.0, 30.0, 80.0, 90.0, 40.0, 60.0, 0.0, 30.0, -40.0, 610.0, 190.0, 20.0, 20.0, 120.0, 80.0, 130.0, -50.0, 270.0, 330.0, 50.0, 20.0, 50.0, 60.0, 100.0, 30.0, -20.0, 130.0, 20.0, 20.0, 80.0, 30.0, 20.0, 260.0, 150.0, 10.0, 10.0, 30.0, 30.0, 180.0, 80.0, 150.0, 290.0, 40.0, 20.0, 280.0, 150.0, 50.0, 40.0, -50.0, 100.0, 160.0, 80.0, 310.0, 10.0, 290.0, 20.0, 40.0, 120.0, 120.0, 290.0, 60.0, 210.0, 80.0, 70.0, 110.0, 100.0, -130.0, 160.0, 50.0, 30.0, 300.0, 80.0, 40.0, 30.0, 20.0, 60.0, 110.0, 150.0, 60.0, 20.0, 10.0, 20.0, 60.0, 25.0, 160.0, -10.0, 20.0, 120.0, 20.0, 50.0, 160.0, 190.0, 60.0, 30.0, 160.0, 0.0, 25.0, 100.0, 100.0, 0.0, 80.0, 50.0, 160.0, 190.0, 40.0, 10.0, 20.0, 190.0, -40.0, 140.0, -40.0, 90.0, 0.0, 160.0, 40.0, 30.0, 20.0, 40.0, 40.0, 160.0, 70.0, 160.0, 70.0, 30.0, 30.0, 130.0, 10.0, 70.0, 0.0, 100.0, 30.0, 170.0, 20.0, 80.0, 40.0, 40.0, 70.0, 40.0, 160.0, 50.0, 10.0, 90.0, 120.0, -40.0, -20.0, 280.0, 20.0, 110.0, 70.0, 50.0, 60.0, 60.0, 30.0, 40.0, 220.0, 80.0, 280.0, 100.0, 50.0, 160.0, 20.0, 95.0, 0.0, 0.0, 40.0, 40.0, 10.0, 170.0, 40.0, 120.0, 110.0, 0.0, 60.0, 70.0, 30.0, 40.0, 200.0, 80.0, 100.0, 35.0, 250.0, 220.0, 200.0, -45.0, 10.0, 250.0, 30.0, -25.0, 440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0, 60.0, 80.0, 70.0, 0.0, 70.0, 40.0, 30.0, 0.0, 50.0, 10.0, 140.0, 40.0, 10.0, 10.0, 120.0, 300.0, 20.0, 170.0, 130.0, 250.0, -45.0, 30.0, 160.0, 140.0, 190.0, 120.0, 650.0, 10.0, 120.0, 290.0, 10.0, 150.0, 40.0, 320.0, 40.0, 30.0, 90.0, 0.0, 20.0, 50.0, 100.0, 40.0, 90.0, 0.0, 40.0, 0.0, 0.0, 40.0, 30.0, 30.0, 180.0, 450.0, 40.0, 90.0, 80.0, 10.0, 20.0, 80.0, 50.0, 70.0, 40.0, 40.0, 50.0, 80.0, 80.0, 90.0, 40.0, 10.0, 65.0, 20.0, 270.0, 40.0, 15.0, 130.0, 80.0, 90.0, 30.0, 80.0, 110.0, 50.0, 150.0, 5.0, 0.0, 90.0, 0.0, 70.0, 60.0, 30.0, 140.0, 180.0, 100.0, -5.0, 0.0, 30.0, 230.0, 190.0, 10.0, 170.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 40.0, 20.0, 260.0, 290.0, 30.0, 460.0, 50.0, 190.0, 10.0, 40.0, 45.0, 270.0, 80.0, 130.0, 20.0, 340.0, 100.0, 40.0, 50.0, 100.0, 140.0, 300.0, 80.0, 50.0, 40.0, 200.0, 60.0, 230.0, 70.0, 30.0, 70.0, 70.0, 30.0, 160.0, 40.0, 10.0, 110.0, -20.0, 180.0, 130.0, 20.0, 60.0, 40.0, 50.0, 100.0, 50.0, 15.0, 90.0, 170.0, 40.0, 110.0, 50.0, 240.0, 110.0, 60.0, 100.0, 20.0, 30.0, 110.0, 110.0, 200.0, 60.0, 20.0, 180.0, 50.0, 50.0, 70.0, 340.0, 50.0, 80.0, 100.0, 110.0, 60.0, 310.0, 155.0, 400.0, 10.0, 50.0, 70.0, 15.0, 100.0, 90.0, 90.0, 60.0, 30.0, 10.0, 100.0, 40.0, 20.0, 50.0, 40.0, 80.0, 130.0, 70.0, 50.0, 100.0, 10.0, 30.0, 260.0, 210.0, 40.0, 10.0, 200.0, 80.0, -40.0, 40.0, 180.0, 50.0, -30.0, 30.0, 125.0, 270.0, 20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0, 110.0, 80.0, 40.0, 30.0, 130.0, 30.0, 30.0, 310.0, 90.0, 120.0, 120.0, 390.0, -5.0, 70.0, 10.0, 170.0, -45.0, 270.0, 80.0, -20.0, 110.0, 30.0, 30.0, 80.0, 270.0, 40.0, 120.0, 40.0, 50.0, 130.0, 100.0, 100.0, 200.0, 120.0, 50.0, 340.0, 60.0, 80.0, 100.0, 140.0, 20.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 370.0, -45.0, 55.0, 30.0, 20.0, 20.0, 50.0, 80.0, 30.0, -40.0, 180.0, 200.0, 100.0, 200.0, 70.0, 120.0, 170.0, 20.0, 60.0, 110.0, 0.0, 20.0, 30.0, 0.0, 110.0, 20.0, 80.0, 150.0, 20.0, 120.0, 70.0, 40.0, 60.0, 120.0, 50.0, 300.0, 20.0, 15.0, 60.0, 160.0, 70.0, 200.0, 40.0, 10.0, 0.0, 160.0, 40.0, 30.0, 40.0, 60.0, 60.0, 130.0, 40.0, 20.0, 110.0, 180.0, 0.0, 90.0, 40.0, 40.0, 10.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 90.0, 300.0, 160.0, 80.0, 290.0, 50.0, 160.0, 140.0, 130.0, 60.0, 90.0, 20.0, 80.0, 20.0, 100.0, 120.0, 190.0, 50.0, 70.0, 30.0, 0.0, 100.0, 60.0, 80.0, 85.0, 130.0, 230.0, 30.0, 25.0, 170.0, 70.0, 40.0, 170.0, -30.0, 60.0, 210.0, 180.0, 60.0, 70.0, 170.0, 50.0, 120.0, 0.0, 70.0, 280.0, 90.0, 150.0, 310.0, 40.0, 130.0, 0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0, 0.0, 0.0, 20.0, 50.0, 30.0, 40.0, 190.0, 60.0, 70.0, 70.0, 140.0, 30.0, 20.0, 60.0, 90.0, 50.0, 20.0, 20.0, 10.0, 50.0, 210.0, 70.0, 120.0, 135.0, 70.0, 130.0, 140.0, 10.0, 170.0, 260.0, -20.0, 180.0, 10.0, 220.0, 60.0, 330.0, 5.0, 200.0, 80.0, 10.0, 50.0, 210.0, 80.0, 40.0, 90.0, 140.0, 190.0, 40.0, -50.0, 130.0, 55.0, 300.0, 10.0, 190.0, 100.0, 110.0, 400.0, 40.0, 70.0, 145.0, 70.0, -65.0, 60.0, 0.0, 100.0, 480.0, 10.0, 30.0, 230.0, -25.0, 100.0, 70.0, 40.0, 160.0, 30.0, 90.0, 60.0, 150.0, 60.0, 240.0, 80.0, 40.0, 140.0, 40.0, 10.0, 30.0, 20.0, 60.0, 160.0, 80.0, 110.0, 30.0, 120.0, 110.0, 70.0, 100.0, 10.0, 210.0, 10.0, 110.0, 50.0, 150.0, 10.0, 190.0, 90.0, 70.0, 90.0, 30.0, 10.0, 60.0, 290.0, 10.0, 20.0, 80.0, 40.0, 140.0, 40.0, 670.0, 80.0, 110.0, 50.0, 280.0, 70.0, 310.0, 60.0, 280.0, 40.0, 170.0, 50.0, 100.0, 10.0, 20.0, 120.0, 40.0, 0.0, 20.0, 40.0, 80.0, 90.0, 20.0, 70.0, 70.0, 50.0, 290.0, 90.0, 90.0, 120.0, 30.0, 10.0, 70.0, 70.0, 110.0, 290.0, -30.0, 420.0, 100.0, 30.0, 140.0, 20.0, 60.0, 340.0, 100.0, 40.0, 150.0, 80.0, 160.0, 15.0, 90.0, 50.0, 300.0, 170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5506164581455908, "mean_inference_ms": 1.4076512232164986, "mean_action_processing_ms": 0.43305346340118844, "mean_env_wait_ms": 1.259438175790806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01302027702331543, "StateBufferConnector_ms": 0.009850502014160156, "ViewRequirementAgentConnector_ms": 0.38034772872924805}, "num_episodes": 18, "episode_return_max": 1665.0, "episode_return_min": 180.0, "episode_return_mean": 852.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.19021394738496, "num_env_steps_trained_throughput_per_sec": 21.19021394738496, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 187340.833, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187340.785, "sample_time_ms": 2474.442, "learn_time_ms": 184845.849, "learn_throughput": 21.64, "synch_weights_time_ms": 11.609}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "33e63_00000", "date": "2024-06-18_23-59-21", "timestamp": 1718769561, "time_this_iter_s": 188.77213406562805, "time_total_s": 10343.487410783768, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10343.487410783768, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 25.36067415730337, "ram_util_percent": 79.3498127340824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.467410633631281, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.376395877557822, "policy_loss": -0.009224328179660237, "vf_loss": 7.384221312946405, "vf_explained_var": 0.001322101461239897, "kl": 0.0069944849654962294, "entropy": 0.5685033608422365, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 180.0, "episode_reward_mean": 897.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 89.79}, "custom_metrics": {}, "hist_stats": {"episode_reward": [775.0, 560.0, 970.0, 430.0, 1350.0, 770.0, 640.0, 1280.0, 1080.0, 1070.0, 870.0, 485.0, 795.0, 840.0, 440.0, 770.0, 590.0, 780.0, 990.0, 585.0, 750.0, 1025.0, 1220.0, 410.0, 1190.0, 1665.0, 750.0, 370.0, 1070.0, 515.0, 895.0, 725.0, 735.0, 230.0, 1645.0, 1300.0, 900.0, 720.0, 715.0, 1040.0, 1050.0, 1260.0, 520.0, 910.0, 905.0, 240.0, 970.0, 1040.0, 900.0, 1290.0, 220.0, 630.0, 1080.0, 540.0, 855.0, 750.0, 730.0, 180.0, 1460.0, 770.0, 910.0, 1000.0, 1240.0, 1190.0, 530.0, 490.0, 1315.0, 1075.0, 920.0, 1420.0, 890.0, 1000.0, 660.0, 880.0, 750.0, 1480.0, 1410.0, 440.0, 890.0, 1210.0, 1325.0, 1060.0, 1300.0, 780.0, 860.0, 865.0, 1340.0, 1040.0, 855.0, 795.0, 1000.0, 640.0, 565.0, 1090.0, 860.0, 1120.0, 500.0, 1070.0, 1690.0, 1095.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 160.0, 190.0, 40.0, 60.0, 160.0, 10.0, 80.0, 50.0, 25.0, -10.0, 50.0, 20.0, 100.0, 0.0, 260.0, 70.0, 50.0, 10.0, 10.0, 170.0, 140.0, 60.0, 80.0, 90.0, 70.0, 120.0, 90.0, 70.0, 80.0, 90.0, 10.0, 0.0, 30.0, 80.0, 90.0, 40.0, 60.0, 0.0, 30.0, -40.0, 610.0, 190.0, 20.0, 20.0, 120.0, 80.0, 130.0, -50.0, 270.0, 330.0, 50.0, 20.0, 50.0, 60.0, 100.0, 30.0, -20.0, 130.0, 20.0, 20.0, 80.0, 30.0, 20.0, 260.0, 150.0, 10.0, 10.0, 30.0, 30.0, 180.0, 80.0, 150.0, 290.0, 40.0, 20.0, 280.0, 150.0, 50.0, 40.0, -50.0, 100.0, 160.0, 80.0, 310.0, 10.0, 290.0, 20.0, 40.0, 120.0, 120.0, 290.0, 60.0, 210.0, 80.0, 70.0, 110.0, 100.0, -130.0, 160.0, 50.0, 30.0, 300.0, 80.0, 40.0, 30.0, 20.0, 60.0, 110.0, 150.0, 60.0, 20.0, 10.0, 20.0, 60.0, 25.0, 160.0, -10.0, 20.0, 120.0, 20.0, 50.0, 160.0, 190.0, 60.0, 30.0, 160.0, 0.0, 25.0, 100.0, 100.0, 0.0, 80.0, 50.0, 160.0, 190.0, 40.0, 10.0, 20.0, 190.0, -40.0, 140.0, -40.0, 90.0, 0.0, 160.0, 40.0, 30.0, 20.0, 40.0, 40.0, 160.0, 70.0, 160.0, 70.0, 30.0, 30.0, 130.0, 10.0, 70.0, 0.0, 100.0, 30.0, 170.0, 20.0, 80.0, 40.0, 40.0, 70.0, 40.0, 160.0, 50.0, 10.0, 90.0, 120.0, -40.0, -20.0, 280.0, 20.0, 110.0, 70.0, 50.0, 60.0, 60.0, 30.0, 40.0, 220.0, 80.0, 280.0, 100.0, 50.0, 160.0, 20.0, 95.0, 0.0, 0.0, 40.0, 40.0, 10.0, 170.0, 40.0, 120.0, 110.0, 0.0, 60.0, 70.0, 30.0, 40.0, 200.0, 80.0, 100.0, 35.0, 250.0, 220.0, 200.0, -45.0, 10.0, 250.0, 30.0, -25.0, 440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0, 60.0, 80.0, 70.0, 0.0, 70.0, 40.0, 30.0, 0.0, 50.0, 10.0, 140.0, 40.0, 10.0, 10.0, 120.0, 300.0, 20.0, 170.0, 130.0, 250.0, -45.0, 30.0, 160.0, 140.0, 190.0, 120.0, 650.0, 10.0, 120.0, 290.0, 10.0, 150.0, 40.0, 320.0, 40.0, 30.0, 90.0, 0.0, 20.0, 50.0, 100.0, 40.0, 90.0, 0.0, 40.0, 0.0, 0.0, 40.0, 30.0, 30.0, 180.0, 450.0, 40.0, 90.0, 80.0, 10.0, 20.0, 80.0, 50.0, 70.0, 40.0, 40.0, 50.0, 80.0, 80.0, 90.0, 40.0, 10.0, 65.0, 20.0, 270.0, 40.0, 15.0, 130.0, 80.0, 90.0, 30.0, 80.0, 110.0, 50.0, 150.0, 5.0, 0.0, 90.0, 0.0, 70.0, 60.0, 30.0, 140.0, 180.0, 100.0, -5.0, 0.0, 30.0, 230.0, 190.0, 10.0, 170.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 40.0, 20.0, 260.0, 290.0, 30.0, 460.0, 50.0, 190.0, 10.0, 40.0, 45.0, 270.0, 80.0, 130.0, 20.0, 340.0, 100.0, 40.0, 50.0, 100.0, 140.0, 300.0, 80.0, 50.0, 40.0, 200.0, 60.0, 230.0, 70.0, 30.0, 70.0, 70.0, 30.0, 160.0, 40.0, 10.0, 110.0, -20.0, 180.0, 130.0, 20.0, 60.0, 40.0, 50.0, 100.0, 50.0, 15.0, 90.0, 170.0, 40.0, 110.0, 50.0, 240.0, 110.0, 60.0, 100.0, 20.0, 30.0, 110.0, 110.0, 200.0, 60.0, 20.0, 180.0, 50.0, 50.0, 70.0, 340.0, 50.0, 80.0, 100.0, 110.0, 60.0, 310.0, 155.0, 400.0, 10.0, 50.0, 70.0, 15.0, 100.0, 90.0, 90.0, 60.0, 30.0, 10.0, 100.0, 40.0, 20.0, 50.0, 40.0, 80.0, 130.0, 70.0, 50.0, 100.0, 10.0, 30.0, 260.0, 210.0, 40.0, 10.0, 200.0, 80.0, -40.0, 40.0, 180.0, 50.0, -30.0, 30.0, 125.0, 270.0, 20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0, 110.0, 80.0, 40.0, 30.0, 130.0, 30.0, 30.0, 310.0, 90.0, 120.0, 120.0, 390.0, -5.0, 70.0, 10.0, 170.0, -45.0, 270.0, 80.0, -20.0, 110.0, 30.0, 30.0, 80.0, 270.0, 40.0, 120.0, 40.0, 50.0, 130.0, 100.0, 100.0, 200.0, 120.0, 50.0, 340.0, 60.0, 80.0, 100.0, 140.0, 20.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 370.0, -45.0, 55.0, 30.0, 20.0, 20.0, 50.0, 80.0, 30.0, -40.0, 180.0, 200.0, 100.0, 200.0, 70.0, 120.0, 170.0, 20.0, 60.0, 110.0, 0.0, 20.0, 30.0, 0.0, 110.0, 20.0, 80.0, 150.0, 20.0, 120.0, 70.0, 40.0, 60.0, 120.0, 50.0, 300.0, 20.0, 15.0, 60.0, 160.0, 70.0, 200.0, 40.0, 10.0, 0.0, 160.0, 40.0, 30.0, 40.0, 60.0, 60.0, 130.0, 40.0, 20.0, 110.0, 180.0, 0.0, 90.0, 40.0, 40.0, 10.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 90.0, 300.0, 160.0, 80.0, 290.0, 50.0, 160.0, 140.0, 130.0, 60.0, 90.0, 20.0, 80.0, 20.0, 100.0, 120.0, 190.0, 50.0, 70.0, 30.0, 0.0, 100.0, 60.0, 80.0, 85.0, 130.0, 230.0, 30.0, 25.0, 170.0, 70.0, 40.0, 170.0, -30.0, 60.0, 210.0, 180.0, 60.0, 70.0, 170.0, 50.0, 120.0, 0.0, 70.0, 280.0, 90.0, 150.0, 310.0, 40.0, 130.0, 0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0, 0.0, 0.0, 20.0, 50.0, 30.0, 40.0, 190.0, 60.0, 70.0, 70.0, 140.0, 30.0, 20.0, 60.0, 90.0, 50.0, 20.0, 20.0, 10.0, 50.0, 210.0, 70.0, 120.0, 135.0, 70.0, 130.0, 140.0, 10.0, 170.0, 260.0, -20.0, 180.0, 10.0, 220.0, 60.0, 330.0, 5.0, 200.0, 80.0, 10.0, 50.0, 210.0, 80.0, 40.0, 90.0, 140.0, 190.0, 40.0, -50.0, 130.0, 55.0, 300.0, 10.0, 190.0, 100.0, 110.0, 400.0, 40.0, 70.0, 145.0, 70.0, -65.0, 60.0, 0.0, 100.0, 480.0, 10.0, 30.0, 230.0, -25.0, 100.0, 70.0, 40.0, 160.0, 30.0, 90.0, 60.0, 150.0, 60.0, 240.0, 80.0, 40.0, 140.0, 40.0, 10.0, 30.0, 20.0, 60.0, 160.0, 80.0, 110.0, 30.0, 120.0, 110.0, 70.0, 100.0, 10.0, 210.0, 10.0, 110.0, 50.0, 150.0, 10.0, 190.0, 90.0, 70.0, 90.0, 30.0, 10.0, 60.0, 290.0, 10.0, 20.0, 80.0, 40.0, 140.0, 40.0, 670.0, 80.0, 110.0, 50.0, 280.0, 70.0, 310.0, 60.0, 280.0, 40.0, 170.0, 50.0, 100.0, 10.0, 20.0, 120.0, 40.0, 0.0, 20.0, 40.0, 80.0, 90.0, 20.0, 70.0, 70.0, 50.0, 290.0, 90.0, 90.0, 120.0, 30.0, 10.0, 70.0, 70.0, 110.0, 290.0, -30.0, 420.0, 100.0, 30.0, 140.0, 20.0, 60.0, 340.0, 100.0, 40.0, 150.0, 80.0, 160.0, 15.0, 90.0, 50.0, 300.0, 170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0, 120.0, 60.0, 160.0, 70.0, 40.0, 130.0, 80.0, 200.0, 210.0, 230.0, 35.0, 10.0, 10.0, 320.0, 100.0, -20.0, 190.0, 30.0, -5.0, 110.0, 10.0, 40.0, 50.0, 40.0, 160.0, 140.0, 40.0, 290.0, 60.0, 30.0, 30.0, 120.0, 45.0, 70.0, 50.0, 20.0, 20.0, 280.0, 50.0, 180.0, 290.0, 50.0, 110.0, 70.0, 270.0, 270.0, 130.0, 90.0, 40.0, 20.0, 10.0, 20.0, 90.0, 140.0, 310.0, 20.0, 140.0, 130.0, 100.0, 80.0, 20.0, 90.0, 0.0, 60.0, 75.0, 230.0, 190.0, 70.0, 0.0, 120.0, 0.0, 50.0, 30.0, 160.0, 410.0, 30.0, 20.0, 40.0, 15.0, 40.0, 40.0, 190.0, 70.0, 50.0, 80.0, 90.0, 150.0, 170.0, 80.0, 80.0, 90.0, 110.0, 170.0, 100.0, 50.0, 40.0, 50.0, 20.0, -30.0, 40.0, -20.0, 210.0, 10.0, 110.0, 20.0, 30.0, 0.0, 70.0, 70.0, 65.0, 80.0, 80.0, 120.0, 150.0, 20.0, 180.0, 30.0, 10.0, 170.0, 250.0, 40.0, 20.0, 170.0, 40.0, 0.0, 40.0, 290.0, 20.0, 40.0, 200.0, 65.0, 240.0, 45.0, 0.0, 40.0, 320.0, 160.0, 30.0, 140.0, 80.0, 20.0, 150.0, 60.0, -30.0, 40.0, 30.0, 110.0, 40.0, 60.0, 20.0, 20.0, 50.0, 170.0, 40.0, 40.0, 40.0, 330.0, 180.0, -50.0, 250.0, 70.0, 380.0, 380.0, 30.0, 220.0, 190.0, 120.0, 140.0, 60.0, 100.0, 210.0, 60.0, 110.0, 60.0, 270.0, 30.0, 40.0, 90.0, 15.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5501297474164146, "mean_inference_ms": 1.4075993709304657, "mean_action_processing_ms": 0.43225240167724815, "mean_env_wait_ms": 1.2590202038047205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012659311294555664, "StateBufferConnector_ms": 0.009713172912597656, "ViewRequirementAgentConnector_ms": 0.37050938606262207}, "num_episodes": 18, "episode_return_max": 1690.0, "episode_return_min": 180.0, "episode_return_mean": 897.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.876449510084615, "num_env_steps_trained_throughput_per_sec": 20.876449510084615, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 187726.1, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187726.052, "sample_time_ms": 2508.972, "learn_time_ms": 185196.93, "learn_throughput": 21.599, "synch_weights_time_ms": 11.256}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "33e63_00000", "date": "2024-06-19_00-02-32", "timestamp": 1718769752, "time_this_iter_s": 191.615571975708, "time_total_s": 10535.102982759476, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276df0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10535.102982759476, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 26.661481481481484, "ram_util_percent": 79.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.517918265138825, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.558008769221199, "policy_loss": -0.009929594742749143, "vf_loss": 7.566565856080467, "vf_explained_var": 0.0013173573695051785, "kl": 0.006862546330803558, "entropy": 0.525140767553236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 180.0, "episode_reward_mean": 952.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 95.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1220.0, 410.0, 1190.0, 1665.0, 750.0, 370.0, 1070.0, 515.0, 895.0, 725.0, 735.0, 230.0, 1645.0, 1300.0, 900.0, 720.0, 715.0, 1040.0, 1050.0, 1260.0, 520.0, 910.0, 905.0, 240.0, 970.0, 1040.0, 900.0, 1290.0, 220.0, 630.0, 1080.0, 540.0, 855.0, 750.0, 730.0, 180.0, 1460.0, 770.0, 910.0, 1000.0, 1240.0, 1190.0, 530.0, 490.0, 1315.0, 1075.0, 920.0, 1420.0, 890.0, 1000.0, 660.0, 880.0, 750.0, 1480.0, 1410.0, 440.0, 890.0, 1210.0, 1325.0, 1060.0, 1300.0, 780.0, 860.0, 865.0, 1340.0, 1040.0, 855.0, 795.0, 1000.0, 640.0, 565.0, 1090.0, 860.0, 1120.0, 500.0, 1070.0, 1690.0, 1095.0, 1350.0, 1050.0, 1450.0, 525.0, 735.0, 1680.0, 1030.0, 1400.0, 1110.0, 1200.0, 800.0, 915.0, 1680.0, 980.0, 365.0, 1490.0, 1575.0, 1155.0, 940.0, 645.0, 435.0, 780.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [440.0, 80.0, 0.0, 10.0, 120.0, 330.0, 140.0, 30.0, 30.0, 40.0, 60.0, 80.0, 70.0, 0.0, 70.0, 40.0, 30.0, 0.0, 50.0, 10.0, 140.0, 40.0, 10.0, 10.0, 120.0, 300.0, 20.0, 170.0, 130.0, 250.0, -45.0, 30.0, 160.0, 140.0, 190.0, 120.0, 650.0, 10.0, 120.0, 290.0, 10.0, 150.0, 40.0, 320.0, 40.0, 30.0, 90.0, 0.0, 20.0, 50.0, 100.0, 40.0, 90.0, 0.0, 40.0, 0.0, 0.0, 40.0, 30.0, 30.0, 180.0, 450.0, 40.0, 90.0, 80.0, 10.0, 20.0, 80.0, 50.0, 70.0, 40.0, 40.0, 50.0, 80.0, 80.0, 90.0, 40.0, 10.0, 65.0, 20.0, 270.0, 40.0, 15.0, 130.0, 80.0, 90.0, 30.0, 80.0, 110.0, 50.0, 150.0, 5.0, 0.0, 90.0, 0.0, 70.0, 60.0, 30.0, 140.0, 180.0, 100.0, -5.0, 0.0, 30.0, 230.0, 190.0, 10.0, 170.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 10.0, 10.0, 50.0, 40.0, 20.0, 260.0, 290.0, 30.0, 460.0, 50.0, 190.0, 10.0, 40.0, 45.0, 270.0, 80.0, 130.0, 20.0, 340.0, 100.0, 40.0, 50.0, 100.0, 140.0, 300.0, 80.0, 50.0, 40.0, 200.0, 60.0, 230.0, 70.0, 30.0, 70.0, 70.0, 30.0, 160.0, 40.0, 10.0, 110.0, -20.0, 180.0, 130.0, 20.0, 60.0, 40.0, 50.0, 100.0, 50.0, 15.0, 90.0, 170.0, 40.0, 110.0, 50.0, 240.0, 110.0, 60.0, 100.0, 20.0, 30.0, 110.0, 110.0, 200.0, 60.0, 20.0, 180.0, 50.0, 50.0, 70.0, 340.0, 50.0, 80.0, 100.0, 110.0, 60.0, 310.0, 155.0, 400.0, 10.0, 50.0, 70.0, 15.0, 100.0, 90.0, 90.0, 60.0, 30.0, 10.0, 100.0, 40.0, 20.0, 50.0, 40.0, 80.0, 130.0, 70.0, 50.0, 100.0, 10.0, 30.0, 260.0, 210.0, 40.0, 10.0, 200.0, 80.0, -40.0, 40.0, 180.0, 50.0, -30.0, 30.0, 125.0, 270.0, 20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0, 110.0, 80.0, 40.0, 30.0, 130.0, 30.0, 30.0, 310.0, 90.0, 120.0, 120.0, 390.0, -5.0, 70.0, 10.0, 170.0, -45.0, 270.0, 80.0, -20.0, 110.0, 30.0, 30.0, 80.0, 270.0, 40.0, 120.0, 40.0, 50.0, 130.0, 100.0, 100.0, 200.0, 120.0, 50.0, 340.0, 60.0, 80.0, 100.0, 140.0, 20.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 370.0, -45.0, 55.0, 30.0, 20.0, 20.0, 50.0, 80.0, 30.0, -40.0, 180.0, 200.0, 100.0, 200.0, 70.0, 120.0, 170.0, 20.0, 60.0, 110.0, 0.0, 20.0, 30.0, 0.0, 110.0, 20.0, 80.0, 150.0, 20.0, 120.0, 70.0, 40.0, 60.0, 120.0, 50.0, 300.0, 20.0, 15.0, 60.0, 160.0, 70.0, 200.0, 40.0, 10.0, 0.0, 160.0, 40.0, 30.0, 40.0, 60.0, 60.0, 130.0, 40.0, 20.0, 110.0, 180.0, 0.0, 90.0, 40.0, 40.0, 10.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 90.0, 300.0, 160.0, 80.0, 290.0, 50.0, 160.0, 140.0, 130.0, 60.0, 90.0, 20.0, 80.0, 20.0, 100.0, 120.0, 190.0, 50.0, 70.0, 30.0, 0.0, 100.0, 60.0, 80.0, 85.0, 130.0, 230.0, 30.0, 25.0, 170.0, 70.0, 40.0, 170.0, -30.0, 60.0, 210.0, 180.0, 60.0, 70.0, 170.0, 50.0, 120.0, 0.0, 70.0, 280.0, 90.0, 150.0, 310.0, 40.0, 130.0, 0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0, 0.0, 0.0, 20.0, 50.0, 30.0, 40.0, 190.0, 60.0, 70.0, 70.0, 140.0, 30.0, 20.0, 60.0, 90.0, 50.0, 20.0, 20.0, 10.0, 50.0, 210.0, 70.0, 120.0, 135.0, 70.0, 130.0, 140.0, 10.0, 170.0, 260.0, -20.0, 180.0, 10.0, 220.0, 60.0, 330.0, 5.0, 200.0, 80.0, 10.0, 50.0, 210.0, 80.0, 40.0, 90.0, 140.0, 190.0, 40.0, -50.0, 130.0, 55.0, 300.0, 10.0, 190.0, 100.0, 110.0, 400.0, 40.0, 70.0, 145.0, 70.0, -65.0, 60.0, 0.0, 100.0, 480.0, 10.0, 30.0, 230.0, -25.0, 100.0, 70.0, 40.0, 160.0, 30.0, 90.0, 60.0, 150.0, 60.0, 240.0, 80.0, 40.0, 140.0, 40.0, 10.0, 30.0, 20.0, 60.0, 160.0, 80.0, 110.0, 30.0, 120.0, 110.0, 70.0, 100.0, 10.0, 210.0, 10.0, 110.0, 50.0, 150.0, 10.0, 190.0, 90.0, 70.0, 90.0, 30.0, 10.0, 60.0, 290.0, 10.0, 20.0, 80.0, 40.0, 140.0, 40.0, 670.0, 80.0, 110.0, 50.0, 280.0, 70.0, 310.0, 60.0, 280.0, 40.0, 170.0, 50.0, 100.0, 10.0, 20.0, 120.0, 40.0, 0.0, 20.0, 40.0, 80.0, 90.0, 20.0, 70.0, 70.0, 50.0, 290.0, 90.0, 90.0, 120.0, 30.0, 10.0, 70.0, 70.0, 110.0, 290.0, -30.0, 420.0, 100.0, 30.0, 140.0, 20.0, 60.0, 340.0, 100.0, 40.0, 150.0, 80.0, 160.0, 15.0, 90.0, 50.0, 300.0, 170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0, 120.0, 60.0, 160.0, 70.0, 40.0, 130.0, 80.0, 200.0, 210.0, 230.0, 35.0, 10.0, 10.0, 320.0, 100.0, -20.0, 190.0, 30.0, -5.0, 110.0, 10.0, 40.0, 50.0, 40.0, 160.0, 140.0, 40.0, 290.0, 60.0, 30.0, 30.0, 120.0, 45.0, 70.0, 50.0, 20.0, 20.0, 280.0, 50.0, 180.0, 290.0, 50.0, 110.0, 70.0, 270.0, 270.0, 130.0, 90.0, 40.0, 20.0, 10.0, 20.0, 90.0, 140.0, 310.0, 20.0, 140.0, 130.0, 100.0, 80.0, 20.0, 90.0, 0.0, 60.0, 75.0, 230.0, 190.0, 70.0, 0.0, 120.0, 0.0, 50.0, 30.0, 160.0, 410.0, 30.0, 20.0, 40.0, 15.0, 40.0, 40.0, 190.0, 70.0, 50.0, 80.0, 90.0, 150.0, 170.0, 80.0, 80.0, 90.0, 110.0, 170.0, 100.0, 50.0, 40.0, 50.0, 20.0, -30.0, 40.0, -20.0, 210.0, 10.0, 110.0, 20.0, 30.0, 0.0, 70.0, 70.0, 65.0, 80.0, 80.0, 120.0, 150.0, 20.0, 180.0, 30.0, 10.0, 170.0, 250.0, 40.0, 20.0, 170.0, 40.0, 0.0, 40.0, 290.0, 20.0, 40.0, 200.0, 65.0, 240.0, 45.0, 0.0, 40.0, 320.0, 160.0, 30.0, 140.0, 80.0, 20.0, 150.0, 60.0, -30.0, 40.0, 30.0, 110.0, 40.0, 60.0, 20.0, 20.0, 50.0, 170.0, 40.0, 40.0, 40.0, 330.0, 180.0, -50.0, 250.0, 70.0, 380.0, 380.0, 30.0, 220.0, 190.0, 120.0, 140.0, 60.0, 100.0, 210.0, 60.0, 110.0, 60.0, 270.0, 30.0, 40.0, 90.0, 15.0, 210.0, 130.0, 200.0, 430.0, 40.0, 280.0, 170.0, 10.0, -30.0, 60.0, 60.0, 370.0, 60.0, 290.0, 120.0, 90.0, 20.0, 130.0, 0.0, 10.0, -40.0, 250.0, 110.0, 120.0, 230.0, 400.0, 20.0, 100.0, 130.0, 70.0, 20.0, 40.0, 30.0, 30.0, 30.0, 190.0, 40.0, 30.0, 20.0, 60.0, 55.0, 80.0, 20.0, 200.0, 50.0, 40.0, 10.0, 10.0, 70.0, 220.0, 35.0, 130.0, 550.0, 110.0, 100.0, 330.0, 200.0, 40.0, 30.0, 120.0, 70.0, 10.0, 120.0, 50.0, 50.0, 130.0, 10.0, 560.0, 20.0, 10.0, 70.0, 140.0, 250.0, 200.0, 30.0, 20.0, 20.0, 200.0, 80.0, 330.0, 130.0, 40.0, 90.0, -10.0, 100.0, 290.0, 90.0, 280.0, 60.0, 100.0, 70.0, 110.0, 60.0, 50.0, 70.0, 210.0, 120.0, 70.0, 190.0, 70.0, 250.0, -125.0, 50.0, 110.0, 190.0, -10.0, 70.0, 380.0, -135.0, 160.0, 110.0, 80.0, 160.0, 90.0, 10.0, 150.0, 140.0, 70.0, 80.0, 70.0, 65.0, 150.0, 110.0, 90.0, 310.0, 35.0, 310.0, 35.0, 70.0, 480.0, 90.0, 0.0, 160.0, 110.0, 210.0, 30.0, 10.0, 40.0, 410.0, -40.0, 50.0, 20.0, 30.0, -15.0, 15.0, -15.0, 30.0, 95.0, -25.0, 200.0, 30.0, 280.0, 100.0, 80.0, 200.0, 30.0, 40.0, 200.0, 80.0, 310.0, 170.0, 10.0, 500.0, 60.0, 120.0, 500.0, 40.0, 65.0, 190.0, 20.0, 70.0, 440.0, 100.0, 40.0, 60.0, 80.0, 10.0, 150.0, 90.0, 155.0, 30.0, 110.0, 60.0, 190.0, -130.0, 200.0, 150.0, 160.0, 40.0, 50.0, 110.0, 0.0, 25.0, 15.0, 30.0, 20.0, 30.0, 55.0, 220.0, 90.0, 160.0, 10.0, 55.0, 20.0, 50.0, 110.0, 30.0, 30.0, 100.0, 20.0, 10.0, 90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5492403965940225, "mean_inference_ms": 1.407826055128881, "mean_action_processing_ms": 0.43948220952487493, "mean_env_wait_ms": 1.2586417465121678, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01266932487487793, "StateBufferConnector_ms": 0.009840011596679688, "ViewRequirementAgentConnector_ms": 0.37136220932006836}, "num_episodes": 22, "episode_return_max": 1690.0, "episode_return_min": 180.0, "episode_return_mean": 952.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.804257411159327, "num_env_steps_trained_throughput_per_sec": 20.804257411159327, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 188344.784, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188344.736, "sample_time_ms": 2648.035, "learn_time_ms": 185676.286, "learn_throughput": 21.543, "synch_weights_time_ms": 11.493}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "33e63_00000", "date": "2024-06-19_00-05-44", "timestamp": 1718769944, "time_this_iter_s": 192.2812421321869, "time_total_s": 10727.384224891663, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276f5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10727.384224891663, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 25.379411764705882, "ram_util_percent": 81.29375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.731097291103694, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.805496743489632, "policy_loss": -0.009671204346537102, "vf_loss": 6.813873304878942, "vf_explained_var": 0.0006933364814843613, "kl": 0.006473248665807983, "entropy": 0.5677359392372564, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 180.0, "episode_reward_mean": 942.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 94.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 970.0, 1040.0, 900.0, 1290.0, 220.0, 630.0, 1080.0, 540.0, 855.0, 750.0, 730.0, 180.0, 1460.0, 770.0, 910.0, 1000.0, 1240.0, 1190.0, 530.0, 490.0, 1315.0, 1075.0, 920.0, 1420.0, 890.0, 1000.0, 660.0, 880.0, 750.0, 1480.0, 1410.0, 440.0, 890.0, 1210.0, 1325.0, 1060.0, 1300.0, 780.0, 860.0, 865.0, 1340.0, 1040.0, 855.0, 795.0, 1000.0, 640.0, 565.0, 1090.0, 860.0, 1120.0, 500.0, 1070.0, 1690.0, 1095.0, 1350.0, 1050.0, 1450.0, 525.0, 735.0, 1680.0, 1030.0, 1400.0, 1110.0, 1200.0, 800.0, 915.0, 1680.0, 980.0, 365.0, 1490.0, 1575.0, 1155.0, 940.0, 645.0, 435.0, 780.0, 1230.0, 980.0, 730.0, 350.0, 1110.0, 530.0, 490.0, 715.0, 1105.0, 910.0, 1255.0, 960.0, 670.0, 650.0, 520.0, 675.0, 300.0, 510.0, 1180.0, 935.0, 990.0, 1565.0, 1405.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 30.0, 20.0, 20.0, 70.0, 10.0, 10.0, 20.0, 110.0, 80.0, 40.0, 30.0, 130.0, 30.0, 30.0, 310.0, 90.0, 120.0, 120.0, 390.0, -5.0, 70.0, 10.0, 170.0, -45.0, 270.0, 80.0, -20.0, 110.0, 30.0, 30.0, 80.0, 270.0, 40.0, 120.0, 40.0, 50.0, 130.0, 100.0, 100.0, 200.0, 120.0, 50.0, 340.0, 60.0, 80.0, 100.0, 140.0, 20.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 20.0, 20.0, 10.0, 20.0, 370.0, -45.0, 55.0, 30.0, 20.0, 20.0, 50.0, 80.0, 30.0, -40.0, 180.0, 200.0, 100.0, 200.0, 70.0, 120.0, 170.0, 20.0, 60.0, 110.0, 0.0, 20.0, 30.0, 0.0, 110.0, 20.0, 80.0, 150.0, 20.0, 120.0, 70.0, 40.0, 60.0, 120.0, 50.0, 300.0, 20.0, 15.0, 60.0, 160.0, 70.0, 200.0, 40.0, 10.0, 0.0, 160.0, 40.0, 30.0, 40.0, 60.0, 60.0, 130.0, 40.0, 20.0, 110.0, 180.0, 0.0, 90.0, 40.0, 40.0, 10.0, 30.0, 30.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 90.0, 300.0, 160.0, 80.0, 290.0, 50.0, 160.0, 140.0, 130.0, 60.0, 90.0, 20.0, 80.0, 20.0, 100.0, 120.0, 190.0, 50.0, 70.0, 30.0, 0.0, 100.0, 60.0, 80.0, 85.0, 130.0, 230.0, 30.0, 25.0, 170.0, 70.0, 40.0, 170.0, -30.0, 60.0, 210.0, 180.0, 60.0, 70.0, 170.0, 50.0, 120.0, 0.0, 70.0, 280.0, 90.0, 150.0, 310.0, 40.0, 130.0, 0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0, 0.0, 0.0, 20.0, 50.0, 30.0, 40.0, 190.0, 60.0, 70.0, 70.0, 140.0, 30.0, 20.0, 60.0, 90.0, 50.0, 20.0, 20.0, 10.0, 50.0, 210.0, 70.0, 120.0, 135.0, 70.0, 130.0, 140.0, 10.0, 170.0, 260.0, -20.0, 180.0, 10.0, 220.0, 60.0, 330.0, 5.0, 200.0, 80.0, 10.0, 50.0, 210.0, 80.0, 40.0, 90.0, 140.0, 190.0, 40.0, -50.0, 130.0, 55.0, 300.0, 10.0, 190.0, 100.0, 110.0, 400.0, 40.0, 70.0, 145.0, 70.0, -65.0, 60.0, 0.0, 100.0, 480.0, 10.0, 30.0, 230.0, -25.0, 100.0, 70.0, 40.0, 160.0, 30.0, 90.0, 60.0, 150.0, 60.0, 240.0, 80.0, 40.0, 140.0, 40.0, 10.0, 30.0, 20.0, 60.0, 160.0, 80.0, 110.0, 30.0, 120.0, 110.0, 70.0, 100.0, 10.0, 210.0, 10.0, 110.0, 50.0, 150.0, 10.0, 190.0, 90.0, 70.0, 90.0, 30.0, 10.0, 60.0, 290.0, 10.0, 20.0, 80.0, 40.0, 140.0, 40.0, 670.0, 80.0, 110.0, 50.0, 280.0, 70.0, 310.0, 60.0, 280.0, 40.0, 170.0, 50.0, 100.0, 10.0, 20.0, 120.0, 40.0, 0.0, 20.0, 40.0, 80.0, 90.0, 20.0, 70.0, 70.0, 50.0, 290.0, 90.0, 90.0, 120.0, 30.0, 10.0, 70.0, 70.0, 110.0, 290.0, -30.0, 420.0, 100.0, 30.0, 140.0, 20.0, 60.0, 340.0, 100.0, 40.0, 150.0, 80.0, 160.0, 15.0, 90.0, 50.0, 300.0, 170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0, 120.0, 60.0, 160.0, 70.0, 40.0, 130.0, 80.0, 200.0, 210.0, 230.0, 35.0, 10.0, 10.0, 320.0, 100.0, -20.0, 190.0, 30.0, -5.0, 110.0, 10.0, 40.0, 50.0, 40.0, 160.0, 140.0, 40.0, 290.0, 60.0, 30.0, 30.0, 120.0, 45.0, 70.0, 50.0, 20.0, 20.0, 280.0, 50.0, 180.0, 290.0, 50.0, 110.0, 70.0, 270.0, 270.0, 130.0, 90.0, 40.0, 20.0, 10.0, 20.0, 90.0, 140.0, 310.0, 20.0, 140.0, 130.0, 100.0, 80.0, 20.0, 90.0, 0.0, 60.0, 75.0, 230.0, 190.0, 70.0, 0.0, 120.0, 0.0, 50.0, 30.0, 160.0, 410.0, 30.0, 20.0, 40.0, 15.0, 40.0, 40.0, 190.0, 70.0, 50.0, 80.0, 90.0, 150.0, 170.0, 80.0, 80.0, 90.0, 110.0, 170.0, 100.0, 50.0, 40.0, 50.0, 20.0, -30.0, 40.0, -20.0, 210.0, 10.0, 110.0, 20.0, 30.0, 0.0, 70.0, 70.0, 65.0, 80.0, 80.0, 120.0, 150.0, 20.0, 180.0, 30.0, 10.0, 170.0, 250.0, 40.0, 20.0, 170.0, 40.0, 0.0, 40.0, 290.0, 20.0, 40.0, 200.0, 65.0, 240.0, 45.0, 0.0, 40.0, 320.0, 160.0, 30.0, 140.0, 80.0, 20.0, 150.0, 60.0, -30.0, 40.0, 30.0, 110.0, 40.0, 60.0, 20.0, 20.0, 50.0, 170.0, 40.0, 40.0, 40.0, 330.0, 180.0, -50.0, 250.0, 70.0, 380.0, 380.0, 30.0, 220.0, 190.0, 120.0, 140.0, 60.0, 100.0, 210.0, 60.0, 110.0, 60.0, 270.0, 30.0, 40.0, 90.0, 15.0, 210.0, 130.0, 200.0, 430.0, 40.0, 280.0, 170.0, 10.0, -30.0, 60.0, 60.0, 370.0, 60.0, 290.0, 120.0, 90.0, 20.0, 130.0, 0.0, 10.0, -40.0, 250.0, 110.0, 120.0, 230.0, 400.0, 20.0, 100.0, 130.0, 70.0, 20.0, 40.0, 30.0, 30.0, 30.0, 190.0, 40.0, 30.0, 20.0, 60.0, 55.0, 80.0, 20.0, 200.0, 50.0, 40.0, 10.0, 10.0, 70.0, 220.0, 35.0, 130.0, 550.0, 110.0, 100.0, 330.0, 200.0, 40.0, 30.0, 120.0, 70.0, 10.0, 120.0, 50.0, 50.0, 130.0, 10.0, 560.0, 20.0, 10.0, 70.0, 140.0, 250.0, 200.0, 30.0, 20.0, 20.0, 200.0, 80.0, 330.0, 130.0, 40.0, 90.0, -10.0, 100.0, 290.0, 90.0, 280.0, 60.0, 100.0, 70.0, 110.0, 60.0, 50.0, 70.0, 210.0, 120.0, 70.0, 190.0, 70.0, 250.0, -125.0, 50.0, 110.0, 190.0, -10.0, 70.0, 380.0, -135.0, 160.0, 110.0, 80.0, 160.0, 90.0, 10.0, 150.0, 140.0, 70.0, 80.0, 70.0, 65.0, 150.0, 110.0, 90.0, 310.0, 35.0, 310.0, 35.0, 70.0, 480.0, 90.0, 0.0, 160.0, 110.0, 210.0, 30.0, 10.0, 40.0, 410.0, -40.0, 50.0, 20.0, 30.0, -15.0, 15.0, -15.0, 30.0, 95.0, -25.0, 200.0, 30.0, 280.0, 100.0, 80.0, 200.0, 30.0, 40.0, 200.0, 80.0, 310.0, 170.0, 10.0, 500.0, 60.0, 120.0, 500.0, 40.0, 65.0, 190.0, 20.0, 70.0, 440.0, 100.0, 40.0, 60.0, 80.0, 10.0, 150.0, 90.0, 155.0, 30.0, 110.0, 60.0, 190.0, -130.0, 200.0, 150.0, 160.0, 40.0, 50.0, 110.0, 0.0, 25.0, 15.0, 30.0, 20.0, 30.0, 55.0, 220.0, 90.0, 160.0, 10.0, 55.0, 20.0, 50.0, 110.0, 30.0, 30.0, 100.0, 20.0, 10.0, 90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0, 90.0, 130.0, 120.0, 100.0, 130.0, -20.0, 320.0, 90.0, 170.0, 100.0, 35.0, 60.0, 35.0, 30.0, 60.0, 30.0, 10.0, 40.0, 100.0, 580.0, 50.0, 20.0, 60.0, 20.0, 160.0, 80.0, 50.0, 0.0, 90.0, 200.0, 160.0, 30.0, 60.0, 30.0, 20.0, 60.0, -5.0, -95.0, 60.0, 30.0, 10.0, 150.0, 50.0, 240.0, 50.0, 90.0, 510.0, 40.0, -40.0, 10.0, 20.0, 10.0, 160.0, 80.0, 20.0, 150.0, 10.0, 15.0, 25.0, 40.0, 0.0, 60.0, 10.0, 60.0, 0.0, 60.0, 80.0, 150.0, 30.0, 40.0, 95.0, 40.0, 10.0, 30.0, 80.0, 10.0, 50.0, 350.0, 30.0, 20.0, 80.0, 10.0, 110.0, 110.0, 330.0, 75.0, 40.0, 70.0, 80.0, 200.0, 70.0, 60.0, 50.0, 60.0, 80.0, 150.0, 40.0, 390.0, 0.0, 10.0, 180.0, 155.0, 310.0, 90.0, 110.0, 50.0, 20.0, 170.0, 120.0, 50.0, 150.0, 20.0, 40.0, -20.0, 330.0, 180.0, 60.0, 40.0, 60.0, 100.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 40.0, 320.0, 70.0, 160.0, 10.0, 50.0, 20.0, -20.0, 60.0, 20.0, 260.0, 100.0, 80.0, 70.0, 50.0, 0.0, 40.0, 370.0, 20.0, 30.0, -10.0, 10.0, 10.0, 0.0, 75.0, 30.0, 45.0, 150.0, 80.0, 35.0, 100.0, 40.0, 90.0, 30.0, 10.0, 10.0, 50.0, 30.0, 50.0, 30.0, 30.0, 10.0, 10.0, 70.0, 30.0, 30.0, 20.0, 0.0, 200.0, 0.0, 60.0, 40.0, 90.0, 40.0, 170.0, -40.0, 250.0, 100.0, 70.0, 100.0, 120.0, 80.0, 170.0, 160.0, 110.0, 270.0, 80.0, 130.0, 10.0, 5.0, 70.0, 20.0, 150.0, 90.0, 160.0, 110.0, 100.0, 20.0, 140.0, 100.0, 30.0, 30.0, 70.0, 230.0, 35.0, 180.0, 130.0, 150.0, 350.0, 210.0, 50.0, 240.0, 150.0, 70.0, 110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5483188209908412, "mean_inference_ms": 1.4094093933599336, "mean_action_processing_ms": 0.44587236525999785, "mean_env_wait_ms": 1.2587283461837897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013216972351074219, "StateBufferConnector_ms": 0.01006770133972168, "ViewRequirementAgentConnector_ms": 0.38190412521362305}, "num_episodes": 23, "episode_return_max": 1690.0, "episode_return_min": 180.0, "episode_return_mean": 942.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.09809328999495, "num_env_steps_trained_throughput_per_sec": 21.09809328999495, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 188574.198, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188574.149, "sample_time_ms": 2697.47, "learn_time_ms": 185856.7, "learn_throughput": 21.522, "synch_weights_time_ms": 11.314}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "33e63_00000", "date": "2024-06-19_00-08-54", "timestamp": 1718770134, "time_this_iter_s": 189.6241352558136, "time_total_s": 10917.008360147476, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272c6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10917.008360147476, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 25.208955223880597, "ram_util_percent": 80.35149253731345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.985598217634855, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.71120182952434, "policy_loss": -0.0095475851827677, "vf_loss": 6.719373098349038, "vf_explained_var": 0.0005839071080834466, "kl": 0.0068815700174585095, "entropy": 0.5551330544411565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 300.0, "episode_reward_mean": 943.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 94.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1190.0, 530.0, 490.0, 1315.0, 1075.0, 920.0, 1420.0, 890.0, 1000.0, 660.0, 880.0, 750.0, 1480.0, 1410.0, 440.0, 890.0, 1210.0, 1325.0, 1060.0, 1300.0, 780.0, 860.0, 865.0, 1340.0, 1040.0, 855.0, 795.0, 1000.0, 640.0, 565.0, 1090.0, 860.0, 1120.0, 500.0, 1070.0, 1690.0, 1095.0, 1350.0, 1050.0, 1450.0, 525.0, 735.0, 1680.0, 1030.0, 1400.0, 1110.0, 1200.0, 800.0, 915.0, 1680.0, 980.0, 365.0, 1490.0, 1575.0, 1155.0, 940.0, 645.0, 435.0, 780.0, 1230.0, 980.0, 730.0, 350.0, 1110.0, 530.0, 490.0, 715.0, 1105.0, 910.0, 1255.0, 960.0, 670.0, 650.0, 520.0, 675.0, 300.0, 510.0, 1180.0, 935.0, 990.0, 1565.0, 1405.0, 430.0, 475.0, 570.0, 415.0, 1230.0, 1370.0, 475.0, 340.0, 645.0, 1470.0, 1025.0, 725.0, 1190.0, 960.0, 555.0, 920.0, 1310.0, 750.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 570.0, 130.0, 130.0, 60.0, -30.0, 80.0, 170.0, 60.0, 20.0, 0.0, 0.0, 20.0, 50.0, 30.0, 40.0, 190.0, 60.0, 70.0, 70.0, 140.0, 30.0, 20.0, 60.0, 90.0, 50.0, 20.0, 20.0, 10.0, 50.0, 210.0, 70.0, 120.0, 135.0, 70.0, 130.0, 140.0, 10.0, 170.0, 260.0, -20.0, 180.0, 10.0, 220.0, 60.0, 330.0, 5.0, 200.0, 80.0, 10.0, 50.0, 210.0, 80.0, 40.0, 90.0, 140.0, 190.0, 40.0, -50.0, 130.0, 55.0, 300.0, 10.0, 190.0, 100.0, 110.0, 400.0, 40.0, 70.0, 145.0, 70.0, -65.0, 60.0, 0.0, 100.0, 480.0, 10.0, 30.0, 230.0, -25.0, 100.0, 70.0, 40.0, 160.0, 30.0, 90.0, 60.0, 150.0, 60.0, 240.0, 80.0, 40.0, 140.0, 40.0, 10.0, 30.0, 20.0, 60.0, 160.0, 80.0, 110.0, 30.0, 120.0, 110.0, 70.0, 100.0, 10.0, 210.0, 10.0, 110.0, 50.0, 150.0, 10.0, 190.0, 90.0, 70.0, 90.0, 30.0, 10.0, 60.0, 290.0, 10.0, 20.0, 80.0, 40.0, 140.0, 40.0, 670.0, 80.0, 110.0, 50.0, 280.0, 70.0, 310.0, 60.0, 280.0, 40.0, 170.0, 50.0, 100.0, 10.0, 20.0, 120.0, 40.0, 0.0, 20.0, 40.0, 80.0, 90.0, 20.0, 70.0, 70.0, 50.0, 290.0, 90.0, 90.0, 120.0, 30.0, 10.0, 70.0, 70.0, 110.0, 290.0, -30.0, 420.0, 100.0, 30.0, 140.0, 20.0, 60.0, 340.0, 100.0, 40.0, 150.0, 80.0, 160.0, 15.0, 90.0, 50.0, 300.0, 170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0, 120.0, 60.0, 160.0, 70.0, 40.0, 130.0, 80.0, 200.0, 210.0, 230.0, 35.0, 10.0, 10.0, 320.0, 100.0, -20.0, 190.0, 30.0, -5.0, 110.0, 10.0, 40.0, 50.0, 40.0, 160.0, 140.0, 40.0, 290.0, 60.0, 30.0, 30.0, 120.0, 45.0, 70.0, 50.0, 20.0, 20.0, 280.0, 50.0, 180.0, 290.0, 50.0, 110.0, 70.0, 270.0, 270.0, 130.0, 90.0, 40.0, 20.0, 10.0, 20.0, 90.0, 140.0, 310.0, 20.0, 140.0, 130.0, 100.0, 80.0, 20.0, 90.0, 0.0, 60.0, 75.0, 230.0, 190.0, 70.0, 0.0, 120.0, 0.0, 50.0, 30.0, 160.0, 410.0, 30.0, 20.0, 40.0, 15.0, 40.0, 40.0, 190.0, 70.0, 50.0, 80.0, 90.0, 150.0, 170.0, 80.0, 80.0, 90.0, 110.0, 170.0, 100.0, 50.0, 40.0, 50.0, 20.0, -30.0, 40.0, -20.0, 210.0, 10.0, 110.0, 20.0, 30.0, 0.0, 70.0, 70.0, 65.0, 80.0, 80.0, 120.0, 150.0, 20.0, 180.0, 30.0, 10.0, 170.0, 250.0, 40.0, 20.0, 170.0, 40.0, 0.0, 40.0, 290.0, 20.0, 40.0, 200.0, 65.0, 240.0, 45.0, 0.0, 40.0, 320.0, 160.0, 30.0, 140.0, 80.0, 20.0, 150.0, 60.0, -30.0, 40.0, 30.0, 110.0, 40.0, 60.0, 20.0, 20.0, 50.0, 170.0, 40.0, 40.0, 40.0, 330.0, 180.0, -50.0, 250.0, 70.0, 380.0, 380.0, 30.0, 220.0, 190.0, 120.0, 140.0, 60.0, 100.0, 210.0, 60.0, 110.0, 60.0, 270.0, 30.0, 40.0, 90.0, 15.0, 210.0, 130.0, 200.0, 430.0, 40.0, 280.0, 170.0, 10.0, -30.0, 60.0, 60.0, 370.0, 60.0, 290.0, 120.0, 90.0, 20.0, 130.0, 0.0, 10.0, -40.0, 250.0, 110.0, 120.0, 230.0, 400.0, 20.0, 100.0, 130.0, 70.0, 20.0, 40.0, 30.0, 30.0, 30.0, 190.0, 40.0, 30.0, 20.0, 60.0, 55.0, 80.0, 20.0, 200.0, 50.0, 40.0, 10.0, 10.0, 70.0, 220.0, 35.0, 130.0, 550.0, 110.0, 100.0, 330.0, 200.0, 40.0, 30.0, 120.0, 70.0, 10.0, 120.0, 50.0, 50.0, 130.0, 10.0, 560.0, 20.0, 10.0, 70.0, 140.0, 250.0, 200.0, 30.0, 20.0, 20.0, 200.0, 80.0, 330.0, 130.0, 40.0, 90.0, -10.0, 100.0, 290.0, 90.0, 280.0, 60.0, 100.0, 70.0, 110.0, 60.0, 50.0, 70.0, 210.0, 120.0, 70.0, 190.0, 70.0, 250.0, -125.0, 50.0, 110.0, 190.0, -10.0, 70.0, 380.0, -135.0, 160.0, 110.0, 80.0, 160.0, 90.0, 10.0, 150.0, 140.0, 70.0, 80.0, 70.0, 65.0, 150.0, 110.0, 90.0, 310.0, 35.0, 310.0, 35.0, 70.0, 480.0, 90.0, 0.0, 160.0, 110.0, 210.0, 30.0, 10.0, 40.0, 410.0, -40.0, 50.0, 20.0, 30.0, -15.0, 15.0, -15.0, 30.0, 95.0, -25.0, 200.0, 30.0, 280.0, 100.0, 80.0, 200.0, 30.0, 40.0, 200.0, 80.0, 310.0, 170.0, 10.0, 500.0, 60.0, 120.0, 500.0, 40.0, 65.0, 190.0, 20.0, 70.0, 440.0, 100.0, 40.0, 60.0, 80.0, 10.0, 150.0, 90.0, 155.0, 30.0, 110.0, 60.0, 190.0, -130.0, 200.0, 150.0, 160.0, 40.0, 50.0, 110.0, 0.0, 25.0, 15.0, 30.0, 20.0, 30.0, 55.0, 220.0, 90.0, 160.0, 10.0, 55.0, 20.0, 50.0, 110.0, 30.0, 30.0, 100.0, 20.0, 10.0, 90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0, 90.0, 130.0, 120.0, 100.0, 130.0, -20.0, 320.0, 90.0, 170.0, 100.0, 35.0, 60.0, 35.0, 30.0, 60.0, 30.0, 10.0, 40.0, 100.0, 580.0, 50.0, 20.0, 60.0, 20.0, 160.0, 80.0, 50.0, 0.0, 90.0, 200.0, 160.0, 30.0, 60.0, 30.0, 20.0, 60.0, -5.0, -95.0, 60.0, 30.0, 10.0, 150.0, 50.0, 240.0, 50.0, 90.0, 510.0, 40.0, -40.0, 10.0, 20.0, 10.0, 160.0, 80.0, 20.0, 150.0, 10.0, 15.0, 25.0, 40.0, 0.0, 60.0, 10.0, 60.0, 0.0, 60.0, 80.0, 150.0, 30.0, 40.0, 95.0, 40.0, 10.0, 30.0, 80.0, 10.0, 50.0, 350.0, 30.0, 20.0, 80.0, 10.0, 110.0, 110.0, 330.0, 75.0, 40.0, 70.0, 80.0, 200.0, 70.0, 60.0, 50.0, 60.0, 80.0, 150.0, 40.0, 390.0, 0.0, 10.0, 180.0, 155.0, 310.0, 90.0, 110.0, 50.0, 20.0, 170.0, 120.0, 50.0, 150.0, 20.0, 40.0, -20.0, 330.0, 180.0, 60.0, 40.0, 60.0, 100.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 40.0, 320.0, 70.0, 160.0, 10.0, 50.0, 20.0, -20.0, 60.0, 20.0, 260.0, 100.0, 80.0, 70.0, 50.0, 0.0, 40.0, 370.0, 20.0, 30.0, -10.0, 10.0, 10.0, 0.0, 75.0, 30.0, 45.0, 150.0, 80.0, 35.0, 100.0, 40.0, 90.0, 30.0, 10.0, 10.0, 50.0, 30.0, 50.0, 30.0, 30.0, 10.0, 10.0, 70.0, 30.0, 30.0, 20.0, 0.0, 200.0, 0.0, 60.0, 40.0, 90.0, 40.0, 170.0, -40.0, 250.0, 100.0, 70.0, 100.0, 120.0, 80.0, 170.0, 160.0, 110.0, 270.0, 80.0, 130.0, 10.0, 5.0, 70.0, 20.0, 150.0, 90.0, 160.0, 110.0, 100.0, 20.0, 140.0, 100.0, 30.0, 30.0, 70.0, 230.0, 35.0, 180.0, 130.0, 150.0, 350.0, 210.0, 50.0, 240.0, 150.0, 70.0, 110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0, 70.0, 55.0, 45.0, -30.0, 0.0, 10.0, 20.0, 130.0, 90.0, 40.0, 110.0, 20.0, -30.0, 20.0, 30.0, 180.0, 30.0, 0.0, 130.0, -15.0, 10.0, 0.0, 80.0, 40.0, 10.0, 30.0, 20.0, 270.0, 70.0, 40.0, 25.0, 25.0, 5.0, 10.0, 110.0, 60.0, 10.0, 40.0, 120.0, 10.0, 60.0, 70.0, -40.0, -50.0, 530.0, 40.0, 50.0, 200.0, 300.0, 70.0, 80.0, 320.0, 260.0, 180.0, 140.0, -20.0, 110.0, 50.0, 90.0, 160.0, 30.0, 70.0, 15.0, 70.0, 30.0, 30.0, 70.0, 70.0, 40.0, 50.0, 20.0, 50.0, 50.0, 0.0, 80.0, 40.0, 0.0, 0.0, 60.0, 40.0, 270.0, -100.0, 30.0, 30.0, 170.0, 80.0, 140.0, 20.0, -5.0, 10.0, 240.0, 150.0, 70.0, -105.0, 240.0, 90.0, 255.0, 460.0, 50.0, 20.0, 220.0, 150.0, 70.0, 90.0, 45.0, 10.0, 120.0, 240.0, 20.0, 60.0, 40.0, 20.0, 80.0, 30.0, 145.0, 300.0, 80.0, -15.0, 45.0, 0.0, 30.0, 20.0, 90.0, 290.0, 460.0, -20.0, 50.0, -20.0, 50.0, 240.0, 50.0, 10.0, 160.0, 30.0, 110.0, 70.0, 70.0, 270.0, 20.0, 170.0, 20.0, 30.0, -50.0, 160.0, 10.0, 20.0, -90.0, 160.0, 55.0, 240.0, 30.0, -40.0, 40.0, 60.0, 380.0, 110.0, 50.0, 260.0, 20.0, 10.0, 20.0, 330.0, 190.0, 10.0, 120.0, 320.0, -30.0, 60.0, 250.0, 40.0, 40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.54779724789992, "mean_inference_ms": 1.4104184625221021, "mean_action_processing_ms": 0.45168850450447123, "mean_env_wait_ms": 1.25877804314219, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013060808181762695, "StateBufferConnector_ms": 0.009985685348510742, "ViewRequirementAgentConnector_ms": 0.38233089447021484}, "num_episodes": 18, "episode_return_max": 1690.0, "episode_return_min": 300.0, "episode_return_mean": 943.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.269889516878614, "num_env_steps_trained_throughput_per_sec": 21.269889516878614, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 188661.69, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188661.641, "sample_time_ms": 2688.177, "learn_time_ms": 185953.316, "learn_throughput": 21.511, "synch_weights_time_ms": 11.337}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "33e63_00000", "date": "2024-06-19_00-12-02", "timestamp": 1718770322, "time_this_iter_s": 188.06595277786255, "time_total_s": 11105.074312925339, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11105.074312925339, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 24.741353383458645, "ram_util_percent": 79.2109022556391}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.81389030756407, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.945428812110259, "policy_loss": -0.009132206959960362, "vf_loss": 6.953280744410424, "vf_explained_var": 0.0004922157278457008, "kl": 0.006401383855776865, "entropy": 0.563848074220113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1690.0, "episode_reward_min": 225.0, "episode_reward_mean": 920.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 92.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 1300.0, 780.0, 860.0, 865.0, 1340.0, 1040.0, 855.0, 795.0, 1000.0, 640.0, 565.0, 1090.0, 860.0, 1120.0, 500.0, 1070.0, 1690.0, 1095.0, 1350.0, 1050.0, 1450.0, 525.0, 735.0, 1680.0, 1030.0, 1400.0, 1110.0, 1200.0, 800.0, 915.0, 1680.0, 980.0, 365.0, 1490.0, 1575.0, 1155.0, 940.0, 645.0, 435.0, 780.0, 1230.0, 980.0, 730.0, 350.0, 1110.0, 530.0, 490.0, 715.0, 1105.0, 910.0, 1255.0, 960.0, 670.0, 650.0, 520.0, 675.0, 300.0, 510.0, 1180.0, 935.0, 990.0, 1565.0, 1405.0, 430.0, 475.0, 570.0, 415.0, 1230.0, 1370.0, 475.0, 340.0, 645.0, 1470.0, 1025.0, 725.0, 1190.0, 960.0, 555.0, 920.0, 1310.0, 750.0, 225.0, 560.0, 500.0, 960.0, 790.0, 340.0, 975.0, 1570.0, 345.0, 570.0, 1565.0, 1030.0, 560.0, 1380.0, 1130.0, 1300.0, 1090.0, 745.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 70.0, -40.0, 30.0, 130.0, 160.0, 70.0, 100.0, 130.0, 240.0, 120.0, 60.0, 160.0, 70.0, 40.0, 130.0, 80.0, 200.0, 210.0, 230.0, 35.0, 10.0, 10.0, 320.0, 100.0, -20.0, 190.0, 30.0, -5.0, 110.0, 10.0, 40.0, 50.0, 40.0, 160.0, 140.0, 40.0, 290.0, 60.0, 30.0, 30.0, 120.0, 45.0, 70.0, 50.0, 20.0, 20.0, 280.0, 50.0, 180.0, 290.0, 50.0, 110.0, 70.0, 270.0, 270.0, 130.0, 90.0, 40.0, 20.0, 10.0, 20.0, 90.0, 140.0, 310.0, 20.0, 140.0, 130.0, 100.0, 80.0, 20.0, 90.0, 0.0, 60.0, 75.0, 230.0, 190.0, 70.0, 0.0, 120.0, 0.0, 50.0, 30.0, 160.0, 410.0, 30.0, 20.0, 40.0, 15.0, 40.0, 40.0, 190.0, 70.0, 50.0, 80.0, 90.0, 150.0, 170.0, 80.0, 80.0, 90.0, 110.0, 170.0, 100.0, 50.0, 40.0, 50.0, 20.0, -30.0, 40.0, -20.0, 210.0, 10.0, 110.0, 20.0, 30.0, 0.0, 70.0, 70.0, 65.0, 80.0, 80.0, 120.0, 150.0, 20.0, 180.0, 30.0, 10.0, 170.0, 250.0, 40.0, 20.0, 170.0, 40.0, 0.0, 40.0, 290.0, 20.0, 40.0, 200.0, 65.0, 240.0, 45.0, 0.0, 40.0, 320.0, 160.0, 30.0, 140.0, 80.0, 20.0, 150.0, 60.0, -30.0, 40.0, 30.0, 110.0, 40.0, 60.0, 20.0, 20.0, 50.0, 170.0, 40.0, 40.0, 40.0, 330.0, 180.0, -50.0, 250.0, 70.0, 380.0, 380.0, 30.0, 220.0, 190.0, 120.0, 140.0, 60.0, 100.0, 210.0, 60.0, 110.0, 60.0, 270.0, 30.0, 40.0, 90.0, 15.0, 210.0, 130.0, 200.0, 430.0, 40.0, 280.0, 170.0, 10.0, -30.0, 60.0, 60.0, 370.0, 60.0, 290.0, 120.0, 90.0, 20.0, 130.0, 0.0, 10.0, -40.0, 250.0, 110.0, 120.0, 230.0, 400.0, 20.0, 100.0, 130.0, 70.0, 20.0, 40.0, 30.0, 30.0, 30.0, 190.0, 40.0, 30.0, 20.0, 60.0, 55.0, 80.0, 20.0, 200.0, 50.0, 40.0, 10.0, 10.0, 70.0, 220.0, 35.0, 130.0, 550.0, 110.0, 100.0, 330.0, 200.0, 40.0, 30.0, 120.0, 70.0, 10.0, 120.0, 50.0, 50.0, 130.0, 10.0, 560.0, 20.0, 10.0, 70.0, 140.0, 250.0, 200.0, 30.0, 20.0, 20.0, 200.0, 80.0, 330.0, 130.0, 40.0, 90.0, -10.0, 100.0, 290.0, 90.0, 280.0, 60.0, 100.0, 70.0, 110.0, 60.0, 50.0, 70.0, 210.0, 120.0, 70.0, 190.0, 70.0, 250.0, -125.0, 50.0, 110.0, 190.0, -10.0, 70.0, 380.0, -135.0, 160.0, 110.0, 80.0, 160.0, 90.0, 10.0, 150.0, 140.0, 70.0, 80.0, 70.0, 65.0, 150.0, 110.0, 90.0, 310.0, 35.0, 310.0, 35.0, 70.0, 480.0, 90.0, 0.0, 160.0, 110.0, 210.0, 30.0, 10.0, 40.0, 410.0, -40.0, 50.0, 20.0, 30.0, -15.0, 15.0, -15.0, 30.0, 95.0, -25.0, 200.0, 30.0, 280.0, 100.0, 80.0, 200.0, 30.0, 40.0, 200.0, 80.0, 310.0, 170.0, 10.0, 500.0, 60.0, 120.0, 500.0, 40.0, 65.0, 190.0, 20.0, 70.0, 440.0, 100.0, 40.0, 60.0, 80.0, 10.0, 150.0, 90.0, 155.0, 30.0, 110.0, 60.0, 190.0, -130.0, 200.0, 150.0, 160.0, 40.0, 50.0, 110.0, 0.0, 25.0, 15.0, 30.0, 20.0, 30.0, 55.0, 220.0, 90.0, 160.0, 10.0, 55.0, 20.0, 50.0, 110.0, 30.0, 30.0, 100.0, 20.0, 10.0, 90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0, 90.0, 130.0, 120.0, 100.0, 130.0, -20.0, 320.0, 90.0, 170.0, 100.0, 35.0, 60.0, 35.0, 30.0, 60.0, 30.0, 10.0, 40.0, 100.0, 580.0, 50.0, 20.0, 60.0, 20.0, 160.0, 80.0, 50.0, 0.0, 90.0, 200.0, 160.0, 30.0, 60.0, 30.0, 20.0, 60.0, -5.0, -95.0, 60.0, 30.0, 10.0, 150.0, 50.0, 240.0, 50.0, 90.0, 510.0, 40.0, -40.0, 10.0, 20.0, 10.0, 160.0, 80.0, 20.0, 150.0, 10.0, 15.0, 25.0, 40.0, 0.0, 60.0, 10.0, 60.0, 0.0, 60.0, 80.0, 150.0, 30.0, 40.0, 95.0, 40.0, 10.0, 30.0, 80.0, 10.0, 50.0, 350.0, 30.0, 20.0, 80.0, 10.0, 110.0, 110.0, 330.0, 75.0, 40.0, 70.0, 80.0, 200.0, 70.0, 60.0, 50.0, 60.0, 80.0, 150.0, 40.0, 390.0, 0.0, 10.0, 180.0, 155.0, 310.0, 90.0, 110.0, 50.0, 20.0, 170.0, 120.0, 50.0, 150.0, 20.0, 40.0, -20.0, 330.0, 180.0, 60.0, 40.0, 60.0, 100.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 40.0, 320.0, 70.0, 160.0, 10.0, 50.0, 20.0, -20.0, 60.0, 20.0, 260.0, 100.0, 80.0, 70.0, 50.0, 0.0, 40.0, 370.0, 20.0, 30.0, -10.0, 10.0, 10.0, 0.0, 75.0, 30.0, 45.0, 150.0, 80.0, 35.0, 100.0, 40.0, 90.0, 30.0, 10.0, 10.0, 50.0, 30.0, 50.0, 30.0, 30.0, 10.0, 10.0, 70.0, 30.0, 30.0, 20.0, 0.0, 200.0, 0.0, 60.0, 40.0, 90.0, 40.0, 170.0, -40.0, 250.0, 100.0, 70.0, 100.0, 120.0, 80.0, 170.0, 160.0, 110.0, 270.0, 80.0, 130.0, 10.0, 5.0, 70.0, 20.0, 150.0, 90.0, 160.0, 110.0, 100.0, 20.0, 140.0, 100.0, 30.0, 30.0, 70.0, 230.0, 35.0, 180.0, 130.0, 150.0, 350.0, 210.0, 50.0, 240.0, 150.0, 70.0, 110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0, 70.0, 55.0, 45.0, -30.0, 0.0, 10.0, 20.0, 130.0, 90.0, 40.0, 110.0, 20.0, -30.0, 20.0, 30.0, 180.0, 30.0, 0.0, 130.0, -15.0, 10.0, 0.0, 80.0, 40.0, 10.0, 30.0, 20.0, 270.0, 70.0, 40.0, 25.0, 25.0, 5.0, 10.0, 110.0, 60.0, 10.0, 40.0, 120.0, 10.0, 60.0, 70.0, -40.0, -50.0, 530.0, 40.0, 50.0, 200.0, 300.0, 70.0, 80.0, 320.0, 260.0, 180.0, 140.0, -20.0, 110.0, 50.0, 90.0, 160.0, 30.0, 70.0, 15.0, 70.0, 30.0, 30.0, 70.0, 70.0, 40.0, 50.0, 20.0, 50.0, 50.0, 0.0, 80.0, 40.0, 0.0, 0.0, 60.0, 40.0, 270.0, -100.0, 30.0, 30.0, 170.0, 80.0, 140.0, 20.0, -5.0, 10.0, 240.0, 150.0, 70.0, -105.0, 240.0, 90.0, 255.0, 460.0, 50.0, 20.0, 220.0, 150.0, 70.0, 90.0, 45.0, 10.0, 120.0, 240.0, 20.0, 60.0, 40.0, 20.0, 80.0, 30.0, 145.0, 300.0, 80.0, -15.0, 45.0, 0.0, 30.0, 20.0, 90.0, 290.0, 460.0, -20.0, 50.0, -20.0, 50.0, 240.0, 50.0, 10.0, 160.0, 30.0, 110.0, 70.0, 70.0, 270.0, 20.0, 170.0, 20.0, 30.0, -50.0, 160.0, 10.0, 20.0, -90.0, 160.0, 55.0, 240.0, 30.0, -40.0, 40.0, 60.0, 380.0, 110.0, 50.0, 260.0, 20.0, 10.0, 20.0, 330.0, 190.0, 10.0, 120.0, 320.0, -30.0, 60.0, 250.0, 40.0, 40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 45.0, 0.0, 100.0, 160.0, 40.0, 60.0, 90.0, 50.0, 0.0, 40.0, 0.0, 20.0, 100.0, 120.0, 190.0, 10.0, 10.0, 20.0, 30.0, -90.0, 70.0, 40.0, 60.0, 50.0, -30.0, 60.0, 150.0, 460.0, 80.0, 10.0, 70.0, 50.0, 30.0, -20.0, 10.0, 40.0, 20.0, 150.0, 40.0, 120.0, 370.0, 30.0, 40.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 160.0, 10.0, 40.0, 40.0, 70.0, 90.0, 95.0, 70.0, 50.0, 280.0, 40.0, 130.0, 110.0, 50.0, 180.0, 380.0, 140.0, 140.0, 80.0, 300.0, 60.0, 90.0, 150.0, 100.0, 60.0, 80.0, 0.0, 0.0, 0.0, 0.0, 50.0, 30.0, 25.0, 50.0, 0.0, 40.0, 120.0, 40.0, 50.0, 30.0, 130.0, 90.0, 20.0, 50.0, 80.0, 80.0, 270.0, 150.0, 125.0, 120.0, 180.0, 190.0, 320.0, 70.0, 70.0, 60.0, 330.0, 70.0, -20.0, -10.0, 40.0, -90.0, 510.0, 70.0, 70.0, 50.0, 20.0, 130.0, 120.0, 40.0, 30.0, 0.0, 30.0, 180.0, 70.0, 170.0, 310.0, 10.0, 340.0, 150.0, 80.0, 50.0, 20.0, 190.0, 50.0, 210.0, 60.0, 130.0, 120.0, -30.0, 70.0, 60.0, 270.0, 40.0, 190.0, 30.0, 350.0, 500.0, 10.0, 50.0, 80.0, 50.0, 0.0, 360.0, 510.0, 110.0, 70.0, -90.0, 0.0, 60.0, 70.0, 0.0, 0.0, 10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5476328578281033, "mean_inference_ms": 1.4116212096371896, "mean_action_processing_ms": 0.45745722848279724, "mean_env_wait_ms": 1.2589716775581474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012364625930786133, "StateBufferConnector_ms": 0.009496927261352539, "ViewRequirementAgentConnector_ms": 0.38060975074768066}, "num_episodes": 18, "episode_return_max": 1690.0, "episode_return_min": 225.0, "episode_return_mean": 920.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.13020022321703, "num_env_steps_trained_throughput_per_sec": 21.13020022321703, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 188925.649, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188925.602, "sample_time_ms": 2704.403, "learn_time_ms": 186201.275, "learn_throughput": 21.482, "synch_weights_time_ms": 11.285}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "33e63_00000", "date": "2024-06-19_00-15-12", "timestamp": 1718770512, "time_this_iter_s": 189.31215000152588, "time_total_s": 11294.386462926865, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11294.386462926865, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 25.29402985074627, "ram_util_percent": 79.79440298507463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4165980004464473, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.098141156065578, "policy_loss": -0.008970596779574748, "vf_loss": 7.105733312712437, "vf_explained_var": 0.0013959228167264733, "kl": 0.006892178067952216, "entropy": 0.5385201392304529, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1735.0, "episode_reward_min": 225.0, "episode_reward_mean": 898.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -135.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 89.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [525.0, 735.0, 1680.0, 1030.0, 1400.0, 1110.0, 1200.0, 800.0, 915.0, 1680.0, 980.0, 365.0, 1490.0, 1575.0, 1155.0, 940.0, 645.0, 435.0, 780.0, 1230.0, 980.0, 730.0, 350.0, 1110.0, 530.0, 490.0, 715.0, 1105.0, 910.0, 1255.0, 960.0, 670.0, 650.0, 520.0, 675.0, 300.0, 510.0, 1180.0, 935.0, 990.0, 1565.0, 1405.0, 430.0, 475.0, 570.0, 415.0, 1230.0, 1370.0, 475.0, 340.0, 645.0, 1470.0, 1025.0, 725.0, 1190.0, 960.0, 555.0, 920.0, 1310.0, 750.0, 225.0, 560.0, 500.0, 960.0, 790.0, 340.0, 975.0, 1570.0, 345.0, 570.0, 1565.0, 1030.0, 560.0, 1380.0, 1130.0, 1300.0, 1090.0, 745.0, 840.0, 830.0, 805.0, 430.0, 820.0, 1555.0, 1735.0, 625.0, 1120.0, 830.0, 1280.0, 530.0, 1350.0, 1160.0, 660.0, 790.0, 1130.0, 610.0, 1030.0, 760.0, 295.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 30.0, 30.0, 190.0, 40.0, 30.0, 20.0, 60.0, 55.0, 80.0, 20.0, 200.0, 50.0, 40.0, 10.0, 10.0, 70.0, 220.0, 35.0, 130.0, 550.0, 110.0, 100.0, 330.0, 200.0, 40.0, 30.0, 120.0, 70.0, 10.0, 120.0, 50.0, 50.0, 130.0, 10.0, 560.0, 20.0, 10.0, 70.0, 140.0, 250.0, 200.0, 30.0, 20.0, 20.0, 200.0, 80.0, 330.0, 130.0, 40.0, 90.0, -10.0, 100.0, 290.0, 90.0, 280.0, 60.0, 100.0, 70.0, 110.0, 60.0, 50.0, 70.0, 210.0, 120.0, 70.0, 190.0, 70.0, 250.0, -125.0, 50.0, 110.0, 190.0, -10.0, 70.0, 380.0, -135.0, 160.0, 110.0, 80.0, 160.0, 90.0, 10.0, 150.0, 140.0, 70.0, 80.0, 70.0, 65.0, 150.0, 110.0, 90.0, 310.0, 35.0, 310.0, 35.0, 70.0, 480.0, 90.0, 0.0, 160.0, 110.0, 210.0, 30.0, 10.0, 40.0, 410.0, -40.0, 50.0, 20.0, 30.0, -15.0, 15.0, -15.0, 30.0, 95.0, -25.0, 200.0, 30.0, 280.0, 100.0, 80.0, 200.0, 30.0, 40.0, 200.0, 80.0, 310.0, 170.0, 10.0, 500.0, 60.0, 120.0, 500.0, 40.0, 65.0, 190.0, 20.0, 70.0, 440.0, 100.0, 40.0, 60.0, 80.0, 10.0, 150.0, 90.0, 155.0, 30.0, 110.0, 60.0, 190.0, -130.0, 200.0, 150.0, 160.0, 40.0, 50.0, 110.0, 0.0, 25.0, 15.0, 30.0, 20.0, 30.0, 55.0, 220.0, 90.0, 160.0, 10.0, 55.0, 20.0, 50.0, 110.0, 30.0, 30.0, 100.0, 20.0, 10.0, 90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0, 90.0, 130.0, 120.0, 100.0, 130.0, -20.0, 320.0, 90.0, 170.0, 100.0, 35.0, 60.0, 35.0, 30.0, 60.0, 30.0, 10.0, 40.0, 100.0, 580.0, 50.0, 20.0, 60.0, 20.0, 160.0, 80.0, 50.0, 0.0, 90.0, 200.0, 160.0, 30.0, 60.0, 30.0, 20.0, 60.0, -5.0, -95.0, 60.0, 30.0, 10.0, 150.0, 50.0, 240.0, 50.0, 90.0, 510.0, 40.0, -40.0, 10.0, 20.0, 10.0, 160.0, 80.0, 20.0, 150.0, 10.0, 15.0, 25.0, 40.0, 0.0, 60.0, 10.0, 60.0, 0.0, 60.0, 80.0, 150.0, 30.0, 40.0, 95.0, 40.0, 10.0, 30.0, 80.0, 10.0, 50.0, 350.0, 30.0, 20.0, 80.0, 10.0, 110.0, 110.0, 330.0, 75.0, 40.0, 70.0, 80.0, 200.0, 70.0, 60.0, 50.0, 60.0, 80.0, 150.0, 40.0, 390.0, 0.0, 10.0, 180.0, 155.0, 310.0, 90.0, 110.0, 50.0, 20.0, 170.0, 120.0, 50.0, 150.0, 20.0, 40.0, -20.0, 330.0, 180.0, 60.0, 40.0, 60.0, 100.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 40.0, 320.0, 70.0, 160.0, 10.0, 50.0, 20.0, -20.0, 60.0, 20.0, 260.0, 100.0, 80.0, 70.0, 50.0, 0.0, 40.0, 370.0, 20.0, 30.0, -10.0, 10.0, 10.0, 0.0, 75.0, 30.0, 45.0, 150.0, 80.0, 35.0, 100.0, 40.0, 90.0, 30.0, 10.0, 10.0, 50.0, 30.0, 50.0, 30.0, 30.0, 10.0, 10.0, 70.0, 30.0, 30.0, 20.0, 0.0, 200.0, 0.0, 60.0, 40.0, 90.0, 40.0, 170.0, -40.0, 250.0, 100.0, 70.0, 100.0, 120.0, 80.0, 170.0, 160.0, 110.0, 270.0, 80.0, 130.0, 10.0, 5.0, 70.0, 20.0, 150.0, 90.0, 160.0, 110.0, 100.0, 20.0, 140.0, 100.0, 30.0, 30.0, 70.0, 230.0, 35.0, 180.0, 130.0, 150.0, 350.0, 210.0, 50.0, 240.0, 150.0, 70.0, 110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0, 70.0, 55.0, 45.0, -30.0, 0.0, 10.0, 20.0, 130.0, 90.0, 40.0, 110.0, 20.0, -30.0, 20.0, 30.0, 180.0, 30.0, 0.0, 130.0, -15.0, 10.0, 0.0, 80.0, 40.0, 10.0, 30.0, 20.0, 270.0, 70.0, 40.0, 25.0, 25.0, 5.0, 10.0, 110.0, 60.0, 10.0, 40.0, 120.0, 10.0, 60.0, 70.0, -40.0, -50.0, 530.0, 40.0, 50.0, 200.0, 300.0, 70.0, 80.0, 320.0, 260.0, 180.0, 140.0, -20.0, 110.0, 50.0, 90.0, 160.0, 30.0, 70.0, 15.0, 70.0, 30.0, 30.0, 70.0, 70.0, 40.0, 50.0, 20.0, 50.0, 50.0, 0.0, 80.0, 40.0, 0.0, 0.0, 60.0, 40.0, 270.0, -100.0, 30.0, 30.0, 170.0, 80.0, 140.0, 20.0, -5.0, 10.0, 240.0, 150.0, 70.0, -105.0, 240.0, 90.0, 255.0, 460.0, 50.0, 20.0, 220.0, 150.0, 70.0, 90.0, 45.0, 10.0, 120.0, 240.0, 20.0, 60.0, 40.0, 20.0, 80.0, 30.0, 145.0, 300.0, 80.0, -15.0, 45.0, 0.0, 30.0, 20.0, 90.0, 290.0, 460.0, -20.0, 50.0, -20.0, 50.0, 240.0, 50.0, 10.0, 160.0, 30.0, 110.0, 70.0, 70.0, 270.0, 20.0, 170.0, 20.0, 30.0, -50.0, 160.0, 10.0, 20.0, -90.0, 160.0, 55.0, 240.0, 30.0, -40.0, 40.0, 60.0, 380.0, 110.0, 50.0, 260.0, 20.0, 10.0, 20.0, 330.0, 190.0, 10.0, 120.0, 320.0, -30.0, 60.0, 250.0, 40.0, 40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 45.0, 0.0, 100.0, 160.0, 40.0, 60.0, 90.0, 50.0, 0.0, 40.0, 0.0, 20.0, 100.0, 120.0, 190.0, 10.0, 10.0, 20.0, 30.0, -90.0, 70.0, 40.0, 60.0, 50.0, -30.0, 60.0, 150.0, 460.0, 80.0, 10.0, 70.0, 50.0, 30.0, -20.0, 10.0, 40.0, 20.0, 150.0, 40.0, 120.0, 370.0, 30.0, 40.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 160.0, 10.0, 40.0, 40.0, 70.0, 90.0, 95.0, 70.0, 50.0, 280.0, 40.0, 130.0, 110.0, 50.0, 180.0, 380.0, 140.0, 140.0, 80.0, 300.0, 60.0, 90.0, 150.0, 100.0, 60.0, 80.0, 0.0, 0.0, 0.0, 0.0, 50.0, 30.0, 25.0, 50.0, 0.0, 40.0, 120.0, 40.0, 50.0, 30.0, 130.0, 90.0, 20.0, 50.0, 80.0, 80.0, 270.0, 150.0, 125.0, 120.0, 180.0, 190.0, 320.0, 70.0, 70.0, 60.0, 330.0, 70.0, -20.0, -10.0, 40.0, -90.0, 510.0, 70.0, 70.0, 50.0, 20.0, 130.0, 120.0, 40.0, 30.0, 0.0, 30.0, 180.0, 70.0, 170.0, 310.0, 10.0, 340.0, 150.0, 80.0, 50.0, 20.0, 190.0, 50.0, 210.0, 60.0, 130.0, 120.0, -30.0, 70.0, 60.0, 270.0, 40.0, 190.0, 30.0, 350.0, 500.0, 10.0, 50.0, 80.0, 50.0, 0.0, 360.0, 510.0, 110.0, 70.0, -90.0, 0.0, 60.0, 70.0, 0.0, 0.0, 10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0, 90.0, 0.0, 230.0, -10.0, 20.0, -5.0, 20.0, 490.0, 0.0, 5.0, 150.0, 60.0, 90.0, 90.0, 0.0, 20.0, 20.0, 310.0, 70.0, 20.0, 50.0, 370.0, 30.0, 25.0, 10.0, 10.0, 40.0, 90.0, 160.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 50.0, 20.0, 170.0, 20.0, 30.0, 90.0, 10.0, 40.0, 20.0, 40.0, 50.0, 380.0, 40.0, 100.0, 50.0, 300.0, 80.0, 40.0, 700.0, -30.0, 130.0, 90.0, -115.0, 70.0, 290.0, 210.0, 90.0, 80.0, 540.0, 30.0, 130.0, 45.0, 350.0, 200.0, 60.0, 70.0, 60.0, 20.0, 20.0, 250.0, 50.0, 60.0, 40.0, 15.0, 40.0, 230.0, 60.0, 80.0, 70.0, 120.0, 250.0, 90.0, 80.0, 70.0, 70.0, 10.0, 100.0, 130.0, 280.0, 150.0, 80.0, 10.0, 0.0, 50.0, 20.0, 110.0, 100.0, 370.0, 100.0, 100.0, 80.0, 70.0, 150.0, 100.0, 100.0, 20.0, 30.0, 10.0, 80.0, 30.0, 50.0, 50.0, 130.0, 80.0, 50.0, 70.0, 80.0, 110.0, 100.0, 130.0, 30.0, 80.0, 220.0, 440.0, 90.0, 130.0, 160.0, 90.0, 30.0, 200.0, -5.0, 70.0, 35.0, 410.0, 40.0, 40.0, 50.0, 20.0, -35.0, -20.0, -75.0, 270.0, 150.0, 190.0, 70.0, 120.0, 10.0, 60.0, 350.0, 20.0, 10.0, 20.0, 50.0, 30.0, 120.0, 100.0, 170.0, 230.0, 35.0, 60.0, 65.0, 140.0, 110.0, 120.0, 100.0, 170.0, 70.0, 10.0, 160.0, 35.0, 10.0, 30.0, 110.0, -15.0, 30.0, 90.0, -30.0, 100.0, 360.0, 70.0, 80.0, 80.0, 0.0, 170.0, 110.0, 0.0, 10.0, 220.0, 160.0, 20.0, 70.0, 10.0, 120.0, 100.0, 50.0, 30.0, 70.0, 40.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 35.0, 110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5459342333984814, "mean_inference_ms": 1.411824721110478, "mean_action_processing_ms": 0.4636381614698223, "mean_env_wait_ms": 1.2589692504620023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012322187423706055, "StateBufferConnector_ms": 0.00947117805480957, "ViewRequirementAgentConnector_ms": 0.3755826950073242}, "num_episodes": 22, "episode_return_max": 1735.0, "episode_return_min": 225.0, "episode_return_mean": 898.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.10652610014486, "num_env_steps_trained_throughput_per_sec": 21.10652610014486, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 189201.597, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189201.551, "sample_time_ms": 2698.627, "learn_time_ms": 186483.36, "learn_throughput": 21.45, "synch_weights_time_ms": 11.186}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "33e63_00000", "date": "2024-06-19_00-18-21", "timestamp": 1718770701, "time_this_iter_s": 189.52555799484253, "time_total_s": 11483.912020921707, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11483.912020921707, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 24.97798507462687, "ram_util_percent": 80.32873134328358}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.399411130167298, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.209670797882243, "policy_loss": -0.009568438646200095, "vf_loss": 7.217967462031859, "vf_explained_var": -0.0004385594615794091, "kl": 0.0063588557697913965, "entropy": 0.5101419071134287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 1735.0, "episode_reward_min": 225.0, "episode_reward_mean": 890.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 89.08}, "custom_metrics": {}, "hist_stats": {"episode_reward": [780.0, 1230.0, 980.0, 730.0, 350.0, 1110.0, 530.0, 490.0, 715.0, 1105.0, 910.0, 1255.0, 960.0, 670.0, 650.0, 520.0, 675.0, 300.0, 510.0, 1180.0, 935.0, 990.0, 1565.0, 1405.0, 430.0, 475.0, 570.0, 415.0, 1230.0, 1370.0, 475.0, 340.0, 645.0, 1470.0, 1025.0, 725.0, 1190.0, 960.0, 555.0, 920.0, 1310.0, 750.0, 225.0, 560.0, 500.0, 960.0, 790.0, 340.0, 975.0, 1570.0, 345.0, 570.0, 1565.0, 1030.0, 560.0, 1380.0, 1130.0, 1300.0, 1090.0, 745.0, 840.0, 830.0, 805.0, 430.0, 820.0, 1555.0, 1735.0, 625.0, 1120.0, 830.0, 1280.0, 530.0, 1350.0, 1160.0, 660.0, 790.0, 1130.0, 610.0, 1030.0, 760.0, 295.0, 960.0, 1530.0, 580.0, 405.0, 1695.0, 860.0, 805.0, 1180.0, 1290.0, 990.0, 1280.0, 1030.0, 1190.0, 840.0, 620.0, 660.0, 785.0, 865.0, 1295.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 30.0, 170.0, 40.0, 90.0, 0.0, 210.0, 30.0, -10.0, 130.0, 90.0, 130.0, 120.0, 100.0, 130.0, -20.0, 320.0, 90.0, 170.0, 100.0, 35.0, 60.0, 35.0, 30.0, 60.0, 30.0, 10.0, 40.0, 100.0, 580.0, 50.0, 20.0, 60.0, 20.0, 160.0, 80.0, 50.0, 0.0, 90.0, 200.0, 160.0, 30.0, 60.0, 30.0, 20.0, 60.0, -5.0, -95.0, 60.0, 30.0, 10.0, 150.0, 50.0, 240.0, 50.0, 90.0, 510.0, 40.0, -40.0, 10.0, 20.0, 10.0, 160.0, 80.0, 20.0, 150.0, 10.0, 15.0, 25.0, 40.0, 0.0, 60.0, 10.0, 60.0, 0.0, 60.0, 80.0, 150.0, 30.0, 40.0, 95.0, 40.0, 10.0, 30.0, 80.0, 10.0, 50.0, 350.0, 30.0, 20.0, 80.0, 10.0, 110.0, 110.0, 330.0, 75.0, 40.0, 70.0, 80.0, 200.0, 70.0, 60.0, 50.0, 60.0, 80.0, 150.0, 40.0, 390.0, 0.0, 10.0, 180.0, 155.0, 310.0, 90.0, 110.0, 50.0, 20.0, 170.0, 120.0, 50.0, 150.0, 20.0, 40.0, -20.0, 330.0, 180.0, 60.0, 40.0, 60.0, 100.0, 10.0, 20.0, 30.0, 0.0, 20.0, 0.0, 40.0, 320.0, 70.0, 160.0, 10.0, 50.0, 20.0, -20.0, 60.0, 20.0, 260.0, 100.0, 80.0, 70.0, 50.0, 0.0, 40.0, 370.0, 20.0, 30.0, -10.0, 10.0, 10.0, 0.0, 75.0, 30.0, 45.0, 150.0, 80.0, 35.0, 100.0, 40.0, 90.0, 30.0, 10.0, 10.0, 50.0, 30.0, 50.0, 30.0, 30.0, 10.0, 10.0, 70.0, 30.0, 30.0, 20.0, 0.0, 200.0, 0.0, 60.0, 40.0, 90.0, 40.0, 170.0, -40.0, 250.0, 100.0, 70.0, 100.0, 120.0, 80.0, 170.0, 160.0, 110.0, 270.0, 80.0, 130.0, 10.0, 5.0, 70.0, 20.0, 150.0, 90.0, 160.0, 110.0, 100.0, 20.0, 140.0, 100.0, 30.0, 30.0, 70.0, 230.0, 35.0, 180.0, 130.0, 150.0, 350.0, 210.0, 50.0, 240.0, 150.0, 70.0, 110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0, 70.0, 55.0, 45.0, -30.0, 0.0, 10.0, 20.0, 130.0, 90.0, 40.0, 110.0, 20.0, -30.0, 20.0, 30.0, 180.0, 30.0, 0.0, 130.0, -15.0, 10.0, 0.0, 80.0, 40.0, 10.0, 30.0, 20.0, 270.0, 70.0, 40.0, 25.0, 25.0, 5.0, 10.0, 110.0, 60.0, 10.0, 40.0, 120.0, 10.0, 60.0, 70.0, -40.0, -50.0, 530.0, 40.0, 50.0, 200.0, 300.0, 70.0, 80.0, 320.0, 260.0, 180.0, 140.0, -20.0, 110.0, 50.0, 90.0, 160.0, 30.0, 70.0, 15.0, 70.0, 30.0, 30.0, 70.0, 70.0, 40.0, 50.0, 20.0, 50.0, 50.0, 0.0, 80.0, 40.0, 0.0, 0.0, 60.0, 40.0, 270.0, -100.0, 30.0, 30.0, 170.0, 80.0, 140.0, 20.0, -5.0, 10.0, 240.0, 150.0, 70.0, -105.0, 240.0, 90.0, 255.0, 460.0, 50.0, 20.0, 220.0, 150.0, 70.0, 90.0, 45.0, 10.0, 120.0, 240.0, 20.0, 60.0, 40.0, 20.0, 80.0, 30.0, 145.0, 300.0, 80.0, -15.0, 45.0, 0.0, 30.0, 20.0, 90.0, 290.0, 460.0, -20.0, 50.0, -20.0, 50.0, 240.0, 50.0, 10.0, 160.0, 30.0, 110.0, 70.0, 70.0, 270.0, 20.0, 170.0, 20.0, 30.0, -50.0, 160.0, 10.0, 20.0, -90.0, 160.0, 55.0, 240.0, 30.0, -40.0, 40.0, 60.0, 380.0, 110.0, 50.0, 260.0, 20.0, 10.0, 20.0, 330.0, 190.0, 10.0, 120.0, 320.0, -30.0, 60.0, 250.0, 40.0, 40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 45.0, 0.0, 100.0, 160.0, 40.0, 60.0, 90.0, 50.0, 0.0, 40.0, 0.0, 20.0, 100.0, 120.0, 190.0, 10.0, 10.0, 20.0, 30.0, -90.0, 70.0, 40.0, 60.0, 50.0, -30.0, 60.0, 150.0, 460.0, 80.0, 10.0, 70.0, 50.0, 30.0, -20.0, 10.0, 40.0, 20.0, 150.0, 40.0, 120.0, 370.0, 30.0, 40.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 160.0, 10.0, 40.0, 40.0, 70.0, 90.0, 95.0, 70.0, 50.0, 280.0, 40.0, 130.0, 110.0, 50.0, 180.0, 380.0, 140.0, 140.0, 80.0, 300.0, 60.0, 90.0, 150.0, 100.0, 60.0, 80.0, 0.0, 0.0, 0.0, 0.0, 50.0, 30.0, 25.0, 50.0, 0.0, 40.0, 120.0, 40.0, 50.0, 30.0, 130.0, 90.0, 20.0, 50.0, 80.0, 80.0, 270.0, 150.0, 125.0, 120.0, 180.0, 190.0, 320.0, 70.0, 70.0, 60.0, 330.0, 70.0, -20.0, -10.0, 40.0, -90.0, 510.0, 70.0, 70.0, 50.0, 20.0, 130.0, 120.0, 40.0, 30.0, 0.0, 30.0, 180.0, 70.0, 170.0, 310.0, 10.0, 340.0, 150.0, 80.0, 50.0, 20.0, 190.0, 50.0, 210.0, 60.0, 130.0, 120.0, -30.0, 70.0, 60.0, 270.0, 40.0, 190.0, 30.0, 350.0, 500.0, 10.0, 50.0, 80.0, 50.0, 0.0, 360.0, 510.0, 110.0, 70.0, -90.0, 0.0, 60.0, 70.0, 0.0, 0.0, 10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0, 90.0, 0.0, 230.0, -10.0, 20.0, -5.0, 20.0, 490.0, 0.0, 5.0, 150.0, 60.0, 90.0, 90.0, 0.0, 20.0, 20.0, 310.0, 70.0, 20.0, 50.0, 370.0, 30.0, 25.0, 10.0, 10.0, 40.0, 90.0, 160.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 50.0, 20.0, 170.0, 20.0, 30.0, 90.0, 10.0, 40.0, 20.0, 40.0, 50.0, 380.0, 40.0, 100.0, 50.0, 300.0, 80.0, 40.0, 700.0, -30.0, 130.0, 90.0, -115.0, 70.0, 290.0, 210.0, 90.0, 80.0, 540.0, 30.0, 130.0, 45.0, 350.0, 200.0, 60.0, 70.0, 60.0, 20.0, 20.0, 250.0, 50.0, 60.0, 40.0, 15.0, 40.0, 230.0, 60.0, 80.0, 70.0, 120.0, 250.0, 90.0, 80.0, 70.0, 70.0, 10.0, 100.0, 130.0, 280.0, 150.0, 80.0, 10.0, 0.0, 50.0, 20.0, 110.0, 100.0, 370.0, 100.0, 100.0, 80.0, 70.0, 150.0, 100.0, 100.0, 20.0, 30.0, 10.0, 80.0, 30.0, 50.0, 50.0, 130.0, 80.0, 50.0, 70.0, 80.0, 110.0, 100.0, 130.0, 30.0, 80.0, 220.0, 440.0, 90.0, 130.0, 160.0, 90.0, 30.0, 200.0, -5.0, 70.0, 35.0, 410.0, 40.0, 40.0, 50.0, 20.0, -35.0, -20.0, -75.0, 270.0, 150.0, 190.0, 70.0, 120.0, 10.0, 60.0, 350.0, 20.0, 10.0, 20.0, 50.0, 30.0, 120.0, 100.0, 170.0, 230.0, 35.0, 60.0, 65.0, 140.0, 110.0, 120.0, 100.0, 170.0, 70.0, 10.0, 160.0, 35.0, 10.0, 30.0, 110.0, -15.0, 30.0, 90.0, -30.0, 100.0, 360.0, 70.0, 80.0, 80.0, 0.0, 170.0, 110.0, 0.0, 10.0, 220.0, 160.0, 20.0, 70.0, 10.0, 120.0, 100.0, 50.0, 30.0, 70.0, 40.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 35.0, 110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0, 350.0, 120.0, 100.0, -30.0, 260.0, 110.0, 320.0, 110.0, 110.0, 80.0, 20.0, 40.0, 20.0, 50.0, 40.0, 190.0, 50.0, 30.0, 120.0, 20.0, 0.0, 50.0, 60.0, 90.0, 90.0, 10.0, 30.0, 70.0, 5.0, 0.0, 360.0, 160.0, 20.0, 100.0, 100.0, 360.0, 10.0, 280.0, 195.0, 110.0, 20.0, 170.0, 60.0, 20.0, 290.0, 170.0, 20.0, 40.0, 40.0, 30.0, 50.0, 10.0, 370.0, -20.0, 320.0, 30.0, -30.0, 0.0, 35.0, 40.0, 30.0, 420.0, 120.0, 65.0, 100.0, 100.0, 160.0, 15.0, 20.0, 150.0, 290.0, 10.0, 180.0, 30.0, 20.0, 250.0, 250.0, 80.0, 130.0, 50.0, 110.0, 270.0, 90.0, 30.0, 160.0, -35.0, 110.0, 15.0, 110.0, 130.0, 210.0, 60.0, 0.0, 290.0, 290.0, 260.0, 0.0, 200.0, -90.0, 60.0, 10.0, 170.0, 85.0, 150.0, 70.0, 150.0, 90.0, 300.0, 10.0, -5.0, 70.0, 110.0, 100.0, 70.0, 110.0, 210.0, 180.0, 160.0, 140.0, 40.0, -10.0, 160.0, -35.0, -30.0, -25.0, 70.0, 310.0, 250.0, 80.0, 70.0, 200.0, 70.0, 40.0, -30.0, 10.0, 60.0, 100.0, 140.0, 30.0, 0.0, 130.0, 60.0, 10.0, 90.0, 100.0, 110.0, 60.0, 10.0, 40.0, 50.0, -15.0, 80.0, -40.0, 230.0, -20.0, 70.0, -50.0, 160.0, 60.0, 310.0, 370.0, 60.0, 0.0, -45.0, 80.0, 50.0, 70.0, 100.0, 150.0, 30.0, 70.0, 55.0, 270.0, 90.0, 300.0, 70.0, 190.0, 190.0, 10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5463991429436437, "mean_inference_ms": 1.4147105370008226, "mean_action_processing_ms": 0.46302794279390674, "mean_env_wait_ms": 1.2595439092334801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012410163879394531, "StateBufferConnector_ms": 0.009514093399047852, "ViewRequirementAgentConnector_ms": 0.3814280033111572}, "num_episodes": 18, "episode_return_max": 1735.0, "episode_return_min": 225.0, "episode_return_mean": 890.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.18302230991378, "num_env_steps_trained_throughput_per_sec": 21.18302230991378, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 189515.655, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189515.609, "sample_time_ms": 2730.413, "learn_time_ms": 186765.895, "learn_throughput": 21.417, "synch_weights_time_ms": 11.009}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "33e63_00000", "date": "2024-06-19_00-21-30", "timestamp": 1718770890, "time_this_iter_s": 188.8388228416443, "time_total_s": 11672.750843763351, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276f5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11672.750843763351, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 21.427715355805248, "ram_util_percent": 79.43220973782772}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.307921260373153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.669195502202986, "policy_loss": -0.009258944287556952, "vf_loss": 7.677118123555209, "vf_explained_var": -0.0006330323358948112, "kl": 0.0066816161835356325, "entropy": 0.4845120088678325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 1735.0, "episode_reward_min": 225.0, "episode_reward_mean": 949.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 94.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1405.0, 430.0, 475.0, 570.0, 415.0, 1230.0, 1370.0, 475.0, 340.0, 645.0, 1470.0, 1025.0, 725.0, 1190.0, 960.0, 555.0, 920.0, 1310.0, 750.0, 225.0, 560.0, 500.0, 960.0, 790.0, 340.0, 975.0, 1570.0, 345.0, 570.0, 1565.0, 1030.0, 560.0, 1380.0, 1130.0, 1300.0, 1090.0, 745.0, 840.0, 830.0, 805.0, 430.0, 820.0, 1555.0, 1735.0, 625.0, 1120.0, 830.0, 1280.0, 530.0, 1350.0, 1160.0, 660.0, 790.0, 1130.0, 610.0, 1030.0, 760.0, 295.0, 960.0, 1530.0, 580.0, 405.0, 1695.0, 860.0, 805.0, 1180.0, 1290.0, 990.0, 1280.0, 1030.0, 1190.0, 840.0, 620.0, 660.0, 785.0, 865.0, 1295.0, 1090.0, 1200.0, 1145.0, 680.0, 1070.0, 1330.0, 1510.0, 805.0, 790.0, 1130.0, 810.0, 830.0, 955.0, 1170.0, 835.0, 875.0, 720.0, 1390.0, 1235.0, 1330.0, 1195.0, 1230.0, 1710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, -10.0, 180.0, 480.0, -50.0, 310.0, 85.0, 30.0, 240.0, 30.0, 70.0, 55.0, 45.0, -30.0, 0.0, 10.0, 20.0, 130.0, 90.0, 40.0, 110.0, 20.0, -30.0, 20.0, 30.0, 180.0, 30.0, 0.0, 130.0, -15.0, 10.0, 0.0, 80.0, 40.0, 10.0, 30.0, 20.0, 270.0, 70.0, 40.0, 25.0, 25.0, 5.0, 10.0, 110.0, 60.0, 10.0, 40.0, 120.0, 10.0, 60.0, 70.0, -40.0, -50.0, 530.0, 40.0, 50.0, 200.0, 300.0, 70.0, 80.0, 320.0, 260.0, 180.0, 140.0, -20.0, 110.0, 50.0, 90.0, 160.0, 30.0, 70.0, 15.0, 70.0, 30.0, 30.0, 70.0, 70.0, 40.0, 50.0, 20.0, 50.0, 50.0, 0.0, 80.0, 40.0, 0.0, 0.0, 60.0, 40.0, 270.0, -100.0, 30.0, 30.0, 170.0, 80.0, 140.0, 20.0, -5.0, 10.0, 240.0, 150.0, 70.0, -105.0, 240.0, 90.0, 255.0, 460.0, 50.0, 20.0, 220.0, 150.0, 70.0, 90.0, 45.0, 10.0, 120.0, 240.0, 20.0, 60.0, 40.0, 20.0, 80.0, 30.0, 145.0, 300.0, 80.0, -15.0, 45.0, 0.0, 30.0, 20.0, 90.0, 290.0, 460.0, -20.0, 50.0, -20.0, 50.0, 240.0, 50.0, 10.0, 160.0, 30.0, 110.0, 70.0, 70.0, 270.0, 20.0, 170.0, 20.0, 30.0, -50.0, 160.0, 10.0, 20.0, -90.0, 160.0, 55.0, 240.0, 30.0, -40.0, 40.0, 60.0, 380.0, 110.0, 50.0, 260.0, 20.0, 10.0, 20.0, 330.0, 190.0, 10.0, 120.0, 320.0, -30.0, 60.0, 250.0, 40.0, 40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 45.0, 0.0, 100.0, 160.0, 40.0, 60.0, 90.0, 50.0, 0.0, 40.0, 0.0, 20.0, 100.0, 120.0, 190.0, 10.0, 10.0, 20.0, 30.0, -90.0, 70.0, 40.0, 60.0, 50.0, -30.0, 60.0, 150.0, 460.0, 80.0, 10.0, 70.0, 50.0, 30.0, -20.0, 10.0, 40.0, 20.0, 150.0, 40.0, 120.0, 370.0, 30.0, 40.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 160.0, 10.0, 40.0, 40.0, 70.0, 90.0, 95.0, 70.0, 50.0, 280.0, 40.0, 130.0, 110.0, 50.0, 180.0, 380.0, 140.0, 140.0, 80.0, 300.0, 60.0, 90.0, 150.0, 100.0, 60.0, 80.0, 0.0, 0.0, 0.0, 0.0, 50.0, 30.0, 25.0, 50.0, 0.0, 40.0, 120.0, 40.0, 50.0, 30.0, 130.0, 90.0, 20.0, 50.0, 80.0, 80.0, 270.0, 150.0, 125.0, 120.0, 180.0, 190.0, 320.0, 70.0, 70.0, 60.0, 330.0, 70.0, -20.0, -10.0, 40.0, -90.0, 510.0, 70.0, 70.0, 50.0, 20.0, 130.0, 120.0, 40.0, 30.0, 0.0, 30.0, 180.0, 70.0, 170.0, 310.0, 10.0, 340.0, 150.0, 80.0, 50.0, 20.0, 190.0, 50.0, 210.0, 60.0, 130.0, 120.0, -30.0, 70.0, 60.0, 270.0, 40.0, 190.0, 30.0, 350.0, 500.0, 10.0, 50.0, 80.0, 50.0, 0.0, 360.0, 510.0, 110.0, 70.0, -90.0, 0.0, 60.0, 70.0, 0.0, 0.0, 10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0, 90.0, 0.0, 230.0, -10.0, 20.0, -5.0, 20.0, 490.0, 0.0, 5.0, 150.0, 60.0, 90.0, 90.0, 0.0, 20.0, 20.0, 310.0, 70.0, 20.0, 50.0, 370.0, 30.0, 25.0, 10.0, 10.0, 40.0, 90.0, 160.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 50.0, 20.0, 170.0, 20.0, 30.0, 90.0, 10.0, 40.0, 20.0, 40.0, 50.0, 380.0, 40.0, 100.0, 50.0, 300.0, 80.0, 40.0, 700.0, -30.0, 130.0, 90.0, -115.0, 70.0, 290.0, 210.0, 90.0, 80.0, 540.0, 30.0, 130.0, 45.0, 350.0, 200.0, 60.0, 70.0, 60.0, 20.0, 20.0, 250.0, 50.0, 60.0, 40.0, 15.0, 40.0, 230.0, 60.0, 80.0, 70.0, 120.0, 250.0, 90.0, 80.0, 70.0, 70.0, 10.0, 100.0, 130.0, 280.0, 150.0, 80.0, 10.0, 0.0, 50.0, 20.0, 110.0, 100.0, 370.0, 100.0, 100.0, 80.0, 70.0, 150.0, 100.0, 100.0, 20.0, 30.0, 10.0, 80.0, 30.0, 50.0, 50.0, 130.0, 80.0, 50.0, 70.0, 80.0, 110.0, 100.0, 130.0, 30.0, 80.0, 220.0, 440.0, 90.0, 130.0, 160.0, 90.0, 30.0, 200.0, -5.0, 70.0, 35.0, 410.0, 40.0, 40.0, 50.0, 20.0, -35.0, -20.0, -75.0, 270.0, 150.0, 190.0, 70.0, 120.0, 10.0, 60.0, 350.0, 20.0, 10.0, 20.0, 50.0, 30.0, 120.0, 100.0, 170.0, 230.0, 35.0, 60.0, 65.0, 140.0, 110.0, 120.0, 100.0, 170.0, 70.0, 10.0, 160.0, 35.0, 10.0, 30.0, 110.0, -15.0, 30.0, 90.0, -30.0, 100.0, 360.0, 70.0, 80.0, 80.0, 0.0, 170.0, 110.0, 0.0, 10.0, 220.0, 160.0, 20.0, 70.0, 10.0, 120.0, 100.0, 50.0, 30.0, 70.0, 40.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 35.0, 110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0, 350.0, 120.0, 100.0, -30.0, 260.0, 110.0, 320.0, 110.0, 110.0, 80.0, 20.0, 40.0, 20.0, 50.0, 40.0, 190.0, 50.0, 30.0, 120.0, 20.0, 0.0, 50.0, 60.0, 90.0, 90.0, 10.0, 30.0, 70.0, 5.0, 0.0, 360.0, 160.0, 20.0, 100.0, 100.0, 360.0, 10.0, 280.0, 195.0, 110.0, 20.0, 170.0, 60.0, 20.0, 290.0, 170.0, 20.0, 40.0, 40.0, 30.0, 50.0, 10.0, 370.0, -20.0, 320.0, 30.0, -30.0, 0.0, 35.0, 40.0, 30.0, 420.0, 120.0, 65.0, 100.0, 100.0, 160.0, 15.0, 20.0, 150.0, 290.0, 10.0, 180.0, 30.0, 20.0, 250.0, 250.0, 80.0, 130.0, 50.0, 110.0, 270.0, 90.0, 30.0, 160.0, -35.0, 110.0, 15.0, 110.0, 130.0, 210.0, 60.0, 0.0, 290.0, 290.0, 260.0, 0.0, 200.0, -90.0, 60.0, 10.0, 170.0, 85.0, 150.0, 70.0, 150.0, 90.0, 300.0, 10.0, -5.0, 70.0, 110.0, 100.0, 70.0, 110.0, 210.0, 180.0, 160.0, 140.0, 40.0, -10.0, 160.0, -35.0, -30.0, -25.0, 70.0, 310.0, 250.0, 80.0, 70.0, 200.0, 70.0, 40.0, -30.0, 10.0, 60.0, 100.0, 140.0, 30.0, 0.0, 130.0, 60.0, 10.0, 90.0, 100.0, 110.0, 60.0, 10.0, 40.0, 50.0, -15.0, 80.0, -40.0, 230.0, -20.0, 70.0, -50.0, 160.0, 60.0, 310.0, 370.0, 60.0, 0.0, -45.0, 80.0, 50.0, 70.0, 100.0, 150.0, 30.0, 70.0, 55.0, 270.0, 90.0, 300.0, 70.0, 190.0, 190.0, 10.0, 50.0, 40.0, 10.0, 60.0, 40.0, 70.0, 150.0, 340.0, 200.0, 60.0, 120.0, 110.0, 40.0, 40.0, 30.0, 400.0, 90.0, 180.0, 60.0, 50.0, 200.0, 80.0, 70.0, 50.0, 185.0, 90.0, 140.0, 110.0, 340.0, 30.0, 50.0, 150.0, 110.0, -105.0, 120.0, 80.0, 90.0, 30.0, 140.0, 25.0, 40.0, 40.0, 0.0, 150.0, 200.0, 30.0, 80.0, 240.0, 140.0, 140.0, 50.0, 40.0, 90.0, 10.0, 80.0, 160.0, -20.0, -30.0, 520.0, 440.0, 40.0, 320.0, 0.0, -10.0, 470.0, 40.0, 80.0, 10.0, 100.0, 440.0, 60.0, 130.0, 10.0, 330.0, -20.0, 180.0, 0.0, 50.0, 60.0, 55.0, 10.0, 0.0, 100.0, 50.0, 40.0, 50.0, 140.0, 10.0, 190.0, 180.0, 30.0, 30.0, 60.0, 100.0, 120.0, 200.0, 160.0, 50.0, 60.0, 260.0, 90.0, 50.0, 110.0, 0.0, 10.0, 160.0, 0.0, 60.0, 310.0, 60.0, 50.0, 100.0, 70.0, 60.0, 60.0, 30.0, 40.0, 30.0, 170.0, 30.0, 240.0, 35.0, -50.0, 50.0, 70.0, 120.0, 200.0, 80.0, 320.0, 100.0, 30.0, 160.0, 0.0, 100.0, 160.0, 150.0, 250.0, -20.0, -60.0, 70.0, 360.0, 90.0, 120.0, 80.0, 70.0, 160.0, 65.0, 110.0, 10.0, 30.0, 100.0, 0.0, 185.0, 100.0, 90.0, 40.0, 50.0, 60.0, 70.0, 260.0, 20.0, 30.0, 50.0, 50.0, 50.0, 30.0, 40.0, 160.0, 50.0, 250.0, 10.0, 120.0, 380.0, 200.0, 50.0, 100.0, 30.0, 90.0, 280.0, 80.0, 60.0, 0.0, 145.0, -30.0, 340.0, -30.0, 40.0, 70.0, 150.0, 400.0, 150.0, 20.0, 110.0, 270.0, 500.0, 70.0, 40.0, -10.0, 170.0, 100.0, 60.0, 70.0, 40.0, 190.0, 160.0, 75.0, 300.0, -20.0, 80.0, 170.0, 130.0, -10.0, 180.0, 130.0, 170.0, 50.0, 70.0, 110.0, 100.0, 130.0, 300.0, 120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5462432951546057, "mean_inference_ms": 1.4159465755410678, "mean_action_processing_ms": 0.4619113815903971, "mean_env_wait_ms": 1.259724669923546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01296854019165039, "StateBufferConnector_ms": 0.009688138961791992, "ViewRequirementAgentConnector_ms": 0.38240528106689453}, "num_episodes": 23, "episode_return_max": 1735.0, "episode_return_min": 225.0, "episode_return_mean": 949.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.22036369838733, "num_env_steps_trained_throughput_per_sec": 21.22036369838733, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 189744.587, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189744.542, "sample_time_ms": 2748.463, "learn_time_ms": 186976.763, "learn_throughput": 21.393, "synch_weights_time_ms": 11.108}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "33e63_00000", "date": "2024-06-19_00-24-38", "timestamp": 1718771078, "time_this_iter_s": 188.53128170967102, "time_total_s": 11861.282125473022, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11861.282125473022, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.149248120300754, "ram_util_percent": 79.73909774436089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2775794598114247, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.672810946841336, "policy_loss": -0.009025668944762791, "vf_loss": 6.6804740920996135, "vf_explained_var": -0.0011664014845229565, "kl": 0.0068126388309531945, "entropy": 0.5257332681308285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 1735.0, "episode_reward_min": 225.0, "episode_reward_mean": 949.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 94.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [750.0, 225.0, 560.0, 500.0, 960.0, 790.0, 340.0, 975.0, 1570.0, 345.0, 570.0, 1565.0, 1030.0, 560.0, 1380.0, 1130.0, 1300.0, 1090.0, 745.0, 840.0, 830.0, 805.0, 430.0, 820.0, 1555.0, 1735.0, 625.0, 1120.0, 830.0, 1280.0, 530.0, 1350.0, 1160.0, 660.0, 790.0, 1130.0, 610.0, 1030.0, 760.0, 295.0, 960.0, 1530.0, 580.0, 405.0, 1695.0, 860.0, 805.0, 1180.0, 1290.0, 990.0, 1280.0, 1030.0, 1190.0, 840.0, 620.0, 660.0, 785.0, 865.0, 1295.0, 1090.0, 1200.0, 1145.0, 680.0, 1070.0, 1330.0, 1510.0, 805.0, 790.0, 1130.0, 810.0, 830.0, 955.0, 1170.0, 835.0, 875.0, 720.0, 1390.0, 1235.0, 1330.0, 1195.0, 1230.0, 1710.0, 530.0, 740.0, 920.0, 865.0, 885.0, 930.0, 1180.0, 510.0, 1365.0, 1255.0, 455.0, 1280.0, 340.0, 1695.0, 910.0, 450.0, 485.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -30.0, 60.0, -10.0, 130.0, 170.0, 20.0, 110.0, 170.0, 90.0, 50.0, 40.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 45.0, 0.0, 100.0, 160.0, 40.0, 60.0, 90.0, 50.0, 0.0, 40.0, 0.0, 20.0, 100.0, 120.0, 190.0, 10.0, 10.0, 20.0, 30.0, -90.0, 70.0, 40.0, 60.0, 50.0, -30.0, 60.0, 150.0, 460.0, 80.0, 10.0, 70.0, 50.0, 30.0, -20.0, 10.0, 40.0, 20.0, 150.0, 40.0, 120.0, 370.0, 30.0, 40.0, 0.0, 10.0, 0.0, 40.0, 30.0, 10.0, 160.0, 10.0, 40.0, 40.0, 70.0, 90.0, 95.0, 70.0, 50.0, 280.0, 40.0, 130.0, 110.0, 50.0, 180.0, 380.0, 140.0, 140.0, 80.0, 300.0, 60.0, 90.0, 150.0, 100.0, 60.0, 80.0, 0.0, 0.0, 0.0, 0.0, 50.0, 30.0, 25.0, 50.0, 0.0, 40.0, 120.0, 40.0, 50.0, 30.0, 130.0, 90.0, 20.0, 50.0, 80.0, 80.0, 270.0, 150.0, 125.0, 120.0, 180.0, 190.0, 320.0, 70.0, 70.0, 60.0, 330.0, 70.0, -20.0, -10.0, 40.0, -90.0, 510.0, 70.0, 70.0, 50.0, 20.0, 130.0, 120.0, 40.0, 30.0, 0.0, 30.0, 180.0, 70.0, 170.0, 310.0, 10.0, 340.0, 150.0, 80.0, 50.0, 20.0, 190.0, 50.0, 210.0, 60.0, 130.0, 120.0, -30.0, 70.0, 60.0, 270.0, 40.0, 190.0, 30.0, 350.0, 500.0, 10.0, 50.0, 80.0, 50.0, 0.0, 360.0, 510.0, 110.0, 70.0, -90.0, 0.0, 60.0, 70.0, 0.0, 0.0, 10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0, 90.0, 0.0, 230.0, -10.0, 20.0, -5.0, 20.0, 490.0, 0.0, 5.0, 150.0, 60.0, 90.0, 90.0, 0.0, 20.0, 20.0, 310.0, 70.0, 20.0, 50.0, 370.0, 30.0, 25.0, 10.0, 10.0, 40.0, 90.0, 160.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 50.0, 20.0, 170.0, 20.0, 30.0, 90.0, 10.0, 40.0, 20.0, 40.0, 50.0, 380.0, 40.0, 100.0, 50.0, 300.0, 80.0, 40.0, 700.0, -30.0, 130.0, 90.0, -115.0, 70.0, 290.0, 210.0, 90.0, 80.0, 540.0, 30.0, 130.0, 45.0, 350.0, 200.0, 60.0, 70.0, 60.0, 20.0, 20.0, 250.0, 50.0, 60.0, 40.0, 15.0, 40.0, 230.0, 60.0, 80.0, 70.0, 120.0, 250.0, 90.0, 80.0, 70.0, 70.0, 10.0, 100.0, 130.0, 280.0, 150.0, 80.0, 10.0, 0.0, 50.0, 20.0, 110.0, 100.0, 370.0, 100.0, 100.0, 80.0, 70.0, 150.0, 100.0, 100.0, 20.0, 30.0, 10.0, 80.0, 30.0, 50.0, 50.0, 130.0, 80.0, 50.0, 70.0, 80.0, 110.0, 100.0, 130.0, 30.0, 80.0, 220.0, 440.0, 90.0, 130.0, 160.0, 90.0, 30.0, 200.0, -5.0, 70.0, 35.0, 410.0, 40.0, 40.0, 50.0, 20.0, -35.0, -20.0, -75.0, 270.0, 150.0, 190.0, 70.0, 120.0, 10.0, 60.0, 350.0, 20.0, 10.0, 20.0, 50.0, 30.0, 120.0, 100.0, 170.0, 230.0, 35.0, 60.0, 65.0, 140.0, 110.0, 120.0, 100.0, 170.0, 70.0, 10.0, 160.0, 35.0, 10.0, 30.0, 110.0, -15.0, 30.0, 90.0, -30.0, 100.0, 360.0, 70.0, 80.0, 80.0, 0.0, 170.0, 110.0, 0.0, 10.0, 220.0, 160.0, 20.0, 70.0, 10.0, 120.0, 100.0, 50.0, 30.0, 70.0, 40.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 35.0, 110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0, 350.0, 120.0, 100.0, -30.0, 260.0, 110.0, 320.0, 110.0, 110.0, 80.0, 20.0, 40.0, 20.0, 50.0, 40.0, 190.0, 50.0, 30.0, 120.0, 20.0, 0.0, 50.0, 60.0, 90.0, 90.0, 10.0, 30.0, 70.0, 5.0, 0.0, 360.0, 160.0, 20.0, 100.0, 100.0, 360.0, 10.0, 280.0, 195.0, 110.0, 20.0, 170.0, 60.0, 20.0, 290.0, 170.0, 20.0, 40.0, 40.0, 30.0, 50.0, 10.0, 370.0, -20.0, 320.0, 30.0, -30.0, 0.0, 35.0, 40.0, 30.0, 420.0, 120.0, 65.0, 100.0, 100.0, 160.0, 15.0, 20.0, 150.0, 290.0, 10.0, 180.0, 30.0, 20.0, 250.0, 250.0, 80.0, 130.0, 50.0, 110.0, 270.0, 90.0, 30.0, 160.0, -35.0, 110.0, 15.0, 110.0, 130.0, 210.0, 60.0, 0.0, 290.0, 290.0, 260.0, 0.0, 200.0, -90.0, 60.0, 10.0, 170.0, 85.0, 150.0, 70.0, 150.0, 90.0, 300.0, 10.0, -5.0, 70.0, 110.0, 100.0, 70.0, 110.0, 210.0, 180.0, 160.0, 140.0, 40.0, -10.0, 160.0, -35.0, -30.0, -25.0, 70.0, 310.0, 250.0, 80.0, 70.0, 200.0, 70.0, 40.0, -30.0, 10.0, 60.0, 100.0, 140.0, 30.0, 0.0, 130.0, 60.0, 10.0, 90.0, 100.0, 110.0, 60.0, 10.0, 40.0, 50.0, -15.0, 80.0, -40.0, 230.0, -20.0, 70.0, -50.0, 160.0, 60.0, 310.0, 370.0, 60.0, 0.0, -45.0, 80.0, 50.0, 70.0, 100.0, 150.0, 30.0, 70.0, 55.0, 270.0, 90.0, 300.0, 70.0, 190.0, 190.0, 10.0, 50.0, 40.0, 10.0, 60.0, 40.0, 70.0, 150.0, 340.0, 200.0, 60.0, 120.0, 110.0, 40.0, 40.0, 30.0, 400.0, 90.0, 180.0, 60.0, 50.0, 200.0, 80.0, 70.0, 50.0, 185.0, 90.0, 140.0, 110.0, 340.0, 30.0, 50.0, 150.0, 110.0, -105.0, 120.0, 80.0, 90.0, 30.0, 140.0, 25.0, 40.0, 40.0, 0.0, 150.0, 200.0, 30.0, 80.0, 240.0, 140.0, 140.0, 50.0, 40.0, 90.0, 10.0, 80.0, 160.0, -20.0, -30.0, 520.0, 440.0, 40.0, 320.0, 0.0, -10.0, 470.0, 40.0, 80.0, 10.0, 100.0, 440.0, 60.0, 130.0, 10.0, 330.0, -20.0, 180.0, 0.0, 50.0, 60.0, 55.0, 10.0, 0.0, 100.0, 50.0, 40.0, 50.0, 140.0, 10.0, 190.0, 180.0, 30.0, 30.0, 60.0, 100.0, 120.0, 200.0, 160.0, 50.0, 60.0, 260.0, 90.0, 50.0, 110.0, 0.0, 10.0, 160.0, 0.0, 60.0, 310.0, 60.0, 50.0, 100.0, 70.0, 60.0, 60.0, 30.0, 40.0, 30.0, 170.0, 30.0, 240.0, 35.0, -50.0, 50.0, 70.0, 120.0, 200.0, 80.0, 320.0, 100.0, 30.0, 160.0, 0.0, 100.0, 160.0, 150.0, 250.0, -20.0, -60.0, 70.0, 360.0, 90.0, 120.0, 80.0, 70.0, 160.0, 65.0, 110.0, 10.0, 30.0, 100.0, 0.0, 185.0, 100.0, 90.0, 40.0, 50.0, 60.0, 70.0, 260.0, 20.0, 30.0, 50.0, 50.0, 50.0, 30.0, 40.0, 160.0, 50.0, 250.0, 10.0, 120.0, 380.0, 200.0, 50.0, 100.0, 30.0, 90.0, 280.0, 80.0, 60.0, 0.0, 145.0, -30.0, 340.0, -30.0, 40.0, 70.0, 150.0, 400.0, 150.0, 20.0, 110.0, 270.0, 500.0, 70.0, 40.0, -10.0, 170.0, 100.0, 60.0, 70.0, 40.0, 190.0, 160.0, 75.0, 300.0, -20.0, 80.0, 170.0, 130.0, -10.0, 180.0, 130.0, 170.0, 50.0, 70.0, 110.0, 100.0, 130.0, 300.0, 120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0, 60.0, 100.0, -50.0, 40.0, -50.0, 350.0, 0.0, 10.0, 120.0, -50.0, 220.0, 20.0, 10.0, 80.0, 40.0, 90.0, 40.0, 70.0, 80.0, 90.0, 10.0, 90.0, 80.0, 100.0, 100.0, 370.0, 40.0, 60.0, 90.0, -20.0, 90.0, 10.0, 110.0, 350.0, 45.0, 120.0, 10.0, 20.0, 40.0, 70.0, 130.0, 80.0, 190.0, 80.0, -40.0, 150.0, 105.0, -30.0, 190.0, 30.0, 40.0, 120.0, 30.0, 30.0, 90.0, -30.0, 70.0, 270.0, 110.0, 200.0, 10.0, 570.0, 180.0, 100.0, 30.0, 50.0, 60.0, 90.0, 50.0, 40.0, 40.0, 90.0, 40.0, 50.0, 20.0, 20.0, 40.0, 190.0, 20.0, 0.0, 20.0, 130.0, 240.0, 10.0, 50.0, 130.0, 80.0, 110.0, 560.0, 35.0, 300.0, 110.0, -20.0, 55.0, 120.0, 70.0, 440.0, 80.0, 60.0, 40.0, -45.0, 140.0, -40.0, 60.0, 10.0, 60.0, 10.0, 190.0, 40.0, 30.0, 230.0, 60.0, 140.0, 30.0, 270.0, 60.0, 70.0, 210.0, 100.0, 110.0, 100.0, 40.0, 60.0, 20.0, 30.0, 10.0, 0.0, 60.0, 0.0, 20.0, 25.0, 560.0, 90.0, 70.0, 90.0, 440.0, 30.0, 150.0, 180.0, 60.0, 80.0, 50.0, 250.0, 110.0, 10.0, 240.0, 30.0, 0.0, 80.0, 60.0, 30.0, 10.0, 300.0, 20.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 100.0, -5.0, 10.0, 80.0, 80.0, 40.0, 30.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5460612808705616, "mean_inference_ms": 1.416932804976692, "mean_action_processing_ms": 0.4609041633033895, "mean_env_wait_ms": 1.259897703044159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01328587532043457, "StateBufferConnector_ms": 0.009691476821899414, "ViewRequirementAgentConnector_ms": 0.3818345069885254}, "num_episodes": 18, "episode_return_max": 1735.0, "episode_return_min": 225.0, "episode_return_mean": 949.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.245645580418152, "num_env_steps_trained_throughput_per_sec": 21.245645580418152, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 189470.803, "restore_workers_time_ms": 0.013, "training_step_time_ms": 189470.757, "sample_time_ms": 2746.082, "learn_time_ms": 186705.466, "learn_throughput": 21.424, "synch_weights_time_ms": 11.041}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "33e63_00000", "date": "2024-06-19_00-27-47", "timestamp": 1718771267, "time_this_iter_s": 188.28384280204773, "time_total_s": 12049.56596827507, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12049.56596827507, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 18.11385767790262, "ram_util_percent": 79.94082397003746}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.305370197864894, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.375474796356103, "policy_loss": -0.009203748512319839, "vf_loss": 7.383314714645045, "vf_explained_var": -9.542212953455785e-05, "kl": 0.006819145766041716, "entropy": 0.4707490997636915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 1735.0, "episode_reward_min": 295.0, "episode_reward_mean": 964.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -115.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 96.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [745.0, 840.0, 830.0, 805.0, 430.0, 820.0, 1555.0, 1735.0, 625.0, 1120.0, 830.0, 1280.0, 530.0, 1350.0, 1160.0, 660.0, 790.0, 1130.0, 610.0, 1030.0, 760.0, 295.0, 960.0, 1530.0, 580.0, 405.0, 1695.0, 860.0, 805.0, 1180.0, 1290.0, 990.0, 1280.0, 1030.0, 1190.0, 840.0, 620.0, 660.0, 785.0, 865.0, 1295.0, 1090.0, 1200.0, 1145.0, 680.0, 1070.0, 1330.0, 1510.0, 805.0, 790.0, 1130.0, 810.0, 830.0, 955.0, 1170.0, 835.0, 875.0, 720.0, 1390.0, 1235.0, 1330.0, 1195.0, 1230.0, 1710.0, 530.0, 740.0, 920.0, 865.0, 885.0, 930.0, 1180.0, 510.0, 1365.0, 1255.0, 455.0, 1280.0, 340.0, 1695.0, 910.0, 450.0, 485.0, 690.0, 665.0, 470.0, 705.0, 1020.0, 470.0, 800.0, 800.0, 880.0, 1315.0, 1250.0, 1190.0, 1480.0, 670.0, 1110.0, 665.0, 1650.0, 1010.0, 975.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 35.0, 40.0, 60.0, 0.0, 20.0, 190.0, 40.0, 310.0, 40.0, 90.0, 0.0, 230.0, -10.0, 20.0, -5.0, 20.0, 490.0, 0.0, 5.0, 150.0, 60.0, 90.0, 90.0, 0.0, 20.0, 20.0, 310.0, 70.0, 20.0, 50.0, 370.0, 30.0, 25.0, 10.0, 10.0, 40.0, 90.0, 160.0, 20.0, 20.0, 40.0, 20.0, 40.0, 20.0, 50.0, 20.0, 170.0, 20.0, 30.0, 90.0, 10.0, 40.0, 20.0, 40.0, 50.0, 380.0, 40.0, 100.0, 50.0, 300.0, 80.0, 40.0, 700.0, -30.0, 130.0, 90.0, -115.0, 70.0, 290.0, 210.0, 90.0, 80.0, 540.0, 30.0, 130.0, 45.0, 350.0, 200.0, 60.0, 70.0, 60.0, 20.0, 20.0, 250.0, 50.0, 60.0, 40.0, 15.0, 40.0, 230.0, 60.0, 80.0, 70.0, 120.0, 250.0, 90.0, 80.0, 70.0, 70.0, 10.0, 100.0, 130.0, 280.0, 150.0, 80.0, 10.0, 0.0, 50.0, 20.0, 110.0, 100.0, 370.0, 100.0, 100.0, 80.0, 70.0, 150.0, 100.0, 100.0, 20.0, 30.0, 10.0, 80.0, 30.0, 50.0, 50.0, 130.0, 80.0, 50.0, 70.0, 80.0, 110.0, 100.0, 130.0, 30.0, 80.0, 220.0, 440.0, 90.0, 130.0, 160.0, 90.0, 30.0, 200.0, -5.0, 70.0, 35.0, 410.0, 40.0, 40.0, 50.0, 20.0, -35.0, -20.0, -75.0, 270.0, 150.0, 190.0, 70.0, 120.0, 10.0, 60.0, 350.0, 20.0, 10.0, 20.0, 50.0, 30.0, 120.0, 100.0, 170.0, 230.0, 35.0, 60.0, 65.0, 140.0, 110.0, 120.0, 100.0, 170.0, 70.0, 10.0, 160.0, 35.0, 10.0, 30.0, 110.0, -15.0, 30.0, 90.0, -30.0, 100.0, 360.0, 70.0, 80.0, 80.0, 0.0, 170.0, 110.0, 0.0, 10.0, 220.0, 160.0, 20.0, 70.0, 10.0, 120.0, 100.0, 50.0, 30.0, 70.0, 40.0, 30.0, 30.0, 10.0, 0.0, 10.0, 40.0, 35.0, 110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0, 350.0, 120.0, 100.0, -30.0, 260.0, 110.0, 320.0, 110.0, 110.0, 80.0, 20.0, 40.0, 20.0, 50.0, 40.0, 190.0, 50.0, 30.0, 120.0, 20.0, 0.0, 50.0, 60.0, 90.0, 90.0, 10.0, 30.0, 70.0, 5.0, 0.0, 360.0, 160.0, 20.0, 100.0, 100.0, 360.0, 10.0, 280.0, 195.0, 110.0, 20.0, 170.0, 60.0, 20.0, 290.0, 170.0, 20.0, 40.0, 40.0, 30.0, 50.0, 10.0, 370.0, -20.0, 320.0, 30.0, -30.0, 0.0, 35.0, 40.0, 30.0, 420.0, 120.0, 65.0, 100.0, 100.0, 160.0, 15.0, 20.0, 150.0, 290.0, 10.0, 180.0, 30.0, 20.0, 250.0, 250.0, 80.0, 130.0, 50.0, 110.0, 270.0, 90.0, 30.0, 160.0, -35.0, 110.0, 15.0, 110.0, 130.0, 210.0, 60.0, 0.0, 290.0, 290.0, 260.0, 0.0, 200.0, -90.0, 60.0, 10.0, 170.0, 85.0, 150.0, 70.0, 150.0, 90.0, 300.0, 10.0, -5.0, 70.0, 110.0, 100.0, 70.0, 110.0, 210.0, 180.0, 160.0, 140.0, 40.0, -10.0, 160.0, -35.0, -30.0, -25.0, 70.0, 310.0, 250.0, 80.0, 70.0, 200.0, 70.0, 40.0, -30.0, 10.0, 60.0, 100.0, 140.0, 30.0, 0.0, 130.0, 60.0, 10.0, 90.0, 100.0, 110.0, 60.0, 10.0, 40.0, 50.0, -15.0, 80.0, -40.0, 230.0, -20.0, 70.0, -50.0, 160.0, 60.0, 310.0, 370.0, 60.0, 0.0, -45.0, 80.0, 50.0, 70.0, 100.0, 150.0, 30.0, 70.0, 55.0, 270.0, 90.0, 300.0, 70.0, 190.0, 190.0, 10.0, 50.0, 40.0, 10.0, 60.0, 40.0, 70.0, 150.0, 340.0, 200.0, 60.0, 120.0, 110.0, 40.0, 40.0, 30.0, 400.0, 90.0, 180.0, 60.0, 50.0, 200.0, 80.0, 70.0, 50.0, 185.0, 90.0, 140.0, 110.0, 340.0, 30.0, 50.0, 150.0, 110.0, -105.0, 120.0, 80.0, 90.0, 30.0, 140.0, 25.0, 40.0, 40.0, 0.0, 150.0, 200.0, 30.0, 80.0, 240.0, 140.0, 140.0, 50.0, 40.0, 90.0, 10.0, 80.0, 160.0, -20.0, -30.0, 520.0, 440.0, 40.0, 320.0, 0.0, -10.0, 470.0, 40.0, 80.0, 10.0, 100.0, 440.0, 60.0, 130.0, 10.0, 330.0, -20.0, 180.0, 0.0, 50.0, 60.0, 55.0, 10.0, 0.0, 100.0, 50.0, 40.0, 50.0, 140.0, 10.0, 190.0, 180.0, 30.0, 30.0, 60.0, 100.0, 120.0, 200.0, 160.0, 50.0, 60.0, 260.0, 90.0, 50.0, 110.0, 0.0, 10.0, 160.0, 0.0, 60.0, 310.0, 60.0, 50.0, 100.0, 70.0, 60.0, 60.0, 30.0, 40.0, 30.0, 170.0, 30.0, 240.0, 35.0, -50.0, 50.0, 70.0, 120.0, 200.0, 80.0, 320.0, 100.0, 30.0, 160.0, 0.0, 100.0, 160.0, 150.0, 250.0, -20.0, -60.0, 70.0, 360.0, 90.0, 120.0, 80.0, 70.0, 160.0, 65.0, 110.0, 10.0, 30.0, 100.0, 0.0, 185.0, 100.0, 90.0, 40.0, 50.0, 60.0, 70.0, 260.0, 20.0, 30.0, 50.0, 50.0, 50.0, 30.0, 40.0, 160.0, 50.0, 250.0, 10.0, 120.0, 380.0, 200.0, 50.0, 100.0, 30.0, 90.0, 280.0, 80.0, 60.0, 0.0, 145.0, -30.0, 340.0, -30.0, 40.0, 70.0, 150.0, 400.0, 150.0, 20.0, 110.0, 270.0, 500.0, 70.0, 40.0, -10.0, 170.0, 100.0, 60.0, 70.0, 40.0, 190.0, 160.0, 75.0, 300.0, -20.0, 80.0, 170.0, 130.0, -10.0, 180.0, 130.0, 170.0, 50.0, 70.0, 110.0, 100.0, 130.0, 300.0, 120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0, 60.0, 100.0, -50.0, 40.0, -50.0, 350.0, 0.0, 10.0, 120.0, -50.0, 220.0, 20.0, 10.0, 80.0, 40.0, 90.0, 40.0, 70.0, 80.0, 90.0, 10.0, 90.0, 80.0, 100.0, 100.0, 370.0, 40.0, 60.0, 90.0, -20.0, 90.0, 10.0, 110.0, 350.0, 45.0, 120.0, 10.0, 20.0, 40.0, 70.0, 130.0, 80.0, 190.0, 80.0, -40.0, 150.0, 105.0, -30.0, 190.0, 30.0, 40.0, 120.0, 30.0, 30.0, 90.0, -30.0, 70.0, 270.0, 110.0, 200.0, 10.0, 570.0, 180.0, 100.0, 30.0, 50.0, 60.0, 90.0, 50.0, 40.0, 40.0, 90.0, 40.0, 50.0, 20.0, 20.0, 40.0, 190.0, 20.0, 0.0, 20.0, 130.0, 240.0, 10.0, 50.0, 130.0, 80.0, 110.0, 560.0, 35.0, 300.0, 110.0, -20.0, 55.0, 120.0, 70.0, 440.0, 80.0, 60.0, 40.0, -45.0, 140.0, -40.0, 60.0, 10.0, 60.0, 10.0, 190.0, 40.0, 30.0, 230.0, 60.0, 140.0, 30.0, 270.0, 60.0, 70.0, 210.0, 100.0, 110.0, 100.0, 40.0, 60.0, 20.0, 30.0, 10.0, 0.0, 60.0, 0.0, 20.0, 25.0, 560.0, 90.0, 70.0, 90.0, 440.0, 30.0, 150.0, 180.0, 60.0, 80.0, 50.0, 250.0, 110.0, 10.0, 240.0, 30.0, 0.0, 80.0, 60.0, 30.0, 10.0, 300.0, 20.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 100.0, -5.0, 10.0, 80.0, 80.0, 40.0, 30.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0, -5.0, 30.0, -50.0, 10.0, 50.0, 30.0, 40.0, 60.0, 40.0, 460.0, 30.0, 0.0, 40.0, 30.0, 30.0, 40.0, 50.0, 20.0, 200.0, 30.0, 100.0, 220.0, 40.0, 40.0, -15.0, 50.0, 110.0, 80.0, 10.0, 70.0, 150.0, 90.0, 260.0, 20.0, -40.0, 70.0, 40.0, 370.0, 60.0, 0.0, 110.0, 30.0, 60.0, 20.0, 0.0, -40.0, 30.0, 50.0, 110.0, 100.0, 20.0, 100.0, 40.0, 260.0, 55.0, 10.0, 90.0, 230.0, 20.0, -25.0, 30.0, 80.0, 50.0, 190.0, 30.0, -10.0, 140.0, 150.0, 130.0, 10.0, -10.0, 110.0, 100.0, 100.0, 30.0, -50.0, 390.0, 20.0, 10.0, 180.0, 170.0, 130.0, 90.0, 150.0, 55.0, 360.0, 120.0, 50.0, 110.0, 80.0, 180.0, 80.0, 110.0, 110.0, 120.0, 180.0, 80.0, 320.0, 40.0, 30.0, 245.0, 160.0, 50.0, 35.0, 400.0, 80.0, -20.0, 80.0, 130.0, 30.0, 20.0, 40.0, 80.0, 20.0, 150.0, 60.0, 310.0, 470.0, 20.0, 310.0, 20.0, 180.0, 30.0, 0.0, 50.0, 70.0, 20.0, 70.0, 10.0, 220.0, 0.0, 90.0, 330.0, 110.0, 150.0, 70.0, 100.0, 150.0, 50.0, 60.0, 160.0, 140.0, -60.0, 90.0, 70.0, 90.0, 50.0, 45.0, 30.0, 50.0, 30.0, 90.0, 160.0, 180.0, 270.0, 240.0, 60.0, 230.0, 80.0, 310.0, 60.0, 160.0, -30.0, 140.0, 170.0, -80.0, 0.0, 100.0, 130.0, 360.0, 95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5458267200026439, "mean_inference_ms": 1.4177894433169151, "mean_action_processing_ms": 0.4598778835698147, "mean_env_wait_ms": 1.2599118893912544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013424158096313477, "StateBufferConnector_ms": 0.010174751281738281, "ViewRequirementAgentConnector_ms": 0.38207054138183594}, "num_episodes": 18, "episode_return_max": 1735.0, "episode_return_min": 295.0, "episode_return_mean": 964.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.49968838603939, "num_env_steps_trained_throughput_per_sec": 21.49968838603939, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 189199.085, "restore_workers_time_ms": 0.014, "training_step_time_ms": 189199.04, "sample_time_ms": 2764.602, "learn_time_ms": 186414.705, "learn_throughput": 21.458, "synch_weights_time_ms": 11.016}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "33e63_00000", "date": "2024-06-19_00-30-53", "timestamp": 1718771453, "time_this_iter_s": 186.06185913085938, "time_total_s": 12235.62782740593, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12235.62782740593, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 17.01749049429658, "ram_util_percent": 79.093536121673}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.414388452367153, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.853140885431292, "policy_loss": -0.008324826467698946, "vf_loss": 6.860205165468973, "vf_explained_var": -0.0001657715366798214, "kl": 0.006302753045917689, "entropy": 0.5019490476868277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 1710.0, "episode_reward_min": 340.0, "episode_reward_mean": 970.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -105.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 97.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [960.0, 1530.0, 580.0, 405.0, 1695.0, 860.0, 805.0, 1180.0, 1290.0, 990.0, 1280.0, 1030.0, 1190.0, 840.0, 620.0, 660.0, 785.0, 865.0, 1295.0, 1090.0, 1200.0, 1145.0, 680.0, 1070.0, 1330.0, 1510.0, 805.0, 790.0, 1130.0, 810.0, 830.0, 955.0, 1170.0, 835.0, 875.0, 720.0, 1390.0, 1235.0, 1330.0, 1195.0, 1230.0, 1710.0, 530.0, 740.0, 920.0, 865.0, 885.0, 930.0, 1180.0, 510.0, 1365.0, 1255.0, 455.0, 1280.0, 340.0, 1695.0, 910.0, 450.0, 485.0, 690.0, 665.0, 470.0, 705.0, 1020.0, 470.0, 800.0, 800.0, 880.0, 1315.0, 1250.0, 1190.0, 1480.0, 670.0, 1110.0, 665.0, 1650.0, 1010.0, 975.0, 1420.0, 870.0, 990.0, 1320.0, 1020.0, 860.0, 650.0, 1075.0, 640.0, 810.0, 1000.0, 1540.0, 860.0, 785.0, 870.0, 605.0, 840.0, 435.0, 1140.0, 745.0, 1440.0, 625.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 230.0, 70.0, 110.0, 50.0, 60.0, 140.0, 130.0, 110.0, -50.0, 350.0, 120.0, 100.0, -30.0, 260.0, 110.0, 320.0, 110.0, 110.0, 80.0, 20.0, 40.0, 20.0, 50.0, 40.0, 190.0, 50.0, 30.0, 120.0, 20.0, 0.0, 50.0, 60.0, 90.0, 90.0, 10.0, 30.0, 70.0, 5.0, 0.0, 360.0, 160.0, 20.0, 100.0, 100.0, 360.0, 10.0, 280.0, 195.0, 110.0, 20.0, 170.0, 60.0, 20.0, 290.0, 170.0, 20.0, 40.0, 40.0, 30.0, 50.0, 10.0, 370.0, -20.0, 320.0, 30.0, -30.0, 0.0, 35.0, 40.0, 30.0, 420.0, 120.0, 65.0, 100.0, 100.0, 160.0, 15.0, 20.0, 150.0, 290.0, 10.0, 180.0, 30.0, 20.0, 250.0, 250.0, 80.0, 130.0, 50.0, 110.0, 270.0, 90.0, 30.0, 160.0, -35.0, 110.0, 15.0, 110.0, 130.0, 210.0, 60.0, 0.0, 290.0, 290.0, 260.0, 0.0, 200.0, -90.0, 60.0, 10.0, 170.0, 85.0, 150.0, 70.0, 150.0, 90.0, 300.0, 10.0, -5.0, 70.0, 110.0, 100.0, 70.0, 110.0, 210.0, 180.0, 160.0, 140.0, 40.0, -10.0, 160.0, -35.0, -30.0, -25.0, 70.0, 310.0, 250.0, 80.0, 70.0, 200.0, 70.0, 40.0, -30.0, 10.0, 60.0, 100.0, 140.0, 30.0, 0.0, 130.0, 60.0, 10.0, 90.0, 100.0, 110.0, 60.0, 10.0, 40.0, 50.0, -15.0, 80.0, -40.0, 230.0, -20.0, 70.0, -50.0, 160.0, 60.0, 310.0, 370.0, 60.0, 0.0, -45.0, 80.0, 50.0, 70.0, 100.0, 150.0, 30.0, 70.0, 55.0, 270.0, 90.0, 300.0, 70.0, 190.0, 190.0, 10.0, 50.0, 40.0, 10.0, 60.0, 40.0, 70.0, 150.0, 340.0, 200.0, 60.0, 120.0, 110.0, 40.0, 40.0, 30.0, 400.0, 90.0, 180.0, 60.0, 50.0, 200.0, 80.0, 70.0, 50.0, 185.0, 90.0, 140.0, 110.0, 340.0, 30.0, 50.0, 150.0, 110.0, -105.0, 120.0, 80.0, 90.0, 30.0, 140.0, 25.0, 40.0, 40.0, 0.0, 150.0, 200.0, 30.0, 80.0, 240.0, 140.0, 140.0, 50.0, 40.0, 90.0, 10.0, 80.0, 160.0, -20.0, -30.0, 520.0, 440.0, 40.0, 320.0, 0.0, -10.0, 470.0, 40.0, 80.0, 10.0, 100.0, 440.0, 60.0, 130.0, 10.0, 330.0, -20.0, 180.0, 0.0, 50.0, 60.0, 55.0, 10.0, 0.0, 100.0, 50.0, 40.0, 50.0, 140.0, 10.0, 190.0, 180.0, 30.0, 30.0, 60.0, 100.0, 120.0, 200.0, 160.0, 50.0, 60.0, 260.0, 90.0, 50.0, 110.0, 0.0, 10.0, 160.0, 0.0, 60.0, 310.0, 60.0, 50.0, 100.0, 70.0, 60.0, 60.0, 30.0, 40.0, 30.0, 170.0, 30.0, 240.0, 35.0, -50.0, 50.0, 70.0, 120.0, 200.0, 80.0, 320.0, 100.0, 30.0, 160.0, 0.0, 100.0, 160.0, 150.0, 250.0, -20.0, -60.0, 70.0, 360.0, 90.0, 120.0, 80.0, 70.0, 160.0, 65.0, 110.0, 10.0, 30.0, 100.0, 0.0, 185.0, 100.0, 90.0, 40.0, 50.0, 60.0, 70.0, 260.0, 20.0, 30.0, 50.0, 50.0, 50.0, 30.0, 40.0, 160.0, 50.0, 250.0, 10.0, 120.0, 380.0, 200.0, 50.0, 100.0, 30.0, 90.0, 280.0, 80.0, 60.0, 0.0, 145.0, -30.0, 340.0, -30.0, 40.0, 70.0, 150.0, 400.0, 150.0, 20.0, 110.0, 270.0, 500.0, 70.0, 40.0, -10.0, 170.0, 100.0, 60.0, 70.0, 40.0, 190.0, 160.0, 75.0, 300.0, -20.0, 80.0, 170.0, 130.0, -10.0, 180.0, 130.0, 170.0, 50.0, 70.0, 110.0, 100.0, 130.0, 300.0, 120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0, 60.0, 100.0, -50.0, 40.0, -50.0, 350.0, 0.0, 10.0, 120.0, -50.0, 220.0, 20.0, 10.0, 80.0, 40.0, 90.0, 40.0, 70.0, 80.0, 90.0, 10.0, 90.0, 80.0, 100.0, 100.0, 370.0, 40.0, 60.0, 90.0, -20.0, 90.0, 10.0, 110.0, 350.0, 45.0, 120.0, 10.0, 20.0, 40.0, 70.0, 130.0, 80.0, 190.0, 80.0, -40.0, 150.0, 105.0, -30.0, 190.0, 30.0, 40.0, 120.0, 30.0, 30.0, 90.0, -30.0, 70.0, 270.0, 110.0, 200.0, 10.0, 570.0, 180.0, 100.0, 30.0, 50.0, 60.0, 90.0, 50.0, 40.0, 40.0, 90.0, 40.0, 50.0, 20.0, 20.0, 40.0, 190.0, 20.0, 0.0, 20.0, 130.0, 240.0, 10.0, 50.0, 130.0, 80.0, 110.0, 560.0, 35.0, 300.0, 110.0, -20.0, 55.0, 120.0, 70.0, 440.0, 80.0, 60.0, 40.0, -45.0, 140.0, -40.0, 60.0, 10.0, 60.0, 10.0, 190.0, 40.0, 30.0, 230.0, 60.0, 140.0, 30.0, 270.0, 60.0, 70.0, 210.0, 100.0, 110.0, 100.0, 40.0, 60.0, 20.0, 30.0, 10.0, 0.0, 60.0, 0.0, 20.0, 25.0, 560.0, 90.0, 70.0, 90.0, 440.0, 30.0, 150.0, 180.0, 60.0, 80.0, 50.0, 250.0, 110.0, 10.0, 240.0, 30.0, 0.0, 80.0, 60.0, 30.0, 10.0, 300.0, 20.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 100.0, -5.0, 10.0, 80.0, 80.0, 40.0, 30.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0, -5.0, 30.0, -50.0, 10.0, 50.0, 30.0, 40.0, 60.0, 40.0, 460.0, 30.0, 0.0, 40.0, 30.0, 30.0, 40.0, 50.0, 20.0, 200.0, 30.0, 100.0, 220.0, 40.0, 40.0, -15.0, 50.0, 110.0, 80.0, 10.0, 70.0, 150.0, 90.0, 260.0, 20.0, -40.0, 70.0, 40.0, 370.0, 60.0, 0.0, 110.0, 30.0, 60.0, 20.0, 0.0, -40.0, 30.0, 50.0, 110.0, 100.0, 20.0, 100.0, 40.0, 260.0, 55.0, 10.0, 90.0, 230.0, 20.0, -25.0, 30.0, 80.0, 50.0, 190.0, 30.0, -10.0, 140.0, 150.0, 130.0, 10.0, -10.0, 110.0, 100.0, 100.0, 30.0, -50.0, 390.0, 20.0, 10.0, 180.0, 170.0, 130.0, 90.0, 150.0, 55.0, 360.0, 120.0, 50.0, 110.0, 80.0, 180.0, 80.0, 110.0, 110.0, 120.0, 180.0, 80.0, 320.0, 40.0, 30.0, 245.0, 160.0, 50.0, 35.0, 400.0, 80.0, -20.0, 80.0, 130.0, 30.0, 20.0, 40.0, 80.0, 20.0, 150.0, 60.0, 310.0, 470.0, 20.0, 310.0, 20.0, 180.0, 30.0, 0.0, 50.0, 70.0, 20.0, 70.0, 10.0, 220.0, 0.0, 90.0, 330.0, 110.0, 150.0, 70.0, 100.0, 150.0, 50.0, 60.0, 160.0, 140.0, -60.0, 90.0, 70.0, 90.0, 50.0, 45.0, 30.0, 50.0, 30.0, 90.0, 160.0, 180.0, 270.0, 240.0, 60.0, 230.0, 80.0, 310.0, 60.0, 160.0, -30.0, 140.0, 170.0, -80.0, 0.0, 100.0, 130.0, 360.0, 95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0, 250.0, 70.0, 240.0, 100.0, 110.0, 60.0, 70.0, 110.0, 60.0, 350.0, 110.0, 160.0, 110.0, 150.0, 50.0, -20.0, 120.0, 160.0, 10.0, 20.0, 110.0, 300.0, 80.0, 150.0, 40.0, 50.0, -10.0, 70.0, 10.0, 190.0, 220.0, 160.0, 120.0, -20.0, 550.0, 10.0, 30.0, 60.0, 120.0, 70.0, 80.0, 35.0, 100.0, 30.0, 180.0, 220.0, 25.0, 200.0, 50.0, 100.0, 180.0, 30.0, 5.0, 80.0, -40.0, 180.0, 150.0, -65.0, 60.0, 280.0, 70.0, 0.0, 20.0, 100.0, 20.0, 40.0, 0.0, 30.0, 260.0, 110.0, 110.0, 60.0, 70.0, 120.0, 65.0, 160.0, 60.0, 50.0, 180.0, 200.0, 30.0, 0.0, 190.0, 40.0, 60.0, 10.0, 30.0, 20.0, 260.0, 0.0, 340.0, 60.0, 90.0, 10.0, 20.0, 20.0, 160.0, 0.0, 40.0, 70.0, 10.0, 150.0, 5.0, -100.0, 10.0, 45.0, 170.0, 150.0, 320.0, 240.0, 280.0, -30.0, 0.0, 160.0, 50.0, 580.0, -10.0, 310.0, 100.0, 100.0, 90.0, 40.0, 90.0, 110.0, 70.0, 260.0, 100.0, -20.0, 60.0, 60.0, 100.0, 30.0, 220.0, 70.0, 20.0, 40.0, 60.0, 180.0, 30.0, 35.0, 170.0, 50.0, 220.0, 30.0, 35.0, 190.0, 30.0, -5.0, 40.0, 110.0, 5.0, 50.0, 10.0, 150.0, 20.0, 60.0, 20.0, 260.0, 10.0, 20.0, 30.0, 0.0, 30.0, 210.0, 260.0, 20.0, -10.0, 20.0, 260.0, 20.0, 50.0, 60.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 60.0, 160.0, 340.0, 20.0, -30.0, 20.0, 90.0, 90.0, 70.0, 30.0, 290.0, 220.0, 260.0, -5.0, 50.0, 80.0, 30.0, 0.0, 200.0, 30.0, 50.0, 50.0, 440.0, 260.0, 20.0, 80.0, 30.0, 20.0, 80.0, 430.0, 30.0, 50.0, 90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.545646872497601, "mean_inference_ms": 1.4183486240044443, "mean_action_processing_ms": 0.4585828291532655, "mean_env_wait_ms": 1.2599582686960644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013336181640625, "StateBufferConnector_ms": 0.010136604309082031, "ViewRequirementAgentConnector_ms": 0.38956117630004883}, "num_episodes": 22, "episode_return_max": 1710.0, "episode_return_min": 340.0, "episode_return_mean": 970.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.551767559134035, "num_env_steps_trained_throughput_per_sec": 21.551767559134035, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 188598.702, "restore_workers_time_ms": 0.014, "training_step_time_ms": 188598.657, "sample_time_ms": 2724.406, "learn_time_ms": 185854.418, "learn_throughput": 21.522, "synch_weights_time_ms": 11.045}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "33e63_00000", "date": "2024-06-19_00-33-59", "timestamp": 1718771639, "time_this_iter_s": 185.60773730278015, "time_total_s": 12421.23556470871, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12421.23556470871, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 16.588549618320613, "ram_util_percent": 79.1030534351145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8048088810885674, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.780221762621618, "policy_loss": -0.009451448554059052, "vf_loss": 6.7882537477694385, "vf_explained_var": 0.001635270276135657, "kl": 0.007097369903858757, "entropy": 0.4848070490474518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1710.0, "episode_reward_min": 225.0, "episode_reward_mean": 922.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 580.0}, "policy_reward_mean": {"policy_0": 92.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 1330.0, 1510.0, 805.0, 790.0, 1130.0, 810.0, 830.0, 955.0, 1170.0, 835.0, 875.0, 720.0, 1390.0, 1235.0, 1330.0, 1195.0, 1230.0, 1710.0, 530.0, 740.0, 920.0, 865.0, 885.0, 930.0, 1180.0, 510.0, 1365.0, 1255.0, 455.0, 1280.0, 340.0, 1695.0, 910.0, 450.0, 485.0, 690.0, 665.0, 470.0, 705.0, 1020.0, 470.0, 800.0, 800.0, 880.0, 1315.0, 1250.0, 1190.0, 1480.0, 670.0, 1110.0, 665.0, 1650.0, 1010.0, 975.0, 1420.0, 870.0, 990.0, 1320.0, 1020.0, 860.0, 650.0, 1075.0, 640.0, 810.0, 1000.0, 1540.0, 860.0, 785.0, 870.0, 605.0, 840.0, 435.0, 1140.0, 745.0, 1440.0, 625.0, 1005.0, 655.0, 230.0, 700.0, 1250.0, 545.0, 225.0, 1020.0, 755.0, 1370.0, 1005.0, 905.0, 820.0, 670.0, 440.0, 1070.0, 1035.0, 1270.0, 1090.0, 650.0, 550.0, 350.0, 580.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 0.0, 150.0, 200.0, 30.0, 80.0, 240.0, 140.0, 140.0, 50.0, 40.0, 90.0, 10.0, 80.0, 160.0, -20.0, -30.0, 520.0, 440.0, 40.0, 320.0, 0.0, -10.0, 470.0, 40.0, 80.0, 10.0, 100.0, 440.0, 60.0, 130.0, 10.0, 330.0, -20.0, 180.0, 0.0, 50.0, 60.0, 55.0, 10.0, 0.0, 100.0, 50.0, 40.0, 50.0, 140.0, 10.0, 190.0, 180.0, 30.0, 30.0, 60.0, 100.0, 120.0, 200.0, 160.0, 50.0, 60.0, 260.0, 90.0, 50.0, 110.0, 0.0, 10.0, 160.0, 0.0, 60.0, 310.0, 60.0, 50.0, 100.0, 70.0, 60.0, 60.0, 30.0, 40.0, 30.0, 170.0, 30.0, 240.0, 35.0, -50.0, 50.0, 70.0, 120.0, 200.0, 80.0, 320.0, 100.0, 30.0, 160.0, 0.0, 100.0, 160.0, 150.0, 250.0, -20.0, -60.0, 70.0, 360.0, 90.0, 120.0, 80.0, 70.0, 160.0, 65.0, 110.0, 10.0, 30.0, 100.0, 0.0, 185.0, 100.0, 90.0, 40.0, 50.0, 60.0, 70.0, 260.0, 20.0, 30.0, 50.0, 50.0, 50.0, 30.0, 40.0, 160.0, 50.0, 250.0, 10.0, 120.0, 380.0, 200.0, 50.0, 100.0, 30.0, 90.0, 280.0, 80.0, 60.0, 0.0, 145.0, -30.0, 340.0, -30.0, 40.0, 70.0, 150.0, 400.0, 150.0, 20.0, 110.0, 270.0, 500.0, 70.0, 40.0, -10.0, 170.0, 100.0, 60.0, 70.0, 40.0, 190.0, 160.0, 75.0, 300.0, -20.0, 80.0, 170.0, 130.0, -10.0, 180.0, 130.0, 170.0, 50.0, 70.0, 110.0, 100.0, 130.0, 300.0, 120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0, 60.0, 100.0, -50.0, 40.0, -50.0, 350.0, 0.0, 10.0, 120.0, -50.0, 220.0, 20.0, 10.0, 80.0, 40.0, 90.0, 40.0, 70.0, 80.0, 90.0, 10.0, 90.0, 80.0, 100.0, 100.0, 370.0, 40.0, 60.0, 90.0, -20.0, 90.0, 10.0, 110.0, 350.0, 45.0, 120.0, 10.0, 20.0, 40.0, 70.0, 130.0, 80.0, 190.0, 80.0, -40.0, 150.0, 105.0, -30.0, 190.0, 30.0, 40.0, 120.0, 30.0, 30.0, 90.0, -30.0, 70.0, 270.0, 110.0, 200.0, 10.0, 570.0, 180.0, 100.0, 30.0, 50.0, 60.0, 90.0, 50.0, 40.0, 40.0, 90.0, 40.0, 50.0, 20.0, 20.0, 40.0, 190.0, 20.0, 0.0, 20.0, 130.0, 240.0, 10.0, 50.0, 130.0, 80.0, 110.0, 560.0, 35.0, 300.0, 110.0, -20.0, 55.0, 120.0, 70.0, 440.0, 80.0, 60.0, 40.0, -45.0, 140.0, -40.0, 60.0, 10.0, 60.0, 10.0, 190.0, 40.0, 30.0, 230.0, 60.0, 140.0, 30.0, 270.0, 60.0, 70.0, 210.0, 100.0, 110.0, 100.0, 40.0, 60.0, 20.0, 30.0, 10.0, 0.0, 60.0, 0.0, 20.0, 25.0, 560.0, 90.0, 70.0, 90.0, 440.0, 30.0, 150.0, 180.0, 60.0, 80.0, 50.0, 250.0, 110.0, 10.0, 240.0, 30.0, 0.0, 80.0, 60.0, 30.0, 10.0, 300.0, 20.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 100.0, -5.0, 10.0, 80.0, 80.0, 40.0, 30.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0, -5.0, 30.0, -50.0, 10.0, 50.0, 30.0, 40.0, 60.0, 40.0, 460.0, 30.0, 0.0, 40.0, 30.0, 30.0, 40.0, 50.0, 20.0, 200.0, 30.0, 100.0, 220.0, 40.0, 40.0, -15.0, 50.0, 110.0, 80.0, 10.0, 70.0, 150.0, 90.0, 260.0, 20.0, -40.0, 70.0, 40.0, 370.0, 60.0, 0.0, 110.0, 30.0, 60.0, 20.0, 0.0, -40.0, 30.0, 50.0, 110.0, 100.0, 20.0, 100.0, 40.0, 260.0, 55.0, 10.0, 90.0, 230.0, 20.0, -25.0, 30.0, 80.0, 50.0, 190.0, 30.0, -10.0, 140.0, 150.0, 130.0, 10.0, -10.0, 110.0, 100.0, 100.0, 30.0, -50.0, 390.0, 20.0, 10.0, 180.0, 170.0, 130.0, 90.0, 150.0, 55.0, 360.0, 120.0, 50.0, 110.0, 80.0, 180.0, 80.0, 110.0, 110.0, 120.0, 180.0, 80.0, 320.0, 40.0, 30.0, 245.0, 160.0, 50.0, 35.0, 400.0, 80.0, -20.0, 80.0, 130.0, 30.0, 20.0, 40.0, 80.0, 20.0, 150.0, 60.0, 310.0, 470.0, 20.0, 310.0, 20.0, 180.0, 30.0, 0.0, 50.0, 70.0, 20.0, 70.0, 10.0, 220.0, 0.0, 90.0, 330.0, 110.0, 150.0, 70.0, 100.0, 150.0, 50.0, 60.0, 160.0, 140.0, -60.0, 90.0, 70.0, 90.0, 50.0, 45.0, 30.0, 50.0, 30.0, 90.0, 160.0, 180.0, 270.0, 240.0, 60.0, 230.0, 80.0, 310.0, 60.0, 160.0, -30.0, 140.0, 170.0, -80.0, 0.0, 100.0, 130.0, 360.0, 95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0, 250.0, 70.0, 240.0, 100.0, 110.0, 60.0, 70.0, 110.0, 60.0, 350.0, 110.0, 160.0, 110.0, 150.0, 50.0, -20.0, 120.0, 160.0, 10.0, 20.0, 110.0, 300.0, 80.0, 150.0, 40.0, 50.0, -10.0, 70.0, 10.0, 190.0, 220.0, 160.0, 120.0, -20.0, 550.0, 10.0, 30.0, 60.0, 120.0, 70.0, 80.0, 35.0, 100.0, 30.0, 180.0, 220.0, 25.0, 200.0, 50.0, 100.0, 180.0, 30.0, 5.0, 80.0, -40.0, 180.0, 150.0, -65.0, 60.0, 280.0, 70.0, 0.0, 20.0, 100.0, 20.0, 40.0, 0.0, 30.0, 260.0, 110.0, 110.0, 60.0, 70.0, 120.0, 65.0, 160.0, 60.0, 50.0, 180.0, 200.0, 30.0, 0.0, 190.0, 40.0, 60.0, 10.0, 30.0, 20.0, 260.0, 0.0, 340.0, 60.0, 90.0, 10.0, 20.0, 20.0, 160.0, 0.0, 40.0, 70.0, 10.0, 150.0, 5.0, -100.0, 10.0, 45.0, 170.0, 150.0, 320.0, 240.0, 280.0, -30.0, 0.0, 160.0, 50.0, 580.0, -10.0, 310.0, 100.0, 100.0, 90.0, 40.0, 90.0, 110.0, 70.0, 260.0, 100.0, -20.0, 60.0, 60.0, 100.0, 30.0, 220.0, 70.0, 20.0, 40.0, 60.0, 180.0, 30.0, 35.0, 170.0, 50.0, 220.0, 30.0, 35.0, 190.0, 30.0, -5.0, 40.0, 110.0, 5.0, 50.0, 10.0, 150.0, 20.0, 60.0, 20.0, 260.0, 10.0, 20.0, 30.0, 0.0, 30.0, 210.0, 260.0, 20.0, -10.0, 20.0, 260.0, 20.0, 50.0, 60.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 60.0, 160.0, 340.0, 20.0, -30.0, 20.0, 90.0, 90.0, 70.0, 30.0, 290.0, 220.0, 260.0, -5.0, 50.0, 80.0, 30.0, 0.0, 200.0, 30.0, 50.0, 50.0, 440.0, 260.0, 20.0, 80.0, 30.0, 20.0, 80.0, 430.0, 30.0, 50.0, 90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0, 20.0, 350.0, -5.0, 100.0, 30.0, 110.0, 90.0, 40.0, 100.0, 170.0, 80.0, 120.0, 80.0, 50.0, 90.0, 25.0, 70.0, 10.0, 40.0, 90.0, 0.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 30.0, 170.0, 40.0, 60.0, 30.0, 0.0, 170.0, 20.0, 250.0, -90.0, 50.0, 60.0, 80.0, 20.0, 70.0, 360.0, 190.0, 90.0, 230.0, 130.0, 20.0, 100.0, -40.0, 120.0, 35.0, 20.0, 180.0, 10.0, -10.0, -40.0, 170.0, 20.0, 20.0, 20.0, 80.0, 0.0, 20.0, 30.0, 20.0, 10.0, 5.0, 40.0, 10.0, 180.0, 40.0, 250.0, 140.0, 70.0, 100.0, 110.0, 80.0, -350.0, 50.0, 10.0, 80.0, 265.0, 50.0, 100.0, 210.0, 60.0, 280.0, 310.0, 110.0, 150.0, 60.0, 240.0, 220.0, 30.0, 0.0, 70.0, 180.0, 100.0, 20.0, 100.0, 25.0, -95.0, 200.0, 90.0, 115.0, 280.0, 170.0, 210.0, 15.0, 15.0, 40.0, 0.0, 120.0, 320.0, 100.0, 80.0, 5.0, 20.0, 20.0, 300.0, 270.0, 70.0, 10.0, -20.0, 50.0, 30.0, 70.0, -10.0, 20.0, 70.0, 30.0, -80.0, 10.0, 80.0, 0.0, 350.0, 200.0, 30.0, 30.0, 100.0, 50.0, 20.0, 30.0, 0.0, 160.0, 0.0, 20.0, 160.0, 190.0, 10.0, 100.0, 190.0, 60.0, 100.0, 40.0, 200.0, 20.0, 100.0, 110.0, 40.0, 100.0, 100.0, 50.0, 105.0, 70.0, 80.0, 280.0, 350.0, 70.0, 130.0, 100.0, 110.0, 80.0, 160.0, 120.0, 50.0, 100.0, 30.0, 80.0, 40.0, 460.0, 60.0, 20.0, 170.0, 90.0, 90.0, 50.0, 70.0, 10.0, 60.0, 20.0, 0.0, 40.0, 40.0, 170.0, 140.0, 100.0, 140.0, 30.0, 20.0, 10.0, 20.0, 120.0, 110.0, 30.0, 0.0, 70.0, 0.0, 250.0, 30.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.545218601698457, "mean_inference_ms": 1.4166301989506775, "mean_action_processing_ms": 0.4551887727290771, "mean_env_wait_ms": 1.2595221673271992, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013267993927001953, "StateBufferConnector_ms": 0.009993314743041992, "ViewRequirementAgentConnector_ms": 0.3864009380340576}, "num_episodes": 23, "episode_return_max": 1710.0, "episode_return_min": 225.0, "episode_return_mean": 922.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.514794044658572, "num_env_steps_trained_throughput_per_sec": 21.514794044658572, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 187963.727, "restore_workers_time_ms": 0.014, "training_step_time_ms": 187963.681, "sample_time_ms": 2562.672, "learn_time_ms": 185381.414, "learn_throughput": 21.577, "synch_weights_time_ms": 10.939}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "33e63_00000", "date": "2024-06-19_00-37-04", "timestamp": 1718771824, "time_this_iter_s": 185.92762112617493, "time_total_s": 12607.163185834885, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276f5dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12607.163185834885, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 16.965399239543725, "ram_util_percent": 79.6300380228137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9062162619238845, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.816540281206401, "policy_loss": -0.007870526443021343, "vf_loss": 6.823063605382673, "vf_explained_var": 0.0020893220576488425, "kl": 0.0067360135098666, "entropy": 0.4760574153976572, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 1710.0, "episode_reward_min": 90.0, "episode_reward_mean": 910.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 91.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1710.0, 530.0, 740.0, 920.0, 865.0, 885.0, 930.0, 1180.0, 510.0, 1365.0, 1255.0, 455.0, 1280.0, 340.0, 1695.0, 910.0, 450.0, 485.0, 690.0, 665.0, 470.0, 705.0, 1020.0, 470.0, 800.0, 800.0, 880.0, 1315.0, 1250.0, 1190.0, 1480.0, 670.0, 1110.0, 665.0, 1650.0, 1010.0, 975.0, 1420.0, 870.0, 990.0, 1320.0, 1020.0, 860.0, 650.0, 1075.0, 640.0, 810.0, 1000.0, 1540.0, 860.0, 785.0, 870.0, 605.0, 840.0, 435.0, 1140.0, 745.0, 1440.0, 625.0, 1005.0, 655.0, 230.0, 700.0, 1250.0, 545.0, 225.0, 1020.0, 755.0, 1370.0, 1005.0, 905.0, 820.0, 670.0, 440.0, 1070.0, 1035.0, 1270.0, 1090.0, 650.0, 550.0, 350.0, 580.0, 1370.0, 760.0, 705.0, 1240.0, 420.0, 1195.0, 1230.0, 1100.0, 1490.0, 1470.0, 1170.0, 90.0, 360.0, 490.0, 1180.0, 1670.0, 490.0, 1560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 470.0, 290.0, 160.0, 110.0, 20.0, 60.0, 180.0, 300.0, 0.0, 60.0, 100.0, -50.0, 40.0, -50.0, 350.0, 0.0, 10.0, 120.0, -50.0, 220.0, 20.0, 10.0, 80.0, 40.0, 90.0, 40.0, 70.0, 80.0, 90.0, 10.0, 90.0, 80.0, 100.0, 100.0, 370.0, 40.0, 60.0, 90.0, -20.0, 90.0, 10.0, 110.0, 350.0, 45.0, 120.0, 10.0, 20.0, 40.0, 70.0, 130.0, 80.0, 190.0, 80.0, -40.0, 150.0, 105.0, -30.0, 190.0, 30.0, 40.0, 120.0, 30.0, 30.0, 90.0, -30.0, 70.0, 270.0, 110.0, 200.0, 10.0, 570.0, 180.0, 100.0, 30.0, 50.0, 60.0, 90.0, 50.0, 40.0, 40.0, 90.0, 40.0, 50.0, 20.0, 20.0, 40.0, 190.0, 20.0, 0.0, 20.0, 130.0, 240.0, 10.0, 50.0, 130.0, 80.0, 110.0, 560.0, 35.0, 300.0, 110.0, -20.0, 55.0, 120.0, 70.0, 440.0, 80.0, 60.0, 40.0, -45.0, 140.0, -40.0, 60.0, 10.0, 60.0, 10.0, 190.0, 40.0, 30.0, 230.0, 60.0, 140.0, 30.0, 270.0, 60.0, 70.0, 210.0, 100.0, 110.0, 100.0, 40.0, 60.0, 20.0, 30.0, 10.0, 0.0, 60.0, 0.0, 20.0, 25.0, 560.0, 90.0, 70.0, 90.0, 440.0, 30.0, 150.0, 180.0, 60.0, 80.0, 50.0, 250.0, 110.0, 10.0, 240.0, 30.0, 0.0, 80.0, 60.0, 30.0, 10.0, 300.0, 20.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 100.0, -5.0, 10.0, 80.0, 80.0, 40.0, 30.0, 20.0, 90.0, 40.0, 20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0, -5.0, 30.0, -50.0, 10.0, 50.0, 30.0, 40.0, 60.0, 40.0, 460.0, 30.0, 0.0, 40.0, 30.0, 30.0, 40.0, 50.0, 20.0, 200.0, 30.0, 100.0, 220.0, 40.0, 40.0, -15.0, 50.0, 110.0, 80.0, 10.0, 70.0, 150.0, 90.0, 260.0, 20.0, -40.0, 70.0, 40.0, 370.0, 60.0, 0.0, 110.0, 30.0, 60.0, 20.0, 0.0, -40.0, 30.0, 50.0, 110.0, 100.0, 20.0, 100.0, 40.0, 260.0, 55.0, 10.0, 90.0, 230.0, 20.0, -25.0, 30.0, 80.0, 50.0, 190.0, 30.0, -10.0, 140.0, 150.0, 130.0, 10.0, -10.0, 110.0, 100.0, 100.0, 30.0, -50.0, 390.0, 20.0, 10.0, 180.0, 170.0, 130.0, 90.0, 150.0, 55.0, 360.0, 120.0, 50.0, 110.0, 80.0, 180.0, 80.0, 110.0, 110.0, 120.0, 180.0, 80.0, 320.0, 40.0, 30.0, 245.0, 160.0, 50.0, 35.0, 400.0, 80.0, -20.0, 80.0, 130.0, 30.0, 20.0, 40.0, 80.0, 20.0, 150.0, 60.0, 310.0, 470.0, 20.0, 310.0, 20.0, 180.0, 30.0, 0.0, 50.0, 70.0, 20.0, 70.0, 10.0, 220.0, 0.0, 90.0, 330.0, 110.0, 150.0, 70.0, 100.0, 150.0, 50.0, 60.0, 160.0, 140.0, -60.0, 90.0, 70.0, 90.0, 50.0, 45.0, 30.0, 50.0, 30.0, 90.0, 160.0, 180.0, 270.0, 240.0, 60.0, 230.0, 80.0, 310.0, 60.0, 160.0, -30.0, 140.0, 170.0, -80.0, 0.0, 100.0, 130.0, 360.0, 95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0, 250.0, 70.0, 240.0, 100.0, 110.0, 60.0, 70.0, 110.0, 60.0, 350.0, 110.0, 160.0, 110.0, 150.0, 50.0, -20.0, 120.0, 160.0, 10.0, 20.0, 110.0, 300.0, 80.0, 150.0, 40.0, 50.0, -10.0, 70.0, 10.0, 190.0, 220.0, 160.0, 120.0, -20.0, 550.0, 10.0, 30.0, 60.0, 120.0, 70.0, 80.0, 35.0, 100.0, 30.0, 180.0, 220.0, 25.0, 200.0, 50.0, 100.0, 180.0, 30.0, 5.0, 80.0, -40.0, 180.0, 150.0, -65.0, 60.0, 280.0, 70.0, 0.0, 20.0, 100.0, 20.0, 40.0, 0.0, 30.0, 260.0, 110.0, 110.0, 60.0, 70.0, 120.0, 65.0, 160.0, 60.0, 50.0, 180.0, 200.0, 30.0, 0.0, 190.0, 40.0, 60.0, 10.0, 30.0, 20.0, 260.0, 0.0, 340.0, 60.0, 90.0, 10.0, 20.0, 20.0, 160.0, 0.0, 40.0, 70.0, 10.0, 150.0, 5.0, -100.0, 10.0, 45.0, 170.0, 150.0, 320.0, 240.0, 280.0, -30.0, 0.0, 160.0, 50.0, 580.0, -10.0, 310.0, 100.0, 100.0, 90.0, 40.0, 90.0, 110.0, 70.0, 260.0, 100.0, -20.0, 60.0, 60.0, 100.0, 30.0, 220.0, 70.0, 20.0, 40.0, 60.0, 180.0, 30.0, 35.0, 170.0, 50.0, 220.0, 30.0, 35.0, 190.0, 30.0, -5.0, 40.0, 110.0, 5.0, 50.0, 10.0, 150.0, 20.0, 60.0, 20.0, 260.0, 10.0, 20.0, 30.0, 0.0, 30.0, 210.0, 260.0, 20.0, -10.0, 20.0, 260.0, 20.0, 50.0, 60.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 60.0, 160.0, 340.0, 20.0, -30.0, 20.0, 90.0, 90.0, 70.0, 30.0, 290.0, 220.0, 260.0, -5.0, 50.0, 80.0, 30.0, 0.0, 200.0, 30.0, 50.0, 50.0, 440.0, 260.0, 20.0, 80.0, 30.0, 20.0, 80.0, 430.0, 30.0, 50.0, 90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0, 20.0, 350.0, -5.0, 100.0, 30.0, 110.0, 90.0, 40.0, 100.0, 170.0, 80.0, 120.0, 80.0, 50.0, 90.0, 25.0, 70.0, 10.0, 40.0, 90.0, 0.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 30.0, 170.0, 40.0, 60.0, 30.0, 0.0, 170.0, 20.0, 250.0, -90.0, 50.0, 60.0, 80.0, 20.0, 70.0, 360.0, 190.0, 90.0, 230.0, 130.0, 20.0, 100.0, -40.0, 120.0, 35.0, 20.0, 180.0, 10.0, -10.0, -40.0, 170.0, 20.0, 20.0, 20.0, 80.0, 0.0, 20.0, 30.0, 20.0, 10.0, 5.0, 40.0, 10.0, 180.0, 40.0, 250.0, 140.0, 70.0, 100.0, 110.0, 80.0, -350.0, 50.0, 10.0, 80.0, 265.0, 50.0, 100.0, 210.0, 60.0, 280.0, 310.0, 110.0, 150.0, 60.0, 240.0, 220.0, 30.0, 0.0, 70.0, 180.0, 100.0, 20.0, 100.0, 25.0, -95.0, 200.0, 90.0, 115.0, 280.0, 170.0, 210.0, 15.0, 15.0, 40.0, 0.0, 120.0, 320.0, 100.0, 80.0, 5.0, 20.0, 20.0, 300.0, 270.0, 70.0, 10.0, -20.0, 50.0, 30.0, 70.0, -10.0, 20.0, 70.0, 30.0, -80.0, 10.0, 80.0, 0.0, 350.0, 200.0, 30.0, 30.0, 100.0, 50.0, 20.0, 30.0, 0.0, 160.0, 0.0, 20.0, 160.0, 190.0, 10.0, 100.0, 190.0, 60.0, 100.0, 40.0, 200.0, 20.0, 100.0, 110.0, 40.0, 100.0, 100.0, 50.0, 105.0, 70.0, 80.0, 280.0, 350.0, 70.0, 130.0, 100.0, 110.0, 80.0, 160.0, 120.0, 50.0, 100.0, 30.0, 80.0, 40.0, 460.0, 60.0, 20.0, 170.0, 90.0, 90.0, 50.0, 70.0, 10.0, 60.0, 20.0, 0.0, 40.0, 40.0, 170.0, 140.0, 100.0, 140.0, 30.0, 20.0, 10.0, 20.0, 120.0, 110.0, 30.0, 0.0, 70.0, 0.0, 250.0, 30.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0, 80.0, 120.0, 20.0, 120.0, 20.0, 60.0, 210.0, 310.0, 230.0, 200.0, 20.0, 150.0, 410.0, 20.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 50.0, 130.0, 5.0, 30.0, 210.0, 30.0, 30.0, 120.0, 70.0, 190.0, 50.0, 630.0, 20.0, 30.0, 30.0, 70.0, 30.0, 40.0, 40.0, 20.0, 100.0, 190.0, 30.0, 0.0, 0.0, -10.0, 10.0, 470.0, 70.0, 60.0, 40.0, 180.0, 90.0, 90.0, 45.0, 140.0, 10.0, 320.0, 150.0, 20.0, 80.0, 100.0, 60.0, 30.0, 290.0, 90.0, 90.0, 20.0, 60.0, 160.0, 120.0, 20.0, 70.0, 160.0, 160.0, 280.0, 50.0, 20.0, 40.0, 110.0, 10.0, 530.0, 0.0, 40.0, 200.0, 380.0, 160.0, 70.0, 530.0, 180.0, 160.0, 60.0, 40.0, 50.0, 30.0, 10.0, 340.0, 110.0, 30.0, 320.0, 60.0, 90.0, 30.0, 300.0, 110.0, 110.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, 70.0, 0.0, 40.0, 60.0, 10.0, 70.0, 30.0, 95.0, 40.0, 0.0, 170.0, 0.0, 55.0, 20.0, 10.0, 200.0, 140.0, 150.0, 180.0, 10.0, 40.0, 200.0, 50.0, 60.0, 150.0, 80.0, 360.0, 150.0, 420.0, 70.0, 60.0, 70.0, 170.0, 70.0, 220.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 60.0, 30.0, 180.0, 70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.54464180371113, "mean_inference_ms": 1.4174980167749753, "mean_action_processing_ms": 0.4563432835666676, "mean_env_wait_ms": 1.2590241295808675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01281118392944336, "StateBufferConnector_ms": 0.009787559509277344, "ViewRequirementAgentConnector_ms": 0.37869930267333984}, "num_episodes": 18, "episode_return_max": 1710.0, "episode_return_min": 90.0, "episode_return_mean": 910.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.55750970216789, "num_env_steps_trained_throughput_per_sec": 21.55750970216789, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 187559.687, "restore_workers_time_ms": 0.015, "training_step_time_ms": 187559.638, "sample_time_ms": 2537.959, "learn_time_ms": 185002.122, "learn_throughput": 21.621, "synch_weights_time_ms": 10.786}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "33e63_00000", "date": "2024-06-19_00-40-10", "timestamp": 1718772010, "time_this_iter_s": 185.56012296676636, "time_total_s": 12792.723308801651, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277c63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12792.723308801651, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.45855513307985, "ram_util_percent": 79.0041825095057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3091658913860686, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.948190341488368, "policy_loss": -0.00890638067350347, "vf_loss": 6.95582358626385, "vf_explained_var": 0.000276863619415397, "kl": 0.006365628655267709, "entropy": 0.45187104663338523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 920.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 92.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 665.0, 470.0, 705.0, 1020.0, 470.0, 800.0, 800.0, 880.0, 1315.0, 1250.0, 1190.0, 1480.0, 670.0, 1110.0, 665.0, 1650.0, 1010.0, 975.0, 1420.0, 870.0, 990.0, 1320.0, 1020.0, 860.0, 650.0, 1075.0, 640.0, 810.0, 1000.0, 1540.0, 860.0, 785.0, 870.0, 605.0, 840.0, 435.0, 1140.0, 745.0, 1440.0, 625.0, 1005.0, 655.0, 230.0, 700.0, 1250.0, 545.0, 225.0, 1020.0, 755.0, 1370.0, 1005.0, 905.0, 820.0, 670.0, 440.0, 1070.0, 1035.0, 1270.0, 1090.0, 650.0, 550.0, 350.0, 580.0, 1370.0, 760.0, 705.0, 1240.0, 420.0, 1195.0, 1230.0, 1100.0, 1490.0, 1470.0, 1170.0, 90.0, 360.0, 490.0, 1180.0, 1670.0, 490.0, 1560.0, 375.0, 265.0, 570.0, 975.0, 640.0, 800.0, 1270.0, 1080.0, 1190.0, 840.0, 2225.0, 890.0, 1285.0, 955.0, 1440.0, 1060.0, 1280.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 40.0, 10.0, 30.0, 40.0, 150.0, 90.0, 30.0, 280.0, -5.0, 30.0, -50.0, 10.0, 50.0, 30.0, 40.0, 60.0, 40.0, 460.0, 30.0, 0.0, 40.0, 30.0, 30.0, 40.0, 50.0, 20.0, 200.0, 30.0, 100.0, 220.0, 40.0, 40.0, -15.0, 50.0, 110.0, 80.0, 10.0, 70.0, 150.0, 90.0, 260.0, 20.0, -40.0, 70.0, 40.0, 370.0, 60.0, 0.0, 110.0, 30.0, 60.0, 20.0, 0.0, -40.0, 30.0, 50.0, 110.0, 100.0, 20.0, 100.0, 40.0, 260.0, 55.0, 10.0, 90.0, 230.0, 20.0, -25.0, 30.0, 80.0, 50.0, 190.0, 30.0, -10.0, 140.0, 150.0, 130.0, 10.0, -10.0, 110.0, 100.0, 100.0, 30.0, -50.0, 390.0, 20.0, 10.0, 180.0, 170.0, 130.0, 90.0, 150.0, 55.0, 360.0, 120.0, 50.0, 110.0, 80.0, 180.0, 80.0, 110.0, 110.0, 120.0, 180.0, 80.0, 320.0, 40.0, 30.0, 245.0, 160.0, 50.0, 35.0, 400.0, 80.0, -20.0, 80.0, 130.0, 30.0, 20.0, 40.0, 80.0, 20.0, 150.0, 60.0, 310.0, 470.0, 20.0, 310.0, 20.0, 180.0, 30.0, 0.0, 50.0, 70.0, 20.0, 70.0, 10.0, 220.0, 0.0, 90.0, 330.0, 110.0, 150.0, 70.0, 100.0, 150.0, 50.0, 60.0, 160.0, 140.0, -60.0, 90.0, 70.0, 90.0, 50.0, 45.0, 30.0, 50.0, 30.0, 90.0, 160.0, 180.0, 270.0, 240.0, 60.0, 230.0, 80.0, 310.0, 60.0, 160.0, -30.0, 140.0, 170.0, -80.0, 0.0, 100.0, 130.0, 360.0, 95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0, 250.0, 70.0, 240.0, 100.0, 110.0, 60.0, 70.0, 110.0, 60.0, 350.0, 110.0, 160.0, 110.0, 150.0, 50.0, -20.0, 120.0, 160.0, 10.0, 20.0, 110.0, 300.0, 80.0, 150.0, 40.0, 50.0, -10.0, 70.0, 10.0, 190.0, 220.0, 160.0, 120.0, -20.0, 550.0, 10.0, 30.0, 60.0, 120.0, 70.0, 80.0, 35.0, 100.0, 30.0, 180.0, 220.0, 25.0, 200.0, 50.0, 100.0, 180.0, 30.0, 5.0, 80.0, -40.0, 180.0, 150.0, -65.0, 60.0, 280.0, 70.0, 0.0, 20.0, 100.0, 20.0, 40.0, 0.0, 30.0, 260.0, 110.0, 110.0, 60.0, 70.0, 120.0, 65.0, 160.0, 60.0, 50.0, 180.0, 200.0, 30.0, 0.0, 190.0, 40.0, 60.0, 10.0, 30.0, 20.0, 260.0, 0.0, 340.0, 60.0, 90.0, 10.0, 20.0, 20.0, 160.0, 0.0, 40.0, 70.0, 10.0, 150.0, 5.0, -100.0, 10.0, 45.0, 170.0, 150.0, 320.0, 240.0, 280.0, -30.0, 0.0, 160.0, 50.0, 580.0, -10.0, 310.0, 100.0, 100.0, 90.0, 40.0, 90.0, 110.0, 70.0, 260.0, 100.0, -20.0, 60.0, 60.0, 100.0, 30.0, 220.0, 70.0, 20.0, 40.0, 60.0, 180.0, 30.0, 35.0, 170.0, 50.0, 220.0, 30.0, 35.0, 190.0, 30.0, -5.0, 40.0, 110.0, 5.0, 50.0, 10.0, 150.0, 20.0, 60.0, 20.0, 260.0, 10.0, 20.0, 30.0, 0.0, 30.0, 210.0, 260.0, 20.0, -10.0, 20.0, 260.0, 20.0, 50.0, 60.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 60.0, 160.0, 340.0, 20.0, -30.0, 20.0, 90.0, 90.0, 70.0, 30.0, 290.0, 220.0, 260.0, -5.0, 50.0, 80.0, 30.0, 0.0, 200.0, 30.0, 50.0, 50.0, 440.0, 260.0, 20.0, 80.0, 30.0, 20.0, 80.0, 430.0, 30.0, 50.0, 90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0, 20.0, 350.0, -5.0, 100.0, 30.0, 110.0, 90.0, 40.0, 100.0, 170.0, 80.0, 120.0, 80.0, 50.0, 90.0, 25.0, 70.0, 10.0, 40.0, 90.0, 0.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 30.0, 170.0, 40.0, 60.0, 30.0, 0.0, 170.0, 20.0, 250.0, -90.0, 50.0, 60.0, 80.0, 20.0, 70.0, 360.0, 190.0, 90.0, 230.0, 130.0, 20.0, 100.0, -40.0, 120.0, 35.0, 20.0, 180.0, 10.0, -10.0, -40.0, 170.0, 20.0, 20.0, 20.0, 80.0, 0.0, 20.0, 30.0, 20.0, 10.0, 5.0, 40.0, 10.0, 180.0, 40.0, 250.0, 140.0, 70.0, 100.0, 110.0, 80.0, -350.0, 50.0, 10.0, 80.0, 265.0, 50.0, 100.0, 210.0, 60.0, 280.0, 310.0, 110.0, 150.0, 60.0, 240.0, 220.0, 30.0, 0.0, 70.0, 180.0, 100.0, 20.0, 100.0, 25.0, -95.0, 200.0, 90.0, 115.0, 280.0, 170.0, 210.0, 15.0, 15.0, 40.0, 0.0, 120.0, 320.0, 100.0, 80.0, 5.0, 20.0, 20.0, 300.0, 270.0, 70.0, 10.0, -20.0, 50.0, 30.0, 70.0, -10.0, 20.0, 70.0, 30.0, -80.0, 10.0, 80.0, 0.0, 350.0, 200.0, 30.0, 30.0, 100.0, 50.0, 20.0, 30.0, 0.0, 160.0, 0.0, 20.0, 160.0, 190.0, 10.0, 100.0, 190.0, 60.0, 100.0, 40.0, 200.0, 20.0, 100.0, 110.0, 40.0, 100.0, 100.0, 50.0, 105.0, 70.0, 80.0, 280.0, 350.0, 70.0, 130.0, 100.0, 110.0, 80.0, 160.0, 120.0, 50.0, 100.0, 30.0, 80.0, 40.0, 460.0, 60.0, 20.0, 170.0, 90.0, 90.0, 50.0, 70.0, 10.0, 60.0, 20.0, 0.0, 40.0, 40.0, 170.0, 140.0, 100.0, 140.0, 30.0, 20.0, 10.0, 20.0, 120.0, 110.0, 30.0, 0.0, 70.0, 0.0, 250.0, 30.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0, 80.0, 120.0, 20.0, 120.0, 20.0, 60.0, 210.0, 310.0, 230.0, 200.0, 20.0, 150.0, 410.0, 20.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 50.0, 130.0, 5.0, 30.0, 210.0, 30.0, 30.0, 120.0, 70.0, 190.0, 50.0, 630.0, 20.0, 30.0, 30.0, 70.0, 30.0, 40.0, 40.0, 20.0, 100.0, 190.0, 30.0, 0.0, 0.0, -10.0, 10.0, 470.0, 70.0, 60.0, 40.0, 180.0, 90.0, 90.0, 45.0, 140.0, 10.0, 320.0, 150.0, 20.0, 80.0, 100.0, 60.0, 30.0, 290.0, 90.0, 90.0, 20.0, 60.0, 160.0, 120.0, 20.0, 70.0, 160.0, 160.0, 280.0, 50.0, 20.0, 40.0, 110.0, 10.0, 530.0, 0.0, 40.0, 200.0, 380.0, 160.0, 70.0, 530.0, 180.0, 160.0, 60.0, 40.0, 50.0, 30.0, 10.0, 340.0, 110.0, 30.0, 320.0, 60.0, 90.0, 30.0, 300.0, 110.0, 110.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, 70.0, 0.0, 40.0, 60.0, 10.0, 70.0, 30.0, 95.0, 40.0, 0.0, 170.0, 0.0, 55.0, 20.0, 10.0, 200.0, 140.0, 150.0, 180.0, 10.0, 40.0, 200.0, 50.0, 60.0, 150.0, 80.0, 360.0, 150.0, 420.0, 70.0, 60.0, 70.0, 170.0, 70.0, 220.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 60.0, 30.0, 180.0, 70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 5.0, 70.0, 200.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, -15.0, 20.0, 30.0, 130.0, 60.0, 20.0, 60.0, 30.0, 20.0, 20.0, 50.0, 190.0, 90.0, 30.0, 10.0, 20.0, 75.0, 320.0, 120.0, 70.0, 30.0, 80.0, 60.0, 190.0, 150.0, 20.0, 70.0, 150.0, 10.0, 30.0, 60.0, 80.0, 30.0, 40.0, 10.0, 30.0, 90.0, 140.0, 30.0, 150.0, 40.0, 40.0, 10.0, 260.0, 330.0, 50.0, 60.0, 210.0, 160.0, 90.0, 150.0, 0.0, 60.0, 160.0, 40.0, 150.0, 110.0, 90.0, 120.0, 140.0, 170.0, 130.0, 110.0, 20.0, 170.0, 50.0, 40.0, 110.0, 170.0, 80.0, 80.0, 160.0, 70.0, 260.0, 210.0, 30.0, -10.0, 40.0, 40.0, 210.0, 30.0, 200.0, 20.0, 70.0, 130.0, 90.0, 470.0, -45.0, -10.0, 100.0, 110.0, 260.0, 570.0, 550.0, 30.0, 70.0, 20.0, 170.0, 200.0, 150.0, -30.0, 50.0, 180.0, 50.0, 80.0, 170.0, 30.0, 100.0, 25.0, 180.0, 340.0, 230.0, 60.0, 70.0, -40.0, 65.0, 50.0, 210.0, 30.0, 80.0, 190.0, 70.0, 100.0, 200.0, 0.0, -20.0, 120.0, -20.0, 140.0, 320.0, 570.0, -10.0, 270.0, 70.0, 310.0, 20.0, 20.0, 30.0, 100.0, 20.0, 20.0, 430.0, 110.0, 0.0, 50.0, 40.0, -10.0, 50.0, 40.0, 500.0, 190.0, 90.0, 70.0, 260.0, 0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5444720578349547, "mean_inference_ms": 1.4170600703637435, "mean_action_processing_ms": 0.45531172430657674, "mean_env_wait_ms": 1.2584640692368865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012382030487060547, "StateBufferConnector_ms": 0.009603500366210938, "ViewRequirementAgentConnector_ms": 0.374924898147583}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 920.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.66845371742387, "num_env_steps_trained_throughput_per_sec": 21.66845371742387, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 187213.776, "restore_workers_time_ms": 0.014, "training_step_time_ms": 187213.727, "sample_time_ms": 2532.758, "learn_time_ms": 184661.585, "learn_throughput": 21.661, "synch_weights_time_ms": 10.521}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "33e63_00000", "date": "2024-06-19_00-43-15", "timestamp": 1718772195, "time_this_iter_s": 184.609356880188, "time_total_s": 12977.332665681839, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276df1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12977.332665681839, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 16.3272030651341, "ram_util_percent": 79.49578544061303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.393574541312056, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.436814138505913, "policy_loss": -0.009231518284061624, "vf_loss": 6.444731622001234, "vf_explained_var": 0.0003835762524630188, "kl": 0.0065701567866569555, "entropy": 0.497394779994211, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 932.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 93.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [975.0, 1420.0, 870.0, 990.0, 1320.0, 1020.0, 860.0, 650.0, 1075.0, 640.0, 810.0, 1000.0, 1540.0, 860.0, 785.0, 870.0, 605.0, 840.0, 435.0, 1140.0, 745.0, 1440.0, 625.0, 1005.0, 655.0, 230.0, 700.0, 1250.0, 545.0, 225.0, 1020.0, 755.0, 1370.0, 1005.0, 905.0, 820.0, 670.0, 440.0, 1070.0, 1035.0, 1270.0, 1090.0, 650.0, 550.0, 350.0, 580.0, 1370.0, 760.0, 705.0, 1240.0, 420.0, 1195.0, 1230.0, 1100.0, 1490.0, 1470.0, 1170.0, 90.0, 360.0, 490.0, 1180.0, 1670.0, 490.0, 1560.0, 375.0, 265.0, 570.0, 975.0, 640.0, 800.0, 1270.0, 1080.0, 1190.0, 840.0, 2225.0, 890.0, 1285.0, 955.0, 1440.0, 1060.0, 1280.0, 380.0, 1355.0, 870.0, 1170.0, 495.0, 1190.0, 410.0, 400.0, 685.0, 1370.0, 1925.0, 990.0, 1290.0, 540.0, 410.0, 1480.0, 1030.0, 1325.0, 1135.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [95.0, 20.0, 390.0, 90.0, 30.0, 160.0, 20.0, -20.0, 160.0, 30.0, 250.0, 70.0, 240.0, 100.0, 110.0, 60.0, 70.0, 110.0, 60.0, 350.0, 110.0, 160.0, 110.0, 150.0, 50.0, -20.0, 120.0, 160.0, 10.0, 20.0, 110.0, 300.0, 80.0, 150.0, 40.0, 50.0, -10.0, 70.0, 10.0, 190.0, 220.0, 160.0, 120.0, -20.0, 550.0, 10.0, 30.0, 60.0, 120.0, 70.0, 80.0, 35.0, 100.0, 30.0, 180.0, 220.0, 25.0, 200.0, 50.0, 100.0, 180.0, 30.0, 5.0, 80.0, -40.0, 180.0, 150.0, -65.0, 60.0, 280.0, 70.0, 0.0, 20.0, 100.0, 20.0, 40.0, 0.0, 30.0, 260.0, 110.0, 110.0, 60.0, 70.0, 120.0, 65.0, 160.0, 60.0, 50.0, 180.0, 200.0, 30.0, 0.0, 190.0, 40.0, 60.0, 10.0, 30.0, 20.0, 260.0, 0.0, 340.0, 60.0, 90.0, 10.0, 20.0, 20.0, 160.0, 0.0, 40.0, 70.0, 10.0, 150.0, 5.0, -100.0, 10.0, 45.0, 170.0, 150.0, 320.0, 240.0, 280.0, -30.0, 0.0, 160.0, 50.0, 580.0, -10.0, 310.0, 100.0, 100.0, 90.0, 40.0, 90.0, 110.0, 70.0, 260.0, 100.0, -20.0, 60.0, 60.0, 100.0, 30.0, 220.0, 70.0, 20.0, 40.0, 60.0, 180.0, 30.0, 35.0, 170.0, 50.0, 220.0, 30.0, 35.0, 190.0, 30.0, -5.0, 40.0, 110.0, 5.0, 50.0, 10.0, 150.0, 20.0, 60.0, 20.0, 260.0, 10.0, 20.0, 30.0, 0.0, 30.0, 210.0, 260.0, 20.0, -10.0, 20.0, 260.0, 20.0, 50.0, 60.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 60.0, 160.0, 340.0, 20.0, -30.0, 20.0, 90.0, 90.0, 70.0, 30.0, 290.0, 220.0, 260.0, -5.0, 50.0, 80.0, 30.0, 0.0, 200.0, 30.0, 50.0, 50.0, 440.0, 260.0, 20.0, 80.0, 30.0, 20.0, 80.0, 430.0, 30.0, 50.0, 90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0, 20.0, 350.0, -5.0, 100.0, 30.0, 110.0, 90.0, 40.0, 100.0, 170.0, 80.0, 120.0, 80.0, 50.0, 90.0, 25.0, 70.0, 10.0, 40.0, 90.0, 0.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 30.0, 170.0, 40.0, 60.0, 30.0, 0.0, 170.0, 20.0, 250.0, -90.0, 50.0, 60.0, 80.0, 20.0, 70.0, 360.0, 190.0, 90.0, 230.0, 130.0, 20.0, 100.0, -40.0, 120.0, 35.0, 20.0, 180.0, 10.0, -10.0, -40.0, 170.0, 20.0, 20.0, 20.0, 80.0, 0.0, 20.0, 30.0, 20.0, 10.0, 5.0, 40.0, 10.0, 180.0, 40.0, 250.0, 140.0, 70.0, 100.0, 110.0, 80.0, -350.0, 50.0, 10.0, 80.0, 265.0, 50.0, 100.0, 210.0, 60.0, 280.0, 310.0, 110.0, 150.0, 60.0, 240.0, 220.0, 30.0, 0.0, 70.0, 180.0, 100.0, 20.0, 100.0, 25.0, -95.0, 200.0, 90.0, 115.0, 280.0, 170.0, 210.0, 15.0, 15.0, 40.0, 0.0, 120.0, 320.0, 100.0, 80.0, 5.0, 20.0, 20.0, 300.0, 270.0, 70.0, 10.0, -20.0, 50.0, 30.0, 70.0, -10.0, 20.0, 70.0, 30.0, -80.0, 10.0, 80.0, 0.0, 350.0, 200.0, 30.0, 30.0, 100.0, 50.0, 20.0, 30.0, 0.0, 160.0, 0.0, 20.0, 160.0, 190.0, 10.0, 100.0, 190.0, 60.0, 100.0, 40.0, 200.0, 20.0, 100.0, 110.0, 40.0, 100.0, 100.0, 50.0, 105.0, 70.0, 80.0, 280.0, 350.0, 70.0, 130.0, 100.0, 110.0, 80.0, 160.0, 120.0, 50.0, 100.0, 30.0, 80.0, 40.0, 460.0, 60.0, 20.0, 170.0, 90.0, 90.0, 50.0, 70.0, 10.0, 60.0, 20.0, 0.0, 40.0, 40.0, 170.0, 140.0, 100.0, 140.0, 30.0, 20.0, 10.0, 20.0, 120.0, 110.0, 30.0, 0.0, 70.0, 0.0, 250.0, 30.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0, 80.0, 120.0, 20.0, 120.0, 20.0, 60.0, 210.0, 310.0, 230.0, 200.0, 20.0, 150.0, 410.0, 20.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 50.0, 130.0, 5.0, 30.0, 210.0, 30.0, 30.0, 120.0, 70.0, 190.0, 50.0, 630.0, 20.0, 30.0, 30.0, 70.0, 30.0, 40.0, 40.0, 20.0, 100.0, 190.0, 30.0, 0.0, 0.0, -10.0, 10.0, 470.0, 70.0, 60.0, 40.0, 180.0, 90.0, 90.0, 45.0, 140.0, 10.0, 320.0, 150.0, 20.0, 80.0, 100.0, 60.0, 30.0, 290.0, 90.0, 90.0, 20.0, 60.0, 160.0, 120.0, 20.0, 70.0, 160.0, 160.0, 280.0, 50.0, 20.0, 40.0, 110.0, 10.0, 530.0, 0.0, 40.0, 200.0, 380.0, 160.0, 70.0, 530.0, 180.0, 160.0, 60.0, 40.0, 50.0, 30.0, 10.0, 340.0, 110.0, 30.0, 320.0, 60.0, 90.0, 30.0, 300.0, 110.0, 110.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, 70.0, 0.0, 40.0, 60.0, 10.0, 70.0, 30.0, 95.0, 40.0, 0.0, 170.0, 0.0, 55.0, 20.0, 10.0, 200.0, 140.0, 150.0, 180.0, 10.0, 40.0, 200.0, 50.0, 60.0, 150.0, 80.0, 360.0, 150.0, 420.0, 70.0, 60.0, 70.0, 170.0, 70.0, 220.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 60.0, 30.0, 180.0, 70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 5.0, 70.0, 200.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, -15.0, 20.0, 30.0, 130.0, 60.0, 20.0, 60.0, 30.0, 20.0, 20.0, 50.0, 190.0, 90.0, 30.0, 10.0, 20.0, 75.0, 320.0, 120.0, 70.0, 30.0, 80.0, 60.0, 190.0, 150.0, 20.0, 70.0, 150.0, 10.0, 30.0, 60.0, 80.0, 30.0, 40.0, 10.0, 30.0, 90.0, 140.0, 30.0, 150.0, 40.0, 40.0, 10.0, 260.0, 330.0, 50.0, 60.0, 210.0, 160.0, 90.0, 150.0, 0.0, 60.0, 160.0, 40.0, 150.0, 110.0, 90.0, 120.0, 140.0, 170.0, 130.0, 110.0, 20.0, 170.0, 50.0, 40.0, 110.0, 170.0, 80.0, 80.0, 160.0, 70.0, 260.0, 210.0, 30.0, -10.0, 40.0, 40.0, 210.0, 30.0, 200.0, 20.0, 70.0, 130.0, 90.0, 470.0, -45.0, -10.0, 100.0, 110.0, 260.0, 570.0, 550.0, 30.0, 70.0, 20.0, 170.0, 200.0, 150.0, -30.0, 50.0, 180.0, 50.0, 80.0, 170.0, 30.0, 100.0, 25.0, 180.0, 340.0, 230.0, 60.0, 70.0, -40.0, 65.0, 50.0, 210.0, 30.0, 80.0, 190.0, 70.0, 100.0, 200.0, 0.0, -20.0, 120.0, -20.0, 140.0, 320.0, 570.0, -10.0, 270.0, 70.0, 310.0, 20.0, 20.0, 30.0, 100.0, 20.0, 20.0, 430.0, 110.0, 0.0, 50.0, 40.0, -10.0, 50.0, 40.0, 500.0, 190.0, 90.0, 70.0, 260.0, 0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0, 105.0, 20.0, 80.0, 30.0, 250.0, 120.0, 20.0, 20.0, 120.0, 590.0, 170.0, 30.0, 40.0, 220.0, 90.0, 60.0, 120.0, 80.0, 40.0, 20.0, -40.0, 560.0, 40.0, 10.0, 70.0, 30.0, 90.0, 70.0, 250.0, 90.0, 40.0, -25.0, -20.0, 20.0, 5.0, 300.0, 10.0, 40.0, 15.0, 110.0, 180.0, 70.0, 170.0, 290.0, 80.0, 60.0, 50.0, -10.0, 230.0, 70.0, 20.0, -30.0, 40.0, 40.0, 0.0, 20.0, 40.0, 10.0, 220.0, 50.0, 60.0, 60.0, 50.0, -130.0, 70.0, -100.0, 80.0, 170.0, 60.0, 80.0, 30.0, 190.0, 30.0, 20.0, 20.0, 70.0, 110.0, 90.0, 90.0, 35.0, 30.0, 70.0, 160.0, 50.0, 60.0, 40.0, 200.0, 150.0, 510.0, 100.0, 60.0, 190.0, 330.0, -10.0, 210.0, 370.0, 360.0, 90.0, 240.0, 85.0, 20.0, 80.0, 0.0, 70.0, 80.0, 250.0, 330.0, 40.0, 40.0, 80.0, 140.0, 200.0, 90.0, 230.0, 110.0, 270.0, 50.0, 10.0, 120.0, 70.0, 80.0, 40.0, 10.0, 70.0, 160.0, 40.0, 30.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 100.0, 30.0, 70.0, 0.0, 70.0, 20.0, 120.0, 80.0, 230.0, 60.0, 70.0, 90.0, 110.0, 600.0, 80.0, 40.0, 120.0, 140.0, 90.0, 190.0, 90.0, 120.0, 100.0, 60.0, 140.0, -20.0, 80.0, 75.0, 60.0, 55.0, 60.0, 330.0, -5.0, 180.0, 90.0, 400.0, 35.0, 80.0, 260.0, 10.0, 0.0, 60.0, 330.0, 10.0, 240.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.544191661513635, "mean_inference_ms": 1.4164435710877366, "mean_action_processing_ms": 0.45429480584394194, "mean_env_wait_ms": 1.2578016400178162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012378692626953125, "StateBufferConnector_ms": 0.009235143661499023, "ViewRequirementAgentConnector_ms": 0.3776545524597168}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 932.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.568346782524895, "num_env_steps_trained_throughput_per_sec": 21.568346782524895, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 186829.221, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186829.171, "sample_time_ms": 2517.926, "learn_time_ms": 184291.779, "learn_throughput": 21.705, "synch_weights_time_ms": 10.363}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "33e63_00000", "date": "2024-06-19_00-46-20", "timestamp": 1718772380, "time_this_iter_s": 185.46735095977783, "time_total_s": 13162.800016641617, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277c6ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13162.800016641617, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 16.528625954198475, "ram_util_percent": 78.85419847328245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7236706174283234, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.000242662785279, "policy_loss": -0.009436404191964743, "vf_loss": 7.008405395666251, "vf_explained_var": 0.0002535693688641468, "kl": 0.00636836695813878, "entropy": 0.46638978366145944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 930.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 93.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [625.0, 1005.0, 655.0, 230.0, 700.0, 1250.0, 545.0, 225.0, 1020.0, 755.0, 1370.0, 1005.0, 905.0, 820.0, 670.0, 440.0, 1070.0, 1035.0, 1270.0, 1090.0, 650.0, 550.0, 350.0, 580.0, 1370.0, 760.0, 705.0, 1240.0, 420.0, 1195.0, 1230.0, 1100.0, 1490.0, 1470.0, 1170.0, 90.0, 360.0, 490.0, 1180.0, 1670.0, 490.0, 1560.0, 375.0, 265.0, 570.0, 975.0, 640.0, 800.0, 1270.0, 1080.0, 1190.0, 840.0, 2225.0, 890.0, 1285.0, 955.0, 1440.0, 1060.0, 1280.0, 380.0, 1355.0, 870.0, 1170.0, 495.0, 1190.0, 410.0, 400.0, 685.0, 1370.0, 1925.0, 990.0, 1290.0, 540.0, 410.0, 1480.0, 1030.0, 1325.0, 1135.0, 1035.0, 1200.0, 2020.0, 1555.0, 1230.0, 1410.0, 215.0, 1050.0, 580.0, 380.0, 705.0, 855.0, 1000.0, 1025.0, 340.0, 865.0, 915.0, 315.0, 395.0, 1310.0, 780.0, 1475.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 10.0, 40.0, 25.0, 100.0, 150.0, 160.0, 20.0, 0.0, 30.0, 20.0, 350.0, -5.0, 100.0, 30.0, 110.0, 90.0, 40.0, 100.0, 170.0, 80.0, 120.0, 80.0, 50.0, 90.0, 25.0, 70.0, 10.0, 40.0, 90.0, 0.0, 50.0, 0.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 30.0, 170.0, 40.0, 60.0, 30.0, 0.0, 170.0, 20.0, 250.0, -90.0, 50.0, 60.0, 80.0, 20.0, 70.0, 360.0, 190.0, 90.0, 230.0, 130.0, 20.0, 100.0, -40.0, 120.0, 35.0, 20.0, 180.0, 10.0, -10.0, -40.0, 170.0, 20.0, 20.0, 20.0, 80.0, 0.0, 20.0, 30.0, 20.0, 10.0, 5.0, 40.0, 10.0, 180.0, 40.0, 250.0, 140.0, 70.0, 100.0, 110.0, 80.0, -350.0, 50.0, 10.0, 80.0, 265.0, 50.0, 100.0, 210.0, 60.0, 280.0, 310.0, 110.0, 150.0, 60.0, 240.0, 220.0, 30.0, 0.0, 70.0, 180.0, 100.0, 20.0, 100.0, 25.0, -95.0, 200.0, 90.0, 115.0, 280.0, 170.0, 210.0, 15.0, 15.0, 40.0, 0.0, 120.0, 320.0, 100.0, 80.0, 5.0, 20.0, 20.0, 300.0, 270.0, 70.0, 10.0, -20.0, 50.0, 30.0, 70.0, -10.0, 20.0, 70.0, 30.0, -80.0, 10.0, 80.0, 0.0, 350.0, 200.0, 30.0, 30.0, 100.0, 50.0, 20.0, 30.0, 0.0, 160.0, 0.0, 20.0, 160.0, 190.0, 10.0, 100.0, 190.0, 60.0, 100.0, 40.0, 200.0, 20.0, 100.0, 110.0, 40.0, 100.0, 100.0, 50.0, 105.0, 70.0, 80.0, 280.0, 350.0, 70.0, 130.0, 100.0, 110.0, 80.0, 160.0, 120.0, 50.0, 100.0, 30.0, 80.0, 40.0, 460.0, 60.0, 20.0, 170.0, 90.0, 90.0, 50.0, 70.0, 10.0, 60.0, 20.0, 0.0, 40.0, 40.0, 170.0, 140.0, 100.0, 140.0, 30.0, 20.0, 10.0, 20.0, 120.0, 110.0, 30.0, 0.0, 70.0, 0.0, 250.0, 30.0, 10.0, 0.0, 30.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0, 80.0, 120.0, 20.0, 120.0, 20.0, 60.0, 210.0, 310.0, 230.0, 200.0, 20.0, 150.0, 410.0, 20.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 50.0, 130.0, 5.0, 30.0, 210.0, 30.0, 30.0, 120.0, 70.0, 190.0, 50.0, 630.0, 20.0, 30.0, 30.0, 70.0, 30.0, 40.0, 40.0, 20.0, 100.0, 190.0, 30.0, 0.0, 0.0, -10.0, 10.0, 470.0, 70.0, 60.0, 40.0, 180.0, 90.0, 90.0, 45.0, 140.0, 10.0, 320.0, 150.0, 20.0, 80.0, 100.0, 60.0, 30.0, 290.0, 90.0, 90.0, 20.0, 60.0, 160.0, 120.0, 20.0, 70.0, 160.0, 160.0, 280.0, 50.0, 20.0, 40.0, 110.0, 10.0, 530.0, 0.0, 40.0, 200.0, 380.0, 160.0, 70.0, 530.0, 180.0, 160.0, 60.0, 40.0, 50.0, 30.0, 10.0, 340.0, 110.0, 30.0, 320.0, 60.0, 90.0, 30.0, 300.0, 110.0, 110.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, 70.0, 0.0, 40.0, 60.0, 10.0, 70.0, 30.0, 95.0, 40.0, 0.0, 170.0, 0.0, 55.0, 20.0, 10.0, 200.0, 140.0, 150.0, 180.0, 10.0, 40.0, 200.0, 50.0, 60.0, 150.0, 80.0, 360.0, 150.0, 420.0, 70.0, 60.0, 70.0, 170.0, 70.0, 220.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 60.0, 30.0, 180.0, 70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 5.0, 70.0, 200.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, -15.0, 20.0, 30.0, 130.0, 60.0, 20.0, 60.0, 30.0, 20.0, 20.0, 50.0, 190.0, 90.0, 30.0, 10.0, 20.0, 75.0, 320.0, 120.0, 70.0, 30.0, 80.0, 60.0, 190.0, 150.0, 20.0, 70.0, 150.0, 10.0, 30.0, 60.0, 80.0, 30.0, 40.0, 10.0, 30.0, 90.0, 140.0, 30.0, 150.0, 40.0, 40.0, 10.0, 260.0, 330.0, 50.0, 60.0, 210.0, 160.0, 90.0, 150.0, 0.0, 60.0, 160.0, 40.0, 150.0, 110.0, 90.0, 120.0, 140.0, 170.0, 130.0, 110.0, 20.0, 170.0, 50.0, 40.0, 110.0, 170.0, 80.0, 80.0, 160.0, 70.0, 260.0, 210.0, 30.0, -10.0, 40.0, 40.0, 210.0, 30.0, 200.0, 20.0, 70.0, 130.0, 90.0, 470.0, -45.0, -10.0, 100.0, 110.0, 260.0, 570.0, 550.0, 30.0, 70.0, 20.0, 170.0, 200.0, 150.0, -30.0, 50.0, 180.0, 50.0, 80.0, 170.0, 30.0, 100.0, 25.0, 180.0, 340.0, 230.0, 60.0, 70.0, -40.0, 65.0, 50.0, 210.0, 30.0, 80.0, 190.0, 70.0, 100.0, 200.0, 0.0, -20.0, 120.0, -20.0, 140.0, 320.0, 570.0, -10.0, 270.0, 70.0, 310.0, 20.0, 20.0, 30.0, 100.0, 20.0, 20.0, 430.0, 110.0, 0.0, 50.0, 40.0, -10.0, 50.0, 40.0, 500.0, 190.0, 90.0, 70.0, 260.0, 0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0, 105.0, 20.0, 80.0, 30.0, 250.0, 120.0, 20.0, 20.0, 120.0, 590.0, 170.0, 30.0, 40.0, 220.0, 90.0, 60.0, 120.0, 80.0, 40.0, 20.0, -40.0, 560.0, 40.0, 10.0, 70.0, 30.0, 90.0, 70.0, 250.0, 90.0, 40.0, -25.0, -20.0, 20.0, 5.0, 300.0, 10.0, 40.0, 15.0, 110.0, 180.0, 70.0, 170.0, 290.0, 80.0, 60.0, 50.0, -10.0, 230.0, 70.0, 20.0, -30.0, 40.0, 40.0, 0.0, 20.0, 40.0, 10.0, 220.0, 50.0, 60.0, 60.0, 50.0, -130.0, 70.0, -100.0, 80.0, 170.0, 60.0, 80.0, 30.0, 190.0, 30.0, 20.0, 20.0, 70.0, 110.0, 90.0, 90.0, 35.0, 30.0, 70.0, 160.0, 50.0, 60.0, 40.0, 200.0, 150.0, 510.0, 100.0, 60.0, 190.0, 330.0, -10.0, 210.0, 370.0, 360.0, 90.0, 240.0, 85.0, 20.0, 80.0, 0.0, 70.0, 80.0, 250.0, 330.0, 40.0, 40.0, 80.0, 140.0, 200.0, 90.0, 230.0, 110.0, 270.0, 50.0, 10.0, 120.0, 70.0, 80.0, 40.0, 10.0, 70.0, 160.0, 40.0, 30.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 100.0, 30.0, 70.0, 0.0, 70.0, 20.0, 120.0, 80.0, 230.0, 60.0, 70.0, 90.0, 110.0, 600.0, 80.0, 40.0, 120.0, 140.0, 90.0, 190.0, 90.0, 120.0, 100.0, 60.0, 140.0, -20.0, 80.0, 75.0, 60.0, 55.0, 60.0, 330.0, -5.0, 180.0, 90.0, 400.0, 35.0, 80.0, 260.0, 10.0, 0.0, 60.0, 330.0, 10.0, 240.0, 110.0, -20.0, 70.0, 80.0, 10.0, 170.0, 60.0, 180.0, 170.0, 25.0, 290.0, 110.0, 90.0, 20.0, 40.0, 100.0, 40.0, 320.0, 130.0, 190.0, 160.0, 110.0, 600.0, 20.0, 360.0, 110.0, 90.0, 70.0, 260.0, 190.0, 210.0, 170.0, 220.0, 110.0, 20.0, 120.0, -25.0, 50.0, 40.0, 450.0, 400.0, 80.0, -130.0, 10.0, 210.0, 300.0, 310.0, 50.0, 20.0, 170.0, 210.0, -70.0, 120.0, 30.0, 70.0, 250.0, 120.0, 80.0, 520.0, 170.0, 120.0, 150.0, 10.0, 30.0, 50.0, 10.0, 0.0, -55.0, 10.0, 10.0, 0.0, 110.0, 200.0, 40.0, 20.0, 50.0, 60.0, 250.0, 80.0, 10.0, 230.0, 40.0, 50.0, 5.0, -5.0, 30.0, 10.0, 130.0, 50.0, 130.0, 140.0, 10.0, 100.0, 20.0, 30.0, 10.0, 150.0, 0.0, 30.0, 30.0, 0.0, 180.0, 0.0, 0.0, 75.0, 170.0, 0.0, 30.0, 170.0, 0.0, 80.0, 110.0, 115.0, 90.0, 240.0, 0.0, 60.0, 150.0, 20.0, 50.0, 20.0, 250.0, 50.0, 160.0, 70.0, 30.0, 50.0, 260.0, 110.0, 20.0, 0.0, 410.0, 20.0, 30.0, 25.0, -10.0, 90.0, 270.0, -10.0, 180.0, 20.0, 60.0, 0.0, 60.0, 160.0, 20.0, 20.0, -20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 100.0, 100.0, 30.0, 210.0, 30.0, 15.0, 320.0, -10.0, 110.0, 150.0, 40.0, 30.0, 20.0, 65.0, 200.0, 300.0, 10.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 30.0, 0.0, 35.0, 90.0, 30.0, -5.0, 65.0, 10.0, 160.0, 50.0, 30.0, -45.0, -10.0, 110.0, 80.0, 230.0, 90.0, 300.0, 20.0, 40.0, 10.0, 30.0, 90.0, 420.0, 70.0, 30.0, 300.0, 20.0, 60.0, 80.0, 50.0, 10.0, 140.0, 20.0, 270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5434091630996902, "mean_inference_ms": 1.4159554980541347, "mean_action_processing_ms": 0.4529879130536809, "mean_env_wait_ms": 1.2569891508830358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012802600860595703, "StateBufferConnector_ms": 0.00953054428100586, "ViewRequirementAgentConnector_ms": 0.38058972358703613}, "num_episodes": 22, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 930.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.58581042307995, "num_env_steps_trained_throughput_per_sec": 21.58581042307995, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 186408.429, "restore_workers_time_ms": 0.014, "training_step_time_ms": 186408.379, "sample_time_ms": 2506.322, "learn_time_ms": 183881.816, "learn_throughput": 21.753, "synch_weights_time_ms": 10.526}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "33e63_00000", "date": "2024-06-19_00-49-25", "timestamp": 1718772565, "time_this_iter_s": 185.32158207893372, "time_total_s": 13348.12159872055, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13348.12159872055, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 16.153435114503818, "ram_util_percent": 79.52671755725191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7804144781999316, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.414386223578733, "policy_loss": -0.00903564330259352, "vf_loss": 7.422089862163328, "vf_explained_var": 0.0008461960207540006, "kl": 0.006659977130960352, "entropy": 0.4351906700446583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 90.0, "episode_reward_mean": 981.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 98.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [580.0, 1370.0, 760.0, 705.0, 1240.0, 420.0, 1195.0, 1230.0, 1100.0, 1490.0, 1470.0, 1170.0, 90.0, 360.0, 490.0, 1180.0, 1670.0, 490.0, 1560.0, 375.0, 265.0, 570.0, 975.0, 640.0, 800.0, 1270.0, 1080.0, 1190.0, 840.0, 2225.0, 890.0, 1285.0, 955.0, 1440.0, 1060.0, 1280.0, 380.0, 1355.0, 870.0, 1170.0, 495.0, 1190.0, 410.0, 400.0, 685.0, 1370.0, 1925.0, 990.0, 1290.0, 540.0, 410.0, 1480.0, 1030.0, 1325.0, 1135.0, 1035.0, 1200.0, 2020.0, 1555.0, 1230.0, 1410.0, 215.0, 1050.0, 580.0, 380.0, 705.0, 855.0, 1000.0, 1025.0, 340.0, 865.0, 915.0, 315.0, 395.0, 1310.0, 780.0, 1475.0, 885.0, 1580.0, 875.0, 1250.0, 910.0, 660.0, 1260.0, 580.0, 910.0, 1590.0, 1200.0, 925.0, 1035.0, 1245.0, 980.0, 630.0, 645.0, 960.0, 920.0, 1455.0, 995.0, 540.0, 1290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 10.0, 10.0, 60.0, 180.0, 90.0, 80.0, 50.0, 70.0, 0.0, 80.0, 120.0, 20.0, 120.0, 20.0, 60.0, 210.0, 310.0, 230.0, 200.0, 20.0, 150.0, 410.0, 20.0, 30.0, 40.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 50.0, 130.0, 5.0, 30.0, 210.0, 30.0, 30.0, 120.0, 70.0, 190.0, 50.0, 630.0, 20.0, 30.0, 30.0, 70.0, 30.0, 40.0, 40.0, 20.0, 100.0, 190.0, 30.0, 0.0, 0.0, -10.0, 10.0, 470.0, 70.0, 60.0, 40.0, 180.0, 90.0, 90.0, 45.0, 140.0, 10.0, 320.0, 150.0, 20.0, 80.0, 100.0, 60.0, 30.0, 290.0, 90.0, 90.0, 20.0, 60.0, 160.0, 120.0, 20.0, 70.0, 160.0, 160.0, 280.0, 50.0, 20.0, 40.0, 110.0, 10.0, 530.0, 0.0, 40.0, 200.0, 380.0, 160.0, 70.0, 530.0, 180.0, 160.0, 60.0, 40.0, 50.0, 30.0, 10.0, 340.0, 110.0, 30.0, 320.0, 60.0, 90.0, 30.0, 300.0, 110.0, 110.0, 10.0, 10.0, 20.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, 70.0, 0.0, 40.0, 60.0, 10.0, 70.0, 30.0, 95.0, 40.0, 0.0, 170.0, 0.0, 55.0, 20.0, 10.0, 200.0, 140.0, 150.0, 180.0, 10.0, 40.0, 200.0, 50.0, 60.0, 150.0, 80.0, 360.0, 150.0, 420.0, 70.0, 60.0, 70.0, 170.0, 70.0, 220.0, 20.0, 40.0, 20.0, 30.0, 20.0, 60.0, 30.0, 60.0, 30.0, 180.0, 70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 5.0, 70.0, 200.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, -15.0, 20.0, 30.0, 130.0, 60.0, 20.0, 60.0, 30.0, 20.0, 20.0, 50.0, 190.0, 90.0, 30.0, 10.0, 20.0, 75.0, 320.0, 120.0, 70.0, 30.0, 80.0, 60.0, 190.0, 150.0, 20.0, 70.0, 150.0, 10.0, 30.0, 60.0, 80.0, 30.0, 40.0, 10.0, 30.0, 90.0, 140.0, 30.0, 150.0, 40.0, 40.0, 10.0, 260.0, 330.0, 50.0, 60.0, 210.0, 160.0, 90.0, 150.0, 0.0, 60.0, 160.0, 40.0, 150.0, 110.0, 90.0, 120.0, 140.0, 170.0, 130.0, 110.0, 20.0, 170.0, 50.0, 40.0, 110.0, 170.0, 80.0, 80.0, 160.0, 70.0, 260.0, 210.0, 30.0, -10.0, 40.0, 40.0, 210.0, 30.0, 200.0, 20.0, 70.0, 130.0, 90.0, 470.0, -45.0, -10.0, 100.0, 110.0, 260.0, 570.0, 550.0, 30.0, 70.0, 20.0, 170.0, 200.0, 150.0, -30.0, 50.0, 180.0, 50.0, 80.0, 170.0, 30.0, 100.0, 25.0, 180.0, 340.0, 230.0, 60.0, 70.0, -40.0, 65.0, 50.0, 210.0, 30.0, 80.0, 190.0, 70.0, 100.0, 200.0, 0.0, -20.0, 120.0, -20.0, 140.0, 320.0, 570.0, -10.0, 270.0, 70.0, 310.0, 20.0, 20.0, 30.0, 100.0, 20.0, 20.0, 430.0, 110.0, 0.0, 50.0, 40.0, -10.0, 50.0, 40.0, 500.0, 190.0, 90.0, 70.0, 260.0, 0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0, 105.0, 20.0, 80.0, 30.0, 250.0, 120.0, 20.0, 20.0, 120.0, 590.0, 170.0, 30.0, 40.0, 220.0, 90.0, 60.0, 120.0, 80.0, 40.0, 20.0, -40.0, 560.0, 40.0, 10.0, 70.0, 30.0, 90.0, 70.0, 250.0, 90.0, 40.0, -25.0, -20.0, 20.0, 5.0, 300.0, 10.0, 40.0, 15.0, 110.0, 180.0, 70.0, 170.0, 290.0, 80.0, 60.0, 50.0, -10.0, 230.0, 70.0, 20.0, -30.0, 40.0, 40.0, 0.0, 20.0, 40.0, 10.0, 220.0, 50.0, 60.0, 60.0, 50.0, -130.0, 70.0, -100.0, 80.0, 170.0, 60.0, 80.0, 30.0, 190.0, 30.0, 20.0, 20.0, 70.0, 110.0, 90.0, 90.0, 35.0, 30.0, 70.0, 160.0, 50.0, 60.0, 40.0, 200.0, 150.0, 510.0, 100.0, 60.0, 190.0, 330.0, -10.0, 210.0, 370.0, 360.0, 90.0, 240.0, 85.0, 20.0, 80.0, 0.0, 70.0, 80.0, 250.0, 330.0, 40.0, 40.0, 80.0, 140.0, 200.0, 90.0, 230.0, 110.0, 270.0, 50.0, 10.0, 120.0, 70.0, 80.0, 40.0, 10.0, 70.0, 160.0, 40.0, 30.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 100.0, 30.0, 70.0, 0.0, 70.0, 20.0, 120.0, 80.0, 230.0, 60.0, 70.0, 90.0, 110.0, 600.0, 80.0, 40.0, 120.0, 140.0, 90.0, 190.0, 90.0, 120.0, 100.0, 60.0, 140.0, -20.0, 80.0, 75.0, 60.0, 55.0, 60.0, 330.0, -5.0, 180.0, 90.0, 400.0, 35.0, 80.0, 260.0, 10.0, 0.0, 60.0, 330.0, 10.0, 240.0, 110.0, -20.0, 70.0, 80.0, 10.0, 170.0, 60.0, 180.0, 170.0, 25.0, 290.0, 110.0, 90.0, 20.0, 40.0, 100.0, 40.0, 320.0, 130.0, 190.0, 160.0, 110.0, 600.0, 20.0, 360.0, 110.0, 90.0, 70.0, 260.0, 190.0, 210.0, 170.0, 220.0, 110.0, 20.0, 120.0, -25.0, 50.0, 40.0, 450.0, 400.0, 80.0, -130.0, 10.0, 210.0, 300.0, 310.0, 50.0, 20.0, 170.0, 210.0, -70.0, 120.0, 30.0, 70.0, 250.0, 120.0, 80.0, 520.0, 170.0, 120.0, 150.0, 10.0, 30.0, 50.0, 10.0, 0.0, -55.0, 10.0, 10.0, 0.0, 110.0, 200.0, 40.0, 20.0, 50.0, 60.0, 250.0, 80.0, 10.0, 230.0, 40.0, 50.0, 5.0, -5.0, 30.0, 10.0, 130.0, 50.0, 130.0, 140.0, 10.0, 100.0, 20.0, 30.0, 10.0, 150.0, 0.0, 30.0, 30.0, 0.0, 180.0, 0.0, 0.0, 75.0, 170.0, 0.0, 30.0, 170.0, 0.0, 80.0, 110.0, 115.0, 90.0, 240.0, 0.0, 60.0, 150.0, 20.0, 50.0, 20.0, 250.0, 50.0, 160.0, 70.0, 30.0, 50.0, 260.0, 110.0, 20.0, 0.0, 410.0, 20.0, 30.0, 25.0, -10.0, 90.0, 270.0, -10.0, 180.0, 20.0, 60.0, 0.0, 60.0, 160.0, 20.0, 20.0, -20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 100.0, 100.0, 30.0, 210.0, 30.0, 15.0, 320.0, -10.0, 110.0, 150.0, 40.0, 30.0, 20.0, 65.0, 200.0, 300.0, 10.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 30.0, 0.0, 35.0, 90.0, 30.0, -5.0, 65.0, 10.0, 160.0, 50.0, 30.0, -45.0, -10.0, 110.0, 80.0, 230.0, 90.0, 300.0, 20.0, 40.0, 10.0, 30.0, 90.0, 420.0, 70.0, 30.0, 300.0, 20.0, 60.0, 80.0, 50.0, 10.0, 140.0, 20.0, 270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0, 25.0, 60.0, 110.0, 50.0, 70.0, 230.0, 120.0, 120.0, 90.0, 10.0, 50.0, -10.0, 270.0, 120.0, 330.0, 180.0, 130.0, 100.0, 100.0, 310.0, 30.0, 30.0, 170.0, 100.0, 40.0, 40.0, 10.0, 40.0, 70.0, 345.0, 60.0, 140.0, 110.0, 40.0, 190.0, 250.0, 140.0, 190.0, 20.0, 110.0, 150.0, 200.0, 160.0, 10.0, 0.0, 210.0, 30.0, 10.0, 30.0, 110.0, 120.0, 20.0, 10.0, 30.0, 30.0, 70.0, 30.0, 110.0, 40.0, 200.0, 60.0, -50.0, 380.0, 110.0, -10.0, 110.0, 290.0, 60.0, 250.0, 60.0, 40.0, 0.0, 40.0, 40.0, 100.0, 30.0, 80.0, 120.0, 90.0, 40.0, 10.0, 30.0, 40.0, 400.0, 40.0, 150.0, 40.0, 130.0, 20.0, 50.0, 90.0, 210.0, 120.0, 160.0, 360.0, -70.0, 140.0, 250.0, 180.0, 150.0, 140.0, 70.0, 80.0, 50.0, 220.0, 220.0, 170.0, 70.0, 100.0, 80.0, 250.0, -30.0, 70.0, 310.0, 70.0, 60.0, 190.0, -45.0, 30.0, 20.0, 100.0, 240.0, 150.0, 25.0, -120.0, 130.0, 170.0, 140.0, 70.0, 130.0, -120.0, 70.0, 40.0, 440.0, 30.0, 135.0, 270.0, 210.0, 80.0, 90.0, 40.0, 35.0, 5.0, 120.0, 520.0, 10.0, 30.0, 60.0, -10.0, 170.0, -10.0, 140.0, 240.0, 30.0, 40.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 10.0, 210.0, 90.0, 10.0, 160.0, 10.0, 40.0, 30.0, 65.0, 100.0, 100.0, 130.0, 130.0, 210.0, 90.0, 230.0, -120.0, 70.0, 20.0, 150.0, 50.0, -15.0, 80.0, 300.0, 110.0, 60.0, 220.0, 70.0, -105.0, 330.0, 70.0, 75.0, 30.0, 340.0, 220.0, 30.0, 60.0, 170.0, 130.0, 70.0, 180.0, 100.0, 190.0, 30.0, 75.0, 60.0, 60.0, 160.0, 70.0, 100.0, 0.0, 40.0, 20.0, 60.0, 30.0, 30.0, 20.0, 90.0, 150.0, 40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5428788688510264, "mean_inference_ms": 1.4152856642314118, "mean_action_processing_ms": 0.4518256433559158, "mean_env_wait_ms": 1.2560132230955903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012681961059570312, "StateBufferConnector_ms": 0.010011911392211914, "ViewRequirementAgentConnector_ms": 0.38120317459106445}, "num_episodes": 23, "episode_return_max": 2225.0, "episode_return_min": 90.0, "episode_return_mean": 981.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.660882737583236, "num_env_steps_trained_throughput_per_sec": 21.660882737583236, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 185991.85, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185991.8, "sample_time_ms": 2495.068, "learn_time_ms": 183476.9, "learn_throughput": 21.801, "synch_weights_time_ms": 10.3}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "33e63_00000", "date": "2024-06-19_00-52-30", "timestamp": 1718772750, "time_this_iter_s": 184.67424416542053, "time_total_s": 13532.795842885971, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276faee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13532.795842885971, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 16.226819923371647, "ram_util_percent": 78.33295019157089}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6083054612873715, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.845188648987629, "policy_loss": -0.008571642996181452, "vf_loss": 6.852451269872907, "vf_explained_var": 0.0027873520399180974, "kl": 0.006545113511041636, "entropy": 0.4463872835785944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 2225.0, "episode_reward_min": 215.0, "episode_reward_mean": 953.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 95.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1560.0, 375.0, 265.0, 570.0, 975.0, 640.0, 800.0, 1270.0, 1080.0, 1190.0, 840.0, 2225.0, 890.0, 1285.0, 955.0, 1440.0, 1060.0, 1280.0, 380.0, 1355.0, 870.0, 1170.0, 495.0, 1190.0, 410.0, 400.0, 685.0, 1370.0, 1925.0, 990.0, 1290.0, 540.0, 410.0, 1480.0, 1030.0, 1325.0, 1135.0, 1035.0, 1200.0, 2020.0, 1555.0, 1230.0, 1410.0, 215.0, 1050.0, 580.0, 380.0, 705.0, 855.0, 1000.0, 1025.0, 340.0, 865.0, 915.0, 315.0, 395.0, 1310.0, 780.0, 1475.0, 885.0, 1580.0, 875.0, 1250.0, 910.0, 660.0, 1260.0, 580.0, 910.0, 1590.0, 1200.0, 925.0, 1035.0, 1245.0, 980.0, 630.0, 645.0, 960.0, 920.0, 1455.0, 995.0, 540.0, 1290.0, 490.0, 485.0, 1270.0, 665.0, 730.0, 1105.0, 570.0, 540.0, 1070.0, 495.0, 635.0, 930.0, 1430.0, 485.0, 1580.0, 265.0, 795.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 70.0, 170.0, -20.0, 360.0, 140.0, 130.0, 0.0, 290.0, 350.0, 0.0, 30.0, 30.0, 20.0, 10.0, 10.0, 0.0, 5.0, 70.0, 200.0, 10.0, 20.0, 20.0, 0.0, 40.0, 10.0, -15.0, 20.0, 30.0, 130.0, 60.0, 20.0, 60.0, 30.0, 20.0, 20.0, 50.0, 190.0, 90.0, 30.0, 10.0, 20.0, 75.0, 320.0, 120.0, 70.0, 30.0, 80.0, 60.0, 190.0, 150.0, 20.0, 70.0, 150.0, 10.0, 30.0, 60.0, 80.0, 30.0, 40.0, 10.0, 30.0, 90.0, 140.0, 30.0, 150.0, 40.0, 40.0, 10.0, 260.0, 330.0, 50.0, 60.0, 210.0, 160.0, 90.0, 150.0, 0.0, 60.0, 160.0, 40.0, 150.0, 110.0, 90.0, 120.0, 140.0, 170.0, 130.0, 110.0, 20.0, 170.0, 50.0, 40.0, 110.0, 170.0, 80.0, 80.0, 160.0, 70.0, 260.0, 210.0, 30.0, -10.0, 40.0, 40.0, 210.0, 30.0, 200.0, 20.0, 70.0, 130.0, 90.0, 470.0, -45.0, -10.0, 100.0, 110.0, 260.0, 570.0, 550.0, 30.0, 70.0, 20.0, 170.0, 200.0, 150.0, -30.0, 50.0, 180.0, 50.0, 80.0, 170.0, 30.0, 100.0, 25.0, 180.0, 340.0, 230.0, 60.0, 70.0, -40.0, 65.0, 50.0, 210.0, 30.0, 80.0, 190.0, 70.0, 100.0, 200.0, 0.0, -20.0, 120.0, -20.0, 140.0, 320.0, 570.0, -10.0, 270.0, 70.0, 310.0, 20.0, 20.0, 30.0, 100.0, 20.0, 20.0, 430.0, 110.0, 0.0, 50.0, 40.0, -10.0, 50.0, 40.0, 500.0, 190.0, 90.0, 70.0, 260.0, 0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0, 105.0, 20.0, 80.0, 30.0, 250.0, 120.0, 20.0, 20.0, 120.0, 590.0, 170.0, 30.0, 40.0, 220.0, 90.0, 60.0, 120.0, 80.0, 40.0, 20.0, -40.0, 560.0, 40.0, 10.0, 70.0, 30.0, 90.0, 70.0, 250.0, 90.0, 40.0, -25.0, -20.0, 20.0, 5.0, 300.0, 10.0, 40.0, 15.0, 110.0, 180.0, 70.0, 170.0, 290.0, 80.0, 60.0, 50.0, -10.0, 230.0, 70.0, 20.0, -30.0, 40.0, 40.0, 0.0, 20.0, 40.0, 10.0, 220.0, 50.0, 60.0, 60.0, 50.0, -130.0, 70.0, -100.0, 80.0, 170.0, 60.0, 80.0, 30.0, 190.0, 30.0, 20.0, 20.0, 70.0, 110.0, 90.0, 90.0, 35.0, 30.0, 70.0, 160.0, 50.0, 60.0, 40.0, 200.0, 150.0, 510.0, 100.0, 60.0, 190.0, 330.0, -10.0, 210.0, 370.0, 360.0, 90.0, 240.0, 85.0, 20.0, 80.0, 0.0, 70.0, 80.0, 250.0, 330.0, 40.0, 40.0, 80.0, 140.0, 200.0, 90.0, 230.0, 110.0, 270.0, 50.0, 10.0, 120.0, 70.0, 80.0, 40.0, 10.0, 70.0, 160.0, 40.0, 30.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 100.0, 30.0, 70.0, 0.0, 70.0, 20.0, 120.0, 80.0, 230.0, 60.0, 70.0, 90.0, 110.0, 600.0, 80.0, 40.0, 120.0, 140.0, 90.0, 190.0, 90.0, 120.0, 100.0, 60.0, 140.0, -20.0, 80.0, 75.0, 60.0, 55.0, 60.0, 330.0, -5.0, 180.0, 90.0, 400.0, 35.0, 80.0, 260.0, 10.0, 0.0, 60.0, 330.0, 10.0, 240.0, 110.0, -20.0, 70.0, 80.0, 10.0, 170.0, 60.0, 180.0, 170.0, 25.0, 290.0, 110.0, 90.0, 20.0, 40.0, 100.0, 40.0, 320.0, 130.0, 190.0, 160.0, 110.0, 600.0, 20.0, 360.0, 110.0, 90.0, 70.0, 260.0, 190.0, 210.0, 170.0, 220.0, 110.0, 20.0, 120.0, -25.0, 50.0, 40.0, 450.0, 400.0, 80.0, -130.0, 10.0, 210.0, 300.0, 310.0, 50.0, 20.0, 170.0, 210.0, -70.0, 120.0, 30.0, 70.0, 250.0, 120.0, 80.0, 520.0, 170.0, 120.0, 150.0, 10.0, 30.0, 50.0, 10.0, 0.0, -55.0, 10.0, 10.0, 0.0, 110.0, 200.0, 40.0, 20.0, 50.0, 60.0, 250.0, 80.0, 10.0, 230.0, 40.0, 50.0, 5.0, -5.0, 30.0, 10.0, 130.0, 50.0, 130.0, 140.0, 10.0, 100.0, 20.0, 30.0, 10.0, 150.0, 0.0, 30.0, 30.0, 0.0, 180.0, 0.0, 0.0, 75.0, 170.0, 0.0, 30.0, 170.0, 0.0, 80.0, 110.0, 115.0, 90.0, 240.0, 0.0, 60.0, 150.0, 20.0, 50.0, 20.0, 250.0, 50.0, 160.0, 70.0, 30.0, 50.0, 260.0, 110.0, 20.0, 0.0, 410.0, 20.0, 30.0, 25.0, -10.0, 90.0, 270.0, -10.0, 180.0, 20.0, 60.0, 0.0, 60.0, 160.0, 20.0, 20.0, -20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 100.0, 100.0, 30.0, 210.0, 30.0, 15.0, 320.0, -10.0, 110.0, 150.0, 40.0, 30.0, 20.0, 65.0, 200.0, 300.0, 10.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 30.0, 0.0, 35.0, 90.0, 30.0, -5.0, 65.0, 10.0, 160.0, 50.0, 30.0, -45.0, -10.0, 110.0, 80.0, 230.0, 90.0, 300.0, 20.0, 40.0, 10.0, 30.0, 90.0, 420.0, 70.0, 30.0, 300.0, 20.0, 60.0, 80.0, 50.0, 10.0, 140.0, 20.0, 270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0, 25.0, 60.0, 110.0, 50.0, 70.0, 230.0, 120.0, 120.0, 90.0, 10.0, 50.0, -10.0, 270.0, 120.0, 330.0, 180.0, 130.0, 100.0, 100.0, 310.0, 30.0, 30.0, 170.0, 100.0, 40.0, 40.0, 10.0, 40.0, 70.0, 345.0, 60.0, 140.0, 110.0, 40.0, 190.0, 250.0, 140.0, 190.0, 20.0, 110.0, 150.0, 200.0, 160.0, 10.0, 0.0, 210.0, 30.0, 10.0, 30.0, 110.0, 120.0, 20.0, 10.0, 30.0, 30.0, 70.0, 30.0, 110.0, 40.0, 200.0, 60.0, -50.0, 380.0, 110.0, -10.0, 110.0, 290.0, 60.0, 250.0, 60.0, 40.0, 0.0, 40.0, 40.0, 100.0, 30.0, 80.0, 120.0, 90.0, 40.0, 10.0, 30.0, 40.0, 400.0, 40.0, 150.0, 40.0, 130.0, 20.0, 50.0, 90.0, 210.0, 120.0, 160.0, 360.0, -70.0, 140.0, 250.0, 180.0, 150.0, 140.0, 70.0, 80.0, 50.0, 220.0, 220.0, 170.0, 70.0, 100.0, 80.0, 250.0, -30.0, 70.0, 310.0, 70.0, 60.0, 190.0, -45.0, 30.0, 20.0, 100.0, 240.0, 150.0, 25.0, -120.0, 130.0, 170.0, 140.0, 70.0, 130.0, -120.0, 70.0, 40.0, 440.0, 30.0, 135.0, 270.0, 210.0, 80.0, 90.0, 40.0, 35.0, 5.0, 120.0, 520.0, 10.0, 30.0, 60.0, -10.0, 170.0, -10.0, 140.0, 240.0, 30.0, 40.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 10.0, 210.0, 90.0, 10.0, 160.0, 10.0, 40.0, 30.0, 65.0, 100.0, 100.0, 130.0, 130.0, 210.0, 90.0, 230.0, -120.0, 70.0, 20.0, 150.0, 50.0, -15.0, 80.0, 300.0, 110.0, 60.0, 220.0, 70.0, -105.0, 330.0, 70.0, 75.0, 30.0, 340.0, 220.0, 30.0, 60.0, 170.0, 130.0, 70.0, 180.0, 100.0, 190.0, 30.0, 75.0, 60.0, 60.0, 160.0, 70.0, 100.0, 0.0, 40.0, 20.0, 60.0, 30.0, 30.0, 20.0, 90.0, 150.0, 40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 220.0, 10.0, 30.0, 40.0, 0.0, 170.0, 30.0, 60.0, 0.0, 120.0, 40.0, 25.0, 20.0, 0.0, 20.0, 130.0, 150.0, 30.0, 70.0, 30.0, 190.0, 40.0, 50.0, 270.0, 310.0, 30.0, 150.0, 0.0, 90.0, 40.0, 65.0, 60.0, 160.0, 70.0, 0.0, 190.0, 40.0, 50.0, 90.0, 20.0, 110.0, 60.0, 100.0, 30.0, 40.0, 60.0, 10.0, 255.0, 10.0, 200.0, 340.0, -140.0, 30.0, 50.0, 290.0, 50.0, 30.0, 230.0, 0.0, 80.0, 20.0, 30.0, 40.0, 20.0, 70.0, 10.0, 30.0, -20.0, 10.0, 50.0, 50.0, 100.0, 40.0, 100.0, 170.0, 30.0, 180.0, 10.0, 50.0, 20.0, 300.0, 70.0, 60.0, 250.0, 100.0, 30.0, 200.0, 30.0, 60.0, 25.0, 30.0, 35.0, -5.0, 60.0, 30.0, 400.0, 30.0, 20.0, 20.0, 0.0, 100.0, 5.0, 40.0, 20.0, 0.0, 80.0, 50.0, 90.0, 40.0, 240.0, 110.0, 10.0, 100.0, 120.0, 90.0, 230.0, 110.0, 180.0, 50.0, 290.0, 150.0, 120.0, 100.0, 130.0, 70.0, 30.0, 40.0, 30.0, -30.0, 170.0, 30.0, 10.0, 190.0, -5.0, 20.0, 110.0, 10.0, 0.0, 135.0, 530.0, 310.0, 90.0, 140.0, 15.0, 240.0, 0.0, 40.0, -50.0, -25.0, 40.0, 110.0, 30.0, 30.0, 30.0, 60.0, 150.0, 310.0, 20.0, 20.0, 50.0, 30.0, 80.0, 70.0, 60.0, 5.0, 220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5421446336530966, "mean_inference_ms": 1.4147040460598976, "mean_action_processing_ms": 0.4508670818146184, "mean_env_wait_ms": 1.2552190202630555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012089967727661133, "StateBufferConnector_ms": 0.009799480438232422, "ViewRequirementAgentConnector_ms": 0.38127851486206055}, "num_episodes": 18, "episode_return_max": 2225.0, "episode_return_min": 215.0, "episode_return_mean": 953.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.44059703348897, "num_env_steps_trained_throughput_per_sec": 21.44059703348897, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 185798.229, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185798.179, "sample_time_ms": 2478.301, "learn_time_ms": 183300.033, "learn_throughput": 21.822, "synch_weights_time_ms": 10.025}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "33e63_00000", "date": "2024-06-19_00-55-37", "timestamp": 1718772937, "time_this_iter_s": 186.57832598686218, "time_total_s": 13719.374168872833, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13719.374168872833, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.90492424242424, "ram_util_percent": 79.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.010766120091541, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.326472935102745, "policy_loss": -0.008565633767557205, "vf_loss": 7.3337739597621185, "vf_explained_var": 0.0006777418624605741, "kl": 0.006323030115146179, "entropy": 0.4069594011646998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 2020.0, "episode_reward_min": 215.0, "episode_reward_mean": 957.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 600.0}, "policy_reward_mean": {"policy_0": 95.71}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 1355.0, 870.0, 1170.0, 495.0, 1190.0, 410.0, 400.0, 685.0, 1370.0, 1925.0, 990.0, 1290.0, 540.0, 410.0, 1480.0, 1030.0, 1325.0, 1135.0, 1035.0, 1200.0, 2020.0, 1555.0, 1230.0, 1410.0, 215.0, 1050.0, 580.0, 380.0, 705.0, 855.0, 1000.0, 1025.0, 340.0, 865.0, 915.0, 315.0, 395.0, 1310.0, 780.0, 1475.0, 885.0, 1580.0, 875.0, 1250.0, 910.0, 660.0, 1260.0, 580.0, 910.0, 1590.0, 1200.0, 925.0, 1035.0, 1245.0, 980.0, 630.0, 645.0, 960.0, 920.0, 1455.0, 995.0, 540.0, 1290.0, 490.0, 485.0, 1270.0, 665.0, 730.0, 1105.0, 570.0, 540.0, 1070.0, 495.0, 635.0, 930.0, 1430.0, 485.0, 1580.0, 265.0, 795.0, 700.0, 1750.0, 960.0, 1050.0, 480.0, 1605.0, 645.0, 925.0, 630.0, 1125.0, 1350.0, 1470.0, 1060.0, 1085.0, 565.0, 450.0, 1435.0, 1210.0, 1250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 80.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 40.0, 50.0, 105.0, 20.0, 80.0, 30.0, 250.0, 120.0, 20.0, 20.0, 120.0, 590.0, 170.0, 30.0, 40.0, 220.0, 90.0, 60.0, 120.0, 80.0, 40.0, 20.0, -40.0, 560.0, 40.0, 10.0, 70.0, 30.0, 90.0, 70.0, 250.0, 90.0, 40.0, -25.0, -20.0, 20.0, 5.0, 300.0, 10.0, 40.0, 15.0, 110.0, 180.0, 70.0, 170.0, 290.0, 80.0, 60.0, 50.0, -10.0, 230.0, 70.0, 20.0, -30.0, 40.0, 40.0, 0.0, 20.0, 40.0, 10.0, 220.0, 50.0, 60.0, 60.0, 50.0, -130.0, 70.0, -100.0, 80.0, 170.0, 60.0, 80.0, 30.0, 190.0, 30.0, 20.0, 20.0, 70.0, 110.0, 90.0, 90.0, 35.0, 30.0, 70.0, 160.0, 50.0, 60.0, 40.0, 200.0, 150.0, 510.0, 100.0, 60.0, 190.0, 330.0, -10.0, 210.0, 370.0, 360.0, 90.0, 240.0, 85.0, 20.0, 80.0, 0.0, 70.0, 80.0, 250.0, 330.0, 40.0, 40.0, 80.0, 140.0, 200.0, 90.0, 230.0, 110.0, 270.0, 50.0, 10.0, 120.0, 70.0, 80.0, 40.0, 10.0, 70.0, 160.0, 40.0, 30.0, 30.0, 30.0, 50.0, 20.0, 40.0, 50.0, 10.0, 100.0, 30.0, 70.0, 0.0, 70.0, 20.0, 120.0, 80.0, 230.0, 60.0, 70.0, 90.0, 110.0, 600.0, 80.0, 40.0, 120.0, 140.0, 90.0, 190.0, 90.0, 120.0, 100.0, 60.0, 140.0, -20.0, 80.0, 75.0, 60.0, 55.0, 60.0, 330.0, -5.0, 180.0, 90.0, 400.0, 35.0, 80.0, 260.0, 10.0, 0.0, 60.0, 330.0, 10.0, 240.0, 110.0, -20.0, 70.0, 80.0, 10.0, 170.0, 60.0, 180.0, 170.0, 25.0, 290.0, 110.0, 90.0, 20.0, 40.0, 100.0, 40.0, 320.0, 130.0, 190.0, 160.0, 110.0, 600.0, 20.0, 360.0, 110.0, 90.0, 70.0, 260.0, 190.0, 210.0, 170.0, 220.0, 110.0, 20.0, 120.0, -25.0, 50.0, 40.0, 450.0, 400.0, 80.0, -130.0, 10.0, 210.0, 300.0, 310.0, 50.0, 20.0, 170.0, 210.0, -70.0, 120.0, 30.0, 70.0, 250.0, 120.0, 80.0, 520.0, 170.0, 120.0, 150.0, 10.0, 30.0, 50.0, 10.0, 0.0, -55.0, 10.0, 10.0, 0.0, 110.0, 200.0, 40.0, 20.0, 50.0, 60.0, 250.0, 80.0, 10.0, 230.0, 40.0, 50.0, 5.0, -5.0, 30.0, 10.0, 130.0, 50.0, 130.0, 140.0, 10.0, 100.0, 20.0, 30.0, 10.0, 150.0, 0.0, 30.0, 30.0, 0.0, 180.0, 0.0, 0.0, 75.0, 170.0, 0.0, 30.0, 170.0, 0.0, 80.0, 110.0, 115.0, 90.0, 240.0, 0.0, 60.0, 150.0, 20.0, 50.0, 20.0, 250.0, 50.0, 160.0, 70.0, 30.0, 50.0, 260.0, 110.0, 20.0, 0.0, 410.0, 20.0, 30.0, 25.0, -10.0, 90.0, 270.0, -10.0, 180.0, 20.0, 60.0, 0.0, 60.0, 160.0, 20.0, 20.0, -20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 100.0, 100.0, 30.0, 210.0, 30.0, 15.0, 320.0, -10.0, 110.0, 150.0, 40.0, 30.0, 20.0, 65.0, 200.0, 300.0, 10.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 30.0, 0.0, 35.0, 90.0, 30.0, -5.0, 65.0, 10.0, 160.0, 50.0, 30.0, -45.0, -10.0, 110.0, 80.0, 230.0, 90.0, 300.0, 20.0, 40.0, 10.0, 30.0, 90.0, 420.0, 70.0, 30.0, 300.0, 20.0, 60.0, 80.0, 50.0, 10.0, 140.0, 20.0, 270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0, 25.0, 60.0, 110.0, 50.0, 70.0, 230.0, 120.0, 120.0, 90.0, 10.0, 50.0, -10.0, 270.0, 120.0, 330.0, 180.0, 130.0, 100.0, 100.0, 310.0, 30.0, 30.0, 170.0, 100.0, 40.0, 40.0, 10.0, 40.0, 70.0, 345.0, 60.0, 140.0, 110.0, 40.0, 190.0, 250.0, 140.0, 190.0, 20.0, 110.0, 150.0, 200.0, 160.0, 10.0, 0.0, 210.0, 30.0, 10.0, 30.0, 110.0, 120.0, 20.0, 10.0, 30.0, 30.0, 70.0, 30.0, 110.0, 40.0, 200.0, 60.0, -50.0, 380.0, 110.0, -10.0, 110.0, 290.0, 60.0, 250.0, 60.0, 40.0, 0.0, 40.0, 40.0, 100.0, 30.0, 80.0, 120.0, 90.0, 40.0, 10.0, 30.0, 40.0, 400.0, 40.0, 150.0, 40.0, 130.0, 20.0, 50.0, 90.0, 210.0, 120.0, 160.0, 360.0, -70.0, 140.0, 250.0, 180.0, 150.0, 140.0, 70.0, 80.0, 50.0, 220.0, 220.0, 170.0, 70.0, 100.0, 80.0, 250.0, -30.0, 70.0, 310.0, 70.0, 60.0, 190.0, -45.0, 30.0, 20.0, 100.0, 240.0, 150.0, 25.0, -120.0, 130.0, 170.0, 140.0, 70.0, 130.0, -120.0, 70.0, 40.0, 440.0, 30.0, 135.0, 270.0, 210.0, 80.0, 90.0, 40.0, 35.0, 5.0, 120.0, 520.0, 10.0, 30.0, 60.0, -10.0, 170.0, -10.0, 140.0, 240.0, 30.0, 40.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 10.0, 210.0, 90.0, 10.0, 160.0, 10.0, 40.0, 30.0, 65.0, 100.0, 100.0, 130.0, 130.0, 210.0, 90.0, 230.0, -120.0, 70.0, 20.0, 150.0, 50.0, -15.0, 80.0, 300.0, 110.0, 60.0, 220.0, 70.0, -105.0, 330.0, 70.0, 75.0, 30.0, 340.0, 220.0, 30.0, 60.0, 170.0, 130.0, 70.0, 180.0, 100.0, 190.0, 30.0, 75.0, 60.0, 60.0, 160.0, 70.0, 100.0, 0.0, 40.0, 20.0, 60.0, 30.0, 30.0, 20.0, 90.0, 150.0, 40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 220.0, 10.0, 30.0, 40.0, 0.0, 170.0, 30.0, 60.0, 0.0, 120.0, 40.0, 25.0, 20.0, 0.0, 20.0, 130.0, 150.0, 30.0, 70.0, 30.0, 190.0, 40.0, 50.0, 270.0, 310.0, 30.0, 150.0, 0.0, 90.0, 40.0, 65.0, 60.0, 160.0, 70.0, 0.0, 190.0, 40.0, 50.0, 90.0, 20.0, 110.0, 60.0, 100.0, 30.0, 40.0, 60.0, 10.0, 255.0, 10.0, 200.0, 340.0, -140.0, 30.0, 50.0, 290.0, 50.0, 30.0, 230.0, 0.0, 80.0, 20.0, 30.0, 40.0, 20.0, 70.0, 10.0, 30.0, -20.0, 10.0, 50.0, 50.0, 100.0, 40.0, 100.0, 170.0, 30.0, 180.0, 10.0, 50.0, 20.0, 300.0, 70.0, 60.0, 250.0, 100.0, 30.0, 200.0, 30.0, 60.0, 25.0, 30.0, 35.0, -5.0, 60.0, 30.0, 400.0, 30.0, 20.0, 20.0, 0.0, 100.0, 5.0, 40.0, 20.0, 0.0, 80.0, 50.0, 90.0, 40.0, 240.0, 110.0, 10.0, 100.0, 120.0, 90.0, 230.0, 110.0, 180.0, 50.0, 290.0, 150.0, 120.0, 100.0, 130.0, 70.0, 30.0, 40.0, 30.0, -30.0, 170.0, 30.0, 10.0, 190.0, -5.0, 20.0, 110.0, 10.0, 0.0, 135.0, 530.0, 310.0, 90.0, 140.0, 15.0, 240.0, 0.0, 40.0, -50.0, -25.0, 40.0, 110.0, 30.0, 30.0, 30.0, 60.0, 150.0, 310.0, 20.0, 20.0, 50.0, 30.0, 80.0, 70.0, 60.0, 5.0, 220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0, 80.0, 140.0, 350.0, 110.0, 260.0, 70.0, 80.0, 150.0, 300.0, 210.0, 30.0, 110.0, 140.0, 70.0, -20.0, 60.0, 110.0, 170.0, 250.0, 40.0, 140.0, 30.0, 30.0, 100.0, 110.0, 30.0, 80.0, 300.0, 200.0, 30.0, 40.0, 30.0, 50.0, 0.0, 50.0, 0.0, 70.0, 230.0, 0.0, 10.0, 470.0, 200.0, 190.0, 200.0, 50.0, 100.0, 100.0, 90.0, 145.0, 60.0, 40.0, -30.0, -30.0, 120.0, 210.0, 70.0, 65.0, 50.0, 20.0, 130.0, 370.0, 30.0, 15.0, 130.0, 30.0, 20.0, 10.0, 0.0, 270.0, 50.0, 30.0, 290.0, 80.0, -40.0, 80.0, 30.0, 50.0, 80.0, 10.0, 20.0, 70.0, 130.0, 25.0, 20.0, 155.0, 200.0, 90.0, 450.0, -25.0, 10.0, 200.0, 230.0, 250.0, 80.0, 10.0, 280.0, 180.0, 20.0, 50.0, 50.0, 350.0, 220.0, 50.0, 70.0, 60.0, 70.0, 110.0, 10.0, 260.0, 270.0, 70.0, 110.0, 210.0, 70.0, -30.0, 310.0, 40.0, 30.0, 190.0, 60.0, -10.0, 45.0, 320.0, 90.0, 180.0, 30.0, 70.0, 20.0, 40.0, 300.0, 50.0, 30.0, 20.0, 25.0, 30.0, 20.0, 0.0, 30.0, 300.0, 60.0, 40.0, 20.0, 20.0, 50.0, 30.0, 0.0, 150.0, 60.0, 10.0, 70.0, 150.0, 130.0, 120.0, 370.0, 270.0, 110.0, 55.0, 30.0, 120.0, 80.0, 60.0, 20.0, 260.0, 50.0, 110.0, 200.0, 110.0, 70.0, 280.0, 50.0, 60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5418263952681095, "mean_inference_ms": 1.4141003740414073, "mean_action_processing_ms": 0.4499526336042247, "mean_env_wait_ms": 1.2545394026972725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012489080429077148, "StateBufferConnector_ms": 0.010029077529907227, "ViewRequirementAgentConnector_ms": 0.3897521495819092}, "num_episodes": 18, "episode_return_max": 2020.0, "episode_return_min": 215.0, "episode_return_mean": 957.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.45536042291967, "num_env_steps_trained_throughput_per_sec": 21.45536042291967, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 185614.201, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185614.151, "sample_time_ms": 2511.175, "learn_time_ms": 183082.972, "learn_throughput": 21.848, "synch_weights_time_ms": 9.942}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "33e63_00000", "date": "2024-06-19_00-58-43", "timestamp": 1718773123, "time_this_iter_s": 186.44352412223816, "time_total_s": 13905.817692995071, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13905.817692995071, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.346969696969698, "ram_util_percent": 79.21174242424243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1226186665419697, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.5357486611611035, "policy_loss": -0.008929903979866476, "vf_loss": 7.543334746589295, "vf_explained_var": -0.0001686415288902827, "kl": 0.0067191039002915546, "entropy": 0.4168480198921614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": 215.0, "episode_reward_mean": 965.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 96.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1555.0, 1230.0, 1410.0, 215.0, 1050.0, 580.0, 380.0, 705.0, 855.0, 1000.0, 1025.0, 340.0, 865.0, 915.0, 315.0, 395.0, 1310.0, 780.0, 1475.0, 885.0, 1580.0, 875.0, 1250.0, 910.0, 660.0, 1260.0, 580.0, 910.0, 1590.0, 1200.0, 925.0, 1035.0, 1245.0, 980.0, 630.0, 645.0, 960.0, 920.0, 1455.0, 995.0, 540.0, 1290.0, 490.0, 485.0, 1270.0, 665.0, 730.0, 1105.0, 570.0, 540.0, 1070.0, 495.0, 635.0, 930.0, 1430.0, 485.0, 1580.0, 265.0, 795.0, 700.0, 1750.0, 960.0, 1050.0, 480.0, 1605.0, 645.0, 925.0, 630.0, 1125.0, 1350.0, 1470.0, 1060.0, 1085.0, 565.0, 450.0, 1435.0, 1210.0, 1250.0, 750.0, 1000.0, 985.0, 1270.0, 1050.0, 1370.0, 860.0, 1070.0, 1440.0, 1105.0, 625.0, 800.0, 1200.0, 1550.0, 1055.0, 930.0, 1400.0, 830.0, 1720.0, 1460.0, 440.0, 635.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 220.0, 110.0, 20.0, 120.0, -25.0, 50.0, 40.0, 450.0, 400.0, 80.0, -130.0, 10.0, 210.0, 300.0, 310.0, 50.0, 20.0, 170.0, 210.0, -70.0, 120.0, 30.0, 70.0, 250.0, 120.0, 80.0, 520.0, 170.0, 120.0, 150.0, 10.0, 30.0, 50.0, 10.0, 0.0, -55.0, 10.0, 10.0, 0.0, 110.0, 200.0, 40.0, 20.0, 50.0, 60.0, 250.0, 80.0, 10.0, 230.0, 40.0, 50.0, 5.0, -5.0, 30.0, 10.0, 130.0, 50.0, 130.0, 140.0, 10.0, 100.0, 20.0, 30.0, 10.0, 150.0, 0.0, 30.0, 30.0, 0.0, 180.0, 0.0, 0.0, 75.0, 170.0, 0.0, 30.0, 170.0, 0.0, 80.0, 110.0, 115.0, 90.0, 240.0, 0.0, 60.0, 150.0, 20.0, 50.0, 20.0, 250.0, 50.0, 160.0, 70.0, 30.0, 50.0, 260.0, 110.0, 20.0, 0.0, 410.0, 20.0, 30.0, 25.0, -10.0, 90.0, 270.0, -10.0, 180.0, 20.0, 60.0, 0.0, 60.0, 160.0, 20.0, 20.0, -20.0, 30.0, 0.0, 10.0, 40.0, 20.0, 0.0, 100.0, 100.0, 30.0, 210.0, 30.0, 15.0, 320.0, -10.0, 110.0, 150.0, 40.0, 30.0, 20.0, 65.0, 200.0, 300.0, 10.0, 20.0, 10.0, 10.0, 60.0, 40.0, 20.0, 30.0, 0.0, 35.0, 90.0, 30.0, -5.0, 65.0, 10.0, 160.0, 50.0, 30.0, -45.0, -10.0, 110.0, 80.0, 230.0, 90.0, 300.0, 20.0, 40.0, 10.0, 30.0, 90.0, 420.0, 70.0, 30.0, 300.0, 20.0, 60.0, 80.0, 50.0, 10.0, 140.0, 20.0, 270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0, 25.0, 60.0, 110.0, 50.0, 70.0, 230.0, 120.0, 120.0, 90.0, 10.0, 50.0, -10.0, 270.0, 120.0, 330.0, 180.0, 130.0, 100.0, 100.0, 310.0, 30.0, 30.0, 170.0, 100.0, 40.0, 40.0, 10.0, 40.0, 70.0, 345.0, 60.0, 140.0, 110.0, 40.0, 190.0, 250.0, 140.0, 190.0, 20.0, 110.0, 150.0, 200.0, 160.0, 10.0, 0.0, 210.0, 30.0, 10.0, 30.0, 110.0, 120.0, 20.0, 10.0, 30.0, 30.0, 70.0, 30.0, 110.0, 40.0, 200.0, 60.0, -50.0, 380.0, 110.0, -10.0, 110.0, 290.0, 60.0, 250.0, 60.0, 40.0, 0.0, 40.0, 40.0, 100.0, 30.0, 80.0, 120.0, 90.0, 40.0, 10.0, 30.0, 40.0, 400.0, 40.0, 150.0, 40.0, 130.0, 20.0, 50.0, 90.0, 210.0, 120.0, 160.0, 360.0, -70.0, 140.0, 250.0, 180.0, 150.0, 140.0, 70.0, 80.0, 50.0, 220.0, 220.0, 170.0, 70.0, 100.0, 80.0, 250.0, -30.0, 70.0, 310.0, 70.0, 60.0, 190.0, -45.0, 30.0, 20.0, 100.0, 240.0, 150.0, 25.0, -120.0, 130.0, 170.0, 140.0, 70.0, 130.0, -120.0, 70.0, 40.0, 440.0, 30.0, 135.0, 270.0, 210.0, 80.0, 90.0, 40.0, 35.0, 5.0, 120.0, 520.0, 10.0, 30.0, 60.0, -10.0, 170.0, -10.0, 140.0, 240.0, 30.0, 40.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 10.0, 210.0, 90.0, 10.0, 160.0, 10.0, 40.0, 30.0, 65.0, 100.0, 100.0, 130.0, 130.0, 210.0, 90.0, 230.0, -120.0, 70.0, 20.0, 150.0, 50.0, -15.0, 80.0, 300.0, 110.0, 60.0, 220.0, 70.0, -105.0, 330.0, 70.0, 75.0, 30.0, 340.0, 220.0, 30.0, 60.0, 170.0, 130.0, 70.0, 180.0, 100.0, 190.0, 30.0, 75.0, 60.0, 60.0, 160.0, 70.0, 100.0, 0.0, 40.0, 20.0, 60.0, 30.0, 30.0, 20.0, 90.0, 150.0, 40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 220.0, 10.0, 30.0, 40.0, 0.0, 170.0, 30.0, 60.0, 0.0, 120.0, 40.0, 25.0, 20.0, 0.0, 20.0, 130.0, 150.0, 30.0, 70.0, 30.0, 190.0, 40.0, 50.0, 270.0, 310.0, 30.0, 150.0, 0.0, 90.0, 40.0, 65.0, 60.0, 160.0, 70.0, 0.0, 190.0, 40.0, 50.0, 90.0, 20.0, 110.0, 60.0, 100.0, 30.0, 40.0, 60.0, 10.0, 255.0, 10.0, 200.0, 340.0, -140.0, 30.0, 50.0, 290.0, 50.0, 30.0, 230.0, 0.0, 80.0, 20.0, 30.0, 40.0, 20.0, 70.0, 10.0, 30.0, -20.0, 10.0, 50.0, 50.0, 100.0, 40.0, 100.0, 170.0, 30.0, 180.0, 10.0, 50.0, 20.0, 300.0, 70.0, 60.0, 250.0, 100.0, 30.0, 200.0, 30.0, 60.0, 25.0, 30.0, 35.0, -5.0, 60.0, 30.0, 400.0, 30.0, 20.0, 20.0, 0.0, 100.0, 5.0, 40.0, 20.0, 0.0, 80.0, 50.0, 90.0, 40.0, 240.0, 110.0, 10.0, 100.0, 120.0, 90.0, 230.0, 110.0, 180.0, 50.0, 290.0, 150.0, 120.0, 100.0, 130.0, 70.0, 30.0, 40.0, 30.0, -30.0, 170.0, 30.0, 10.0, 190.0, -5.0, 20.0, 110.0, 10.0, 0.0, 135.0, 530.0, 310.0, 90.0, 140.0, 15.0, 240.0, 0.0, 40.0, -50.0, -25.0, 40.0, 110.0, 30.0, 30.0, 30.0, 60.0, 150.0, 310.0, 20.0, 20.0, 50.0, 30.0, 80.0, 70.0, 60.0, 5.0, 220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0, 80.0, 140.0, 350.0, 110.0, 260.0, 70.0, 80.0, 150.0, 300.0, 210.0, 30.0, 110.0, 140.0, 70.0, -20.0, 60.0, 110.0, 170.0, 250.0, 40.0, 140.0, 30.0, 30.0, 100.0, 110.0, 30.0, 80.0, 300.0, 200.0, 30.0, 40.0, 30.0, 50.0, 0.0, 50.0, 0.0, 70.0, 230.0, 0.0, 10.0, 470.0, 200.0, 190.0, 200.0, 50.0, 100.0, 100.0, 90.0, 145.0, 60.0, 40.0, -30.0, -30.0, 120.0, 210.0, 70.0, 65.0, 50.0, 20.0, 130.0, 370.0, 30.0, 15.0, 130.0, 30.0, 20.0, 10.0, 0.0, 270.0, 50.0, 30.0, 290.0, 80.0, -40.0, 80.0, 30.0, 50.0, 80.0, 10.0, 20.0, 70.0, 130.0, 25.0, 20.0, 155.0, 200.0, 90.0, 450.0, -25.0, 10.0, 200.0, 230.0, 250.0, 80.0, 10.0, 280.0, 180.0, 20.0, 50.0, 50.0, 350.0, 220.0, 50.0, 70.0, 60.0, 70.0, 110.0, 10.0, 260.0, 270.0, 70.0, 110.0, 210.0, 70.0, -30.0, 310.0, 40.0, 30.0, 190.0, 60.0, -10.0, 45.0, 320.0, 90.0, 180.0, 30.0, 70.0, 20.0, 40.0, 300.0, 50.0, 30.0, 20.0, 25.0, 30.0, 20.0, 0.0, 30.0, 300.0, 60.0, 40.0, 20.0, 20.0, 50.0, 30.0, 0.0, 150.0, 60.0, 10.0, 70.0, 150.0, 130.0, 120.0, 370.0, 270.0, 110.0, 55.0, 30.0, 120.0, 80.0, 60.0, 20.0, 260.0, 50.0, 110.0, 200.0, 110.0, 70.0, 280.0, 50.0, 60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0, 30.0, 50.0, 90.0, 190.0, 110.0, 90.0, 20.0, 60.0, 50.0, 60.0, 160.0, 70.0, 280.0, 70.0, 60.0, 20.0, 240.0, 10.0, 50.0, 40.0, 140.0, 25.0, 20.0, 50.0, 20.0, 80.0, 240.0, 60.0, 320.0, 30.0, 180.0, -80.0, 180.0, 140.0, 360.0, 120.0, 80.0, 50.0, 120.0, 120.0, 190.0, 70.0, 200.0, 200.0, 90.0, 110.0, 150.0, 10.0, 20.0, 10.0, 80.0, 260.0, 20.0, 180.0, 240.0, 10.0, 150.0, 60.0, 190.0, 180.0, 70.0, 160.0, 90.0, 90.0, 20.0, 30.0, 110.0, 60.0, 150.0, 80.0, 120.0, 50.0, 90.0, 230.0, 40.0, -10.0, 80.0, 50.0, 100.0, 320.0, 50.0, 310.0, 170.0, 50.0, 30.0, 60.0, 310.0, -30.0, 300.0, 190.0, 100.0, 30.0, 180.0, 590.0, -45.0, 90.0, 20.0, 50.0, 0.0, 90.0, 150.0, 10.0, 0.0, 180.0, 85.0, 10.0, 40.0, 70.0, 40.0, 40.0, 90.0, 90.0, -20.0, 0.0, 110.0, 50.0, 90.0, 50.0, 30.0, 310.0, 180.0, 40.0, 30.0, 40.0, 160.0, 130.0, 290.0, 90.0, 120.0, 120.0, 90.0, -50.0, 180.0, 120.0, 70.0, 240.0, 100.0, 110.0, 480.0, 210.0, 15.0, 150.0, 140.0, 35.0, 60.0, 70.0, 160.0, 160.0, 260.0, 5.0, 65.0, 150.0, 50.0, 40.0, 120.0, 20.0, 10.0, 105.0, 20.0, 350.0, 240.0, 30.0, 50.0, -80.0, 50.0, 440.0, -20.0, 510.0, 160.0, 20.0, 25.0, 125.0, 70.0, 0.0, 190.0, 120.0, 50.0, 70.0, 80.0, 100.0, 60.0, 130.0, 360.0, 100.0, 110.0, 380.0, 250.0, 110.0, 150.0, 70.0, -30.0, 380.0, 80.0, 20.0, 120.0, 190.0, 90.0, 330.0, 190.0, 90.0, 20.0, 30.0, 150.0, 160.0, 20.0, 20.0, -60.0, 0.0, 80.0, 20.0, -40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5406951090350935, "mean_inference_ms": 1.4119496470523172, "mean_action_processing_ms": 0.44939126729439516, "mean_env_wait_ms": 1.2536397948105078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012249946594238281, "StateBufferConnector_ms": 0.009807586669921875, "ViewRequirementAgentConnector_ms": 0.384387731552124}, "num_episodes": 22, "episode_return_max": 1750.0, "episode_return_min": 215.0, "episode_return_mean": 965.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.177784125743607, "num_env_steps_trained_throughput_per_sec": 21.177784125743607, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 185896.997, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185896.948, "sample_time_ms": 2507.281, "learn_time_ms": 183369.641, "learn_throughput": 21.814, "synch_weights_time_ms": 10.166}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "33e63_00000", "date": "2024-06-19_01-01-52", "timestamp": 1718773312, "time_this_iter_s": 188.89016890525818, "time_total_s": 14094.70786190033, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b70d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14094.70786190033, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 18.99438202247191, "ram_util_percent": 80.08052434456928}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0109994253157555, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008988522110319438, "vf_loss": 6.842562200720953, "vf_explained_var": 0.0005119068173173898, "kl": Infinity, "entropy": 0.4600832182283219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": -265.0, "episode_reward_mean": 970.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 97.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1475.0, 885.0, 1580.0, 875.0, 1250.0, 910.0, 660.0, 1260.0, 580.0, 910.0, 1590.0, 1200.0, 925.0, 1035.0, 1245.0, 980.0, 630.0, 645.0, 960.0, 920.0, 1455.0, 995.0, 540.0, 1290.0, 490.0, 485.0, 1270.0, 665.0, 730.0, 1105.0, 570.0, 540.0, 1070.0, 495.0, 635.0, 930.0, 1430.0, 485.0, 1580.0, 265.0, 795.0, 700.0, 1750.0, 960.0, 1050.0, 480.0, 1605.0, 645.0, 925.0, 630.0, 1125.0, 1350.0, 1470.0, 1060.0, 1085.0, 565.0, 450.0, 1435.0, 1210.0, 1250.0, 750.0, 1000.0, 985.0, 1270.0, 1050.0, 1370.0, 860.0, 1070.0, 1440.0, 1105.0, 625.0, 800.0, 1200.0, 1550.0, 1055.0, 930.0, 1400.0, 830.0, 1720.0, 1460.0, 440.0, 635.0, -265.0, 490.0, 1075.0, 1260.0, 505.0, 620.0, 1230.0, 1600.0, 940.0, 510.0, 1150.0, 225.0, 1330.0, 1240.0, 1080.0, 855.0, 560.0, 1060.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [270.0, 40.0, -25.0, 230.0, 210.0, 70.0, 270.0, 40.0, 100.0, 270.0, 25.0, 60.0, 110.0, 50.0, 70.0, 230.0, 120.0, 120.0, 90.0, 10.0, 50.0, -10.0, 270.0, 120.0, 330.0, 180.0, 130.0, 100.0, 100.0, 310.0, 30.0, 30.0, 170.0, 100.0, 40.0, 40.0, 10.0, 40.0, 70.0, 345.0, 60.0, 140.0, 110.0, 40.0, 190.0, 250.0, 140.0, 190.0, 20.0, 110.0, 150.0, 200.0, 160.0, 10.0, 0.0, 210.0, 30.0, 10.0, 30.0, 110.0, 120.0, 20.0, 10.0, 30.0, 30.0, 70.0, 30.0, 110.0, 40.0, 200.0, 60.0, -50.0, 380.0, 110.0, -10.0, 110.0, 290.0, 60.0, 250.0, 60.0, 40.0, 0.0, 40.0, 40.0, 100.0, 30.0, 80.0, 120.0, 90.0, 40.0, 10.0, 30.0, 40.0, 400.0, 40.0, 150.0, 40.0, 130.0, 20.0, 50.0, 90.0, 210.0, 120.0, 160.0, 360.0, -70.0, 140.0, 250.0, 180.0, 150.0, 140.0, 70.0, 80.0, 50.0, 220.0, 220.0, 170.0, 70.0, 100.0, 80.0, 250.0, -30.0, 70.0, 310.0, 70.0, 60.0, 190.0, -45.0, 30.0, 20.0, 100.0, 240.0, 150.0, 25.0, -120.0, 130.0, 170.0, 140.0, 70.0, 130.0, -120.0, 70.0, 40.0, 440.0, 30.0, 135.0, 270.0, 210.0, 80.0, 90.0, 40.0, 35.0, 5.0, 120.0, 520.0, 10.0, 30.0, 60.0, -10.0, 170.0, -10.0, 140.0, 240.0, 30.0, 40.0, 30.0, 20.0, 70.0, 40.0, 30.0, 20.0, 10.0, 210.0, 90.0, 10.0, 160.0, 10.0, 40.0, 30.0, 65.0, 100.0, 100.0, 130.0, 130.0, 210.0, 90.0, 230.0, -120.0, 70.0, 20.0, 150.0, 50.0, -15.0, 80.0, 300.0, 110.0, 60.0, 220.0, 70.0, -105.0, 330.0, 70.0, 75.0, 30.0, 340.0, 220.0, 30.0, 60.0, 170.0, 130.0, 70.0, 180.0, 100.0, 190.0, 30.0, 75.0, 60.0, 60.0, 160.0, 70.0, 100.0, 0.0, 40.0, 20.0, 60.0, 30.0, 30.0, 20.0, 90.0, 150.0, 40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 220.0, 10.0, 30.0, 40.0, 0.0, 170.0, 30.0, 60.0, 0.0, 120.0, 40.0, 25.0, 20.0, 0.0, 20.0, 130.0, 150.0, 30.0, 70.0, 30.0, 190.0, 40.0, 50.0, 270.0, 310.0, 30.0, 150.0, 0.0, 90.0, 40.0, 65.0, 60.0, 160.0, 70.0, 0.0, 190.0, 40.0, 50.0, 90.0, 20.0, 110.0, 60.0, 100.0, 30.0, 40.0, 60.0, 10.0, 255.0, 10.0, 200.0, 340.0, -140.0, 30.0, 50.0, 290.0, 50.0, 30.0, 230.0, 0.0, 80.0, 20.0, 30.0, 40.0, 20.0, 70.0, 10.0, 30.0, -20.0, 10.0, 50.0, 50.0, 100.0, 40.0, 100.0, 170.0, 30.0, 180.0, 10.0, 50.0, 20.0, 300.0, 70.0, 60.0, 250.0, 100.0, 30.0, 200.0, 30.0, 60.0, 25.0, 30.0, 35.0, -5.0, 60.0, 30.0, 400.0, 30.0, 20.0, 20.0, 0.0, 100.0, 5.0, 40.0, 20.0, 0.0, 80.0, 50.0, 90.0, 40.0, 240.0, 110.0, 10.0, 100.0, 120.0, 90.0, 230.0, 110.0, 180.0, 50.0, 290.0, 150.0, 120.0, 100.0, 130.0, 70.0, 30.0, 40.0, 30.0, -30.0, 170.0, 30.0, 10.0, 190.0, -5.0, 20.0, 110.0, 10.0, 0.0, 135.0, 530.0, 310.0, 90.0, 140.0, 15.0, 240.0, 0.0, 40.0, -50.0, -25.0, 40.0, 110.0, 30.0, 30.0, 30.0, 60.0, 150.0, 310.0, 20.0, 20.0, 50.0, 30.0, 80.0, 70.0, 60.0, 5.0, 220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0, 80.0, 140.0, 350.0, 110.0, 260.0, 70.0, 80.0, 150.0, 300.0, 210.0, 30.0, 110.0, 140.0, 70.0, -20.0, 60.0, 110.0, 170.0, 250.0, 40.0, 140.0, 30.0, 30.0, 100.0, 110.0, 30.0, 80.0, 300.0, 200.0, 30.0, 40.0, 30.0, 50.0, 0.0, 50.0, 0.0, 70.0, 230.0, 0.0, 10.0, 470.0, 200.0, 190.0, 200.0, 50.0, 100.0, 100.0, 90.0, 145.0, 60.0, 40.0, -30.0, -30.0, 120.0, 210.0, 70.0, 65.0, 50.0, 20.0, 130.0, 370.0, 30.0, 15.0, 130.0, 30.0, 20.0, 10.0, 0.0, 270.0, 50.0, 30.0, 290.0, 80.0, -40.0, 80.0, 30.0, 50.0, 80.0, 10.0, 20.0, 70.0, 130.0, 25.0, 20.0, 155.0, 200.0, 90.0, 450.0, -25.0, 10.0, 200.0, 230.0, 250.0, 80.0, 10.0, 280.0, 180.0, 20.0, 50.0, 50.0, 350.0, 220.0, 50.0, 70.0, 60.0, 70.0, 110.0, 10.0, 260.0, 270.0, 70.0, 110.0, 210.0, 70.0, -30.0, 310.0, 40.0, 30.0, 190.0, 60.0, -10.0, 45.0, 320.0, 90.0, 180.0, 30.0, 70.0, 20.0, 40.0, 300.0, 50.0, 30.0, 20.0, 25.0, 30.0, 20.0, 0.0, 30.0, 300.0, 60.0, 40.0, 20.0, 20.0, 50.0, 30.0, 0.0, 150.0, 60.0, 10.0, 70.0, 150.0, 130.0, 120.0, 370.0, 270.0, 110.0, 55.0, 30.0, 120.0, 80.0, 60.0, 20.0, 260.0, 50.0, 110.0, 200.0, 110.0, 70.0, 280.0, 50.0, 60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0, 30.0, 50.0, 90.0, 190.0, 110.0, 90.0, 20.0, 60.0, 50.0, 60.0, 160.0, 70.0, 280.0, 70.0, 60.0, 20.0, 240.0, 10.0, 50.0, 40.0, 140.0, 25.0, 20.0, 50.0, 20.0, 80.0, 240.0, 60.0, 320.0, 30.0, 180.0, -80.0, 180.0, 140.0, 360.0, 120.0, 80.0, 50.0, 120.0, 120.0, 190.0, 70.0, 200.0, 200.0, 90.0, 110.0, 150.0, 10.0, 20.0, 10.0, 80.0, 260.0, 20.0, 180.0, 240.0, 10.0, 150.0, 60.0, 190.0, 180.0, 70.0, 160.0, 90.0, 90.0, 20.0, 30.0, 110.0, 60.0, 150.0, 80.0, 120.0, 50.0, 90.0, 230.0, 40.0, -10.0, 80.0, 50.0, 100.0, 320.0, 50.0, 310.0, 170.0, 50.0, 30.0, 60.0, 310.0, -30.0, 300.0, 190.0, 100.0, 30.0, 180.0, 590.0, -45.0, 90.0, 20.0, 50.0, 0.0, 90.0, 150.0, 10.0, 0.0, 180.0, 85.0, 10.0, 40.0, 70.0, 40.0, 40.0, 90.0, 90.0, -20.0, 0.0, 110.0, 50.0, 90.0, 50.0, 30.0, 310.0, 180.0, 40.0, 30.0, 40.0, 160.0, 130.0, 290.0, 90.0, 120.0, 120.0, 90.0, -50.0, 180.0, 120.0, 70.0, 240.0, 100.0, 110.0, 480.0, 210.0, 15.0, 150.0, 140.0, 35.0, 60.0, 70.0, 160.0, 160.0, 260.0, 5.0, 65.0, 150.0, 50.0, 40.0, 120.0, 20.0, 10.0, 105.0, 20.0, 350.0, 240.0, 30.0, 50.0, -80.0, 50.0, 440.0, -20.0, 510.0, 160.0, 20.0, 25.0, 125.0, 70.0, 0.0, 190.0, 120.0, 50.0, 70.0, 80.0, 100.0, 60.0, 130.0, 360.0, 100.0, 110.0, 380.0, 250.0, 110.0, 150.0, 70.0, -30.0, 380.0, 80.0, 20.0, 120.0, 190.0, 90.0, 330.0, 190.0, 90.0, 20.0, 30.0, 150.0, 160.0, 20.0, 20.0, -60.0, 0.0, 80.0, 20.0, -40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0, -20.0, -245.0, 20.0, 150.0, -300.0, 10.0, 40.0, 20.0, 40.0, 20.0, 90.0, 30.0, 30.0, 90.0, 40.0, 50.0, 50.0, 50.0, 20.0, 40.0, 120.0, 100.0, 10.0, 180.0, 10.0, 290.0, 0.0, 65.0, 40.0, 260.0, 60.0, 30.0, 210.0, 280.0, 30.0, 60.0, 40.0, 10.0, 250.0, 290.0, 130.0, 10.0, 10.0, 20.0, 0.0, 5.0, 30.0, 210.0, 30.0, 60.0, 130.0, 70.0, 20.0, 50.0, 20.0, 40.0, 70.0, 40.0, 90.0, 90.0, 120.0, 640.0, 20.0, 30.0, -40.0, 100.0, -10.0, 130.0, 160.0, 80.0, 110.0, 700.0, 30.0, 30.0, 40.0, 120.0, 20.0, 110.0, 290.0, 150.0, 170.0, 160.0, 180.0, 130.0, 40.0, 30.0, 0.0, 100.0, 90.0, 40.0, 40.0, 20.0, 70.0, 20.0, 10.0, 10.0, 130.0, 160.0, 20.0, 30.0, 30.0, 270.0, 160.0, 110.0, 70.0, 200.0, 40.0, 130.0, 60.0, 80.0, 170.0, 5.0, 15.0, 0.0, 20.0, 20.0, -20.0, -10.0, 15.0, 10.0, 70.0, 40.0, 110.0, 70.0, 60.0, 100.0, 50.0, 190.0, 300.0, 340.0, 100.0, 10.0, 30.0, 120.0, 190.0, 30.0, 30.0, 60.0, 500.0, 170.0, 70.0, 310.0, 110.0, 270.0, 80.0, -200.0, 350.0, 30.0, 40.0, 20.0, 30.0, 150.0, 5.0, 30.0, 70.0, 210.0, 30.0, 30.0, 130.0, 170.0, 0.0, 10.0, 110.0, 240.0, 30.0, 10.0, 70.0, 30.0, 30.0, 30.0, 260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5413537804157957, "mean_inference_ms": 1.4126042250884296, "mean_action_processing_ms": 0.4480256021130136, "mean_env_wait_ms": 1.253241705553198, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259244918823242, "StateBufferConnector_ms": 0.009752511978149414, "ViewRequirementAgentConnector_ms": 0.38881969451904297}, "num_episodes": 18, "episode_return_max": 1750.0, "episode_return_min": -265.0, "episode_return_mean": 970.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.515299894860956, "num_env_steps_trained_throughput_per_sec": 21.515299894860956, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 185928.456, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185928.406, "sample_time_ms": 2523.205, "learn_time_ms": 183385.34, "learn_throughput": 21.812, "synch_weights_time_ms": 10.087}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "33e63_00000", "date": "2024-06-19_01-04-58", "timestamp": 1718773498, "time_this_iter_s": 185.92173528671265, "time_total_s": 14280.629597187042, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32770c280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14280.629597187042, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 16.356653992395437, "ram_util_percent": 78.72851711026617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.856197952836974, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.174801958305514, "policy_loss": -0.009479693758734864, "vf_loss": 7.182591429660622, "vf_explained_var": -0.0002727437577943325, "kl": 0.0056341013983547865, "entropy": 0.4362557262372666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": -265.0, "episode_reward_mean": 953.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 95.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1290.0, 490.0, 485.0, 1270.0, 665.0, 730.0, 1105.0, 570.0, 540.0, 1070.0, 495.0, 635.0, 930.0, 1430.0, 485.0, 1580.0, 265.0, 795.0, 700.0, 1750.0, 960.0, 1050.0, 480.0, 1605.0, 645.0, 925.0, 630.0, 1125.0, 1350.0, 1470.0, 1060.0, 1085.0, 565.0, 450.0, 1435.0, 1210.0, 1250.0, 750.0, 1000.0, 985.0, 1270.0, 1050.0, 1370.0, 860.0, 1070.0, 1440.0, 1105.0, 625.0, 800.0, 1200.0, 1550.0, 1055.0, 930.0, 1400.0, 830.0, 1720.0, 1460.0, 440.0, 635.0, -265.0, 490.0, 1075.0, 1260.0, 505.0, 620.0, 1230.0, 1600.0, 940.0, 510.0, 1150.0, 225.0, 1330.0, 1240.0, 1080.0, 855.0, 560.0, 1060.0, 570.0, 500.0, 360.0, 915.0, 1210.0, 945.0, 550.0, 1200.0, 1400.0, 1110.0, 875.0, 480.0, 1000.0, 910.0, 1280.0, 850.0, 820.0, 1720.0, 995.0, 745.0, 1220.0, 760.0, 1340.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 100.0, 20.0, 100.0, 30.0, 50.0, 90.0, 80.0, 400.0, 380.0, 20.0, 100.0, 30.0, 30.0, 10.0, 220.0, 10.0, 30.0, 40.0, 0.0, 170.0, 30.0, 60.0, 0.0, 120.0, 40.0, 25.0, 20.0, 0.0, 20.0, 130.0, 150.0, 30.0, 70.0, 30.0, 190.0, 40.0, 50.0, 270.0, 310.0, 30.0, 150.0, 0.0, 90.0, 40.0, 65.0, 60.0, 160.0, 70.0, 0.0, 190.0, 40.0, 50.0, 90.0, 20.0, 110.0, 60.0, 100.0, 30.0, 40.0, 60.0, 10.0, 255.0, 10.0, 200.0, 340.0, -140.0, 30.0, 50.0, 290.0, 50.0, 30.0, 230.0, 0.0, 80.0, 20.0, 30.0, 40.0, 20.0, 70.0, 10.0, 30.0, -20.0, 10.0, 50.0, 50.0, 100.0, 40.0, 100.0, 170.0, 30.0, 180.0, 10.0, 50.0, 20.0, 300.0, 70.0, 60.0, 250.0, 100.0, 30.0, 200.0, 30.0, 60.0, 25.0, 30.0, 35.0, -5.0, 60.0, 30.0, 400.0, 30.0, 20.0, 20.0, 0.0, 100.0, 5.0, 40.0, 20.0, 0.0, 80.0, 50.0, 90.0, 40.0, 240.0, 110.0, 10.0, 100.0, 120.0, 90.0, 230.0, 110.0, 180.0, 50.0, 290.0, 150.0, 120.0, 100.0, 130.0, 70.0, 30.0, 40.0, 30.0, -30.0, 170.0, 30.0, 10.0, 190.0, -5.0, 20.0, 110.0, 10.0, 0.0, 135.0, 530.0, 310.0, 90.0, 140.0, 15.0, 240.0, 0.0, 40.0, -50.0, -25.0, 40.0, 110.0, 30.0, 30.0, 30.0, 60.0, 150.0, 310.0, 20.0, 20.0, 50.0, 30.0, 80.0, 70.0, 60.0, 5.0, 220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0, 80.0, 140.0, 350.0, 110.0, 260.0, 70.0, 80.0, 150.0, 300.0, 210.0, 30.0, 110.0, 140.0, 70.0, -20.0, 60.0, 110.0, 170.0, 250.0, 40.0, 140.0, 30.0, 30.0, 100.0, 110.0, 30.0, 80.0, 300.0, 200.0, 30.0, 40.0, 30.0, 50.0, 0.0, 50.0, 0.0, 70.0, 230.0, 0.0, 10.0, 470.0, 200.0, 190.0, 200.0, 50.0, 100.0, 100.0, 90.0, 145.0, 60.0, 40.0, -30.0, -30.0, 120.0, 210.0, 70.0, 65.0, 50.0, 20.0, 130.0, 370.0, 30.0, 15.0, 130.0, 30.0, 20.0, 10.0, 0.0, 270.0, 50.0, 30.0, 290.0, 80.0, -40.0, 80.0, 30.0, 50.0, 80.0, 10.0, 20.0, 70.0, 130.0, 25.0, 20.0, 155.0, 200.0, 90.0, 450.0, -25.0, 10.0, 200.0, 230.0, 250.0, 80.0, 10.0, 280.0, 180.0, 20.0, 50.0, 50.0, 350.0, 220.0, 50.0, 70.0, 60.0, 70.0, 110.0, 10.0, 260.0, 270.0, 70.0, 110.0, 210.0, 70.0, -30.0, 310.0, 40.0, 30.0, 190.0, 60.0, -10.0, 45.0, 320.0, 90.0, 180.0, 30.0, 70.0, 20.0, 40.0, 300.0, 50.0, 30.0, 20.0, 25.0, 30.0, 20.0, 0.0, 30.0, 300.0, 60.0, 40.0, 20.0, 20.0, 50.0, 30.0, 0.0, 150.0, 60.0, 10.0, 70.0, 150.0, 130.0, 120.0, 370.0, 270.0, 110.0, 55.0, 30.0, 120.0, 80.0, 60.0, 20.0, 260.0, 50.0, 110.0, 200.0, 110.0, 70.0, 280.0, 50.0, 60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0, 30.0, 50.0, 90.0, 190.0, 110.0, 90.0, 20.0, 60.0, 50.0, 60.0, 160.0, 70.0, 280.0, 70.0, 60.0, 20.0, 240.0, 10.0, 50.0, 40.0, 140.0, 25.0, 20.0, 50.0, 20.0, 80.0, 240.0, 60.0, 320.0, 30.0, 180.0, -80.0, 180.0, 140.0, 360.0, 120.0, 80.0, 50.0, 120.0, 120.0, 190.0, 70.0, 200.0, 200.0, 90.0, 110.0, 150.0, 10.0, 20.0, 10.0, 80.0, 260.0, 20.0, 180.0, 240.0, 10.0, 150.0, 60.0, 190.0, 180.0, 70.0, 160.0, 90.0, 90.0, 20.0, 30.0, 110.0, 60.0, 150.0, 80.0, 120.0, 50.0, 90.0, 230.0, 40.0, -10.0, 80.0, 50.0, 100.0, 320.0, 50.0, 310.0, 170.0, 50.0, 30.0, 60.0, 310.0, -30.0, 300.0, 190.0, 100.0, 30.0, 180.0, 590.0, -45.0, 90.0, 20.0, 50.0, 0.0, 90.0, 150.0, 10.0, 0.0, 180.0, 85.0, 10.0, 40.0, 70.0, 40.0, 40.0, 90.0, 90.0, -20.0, 0.0, 110.0, 50.0, 90.0, 50.0, 30.0, 310.0, 180.0, 40.0, 30.0, 40.0, 160.0, 130.0, 290.0, 90.0, 120.0, 120.0, 90.0, -50.0, 180.0, 120.0, 70.0, 240.0, 100.0, 110.0, 480.0, 210.0, 15.0, 150.0, 140.0, 35.0, 60.0, 70.0, 160.0, 160.0, 260.0, 5.0, 65.0, 150.0, 50.0, 40.0, 120.0, 20.0, 10.0, 105.0, 20.0, 350.0, 240.0, 30.0, 50.0, -80.0, 50.0, 440.0, -20.0, 510.0, 160.0, 20.0, 25.0, 125.0, 70.0, 0.0, 190.0, 120.0, 50.0, 70.0, 80.0, 100.0, 60.0, 130.0, 360.0, 100.0, 110.0, 380.0, 250.0, 110.0, 150.0, 70.0, -30.0, 380.0, 80.0, 20.0, 120.0, 190.0, 90.0, 330.0, 190.0, 90.0, 20.0, 30.0, 150.0, 160.0, 20.0, 20.0, -60.0, 0.0, 80.0, 20.0, -40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0, -20.0, -245.0, 20.0, 150.0, -300.0, 10.0, 40.0, 20.0, 40.0, 20.0, 90.0, 30.0, 30.0, 90.0, 40.0, 50.0, 50.0, 50.0, 20.0, 40.0, 120.0, 100.0, 10.0, 180.0, 10.0, 290.0, 0.0, 65.0, 40.0, 260.0, 60.0, 30.0, 210.0, 280.0, 30.0, 60.0, 40.0, 10.0, 250.0, 290.0, 130.0, 10.0, 10.0, 20.0, 0.0, 5.0, 30.0, 210.0, 30.0, 60.0, 130.0, 70.0, 20.0, 50.0, 20.0, 40.0, 70.0, 40.0, 90.0, 90.0, 120.0, 640.0, 20.0, 30.0, -40.0, 100.0, -10.0, 130.0, 160.0, 80.0, 110.0, 700.0, 30.0, 30.0, 40.0, 120.0, 20.0, 110.0, 290.0, 150.0, 170.0, 160.0, 180.0, 130.0, 40.0, 30.0, 0.0, 100.0, 90.0, 40.0, 40.0, 20.0, 70.0, 20.0, 10.0, 10.0, 130.0, 160.0, 20.0, 30.0, 30.0, 270.0, 160.0, 110.0, 70.0, 200.0, 40.0, 130.0, 60.0, 80.0, 170.0, 5.0, 15.0, 0.0, 20.0, 20.0, -20.0, -10.0, 15.0, 10.0, 70.0, 40.0, 110.0, 70.0, 60.0, 100.0, 50.0, 190.0, 300.0, 340.0, 100.0, 10.0, 30.0, 120.0, 190.0, 30.0, 30.0, 60.0, 500.0, 170.0, 70.0, 310.0, 110.0, 270.0, 80.0, -200.0, 350.0, 30.0, 40.0, 20.0, 30.0, 150.0, 5.0, 30.0, 70.0, 210.0, 30.0, 30.0, 130.0, 170.0, 0.0, 10.0, 110.0, 240.0, 30.0, 10.0, 70.0, 30.0, 30.0, 30.0, 260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0, 20.0, -30.0, 90.0, 260.0, 20.0, 90.0, 120.0, 40.0, -30.0, -10.0, -30.0, 20.0, -15.0, 160.0, 130.0, 0.0, 20.0, 40.0, 160.0, 15.0, 20.0, 50.0, 60.0, 30.0, 10.0, 0.0, 20.0, 100.0, 40.0, 30.0, 70.0, 140.0, 60.0, -70.0, 140.0, 60.0, -55.0, 50.0, 160.0, 360.0, 230.0, 150.0, 140.0, 70.0, 280.0, 80.0, 150.0, 50.0, 0.0, 60.0, 160.0, 150.0, 85.0, 80.0, 30.0, 30.0, 0.0, 260.0, 30.0, 120.0, 80.0, 120.0, 90.0, 60.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, -80.0, 20.0, 40.0, 130.0, 90.0, 80.0, 340.0, 480.0, 150.0, -50.0, 190.0, 70.0, 120.0, 320.0, 100.0, 50.0, 300.0, 90.0, 110.0, 50.0, 30.0, 320.0, 30.0, 60.0, 70.0, 140.0, 280.0, 40.0, 50.0, 90.0, 375.0, 80.0, 110.0, 40.0, 90.0, 0.0, -40.0, 30.0, 10.0, 180.0, 20.0, 80.0, 120.0, 20.0, 30.0, 65.0, 0.0, 30.0, 40.0, 75.0, 40.0, 290.0, 150.0, 40.0, 90.0, 150.0, 30.0, 80.0, 80.0, 50.0, 170.0, 80.0, 60.0, 170.0, 140.0, 60.0, 40.0, 50.0, 140.0, 0.0, 60.0, 70.0, -30.0, 80.0, 300.0, 90.0, 90.0, 200.0, 130.0, 290.0, 20.0, 70.0, 60.0, 90.0, 50.0, 30.0, 170.0, 100.0, 200.0, 60.0, 70.0, 70.0, 40.0, 40.0, 110.0, 20.0, 40.0, 40.0, 260.0, 130.0, 65.0, 120.0, 460.0, 140.0, 40.0, 50.0, 60.0, 520.0, 70.0, 195.0, 0.0, 320.0, 35.0, 110.0, 210.0, 40.0, 30.0, 5.0, 125.0, 120.0, -70.0, 40.0, 100.0, 40.0, 140.0, 120.0, -45.0, 210.0, 80.0, 130.0, 50.0, 300.0, 210.0, 75.0, 110.0, 80.0, 235.0, 30.0, 70.0, 60.0, 0.0, 20.0, 50.0, 190.0, 320.0, 100.0, -20.0, 160.0, -60.0, 0.0, 180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5414098075482168, "mean_inference_ms": 1.4121891700030582, "mean_action_processing_ms": 0.44706788034448103, "mean_env_wait_ms": 1.252637872433305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012490510940551758, "StateBufferConnector_ms": 0.009351253509521484, "ViewRequirementAgentConnector_ms": 0.3984365463256836}, "num_episodes": 23, "episode_return_max": 1750.0, "episode_return_min": -265.0, "episode_return_mean": 953.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.438835043551133, "num_env_steps_trained_throughput_per_sec": 21.438835043551133, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 185994.327, "restore_workers_time_ms": 0.014, "training_step_time_ms": 185994.278, "sample_time_ms": 2534.253, "learn_time_ms": 183440.111, "learn_throughput": 21.805, "synch_weights_time_ms": 10.176}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "33e63_00000", "date": "2024-06-19_01-08-05", "timestamp": 1718773685, "time_this_iter_s": 186.5852289199829, "time_total_s": 14467.214826107025, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14467.214826107025, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 16.489353612167296, "ram_util_percent": 80.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9003732545751606, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.114818898303567, "policy_loss": -0.008427362430977602, "vf_loss": 7.121674440209223, "vf_explained_var": 0.00023598373253632405, "kl": 0.005239403916456508, "entropy": 0.41102318032798424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 1970.0, "episode_reward_min": -265.0, "episode_reward_mean": 988.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -300.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 98.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 1750.0, 960.0, 1050.0, 480.0, 1605.0, 645.0, 925.0, 630.0, 1125.0, 1350.0, 1470.0, 1060.0, 1085.0, 565.0, 450.0, 1435.0, 1210.0, 1250.0, 750.0, 1000.0, 985.0, 1270.0, 1050.0, 1370.0, 860.0, 1070.0, 1440.0, 1105.0, 625.0, 800.0, 1200.0, 1550.0, 1055.0, 930.0, 1400.0, 830.0, 1720.0, 1460.0, 440.0, 635.0, -265.0, 490.0, 1075.0, 1260.0, 505.0, 620.0, 1230.0, 1600.0, 940.0, 510.0, 1150.0, 225.0, 1330.0, 1240.0, 1080.0, 855.0, 560.0, 1060.0, 570.0, 500.0, 360.0, 915.0, 1210.0, 945.0, 550.0, 1200.0, 1400.0, 1110.0, 875.0, 480.0, 1000.0, 910.0, 1280.0, 850.0, 820.0, 1720.0, 995.0, 745.0, 1220.0, 760.0, 1340.0, 490.0, 1970.0, 690.0, 1290.0, 910.0, 730.0, 1170.0, 440.0, 1260.0, 500.0, 1435.0, 995.0, 1160.0, 950.0, 1360.0, 985.0, 1050.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [220.0, 50.0, 5.0, 10.0, 5.0, 150.0, -10.0, 200.0, 70.0, 0.0, 80.0, 140.0, 350.0, 110.0, 260.0, 70.0, 80.0, 150.0, 300.0, 210.0, 30.0, 110.0, 140.0, 70.0, -20.0, 60.0, 110.0, 170.0, 250.0, 40.0, 140.0, 30.0, 30.0, 100.0, 110.0, 30.0, 80.0, 300.0, 200.0, 30.0, 40.0, 30.0, 50.0, 0.0, 50.0, 0.0, 70.0, 230.0, 0.0, 10.0, 470.0, 200.0, 190.0, 200.0, 50.0, 100.0, 100.0, 90.0, 145.0, 60.0, 40.0, -30.0, -30.0, 120.0, 210.0, 70.0, 65.0, 50.0, 20.0, 130.0, 370.0, 30.0, 15.0, 130.0, 30.0, 20.0, 10.0, 0.0, 270.0, 50.0, 30.0, 290.0, 80.0, -40.0, 80.0, 30.0, 50.0, 80.0, 10.0, 20.0, 70.0, 130.0, 25.0, 20.0, 155.0, 200.0, 90.0, 450.0, -25.0, 10.0, 200.0, 230.0, 250.0, 80.0, 10.0, 280.0, 180.0, 20.0, 50.0, 50.0, 350.0, 220.0, 50.0, 70.0, 60.0, 70.0, 110.0, 10.0, 260.0, 270.0, 70.0, 110.0, 210.0, 70.0, -30.0, 310.0, 40.0, 30.0, 190.0, 60.0, -10.0, 45.0, 320.0, 90.0, 180.0, 30.0, 70.0, 20.0, 40.0, 300.0, 50.0, 30.0, 20.0, 25.0, 30.0, 20.0, 0.0, 30.0, 300.0, 60.0, 40.0, 20.0, 20.0, 50.0, 30.0, 0.0, 150.0, 60.0, 10.0, 70.0, 150.0, 130.0, 120.0, 370.0, 270.0, 110.0, 55.0, 30.0, 120.0, 80.0, 60.0, 20.0, 260.0, 50.0, 110.0, 200.0, 110.0, 70.0, 280.0, 50.0, 60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0, 30.0, 50.0, 90.0, 190.0, 110.0, 90.0, 20.0, 60.0, 50.0, 60.0, 160.0, 70.0, 280.0, 70.0, 60.0, 20.0, 240.0, 10.0, 50.0, 40.0, 140.0, 25.0, 20.0, 50.0, 20.0, 80.0, 240.0, 60.0, 320.0, 30.0, 180.0, -80.0, 180.0, 140.0, 360.0, 120.0, 80.0, 50.0, 120.0, 120.0, 190.0, 70.0, 200.0, 200.0, 90.0, 110.0, 150.0, 10.0, 20.0, 10.0, 80.0, 260.0, 20.0, 180.0, 240.0, 10.0, 150.0, 60.0, 190.0, 180.0, 70.0, 160.0, 90.0, 90.0, 20.0, 30.0, 110.0, 60.0, 150.0, 80.0, 120.0, 50.0, 90.0, 230.0, 40.0, -10.0, 80.0, 50.0, 100.0, 320.0, 50.0, 310.0, 170.0, 50.0, 30.0, 60.0, 310.0, -30.0, 300.0, 190.0, 100.0, 30.0, 180.0, 590.0, -45.0, 90.0, 20.0, 50.0, 0.0, 90.0, 150.0, 10.0, 0.0, 180.0, 85.0, 10.0, 40.0, 70.0, 40.0, 40.0, 90.0, 90.0, -20.0, 0.0, 110.0, 50.0, 90.0, 50.0, 30.0, 310.0, 180.0, 40.0, 30.0, 40.0, 160.0, 130.0, 290.0, 90.0, 120.0, 120.0, 90.0, -50.0, 180.0, 120.0, 70.0, 240.0, 100.0, 110.0, 480.0, 210.0, 15.0, 150.0, 140.0, 35.0, 60.0, 70.0, 160.0, 160.0, 260.0, 5.0, 65.0, 150.0, 50.0, 40.0, 120.0, 20.0, 10.0, 105.0, 20.0, 350.0, 240.0, 30.0, 50.0, -80.0, 50.0, 440.0, -20.0, 510.0, 160.0, 20.0, 25.0, 125.0, 70.0, 0.0, 190.0, 120.0, 50.0, 70.0, 80.0, 100.0, 60.0, 130.0, 360.0, 100.0, 110.0, 380.0, 250.0, 110.0, 150.0, 70.0, -30.0, 380.0, 80.0, 20.0, 120.0, 190.0, 90.0, 330.0, 190.0, 90.0, 20.0, 30.0, 150.0, 160.0, 20.0, 20.0, -60.0, 0.0, 80.0, 20.0, -40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0, -20.0, -245.0, 20.0, 150.0, -300.0, 10.0, 40.0, 20.0, 40.0, 20.0, 90.0, 30.0, 30.0, 90.0, 40.0, 50.0, 50.0, 50.0, 20.0, 40.0, 120.0, 100.0, 10.0, 180.0, 10.0, 290.0, 0.0, 65.0, 40.0, 260.0, 60.0, 30.0, 210.0, 280.0, 30.0, 60.0, 40.0, 10.0, 250.0, 290.0, 130.0, 10.0, 10.0, 20.0, 0.0, 5.0, 30.0, 210.0, 30.0, 60.0, 130.0, 70.0, 20.0, 50.0, 20.0, 40.0, 70.0, 40.0, 90.0, 90.0, 120.0, 640.0, 20.0, 30.0, -40.0, 100.0, -10.0, 130.0, 160.0, 80.0, 110.0, 700.0, 30.0, 30.0, 40.0, 120.0, 20.0, 110.0, 290.0, 150.0, 170.0, 160.0, 180.0, 130.0, 40.0, 30.0, 0.0, 100.0, 90.0, 40.0, 40.0, 20.0, 70.0, 20.0, 10.0, 10.0, 130.0, 160.0, 20.0, 30.0, 30.0, 270.0, 160.0, 110.0, 70.0, 200.0, 40.0, 130.0, 60.0, 80.0, 170.0, 5.0, 15.0, 0.0, 20.0, 20.0, -20.0, -10.0, 15.0, 10.0, 70.0, 40.0, 110.0, 70.0, 60.0, 100.0, 50.0, 190.0, 300.0, 340.0, 100.0, 10.0, 30.0, 120.0, 190.0, 30.0, 30.0, 60.0, 500.0, 170.0, 70.0, 310.0, 110.0, 270.0, 80.0, -200.0, 350.0, 30.0, 40.0, 20.0, 30.0, 150.0, 5.0, 30.0, 70.0, 210.0, 30.0, 30.0, 130.0, 170.0, 0.0, 10.0, 110.0, 240.0, 30.0, 10.0, 70.0, 30.0, 30.0, 30.0, 260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0, 20.0, -30.0, 90.0, 260.0, 20.0, 90.0, 120.0, 40.0, -30.0, -10.0, -30.0, 20.0, -15.0, 160.0, 130.0, 0.0, 20.0, 40.0, 160.0, 15.0, 20.0, 50.0, 60.0, 30.0, 10.0, 0.0, 20.0, 100.0, 40.0, 30.0, 70.0, 140.0, 60.0, -70.0, 140.0, 60.0, -55.0, 50.0, 160.0, 360.0, 230.0, 150.0, 140.0, 70.0, 280.0, 80.0, 150.0, 50.0, 0.0, 60.0, 160.0, 150.0, 85.0, 80.0, 30.0, 30.0, 0.0, 260.0, 30.0, 120.0, 80.0, 120.0, 90.0, 60.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, -80.0, 20.0, 40.0, 130.0, 90.0, 80.0, 340.0, 480.0, 150.0, -50.0, 190.0, 70.0, 120.0, 320.0, 100.0, 50.0, 300.0, 90.0, 110.0, 50.0, 30.0, 320.0, 30.0, 60.0, 70.0, 140.0, 280.0, 40.0, 50.0, 90.0, 375.0, 80.0, 110.0, 40.0, 90.0, 0.0, -40.0, 30.0, 10.0, 180.0, 20.0, 80.0, 120.0, 20.0, 30.0, 65.0, 0.0, 30.0, 40.0, 75.0, 40.0, 290.0, 150.0, 40.0, 90.0, 150.0, 30.0, 80.0, 80.0, 50.0, 170.0, 80.0, 60.0, 170.0, 140.0, 60.0, 40.0, 50.0, 140.0, 0.0, 60.0, 70.0, -30.0, 80.0, 300.0, 90.0, 90.0, 200.0, 130.0, 290.0, 20.0, 70.0, 60.0, 90.0, 50.0, 30.0, 170.0, 100.0, 200.0, 60.0, 70.0, 70.0, 40.0, 40.0, 110.0, 20.0, 40.0, 40.0, 260.0, 130.0, 65.0, 120.0, 460.0, 140.0, 40.0, 50.0, 60.0, 520.0, 70.0, 195.0, 0.0, 320.0, 35.0, 110.0, 210.0, 40.0, 30.0, 5.0, 125.0, 120.0, -70.0, 40.0, 100.0, 40.0, 140.0, 120.0, -45.0, 210.0, 80.0, 130.0, 50.0, 300.0, 210.0, 75.0, 110.0, 80.0, 235.0, 30.0, 70.0, 60.0, 0.0, 20.0, 50.0, 190.0, 320.0, 100.0, -20.0, 160.0, -60.0, 0.0, 180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0, 50.0, 25.0, 20.0, 150.0, 20.0, 110.0, 25.0, 90.0, 0.0, 0.0, 80.0, 340.0, 120.0, 80.0, 570.0, 500.0, 110.0, 90.0, 90.0, -10.0, 50.0, 50.0, 20.0, 110.0, 60.0, 70.0, 160.0, 10.0, 160.0, 0.0, 360.0, 60.0, 70.0, 180.0, 260.0, 160.0, 90.0, -10.0, 70.0, 50.0, 30.0, 40.0, 130.0, 70.0, 160.0, 30.0, 160.0, 30.0, 40.0, 220.0, 70.0, 20.0, 80.0, 160.0, 100.0, 40.0, 40.0, 40.0, 70.0, 110.0, 80.0, 10.0, 110.0, -70.0, 260.0, 340.0, 160.0, 130.0, 40.0, 110.0, 20.0, 10.0, 0.0, 0.0, 180.0, 80.0, 50.0, 40.0, 40.0, 20.0, 230.0, 120.0, 170.0, 60.0, 180.0, 90.0, 130.0, 160.0, 60.0, 60.0, 20.0, 230.0, 40.0, 30.0, 40.0, 0.0, 40.0, 20.0, 80.0, 0.0, 190.0, 40.0, 60.0, 105.0, 630.0, 80.0, 0.0, 50.0, 110.0, 170.0, 70.0, 180.0, 200.0, 40.0, 20.0, 130.0, 160.0, 140.0, 0.0, 55.0, 100.0, 50.0, 330.0, 210.0, 150.0, 170.0, 110.0, 20.0, 0.0, 20.0, 20.0, 210.0, 40.0, 90.0, 40.0, 170.0, 40.0, 310.0, 0.0, 30.0, 50.0, -45.0, 160.0, 160.0, 50.0, 40.0, 95.0, 230.0, 540.0, 80.0, 85.0, 120.0, 40.0, 140.0, 290.0, 80.0, 70.0, 30.0, 60.0, 70.0, 130.0, 360.0, 15.0, 170.0, 80.0, 80.0, -15.0, 20.0, 180.0, 30.0, 50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5417213047634857, "mean_inference_ms": 1.41186785772389, "mean_action_processing_ms": 0.4463004742569453, "mean_env_wait_ms": 1.252267669706685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012524843215942383, "StateBufferConnector_ms": 0.009405851364135742, "ViewRequirementAgentConnector_ms": 0.4035007953643799}, "num_episodes": 18, "episode_return_max": 1970.0, "episode_return_min": -265.0, "episode_return_mean": 988.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.382473881657802, "num_env_steps_trained_throughput_per_sec": 21.382473881657802, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 186146.216, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186146.172, "sample_time_ms": 2523.033, "learn_time_ms": 183603.126, "learn_throughput": 21.786, "synch_weights_time_ms": 10.151}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "33e63_00000", "date": "2024-06-19_01-11-12", "timestamp": 1718773872, "time_this_iter_s": 187.0789749622345, "time_total_s": 14654.29380106926, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32773aa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14654.29380106926, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 16.681509433962262, "ram_util_percent": 79.10113207547171}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6251316137334157, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.96072149043139, "policy_loss": -0.00832343830804403, "vf_loss": 6.967510814991749, "vf_explained_var": -0.00038216632649032704, "kl": 0.005113706620770866, "entropy": 0.46035979219709344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 2590.0, "episode_reward_min": -265.0, "episode_reward_mean": 967.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 96.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.0, 750.0, 1000.0, 985.0, 1270.0, 1050.0, 1370.0, 860.0, 1070.0, 1440.0, 1105.0, 625.0, 800.0, 1200.0, 1550.0, 1055.0, 930.0, 1400.0, 830.0, 1720.0, 1460.0, 440.0, 635.0, -265.0, 490.0, 1075.0, 1260.0, 505.0, 620.0, 1230.0, 1600.0, 940.0, 510.0, 1150.0, 225.0, 1330.0, 1240.0, 1080.0, 855.0, 560.0, 1060.0, 570.0, 500.0, 360.0, 915.0, 1210.0, 945.0, 550.0, 1200.0, 1400.0, 1110.0, 875.0, 480.0, 1000.0, 910.0, 1280.0, 850.0, 820.0, 1720.0, 995.0, 745.0, 1220.0, 760.0, 1340.0, 490.0, 1970.0, 690.0, 1290.0, 910.0, 730.0, 1170.0, 440.0, 1260.0, 500.0, 1435.0, 995.0, 1160.0, 950.0, 1360.0, 985.0, 1050.0, 910.0, 980.0, 620.0, 690.0, 735.0, 1280.0, 485.0, 390.0, 1390.0, 415.0, 1150.0, 1070.0, 555.0, 1070.0, 780.0, 885.0, 850.0, 2590.0, 460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, -120.0, 70.0, 520.0, 70.0, 200.0, 0.0, 230.0, 30.0, 190.0, 30.0, 50.0, 90.0, 190.0, 110.0, 90.0, 20.0, 60.0, 50.0, 60.0, 160.0, 70.0, 280.0, 70.0, 60.0, 20.0, 240.0, 10.0, 50.0, 40.0, 140.0, 25.0, 20.0, 50.0, 20.0, 80.0, 240.0, 60.0, 320.0, 30.0, 180.0, -80.0, 180.0, 140.0, 360.0, 120.0, 80.0, 50.0, 120.0, 120.0, 190.0, 70.0, 200.0, 200.0, 90.0, 110.0, 150.0, 10.0, 20.0, 10.0, 80.0, 260.0, 20.0, 180.0, 240.0, 10.0, 150.0, 60.0, 190.0, 180.0, 70.0, 160.0, 90.0, 90.0, 20.0, 30.0, 110.0, 60.0, 150.0, 80.0, 120.0, 50.0, 90.0, 230.0, 40.0, -10.0, 80.0, 50.0, 100.0, 320.0, 50.0, 310.0, 170.0, 50.0, 30.0, 60.0, 310.0, -30.0, 300.0, 190.0, 100.0, 30.0, 180.0, 590.0, -45.0, 90.0, 20.0, 50.0, 0.0, 90.0, 150.0, 10.0, 0.0, 180.0, 85.0, 10.0, 40.0, 70.0, 40.0, 40.0, 90.0, 90.0, -20.0, 0.0, 110.0, 50.0, 90.0, 50.0, 30.0, 310.0, 180.0, 40.0, 30.0, 40.0, 160.0, 130.0, 290.0, 90.0, 120.0, 120.0, 90.0, -50.0, 180.0, 120.0, 70.0, 240.0, 100.0, 110.0, 480.0, 210.0, 15.0, 150.0, 140.0, 35.0, 60.0, 70.0, 160.0, 160.0, 260.0, 5.0, 65.0, 150.0, 50.0, 40.0, 120.0, 20.0, 10.0, 105.0, 20.0, 350.0, 240.0, 30.0, 50.0, -80.0, 50.0, 440.0, -20.0, 510.0, 160.0, 20.0, 25.0, 125.0, 70.0, 0.0, 190.0, 120.0, 50.0, 70.0, 80.0, 100.0, 60.0, 130.0, 360.0, 100.0, 110.0, 380.0, 250.0, 110.0, 150.0, 70.0, -30.0, 380.0, 80.0, 20.0, 120.0, 190.0, 90.0, 330.0, 190.0, 90.0, 20.0, 30.0, 150.0, 160.0, 20.0, 20.0, -60.0, 0.0, 80.0, 20.0, -40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0, -20.0, -245.0, 20.0, 150.0, -300.0, 10.0, 40.0, 20.0, 40.0, 20.0, 90.0, 30.0, 30.0, 90.0, 40.0, 50.0, 50.0, 50.0, 20.0, 40.0, 120.0, 100.0, 10.0, 180.0, 10.0, 290.0, 0.0, 65.0, 40.0, 260.0, 60.0, 30.0, 210.0, 280.0, 30.0, 60.0, 40.0, 10.0, 250.0, 290.0, 130.0, 10.0, 10.0, 20.0, 0.0, 5.0, 30.0, 210.0, 30.0, 60.0, 130.0, 70.0, 20.0, 50.0, 20.0, 40.0, 70.0, 40.0, 90.0, 90.0, 120.0, 640.0, 20.0, 30.0, -40.0, 100.0, -10.0, 130.0, 160.0, 80.0, 110.0, 700.0, 30.0, 30.0, 40.0, 120.0, 20.0, 110.0, 290.0, 150.0, 170.0, 160.0, 180.0, 130.0, 40.0, 30.0, 0.0, 100.0, 90.0, 40.0, 40.0, 20.0, 70.0, 20.0, 10.0, 10.0, 130.0, 160.0, 20.0, 30.0, 30.0, 270.0, 160.0, 110.0, 70.0, 200.0, 40.0, 130.0, 60.0, 80.0, 170.0, 5.0, 15.0, 0.0, 20.0, 20.0, -20.0, -10.0, 15.0, 10.0, 70.0, 40.0, 110.0, 70.0, 60.0, 100.0, 50.0, 190.0, 300.0, 340.0, 100.0, 10.0, 30.0, 120.0, 190.0, 30.0, 30.0, 60.0, 500.0, 170.0, 70.0, 310.0, 110.0, 270.0, 80.0, -200.0, 350.0, 30.0, 40.0, 20.0, 30.0, 150.0, 5.0, 30.0, 70.0, 210.0, 30.0, 30.0, 130.0, 170.0, 0.0, 10.0, 110.0, 240.0, 30.0, 10.0, 70.0, 30.0, 30.0, 30.0, 260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0, 20.0, -30.0, 90.0, 260.0, 20.0, 90.0, 120.0, 40.0, -30.0, -10.0, -30.0, 20.0, -15.0, 160.0, 130.0, 0.0, 20.0, 40.0, 160.0, 15.0, 20.0, 50.0, 60.0, 30.0, 10.0, 0.0, 20.0, 100.0, 40.0, 30.0, 70.0, 140.0, 60.0, -70.0, 140.0, 60.0, -55.0, 50.0, 160.0, 360.0, 230.0, 150.0, 140.0, 70.0, 280.0, 80.0, 150.0, 50.0, 0.0, 60.0, 160.0, 150.0, 85.0, 80.0, 30.0, 30.0, 0.0, 260.0, 30.0, 120.0, 80.0, 120.0, 90.0, 60.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, -80.0, 20.0, 40.0, 130.0, 90.0, 80.0, 340.0, 480.0, 150.0, -50.0, 190.0, 70.0, 120.0, 320.0, 100.0, 50.0, 300.0, 90.0, 110.0, 50.0, 30.0, 320.0, 30.0, 60.0, 70.0, 140.0, 280.0, 40.0, 50.0, 90.0, 375.0, 80.0, 110.0, 40.0, 90.0, 0.0, -40.0, 30.0, 10.0, 180.0, 20.0, 80.0, 120.0, 20.0, 30.0, 65.0, 0.0, 30.0, 40.0, 75.0, 40.0, 290.0, 150.0, 40.0, 90.0, 150.0, 30.0, 80.0, 80.0, 50.0, 170.0, 80.0, 60.0, 170.0, 140.0, 60.0, 40.0, 50.0, 140.0, 0.0, 60.0, 70.0, -30.0, 80.0, 300.0, 90.0, 90.0, 200.0, 130.0, 290.0, 20.0, 70.0, 60.0, 90.0, 50.0, 30.0, 170.0, 100.0, 200.0, 60.0, 70.0, 70.0, 40.0, 40.0, 110.0, 20.0, 40.0, 40.0, 260.0, 130.0, 65.0, 120.0, 460.0, 140.0, 40.0, 50.0, 60.0, 520.0, 70.0, 195.0, 0.0, 320.0, 35.0, 110.0, 210.0, 40.0, 30.0, 5.0, 125.0, 120.0, -70.0, 40.0, 100.0, 40.0, 140.0, 120.0, -45.0, 210.0, 80.0, 130.0, 50.0, 300.0, 210.0, 75.0, 110.0, 80.0, 235.0, 30.0, 70.0, 60.0, 0.0, 20.0, 50.0, 190.0, 320.0, 100.0, -20.0, 160.0, -60.0, 0.0, 180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0, 50.0, 25.0, 20.0, 150.0, 20.0, 110.0, 25.0, 90.0, 0.0, 0.0, 80.0, 340.0, 120.0, 80.0, 570.0, 500.0, 110.0, 90.0, 90.0, -10.0, 50.0, 50.0, 20.0, 110.0, 60.0, 70.0, 160.0, 10.0, 160.0, 0.0, 360.0, 60.0, 70.0, 180.0, 260.0, 160.0, 90.0, -10.0, 70.0, 50.0, 30.0, 40.0, 130.0, 70.0, 160.0, 30.0, 160.0, 30.0, 40.0, 220.0, 70.0, 20.0, 80.0, 160.0, 100.0, 40.0, 40.0, 40.0, 70.0, 110.0, 80.0, 10.0, 110.0, -70.0, 260.0, 340.0, 160.0, 130.0, 40.0, 110.0, 20.0, 10.0, 0.0, 0.0, 180.0, 80.0, 50.0, 40.0, 40.0, 20.0, 230.0, 120.0, 170.0, 60.0, 180.0, 90.0, 130.0, 160.0, 60.0, 60.0, 20.0, 230.0, 40.0, 30.0, 40.0, 0.0, 40.0, 20.0, 80.0, 0.0, 190.0, 40.0, 60.0, 105.0, 630.0, 80.0, 0.0, 50.0, 110.0, 170.0, 70.0, 180.0, 200.0, 40.0, 20.0, 130.0, 160.0, 140.0, 0.0, 55.0, 100.0, 50.0, 330.0, 210.0, 150.0, 170.0, 110.0, 20.0, 0.0, 20.0, 20.0, 210.0, 40.0, 90.0, 40.0, 170.0, 40.0, 310.0, 0.0, 30.0, 50.0, -45.0, 160.0, 160.0, 50.0, 40.0, 95.0, 230.0, 540.0, 80.0, 85.0, 120.0, 40.0, 140.0, 290.0, 80.0, 70.0, 30.0, 60.0, 70.0, 130.0, 360.0, 15.0, 170.0, 80.0, 80.0, -15.0, 20.0, 180.0, 30.0, 50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0, 20.0, 150.0, 30.0, 90.0, 40.0, -60.0, 80.0, 200.0, 200.0, 230.0, 90.0, 40.0, 40.0, 50.0, 160.0, 10.0, 170.0, 0.0, 40.0, 20.0, 50.0, 20.0, 10.0, 110.0, 70.0, 90.0, 30.0, 40.0, 250.0, 20.0, 310.0, 170.0, 90.0, -40.0, 0.0, 40.0, 45.0, 70.0, 30.0, 20.0, 110.0, 70.0, 340.0, 200.0, 90.0, 70.0, 70.0, 130.0, 100.0, 100.0, 480.0, 90.0, -370.0, 10.0, -30.0, 190.0, 0.0, 5.0, 50.0, 60.0, 20.0, 40.0, 5.0, 110.0, 60.0, 150.0, 10.0, 80.0, 0.0, -85.0, 60.0, 40.0, 520.0, 100.0, 20.0, 250.0, 230.0, 30.0, 40.0, 100.0, 90.0, -10.0, 10.0, 10.0, 40.0, 20.0, 40.0, -15.0, 120.0, 110.0, 60.0, 130.0, 110.0, 90.0, 90.0, 110.0, -10.0, 200.0, 260.0, 110.0, 190.0, 220.0, 280.0, 0.0, 150.0, 130.0, -30.0, 20.0, -10.0, 120.0, 20.0, 40.0, 70.0, 50.0, 15.0, 0.0, 180.0, 0.0, 20.0, 160.0, 350.0, 60.0, 80.0, 100.0, 50.0, 110.0, 120.0, 90.0, 10.0, 100.0, 250.0, 60.0, 5.0, 10.0, 130.0, 10.0, 250.0, 5.0, 0.0, 60.0, 190.0, -130.0, 30.0, 160.0, 220.0, 30.0, 30.0, 55.0, 180.0, 120.0, 100.0, -40.0, 60.0, -50.0, 430.0, 240.0, 90.0, -40.0, -20.0, 80.0, 1090.0, 250.0, 220.0, 320.0, 80.0, 390.0, 120.0, -20.0, 70.0, 70.0, -120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5414904219832428, "mean_inference_ms": 1.4114854726642818, "mean_action_processing_ms": 0.44553389661956017, "mean_env_wait_ms": 1.2518000407884795, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012141942977905273, "StateBufferConnector_ms": 0.009183406829833984, "ViewRequirementAgentConnector_ms": 0.3935716152191162}, "num_episodes": 18, "episode_return_max": 2590.0, "episode_return_min": -265.0, "episode_return_mean": 967.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.684015915725766, "num_env_steps_trained_throughput_per_sec": 21.684015915725766, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 186132.968, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186132.924, "sample_time_ms": 2544.866, "learn_time_ms": 183567.934, "learn_throughput": 21.79, "synch_weights_time_ms": 10.38}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "33e63_00000", "date": "2024-06-19_01-14-16", "timestamp": 1718774056, "time_this_iter_s": 184.47843980789185, "time_total_s": 14838.772240877151, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b7670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14838.772240877151, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 15.94022988505747, "ram_util_percent": 77.67969348659004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.310761179799597, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009259663802086593, "vf_loss": 6.884650181556028, "vf_explained_var": -0.0003083312854218407, "kl": Infinity, "entropy": 0.4513004388735571, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 2590.0, "episode_reward_min": -265.0, "episode_reward_mean": 928.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 92.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [635.0, -265.0, 490.0, 1075.0, 1260.0, 505.0, 620.0, 1230.0, 1600.0, 940.0, 510.0, 1150.0, 225.0, 1330.0, 1240.0, 1080.0, 855.0, 560.0, 1060.0, 570.0, 500.0, 360.0, 915.0, 1210.0, 945.0, 550.0, 1200.0, 1400.0, 1110.0, 875.0, 480.0, 1000.0, 910.0, 1280.0, 850.0, 820.0, 1720.0, 995.0, 745.0, 1220.0, 760.0, 1340.0, 490.0, 1970.0, 690.0, 1290.0, 910.0, 730.0, 1170.0, 440.0, 1260.0, 500.0, 1435.0, 995.0, 1160.0, 950.0, 1360.0, 985.0, 1050.0, 910.0, 980.0, 620.0, 690.0, 735.0, 1280.0, 485.0, 390.0, 1390.0, 415.0, 1150.0, 1070.0, 555.0, 1070.0, 780.0, 885.0, 850.0, 2590.0, 460.0, 1110.0, 1500.0, 1170.0, 625.0, 750.0, 240.0, 1220.0, 1010.0, 1110.0, 810.0, 350.0, 420.0, 405.0, 355.0, 610.0, 950.0, 1365.0, 1440.0, 1320.0, 1220.0, 1320.0, 1010.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-40.0, 30.0, 60.0, 150.0, -35.0, 0.0, 20.0, 90.0, 60.0, 300.0, -20.0, -245.0, 20.0, 150.0, -300.0, 10.0, 40.0, 20.0, 40.0, 20.0, 90.0, 30.0, 30.0, 90.0, 40.0, 50.0, 50.0, 50.0, 20.0, 40.0, 120.0, 100.0, 10.0, 180.0, 10.0, 290.0, 0.0, 65.0, 40.0, 260.0, 60.0, 30.0, 210.0, 280.0, 30.0, 60.0, 40.0, 10.0, 250.0, 290.0, 130.0, 10.0, 10.0, 20.0, 0.0, 5.0, 30.0, 210.0, 30.0, 60.0, 130.0, 70.0, 20.0, 50.0, 20.0, 40.0, 70.0, 40.0, 90.0, 90.0, 120.0, 640.0, 20.0, 30.0, -40.0, 100.0, -10.0, 130.0, 160.0, 80.0, 110.0, 700.0, 30.0, 30.0, 40.0, 120.0, 20.0, 110.0, 290.0, 150.0, 170.0, 160.0, 180.0, 130.0, 40.0, 30.0, 0.0, 100.0, 90.0, 40.0, 40.0, 20.0, 70.0, 20.0, 10.0, 10.0, 130.0, 160.0, 20.0, 30.0, 30.0, 270.0, 160.0, 110.0, 70.0, 200.0, 40.0, 130.0, 60.0, 80.0, 170.0, 5.0, 15.0, 0.0, 20.0, 20.0, -20.0, -10.0, 15.0, 10.0, 70.0, 40.0, 110.0, 70.0, 60.0, 100.0, 50.0, 190.0, 300.0, 340.0, 100.0, 10.0, 30.0, 120.0, 190.0, 30.0, 30.0, 60.0, 500.0, 170.0, 70.0, 310.0, 110.0, 270.0, 80.0, -200.0, 350.0, 30.0, 40.0, 20.0, 30.0, 150.0, 5.0, 30.0, 70.0, 210.0, 30.0, 30.0, 130.0, 170.0, 0.0, 10.0, 110.0, 240.0, 30.0, 10.0, 70.0, 30.0, 30.0, 30.0, 260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0, 20.0, -30.0, 90.0, 260.0, 20.0, 90.0, 120.0, 40.0, -30.0, -10.0, -30.0, 20.0, -15.0, 160.0, 130.0, 0.0, 20.0, 40.0, 160.0, 15.0, 20.0, 50.0, 60.0, 30.0, 10.0, 0.0, 20.0, 100.0, 40.0, 30.0, 70.0, 140.0, 60.0, -70.0, 140.0, 60.0, -55.0, 50.0, 160.0, 360.0, 230.0, 150.0, 140.0, 70.0, 280.0, 80.0, 150.0, 50.0, 0.0, 60.0, 160.0, 150.0, 85.0, 80.0, 30.0, 30.0, 0.0, 260.0, 30.0, 120.0, 80.0, 120.0, 90.0, 60.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, -80.0, 20.0, 40.0, 130.0, 90.0, 80.0, 340.0, 480.0, 150.0, -50.0, 190.0, 70.0, 120.0, 320.0, 100.0, 50.0, 300.0, 90.0, 110.0, 50.0, 30.0, 320.0, 30.0, 60.0, 70.0, 140.0, 280.0, 40.0, 50.0, 90.0, 375.0, 80.0, 110.0, 40.0, 90.0, 0.0, -40.0, 30.0, 10.0, 180.0, 20.0, 80.0, 120.0, 20.0, 30.0, 65.0, 0.0, 30.0, 40.0, 75.0, 40.0, 290.0, 150.0, 40.0, 90.0, 150.0, 30.0, 80.0, 80.0, 50.0, 170.0, 80.0, 60.0, 170.0, 140.0, 60.0, 40.0, 50.0, 140.0, 0.0, 60.0, 70.0, -30.0, 80.0, 300.0, 90.0, 90.0, 200.0, 130.0, 290.0, 20.0, 70.0, 60.0, 90.0, 50.0, 30.0, 170.0, 100.0, 200.0, 60.0, 70.0, 70.0, 40.0, 40.0, 110.0, 20.0, 40.0, 40.0, 260.0, 130.0, 65.0, 120.0, 460.0, 140.0, 40.0, 50.0, 60.0, 520.0, 70.0, 195.0, 0.0, 320.0, 35.0, 110.0, 210.0, 40.0, 30.0, 5.0, 125.0, 120.0, -70.0, 40.0, 100.0, 40.0, 140.0, 120.0, -45.0, 210.0, 80.0, 130.0, 50.0, 300.0, 210.0, 75.0, 110.0, 80.0, 235.0, 30.0, 70.0, 60.0, 0.0, 20.0, 50.0, 190.0, 320.0, 100.0, -20.0, 160.0, -60.0, 0.0, 180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0, 50.0, 25.0, 20.0, 150.0, 20.0, 110.0, 25.0, 90.0, 0.0, 0.0, 80.0, 340.0, 120.0, 80.0, 570.0, 500.0, 110.0, 90.0, 90.0, -10.0, 50.0, 50.0, 20.0, 110.0, 60.0, 70.0, 160.0, 10.0, 160.0, 0.0, 360.0, 60.0, 70.0, 180.0, 260.0, 160.0, 90.0, -10.0, 70.0, 50.0, 30.0, 40.0, 130.0, 70.0, 160.0, 30.0, 160.0, 30.0, 40.0, 220.0, 70.0, 20.0, 80.0, 160.0, 100.0, 40.0, 40.0, 40.0, 70.0, 110.0, 80.0, 10.0, 110.0, -70.0, 260.0, 340.0, 160.0, 130.0, 40.0, 110.0, 20.0, 10.0, 0.0, 0.0, 180.0, 80.0, 50.0, 40.0, 40.0, 20.0, 230.0, 120.0, 170.0, 60.0, 180.0, 90.0, 130.0, 160.0, 60.0, 60.0, 20.0, 230.0, 40.0, 30.0, 40.0, 0.0, 40.0, 20.0, 80.0, 0.0, 190.0, 40.0, 60.0, 105.0, 630.0, 80.0, 0.0, 50.0, 110.0, 170.0, 70.0, 180.0, 200.0, 40.0, 20.0, 130.0, 160.0, 140.0, 0.0, 55.0, 100.0, 50.0, 330.0, 210.0, 150.0, 170.0, 110.0, 20.0, 0.0, 20.0, 20.0, 210.0, 40.0, 90.0, 40.0, 170.0, 40.0, 310.0, 0.0, 30.0, 50.0, -45.0, 160.0, 160.0, 50.0, 40.0, 95.0, 230.0, 540.0, 80.0, 85.0, 120.0, 40.0, 140.0, 290.0, 80.0, 70.0, 30.0, 60.0, 70.0, 130.0, 360.0, 15.0, 170.0, 80.0, 80.0, -15.0, 20.0, 180.0, 30.0, 50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0, 20.0, 150.0, 30.0, 90.0, 40.0, -60.0, 80.0, 200.0, 200.0, 230.0, 90.0, 40.0, 40.0, 50.0, 160.0, 10.0, 170.0, 0.0, 40.0, 20.0, 50.0, 20.0, 10.0, 110.0, 70.0, 90.0, 30.0, 40.0, 250.0, 20.0, 310.0, 170.0, 90.0, -40.0, 0.0, 40.0, 45.0, 70.0, 30.0, 20.0, 110.0, 70.0, 340.0, 200.0, 90.0, 70.0, 70.0, 130.0, 100.0, 100.0, 480.0, 90.0, -370.0, 10.0, -30.0, 190.0, 0.0, 5.0, 50.0, 60.0, 20.0, 40.0, 5.0, 110.0, 60.0, 150.0, 10.0, 80.0, 0.0, -85.0, 60.0, 40.0, 520.0, 100.0, 20.0, 250.0, 230.0, 30.0, 40.0, 100.0, 90.0, -10.0, 10.0, 10.0, 40.0, 20.0, 40.0, -15.0, 120.0, 110.0, 60.0, 130.0, 110.0, 90.0, 90.0, 110.0, -10.0, 200.0, 260.0, 110.0, 190.0, 220.0, 280.0, 0.0, 150.0, 130.0, -30.0, 20.0, -10.0, 120.0, 20.0, 40.0, 70.0, 50.0, 15.0, 0.0, 180.0, 0.0, 20.0, 160.0, 350.0, 60.0, 80.0, 100.0, 50.0, 110.0, 120.0, 90.0, 10.0, 100.0, 250.0, 60.0, 5.0, 10.0, 130.0, 10.0, 250.0, 5.0, 0.0, 60.0, 190.0, -130.0, 30.0, 160.0, 220.0, 30.0, 30.0, 55.0, 180.0, 120.0, 100.0, -40.0, 60.0, -50.0, 430.0, 240.0, 90.0, -40.0, -20.0, 80.0, 1090.0, 250.0, 220.0, 320.0, 80.0, 390.0, 120.0, -20.0, 70.0, 70.0, -120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0, 100.0, 20.0, 20.0, 20.0, 30.0, 320.0, 60.0, 220.0, 240.0, 80.0, 150.0, 70.0, 120.0, 110.0, 80.0, 70.0, 90.0, 530.0, 180.0, 100.0, 110.0, 60.0, 520.0, 40.0, 100.0, 30.0, 40.0, 130.0, 60.0, 80.0, 130.0, 110.0, 40.0, 10.0, 50.0, 180.0, 10.0, 50.0, 30.0, 15.0, 30.0, 30.0, 190.0, 20.0, 50.0, 0.0, 90.0, 60.0, 0.0, 280.0, 20.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 40.0, 100.0, 210.0, 160.0, 120.0, 120.0, 210.0, 90.0, 120.0, 50.0, 60.0, 80.0, 150.0, 340.0, 80.0, 80.0, -30.0, 40.0, 170.0, 40.0, 70.0, 90.0, 170.0, 110.0, 110.0, 50.0, 100.0, 340.0, 50.0, 20.0, 20.0, 70.0, 80.0, 110.0, 90.0, 80.0, 170.0, 140.0, 45.0, 5.0, 160.0, 0.0, -40.0, 360.0, 60.0, -70.0, -190.0, -140.0, 360.0, -150.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 80.0, 30.0, 180.0, 40.0, 15.0, 10.0, 0.0, 40.0, 70.0, 70.0, 110.0, 20.0, 30.0, 110.0, -105.0, 60.0, 50.0, 50.0, 60.0, 180.0, -115.0, 30.0, 35.0, 20.0, 60.0, 60.0, 0.0, 230.0, 20.0, 80.0, 30.0, 100.0, 10.0, 120.0, 10.0, 220.0, 70.0, 30.0, 260.0, 100.0, 20.0, 50.0, 70.0, 60.0, 30.0, 300.0, 40.0, 260.0, 0.0, 70.0, 480.0, 20.0, 105.0, 60.0, 110.0, 250.0, 20.0, 130.0, 40.0, 510.0, 10.0, 260.0, 50.0, 80.0, 140.0, 140.0, 70.0, 200.0, 230.0, 90.0, 300.0, 60.0, 10.0, 80.0, 50.0, 70.0, 120.0, 330.0, -30.0, 130.0, 130.0, 210.0, 130.0, 190.0, 250.0, 10.0, 40.0, 90.0, 390.0, 20.0, 100.0, 180.0, 50.0, 30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.541147221576116, "mean_inference_ms": 1.411637380010568, "mean_action_processing_ms": 0.44459230643404596, "mean_env_wait_ms": 1.2513955380493704, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012264013290405273, "StateBufferConnector_ms": 0.009259939193725586, "ViewRequirementAgentConnector_ms": 0.3914036750793457}, "num_episodes": 22, "episode_return_max": 2590.0, "episode_return_min": -265.0, "episode_return_mean": 928.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.428688123545385, "num_env_steps_trained_throughput_per_sec": 21.428688123545385, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 186253.837, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186253.794, "sample_time_ms": 2531.545, "learn_time_ms": 183702.305, "learn_throughput": 21.774, "synch_weights_time_ms": 10.33}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "33e63_00000", "date": "2024-06-19_01-17-23", "timestamp": 1718774243, "time_this_iter_s": 186.68105602264404, "time_total_s": 15025.453296899796, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3272d1e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15025.453296899796, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 16.84280303030303, "ram_util_percent": 78.50416666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2853767236454674, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.181045669590195, "policy_loss": -0.008595031476158081, "vf_loss": 7.18759949946175, "vf_explained_var": -6.982502592003511e-05, "kl": 0.004536003837769874, "entropy": 0.4339747219992141, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 2590.0, "episode_reward_min": 240.0, "episode_reward_mean": 943.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 94.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1060.0, 570.0, 500.0, 360.0, 915.0, 1210.0, 945.0, 550.0, 1200.0, 1400.0, 1110.0, 875.0, 480.0, 1000.0, 910.0, 1280.0, 850.0, 820.0, 1720.0, 995.0, 745.0, 1220.0, 760.0, 1340.0, 490.0, 1970.0, 690.0, 1290.0, 910.0, 730.0, 1170.0, 440.0, 1260.0, 500.0, 1435.0, 995.0, 1160.0, 950.0, 1360.0, 985.0, 1050.0, 910.0, 980.0, 620.0, 690.0, 735.0, 1280.0, 485.0, 390.0, 1390.0, 415.0, 1150.0, 1070.0, 555.0, 1070.0, 780.0, 885.0, 850.0, 2590.0, 460.0, 1110.0, 1500.0, 1170.0, 625.0, 750.0, 240.0, 1220.0, 1010.0, 1110.0, 810.0, 350.0, 420.0, 405.0, 355.0, 610.0, 950.0, 1365.0, 1440.0, 1320.0, 1220.0, 1320.0, 1010.0, 695.0, 1065.0, 870.0, 1410.0, 580.0, 730.0, 1550.0, 1060.0, 700.0, 455.0, 640.0, 1815.0, 1250.0, 1075.0, 1045.0, 375.0, 600.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [260.0, 120.0, 100.0, 30.0, 30.0, 40.0, 360.0, 10.0, 100.0, 10.0, 20.0, -30.0, 90.0, 260.0, 20.0, 90.0, 120.0, 40.0, -30.0, -10.0, -30.0, 20.0, -15.0, 160.0, 130.0, 0.0, 20.0, 40.0, 160.0, 15.0, 20.0, 50.0, 60.0, 30.0, 10.0, 0.0, 20.0, 100.0, 40.0, 30.0, 70.0, 140.0, 60.0, -70.0, 140.0, 60.0, -55.0, 50.0, 160.0, 360.0, 230.0, 150.0, 140.0, 70.0, 280.0, 80.0, 150.0, 50.0, 0.0, 60.0, 160.0, 150.0, 85.0, 80.0, 30.0, 30.0, 0.0, 260.0, 30.0, 120.0, 80.0, 120.0, 90.0, 60.0, 70.0, 20.0, 30.0, 20.0, 30.0, 30.0, -80.0, 20.0, 40.0, 130.0, 90.0, 80.0, 340.0, 480.0, 150.0, -50.0, 190.0, 70.0, 120.0, 320.0, 100.0, 50.0, 300.0, 90.0, 110.0, 50.0, 30.0, 320.0, 30.0, 60.0, 70.0, 140.0, 280.0, 40.0, 50.0, 90.0, 375.0, 80.0, 110.0, 40.0, 90.0, 0.0, -40.0, 30.0, 10.0, 180.0, 20.0, 80.0, 120.0, 20.0, 30.0, 65.0, 0.0, 30.0, 40.0, 75.0, 40.0, 290.0, 150.0, 40.0, 90.0, 150.0, 30.0, 80.0, 80.0, 50.0, 170.0, 80.0, 60.0, 170.0, 140.0, 60.0, 40.0, 50.0, 140.0, 0.0, 60.0, 70.0, -30.0, 80.0, 300.0, 90.0, 90.0, 200.0, 130.0, 290.0, 20.0, 70.0, 60.0, 90.0, 50.0, 30.0, 170.0, 100.0, 200.0, 60.0, 70.0, 70.0, 40.0, 40.0, 110.0, 20.0, 40.0, 40.0, 260.0, 130.0, 65.0, 120.0, 460.0, 140.0, 40.0, 50.0, 60.0, 520.0, 70.0, 195.0, 0.0, 320.0, 35.0, 110.0, 210.0, 40.0, 30.0, 5.0, 125.0, 120.0, -70.0, 40.0, 100.0, 40.0, 140.0, 120.0, -45.0, 210.0, 80.0, 130.0, 50.0, 300.0, 210.0, 75.0, 110.0, 80.0, 235.0, 30.0, 70.0, 60.0, 0.0, 20.0, 50.0, 190.0, 320.0, 100.0, -20.0, 160.0, -60.0, 0.0, 180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0, 50.0, 25.0, 20.0, 150.0, 20.0, 110.0, 25.0, 90.0, 0.0, 0.0, 80.0, 340.0, 120.0, 80.0, 570.0, 500.0, 110.0, 90.0, 90.0, -10.0, 50.0, 50.0, 20.0, 110.0, 60.0, 70.0, 160.0, 10.0, 160.0, 0.0, 360.0, 60.0, 70.0, 180.0, 260.0, 160.0, 90.0, -10.0, 70.0, 50.0, 30.0, 40.0, 130.0, 70.0, 160.0, 30.0, 160.0, 30.0, 40.0, 220.0, 70.0, 20.0, 80.0, 160.0, 100.0, 40.0, 40.0, 40.0, 70.0, 110.0, 80.0, 10.0, 110.0, -70.0, 260.0, 340.0, 160.0, 130.0, 40.0, 110.0, 20.0, 10.0, 0.0, 0.0, 180.0, 80.0, 50.0, 40.0, 40.0, 20.0, 230.0, 120.0, 170.0, 60.0, 180.0, 90.0, 130.0, 160.0, 60.0, 60.0, 20.0, 230.0, 40.0, 30.0, 40.0, 0.0, 40.0, 20.0, 80.0, 0.0, 190.0, 40.0, 60.0, 105.0, 630.0, 80.0, 0.0, 50.0, 110.0, 170.0, 70.0, 180.0, 200.0, 40.0, 20.0, 130.0, 160.0, 140.0, 0.0, 55.0, 100.0, 50.0, 330.0, 210.0, 150.0, 170.0, 110.0, 20.0, 0.0, 20.0, 20.0, 210.0, 40.0, 90.0, 40.0, 170.0, 40.0, 310.0, 0.0, 30.0, 50.0, -45.0, 160.0, 160.0, 50.0, 40.0, 95.0, 230.0, 540.0, 80.0, 85.0, 120.0, 40.0, 140.0, 290.0, 80.0, 70.0, 30.0, 60.0, 70.0, 130.0, 360.0, 15.0, 170.0, 80.0, 80.0, -15.0, 20.0, 180.0, 30.0, 50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0, 20.0, 150.0, 30.0, 90.0, 40.0, -60.0, 80.0, 200.0, 200.0, 230.0, 90.0, 40.0, 40.0, 50.0, 160.0, 10.0, 170.0, 0.0, 40.0, 20.0, 50.0, 20.0, 10.0, 110.0, 70.0, 90.0, 30.0, 40.0, 250.0, 20.0, 310.0, 170.0, 90.0, -40.0, 0.0, 40.0, 45.0, 70.0, 30.0, 20.0, 110.0, 70.0, 340.0, 200.0, 90.0, 70.0, 70.0, 130.0, 100.0, 100.0, 480.0, 90.0, -370.0, 10.0, -30.0, 190.0, 0.0, 5.0, 50.0, 60.0, 20.0, 40.0, 5.0, 110.0, 60.0, 150.0, 10.0, 80.0, 0.0, -85.0, 60.0, 40.0, 520.0, 100.0, 20.0, 250.0, 230.0, 30.0, 40.0, 100.0, 90.0, -10.0, 10.0, 10.0, 40.0, 20.0, 40.0, -15.0, 120.0, 110.0, 60.0, 130.0, 110.0, 90.0, 90.0, 110.0, -10.0, 200.0, 260.0, 110.0, 190.0, 220.0, 280.0, 0.0, 150.0, 130.0, -30.0, 20.0, -10.0, 120.0, 20.0, 40.0, 70.0, 50.0, 15.0, 0.0, 180.0, 0.0, 20.0, 160.0, 350.0, 60.0, 80.0, 100.0, 50.0, 110.0, 120.0, 90.0, 10.0, 100.0, 250.0, 60.0, 5.0, 10.0, 130.0, 10.0, 250.0, 5.0, 0.0, 60.0, 190.0, -130.0, 30.0, 160.0, 220.0, 30.0, 30.0, 55.0, 180.0, 120.0, 100.0, -40.0, 60.0, -50.0, 430.0, 240.0, 90.0, -40.0, -20.0, 80.0, 1090.0, 250.0, 220.0, 320.0, 80.0, 390.0, 120.0, -20.0, 70.0, 70.0, -120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0, 100.0, 20.0, 20.0, 20.0, 30.0, 320.0, 60.0, 220.0, 240.0, 80.0, 150.0, 70.0, 120.0, 110.0, 80.0, 70.0, 90.0, 530.0, 180.0, 100.0, 110.0, 60.0, 520.0, 40.0, 100.0, 30.0, 40.0, 130.0, 60.0, 80.0, 130.0, 110.0, 40.0, 10.0, 50.0, 180.0, 10.0, 50.0, 30.0, 15.0, 30.0, 30.0, 190.0, 20.0, 50.0, 0.0, 90.0, 60.0, 0.0, 280.0, 20.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 40.0, 100.0, 210.0, 160.0, 120.0, 120.0, 210.0, 90.0, 120.0, 50.0, 60.0, 80.0, 150.0, 340.0, 80.0, 80.0, -30.0, 40.0, 170.0, 40.0, 70.0, 90.0, 170.0, 110.0, 110.0, 50.0, 100.0, 340.0, 50.0, 20.0, 20.0, 70.0, 80.0, 110.0, 90.0, 80.0, 170.0, 140.0, 45.0, 5.0, 160.0, 0.0, -40.0, 360.0, 60.0, -70.0, -190.0, -140.0, 360.0, -150.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 80.0, 30.0, 180.0, 40.0, 15.0, 10.0, 0.0, 40.0, 70.0, 70.0, 110.0, 20.0, 30.0, 110.0, -105.0, 60.0, 50.0, 50.0, 60.0, 180.0, -115.0, 30.0, 35.0, 20.0, 60.0, 60.0, 0.0, 230.0, 20.0, 80.0, 30.0, 100.0, 10.0, 120.0, 10.0, 220.0, 70.0, 30.0, 260.0, 100.0, 20.0, 50.0, 70.0, 60.0, 30.0, 300.0, 40.0, 260.0, 0.0, 70.0, 480.0, 20.0, 105.0, 60.0, 110.0, 250.0, 20.0, 130.0, 40.0, 510.0, 10.0, 260.0, 50.0, 80.0, 140.0, 140.0, 70.0, 200.0, 230.0, 90.0, 300.0, 60.0, 10.0, 80.0, 50.0, 70.0, 120.0, 330.0, -30.0, 130.0, 130.0, 210.0, 130.0, 190.0, 250.0, 10.0, 40.0, 90.0, 390.0, 20.0, 100.0, 180.0, 50.0, 30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 30.0, 160.0, 40.0, 20.0, 70.0, 80.0, 35.0, 10.0, 0.0, 250.0, 110.0, 410.0, 40.0, 50.0, 350.0, -70.0, 40.0, 55.0, -50.0, 130.0, 80.0, 15.0, 5.0, 80.0, 120.0, 40.0, 30.0, 180.0, 160.0, 160.0, 380.0, 80.0, 110.0, 40.0, 250.0, 80.0, 220.0, 110.0, 50.0, 90.0, -100.0, 50.0, -60.0, 40.0, 30.0, 200.0, 100.0, 40.0, 30.0, 250.0, 50.0, 270.0, 60.0, 0.0, 70.0, 0.0, -10.0, 20.0, 240.0, 30.0, 230.0, 290.0, 30.0, 230.0, 330.0, 250.0, 60.0, 70.0, 80.0, -20.0, -30.0, 50.0, 10.0, 250.0, 170.0, 160.0, 90.0, 240.0, 60.0, 60.0, 10.0, 10.0, 30.0, 260.0, 40.0, 160.0, 70.0, 40.0, 10.0, 70.0, 0.0, -20.0, 50.0, 160.0, 10.0, 5.0, 20.0, 170.0, 40.0, 20.0, 40.0, 50.0, 105.0, 185.0, 80.0, 40.0, 80.0, 30.0, 0.0, 30.0, 45.0, 120.0, 630.0, 310.0, 100.0, 20.0, 200.0, 280.0, 80.0, 30.0, 140.0, 380.0, 200.0, 90.0, 80.0, 90.0, 30.0, 40.0, 90.0, 110.0, 130.0, 40.0, 140.0, 260.0, 100.0, 130.0, -5.0, 70.0, 200.0, 10.0, 170.0, 30.0, -5.0, 200.0, 20.0, 20.0, 170.0, 210.0, 130.0, 100.0, -105.0, 50.0, -10.0, 10.0, -130.0, 200.0, 100.0, 20.0, 20.0, 220.0, 95.0, 40.0, 130.0, 30.0, 75.0, 130.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5408223630583762, "mean_inference_ms": 1.4116694092468736, "mean_action_processing_ms": 0.4438671139437141, "mean_env_wait_ms": 1.2510084845425151, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012055635452270508, "StateBufferConnector_ms": 0.009109258651733398, "ViewRequirementAgentConnector_ms": 0.3839714527130127}, "num_episodes": 18, "episode_return_max": 2590.0, "episode_return_min": 240.0, "episode_return_mean": 943.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.59720089874197, "num_env_steps_trained_throughput_per_sec": 21.59720089874197, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 186244.064, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186244.02, "sample_time_ms": 2544.369, "learn_time_ms": 183680.111, "learn_throughput": 21.777, "synch_weights_time_ms": 10.399}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "33e63_00000", "date": "2024-06-19_01-20-28", "timestamp": 1718774428, "time_this_iter_s": 185.21778988838196, "time_total_s": 15210.671086788177, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276cab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15210.671086788177, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 16.156870229007634, "ram_util_percent": 78.61030534351144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2473253381264984, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.300624488590878, "policy_loss": -0.009142286407079894, "vf_loss": 6.30830796422542, "vf_explained_var": 0.0015250025021509368, "kl": 0.006483623762857335, "entropy": 0.45154366226940235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 2590.0, "episode_reward_min": 195.0, "episode_reward_mean": 937.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 93.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1340.0, 490.0, 1970.0, 690.0, 1290.0, 910.0, 730.0, 1170.0, 440.0, 1260.0, 500.0, 1435.0, 995.0, 1160.0, 950.0, 1360.0, 985.0, 1050.0, 910.0, 980.0, 620.0, 690.0, 735.0, 1280.0, 485.0, 390.0, 1390.0, 415.0, 1150.0, 1070.0, 555.0, 1070.0, 780.0, 885.0, 850.0, 2590.0, 460.0, 1110.0, 1500.0, 1170.0, 625.0, 750.0, 240.0, 1220.0, 1010.0, 1110.0, 810.0, 350.0, 420.0, 405.0, 355.0, 610.0, 950.0, 1365.0, 1440.0, 1320.0, 1220.0, 1320.0, 1010.0, 695.0, 1065.0, 870.0, 1410.0, 580.0, 730.0, 1550.0, 1060.0, 700.0, 455.0, 640.0, 1815.0, 1250.0, 1075.0, 1045.0, 375.0, 600.0, 620.0, 915.0, 410.0, 810.0, 400.0, 2270.0, 1665.0, 760.0, 1400.0, 600.0, 475.0, 390.0, 1480.0, 1060.0, 195.0, 620.0, 1015.0, 945.0, 910.0, 870.0, 1310.0, 1585.0, 485.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [180.0, -190.0, 90.0, 130.0, 270.0, 200.0, 160.0, 290.0, 130.0, 80.0, 50.0, 25.0, 20.0, 150.0, 20.0, 110.0, 25.0, 90.0, 0.0, 0.0, 80.0, 340.0, 120.0, 80.0, 570.0, 500.0, 110.0, 90.0, 90.0, -10.0, 50.0, 50.0, 20.0, 110.0, 60.0, 70.0, 160.0, 10.0, 160.0, 0.0, 360.0, 60.0, 70.0, 180.0, 260.0, 160.0, 90.0, -10.0, 70.0, 50.0, 30.0, 40.0, 130.0, 70.0, 160.0, 30.0, 160.0, 30.0, 40.0, 220.0, 70.0, 20.0, 80.0, 160.0, 100.0, 40.0, 40.0, 40.0, 70.0, 110.0, 80.0, 10.0, 110.0, -70.0, 260.0, 340.0, 160.0, 130.0, 40.0, 110.0, 20.0, 10.0, 0.0, 0.0, 180.0, 80.0, 50.0, 40.0, 40.0, 20.0, 230.0, 120.0, 170.0, 60.0, 180.0, 90.0, 130.0, 160.0, 60.0, 60.0, 20.0, 230.0, 40.0, 30.0, 40.0, 0.0, 40.0, 20.0, 80.0, 0.0, 190.0, 40.0, 60.0, 105.0, 630.0, 80.0, 0.0, 50.0, 110.0, 170.0, 70.0, 180.0, 200.0, 40.0, 20.0, 130.0, 160.0, 140.0, 0.0, 55.0, 100.0, 50.0, 330.0, 210.0, 150.0, 170.0, 110.0, 20.0, 0.0, 20.0, 20.0, 210.0, 40.0, 90.0, 40.0, 170.0, 40.0, 310.0, 0.0, 30.0, 50.0, -45.0, 160.0, 160.0, 50.0, 40.0, 95.0, 230.0, 540.0, 80.0, 85.0, 120.0, 40.0, 140.0, 290.0, 80.0, 70.0, 30.0, 60.0, 70.0, 130.0, 360.0, 15.0, 170.0, 80.0, 80.0, -15.0, 20.0, 180.0, 30.0, 50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0, 20.0, 150.0, 30.0, 90.0, 40.0, -60.0, 80.0, 200.0, 200.0, 230.0, 90.0, 40.0, 40.0, 50.0, 160.0, 10.0, 170.0, 0.0, 40.0, 20.0, 50.0, 20.0, 10.0, 110.0, 70.0, 90.0, 30.0, 40.0, 250.0, 20.0, 310.0, 170.0, 90.0, -40.0, 0.0, 40.0, 45.0, 70.0, 30.0, 20.0, 110.0, 70.0, 340.0, 200.0, 90.0, 70.0, 70.0, 130.0, 100.0, 100.0, 480.0, 90.0, -370.0, 10.0, -30.0, 190.0, 0.0, 5.0, 50.0, 60.0, 20.0, 40.0, 5.0, 110.0, 60.0, 150.0, 10.0, 80.0, 0.0, -85.0, 60.0, 40.0, 520.0, 100.0, 20.0, 250.0, 230.0, 30.0, 40.0, 100.0, 90.0, -10.0, 10.0, 10.0, 40.0, 20.0, 40.0, -15.0, 120.0, 110.0, 60.0, 130.0, 110.0, 90.0, 90.0, 110.0, -10.0, 200.0, 260.0, 110.0, 190.0, 220.0, 280.0, 0.0, 150.0, 130.0, -30.0, 20.0, -10.0, 120.0, 20.0, 40.0, 70.0, 50.0, 15.0, 0.0, 180.0, 0.0, 20.0, 160.0, 350.0, 60.0, 80.0, 100.0, 50.0, 110.0, 120.0, 90.0, 10.0, 100.0, 250.0, 60.0, 5.0, 10.0, 130.0, 10.0, 250.0, 5.0, 0.0, 60.0, 190.0, -130.0, 30.0, 160.0, 220.0, 30.0, 30.0, 55.0, 180.0, 120.0, 100.0, -40.0, 60.0, -50.0, 430.0, 240.0, 90.0, -40.0, -20.0, 80.0, 1090.0, 250.0, 220.0, 320.0, 80.0, 390.0, 120.0, -20.0, 70.0, 70.0, -120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0, 100.0, 20.0, 20.0, 20.0, 30.0, 320.0, 60.0, 220.0, 240.0, 80.0, 150.0, 70.0, 120.0, 110.0, 80.0, 70.0, 90.0, 530.0, 180.0, 100.0, 110.0, 60.0, 520.0, 40.0, 100.0, 30.0, 40.0, 130.0, 60.0, 80.0, 130.0, 110.0, 40.0, 10.0, 50.0, 180.0, 10.0, 50.0, 30.0, 15.0, 30.0, 30.0, 190.0, 20.0, 50.0, 0.0, 90.0, 60.0, 0.0, 280.0, 20.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 40.0, 100.0, 210.0, 160.0, 120.0, 120.0, 210.0, 90.0, 120.0, 50.0, 60.0, 80.0, 150.0, 340.0, 80.0, 80.0, -30.0, 40.0, 170.0, 40.0, 70.0, 90.0, 170.0, 110.0, 110.0, 50.0, 100.0, 340.0, 50.0, 20.0, 20.0, 70.0, 80.0, 110.0, 90.0, 80.0, 170.0, 140.0, 45.0, 5.0, 160.0, 0.0, -40.0, 360.0, 60.0, -70.0, -190.0, -140.0, 360.0, -150.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 80.0, 30.0, 180.0, 40.0, 15.0, 10.0, 0.0, 40.0, 70.0, 70.0, 110.0, 20.0, 30.0, 110.0, -105.0, 60.0, 50.0, 50.0, 60.0, 180.0, -115.0, 30.0, 35.0, 20.0, 60.0, 60.0, 0.0, 230.0, 20.0, 80.0, 30.0, 100.0, 10.0, 120.0, 10.0, 220.0, 70.0, 30.0, 260.0, 100.0, 20.0, 50.0, 70.0, 60.0, 30.0, 300.0, 40.0, 260.0, 0.0, 70.0, 480.0, 20.0, 105.0, 60.0, 110.0, 250.0, 20.0, 130.0, 40.0, 510.0, 10.0, 260.0, 50.0, 80.0, 140.0, 140.0, 70.0, 200.0, 230.0, 90.0, 300.0, 60.0, 10.0, 80.0, 50.0, 70.0, 120.0, 330.0, -30.0, 130.0, 130.0, 210.0, 130.0, 190.0, 250.0, 10.0, 40.0, 90.0, 390.0, 20.0, 100.0, 180.0, 50.0, 30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 30.0, 160.0, 40.0, 20.0, 70.0, 80.0, 35.0, 10.0, 0.0, 250.0, 110.0, 410.0, 40.0, 50.0, 350.0, -70.0, 40.0, 55.0, -50.0, 130.0, 80.0, 15.0, 5.0, 80.0, 120.0, 40.0, 30.0, 180.0, 160.0, 160.0, 380.0, 80.0, 110.0, 40.0, 250.0, 80.0, 220.0, 110.0, 50.0, 90.0, -100.0, 50.0, -60.0, 40.0, 30.0, 200.0, 100.0, 40.0, 30.0, 250.0, 50.0, 270.0, 60.0, 0.0, 70.0, 0.0, -10.0, 20.0, 240.0, 30.0, 230.0, 290.0, 30.0, 230.0, 330.0, 250.0, 60.0, 70.0, 80.0, -20.0, -30.0, 50.0, 10.0, 250.0, 170.0, 160.0, 90.0, 240.0, 60.0, 60.0, 10.0, 10.0, 30.0, 260.0, 40.0, 160.0, 70.0, 40.0, 10.0, 70.0, 0.0, -20.0, 50.0, 160.0, 10.0, 5.0, 20.0, 170.0, 40.0, 20.0, 40.0, 50.0, 105.0, 185.0, 80.0, 40.0, 80.0, 30.0, 0.0, 30.0, 45.0, 120.0, 630.0, 310.0, 100.0, 20.0, 200.0, 280.0, 80.0, 30.0, 140.0, 380.0, 200.0, 90.0, 80.0, 90.0, 30.0, 40.0, 90.0, 110.0, 130.0, 40.0, 140.0, 260.0, 100.0, 130.0, -5.0, 70.0, 200.0, 10.0, 170.0, 30.0, -5.0, 200.0, 20.0, 20.0, 170.0, 210.0, 130.0, 100.0, -105.0, 50.0, -10.0, 10.0, -130.0, 200.0, 100.0, 20.0, 20.0, 220.0, 95.0, 40.0, 130.0, 30.0, 75.0, 130.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0, 30.0, 110.0, -40.0, 5.0, 30.0, 110.0, 400.0, 200.0, 60.0, 10.0, 70.0, 60.0, 30.0, 140.0, -50.0, 10.0, 70.0, 0.0, 70.0, 10.0, 90.0, 170.0, 40.0, 100.0, 150.0, 20.0, 10.0, 60.0, 80.0, 90.0, 90.0, 130.0, 40.0, 10.0, 10.0, -10.0, 0.0, 120.0, 0.0, 10.0, 130.0, 80.0, 1060.0, 50.0, -30.0, 150.0, 170.0, 230.0, 120.0, 310.0, 190.0, 130.0, 290.0, 110.0, 690.0, 40.0, 0.0, 50.0, 85.0, 80.0, 60.0, 70.0, 30.0, 30.0, 90.0, 300.0, 20.0, 20.0, 60.0, 80.0, 180.0, 430.0, 100.0, 60.0, 30.0, 180.0, 220.0, 140.0, 50.0, 10.0, 20.0, 20.0, 50.0, 130.0, 70.0, 70.0, 40.0, 10.0, 190.0, 0.0, 60.0, -15.0, 40.0, 30.0, 190.0, 0.0, 40.0, 0.0, 20.0, 110.0, 30.0, 20.0, 40.0, 40.0, 40.0, 110.0, 60.0, 0.0, 30.0, 20.0, 150.0, 60.0, 40.0, 260.0, 500.0, 30.0, 240.0, 40.0, 20.0, 140.0, 20.0, 110.0, 70.0, 70.0, 90.0, 80.0, 70.0, 370.0, 10.0, 170.0, 10.0, -15.0, 80.0, 60.0, 0.0, 0.0, 20.0, 70.0, 0.0, -30.0, 140.0, 100.0, 120.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 170.0, 90.0, 300.0, 240.0, 25.0, 110.0, 10.0, 90.0, 100.0, 40.0, 10.0, 60.0, 50.0, -40.0, 0.0, 170.0, 105.0, 110.0, 60.0, 240.0, 190.0, 60.0, 1000.0, 30.0, -20.0, -20.0, -40.0, 0.0, -180.0, 10.0, 70.0, 90.0, 20.0, 170.0, 60.0, 350.0, 120.0, -40.0, 40.0, 30.0, 30.0, 70.0, 410.0, 50.0, -20.0, 260.0, 330.0, 70.0, 70.0, 40.0, 30.0, 35.0, 350.0, 410.0, 260.0, 160.0, 40.0, 200.0, -50.0, -30.0, 210.0, 300.0, 10.0, -5.0, 30.0, -10.0, 0.0, 100.0, 40.0, 10.0, 10.0, 170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5402166031411537, "mean_inference_ms": 1.4116707291610033, "mean_action_processing_ms": 0.4430330884336569, "mean_env_wait_ms": 1.250528276554598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012283802032470703, "StateBufferConnector_ms": 0.00917363166809082, "ViewRequirementAgentConnector_ms": 0.3719508647918701}, "num_episodes": 23, "episode_return_max": 2590.0, "episode_return_min": 195.0, "episode_return_mean": 937.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.68631742252394, "num_env_steps_trained_throughput_per_sec": 21.68631742252394, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 186222.405, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186222.362, "sample_time_ms": 2520.473, "learn_time_ms": 183682.419, "learn_throughput": 21.777, "synch_weights_time_ms": 10.503}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "33e63_00000", "date": "2024-06-19_01-23-33", "timestamp": 1718774613, "time_this_iter_s": 184.45682287216187, "time_total_s": 15395.12790966034, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32771d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15395.12790966034, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 16.614615384615387, "ram_util_percent": 78.97653846153847}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3307791716438007, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.60553300941841, "policy_loss": -0.008894885119464332, "vf_loss": 7.613086618782994, "vf_explained_var": 0.0007603513673979381, "kl": 0.005961194624533852, "entropy": 0.4324359654142453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 2590.0, "episode_reward_min": 195.0, "episode_reward_mean": 930.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 93.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 980.0, 620.0, 690.0, 735.0, 1280.0, 485.0, 390.0, 1390.0, 415.0, 1150.0, 1070.0, 555.0, 1070.0, 780.0, 885.0, 850.0, 2590.0, 460.0, 1110.0, 1500.0, 1170.0, 625.0, 750.0, 240.0, 1220.0, 1010.0, 1110.0, 810.0, 350.0, 420.0, 405.0, 355.0, 610.0, 950.0, 1365.0, 1440.0, 1320.0, 1220.0, 1320.0, 1010.0, 695.0, 1065.0, 870.0, 1410.0, 580.0, 730.0, 1550.0, 1060.0, 700.0, 455.0, 640.0, 1815.0, 1250.0, 1075.0, 1045.0, 375.0, 600.0, 620.0, 915.0, 410.0, 810.0, 400.0, 2270.0, 1665.0, 760.0, 1400.0, 600.0, 475.0, 390.0, 1480.0, 1060.0, 195.0, 620.0, 1015.0, 945.0, 910.0, 870.0, 1310.0, 1585.0, 485.0, 350.0, 815.0, 1575.0, 1090.0, 1275.0, 540.0, 210.0, 980.0, 800.0, 745.0, 870.0, 1080.0, 1100.0, 1030.0, 1155.0, 900.0, 1255.0, 1445.0, 1140.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 160.0, 110.0, 10.0, 130.0, 10.0, 50.0, 100.0, 270.0, 20.0, 150.0, 30.0, 90.0, 40.0, -60.0, 80.0, 200.0, 200.0, 230.0, 90.0, 40.0, 40.0, 50.0, 160.0, 10.0, 170.0, 0.0, 40.0, 20.0, 50.0, 20.0, 10.0, 110.0, 70.0, 90.0, 30.0, 40.0, 250.0, 20.0, 310.0, 170.0, 90.0, -40.0, 0.0, 40.0, 45.0, 70.0, 30.0, 20.0, 110.0, 70.0, 340.0, 200.0, 90.0, 70.0, 70.0, 130.0, 100.0, 100.0, 480.0, 90.0, -370.0, 10.0, -30.0, 190.0, 0.0, 5.0, 50.0, 60.0, 20.0, 40.0, 5.0, 110.0, 60.0, 150.0, 10.0, 80.0, 0.0, -85.0, 60.0, 40.0, 520.0, 100.0, 20.0, 250.0, 230.0, 30.0, 40.0, 100.0, 90.0, -10.0, 10.0, 10.0, 40.0, 20.0, 40.0, -15.0, 120.0, 110.0, 60.0, 130.0, 110.0, 90.0, 90.0, 110.0, -10.0, 200.0, 260.0, 110.0, 190.0, 220.0, 280.0, 0.0, 150.0, 130.0, -30.0, 20.0, -10.0, 120.0, 20.0, 40.0, 70.0, 50.0, 15.0, 0.0, 180.0, 0.0, 20.0, 160.0, 350.0, 60.0, 80.0, 100.0, 50.0, 110.0, 120.0, 90.0, 10.0, 100.0, 250.0, 60.0, 5.0, 10.0, 130.0, 10.0, 250.0, 5.0, 0.0, 60.0, 190.0, -130.0, 30.0, 160.0, 220.0, 30.0, 30.0, 55.0, 180.0, 120.0, 100.0, -40.0, 60.0, -50.0, 430.0, 240.0, 90.0, -40.0, -20.0, 80.0, 1090.0, 250.0, 220.0, 320.0, 80.0, 390.0, 120.0, -20.0, 70.0, 70.0, -120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0, 100.0, 20.0, 20.0, 20.0, 30.0, 320.0, 60.0, 220.0, 240.0, 80.0, 150.0, 70.0, 120.0, 110.0, 80.0, 70.0, 90.0, 530.0, 180.0, 100.0, 110.0, 60.0, 520.0, 40.0, 100.0, 30.0, 40.0, 130.0, 60.0, 80.0, 130.0, 110.0, 40.0, 10.0, 50.0, 180.0, 10.0, 50.0, 30.0, 15.0, 30.0, 30.0, 190.0, 20.0, 50.0, 0.0, 90.0, 60.0, 0.0, 280.0, 20.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 40.0, 100.0, 210.0, 160.0, 120.0, 120.0, 210.0, 90.0, 120.0, 50.0, 60.0, 80.0, 150.0, 340.0, 80.0, 80.0, -30.0, 40.0, 170.0, 40.0, 70.0, 90.0, 170.0, 110.0, 110.0, 50.0, 100.0, 340.0, 50.0, 20.0, 20.0, 70.0, 80.0, 110.0, 90.0, 80.0, 170.0, 140.0, 45.0, 5.0, 160.0, 0.0, -40.0, 360.0, 60.0, -70.0, -190.0, -140.0, 360.0, -150.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 80.0, 30.0, 180.0, 40.0, 15.0, 10.0, 0.0, 40.0, 70.0, 70.0, 110.0, 20.0, 30.0, 110.0, -105.0, 60.0, 50.0, 50.0, 60.0, 180.0, -115.0, 30.0, 35.0, 20.0, 60.0, 60.0, 0.0, 230.0, 20.0, 80.0, 30.0, 100.0, 10.0, 120.0, 10.0, 220.0, 70.0, 30.0, 260.0, 100.0, 20.0, 50.0, 70.0, 60.0, 30.0, 300.0, 40.0, 260.0, 0.0, 70.0, 480.0, 20.0, 105.0, 60.0, 110.0, 250.0, 20.0, 130.0, 40.0, 510.0, 10.0, 260.0, 50.0, 80.0, 140.0, 140.0, 70.0, 200.0, 230.0, 90.0, 300.0, 60.0, 10.0, 80.0, 50.0, 70.0, 120.0, 330.0, -30.0, 130.0, 130.0, 210.0, 130.0, 190.0, 250.0, 10.0, 40.0, 90.0, 390.0, 20.0, 100.0, 180.0, 50.0, 30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 30.0, 160.0, 40.0, 20.0, 70.0, 80.0, 35.0, 10.0, 0.0, 250.0, 110.0, 410.0, 40.0, 50.0, 350.0, -70.0, 40.0, 55.0, -50.0, 130.0, 80.0, 15.0, 5.0, 80.0, 120.0, 40.0, 30.0, 180.0, 160.0, 160.0, 380.0, 80.0, 110.0, 40.0, 250.0, 80.0, 220.0, 110.0, 50.0, 90.0, -100.0, 50.0, -60.0, 40.0, 30.0, 200.0, 100.0, 40.0, 30.0, 250.0, 50.0, 270.0, 60.0, 0.0, 70.0, 0.0, -10.0, 20.0, 240.0, 30.0, 230.0, 290.0, 30.0, 230.0, 330.0, 250.0, 60.0, 70.0, 80.0, -20.0, -30.0, 50.0, 10.0, 250.0, 170.0, 160.0, 90.0, 240.0, 60.0, 60.0, 10.0, 10.0, 30.0, 260.0, 40.0, 160.0, 70.0, 40.0, 10.0, 70.0, 0.0, -20.0, 50.0, 160.0, 10.0, 5.0, 20.0, 170.0, 40.0, 20.0, 40.0, 50.0, 105.0, 185.0, 80.0, 40.0, 80.0, 30.0, 0.0, 30.0, 45.0, 120.0, 630.0, 310.0, 100.0, 20.0, 200.0, 280.0, 80.0, 30.0, 140.0, 380.0, 200.0, 90.0, 80.0, 90.0, 30.0, 40.0, 90.0, 110.0, 130.0, 40.0, 140.0, 260.0, 100.0, 130.0, -5.0, 70.0, 200.0, 10.0, 170.0, 30.0, -5.0, 200.0, 20.0, 20.0, 170.0, 210.0, 130.0, 100.0, -105.0, 50.0, -10.0, 10.0, -130.0, 200.0, 100.0, 20.0, 20.0, 220.0, 95.0, 40.0, 130.0, 30.0, 75.0, 130.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0, 30.0, 110.0, -40.0, 5.0, 30.0, 110.0, 400.0, 200.0, 60.0, 10.0, 70.0, 60.0, 30.0, 140.0, -50.0, 10.0, 70.0, 0.0, 70.0, 10.0, 90.0, 170.0, 40.0, 100.0, 150.0, 20.0, 10.0, 60.0, 80.0, 90.0, 90.0, 130.0, 40.0, 10.0, 10.0, -10.0, 0.0, 120.0, 0.0, 10.0, 130.0, 80.0, 1060.0, 50.0, -30.0, 150.0, 170.0, 230.0, 120.0, 310.0, 190.0, 130.0, 290.0, 110.0, 690.0, 40.0, 0.0, 50.0, 85.0, 80.0, 60.0, 70.0, 30.0, 30.0, 90.0, 300.0, 20.0, 20.0, 60.0, 80.0, 180.0, 430.0, 100.0, 60.0, 30.0, 180.0, 220.0, 140.0, 50.0, 10.0, 20.0, 20.0, 50.0, 130.0, 70.0, 70.0, 40.0, 10.0, 190.0, 0.0, 60.0, -15.0, 40.0, 30.0, 190.0, 0.0, 40.0, 0.0, 20.0, 110.0, 30.0, 20.0, 40.0, 40.0, 40.0, 110.0, 60.0, 0.0, 30.0, 20.0, 150.0, 60.0, 40.0, 260.0, 500.0, 30.0, 240.0, 40.0, 20.0, 140.0, 20.0, 110.0, 70.0, 70.0, 90.0, 80.0, 70.0, 370.0, 10.0, 170.0, 10.0, -15.0, 80.0, 60.0, 0.0, 0.0, 20.0, 70.0, 0.0, -30.0, 140.0, 100.0, 120.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 170.0, 90.0, 300.0, 240.0, 25.0, 110.0, 10.0, 90.0, 100.0, 40.0, 10.0, 60.0, 50.0, -40.0, 0.0, 170.0, 105.0, 110.0, 60.0, 240.0, 190.0, 60.0, 1000.0, 30.0, -20.0, -20.0, -40.0, 0.0, -180.0, 10.0, 70.0, 90.0, 20.0, 170.0, 60.0, 350.0, 120.0, -40.0, 40.0, 30.0, 30.0, 70.0, 410.0, 50.0, -20.0, 260.0, 330.0, 70.0, 70.0, 40.0, 30.0, 35.0, 350.0, 410.0, 260.0, 160.0, 40.0, 200.0, -50.0, -30.0, 210.0, 300.0, 10.0, -5.0, 30.0, -10.0, 0.0, 100.0, 40.0, 10.0, 10.0, 170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 250.0, 130.0, 10.0, 40.0, 120.0, -5.0, 170.0, 60.0, 30.0, 370.0, 80.0, 60.0, 230.0, 130.0, 60.0, 105.0, 220.0, 230.0, 90.0, 50.0, 60.0, 70.0, 150.0, 20.0, 180.0, 190.0, 50.0, 90.0, 230.0, 290.0, 85.0, 30.0, 80.0, 230.0, 190.0, 70.0, 70.0, 160.0, 70.0, 150.0, 50.0, 80.0, 60.0, 0.0, 60.0, -50.0, 80.0, 90.0, 20.0, 40.0, 40.0, 10.0, 15.0, 0.0, 70.0, 0.0, 5.0, 0.0, 30.0, 20.0, 55.0, 170.0, 30.0, 65.0, 60.0, 60.0, 110.0, 390.0, 20.0, 60.0, 160.0, 140.0, -30.0, 80.0, 50.0, 90.0, 40.0, 80.0, 130.0, 20.0, 170.0, 30.0, 20.0, 70.0, 100.0, 100.0, 30.0, 65.0, 140.0, 160.0, 0.0, 30.0, 30.0, 0.0, 140.0, 300.0, 50.0, 30.0, 130.0, 300.0, 150.0, 200.0, -40.0, 270.0, 50.0, 70.0, -5.0, 10.0, 75.0, 40.0, 20.0, 300.0, 30.0, 390.0, 10.0, 50.0, 100.0, 60.0, 100.0, 40.0, 60.0, 60.0, 90.0, 110.0, 260.0, 110.0, 50.0, 60.0, 190.0, -10.0, 20.0, 80.0, 120.0, 80.0, 185.0, 190.0, 80.0, 30.0, 380.0, 270.0, 40.0, 40.0, 80.0, 110.0, 70.0, 10.0, 110.0, 20.0, 150.0, 50.0, 130.0, 370.0, 10.0, 60.0, 65.0, 330.0, 40.0, 70.0, 130.0, 260.0, 170.0, 105.0, 390.0, 110.0, 90.0, 90.0, 90.0, 40.0, 100.0, 50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5395782497272237, "mean_inference_ms": 1.4116099339447274, "mean_action_processing_ms": 0.4423486577707447, "mean_env_wait_ms": 1.2501006646872035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012294530868530273, "StateBufferConnector_ms": 0.009238481521606445, "ViewRequirementAgentConnector_ms": 0.36530303955078125}, "num_episodes": 18, "episode_return_max": 2590.0, "episode_return_min": 195.0, "episode_return_mean": 930.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.400101627553525, "num_env_steps_trained_throughput_per_sec": 21.400101627553525, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 186257.708, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186257.646, "sample_time_ms": 2520.975, "learn_time_ms": 183716.965, "learn_throughput": 21.773, "synch_weights_time_ms": 10.75}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "33e63_00000", "date": "2024-06-19_01-26-40", "timestamp": 1718774800, "time_this_iter_s": 186.9431128501892, "time_total_s": 15582.071022510529, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15582.071022510529, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 18.78301886792453, "ram_util_percent": 79.3211320754717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.631162938593041, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.033677550855155, "policy_loss": -0.00828079678404866, "vf_loss": 7.040484599996045, "vf_explained_var": 0.0011473307149986616, "kl": 0.00654999986134906, "entropy": 0.4351019148152476, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 195.0, "episode_reward_mean": 951.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -190.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 95.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 1110.0, 1500.0, 1170.0, 625.0, 750.0, 240.0, 1220.0, 1010.0, 1110.0, 810.0, 350.0, 420.0, 405.0, 355.0, 610.0, 950.0, 1365.0, 1440.0, 1320.0, 1220.0, 1320.0, 1010.0, 695.0, 1065.0, 870.0, 1410.0, 580.0, 730.0, 1550.0, 1060.0, 700.0, 455.0, 640.0, 1815.0, 1250.0, 1075.0, 1045.0, 375.0, 600.0, 620.0, 915.0, 410.0, 810.0, 400.0, 2270.0, 1665.0, 760.0, 1400.0, 600.0, 475.0, 390.0, 1480.0, 1060.0, 195.0, 620.0, 1015.0, 945.0, 910.0, 870.0, 1310.0, 1585.0, 485.0, 350.0, 815.0, 1575.0, 1090.0, 1275.0, 540.0, 210.0, 980.0, 800.0, 745.0, 870.0, 1080.0, 1100.0, 1030.0, 1155.0, 900.0, 1255.0, 1445.0, 1140.0, 1585.0, 1540.0, 1330.0, 1670.0, 1420.0, 1020.0, 925.0, 1185.0, 745.0, 780.0, 710.0, 1220.0, 850.0, 1200.0, 600.0, 450.0, 475.0, 1250.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-120.0, 160.0, 30.0, 150.0, 40.0, 60.0, 110.0, 10.0, 20.0, 0.0, 100.0, 20.0, 20.0, 20.0, 30.0, 320.0, 60.0, 220.0, 240.0, 80.0, 150.0, 70.0, 120.0, 110.0, 80.0, 70.0, 90.0, 530.0, 180.0, 100.0, 110.0, 60.0, 520.0, 40.0, 100.0, 30.0, 40.0, 130.0, 60.0, 80.0, 130.0, 110.0, 40.0, 10.0, 50.0, 180.0, 10.0, 50.0, 30.0, 15.0, 30.0, 30.0, 190.0, 20.0, 50.0, 0.0, 90.0, 60.0, 0.0, 280.0, 20.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 40.0, 100.0, 210.0, 160.0, 120.0, 120.0, 210.0, 90.0, 120.0, 50.0, 60.0, 80.0, 150.0, 340.0, 80.0, 80.0, -30.0, 40.0, 170.0, 40.0, 70.0, 90.0, 170.0, 110.0, 110.0, 50.0, 100.0, 340.0, 50.0, 20.0, 20.0, 70.0, 80.0, 110.0, 90.0, 80.0, 170.0, 140.0, 45.0, 5.0, 160.0, 0.0, -40.0, 360.0, 60.0, -70.0, -190.0, -140.0, 360.0, -150.0, 30.0, 20.0, 40.0, 20.0, 0.0, 20.0, 0.0, 80.0, 30.0, 180.0, 40.0, 15.0, 10.0, 0.0, 40.0, 70.0, 70.0, 110.0, 20.0, 30.0, 110.0, -105.0, 60.0, 50.0, 50.0, 60.0, 180.0, -115.0, 30.0, 35.0, 20.0, 60.0, 60.0, 0.0, 230.0, 20.0, 80.0, 30.0, 100.0, 10.0, 120.0, 10.0, 220.0, 70.0, 30.0, 260.0, 100.0, 20.0, 50.0, 70.0, 60.0, 30.0, 300.0, 40.0, 260.0, 0.0, 70.0, 480.0, 20.0, 105.0, 60.0, 110.0, 250.0, 20.0, 130.0, 40.0, 510.0, 10.0, 260.0, 50.0, 80.0, 140.0, 140.0, 70.0, 200.0, 230.0, 90.0, 300.0, 60.0, 10.0, 80.0, 50.0, 70.0, 120.0, 330.0, -30.0, 130.0, 130.0, 210.0, 130.0, 190.0, 250.0, 10.0, 40.0, 90.0, 390.0, 20.0, 100.0, 180.0, 50.0, 30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 30.0, 160.0, 40.0, 20.0, 70.0, 80.0, 35.0, 10.0, 0.0, 250.0, 110.0, 410.0, 40.0, 50.0, 350.0, -70.0, 40.0, 55.0, -50.0, 130.0, 80.0, 15.0, 5.0, 80.0, 120.0, 40.0, 30.0, 180.0, 160.0, 160.0, 380.0, 80.0, 110.0, 40.0, 250.0, 80.0, 220.0, 110.0, 50.0, 90.0, -100.0, 50.0, -60.0, 40.0, 30.0, 200.0, 100.0, 40.0, 30.0, 250.0, 50.0, 270.0, 60.0, 0.0, 70.0, 0.0, -10.0, 20.0, 240.0, 30.0, 230.0, 290.0, 30.0, 230.0, 330.0, 250.0, 60.0, 70.0, 80.0, -20.0, -30.0, 50.0, 10.0, 250.0, 170.0, 160.0, 90.0, 240.0, 60.0, 60.0, 10.0, 10.0, 30.0, 260.0, 40.0, 160.0, 70.0, 40.0, 10.0, 70.0, 0.0, -20.0, 50.0, 160.0, 10.0, 5.0, 20.0, 170.0, 40.0, 20.0, 40.0, 50.0, 105.0, 185.0, 80.0, 40.0, 80.0, 30.0, 0.0, 30.0, 45.0, 120.0, 630.0, 310.0, 100.0, 20.0, 200.0, 280.0, 80.0, 30.0, 140.0, 380.0, 200.0, 90.0, 80.0, 90.0, 30.0, 40.0, 90.0, 110.0, 130.0, 40.0, 140.0, 260.0, 100.0, 130.0, -5.0, 70.0, 200.0, 10.0, 170.0, 30.0, -5.0, 200.0, 20.0, 20.0, 170.0, 210.0, 130.0, 100.0, -105.0, 50.0, -10.0, 10.0, -130.0, 200.0, 100.0, 20.0, 20.0, 220.0, 95.0, 40.0, 130.0, 30.0, 75.0, 130.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0, 30.0, 110.0, -40.0, 5.0, 30.0, 110.0, 400.0, 200.0, 60.0, 10.0, 70.0, 60.0, 30.0, 140.0, -50.0, 10.0, 70.0, 0.0, 70.0, 10.0, 90.0, 170.0, 40.0, 100.0, 150.0, 20.0, 10.0, 60.0, 80.0, 90.0, 90.0, 130.0, 40.0, 10.0, 10.0, -10.0, 0.0, 120.0, 0.0, 10.0, 130.0, 80.0, 1060.0, 50.0, -30.0, 150.0, 170.0, 230.0, 120.0, 310.0, 190.0, 130.0, 290.0, 110.0, 690.0, 40.0, 0.0, 50.0, 85.0, 80.0, 60.0, 70.0, 30.0, 30.0, 90.0, 300.0, 20.0, 20.0, 60.0, 80.0, 180.0, 430.0, 100.0, 60.0, 30.0, 180.0, 220.0, 140.0, 50.0, 10.0, 20.0, 20.0, 50.0, 130.0, 70.0, 70.0, 40.0, 10.0, 190.0, 0.0, 60.0, -15.0, 40.0, 30.0, 190.0, 0.0, 40.0, 0.0, 20.0, 110.0, 30.0, 20.0, 40.0, 40.0, 40.0, 110.0, 60.0, 0.0, 30.0, 20.0, 150.0, 60.0, 40.0, 260.0, 500.0, 30.0, 240.0, 40.0, 20.0, 140.0, 20.0, 110.0, 70.0, 70.0, 90.0, 80.0, 70.0, 370.0, 10.0, 170.0, 10.0, -15.0, 80.0, 60.0, 0.0, 0.0, 20.0, 70.0, 0.0, -30.0, 140.0, 100.0, 120.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 170.0, 90.0, 300.0, 240.0, 25.0, 110.0, 10.0, 90.0, 100.0, 40.0, 10.0, 60.0, 50.0, -40.0, 0.0, 170.0, 105.0, 110.0, 60.0, 240.0, 190.0, 60.0, 1000.0, 30.0, -20.0, -20.0, -40.0, 0.0, -180.0, 10.0, 70.0, 90.0, 20.0, 170.0, 60.0, 350.0, 120.0, -40.0, 40.0, 30.0, 30.0, 70.0, 410.0, 50.0, -20.0, 260.0, 330.0, 70.0, 70.0, 40.0, 30.0, 35.0, 350.0, 410.0, 260.0, 160.0, 40.0, 200.0, -50.0, -30.0, 210.0, 300.0, 10.0, -5.0, 30.0, -10.0, 0.0, 100.0, 40.0, 10.0, 10.0, 170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 250.0, 130.0, 10.0, 40.0, 120.0, -5.0, 170.0, 60.0, 30.0, 370.0, 80.0, 60.0, 230.0, 130.0, 60.0, 105.0, 220.0, 230.0, 90.0, 50.0, 60.0, 70.0, 150.0, 20.0, 180.0, 190.0, 50.0, 90.0, 230.0, 290.0, 85.0, 30.0, 80.0, 230.0, 190.0, 70.0, 70.0, 160.0, 70.0, 150.0, 50.0, 80.0, 60.0, 0.0, 60.0, -50.0, 80.0, 90.0, 20.0, 40.0, 40.0, 10.0, 15.0, 0.0, 70.0, 0.0, 5.0, 0.0, 30.0, 20.0, 55.0, 170.0, 30.0, 65.0, 60.0, 60.0, 110.0, 390.0, 20.0, 60.0, 160.0, 140.0, -30.0, 80.0, 50.0, 90.0, 40.0, 80.0, 130.0, 20.0, 170.0, 30.0, 20.0, 70.0, 100.0, 100.0, 30.0, 65.0, 140.0, 160.0, 0.0, 30.0, 30.0, 0.0, 140.0, 300.0, 50.0, 30.0, 130.0, 300.0, 150.0, 200.0, -40.0, 270.0, 50.0, 70.0, -5.0, 10.0, 75.0, 40.0, 20.0, 300.0, 30.0, 390.0, 10.0, 50.0, 100.0, 60.0, 100.0, 40.0, 60.0, 60.0, 90.0, 110.0, 260.0, 110.0, 50.0, 60.0, 190.0, -10.0, 20.0, 80.0, 120.0, 80.0, 185.0, 190.0, 80.0, 30.0, 380.0, 270.0, 40.0, 40.0, 80.0, 110.0, 70.0, 10.0, 110.0, 20.0, 150.0, 50.0, 130.0, 370.0, 10.0, 60.0, 65.0, 330.0, 40.0, 70.0, 130.0, 260.0, 170.0, 105.0, 390.0, 110.0, 90.0, 90.0, 90.0, 40.0, 100.0, 50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0, 60.0, 520.0, 10.0, 200.0, 65.0, 220.0, 120.0, 130.0, 40.0, 220.0, 110.0, 320.0, 130.0, 170.0, 160.0, 100.0, 110.0, 260.0, 130.0, 50.0, 160.0, 180.0, 80.0, 90.0, 140.0, 130.0, 80.0, 330.0, 80.0, 60.0, 110.0, 560.0, 60.0, 10.0, 40.0, 40.0, 30.0, 10.0, 380.0, 430.0, 190.0, 150.0, 190.0, 20.0, 130.0, 40.0, 160.0, 330.0, 70.0, 140.0, -5.0, 125.0, 200.0, 360.0, 70.0, 0.0, 50.0, 30.0, 80.0, 110.0, 100.0, 10.0, 95.0, 230.0, 30.0, 70.0, 50.0, 30.0, 100.0, 210.0, 210.0, 220.0, 265.0, -20.0, 110.0, 160.0, 180.0, 30.0, 25.0, 5.0, 80.0, 270.0, 190.0, 30.0, 40.0, 30.0, 0.0, 25.0, 40.0, 40.0, 110.0, 40.0, 80.0, 0.0, 120.0, 70.0, 30.0, 300.0, 20.0, 10.0, 365.0, 30.0, 70.0, -5.0, 30.0, 30.0, 40.0, 30.0, 40.0, 80.0, 200.0, 200.0, -70.0, 80.0, 180.0, 50.0, 270.0, 20.0, 230.0, 60.0, 60.0, 130.0, 80.0, 60.0, 10.0, 100.0, 50.0, 150.0, 110.0, 100.0, 40.0, 50.0, 170.0, 10.0, 290.0, 30.0, 10.0, 60.0, 20.0, 520.0, 130.0, 0.0, 30.0, 190.0, 30.0, 0.0, 40.0, 110.0, 50.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, 10.0, 140.0, 20.0, 20.0, 120.0, 170.0, 30.0, 15.0, 50.0, 60.0, 20.0, -30.0, -50.0, 140.0, 70.0, 40.0, 60.0, 130.0, 80.0, 90.0, 210.0, 90.0, 50.0, 210.0, 290.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5391940693496622, "mean_inference_ms": 1.4115397057384909, "mean_action_processing_ms": 0.44168867248477606, "mean_env_wait_ms": 1.2497131982005483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012341499328613281, "StateBufferConnector_ms": 0.00927114486694336, "ViewRequirementAgentConnector_ms": 0.3657646179199219}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 195.0, "episode_return_mean": 951.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.139671500412447, "num_env_steps_trained_throughput_per_sec": 21.139671500412447, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 186536.119, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186536.056, "sample_time_ms": 2529.579, "learn_time_ms": 183985.656, "learn_throughput": 21.741, "synch_weights_time_ms": 11.053}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "33e63_00000", "date": "2024-06-19_01-29-49", "timestamp": 1718774989, "time_this_iter_s": 189.2258276939392, "time_total_s": 15771.296850204468, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276f5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15771.296850204468, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.520224719101122, "ram_util_percent": 80.00224719101124}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7896206998850466, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.259085107535219, "policy_loss": -0.008249386202016323, "vf_loss": 7.2659291431418875, "vf_explained_var": 0.0017476331438627233, "kl": 0.0062460096067867, "entropy": 0.3987554944329622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 190.0, "episode_reward_mean": 967.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 96.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1010.0, 695.0, 1065.0, 870.0, 1410.0, 580.0, 730.0, 1550.0, 1060.0, 700.0, 455.0, 640.0, 1815.0, 1250.0, 1075.0, 1045.0, 375.0, 600.0, 620.0, 915.0, 410.0, 810.0, 400.0, 2270.0, 1665.0, 760.0, 1400.0, 600.0, 475.0, 390.0, 1480.0, 1060.0, 195.0, 620.0, 1015.0, 945.0, 910.0, 870.0, 1310.0, 1585.0, 485.0, 350.0, 815.0, 1575.0, 1090.0, 1275.0, 540.0, 210.0, 980.0, 800.0, 745.0, 870.0, 1080.0, 1100.0, 1030.0, 1155.0, 900.0, 1255.0, 1445.0, 1140.0, 1585.0, 1540.0, 1330.0, 1670.0, 1420.0, 1020.0, 925.0, 1185.0, 745.0, 780.0, 710.0, 1220.0, 850.0, 1200.0, 600.0, 450.0, 475.0, 1250.0, 1820.0, 1360.0, 980.0, 1120.0, 1120.0, 350.0, 840.0, 1585.0, 1085.0, 400.0, 870.0, 990.0, 900.0, 1400.0, 850.0, 1100.0, 510.0, 1340.0, 855.0, 190.0, 1130.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 60.0, 80.0, 110.0, 60.0, 170.0, 180.0, 90.0, 170.0, 60.0, 30.0, 160.0, 40.0, 20.0, 70.0, 80.0, 35.0, 10.0, 0.0, 250.0, 110.0, 410.0, 40.0, 50.0, 350.0, -70.0, 40.0, 55.0, -50.0, 130.0, 80.0, 15.0, 5.0, 80.0, 120.0, 40.0, 30.0, 180.0, 160.0, 160.0, 380.0, 80.0, 110.0, 40.0, 250.0, 80.0, 220.0, 110.0, 50.0, 90.0, -100.0, 50.0, -60.0, 40.0, 30.0, 200.0, 100.0, 40.0, 30.0, 250.0, 50.0, 270.0, 60.0, 0.0, 70.0, 0.0, -10.0, 20.0, 240.0, 30.0, 230.0, 290.0, 30.0, 230.0, 330.0, 250.0, 60.0, 70.0, 80.0, -20.0, -30.0, 50.0, 10.0, 250.0, 170.0, 160.0, 90.0, 240.0, 60.0, 60.0, 10.0, 10.0, 30.0, 260.0, 40.0, 160.0, 70.0, 40.0, 10.0, 70.0, 0.0, -20.0, 50.0, 160.0, 10.0, 5.0, 20.0, 170.0, 40.0, 20.0, 40.0, 50.0, 105.0, 185.0, 80.0, 40.0, 80.0, 30.0, 0.0, 30.0, 45.0, 120.0, 630.0, 310.0, 100.0, 20.0, 200.0, 280.0, 80.0, 30.0, 140.0, 380.0, 200.0, 90.0, 80.0, 90.0, 30.0, 40.0, 90.0, 110.0, 130.0, 40.0, 140.0, 260.0, 100.0, 130.0, -5.0, 70.0, 200.0, 10.0, 170.0, 30.0, -5.0, 200.0, 20.0, 20.0, 170.0, 210.0, 130.0, 100.0, -105.0, 50.0, -10.0, 10.0, -130.0, 200.0, 100.0, 20.0, 20.0, 220.0, 95.0, 40.0, 130.0, 30.0, 75.0, 130.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0, 30.0, 110.0, -40.0, 5.0, 30.0, 110.0, 400.0, 200.0, 60.0, 10.0, 70.0, 60.0, 30.0, 140.0, -50.0, 10.0, 70.0, 0.0, 70.0, 10.0, 90.0, 170.0, 40.0, 100.0, 150.0, 20.0, 10.0, 60.0, 80.0, 90.0, 90.0, 130.0, 40.0, 10.0, 10.0, -10.0, 0.0, 120.0, 0.0, 10.0, 130.0, 80.0, 1060.0, 50.0, -30.0, 150.0, 170.0, 230.0, 120.0, 310.0, 190.0, 130.0, 290.0, 110.0, 690.0, 40.0, 0.0, 50.0, 85.0, 80.0, 60.0, 70.0, 30.0, 30.0, 90.0, 300.0, 20.0, 20.0, 60.0, 80.0, 180.0, 430.0, 100.0, 60.0, 30.0, 180.0, 220.0, 140.0, 50.0, 10.0, 20.0, 20.0, 50.0, 130.0, 70.0, 70.0, 40.0, 10.0, 190.0, 0.0, 60.0, -15.0, 40.0, 30.0, 190.0, 0.0, 40.0, 0.0, 20.0, 110.0, 30.0, 20.0, 40.0, 40.0, 40.0, 110.0, 60.0, 0.0, 30.0, 20.0, 150.0, 60.0, 40.0, 260.0, 500.0, 30.0, 240.0, 40.0, 20.0, 140.0, 20.0, 110.0, 70.0, 70.0, 90.0, 80.0, 70.0, 370.0, 10.0, 170.0, 10.0, -15.0, 80.0, 60.0, 0.0, 0.0, 20.0, 70.0, 0.0, -30.0, 140.0, 100.0, 120.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 170.0, 90.0, 300.0, 240.0, 25.0, 110.0, 10.0, 90.0, 100.0, 40.0, 10.0, 60.0, 50.0, -40.0, 0.0, 170.0, 105.0, 110.0, 60.0, 240.0, 190.0, 60.0, 1000.0, 30.0, -20.0, -20.0, -40.0, 0.0, -180.0, 10.0, 70.0, 90.0, 20.0, 170.0, 60.0, 350.0, 120.0, -40.0, 40.0, 30.0, 30.0, 70.0, 410.0, 50.0, -20.0, 260.0, 330.0, 70.0, 70.0, 40.0, 30.0, 35.0, 350.0, 410.0, 260.0, 160.0, 40.0, 200.0, -50.0, -30.0, 210.0, 300.0, 10.0, -5.0, 30.0, -10.0, 0.0, 100.0, 40.0, 10.0, 10.0, 170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 250.0, 130.0, 10.0, 40.0, 120.0, -5.0, 170.0, 60.0, 30.0, 370.0, 80.0, 60.0, 230.0, 130.0, 60.0, 105.0, 220.0, 230.0, 90.0, 50.0, 60.0, 70.0, 150.0, 20.0, 180.0, 190.0, 50.0, 90.0, 230.0, 290.0, 85.0, 30.0, 80.0, 230.0, 190.0, 70.0, 70.0, 160.0, 70.0, 150.0, 50.0, 80.0, 60.0, 0.0, 60.0, -50.0, 80.0, 90.0, 20.0, 40.0, 40.0, 10.0, 15.0, 0.0, 70.0, 0.0, 5.0, 0.0, 30.0, 20.0, 55.0, 170.0, 30.0, 65.0, 60.0, 60.0, 110.0, 390.0, 20.0, 60.0, 160.0, 140.0, -30.0, 80.0, 50.0, 90.0, 40.0, 80.0, 130.0, 20.0, 170.0, 30.0, 20.0, 70.0, 100.0, 100.0, 30.0, 65.0, 140.0, 160.0, 0.0, 30.0, 30.0, 0.0, 140.0, 300.0, 50.0, 30.0, 130.0, 300.0, 150.0, 200.0, -40.0, 270.0, 50.0, 70.0, -5.0, 10.0, 75.0, 40.0, 20.0, 300.0, 30.0, 390.0, 10.0, 50.0, 100.0, 60.0, 100.0, 40.0, 60.0, 60.0, 90.0, 110.0, 260.0, 110.0, 50.0, 60.0, 190.0, -10.0, 20.0, 80.0, 120.0, 80.0, 185.0, 190.0, 80.0, 30.0, 380.0, 270.0, 40.0, 40.0, 80.0, 110.0, 70.0, 10.0, 110.0, 20.0, 150.0, 50.0, 130.0, 370.0, 10.0, 60.0, 65.0, 330.0, 40.0, 70.0, 130.0, 260.0, 170.0, 105.0, 390.0, 110.0, 90.0, 90.0, 90.0, 40.0, 100.0, 50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0, 60.0, 520.0, 10.0, 200.0, 65.0, 220.0, 120.0, 130.0, 40.0, 220.0, 110.0, 320.0, 130.0, 170.0, 160.0, 100.0, 110.0, 260.0, 130.0, 50.0, 160.0, 180.0, 80.0, 90.0, 140.0, 130.0, 80.0, 330.0, 80.0, 60.0, 110.0, 560.0, 60.0, 10.0, 40.0, 40.0, 30.0, 10.0, 380.0, 430.0, 190.0, 150.0, 190.0, 20.0, 130.0, 40.0, 160.0, 330.0, 70.0, 140.0, -5.0, 125.0, 200.0, 360.0, 70.0, 0.0, 50.0, 30.0, 80.0, 110.0, 100.0, 10.0, 95.0, 230.0, 30.0, 70.0, 50.0, 30.0, 100.0, 210.0, 210.0, 220.0, 265.0, -20.0, 110.0, 160.0, 180.0, 30.0, 25.0, 5.0, 80.0, 270.0, 190.0, 30.0, 40.0, 30.0, 0.0, 25.0, 40.0, 40.0, 110.0, 40.0, 80.0, 0.0, 120.0, 70.0, 30.0, 300.0, 20.0, 10.0, 365.0, 30.0, 70.0, -5.0, 30.0, 30.0, 40.0, 30.0, 40.0, 80.0, 200.0, 200.0, -70.0, 80.0, 180.0, 50.0, 270.0, 20.0, 230.0, 60.0, 60.0, 130.0, 80.0, 60.0, 10.0, 100.0, 50.0, 150.0, 110.0, 100.0, 40.0, 50.0, 170.0, 10.0, 290.0, 30.0, 10.0, 60.0, 20.0, 520.0, 130.0, 0.0, 30.0, 190.0, 30.0, 0.0, 40.0, 110.0, 50.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, 10.0, 140.0, 20.0, 20.0, 120.0, 170.0, 30.0, 15.0, 50.0, 60.0, 20.0, -30.0, -50.0, 140.0, 70.0, 40.0, 60.0, 130.0, 80.0, 90.0, 210.0, 90.0, 50.0, 210.0, 290.0, 270.0, 180.0, 60.0, 650.0, 70.0, 150.0, 190.0, 10.0, 150.0, 90.0, 110.0, 20.0, 60.0, 220.0, 240.0, 0.0, 40.0, 100.0, 390.0, 180.0, 140.0, 100.0, 30.0, 55.0, 160.0, 150.0, -5.0, 120.0, 70.0, 160.0, 280.0, -10.0, 200.0, 220.0, 0.0, 110.0, 40.0, 230.0, 50.0, 0.0, 100.0, 170.0, 250.0, 70.0, 200.0, 20.0, 90.0, 80.0, 20.0, 120.0, 0.0, 220.0, 20.0, 30.0, 20.0, -80.0, 30.0, 20.0, 80.0, 10.0, 50.0, 40.0, -70.0, 90.0, 230.0, 100.0, 10.0, 90.0, 20.0, 280.0, 70.0, 400.0, 600.0, 65.0, 300.0, 20.0, -30.0, 90.0, 40.0, 30.0, 80.0, 180.0, 40.0, 80.0, 10.0, 150.0, 190.0, 300.0, 30.0, 25.0, 70.0, 10.0, -35.0, 110.0, 70.0, 40.0, 30.0, 25.0, 40.0, 40.0, 20.0, 120.0, 80.0, 360.0, -10.0, 20.0, 40.0, 60.0, 170.0, 10.0, 20.0, -40.0, 60.0, 70.0, -40.0, 190.0, 220.0, 90.0, 40.0, 380.0, 50.0, 10.0, 30.0, 340.0, 10.0, 40.0, 100.0, 180.0, 120.0, 20.0, 120.0, 150.0, 220.0, 80.0, 60.0, 100.0, 310.0, 100.0, 310.0, -50.0, 40.0, 30.0, 40.0, 80.0, 320.0, 40.0, 10.0, 0.0, 290.0, 0.0, 90.0, 50.0, 130.0, 120.0, 110.0, 240.0, 60.0, 10.0, 190.0, 100.0, 20.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 110.0, 160.0, 80.0, 170.0, 100.0, 30.0, 110.0, 110.0, 270.0, 80.0, 300.0, 70.0, 100.0, 300.0, 30.0, 10.0, 40.0, 50.0, 20.0, 100.0, 105.0, 160.0, 40.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 90.0, 20.0, 0.0, 190.0, 70.0, 245.0, 60.0, 70.0, 40.0, 170.0, 175.0, 30.0, 80.0, 90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5385083857563502, "mean_inference_ms": 1.4113984700690265, "mean_action_processing_ms": 0.4408413716522502, "mean_env_wait_ms": 1.2492365780947774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013348102569580078, "StateBufferConnector_ms": 0.010579586029052734, "ViewRequirementAgentConnector_ms": 0.3755819797515869}, "num_episodes": 22, "episode_return_max": 2270.0, "episode_return_min": 190.0, "episode_return_mean": 967.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.40940774051057, "num_env_steps_trained_throughput_per_sec": 21.40940774051057, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 186331.777, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186331.714, "sample_time_ms": 2502.764, "learn_time_ms": 183808.744, "learn_throughput": 21.762, "synch_weights_time_ms": 10.921}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "33e63_00000", "date": "2024-06-19_01-32-56", "timestamp": 1718775176, "time_this_iter_s": 186.84270095825195, "time_total_s": 15958.13955116272, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327741ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15958.13955116272, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 16.985227272727276, "ram_util_percent": 79.97727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7300300860493834, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.992628577469002, "policy_loss": -0.009437721834495203, "vf_loss": 7.000611306963384, "vf_explained_var": 0.0009798261939019315, "kl": 0.006466645913834357, "entropy": 0.4016596950836583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 20.0, "episode_reward_mean": 959.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 1060.0}, "policy_reward_mean": {"policy_0": 95.905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 915.0, 410.0, 810.0, 400.0, 2270.0, 1665.0, 760.0, 1400.0, 600.0, 475.0, 390.0, 1480.0, 1060.0, 195.0, 620.0, 1015.0, 945.0, 910.0, 870.0, 1310.0, 1585.0, 485.0, 350.0, 815.0, 1575.0, 1090.0, 1275.0, 540.0, 210.0, 980.0, 800.0, 745.0, 870.0, 1080.0, 1100.0, 1030.0, 1155.0, 900.0, 1255.0, 1445.0, 1140.0, 1585.0, 1540.0, 1330.0, 1670.0, 1420.0, 1020.0, 925.0, 1185.0, 745.0, 780.0, 710.0, 1220.0, 850.0, 1200.0, 600.0, 450.0, 475.0, 1250.0, 1820.0, 1360.0, 980.0, 1120.0, 1120.0, 350.0, 840.0, 1585.0, 1085.0, 400.0, 870.0, 990.0, 900.0, 1400.0, 850.0, 1100.0, 510.0, 1340.0, 855.0, 190.0, 1130.0, 520.0, 1100.0, 235.0, 625.0, 940.0, 520.0, 20.0, 1600.0, 1250.0, 1160.0, 560.0, 1330.0, 1170.0, 960.0, 700.0, 580.0, 1645.0, 845.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 80.0, 40.0, 310.0, 70.0, 30.0, 110.0, -40.0, 5.0, 30.0, 110.0, 400.0, 200.0, 60.0, 10.0, 70.0, 60.0, 30.0, 140.0, -50.0, 10.0, 70.0, 0.0, 70.0, 10.0, 90.0, 170.0, 40.0, 100.0, 150.0, 20.0, 10.0, 60.0, 80.0, 90.0, 90.0, 130.0, 40.0, 10.0, 10.0, -10.0, 0.0, 120.0, 0.0, 10.0, 130.0, 80.0, 1060.0, 50.0, -30.0, 150.0, 170.0, 230.0, 120.0, 310.0, 190.0, 130.0, 290.0, 110.0, 690.0, 40.0, 0.0, 50.0, 85.0, 80.0, 60.0, 70.0, 30.0, 30.0, 90.0, 300.0, 20.0, 20.0, 60.0, 80.0, 180.0, 430.0, 100.0, 60.0, 30.0, 180.0, 220.0, 140.0, 50.0, 10.0, 20.0, 20.0, 50.0, 130.0, 70.0, 70.0, 40.0, 10.0, 190.0, 0.0, 60.0, -15.0, 40.0, 30.0, 190.0, 0.0, 40.0, 0.0, 20.0, 110.0, 30.0, 20.0, 40.0, 40.0, 40.0, 110.0, 60.0, 0.0, 30.0, 20.0, 150.0, 60.0, 40.0, 260.0, 500.0, 30.0, 240.0, 40.0, 20.0, 140.0, 20.0, 110.0, 70.0, 70.0, 90.0, 80.0, 70.0, 370.0, 10.0, 170.0, 10.0, -15.0, 80.0, 60.0, 0.0, 0.0, 20.0, 70.0, 0.0, -30.0, 140.0, 100.0, 120.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 170.0, 90.0, 300.0, 240.0, 25.0, 110.0, 10.0, 90.0, 100.0, 40.0, 10.0, 60.0, 50.0, -40.0, 0.0, 170.0, 105.0, 110.0, 60.0, 240.0, 190.0, 60.0, 1000.0, 30.0, -20.0, -20.0, -40.0, 0.0, -180.0, 10.0, 70.0, 90.0, 20.0, 170.0, 60.0, 350.0, 120.0, -40.0, 40.0, 30.0, 30.0, 70.0, 410.0, 50.0, -20.0, 260.0, 330.0, 70.0, 70.0, 40.0, 30.0, 35.0, 350.0, 410.0, 260.0, 160.0, 40.0, 200.0, -50.0, -30.0, 210.0, 300.0, 10.0, -5.0, 30.0, -10.0, 0.0, 100.0, 40.0, 10.0, 10.0, 170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 250.0, 130.0, 10.0, 40.0, 120.0, -5.0, 170.0, 60.0, 30.0, 370.0, 80.0, 60.0, 230.0, 130.0, 60.0, 105.0, 220.0, 230.0, 90.0, 50.0, 60.0, 70.0, 150.0, 20.0, 180.0, 190.0, 50.0, 90.0, 230.0, 290.0, 85.0, 30.0, 80.0, 230.0, 190.0, 70.0, 70.0, 160.0, 70.0, 150.0, 50.0, 80.0, 60.0, 0.0, 60.0, -50.0, 80.0, 90.0, 20.0, 40.0, 40.0, 10.0, 15.0, 0.0, 70.0, 0.0, 5.0, 0.0, 30.0, 20.0, 55.0, 170.0, 30.0, 65.0, 60.0, 60.0, 110.0, 390.0, 20.0, 60.0, 160.0, 140.0, -30.0, 80.0, 50.0, 90.0, 40.0, 80.0, 130.0, 20.0, 170.0, 30.0, 20.0, 70.0, 100.0, 100.0, 30.0, 65.0, 140.0, 160.0, 0.0, 30.0, 30.0, 0.0, 140.0, 300.0, 50.0, 30.0, 130.0, 300.0, 150.0, 200.0, -40.0, 270.0, 50.0, 70.0, -5.0, 10.0, 75.0, 40.0, 20.0, 300.0, 30.0, 390.0, 10.0, 50.0, 100.0, 60.0, 100.0, 40.0, 60.0, 60.0, 90.0, 110.0, 260.0, 110.0, 50.0, 60.0, 190.0, -10.0, 20.0, 80.0, 120.0, 80.0, 185.0, 190.0, 80.0, 30.0, 380.0, 270.0, 40.0, 40.0, 80.0, 110.0, 70.0, 10.0, 110.0, 20.0, 150.0, 50.0, 130.0, 370.0, 10.0, 60.0, 65.0, 330.0, 40.0, 70.0, 130.0, 260.0, 170.0, 105.0, 390.0, 110.0, 90.0, 90.0, 90.0, 40.0, 100.0, 50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0, 60.0, 520.0, 10.0, 200.0, 65.0, 220.0, 120.0, 130.0, 40.0, 220.0, 110.0, 320.0, 130.0, 170.0, 160.0, 100.0, 110.0, 260.0, 130.0, 50.0, 160.0, 180.0, 80.0, 90.0, 140.0, 130.0, 80.0, 330.0, 80.0, 60.0, 110.0, 560.0, 60.0, 10.0, 40.0, 40.0, 30.0, 10.0, 380.0, 430.0, 190.0, 150.0, 190.0, 20.0, 130.0, 40.0, 160.0, 330.0, 70.0, 140.0, -5.0, 125.0, 200.0, 360.0, 70.0, 0.0, 50.0, 30.0, 80.0, 110.0, 100.0, 10.0, 95.0, 230.0, 30.0, 70.0, 50.0, 30.0, 100.0, 210.0, 210.0, 220.0, 265.0, -20.0, 110.0, 160.0, 180.0, 30.0, 25.0, 5.0, 80.0, 270.0, 190.0, 30.0, 40.0, 30.0, 0.0, 25.0, 40.0, 40.0, 110.0, 40.0, 80.0, 0.0, 120.0, 70.0, 30.0, 300.0, 20.0, 10.0, 365.0, 30.0, 70.0, -5.0, 30.0, 30.0, 40.0, 30.0, 40.0, 80.0, 200.0, 200.0, -70.0, 80.0, 180.0, 50.0, 270.0, 20.0, 230.0, 60.0, 60.0, 130.0, 80.0, 60.0, 10.0, 100.0, 50.0, 150.0, 110.0, 100.0, 40.0, 50.0, 170.0, 10.0, 290.0, 30.0, 10.0, 60.0, 20.0, 520.0, 130.0, 0.0, 30.0, 190.0, 30.0, 0.0, 40.0, 110.0, 50.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, 10.0, 140.0, 20.0, 20.0, 120.0, 170.0, 30.0, 15.0, 50.0, 60.0, 20.0, -30.0, -50.0, 140.0, 70.0, 40.0, 60.0, 130.0, 80.0, 90.0, 210.0, 90.0, 50.0, 210.0, 290.0, 270.0, 180.0, 60.0, 650.0, 70.0, 150.0, 190.0, 10.0, 150.0, 90.0, 110.0, 20.0, 60.0, 220.0, 240.0, 0.0, 40.0, 100.0, 390.0, 180.0, 140.0, 100.0, 30.0, 55.0, 160.0, 150.0, -5.0, 120.0, 70.0, 160.0, 280.0, -10.0, 200.0, 220.0, 0.0, 110.0, 40.0, 230.0, 50.0, 0.0, 100.0, 170.0, 250.0, 70.0, 200.0, 20.0, 90.0, 80.0, 20.0, 120.0, 0.0, 220.0, 20.0, 30.0, 20.0, -80.0, 30.0, 20.0, 80.0, 10.0, 50.0, 40.0, -70.0, 90.0, 230.0, 100.0, 10.0, 90.0, 20.0, 280.0, 70.0, 400.0, 600.0, 65.0, 300.0, 20.0, -30.0, 90.0, 40.0, 30.0, 80.0, 180.0, 40.0, 80.0, 10.0, 150.0, 190.0, 300.0, 30.0, 25.0, 70.0, 10.0, -35.0, 110.0, 70.0, 40.0, 30.0, 25.0, 40.0, 40.0, 20.0, 120.0, 80.0, 360.0, -10.0, 20.0, 40.0, 60.0, 170.0, 10.0, 20.0, -40.0, 60.0, 70.0, -40.0, 190.0, 220.0, 90.0, 40.0, 380.0, 50.0, 10.0, 30.0, 340.0, 10.0, 40.0, 100.0, 180.0, 120.0, 20.0, 120.0, 150.0, 220.0, 80.0, 60.0, 100.0, 310.0, 100.0, 310.0, -50.0, 40.0, 30.0, 40.0, 80.0, 320.0, 40.0, 10.0, 0.0, 290.0, 0.0, 90.0, 50.0, 130.0, 120.0, 110.0, 240.0, 60.0, 10.0, 190.0, 100.0, 20.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 110.0, 160.0, 80.0, 170.0, 100.0, 30.0, 110.0, 110.0, 270.0, 80.0, 300.0, 70.0, 100.0, 300.0, 30.0, 10.0, 40.0, 50.0, 20.0, 100.0, 105.0, 160.0, 40.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 90.0, 20.0, 0.0, 190.0, 70.0, 245.0, 60.0, 70.0, 40.0, 170.0, 175.0, 30.0, 80.0, 90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0, 30.0, 50.0, 20.0, 70.0, 60.0, 90.0, 500.0, 80.0, 150.0, 50.0, 20.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 35.0, 20.0, 30.0, -5.0, 60.0, 40.0, 40.0, 20.0, 20.0, 30.0, 120.0, 190.0, 110.0, 10.0, 150.0, 60.0, 60.0, 10.0, 40.0, 270.0, 90.0, 170.0, 80.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 310.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, -320.0, 170.0, 20.0, 0.0, 0.0, 20.0, 10.0, -50.0, 630.0, 290.0, 240.0, 190.0, 60.0, -60.0, -70.0, 190.0, 180.0, 90.0, 60.0, 260.0, 110.0, 100.0, -50.0, 20.0, 210.0, 420.0, 30.0, 210.0, 70.0, 40.0, 240.0, 70.0, 90.0, 160.0, 140.0, 80.0, 60.0, 200.0, 0.0, 0.0, 30.0, 90.0, 30.0, 40.0, 60.0, 30.0, 80.0, 520.0, 100.0, 310.0, -20.0, 20.0, 140.0, 100.0, 30.0, 30.0, 100.0, 130.0, 40.0, 80.0, 290.0, 140.0, 90.0, 220.0, 80.0, 80.0, 20.0, 10.0, 30.0, 160.0, 60.0, 120.0, 50.0, 80.0, 190.0, 180.0, 80.0, 10.0, 20.0, 60.0, 90.0, 220.0, 30.0, 30.0, 70.0, 160.0, 10.0, 20.0, 10.0, 40.0, 20.0, 50.0, 20.0, 310.0, 20.0, 60.0, 30.0, 85.0, 190.0, 210.0, 240.0, 70.0, 170.0, 110.0, 340.0, 220.0, 10.0, -50.0, 110.0, 220.0, 50.0, 100.0, 25.0, 0.0, 30.0, 180.0, 180.0, 0.0, 350.0, 50.0, 60.0, 40.0, 20.0, 80.0, 100.0, 20.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5380024721101457, "mean_inference_ms": 1.4112788844506832, "mean_action_processing_ms": 0.4402364691600568, "mean_env_wait_ms": 1.248938795821435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013616561889648438, "StateBufferConnector_ms": 0.010846138000488281, "ViewRequirementAgentConnector_ms": 0.38039588928222656}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 20.0, "episode_return_mean": 959.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.452232211433454, "num_env_steps_trained_throughput_per_sec": 21.452232211433454, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 186386.434, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186386.371, "sample_time_ms": 2503.592, "learn_time_ms": 183862.43, "learn_throughput": 21.755, "synch_weights_time_ms": 11.024}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "33e63_00000", "date": "2024-06-19_01-36-02", "timestamp": 1718775362, "time_this_iter_s": 186.47042393684387, "time_total_s": 16144.609975099564, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32771de50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16144.609975099564, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 16.34318181818182, "ram_util_percent": 78.55492424242425}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6827288227403763, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.767021858704864, "policy_loss": -0.007631427022088934, "vf_loss": 6.773321351355003, "vf_explained_var": 0.0011965155220641116, "kl": 0.005919701387766422, "entropy": 0.4174764177987116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1820.0, "episode_reward_min": 20.0, "episode_reward_mean": 950.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 95.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 815.0, 1575.0, 1090.0, 1275.0, 540.0, 210.0, 980.0, 800.0, 745.0, 870.0, 1080.0, 1100.0, 1030.0, 1155.0, 900.0, 1255.0, 1445.0, 1140.0, 1585.0, 1540.0, 1330.0, 1670.0, 1420.0, 1020.0, 925.0, 1185.0, 745.0, 780.0, 710.0, 1220.0, 850.0, 1200.0, 600.0, 450.0, 475.0, 1250.0, 1820.0, 1360.0, 980.0, 1120.0, 1120.0, 350.0, 840.0, 1585.0, 1085.0, 400.0, 870.0, 990.0, 900.0, 1400.0, 850.0, 1100.0, 510.0, 1340.0, 855.0, 190.0, 1130.0, 520.0, 1100.0, 235.0, 625.0, 940.0, 520.0, 20.0, 1600.0, 1250.0, 1160.0, 560.0, 1330.0, 1170.0, 960.0, 700.0, 580.0, 1645.0, 845.0, 850.0, 1615.0, 540.0, 440.0, 1310.0, 620.0, 200.0, 600.0, 1080.0, 610.0, 1100.0, 120.0, 1360.0, 800.0, 1530.0, 1165.0, 1200.0, 800.0, 870.0, 830.0, 1140.0, 1240.0, 820.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 40.0, 0.0, 30.0, 10.0, 0.0, 60.0, 0.0, 10.0, 30.0, 10.0, 250.0, 130.0, 10.0, 40.0, 120.0, -5.0, 170.0, 60.0, 30.0, 370.0, 80.0, 60.0, 230.0, 130.0, 60.0, 105.0, 220.0, 230.0, 90.0, 50.0, 60.0, 70.0, 150.0, 20.0, 180.0, 190.0, 50.0, 90.0, 230.0, 290.0, 85.0, 30.0, 80.0, 230.0, 190.0, 70.0, 70.0, 160.0, 70.0, 150.0, 50.0, 80.0, 60.0, 0.0, 60.0, -50.0, 80.0, 90.0, 20.0, 40.0, 40.0, 10.0, 15.0, 0.0, 70.0, 0.0, 5.0, 0.0, 30.0, 20.0, 55.0, 170.0, 30.0, 65.0, 60.0, 60.0, 110.0, 390.0, 20.0, 60.0, 160.0, 140.0, -30.0, 80.0, 50.0, 90.0, 40.0, 80.0, 130.0, 20.0, 170.0, 30.0, 20.0, 70.0, 100.0, 100.0, 30.0, 65.0, 140.0, 160.0, 0.0, 30.0, 30.0, 0.0, 140.0, 300.0, 50.0, 30.0, 130.0, 300.0, 150.0, 200.0, -40.0, 270.0, 50.0, 70.0, -5.0, 10.0, 75.0, 40.0, 20.0, 300.0, 30.0, 390.0, 10.0, 50.0, 100.0, 60.0, 100.0, 40.0, 60.0, 60.0, 90.0, 110.0, 260.0, 110.0, 50.0, 60.0, 190.0, -10.0, 20.0, 80.0, 120.0, 80.0, 185.0, 190.0, 80.0, 30.0, 380.0, 270.0, 40.0, 40.0, 80.0, 110.0, 70.0, 10.0, 110.0, 20.0, 150.0, 50.0, 130.0, 370.0, 10.0, 60.0, 65.0, 330.0, 40.0, 70.0, 130.0, 260.0, 170.0, 105.0, 390.0, 110.0, 90.0, 90.0, 90.0, 40.0, 100.0, 50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0, 60.0, 520.0, 10.0, 200.0, 65.0, 220.0, 120.0, 130.0, 40.0, 220.0, 110.0, 320.0, 130.0, 170.0, 160.0, 100.0, 110.0, 260.0, 130.0, 50.0, 160.0, 180.0, 80.0, 90.0, 140.0, 130.0, 80.0, 330.0, 80.0, 60.0, 110.0, 560.0, 60.0, 10.0, 40.0, 40.0, 30.0, 10.0, 380.0, 430.0, 190.0, 150.0, 190.0, 20.0, 130.0, 40.0, 160.0, 330.0, 70.0, 140.0, -5.0, 125.0, 200.0, 360.0, 70.0, 0.0, 50.0, 30.0, 80.0, 110.0, 100.0, 10.0, 95.0, 230.0, 30.0, 70.0, 50.0, 30.0, 100.0, 210.0, 210.0, 220.0, 265.0, -20.0, 110.0, 160.0, 180.0, 30.0, 25.0, 5.0, 80.0, 270.0, 190.0, 30.0, 40.0, 30.0, 0.0, 25.0, 40.0, 40.0, 110.0, 40.0, 80.0, 0.0, 120.0, 70.0, 30.0, 300.0, 20.0, 10.0, 365.0, 30.0, 70.0, -5.0, 30.0, 30.0, 40.0, 30.0, 40.0, 80.0, 200.0, 200.0, -70.0, 80.0, 180.0, 50.0, 270.0, 20.0, 230.0, 60.0, 60.0, 130.0, 80.0, 60.0, 10.0, 100.0, 50.0, 150.0, 110.0, 100.0, 40.0, 50.0, 170.0, 10.0, 290.0, 30.0, 10.0, 60.0, 20.0, 520.0, 130.0, 0.0, 30.0, 190.0, 30.0, 0.0, 40.0, 110.0, 50.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, 10.0, 140.0, 20.0, 20.0, 120.0, 170.0, 30.0, 15.0, 50.0, 60.0, 20.0, -30.0, -50.0, 140.0, 70.0, 40.0, 60.0, 130.0, 80.0, 90.0, 210.0, 90.0, 50.0, 210.0, 290.0, 270.0, 180.0, 60.0, 650.0, 70.0, 150.0, 190.0, 10.0, 150.0, 90.0, 110.0, 20.0, 60.0, 220.0, 240.0, 0.0, 40.0, 100.0, 390.0, 180.0, 140.0, 100.0, 30.0, 55.0, 160.0, 150.0, -5.0, 120.0, 70.0, 160.0, 280.0, -10.0, 200.0, 220.0, 0.0, 110.0, 40.0, 230.0, 50.0, 0.0, 100.0, 170.0, 250.0, 70.0, 200.0, 20.0, 90.0, 80.0, 20.0, 120.0, 0.0, 220.0, 20.0, 30.0, 20.0, -80.0, 30.0, 20.0, 80.0, 10.0, 50.0, 40.0, -70.0, 90.0, 230.0, 100.0, 10.0, 90.0, 20.0, 280.0, 70.0, 400.0, 600.0, 65.0, 300.0, 20.0, -30.0, 90.0, 40.0, 30.0, 80.0, 180.0, 40.0, 80.0, 10.0, 150.0, 190.0, 300.0, 30.0, 25.0, 70.0, 10.0, -35.0, 110.0, 70.0, 40.0, 30.0, 25.0, 40.0, 40.0, 20.0, 120.0, 80.0, 360.0, -10.0, 20.0, 40.0, 60.0, 170.0, 10.0, 20.0, -40.0, 60.0, 70.0, -40.0, 190.0, 220.0, 90.0, 40.0, 380.0, 50.0, 10.0, 30.0, 340.0, 10.0, 40.0, 100.0, 180.0, 120.0, 20.0, 120.0, 150.0, 220.0, 80.0, 60.0, 100.0, 310.0, 100.0, 310.0, -50.0, 40.0, 30.0, 40.0, 80.0, 320.0, 40.0, 10.0, 0.0, 290.0, 0.0, 90.0, 50.0, 130.0, 120.0, 110.0, 240.0, 60.0, 10.0, 190.0, 100.0, 20.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 110.0, 160.0, 80.0, 170.0, 100.0, 30.0, 110.0, 110.0, 270.0, 80.0, 300.0, 70.0, 100.0, 300.0, 30.0, 10.0, 40.0, 50.0, 20.0, 100.0, 105.0, 160.0, 40.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 90.0, 20.0, 0.0, 190.0, 70.0, 245.0, 60.0, 70.0, 40.0, 170.0, 175.0, 30.0, 80.0, 90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0, 30.0, 50.0, 20.0, 70.0, 60.0, 90.0, 500.0, 80.0, 150.0, 50.0, 20.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 35.0, 20.0, 30.0, -5.0, 60.0, 40.0, 40.0, 20.0, 20.0, 30.0, 120.0, 190.0, 110.0, 10.0, 150.0, 60.0, 60.0, 10.0, 40.0, 270.0, 90.0, 170.0, 80.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 310.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, -320.0, 170.0, 20.0, 0.0, 0.0, 20.0, 10.0, -50.0, 630.0, 290.0, 240.0, 190.0, 60.0, -60.0, -70.0, 190.0, 180.0, 90.0, 60.0, 260.0, 110.0, 100.0, -50.0, 20.0, 210.0, 420.0, 30.0, 210.0, 70.0, 40.0, 240.0, 70.0, 90.0, 160.0, 140.0, 80.0, 60.0, 200.0, 0.0, 0.0, 30.0, 90.0, 30.0, 40.0, 60.0, 30.0, 80.0, 520.0, 100.0, 310.0, -20.0, 20.0, 140.0, 100.0, 30.0, 30.0, 100.0, 130.0, 40.0, 80.0, 290.0, 140.0, 90.0, 220.0, 80.0, 80.0, 20.0, 10.0, 30.0, 160.0, 60.0, 120.0, 50.0, 80.0, 190.0, 180.0, 80.0, 10.0, 20.0, 60.0, 90.0, 220.0, 30.0, 30.0, 70.0, 160.0, 10.0, 20.0, 10.0, 40.0, 20.0, 50.0, 20.0, 310.0, 20.0, 60.0, 30.0, 85.0, 190.0, 210.0, 240.0, 70.0, 170.0, 110.0, 340.0, 220.0, 10.0, -50.0, 110.0, 220.0, 50.0, 100.0, 25.0, 0.0, 30.0, 180.0, 180.0, 0.0, 350.0, 50.0, 60.0, 40.0, 20.0, 80.0, 100.0, 20.0, 130.0, 410.0, 230.0, 35.0, 240.0, 60.0, 80.0, 90.0, 100.0, 80.0, 290.0, 40.0, 50.0, 70.0, 20.0, 20.0, 60.0, 10.0, 20.0, 180.0, 70.0, 20.0, 60.0, 160.0, 20.0, 40.0, 50.0, 20.0, 40.0, 20.0, 10.0, 360.0, 60.0, 40.0, 10.0, 50.0, 340.0, 170.0, 10.0, 110.0, 160.0, 70.0, 250.0, 40.0, 20.0, 10.0, 20.0, 40.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 70.0, 0.0, 10.0, 0.0, 70.0, -30.0, 70.0, 10.0, 100.0, 20.0, 150.0, 80.0, 50.0, 80.0, 100.0, -30.0, 300.0, 40.0, 150.0, 70.0, 130.0, 90.0, 170.0, 60.0, 190.0, 70.0, 30.0, 50.0, 40.0, 40.0, 40.0, 130.0, -40.0, 60.0, 90.0, 220.0, 50.0, 40.0, 150.0, 270.0, 80.0, 90.0, 150.0, -40.0, 10.0, -30.0, 10.0, -25.0, -25.0, 40.0, -60.0, 130.0, -10.0, 80.0, 20.0, 280.0, 130.0, 380.0, 140.0, 150.0, 140.0, 50.0, 10.0, 60.0, 80.0, 170.0, 300.0, 30.0, 10.0, 40.0, 60.0, 80.0, 30.0, 0.0, 390.0, 70.0, 60.0, 50.0, 80.0, 260.0, 50.0, 210.0, 30.0, 330.0, 90.0, 40.0, 80.0, 180.0, 130.0, -105.0, 50.0, 490.0, 170.0, 40.0, 210.0, 510.0, 70.0, 100.0, -40.0, 60.0, 30.0, 100.0, 70.0, 90.0, 50.0, 40.0, 80.0, 20.0, 110.0, 10.0, 40.0, 80.0, 180.0, 190.0, 40.0, 100.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 230.0, 90.0, 220.0, 200.0, 30.0, 0.0, 10.0, 100.0, 20.0, 30.0, 170.0, 50.0, 110.0, 40.0, 350.0, 10.0, 70.0, 30.0, 40.0, 80.0, 20.0, 390.0, 160.0, 270.0, 170.0, 70.0, 110.0, -80.0, 90.0, 100.0, 320.0, 30.0, 0.0, 170.0, 20.0, 200.0, 10.0, 70.0, 210.0, 20.0, 80.0, 40.0, 0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5373681915099773, "mean_inference_ms": 1.4110193830309392, "mean_action_processing_ms": 0.44535499756800884, "mean_env_wait_ms": 1.248638260680402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013681411743164062, "StateBufferConnector_ms": 0.011293411254882812, "ViewRequirementAgentConnector_ms": 0.3847367763519287}, "num_episodes": 23, "episode_return_max": 1820.0, "episode_return_min": 20.0, "episode_return_mean": 950.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.267953021650115, "num_env_steps_trained_throughput_per_sec": 21.267953021650115, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 186536.344, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186536.28, "sample_time_ms": 2592.394, "learn_time_ms": 183922.653, "learn_throughput": 21.748, "synch_weights_time_ms": 10.83}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "33e63_00000", "date": "2024-06-19_01-39-10", "timestamp": 1718775550, "time_this_iter_s": 188.09387588500977, "time_total_s": 16332.703850984573, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32770cee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16332.703850984573, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 16.571052631578947, "ram_util_percent": 80.1312030075188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3866177148521897, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.417103176959914, "policy_loss": -0.008257826099383494, "vf_loss": 7.423958899088688, "vf_explained_var": 0.0012360566467268907, "kl": 0.006231526210383881, "entropy": 0.41259474568346693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1820.0, "episode_reward_min": 20.0, "episode_reward_mean": 953.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 650.0}, "policy_reward_mean": {"policy_0": 95.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1140.0, 1585.0, 1540.0, 1330.0, 1670.0, 1420.0, 1020.0, 925.0, 1185.0, 745.0, 780.0, 710.0, 1220.0, 850.0, 1200.0, 600.0, 450.0, 475.0, 1250.0, 1820.0, 1360.0, 980.0, 1120.0, 1120.0, 350.0, 840.0, 1585.0, 1085.0, 400.0, 870.0, 990.0, 900.0, 1400.0, 850.0, 1100.0, 510.0, 1340.0, 855.0, 190.0, 1130.0, 520.0, 1100.0, 235.0, 625.0, 940.0, 520.0, 20.0, 1600.0, 1250.0, 1160.0, 560.0, 1330.0, 1170.0, 960.0, 700.0, 580.0, 1645.0, 845.0, 850.0, 1615.0, 540.0, 440.0, 1310.0, 620.0, 200.0, 600.0, 1080.0, 610.0, 1100.0, 120.0, 1360.0, 800.0, 1530.0, 1165.0, 1200.0, 800.0, 870.0, 830.0, 1140.0, 1240.0, 820.0, 370.0, 450.0, 1000.0, 685.0, 940.0, 1410.0, 1250.0, 725.0, 840.0, 1420.0, 395.0, 1120.0, 1300.0, 1225.0, 965.0, 570.0, 1120.0, 1250.0, 860.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 200.0, 350.0, 160.0, 60.0, 60.0, 10.0, 60.0, 130.0, 60.0, 60.0, 520.0, 10.0, 200.0, 65.0, 220.0, 120.0, 130.0, 40.0, 220.0, 110.0, 320.0, 130.0, 170.0, 160.0, 100.0, 110.0, 260.0, 130.0, 50.0, 160.0, 180.0, 80.0, 90.0, 140.0, 130.0, 80.0, 330.0, 80.0, 60.0, 110.0, 560.0, 60.0, 10.0, 40.0, 40.0, 30.0, 10.0, 380.0, 430.0, 190.0, 150.0, 190.0, 20.0, 130.0, 40.0, 160.0, 330.0, 70.0, 140.0, -5.0, 125.0, 200.0, 360.0, 70.0, 0.0, 50.0, 30.0, 80.0, 110.0, 100.0, 10.0, 95.0, 230.0, 30.0, 70.0, 50.0, 30.0, 100.0, 210.0, 210.0, 220.0, 265.0, -20.0, 110.0, 160.0, 180.0, 30.0, 25.0, 5.0, 80.0, 270.0, 190.0, 30.0, 40.0, 30.0, 0.0, 25.0, 40.0, 40.0, 110.0, 40.0, 80.0, 0.0, 120.0, 70.0, 30.0, 300.0, 20.0, 10.0, 365.0, 30.0, 70.0, -5.0, 30.0, 30.0, 40.0, 30.0, 40.0, 80.0, 200.0, 200.0, -70.0, 80.0, 180.0, 50.0, 270.0, 20.0, 230.0, 60.0, 60.0, 130.0, 80.0, 60.0, 10.0, 100.0, 50.0, 150.0, 110.0, 100.0, 40.0, 50.0, 170.0, 10.0, 290.0, 30.0, 10.0, 60.0, 20.0, 520.0, 130.0, 0.0, 30.0, 190.0, 30.0, 0.0, 40.0, 110.0, 50.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, 10.0, 140.0, 20.0, 20.0, 120.0, 170.0, 30.0, 15.0, 50.0, 60.0, 20.0, -30.0, -50.0, 140.0, 70.0, 40.0, 60.0, 130.0, 80.0, 90.0, 210.0, 90.0, 50.0, 210.0, 290.0, 270.0, 180.0, 60.0, 650.0, 70.0, 150.0, 190.0, 10.0, 150.0, 90.0, 110.0, 20.0, 60.0, 220.0, 240.0, 0.0, 40.0, 100.0, 390.0, 180.0, 140.0, 100.0, 30.0, 55.0, 160.0, 150.0, -5.0, 120.0, 70.0, 160.0, 280.0, -10.0, 200.0, 220.0, 0.0, 110.0, 40.0, 230.0, 50.0, 0.0, 100.0, 170.0, 250.0, 70.0, 200.0, 20.0, 90.0, 80.0, 20.0, 120.0, 0.0, 220.0, 20.0, 30.0, 20.0, -80.0, 30.0, 20.0, 80.0, 10.0, 50.0, 40.0, -70.0, 90.0, 230.0, 100.0, 10.0, 90.0, 20.0, 280.0, 70.0, 400.0, 600.0, 65.0, 300.0, 20.0, -30.0, 90.0, 40.0, 30.0, 80.0, 180.0, 40.0, 80.0, 10.0, 150.0, 190.0, 300.0, 30.0, 25.0, 70.0, 10.0, -35.0, 110.0, 70.0, 40.0, 30.0, 25.0, 40.0, 40.0, 20.0, 120.0, 80.0, 360.0, -10.0, 20.0, 40.0, 60.0, 170.0, 10.0, 20.0, -40.0, 60.0, 70.0, -40.0, 190.0, 220.0, 90.0, 40.0, 380.0, 50.0, 10.0, 30.0, 340.0, 10.0, 40.0, 100.0, 180.0, 120.0, 20.0, 120.0, 150.0, 220.0, 80.0, 60.0, 100.0, 310.0, 100.0, 310.0, -50.0, 40.0, 30.0, 40.0, 80.0, 320.0, 40.0, 10.0, 0.0, 290.0, 0.0, 90.0, 50.0, 130.0, 120.0, 110.0, 240.0, 60.0, 10.0, 190.0, 100.0, 20.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 110.0, 160.0, 80.0, 170.0, 100.0, 30.0, 110.0, 110.0, 270.0, 80.0, 300.0, 70.0, 100.0, 300.0, 30.0, 10.0, 40.0, 50.0, 20.0, 100.0, 105.0, 160.0, 40.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 90.0, 20.0, 0.0, 190.0, 70.0, 245.0, 60.0, 70.0, 40.0, 170.0, 175.0, 30.0, 80.0, 90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0, 30.0, 50.0, 20.0, 70.0, 60.0, 90.0, 500.0, 80.0, 150.0, 50.0, 20.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 35.0, 20.0, 30.0, -5.0, 60.0, 40.0, 40.0, 20.0, 20.0, 30.0, 120.0, 190.0, 110.0, 10.0, 150.0, 60.0, 60.0, 10.0, 40.0, 270.0, 90.0, 170.0, 80.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 310.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, -320.0, 170.0, 20.0, 0.0, 0.0, 20.0, 10.0, -50.0, 630.0, 290.0, 240.0, 190.0, 60.0, -60.0, -70.0, 190.0, 180.0, 90.0, 60.0, 260.0, 110.0, 100.0, -50.0, 20.0, 210.0, 420.0, 30.0, 210.0, 70.0, 40.0, 240.0, 70.0, 90.0, 160.0, 140.0, 80.0, 60.0, 200.0, 0.0, 0.0, 30.0, 90.0, 30.0, 40.0, 60.0, 30.0, 80.0, 520.0, 100.0, 310.0, -20.0, 20.0, 140.0, 100.0, 30.0, 30.0, 100.0, 130.0, 40.0, 80.0, 290.0, 140.0, 90.0, 220.0, 80.0, 80.0, 20.0, 10.0, 30.0, 160.0, 60.0, 120.0, 50.0, 80.0, 190.0, 180.0, 80.0, 10.0, 20.0, 60.0, 90.0, 220.0, 30.0, 30.0, 70.0, 160.0, 10.0, 20.0, 10.0, 40.0, 20.0, 50.0, 20.0, 310.0, 20.0, 60.0, 30.0, 85.0, 190.0, 210.0, 240.0, 70.0, 170.0, 110.0, 340.0, 220.0, 10.0, -50.0, 110.0, 220.0, 50.0, 100.0, 25.0, 0.0, 30.0, 180.0, 180.0, 0.0, 350.0, 50.0, 60.0, 40.0, 20.0, 80.0, 100.0, 20.0, 130.0, 410.0, 230.0, 35.0, 240.0, 60.0, 80.0, 90.0, 100.0, 80.0, 290.0, 40.0, 50.0, 70.0, 20.0, 20.0, 60.0, 10.0, 20.0, 180.0, 70.0, 20.0, 60.0, 160.0, 20.0, 40.0, 50.0, 20.0, 40.0, 20.0, 10.0, 360.0, 60.0, 40.0, 10.0, 50.0, 340.0, 170.0, 10.0, 110.0, 160.0, 70.0, 250.0, 40.0, 20.0, 10.0, 20.0, 40.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 70.0, 0.0, 10.0, 0.0, 70.0, -30.0, 70.0, 10.0, 100.0, 20.0, 150.0, 80.0, 50.0, 80.0, 100.0, -30.0, 300.0, 40.0, 150.0, 70.0, 130.0, 90.0, 170.0, 60.0, 190.0, 70.0, 30.0, 50.0, 40.0, 40.0, 40.0, 130.0, -40.0, 60.0, 90.0, 220.0, 50.0, 40.0, 150.0, 270.0, 80.0, 90.0, 150.0, -40.0, 10.0, -30.0, 10.0, -25.0, -25.0, 40.0, -60.0, 130.0, -10.0, 80.0, 20.0, 280.0, 130.0, 380.0, 140.0, 150.0, 140.0, 50.0, 10.0, 60.0, 80.0, 170.0, 300.0, 30.0, 10.0, 40.0, 60.0, 80.0, 30.0, 0.0, 390.0, 70.0, 60.0, 50.0, 80.0, 260.0, 50.0, 210.0, 30.0, 330.0, 90.0, 40.0, 80.0, 180.0, 130.0, -105.0, 50.0, 490.0, 170.0, 40.0, 210.0, 510.0, 70.0, 100.0, -40.0, 60.0, 30.0, 100.0, 70.0, 90.0, 50.0, 40.0, 80.0, 20.0, 110.0, 10.0, 40.0, 80.0, 180.0, 190.0, 40.0, 100.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 230.0, 90.0, 220.0, 200.0, 30.0, 0.0, 10.0, 100.0, 20.0, 30.0, 170.0, 50.0, 110.0, 40.0, 350.0, 10.0, 70.0, 30.0, 40.0, 80.0, 20.0, 390.0, 160.0, 270.0, 170.0, 70.0, 110.0, -80.0, 90.0, 100.0, 320.0, 30.0, 0.0, 170.0, 20.0, 200.0, 10.0, 70.0, 210.0, 20.0, 80.0, 40.0, 0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0, 20.0, 90.0, 40.0, 10.0, 10.0, 0.0, 20.0, 60.0, 0.0, 200.0, 30.0, -10.0, 160.0, 260.0, 150.0, 80.0, 60.0, 10.0, 80.0, 180.0, 30.0, 20.0, 380.0, 80.0, 20.0, 85.0, 20.0, 20.0, 10.0, 20.0, -50.0, 90.0, 60.0, 80.0, 60.0, 40.0, 0.0, 80.0, 200.0, 380.0, 110.0, -60.0, 150.0, 40.0, 40.0, 90.0, 620.0, 70.0, 20.0, 330.0, 40.0, 10.0, 340.0, 80.0, 100.0, 10.0, 20.0, 120.0, 350.0, 180.0, 180.0, 30.0, 50.0, 80.0, 50.0, 30.0, 220.0, 20.0, 45.0, 20.0, 40.0, 100.0, 60.0, 180.0, 30.0, 90.0, 130.0, 130.0, 40.0, 40.0, 70.0, 80.0, 80.0, 200.0, 30.0, 130.0, 190.0, 360.0, 50.0, 230.0, 70.0, 30.0, 50.0, 50.0, 50.0, 0.0, 85.0, 30.0, 10.0, 20.0, 240.0, 190.0, 150.0, 40.0, 170.0, 90.0, 50.0, 70.0, 20.0, 100.0, 190.0, 340.0, 90.0, 110.0, 310.0, 80.0, 40.0, 70.0, 40.0, 30.0, 55.0, -20.0, 410.0, 50.0, 130.0, 110.0, 80.0, 170.0, 50.0, 190.0, 100.0, 80.0, 60.0, 110.0, 310.0, 45.0, 20.0, 60.0, 150.0, 30.0, 50.0, 150.0, 70.0, 150.0, -50.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 40.0, 20.0, 130.0, 230.0, 300.0, 30.0, 10.0, 130.0, 150.0, 80.0, 50.0, 170.0, 60.0, 180.0, 190.0, 70.0, 200.0, 210.0, 40.0, -20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5368478635022056, "mean_inference_ms": 1.41100055872111, "mean_action_processing_ms": 0.44920972714986135, "mean_env_wait_ms": 1.2485084725456252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013617277145385742, "StateBufferConnector_ms": 0.011185646057128906, "ViewRequirementAgentConnector_ms": 0.3828318119049072}, "num_episodes": 18, "episode_return_max": 1820.0, "episode_return_min": 20.0, "episode_return_mean": 953.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.5033231466801, "num_env_steps_trained_throughput_per_sec": 21.5033231466801, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 186431.211, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186431.147, "sample_time_ms": 2599.225, "learn_time_ms": 183810.61, "learn_throughput": 21.762, "synch_weights_time_ms": 10.917}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "33e63_00000", "date": "2024-06-19_01-42-16", "timestamp": 1718775736, "time_this_iter_s": 186.02808594703674, "time_total_s": 16518.73193693161, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16518.73193693161, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 16.088973384030417, "ram_util_percent": 78.85589353612168}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1799320336347954, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.14227147249622, "policy_loss": -0.009419351882406404, "vf_loss": 7.150191200833224, "vf_explained_var": 0.0004443345422815845, "kl": 0.00666499320164712, "entropy": 0.4079494620950077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 1810.0, "episode_reward_min": 20.0, "episode_reward_mean": 945.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 94.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 1120.0, 350.0, 840.0, 1585.0, 1085.0, 400.0, 870.0, 990.0, 900.0, 1400.0, 850.0, 1100.0, 510.0, 1340.0, 855.0, 190.0, 1130.0, 520.0, 1100.0, 235.0, 625.0, 940.0, 520.0, 20.0, 1600.0, 1250.0, 1160.0, 560.0, 1330.0, 1170.0, 960.0, 700.0, 580.0, 1645.0, 845.0, 850.0, 1615.0, 540.0, 440.0, 1310.0, 620.0, 200.0, 600.0, 1080.0, 610.0, 1100.0, 120.0, 1360.0, 800.0, 1530.0, 1165.0, 1200.0, 800.0, 870.0, 830.0, 1140.0, 1240.0, 820.0, 370.0, 450.0, 1000.0, 685.0, 940.0, 1410.0, 1250.0, 725.0, 840.0, 1420.0, 395.0, 1120.0, 1300.0, 1225.0, 965.0, 570.0, 1120.0, 1250.0, 860.0, 540.0, 1105.0, 760.0, 1560.0, 1200.0, 720.0, 1810.0, 1415.0, 1025.0, 940.0, 1070.0, 1795.0, 1030.0, 1380.0, 810.0, 1000.0, 780.0, 290.0, 1370.0, 1370.0, 405.0, 1090.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [280.0, -10.0, 200.0, 220.0, 0.0, 110.0, 40.0, 230.0, 50.0, 0.0, 100.0, 170.0, 250.0, 70.0, 200.0, 20.0, 90.0, 80.0, 20.0, 120.0, 0.0, 220.0, 20.0, 30.0, 20.0, -80.0, 30.0, 20.0, 80.0, 10.0, 50.0, 40.0, -70.0, 90.0, 230.0, 100.0, 10.0, 90.0, 20.0, 280.0, 70.0, 400.0, 600.0, 65.0, 300.0, 20.0, -30.0, 90.0, 40.0, 30.0, 80.0, 180.0, 40.0, 80.0, 10.0, 150.0, 190.0, 300.0, 30.0, 25.0, 70.0, 10.0, -35.0, 110.0, 70.0, 40.0, 30.0, 25.0, 40.0, 40.0, 20.0, 120.0, 80.0, 360.0, -10.0, 20.0, 40.0, 60.0, 170.0, 10.0, 20.0, -40.0, 60.0, 70.0, -40.0, 190.0, 220.0, 90.0, 40.0, 380.0, 50.0, 10.0, 30.0, 340.0, 10.0, 40.0, 100.0, 180.0, 120.0, 20.0, 120.0, 150.0, 220.0, 80.0, 60.0, 100.0, 310.0, 100.0, 310.0, -50.0, 40.0, 30.0, 40.0, 80.0, 320.0, 40.0, 10.0, 0.0, 290.0, 0.0, 90.0, 50.0, 130.0, 120.0, 110.0, 240.0, 60.0, 10.0, 190.0, 100.0, 20.0, 20.0, 30.0, 30.0, 0.0, 30.0, 30.0, 110.0, 160.0, 80.0, 170.0, 100.0, 30.0, 110.0, 110.0, 270.0, 80.0, 300.0, 70.0, 100.0, 300.0, 30.0, 10.0, 40.0, 50.0, 20.0, 100.0, 105.0, 160.0, 40.0, 0.0, 0.0, 30.0, 0.0, 10.0, 0.0, 40.0, 90.0, 20.0, 0.0, 190.0, 70.0, 245.0, 60.0, 70.0, 40.0, 170.0, 175.0, 30.0, 80.0, 90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0, 30.0, 50.0, 20.0, 70.0, 60.0, 90.0, 500.0, 80.0, 150.0, 50.0, 20.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 35.0, 20.0, 30.0, -5.0, 60.0, 40.0, 40.0, 20.0, 20.0, 30.0, 120.0, 190.0, 110.0, 10.0, 150.0, 60.0, 60.0, 10.0, 40.0, 270.0, 90.0, 170.0, 80.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 310.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, -320.0, 170.0, 20.0, 0.0, 0.0, 20.0, 10.0, -50.0, 630.0, 290.0, 240.0, 190.0, 60.0, -60.0, -70.0, 190.0, 180.0, 90.0, 60.0, 260.0, 110.0, 100.0, -50.0, 20.0, 210.0, 420.0, 30.0, 210.0, 70.0, 40.0, 240.0, 70.0, 90.0, 160.0, 140.0, 80.0, 60.0, 200.0, 0.0, 0.0, 30.0, 90.0, 30.0, 40.0, 60.0, 30.0, 80.0, 520.0, 100.0, 310.0, -20.0, 20.0, 140.0, 100.0, 30.0, 30.0, 100.0, 130.0, 40.0, 80.0, 290.0, 140.0, 90.0, 220.0, 80.0, 80.0, 20.0, 10.0, 30.0, 160.0, 60.0, 120.0, 50.0, 80.0, 190.0, 180.0, 80.0, 10.0, 20.0, 60.0, 90.0, 220.0, 30.0, 30.0, 70.0, 160.0, 10.0, 20.0, 10.0, 40.0, 20.0, 50.0, 20.0, 310.0, 20.0, 60.0, 30.0, 85.0, 190.0, 210.0, 240.0, 70.0, 170.0, 110.0, 340.0, 220.0, 10.0, -50.0, 110.0, 220.0, 50.0, 100.0, 25.0, 0.0, 30.0, 180.0, 180.0, 0.0, 350.0, 50.0, 60.0, 40.0, 20.0, 80.0, 100.0, 20.0, 130.0, 410.0, 230.0, 35.0, 240.0, 60.0, 80.0, 90.0, 100.0, 80.0, 290.0, 40.0, 50.0, 70.0, 20.0, 20.0, 60.0, 10.0, 20.0, 180.0, 70.0, 20.0, 60.0, 160.0, 20.0, 40.0, 50.0, 20.0, 40.0, 20.0, 10.0, 360.0, 60.0, 40.0, 10.0, 50.0, 340.0, 170.0, 10.0, 110.0, 160.0, 70.0, 250.0, 40.0, 20.0, 10.0, 20.0, 40.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 70.0, 0.0, 10.0, 0.0, 70.0, -30.0, 70.0, 10.0, 100.0, 20.0, 150.0, 80.0, 50.0, 80.0, 100.0, -30.0, 300.0, 40.0, 150.0, 70.0, 130.0, 90.0, 170.0, 60.0, 190.0, 70.0, 30.0, 50.0, 40.0, 40.0, 40.0, 130.0, -40.0, 60.0, 90.0, 220.0, 50.0, 40.0, 150.0, 270.0, 80.0, 90.0, 150.0, -40.0, 10.0, -30.0, 10.0, -25.0, -25.0, 40.0, -60.0, 130.0, -10.0, 80.0, 20.0, 280.0, 130.0, 380.0, 140.0, 150.0, 140.0, 50.0, 10.0, 60.0, 80.0, 170.0, 300.0, 30.0, 10.0, 40.0, 60.0, 80.0, 30.0, 0.0, 390.0, 70.0, 60.0, 50.0, 80.0, 260.0, 50.0, 210.0, 30.0, 330.0, 90.0, 40.0, 80.0, 180.0, 130.0, -105.0, 50.0, 490.0, 170.0, 40.0, 210.0, 510.0, 70.0, 100.0, -40.0, 60.0, 30.0, 100.0, 70.0, 90.0, 50.0, 40.0, 80.0, 20.0, 110.0, 10.0, 40.0, 80.0, 180.0, 190.0, 40.0, 100.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 230.0, 90.0, 220.0, 200.0, 30.0, 0.0, 10.0, 100.0, 20.0, 30.0, 170.0, 50.0, 110.0, 40.0, 350.0, 10.0, 70.0, 30.0, 40.0, 80.0, 20.0, 390.0, 160.0, 270.0, 170.0, 70.0, 110.0, -80.0, 90.0, 100.0, 320.0, 30.0, 0.0, 170.0, 20.0, 200.0, 10.0, 70.0, 210.0, 20.0, 80.0, 40.0, 0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0, 20.0, 90.0, 40.0, 10.0, 10.0, 0.0, 20.0, 60.0, 0.0, 200.0, 30.0, -10.0, 160.0, 260.0, 150.0, 80.0, 60.0, 10.0, 80.0, 180.0, 30.0, 20.0, 380.0, 80.0, 20.0, 85.0, 20.0, 20.0, 10.0, 20.0, -50.0, 90.0, 60.0, 80.0, 60.0, 40.0, 0.0, 80.0, 200.0, 380.0, 110.0, -60.0, 150.0, 40.0, 40.0, 90.0, 620.0, 70.0, 20.0, 330.0, 40.0, 10.0, 340.0, 80.0, 100.0, 10.0, 20.0, 120.0, 350.0, 180.0, 180.0, 30.0, 50.0, 80.0, 50.0, 30.0, 220.0, 20.0, 45.0, 20.0, 40.0, 100.0, 60.0, 180.0, 30.0, 90.0, 130.0, 130.0, 40.0, 40.0, 70.0, 80.0, 80.0, 200.0, 30.0, 130.0, 190.0, 360.0, 50.0, 230.0, 70.0, 30.0, 50.0, 50.0, 50.0, 0.0, 85.0, 30.0, 10.0, 20.0, 240.0, 190.0, 150.0, 40.0, 170.0, 90.0, 50.0, 70.0, 20.0, 100.0, 190.0, 340.0, 90.0, 110.0, 310.0, 80.0, 40.0, 70.0, 40.0, 30.0, 55.0, -20.0, 410.0, 50.0, 130.0, 110.0, 80.0, 170.0, 50.0, 190.0, 100.0, 80.0, 60.0, 110.0, 310.0, 45.0, 20.0, 60.0, 150.0, 30.0, 50.0, 150.0, 70.0, 150.0, -50.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 40.0, 20.0, 130.0, 230.0, 300.0, 30.0, 10.0, 130.0, 150.0, 80.0, 50.0, 170.0, 60.0, 180.0, 190.0, 70.0, 200.0, 210.0, 40.0, -20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0, 80.0, 40.0, 0.0, 80.0, 120.0, 30.0, 110.0, 20.0, 20.0, 40.0, 100.0, 120.0, 60.0, 30.0, 110.0, 300.0, 50.0, 130.0, -25.0, 230.0, 110.0, 50.0, 100.0, 180.0, 30.0, 70.0, 90.0, 30.0, 40.0, 60.0, 150.0, 80.0, -40.0, 120.0, 110.0, 290.0, 370.0, 100.0, 140.0, 240.0, 120.0, 80.0, 210.0, 40.0, 130.0, 260.0, 70.0, 170.0, 20.0, 100.0, 20.0, 80.0, 80.0, 0.0, 150.0, 20.0, 290.0, 0.0, 30.0, 50.0, 20.0, 70.0, 160.0, 70.0, 360.0, 50.0, 120.0, 530.0, -10.0, 440.0, 210.0, 100.0, 190.0, 640.0, 115.0, 170.0, 100.0, -50.0, -110.0, 50.0, 130.0, 30.0, 0.0, 100.0, 0.0, 15.0, -30.0, 300.0, 180.0, 300.0, 30.0, 40.0, 10.0, 170.0, 20.0, 60.0, 20.0, 80.0, 210.0, 300.0, 20.0, 240.0, 0.0, 20.0, 190.0, 40.0, 370.0, 40.0, 80.0, 70.0, 60.0, 215.0, 120.0, 480.0, 320.0, 130.0, 50.0, 180.0, 120.0, 120.0, 80.0, 60.0, 30.0, 50.0, 610.0, 80.0, -50.0, 40.0, 70.0, 60.0, 110.0, 110.0, 180.0, 90.0, 240.0, 110.0, 150.0, 110.0, 180.0, 100.0, 190.0, 20.0, 70.0, 50.0, 20.0, 310.0, 0.0, 30.0, 60.0, 60.0, 60.0, 90.0, 40.0, 370.0, 90.0, 160.0, 60.0, 80.0, 20.0, 30.0, 70.0, 40.0, 30.0, 60.0, 190.0, 20.0, 40.0, 110.0, -20.0, 240.0, 150.0, 10.0, 0.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 340.0, 80.0, 160.0, 80.0, 170.0, 200.0, 190.0, 70.0, 50.0, 50.0, 210.0, 30.0, 220.0, 90.0, 360.0, 120.0, 150.0, 90.0, 50.0, -5.0, 0.0, 40.0, 50.0, 30.0, 80.0, 50.0, 70.0, 40.0, 110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5352729097939448, "mean_inference_ms": 1.4100218985307422, "mean_action_processing_ms": 0.4542604706954637, "mean_env_wait_ms": 1.248294915173466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013431549072265625, "StateBufferConnector_ms": 0.011141300201416016, "ViewRequirementAgentConnector_ms": 0.3832669258117676}, "num_episodes": 22, "episode_return_max": 1810.0, "episode_return_min": 20.0, "episode_return_mean": 945.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.336822890582454, "num_env_steps_trained_throughput_per_sec": 21.336822890582454, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 186731.377, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186731.313, "sample_time_ms": 2577.433, "learn_time_ms": 184132.7, "learn_throughput": 21.723, "synch_weights_time_ms": 10.695}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "33e63_00000", "date": "2024-06-19_01-45-24", "timestamp": 1718775924, "time_this_iter_s": 187.47811627388, "time_total_s": 16706.21005320549, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32771d040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16706.21005320549, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 16.405283018867923, "ram_util_percent": 79.68830188679244}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.383752139295125, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.461088842426499, "policy_loss": -0.009440634265185965, "vf_loss": 7.469055504692248, "vf_explained_var": 0.0004730321220950451, "kl": 0.006550990021459103, "entropy": 0.4038079951930478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 1810.0, "episode_reward_min": 20.0, "episode_reward_mean": 977.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 97.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 1100.0, 235.0, 625.0, 940.0, 520.0, 20.0, 1600.0, 1250.0, 1160.0, 560.0, 1330.0, 1170.0, 960.0, 700.0, 580.0, 1645.0, 845.0, 850.0, 1615.0, 540.0, 440.0, 1310.0, 620.0, 200.0, 600.0, 1080.0, 610.0, 1100.0, 120.0, 1360.0, 800.0, 1530.0, 1165.0, 1200.0, 800.0, 870.0, 830.0, 1140.0, 1240.0, 820.0, 370.0, 450.0, 1000.0, 685.0, 940.0, 1410.0, 1250.0, 725.0, 840.0, 1420.0, 395.0, 1120.0, 1300.0, 1225.0, 965.0, 570.0, 1120.0, 1250.0, 860.0, 540.0, 1105.0, 760.0, 1560.0, 1200.0, 720.0, 1810.0, 1415.0, 1025.0, 940.0, 1070.0, 1795.0, 1030.0, 1380.0, 810.0, 1000.0, 780.0, 290.0, 1370.0, 1370.0, 405.0, 1090.0, 1410.0, 1610.0, 1045.0, 1610.0, 400.0, 960.0, 1480.0, 1075.0, 1395.0, 970.0, 840.0, 730.0, 1250.0, 1000.0, 1030.0, 1240.0, 730.0, 995.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 40.0, 180.0, 70.0, 160.0, 30.0, 10.0, 0.0, -70.0, 10.0, 30.0, 50.0, 20.0, 70.0, 60.0, 90.0, 500.0, 80.0, 150.0, 50.0, 20.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 35.0, 20.0, 30.0, -5.0, 60.0, 40.0, 40.0, 20.0, 20.0, 30.0, 120.0, 190.0, 110.0, 10.0, 150.0, 60.0, 60.0, 10.0, 40.0, 270.0, 90.0, 170.0, 80.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 310.0, 20.0, 30.0, 30.0, 80.0, 30.0, 10.0, -320.0, 170.0, 20.0, 0.0, 0.0, 20.0, 10.0, -50.0, 630.0, 290.0, 240.0, 190.0, 60.0, -60.0, -70.0, 190.0, 180.0, 90.0, 60.0, 260.0, 110.0, 100.0, -50.0, 20.0, 210.0, 420.0, 30.0, 210.0, 70.0, 40.0, 240.0, 70.0, 90.0, 160.0, 140.0, 80.0, 60.0, 200.0, 0.0, 0.0, 30.0, 90.0, 30.0, 40.0, 60.0, 30.0, 80.0, 520.0, 100.0, 310.0, -20.0, 20.0, 140.0, 100.0, 30.0, 30.0, 100.0, 130.0, 40.0, 80.0, 290.0, 140.0, 90.0, 220.0, 80.0, 80.0, 20.0, 10.0, 30.0, 160.0, 60.0, 120.0, 50.0, 80.0, 190.0, 180.0, 80.0, 10.0, 20.0, 60.0, 90.0, 220.0, 30.0, 30.0, 70.0, 160.0, 10.0, 20.0, 10.0, 40.0, 20.0, 50.0, 20.0, 310.0, 20.0, 60.0, 30.0, 85.0, 190.0, 210.0, 240.0, 70.0, 170.0, 110.0, 340.0, 220.0, 10.0, -50.0, 110.0, 220.0, 50.0, 100.0, 25.0, 0.0, 30.0, 180.0, 180.0, 0.0, 350.0, 50.0, 60.0, 40.0, 20.0, 80.0, 100.0, 20.0, 130.0, 410.0, 230.0, 35.0, 240.0, 60.0, 80.0, 90.0, 100.0, 80.0, 290.0, 40.0, 50.0, 70.0, 20.0, 20.0, 60.0, 10.0, 20.0, 180.0, 70.0, 20.0, 60.0, 160.0, 20.0, 40.0, 50.0, 20.0, 40.0, 20.0, 10.0, 360.0, 60.0, 40.0, 10.0, 50.0, 340.0, 170.0, 10.0, 110.0, 160.0, 70.0, 250.0, 40.0, 20.0, 10.0, 20.0, 40.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 70.0, 0.0, 10.0, 0.0, 70.0, -30.0, 70.0, 10.0, 100.0, 20.0, 150.0, 80.0, 50.0, 80.0, 100.0, -30.0, 300.0, 40.0, 150.0, 70.0, 130.0, 90.0, 170.0, 60.0, 190.0, 70.0, 30.0, 50.0, 40.0, 40.0, 40.0, 130.0, -40.0, 60.0, 90.0, 220.0, 50.0, 40.0, 150.0, 270.0, 80.0, 90.0, 150.0, -40.0, 10.0, -30.0, 10.0, -25.0, -25.0, 40.0, -60.0, 130.0, -10.0, 80.0, 20.0, 280.0, 130.0, 380.0, 140.0, 150.0, 140.0, 50.0, 10.0, 60.0, 80.0, 170.0, 300.0, 30.0, 10.0, 40.0, 60.0, 80.0, 30.0, 0.0, 390.0, 70.0, 60.0, 50.0, 80.0, 260.0, 50.0, 210.0, 30.0, 330.0, 90.0, 40.0, 80.0, 180.0, 130.0, -105.0, 50.0, 490.0, 170.0, 40.0, 210.0, 510.0, 70.0, 100.0, -40.0, 60.0, 30.0, 100.0, 70.0, 90.0, 50.0, 40.0, 80.0, 20.0, 110.0, 10.0, 40.0, 80.0, 180.0, 190.0, 40.0, 100.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 230.0, 90.0, 220.0, 200.0, 30.0, 0.0, 10.0, 100.0, 20.0, 30.0, 170.0, 50.0, 110.0, 40.0, 350.0, 10.0, 70.0, 30.0, 40.0, 80.0, 20.0, 390.0, 160.0, 270.0, 170.0, 70.0, 110.0, -80.0, 90.0, 100.0, 320.0, 30.0, 0.0, 170.0, 20.0, 200.0, 10.0, 70.0, 210.0, 20.0, 80.0, 40.0, 0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0, 20.0, 90.0, 40.0, 10.0, 10.0, 0.0, 20.0, 60.0, 0.0, 200.0, 30.0, -10.0, 160.0, 260.0, 150.0, 80.0, 60.0, 10.0, 80.0, 180.0, 30.0, 20.0, 380.0, 80.0, 20.0, 85.0, 20.0, 20.0, 10.0, 20.0, -50.0, 90.0, 60.0, 80.0, 60.0, 40.0, 0.0, 80.0, 200.0, 380.0, 110.0, -60.0, 150.0, 40.0, 40.0, 90.0, 620.0, 70.0, 20.0, 330.0, 40.0, 10.0, 340.0, 80.0, 100.0, 10.0, 20.0, 120.0, 350.0, 180.0, 180.0, 30.0, 50.0, 80.0, 50.0, 30.0, 220.0, 20.0, 45.0, 20.0, 40.0, 100.0, 60.0, 180.0, 30.0, 90.0, 130.0, 130.0, 40.0, 40.0, 70.0, 80.0, 80.0, 200.0, 30.0, 130.0, 190.0, 360.0, 50.0, 230.0, 70.0, 30.0, 50.0, 50.0, 50.0, 0.0, 85.0, 30.0, 10.0, 20.0, 240.0, 190.0, 150.0, 40.0, 170.0, 90.0, 50.0, 70.0, 20.0, 100.0, 190.0, 340.0, 90.0, 110.0, 310.0, 80.0, 40.0, 70.0, 40.0, 30.0, 55.0, -20.0, 410.0, 50.0, 130.0, 110.0, 80.0, 170.0, 50.0, 190.0, 100.0, 80.0, 60.0, 110.0, 310.0, 45.0, 20.0, 60.0, 150.0, 30.0, 50.0, 150.0, 70.0, 150.0, -50.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 40.0, 20.0, 130.0, 230.0, 300.0, 30.0, 10.0, 130.0, 150.0, 80.0, 50.0, 170.0, 60.0, 180.0, 190.0, 70.0, 200.0, 210.0, 40.0, -20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0, 80.0, 40.0, 0.0, 80.0, 120.0, 30.0, 110.0, 20.0, 20.0, 40.0, 100.0, 120.0, 60.0, 30.0, 110.0, 300.0, 50.0, 130.0, -25.0, 230.0, 110.0, 50.0, 100.0, 180.0, 30.0, 70.0, 90.0, 30.0, 40.0, 60.0, 150.0, 80.0, -40.0, 120.0, 110.0, 290.0, 370.0, 100.0, 140.0, 240.0, 120.0, 80.0, 210.0, 40.0, 130.0, 260.0, 70.0, 170.0, 20.0, 100.0, 20.0, 80.0, 80.0, 0.0, 150.0, 20.0, 290.0, 0.0, 30.0, 50.0, 20.0, 70.0, 160.0, 70.0, 360.0, 50.0, 120.0, 530.0, -10.0, 440.0, 210.0, 100.0, 190.0, 640.0, 115.0, 170.0, 100.0, -50.0, -110.0, 50.0, 130.0, 30.0, 0.0, 100.0, 0.0, 15.0, -30.0, 300.0, 180.0, 300.0, 30.0, 40.0, 10.0, 170.0, 20.0, 60.0, 20.0, 80.0, 210.0, 300.0, 20.0, 240.0, 0.0, 20.0, 190.0, 40.0, 370.0, 40.0, 80.0, 70.0, 60.0, 215.0, 120.0, 480.0, 320.0, 130.0, 50.0, 180.0, 120.0, 120.0, 80.0, 60.0, 30.0, 50.0, 610.0, 80.0, -50.0, 40.0, 70.0, 60.0, 110.0, 110.0, 180.0, 90.0, 240.0, 110.0, 150.0, 110.0, 180.0, 100.0, 190.0, 20.0, 70.0, 50.0, 20.0, 310.0, 0.0, 30.0, 60.0, 60.0, 60.0, 90.0, 40.0, 370.0, 90.0, 160.0, 60.0, 80.0, 20.0, 30.0, 70.0, 40.0, 30.0, 60.0, 190.0, 20.0, 40.0, 110.0, -20.0, 240.0, 150.0, 10.0, 0.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 340.0, 80.0, 160.0, 80.0, 170.0, 200.0, 190.0, 70.0, 50.0, 50.0, 210.0, 30.0, 220.0, 90.0, 360.0, 120.0, 150.0, 90.0, 50.0, -5.0, 0.0, 40.0, 50.0, 30.0, 80.0, 50.0, 70.0, 40.0, 110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0, 60.0, 170.0, 20.0, 110.0, 90.0, 250.0, 280.0, 60.0, 250.0, 120.0, 150.0, 300.0, 80.0, 280.0, 300.0, 150.0, 50.0, 90.0, 50.0, 160.0, 270.0, 170.0, 70.0, 30.0, 70.0, 70.0, 145.0, 80.0, 100.0, 40.0, 110.0, 50.0, 80.0, 360.0, 0.0, 450.0, 40.0, 60.0, 140.0, 320.0, 160.0, 0.0, 30.0, 40.0, 60.0, 80.0, 30.0, 0.0, 0.0, 0.0, 120.0, 80.0, 280.0, 10.0, 0.0, 70.0, 30.0, 140.0, 160.0, 70.0, 60.0, 70.0, 110.0, -20.0, 140.0, 100.0, 110.0, 350.0, 30.0, 530.0, 25.0, 90.0, 10.0, 340.0, 290.0, 40.0, 120.0, 90.0, 0.0, 70.0, 380.0, 0.0, 30.0, 190.0, 110.0, 0.0, 5.0, 320.0, 190.0, 170.0, 20.0, 10.0, 80.0, 80.0, -20.0, 190.0, -40.0, 690.0, 20.0, -60.0, 170.0, 180.0, 60.0, 90.0, 10.0, 50.0, 20.0, -20.0, 250.0, 30.0, 20.0, 200.0, 10.0, 80.0, 240.0, 80.0, 40.0, 40.0, 10.0, 10.0, 70.0, 130.0, 220.0, 70.0, 190.0, 50.0, 0.0, 340.0, 180.0, 0.0, 0.0, 65.0, 210.0, 110.0, -25.0, 60.0, 40.0, 180.0, 60.0, 300.0, 170.0, 110.0, 270.0, 70.0, 80.0, 0.0, 120.0, 60.0, 10.0, 140.0, 70.0, 90.0, 100.0, 150.0, 190.0, 60.0, 290.0, 60.0, 120.0, 110.0, 60.0, 20.0, 50.0, 20.0, 120.0, 330.0, 10.0, 20.0, 30.0, 70.0, 70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5354254774249438, "mean_inference_ms": 1.4112800370701246, "mean_action_processing_ms": 0.45752004227397364, "mean_env_wait_ms": 1.2481636569712478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01261281967163086, "StateBufferConnector_ms": 0.009827852249145508, "ViewRequirementAgentConnector_ms": 0.3749542236328125}, "num_episodes": 18, "episode_return_max": 1810.0, "episode_return_min": 20.0, "episode_return_mean": 977.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.314683283593425, "num_env_steps_trained_throughput_per_sec": 21.314683283593425, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 186831.218, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186831.153, "sample_time_ms": 2578.902, "learn_time_ms": 184231.185, "learn_throughput": 21.712, "synch_weights_time_ms": 10.495}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "33e63_00000", "date": "2024-06-19_01-48-32", "timestamp": 1718776112, "time_this_iter_s": 187.67191982269287, "time_total_s": 16893.881973028183, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16893.881973028183, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 16.766792452830188, "ram_util_percent": 80.62301886792453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.229420470753417, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.170586287556365, "policy_loss": -0.008215969306165383, "vf_loss": 7.1774058237370335, "vf_explained_var": 1.5998515077292346e-05, "kl": 0.006206320526366472, "entropy": 0.42556065391745174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 120.0, "episode_reward_mean": 1024.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 102.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 200.0, 600.0, 1080.0, 610.0, 1100.0, 120.0, 1360.0, 800.0, 1530.0, 1165.0, 1200.0, 800.0, 870.0, 830.0, 1140.0, 1240.0, 820.0, 370.0, 450.0, 1000.0, 685.0, 940.0, 1410.0, 1250.0, 725.0, 840.0, 1420.0, 395.0, 1120.0, 1300.0, 1225.0, 965.0, 570.0, 1120.0, 1250.0, 860.0, 540.0, 1105.0, 760.0, 1560.0, 1200.0, 720.0, 1810.0, 1415.0, 1025.0, 940.0, 1070.0, 1795.0, 1030.0, 1380.0, 810.0, 1000.0, 780.0, 290.0, 1370.0, 1370.0, 405.0, 1090.0, 1410.0, 1610.0, 1045.0, 1610.0, 400.0, 960.0, 1480.0, 1075.0, 1395.0, 970.0, 840.0, 730.0, 1250.0, 1000.0, 1030.0, 1240.0, 730.0, 995.0, 1285.0, 1520.0, 1230.0, 1170.0, 1210.0, 845.0, 1530.0, 615.0, 1320.0, 1260.0, 1840.0, 1370.0, 485.0, 1520.0, 1500.0, 660.0, 410.0, 1310.0, 330.0, 1120.0, 725.0, 670.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 250.0, 40.0, 20.0, 10.0, 20.0, 40.0, 50.0, 60.0, 60.0, 20.0, 10.0, 20.0, 20.0, 50.0, 0.0, 70.0, 0.0, 10.0, 0.0, 70.0, -30.0, 70.0, 10.0, 100.0, 20.0, 150.0, 80.0, 50.0, 80.0, 100.0, -30.0, 300.0, 40.0, 150.0, 70.0, 130.0, 90.0, 170.0, 60.0, 190.0, 70.0, 30.0, 50.0, 40.0, 40.0, 40.0, 130.0, -40.0, 60.0, 90.0, 220.0, 50.0, 40.0, 150.0, 270.0, 80.0, 90.0, 150.0, -40.0, 10.0, -30.0, 10.0, -25.0, -25.0, 40.0, -60.0, 130.0, -10.0, 80.0, 20.0, 280.0, 130.0, 380.0, 140.0, 150.0, 140.0, 50.0, 10.0, 60.0, 80.0, 170.0, 300.0, 30.0, 10.0, 40.0, 60.0, 80.0, 30.0, 0.0, 390.0, 70.0, 60.0, 50.0, 80.0, 260.0, 50.0, 210.0, 30.0, 330.0, 90.0, 40.0, 80.0, 180.0, 130.0, -105.0, 50.0, 490.0, 170.0, 40.0, 210.0, 510.0, 70.0, 100.0, -40.0, 60.0, 30.0, 100.0, 70.0, 90.0, 50.0, 40.0, 80.0, 20.0, 110.0, 10.0, 40.0, 80.0, 180.0, 190.0, 40.0, 100.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 230.0, 90.0, 220.0, 200.0, 30.0, 0.0, 10.0, 100.0, 20.0, 30.0, 170.0, 50.0, 110.0, 40.0, 350.0, 10.0, 70.0, 30.0, 40.0, 80.0, 20.0, 390.0, 160.0, 270.0, 170.0, 70.0, 110.0, -80.0, 90.0, 100.0, 320.0, 30.0, 0.0, 170.0, 20.0, 200.0, 10.0, 70.0, 210.0, 20.0, 80.0, 40.0, 0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0, 20.0, 90.0, 40.0, 10.0, 10.0, 0.0, 20.0, 60.0, 0.0, 200.0, 30.0, -10.0, 160.0, 260.0, 150.0, 80.0, 60.0, 10.0, 80.0, 180.0, 30.0, 20.0, 380.0, 80.0, 20.0, 85.0, 20.0, 20.0, 10.0, 20.0, -50.0, 90.0, 60.0, 80.0, 60.0, 40.0, 0.0, 80.0, 200.0, 380.0, 110.0, -60.0, 150.0, 40.0, 40.0, 90.0, 620.0, 70.0, 20.0, 330.0, 40.0, 10.0, 340.0, 80.0, 100.0, 10.0, 20.0, 120.0, 350.0, 180.0, 180.0, 30.0, 50.0, 80.0, 50.0, 30.0, 220.0, 20.0, 45.0, 20.0, 40.0, 100.0, 60.0, 180.0, 30.0, 90.0, 130.0, 130.0, 40.0, 40.0, 70.0, 80.0, 80.0, 200.0, 30.0, 130.0, 190.0, 360.0, 50.0, 230.0, 70.0, 30.0, 50.0, 50.0, 50.0, 0.0, 85.0, 30.0, 10.0, 20.0, 240.0, 190.0, 150.0, 40.0, 170.0, 90.0, 50.0, 70.0, 20.0, 100.0, 190.0, 340.0, 90.0, 110.0, 310.0, 80.0, 40.0, 70.0, 40.0, 30.0, 55.0, -20.0, 410.0, 50.0, 130.0, 110.0, 80.0, 170.0, 50.0, 190.0, 100.0, 80.0, 60.0, 110.0, 310.0, 45.0, 20.0, 60.0, 150.0, 30.0, 50.0, 150.0, 70.0, 150.0, -50.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 40.0, 20.0, 130.0, 230.0, 300.0, 30.0, 10.0, 130.0, 150.0, 80.0, 50.0, 170.0, 60.0, 180.0, 190.0, 70.0, 200.0, 210.0, 40.0, -20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0, 80.0, 40.0, 0.0, 80.0, 120.0, 30.0, 110.0, 20.0, 20.0, 40.0, 100.0, 120.0, 60.0, 30.0, 110.0, 300.0, 50.0, 130.0, -25.0, 230.0, 110.0, 50.0, 100.0, 180.0, 30.0, 70.0, 90.0, 30.0, 40.0, 60.0, 150.0, 80.0, -40.0, 120.0, 110.0, 290.0, 370.0, 100.0, 140.0, 240.0, 120.0, 80.0, 210.0, 40.0, 130.0, 260.0, 70.0, 170.0, 20.0, 100.0, 20.0, 80.0, 80.0, 0.0, 150.0, 20.0, 290.0, 0.0, 30.0, 50.0, 20.0, 70.0, 160.0, 70.0, 360.0, 50.0, 120.0, 530.0, -10.0, 440.0, 210.0, 100.0, 190.0, 640.0, 115.0, 170.0, 100.0, -50.0, -110.0, 50.0, 130.0, 30.0, 0.0, 100.0, 0.0, 15.0, -30.0, 300.0, 180.0, 300.0, 30.0, 40.0, 10.0, 170.0, 20.0, 60.0, 20.0, 80.0, 210.0, 300.0, 20.0, 240.0, 0.0, 20.0, 190.0, 40.0, 370.0, 40.0, 80.0, 70.0, 60.0, 215.0, 120.0, 480.0, 320.0, 130.0, 50.0, 180.0, 120.0, 120.0, 80.0, 60.0, 30.0, 50.0, 610.0, 80.0, -50.0, 40.0, 70.0, 60.0, 110.0, 110.0, 180.0, 90.0, 240.0, 110.0, 150.0, 110.0, 180.0, 100.0, 190.0, 20.0, 70.0, 50.0, 20.0, 310.0, 0.0, 30.0, 60.0, 60.0, 60.0, 90.0, 40.0, 370.0, 90.0, 160.0, 60.0, 80.0, 20.0, 30.0, 70.0, 40.0, 30.0, 60.0, 190.0, 20.0, 40.0, 110.0, -20.0, 240.0, 150.0, 10.0, 0.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 340.0, 80.0, 160.0, 80.0, 170.0, 200.0, 190.0, 70.0, 50.0, 50.0, 210.0, 30.0, 220.0, 90.0, 360.0, 120.0, 150.0, 90.0, 50.0, -5.0, 0.0, 40.0, 50.0, 30.0, 80.0, 50.0, 70.0, 40.0, 110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0, 60.0, 170.0, 20.0, 110.0, 90.0, 250.0, 280.0, 60.0, 250.0, 120.0, 150.0, 300.0, 80.0, 280.0, 300.0, 150.0, 50.0, 90.0, 50.0, 160.0, 270.0, 170.0, 70.0, 30.0, 70.0, 70.0, 145.0, 80.0, 100.0, 40.0, 110.0, 50.0, 80.0, 360.0, 0.0, 450.0, 40.0, 60.0, 140.0, 320.0, 160.0, 0.0, 30.0, 40.0, 60.0, 80.0, 30.0, 0.0, 0.0, 0.0, 120.0, 80.0, 280.0, 10.0, 0.0, 70.0, 30.0, 140.0, 160.0, 70.0, 60.0, 70.0, 110.0, -20.0, 140.0, 100.0, 110.0, 350.0, 30.0, 530.0, 25.0, 90.0, 10.0, 340.0, 290.0, 40.0, 120.0, 90.0, 0.0, 70.0, 380.0, 0.0, 30.0, 190.0, 110.0, 0.0, 5.0, 320.0, 190.0, 170.0, 20.0, 10.0, 80.0, 80.0, -20.0, 190.0, -40.0, 690.0, 20.0, -60.0, 170.0, 180.0, 60.0, 90.0, 10.0, 50.0, 20.0, -20.0, 250.0, 30.0, 20.0, 200.0, 10.0, 80.0, 240.0, 80.0, 40.0, 40.0, 10.0, 10.0, 70.0, 130.0, 220.0, 70.0, 190.0, 50.0, 0.0, 340.0, 180.0, 0.0, 0.0, 65.0, 210.0, 110.0, -25.0, 60.0, 40.0, 180.0, 60.0, 300.0, 170.0, 110.0, 270.0, 70.0, 80.0, 0.0, 120.0, 60.0, 10.0, 140.0, 70.0, 90.0, 100.0, 150.0, 190.0, 60.0, 290.0, 60.0, 120.0, 110.0, 60.0, 20.0, 50.0, 20.0, 120.0, 330.0, 10.0, 20.0, 30.0, 70.0, 70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0, 120.0, 70.0, 190.0, 330.0, -25.0, 80.0, 170.0, 60.0, 50.0, 240.0, 610.0, 40.0, -20.0, 310.0, 120.0, 30.0, 130.0, 60.0, 40.0, 200.0, 90.0, 180.0, -20.0, 110.0, 60.0, 30.0, 420.0, 30.0, 220.0, 110.0, 60.0, 230.0, 190.0, 150.0, -40.0, 160.0, 20.0, 70.0, 180.0, 150.0, 80.0, 100.0, 0.0, 190.0, 90.0, 90.0, 210.0, 250.0, 30.0, 170.0, 40.0, 120.0, 20.0, 15.0, 310.0, 0.0, 170.0, 90.0, 90.0, -10.0, 80.0, 100.0, 40.0, 160.0, 180.0, 450.0, 130.0, 110.0, -30.0, 310.0, -85.0, 40.0, 40.0, 80.0, 20.0, 100.0, 60.0, 0.0, 290.0, 70.0, 260.0, 130.0, 110.0, 130.0, 30.0, 50.0, 80.0, 220.0, 210.0, 100.0, 300.0, 100.0, 30.0, 390.0, -10.0, 150.0, 90.0, 60.0, 70.0, 80.0, 120.0, 100.0, 360.0, 100.0, 80.0, 130.0, 220.0, 300.0, 170.0, 260.0, 120.0, 180.0, 190.0, 60.0, 510.0, 80.0, 50.0, 20.0, 130.0, 30.0, 20.0, 30.0, 20.0, 50.0, 30.0, 30.0, 130.0, -15.0, 150.0, 40.0, 50.0, 550.0, 0.0, 290.0, 100.0, 90.0, 70.0, 100.0, 60.0, 210.0, 260.0, 400.0, 0.0, 90.0, 330.0, 170.0, 80.0, 20.0, 160.0, -10.0, 30.0, 170.0, 60.0, 30.0, 0.0, 0.0, 20.0, 40.0, 190.0, 120.0, 20.0, -30.0, 20.0, 40.0, 30.0, 30.0, 10.0, 90.0, 40.0, 160.0, 440.0, 200.0, 70.0, 90.0, 40.0, 220.0, 0.0, 160.0, 50.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 50.0, 70.0, 0.0, 90.0, 40.0, 140.0, 210.0, 50.0, 120.0, 40.0, 40.0, 90.0, 60.0, 330.0, 190.0, 10.0, 30.0, 20.0, 40.0, 25.0, 250.0, 80.0, 80.0, 0.0, 80.0, 20.0, 0.0, 200.0, 40.0, 220.0, 30.0, 40.0, 90.0, -50.0, 40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5353797961703288, "mean_inference_ms": 1.410289111167876, "mean_action_processing_ms": 0.4599581900993867, "mean_env_wait_ms": 1.2479679960892818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012300729751586914, "StateBufferConnector_ms": 0.009558677673339844, "ViewRequirementAgentConnector_ms": 0.3776233196258545}, "num_episodes": 23, "episode_return_max": 1840.0, "episode_return_min": 120.0, "episode_return_mean": 1024.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.37358946524435, "num_env_steps_trained_throughput_per_sec": 21.37358946524435, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 187024.985, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187024.92, "sample_time_ms": 2592.523, "learn_time_ms": 184411.517, "learn_throughput": 21.691, "synch_weights_time_ms": 10.295}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "33e63_00000", "date": "2024-06-19_01-51-39", "timestamp": 1718776299, "time_this_iter_s": 187.15559816360474, "time_total_s": 17081.037571191788, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276f5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17081.037571191788, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 16.465530303030306, "ram_util_percent": 79.5026515151515}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5563623824566446, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009096525738083215, "vf_loss": 7.452905864380419, "vf_explained_var": 0.0015843345524784857, "kl": Infinity, "entropy": 0.3802484083877077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 290.0, "episode_reward_mean": 1055.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 105.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 450.0, 1000.0, 685.0, 940.0, 1410.0, 1250.0, 725.0, 840.0, 1420.0, 395.0, 1120.0, 1300.0, 1225.0, 965.0, 570.0, 1120.0, 1250.0, 860.0, 540.0, 1105.0, 760.0, 1560.0, 1200.0, 720.0, 1810.0, 1415.0, 1025.0, 940.0, 1070.0, 1795.0, 1030.0, 1380.0, 810.0, 1000.0, 780.0, 290.0, 1370.0, 1370.0, 405.0, 1090.0, 1410.0, 1610.0, 1045.0, 1610.0, 400.0, 960.0, 1480.0, 1075.0, 1395.0, 970.0, 840.0, 730.0, 1250.0, 1000.0, 1030.0, 1240.0, 730.0, 995.0, 1285.0, 1520.0, 1230.0, 1170.0, 1210.0, 845.0, 1530.0, 615.0, 1320.0, 1260.0, 1840.0, 1370.0, 485.0, 1520.0, 1500.0, 660.0, 410.0, 1310.0, 330.0, 1120.0, 725.0, 670.0, 1260.0, 810.0, 470.0, 1200.0, 925.0, 1205.0, 760.0, 845.0, 1430.0, 1320.0, 1650.0, 1005.0, 820.0, 1390.0, 1095.0, 1335.0, 610.0, 1020.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 50.0, 10.0, 60.0, 30.0, 20.0, 10.0, 130.0, 10.0, 50.0, 20.0, 90.0, 40.0, 10.0, 10.0, 0.0, 20.0, 60.0, 0.0, 200.0, 30.0, -10.0, 160.0, 260.0, 150.0, 80.0, 60.0, 10.0, 80.0, 180.0, 30.0, 20.0, 380.0, 80.0, 20.0, 85.0, 20.0, 20.0, 10.0, 20.0, -50.0, 90.0, 60.0, 80.0, 60.0, 40.0, 0.0, 80.0, 200.0, 380.0, 110.0, -60.0, 150.0, 40.0, 40.0, 90.0, 620.0, 70.0, 20.0, 330.0, 40.0, 10.0, 340.0, 80.0, 100.0, 10.0, 20.0, 120.0, 350.0, 180.0, 180.0, 30.0, 50.0, 80.0, 50.0, 30.0, 220.0, 20.0, 45.0, 20.0, 40.0, 100.0, 60.0, 180.0, 30.0, 90.0, 130.0, 130.0, 40.0, 40.0, 70.0, 80.0, 80.0, 200.0, 30.0, 130.0, 190.0, 360.0, 50.0, 230.0, 70.0, 30.0, 50.0, 50.0, 50.0, 0.0, 85.0, 30.0, 10.0, 20.0, 240.0, 190.0, 150.0, 40.0, 170.0, 90.0, 50.0, 70.0, 20.0, 100.0, 190.0, 340.0, 90.0, 110.0, 310.0, 80.0, 40.0, 70.0, 40.0, 30.0, 55.0, -20.0, 410.0, 50.0, 130.0, 110.0, 80.0, 170.0, 50.0, 190.0, 100.0, 80.0, 60.0, 110.0, 310.0, 45.0, 20.0, 60.0, 150.0, 30.0, 50.0, 150.0, 70.0, 150.0, -50.0, 30.0, 50.0, 50.0, 30.0, 40.0, 80.0, 40.0, 20.0, 130.0, 230.0, 300.0, 30.0, 10.0, 130.0, 150.0, 80.0, 50.0, 170.0, 60.0, 180.0, 190.0, 70.0, 200.0, 210.0, 40.0, -20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0, 80.0, 40.0, 0.0, 80.0, 120.0, 30.0, 110.0, 20.0, 20.0, 40.0, 100.0, 120.0, 60.0, 30.0, 110.0, 300.0, 50.0, 130.0, -25.0, 230.0, 110.0, 50.0, 100.0, 180.0, 30.0, 70.0, 90.0, 30.0, 40.0, 60.0, 150.0, 80.0, -40.0, 120.0, 110.0, 290.0, 370.0, 100.0, 140.0, 240.0, 120.0, 80.0, 210.0, 40.0, 130.0, 260.0, 70.0, 170.0, 20.0, 100.0, 20.0, 80.0, 80.0, 0.0, 150.0, 20.0, 290.0, 0.0, 30.0, 50.0, 20.0, 70.0, 160.0, 70.0, 360.0, 50.0, 120.0, 530.0, -10.0, 440.0, 210.0, 100.0, 190.0, 640.0, 115.0, 170.0, 100.0, -50.0, -110.0, 50.0, 130.0, 30.0, 0.0, 100.0, 0.0, 15.0, -30.0, 300.0, 180.0, 300.0, 30.0, 40.0, 10.0, 170.0, 20.0, 60.0, 20.0, 80.0, 210.0, 300.0, 20.0, 240.0, 0.0, 20.0, 190.0, 40.0, 370.0, 40.0, 80.0, 70.0, 60.0, 215.0, 120.0, 480.0, 320.0, 130.0, 50.0, 180.0, 120.0, 120.0, 80.0, 60.0, 30.0, 50.0, 610.0, 80.0, -50.0, 40.0, 70.0, 60.0, 110.0, 110.0, 180.0, 90.0, 240.0, 110.0, 150.0, 110.0, 180.0, 100.0, 190.0, 20.0, 70.0, 50.0, 20.0, 310.0, 0.0, 30.0, 60.0, 60.0, 60.0, 90.0, 40.0, 370.0, 90.0, 160.0, 60.0, 80.0, 20.0, 30.0, 70.0, 40.0, 30.0, 60.0, 190.0, 20.0, 40.0, 110.0, -20.0, 240.0, 150.0, 10.0, 0.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 340.0, 80.0, 160.0, 80.0, 170.0, 200.0, 190.0, 70.0, 50.0, 50.0, 210.0, 30.0, 220.0, 90.0, 360.0, 120.0, 150.0, 90.0, 50.0, -5.0, 0.0, 40.0, 50.0, 30.0, 80.0, 50.0, 70.0, 40.0, 110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0, 60.0, 170.0, 20.0, 110.0, 90.0, 250.0, 280.0, 60.0, 250.0, 120.0, 150.0, 300.0, 80.0, 280.0, 300.0, 150.0, 50.0, 90.0, 50.0, 160.0, 270.0, 170.0, 70.0, 30.0, 70.0, 70.0, 145.0, 80.0, 100.0, 40.0, 110.0, 50.0, 80.0, 360.0, 0.0, 450.0, 40.0, 60.0, 140.0, 320.0, 160.0, 0.0, 30.0, 40.0, 60.0, 80.0, 30.0, 0.0, 0.0, 0.0, 120.0, 80.0, 280.0, 10.0, 0.0, 70.0, 30.0, 140.0, 160.0, 70.0, 60.0, 70.0, 110.0, -20.0, 140.0, 100.0, 110.0, 350.0, 30.0, 530.0, 25.0, 90.0, 10.0, 340.0, 290.0, 40.0, 120.0, 90.0, 0.0, 70.0, 380.0, 0.0, 30.0, 190.0, 110.0, 0.0, 5.0, 320.0, 190.0, 170.0, 20.0, 10.0, 80.0, 80.0, -20.0, 190.0, -40.0, 690.0, 20.0, -60.0, 170.0, 180.0, 60.0, 90.0, 10.0, 50.0, 20.0, -20.0, 250.0, 30.0, 20.0, 200.0, 10.0, 80.0, 240.0, 80.0, 40.0, 40.0, 10.0, 10.0, 70.0, 130.0, 220.0, 70.0, 190.0, 50.0, 0.0, 340.0, 180.0, 0.0, 0.0, 65.0, 210.0, 110.0, -25.0, 60.0, 40.0, 180.0, 60.0, 300.0, 170.0, 110.0, 270.0, 70.0, 80.0, 0.0, 120.0, 60.0, 10.0, 140.0, 70.0, 90.0, 100.0, 150.0, 190.0, 60.0, 290.0, 60.0, 120.0, 110.0, 60.0, 20.0, 50.0, 20.0, 120.0, 330.0, 10.0, 20.0, 30.0, 70.0, 70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0, 120.0, 70.0, 190.0, 330.0, -25.0, 80.0, 170.0, 60.0, 50.0, 240.0, 610.0, 40.0, -20.0, 310.0, 120.0, 30.0, 130.0, 60.0, 40.0, 200.0, 90.0, 180.0, -20.0, 110.0, 60.0, 30.0, 420.0, 30.0, 220.0, 110.0, 60.0, 230.0, 190.0, 150.0, -40.0, 160.0, 20.0, 70.0, 180.0, 150.0, 80.0, 100.0, 0.0, 190.0, 90.0, 90.0, 210.0, 250.0, 30.0, 170.0, 40.0, 120.0, 20.0, 15.0, 310.0, 0.0, 170.0, 90.0, 90.0, -10.0, 80.0, 100.0, 40.0, 160.0, 180.0, 450.0, 130.0, 110.0, -30.0, 310.0, -85.0, 40.0, 40.0, 80.0, 20.0, 100.0, 60.0, 0.0, 290.0, 70.0, 260.0, 130.0, 110.0, 130.0, 30.0, 50.0, 80.0, 220.0, 210.0, 100.0, 300.0, 100.0, 30.0, 390.0, -10.0, 150.0, 90.0, 60.0, 70.0, 80.0, 120.0, 100.0, 360.0, 100.0, 80.0, 130.0, 220.0, 300.0, 170.0, 260.0, 120.0, 180.0, 190.0, 60.0, 510.0, 80.0, 50.0, 20.0, 130.0, 30.0, 20.0, 30.0, 20.0, 50.0, 30.0, 30.0, 130.0, -15.0, 150.0, 40.0, 50.0, 550.0, 0.0, 290.0, 100.0, 90.0, 70.0, 100.0, 60.0, 210.0, 260.0, 400.0, 0.0, 90.0, 330.0, 170.0, 80.0, 20.0, 160.0, -10.0, 30.0, 170.0, 60.0, 30.0, 0.0, 0.0, 20.0, 40.0, 190.0, 120.0, 20.0, -30.0, 20.0, 40.0, 30.0, 30.0, 10.0, 90.0, 40.0, 160.0, 440.0, 200.0, 70.0, 90.0, 40.0, 220.0, 0.0, 160.0, 50.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 50.0, 70.0, 0.0, 90.0, 40.0, 140.0, 210.0, 50.0, 120.0, 40.0, 40.0, 90.0, 60.0, 330.0, 190.0, 10.0, 30.0, 20.0, 40.0, 25.0, 250.0, 80.0, 80.0, 0.0, 80.0, 20.0, 0.0, 200.0, 40.0, 220.0, 30.0, 40.0, 90.0, -50.0, 40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0, 20.0, 30.0, 80.0, 80.0, 40.0, 30.0, 100.0, 90.0, 30.0, 310.0, 40.0, -20.0, 30.0, 30.0, 40.0, 50.0, 40.0, 40.0, 130.0, 90.0, 190.0, 10.0, 90.0, 290.0, 260.0, 80.0, 60.0, 40.0, 140.0, 40.0, 50.0, 250.0, 180.0, 160.0, 70.0, 20.0, 150.0, 40.0, -15.0, 20.0, 40.0, 150.0, -100.0, 70.0, 80.0, -20.0, 60.0, 25.0, 200.0, 700.0, 60.0, 160.0, 50.0, 30.0, 0.0, 10.0, 10.0, 50.0, 280.0, 110.0, 10.0, 60.0, 25.0, 10.0, 70.0, 50.0, 120.0, 160.0, 320.0, 20.0, 170.0, 70.0, -20.0, 180.0, 170.0, 350.0, 160.0, 70.0, 240.0, 40.0, 170.0, 290.0, 30.0, 20.0, 80.0, 150.0, 90.0, 300.0, 160.0, 30.0, 530.0, 280.0, 30.0, 10.0, 10.0, 0.0, 230.0, 200.0, 20.0, 340.0, 0.0, 30.0, 100.0, 120.0, 60.0, 0.0, 65.0, 270.0, 360.0, 0.0, -50.0, 50.0, 300.0, 10.0, 40.0, 40.0, -50.0, 420.0, 30.0, 30.0, 100.0, 180.0, 230.0, 310.0, 90.0, 200.0, 150.0, 20.0, 60.0, 50.0, 50.0, 280.0, 160.0, 110.0, 215.0, 90.0, 80.0, 30.0, 20.0, 60.0, 10.0, 170.0, 350.0, 120.0, -50.0, 180.0, 30.0, 180.0, 20.0, 325.0, 30.0, 40.0, 20.0, 40.0, 20.0, 210.0, 40.0, 0.0, 190.0, 20.0, 70.0, 90.0, 50.0, 160.0, 30.0, 320.0, 20.0, 30.0, 40.0, 210.0, 330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.534312162858407, "mean_inference_ms": 1.41138742783157, "mean_action_processing_ms": 0.46049077027796104, "mean_env_wait_ms": 1.2475481109902864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011624574661254883, "StateBufferConnector_ms": 0.009002923965454102, "ViewRequirementAgentConnector_ms": 0.37056684494018555}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 290.0, "episode_return_mean": 1055.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.510098255958635, "num_env_steps_trained_throughput_per_sec": 21.510098255958635, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 187176.092, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187176.027, "sample_time_ms": 2617.985, "learn_time_ms": 184536.86, "learn_throughput": 21.676, "synch_weights_time_ms": 10.668}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "33e63_00000", "date": "2024-06-19_01-54-45", "timestamp": 1718776485, "time_this_iter_s": 185.96771621704102, "time_total_s": 17267.00528740883, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32771d4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17267.00528740883, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 16.561596958174906, "ram_util_percent": 78.9851711026616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5323311471901, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.652059335119554, "policy_loss": -0.00782050251101835, "vf_loss": 6.6581775175242885, "vf_explained_var": 0.0024363799661366197, "kl": 0.005043912811082818, "entropy": 0.43105034948157045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 210.0, "episode_reward_mean": 1039.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 103.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 540.0, 1105.0, 760.0, 1560.0, 1200.0, 720.0, 1810.0, 1415.0, 1025.0, 940.0, 1070.0, 1795.0, 1030.0, 1380.0, 810.0, 1000.0, 780.0, 290.0, 1370.0, 1370.0, 405.0, 1090.0, 1410.0, 1610.0, 1045.0, 1610.0, 400.0, 960.0, 1480.0, 1075.0, 1395.0, 970.0, 840.0, 730.0, 1250.0, 1000.0, 1030.0, 1240.0, 730.0, 995.0, 1285.0, 1520.0, 1230.0, 1170.0, 1210.0, 845.0, 1530.0, 615.0, 1320.0, 1260.0, 1840.0, 1370.0, 485.0, 1520.0, 1500.0, 660.0, 410.0, 1310.0, 330.0, 1120.0, 725.0, 670.0, 1260.0, 810.0, 470.0, 1200.0, 925.0, 1205.0, 760.0, 845.0, 1430.0, 1320.0, 1650.0, 1005.0, 820.0, 1390.0, 1095.0, 1335.0, 610.0, 1020.0, 1310.0, 1630.0, 940.0, 645.0, 1320.0, 630.0, 1485.0, 845.0, 810.0, 905.0, 1380.0, 375.0, 695.0, 610.0, 880.0, 680.0, 210.0, 1120.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-20.0, 40.0, 50.0, 60.0, 180.0, 0.0, 40.0, 310.0, 40.0, 160.0, 80.0, 40.0, 0.0, 80.0, 120.0, 30.0, 110.0, 20.0, 20.0, 40.0, 100.0, 120.0, 60.0, 30.0, 110.0, 300.0, 50.0, 130.0, -25.0, 230.0, 110.0, 50.0, 100.0, 180.0, 30.0, 70.0, 90.0, 30.0, 40.0, 60.0, 150.0, 80.0, -40.0, 120.0, 110.0, 290.0, 370.0, 100.0, 140.0, 240.0, 120.0, 80.0, 210.0, 40.0, 130.0, 260.0, 70.0, 170.0, 20.0, 100.0, 20.0, 80.0, 80.0, 0.0, 150.0, 20.0, 290.0, 0.0, 30.0, 50.0, 20.0, 70.0, 160.0, 70.0, 360.0, 50.0, 120.0, 530.0, -10.0, 440.0, 210.0, 100.0, 190.0, 640.0, 115.0, 170.0, 100.0, -50.0, -110.0, 50.0, 130.0, 30.0, 0.0, 100.0, 0.0, 15.0, -30.0, 300.0, 180.0, 300.0, 30.0, 40.0, 10.0, 170.0, 20.0, 60.0, 20.0, 80.0, 210.0, 300.0, 20.0, 240.0, 0.0, 20.0, 190.0, 40.0, 370.0, 40.0, 80.0, 70.0, 60.0, 215.0, 120.0, 480.0, 320.0, 130.0, 50.0, 180.0, 120.0, 120.0, 80.0, 60.0, 30.0, 50.0, 610.0, 80.0, -50.0, 40.0, 70.0, 60.0, 110.0, 110.0, 180.0, 90.0, 240.0, 110.0, 150.0, 110.0, 180.0, 100.0, 190.0, 20.0, 70.0, 50.0, 20.0, 310.0, 0.0, 30.0, 60.0, 60.0, 60.0, 90.0, 40.0, 370.0, 90.0, 160.0, 60.0, 80.0, 20.0, 30.0, 70.0, 40.0, 30.0, 60.0, 190.0, 20.0, 40.0, 110.0, -20.0, 240.0, 150.0, 10.0, 0.0, 0.0, 0.0, 50.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 340.0, 80.0, 160.0, 80.0, 170.0, 200.0, 190.0, 70.0, 50.0, 50.0, 210.0, 30.0, 220.0, 90.0, 360.0, 120.0, 150.0, 90.0, 50.0, -5.0, 0.0, 40.0, 50.0, 30.0, 80.0, 50.0, 70.0, 40.0, 110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0, 60.0, 170.0, 20.0, 110.0, 90.0, 250.0, 280.0, 60.0, 250.0, 120.0, 150.0, 300.0, 80.0, 280.0, 300.0, 150.0, 50.0, 90.0, 50.0, 160.0, 270.0, 170.0, 70.0, 30.0, 70.0, 70.0, 145.0, 80.0, 100.0, 40.0, 110.0, 50.0, 80.0, 360.0, 0.0, 450.0, 40.0, 60.0, 140.0, 320.0, 160.0, 0.0, 30.0, 40.0, 60.0, 80.0, 30.0, 0.0, 0.0, 0.0, 120.0, 80.0, 280.0, 10.0, 0.0, 70.0, 30.0, 140.0, 160.0, 70.0, 60.0, 70.0, 110.0, -20.0, 140.0, 100.0, 110.0, 350.0, 30.0, 530.0, 25.0, 90.0, 10.0, 340.0, 290.0, 40.0, 120.0, 90.0, 0.0, 70.0, 380.0, 0.0, 30.0, 190.0, 110.0, 0.0, 5.0, 320.0, 190.0, 170.0, 20.0, 10.0, 80.0, 80.0, -20.0, 190.0, -40.0, 690.0, 20.0, -60.0, 170.0, 180.0, 60.0, 90.0, 10.0, 50.0, 20.0, -20.0, 250.0, 30.0, 20.0, 200.0, 10.0, 80.0, 240.0, 80.0, 40.0, 40.0, 10.0, 10.0, 70.0, 130.0, 220.0, 70.0, 190.0, 50.0, 0.0, 340.0, 180.0, 0.0, 0.0, 65.0, 210.0, 110.0, -25.0, 60.0, 40.0, 180.0, 60.0, 300.0, 170.0, 110.0, 270.0, 70.0, 80.0, 0.0, 120.0, 60.0, 10.0, 140.0, 70.0, 90.0, 100.0, 150.0, 190.0, 60.0, 290.0, 60.0, 120.0, 110.0, 60.0, 20.0, 50.0, 20.0, 120.0, 330.0, 10.0, 20.0, 30.0, 70.0, 70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0, 120.0, 70.0, 190.0, 330.0, -25.0, 80.0, 170.0, 60.0, 50.0, 240.0, 610.0, 40.0, -20.0, 310.0, 120.0, 30.0, 130.0, 60.0, 40.0, 200.0, 90.0, 180.0, -20.0, 110.0, 60.0, 30.0, 420.0, 30.0, 220.0, 110.0, 60.0, 230.0, 190.0, 150.0, -40.0, 160.0, 20.0, 70.0, 180.0, 150.0, 80.0, 100.0, 0.0, 190.0, 90.0, 90.0, 210.0, 250.0, 30.0, 170.0, 40.0, 120.0, 20.0, 15.0, 310.0, 0.0, 170.0, 90.0, 90.0, -10.0, 80.0, 100.0, 40.0, 160.0, 180.0, 450.0, 130.0, 110.0, -30.0, 310.0, -85.0, 40.0, 40.0, 80.0, 20.0, 100.0, 60.0, 0.0, 290.0, 70.0, 260.0, 130.0, 110.0, 130.0, 30.0, 50.0, 80.0, 220.0, 210.0, 100.0, 300.0, 100.0, 30.0, 390.0, -10.0, 150.0, 90.0, 60.0, 70.0, 80.0, 120.0, 100.0, 360.0, 100.0, 80.0, 130.0, 220.0, 300.0, 170.0, 260.0, 120.0, 180.0, 190.0, 60.0, 510.0, 80.0, 50.0, 20.0, 130.0, 30.0, 20.0, 30.0, 20.0, 50.0, 30.0, 30.0, 130.0, -15.0, 150.0, 40.0, 50.0, 550.0, 0.0, 290.0, 100.0, 90.0, 70.0, 100.0, 60.0, 210.0, 260.0, 400.0, 0.0, 90.0, 330.0, 170.0, 80.0, 20.0, 160.0, -10.0, 30.0, 170.0, 60.0, 30.0, 0.0, 0.0, 20.0, 40.0, 190.0, 120.0, 20.0, -30.0, 20.0, 40.0, 30.0, 30.0, 10.0, 90.0, 40.0, 160.0, 440.0, 200.0, 70.0, 90.0, 40.0, 220.0, 0.0, 160.0, 50.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 50.0, 70.0, 0.0, 90.0, 40.0, 140.0, 210.0, 50.0, 120.0, 40.0, 40.0, 90.0, 60.0, 330.0, 190.0, 10.0, 30.0, 20.0, 40.0, 25.0, 250.0, 80.0, 80.0, 0.0, 80.0, 20.0, 0.0, 200.0, 40.0, 220.0, 30.0, 40.0, 90.0, -50.0, 40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0, 20.0, 30.0, 80.0, 80.0, 40.0, 30.0, 100.0, 90.0, 30.0, 310.0, 40.0, -20.0, 30.0, 30.0, 40.0, 50.0, 40.0, 40.0, 130.0, 90.0, 190.0, 10.0, 90.0, 290.0, 260.0, 80.0, 60.0, 40.0, 140.0, 40.0, 50.0, 250.0, 180.0, 160.0, 70.0, 20.0, 150.0, 40.0, -15.0, 20.0, 40.0, 150.0, -100.0, 70.0, 80.0, -20.0, 60.0, 25.0, 200.0, 700.0, 60.0, 160.0, 50.0, 30.0, 0.0, 10.0, 10.0, 50.0, 280.0, 110.0, 10.0, 60.0, 25.0, 10.0, 70.0, 50.0, 120.0, 160.0, 320.0, 20.0, 170.0, 70.0, -20.0, 180.0, 170.0, 350.0, 160.0, 70.0, 240.0, 40.0, 170.0, 290.0, 30.0, 20.0, 80.0, 150.0, 90.0, 300.0, 160.0, 30.0, 530.0, 280.0, 30.0, 10.0, 10.0, 0.0, 230.0, 200.0, 20.0, 340.0, 0.0, 30.0, 100.0, 120.0, 60.0, 0.0, 65.0, 270.0, 360.0, 0.0, -50.0, 50.0, 300.0, 10.0, 40.0, 40.0, -50.0, 420.0, 30.0, 30.0, 100.0, 180.0, 230.0, 310.0, 90.0, 200.0, 150.0, 20.0, 60.0, 50.0, 50.0, 280.0, 160.0, 110.0, 215.0, 90.0, 80.0, 30.0, 20.0, 60.0, 10.0, 170.0, 350.0, 120.0, -50.0, 180.0, 30.0, 180.0, 20.0, 325.0, 30.0, 40.0, 20.0, 40.0, 20.0, 210.0, 40.0, 0.0, 190.0, 20.0, 70.0, 90.0, 50.0, 160.0, 30.0, 320.0, 20.0, 30.0, 40.0, 210.0, 330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0, 290.0, 110.0, 20.0, 80.0, 300.0, 330.0, 90.0, 120.0, 100.0, 190.0, 30.0, 90.0, 110.0, 130.0, 20.0, 20.0, 190.0, 90.0, 120.0, 140.0, 210.0, 70.0, 20.0, 40.0, 0.0, 65.0, 40.0, 40.0, 140.0, 20.0, 170.0, 90.0, 20.0, 80.0, 10.0, 130.0, 310.0, 350.0, 110.0, 50.0, 0.0, 20.0, 190.0, 10.0, 110.0, 60.0, 60.0, 50.0, 100.0, 30.0, 90.0, 110.0, -55.0, 0.0, 160.0, 270.0, 420.0, 160.0, 240.0, 90.0, 40.0, 70.0, 210.0, 65.0, 270.0, 20.0, 60.0, 10.0, 30.0, 70.0, 0.0, -40.0, 20.0, 40.0, 190.0, 60.0, 270.0, 60.0, 30.0, 180.0, 70.0, 55.0, 30.0, 50.0, 60.0, 200.0, 80.0, 60.0, 230.0, 70.0, 50.0, 130.0, 10.0, 50.0, 450.0, 210.0, 100.0, 40.0, 160.0, 180.0, -65.0, 30.0, 30.0, 0.0, 15.0, 30.0, 260.0, 100.0, -75.0, 50.0, 65.0, 120.0, 30.0, 20.0, 150.0, 70.0, 0.0, 90.0, 140.0, 10.0, 25.0, 35.0, 40.0, 70.0, 40.0, 70.0, 80.0, 190.0, 20.0, 40.0, 30.0, 100.0, 200.0, 40.0, 30.0, 40.0, 100.0, 90.0, 130.0, 120.0, 20.0, 40.0, 30.0, 30.0, 60.0, 130.0, 30.0, 220.0, 10.0, 110.0, 0.0, 10.0, 40.0, 0.0, 0.0, 50.0, 40.0, 60.0, 0.0, 10.0, 60.0, 40.0, -10.0, 40.0, 10.0, 30.0, 700.0, 40.0, 180.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5336687905348618, "mean_inference_ms": 1.4114501142805778, "mean_action_processing_ms": 0.4596670585200379, "mean_env_wait_ms": 1.2472407476452299, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011850595474243164, "StateBufferConnector_ms": 0.009203433990478516, "ViewRequirementAgentConnector_ms": 0.39241576194763184}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 210.0, "episode_return_mean": 1039.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.29944403047589, "num_env_steps_trained_throughput_per_sec": 21.29944403047589, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 187264.425, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187264.38, "sample_time_ms": 2617.53, "learn_time_ms": 184626.222, "learn_throughput": 21.665, "synch_weights_time_ms": 10.431}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "33e63_00000", "date": "2024-06-19_01-57-53", "timestamp": 1718776673, "time_this_iter_s": 187.81166791915894, "time_total_s": 17454.816955327988, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32770ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17454.816955327988, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 17.406766917293233, "ram_util_percent": 78.99586466165414}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5907126298219887, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.555704218333267, "policy_loss": -0.009103850838559639, "vf_loss": 7.562958692768004, "vf_explained_var": 0.0017631811582750152, "kl": 0.00547961575534927, "entropy": 0.38591870277231366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 210.0, "episode_reward_mean": 1039.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 103.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1090.0, 1410.0, 1610.0, 1045.0, 1610.0, 400.0, 960.0, 1480.0, 1075.0, 1395.0, 970.0, 840.0, 730.0, 1250.0, 1000.0, 1030.0, 1240.0, 730.0, 995.0, 1285.0, 1520.0, 1230.0, 1170.0, 1210.0, 845.0, 1530.0, 615.0, 1320.0, 1260.0, 1840.0, 1370.0, 485.0, 1520.0, 1500.0, 660.0, 410.0, 1310.0, 330.0, 1120.0, 725.0, 670.0, 1260.0, 810.0, 470.0, 1200.0, 925.0, 1205.0, 760.0, 845.0, 1430.0, 1320.0, 1650.0, 1005.0, 820.0, 1390.0, 1095.0, 1335.0, 610.0, 1020.0, 1310.0, 1630.0, 940.0, 645.0, 1320.0, 630.0, 1485.0, 845.0, 810.0, 905.0, 1380.0, 375.0, 695.0, 610.0, 880.0, 680.0, 210.0, 1120.0, 310.0, 800.0, 605.0, 1260.0, 1115.0, 700.0, 1170.0, 810.0, 1385.0, 1830.0, 1020.0, 1380.0, 800.0, 960.0, 1830.0, 360.0, 910.0, 970.0, 900.0, 630.0, 1290.0, 1300.0, 1170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 360.0, 50.0, 230.0, 120.0, 50.0, 280.0, -10.0, 30.0, -130.0, 60.0, 170.0, 20.0, 110.0, 90.0, 250.0, 280.0, 60.0, 250.0, 120.0, 150.0, 300.0, 80.0, 280.0, 300.0, 150.0, 50.0, 90.0, 50.0, 160.0, 270.0, 170.0, 70.0, 30.0, 70.0, 70.0, 145.0, 80.0, 100.0, 40.0, 110.0, 50.0, 80.0, 360.0, 0.0, 450.0, 40.0, 60.0, 140.0, 320.0, 160.0, 0.0, 30.0, 40.0, 60.0, 80.0, 30.0, 0.0, 0.0, 0.0, 120.0, 80.0, 280.0, 10.0, 0.0, 70.0, 30.0, 140.0, 160.0, 70.0, 60.0, 70.0, 110.0, -20.0, 140.0, 100.0, 110.0, 350.0, 30.0, 530.0, 25.0, 90.0, 10.0, 340.0, 290.0, 40.0, 120.0, 90.0, 0.0, 70.0, 380.0, 0.0, 30.0, 190.0, 110.0, 0.0, 5.0, 320.0, 190.0, 170.0, 20.0, 10.0, 80.0, 80.0, -20.0, 190.0, -40.0, 690.0, 20.0, -60.0, 170.0, 180.0, 60.0, 90.0, 10.0, 50.0, 20.0, -20.0, 250.0, 30.0, 20.0, 200.0, 10.0, 80.0, 240.0, 80.0, 40.0, 40.0, 10.0, 10.0, 70.0, 130.0, 220.0, 70.0, 190.0, 50.0, 0.0, 340.0, 180.0, 0.0, 0.0, 65.0, 210.0, 110.0, -25.0, 60.0, 40.0, 180.0, 60.0, 300.0, 170.0, 110.0, 270.0, 70.0, 80.0, 0.0, 120.0, 60.0, 10.0, 140.0, 70.0, 90.0, 100.0, 150.0, 190.0, 60.0, 290.0, 60.0, 120.0, 110.0, 60.0, 20.0, 50.0, 20.0, 120.0, 330.0, 10.0, 20.0, 30.0, 70.0, 70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0, 120.0, 70.0, 190.0, 330.0, -25.0, 80.0, 170.0, 60.0, 50.0, 240.0, 610.0, 40.0, -20.0, 310.0, 120.0, 30.0, 130.0, 60.0, 40.0, 200.0, 90.0, 180.0, -20.0, 110.0, 60.0, 30.0, 420.0, 30.0, 220.0, 110.0, 60.0, 230.0, 190.0, 150.0, -40.0, 160.0, 20.0, 70.0, 180.0, 150.0, 80.0, 100.0, 0.0, 190.0, 90.0, 90.0, 210.0, 250.0, 30.0, 170.0, 40.0, 120.0, 20.0, 15.0, 310.0, 0.0, 170.0, 90.0, 90.0, -10.0, 80.0, 100.0, 40.0, 160.0, 180.0, 450.0, 130.0, 110.0, -30.0, 310.0, -85.0, 40.0, 40.0, 80.0, 20.0, 100.0, 60.0, 0.0, 290.0, 70.0, 260.0, 130.0, 110.0, 130.0, 30.0, 50.0, 80.0, 220.0, 210.0, 100.0, 300.0, 100.0, 30.0, 390.0, -10.0, 150.0, 90.0, 60.0, 70.0, 80.0, 120.0, 100.0, 360.0, 100.0, 80.0, 130.0, 220.0, 300.0, 170.0, 260.0, 120.0, 180.0, 190.0, 60.0, 510.0, 80.0, 50.0, 20.0, 130.0, 30.0, 20.0, 30.0, 20.0, 50.0, 30.0, 30.0, 130.0, -15.0, 150.0, 40.0, 50.0, 550.0, 0.0, 290.0, 100.0, 90.0, 70.0, 100.0, 60.0, 210.0, 260.0, 400.0, 0.0, 90.0, 330.0, 170.0, 80.0, 20.0, 160.0, -10.0, 30.0, 170.0, 60.0, 30.0, 0.0, 0.0, 20.0, 40.0, 190.0, 120.0, 20.0, -30.0, 20.0, 40.0, 30.0, 30.0, 10.0, 90.0, 40.0, 160.0, 440.0, 200.0, 70.0, 90.0, 40.0, 220.0, 0.0, 160.0, 50.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 50.0, 70.0, 0.0, 90.0, 40.0, 140.0, 210.0, 50.0, 120.0, 40.0, 40.0, 90.0, 60.0, 330.0, 190.0, 10.0, 30.0, 20.0, 40.0, 25.0, 250.0, 80.0, 80.0, 0.0, 80.0, 20.0, 0.0, 200.0, 40.0, 220.0, 30.0, 40.0, 90.0, -50.0, 40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0, 20.0, 30.0, 80.0, 80.0, 40.0, 30.0, 100.0, 90.0, 30.0, 310.0, 40.0, -20.0, 30.0, 30.0, 40.0, 50.0, 40.0, 40.0, 130.0, 90.0, 190.0, 10.0, 90.0, 290.0, 260.0, 80.0, 60.0, 40.0, 140.0, 40.0, 50.0, 250.0, 180.0, 160.0, 70.0, 20.0, 150.0, 40.0, -15.0, 20.0, 40.0, 150.0, -100.0, 70.0, 80.0, -20.0, 60.0, 25.0, 200.0, 700.0, 60.0, 160.0, 50.0, 30.0, 0.0, 10.0, 10.0, 50.0, 280.0, 110.0, 10.0, 60.0, 25.0, 10.0, 70.0, 50.0, 120.0, 160.0, 320.0, 20.0, 170.0, 70.0, -20.0, 180.0, 170.0, 350.0, 160.0, 70.0, 240.0, 40.0, 170.0, 290.0, 30.0, 20.0, 80.0, 150.0, 90.0, 300.0, 160.0, 30.0, 530.0, 280.0, 30.0, 10.0, 10.0, 0.0, 230.0, 200.0, 20.0, 340.0, 0.0, 30.0, 100.0, 120.0, 60.0, 0.0, 65.0, 270.0, 360.0, 0.0, -50.0, 50.0, 300.0, 10.0, 40.0, 40.0, -50.0, 420.0, 30.0, 30.0, 100.0, 180.0, 230.0, 310.0, 90.0, 200.0, 150.0, 20.0, 60.0, 50.0, 50.0, 280.0, 160.0, 110.0, 215.0, 90.0, 80.0, 30.0, 20.0, 60.0, 10.0, 170.0, 350.0, 120.0, -50.0, 180.0, 30.0, 180.0, 20.0, 325.0, 30.0, 40.0, 20.0, 40.0, 20.0, 210.0, 40.0, 0.0, 190.0, 20.0, 70.0, 90.0, 50.0, 160.0, 30.0, 320.0, 20.0, 30.0, 40.0, 210.0, 330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0, 290.0, 110.0, 20.0, 80.0, 300.0, 330.0, 90.0, 120.0, 100.0, 190.0, 30.0, 90.0, 110.0, 130.0, 20.0, 20.0, 190.0, 90.0, 120.0, 140.0, 210.0, 70.0, 20.0, 40.0, 0.0, 65.0, 40.0, 40.0, 140.0, 20.0, 170.0, 90.0, 20.0, 80.0, 10.0, 130.0, 310.0, 350.0, 110.0, 50.0, 0.0, 20.0, 190.0, 10.0, 110.0, 60.0, 60.0, 50.0, 100.0, 30.0, 90.0, 110.0, -55.0, 0.0, 160.0, 270.0, 420.0, 160.0, 240.0, 90.0, 40.0, 70.0, 210.0, 65.0, 270.0, 20.0, 60.0, 10.0, 30.0, 70.0, 0.0, -40.0, 20.0, 40.0, 190.0, 60.0, 270.0, 60.0, 30.0, 180.0, 70.0, 55.0, 30.0, 50.0, 60.0, 200.0, 80.0, 60.0, 230.0, 70.0, 50.0, 130.0, 10.0, 50.0, 450.0, 210.0, 100.0, 40.0, 160.0, 180.0, -65.0, 30.0, 30.0, 0.0, 15.0, 30.0, 260.0, 100.0, -75.0, 50.0, 65.0, 120.0, 30.0, 20.0, 150.0, 70.0, 0.0, 90.0, 140.0, 10.0, 25.0, 35.0, 40.0, 70.0, 40.0, 70.0, 80.0, 190.0, 20.0, 40.0, 30.0, 100.0, 200.0, 40.0, 30.0, 40.0, 100.0, 90.0, 130.0, 120.0, 20.0, 40.0, 30.0, 30.0, 60.0, 130.0, 30.0, 220.0, 10.0, 110.0, 0.0, 10.0, 40.0, 0.0, 0.0, 50.0, 40.0, 60.0, 0.0, 10.0, 60.0, 40.0, -10.0, 40.0, 10.0, 30.0, 700.0, 40.0, 180.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0, 70.0, 190.0, 80.0, 30.0, 20.0, 180.0, 170.0, 10.0, 40.0, 10.0, 5.0, 30.0, 100.0, 110.0, 80.0, 60.0, 10.0, 50.0, 160.0, 0.0, 170.0, 30.0, 220.0, -60.0, 0.0, 110.0, 260.0, 150.0, 200.0, 180.0, 20.0, 200.0, 200.0, 40.0, 150.0, 15.0, 290.0, 40.0, 60.0, 100.0, 40.0, 20.0, 30.0, 60.0, 10.0, 130.0, 70.0, 80.0, 180.0, 80.0, 270.0, 130.0, 90.0, 50.0, 0.0, 440.0, 100.0, 30.0, 30.0, 30.0, 0.0, 10.0, 20.0, 140.0, 210.0, 150.0, 90.0, 40.0, 0.0, 150.0, 260.0, 220.0, 170.0, 190.0, 50.0, 100.0, -10.0, 20.0, -15.0, 400.0, 80.0, 50.0, 130.0, 490.0, 150.0, 50.0, 80.0, 490.0, 150.0, 160.0, 40.0, 80.0, 120.0, 30.0, 50.0, 260.0, 40.0, 110.0, 250.0, 40.0, 360.0, 90.0, 110.0, 10.0, 120.0, 30.0, 220.0, 150.0, 210.0, 80.0, 100.0, 250.0, 80.0, 70.0, 0.0, 10.0, 50.0, 90.0, -60.0, 210.0, 160.0, 300.0, -100.0, 70.0, 70.0, 130.0, 160.0, 70.0, 20.0, 80.0, 220.0, -10.0, 460.0, 100.0, 100.0, 170.0, 450.0, 100.0, 130.0, 110.0, 50.0, 0.0, 60.0, 20.0, 40.0, 40.0, 0.0, 60.0, 60.0, 30.0, 20.0, 110.0, 70.0, -30.0, 30.0, 50.0, 90.0, 60.0, 130.0, 380.0, 70.0, 40.0, 20.0, 170.0, 80.0, 90.0, 60.0, 460.0, 0.0, -20.0, 120.0, 80.0, 60.0, 50.0, 170.0, 40.0, 80.0, 20.0, 40.0, 240.0, 220.0, 20.0, 30.0, 20.0, 40.0, 0.0, 210.0, 20.0, 50.0, 20.0, 50.0, 10.0, 270.0, 70.0, 60.0, 620.0, 30.0, 60.0, 20.0, 100.0, 160.0, 20.0, 210.0, 90.0, 140.0, 10.0, 70.0, 80.0, 360.0, 160.0, 70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5327373112578655, "mean_inference_ms": 1.4114197968913225, "mean_action_processing_ms": 0.45864559508683184, "mean_env_wait_ms": 1.2469043343824282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012026071548461914, "StateBufferConnector_ms": 0.00970911979675293, "ViewRequirementAgentConnector_ms": 0.3969125747680664}, "num_episodes": 22, "episode_return_max": 1840.0, "episode_return_min": 210.0, "episode_return_mean": 1039.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.082970405735292, "num_env_steps_trained_throughput_per_sec": 21.082970405735292, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 187315.313, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187315.268, "sample_time_ms": 2577.583, "learn_time_ms": 184718.238, "learn_throughput": 21.655, "synch_weights_time_ms": 10.093}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "33e63_00000", "date": "2024-06-19_02-01-02", "timestamp": 1718776862, "time_this_iter_s": 189.7384910583496, "time_total_s": 17644.555446386337, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3276ca8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17644.555446386337, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 18.966044776119404, "ram_util_percent": 79.60298507462686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.548263600738412, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.107005625563308, "policy_loss": -0.007400868705144554, "vf_loss": 7.112668259075274, "vf_explained_var": 0.002003313659732969, "kl": 0.005150302554828507, "entropy": 0.4150046861908052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1840.0, "episode_reward_min": 210.0, "episode_reward_mean": 999.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -900.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 99.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [995.0, 1285.0, 1520.0, 1230.0, 1170.0, 1210.0, 845.0, 1530.0, 615.0, 1320.0, 1260.0, 1840.0, 1370.0, 485.0, 1520.0, 1500.0, 660.0, 410.0, 1310.0, 330.0, 1120.0, 725.0, 670.0, 1260.0, 810.0, 470.0, 1200.0, 925.0, 1205.0, 760.0, 845.0, 1430.0, 1320.0, 1650.0, 1005.0, 820.0, 1390.0, 1095.0, 1335.0, 610.0, 1020.0, 1310.0, 1630.0, 940.0, 645.0, 1320.0, 630.0, 1485.0, 845.0, 810.0, 905.0, 1380.0, 375.0, 695.0, 610.0, 880.0, 680.0, 210.0, 1120.0, 310.0, 800.0, 605.0, 1260.0, 1115.0, 700.0, 1170.0, 810.0, 1385.0, 1830.0, 1020.0, 1380.0, 800.0, 960.0, 1830.0, 360.0, 910.0, 970.0, 900.0, 630.0, 1290.0, 1300.0, 1170.0, 960.0, 350.0, 315.0, 660.0, 1500.0, 760.0, 670.0, 890.0, 1260.0, 1000.0, 620.0, 620.0, 280.0, 1190.0, 1280.0, 730.0, 1390.0, 1440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 50.0, 10.0, 290.0, 50.0, 20.0, 80.0, 30.0, 210.0, 185.0, 120.0, 70.0, 190.0, 330.0, -25.0, 80.0, 170.0, 60.0, 50.0, 240.0, 610.0, 40.0, -20.0, 310.0, 120.0, 30.0, 130.0, 60.0, 40.0, 200.0, 90.0, 180.0, -20.0, 110.0, 60.0, 30.0, 420.0, 30.0, 220.0, 110.0, 60.0, 230.0, 190.0, 150.0, -40.0, 160.0, 20.0, 70.0, 180.0, 150.0, 80.0, 100.0, 0.0, 190.0, 90.0, 90.0, 210.0, 250.0, 30.0, 170.0, 40.0, 120.0, 20.0, 15.0, 310.0, 0.0, 170.0, 90.0, 90.0, -10.0, 80.0, 100.0, 40.0, 160.0, 180.0, 450.0, 130.0, 110.0, -30.0, 310.0, -85.0, 40.0, 40.0, 80.0, 20.0, 100.0, 60.0, 0.0, 290.0, 70.0, 260.0, 130.0, 110.0, 130.0, 30.0, 50.0, 80.0, 220.0, 210.0, 100.0, 300.0, 100.0, 30.0, 390.0, -10.0, 150.0, 90.0, 60.0, 70.0, 80.0, 120.0, 100.0, 360.0, 100.0, 80.0, 130.0, 220.0, 300.0, 170.0, 260.0, 120.0, 180.0, 190.0, 60.0, 510.0, 80.0, 50.0, 20.0, 130.0, 30.0, 20.0, 30.0, 20.0, 50.0, 30.0, 30.0, 130.0, -15.0, 150.0, 40.0, 50.0, 550.0, 0.0, 290.0, 100.0, 90.0, 70.0, 100.0, 60.0, 210.0, 260.0, 400.0, 0.0, 90.0, 330.0, 170.0, 80.0, 20.0, 160.0, -10.0, 30.0, 170.0, 60.0, 30.0, 0.0, 0.0, 20.0, 40.0, 190.0, 120.0, 20.0, -30.0, 20.0, 40.0, 30.0, 30.0, 10.0, 90.0, 40.0, 160.0, 440.0, 200.0, 70.0, 90.0, 40.0, 220.0, 0.0, 160.0, 50.0, 40.0, 0.0, 10.0, 20.0, 10.0, 40.0, 40.0, 50.0, 70.0, 0.0, 90.0, 40.0, 140.0, 210.0, 50.0, 120.0, 40.0, 40.0, 90.0, 60.0, 330.0, 190.0, 10.0, 30.0, 20.0, 40.0, 25.0, 250.0, 80.0, 80.0, 0.0, 80.0, 20.0, 0.0, 200.0, 40.0, 220.0, 30.0, 40.0, 90.0, -50.0, 40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0, 20.0, 30.0, 80.0, 80.0, 40.0, 30.0, 100.0, 90.0, 30.0, 310.0, 40.0, -20.0, 30.0, 30.0, 40.0, 50.0, 40.0, 40.0, 130.0, 90.0, 190.0, 10.0, 90.0, 290.0, 260.0, 80.0, 60.0, 40.0, 140.0, 40.0, 50.0, 250.0, 180.0, 160.0, 70.0, 20.0, 150.0, 40.0, -15.0, 20.0, 40.0, 150.0, -100.0, 70.0, 80.0, -20.0, 60.0, 25.0, 200.0, 700.0, 60.0, 160.0, 50.0, 30.0, 0.0, 10.0, 10.0, 50.0, 280.0, 110.0, 10.0, 60.0, 25.0, 10.0, 70.0, 50.0, 120.0, 160.0, 320.0, 20.0, 170.0, 70.0, -20.0, 180.0, 170.0, 350.0, 160.0, 70.0, 240.0, 40.0, 170.0, 290.0, 30.0, 20.0, 80.0, 150.0, 90.0, 300.0, 160.0, 30.0, 530.0, 280.0, 30.0, 10.0, 10.0, 0.0, 230.0, 200.0, 20.0, 340.0, 0.0, 30.0, 100.0, 120.0, 60.0, 0.0, 65.0, 270.0, 360.0, 0.0, -50.0, 50.0, 300.0, 10.0, 40.0, 40.0, -50.0, 420.0, 30.0, 30.0, 100.0, 180.0, 230.0, 310.0, 90.0, 200.0, 150.0, 20.0, 60.0, 50.0, 50.0, 280.0, 160.0, 110.0, 215.0, 90.0, 80.0, 30.0, 20.0, 60.0, 10.0, 170.0, 350.0, 120.0, -50.0, 180.0, 30.0, 180.0, 20.0, 325.0, 30.0, 40.0, 20.0, 40.0, 20.0, 210.0, 40.0, 0.0, 190.0, 20.0, 70.0, 90.0, 50.0, 160.0, 30.0, 320.0, 20.0, 30.0, 40.0, 210.0, 330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0, 290.0, 110.0, 20.0, 80.0, 300.0, 330.0, 90.0, 120.0, 100.0, 190.0, 30.0, 90.0, 110.0, 130.0, 20.0, 20.0, 190.0, 90.0, 120.0, 140.0, 210.0, 70.0, 20.0, 40.0, 0.0, 65.0, 40.0, 40.0, 140.0, 20.0, 170.0, 90.0, 20.0, 80.0, 10.0, 130.0, 310.0, 350.0, 110.0, 50.0, 0.0, 20.0, 190.0, 10.0, 110.0, 60.0, 60.0, 50.0, 100.0, 30.0, 90.0, 110.0, -55.0, 0.0, 160.0, 270.0, 420.0, 160.0, 240.0, 90.0, 40.0, 70.0, 210.0, 65.0, 270.0, 20.0, 60.0, 10.0, 30.0, 70.0, 0.0, -40.0, 20.0, 40.0, 190.0, 60.0, 270.0, 60.0, 30.0, 180.0, 70.0, 55.0, 30.0, 50.0, 60.0, 200.0, 80.0, 60.0, 230.0, 70.0, 50.0, 130.0, 10.0, 50.0, 450.0, 210.0, 100.0, 40.0, 160.0, 180.0, -65.0, 30.0, 30.0, 0.0, 15.0, 30.0, 260.0, 100.0, -75.0, 50.0, 65.0, 120.0, 30.0, 20.0, 150.0, 70.0, 0.0, 90.0, 140.0, 10.0, 25.0, 35.0, 40.0, 70.0, 40.0, 70.0, 80.0, 190.0, 20.0, 40.0, 30.0, 100.0, 200.0, 40.0, 30.0, 40.0, 100.0, 90.0, 130.0, 120.0, 20.0, 40.0, 30.0, 30.0, 60.0, 130.0, 30.0, 220.0, 10.0, 110.0, 0.0, 10.0, 40.0, 0.0, 0.0, 50.0, 40.0, 60.0, 0.0, 10.0, 60.0, 40.0, -10.0, 40.0, 10.0, 30.0, 700.0, 40.0, 180.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0, 70.0, 190.0, 80.0, 30.0, 20.0, 180.0, 170.0, 10.0, 40.0, 10.0, 5.0, 30.0, 100.0, 110.0, 80.0, 60.0, 10.0, 50.0, 160.0, 0.0, 170.0, 30.0, 220.0, -60.0, 0.0, 110.0, 260.0, 150.0, 200.0, 180.0, 20.0, 200.0, 200.0, 40.0, 150.0, 15.0, 290.0, 40.0, 60.0, 100.0, 40.0, 20.0, 30.0, 60.0, 10.0, 130.0, 70.0, 80.0, 180.0, 80.0, 270.0, 130.0, 90.0, 50.0, 0.0, 440.0, 100.0, 30.0, 30.0, 30.0, 0.0, 10.0, 20.0, 140.0, 210.0, 150.0, 90.0, 40.0, 0.0, 150.0, 260.0, 220.0, 170.0, 190.0, 50.0, 100.0, -10.0, 20.0, -15.0, 400.0, 80.0, 50.0, 130.0, 490.0, 150.0, 50.0, 80.0, 490.0, 150.0, 160.0, 40.0, 80.0, 120.0, 30.0, 50.0, 260.0, 40.0, 110.0, 250.0, 40.0, 360.0, 90.0, 110.0, 10.0, 120.0, 30.0, 220.0, 150.0, 210.0, 80.0, 100.0, 250.0, 80.0, 70.0, 0.0, 10.0, 50.0, 90.0, -60.0, 210.0, 160.0, 300.0, -100.0, 70.0, 70.0, 130.0, 160.0, 70.0, 20.0, 80.0, 220.0, -10.0, 460.0, 100.0, 100.0, 170.0, 450.0, 100.0, 130.0, 110.0, 50.0, 0.0, 60.0, 20.0, 40.0, 40.0, 0.0, 60.0, 60.0, 30.0, 20.0, 110.0, 70.0, -30.0, 30.0, 50.0, 90.0, 60.0, 130.0, 380.0, 70.0, 40.0, 20.0, 170.0, 80.0, 90.0, 60.0, 460.0, 0.0, -20.0, 120.0, 80.0, 60.0, 50.0, 170.0, 40.0, 80.0, 20.0, 40.0, 240.0, 220.0, 20.0, 30.0, 20.0, 40.0, 0.0, 210.0, 20.0, 50.0, 20.0, 50.0, 10.0, 270.0, 70.0, 60.0, 620.0, 30.0, 60.0, 20.0, 100.0, 160.0, 20.0, 210.0, 90.0, 140.0, 10.0, 70.0, 80.0, 360.0, 160.0, 70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0, 10.0, 20.0, 140.0, -20.0, 190.0, 60.0, 180.0, 170.0, 170.0, 40.0, 30.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 20.0, 70.0, -60.0, 20.0, 20.0, -85.0, 30.0, 0.0, 160.0, 0.0, 150.0, 80.0, -20.0, 310.0, 50.0, 0.0, 70.0, 10.0, 90.0, 80.0, 30.0, 40.0, 20.0, 40.0, 40.0, 320.0, 50.0, 550.0, 290.0, 30.0, 60.0, 100.0, 10.0, 540.0, 10.0, 150.0, 40.0, 30.0, 310.0, 30.0, 20.0, -380.0, 30.0, 10.0, 90.0, 150.0, 50.0, 80.0, 140.0, 40.0, 10.0, 70.0, 320.0, -20.0, 190.0, 70.0, 10.0, 30.0, 100.0, 130.0, 30.0, 30.0, 10.0, 330.0, 40.0, 230.0, 250.0, 10.0, 50.0, 270.0, 40.0, 30.0, 460.0, 0.0, 150.0, 10.0, 10.0, 40.0, 20.0, 140.0, 10.0, 160.0, 10.0, 50.0, 0.0, 160.0, 60.0, 50.0, 90.0, 90.0, 70.0, 40.0, 0.0, 120.0, 0.0, 10.0, 60.0, 240.0, 30.0, 70.0, 40.0, 50.0, -900.0, 20.0, 310.0, 180.0, 140.0, 60.0, 280.0, 70.0, 60.0, 60.0, 80.0, 210.0, 90.0, 320.0, 60.0, 50.0, 70.0, 90.0, 50.0, 170.0, 130.0, 160.0, 50.0, 150.0, 30.0, 250.0, 90.0, 300.0, 50.0, 70.0, 160.0, 60.0, 20.0, 170.0, 130.0, 50.0, 40.0, 0.0, 40.0, 60.0, 60.0, 80.0, 80.0, 440.0, 50.0, 160.0, 140.0, 90.0, 240.0, 50.0, 360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5319638064123364, "mean_inference_ms": 1.4111716466206337, "mean_action_processing_ms": 0.4578517857897833, "mean_env_wait_ms": 1.2465814503066899, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181997299194336, "StateBufferConnector_ms": 0.009720087051391602, "ViewRequirementAgentConnector_ms": 0.3995025157928467}, "num_episodes": 18, "episode_return_max": 1840.0, "episode_return_min": 210.0, "episode_return_mean": 999.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.39808837753069, "num_env_steps_trained_throughput_per_sec": 21.39808837753069, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 187325.196, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187325.152, "sample_time_ms": 2610.943, "learn_time_ms": 184694.671, "learn_throughput": 21.657, "synch_weights_time_ms": 10.152}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "33e63_00000", "date": "2024-06-19_02-04-09", "timestamp": 1718777049, "time_this_iter_s": 186.941339969635, "time_total_s": 17831.496786355972, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32771df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 17831.496786355972, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 16.252452830188677, "ram_util_percent": 79.30150943396227}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9851562041190234, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.860200978188723, "policy_loss": -0.00967481979605354, "vf_loss": 6.868053718928458, "vf_explained_var": 0.002126527613344284, "kl": 0.005398780915650202, "entropy": 0.42539154265762263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1830.0, "episode_reward_min": 210.0, "episode_reward_mean": 949.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -900.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 94.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 810.0, 470.0, 1200.0, 925.0, 1205.0, 760.0, 845.0, 1430.0, 1320.0, 1650.0, 1005.0, 820.0, 1390.0, 1095.0, 1335.0, 610.0, 1020.0, 1310.0, 1630.0, 940.0, 645.0, 1320.0, 630.0, 1485.0, 845.0, 810.0, 905.0, 1380.0, 375.0, 695.0, 610.0, 880.0, 680.0, 210.0, 1120.0, 310.0, 800.0, 605.0, 1260.0, 1115.0, 700.0, 1170.0, 810.0, 1385.0, 1830.0, 1020.0, 1380.0, 800.0, 960.0, 1830.0, 360.0, 910.0, 970.0, 900.0, 630.0, 1290.0, 1300.0, 1170.0, 960.0, 350.0, 315.0, 660.0, 1500.0, 760.0, 670.0, 890.0, 1260.0, 1000.0, 620.0, 620.0, 280.0, 1190.0, 1280.0, 730.0, 1390.0, 1440.0, 320.0, 1320.0, 700.0, 1390.0, 1100.0, 300.0, 410.0, 1200.0, 1115.0, 690.0, 540.0, 460.0, 1100.0, 1510.0, 685.0, 1250.0, 850.0, 510.0, 405.0, 620.0, 1295.0, 1310.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 190.0, 50.0, 80.0, 400.0, 40.0, 10.0, 280.0, 80.0, 90.0, 20.0, 30.0, 80.0, 80.0, 40.0, 30.0, 100.0, 90.0, 30.0, 310.0, 40.0, -20.0, 30.0, 30.0, 40.0, 50.0, 40.0, 40.0, 130.0, 90.0, 190.0, 10.0, 90.0, 290.0, 260.0, 80.0, 60.0, 40.0, 140.0, 40.0, 50.0, 250.0, 180.0, 160.0, 70.0, 20.0, 150.0, 40.0, -15.0, 20.0, 40.0, 150.0, -100.0, 70.0, 80.0, -20.0, 60.0, 25.0, 200.0, 700.0, 60.0, 160.0, 50.0, 30.0, 0.0, 10.0, 10.0, 50.0, 280.0, 110.0, 10.0, 60.0, 25.0, 10.0, 70.0, 50.0, 120.0, 160.0, 320.0, 20.0, 170.0, 70.0, -20.0, 180.0, 170.0, 350.0, 160.0, 70.0, 240.0, 40.0, 170.0, 290.0, 30.0, 20.0, 80.0, 150.0, 90.0, 300.0, 160.0, 30.0, 530.0, 280.0, 30.0, 10.0, 10.0, 0.0, 230.0, 200.0, 20.0, 340.0, 0.0, 30.0, 100.0, 120.0, 60.0, 0.0, 65.0, 270.0, 360.0, 0.0, -50.0, 50.0, 300.0, 10.0, 40.0, 40.0, -50.0, 420.0, 30.0, 30.0, 100.0, 180.0, 230.0, 310.0, 90.0, 200.0, 150.0, 20.0, 60.0, 50.0, 50.0, 280.0, 160.0, 110.0, 215.0, 90.0, 80.0, 30.0, 20.0, 60.0, 10.0, 170.0, 350.0, 120.0, -50.0, 180.0, 30.0, 180.0, 20.0, 325.0, 30.0, 40.0, 20.0, 40.0, 20.0, 210.0, 40.0, 0.0, 190.0, 20.0, 70.0, 90.0, 50.0, 160.0, 30.0, 320.0, 20.0, 30.0, 40.0, 210.0, 330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0, 290.0, 110.0, 20.0, 80.0, 300.0, 330.0, 90.0, 120.0, 100.0, 190.0, 30.0, 90.0, 110.0, 130.0, 20.0, 20.0, 190.0, 90.0, 120.0, 140.0, 210.0, 70.0, 20.0, 40.0, 0.0, 65.0, 40.0, 40.0, 140.0, 20.0, 170.0, 90.0, 20.0, 80.0, 10.0, 130.0, 310.0, 350.0, 110.0, 50.0, 0.0, 20.0, 190.0, 10.0, 110.0, 60.0, 60.0, 50.0, 100.0, 30.0, 90.0, 110.0, -55.0, 0.0, 160.0, 270.0, 420.0, 160.0, 240.0, 90.0, 40.0, 70.0, 210.0, 65.0, 270.0, 20.0, 60.0, 10.0, 30.0, 70.0, 0.0, -40.0, 20.0, 40.0, 190.0, 60.0, 270.0, 60.0, 30.0, 180.0, 70.0, 55.0, 30.0, 50.0, 60.0, 200.0, 80.0, 60.0, 230.0, 70.0, 50.0, 130.0, 10.0, 50.0, 450.0, 210.0, 100.0, 40.0, 160.0, 180.0, -65.0, 30.0, 30.0, 0.0, 15.0, 30.0, 260.0, 100.0, -75.0, 50.0, 65.0, 120.0, 30.0, 20.0, 150.0, 70.0, 0.0, 90.0, 140.0, 10.0, 25.0, 35.0, 40.0, 70.0, 40.0, 70.0, 80.0, 190.0, 20.0, 40.0, 30.0, 100.0, 200.0, 40.0, 30.0, 40.0, 100.0, 90.0, 130.0, 120.0, 20.0, 40.0, 30.0, 30.0, 60.0, 130.0, 30.0, 220.0, 10.0, 110.0, 0.0, 10.0, 40.0, 0.0, 0.0, 50.0, 40.0, 60.0, 0.0, 10.0, 60.0, 40.0, -10.0, 40.0, 10.0, 30.0, 700.0, 40.0, 180.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0, 70.0, 190.0, 80.0, 30.0, 20.0, 180.0, 170.0, 10.0, 40.0, 10.0, 5.0, 30.0, 100.0, 110.0, 80.0, 60.0, 10.0, 50.0, 160.0, 0.0, 170.0, 30.0, 220.0, -60.0, 0.0, 110.0, 260.0, 150.0, 200.0, 180.0, 20.0, 200.0, 200.0, 40.0, 150.0, 15.0, 290.0, 40.0, 60.0, 100.0, 40.0, 20.0, 30.0, 60.0, 10.0, 130.0, 70.0, 80.0, 180.0, 80.0, 270.0, 130.0, 90.0, 50.0, 0.0, 440.0, 100.0, 30.0, 30.0, 30.0, 0.0, 10.0, 20.0, 140.0, 210.0, 150.0, 90.0, 40.0, 0.0, 150.0, 260.0, 220.0, 170.0, 190.0, 50.0, 100.0, -10.0, 20.0, -15.0, 400.0, 80.0, 50.0, 130.0, 490.0, 150.0, 50.0, 80.0, 490.0, 150.0, 160.0, 40.0, 80.0, 120.0, 30.0, 50.0, 260.0, 40.0, 110.0, 250.0, 40.0, 360.0, 90.0, 110.0, 10.0, 120.0, 30.0, 220.0, 150.0, 210.0, 80.0, 100.0, 250.0, 80.0, 70.0, 0.0, 10.0, 50.0, 90.0, -60.0, 210.0, 160.0, 300.0, -100.0, 70.0, 70.0, 130.0, 160.0, 70.0, 20.0, 80.0, 220.0, -10.0, 460.0, 100.0, 100.0, 170.0, 450.0, 100.0, 130.0, 110.0, 50.0, 0.0, 60.0, 20.0, 40.0, 40.0, 0.0, 60.0, 60.0, 30.0, 20.0, 110.0, 70.0, -30.0, 30.0, 50.0, 90.0, 60.0, 130.0, 380.0, 70.0, 40.0, 20.0, 170.0, 80.0, 90.0, 60.0, 460.0, 0.0, -20.0, 120.0, 80.0, 60.0, 50.0, 170.0, 40.0, 80.0, 20.0, 40.0, 240.0, 220.0, 20.0, 30.0, 20.0, 40.0, 0.0, 210.0, 20.0, 50.0, 20.0, 50.0, 10.0, 270.0, 70.0, 60.0, 620.0, 30.0, 60.0, 20.0, 100.0, 160.0, 20.0, 210.0, 90.0, 140.0, 10.0, 70.0, 80.0, 360.0, 160.0, 70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0, 10.0, 20.0, 140.0, -20.0, 190.0, 60.0, 180.0, 170.0, 170.0, 40.0, 30.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 20.0, 70.0, -60.0, 20.0, 20.0, -85.0, 30.0, 0.0, 160.0, 0.0, 150.0, 80.0, -20.0, 310.0, 50.0, 0.0, 70.0, 10.0, 90.0, 80.0, 30.0, 40.0, 20.0, 40.0, 40.0, 320.0, 50.0, 550.0, 290.0, 30.0, 60.0, 100.0, 10.0, 540.0, 10.0, 150.0, 40.0, 30.0, 310.0, 30.0, 20.0, -380.0, 30.0, 10.0, 90.0, 150.0, 50.0, 80.0, 140.0, 40.0, 10.0, 70.0, 320.0, -20.0, 190.0, 70.0, 10.0, 30.0, 100.0, 130.0, 30.0, 30.0, 10.0, 330.0, 40.0, 230.0, 250.0, 10.0, 50.0, 270.0, 40.0, 30.0, 460.0, 0.0, 150.0, 10.0, 10.0, 40.0, 20.0, 140.0, 10.0, 160.0, 10.0, 50.0, 0.0, 160.0, 60.0, 50.0, 90.0, 90.0, 70.0, 40.0, 0.0, 120.0, 0.0, 10.0, 60.0, 240.0, 30.0, 70.0, 40.0, 50.0, -900.0, 20.0, 310.0, 180.0, 140.0, 60.0, 280.0, 70.0, 60.0, 60.0, 80.0, 210.0, 90.0, 320.0, 60.0, 50.0, 70.0, 90.0, 50.0, 170.0, 130.0, 160.0, 50.0, 150.0, 30.0, 250.0, 90.0, 300.0, 50.0, 70.0, 160.0, 60.0, 20.0, 170.0, 130.0, 50.0, 40.0, 0.0, 40.0, 60.0, 60.0, 80.0, 80.0, 440.0, 50.0, 160.0, 140.0, 90.0, 240.0, 50.0, 360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0, -290.0, 40.0, 0.0, 40.0, 90.0, 190.0, 70.0, 20.0, 150.0, 10.0, 230.0, 10.0, 80.0, 70.0, 40.0, 370.0, 300.0, 90.0, 70.0, 60.0, 20.0, 90.0, 90.0, 10.0, 30.0, 60.0, 250.0, 110.0, -40.0, 80.0, 180.0, 90.0, 70.0, 220.0, 80.0, 70.0, 230.0, 110.0, 150.0, 190.0, 410.0, 120.0, 170.0, 50.0, 30.0, 50.0, 80.0, 110.0, -30.0, 110.0, 40.0, -30.0, -40.0, 180.0, 90.0, 80.0, -10.0, -30.0, 15.0, 5.0, 40.0, 20.0, 10.0, 40.0, 20.0, 70.0, 40.0, 20.0, 110.0, 40.0, 40.0, 60.0, -60.0, 250.0, 270.0, 160.0, 30.0, -40.0, 160.0, 330.0, 60.0, 140.0, 200.0, 15.0, 40.0, 120.0, 110.0, 190.0, 70.0, 170.0, 20.0, 120.0, 110.0, 80.0, 160.0, 30.0, 40.0, 70.0, 50.0, 10.0, 180.0, 50.0, 90.0, 30.0, 0.0, 0.0, 10.0, 60.0, 10.0, 110.0, 150.0, 30.0, 20.0, 40.0, -40.0, 110.0, 40.0, 20.0, 40.0, 50.0, 210.0, -30.0, 390.0, 110.0, 20.0, 140.0, 80.0, 40.0, 60.0, 80.0, 40.0, 30.0, 10.0, 30.0, 0.0, 850.0, 0.0, 200.0, 20.0, 330.0, 40.0, 60.0, 5.0, 20.0, 100.0, 10.0, 220.0, 70.0, 40.0, 120.0, 50.0, 90.0, 30.0, 280.0, 160.0, 150.0, 160.0, 20.0, 100.0, 210.0, 30.0, 50.0, 40.0, 30.0, 100.0, 70.0, 310.0, 20.0, 180.0, 20.0, -30.0, 20.0, 190.0, 70.0, 20.0, 190.0, 40.0, 30.0, -50.0, 30.0, 75.0, 30.0, 20.0, 100.0, 0.0, 90.0, 40.0, 20.0, 10.0, 20.0, 0.0, 40.0, 40.0, 50.0, 10.0, 240.0, 20.0, 180.0, 30.0, 10.0, 340.0, 45.0, 110.0, 170.0, 80.0, 120.0, 140.0, 180.0, 70.0, 40.0, 350.0, 390.0, -15.0, 60.0, 10.0, 65.0, 160.0, 50.0, 190.0, 50.0, 60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5312420288579132, "mean_inference_ms": 1.4107250186508766, "mean_action_processing_ms": 0.4568973210071212, "mean_env_wait_ms": 1.2461512922696438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012207269668579102, "StateBufferConnector_ms": 0.009787321090698242, "ViewRequirementAgentConnector_ms": 0.39653968811035156}, "num_episodes": 23, "episode_return_max": 1830.0, "episode_return_min": 210.0, "episode_return_mean": 949.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.348581230203326, "num_env_steps_trained_throughput_per_sec": 21.348581230203326, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 187415.726, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187415.682, "sample_time_ms": 2605.659, "learn_time_ms": 184790.677, "learn_throughput": 21.646, "synch_weights_time_ms": 10.059}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "33e63_00000", "date": "2024-06-19_02-07-17", "timestamp": 1718777237, "time_this_iter_s": 187.3756070137024, "time_total_s": 18018.872393369675, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18018.872393369675, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 17.787924528301883, "ram_util_percent": 79.1788679245283}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5682085835387785, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009129920353913626, "vf_loss": 7.209949272407638, "vf_explained_var": 0.0013845113900522836, "kl": Infinity, "entropy": 0.39763859371883803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1830.0, "episode_reward_min": 155.0, "episode_reward_mean": 924.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -900.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 92.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1310.0, 1630.0, 940.0, 645.0, 1320.0, 630.0, 1485.0, 845.0, 810.0, 905.0, 1380.0, 375.0, 695.0, 610.0, 880.0, 680.0, 210.0, 1120.0, 310.0, 800.0, 605.0, 1260.0, 1115.0, 700.0, 1170.0, 810.0, 1385.0, 1830.0, 1020.0, 1380.0, 800.0, 960.0, 1830.0, 360.0, 910.0, 970.0, 900.0, 630.0, 1290.0, 1300.0, 1170.0, 960.0, 350.0, 315.0, 660.0, 1500.0, 760.0, 670.0, 890.0, 1260.0, 1000.0, 620.0, 620.0, 280.0, 1190.0, 1280.0, 730.0, 1390.0, 1440.0, 320.0, 1320.0, 700.0, 1390.0, 1100.0, 300.0, 410.0, 1200.0, 1115.0, 690.0, 540.0, 460.0, 1100.0, 1510.0, 685.0, 1250.0, 850.0, 510.0, 405.0, 620.0, 1295.0, 1310.0, 850.0, 155.0, 1220.0, 810.0, 595.0, 1650.0, 795.0, 1030.0, 1125.0, 825.0, 1045.0, 825.0, 1100.0, 1115.0, 1230.0, 225.0, 490.0, 1380.0, 1055.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [330.0, 180.0, 40.0, -90.0, 280.0, 120.0, 80.0, 200.0, 80.0, 90.0, 290.0, 110.0, 20.0, 80.0, 300.0, 330.0, 90.0, 120.0, 100.0, 190.0, 30.0, 90.0, 110.0, 130.0, 20.0, 20.0, 190.0, 90.0, 120.0, 140.0, 210.0, 70.0, 20.0, 40.0, 0.0, 65.0, 40.0, 40.0, 140.0, 20.0, 170.0, 90.0, 20.0, 80.0, 10.0, 130.0, 310.0, 350.0, 110.0, 50.0, 0.0, 20.0, 190.0, 10.0, 110.0, 60.0, 60.0, 50.0, 100.0, 30.0, 90.0, 110.0, -55.0, 0.0, 160.0, 270.0, 420.0, 160.0, 240.0, 90.0, 40.0, 70.0, 210.0, 65.0, 270.0, 20.0, 60.0, 10.0, 30.0, 70.0, 0.0, -40.0, 20.0, 40.0, 190.0, 60.0, 270.0, 60.0, 30.0, 180.0, 70.0, 55.0, 30.0, 50.0, 60.0, 200.0, 80.0, 60.0, 230.0, 70.0, 50.0, 130.0, 10.0, 50.0, 450.0, 210.0, 100.0, 40.0, 160.0, 180.0, -65.0, 30.0, 30.0, 0.0, 15.0, 30.0, 260.0, 100.0, -75.0, 50.0, 65.0, 120.0, 30.0, 20.0, 150.0, 70.0, 0.0, 90.0, 140.0, 10.0, 25.0, 35.0, 40.0, 70.0, 40.0, 70.0, 80.0, 190.0, 20.0, 40.0, 30.0, 100.0, 200.0, 40.0, 30.0, 40.0, 100.0, 90.0, 130.0, 120.0, 20.0, 40.0, 30.0, 30.0, 60.0, 130.0, 30.0, 220.0, 10.0, 110.0, 0.0, 10.0, 40.0, 0.0, 0.0, 50.0, 40.0, 60.0, 0.0, 10.0, 60.0, 40.0, -10.0, 40.0, 10.0, 30.0, 700.0, 40.0, 180.0, 30.0, 0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0, 70.0, 190.0, 80.0, 30.0, 20.0, 180.0, 170.0, 10.0, 40.0, 10.0, 5.0, 30.0, 100.0, 110.0, 80.0, 60.0, 10.0, 50.0, 160.0, 0.0, 170.0, 30.0, 220.0, -60.0, 0.0, 110.0, 260.0, 150.0, 200.0, 180.0, 20.0, 200.0, 200.0, 40.0, 150.0, 15.0, 290.0, 40.0, 60.0, 100.0, 40.0, 20.0, 30.0, 60.0, 10.0, 130.0, 70.0, 80.0, 180.0, 80.0, 270.0, 130.0, 90.0, 50.0, 0.0, 440.0, 100.0, 30.0, 30.0, 30.0, 0.0, 10.0, 20.0, 140.0, 210.0, 150.0, 90.0, 40.0, 0.0, 150.0, 260.0, 220.0, 170.0, 190.0, 50.0, 100.0, -10.0, 20.0, -15.0, 400.0, 80.0, 50.0, 130.0, 490.0, 150.0, 50.0, 80.0, 490.0, 150.0, 160.0, 40.0, 80.0, 120.0, 30.0, 50.0, 260.0, 40.0, 110.0, 250.0, 40.0, 360.0, 90.0, 110.0, 10.0, 120.0, 30.0, 220.0, 150.0, 210.0, 80.0, 100.0, 250.0, 80.0, 70.0, 0.0, 10.0, 50.0, 90.0, -60.0, 210.0, 160.0, 300.0, -100.0, 70.0, 70.0, 130.0, 160.0, 70.0, 20.0, 80.0, 220.0, -10.0, 460.0, 100.0, 100.0, 170.0, 450.0, 100.0, 130.0, 110.0, 50.0, 0.0, 60.0, 20.0, 40.0, 40.0, 0.0, 60.0, 60.0, 30.0, 20.0, 110.0, 70.0, -30.0, 30.0, 50.0, 90.0, 60.0, 130.0, 380.0, 70.0, 40.0, 20.0, 170.0, 80.0, 90.0, 60.0, 460.0, 0.0, -20.0, 120.0, 80.0, 60.0, 50.0, 170.0, 40.0, 80.0, 20.0, 40.0, 240.0, 220.0, 20.0, 30.0, 20.0, 40.0, 0.0, 210.0, 20.0, 50.0, 20.0, 50.0, 10.0, 270.0, 70.0, 60.0, 620.0, 30.0, 60.0, 20.0, 100.0, 160.0, 20.0, 210.0, 90.0, 140.0, 10.0, 70.0, 80.0, 360.0, 160.0, 70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0, 10.0, 20.0, 140.0, -20.0, 190.0, 60.0, 180.0, 170.0, 170.0, 40.0, 30.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 20.0, 70.0, -60.0, 20.0, 20.0, -85.0, 30.0, 0.0, 160.0, 0.0, 150.0, 80.0, -20.0, 310.0, 50.0, 0.0, 70.0, 10.0, 90.0, 80.0, 30.0, 40.0, 20.0, 40.0, 40.0, 320.0, 50.0, 550.0, 290.0, 30.0, 60.0, 100.0, 10.0, 540.0, 10.0, 150.0, 40.0, 30.0, 310.0, 30.0, 20.0, -380.0, 30.0, 10.0, 90.0, 150.0, 50.0, 80.0, 140.0, 40.0, 10.0, 70.0, 320.0, -20.0, 190.0, 70.0, 10.0, 30.0, 100.0, 130.0, 30.0, 30.0, 10.0, 330.0, 40.0, 230.0, 250.0, 10.0, 50.0, 270.0, 40.0, 30.0, 460.0, 0.0, 150.0, 10.0, 10.0, 40.0, 20.0, 140.0, 10.0, 160.0, 10.0, 50.0, 0.0, 160.0, 60.0, 50.0, 90.0, 90.0, 70.0, 40.0, 0.0, 120.0, 0.0, 10.0, 60.0, 240.0, 30.0, 70.0, 40.0, 50.0, -900.0, 20.0, 310.0, 180.0, 140.0, 60.0, 280.0, 70.0, 60.0, 60.0, 80.0, 210.0, 90.0, 320.0, 60.0, 50.0, 70.0, 90.0, 50.0, 170.0, 130.0, 160.0, 50.0, 150.0, 30.0, 250.0, 90.0, 300.0, 50.0, 70.0, 160.0, 60.0, 20.0, 170.0, 130.0, 50.0, 40.0, 0.0, 40.0, 60.0, 60.0, 80.0, 80.0, 440.0, 50.0, 160.0, 140.0, 90.0, 240.0, 50.0, 360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0, -290.0, 40.0, 0.0, 40.0, 90.0, 190.0, 70.0, 20.0, 150.0, 10.0, 230.0, 10.0, 80.0, 70.0, 40.0, 370.0, 300.0, 90.0, 70.0, 60.0, 20.0, 90.0, 90.0, 10.0, 30.0, 60.0, 250.0, 110.0, -40.0, 80.0, 180.0, 90.0, 70.0, 220.0, 80.0, 70.0, 230.0, 110.0, 150.0, 190.0, 410.0, 120.0, 170.0, 50.0, 30.0, 50.0, 80.0, 110.0, -30.0, 110.0, 40.0, -30.0, -40.0, 180.0, 90.0, 80.0, -10.0, -30.0, 15.0, 5.0, 40.0, 20.0, 10.0, 40.0, 20.0, 70.0, 40.0, 20.0, 110.0, 40.0, 40.0, 60.0, -60.0, 250.0, 270.0, 160.0, 30.0, -40.0, 160.0, 330.0, 60.0, 140.0, 200.0, 15.0, 40.0, 120.0, 110.0, 190.0, 70.0, 170.0, 20.0, 120.0, 110.0, 80.0, 160.0, 30.0, 40.0, 70.0, 50.0, 10.0, 180.0, 50.0, 90.0, 30.0, 0.0, 0.0, 10.0, 60.0, 10.0, 110.0, 150.0, 30.0, 20.0, 40.0, -40.0, 110.0, 40.0, 20.0, 40.0, 50.0, 210.0, -30.0, 390.0, 110.0, 20.0, 140.0, 80.0, 40.0, 60.0, 80.0, 40.0, 30.0, 10.0, 30.0, 0.0, 850.0, 0.0, 200.0, 20.0, 330.0, 40.0, 60.0, 5.0, 20.0, 100.0, 10.0, 220.0, 70.0, 40.0, 120.0, 50.0, 90.0, 30.0, 280.0, 160.0, 150.0, 160.0, 20.0, 100.0, 210.0, 30.0, 50.0, 40.0, 30.0, 100.0, 70.0, 310.0, 20.0, 180.0, 20.0, -30.0, 20.0, 190.0, 70.0, 20.0, 190.0, 40.0, 30.0, -50.0, 30.0, 75.0, 30.0, 20.0, 100.0, 0.0, 90.0, 40.0, 20.0, 10.0, 20.0, 0.0, 40.0, 40.0, 50.0, 10.0, 240.0, 20.0, 180.0, 30.0, 10.0, 340.0, 45.0, 110.0, 170.0, 80.0, 120.0, 140.0, 180.0, 70.0, 40.0, 350.0, 390.0, -15.0, 60.0, 10.0, 65.0, 160.0, 50.0, 190.0, 50.0, 60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0, 15.0, 10.0, 70.0, 50.0, 25.0, -25.0, 60.0, -10.0, 40.0, -80.0, 130.0, 50.0, 140.0, 20.0, 50.0, 170.0, 120.0, 110.0, 340.0, 90.0, -30.0, 30.0, 70.0, 20.0, 70.0, 250.0, 40.0, 260.0, 100.0, 0.0, 30.0, 40.0, 20.0, 90.0, 10.0, 75.0, 110.0, 170.0, 0.0, 50.0, 70.0, 300.0, 0.0, 340.0, 90.0, 310.0, 100.0, 60.0, 130.0, 250.0, 70.0, 0.0, 270.0, -85.0, 300.0, 70.0, 10.0, 80.0, 10.0, 70.0, 20.0, 30.0, 50.0, 170.0, 110.0, 110.0, 170.0, 270.0, 60.0, 40.0, 20.0, 85.0, 190.0, 170.0, 250.0, 40.0, 90.0, 60.0, 150.0, 70.0, 30.0, 30.0, -10.0, -40.0, 620.0, 30.0, 20.0, 70.0, 130.0, -55.0, 180.0, 60.0, 20.0, 80.0, 340.0, 60.0, 70.0, 50.0, 15.0, 170.0, 300.0, -20.0, 510.0, 20.0, 25.0, 10.0, -70.0, 0.0, 50.0, 0.0, 300.0, 140.0, 40.0, -60.0, 80.0, 70.0, -10.0, 10.0, 60.0, 470.0, 10.0, 60.0, 40.0, 100.0, 270.0, 120.0, 15.0, 200.0, 160.0, 140.0, 370.0, 20.0, -100.0, 680.0, 50.0, 60.0, 10.0, 70.0, 30.0, 40.0, 70.0, 10.0, 20.0, 40.0, 20.0, 20.0, -5.0, 10.0, 20.0, 20.0, 30.0, 80.0, 70.0, 40.0, 20.0, 40.0, 90.0, 100.0, 20.0, 0.0, 270.0, 200.0, 60.0, 90.0, 110.0, 20.0, 30.0, 130.0, 440.0, 30.0, 0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5303155132111363, "mean_inference_ms": 1.4102841752065733, "mean_action_processing_ms": 0.45613437658965594, "mean_env_wait_ms": 1.2458015501781008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012305021286010742, "StateBufferConnector_ms": 0.009896516799926758, "ViewRequirementAgentConnector_ms": 0.39165496826171875}, "num_episodes": 18, "episode_return_max": 1830.0, "episode_return_min": 155.0, "episode_return_mean": 924.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.52664826363167, "num_env_steps_trained_throughput_per_sec": 21.52664826363167, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 187189.707, "restore_workers_time_ms": 0.011, "training_step_time_ms": 187189.663, "sample_time_ms": 2492.791, "learn_time_ms": 184678.718, "learn_throughput": 21.659, "synch_weights_time_ms": 10.022}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "33e63_00000", "date": "2024-06-19_02-10-23", "timestamp": 1718777423, "time_this_iter_s": 185.8551149368286, "time_total_s": 18204.727508306503, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277419d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18204.727508306503, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.23269961977186, "ram_util_percent": 79.76844106463878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5359148016689432, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009438045509035587, "vf_loss": 7.293037328882593, "vf_explained_var": 0.0013651909475255444, "kl": Infinity, "entropy": 0.41784544575709504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1830.0, "episode_reward_min": 155.0, "episode_reward_mean": 976.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -900.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 97.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 800.0, 605.0, 1260.0, 1115.0, 700.0, 1170.0, 810.0, 1385.0, 1830.0, 1020.0, 1380.0, 800.0, 960.0, 1830.0, 360.0, 910.0, 970.0, 900.0, 630.0, 1290.0, 1300.0, 1170.0, 960.0, 350.0, 315.0, 660.0, 1500.0, 760.0, 670.0, 890.0, 1260.0, 1000.0, 620.0, 620.0, 280.0, 1190.0, 1280.0, 730.0, 1390.0, 1440.0, 320.0, 1320.0, 700.0, 1390.0, 1100.0, 300.0, 410.0, 1200.0, 1115.0, 690.0, 540.0, 460.0, 1100.0, 1510.0, 685.0, 1250.0, 850.0, 510.0, 405.0, 620.0, 1295.0, 1310.0, 850.0, 155.0, 1220.0, 810.0, 595.0, 1650.0, 795.0, 1030.0, 1125.0, 825.0, 1045.0, 825.0, 1100.0, 1115.0, 1230.0, 225.0, 490.0, 1380.0, 1055.0, 1260.0, 1235.0, 1610.0, 790.0, 1595.0, 1100.0, 1475.0, 1440.0, 745.0, 1075.0, 1140.0, 290.0, 930.0, 1180.0, 1465.0, 1490.0, 1760.0, 1015.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 40.0, 0.0, 10.0, 10.0, 110.0, 40.0, 40.0, 20.0, 70.0, 190.0, 80.0, 30.0, 20.0, 180.0, 170.0, 10.0, 40.0, 10.0, 5.0, 30.0, 100.0, 110.0, 80.0, 60.0, 10.0, 50.0, 160.0, 0.0, 170.0, 30.0, 220.0, -60.0, 0.0, 110.0, 260.0, 150.0, 200.0, 180.0, 20.0, 200.0, 200.0, 40.0, 150.0, 15.0, 290.0, 40.0, 60.0, 100.0, 40.0, 20.0, 30.0, 60.0, 10.0, 130.0, 70.0, 80.0, 180.0, 80.0, 270.0, 130.0, 90.0, 50.0, 0.0, 440.0, 100.0, 30.0, 30.0, 30.0, 0.0, 10.0, 20.0, 140.0, 210.0, 150.0, 90.0, 40.0, 0.0, 150.0, 260.0, 220.0, 170.0, 190.0, 50.0, 100.0, -10.0, 20.0, -15.0, 400.0, 80.0, 50.0, 130.0, 490.0, 150.0, 50.0, 80.0, 490.0, 150.0, 160.0, 40.0, 80.0, 120.0, 30.0, 50.0, 260.0, 40.0, 110.0, 250.0, 40.0, 360.0, 90.0, 110.0, 10.0, 120.0, 30.0, 220.0, 150.0, 210.0, 80.0, 100.0, 250.0, 80.0, 70.0, 0.0, 10.0, 50.0, 90.0, -60.0, 210.0, 160.0, 300.0, -100.0, 70.0, 70.0, 130.0, 160.0, 70.0, 20.0, 80.0, 220.0, -10.0, 460.0, 100.0, 100.0, 170.0, 450.0, 100.0, 130.0, 110.0, 50.0, 0.0, 60.0, 20.0, 40.0, 40.0, 0.0, 60.0, 60.0, 30.0, 20.0, 110.0, 70.0, -30.0, 30.0, 50.0, 90.0, 60.0, 130.0, 380.0, 70.0, 40.0, 20.0, 170.0, 80.0, 90.0, 60.0, 460.0, 0.0, -20.0, 120.0, 80.0, 60.0, 50.0, 170.0, 40.0, 80.0, 20.0, 40.0, 240.0, 220.0, 20.0, 30.0, 20.0, 40.0, 0.0, 210.0, 20.0, 50.0, 20.0, 50.0, 10.0, 270.0, 70.0, 60.0, 620.0, 30.0, 60.0, 20.0, 100.0, 160.0, 20.0, 210.0, 90.0, 140.0, 10.0, 70.0, 80.0, 360.0, 160.0, 70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0, 10.0, 20.0, 140.0, -20.0, 190.0, 60.0, 180.0, 170.0, 170.0, 40.0, 30.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 20.0, 70.0, -60.0, 20.0, 20.0, -85.0, 30.0, 0.0, 160.0, 0.0, 150.0, 80.0, -20.0, 310.0, 50.0, 0.0, 70.0, 10.0, 90.0, 80.0, 30.0, 40.0, 20.0, 40.0, 40.0, 320.0, 50.0, 550.0, 290.0, 30.0, 60.0, 100.0, 10.0, 540.0, 10.0, 150.0, 40.0, 30.0, 310.0, 30.0, 20.0, -380.0, 30.0, 10.0, 90.0, 150.0, 50.0, 80.0, 140.0, 40.0, 10.0, 70.0, 320.0, -20.0, 190.0, 70.0, 10.0, 30.0, 100.0, 130.0, 30.0, 30.0, 10.0, 330.0, 40.0, 230.0, 250.0, 10.0, 50.0, 270.0, 40.0, 30.0, 460.0, 0.0, 150.0, 10.0, 10.0, 40.0, 20.0, 140.0, 10.0, 160.0, 10.0, 50.0, 0.0, 160.0, 60.0, 50.0, 90.0, 90.0, 70.0, 40.0, 0.0, 120.0, 0.0, 10.0, 60.0, 240.0, 30.0, 70.0, 40.0, 50.0, -900.0, 20.0, 310.0, 180.0, 140.0, 60.0, 280.0, 70.0, 60.0, 60.0, 80.0, 210.0, 90.0, 320.0, 60.0, 50.0, 70.0, 90.0, 50.0, 170.0, 130.0, 160.0, 50.0, 150.0, 30.0, 250.0, 90.0, 300.0, 50.0, 70.0, 160.0, 60.0, 20.0, 170.0, 130.0, 50.0, 40.0, 0.0, 40.0, 60.0, 60.0, 80.0, 80.0, 440.0, 50.0, 160.0, 140.0, 90.0, 240.0, 50.0, 360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0, -290.0, 40.0, 0.0, 40.0, 90.0, 190.0, 70.0, 20.0, 150.0, 10.0, 230.0, 10.0, 80.0, 70.0, 40.0, 370.0, 300.0, 90.0, 70.0, 60.0, 20.0, 90.0, 90.0, 10.0, 30.0, 60.0, 250.0, 110.0, -40.0, 80.0, 180.0, 90.0, 70.0, 220.0, 80.0, 70.0, 230.0, 110.0, 150.0, 190.0, 410.0, 120.0, 170.0, 50.0, 30.0, 50.0, 80.0, 110.0, -30.0, 110.0, 40.0, -30.0, -40.0, 180.0, 90.0, 80.0, -10.0, -30.0, 15.0, 5.0, 40.0, 20.0, 10.0, 40.0, 20.0, 70.0, 40.0, 20.0, 110.0, 40.0, 40.0, 60.0, -60.0, 250.0, 270.0, 160.0, 30.0, -40.0, 160.0, 330.0, 60.0, 140.0, 200.0, 15.0, 40.0, 120.0, 110.0, 190.0, 70.0, 170.0, 20.0, 120.0, 110.0, 80.0, 160.0, 30.0, 40.0, 70.0, 50.0, 10.0, 180.0, 50.0, 90.0, 30.0, 0.0, 0.0, 10.0, 60.0, 10.0, 110.0, 150.0, 30.0, 20.0, 40.0, -40.0, 110.0, 40.0, 20.0, 40.0, 50.0, 210.0, -30.0, 390.0, 110.0, 20.0, 140.0, 80.0, 40.0, 60.0, 80.0, 40.0, 30.0, 10.0, 30.0, 0.0, 850.0, 0.0, 200.0, 20.0, 330.0, 40.0, 60.0, 5.0, 20.0, 100.0, 10.0, 220.0, 70.0, 40.0, 120.0, 50.0, 90.0, 30.0, 280.0, 160.0, 150.0, 160.0, 20.0, 100.0, 210.0, 30.0, 50.0, 40.0, 30.0, 100.0, 70.0, 310.0, 20.0, 180.0, 20.0, -30.0, 20.0, 190.0, 70.0, 20.0, 190.0, 40.0, 30.0, -50.0, 30.0, 75.0, 30.0, 20.0, 100.0, 0.0, 90.0, 40.0, 20.0, 10.0, 20.0, 0.0, 40.0, 40.0, 50.0, 10.0, 240.0, 20.0, 180.0, 30.0, 10.0, 340.0, 45.0, 110.0, 170.0, 80.0, 120.0, 140.0, 180.0, 70.0, 40.0, 350.0, 390.0, -15.0, 60.0, 10.0, 65.0, 160.0, 50.0, 190.0, 50.0, 60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0, 15.0, 10.0, 70.0, 50.0, 25.0, -25.0, 60.0, -10.0, 40.0, -80.0, 130.0, 50.0, 140.0, 20.0, 50.0, 170.0, 120.0, 110.0, 340.0, 90.0, -30.0, 30.0, 70.0, 20.0, 70.0, 250.0, 40.0, 260.0, 100.0, 0.0, 30.0, 40.0, 20.0, 90.0, 10.0, 75.0, 110.0, 170.0, 0.0, 50.0, 70.0, 300.0, 0.0, 340.0, 90.0, 310.0, 100.0, 60.0, 130.0, 250.0, 70.0, 0.0, 270.0, -85.0, 300.0, 70.0, 10.0, 80.0, 10.0, 70.0, 20.0, 30.0, 50.0, 170.0, 110.0, 110.0, 170.0, 270.0, 60.0, 40.0, 20.0, 85.0, 190.0, 170.0, 250.0, 40.0, 90.0, 60.0, 150.0, 70.0, 30.0, 30.0, -10.0, -40.0, 620.0, 30.0, 20.0, 70.0, 130.0, -55.0, 180.0, 60.0, 20.0, 80.0, 340.0, 60.0, 70.0, 50.0, 15.0, 170.0, 300.0, -20.0, 510.0, 20.0, 25.0, 10.0, -70.0, 0.0, 50.0, 0.0, 300.0, 140.0, 40.0, -60.0, 80.0, 70.0, -10.0, 10.0, 60.0, 470.0, 10.0, 60.0, 40.0, 100.0, 270.0, 120.0, 15.0, 200.0, 160.0, 140.0, 370.0, 20.0, -100.0, 680.0, 50.0, 60.0, 10.0, 70.0, 30.0, 40.0, 70.0, 10.0, 20.0, 40.0, 20.0, 20.0, -5.0, 10.0, 20.0, 20.0, 30.0, 80.0, 70.0, 40.0, 20.0, 40.0, 90.0, 100.0, 20.0, 0.0, 270.0, 200.0, 60.0, 90.0, 110.0, 20.0, 30.0, 130.0, 440.0, 30.0, 0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0, 180.0, 160.0, 110.0, -140.0, 150.0, 110.0, 80.0, 130.0, 50.0, 430.0, -35.0, -100.0, 290.0, 90.0, 190.0, 610.0, 20.0, -30.0, 30.0, 170.0, 300.0, 170.0, 60.0, 250.0, 120.0, 240.0, 180.0, 60.0, 70.0, 160.0, 120.0, 90.0, 20.0, 50.0, 170.0, 100.0, 40.0, 20.0, 150.0, 30.0, 110.0, 30.0, 100.0, 50.0, 20.0, 335.0, 260.0, 190.0, 150.0, 350.0, 0.0, 200.0, -30.0, 260.0, 10.0, 110.0, 30.0, 210.0, 150.0, 160.0, 80.0, 50.0, 90.0, 30.0, 310.0, 45.0, 80.0, 170.0, 290.0, 330.0, 520.0, 210.0, 60.0, 370.0, 60.0, 5.0, 20.0, 70.0, 45.0, 80.0, 50.0, 20.0, 0.0, -40.0, 40.0, 120.0, 320.0, 35.0, 200.0, 0.0, 150.0, 40.0, 200.0, -15.0, 20.0, 40.0, 340.0, 160.0, 100.0, 40.0, 210.0, 170.0, 370.0, 90.0, 40.0, 90.0, 40.0, 70.0, 30.0, 30.0, 0.0, 40.0, 200.0, 50.0, 10.0, 0.0, -20.0, 10.0, 0.0, 0.0, 210.0, 170.0, 130.0, 20.0, 40.0, 20.0, 70.0, 170.0, 50.0, 50.0, 10.0, 130.0, 100.0, 60.0, 100.0, -60.0, 340.0, 80.0, 110.0, 310.0, 180.0, 180.0, 70.0, 120.0, 0.0, 305.0, 20.0, 50.0, 310.0, 230.0, 50.0, 120.0, 30.0, 300.0, 100.0, 20.0, 70.0, 200.0, 60.0, 540.0, 80.0, 210.0, 60.0, 230.0, 360.0, 300.0, 40.0, 220.0, 60.0, 200.0, 100.0, 70.0, -10.0, 70.0, 200.0, 190.0, 40.0, 130.0, 190.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5299560544909179, "mean_inference_ms": 1.409737426611938, "mean_action_processing_ms": 0.4553877849616104, "mean_env_wait_ms": 1.2455207352020015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012224674224853516, "StateBufferConnector_ms": 0.009729862213134766, "ViewRequirementAgentConnector_ms": 0.38306307792663574}, "num_episodes": 18, "episode_return_max": 1830.0, "episode_return_min": 155.0, "episode_return_mean": 976.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.629175353989957, "num_env_steps_trained_throughput_per_sec": 21.629175353989957, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 187081.47, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187081.425, "sample_time_ms": 2488.853, "learn_time_ms": 184574.395, "learn_throughput": 21.671, "synch_weights_time_ms": 9.979}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "33e63_00000", "date": "2024-06-19_02-13-28", "timestamp": 1718777608, "time_this_iter_s": 184.9425778388977, "time_total_s": 18389.6700861454, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327708e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18389.6700861454, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 16.422605363984673, "ram_util_percent": 79.66973180076627}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.747797718894875, "cur_kl_coeff": 0.7593750000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0077663799123471565, "vf_loss": 7.217586202844898, "vf_explained_var": 0.001474073602241703, "kl": Infinity, "entropy": 0.4134126983067225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 1760.0, "episode_reward_min": 155.0, "episode_reward_mean": 967.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -900.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 96.745}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1170.0, 960.0, 350.0, 315.0, 660.0, 1500.0, 760.0, 670.0, 890.0, 1260.0, 1000.0, 620.0, 620.0, 280.0, 1190.0, 1280.0, 730.0, 1390.0, 1440.0, 320.0, 1320.0, 700.0, 1390.0, 1100.0, 300.0, 410.0, 1200.0, 1115.0, 690.0, 540.0, 460.0, 1100.0, 1510.0, 685.0, 1250.0, 850.0, 510.0, 405.0, 620.0, 1295.0, 1310.0, 850.0, 155.0, 1220.0, 810.0, 595.0, 1650.0, 795.0, 1030.0, 1125.0, 825.0, 1045.0, 825.0, 1100.0, 1115.0, 1230.0, 225.0, 490.0, 1380.0, 1055.0, 1260.0, 1235.0, 1610.0, 790.0, 1595.0, 1100.0, 1475.0, 1440.0, 745.0, 1075.0, 1140.0, 290.0, 930.0, 1180.0, 1465.0, 1490.0, 1760.0, 1015.0, 1230.0, 1240.0, 780.0, 350.0, 1080.0, 570.0, 800.0, 695.0, 535.0, 1265.0, 475.0, 1200.0, 730.0, 890.0, 880.0, 1010.0, 910.0, 1620.0, 1620.0, 1380.0, 920.0, 1285.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 210.0, 140.0, 170.0, 80.0, 70.0, 170.0, 60.0, 60.0, 140.0, 10.0, 20.0, 140.0, -20.0, 190.0, 60.0, 180.0, 170.0, 170.0, 40.0, 30.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 20.0, 70.0, -60.0, 20.0, 20.0, -85.0, 30.0, 0.0, 160.0, 0.0, 150.0, 80.0, -20.0, 310.0, 50.0, 0.0, 70.0, 10.0, 90.0, 80.0, 30.0, 40.0, 20.0, 40.0, 40.0, 320.0, 50.0, 550.0, 290.0, 30.0, 60.0, 100.0, 10.0, 540.0, 10.0, 150.0, 40.0, 30.0, 310.0, 30.0, 20.0, -380.0, 30.0, 10.0, 90.0, 150.0, 50.0, 80.0, 140.0, 40.0, 10.0, 70.0, 320.0, -20.0, 190.0, 70.0, 10.0, 30.0, 100.0, 130.0, 30.0, 30.0, 10.0, 330.0, 40.0, 230.0, 250.0, 10.0, 50.0, 270.0, 40.0, 30.0, 460.0, 0.0, 150.0, 10.0, 10.0, 40.0, 20.0, 140.0, 10.0, 160.0, 10.0, 50.0, 0.0, 160.0, 60.0, 50.0, 90.0, 90.0, 70.0, 40.0, 0.0, 120.0, 0.0, 10.0, 60.0, 240.0, 30.0, 70.0, 40.0, 50.0, -900.0, 20.0, 310.0, 180.0, 140.0, 60.0, 280.0, 70.0, 60.0, 60.0, 80.0, 210.0, 90.0, 320.0, 60.0, 50.0, 70.0, 90.0, 50.0, 170.0, 130.0, 160.0, 50.0, 150.0, 30.0, 250.0, 90.0, 300.0, 50.0, 70.0, 160.0, 60.0, 20.0, 170.0, 130.0, 50.0, 40.0, 0.0, 40.0, 60.0, 60.0, 80.0, 80.0, 440.0, 50.0, 160.0, 140.0, 90.0, 240.0, 50.0, 360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0, -290.0, 40.0, 0.0, 40.0, 90.0, 190.0, 70.0, 20.0, 150.0, 10.0, 230.0, 10.0, 80.0, 70.0, 40.0, 370.0, 300.0, 90.0, 70.0, 60.0, 20.0, 90.0, 90.0, 10.0, 30.0, 60.0, 250.0, 110.0, -40.0, 80.0, 180.0, 90.0, 70.0, 220.0, 80.0, 70.0, 230.0, 110.0, 150.0, 190.0, 410.0, 120.0, 170.0, 50.0, 30.0, 50.0, 80.0, 110.0, -30.0, 110.0, 40.0, -30.0, -40.0, 180.0, 90.0, 80.0, -10.0, -30.0, 15.0, 5.0, 40.0, 20.0, 10.0, 40.0, 20.0, 70.0, 40.0, 20.0, 110.0, 40.0, 40.0, 60.0, -60.0, 250.0, 270.0, 160.0, 30.0, -40.0, 160.0, 330.0, 60.0, 140.0, 200.0, 15.0, 40.0, 120.0, 110.0, 190.0, 70.0, 170.0, 20.0, 120.0, 110.0, 80.0, 160.0, 30.0, 40.0, 70.0, 50.0, 10.0, 180.0, 50.0, 90.0, 30.0, 0.0, 0.0, 10.0, 60.0, 10.0, 110.0, 150.0, 30.0, 20.0, 40.0, -40.0, 110.0, 40.0, 20.0, 40.0, 50.0, 210.0, -30.0, 390.0, 110.0, 20.0, 140.0, 80.0, 40.0, 60.0, 80.0, 40.0, 30.0, 10.0, 30.0, 0.0, 850.0, 0.0, 200.0, 20.0, 330.0, 40.0, 60.0, 5.0, 20.0, 100.0, 10.0, 220.0, 70.0, 40.0, 120.0, 50.0, 90.0, 30.0, 280.0, 160.0, 150.0, 160.0, 20.0, 100.0, 210.0, 30.0, 50.0, 40.0, 30.0, 100.0, 70.0, 310.0, 20.0, 180.0, 20.0, -30.0, 20.0, 190.0, 70.0, 20.0, 190.0, 40.0, 30.0, -50.0, 30.0, 75.0, 30.0, 20.0, 100.0, 0.0, 90.0, 40.0, 20.0, 10.0, 20.0, 0.0, 40.0, 40.0, 50.0, 10.0, 240.0, 20.0, 180.0, 30.0, 10.0, 340.0, 45.0, 110.0, 170.0, 80.0, 120.0, 140.0, 180.0, 70.0, 40.0, 350.0, 390.0, -15.0, 60.0, 10.0, 65.0, 160.0, 50.0, 190.0, 50.0, 60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0, 15.0, 10.0, 70.0, 50.0, 25.0, -25.0, 60.0, -10.0, 40.0, -80.0, 130.0, 50.0, 140.0, 20.0, 50.0, 170.0, 120.0, 110.0, 340.0, 90.0, -30.0, 30.0, 70.0, 20.0, 70.0, 250.0, 40.0, 260.0, 100.0, 0.0, 30.0, 40.0, 20.0, 90.0, 10.0, 75.0, 110.0, 170.0, 0.0, 50.0, 70.0, 300.0, 0.0, 340.0, 90.0, 310.0, 100.0, 60.0, 130.0, 250.0, 70.0, 0.0, 270.0, -85.0, 300.0, 70.0, 10.0, 80.0, 10.0, 70.0, 20.0, 30.0, 50.0, 170.0, 110.0, 110.0, 170.0, 270.0, 60.0, 40.0, 20.0, 85.0, 190.0, 170.0, 250.0, 40.0, 90.0, 60.0, 150.0, 70.0, 30.0, 30.0, -10.0, -40.0, 620.0, 30.0, 20.0, 70.0, 130.0, -55.0, 180.0, 60.0, 20.0, 80.0, 340.0, 60.0, 70.0, 50.0, 15.0, 170.0, 300.0, -20.0, 510.0, 20.0, 25.0, 10.0, -70.0, 0.0, 50.0, 0.0, 300.0, 140.0, 40.0, -60.0, 80.0, 70.0, -10.0, 10.0, 60.0, 470.0, 10.0, 60.0, 40.0, 100.0, 270.0, 120.0, 15.0, 200.0, 160.0, 140.0, 370.0, 20.0, -100.0, 680.0, 50.0, 60.0, 10.0, 70.0, 30.0, 40.0, 70.0, 10.0, 20.0, 40.0, 20.0, 20.0, -5.0, 10.0, 20.0, 20.0, 30.0, 80.0, 70.0, 40.0, 20.0, 40.0, 90.0, 100.0, 20.0, 0.0, 270.0, 200.0, 60.0, 90.0, 110.0, 20.0, 30.0, 130.0, 440.0, 30.0, 0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0, 180.0, 160.0, 110.0, -140.0, 150.0, 110.0, 80.0, 130.0, 50.0, 430.0, -35.0, -100.0, 290.0, 90.0, 190.0, 610.0, 20.0, -30.0, 30.0, 170.0, 300.0, 170.0, 60.0, 250.0, 120.0, 240.0, 180.0, 60.0, 70.0, 160.0, 120.0, 90.0, 20.0, 50.0, 170.0, 100.0, 40.0, 20.0, 150.0, 30.0, 110.0, 30.0, 100.0, 50.0, 20.0, 335.0, 260.0, 190.0, 150.0, 350.0, 0.0, 200.0, -30.0, 260.0, 10.0, 110.0, 30.0, 210.0, 150.0, 160.0, 80.0, 50.0, 90.0, 30.0, 310.0, 45.0, 80.0, 170.0, 290.0, 330.0, 520.0, 210.0, 60.0, 370.0, 60.0, 5.0, 20.0, 70.0, 45.0, 80.0, 50.0, 20.0, 0.0, -40.0, 40.0, 120.0, 320.0, 35.0, 200.0, 0.0, 150.0, 40.0, 200.0, -15.0, 20.0, 40.0, 340.0, 160.0, 100.0, 40.0, 210.0, 170.0, 370.0, 90.0, 40.0, 90.0, 40.0, 70.0, 30.0, 30.0, 0.0, 40.0, 200.0, 50.0, 10.0, 0.0, -20.0, 10.0, 0.0, 0.0, 210.0, 170.0, 130.0, 20.0, 40.0, 20.0, 70.0, 170.0, 50.0, 50.0, 10.0, 130.0, 100.0, 60.0, 100.0, -60.0, 340.0, 80.0, 110.0, 310.0, 180.0, 180.0, 70.0, 120.0, 0.0, 305.0, 20.0, 50.0, 310.0, 230.0, 50.0, 120.0, 30.0, 300.0, 100.0, 20.0, 70.0, 200.0, 60.0, 540.0, 80.0, 210.0, 60.0, 230.0, 360.0, 300.0, 40.0, 220.0, 60.0, 200.0, 100.0, 70.0, -10.0, 70.0, 200.0, 190.0, 40.0, 130.0, 190.0, 35.0, 190.0, 180.0, 50.0, 80.0, 80.0, -50.0, 70.0, 40.0, 80.0, 510.0, 120.0, 110.0, 120.0, 20.0, 120.0, 110.0, 240.0, 130.0, 100.0, 170.0, 100.0, 30.0, 90.0, 110.0, 30.0, 40.0, 90.0, 170.0, 70.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 10.0, 20.0, 80.0, 60.0, 70.0, 50.0, 170.0, 20.0, 30.0, 70.0, 190.0, 110.0, 280.0, 90.0, 70.0, 40.0, 55.0, -5.0, 150.0, 50.0, 30.0, 50.0, 10.0, 100.0, 90.0, 120.0, -40.0, 120.0, 380.0, 10.0, 160.0, 40.0, 40.0, 20.0, -50.0, 60.0, 30.0, 20.0, 90.0, 80.0, 30.0, 190.0, 40.0, 75.0, 80.0, -5.0, 100.0, 150.0, 130.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 235.0, 0.0, 70.0, 170.0, 90.0, 220.0, -30.0, 230.0, 60.0, 220.0, 40.0, 90.0, 10.0, 5.0, 40.0, 100.0, 80.0, 60.0, 15.0, 35.0, 150.0, 80.0, 500.0, 100.0, 80.0, 90.0, 30.0, 170.0, 0.0, 0.0, 140.0, 120.0, 70.0, 50.0, 70.0, 70.0, 60.0, 30.0, 90.0, 30.0, 40.0, 20.0, 30.0, 130.0, 160.0, 50.0, 170.0, 160.0, 30.0, 100.0, 50.0, 40.0, 40.0, 190.0, 140.0, 50.0, 40.0, 100.0, 120.0, 110.0, 70.0, 5.0, 15.0, 90.0, 170.0, 180.0, -10.0, 20.0, 400.0, 70.0, 0.0, 90.0, 450.0, 180.0, 10.0, 70.0, 30.0, 0.0, 70.0, 10.0, 30.0, 190.0, 50.0, 730.0, 140.0, 50.0, 120.0, 230.0, 70.0, 10.0, 80.0, 210.0, 70.0, 220.0, 300.0, 370.0, 100.0, 30.0, 120.0, 120.0, 10.0, 420.0, 90.0, 20.0, 140.0, 10.0, 160.0, 200.0, 40.0, 290.0, 170.0, 10.0, 90.0, 130.0, 40.0, 80.0, 60.0, 90.0, 60.0, 190.0, 300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5297931953965611, "mean_inference_ms": 1.4092453943013914, "mean_action_processing_ms": 0.4544819488295228, "mean_env_wait_ms": 1.2452657737517963, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012673616409301758, "StateBufferConnector_ms": 0.009496450424194336, "ViewRequirementAgentConnector_ms": 0.38866710662841797}, "num_episodes": 22, "episode_return_max": 1760.0, "episode_return_min": 155.0, "episode_return_mean": 967.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.57575459002001, "num_env_steps_trained_throughput_per_sec": 21.57575459002001, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 186873.865, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186873.82, "sample_time_ms": 2498.081, "learn_time_ms": 184357.641, "learn_throughput": 21.697, "synch_weights_time_ms": 10.008}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "33e63_00000", "date": "2024-06-19_02-16-33", "timestamp": 1718777793, "time_this_iter_s": 185.4013488292694, "time_total_s": 18575.07143497467, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327708550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18575.07143497467, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 16.56526717557252, "ram_util_percent": 80.01870229007635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0926806481374594, "cur_kl_coeff": 1.1390624999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.850105660665022, "policy_loss": -0.00703450216000743, "vf_loss": 6.854494492771527, "vf_explained_var": 0.0008713579469849381, "kl": 0.0023226749160448045, "entropy": 0.42403244807189516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 1760.0, "episode_reward_min": 155.0, "episode_reward_mean": 985.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 98.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1440.0, 320.0, 1320.0, 700.0, 1390.0, 1100.0, 300.0, 410.0, 1200.0, 1115.0, 690.0, 540.0, 460.0, 1100.0, 1510.0, 685.0, 1250.0, 850.0, 510.0, 405.0, 620.0, 1295.0, 1310.0, 850.0, 155.0, 1220.0, 810.0, 595.0, 1650.0, 795.0, 1030.0, 1125.0, 825.0, 1045.0, 825.0, 1100.0, 1115.0, 1230.0, 225.0, 490.0, 1380.0, 1055.0, 1260.0, 1235.0, 1610.0, 790.0, 1595.0, 1100.0, 1475.0, 1440.0, 745.0, 1075.0, 1140.0, 290.0, 930.0, 1180.0, 1465.0, 1490.0, 1760.0, 1015.0, 1230.0, 1240.0, 780.0, 350.0, 1080.0, 570.0, 800.0, 695.0, 535.0, 1265.0, 475.0, 1200.0, 730.0, 890.0, 880.0, 1010.0, 910.0, 1620.0, 1620.0, 1380.0, 920.0, 1285.0, 720.0, 1330.0, 1170.0, 940.0, 440.0, 1410.0, 690.0, 655.0, 1005.0, 1350.0, 810.0, 1565.0, 970.0, 1320.0, 925.0, 685.0, 1055.0, 390.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [360.0, 390.0, 80.0, 40.0, 100.0, 170.0, 30.0, 170.0, 50.0, 50.0, -290.0, 40.0, 0.0, 40.0, 90.0, 190.0, 70.0, 20.0, 150.0, 10.0, 230.0, 10.0, 80.0, 70.0, 40.0, 370.0, 300.0, 90.0, 70.0, 60.0, 20.0, 90.0, 90.0, 10.0, 30.0, 60.0, 250.0, 110.0, -40.0, 80.0, 180.0, 90.0, 70.0, 220.0, 80.0, 70.0, 230.0, 110.0, 150.0, 190.0, 410.0, 120.0, 170.0, 50.0, 30.0, 50.0, 80.0, 110.0, -30.0, 110.0, 40.0, -30.0, -40.0, 180.0, 90.0, 80.0, -10.0, -30.0, 15.0, 5.0, 40.0, 20.0, 10.0, 40.0, 20.0, 70.0, 40.0, 20.0, 110.0, 40.0, 40.0, 60.0, -60.0, 250.0, 270.0, 160.0, 30.0, -40.0, 160.0, 330.0, 60.0, 140.0, 200.0, 15.0, 40.0, 120.0, 110.0, 190.0, 70.0, 170.0, 20.0, 120.0, 110.0, 80.0, 160.0, 30.0, 40.0, 70.0, 50.0, 10.0, 180.0, 50.0, 90.0, 30.0, 0.0, 0.0, 10.0, 60.0, 10.0, 110.0, 150.0, 30.0, 20.0, 40.0, -40.0, 110.0, 40.0, 20.0, 40.0, 50.0, 210.0, -30.0, 390.0, 110.0, 20.0, 140.0, 80.0, 40.0, 60.0, 80.0, 40.0, 30.0, 10.0, 30.0, 0.0, 850.0, 0.0, 200.0, 20.0, 330.0, 40.0, 60.0, 5.0, 20.0, 100.0, 10.0, 220.0, 70.0, 40.0, 120.0, 50.0, 90.0, 30.0, 280.0, 160.0, 150.0, 160.0, 20.0, 100.0, 210.0, 30.0, 50.0, 40.0, 30.0, 100.0, 70.0, 310.0, 20.0, 180.0, 20.0, -30.0, 20.0, 190.0, 70.0, 20.0, 190.0, 40.0, 30.0, -50.0, 30.0, 75.0, 30.0, 20.0, 100.0, 0.0, 90.0, 40.0, 20.0, 10.0, 20.0, 0.0, 40.0, 40.0, 50.0, 10.0, 240.0, 20.0, 180.0, 30.0, 10.0, 340.0, 45.0, 110.0, 170.0, 80.0, 120.0, 140.0, 180.0, 70.0, 40.0, 350.0, 390.0, -15.0, 60.0, 10.0, 65.0, 160.0, 50.0, 190.0, 50.0, 60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0, 15.0, 10.0, 70.0, 50.0, 25.0, -25.0, 60.0, -10.0, 40.0, -80.0, 130.0, 50.0, 140.0, 20.0, 50.0, 170.0, 120.0, 110.0, 340.0, 90.0, -30.0, 30.0, 70.0, 20.0, 70.0, 250.0, 40.0, 260.0, 100.0, 0.0, 30.0, 40.0, 20.0, 90.0, 10.0, 75.0, 110.0, 170.0, 0.0, 50.0, 70.0, 300.0, 0.0, 340.0, 90.0, 310.0, 100.0, 60.0, 130.0, 250.0, 70.0, 0.0, 270.0, -85.0, 300.0, 70.0, 10.0, 80.0, 10.0, 70.0, 20.0, 30.0, 50.0, 170.0, 110.0, 110.0, 170.0, 270.0, 60.0, 40.0, 20.0, 85.0, 190.0, 170.0, 250.0, 40.0, 90.0, 60.0, 150.0, 70.0, 30.0, 30.0, -10.0, -40.0, 620.0, 30.0, 20.0, 70.0, 130.0, -55.0, 180.0, 60.0, 20.0, 80.0, 340.0, 60.0, 70.0, 50.0, 15.0, 170.0, 300.0, -20.0, 510.0, 20.0, 25.0, 10.0, -70.0, 0.0, 50.0, 0.0, 300.0, 140.0, 40.0, -60.0, 80.0, 70.0, -10.0, 10.0, 60.0, 470.0, 10.0, 60.0, 40.0, 100.0, 270.0, 120.0, 15.0, 200.0, 160.0, 140.0, 370.0, 20.0, -100.0, 680.0, 50.0, 60.0, 10.0, 70.0, 30.0, 40.0, 70.0, 10.0, 20.0, 40.0, 20.0, 20.0, -5.0, 10.0, 20.0, 20.0, 30.0, 80.0, 70.0, 40.0, 20.0, 40.0, 90.0, 100.0, 20.0, 0.0, 270.0, 200.0, 60.0, 90.0, 110.0, 20.0, 30.0, 130.0, 440.0, 30.0, 0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0, 180.0, 160.0, 110.0, -140.0, 150.0, 110.0, 80.0, 130.0, 50.0, 430.0, -35.0, -100.0, 290.0, 90.0, 190.0, 610.0, 20.0, -30.0, 30.0, 170.0, 300.0, 170.0, 60.0, 250.0, 120.0, 240.0, 180.0, 60.0, 70.0, 160.0, 120.0, 90.0, 20.0, 50.0, 170.0, 100.0, 40.0, 20.0, 150.0, 30.0, 110.0, 30.0, 100.0, 50.0, 20.0, 335.0, 260.0, 190.0, 150.0, 350.0, 0.0, 200.0, -30.0, 260.0, 10.0, 110.0, 30.0, 210.0, 150.0, 160.0, 80.0, 50.0, 90.0, 30.0, 310.0, 45.0, 80.0, 170.0, 290.0, 330.0, 520.0, 210.0, 60.0, 370.0, 60.0, 5.0, 20.0, 70.0, 45.0, 80.0, 50.0, 20.0, 0.0, -40.0, 40.0, 120.0, 320.0, 35.0, 200.0, 0.0, 150.0, 40.0, 200.0, -15.0, 20.0, 40.0, 340.0, 160.0, 100.0, 40.0, 210.0, 170.0, 370.0, 90.0, 40.0, 90.0, 40.0, 70.0, 30.0, 30.0, 0.0, 40.0, 200.0, 50.0, 10.0, 0.0, -20.0, 10.0, 0.0, 0.0, 210.0, 170.0, 130.0, 20.0, 40.0, 20.0, 70.0, 170.0, 50.0, 50.0, 10.0, 130.0, 100.0, 60.0, 100.0, -60.0, 340.0, 80.0, 110.0, 310.0, 180.0, 180.0, 70.0, 120.0, 0.0, 305.0, 20.0, 50.0, 310.0, 230.0, 50.0, 120.0, 30.0, 300.0, 100.0, 20.0, 70.0, 200.0, 60.0, 540.0, 80.0, 210.0, 60.0, 230.0, 360.0, 300.0, 40.0, 220.0, 60.0, 200.0, 100.0, 70.0, -10.0, 70.0, 200.0, 190.0, 40.0, 130.0, 190.0, 35.0, 190.0, 180.0, 50.0, 80.0, 80.0, -50.0, 70.0, 40.0, 80.0, 510.0, 120.0, 110.0, 120.0, 20.0, 120.0, 110.0, 240.0, 130.0, 100.0, 170.0, 100.0, 30.0, 90.0, 110.0, 30.0, 40.0, 90.0, 170.0, 70.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 10.0, 20.0, 80.0, 60.0, 70.0, 50.0, 170.0, 20.0, 30.0, 70.0, 190.0, 110.0, 280.0, 90.0, 70.0, 40.0, 55.0, -5.0, 150.0, 50.0, 30.0, 50.0, 10.0, 100.0, 90.0, 120.0, -40.0, 120.0, 380.0, 10.0, 160.0, 40.0, 40.0, 20.0, -50.0, 60.0, 30.0, 20.0, 90.0, 80.0, 30.0, 190.0, 40.0, 75.0, 80.0, -5.0, 100.0, 150.0, 130.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 235.0, 0.0, 70.0, 170.0, 90.0, 220.0, -30.0, 230.0, 60.0, 220.0, 40.0, 90.0, 10.0, 5.0, 40.0, 100.0, 80.0, 60.0, 15.0, 35.0, 150.0, 80.0, 500.0, 100.0, 80.0, 90.0, 30.0, 170.0, 0.0, 0.0, 140.0, 120.0, 70.0, 50.0, 70.0, 70.0, 60.0, 30.0, 90.0, 30.0, 40.0, 20.0, 30.0, 130.0, 160.0, 50.0, 170.0, 160.0, 30.0, 100.0, 50.0, 40.0, 40.0, 190.0, 140.0, 50.0, 40.0, 100.0, 120.0, 110.0, 70.0, 5.0, 15.0, 90.0, 170.0, 180.0, -10.0, 20.0, 400.0, 70.0, 0.0, 90.0, 450.0, 180.0, 10.0, 70.0, 30.0, 0.0, 70.0, 10.0, 30.0, 190.0, 50.0, 730.0, 140.0, 50.0, 120.0, 230.0, 70.0, 10.0, 80.0, 210.0, 70.0, 220.0, 300.0, 370.0, 100.0, 30.0, 120.0, 120.0, 10.0, 420.0, 90.0, 20.0, 140.0, 10.0, 160.0, 200.0, 40.0, 290.0, 170.0, 10.0, 90.0, 130.0, 40.0, 80.0, 60.0, 90.0, 60.0, 190.0, 300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0, 80.0, 40.0, 70.0, 200.0, 90.0, 10.0, 40.0, 80.0, 30.0, 80.0, 410.0, -40.0, -40.0, 60.0, 120.0, 140.0, 250.0, 70.0, 150.0, 210.0, 80.0, 180.0, 80.0, 50.0, 170.0, 160.0, 150.0, 70.0, 50.0, 180.0, 60.0, 80.0, 260.0, 30.0, 50.0, 0.0, 130.0, 120.0, 180.0, 30.0, 0.0, 150.0, 20.0, 10.0, 0.0, 210.0, 20.0, 0.0, 0.0, 30.0, 50.0, 540.0, 350.0, 10.0, 10.0, 50.0, 50.0, 60.0, 210.0, 80.0, 20.0, 30.0, 40.0, 30.0, 140.0, 30.0, 70.0, 40.0, 210.0, 80.0, 90.0, 25.0, 30.0, 100.0, 40.0, 80.0, 30.0, 0.0, 250.0, 10.0, 40.0, 130.0, 40.0, 120.0, 180.0, 80.0, 200.0, 90.0, 65.0, 60.0, 20.0, 290.0, 70.0, -10.0, 110.0, 50.0, 540.0, 160.0, 80.0, 40.0, 280.0, 90.0, 40.0, 0.0, 60.0, 70.0, 30.0, 80.0, 50.0, 110.0, 70.0, 40.0, 590.0, 180.0, 270.0, 30.0, 40.0, 205.0, 130.0, 10.0, 210.0, 170.0, 80.0, 70.0, 140.0, 40.0, 85.0, -95.0, 230.0, 40.0, -50.0, -30.0, 280.0, 80.0, 0.0, 0.0, 210.0, 230.0, 610.0, -10.0, 110.0, 270.0, 90.0, 10.0, 15.0, 60.0, 60.0, 20.0, 160.0, 130.0, 0.0, 10.0, 50.0, 50.0, 220.0, 160.0, 120.0, 15.0, 10.0, 50.0, 260.0, 260.0, 160.0, 20.0, 150.0, 40.0, 15.0, 140.0, 40.0, -30.0, 0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5298344346284691, "mean_inference_ms": 1.4088746272683388, "mean_action_processing_ms": 0.4537802378539462, "mean_env_wait_ms": 1.245033937585717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012428522109985352, "StateBufferConnector_ms": 0.009498834609985352, "ViewRequirementAgentConnector_ms": 0.38686609268188477}, "num_episodes": 18, "episode_return_max": 1760.0, "episode_return_min": 155.0, "episode_return_mean": 985.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.623640088616526, "num_env_steps_trained_throughput_per_sec": 21.623640088616526, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 186605.731, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186605.687, "sample_time_ms": 2490.759, "learn_time_ms": 184096.571, "learn_throughput": 21.728, "synch_weights_time_ms": 10.463}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "33e63_00000", "date": "2024-06-19_02-19-38", "timestamp": 1718777978, "time_this_iter_s": 184.99067783355713, "time_total_s": 18760.062112808228, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277089d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18760.062112808228, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 16.070992366412217, "ram_util_percent": 79.75763358778626}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.335476961049536, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.878161945332861, "policy_loss": -0.008322396802024656, "vf_loss": 6.884395542388526, "vf_explained_var": 0.001213396839694347, "kl": 0.0036675860232822004, "entropy": 0.3869041696365395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 1760.0, "episode_reward_min": 155.0, "episode_reward_mean": 991.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 730.0}, "policy_reward_mean": {"policy_0": 99.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [850.0, 155.0, 1220.0, 810.0, 595.0, 1650.0, 795.0, 1030.0, 1125.0, 825.0, 1045.0, 825.0, 1100.0, 1115.0, 1230.0, 225.0, 490.0, 1380.0, 1055.0, 1260.0, 1235.0, 1610.0, 790.0, 1595.0, 1100.0, 1475.0, 1440.0, 745.0, 1075.0, 1140.0, 290.0, 930.0, 1180.0, 1465.0, 1490.0, 1760.0, 1015.0, 1230.0, 1240.0, 780.0, 350.0, 1080.0, 570.0, 800.0, 695.0, 535.0, 1265.0, 475.0, 1200.0, 730.0, 890.0, 880.0, 1010.0, 910.0, 1620.0, 1620.0, 1380.0, 920.0, 1285.0, 720.0, 1330.0, 1170.0, 940.0, 440.0, 1410.0, 690.0, 655.0, 1005.0, 1350.0, 810.0, 1565.0, 970.0, 1320.0, 925.0, 685.0, 1055.0, 390.0, 715.0, 1480.0, 950.0, 835.0, 1095.0, 1400.0, 995.0, 900.0, 1080.0, 640.0, 570.0, 690.0, 1060.0, 900.0, 825.0, 980.0, 880.0, 930.0, 1070.0, 1490.0, 410.0, 330.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 90.0, 60.0, 40.0, 50.0, 40.0, 170.0, 20.0, 60.0, 260.0, 15.0, 10.0, 70.0, 50.0, 25.0, -25.0, 60.0, -10.0, 40.0, -80.0, 130.0, 50.0, 140.0, 20.0, 50.0, 170.0, 120.0, 110.0, 340.0, 90.0, -30.0, 30.0, 70.0, 20.0, 70.0, 250.0, 40.0, 260.0, 100.0, 0.0, 30.0, 40.0, 20.0, 90.0, 10.0, 75.0, 110.0, 170.0, 0.0, 50.0, 70.0, 300.0, 0.0, 340.0, 90.0, 310.0, 100.0, 60.0, 130.0, 250.0, 70.0, 0.0, 270.0, -85.0, 300.0, 70.0, 10.0, 80.0, 10.0, 70.0, 20.0, 30.0, 50.0, 170.0, 110.0, 110.0, 170.0, 270.0, 60.0, 40.0, 20.0, 85.0, 190.0, 170.0, 250.0, 40.0, 90.0, 60.0, 150.0, 70.0, 30.0, 30.0, -10.0, -40.0, 620.0, 30.0, 20.0, 70.0, 130.0, -55.0, 180.0, 60.0, 20.0, 80.0, 340.0, 60.0, 70.0, 50.0, 15.0, 170.0, 300.0, -20.0, 510.0, 20.0, 25.0, 10.0, -70.0, 0.0, 50.0, 0.0, 300.0, 140.0, 40.0, -60.0, 80.0, 70.0, -10.0, 10.0, 60.0, 470.0, 10.0, 60.0, 40.0, 100.0, 270.0, 120.0, 15.0, 200.0, 160.0, 140.0, 370.0, 20.0, -100.0, 680.0, 50.0, 60.0, 10.0, 70.0, 30.0, 40.0, 70.0, 10.0, 20.0, 40.0, 20.0, 20.0, -5.0, 10.0, 20.0, 20.0, 30.0, 80.0, 70.0, 40.0, 20.0, 40.0, 90.0, 100.0, 20.0, 0.0, 270.0, 200.0, 60.0, 90.0, 110.0, 20.0, 30.0, 130.0, 440.0, 30.0, 0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0, 180.0, 160.0, 110.0, -140.0, 150.0, 110.0, 80.0, 130.0, 50.0, 430.0, -35.0, -100.0, 290.0, 90.0, 190.0, 610.0, 20.0, -30.0, 30.0, 170.0, 300.0, 170.0, 60.0, 250.0, 120.0, 240.0, 180.0, 60.0, 70.0, 160.0, 120.0, 90.0, 20.0, 50.0, 170.0, 100.0, 40.0, 20.0, 150.0, 30.0, 110.0, 30.0, 100.0, 50.0, 20.0, 335.0, 260.0, 190.0, 150.0, 350.0, 0.0, 200.0, -30.0, 260.0, 10.0, 110.0, 30.0, 210.0, 150.0, 160.0, 80.0, 50.0, 90.0, 30.0, 310.0, 45.0, 80.0, 170.0, 290.0, 330.0, 520.0, 210.0, 60.0, 370.0, 60.0, 5.0, 20.0, 70.0, 45.0, 80.0, 50.0, 20.0, 0.0, -40.0, 40.0, 120.0, 320.0, 35.0, 200.0, 0.0, 150.0, 40.0, 200.0, -15.0, 20.0, 40.0, 340.0, 160.0, 100.0, 40.0, 210.0, 170.0, 370.0, 90.0, 40.0, 90.0, 40.0, 70.0, 30.0, 30.0, 0.0, 40.0, 200.0, 50.0, 10.0, 0.0, -20.0, 10.0, 0.0, 0.0, 210.0, 170.0, 130.0, 20.0, 40.0, 20.0, 70.0, 170.0, 50.0, 50.0, 10.0, 130.0, 100.0, 60.0, 100.0, -60.0, 340.0, 80.0, 110.0, 310.0, 180.0, 180.0, 70.0, 120.0, 0.0, 305.0, 20.0, 50.0, 310.0, 230.0, 50.0, 120.0, 30.0, 300.0, 100.0, 20.0, 70.0, 200.0, 60.0, 540.0, 80.0, 210.0, 60.0, 230.0, 360.0, 300.0, 40.0, 220.0, 60.0, 200.0, 100.0, 70.0, -10.0, 70.0, 200.0, 190.0, 40.0, 130.0, 190.0, 35.0, 190.0, 180.0, 50.0, 80.0, 80.0, -50.0, 70.0, 40.0, 80.0, 510.0, 120.0, 110.0, 120.0, 20.0, 120.0, 110.0, 240.0, 130.0, 100.0, 170.0, 100.0, 30.0, 90.0, 110.0, 30.0, 40.0, 90.0, 170.0, 70.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 10.0, 20.0, 80.0, 60.0, 70.0, 50.0, 170.0, 20.0, 30.0, 70.0, 190.0, 110.0, 280.0, 90.0, 70.0, 40.0, 55.0, -5.0, 150.0, 50.0, 30.0, 50.0, 10.0, 100.0, 90.0, 120.0, -40.0, 120.0, 380.0, 10.0, 160.0, 40.0, 40.0, 20.0, -50.0, 60.0, 30.0, 20.0, 90.0, 80.0, 30.0, 190.0, 40.0, 75.0, 80.0, -5.0, 100.0, 150.0, 130.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 235.0, 0.0, 70.0, 170.0, 90.0, 220.0, -30.0, 230.0, 60.0, 220.0, 40.0, 90.0, 10.0, 5.0, 40.0, 100.0, 80.0, 60.0, 15.0, 35.0, 150.0, 80.0, 500.0, 100.0, 80.0, 90.0, 30.0, 170.0, 0.0, 0.0, 140.0, 120.0, 70.0, 50.0, 70.0, 70.0, 60.0, 30.0, 90.0, 30.0, 40.0, 20.0, 30.0, 130.0, 160.0, 50.0, 170.0, 160.0, 30.0, 100.0, 50.0, 40.0, 40.0, 190.0, 140.0, 50.0, 40.0, 100.0, 120.0, 110.0, 70.0, 5.0, 15.0, 90.0, 170.0, 180.0, -10.0, 20.0, 400.0, 70.0, 0.0, 90.0, 450.0, 180.0, 10.0, 70.0, 30.0, 0.0, 70.0, 10.0, 30.0, 190.0, 50.0, 730.0, 140.0, 50.0, 120.0, 230.0, 70.0, 10.0, 80.0, 210.0, 70.0, 220.0, 300.0, 370.0, 100.0, 30.0, 120.0, 120.0, 10.0, 420.0, 90.0, 20.0, 140.0, 10.0, 160.0, 200.0, 40.0, 290.0, 170.0, 10.0, 90.0, 130.0, 40.0, 80.0, 60.0, 90.0, 60.0, 190.0, 300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0, 80.0, 40.0, 70.0, 200.0, 90.0, 10.0, 40.0, 80.0, 30.0, 80.0, 410.0, -40.0, -40.0, 60.0, 120.0, 140.0, 250.0, 70.0, 150.0, 210.0, 80.0, 180.0, 80.0, 50.0, 170.0, 160.0, 150.0, 70.0, 50.0, 180.0, 60.0, 80.0, 260.0, 30.0, 50.0, 0.0, 130.0, 120.0, 180.0, 30.0, 0.0, 150.0, 20.0, 10.0, 0.0, 210.0, 20.0, 0.0, 0.0, 30.0, 50.0, 540.0, 350.0, 10.0, 10.0, 50.0, 50.0, 60.0, 210.0, 80.0, 20.0, 30.0, 40.0, 30.0, 140.0, 30.0, 70.0, 40.0, 210.0, 80.0, 90.0, 25.0, 30.0, 100.0, 40.0, 80.0, 30.0, 0.0, 250.0, 10.0, 40.0, 130.0, 40.0, 120.0, 180.0, 80.0, 200.0, 90.0, 65.0, 60.0, 20.0, 290.0, 70.0, -10.0, 110.0, 50.0, 540.0, 160.0, 80.0, 40.0, 280.0, 90.0, 40.0, 0.0, 60.0, 70.0, 30.0, 80.0, 50.0, 110.0, 70.0, 40.0, 590.0, 180.0, 270.0, 30.0, 40.0, 205.0, 130.0, 10.0, 210.0, 170.0, 80.0, 70.0, 140.0, 40.0, 85.0, -95.0, 230.0, 40.0, -50.0, -30.0, 280.0, 80.0, 0.0, 0.0, 210.0, 230.0, 610.0, -10.0, 110.0, 270.0, 90.0, 10.0, 15.0, 60.0, 60.0, 20.0, 160.0, 130.0, 0.0, 10.0, 50.0, 50.0, 220.0, 160.0, 120.0, 15.0, 10.0, 50.0, 260.0, 260.0, 160.0, 20.0, 150.0, 40.0, 15.0, 140.0, 40.0, -30.0, 0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0, 85.0, 110.0, 70.0, 230.0, 30.0, 10.0, 80.0, 30.0, 70.0, 0.0, 300.0, -20.0, 50.0, 40.0, 100.0, 550.0, 110.0, 100.0, 220.0, 30.0, 0.0, 90.0, 10.0, 40.0, 70.0, 510.0, -10.0, 110.0, 100.0, 30.0, 85.0, 30.0, 40.0, 480.0, -30.0, 0.0, 120.0, 90.0, 10.0, 10.0, 300.0, 120.0, -25.0, 130.0, 50.0, 80.0, 310.0, 110.0, 50.0, -30.0, 170.0, 160.0, 310.0, 110.0, 250.0, 160.0, 60.0, 60.0, 50.0, 70.0, 80.0, 300.0, 15.0, 180.0, 80.0, 200.0, 40.0, 50.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 20.0, 270.0, 110.0, 20.0, 80.0, 70.0, 160.0, 120.0, 20.0, 140.0, 50.0, 60.0, 70.0, 230.0, 100.0, 130.0, 60.0, 0.0, 25.0, 70.0, 160.0, 15.0, 60.0, 20.0, 30.0, 200.0, 120.0, 30.0, 230.0, 40.0, 20.0, 40.0, 40.0, 40.0, 10.0, 0.0, 235.0, 10.0, -20.0, 120.0, 40.0, 170.0, 90.0, 0.0, 45.0, 0.0, 40.0, 70.0, 200.0, 110.0, 110.0, 140.0, 130.0, 140.0, 90.0, 30.0, 140.0, 40.0, 40.0, 30.0, 290.0, 10.0, 80.0, 160.0, 60.0, 50.0, 70.0, 40.0, -90.0, 80.0, 55.0, 60.0, 210.0, 100.0, 250.0, 50.0, 0.0, 230.0, 100.0, 110.0, 120.0, 70.0, 100.0, 110.0, 110.0, 30.0, 10.0, 0.0, 50.0, 40.0, 140.0, 170.0, 40.0, 150.0, 220.0, 60.0, 120.0, 80.0, 80.0, 100.0, 160.0, 50.0, 100.0, 0.0, 10.0, 230.0, -20.0, 90.0, 80.0, 580.0, 40.0, 90.0, 130.0, 70.0, -10.0, 20.0, 170.0, 300.0, 50.0, 40.0, 100.0, 190.0, 50.0, 50.0, 90.0, 450.0, 10.0, -270.0, 40.0, 40.0, 80.0, 40.0, 70.0, 260.0, 50.0, 90.0, 30.0, 30.0, 0.0, 15.0, 40.0, 150.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5298533905426117, "mean_inference_ms": 1.4086688353638233, "mean_action_processing_ms": 0.45294618144238, "mean_env_wait_ms": 1.2447832435177733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012444734573364258, "StateBufferConnector_ms": 0.009522676467895508, "ViewRequirementAgentConnector_ms": 0.38965678215026855}, "num_episodes": 23, "episode_return_max": 1760.0, "episode_return_min": 155.0, "episode_return_mean": 991.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.52779071181525, "num_env_steps_trained_throughput_per_sec": 21.52779071181525, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 186471.68, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186471.635, "sample_time_ms": 2478.057, "learn_time_ms": 183975.009, "learn_throughput": 21.742, "synch_weights_time_ms": 10.567}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "33e63_00000", "date": "2024-06-19_02-22-44", "timestamp": 1718778164, "time_this_iter_s": 185.81516909599304, "time_total_s": 18945.87728190422, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327742550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 18945.87728190422, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 16.573764258555133, "ram_util_percent": 79.67452471482889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.869247812127915, "cur_kl_coeff": 0.28476562499999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007977496232902899, "vf_loss": 7.356042747781935, "vf_explained_var": 0.0004967372638348955, "kl": Infinity, "entropy": 0.376668189516781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 1760.0, "episode_reward_min": 290.0, "episode_reward_mean": 1028.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 102.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1055.0, 1260.0, 1235.0, 1610.0, 790.0, 1595.0, 1100.0, 1475.0, 1440.0, 745.0, 1075.0, 1140.0, 290.0, 930.0, 1180.0, 1465.0, 1490.0, 1760.0, 1015.0, 1230.0, 1240.0, 780.0, 350.0, 1080.0, 570.0, 800.0, 695.0, 535.0, 1265.0, 475.0, 1200.0, 730.0, 890.0, 880.0, 1010.0, 910.0, 1620.0, 1620.0, 1380.0, 920.0, 1285.0, 720.0, 1330.0, 1170.0, 940.0, 440.0, 1410.0, 690.0, 655.0, 1005.0, 1350.0, 810.0, 1565.0, 970.0, 1320.0, 925.0, 685.0, 1055.0, 390.0, 715.0, 1480.0, 950.0, 835.0, 1095.0, 1400.0, 995.0, 900.0, 1080.0, 640.0, 570.0, 690.0, 1060.0, 900.0, 825.0, 980.0, 880.0, 930.0, 1070.0, 1490.0, 410.0, 330.0, 910.0, 910.0, 990.0, 1480.0, 1695.0, 1310.0, 810.0, 1060.0, 1040.0, 750.0, 900.0, 1380.0, 1260.0, 1180.0, 1185.0, 1610.0, 1240.0, 330.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 60.0, 270.0, 50.0, 205.0, 140.0, 180.0, 20.0, 110.0, 180.0, 160.0, 110.0, -140.0, 150.0, 110.0, 80.0, 130.0, 50.0, 430.0, -35.0, -100.0, 290.0, 90.0, 190.0, 610.0, 20.0, -30.0, 30.0, 170.0, 300.0, 170.0, 60.0, 250.0, 120.0, 240.0, 180.0, 60.0, 70.0, 160.0, 120.0, 90.0, 20.0, 50.0, 170.0, 100.0, 40.0, 20.0, 150.0, 30.0, 110.0, 30.0, 100.0, 50.0, 20.0, 335.0, 260.0, 190.0, 150.0, 350.0, 0.0, 200.0, -30.0, 260.0, 10.0, 110.0, 30.0, 210.0, 150.0, 160.0, 80.0, 50.0, 90.0, 30.0, 310.0, 45.0, 80.0, 170.0, 290.0, 330.0, 520.0, 210.0, 60.0, 370.0, 60.0, 5.0, 20.0, 70.0, 45.0, 80.0, 50.0, 20.0, 0.0, -40.0, 40.0, 120.0, 320.0, 35.0, 200.0, 0.0, 150.0, 40.0, 200.0, -15.0, 20.0, 40.0, 340.0, 160.0, 100.0, 40.0, 210.0, 170.0, 370.0, 90.0, 40.0, 90.0, 40.0, 70.0, 30.0, 30.0, 0.0, 40.0, 200.0, 50.0, 10.0, 0.0, -20.0, 10.0, 0.0, 0.0, 210.0, 170.0, 130.0, 20.0, 40.0, 20.0, 70.0, 170.0, 50.0, 50.0, 10.0, 130.0, 100.0, 60.0, 100.0, -60.0, 340.0, 80.0, 110.0, 310.0, 180.0, 180.0, 70.0, 120.0, 0.0, 305.0, 20.0, 50.0, 310.0, 230.0, 50.0, 120.0, 30.0, 300.0, 100.0, 20.0, 70.0, 200.0, 60.0, 540.0, 80.0, 210.0, 60.0, 230.0, 360.0, 300.0, 40.0, 220.0, 60.0, 200.0, 100.0, 70.0, -10.0, 70.0, 200.0, 190.0, 40.0, 130.0, 190.0, 35.0, 190.0, 180.0, 50.0, 80.0, 80.0, -50.0, 70.0, 40.0, 80.0, 510.0, 120.0, 110.0, 120.0, 20.0, 120.0, 110.0, 240.0, 130.0, 100.0, 170.0, 100.0, 30.0, 90.0, 110.0, 30.0, 40.0, 90.0, 170.0, 70.0, 50.0, 10.0, 0.0, 40.0, 40.0, 20.0, 10.0, 20.0, 80.0, 60.0, 70.0, 50.0, 170.0, 20.0, 30.0, 70.0, 190.0, 110.0, 280.0, 90.0, 70.0, 40.0, 55.0, -5.0, 150.0, 50.0, 30.0, 50.0, 10.0, 100.0, 90.0, 120.0, -40.0, 120.0, 380.0, 10.0, 160.0, 40.0, 40.0, 20.0, -50.0, 60.0, 30.0, 20.0, 90.0, 80.0, 30.0, 190.0, 40.0, 75.0, 80.0, -5.0, 100.0, 150.0, 130.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 235.0, 0.0, 70.0, 170.0, 90.0, 220.0, -30.0, 230.0, 60.0, 220.0, 40.0, 90.0, 10.0, 5.0, 40.0, 100.0, 80.0, 60.0, 15.0, 35.0, 150.0, 80.0, 500.0, 100.0, 80.0, 90.0, 30.0, 170.0, 0.0, 0.0, 140.0, 120.0, 70.0, 50.0, 70.0, 70.0, 60.0, 30.0, 90.0, 30.0, 40.0, 20.0, 30.0, 130.0, 160.0, 50.0, 170.0, 160.0, 30.0, 100.0, 50.0, 40.0, 40.0, 190.0, 140.0, 50.0, 40.0, 100.0, 120.0, 110.0, 70.0, 5.0, 15.0, 90.0, 170.0, 180.0, -10.0, 20.0, 400.0, 70.0, 0.0, 90.0, 450.0, 180.0, 10.0, 70.0, 30.0, 0.0, 70.0, 10.0, 30.0, 190.0, 50.0, 730.0, 140.0, 50.0, 120.0, 230.0, 70.0, 10.0, 80.0, 210.0, 70.0, 220.0, 300.0, 370.0, 100.0, 30.0, 120.0, 120.0, 10.0, 420.0, 90.0, 20.0, 140.0, 10.0, 160.0, 200.0, 40.0, 290.0, 170.0, 10.0, 90.0, 130.0, 40.0, 80.0, 60.0, 90.0, 60.0, 190.0, 300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0, 80.0, 40.0, 70.0, 200.0, 90.0, 10.0, 40.0, 80.0, 30.0, 80.0, 410.0, -40.0, -40.0, 60.0, 120.0, 140.0, 250.0, 70.0, 150.0, 210.0, 80.0, 180.0, 80.0, 50.0, 170.0, 160.0, 150.0, 70.0, 50.0, 180.0, 60.0, 80.0, 260.0, 30.0, 50.0, 0.0, 130.0, 120.0, 180.0, 30.0, 0.0, 150.0, 20.0, 10.0, 0.0, 210.0, 20.0, 0.0, 0.0, 30.0, 50.0, 540.0, 350.0, 10.0, 10.0, 50.0, 50.0, 60.0, 210.0, 80.0, 20.0, 30.0, 40.0, 30.0, 140.0, 30.0, 70.0, 40.0, 210.0, 80.0, 90.0, 25.0, 30.0, 100.0, 40.0, 80.0, 30.0, 0.0, 250.0, 10.0, 40.0, 130.0, 40.0, 120.0, 180.0, 80.0, 200.0, 90.0, 65.0, 60.0, 20.0, 290.0, 70.0, -10.0, 110.0, 50.0, 540.0, 160.0, 80.0, 40.0, 280.0, 90.0, 40.0, 0.0, 60.0, 70.0, 30.0, 80.0, 50.0, 110.0, 70.0, 40.0, 590.0, 180.0, 270.0, 30.0, 40.0, 205.0, 130.0, 10.0, 210.0, 170.0, 80.0, 70.0, 140.0, 40.0, 85.0, -95.0, 230.0, 40.0, -50.0, -30.0, 280.0, 80.0, 0.0, 0.0, 210.0, 230.0, 610.0, -10.0, 110.0, 270.0, 90.0, 10.0, 15.0, 60.0, 60.0, 20.0, 160.0, 130.0, 0.0, 10.0, 50.0, 50.0, 220.0, 160.0, 120.0, 15.0, 10.0, 50.0, 260.0, 260.0, 160.0, 20.0, 150.0, 40.0, 15.0, 140.0, 40.0, -30.0, 0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0, 85.0, 110.0, 70.0, 230.0, 30.0, 10.0, 80.0, 30.0, 70.0, 0.0, 300.0, -20.0, 50.0, 40.0, 100.0, 550.0, 110.0, 100.0, 220.0, 30.0, 0.0, 90.0, 10.0, 40.0, 70.0, 510.0, -10.0, 110.0, 100.0, 30.0, 85.0, 30.0, 40.0, 480.0, -30.0, 0.0, 120.0, 90.0, 10.0, 10.0, 300.0, 120.0, -25.0, 130.0, 50.0, 80.0, 310.0, 110.0, 50.0, -30.0, 170.0, 160.0, 310.0, 110.0, 250.0, 160.0, 60.0, 60.0, 50.0, 70.0, 80.0, 300.0, 15.0, 180.0, 80.0, 200.0, 40.0, 50.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 20.0, 270.0, 110.0, 20.0, 80.0, 70.0, 160.0, 120.0, 20.0, 140.0, 50.0, 60.0, 70.0, 230.0, 100.0, 130.0, 60.0, 0.0, 25.0, 70.0, 160.0, 15.0, 60.0, 20.0, 30.0, 200.0, 120.0, 30.0, 230.0, 40.0, 20.0, 40.0, 40.0, 40.0, 10.0, 0.0, 235.0, 10.0, -20.0, 120.0, 40.0, 170.0, 90.0, 0.0, 45.0, 0.0, 40.0, 70.0, 200.0, 110.0, 110.0, 140.0, 130.0, 140.0, 90.0, 30.0, 140.0, 40.0, 40.0, 30.0, 290.0, 10.0, 80.0, 160.0, 60.0, 50.0, 70.0, 40.0, -90.0, 80.0, 55.0, 60.0, 210.0, 100.0, 250.0, 50.0, 0.0, 230.0, 100.0, 110.0, 120.0, 70.0, 100.0, 110.0, 110.0, 30.0, 10.0, 0.0, 50.0, 40.0, 140.0, 170.0, 40.0, 150.0, 220.0, 60.0, 120.0, 80.0, 80.0, 100.0, 160.0, 50.0, 100.0, 0.0, 10.0, 230.0, -20.0, 90.0, 80.0, 580.0, 40.0, 90.0, 130.0, 70.0, -10.0, 20.0, 170.0, 300.0, 50.0, 40.0, 100.0, 190.0, 50.0, 50.0, 90.0, 450.0, 10.0, -270.0, 40.0, 40.0, 80.0, 40.0, 70.0, 260.0, 50.0, 90.0, 30.0, 30.0, 0.0, 15.0, 40.0, 150.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0, 140.0, 50.0, -90.0, 200.0, 80.0, 20.0, 290.0, 80.0, 80.0, 60.0, -50.0, 170.0, 40.0, 110.0, 80.0, 310.0, 0.0, 120.0, 40.0, 170.0, 40.0, 240.0, 300.0, 190.0, 500.0, 10.0, -30.0, 60.0, 60.0, 110.0, -30.0, 60.0, 170.0, 320.0, 480.0, 175.0, -40.0, 220.0, 240.0, 100.0, 260.0, 30.0, 50.0, 25.0, 120.0, 320.0, 110.0, 90.0, 260.0, 45.0, 60.0, 430.0, 30.0, 10.0, 10.0, 30.0, 60.0, 20.0, 10.0, 150.0, 20.0, 70.0, 20.0, 140.0, 100.0, 40.0, 20.0, 70.0, 520.0, 60.0, 150.0, 90.0, 90.0, 250.0, 80.0, 120.0, 160.0, 60.0, 40.0, 0.0, 70.0, 30.0, 10.0, 150.0, 40.0, 10.0, 70.0, 30.0, 30.0, 310.0, 20.0, 70.0, 810.0, 30.0, 0.0, 30.0, 0.0, 10.0, -40.0, -30.0, 180.0, 100.0, 100.0, 170.0, 190.0, 240.0, 20.0, 210.0, 120.0, 50.0, 60.0, 40.0, 20.0, 60.0, 180.0, 80.0, 180.0, 130.0, 160.0, 350.0, -10.0, -20.0, 100.0, 680.0, -10.0, 230.0, 170.0, -40.0, 40.0, 40.0, 150.0, 50.0, 550.0, 0.0, 80.0, 300.0, 20.0, -85.0, 190.0, -70.0, 640.0, 290.0, 130.0, 10.0, 190.0, 70.0, 90.0, 120.0, 20.0, 50.0, 140.0, 50.0, 100.0, 100.0, 190.0, -10.0, 130.0, 170.0, -50.0, 420.0, 20.0, 30.0, 40.0, 40.0, 40.0, 70.0, 20.0, 0.0, 10.0, 60.0, 40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5301072922217094, "mean_inference_ms": 1.4087373932851757, "mean_action_processing_ms": 0.45229773630858, "mean_env_wait_ms": 1.2446796676454015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012374401092529297, "StateBufferConnector_ms": 0.009334325790405273, "ViewRequirementAgentConnector_ms": 0.386289119720459}, "num_episodes": 18, "episode_return_max": 1760.0, "episode_return_min": 290.0, "episode_return_mean": 1028.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.440981574898966, "num_env_steps_trained_throughput_per_sec": 21.440981574898966, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 186531.634, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186531.565, "sample_time_ms": 2454.547, "learn_time_ms": 184058.307, "learn_throughput": 21.732, "synch_weights_time_ms": 10.167}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "33e63_00000", "date": "2024-06-19_02-25-50", "timestamp": 1718778350, "time_this_iter_s": 186.58614706993103, "time_total_s": 19132.46342897415, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327742d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19132.46342897415, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 17.65681818181818, "ram_util_percent": 79.90227272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6666383117723007, "cur_kl_coeff": 0.4271484374999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.707043910610536, "policy_loss": -0.007239438427443079, "vf_loss": 6.71254475495051, "vf_explained_var": 0.0006002288276014237, "kl": 0.004070236028130023, "entropy": 0.41226785796138044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 1695.0, "episode_reward_min": 145.0, "episode_reward_mean": 939.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 93.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 1080.0, 570.0, 800.0, 695.0, 535.0, 1265.0, 475.0, 1200.0, 730.0, 890.0, 880.0, 1010.0, 910.0, 1620.0, 1620.0, 1380.0, 920.0, 1285.0, 720.0, 1330.0, 1170.0, 940.0, 440.0, 1410.0, 690.0, 655.0, 1005.0, 1350.0, 810.0, 1565.0, 970.0, 1320.0, 925.0, 685.0, 1055.0, 390.0, 715.0, 1480.0, 950.0, 835.0, 1095.0, 1400.0, 995.0, 900.0, 1080.0, 640.0, 570.0, 690.0, 1060.0, 900.0, 825.0, 980.0, 880.0, 930.0, 1070.0, 1490.0, 410.0, 330.0, 910.0, 910.0, 990.0, 1480.0, 1695.0, 1310.0, 810.0, 1060.0, 1040.0, 750.0, 900.0, 1380.0, 1260.0, 1180.0, 1185.0, 1610.0, 1240.0, 330.0, 1040.0, 760.0, 1140.0, 145.0, 805.0, 1200.0, 630.0, 475.0, 1080.0, 960.0, 700.0, 1080.0, 600.0, 370.0, 700.0, 1355.0, 895.0, 730.0, 870.0, 1005.0, 630.0, 370.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 40.0, 40.0, 20.0, 10.0, 20.0, 80.0, 60.0, 70.0, 50.0, 170.0, 20.0, 30.0, 70.0, 190.0, 110.0, 280.0, 90.0, 70.0, 40.0, 55.0, -5.0, 150.0, 50.0, 30.0, 50.0, 10.0, 100.0, 90.0, 120.0, -40.0, 120.0, 380.0, 10.0, 160.0, 40.0, 40.0, 20.0, -50.0, 60.0, 30.0, 20.0, 90.0, 80.0, 30.0, 190.0, 40.0, 75.0, 80.0, -5.0, 100.0, 150.0, 130.0, 60.0, 40.0, 0.0, 40.0, 0.0, 20.0, 235.0, 0.0, 70.0, 170.0, 90.0, 220.0, -30.0, 230.0, 60.0, 220.0, 40.0, 90.0, 10.0, 5.0, 40.0, 100.0, 80.0, 60.0, 15.0, 35.0, 150.0, 80.0, 500.0, 100.0, 80.0, 90.0, 30.0, 170.0, 0.0, 0.0, 140.0, 120.0, 70.0, 50.0, 70.0, 70.0, 60.0, 30.0, 90.0, 30.0, 40.0, 20.0, 30.0, 130.0, 160.0, 50.0, 170.0, 160.0, 30.0, 100.0, 50.0, 40.0, 40.0, 190.0, 140.0, 50.0, 40.0, 100.0, 120.0, 110.0, 70.0, 5.0, 15.0, 90.0, 170.0, 180.0, -10.0, 20.0, 400.0, 70.0, 0.0, 90.0, 450.0, 180.0, 10.0, 70.0, 30.0, 0.0, 70.0, 10.0, 30.0, 190.0, 50.0, 730.0, 140.0, 50.0, 120.0, 230.0, 70.0, 10.0, 80.0, 210.0, 70.0, 220.0, 300.0, 370.0, 100.0, 30.0, 120.0, 120.0, 10.0, 420.0, 90.0, 20.0, 140.0, 10.0, 160.0, 200.0, 40.0, 290.0, 170.0, 10.0, 90.0, 130.0, 40.0, 80.0, 60.0, 90.0, 60.0, 190.0, 300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0, 80.0, 40.0, 70.0, 200.0, 90.0, 10.0, 40.0, 80.0, 30.0, 80.0, 410.0, -40.0, -40.0, 60.0, 120.0, 140.0, 250.0, 70.0, 150.0, 210.0, 80.0, 180.0, 80.0, 50.0, 170.0, 160.0, 150.0, 70.0, 50.0, 180.0, 60.0, 80.0, 260.0, 30.0, 50.0, 0.0, 130.0, 120.0, 180.0, 30.0, 0.0, 150.0, 20.0, 10.0, 0.0, 210.0, 20.0, 0.0, 0.0, 30.0, 50.0, 540.0, 350.0, 10.0, 10.0, 50.0, 50.0, 60.0, 210.0, 80.0, 20.0, 30.0, 40.0, 30.0, 140.0, 30.0, 70.0, 40.0, 210.0, 80.0, 90.0, 25.0, 30.0, 100.0, 40.0, 80.0, 30.0, 0.0, 250.0, 10.0, 40.0, 130.0, 40.0, 120.0, 180.0, 80.0, 200.0, 90.0, 65.0, 60.0, 20.0, 290.0, 70.0, -10.0, 110.0, 50.0, 540.0, 160.0, 80.0, 40.0, 280.0, 90.0, 40.0, 0.0, 60.0, 70.0, 30.0, 80.0, 50.0, 110.0, 70.0, 40.0, 590.0, 180.0, 270.0, 30.0, 40.0, 205.0, 130.0, 10.0, 210.0, 170.0, 80.0, 70.0, 140.0, 40.0, 85.0, -95.0, 230.0, 40.0, -50.0, -30.0, 280.0, 80.0, 0.0, 0.0, 210.0, 230.0, 610.0, -10.0, 110.0, 270.0, 90.0, 10.0, 15.0, 60.0, 60.0, 20.0, 160.0, 130.0, 0.0, 10.0, 50.0, 50.0, 220.0, 160.0, 120.0, 15.0, 10.0, 50.0, 260.0, 260.0, 160.0, 20.0, 150.0, 40.0, 15.0, 140.0, 40.0, -30.0, 0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0, 85.0, 110.0, 70.0, 230.0, 30.0, 10.0, 80.0, 30.0, 70.0, 0.0, 300.0, -20.0, 50.0, 40.0, 100.0, 550.0, 110.0, 100.0, 220.0, 30.0, 0.0, 90.0, 10.0, 40.0, 70.0, 510.0, -10.0, 110.0, 100.0, 30.0, 85.0, 30.0, 40.0, 480.0, -30.0, 0.0, 120.0, 90.0, 10.0, 10.0, 300.0, 120.0, -25.0, 130.0, 50.0, 80.0, 310.0, 110.0, 50.0, -30.0, 170.0, 160.0, 310.0, 110.0, 250.0, 160.0, 60.0, 60.0, 50.0, 70.0, 80.0, 300.0, 15.0, 180.0, 80.0, 200.0, 40.0, 50.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 20.0, 270.0, 110.0, 20.0, 80.0, 70.0, 160.0, 120.0, 20.0, 140.0, 50.0, 60.0, 70.0, 230.0, 100.0, 130.0, 60.0, 0.0, 25.0, 70.0, 160.0, 15.0, 60.0, 20.0, 30.0, 200.0, 120.0, 30.0, 230.0, 40.0, 20.0, 40.0, 40.0, 40.0, 10.0, 0.0, 235.0, 10.0, -20.0, 120.0, 40.0, 170.0, 90.0, 0.0, 45.0, 0.0, 40.0, 70.0, 200.0, 110.0, 110.0, 140.0, 130.0, 140.0, 90.0, 30.0, 140.0, 40.0, 40.0, 30.0, 290.0, 10.0, 80.0, 160.0, 60.0, 50.0, 70.0, 40.0, -90.0, 80.0, 55.0, 60.0, 210.0, 100.0, 250.0, 50.0, 0.0, 230.0, 100.0, 110.0, 120.0, 70.0, 100.0, 110.0, 110.0, 30.0, 10.0, 0.0, 50.0, 40.0, 140.0, 170.0, 40.0, 150.0, 220.0, 60.0, 120.0, 80.0, 80.0, 100.0, 160.0, 50.0, 100.0, 0.0, 10.0, 230.0, -20.0, 90.0, 80.0, 580.0, 40.0, 90.0, 130.0, 70.0, -10.0, 20.0, 170.0, 300.0, 50.0, 40.0, 100.0, 190.0, 50.0, 50.0, 90.0, 450.0, 10.0, -270.0, 40.0, 40.0, 80.0, 40.0, 70.0, 260.0, 50.0, 90.0, 30.0, 30.0, 0.0, 15.0, 40.0, 150.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0, 140.0, 50.0, -90.0, 200.0, 80.0, 20.0, 290.0, 80.0, 80.0, 60.0, -50.0, 170.0, 40.0, 110.0, 80.0, 310.0, 0.0, 120.0, 40.0, 170.0, 40.0, 240.0, 300.0, 190.0, 500.0, 10.0, -30.0, 60.0, 60.0, 110.0, -30.0, 60.0, 170.0, 320.0, 480.0, 175.0, -40.0, 220.0, 240.0, 100.0, 260.0, 30.0, 50.0, 25.0, 120.0, 320.0, 110.0, 90.0, 260.0, 45.0, 60.0, 430.0, 30.0, 10.0, 10.0, 30.0, 60.0, 20.0, 10.0, 150.0, 20.0, 70.0, 20.0, 140.0, 100.0, 40.0, 20.0, 70.0, 520.0, 60.0, 150.0, 90.0, 90.0, 250.0, 80.0, 120.0, 160.0, 60.0, 40.0, 0.0, 70.0, 30.0, 10.0, 150.0, 40.0, 10.0, 70.0, 30.0, 30.0, 310.0, 20.0, 70.0, 810.0, 30.0, 0.0, 30.0, 0.0, 10.0, -40.0, -30.0, 180.0, 100.0, 100.0, 170.0, 190.0, 240.0, 20.0, 210.0, 120.0, 50.0, 60.0, 40.0, 20.0, 60.0, 180.0, 80.0, 180.0, 130.0, 160.0, 350.0, -10.0, -20.0, 100.0, 680.0, -10.0, 230.0, 170.0, -40.0, 40.0, 40.0, 150.0, 50.0, 550.0, 0.0, 80.0, 300.0, 20.0, -85.0, 190.0, -70.0, 640.0, 290.0, 130.0, 10.0, 190.0, 70.0, 90.0, 120.0, 20.0, 50.0, 140.0, 50.0, 100.0, 100.0, 190.0, -10.0, 130.0, 170.0, -50.0, 420.0, 20.0, 30.0, 40.0, 40.0, 40.0, 70.0, 20.0, 0.0, 10.0, 60.0, 40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0, 20.0, 70.0, 160.0, 30.0, 40.0, 20.0, 90.0, 220.0, 40.0, 70.0, 110.0, 300.0, 60.0, 120.0, 160.0, 30.0, 340.0, 60.0, -130.0, 90.0, 15.0, 0.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 40.0, 360.0, -40.0, -10.0, 40.0, 20.0, 65.0, 30.0, 260.0, 440.0, 210.0, 25.0, 120.0, 80.0, -130.0, 280.0, 60.0, 60.0, 55.0, -20.0, 20.0, 80.0, 110.0, 140.0, -40.0, 40.0, 80.0, 150.0, 70.0, 40.0, 10.0, 60.0, 10.0, -25.0, -30.0, 30.0, 20.0, 10.0, 350.0, 60.0, 470.0, 0.0, 160.0, 100.0, 10.0, 20.0, 120.0, 130.0, 10.0, 50.0, 90.0, 220.0, 20.0, 60.0, 150.0, 60.0, 70.0, 160.0, 80.0, 10.0, 60.0, 50.0, 70.0, 100.0, 50.0, 100.0, 160.0, 30.0, 70.0, 20.0, 30.0, 150.0, -20.0, 260.0, 100.0, 50.0, 250.0, 200.0, 40.0, 50.0, 30.0, 80.0, 40.0, 20.0, 80.0, 20.0, 150.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 20.0, 20.0, 10.0, 140.0, 0.0, 10.0, 70.0, 60.0, 160.0, 40.0, 180.0, 30.0, 20.0, 90.0, 0.0, 50.0, 20.0, 170.0, 270.0, 220.0, 210.0, 275.0, 30.0, 50.0, 70.0, 40.0, 5.0, 30.0, 20.0, 330.0, 80.0, 20.0, 30.0, 30.0, 310.0, 40.0, 50.0, 70.0, 130.0, 110.0, 30.0, 30.0, 60.0, 0.0, 40.0, 210.0, 30.0, 280.0, 90.0, 30.0, 40.0, 90.0, 110.0, 60.0, 10.0, 130.0, 60.0, 100.0, 15.0, 80.0, 60.0, 20.0, 110.0, 170.0, 120.0, 270.0, 80.0, 70.0, 130.0, 10.0, 50.0, 40.0, 30.0, 140.0, 50.0, 30.0, 0.0, 30.0, 20.0, 160.0, 0.0, 0.0, 0.0, 50.0, 70.0, 40.0, 30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5293364341250457, "mean_inference_ms": 1.4078866255149023, "mean_action_processing_ms": 0.45193182938729604, "mean_env_wait_ms": 1.2444934704887507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012369394302368164, "StateBufferConnector_ms": 0.009376049041748047, "ViewRequirementAgentConnector_ms": 0.381619930267334}, "num_episodes": 22, "episode_return_max": 1695.0, "episode_return_min": 145.0, "episode_return_mean": 939.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.268939479270905, "num_env_steps_trained_throughput_per_sec": 21.268939479270905, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 186558.568, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186558.5, "sample_time_ms": 2472.02, "learn_time_ms": 184067.36, "learn_throughput": 21.731, "synch_weights_time_ms": 10.591}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "33e63_00000", "date": "2024-06-19_02-28-59", "timestamp": 1718778539, "time_this_iter_s": 188.08727192878723, "time_total_s": 19320.55070090294, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327919550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19320.55070090294, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.369924812030074, "ram_util_percent": 79.28157894736843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6451145471094515, "cur_kl_coeff": 0.21357421874999996, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.009425441565919922, "vf_loss": 7.368217351667671, "vf_explained_var": 0.0012538797431352674, "kl": Infinity, "entropy": 0.40297262278545143, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 2005.0, "episode_reward_min": 145.0, "episode_reward_mean": 971.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 97.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1285.0, 720.0, 1330.0, 1170.0, 940.0, 440.0, 1410.0, 690.0, 655.0, 1005.0, 1350.0, 810.0, 1565.0, 970.0, 1320.0, 925.0, 685.0, 1055.0, 390.0, 715.0, 1480.0, 950.0, 835.0, 1095.0, 1400.0, 995.0, 900.0, 1080.0, 640.0, 570.0, 690.0, 1060.0, 900.0, 825.0, 980.0, 880.0, 930.0, 1070.0, 1490.0, 410.0, 330.0, 910.0, 910.0, 990.0, 1480.0, 1695.0, 1310.0, 810.0, 1060.0, 1040.0, 750.0, 900.0, 1380.0, 1260.0, 1180.0, 1185.0, 1610.0, 1240.0, 330.0, 1040.0, 760.0, 1140.0, 145.0, 805.0, 1200.0, 630.0, 475.0, 1080.0, 960.0, 700.0, 1080.0, 600.0, 370.0, 700.0, 1355.0, 895.0, 730.0, 870.0, 1005.0, 630.0, 370.0, 520.0, 580.0, 1310.0, 630.0, 505.0, 1670.0, 975.0, 970.0, 2005.0, 820.0, 1110.0, 1240.0, 1720.0, 1050.0, 1445.0, 1270.0, 650.0, 990.0, 1120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [300.0, 280.0, 30.0, 340.0, 10.0, 20.0, 180.0, 70.0, 10.0, 45.0, 80.0, 40.0, 70.0, 200.0, 90.0, 10.0, 40.0, 80.0, 30.0, 80.0, 410.0, -40.0, -40.0, 60.0, 120.0, 140.0, 250.0, 70.0, 150.0, 210.0, 80.0, 180.0, 80.0, 50.0, 170.0, 160.0, 150.0, 70.0, 50.0, 180.0, 60.0, 80.0, 260.0, 30.0, 50.0, 0.0, 130.0, 120.0, 180.0, 30.0, 0.0, 150.0, 20.0, 10.0, 0.0, 210.0, 20.0, 0.0, 0.0, 30.0, 50.0, 540.0, 350.0, 10.0, 10.0, 50.0, 50.0, 60.0, 210.0, 80.0, 20.0, 30.0, 40.0, 30.0, 140.0, 30.0, 70.0, 40.0, 210.0, 80.0, 90.0, 25.0, 30.0, 100.0, 40.0, 80.0, 30.0, 0.0, 250.0, 10.0, 40.0, 130.0, 40.0, 120.0, 180.0, 80.0, 200.0, 90.0, 65.0, 60.0, 20.0, 290.0, 70.0, -10.0, 110.0, 50.0, 540.0, 160.0, 80.0, 40.0, 280.0, 90.0, 40.0, 0.0, 60.0, 70.0, 30.0, 80.0, 50.0, 110.0, 70.0, 40.0, 590.0, 180.0, 270.0, 30.0, 40.0, 205.0, 130.0, 10.0, 210.0, 170.0, 80.0, 70.0, 140.0, 40.0, 85.0, -95.0, 230.0, 40.0, -50.0, -30.0, 280.0, 80.0, 0.0, 0.0, 210.0, 230.0, 610.0, -10.0, 110.0, 270.0, 90.0, 10.0, 15.0, 60.0, 60.0, 20.0, 160.0, 130.0, 0.0, 10.0, 50.0, 50.0, 220.0, 160.0, 120.0, 15.0, 10.0, 50.0, 260.0, 260.0, 160.0, 20.0, 150.0, 40.0, 15.0, 140.0, 40.0, -30.0, 0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0, 85.0, 110.0, 70.0, 230.0, 30.0, 10.0, 80.0, 30.0, 70.0, 0.0, 300.0, -20.0, 50.0, 40.0, 100.0, 550.0, 110.0, 100.0, 220.0, 30.0, 0.0, 90.0, 10.0, 40.0, 70.0, 510.0, -10.0, 110.0, 100.0, 30.0, 85.0, 30.0, 40.0, 480.0, -30.0, 0.0, 120.0, 90.0, 10.0, 10.0, 300.0, 120.0, -25.0, 130.0, 50.0, 80.0, 310.0, 110.0, 50.0, -30.0, 170.0, 160.0, 310.0, 110.0, 250.0, 160.0, 60.0, 60.0, 50.0, 70.0, 80.0, 300.0, 15.0, 180.0, 80.0, 200.0, 40.0, 50.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 20.0, 270.0, 110.0, 20.0, 80.0, 70.0, 160.0, 120.0, 20.0, 140.0, 50.0, 60.0, 70.0, 230.0, 100.0, 130.0, 60.0, 0.0, 25.0, 70.0, 160.0, 15.0, 60.0, 20.0, 30.0, 200.0, 120.0, 30.0, 230.0, 40.0, 20.0, 40.0, 40.0, 40.0, 10.0, 0.0, 235.0, 10.0, -20.0, 120.0, 40.0, 170.0, 90.0, 0.0, 45.0, 0.0, 40.0, 70.0, 200.0, 110.0, 110.0, 140.0, 130.0, 140.0, 90.0, 30.0, 140.0, 40.0, 40.0, 30.0, 290.0, 10.0, 80.0, 160.0, 60.0, 50.0, 70.0, 40.0, -90.0, 80.0, 55.0, 60.0, 210.0, 100.0, 250.0, 50.0, 0.0, 230.0, 100.0, 110.0, 120.0, 70.0, 100.0, 110.0, 110.0, 30.0, 10.0, 0.0, 50.0, 40.0, 140.0, 170.0, 40.0, 150.0, 220.0, 60.0, 120.0, 80.0, 80.0, 100.0, 160.0, 50.0, 100.0, 0.0, 10.0, 230.0, -20.0, 90.0, 80.0, 580.0, 40.0, 90.0, 130.0, 70.0, -10.0, 20.0, 170.0, 300.0, 50.0, 40.0, 100.0, 190.0, 50.0, 50.0, 90.0, 450.0, 10.0, -270.0, 40.0, 40.0, 80.0, 40.0, 70.0, 260.0, 50.0, 90.0, 30.0, 30.0, 0.0, 15.0, 40.0, 150.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0, 140.0, 50.0, -90.0, 200.0, 80.0, 20.0, 290.0, 80.0, 80.0, 60.0, -50.0, 170.0, 40.0, 110.0, 80.0, 310.0, 0.0, 120.0, 40.0, 170.0, 40.0, 240.0, 300.0, 190.0, 500.0, 10.0, -30.0, 60.0, 60.0, 110.0, -30.0, 60.0, 170.0, 320.0, 480.0, 175.0, -40.0, 220.0, 240.0, 100.0, 260.0, 30.0, 50.0, 25.0, 120.0, 320.0, 110.0, 90.0, 260.0, 45.0, 60.0, 430.0, 30.0, 10.0, 10.0, 30.0, 60.0, 20.0, 10.0, 150.0, 20.0, 70.0, 20.0, 140.0, 100.0, 40.0, 20.0, 70.0, 520.0, 60.0, 150.0, 90.0, 90.0, 250.0, 80.0, 120.0, 160.0, 60.0, 40.0, 0.0, 70.0, 30.0, 10.0, 150.0, 40.0, 10.0, 70.0, 30.0, 30.0, 310.0, 20.0, 70.0, 810.0, 30.0, 0.0, 30.0, 0.0, 10.0, -40.0, -30.0, 180.0, 100.0, 100.0, 170.0, 190.0, 240.0, 20.0, 210.0, 120.0, 50.0, 60.0, 40.0, 20.0, 60.0, 180.0, 80.0, 180.0, 130.0, 160.0, 350.0, -10.0, -20.0, 100.0, 680.0, -10.0, 230.0, 170.0, -40.0, 40.0, 40.0, 150.0, 50.0, 550.0, 0.0, 80.0, 300.0, 20.0, -85.0, 190.0, -70.0, 640.0, 290.0, 130.0, 10.0, 190.0, 70.0, 90.0, 120.0, 20.0, 50.0, 140.0, 50.0, 100.0, 100.0, 190.0, -10.0, 130.0, 170.0, -50.0, 420.0, 20.0, 30.0, 40.0, 40.0, 40.0, 70.0, 20.0, 0.0, 10.0, 60.0, 40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0, 20.0, 70.0, 160.0, 30.0, 40.0, 20.0, 90.0, 220.0, 40.0, 70.0, 110.0, 300.0, 60.0, 120.0, 160.0, 30.0, 340.0, 60.0, -130.0, 90.0, 15.0, 0.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 40.0, 360.0, -40.0, -10.0, 40.0, 20.0, 65.0, 30.0, 260.0, 440.0, 210.0, 25.0, 120.0, 80.0, -130.0, 280.0, 60.0, 60.0, 55.0, -20.0, 20.0, 80.0, 110.0, 140.0, -40.0, 40.0, 80.0, 150.0, 70.0, 40.0, 10.0, 60.0, 10.0, -25.0, -30.0, 30.0, 20.0, 10.0, 350.0, 60.0, 470.0, 0.0, 160.0, 100.0, 10.0, 20.0, 120.0, 130.0, 10.0, 50.0, 90.0, 220.0, 20.0, 60.0, 150.0, 60.0, 70.0, 160.0, 80.0, 10.0, 60.0, 50.0, 70.0, 100.0, 50.0, 100.0, 160.0, 30.0, 70.0, 20.0, 30.0, 150.0, -20.0, 260.0, 100.0, 50.0, 250.0, 200.0, 40.0, 50.0, 30.0, 80.0, 40.0, 20.0, 80.0, 20.0, 150.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 20.0, 20.0, 10.0, 140.0, 0.0, 10.0, 70.0, 60.0, 160.0, 40.0, 180.0, 30.0, 20.0, 90.0, 0.0, 50.0, 20.0, 170.0, 270.0, 220.0, 210.0, 275.0, 30.0, 50.0, 70.0, 40.0, 5.0, 30.0, 20.0, 330.0, 80.0, 20.0, 30.0, 30.0, 310.0, 40.0, 50.0, 70.0, 130.0, 110.0, 30.0, 30.0, 60.0, 0.0, 40.0, 210.0, 30.0, 280.0, 90.0, 30.0, 40.0, 90.0, 110.0, 60.0, 10.0, 130.0, 60.0, 100.0, 15.0, 80.0, 60.0, 20.0, 110.0, 170.0, 120.0, 270.0, 80.0, 70.0, 130.0, 10.0, 50.0, 40.0, 30.0, 140.0, 50.0, 30.0, 0.0, 30.0, 20.0, 160.0, 0.0, 0.0, 0.0, 50.0, 70.0, 40.0, 30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0, 200.0, 50.0, 30.0, 60.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 410.0, 280.0, 90.0, 80.0, 60.0, 170.0, 0.0, 40.0, -50.0, 230.0, 0.0, 80.0, 130.0, -10.0, 10.0, 140.0, 80.0, 160.0, 60.0, -20.0, 50.0, 10.0, 70.0, 100.0, 35.0, 10.0, 0.0, 30.0, 90.0, 110.0, 40.0, 240.0, 60.0, -10.0, 120.0, 390.0, 100.0, 280.0, 270.0, 180.0, 95.0, 80.0, 30.0, 130.0, 110.0, 10.0, 50.0, 230.0, 70.0, 170.0, 10.0, 150.0, 70.0, -70.0, 75.0, 25.0, 300.0, 160.0, 190.0, 60.0, 80.0, 590.0, 320.0, 140.0, 80.0, 180.0, 460.0, 90.0, 35.0, 30.0, 50.0, 110.0, 30.0, 80.0, 40.0, 50.0, 90.0, 120.0, 50.0, 200.0, 110.0, 220.0, 160.0, 50.0, 80.0, 50.0, 100.0, 150.0, 80.0, 110.0, 500.0, 30.0, 30.0, 50.0, 60.0, 220.0, 20.0, 30.0, 170.0, 130.0, 110.0, -30.0, 70.0, 220.0, 180.0, 500.0, 180.0, 80.0, 320.0, 90.0, -40.0, 110.0, 40.0, 90.0, 430.0, 80.0, 100.0, 80.0, 90.0, 70.0, 50.0, 110.0, 160.0, 190.0, 60.0, 10.0, 190.0, 10.0, 65.0, 600.0, 580.0, 120.0, 55.0, 110.0, 30.0, 50.0, 160.0, 100.0, 40.0, 25.0, 110.0, 20.0, 70.0, 20.0, 30.0, 110.0, 150.0, 70.0, 70.0, 0.0, 120.0, 90.0, 60.0, 60.0, 60.0, 50.0, 60.0, 250.0, 140.0, 100.0, 20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5301758351850332, "mean_inference_ms": 1.4088208469818995, "mean_action_processing_ms": 0.4509191311288028, "mean_env_wait_ms": 1.2443353712978615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011948585510253906, "StateBufferConnector_ms": 0.009719610214233398, "ViewRequirementAgentConnector_ms": 0.3761558532714844}, "num_episodes": 18, "episode_return_max": 2005.0, "episode_return_min": 145.0, "episode_return_mean": 971.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.404459603142367, "num_env_steps_trained_throughput_per_sec": 21.404459603142367, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 186273.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186273.535, "sample_time_ms": 2492.583, "learn_time_ms": 183761.806, "learn_throughput": 21.767, "synch_weights_time_ms": 10.765}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "33e63_00000", "date": "2024-06-19_02-32-05", "timestamp": 1718778725, "time_this_iter_s": 186.88457584381104, "time_total_s": 19507.43527674675, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327919a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19507.43527674675, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 16.945833333333333, "ram_util_percent": 79.45568181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9647443394881847, "cur_kl_coeff": 0.32036132812500007, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008300447965331408, "vf_loss": 6.951525802784961, "vf_explained_var": 0.0026167428214202166, "kl": Infinity, "entropy": 0.39649862359348326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 2005.0, "episode_reward_min": 145.0, "episode_reward_mean": 966.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -270.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 96.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.0, 715.0, 1480.0, 950.0, 835.0, 1095.0, 1400.0, 995.0, 900.0, 1080.0, 640.0, 570.0, 690.0, 1060.0, 900.0, 825.0, 980.0, 880.0, 930.0, 1070.0, 1490.0, 410.0, 330.0, 910.0, 910.0, 990.0, 1480.0, 1695.0, 1310.0, 810.0, 1060.0, 1040.0, 750.0, 900.0, 1380.0, 1260.0, 1180.0, 1185.0, 1610.0, 1240.0, 330.0, 1040.0, 760.0, 1140.0, 145.0, 805.0, 1200.0, 630.0, 475.0, 1080.0, 960.0, 700.0, 1080.0, 600.0, 370.0, 700.0, 1355.0, 895.0, 730.0, 870.0, 1005.0, 630.0, 370.0, 520.0, 580.0, 1310.0, 630.0, 505.0, 1670.0, 975.0, 970.0, 2005.0, 820.0, 1110.0, 1240.0, 1720.0, 1050.0, 1445.0, 1270.0, 650.0, 990.0, 1120.0, 580.0, 850.0, 710.0, 1500.0, 670.0, 570.0, 870.0, 1340.0, 1060.0, 415.0, 1360.0, 1155.0, 710.0, 1120.0, 1140.0, 1060.0, 1430.0, 1300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 10.0, 0.0, 60.0, 10.0, 20.0, 50.0, 190.0, 30.0, 85.0, 110.0, 70.0, 230.0, 30.0, 10.0, 80.0, 30.0, 70.0, 0.0, 300.0, -20.0, 50.0, 40.0, 100.0, 550.0, 110.0, 100.0, 220.0, 30.0, 0.0, 90.0, 10.0, 40.0, 70.0, 510.0, -10.0, 110.0, 100.0, 30.0, 85.0, 30.0, 40.0, 480.0, -30.0, 0.0, 120.0, 90.0, 10.0, 10.0, 300.0, 120.0, -25.0, 130.0, 50.0, 80.0, 310.0, 110.0, 50.0, -30.0, 170.0, 160.0, 310.0, 110.0, 250.0, 160.0, 60.0, 60.0, 50.0, 70.0, 80.0, 300.0, 15.0, 180.0, 80.0, 200.0, 40.0, 50.0, 30.0, 20.0, 50.0, 180.0, 20.0, 80.0, 20.0, 270.0, 110.0, 20.0, 80.0, 70.0, 160.0, 120.0, 20.0, 140.0, 50.0, 60.0, 70.0, 230.0, 100.0, 130.0, 60.0, 0.0, 25.0, 70.0, 160.0, 15.0, 60.0, 20.0, 30.0, 200.0, 120.0, 30.0, 230.0, 40.0, 20.0, 40.0, 40.0, 40.0, 10.0, 0.0, 235.0, 10.0, -20.0, 120.0, 40.0, 170.0, 90.0, 0.0, 45.0, 0.0, 40.0, 70.0, 200.0, 110.0, 110.0, 140.0, 130.0, 140.0, 90.0, 30.0, 140.0, 40.0, 40.0, 30.0, 290.0, 10.0, 80.0, 160.0, 60.0, 50.0, 70.0, 40.0, -90.0, 80.0, 55.0, 60.0, 210.0, 100.0, 250.0, 50.0, 0.0, 230.0, 100.0, 110.0, 120.0, 70.0, 100.0, 110.0, 110.0, 30.0, 10.0, 0.0, 50.0, 40.0, 140.0, 170.0, 40.0, 150.0, 220.0, 60.0, 120.0, 80.0, 80.0, 100.0, 160.0, 50.0, 100.0, 0.0, 10.0, 230.0, -20.0, 90.0, 80.0, 580.0, 40.0, 90.0, 130.0, 70.0, -10.0, 20.0, 170.0, 300.0, 50.0, 40.0, 100.0, 190.0, 50.0, 50.0, 90.0, 450.0, 10.0, -270.0, 40.0, 40.0, 80.0, 40.0, 70.0, 260.0, 50.0, 90.0, 30.0, 30.0, 0.0, 15.0, 40.0, 150.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0, 140.0, 50.0, -90.0, 200.0, 80.0, 20.0, 290.0, 80.0, 80.0, 60.0, -50.0, 170.0, 40.0, 110.0, 80.0, 310.0, 0.0, 120.0, 40.0, 170.0, 40.0, 240.0, 300.0, 190.0, 500.0, 10.0, -30.0, 60.0, 60.0, 110.0, -30.0, 60.0, 170.0, 320.0, 480.0, 175.0, -40.0, 220.0, 240.0, 100.0, 260.0, 30.0, 50.0, 25.0, 120.0, 320.0, 110.0, 90.0, 260.0, 45.0, 60.0, 430.0, 30.0, 10.0, 10.0, 30.0, 60.0, 20.0, 10.0, 150.0, 20.0, 70.0, 20.0, 140.0, 100.0, 40.0, 20.0, 70.0, 520.0, 60.0, 150.0, 90.0, 90.0, 250.0, 80.0, 120.0, 160.0, 60.0, 40.0, 0.0, 70.0, 30.0, 10.0, 150.0, 40.0, 10.0, 70.0, 30.0, 30.0, 310.0, 20.0, 70.0, 810.0, 30.0, 0.0, 30.0, 0.0, 10.0, -40.0, -30.0, 180.0, 100.0, 100.0, 170.0, 190.0, 240.0, 20.0, 210.0, 120.0, 50.0, 60.0, 40.0, 20.0, 60.0, 180.0, 80.0, 180.0, 130.0, 160.0, 350.0, -10.0, -20.0, 100.0, 680.0, -10.0, 230.0, 170.0, -40.0, 40.0, 40.0, 150.0, 50.0, 550.0, 0.0, 80.0, 300.0, 20.0, -85.0, 190.0, -70.0, 640.0, 290.0, 130.0, 10.0, 190.0, 70.0, 90.0, 120.0, 20.0, 50.0, 140.0, 50.0, 100.0, 100.0, 190.0, -10.0, 130.0, 170.0, -50.0, 420.0, 20.0, 30.0, 40.0, 40.0, 40.0, 70.0, 20.0, 0.0, 10.0, 60.0, 40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0, 20.0, 70.0, 160.0, 30.0, 40.0, 20.0, 90.0, 220.0, 40.0, 70.0, 110.0, 300.0, 60.0, 120.0, 160.0, 30.0, 340.0, 60.0, -130.0, 90.0, 15.0, 0.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 40.0, 360.0, -40.0, -10.0, 40.0, 20.0, 65.0, 30.0, 260.0, 440.0, 210.0, 25.0, 120.0, 80.0, -130.0, 280.0, 60.0, 60.0, 55.0, -20.0, 20.0, 80.0, 110.0, 140.0, -40.0, 40.0, 80.0, 150.0, 70.0, 40.0, 10.0, 60.0, 10.0, -25.0, -30.0, 30.0, 20.0, 10.0, 350.0, 60.0, 470.0, 0.0, 160.0, 100.0, 10.0, 20.0, 120.0, 130.0, 10.0, 50.0, 90.0, 220.0, 20.0, 60.0, 150.0, 60.0, 70.0, 160.0, 80.0, 10.0, 60.0, 50.0, 70.0, 100.0, 50.0, 100.0, 160.0, 30.0, 70.0, 20.0, 30.0, 150.0, -20.0, 260.0, 100.0, 50.0, 250.0, 200.0, 40.0, 50.0, 30.0, 80.0, 40.0, 20.0, 80.0, 20.0, 150.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 20.0, 20.0, 10.0, 140.0, 0.0, 10.0, 70.0, 60.0, 160.0, 40.0, 180.0, 30.0, 20.0, 90.0, 0.0, 50.0, 20.0, 170.0, 270.0, 220.0, 210.0, 275.0, 30.0, 50.0, 70.0, 40.0, 5.0, 30.0, 20.0, 330.0, 80.0, 20.0, 30.0, 30.0, 310.0, 40.0, 50.0, 70.0, 130.0, 110.0, 30.0, 30.0, 60.0, 0.0, 40.0, 210.0, 30.0, 280.0, 90.0, 30.0, 40.0, 90.0, 110.0, 60.0, 10.0, 130.0, 60.0, 100.0, 15.0, 80.0, 60.0, 20.0, 110.0, 170.0, 120.0, 270.0, 80.0, 70.0, 130.0, 10.0, 50.0, 40.0, 30.0, 140.0, 50.0, 30.0, 0.0, 30.0, 20.0, 160.0, 0.0, 0.0, 0.0, 50.0, 70.0, 40.0, 30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0, 200.0, 50.0, 30.0, 60.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 410.0, 280.0, 90.0, 80.0, 60.0, 170.0, 0.0, 40.0, -50.0, 230.0, 0.0, 80.0, 130.0, -10.0, 10.0, 140.0, 80.0, 160.0, 60.0, -20.0, 50.0, 10.0, 70.0, 100.0, 35.0, 10.0, 0.0, 30.0, 90.0, 110.0, 40.0, 240.0, 60.0, -10.0, 120.0, 390.0, 100.0, 280.0, 270.0, 180.0, 95.0, 80.0, 30.0, 130.0, 110.0, 10.0, 50.0, 230.0, 70.0, 170.0, 10.0, 150.0, 70.0, -70.0, 75.0, 25.0, 300.0, 160.0, 190.0, 60.0, 80.0, 590.0, 320.0, 140.0, 80.0, 180.0, 460.0, 90.0, 35.0, 30.0, 50.0, 110.0, 30.0, 80.0, 40.0, 50.0, 90.0, 120.0, 50.0, 200.0, 110.0, 220.0, 160.0, 50.0, 80.0, 50.0, 100.0, 150.0, 80.0, 110.0, 500.0, 30.0, 30.0, 50.0, 60.0, 220.0, 20.0, 30.0, 170.0, 130.0, 110.0, -30.0, 70.0, 220.0, 180.0, 500.0, 180.0, 80.0, 320.0, 90.0, -40.0, 110.0, 40.0, 90.0, 430.0, 80.0, 100.0, 80.0, 90.0, 70.0, 50.0, 110.0, 160.0, 190.0, 60.0, 10.0, 190.0, 10.0, 65.0, 600.0, 580.0, 120.0, 55.0, 110.0, 30.0, 50.0, 160.0, 100.0, 40.0, 25.0, 110.0, 20.0, 70.0, 20.0, 30.0, 110.0, 150.0, 70.0, 70.0, 0.0, 120.0, 90.0, 60.0, 60.0, 60.0, 50.0, 60.0, 250.0, 140.0, 100.0, 20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0, 50.0, 40.0, 30.0, 30.0, 30.0, 220.0, 0.0, 140.0, 20.0, 20.0, 150.0, 170.0, 130.0, 50.0, 20.0, 80.0, 70.0, 30.0, 90.0, 60.0, 20.0, 30.0, 90.0, 30.0, 240.0, 40.0, 130.0, 0.0, 110.0, 20.0, 80.0, 350.0, 150.0, 90.0, 420.0, 290.0, 10.0, 60.0, 70.0, -20.0, 90.0, 30.0, 80.0, 10.0, 140.0, 180.0, 60.0, 0.0, 70.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 230.0, 150.0, 70.0, 190.0, 10.0, 110.0, 140.0, 110.0, 50.0, 20.0, 70.0, 160.0, 10.0, 130.0, 210.0, 30.0, 260.0, 210.0, -60.0, 360.0, 40.0, 80.0, 80.0, 40.0, 30.0, 190.0, 30.0, 120.0, 110.0, 220.0, 230.0, 20.0, 70.0, 220.0, 70.0, 10.0, 0.0, 55.0, 40.0, 10.0, -120.0, 70.0, 60.0, 520.0, -50.0, -20.0, 160.0, 60.0, -30.0, 260.0, 30.0, 370.0, 60.0, 90.0, 80.0, 270.0, -10.0, 50.0, 60.0, 130.0, -20.0, 460.0, 45.0, 10.0, 310.0, 180.0, 30.0, 30.0, 0.0, -30.0, 170.0, 0.0, 10.0, 140.0, 60.0, 40.0, 210.0, 0.0, 0.0, 100.0, 0.0, 200.0, 370.0, 160.0, 140.0, 170.0, 10.0, 60.0, 130.0, 40.0, 70.0, 80.0, 280.0, 230.0, 50.0, 240.0, 260.0, 60.0, 40.0, 70.0, 70.0, -20.0, 60.0, 30.0, 150.0, 40.0, 380.0, 220.0, 280.0, 150.0, 30.0, 50.0, 100.0, 170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5300355754437032, "mean_inference_ms": 1.4088856256816837, "mean_action_processing_ms": 0.45031667457534497, "mean_env_wait_ms": 1.244196410266574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012161493301391602, "StateBufferConnector_ms": 0.00973367691040039, "ViewRequirementAgentConnector_ms": 0.37955713272094727}, "num_episodes": 18, "episode_return_max": 2005.0, "episode_return_min": 145.0, "episode_return_mean": 966.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.483589547482765, "num_env_steps_trained_throughput_per_sec": 21.483589547482765, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 186199.208, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186199.14, "sample_time_ms": 2464.462, "learn_time_ms": 183715.401, "learn_throughput": 21.773, "synch_weights_time_ms": 10.778}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "33e63_00000", "date": "2024-06-19_02-35-12", "timestamp": 1718778912, "time_this_iter_s": 186.1940460205078, "time_total_s": 19693.629322767258, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327919e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19693.629322767258, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 15.945833333333333, "ram_util_percent": 79.47424242424245}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9191023227188406, "cur_kl_coeff": 0.4805419921874999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.008481811753377968, "vf_loss": 6.124254720939742, "vf_explained_var": 0.0015088320413209632, "kl": Infinity, "entropy": 0.4210204454910514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 2005.0, "episode_reward_min": 145.0, "episode_reward_mean": 951.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 810.0}, "policy_reward_mean": {"policy_0": 95.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 910.0, 990.0, 1480.0, 1695.0, 1310.0, 810.0, 1060.0, 1040.0, 750.0, 900.0, 1380.0, 1260.0, 1180.0, 1185.0, 1610.0, 1240.0, 330.0, 1040.0, 760.0, 1140.0, 145.0, 805.0, 1200.0, 630.0, 475.0, 1080.0, 960.0, 700.0, 1080.0, 600.0, 370.0, 700.0, 1355.0, 895.0, 730.0, 870.0, 1005.0, 630.0, 370.0, 520.0, 580.0, 1310.0, 630.0, 505.0, 1670.0, 975.0, 970.0, 2005.0, 820.0, 1110.0, 1240.0, 1720.0, 1050.0, 1445.0, 1270.0, 650.0, 990.0, 1120.0, 580.0, 850.0, 710.0, 1500.0, 670.0, 570.0, 870.0, 1340.0, 1060.0, 415.0, 1360.0, 1155.0, 710.0, 1120.0, 1140.0, 1060.0, 1430.0, 1300.0, 375.0, 550.0, 720.0, 510.0, 290.0, 680.0, 1440.0, 760.0, 225.0, 850.0, 350.0, 910.0, 640.0, 1030.0, 1475.0, 1510.0, 685.0, 900.0, 1650.0, 1210.0, 975.0, 690.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 50.0, 30.0, 240.0, 160.0, 40.0, 10.0, 160.0, 110.0, 90.0, 140.0, 50.0, -90.0, 200.0, 80.0, 20.0, 290.0, 80.0, 80.0, 60.0, -50.0, 170.0, 40.0, 110.0, 80.0, 310.0, 0.0, 120.0, 40.0, 170.0, 40.0, 240.0, 300.0, 190.0, 500.0, 10.0, -30.0, 60.0, 60.0, 110.0, -30.0, 60.0, 170.0, 320.0, 480.0, 175.0, -40.0, 220.0, 240.0, 100.0, 260.0, 30.0, 50.0, 25.0, 120.0, 320.0, 110.0, 90.0, 260.0, 45.0, 60.0, 430.0, 30.0, 10.0, 10.0, 30.0, 60.0, 20.0, 10.0, 150.0, 20.0, 70.0, 20.0, 140.0, 100.0, 40.0, 20.0, 70.0, 520.0, 60.0, 150.0, 90.0, 90.0, 250.0, 80.0, 120.0, 160.0, 60.0, 40.0, 0.0, 70.0, 30.0, 10.0, 150.0, 40.0, 10.0, 70.0, 30.0, 30.0, 310.0, 20.0, 70.0, 810.0, 30.0, 0.0, 30.0, 0.0, 10.0, -40.0, -30.0, 180.0, 100.0, 100.0, 170.0, 190.0, 240.0, 20.0, 210.0, 120.0, 50.0, 60.0, 40.0, 20.0, 60.0, 180.0, 80.0, 180.0, 130.0, 160.0, 350.0, -10.0, -20.0, 100.0, 680.0, -10.0, 230.0, 170.0, -40.0, 40.0, 40.0, 150.0, 50.0, 550.0, 0.0, 80.0, 300.0, 20.0, -85.0, 190.0, -70.0, 640.0, 290.0, 130.0, 10.0, 190.0, 70.0, 90.0, 120.0, 20.0, 50.0, 140.0, 50.0, 100.0, 100.0, 190.0, -10.0, 130.0, 170.0, -50.0, 420.0, 20.0, 30.0, 40.0, 40.0, 40.0, 70.0, 20.0, 0.0, 10.0, 60.0, 40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0, 20.0, 70.0, 160.0, 30.0, 40.0, 20.0, 90.0, 220.0, 40.0, 70.0, 110.0, 300.0, 60.0, 120.0, 160.0, 30.0, 340.0, 60.0, -130.0, 90.0, 15.0, 0.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 40.0, 360.0, -40.0, -10.0, 40.0, 20.0, 65.0, 30.0, 260.0, 440.0, 210.0, 25.0, 120.0, 80.0, -130.0, 280.0, 60.0, 60.0, 55.0, -20.0, 20.0, 80.0, 110.0, 140.0, -40.0, 40.0, 80.0, 150.0, 70.0, 40.0, 10.0, 60.0, 10.0, -25.0, -30.0, 30.0, 20.0, 10.0, 350.0, 60.0, 470.0, 0.0, 160.0, 100.0, 10.0, 20.0, 120.0, 130.0, 10.0, 50.0, 90.0, 220.0, 20.0, 60.0, 150.0, 60.0, 70.0, 160.0, 80.0, 10.0, 60.0, 50.0, 70.0, 100.0, 50.0, 100.0, 160.0, 30.0, 70.0, 20.0, 30.0, 150.0, -20.0, 260.0, 100.0, 50.0, 250.0, 200.0, 40.0, 50.0, 30.0, 80.0, 40.0, 20.0, 80.0, 20.0, 150.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 20.0, 20.0, 10.0, 140.0, 0.0, 10.0, 70.0, 60.0, 160.0, 40.0, 180.0, 30.0, 20.0, 90.0, 0.0, 50.0, 20.0, 170.0, 270.0, 220.0, 210.0, 275.0, 30.0, 50.0, 70.0, 40.0, 5.0, 30.0, 20.0, 330.0, 80.0, 20.0, 30.0, 30.0, 310.0, 40.0, 50.0, 70.0, 130.0, 110.0, 30.0, 30.0, 60.0, 0.0, 40.0, 210.0, 30.0, 280.0, 90.0, 30.0, 40.0, 90.0, 110.0, 60.0, 10.0, 130.0, 60.0, 100.0, 15.0, 80.0, 60.0, 20.0, 110.0, 170.0, 120.0, 270.0, 80.0, 70.0, 130.0, 10.0, 50.0, 40.0, 30.0, 140.0, 50.0, 30.0, 0.0, 30.0, 20.0, 160.0, 0.0, 0.0, 0.0, 50.0, 70.0, 40.0, 30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0, 200.0, 50.0, 30.0, 60.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 410.0, 280.0, 90.0, 80.0, 60.0, 170.0, 0.0, 40.0, -50.0, 230.0, 0.0, 80.0, 130.0, -10.0, 10.0, 140.0, 80.0, 160.0, 60.0, -20.0, 50.0, 10.0, 70.0, 100.0, 35.0, 10.0, 0.0, 30.0, 90.0, 110.0, 40.0, 240.0, 60.0, -10.0, 120.0, 390.0, 100.0, 280.0, 270.0, 180.0, 95.0, 80.0, 30.0, 130.0, 110.0, 10.0, 50.0, 230.0, 70.0, 170.0, 10.0, 150.0, 70.0, -70.0, 75.0, 25.0, 300.0, 160.0, 190.0, 60.0, 80.0, 590.0, 320.0, 140.0, 80.0, 180.0, 460.0, 90.0, 35.0, 30.0, 50.0, 110.0, 30.0, 80.0, 40.0, 50.0, 90.0, 120.0, 50.0, 200.0, 110.0, 220.0, 160.0, 50.0, 80.0, 50.0, 100.0, 150.0, 80.0, 110.0, 500.0, 30.0, 30.0, 50.0, 60.0, 220.0, 20.0, 30.0, 170.0, 130.0, 110.0, -30.0, 70.0, 220.0, 180.0, 500.0, 180.0, 80.0, 320.0, 90.0, -40.0, 110.0, 40.0, 90.0, 430.0, 80.0, 100.0, 80.0, 90.0, 70.0, 50.0, 110.0, 160.0, 190.0, 60.0, 10.0, 190.0, 10.0, 65.0, 600.0, 580.0, 120.0, 55.0, 110.0, 30.0, 50.0, 160.0, 100.0, 40.0, 25.0, 110.0, 20.0, 70.0, 20.0, 30.0, 110.0, 150.0, 70.0, 70.0, 0.0, 120.0, 90.0, 60.0, 60.0, 60.0, 50.0, 60.0, 250.0, 140.0, 100.0, 20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0, 50.0, 40.0, 30.0, 30.0, 30.0, 220.0, 0.0, 140.0, 20.0, 20.0, 150.0, 170.0, 130.0, 50.0, 20.0, 80.0, 70.0, 30.0, 90.0, 60.0, 20.0, 30.0, 90.0, 30.0, 240.0, 40.0, 130.0, 0.0, 110.0, 20.0, 80.0, 350.0, 150.0, 90.0, 420.0, 290.0, 10.0, 60.0, 70.0, -20.0, 90.0, 30.0, 80.0, 10.0, 140.0, 180.0, 60.0, 0.0, 70.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 230.0, 150.0, 70.0, 190.0, 10.0, 110.0, 140.0, 110.0, 50.0, 20.0, 70.0, 160.0, 10.0, 130.0, 210.0, 30.0, 260.0, 210.0, -60.0, 360.0, 40.0, 80.0, 80.0, 40.0, 30.0, 190.0, 30.0, 120.0, 110.0, 220.0, 230.0, 20.0, 70.0, 220.0, 70.0, 10.0, 0.0, 55.0, 40.0, 10.0, -120.0, 70.0, 60.0, 520.0, -50.0, -20.0, 160.0, 60.0, -30.0, 260.0, 30.0, 370.0, 60.0, 90.0, 80.0, 270.0, -10.0, 50.0, 60.0, 130.0, -20.0, 460.0, 45.0, 10.0, 310.0, 180.0, 30.0, 30.0, 0.0, -30.0, 170.0, 0.0, 10.0, 140.0, 60.0, 40.0, 210.0, 0.0, 0.0, 100.0, 0.0, 200.0, 370.0, 160.0, 140.0, 170.0, 10.0, 60.0, 130.0, 40.0, 70.0, 80.0, 280.0, 230.0, 50.0, 240.0, 260.0, 60.0, 40.0, 70.0, 70.0, -20.0, 60.0, 30.0, 150.0, 40.0, 380.0, 220.0, 280.0, 150.0, 30.0, 50.0, 100.0, 170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0, 20.0, 70.0, 0.0, 40.0, 40.0, 20.0, 40.0, -5.0, 120.0, 30.0, 350.0, 20.0, 10.0, 30.0, 10.0, 50.0, 50.0, 0.0, 20.0, 10.0, 110.0, 250.0, 60.0, 60.0, 40.0, 30.0, 30.0, 30.0, 90.0, 20.0, 100.0, -70.0, 180.0, 40.0, 60.0, 30.0, 100.0, 20.0, 10.0, 40.0, 120.0, 20.0, 30.0, 230.0, -310.0, 10.0, 170.0, 0.0, 0.0, 20.0, 80.0, 90.0, 280.0, 50.0, 30.0, -65.0, 90.0, 50.0, 20.0, 55.0, 120.0, 150.0, 120.0, 80.0, 80.0, 400.0, 170.0, 70.0, 210.0, 40.0, 190.0, 20.0, 0.0, 160.0, 100.0, 40.0, 120.0, 90.0, 30.0, 10.0, 20.0, 20.0, 0.0, 20.0, -5.0, 50.0, 50.0, 30.0, 20.0, 20.0, 0.0, 240.0, 20.0, 80.0, 260.0, 90.0, 40.0, 90.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 110.0, 10.0, 0.0, 80.0, 20.0, 50.0, 90.0, 130.0, 100.0, 20.0, 40.0, 250.0, 120.0, 40.0, 70.0, 60.0, 150.0, 30.0, 20.0, 30.0, 40.0, 200.0, 60.0, 10.0, 40.0, 180.0, 0.0, 30.0, 80.0, 10.0, 20.0, 360.0, 170.0, 140.0, 40.0, 90.0, 155.0, 130.0, 150.0, 20.0, 510.0, 160.0, 90.0, 160.0, 10.0, 40.0, 80.0, 20.0, 20.0, -10.0, 260.0, 630.0, 180.0, -10.0, 300.0, 30.0, 25.0, 160.0, 80.0, 20.0, 30.0, 20.0, 20.0, 10.0, 290.0, 180.0, 310.0, 60.0, 0.0, 40.0, 50.0, 100.0, 65.0, 45.0, 50.0, 160.0, 430.0, 320.0, 50.0, 260.0, 90.0, 140.0, 50.0, 50.0, 100.0, 190.0, 30.0, 20.0, 360.0, 180.0, -40.0, 90.0, 100.0, 240.0, 40.0, 80.0, 180.0, 30.0, -10.0, 250.0, -15.0, 60.0, 50.0, 270.0, 80.0, 20.0, 40.0, 160.0, 60.0, 100.0, 0.0, 220.0, 0.0, 40.0, 50.0, 0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.529619414304847, "mean_inference_ms": 1.4088090879081425, "mean_action_processing_ms": 0.4495858590891151, "mean_env_wait_ms": 1.243946996279434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012604236602783203, "StateBufferConnector_ms": 0.009847402572631836, "ViewRequirementAgentConnector_ms": 0.3817427158355713}, "num_episodes": 23, "episode_return_max": 2005.0, "episode_return_min": 145.0, "episode_return_mean": 951.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.535097982741167, "num_env_steps_trained_throughput_per_sec": 21.535097982741167, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 186036.929, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186036.859, "sample_time_ms": 2448.42, "learn_time_ms": 183568.822, "learn_throughput": 21.79, "synch_weights_time_ms": 10.886}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "33e63_00000", "date": "2024-06-19_02-38-17", "timestamp": 1718779097, "time_this_iter_s": 185.75064301490784, "time_total_s": 19879.379965782166, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327742dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 19879.379965782166, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 16.243129770992365, "ram_util_percent": 78.90458015267176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.911373071637524, "cur_kl_coeff": 0.72081298828125, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006945937256258342, "vf_loss": 7.012355009410074, "vf_explained_var": 0.0012254815259045812, "kl": Infinity, "entropy": 0.374096154216062, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 2360.0, "episode_reward_min": 140.0, "episode_reward_mean": 938.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 1080.0}, "policy_reward_mean": {"policy_0": 93.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 760.0, 1140.0, 145.0, 805.0, 1200.0, 630.0, 475.0, 1080.0, 960.0, 700.0, 1080.0, 600.0, 370.0, 700.0, 1355.0, 895.0, 730.0, 870.0, 1005.0, 630.0, 370.0, 520.0, 580.0, 1310.0, 630.0, 505.0, 1670.0, 975.0, 970.0, 2005.0, 820.0, 1110.0, 1240.0, 1720.0, 1050.0, 1445.0, 1270.0, 650.0, 990.0, 1120.0, 580.0, 850.0, 710.0, 1500.0, 670.0, 570.0, 870.0, 1340.0, 1060.0, 415.0, 1360.0, 1155.0, 710.0, 1120.0, 1140.0, 1060.0, 1430.0, 1300.0, 375.0, 550.0, 720.0, 510.0, 290.0, 680.0, 1440.0, 760.0, 225.0, 850.0, 350.0, 910.0, 640.0, 1030.0, 1475.0, 1510.0, 685.0, 900.0, 1650.0, 1210.0, 975.0, 690.0, 760.0, 730.0, 385.0, 1300.0, 1240.0, 800.0, 1340.0, 140.0, 1055.0, 990.0, 1430.0, 2360.0, 1460.0, 620.0, 1130.0, 1380.0, 830.0, 550.0, 970.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 70.0, 170.0, 120.0, 70.0, 20.0, 90.0, 50.0, 110.0, 300.0, 20.0, 70.0, 160.0, 30.0, 40.0, 20.0, 90.0, 220.0, 40.0, 70.0, 110.0, 300.0, 60.0, 120.0, 160.0, 30.0, 340.0, 60.0, -130.0, 90.0, 15.0, 0.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 0.0, 20.0, 40.0, 40.0, 360.0, -40.0, -10.0, 40.0, 20.0, 65.0, 30.0, 260.0, 440.0, 210.0, 25.0, 120.0, 80.0, -130.0, 280.0, 60.0, 60.0, 55.0, -20.0, 20.0, 80.0, 110.0, 140.0, -40.0, 40.0, 80.0, 150.0, 70.0, 40.0, 10.0, 60.0, 10.0, -25.0, -30.0, 30.0, 20.0, 10.0, 350.0, 60.0, 470.0, 0.0, 160.0, 100.0, 10.0, 20.0, 120.0, 130.0, 10.0, 50.0, 90.0, 220.0, 20.0, 60.0, 150.0, 60.0, 70.0, 160.0, 80.0, 10.0, 60.0, 50.0, 70.0, 100.0, 50.0, 100.0, 160.0, 30.0, 70.0, 20.0, 30.0, 150.0, -20.0, 260.0, 100.0, 50.0, 250.0, 200.0, 40.0, 50.0, 30.0, 80.0, 40.0, 20.0, 80.0, 20.0, 150.0, 10.0, 120.0, 10.0, 30.0, 130.0, 0.0, 20.0, 20.0, 10.0, 140.0, 0.0, 10.0, 70.0, 60.0, 160.0, 40.0, 180.0, 30.0, 20.0, 90.0, 0.0, 50.0, 20.0, 170.0, 270.0, 220.0, 210.0, 275.0, 30.0, 50.0, 70.0, 40.0, 5.0, 30.0, 20.0, 330.0, 80.0, 20.0, 30.0, 30.0, 310.0, 40.0, 50.0, 70.0, 130.0, 110.0, 30.0, 30.0, 60.0, 0.0, 40.0, 210.0, 30.0, 280.0, 90.0, 30.0, 40.0, 90.0, 110.0, 60.0, 10.0, 130.0, 60.0, 100.0, 15.0, 80.0, 60.0, 20.0, 110.0, 170.0, 120.0, 270.0, 80.0, 70.0, 130.0, 10.0, 50.0, 40.0, 30.0, 140.0, 50.0, 30.0, 0.0, 30.0, 20.0, 160.0, 0.0, 0.0, 0.0, 50.0, 70.0, 40.0, 30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0, 200.0, 50.0, 30.0, 60.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 410.0, 280.0, 90.0, 80.0, 60.0, 170.0, 0.0, 40.0, -50.0, 230.0, 0.0, 80.0, 130.0, -10.0, 10.0, 140.0, 80.0, 160.0, 60.0, -20.0, 50.0, 10.0, 70.0, 100.0, 35.0, 10.0, 0.0, 30.0, 90.0, 110.0, 40.0, 240.0, 60.0, -10.0, 120.0, 390.0, 100.0, 280.0, 270.0, 180.0, 95.0, 80.0, 30.0, 130.0, 110.0, 10.0, 50.0, 230.0, 70.0, 170.0, 10.0, 150.0, 70.0, -70.0, 75.0, 25.0, 300.0, 160.0, 190.0, 60.0, 80.0, 590.0, 320.0, 140.0, 80.0, 180.0, 460.0, 90.0, 35.0, 30.0, 50.0, 110.0, 30.0, 80.0, 40.0, 50.0, 90.0, 120.0, 50.0, 200.0, 110.0, 220.0, 160.0, 50.0, 80.0, 50.0, 100.0, 150.0, 80.0, 110.0, 500.0, 30.0, 30.0, 50.0, 60.0, 220.0, 20.0, 30.0, 170.0, 130.0, 110.0, -30.0, 70.0, 220.0, 180.0, 500.0, 180.0, 80.0, 320.0, 90.0, -40.0, 110.0, 40.0, 90.0, 430.0, 80.0, 100.0, 80.0, 90.0, 70.0, 50.0, 110.0, 160.0, 190.0, 60.0, 10.0, 190.0, 10.0, 65.0, 600.0, 580.0, 120.0, 55.0, 110.0, 30.0, 50.0, 160.0, 100.0, 40.0, 25.0, 110.0, 20.0, 70.0, 20.0, 30.0, 110.0, 150.0, 70.0, 70.0, 0.0, 120.0, 90.0, 60.0, 60.0, 60.0, 50.0, 60.0, 250.0, 140.0, 100.0, 20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0, 50.0, 40.0, 30.0, 30.0, 30.0, 220.0, 0.0, 140.0, 20.0, 20.0, 150.0, 170.0, 130.0, 50.0, 20.0, 80.0, 70.0, 30.0, 90.0, 60.0, 20.0, 30.0, 90.0, 30.0, 240.0, 40.0, 130.0, 0.0, 110.0, 20.0, 80.0, 350.0, 150.0, 90.0, 420.0, 290.0, 10.0, 60.0, 70.0, -20.0, 90.0, 30.0, 80.0, 10.0, 140.0, 180.0, 60.0, 0.0, 70.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 230.0, 150.0, 70.0, 190.0, 10.0, 110.0, 140.0, 110.0, 50.0, 20.0, 70.0, 160.0, 10.0, 130.0, 210.0, 30.0, 260.0, 210.0, -60.0, 360.0, 40.0, 80.0, 80.0, 40.0, 30.0, 190.0, 30.0, 120.0, 110.0, 220.0, 230.0, 20.0, 70.0, 220.0, 70.0, 10.0, 0.0, 55.0, 40.0, 10.0, -120.0, 70.0, 60.0, 520.0, -50.0, -20.0, 160.0, 60.0, -30.0, 260.0, 30.0, 370.0, 60.0, 90.0, 80.0, 270.0, -10.0, 50.0, 60.0, 130.0, -20.0, 460.0, 45.0, 10.0, 310.0, 180.0, 30.0, 30.0, 0.0, -30.0, 170.0, 0.0, 10.0, 140.0, 60.0, 40.0, 210.0, 0.0, 0.0, 100.0, 0.0, 200.0, 370.0, 160.0, 140.0, 170.0, 10.0, 60.0, 130.0, 40.0, 70.0, 80.0, 280.0, 230.0, 50.0, 240.0, 260.0, 60.0, 40.0, 70.0, 70.0, -20.0, 60.0, 30.0, 150.0, 40.0, 380.0, 220.0, 280.0, 150.0, 30.0, 50.0, 100.0, 170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0, 20.0, 70.0, 0.0, 40.0, 40.0, 20.0, 40.0, -5.0, 120.0, 30.0, 350.0, 20.0, 10.0, 30.0, 10.0, 50.0, 50.0, 0.0, 20.0, 10.0, 110.0, 250.0, 60.0, 60.0, 40.0, 30.0, 30.0, 30.0, 90.0, 20.0, 100.0, -70.0, 180.0, 40.0, 60.0, 30.0, 100.0, 20.0, 10.0, 40.0, 120.0, 20.0, 30.0, 230.0, -310.0, 10.0, 170.0, 0.0, 0.0, 20.0, 80.0, 90.0, 280.0, 50.0, 30.0, -65.0, 90.0, 50.0, 20.0, 55.0, 120.0, 150.0, 120.0, 80.0, 80.0, 400.0, 170.0, 70.0, 210.0, 40.0, 190.0, 20.0, 0.0, 160.0, 100.0, 40.0, 120.0, 90.0, 30.0, 10.0, 20.0, 20.0, 0.0, 20.0, -5.0, 50.0, 50.0, 30.0, 20.0, 20.0, 0.0, 240.0, 20.0, 80.0, 260.0, 90.0, 40.0, 90.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 110.0, 10.0, 0.0, 80.0, 20.0, 50.0, 90.0, 130.0, 100.0, 20.0, 40.0, 250.0, 120.0, 40.0, 70.0, 60.0, 150.0, 30.0, 20.0, 30.0, 40.0, 200.0, 60.0, 10.0, 40.0, 180.0, 0.0, 30.0, 80.0, 10.0, 20.0, 360.0, 170.0, 140.0, 40.0, 90.0, 155.0, 130.0, 150.0, 20.0, 510.0, 160.0, 90.0, 160.0, 10.0, 40.0, 80.0, 20.0, 20.0, -10.0, 260.0, 630.0, 180.0, -10.0, 300.0, 30.0, 25.0, 160.0, 80.0, 20.0, 30.0, 20.0, 20.0, 10.0, 290.0, 180.0, 310.0, 60.0, 0.0, 40.0, 50.0, 100.0, 65.0, 45.0, 50.0, 160.0, 430.0, 320.0, 50.0, 260.0, 90.0, 140.0, 50.0, 50.0, 100.0, 190.0, 30.0, 20.0, 360.0, 180.0, -40.0, 90.0, 100.0, 240.0, 40.0, 80.0, 180.0, 30.0, -10.0, 250.0, -15.0, 60.0, 50.0, 270.0, 80.0, 20.0, 40.0, 160.0, 60.0, 100.0, 0.0, 220.0, 0.0, 40.0, 50.0, 0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0, 120.0, 70.0, 70.0, 250.0, 0.0, 40.0, 30.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 40.0, 160.0, 20.0, 30.0, 100.0, 0.0, 5.0, 60.0, 220.0, 20.0, 230.0, 110.0, 90.0, 170.0, 110.0, 90.0, 200.0, 90.0, 20.0, 60.0, 50.0, 270.0, 380.0, 40.0, 20.0, 80.0, 230.0, 20.0, 30.0, 10.0, 0.0, 180.0, 70.0, 20.0, 40.0, 380.0, 50.0, 140.0, 140.0, 420.0, 80.0, -90.0, 30.0, 70.0, 450.0, 20.0, 80.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 90.0, -10.0, 0.0, 370.0, 30.0, 20.0, 120.0, 180.0, 5.0, -50.0, 100.0, 220.0, 60.0, 20.0, 190.0, 100.0, 160.0, 120.0, 160.0, 40.0, 80.0, 80.0, 40.0, 0.0, 35.0, 110.0, 320.0, 95.0, 110.0, 0.0, 440.0, 160.0, 160.0, -55.0, 270.0, 240.0, 40.0, 350.0, 80.0, 25.0, 150.0, 180.0, 1080.0, 90.0, 130.0, 190.0, 0.0, 90.0, 330.0, -40.0, 0.0, 490.0, 180.0, 90.0, 90.0, 160.0, 40.0, 10.0, 100.0, 20.0, 70.0, 20.0, 20.0, 100.0, 280.0, 30.0, 40.0, 200.0, 110.0, 0.0, 150.0, 30.0, 190.0, 20.0, 270.0, 30.0, 0.0, 60.0, 10.0, 60.0, 30.0, 80.0, 820.0, 140.0, 30.0, 180.0, 60.0, 80.0, 10.0, 20.0, 60.0, 170.0, 80.0, 80.0, 30.0, 70.0, 130.0, 25.0, 20.0, 80.0, 15.0, 50.0, 50.0, 360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.529356326173835, "mean_inference_ms": 1.408524309641598, "mean_action_processing_ms": 0.44898269743073127, "mean_env_wait_ms": 1.2436798477203599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012525320053100586, "StateBufferConnector_ms": 0.009807348251342773, "ViewRequirementAgentConnector_ms": 0.38084912300109863}, "num_episodes": 18, "episode_return_max": 2360.0, "episode_return_min": 140.0, "episode_return_mean": 938.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.510849703652337, "num_env_steps_trained_throughput_per_sec": 21.510849703652337, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 186050.577, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186050.507, "sample_time_ms": 2465.084, "learn_time_ms": 183565.388, "learn_throughput": 21.791, "synch_weights_time_ms": 11.138}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "33e63_00000", "date": "2024-06-19_02-41-23", "timestamp": 1718779283, "time_this_iter_s": 185.96070885658264, "time_total_s": 20065.340674638748, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327919dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20065.340674638748, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.386692015209128, "ram_util_percent": 79.17718631178707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.887920525241584, "cur_kl_coeff": 1.0812194824218753, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.007442111770981473, "vf_loss": 7.311602120709241, "vf_explained_var": 0.0008680145072733886, "kl": Infinity, "entropy": 0.38288218923174916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 2360.0, "episode_reward_min": 140.0, "episode_reward_mean": 980.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 1080.0}, "policy_reward_mean": {"policy_0": 98.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 580.0, 1310.0, 630.0, 505.0, 1670.0, 975.0, 970.0, 2005.0, 820.0, 1110.0, 1240.0, 1720.0, 1050.0, 1445.0, 1270.0, 650.0, 990.0, 1120.0, 580.0, 850.0, 710.0, 1500.0, 670.0, 570.0, 870.0, 1340.0, 1060.0, 415.0, 1360.0, 1155.0, 710.0, 1120.0, 1140.0, 1060.0, 1430.0, 1300.0, 375.0, 550.0, 720.0, 510.0, 290.0, 680.0, 1440.0, 760.0, 225.0, 850.0, 350.0, 910.0, 640.0, 1030.0, 1475.0, 1510.0, 685.0, 900.0, 1650.0, 1210.0, 975.0, 690.0, 760.0, 730.0, 385.0, 1300.0, 1240.0, 800.0, 1340.0, 140.0, 1055.0, 990.0, 1430.0, 2360.0, 1460.0, 620.0, 1130.0, 1380.0, 830.0, 550.0, 970.0, 1140.0, 440.0, 1180.0, 685.0, 470.0, 945.0, 1230.0, 1285.0, 860.0, 1530.0, 650.0, 570.0, 1030.0, 1100.0, 1200.0, 1390.0, 1120.0, 820.0, 930.0, 1510.0, 805.0, 860.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 10.0, 70.0, 90.0, 130.0, 40.0, 80.0, 40.0, 30.0, 0.0, 200.0, 50.0, 30.0, 60.0, 30.0, 100.0, 20.0, 40.0, 20.0, 30.0, 410.0, 280.0, 90.0, 80.0, 60.0, 170.0, 0.0, 40.0, -50.0, 230.0, 0.0, 80.0, 130.0, -10.0, 10.0, 140.0, 80.0, 160.0, 60.0, -20.0, 50.0, 10.0, 70.0, 100.0, 35.0, 10.0, 0.0, 30.0, 90.0, 110.0, 40.0, 240.0, 60.0, -10.0, 120.0, 390.0, 100.0, 280.0, 270.0, 180.0, 95.0, 80.0, 30.0, 130.0, 110.0, 10.0, 50.0, 230.0, 70.0, 170.0, 10.0, 150.0, 70.0, -70.0, 75.0, 25.0, 300.0, 160.0, 190.0, 60.0, 80.0, 590.0, 320.0, 140.0, 80.0, 180.0, 460.0, 90.0, 35.0, 30.0, 50.0, 110.0, 30.0, 80.0, 40.0, 50.0, 90.0, 120.0, 50.0, 200.0, 110.0, 220.0, 160.0, 50.0, 80.0, 50.0, 100.0, 150.0, 80.0, 110.0, 500.0, 30.0, 30.0, 50.0, 60.0, 220.0, 20.0, 30.0, 170.0, 130.0, 110.0, -30.0, 70.0, 220.0, 180.0, 500.0, 180.0, 80.0, 320.0, 90.0, -40.0, 110.0, 40.0, 90.0, 430.0, 80.0, 100.0, 80.0, 90.0, 70.0, 50.0, 110.0, 160.0, 190.0, 60.0, 10.0, 190.0, 10.0, 65.0, 600.0, 580.0, 120.0, 55.0, 110.0, 30.0, 50.0, 160.0, 100.0, 40.0, 25.0, 110.0, 20.0, 70.0, 20.0, 30.0, 110.0, 150.0, 70.0, 70.0, 0.0, 120.0, 90.0, 60.0, 60.0, 60.0, 50.0, 60.0, 250.0, 140.0, 100.0, 20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0, 50.0, 40.0, 30.0, 30.0, 30.0, 220.0, 0.0, 140.0, 20.0, 20.0, 150.0, 170.0, 130.0, 50.0, 20.0, 80.0, 70.0, 30.0, 90.0, 60.0, 20.0, 30.0, 90.0, 30.0, 240.0, 40.0, 130.0, 0.0, 110.0, 20.0, 80.0, 350.0, 150.0, 90.0, 420.0, 290.0, 10.0, 60.0, 70.0, -20.0, 90.0, 30.0, 80.0, 10.0, 140.0, 180.0, 60.0, 0.0, 70.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 230.0, 150.0, 70.0, 190.0, 10.0, 110.0, 140.0, 110.0, 50.0, 20.0, 70.0, 160.0, 10.0, 130.0, 210.0, 30.0, 260.0, 210.0, -60.0, 360.0, 40.0, 80.0, 80.0, 40.0, 30.0, 190.0, 30.0, 120.0, 110.0, 220.0, 230.0, 20.0, 70.0, 220.0, 70.0, 10.0, 0.0, 55.0, 40.0, 10.0, -120.0, 70.0, 60.0, 520.0, -50.0, -20.0, 160.0, 60.0, -30.0, 260.0, 30.0, 370.0, 60.0, 90.0, 80.0, 270.0, -10.0, 50.0, 60.0, 130.0, -20.0, 460.0, 45.0, 10.0, 310.0, 180.0, 30.0, 30.0, 0.0, -30.0, 170.0, 0.0, 10.0, 140.0, 60.0, 40.0, 210.0, 0.0, 0.0, 100.0, 0.0, 200.0, 370.0, 160.0, 140.0, 170.0, 10.0, 60.0, 130.0, 40.0, 70.0, 80.0, 280.0, 230.0, 50.0, 240.0, 260.0, 60.0, 40.0, 70.0, 70.0, -20.0, 60.0, 30.0, 150.0, 40.0, 380.0, 220.0, 280.0, 150.0, 30.0, 50.0, 100.0, 170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0, 20.0, 70.0, 0.0, 40.0, 40.0, 20.0, 40.0, -5.0, 120.0, 30.0, 350.0, 20.0, 10.0, 30.0, 10.0, 50.0, 50.0, 0.0, 20.0, 10.0, 110.0, 250.0, 60.0, 60.0, 40.0, 30.0, 30.0, 30.0, 90.0, 20.0, 100.0, -70.0, 180.0, 40.0, 60.0, 30.0, 100.0, 20.0, 10.0, 40.0, 120.0, 20.0, 30.0, 230.0, -310.0, 10.0, 170.0, 0.0, 0.0, 20.0, 80.0, 90.0, 280.0, 50.0, 30.0, -65.0, 90.0, 50.0, 20.0, 55.0, 120.0, 150.0, 120.0, 80.0, 80.0, 400.0, 170.0, 70.0, 210.0, 40.0, 190.0, 20.0, 0.0, 160.0, 100.0, 40.0, 120.0, 90.0, 30.0, 10.0, 20.0, 20.0, 0.0, 20.0, -5.0, 50.0, 50.0, 30.0, 20.0, 20.0, 0.0, 240.0, 20.0, 80.0, 260.0, 90.0, 40.0, 90.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 110.0, 10.0, 0.0, 80.0, 20.0, 50.0, 90.0, 130.0, 100.0, 20.0, 40.0, 250.0, 120.0, 40.0, 70.0, 60.0, 150.0, 30.0, 20.0, 30.0, 40.0, 200.0, 60.0, 10.0, 40.0, 180.0, 0.0, 30.0, 80.0, 10.0, 20.0, 360.0, 170.0, 140.0, 40.0, 90.0, 155.0, 130.0, 150.0, 20.0, 510.0, 160.0, 90.0, 160.0, 10.0, 40.0, 80.0, 20.0, 20.0, -10.0, 260.0, 630.0, 180.0, -10.0, 300.0, 30.0, 25.0, 160.0, 80.0, 20.0, 30.0, 20.0, 20.0, 10.0, 290.0, 180.0, 310.0, 60.0, 0.0, 40.0, 50.0, 100.0, 65.0, 45.0, 50.0, 160.0, 430.0, 320.0, 50.0, 260.0, 90.0, 140.0, 50.0, 50.0, 100.0, 190.0, 30.0, 20.0, 360.0, 180.0, -40.0, 90.0, 100.0, 240.0, 40.0, 80.0, 180.0, 30.0, -10.0, 250.0, -15.0, 60.0, 50.0, 270.0, 80.0, 20.0, 40.0, 160.0, 60.0, 100.0, 0.0, 220.0, 0.0, 40.0, 50.0, 0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0, 120.0, 70.0, 70.0, 250.0, 0.0, 40.0, 30.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 40.0, 160.0, 20.0, 30.0, 100.0, 0.0, 5.0, 60.0, 220.0, 20.0, 230.0, 110.0, 90.0, 170.0, 110.0, 90.0, 200.0, 90.0, 20.0, 60.0, 50.0, 270.0, 380.0, 40.0, 20.0, 80.0, 230.0, 20.0, 30.0, 10.0, 0.0, 180.0, 70.0, 20.0, 40.0, 380.0, 50.0, 140.0, 140.0, 420.0, 80.0, -90.0, 30.0, 70.0, 450.0, 20.0, 80.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 90.0, -10.0, 0.0, 370.0, 30.0, 20.0, 120.0, 180.0, 5.0, -50.0, 100.0, 220.0, 60.0, 20.0, 190.0, 100.0, 160.0, 120.0, 160.0, 40.0, 80.0, 80.0, 40.0, 0.0, 35.0, 110.0, 320.0, 95.0, 110.0, 0.0, 440.0, 160.0, 160.0, -55.0, 270.0, 240.0, 40.0, 350.0, 80.0, 25.0, 150.0, 180.0, 1080.0, 90.0, 130.0, 190.0, 0.0, 90.0, 330.0, -40.0, 0.0, 490.0, 180.0, 90.0, 90.0, 160.0, 40.0, 10.0, 100.0, 20.0, 70.0, 20.0, 20.0, 100.0, 280.0, 30.0, 40.0, 200.0, 110.0, 0.0, 150.0, 30.0, 190.0, 20.0, 270.0, 30.0, 0.0, 60.0, 10.0, 60.0, 30.0, 80.0, 820.0, 140.0, 30.0, 180.0, 60.0, 80.0, 10.0, 20.0, 60.0, 170.0, 80.0, 80.0, 30.0, 70.0, 130.0, 25.0, 20.0, 80.0, 15.0, 50.0, 50.0, 360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0, 100.0, 110.0, 70.0, 50.0, 180.0, 30.0, 210.0, 0.0, 50.0, 340.0, 30.0, 120.0, 50.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 60.0, 40.0, 110.0, 40.0, 0.0, 370.0, 40.0, 90.0, 310.0, 120.0, 190.0, 0.0, 80.0, 160.0, 15.0, 70.0, 30.0, 100.0, 10.0, 30.0, 30.0, 90.0, 20.0, 70.0, 30.0, 30.0, 20.0, 110.0, 50.0, 20.0, 0.0, 50.0, 160.0, -40.0, 30.0, 160.0, 40.0, 80.0, 360.0, 105.0, 240.0, 10.0, 120.0, 70.0, -50.0, 360.0, 370.0, 120.0, -50.0, 40.0, 120.0, 15.0, 130.0, 320.0, 110.0, 110.0, 360.0, -10.0, -10.0, 140.0, 10.0, 140.0, 160.0, 70.0, 100.0, 20.0, 250.0, 50.0, 20.0, 40.0, 180.0, 50.0, 410.0, 80.0, 180.0, 0.0, 40.0, 100.0, 230.0, 260.0, 40.0, 10.0, 270.0, 0.0, 70.0, -10.0, 90.0, 30.0, 80.0, 70.0, 10.0, 20.0, 160.0, 90.0, 30.0, 30.0, 60.0, 10.0, 10.0, 150.0, 150.0, 30.0, 330.0, 80.0, 20.0, 80.0, 80.0, 120.0, 50.0, 90.0, 100.0, 110.0, 190.0, 80.0, 60.0, 220.0, 100.0, 40.0, 160.0, 40.0, 220.0, 50.0, 130.0, 90.0, 50.0, 130.0, 140.0, 90.0, 180.0, 120.0, 310.0, 160.0, 60.0, 240.0, 70.0, 160.0, 80.0, 110.0, 40.0, 160.0, 170.0, -30.0, 120.0, 270.0, 60.0, 210.0, 60.0, -30.0, 70.0, 220.0, 20.0, 30.0, 70.0, 90.0, 60.0, 310.0, 70.0, 0.0, 20.0, 150.0, -170.0, 90.0, 90.0, 100.0, 280.0, 120.0, 180.0, 10.0, 130.0, 100.0, 50.0, 240.0, 100.0, 130.0, 230.0, 220.0, 20.0, 150.0, 230.0, 140.0, 50.0, 160.0, 100.0, 210.0, -25.0, 70.0, 80.0, 80.0, 30.0, 50.0, 170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5288103551842869, "mean_inference_ms": 1.4081542414980592, "mean_action_processing_ms": 0.4482032977802273, "mean_env_wait_ms": 1.2432792397783958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012197017669677734, "StateBufferConnector_ms": 0.009615421295166016, "ViewRequirementAgentConnector_ms": 0.3690829277038574}, "num_episodes": 22, "episode_return_max": 2360.0, "episode_return_min": 140.0, "episode_return_mean": 980.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.623858118198264, "num_env_steps_trained_throughput_per_sec": 21.623858118198264, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 186055.124, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186055.055, "sample_time_ms": 2468.133, "learn_time_ms": 183566.684, "learn_throughput": 21.79, "synch_weights_time_ms": 11.305}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "33e63_00000", "date": "2024-06-19_02-44-28", "timestamp": 1718779468, "time_this_iter_s": 184.99014496803284, "time_total_s": 20250.33081960678, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20250.33081960678, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 16.255343511450384, "ram_util_percent": 77.83969465648855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0223691840585682, "cur_kl_coeff": 1.621829223632812, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006500991764582527, "vf_loss": 6.948872093905529, "vf_explained_var": 0.003057929775077568, "kl": Infinity, "entropy": 0.3780194374779289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 2360.0, "episode_reward_min": 140.0, "episode_reward_mean": 957.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 1080.0}, "policy_reward_mean": {"policy_0": 95.795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1120.0, 580.0, 850.0, 710.0, 1500.0, 670.0, 570.0, 870.0, 1340.0, 1060.0, 415.0, 1360.0, 1155.0, 710.0, 1120.0, 1140.0, 1060.0, 1430.0, 1300.0, 375.0, 550.0, 720.0, 510.0, 290.0, 680.0, 1440.0, 760.0, 225.0, 850.0, 350.0, 910.0, 640.0, 1030.0, 1475.0, 1510.0, 685.0, 900.0, 1650.0, 1210.0, 975.0, 690.0, 760.0, 730.0, 385.0, 1300.0, 1240.0, 800.0, 1340.0, 140.0, 1055.0, 990.0, 1430.0, 2360.0, 1460.0, 620.0, 1130.0, 1380.0, 830.0, 550.0, 970.0, 1140.0, 440.0, 1180.0, 685.0, 470.0, 945.0, 1230.0, 1285.0, 860.0, 1530.0, 650.0, 570.0, 1030.0, 1100.0, 1200.0, 1390.0, 1120.0, 820.0, 930.0, 1510.0, 805.0, 860.0, 1240.0, 1335.0, 1395.0, 1390.0, 985.0, 520.0, 850.0, 210.0, 1180.0, 830.0, 1185.0, 200.0, 1210.0, 670.0, 880.0, 1230.0, 1070.0, 810.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 20.0, 40.0, 80.0, 80.0, 500.0, 240.0, 110.0, 30.0, 50.0, 40.0, 30.0, 30.0, 30.0, 220.0, 0.0, 140.0, 20.0, 20.0, 150.0, 170.0, 130.0, 50.0, 20.0, 80.0, 70.0, 30.0, 90.0, 60.0, 20.0, 30.0, 90.0, 30.0, 240.0, 40.0, 130.0, 0.0, 110.0, 20.0, 80.0, 350.0, 150.0, 90.0, 420.0, 290.0, 10.0, 60.0, 70.0, -20.0, 90.0, 30.0, 80.0, 10.0, 140.0, 180.0, 60.0, 0.0, 70.0, 10.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 230.0, 150.0, 70.0, 190.0, 10.0, 110.0, 140.0, 110.0, 50.0, 20.0, 70.0, 160.0, 10.0, 130.0, 210.0, 30.0, 260.0, 210.0, -60.0, 360.0, 40.0, 80.0, 80.0, 40.0, 30.0, 190.0, 30.0, 120.0, 110.0, 220.0, 230.0, 20.0, 70.0, 220.0, 70.0, 10.0, 0.0, 55.0, 40.0, 10.0, -120.0, 70.0, 60.0, 520.0, -50.0, -20.0, 160.0, 60.0, -30.0, 260.0, 30.0, 370.0, 60.0, 90.0, 80.0, 270.0, -10.0, 50.0, 60.0, 130.0, -20.0, 460.0, 45.0, 10.0, 310.0, 180.0, 30.0, 30.0, 0.0, -30.0, 170.0, 0.0, 10.0, 140.0, 60.0, 40.0, 210.0, 0.0, 0.0, 100.0, 0.0, 200.0, 370.0, 160.0, 140.0, 170.0, 10.0, 60.0, 130.0, 40.0, 70.0, 80.0, 280.0, 230.0, 50.0, 240.0, 260.0, 60.0, 40.0, 70.0, 70.0, -20.0, 60.0, 30.0, 150.0, 40.0, 380.0, 220.0, 280.0, 150.0, 30.0, 50.0, 100.0, 170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0, 20.0, 70.0, 0.0, 40.0, 40.0, 20.0, 40.0, -5.0, 120.0, 30.0, 350.0, 20.0, 10.0, 30.0, 10.0, 50.0, 50.0, 0.0, 20.0, 10.0, 110.0, 250.0, 60.0, 60.0, 40.0, 30.0, 30.0, 30.0, 90.0, 20.0, 100.0, -70.0, 180.0, 40.0, 60.0, 30.0, 100.0, 20.0, 10.0, 40.0, 120.0, 20.0, 30.0, 230.0, -310.0, 10.0, 170.0, 0.0, 0.0, 20.0, 80.0, 90.0, 280.0, 50.0, 30.0, -65.0, 90.0, 50.0, 20.0, 55.0, 120.0, 150.0, 120.0, 80.0, 80.0, 400.0, 170.0, 70.0, 210.0, 40.0, 190.0, 20.0, 0.0, 160.0, 100.0, 40.0, 120.0, 90.0, 30.0, 10.0, 20.0, 20.0, 0.0, 20.0, -5.0, 50.0, 50.0, 30.0, 20.0, 20.0, 0.0, 240.0, 20.0, 80.0, 260.0, 90.0, 40.0, 90.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 110.0, 10.0, 0.0, 80.0, 20.0, 50.0, 90.0, 130.0, 100.0, 20.0, 40.0, 250.0, 120.0, 40.0, 70.0, 60.0, 150.0, 30.0, 20.0, 30.0, 40.0, 200.0, 60.0, 10.0, 40.0, 180.0, 0.0, 30.0, 80.0, 10.0, 20.0, 360.0, 170.0, 140.0, 40.0, 90.0, 155.0, 130.0, 150.0, 20.0, 510.0, 160.0, 90.0, 160.0, 10.0, 40.0, 80.0, 20.0, 20.0, -10.0, 260.0, 630.0, 180.0, -10.0, 300.0, 30.0, 25.0, 160.0, 80.0, 20.0, 30.0, 20.0, 20.0, 10.0, 290.0, 180.0, 310.0, 60.0, 0.0, 40.0, 50.0, 100.0, 65.0, 45.0, 50.0, 160.0, 430.0, 320.0, 50.0, 260.0, 90.0, 140.0, 50.0, 50.0, 100.0, 190.0, 30.0, 20.0, 360.0, 180.0, -40.0, 90.0, 100.0, 240.0, 40.0, 80.0, 180.0, 30.0, -10.0, 250.0, -15.0, 60.0, 50.0, 270.0, 80.0, 20.0, 40.0, 160.0, 60.0, 100.0, 0.0, 220.0, 0.0, 40.0, 50.0, 0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0, 120.0, 70.0, 70.0, 250.0, 0.0, 40.0, 30.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 40.0, 160.0, 20.0, 30.0, 100.0, 0.0, 5.0, 60.0, 220.0, 20.0, 230.0, 110.0, 90.0, 170.0, 110.0, 90.0, 200.0, 90.0, 20.0, 60.0, 50.0, 270.0, 380.0, 40.0, 20.0, 80.0, 230.0, 20.0, 30.0, 10.0, 0.0, 180.0, 70.0, 20.0, 40.0, 380.0, 50.0, 140.0, 140.0, 420.0, 80.0, -90.0, 30.0, 70.0, 450.0, 20.0, 80.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 90.0, -10.0, 0.0, 370.0, 30.0, 20.0, 120.0, 180.0, 5.0, -50.0, 100.0, 220.0, 60.0, 20.0, 190.0, 100.0, 160.0, 120.0, 160.0, 40.0, 80.0, 80.0, 40.0, 0.0, 35.0, 110.0, 320.0, 95.0, 110.0, 0.0, 440.0, 160.0, 160.0, -55.0, 270.0, 240.0, 40.0, 350.0, 80.0, 25.0, 150.0, 180.0, 1080.0, 90.0, 130.0, 190.0, 0.0, 90.0, 330.0, -40.0, 0.0, 490.0, 180.0, 90.0, 90.0, 160.0, 40.0, 10.0, 100.0, 20.0, 70.0, 20.0, 20.0, 100.0, 280.0, 30.0, 40.0, 200.0, 110.0, 0.0, 150.0, 30.0, 190.0, 20.0, 270.0, 30.0, 0.0, 60.0, 10.0, 60.0, 30.0, 80.0, 820.0, 140.0, 30.0, 180.0, 60.0, 80.0, 10.0, 20.0, 60.0, 170.0, 80.0, 80.0, 30.0, 70.0, 130.0, 25.0, 20.0, 80.0, 15.0, 50.0, 50.0, 360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0, 100.0, 110.0, 70.0, 50.0, 180.0, 30.0, 210.0, 0.0, 50.0, 340.0, 30.0, 120.0, 50.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 60.0, 40.0, 110.0, 40.0, 0.0, 370.0, 40.0, 90.0, 310.0, 120.0, 190.0, 0.0, 80.0, 160.0, 15.0, 70.0, 30.0, 100.0, 10.0, 30.0, 30.0, 90.0, 20.0, 70.0, 30.0, 30.0, 20.0, 110.0, 50.0, 20.0, 0.0, 50.0, 160.0, -40.0, 30.0, 160.0, 40.0, 80.0, 360.0, 105.0, 240.0, 10.0, 120.0, 70.0, -50.0, 360.0, 370.0, 120.0, -50.0, 40.0, 120.0, 15.0, 130.0, 320.0, 110.0, 110.0, 360.0, -10.0, -10.0, 140.0, 10.0, 140.0, 160.0, 70.0, 100.0, 20.0, 250.0, 50.0, 20.0, 40.0, 180.0, 50.0, 410.0, 80.0, 180.0, 0.0, 40.0, 100.0, 230.0, 260.0, 40.0, 10.0, 270.0, 0.0, 70.0, -10.0, 90.0, 30.0, 80.0, 70.0, 10.0, 20.0, 160.0, 90.0, 30.0, 30.0, 60.0, 10.0, 10.0, 150.0, 150.0, 30.0, 330.0, 80.0, 20.0, 80.0, 80.0, 120.0, 50.0, 90.0, 100.0, 110.0, 190.0, 80.0, 60.0, 220.0, 100.0, 40.0, 160.0, 40.0, 220.0, 50.0, 130.0, 90.0, 50.0, 130.0, 140.0, 90.0, 180.0, 120.0, 310.0, 160.0, 60.0, 240.0, 70.0, 160.0, 80.0, 110.0, 40.0, 160.0, 170.0, -30.0, 120.0, 270.0, 60.0, 210.0, 60.0, -30.0, 70.0, 220.0, 20.0, 30.0, 70.0, 90.0, 60.0, 310.0, 70.0, 0.0, 20.0, 150.0, -170.0, 90.0, 90.0, 100.0, 280.0, 120.0, 180.0, 10.0, 130.0, 100.0, 50.0, 240.0, 100.0, 130.0, 230.0, 220.0, 20.0, 150.0, 230.0, 140.0, 50.0, 160.0, 100.0, 210.0, -25.0, 70.0, 80.0, 80.0, 30.0, 50.0, 170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0, 120.0, 300.0, 30.0, 140.0, 90.0, 110.0, 270.0, 80.0, 10.0, 90.0, 100.0, 40.0, 290.0, 70.0, 230.0, 25.0, 260.0, 130.0, 90.0, 100.0, 380.0, 220.0, 610.0, 80.0, 70.0, 25.0, 50.0, -30.0, -30.0, 20.0, 70.0, 240.0, 240.0, 130.0, 20.0, 200.0, 240.0, 80.0, 50.0, 120.0, 320.0, -120.0, 100.0, 130.0, 150.0, 120.0, 110.0, 160.0, 50.0, -35.0, 40.0, 250.0, 90.0, 20.0, 40.0, 0.0, 0.0, 40.0, 0.0, 40.0, 80.0, 30.0, 15.0, 40.0, 270.0, -5.0, 20.0, 210.0, 100.0, 90.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 50.0, 20.0, 60.0, 110.0, 40.0, 320.0, 60.0, 140.0, 50.0, 240.0, 140.0, 20.0, 30.0, 140.0, 20.0, 70.0, 150.0, 20.0, 160.0, 90.0, 130.0, 140.0, 540.0, 60.0, 110.0, 70.0, 30.0, 10.0, 80.0, 110.0, 35.0, 20.0, 20.0, 40.0, 10.0, 10.0, -30.0, 50.0, 0.0, 20.0, 60.0, 360.0, 160.0, 270.0, 110.0, 90.0, 90.0, 120.0, -30.0, 60.0, -20.0, 50.0, 70.0, 270.0, 60.0, 60.0, 40.0, 20.0, 70.0, 30.0, 0.0, 90.0, 30.0, 320.0, 130.0, 30.0, 0.0, 20.0, 160.0, 60.0, 40.0, 20.0, 130.0, 320.0, 190.0, -40.0, 50.0, 70.0, 280.0, 70.0, 140.0, 90.0, 10.0, 70.0, 20.0, 200.0, 90.0, 50.0, 210.0, 30.0, 300.0, 0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5282538135484465, "mean_inference_ms": 1.40793652577819, "mean_action_processing_ms": 0.4476045172458977, "mean_env_wait_ms": 1.2429773726050075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01236867904663086, "StateBufferConnector_ms": 0.009139537811279297, "ViewRequirementAgentConnector_ms": 0.3647196292877197}, "num_episodes": 18, "episode_return_max": 2360.0, "episode_return_min": 140.0, "episode_return_mean": 957.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.44113707778258, "num_env_steps_trained_throughput_per_sec": 21.44113707778258, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 186171.522, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186171.453, "sample_time_ms": 2453.492, "learn_time_ms": 183697.679, "learn_throughput": 21.775, "synch_weights_time_ms": 11.322}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "33e63_00000", "date": "2024-06-19_02-47-35", "timestamp": 1718779655, "time_this_iter_s": 186.56794095039368, "time_total_s": 20436.898760557175, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277b7a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20436.898760557175, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 16.48977272727273, "ram_util_percent": 77.98143939393938}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.965141387386952, "cur_kl_coeff": 2.4327438354492186, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.006070299519444653, "vf_loss": 7.313132004946057, "vf_explained_var": 0.0015154674284247418, "kl": Infinity, "entropy": 0.382465144230154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 2360.0, "episode_reward_min": 140.0, "episode_reward_mean": 991.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -310.0}, "policy_reward_max": {"policy_0": 1080.0}, "policy_reward_mean": {"policy_0": 99.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1300.0, 375.0, 550.0, 720.0, 510.0, 290.0, 680.0, 1440.0, 760.0, 225.0, 850.0, 350.0, 910.0, 640.0, 1030.0, 1475.0, 1510.0, 685.0, 900.0, 1650.0, 1210.0, 975.0, 690.0, 760.0, 730.0, 385.0, 1300.0, 1240.0, 800.0, 1340.0, 140.0, 1055.0, 990.0, 1430.0, 2360.0, 1460.0, 620.0, 1130.0, 1380.0, 830.0, 550.0, 970.0, 1140.0, 440.0, 1180.0, 685.0, 470.0, 945.0, 1230.0, 1285.0, 860.0, 1530.0, 650.0, 570.0, 1030.0, 1100.0, 1200.0, 1390.0, 1120.0, 820.0, 930.0, 1510.0, 805.0, 860.0, 1240.0, 1335.0, 1395.0, 1390.0, 985.0, 520.0, 850.0, 210.0, 1180.0, 830.0, 1185.0, 200.0, 1210.0, 670.0, 880.0, 1230.0, 1070.0, 810.0, 1490.0, 2320.0, 1925.0, 1315.0, 1050.0, 200.0, 1270.0, 1585.0, 1420.0, 630.0, 440.0, 1150.0, 930.0, 730.0, 1270.0, 1390.0, 1115.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 300.0, 40.0, 170.0, 130.0, 70.0, 190.0, 80.0, 40.0, 110.0, 20.0, 70.0, 0.0, 40.0, 40.0, 20.0, 40.0, -5.0, 120.0, 30.0, 350.0, 20.0, 10.0, 30.0, 10.0, 50.0, 50.0, 0.0, 20.0, 10.0, 110.0, 250.0, 60.0, 60.0, 40.0, 30.0, 30.0, 30.0, 90.0, 20.0, 100.0, -70.0, 180.0, 40.0, 60.0, 30.0, 100.0, 20.0, 10.0, 40.0, 120.0, 20.0, 30.0, 230.0, -310.0, 10.0, 170.0, 0.0, 0.0, 20.0, 80.0, 90.0, 280.0, 50.0, 30.0, -65.0, 90.0, 50.0, 20.0, 55.0, 120.0, 150.0, 120.0, 80.0, 80.0, 400.0, 170.0, 70.0, 210.0, 40.0, 190.0, 20.0, 0.0, 160.0, 100.0, 40.0, 120.0, 90.0, 30.0, 10.0, 20.0, 20.0, 0.0, 20.0, -5.0, 50.0, 50.0, 30.0, 20.0, 20.0, 0.0, 240.0, 20.0, 80.0, 260.0, 90.0, 40.0, 90.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 110.0, 10.0, 0.0, 80.0, 20.0, 50.0, 90.0, 130.0, 100.0, 20.0, 40.0, 250.0, 120.0, 40.0, 70.0, 60.0, 150.0, 30.0, 20.0, 30.0, 40.0, 200.0, 60.0, 10.0, 40.0, 180.0, 0.0, 30.0, 80.0, 10.0, 20.0, 360.0, 170.0, 140.0, 40.0, 90.0, 155.0, 130.0, 150.0, 20.0, 510.0, 160.0, 90.0, 160.0, 10.0, 40.0, 80.0, 20.0, 20.0, -10.0, 260.0, 630.0, 180.0, -10.0, 300.0, 30.0, 25.0, 160.0, 80.0, 20.0, 30.0, 20.0, 20.0, 10.0, 290.0, 180.0, 310.0, 60.0, 0.0, 40.0, 50.0, 100.0, 65.0, 45.0, 50.0, 160.0, 430.0, 320.0, 50.0, 260.0, 90.0, 140.0, 50.0, 50.0, 100.0, 190.0, 30.0, 20.0, 360.0, 180.0, -40.0, 90.0, 100.0, 240.0, 40.0, 80.0, 180.0, 30.0, -10.0, 250.0, -15.0, 60.0, 50.0, 270.0, 80.0, 20.0, 40.0, 160.0, 60.0, 100.0, 0.0, 220.0, 0.0, 40.0, 50.0, 0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0, 120.0, 70.0, 70.0, 250.0, 0.0, 40.0, 30.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 40.0, 160.0, 20.0, 30.0, 100.0, 0.0, 5.0, 60.0, 220.0, 20.0, 230.0, 110.0, 90.0, 170.0, 110.0, 90.0, 200.0, 90.0, 20.0, 60.0, 50.0, 270.0, 380.0, 40.0, 20.0, 80.0, 230.0, 20.0, 30.0, 10.0, 0.0, 180.0, 70.0, 20.0, 40.0, 380.0, 50.0, 140.0, 140.0, 420.0, 80.0, -90.0, 30.0, 70.0, 450.0, 20.0, 80.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 90.0, -10.0, 0.0, 370.0, 30.0, 20.0, 120.0, 180.0, 5.0, -50.0, 100.0, 220.0, 60.0, 20.0, 190.0, 100.0, 160.0, 120.0, 160.0, 40.0, 80.0, 80.0, 40.0, 0.0, 35.0, 110.0, 320.0, 95.0, 110.0, 0.0, 440.0, 160.0, 160.0, -55.0, 270.0, 240.0, 40.0, 350.0, 80.0, 25.0, 150.0, 180.0, 1080.0, 90.0, 130.0, 190.0, 0.0, 90.0, 330.0, -40.0, 0.0, 490.0, 180.0, 90.0, 90.0, 160.0, 40.0, 10.0, 100.0, 20.0, 70.0, 20.0, 20.0, 100.0, 280.0, 30.0, 40.0, 200.0, 110.0, 0.0, 150.0, 30.0, 190.0, 20.0, 270.0, 30.0, 0.0, 60.0, 10.0, 60.0, 30.0, 80.0, 820.0, 140.0, 30.0, 180.0, 60.0, 80.0, 10.0, 20.0, 60.0, 170.0, 80.0, 80.0, 30.0, 70.0, 130.0, 25.0, 20.0, 80.0, 15.0, 50.0, 50.0, 360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0, 100.0, 110.0, 70.0, 50.0, 180.0, 30.0, 210.0, 0.0, 50.0, 340.0, 30.0, 120.0, 50.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 60.0, 40.0, 110.0, 40.0, 0.0, 370.0, 40.0, 90.0, 310.0, 120.0, 190.0, 0.0, 80.0, 160.0, 15.0, 70.0, 30.0, 100.0, 10.0, 30.0, 30.0, 90.0, 20.0, 70.0, 30.0, 30.0, 20.0, 110.0, 50.0, 20.0, 0.0, 50.0, 160.0, -40.0, 30.0, 160.0, 40.0, 80.0, 360.0, 105.0, 240.0, 10.0, 120.0, 70.0, -50.0, 360.0, 370.0, 120.0, -50.0, 40.0, 120.0, 15.0, 130.0, 320.0, 110.0, 110.0, 360.0, -10.0, -10.0, 140.0, 10.0, 140.0, 160.0, 70.0, 100.0, 20.0, 250.0, 50.0, 20.0, 40.0, 180.0, 50.0, 410.0, 80.0, 180.0, 0.0, 40.0, 100.0, 230.0, 260.0, 40.0, 10.0, 270.0, 0.0, 70.0, -10.0, 90.0, 30.0, 80.0, 70.0, 10.0, 20.0, 160.0, 90.0, 30.0, 30.0, 60.0, 10.0, 10.0, 150.0, 150.0, 30.0, 330.0, 80.0, 20.0, 80.0, 80.0, 120.0, 50.0, 90.0, 100.0, 110.0, 190.0, 80.0, 60.0, 220.0, 100.0, 40.0, 160.0, 40.0, 220.0, 50.0, 130.0, 90.0, 50.0, 130.0, 140.0, 90.0, 180.0, 120.0, 310.0, 160.0, 60.0, 240.0, 70.0, 160.0, 80.0, 110.0, 40.0, 160.0, 170.0, -30.0, 120.0, 270.0, 60.0, 210.0, 60.0, -30.0, 70.0, 220.0, 20.0, 30.0, 70.0, 90.0, 60.0, 310.0, 70.0, 0.0, 20.0, 150.0, -170.0, 90.0, 90.0, 100.0, 280.0, 120.0, 180.0, 10.0, 130.0, 100.0, 50.0, 240.0, 100.0, 130.0, 230.0, 220.0, 20.0, 150.0, 230.0, 140.0, 50.0, 160.0, 100.0, 210.0, -25.0, 70.0, 80.0, 80.0, 30.0, 50.0, 170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0, 120.0, 300.0, 30.0, 140.0, 90.0, 110.0, 270.0, 80.0, 10.0, 90.0, 100.0, 40.0, 290.0, 70.0, 230.0, 25.0, 260.0, 130.0, 90.0, 100.0, 380.0, 220.0, 610.0, 80.0, 70.0, 25.0, 50.0, -30.0, -30.0, 20.0, 70.0, 240.0, 240.0, 130.0, 20.0, 200.0, 240.0, 80.0, 50.0, 120.0, 320.0, -120.0, 100.0, 130.0, 150.0, 120.0, 110.0, 160.0, 50.0, -35.0, 40.0, 250.0, 90.0, 20.0, 40.0, 0.0, 0.0, 40.0, 0.0, 40.0, 80.0, 30.0, 15.0, 40.0, 270.0, -5.0, 20.0, 210.0, 100.0, 90.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 50.0, 20.0, 60.0, 110.0, 40.0, 320.0, 60.0, 140.0, 50.0, 240.0, 140.0, 20.0, 30.0, 140.0, 20.0, 70.0, 150.0, 20.0, 160.0, 90.0, 130.0, 140.0, 540.0, 60.0, 110.0, 70.0, 30.0, 10.0, 80.0, 110.0, 35.0, 20.0, 20.0, 40.0, 10.0, 10.0, -30.0, 50.0, 0.0, 20.0, 60.0, 360.0, 160.0, 270.0, 110.0, 90.0, 90.0, 120.0, -30.0, 60.0, -20.0, 50.0, 70.0, 270.0, 60.0, 60.0, 40.0, 20.0, 70.0, 30.0, 0.0, 90.0, 30.0, 320.0, 130.0, 30.0, 0.0, 20.0, 160.0, 60.0, 40.0, 20.0, 130.0, 320.0, 190.0, -40.0, 50.0, 70.0, 280.0, 70.0, 140.0, 90.0, 10.0, 70.0, 20.0, 200.0, 90.0, 50.0, 210.0, 30.0, 300.0, 0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0, 90.0, 60.0, 290.0, 120.0, 70.0, 220.0, 200.0, 150.0, 70.0, 220.0, 420.0, 280.0, 150.0, 890.0, 150.0, 90.0, 20.0, 230.0, 10.0, 80.0, 60.0, 140.0, 5.0, 840.0, 80.0, 90.0, 250.0, 70.0, 160.0, 230.0, 40.0, 60.0, 230.0, 50.0, 80.0, 230.0, 160.0, 450.0, -10.0, 25.0, 110.0, 20.0, -40.0, 20.0, 10.0, 340.0, 140.0, 80.0, 270.0, 100.0, 10.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 0.0, 0.0, 0.0, 40.0, -25.0, 80.0, 80.0, 170.0, 30.0, 390.0, 130.0, 70.0, 305.0, 170.0, 320.0, 230.0, 85.0, 240.0, 70.0, 140.0, 90.0, 220.0, 20.0, 130.0, 80.0, 80.0, 90.0, 250.0, 380.0, 150.0, 80.0, 35.0, 145.0, 10.0, 160.0, 120.0, 50.0, 80.0, 30.0, 30.0, 60.0, 50.0, 40.0, 50.0, 110.0, 20.0, 130.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 290.0, 210.0, 20.0, 100.0, 30.0, 90.0, 210.0, 40.0, 60.0, 100.0, 70.0, 140.0, 50.0, 20.0, 100.0, 240.0, 10.0, 90.0, 150.0, 60.0, 90.0, 30.0, 35.0, 10.0, 140.0, 30.0, 10.0, 35.0, 90.0, 260.0, 210.0, 180.0, 100.0, 160.0, 130.0, 160.0, -20.0, 90.0, 260.0, 0.0, 320.0, 160.0, 60.0, 140.0, 160.0, 30.0, 110.0, 0.0, 250.0, 160.0, 80.0, 40.0, 60.0, 370.0, 90.0, 80.0, 50.0, -10.0, 275.0, 80.0, 50.0, -50.0, 30.0, 80.0, 30.0, 280.0, 190.0, 60.0, 60.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5279298461792916, "mean_inference_ms": 1.4078538748899905, "mean_action_processing_ms": 0.4471121611779334, "mean_env_wait_ms": 1.242836695008977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012318134307861328, "StateBufferConnector_ms": 0.009157419204711914, "ViewRequirementAgentConnector_ms": 0.384718656539917}, "num_episodes": 18, "episode_return_max": 2360.0, "episode_return_min": 140.0, "episode_return_mean": 991.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.565049603763544, "num_env_steps_trained_throughput_per_sec": 21.565049603763544, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 186221.781, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186221.712, "sample_time_ms": 2462.847, "learn_time_ms": 183737.959, "learn_throughput": 21.77, "synch_weights_time_ms": 11.056}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "33e63_00000", "date": "2024-06-19_02-50-41", "timestamp": 1718779841, "time_this_iter_s": 185.49754810333252, "time_total_s": 20622.396308660507, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278e85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20622.396308660507, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 16.12786259541985, "ram_util_percent": 78.52786259541983}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3609646630236387, "cur_kl_coeff": 3.6491157531738287, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0050916374946425695, "vf_loss": 6.984723876967344, "vf_explained_var": 0.002272039442397535, "kl": Infinity, "entropy": 0.3828205773973871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 2360.0, "episode_reward_min": 140.0, "episode_reward_mean": 1033.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 1080.0}, "policy_reward_mean": {"policy_0": 103.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 730.0, 385.0, 1300.0, 1240.0, 800.0, 1340.0, 140.0, 1055.0, 990.0, 1430.0, 2360.0, 1460.0, 620.0, 1130.0, 1380.0, 830.0, 550.0, 970.0, 1140.0, 440.0, 1180.0, 685.0, 470.0, 945.0, 1230.0, 1285.0, 860.0, 1530.0, 650.0, 570.0, 1030.0, 1100.0, 1200.0, 1390.0, 1120.0, 820.0, 930.0, 1510.0, 805.0, 860.0, 1240.0, 1335.0, 1395.0, 1390.0, 985.0, 520.0, 850.0, 210.0, 1180.0, 830.0, 1185.0, 200.0, 1210.0, 670.0, 880.0, 1230.0, 1070.0, 810.0, 1490.0, 2320.0, 1925.0, 1315.0, 1050.0, 200.0, 1270.0, 1585.0, 1420.0, 630.0, 440.0, 1150.0, 930.0, 730.0, 1270.0, 1390.0, 1115.0, 820.0, 690.0, 600.0, 790.0, 1200.0, 1000.0, 1125.0, 1215.0, 950.0, 480.0, 620.0, 900.0, 340.0, 1160.0, 2190.0, 1580.0, 600.0, 1470.0, 955.0, 930.0, 1205.0, 1440.0, 420.0, 2005.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 80.0, 30.0, 110.0, 10.0, 30.0, 130.0, 270.0, 40.0, 60.0, 120.0, 70.0, 70.0, 250.0, 0.0, 40.0, 30.0, 70.0, 50.0, 30.0, 10.0, 10.0, 10.0, 40.0, 160.0, 20.0, 30.0, 100.0, 0.0, 5.0, 60.0, 220.0, 20.0, 230.0, 110.0, 90.0, 170.0, 110.0, 90.0, 200.0, 90.0, 20.0, 60.0, 50.0, 270.0, 380.0, 40.0, 20.0, 80.0, 230.0, 20.0, 30.0, 10.0, 0.0, 180.0, 70.0, 20.0, 40.0, 380.0, 50.0, 140.0, 140.0, 420.0, 80.0, -90.0, 30.0, 70.0, 450.0, 20.0, 80.0, 0.0, 20.0, 0.0, 0.0, 30.0, 0.0, 10.0, 90.0, -10.0, 0.0, 370.0, 30.0, 20.0, 120.0, 180.0, 5.0, -50.0, 100.0, 220.0, 60.0, 20.0, 190.0, 100.0, 160.0, 120.0, 160.0, 40.0, 80.0, 80.0, 40.0, 0.0, 35.0, 110.0, 320.0, 95.0, 110.0, 0.0, 440.0, 160.0, 160.0, -55.0, 270.0, 240.0, 40.0, 350.0, 80.0, 25.0, 150.0, 180.0, 1080.0, 90.0, 130.0, 190.0, 0.0, 90.0, 330.0, -40.0, 0.0, 490.0, 180.0, 90.0, 90.0, 160.0, 40.0, 10.0, 100.0, 20.0, 70.0, 20.0, 20.0, 100.0, 280.0, 30.0, 40.0, 200.0, 110.0, 0.0, 150.0, 30.0, 190.0, 20.0, 270.0, 30.0, 0.0, 60.0, 10.0, 60.0, 30.0, 80.0, 820.0, 140.0, 30.0, 180.0, 60.0, 80.0, 10.0, 20.0, 60.0, 170.0, 80.0, 80.0, 30.0, 70.0, 130.0, 25.0, 20.0, 80.0, 15.0, 50.0, 50.0, 360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0, 100.0, 110.0, 70.0, 50.0, 180.0, 30.0, 210.0, 0.0, 50.0, 340.0, 30.0, 120.0, 50.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 60.0, 40.0, 110.0, 40.0, 0.0, 370.0, 40.0, 90.0, 310.0, 120.0, 190.0, 0.0, 80.0, 160.0, 15.0, 70.0, 30.0, 100.0, 10.0, 30.0, 30.0, 90.0, 20.0, 70.0, 30.0, 30.0, 20.0, 110.0, 50.0, 20.0, 0.0, 50.0, 160.0, -40.0, 30.0, 160.0, 40.0, 80.0, 360.0, 105.0, 240.0, 10.0, 120.0, 70.0, -50.0, 360.0, 370.0, 120.0, -50.0, 40.0, 120.0, 15.0, 130.0, 320.0, 110.0, 110.0, 360.0, -10.0, -10.0, 140.0, 10.0, 140.0, 160.0, 70.0, 100.0, 20.0, 250.0, 50.0, 20.0, 40.0, 180.0, 50.0, 410.0, 80.0, 180.0, 0.0, 40.0, 100.0, 230.0, 260.0, 40.0, 10.0, 270.0, 0.0, 70.0, -10.0, 90.0, 30.0, 80.0, 70.0, 10.0, 20.0, 160.0, 90.0, 30.0, 30.0, 60.0, 10.0, 10.0, 150.0, 150.0, 30.0, 330.0, 80.0, 20.0, 80.0, 80.0, 120.0, 50.0, 90.0, 100.0, 110.0, 190.0, 80.0, 60.0, 220.0, 100.0, 40.0, 160.0, 40.0, 220.0, 50.0, 130.0, 90.0, 50.0, 130.0, 140.0, 90.0, 180.0, 120.0, 310.0, 160.0, 60.0, 240.0, 70.0, 160.0, 80.0, 110.0, 40.0, 160.0, 170.0, -30.0, 120.0, 270.0, 60.0, 210.0, 60.0, -30.0, 70.0, 220.0, 20.0, 30.0, 70.0, 90.0, 60.0, 310.0, 70.0, 0.0, 20.0, 150.0, -170.0, 90.0, 90.0, 100.0, 280.0, 120.0, 180.0, 10.0, 130.0, 100.0, 50.0, 240.0, 100.0, 130.0, 230.0, 220.0, 20.0, 150.0, 230.0, 140.0, 50.0, 160.0, 100.0, 210.0, -25.0, 70.0, 80.0, 80.0, 30.0, 50.0, 170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0, 120.0, 300.0, 30.0, 140.0, 90.0, 110.0, 270.0, 80.0, 10.0, 90.0, 100.0, 40.0, 290.0, 70.0, 230.0, 25.0, 260.0, 130.0, 90.0, 100.0, 380.0, 220.0, 610.0, 80.0, 70.0, 25.0, 50.0, -30.0, -30.0, 20.0, 70.0, 240.0, 240.0, 130.0, 20.0, 200.0, 240.0, 80.0, 50.0, 120.0, 320.0, -120.0, 100.0, 130.0, 150.0, 120.0, 110.0, 160.0, 50.0, -35.0, 40.0, 250.0, 90.0, 20.0, 40.0, 0.0, 0.0, 40.0, 0.0, 40.0, 80.0, 30.0, 15.0, 40.0, 270.0, -5.0, 20.0, 210.0, 100.0, 90.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 50.0, 20.0, 60.0, 110.0, 40.0, 320.0, 60.0, 140.0, 50.0, 240.0, 140.0, 20.0, 30.0, 140.0, 20.0, 70.0, 150.0, 20.0, 160.0, 90.0, 130.0, 140.0, 540.0, 60.0, 110.0, 70.0, 30.0, 10.0, 80.0, 110.0, 35.0, 20.0, 20.0, 40.0, 10.0, 10.0, -30.0, 50.0, 0.0, 20.0, 60.0, 360.0, 160.0, 270.0, 110.0, 90.0, 90.0, 120.0, -30.0, 60.0, -20.0, 50.0, 70.0, 270.0, 60.0, 60.0, 40.0, 20.0, 70.0, 30.0, 0.0, 90.0, 30.0, 320.0, 130.0, 30.0, 0.0, 20.0, 160.0, 60.0, 40.0, 20.0, 130.0, 320.0, 190.0, -40.0, 50.0, 70.0, 280.0, 70.0, 140.0, 90.0, 10.0, 70.0, 20.0, 200.0, 90.0, 50.0, 210.0, 30.0, 300.0, 0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0, 90.0, 60.0, 290.0, 120.0, 70.0, 220.0, 200.0, 150.0, 70.0, 220.0, 420.0, 280.0, 150.0, 890.0, 150.0, 90.0, 20.0, 230.0, 10.0, 80.0, 60.0, 140.0, 5.0, 840.0, 80.0, 90.0, 250.0, 70.0, 160.0, 230.0, 40.0, 60.0, 230.0, 50.0, 80.0, 230.0, 160.0, 450.0, -10.0, 25.0, 110.0, 20.0, -40.0, 20.0, 10.0, 340.0, 140.0, 80.0, 270.0, 100.0, 10.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 0.0, 0.0, 0.0, 40.0, -25.0, 80.0, 80.0, 170.0, 30.0, 390.0, 130.0, 70.0, 305.0, 170.0, 320.0, 230.0, 85.0, 240.0, 70.0, 140.0, 90.0, 220.0, 20.0, 130.0, 80.0, 80.0, 90.0, 250.0, 380.0, 150.0, 80.0, 35.0, 145.0, 10.0, 160.0, 120.0, 50.0, 80.0, 30.0, 30.0, 60.0, 50.0, 40.0, 50.0, 110.0, 20.0, 130.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 290.0, 210.0, 20.0, 100.0, 30.0, 90.0, 210.0, 40.0, 60.0, 100.0, 70.0, 140.0, 50.0, 20.0, 100.0, 240.0, 10.0, 90.0, 150.0, 60.0, 90.0, 30.0, 35.0, 10.0, 140.0, 30.0, 10.0, 35.0, 90.0, 260.0, 210.0, 180.0, 100.0, 160.0, 130.0, 160.0, -20.0, 90.0, 260.0, 0.0, 320.0, 160.0, 60.0, 140.0, 160.0, 30.0, 110.0, 0.0, 250.0, 160.0, 80.0, 40.0, 60.0, 370.0, 90.0, 80.0, 50.0, -10.0, 275.0, 80.0, 50.0, -50.0, 30.0, 80.0, 30.0, 280.0, 190.0, 60.0, 60.0, 90.0, 270.0, 20.0, 10.0, 80.0, 40.0, 20.0, 70.0, 120.0, 50.0, 10.0, 20.0, 90.0, 20.0, 20.0, 60.0, 90.0, 200.0, 10.0, 20.0, 70.0, 40.0, 170.0, 100.0, 110.0, 70.0, 30.0, 140.0, 20.0, 40.0, 70.0, 10.0, 150.0, 40.0, 80.0, 250.0, 50.0, 100.0, 320.0, 100.0, 100.0, 100.0, 50.0, 80.0, 70.0, 200.0, 250.0, 50.0, 80.0, 80.0, 40.0, -50.0, 20.0, 20.0, 20.0, 80.0, 570.0, 45.0, 30.0, 160.0, 230.0, 80.0, 65.0, 210.0, 180.0, 70.0, 10.0, 80.0, 70.0, 220.0, 230.0, -10.0, 40.0, 410.0, 60.0, 60.0, 30.0, 20.0, 190.0, 100.0, 50.0, 0.0, 20.0, 100.0, 90.0, 30.0, 10.0, -10.0, 0.0, 0.0, 240.0, 30.0, 60.0, 10.0, 40.0, 70.0, 200.0, 70.0, 60.0, 40.0, 40.0, 30.0, 170.0, 230.0, 110.0, 70.0, 80.0, 120.0, 30.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 120.0, 40.0, 20.0, 60.0, 920.0, -20.0, 10.0, 40.0, 10.0, -20.0, 30.0, 0.0, 130.0, 490.0, 290.0, 600.0, 250.0, 20.0, 40.0, 20.0, 40.0, 170.0, 270.0, 140.0, 150.0, 130.0, 70.0, 100.0, 330.0, 300.0, 70.0, 200.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 10.0, 40.0, 20.0, 160.0, 20.0, 80.0, 80.0, 80.0, 80.0, 30.0, 540.0, 100.0, 220.0, 90.0, 170.0, 100.0, 50.0, 110.0, 50.0, 40.0, 20.0, 60.0, 45.0, 90.0, 390.0, 310.0, 50.0, 40.0, 60.0, -60.0, 10.0, 220.0, 120.0, 80.0, 100.0, 10.0, 0.0, 130.0, 250.0, 20.0, 60.0, 600.0, 10.0, 70.0, 55.0, 20.0, 360.0, 30.0, -30.0, 310.0, 180.0, 410.0, 120.0, 30.0, 10.0, -5.0, 40.0, 30.0, 40.0, 40.0, 140.0, 20.0, 80.0, 10.0, 25.0, 120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5275465357497828, "mean_inference_ms": 1.407994174048759, "mean_action_processing_ms": 0.4465611880157301, "mean_env_wait_ms": 1.2427470841077957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012506723403930664, "StateBufferConnector_ms": 0.010279178619384766, "ViewRequirementAgentConnector_ms": 0.3925049304962158}, "num_episodes": 23, "episode_return_max": 2360.0, "episode_return_min": 140.0, "episode_return_mean": 1033.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.605202840862287, "num_env_steps_trained_throughput_per_sec": 21.605202840862287, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 186155.205, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186155.137, "sample_time_ms": 2454.958, "learn_time_ms": 183679.169, "learn_throughput": 21.777, "synch_weights_time_ms": 11.303}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "33e63_00000", "date": "2024-06-19_02-53-46", "timestamp": 1718780026, "time_this_iter_s": 185.147047996521, "time_total_s": 20807.54335665703, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278e8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20807.54335665703, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 15.958778625954201, "ram_util_percent": 79.02251908396947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2644516958532748, "cur_kl_coeff": 5.473673629760741, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004618056742370295, "vf_loss": 7.406333244748263, "vf_explained_var": 0.00017685713732458404, "kl": Infinity, "entropy": 0.36077134887250467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 2320.0, "episode_reward_min": 200.0, "episode_reward_mean": 1024.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 102.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [970.0, 1140.0, 440.0, 1180.0, 685.0, 470.0, 945.0, 1230.0, 1285.0, 860.0, 1530.0, 650.0, 570.0, 1030.0, 1100.0, 1200.0, 1390.0, 1120.0, 820.0, 930.0, 1510.0, 805.0, 860.0, 1240.0, 1335.0, 1395.0, 1390.0, 985.0, 520.0, 850.0, 210.0, 1180.0, 830.0, 1185.0, 200.0, 1210.0, 670.0, 880.0, 1230.0, 1070.0, 810.0, 1490.0, 2320.0, 1925.0, 1315.0, 1050.0, 200.0, 1270.0, 1585.0, 1420.0, 630.0, 440.0, 1150.0, 930.0, 730.0, 1270.0, 1390.0, 1115.0, 820.0, 690.0, 600.0, 790.0, 1200.0, 1000.0, 1125.0, 1215.0, 950.0, 480.0, 620.0, 900.0, 340.0, 1160.0, 2190.0, 1580.0, 600.0, 1470.0, 955.0, 930.0, 1205.0, 1440.0, 420.0, 2005.0, 950.0, 335.0, 1020.0, 1030.0, 1160.0, 790.0, 710.0, 970.0, 1230.0, 1200.0, 1045.0, 810.0, 1040.0, 815.0, 1300.0, 1260.0, 1040.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [360.0, 130.0, 130.0, 110.0, 70.0, 10.0, 40.0, 10.0, 80.0, 30.0, 100.0, 110.0, 70.0, 50.0, 180.0, 30.0, 210.0, 0.0, 50.0, 340.0, 30.0, 120.0, 50.0, 20.0, 40.0, 40.0, 30.0, 50.0, 50.0, 10.0, 60.0, 40.0, 110.0, 40.0, 0.0, 370.0, 40.0, 90.0, 310.0, 120.0, 190.0, 0.0, 80.0, 160.0, 15.0, 70.0, 30.0, 100.0, 10.0, 30.0, 30.0, 90.0, 20.0, 70.0, 30.0, 30.0, 20.0, 110.0, 50.0, 20.0, 0.0, 50.0, 160.0, -40.0, 30.0, 160.0, 40.0, 80.0, 360.0, 105.0, 240.0, 10.0, 120.0, 70.0, -50.0, 360.0, 370.0, 120.0, -50.0, 40.0, 120.0, 15.0, 130.0, 320.0, 110.0, 110.0, 360.0, -10.0, -10.0, 140.0, 10.0, 140.0, 160.0, 70.0, 100.0, 20.0, 250.0, 50.0, 20.0, 40.0, 180.0, 50.0, 410.0, 80.0, 180.0, 0.0, 40.0, 100.0, 230.0, 260.0, 40.0, 10.0, 270.0, 0.0, 70.0, -10.0, 90.0, 30.0, 80.0, 70.0, 10.0, 20.0, 160.0, 90.0, 30.0, 30.0, 60.0, 10.0, 10.0, 150.0, 150.0, 30.0, 330.0, 80.0, 20.0, 80.0, 80.0, 120.0, 50.0, 90.0, 100.0, 110.0, 190.0, 80.0, 60.0, 220.0, 100.0, 40.0, 160.0, 40.0, 220.0, 50.0, 130.0, 90.0, 50.0, 130.0, 140.0, 90.0, 180.0, 120.0, 310.0, 160.0, 60.0, 240.0, 70.0, 160.0, 80.0, 110.0, 40.0, 160.0, 170.0, -30.0, 120.0, 270.0, 60.0, 210.0, 60.0, -30.0, 70.0, 220.0, 20.0, 30.0, 70.0, 90.0, 60.0, 310.0, 70.0, 0.0, 20.0, 150.0, -170.0, 90.0, 90.0, 100.0, 280.0, 120.0, 180.0, 10.0, 130.0, 100.0, 50.0, 240.0, 100.0, 130.0, 230.0, 220.0, 20.0, 150.0, 230.0, 140.0, 50.0, 160.0, 100.0, 210.0, -25.0, 70.0, 80.0, 80.0, 30.0, 50.0, 170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0, 120.0, 300.0, 30.0, 140.0, 90.0, 110.0, 270.0, 80.0, 10.0, 90.0, 100.0, 40.0, 290.0, 70.0, 230.0, 25.0, 260.0, 130.0, 90.0, 100.0, 380.0, 220.0, 610.0, 80.0, 70.0, 25.0, 50.0, -30.0, -30.0, 20.0, 70.0, 240.0, 240.0, 130.0, 20.0, 200.0, 240.0, 80.0, 50.0, 120.0, 320.0, -120.0, 100.0, 130.0, 150.0, 120.0, 110.0, 160.0, 50.0, -35.0, 40.0, 250.0, 90.0, 20.0, 40.0, 0.0, 0.0, 40.0, 0.0, 40.0, 80.0, 30.0, 15.0, 40.0, 270.0, -5.0, 20.0, 210.0, 100.0, 90.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 50.0, 20.0, 60.0, 110.0, 40.0, 320.0, 60.0, 140.0, 50.0, 240.0, 140.0, 20.0, 30.0, 140.0, 20.0, 70.0, 150.0, 20.0, 160.0, 90.0, 130.0, 140.0, 540.0, 60.0, 110.0, 70.0, 30.0, 10.0, 80.0, 110.0, 35.0, 20.0, 20.0, 40.0, 10.0, 10.0, -30.0, 50.0, 0.0, 20.0, 60.0, 360.0, 160.0, 270.0, 110.0, 90.0, 90.0, 120.0, -30.0, 60.0, -20.0, 50.0, 70.0, 270.0, 60.0, 60.0, 40.0, 20.0, 70.0, 30.0, 0.0, 90.0, 30.0, 320.0, 130.0, 30.0, 0.0, 20.0, 160.0, 60.0, 40.0, 20.0, 130.0, 320.0, 190.0, -40.0, 50.0, 70.0, 280.0, 70.0, 140.0, 90.0, 10.0, 70.0, 20.0, 200.0, 90.0, 50.0, 210.0, 30.0, 300.0, 0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0, 90.0, 60.0, 290.0, 120.0, 70.0, 220.0, 200.0, 150.0, 70.0, 220.0, 420.0, 280.0, 150.0, 890.0, 150.0, 90.0, 20.0, 230.0, 10.0, 80.0, 60.0, 140.0, 5.0, 840.0, 80.0, 90.0, 250.0, 70.0, 160.0, 230.0, 40.0, 60.0, 230.0, 50.0, 80.0, 230.0, 160.0, 450.0, -10.0, 25.0, 110.0, 20.0, -40.0, 20.0, 10.0, 340.0, 140.0, 80.0, 270.0, 100.0, 10.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 0.0, 0.0, 0.0, 40.0, -25.0, 80.0, 80.0, 170.0, 30.0, 390.0, 130.0, 70.0, 305.0, 170.0, 320.0, 230.0, 85.0, 240.0, 70.0, 140.0, 90.0, 220.0, 20.0, 130.0, 80.0, 80.0, 90.0, 250.0, 380.0, 150.0, 80.0, 35.0, 145.0, 10.0, 160.0, 120.0, 50.0, 80.0, 30.0, 30.0, 60.0, 50.0, 40.0, 50.0, 110.0, 20.0, 130.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 290.0, 210.0, 20.0, 100.0, 30.0, 90.0, 210.0, 40.0, 60.0, 100.0, 70.0, 140.0, 50.0, 20.0, 100.0, 240.0, 10.0, 90.0, 150.0, 60.0, 90.0, 30.0, 35.0, 10.0, 140.0, 30.0, 10.0, 35.0, 90.0, 260.0, 210.0, 180.0, 100.0, 160.0, 130.0, 160.0, -20.0, 90.0, 260.0, 0.0, 320.0, 160.0, 60.0, 140.0, 160.0, 30.0, 110.0, 0.0, 250.0, 160.0, 80.0, 40.0, 60.0, 370.0, 90.0, 80.0, 50.0, -10.0, 275.0, 80.0, 50.0, -50.0, 30.0, 80.0, 30.0, 280.0, 190.0, 60.0, 60.0, 90.0, 270.0, 20.0, 10.0, 80.0, 40.0, 20.0, 70.0, 120.0, 50.0, 10.0, 20.0, 90.0, 20.0, 20.0, 60.0, 90.0, 200.0, 10.0, 20.0, 70.0, 40.0, 170.0, 100.0, 110.0, 70.0, 30.0, 140.0, 20.0, 40.0, 70.0, 10.0, 150.0, 40.0, 80.0, 250.0, 50.0, 100.0, 320.0, 100.0, 100.0, 100.0, 50.0, 80.0, 70.0, 200.0, 250.0, 50.0, 80.0, 80.0, 40.0, -50.0, 20.0, 20.0, 20.0, 80.0, 570.0, 45.0, 30.0, 160.0, 230.0, 80.0, 65.0, 210.0, 180.0, 70.0, 10.0, 80.0, 70.0, 220.0, 230.0, -10.0, 40.0, 410.0, 60.0, 60.0, 30.0, 20.0, 190.0, 100.0, 50.0, 0.0, 20.0, 100.0, 90.0, 30.0, 10.0, -10.0, 0.0, 0.0, 240.0, 30.0, 60.0, 10.0, 40.0, 70.0, 200.0, 70.0, 60.0, 40.0, 40.0, 30.0, 170.0, 230.0, 110.0, 70.0, 80.0, 120.0, 30.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 120.0, 40.0, 20.0, 60.0, 920.0, -20.0, 10.0, 40.0, 10.0, -20.0, 30.0, 0.0, 130.0, 490.0, 290.0, 600.0, 250.0, 20.0, 40.0, 20.0, 40.0, 170.0, 270.0, 140.0, 150.0, 130.0, 70.0, 100.0, 330.0, 300.0, 70.0, 200.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 10.0, 40.0, 20.0, 160.0, 20.0, 80.0, 80.0, 80.0, 80.0, 30.0, 540.0, 100.0, 220.0, 90.0, 170.0, 100.0, 50.0, 110.0, 50.0, 40.0, 20.0, 60.0, 45.0, 90.0, 390.0, 310.0, 50.0, 40.0, 60.0, -60.0, 10.0, 220.0, 120.0, 80.0, 100.0, 10.0, 0.0, 130.0, 250.0, 20.0, 60.0, 600.0, 10.0, 70.0, 55.0, 20.0, 360.0, 30.0, -30.0, 310.0, 180.0, 410.0, 120.0, 30.0, 10.0, -5.0, 40.0, 30.0, 40.0, 40.0, 140.0, 20.0, 80.0, 10.0, 25.0, 120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0, 40.0, 0.0, 210.0, 200.0, 100.0, 20.0, 90.0, 40.0, 170.0, 80.0, 0.0, 30.0, 40.0, 80.0, 5.0, 30.0, 10.0, 80.0, 10.0, 50.0, 80.0, 60.0, 210.0, 30.0, 60.0, 220.0, 50.0, 160.0, 70.0, 80.0, 110.0, 40.0, 280.0, 240.0, 100.0, 40.0, 10.0, 0.0, 120.0, 90.0, 260.0, 30.0, 60.0, 90.0, 60.0, 210.0, 10.0, 30.0, 200.0, 210.0, 80.0, 20.0, 110.0, 50.0, 20.0, 20.0, 170.0, 50.0, 110.0, 160.0, 50.0, 20.0, 80.0, 110.0, 20.0, 120.0, 120.0, 0.0, 10.0, 180.0, 140.0, 230.0, 90.0, 40.0, 50.0, 80.0, 120.0, 120.0, 80.0, 20.0, 60.0, 330.0, 140.0, 100.0, 70.0, 40.0, 170.0, 60.0, 210.0, 50.0, -10.0, 120.0, 80.0, 90.0, 200.0, 100.0, 40.0, 460.0, 90.0, 30.0, 270.0, 5.0, 20.0, 30.0, 70.0, 20.0, 10.0, 450.0, 130.0, 40.0, 90.0, 90.0, 0.0, 70.0, 240.0, 20.0, 180.0, 50.0, 40.0, 30.0, 60.0, 5.0, 30.0, -5.0, 180.0, 20.0, 170.0, 320.0, 140.0, 120.0, 50.0, 50.0, 10.0, 130.0, 200.0, 150.0, 20.0, 160.0, 20.0, 25.0, 40.0, 240.0, 230.0, 40.0, 100.0, 100.0, 210.0, 50.0, 90.0, 200.0, 140.0, 60.0, 340.0, 170.0, 80.0, 120.0, 120.0, 50.0, 70.0, 110.0, 30.0, 80.0, 140.0, 50.0, 70.0, 170.0, 290.0, 110.0, 70.0, 30.0, 80.0, -20.0, 420.0, 0.0, 20.0, 30.0, 180.0, -20.0, 190.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5273424677785983, "mean_inference_ms": 1.4082695442893511, "mean_action_processing_ms": 0.4461176957087598, "mean_env_wait_ms": 1.2427261656398079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012561798095703125, "StateBufferConnector_ms": 0.01044774055480957, "ViewRequirementAgentConnector_ms": 0.3975701332092285}, "num_episodes": 18, "episode_return_max": 2320.0, "episode_return_min": 200.0, "episode_return_mean": 1024.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.257333673027325, "num_env_steps_trained_throughput_per_sec": 21.257333673027325, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 186316.371, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186316.326, "sample_time_ms": 2468.369, "learn_time_ms": 183826.934, "learn_throughput": 21.76, "synch_weights_time_ms": 11.505}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "33e63_00000", "date": "2024-06-19_02-56-54", "timestamp": 1718780214, "time_this_iter_s": 188.17762875556946, "time_total_s": 20995.720985412598, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278e83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 20995.720985412598, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 18.074812030075186, "ram_util_percent": 79.33646616541354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0211798531623186, "cur_kl_coeff": 8.210510444641114, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0037735389812112536, "vf_loss": 7.647289523072898, "vf_explained_var": -0.00041941586520852117, "kl": Infinity, "entropy": 0.3421880180557696, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 2320.0, "episode_reward_min": 200.0, "episode_reward_mean": 1056.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -120.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 105.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 1240.0, 1335.0, 1395.0, 1390.0, 985.0, 520.0, 850.0, 210.0, 1180.0, 830.0, 1185.0, 200.0, 1210.0, 670.0, 880.0, 1230.0, 1070.0, 810.0, 1490.0, 2320.0, 1925.0, 1315.0, 1050.0, 200.0, 1270.0, 1585.0, 1420.0, 630.0, 440.0, 1150.0, 930.0, 730.0, 1270.0, 1390.0, 1115.0, 820.0, 690.0, 600.0, 790.0, 1200.0, 1000.0, 1125.0, 1215.0, 950.0, 480.0, 620.0, 900.0, 340.0, 1160.0, 2190.0, 1580.0, 600.0, 1470.0, 955.0, 930.0, 1205.0, 1440.0, 420.0, 2005.0, 950.0, 335.0, 1020.0, 1030.0, 1160.0, 790.0, 710.0, 970.0, 1230.0, 1200.0, 1045.0, 810.0, 1040.0, 815.0, 1300.0, 1260.0, 1040.0, 960.0, 1040.0, 960.0, 1025.0, 1820.0, 920.0, 1375.0, 1130.0, 880.0, 870.0, 940.0, 1440.0, 1370.0, 610.0, 770.0, 820.0, 760.0, 600.0, 1320.0, 1625.0, 1525.0, 1280.0, 1910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 20.0, 160.0, 0.0, 50.0, 160.0, 170.0, 50.0, 50.0, 30.0, 120.0, 300.0, 30.0, 140.0, 90.0, 110.0, 270.0, 80.0, 10.0, 90.0, 100.0, 40.0, 290.0, 70.0, 230.0, 25.0, 260.0, 130.0, 90.0, 100.0, 380.0, 220.0, 610.0, 80.0, 70.0, 25.0, 50.0, -30.0, -30.0, 20.0, 70.0, 240.0, 240.0, 130.0, 20.0, 200.0, 240.0, 80.0, 50.0, 120.0, 320.0, -120.0, 100.0, 130.0, 150.0, 120.0, 110.0, 160.0, 50.0, -35.0, 40.0, 250.0, 90.0, 20.0, 40.0, 0.0, 0.0, 40.0, 0.0, 40.0, 80.0, 30.0, 15.0, 40.0, 270.0, -5.0, 20.0, 210.0, 100.0, 90.0, 0.0, 0.0, 30.0, 30.0, 30.0, 10.0, 20.0, 30.0, 10.0, 50.0, 20.0, 60.0, 110.0, 40.0, 320.0, 60.0, 140.0, 50.0, 240.0, 140.0, 20.0, 30.0, 140.0, 20.0, 70.0, 150.0, 20.0, 160.0, 90.0, 130.0, 140.0, 540.0, 60.0, 110.0, 70.0, 30.0, 10.0, 80.0, 110.0, 35.0, 20.0, 20.0, 40.0, 10.0, 10.0, -30.0, 50.0, 0.0, 20.0, 60.0, 360.0, 160.0, 270.0, 110.0, 90.0, 90.0, 120.0, -30.0, 60.0, -20.0, 50.0, 70.0, 270.0, 60.0, 60.0, 40.0, 20.0, 70.0, 30.0, 0.0, 90.0, 30.0, 320.0, 130.0, 30.0, 0.0, 20.0, 160.0, 60.0, 40.0, 20.0, 130.0, 320.0, 190.0, -40.0, 50.0, 70.0, 280.0, 70.0, 140.0, 90.0, 10.0, 70.0, 20.0, 200.0, 90.0, 50.0, 210.0, 30.0, 300.0, 0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0, 90.0, 60.0, 290.0, 120.0, 70.0, 220.0, 200.0, 150.0, 70.0, 220.0, 420.0, 280.0, 150.0, 890.0, 150.0, 90.0, 20.0, 230.0, 10.0, 80.0, 60.0, 140.0, 5.0, 840.0, 80.0, 90.0, 250.0, 70.0, 160.0, 230.0, 40.0, 60.0, 230.0, 50.0, 80.0, 230.0, 160.0, 450.0, -10.0, 25.0, 110.0, 20.0, -40.0, 20.0, 10.0, 340.0, 140.0, 80.0, 270.0, 100.0, 10.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 0.0, 0.0, 0.0, 40.0, -25.0, 80.0, 80.0, 170.0, 30.0, 390.0, 130.0, 70.0, 305.0, 170.0, 320.0, 230.0, 85.0, 240.0, 70.0, 140.0, 90.0, 220.0, 20.0, 130.0, 80.0, 80.0, 90.0, 250.0, 380.0, 150.0, 80.0, 35.0, 145.0, 10.0, 160.0, 120.0, 50.0, 80.0, 30.0, 30.0, 60.0, 50.0, 40.0, 50.0, 110.0, 20.0, 130.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 290.0, 210.0, 20.0, 100.0, 30.0, 90.0, 210.0, 40.0, 60.0, 100.0, 70.0, 140.0, 50.0, 20.0, 100.0, 240.0, 10.0, 90.0, 150.0, 60.0, 90.0, 30.0, 35.0, 10.0, 140.0, 30.0, 10.0, 35.0, 90.0, 260.0, 210.0, 180.0, 100.0, 160.0, 130.0, 160.0, -20.0, 90.0, 260.0, 0.0, 320.0, 160.0, 60.0, 140.0, 160.0, 30.0, 110.0, 0.0, 250.0, 160.0, 80.0, 40.0, 60.0, 370.0, 90.0, 80.0, 50.0, -10.0, 275.0, 80.0, 50.0, -50.0, 30.0, 80.0, 30.0, 280.0, 190.0, 60.0, 60.0, 90.0, 270.0, 20.0, 10.0, 80.0, 40.0, 20.0, 70.0, 120.0, 50.0, 10.0, 20.0, 90.0, 20.0, 20.0, 60.0, 90.0, 200.0, 10.0, 20.0, 70.0, 40.0, 170.0, 100.0, 110.0, 70.0, 30.0, 140.0, 20.0, 40.0, 70.0, 10.0, 150.0, 40.0, 80.0, 250.0, 50.0, 100.0, 320.0, 100.0, 100.0, 100.0, 50.0, 80.0, 70.0, 200.0, 250.0, 50.0, 80.0, 80.0, 40.0, -50.0, 20.0, 20.0, 20.0, 80.0, 570.0, 45.0, 30.0, 160.0, 230.0, 80.0, 65.0, 210.0, 180.0, 70.0, 10.0, 80.0, 70.0, 220.0, 230.0, -10.0, 40.0, 410.0, 60.0, 60.0, 30.0, 20.0, 190.0, 100.0, 50.0, 0.0, 20.0, 100.0, 90.0, 30.0, 10.0, -10.0, 0.0, 0.0, 240.0, 30.0, 60.0, 10.0, 40.0, 70.0, 200.0, 70.0, 60.0, 40.0, 40.0, 30.0, 170.0, 230.0, 110.0, 70.0, 80.0, 120.0, 30.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 120.0, 40.0, 20.0, 60.0, 920.0, -20.0, 10.0, 40.0, 10.0, -20.0, 30.0, 0.0, 130.0, 490.0, 290.0, 600.0, 250.0, 20.0, 40.0, 20.0, 40.0, 170.0, 270.0, 140.0, 150.0, 130.0, 70.0, 100.0, 330.0, 300.0, 70.0, 200.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 10.0, 40.0, 20.0, 160.0, 20.0, 80.0, 80.0, 80.0, 80.0, 30.0, 540.0, 100.0, 220.0, 90.0, 170.0, 100.0, 50.0, 110.0, 50.0, 40.0, 20.0, 60.0, 45.0, 90.0, 390.0, 310.0, 50.0, 40.0, 60.0, -60.0, 10.0, 220.0, 120.0, 80.0, 100.0, 10.0, 0.0, 130.0, 250.0, 20.0, 60.0, 600.0, 10.0, 70.0, 55.0, 20.0, 360.0, 30.0, -30.0, 310.0, 180.0, 410.0, 120.0, 30.0, 10.0, -5.0, 40.0, 30.0, 40.0, 40.0, 140.0, 20.0, 80.0, 10.0, 25.0, 120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0, 40.0, 0.0, 210.0, 200.0, 100.0, 20.0, 90.0, 40.0, 170.0, 80.0, 0.0, 30.0, 40.0, 80.0, 5.0, 30.0, 10.0, 80.0, 10.0, 50.0, 80.0, 60.0, 210.0, 30.0, 60.0, 220.0, 50.0, 160.0, 70.0, 80.0, 110.0, 40.0, 280.0, 240.0, 100.0, 40.0, 10.0, 0.0, 120.0, 90.0, 260.0, 30.0, 60.0, 90.0, 60.0, 210.0, 10.0, 30.0, 200.0, 210.0, 80.0, 20.0, 110.0, 50.0, 20.0, 20.0, 170.0, 50.0, 110.0, 160.0, 50.0, 20.0, 80.0, 110.0, 20.0, 120.0, 120.0, 0.0, 10.0, 180.0, 140.0, 230.0, 90.0, 40.0, 50.0, 80.0, 120.0, 120.0, 80.0, 20.0, 60.0, 330.0, 140.0, 100.0, 70.0, 40.0, 170.0, 60.0, 210.0, 50.0, -10.0, 120.0, 80.0, 90.0, 200.0, 100.0, 40.0, 460.0, 90.0, 30.0, 270.0, 5.0, 20.0, 30.0, 70.0, 20.0, 10.0, 450.0, 130.0, 40.0, 90.0, 90.0, 0.0, 70.0, 240.0, 20.0, 180.0, 50.0, 40.0, 30.0, 60.0, 5.0, 30.0, -5.0, 180.0, 20.0, 170.0, 320.0, 140.0, 120.0, 50.0, 50.0, 10.0, 130.0, 200.0, 150.0, 20.0, 160.0, 20.0, 25.0, 40.0, 240.0, 230.0, 40.0, 100.0, 100.0, 210.0, 50.0, 90.0, 200.0, 140.0, 60.0, 340.0, 170.0, 80.0, 120.0, 120.0, 50.0, 70.0, 110.0, 30.0, 80.0, 140.0, 50.0, 70.0, 170.0, 290.0, 110.0, 70.0, 30.0, 80.0, -20.0, 420.0, 0.0, 20.0, 30.0, 180.0, -20.0, 190.0, 80.0, 120.0, 230.0, 50.0, 140.0, 30.0, -20.0, 110.0, 10.0, 30.0, 340.0, 40.0, 240.0, 70.0, 50.0, 60.0, 80.0, 190.0, 170.0, 30.0, 30.0, 210.0, 20.0, 120.0, 60.0, 70.0, 95.0, 70.0, 120.0, 160.0, 100.0, 0.0, 580.0, 40.0, 610.0, 60.0, 70.0, 80.0, 10.0, 240.0, 130.0, 100.0, -30.0, 60.0, 20.0, 10.0, 210.0, 40.0, 80.0, 410.0, 20.0, 100.0, 170.0, 280.0, 60.0, 35.0, 200.0, 140.0, 160.0, 70.0, 160.0, 20.0, 110.0, 20.0, 90.0, 30.0, 30.0, 560.0, 40.0, 40.0, 190.0, 100.0, 90.0, 40.0, 20.0, 60.0, 50.0, 170.0, 140.0, 200.0, 10.0, 120.0, 10.0, 10.0, 80.0, 100.0, 90.0, 240.0, 70.0, 80.0, 70.0, 160.0, 60.0, 80.0, 30.0, 60.0, 70.0, 50.0, 120.0, 60.0, 250.0, 110.0, 50.0, 100.0, 130.0, 160.0, 180.0, 220.0, 70.0, 470.0, -50.0, -70.0, 70.0, 50.0, 70.0, 190.0, 210.0, 70.0, 250.0, 210.0, 320.0, 30.0, -100.0, 60.0, 370.0, 30.0, 40.0, 20.0, 100.0, 20.0, 40.0, 20.0, 40.0, 70.0, 40.0, 50.0, 70.0, 200.0, 100.0, 80.0, 100.0, 170.0, 120.0, 160.0, 120.0, 40.0, 120.0, 20.0, 20.0, 20.0, 30.0, 170.0, 20.0, 50.0, 90.0, 210.0, 40.0, 20.0, 0.0, 40.0, 120.0, 20.0, 100.0, 30.0, 10.0, 100.0, 20.0, 120.0, 150.0, 20.0, 30.0, 180.0, 170.0, 130.0, 100.0, 210.0, 110.0, 220.0, 40.0, 90.0, 70.0, 80.0, 45.0, 530.0, 70.0, -50.0, 140.0, 160.0, 190.0, 100.0, 360.0, 150.0, 80.0, 80.0, 540.0, 150.0, 80.0, 180.0, 85.0, 110.0, 70.0, 160.0, 70.0, 140.0, 10.0, 160.0, 120.0, 0.0, 240.0, 280.0, 100.0, 170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.527156774496143, "mean_inference_ms": 1.4084975929896948, "mean_action_processing_ms": 0.4455639616781452, "mean_env_wait_ms": 1.2427376539208523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013448476791381836, "StateBufferConnector_ms": 0.010845661163330078, "ViewRequirementAgentConnector_ms": 0.4105203151702881}, "num_episodes": 22, "episode_return_max": 2320.0, "episode_return_min": 200.0, "episode_return_mean": 1056.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.53116954337736, "num_env_steps_trained_throughput_per_sec": 21.53116954337736, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 186087.326, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186087.277, "sample_time_ms": 2453.447, "learn_time_ms": 183612.092, "learn_throughput": 21.785, "synch_weights_time_ms": 11.26}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "33e63_00000", "date": "2024-06-19_03-00-00", "timestamp": 1718780400, "time_this_iter_s": 185.79349207878113, "time_total_s": 21181.51447749138, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32791d700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21181.51447749138, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.2361216730038, "ram_util_percent": 79.40114068441065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.43100492212846, "cur_kl_coeff": 12.31576566696167, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.295113252806334, "policy_loss": -0.002967886985587085, "vf_loss": 6.2953630455004905, "vf_explained_var": 0.00022976484161596329, "kl": 0.0002206999068643593, "entropy": 0.3840008326041432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 2320.0, "episode_reward_min": 100.0, "episode_reward_mean": 1039.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 103.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [810.0, 1490.0, 2320.0, 1925.0, 1315.0, 1050.0, 200.0, 1270.0, 1585.0, 1420.0, 630.0, 440.0, 1150.0, 930.0, 730.0, 1270.0, 1390.0, 1115.0, 820.0, 690.0, 600.0, 790.0, 1200.0, 1000.0, 1125.0, 1215.0, 950.0, 480.0, 620.0, 900.0, 340.0, 1160.0, 2190.0, 1580.0, 600.0, 1470.0, 955.0, 930.0, 1205.0, 1440.0, 420.0, 2005.0, 950.0, 335.0, 1020.0, 1030.0, 1160.0, 790.0, 710.0, 970.0, 1230.0, 1200.0, 1045.0, 810.0, 1040.0, 815.0, 1300.0, 1260.0, 1040.0, 960.0, 1040.0, 960.0, 1025.0, 1820.0, 920.0, 1375.0, 1130.0, 880.0, 870.0, 940.0, 1440.0, 1370.0, 610.0, 770.0, 820.0, 760.0, 600.0, 1320.0, 1625.0, 1525.0, 1280.0, 1910.0, 945.0, 1650.0, 720.0, 950.0, 375.0, 1025.0, 710.0, 450.0, 440.0, 1505.0, 1730.0, 770.0, 250.0, 1040.0, 1320.0, 100.0, 1085.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 190.0, 160.0, 260.0, 140.0, -20.0, -30.0, 40.0, 60.0, 10.0, 90.0, 60.0, 290.0, 120.0, 70.0, 220.0, 200.0, 150.0, 70.0, 220.0, 420.0, 280.0, 150.0, 890.0, 150.0, 90.0, 20.0, 230.0, 10.0, 80.0, 60.0, 140.0, 5.0, 840.0, 80.0, 90.0, 250.0, 70.0, 160.0, 230.0, 40.0, 60.0, 230.0, 50.0, 80.0, 230.0, 160.0, 450.0, -10.0, 25.0, 110.0, 20.0, -40.0, 20.0, 10.0, 340.0, 140.0, 80.0, 270.0, 100.0, 10.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 0.0, 0.0, 0.0, 40.0, -25.0, 80.0, 80.0, 170.0, 30.0, 390.0, 130.0, 70.0, 305.0, 170.0, 320.0, 230.0, 85.0, 240.0, 70.0, 140.0, 90.0, 220.0, 20.0, 130.0, 80.0, 80.0, 90.0, 250.0, 380.0, 150.0, 80.0, 35.0, 145.0, 10.0, 160.0, 120.0, 50.0, 80.0, 30.0, 30.0, 60.0, 50.0, 40.0, 50.0, 110.0, 20.0, 130.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 290.0, 210.0, 20.0, 100.0, 30.0, 90.0, 210.0, 40.0, 60.0, 100.0, 70.0, 140.0, 50.0, 20.0, 100.0, 240.0, 10.0, 90.0, 150.0, 60.0, 90.0, 30.0, 35.0, 10.0, 140.0, 30.0, 10.0, 35.0, 90.0, 260.0, 210.0, 180.0, 100.0, 160.0, 130.0, 160.0, -20.0, 90.0, 260.0, 0.0, 320.0, 160.0, 60.0, 140.0, 160.0, 30.0, 110.0, 0.0, 250.0, 160.0, 80.0, 40.0, 60.0, 370.0, 90.0, 80.0, 50.0, -10.0, 275.0, 80.0, 50.0, -50.0, 30.0, 80.0, 30.0, 280.0, 190.0, 60.0, 60.0, 90.0, 270.0, 20.0, 10.0, 80.0, 40.0, 20.0, 70.0, 120.0, 50.0, 10.0, 20.0, 90.0, 20.0, 20.0, 60.0, 90.0, 200.0, 10.0, 20.0, 70.0, 40.0, 170.0, 100.0, 110.0, 70.0, 30.0, 140.0, 20.0, 40.0, 70.0, 10.0, 150.0, 40.0, 80.0, 250.0, 50.0, 100.0, 320.0, 100.0, 100.0, 100.0, 50.0, 80.0, 70.0, 200.0, 250.0, 50.0, 80.0, 80.0, 40.0, -50.0, 20.0, 20.0, 20.0, 80.0, 570.0, 45.0, 30.0, 160.0, 230.0, 80.0, 65.0, 210.0, 180.0, 70.0, 10.0, 80.0, 70.0, 220.0, 230.0, -10.0, 40.0, 410.0, 60.0, 60.0, 30.0, 20.0, 190.0, 100.0, 50.0, 0.0, 20.0, 100.0, 90.0, 30.0, 10.0, -10.0, 0.0, 0.0, 240.0, 30.0, 60.0, 10.0, 40.0, 70.0, 200.0, 70.0, 60.0, 40.0, 40.0, 30.0, 170.0, 230.0, 110.0, 70.0, 80.0, 120.0, 30.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 120.0, 40.0, 20.0, 60.0, 920.0, -20.0, 10.0, 40.0, 10.0, -20.0, 30.0, 0.0, 130.0, 490.0, 290.0, 600.0, 250.0, 20.0, 40.0, 20.0, 40.0, 170.0, 270.0, 140.0, 150.0, 130.0, 70.0, 100.0, 330.0, 300.0, 70.0, 200.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 10.0, 40.0, 20.0, 160.0, 20.0, 80.0, 80.0, 80.0, 80.0, 30.0, 540.0, 100.0, 220.0, 90.0, 170.0, 100.0, 50.0, 110.0, 50.0, 40.0, 20.0, 60.0, 45.0, 90.0, 390.0, 310.0, 50.0, 40.0, 60.0, -60.0, 10.0, 220.0, 120.0, 80.0, 100.0, 10.0, 0.0, 130.0, 250.0, 20.0, 60.0, 600.0, 10.0, 70.0, 55.0, 20.0, 360.0, 30.0, -30.0, 310.0, 180.0, 410.0, 120.0, 30.0, 10.0, -5.0, 40.0, 30.0, 40.0, 40.0, 140.0, 20.0, 80.0, 10.0, 25.0, 120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0, 40.0, 0.0, 210.0, 200.0, 100.0, 20.0, 90.0, 40.0, 170.0, 80.0, 0.0, 30.0, 40.0, 80.0, 5.0, 30.0, 10.0, 80.0, 10.0, 50.0, 80.0, 60.0, 210.0, 30.0, 60.0, 220.0, 50.0, 160.0, 70.0, 80.0, 110.0, 40.0, 280.0, 240.0, 100.0, 40.0, 10.0, 0.0, 120.0, 90.0, 260.0, 30.0, 60.0, 90.0, 60.0, 210.0, 10.0, 30.0, 200.0, 210.0, 80.0, 20.0, 110.0, 50.0, 20.0, 20.0, 170.0, 50.0, 110.0, 160.0, 50.0, 20.0, 80.0, 110.0, 20.0, 120.0, 120.0, 0.0, 10.0, 180.0, 140.0, 230.0, 90.0, 40.0, 50.0, 80.0, 120.0, 120.0, 80.0, 20.0, 60.0, 330.0, 140.0, 100.0, 70.0, 40.0, 170.0, 60.0, 210.0, 50.0, -10.0, 120.0, 80.0, 90.0, 200.0, 100.0, 40.0, 460.0, 90.0, 30.0, 270.0, 5.0, 20.0, 30.0, 70.0, 20.0, 10.0, 450.0, 130.0, 40.0, 90.0, 90.0, 0.0, 70.0, 240.0, 20.0, 180.0, 50.0, 40.0, 30.0, 60.0, 5.0, 30.0, -5.0, 180.0, 20.0, 170.0, 320.0, 140.0, 120.0, 50.0, 50.0, 10.0, 130.0, 200.0, 150.0, 20.0, 160.0, 20.0, 25.0, 40.0, 240.0, 230.0, 40.0, 100.0, 100.0, 210.0, 50.0, 90.0, 200.0, 140.0, 60.0, 340.0, 170.0, 80.0, 120.0, 120.0, 50.0, 70.0, 110.0, 30.0, 80.0, 140.0, 50.0, 70.0, 170.0, 290.0, 110.0, 70.0, 30.0, 80.0, -20.0, 420.0, 0.0, 20.0, 30.0, 180.0, -20.0, 190.0, 80.0, 120.0, 230.0, 50.0, 140.0, 30.0, -20.0, 110.0, 10.0, 30.0, 340.0, 40.0, 240.0, 70.0, 50.0, 60.0, 80.0, 190.0, 170.0, 30.0, 30.0, 210.0, 20.0, 120.0, 60.0, 70.0, 95.0, 70.0, 120.0, 160.0, 100.0, 0.0, 580.0, 40.0, 610.0, 60.0, 70.0, 80.0, 10.0, 240.0, 130.0, 100.0, -30.0, 60.0, 20.0, 10.0, 210.0, 40.0, 80.0, 410.0, 20.0, 100.0, 170.0, 280.0, 60.0, 35.0, 200.0, 140.0, 160.0, 70.0, 160.0, 20.0, 110.0, 20.0, 90.0, 30.0, 30.0, 560.0, 40.0, 40.0, 190.0, 100.0, 90.0, 40.0, 20.0, 60.0, 50.0, 170.0, 140.0, 200.0, 10.0, 120.0, 10.0, 10.0, 80.0, 100.0, 90.0, 240.0, 70.0, 80.0, 70.0, 160.0, 60.0, 80.0, 30.0, 60.0, 70.0, 50.0, 120.0, 60.0, 250.0, 110.0, 50.0, 100.0, 130.0, 160.0, 180.0, 220.0, 70.0, 470.0, -50.0, -70.0, 70.0, 50.0, 70.0, 190.0, 210.0, 70.0, 250.0, 210.0, 320.0, 30.0, -100.0, 60.0, 370.0, 30.0, 40.0, 20.0, 100.0, 20.0, 40.0, 20.0, 40.0, 70.0, 40.0, 50.0, 70.0, 200.0, 100.0, 80.0, 100.0, 170.0, 120.0, 160.0, 120.0, 40.0, 120.0, 20.0, 20.0, 20.0, 30.0, 170.0, 20.0, 50.0, 90.0, 210.0, 40.0, 20.0, 0.0, 40.0, 120.0, 20.0, 100.0, 30.0, 10.0, 100.0, 20.0, 120.0, 150.0, 20.0, 30.0, 180.0, 170.0, 130.0, 100.0, 210.0, 110.0, 220.0, 40.0, 90.0, 70.0, 80.0, 45.0, 530.0, 70.0, -50.0, 140.0, 160.0, 190.0, 100.0, 360.0, 150.0, 80.0, 80.0, 540.0, 150.0, 80.0, 180.0, 85.0, 110.0, 70.0, 160.0, 70.0, 140.0, 10.0, 160.0, 120.0, 0.0, 240.0, 280.0, 100.0, 170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0, 30.0, 70.0, 30.0, 70.0, 80.0, 210.0, 55.0, 170.0, 170.0, 60.0, 370.0, 170.0, 50.0, 90.0, 40.0, 600.0, 60.0, 10.0, 70.0, 190.0, 0.0, 80.0, 70.0, 20.0, 10.0, 20.0, 280.0, 40.0, 30.0, 170.0, 60.0, 120.0, 70.0, 130.0, 130.0, 300.0, 20.0, 20.0, 30.0, 70.0, 30.0, 35.0, 0.0, 30.0, 120.0, 30.0, 30.0, 40.0, 40.0, 20.0, 60.0, 60.0, 170.0, 30.0, 5.0, 60.0, 90.0, 70.0, 350.0, 130.0, 40.0, 140.0, 40.0, 130.0, 40.0, 40.0, 20.0, 10.0, 250.0, 0.0, 70.0, 10.0, 150.0, 30.0, -10.0, 30.0, 30.0, 90.0, 20.0, 30.0, 290.0, 10.0, 40.0, 60.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, -10.0, 110.0, 200.0, 115.0, 160.0, -30.0, 160.0, 550.0, 210.0, 100.0, 570.0, 170.0, 120.0, 60.0, 290.0, 80.0, 50.0, 130.0, 160.0, 170.0, 20.0, 220.0, 90.0, 90.0, 80.0, 0.0, 20.0, 40.0, 40.0, 0.0, 50.0, 40.0, 60.0, -30.0, 50.0, 0.0, 50.0, 0.0, 30.0, 10.0, 190.0, 120.0, 180.0, 80.0, 260.0, 10.0, 50.0, 100.0, 40.0, 20.0, 40.0, 120.0, 220.0, 100.0, 110.0, 40.0, 370.0, 230.0, 70.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, -60.0, 140.0, 20.0, -5.0, 190.0, 160.0, 90.0, 230.0, 260.0, 60.0, 20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5269622389914417, "mean_inference_ms": 1.4086127560512218, "mean_action_processing_ms": 0.4451614836184152, "mean_env_wait_ms": 1.2427631175357052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013108491897583008, "StateBufferConnector_ms": 0.01071023941040039, "ViewRequirementAgentConnector_ms": 0.40943193435668945}, "num_episodes": 18, "episode_return_max": 2320.0, "episode_return_min": 100.0, "episode_return_mean": 1039.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.38867784816618, "num_env_steps_trained_throughput_per_sec": 21.38867784816618, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 186101.115, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186101.066, "sample_time_ms": 2445.926, "learn_time_ms": 183633.6, "learn_throughput": 21.783, "synch_weights_time_ms": 11.221}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "33e63_00000", "date": "2024-06-19_03-03-07", "timestamp": 1718780587, "time_this_iter_s": 187.0231750011444, "time_total_s": 21368.537652492523, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32791dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21368.537652492523, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 16.967045454545456, "ram_util_percent": 79.74583333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.450300977824214, "cur_kl_coeff": 6.157882833480835, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.207372209845514, "policy_loss": -0.004323056381589042, "vf_loss": 7.208533029891432, "vf_explained_var": 0.00154647968066767, "kl": 0.0005135258225767241, "entropy": 0.3652584927785384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 2190.0, "episode_reward_min": 100.0, "episode_reward_mean": 1007.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 920.0}, "policy_reward_mean": {"policy_0": 100.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1000.0, 1125.0, 1215.0, 950.0, 480.0, 620.0, 900.0, 340.0, 1160.0, 2190.0, 1580.0, 600.0, 1470.0, 955.0, 930.0, 1205.0, 1440.0, 420.0, 2005.0, 950.0, 335.0, 1020.0, 1030.0, 1160.0, 790.0, 710.0, 970.0, 1230.0, 1200.0, 1045.0, 810.0, 1040.0, 815.0, 1300.0, 1260.0, 1040.0, 960.0, 1040.0, 960.0, 1025.0, 1820.0, 920.0, 1375.0, 1130.0, 880.0, 870.0, 940.0, 1440.0, 1370.0, 610.0, 770.0, 820.0, 760.0, 600.0, 1320.0, 1625.0, 1525.0, 1280.0, 1910.0, 945.0, 1650.0, 720.0, 950.0, 375.0, 1025.0, 710.0, 450.0, 440.0, 1505.0, 1730.0, 770.0, 250.0, 1040.0, 1320.0, 100.0, 1085.0, 520.0, 745.0, 1120.0, 750.0, 860.0, 1075.0, 300.0, 870.0, 1480.0, 560.0, 1020.0, 1390.0, 685.0, 1205.0, 1245.0, 425.0, 1380.0, 1010.0, 695.0, 620.0, 1570.0, 995.0, 1135.0, 820.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 50.0, 80.0, 70.0, 200.0, 250.0, 50.0, 80.0, 80.0, 40.0, -50.0, 20.0, 20.0, 20.0, 80.0, 570.0, 45.0, 30.0, 160.0, 230.0, 80.0, 65.0, 210.0, 180.0, 70.0, 10.0, 80.0, 70.0, 220.0, 230.0, -10.0, 40.0, 410.0, 60.0, 60.0, 30.0, 20.0, 190.0, 100.0, 50.0, 0.0, 20.0, 100.0, 90.0, 30.0, 10.0, -10.0, 0.0, 0.0, 240.0, 30.0, 60.0, 10.0, 40.0, 70.0, 200.0, 70.0, 60.0, 40.0, 40.0, 30.0, 170.0, 230.0, 110.0, 70.0, 80.0, 120.0, 30.0, 20.0, 40.0, 40.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 120.0, 40.0, 20.0, 60.0, 920.0, -20.0, 10.0, 40.0, 10.0, -20.0, 30.0, 0.0, 130.0, 490.0, 290.0, 600.0, 250.0, 20.0, 40.0, 20.0, 40.0, 170.0, 270.0, 140.0, 150.0, 130.0, 70.0, 100.0, 330.0, 300.0, 70.0, 200.0, 90.0, 20.0, 120.0, 100.0, 50.0, 60.0, 10.0, 40.0, 20.0, 160.0, 20.0, 80.0, 80.0, 80.0, 80.0, 30.0, 540.0, 100.0, 220.0, 90.0, 170.0, 100.0, 50.0, 110.0, 50.0, 40.0, 20.0, 60.0, 45.0, 90.0, 390.0, 310.0, 50.0, 40.0, 60.0, -60.0, 10.0, 220.0, 120.0, 80.0, 100.0, 10.0, 0.0, 130.0, 250.0, 20.0, 60.0, 600.0, 10.0, 70.0, 55.0, 20.0, 360.0, 30.0, -30.0, 310.0, 180.0, 410.0, 120.0, 30.0, 10.0, -5.0, 40.0, 30.0, 40.0, 40.0, 140.0, 20.0, 80.0, 10.0, 25.0, 120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0, 40.0, 0.0, 210.0, 200.0, 100.0, 20.0, 90.0, 40.0, 170.0, 80.0, 0.0, 30.0, 40.0, 80.0, 5.0, 30.0, 10.0, 80.0, 10.0, 50.0, 80.0, 60.0, 210.0, 30.0, 60.0, 220.0, 50.0, 160.0, 70.0, 80.0, 110.0, 40.0, 280.0, 240.0, 100.0, 40.0, 10.0, 0.0, 120.0, 90.0, 260.0, 30.0, 60.0, 90.0, 60.0, 210.0, 10.0, 30.0, 200.0, 210.0, 80.0, 20.0, 110.0, 50.0, 20.0, 20.0, 170.0, 50.0, 110.0, 160.0, 50.0, 20.0, 80.0, 110.0, 20.0, 120.0, 120.0, 0.0, 10.0, 180.0, 140.0, 230.0, 90.0, 40.0, 50.0, 80.0, 120.0, 120.0, 80.0, 20.0, 60.0, 330.0, 140.0, 100.0, 70.0, 40.0, 170.0, 60.0, 210.0, 50.0, -10.0, 120.0, 80.0, 90.0, 200.0, 100.0, 40.0, 460.0, 90.0, 30.0, 270.0, 5.0, 20.0, 30.0, 70.0, 20.0, 10.0, 450.0, 130.0, 40.0, 90.0, 90.0, 0.0, 70.0, 240.0, 20.0, 180.0, 50.0, 40.0, 30.0, 60.0, 5.0, 30.0, -5.0, 180.0, 20.0, 170.0, 320.0, 140.0, 120.0, 50.0, 50.0, 10.0, 130.0, 200.0, 150.0, 20.0, 160.0, 20.0, 25.0, 40.0, 240.0, 230.0, 40.0, 100.0, 100.0, 210.0, 50.0, 90.0, 200.0, 140.0, 60.0, 340.0, 170.0, 80.0, 120.0, 120.0, 50.0, 70.0, 110.0, 30.0, 80.0, 140.0, 50.0, 70.0, 170.0, 290.0, 110.0, 70.0, 30.0, 80.0, -20.0, 420.0, 0.0, 20.0, 30.0, 180.0, -20.0, 190.0, 80.0, 120.0, 230.0, 50.0, 140.0, 30.0, -20.0, 110.0, 10.0, 30.0, 340.0, 40.0, 240.0, 70.0, 50.0, 60.0, 80.0, 190.0, 170.0, 30.0, 30.0, 210.0, 20.0, 120.0, 60.0, 70.0, 95.0, 70.0, 120.0, 160.0, 100.0, 0.0, 580.0, 40.0, 610.0, 60.0, 70.0, 80.0, 10.0, 240.0, 130.0, 100.0, -30.0, 60.0, 20.0, 10.0, 210.0, 40.0, 80.0, 410.0, 20.0, 100.0, 170.0, 280.0, 60.0, 35.0, 200.0, 140.0, 160.0, 70.0, 160.0, 20.0, 110.0, 20.0, 90.0, 30.0, 30.0, 560.0, 40.0, 40.0, 190.0, 100.0, 90.0, 40.0, 20.0, 60.0, 50.0, 170.0, 140.0, 200.0, 10.0, 120.0, 10.0, 10.0, 80.0, 100.0, 90.0, 240.0, 70.0, 80.0, 70.0, 160.0, 60.0, 80.0, 30.0, 60.0, 70.0, 50.0, 120.0, 60.0, 250.0, 110.0, 50.0, 100.0, 130.0, 160.0, 180.0, 220.0, 70.0, 470.0, -50.0, -70.0, 70.0, 50.0, 70.0, 190.0, 210.0, 70.0, 250.0, 210.0, 320.0, 30.0, -100.0, 60.0, 370.0, 30.0, 40.0, 20.0, 100.0, 20.0, 40.0, 20.0, 40.0, 70.0, 40.0, 50.0, 70.0, 200.0, 100.0, 80.0, 100.0, 170.0, 120.0, 160.0, 120.0, 40.0, 120.0, 20.0, 20.0, 20.0, 30.0, 170.0, 20.0, 50.0, 90.0, 210.0, 40.0, 20.0, 0.0, 40.0, 120.0, 20.0, 100.0, 30.0, 10.0, 100.0, 20.0, 120.0, 150.0, 20.0, 30.0, 180.0, 170.0, 130.0, 100.0, 210.0, 110.0, 220.0, 40.0, 90.0, 70.0, 80.0, 45.0, 530.0, 70.0, -50.0, 140.0, 160.0, 190.0, 100.0, 360.0, 150.0, 80.0, 80.0, 540.0, 150.0, 80.0, 180.0, 85.0, 110.0, 70.0, 160.0, 70.0, 140.0, 10.0, 160.0, 120.0, 0.0, 240.0, 280.0, 100.0, 170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0, 30.0, 70.0, 30.0, 70.0, 80.0, 210.0, 55.0, 170.0, 170.0, 60.0, 370.0, 170.0, 50.0, 90.0, 40.0, 600.0, 60.0, 10.0, 70.0, 190.0, 0.0, 80.0, 70.0, 20.0, 10.0, 20.0, 280.0, 40.0, 30.0, 170.0, 60.0, 120.0, 70.0, 130.0, 130.0, 300.0, 20.0, 20.0, 30.0, 70.0, 30.0, 35.0, 0.0, 30.0, 120.0, 30.0, 30.0, 40.0, 40.0, 20.0, 60.0, 60.0, 170.0, 30.0, 5.0, 60.0, 90.0, 70.0, 350.0, 130.0, 40.0, 140.0, 40.0, 130.0, 40.0, 40.0, 20.0, 10.0, 250.0, 0.0, 70.0, 10.0, 150.0, 30.0, -10.0, 30.0, 30.0, 90.0, 20.0, 30.0, 290.0, 10.0, 40.0, 60.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, -10.0, 110.0, 200.0, 115.0, 160.0, -30.0, 160.0, 550.0, 210.0, 100.0, 570.0, 170.0, 120.0, 60.0, 290.0, 80.0, 50.0, 130.0, 160.0, 170.0, 20.0, 220.0, 90.0, 90.0, 80.0, 0.0, 20.0, 40.0, 40.0, 0.0, 50.0, 40.0, 60.0, -30.0, 50.0, 0.0, 50.0, 0.0, 30.0, 10.0, 190.0, 120.0, 180.0, 80.0, 260.0, 10.0, 50.0, 100.0, 40.0, 20.0, 40.0, 120.0, 220.0, 100.0, 110.0, 40.0, 370.0, 230.0, 70.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, -60.0, 140.0, 20.0, -5.0, 190.0, 160.0, 90.0, 230.0, 260.0, 60.0, 20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0, 190.0, 300.0, 20.0, 40.0, 60.0, 40.0, 160.0, -30.0, 15.0, -50.0, 10.0, 110.0, 60.0, 410.0, 10.0, 140.0, 20.0, 50.0, 30.0, 280.0, 50.0, 120.0, 70.0, 70.0, 40.0, 90.0, 70.0, 170.0, 0.0, 70.0, 10.0, 170.0, 180.0, 30.0, 20.0, 150.0, 30.0, 60.0, 30.0, 180.0, -55.0, 10.0, 340.0, 60.0, 300.0, 20.0, 70.0, 40.0, 30.0, 260.0, 30.0, 90.0, 20.0, 60.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 100.0, 50.0, 210.0, 70.0, 40.0, 170.0, 20.0, 10.0, 200.0, 0.0, 70.0, 110.0, 130.0, 90.0, 30.0, 220.0, 180.0, 50.0, 210.0, 390.0, 50.0, 40.0, 170.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 150.0, 0.0, 100.0, 200.0, 10.0, 230.0, 120.0, 120.0, 80.0, 120.0, 40.0, 40.0, -30.0, 100.0, 110.0, 450.0, 170.0, 310.0, 110.0, 20.0, 110.0, 10.0, 115.0, 160.0, 60.0, 40.0, 20.0, 20.0, 0.0, 80.0, 180.0, 50.0, 5.0, 130.0, 90.0, 0.0, 80.0, 110.0, 180.0, 170.0, 390.0, 90.0, 310.0, 80.0, 70.0, 300.0, 5.0, 110.0, 210.0, 40.0, 30.0, 0.0, 20.0, 60.0, 50.0, 220.0, 0.0, 25.0, 10.0, 30.0, 10.0, 50.0, 50.0, 240.0, 300.0, 280.0, 240.0, 190.0, 20.0, 10.0, 0.0, 530.0, 40.0, 30.0, 10.0, 90.0, 50.0, 30.0, 30.0, 120.0, 80.0, 20.0, 60.0, 30.0, 60.0, 15.0, 40.0, 20.0, 50.0, 160.0, 240.0, 40.0, 100.0, 40.0, 40.0, 80.0, 0.0, 160.0, 60.0, 60.0, 40.0, 30.0, 190.0, 10.0, 460.0, 30.0, 310.0, 290.0, 10.0, 120.0, 120.0, 65.0, 50.0, 40.0, 0.0, 70.0, 210.0, 30.0, 40.0, 10.0, 480.0, 120.0, 80.0, 60.0, 50.0, 320.0, 30.0, 60.0, 75.0, 210.0, 130.0, -35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5268610515049599, "mean_inference_ms": 1.4074384134995186, "mean_action_processing_ms": 0.4456621905615169, "mean_env_wait_ms": 1.2425427232155708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01300954818725586, "StateBufferConnector_ms": 0.010694503784179688, "ViewRequirementAgentConnector_ms": 0.3893110752105713}, "num_episodes": 23, "episode_return_max": 2190.0, "episode_return_min": 100.0, "episode_return_mean": 1007.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.094402037597696, "num_env_steps_trained_throughput_per_sec": 21.094402037597696, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 186444.629, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186444.579, "sample_time_ms": 2546.324, "learn_time_ms": 183876.249, "learn_throughput": 21.754, "synch_weights_time_ms": 11.746}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "33e63_00000", "date": "2024-06-19_03-06-16", "timestamp": 1718780776, "time_this_iter_s": 189.63132309913635, "time_total_s": 21558.16897559166, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32791df70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21558.16897559166, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 18.05223880597015, "ram_util_percent": 81.8731343283582}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1022734019258658, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00579200464645966, "vf_loss": 6.4952618219093265, "vf_explained_var": 0.0011589549981747952, "kl": Infinity, "entropy": 0.42208162535366794, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 2005.0, "episode_reward_min": 100.0, "episode_reward_mean": 992.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 870.0}, "policy_reward_mean": {"policy_0": 99.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2005.0, 950.0, 335.0, 1020.0, 1030.0, 1160.0, 790.0, 710.0, 970.0, 1230.0, 1200.0, 1045.0, 810.0, 1040.0, 815.0, 1300.0, 1260.0, 1040.0, 960.0, 1040.0, 960.0, 1025.0, 1820.0, 920.0, 1375.0, 1130.0, 880.0, 870.0, 940.0, 1440.0, 1370.0, 610.0, 770.0, 820.0, 760.0, 600.0, 1320.0, 1625.0, 1525.0, 1280.0, 1910.0, 945.0, 1650.0, 720.0, 950.0, 375.0, 1025.0, 710.0, 450.0, 440.0, 1505.0, 1730.0, 770.0, 250.0, 1040.0, 1320.0, 100.0, 1085.0, 520.0, 745.0, 1120.0, 750.0, 860.0, 1075.0, 300.0, 870.0, 1480.0, 560.0, 1020.0, 1390.0, 685.0, 1205.0, 1245.0, 425.0, 1380.0, 1010.0, 695.0, 620.0, 1570.0, 995.0, 1135.0, 820.0, 1740.0, 860.0, 620.0, 1600.0, 1470.0, 1145.0, 1620.0, 540.0, 620.0, 315.0, 700.0, 1260.0, 795.0, 240.0, 250.0, 1390.0, 1090.0, 830.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 90.0, 30.0, 190.0, 55.0, 100.0, 870.0, 220.0, 130.0, 200.0, 40.0, 0.0, 210.0, 200.0, 100.0, 20.0, 90.0, 40.0, 170.0, 80.0, 0.0, 30.0, 40.0, 80.0, 5.0, 30.0, 10.0, 80.0, 10.0, 50.0, 80.0, 60.0, 210.0, 30.0, 60.0, 220.0, 50.0, 160.0, 70.0, 80.0, 110.0, 40.0, 280.0, 240.0, 100.0, 40.0, 10.0, 0.0, 120.0, 90.0, 260.0, 30.0, 60.0, 90.0, 60.0, 210.0, 10.0, 30.0, 200.0, 210.0, 80.0, 20.0, 110.0, 50.0, 20.0, 20.0, 170.0, 50.0, 110.0, 160.0, 50.0, 20.0, 80.0, 110.0, 20.0, 120.0, 120.0, 0.0, 10.0, 180.0, 140.0, 230.0, 90.0, 40.0, 50.0, 80.0, 120.0, 120.0, 80.0, 20.0, 60.0, 330.0, 140.0, 100.0, 70.0, 40.0, 170.0, 60.0, 210.0, 50.0, -10.0, 120.0, 80.0, 90.0, 200.0, 100.0, 40.0, 460.0, 90.0, 30.0, 270.0, 5.0, 20.0, 30.0, 70.0, 20.0, 10.0, 450.0, 130.0, 40.0, 90.0, 90.0, 0.0, 70.0, 240.0, 20.0, 180.0, 50.0, 40.0, 30.0, 60.0, 5.0, 30.0, -5.0, 180.0, 20.0, 170.0, 320.0, 140.0, 120.0, 50.0, 50.0, 10.0, 130.0, 200.0, 150.0, 20.0, 160.0, 20.0, 25.0, 40.0, 240.0, 230.0, 40.0, 100.0, 100.0, 210.0, 50.0, 90.0, 200.0, 140.0, 60.0, 340.0, 170.0, 80.0, 120.0, 120.0, 50.0, 70.0, 110.0, 30.0, 80.0, 140.0, 50.0, 70.0, 170.0, 290.0, 110.0, 70.0, 30.0, 80.0, -20.0, 420.0, 0.0, 20.0, 30.0, 180.0, -20.0, 190.0, 80.0, 120.0, 230.0, 50.0, 140.0, 30.0, -20.0, 110.0, 10.0, 30.0, 340.0, 40.0, 240.0, 70.0, 50.0, 60.0, 80.0, 190.0, 170.0, 30.0, 30.0, 210.0, 20.0, 120.0, 60.0, 70.0, 95.0, 70.0, 120.0, 160.0, 100.0, 0.0, 580.0, 40.0, 610.0, 60.0, 70.0, 80.0, 10.0, 240.0, 130.0, 100.0, -30.0, 60.0, 20.0, 10.0, 210.0, 40.0, 80.0, 410.0, 20.0, 100.0, 170.0, 280.0, 60.0, 35.0, 200.0, 140.0, 160.0, 70.0, 160.0, 20.0, 110.0, 20.0, 90.0, 30.0, 30.0, 560.0, 40.0, 40.0, 190.0, 100.0, 90.0, 40.0, 20.0, 60.0, 50.0, 170.0, 140.0, 200.0, 10.0, 120.0, 10.0, 10.0, 80.0, 100.0, 90.0, 240.0, 70.0, 80.0, 70.0, 160.0, 60.0, 80.0, 30.0, 60.0, 70.0, 50.0, 120.0, 60.0, 250.0, 110.0, 50.0, 100.0, 130.0, 160.0, 180.0, 220.0, 70.0, 470.0, -50.0, -70.0, 70.0, 50.0, 70.0, 190.0, 210.0, 70.0, 250.0, 210.0, 320.0, 30.0, -100.0, 60.0, 370.0, 30.0, 40.0, 20.0, 100.0, 20.0, 40.0, 20.0, 40.0, 70.0, 40.0, 50.0, 70.0, 200.0, 100.0, 80.0, 100.0, 170.0, 120.0, 160.0, 120.0, 40.0, 120.0, 20.0, 20.0, 20.0, 30.0, 170.0, 20.0, 50.0, 90.0, 210.0, 40.0, 20.0, 0.0, 40.0, 120.0, 20.0, 100.0, 30.0, 10.0, 100.0, 20.0, 120.0, 150.0, 20.0, 30.0, 180.0, 170.0, 130.0, 100.0, 210.0, 110.0, 220.0, 40.0, 90.0, 70.0, 80.0, 45.0, 530.0, 70.0, -50.0, 140.0, 160.0, 190.0, 100.0, 360.0, 150.0, 80.0, 80.0, 540.0, 150.0, 80.0, 180.0, 85.0, 110.0, 70.0, 160.0, 70.0, 140.0, 10.0, 160.0, 120.0, 0.0, 240.0, 280.0, 100.0, 170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0, 30.0, 70.0, 30.0, 70.0, 80.0, 210.0, 55.0, 170.0, 170.0, 60.0, 370.0, 170.0, 50.0, 90.0, 40.0, 600.0, 60.0, 10.0, 70.0, 190.0, 0.0, 80.0, 70.0, 20.0, 10.0, 20.0, 280.0, 40.0, 30.0, 170.0, 60.0, 120.0, 70.0, 130.0, 130.0, 300.0, 20.0, 20.0, 30.0, 70.0, 30.0, 35.0, 0.0, 30.0, 120.0, 30.0, 30.0, 40.0, 40.0, 20.0, 60.0, 60.0, 170.0, 30.0, 5.0, 60.0, 90.0, 70.0, 350.0, 130.0, 40.0, 140.0, 40.0, 130.0, 40.0, 40.0, 20.0, 10.0, 250.0, 0.0, 70.0, 10.0, 150.0, 30.0, -10.0, 30.0, 30.0, 90.0, 20.0, 30.0, 290.0, 10.0, 40.0, 60.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, -10.0, 110.0, 200.0, 115.0, 160.0, -30.0, 160.0, 550.0, 210.0, 100.0, 570.0, 170.0, 120.0, 60.0, 290.0, 80.0, 50.0, 130.0, 160.0, 170.0, 20.0, 220.0, 90.0, 90.0, 80.0, 0.0, 20.0, 40.0, 40.0, 0.0, 50.0, 40.0, 60.0, -30.0, 50.0, 0.0, 50.0, 0.0, 30.0, 10.0, 190.0, 120.0, 180.0, 80.0, 260.0, 10.0, 50.0, 100.0, 40.0, 20.0, 40.0, 120.0, 220.0, 100.0, 110.0, 40.0, 370.0, 230.0, 70.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, -60.0, 140.0, 20.0, -5.0, 190.0, 160.0, 90.0, 230.0, 260.0, 60.0, 20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0, 190.0, 300.0, 20.0, 40.0, 60.0, 40.0, 160.0, -30.0, 15.0, -50.0, 10.0, 110.0, 60.0, 410.0, 10.0, 140.0, 20.0, 50.0, 30.0, 280.0, 50.0, 120.0, 70.0, 70.0, 40.0, 90.0, 70.0, 170.0, 0.0, 70.0, 10.0, 170.0, 180.0, 30.0, 20.0, 150.0, 30.0, 60.0, 30.0, 180.0, -55.0, 10.0, 340.0, 60.0, 300.0, 20.0, 70.0, 40.0, 30.0, 260.0, 30.0, 90.0, 20.0, 60.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 100.0, 50.0, 210.0, 70.0, 40.0, 170.0, 20.0, 10.0, 200.0, 0.0, 70.0, 110.0, 130.0, 90.0, 30.0, 220.0, 180.0, 50.0, 210.0, 390.0, 50.0, 40.0, 170.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 150.0, 0.0, 100.0, 200.0, 10.0, 230.0, 120.0, 120.0, 80.0, 120.0, 40.0, 40.0, -30.0, 100.0, 110.0, 450.0, 170.0, 310.0, 110.0, 20.0, 110.0, 10.0, 115.0, 160.0, 60.0, 40.0, 20.0, 20.0, 0.0, 80.0, 180.0, 50.0, 5.0, 130.0, 90.0, 0.0, 80.0, 110.0, 180.0, 170.0, 390.0, 90.0, 310.0, 80.0, 70.0, 300.0, 5.0, 110.0, 210.0, 40.0, 30.0, 0.0, 20.0, 60.0, 50.0, 220.0, 0.0, 25.0, 10.0, 30.0, 10.0, 50.0, 50.0, 240.0, 300.0, 280.0, 240.0, 190.0, 20.0, 10.0, 0.0, 530.0, 40.0, 30.0, 10.0, 90.0, 50.0, 30.0, 30.0, 120.0, 80.0, 20.0, 60.0, 30.0, 60.0, 15.0, 40.0, 20.0, 50.0, 160.0, 240.0, 40.0, 100.0, 40.0, 40.0, 80.0, 0.0, 160.0, 60.0, 60.0, 40.0, 30.0, 190.0, 10.0, 460.0, 30.0, 310.0, 290.0, 10.0, 120.0, 120.0, 65.0, 50.0, 40.0, 0.0, 70.0, 210.0, 30.0, 40.0, 10.0, 480.0, 120.0, 80.0, 60.0, 50.0, 320.0, 30.0, 60.0, 75.0, 210.0, 130.0, -35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0, 270.0, 200.0, 200.0, 190.0, 80.0, 30.0, 610.0, 70.0, 130.0, -40.0, 100.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 260.0, 250.0, 170.0, 80.0, 180.0, 0.0, 0.0, 40.0, 10.0, 60.0, 90.0, 120.0, 40.0, -5.0, 170.0, 60.0, -15.0, 420.0, 210.0, 40.0, 190.0, 450.0, 80.0, 60.0, 100.0, 340.0, 20.0, 110.0, 50.0, 330.0, 310.0, 80.0, 70.0, 100.0, 100.0, 20.0, 150.0, 420.0, 40.0, 50.0, 60.0, 15.0, 190.0, 400.0, 260.0, 250.0, 70.0, 40.0, 190.0, -10.0, 100.0, 220.0, 100.0, 310.0, 60.0, 120.0, 30.0, 0.0, 30.0, 10.0, -20.0, -10.0, 10.0, 50.0, 110.0, 120.0, 10.0, 10.0, 20.0, 30.0, 50.0, 20.0, 200.0, 50.0, 25.0, 50.0, -60.0, 20.0, 80.0, 20.0, 30.0, 40.0, 60.0, -40.0, -40.0, 90.0, 35.0, 20.0, 190.0, 0.0, 370.0, 20.0, 55.0, 350.0, 160.0, -20.0, 220.0, -40.0, 290.0, 60.0, 40.0, 40.0, 160.0, 50.0, 340.0, 170.0, 0.0, 60.0, 80.0, 0.0, 10.0, 45.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 30.0, 20.0, 20.0, 60.0, 10.0, 30.0, 10.0, 0.0, 320.0, 20.0, 220.0, 180.0, 100.0, 70.0, 90.0, 80.0, 110.0, 200.0, 20.0, 30.0, 160.0, 90.0, 50.0, 50.0, 210.0, 340.0, 110.0, 30.0, 50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5258023097746818, "mean_inference_ms": 1.4082926514741902, "mean_action_processing_ms": 0.4500077314828496, "mean_env_wait_ms": 1.2425176874884007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012462377548217773, "StateBufferConnector_ms": 0.009295463562011719, "ViewRequirementAgentConnector_ms": 0.3754608631134033}, "num_episodes": 18, "episode_return_max": 2005.0, "episode_return_min": 100.0, "episode_return_mean": 992.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.328458172718467, "num_env_steps_trained_throughput_per_sec": 21.328458172718467, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 186624.586, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186624.537, "sample_time_ms": 2613.661, "learn_time_ms": 183989.03, "learn_throughput": 21.74, "synch_weights_time_ms": 11.831}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "33e63_00000", "date": "2024-06-19_03-09-24", "timestamp": 1718780964, "time_this_iter_s": 187.54856085777283, "time_total_s": 21745.717536449432, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327708dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21745.717536449432, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 16.59056603773585, "ram_util_percent": 80.6290566037736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.728422885123914, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004890576773608268, "vf_loss": 7.463709443369613, "vf_explained_var": -0.0002636242090576627, "kl": Infinity, "entropy": 0.35284291756705355, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 100.0, "episode_reward_mean": 995.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 610.0}, "policy_reward_mean": {"policy_0": 99.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1820.0, 920.0, 1375.0, 1130.0, 880.0, 870.0, 940.0, 1440.0, 1370.0, 610.0, 770.0, 820.0, 760.0, 600.0, 1320.0, 1625.0, 1525.0, 1280.0, 1910.0, 945.0, 1650.0, 720.0, 950.0, 375.0, 1025.0, 710.0, 450.0, 440.0, 1505.0, 1730.0, 770.0, 250.0, 1040.0, 1320.0, 100.0, 1085.0, 520.0, 745.0, 1120.0, 750.0, 860.0, 1075.0, 300.0, 870.0, 1480.0, 560.0, 1020.0, 1390.0, 685.0, 1205.0, 1245.0, 425.0, 1380.0, 1010.0, 695.0, 620.0, 1570.0, 995.0, 1135.0, 820.0, 1740.0, 860.0, 620.0, 1600.0, 1470.0, 1145.0, 1620.0, 540.0, 620.0, 315.0, 700.0, 1260.0, 795.0, 240.0, 250.0, 1390.0, 1090.0, 830.0, 1090.0, 1120.0, 610.0, 1460.0, 950.0, 1350.0, 705.0, 570.0, 780.0, 780.0, 880.0, 1300.0, 1320.0, 1615.0, 995.0, 905.0, 1170.0, 855.0, 300.0, 1805.0, 755.0, 1650.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 580.0, 40.0, 610.0, 60.0, 70.0, 80.0, 10.0, 240.0, 130.0, 100.0, -30.0, 60.0, 20.0, 10.0, 210.0, 40.0, 80.0, 410.0, 20.0, 100.0, 170.0, 280.0, 60.0, 35.0, 200.0, 140.0, 160.0, 70.0, 160.0, 20.0, 110.0, 20.0, 90.0, 30.0, 30.0, 560.0, 40.0, 40.0, 190.0, 100.0, 90.0, 40.0, 20.0, 60.0, 50.0, 170.0, 140.0, 200.0, 10.0, 120.0, 10.0, 10.0, 80.0, 100.0, 90.0, 240.0, 70.0, 80.0, 70.0, 160.0, 60.0, 80.0, 30.0, 60.0, 70.0, 50.0, 120.0, 60.0, 250.0, 110.0, 50.0, 100.0, 130.0, 160.0, 180.0, 220.0, 70.0, 470.0, -50.0, -70.0, 70.0, 50.0, 70.0, 190.0, 210.0, 70.0, 250.0, 210.0, 320.0, 30.0, -100.0, 60.0, 370.0, 30.0, 40.0, 20.0, 100.0, 20.0, 40.0, 20.0, 40.0, 70.0, 40.0, 50.0, 70.0, 200.0, 100.0, 80.0, 100.0, 170.0, 120.0, 160.0, 120.0, 40.0, 120.0, 20.0, 20.0, 20.0, 30.0, 170.0, 20.0, 50.0, 90.0, 210.0, 40.0, 20.0, 0.0, 40.0, 120.0, 20.0, 100.0, 30.0, 10.0, 100.0, 20.0, 120.0, 150.0, 20.0, 30.0, 180.0, 170.0, 130.0, 100.0, 210.0, 110.0, 220.0, 40.0, 90.0, 70.0, 80.0, 45.0, 530.0, 70.0, -50.0, 140.0, 160.0, 190.0, 100.0, 360.0, 150.0, 80.0, 80.0, 540.0, 150.0, 80.0, 180.0, 85.0, 110.0, 70.0, 160.0, 70.0, 140.0, 10.0, 160.0, 120.0, 0.0, 240.0, 280.0, 100.0, 170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0, 30.0, 70.0, 30.0, 70.0, 80.0, 210.0, 55.0, 170.0, 170.0, 60.0, 370.0, 170.0, 50.0, 90.0, 40.0, 600.0, 60.0, 10.0, 70.0, 190.0, 0.0, 80.0, 70.0, 20.0, 10.0, 20.0, 280.0, 40.0, 30.0, 170.0, 60.0, 120.0, 70.0, 130.0, 130.0, 300.0, 20.0, 20.0, 30.0, 70.0, 30.0, 35.0, 0.0, 30.0, 120.0, 30.0, 30.0, 40.0, 40.0, 20.0, 60.0, 60.0, 170.0, 30.0, 5.0, 60.0, 90.0, 70.0, 350.0, 130.0, 40.0, 140.0, 40.0, 130.0, 40.0, 40.0, 20.0, 10.0, 250.0, 0.0, 70.0, 10.0, 150.0, 30.0, -10.0, 30.0, 30.0, 90.0, 20.0, 30.0, 290.0, 10.0, 40.0, 60.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, -10.0, 110.0, 200.0, 115.0, 160.0, -30.0, 160.0, 550.0, 210.0, 100.0, 570.0, 170.0, 120.0, 60.0, 290.0, 80.0, 50.0, 130.0, 160.0, 170.0, 20.0, 220.0, 90.0, 90.0, 80.0, 0.0, 20.0, 40.0, 40.0, 0.0, 50.0, 40.0, 60.0, -30.0, 50.0, 0.0, 50.0, 0.0, 30.0, 10.0, 190.0, 120.0, 180.0, 80.0, 260.0, 10.0, 50.0, 100.0, 40.0, 20.0, 40.0, 120.0, 220.0, 100.0, 110.0, 40.0, 370.0, 230.0, 70.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, -60.0, 140.0, 20.0, -5.0, 190.0, 160.0, 90.0, 230.0, 260.0, 60.0, 20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0, 190.0, 300.0, 20.0, 40.0, 60.0, 40.0, 160.0, -30.0, 15.0, -50.0, 10.0, 110.0, 60.0, 410.0, 10.0, 140.0, 20.0, 50.0, 30.0, 280.0, 50.0, 120.0, 70.0, 70.0, 40.0, 90.0, 70.0, 170.0, 0.0, 70.0, 10.0, 170.0, 180.0, 30.0, 20.0, 150.0, 30.0, 60.0, 30.0, 180.0, -55.0, 10.0, 340.0, 60.0, 300.0, 20.0, 70.0, 40.0, 30.0, 260.0, 30.0, 90.0, 20.0, 60.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 100.0, 50.0, 210.0, 70.0, 40.0, 170.0, 20.0, 10.0, 200.0, 0.0, 70.0, 110.0, 130.0, 90.0, 30.0, 220.0, 180.0, 50.0, 210.0, 390.0, 50.0, 40.0, 170.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 150.0, 0.0, 100.0, 200.0, 10.0, 230.0, 120.0, 120.0, 80.0, 120.0, 40.0, 40.0, -30.0, 100.0, 110.0, 450.0, 170.0, 310.0, 110.0, 20.0, 110.0, 10.0, 115.0, 160.0, 60.0, 40.0, 20.0, 20.0, 0.0, 80.0, 180.0, 50.0, 5.0, 130.0, 90.0, 0.0, 80.0, 110.0, 180.0, 170.0, 390.0, 90.0, 310.0, 80.0, 70.0, 300.0, 5.0, 110.0, 210.0, 40.0, 30.0, 0.0, 20.0, 60.0, 50.0, 220.0, 0.0, 25.0, 10.0, 30.0, 10.0, 50.0, 50.0, 240.0, 300.0, 280.0, 240.0, 190.0, 20.0, 10.0, 0.0, 530.0, 40.0, 30.0, 10.0, 90.0, 50.0, 30.0, 30.0, 120.0, 80.0, 20.0, 60.0, 30.0, 60.0, 15.0, 40.0, 20.0, 50.0, 160.0, 240.0, 40.0, 100.0, 40.0, 40.0, 80.0, 0.0, 160.0, 60.0, 60.0, 40.0, 30.0, 190.0, 10.0, 460.0, 30.0, 310.0, 290.0, 10.0, 120.0, 120.0, 65.0, 50.0, 40.0, 0.0, 70.0, 210.0, 30.0, 40.0, 10.0, 480.0, 120.0, 80.0, 60.0, 50.0, 320.0, 30.0, 60.0, 75.0, 210.0, 130.0, -35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0, 270.0, 200.0, 200.0, 190.0, 80.0, 30.0, 610.0, 70.0, 130.0, -40.0, 100.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 260.0, 250.0, 170.0, 80.0, 180.0, 0.0, 0.0, 40.0, 10.0, 60.0, 90.0, 120.0, 40.0, -5.0, 170.0, 60.0, -15.0, 420.0, 210.0, 40.0, 190.0, 450.0, 80.0, 60.0, 100.0, 340.0, 20.0, 110.0, 50.0, 330.0, 310.0, 80.0, 70.0, 100.0, 100.0, 20.0, 150.0, 420.0, 40.0, 50.0, 60.0, 15.0, 190.0, 400.0, 260.0, 250.0, 70.0, 40.0, 190.0, -10.0, 100.0, 220.0, 100.0, 310.0, 60.0, 120.0, 30.0, 0.0, 30.0, 10.0, -20.0, -10.0, 10.0, 50.0, 110.0, 120.0, 10.0, 10.0, 20.0, 30.0, 50.0, 20.0, 200.0, 50.0, 25.0, 50.0, -60.0, 20.0, 80.0, 20.0, 30.0, 40.0, 60.0, -40.0, -40.0, 90.0, 35.0, 20.0, 190.0, 0.0, 370.0, 20.0, 55.0, 350.0, 160.0, -20.0, 220.0, -40.0, 290.0, 60.0, 40.0, 40.0, 160.0, 50.0, 340.0, 170.0, 0.0, 60.0, 80.0, 0.0, 10.0, 45.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 30.0, 20.0, 20.0, 60.0, 10.0, 30.0, 10.0, 0.0, 320.0, 20.0, 220.0, 180.0, 100.0, 70.0, 90.0, 80.0, 110.0, 200.0, 20.0, 30.0, 160.0, 90.0, 50.0, 50.0, 210.0, 340.0, 110.0, 30.0, 50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0, 160.0, 120.0, 30.0, 80.0, 80.0, 80.0, 20.0, 80.0, 390.0, 50.0, 120.0, 60.0, 70.0, 40.0, 140.0, 0.0, 340.0, 180.0, 70.0, 100.0, 140.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, -20.0, 50.0, 300.0, 130.0, 100.0, 110.0, 80.0, 320.0, 280.0, 90.0, -20.0, -30.0, 400.0, 60.0, 110.0, 280.0, 40.0, 260.0, 70.0, -20.0, 30.0, 30.0, 90.0, 0.0, 20.0, 70.0, 140.0, 130.0, 90.0, 440.0, 110.0, 260.0, 90.0, -150.0, 40.0, 360.0, 40.0, 30.0, 35.0, 0.0, 300.0, 40.0, 10.0, 40.0, 90.0, 80.0, 90.0, 10.0, 160.0, 20.0, 20.0, 20.0, 40.0, 350.0, 40.0, 40.0, 80.0, 10.0, 20.0, 100.0, -40.0, 20.0, 160.0, 20.0, 40.0, 60.0, 10.0, -40.0, 30.0, 370.0, 290.0, -20.0, 20.0, 580.0, 10.0, 150.0, 300.0, -30.0, -50.0, -50.0, -40.0, -10.0, 20.0, 120.0, 190.0, 120.0, 310.0, 90.0, 20.0, 60.0, 180.0, 90.0, 120.0, 160.0, 270.0, 40.0, 80.0, 50.0, 60.0, 130.0, 70.0, 220.0, 240.0, 340.0, 40.0, 150.0, 0.0, 140.0, 55.0, 370.0, 20.0, 100.0, 400.0, 80.0, 10.0, 50.0, 130.0, 180.0, 50.0, 130.0, -35.0, 290.0, 110.0, 20.0, 40.0, 0.0, 40.0, 90.0, 300.0, 310.0, 60.0, 15.0, 30.0, 60.0, 30.0, 90.0, 100.0, 50.0, 80.0, 80.0, 60.0, 140.0, 480.0, 30.0, 20.0, 40.0, 85.0, 170.0, 150.0, 150.0, 170.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 15.0, 580.0, 50.0, 20.0, 150.0, 80.0, 90.0, 110.0, 250.0, 460.0, 190.0, 95.0, 100.0, 80.0, 30.0, 50.0, 100.0, 70.0, 40.0, 0.0, 50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5243405091197944, "mean_inference_ms": 1.4071459888831765, "mean_action_processing_ms": 0.4545634766435219, "mean_env_wait_ms": 1.242548216031759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012877702713012695, "StateBufferConnector_ms": 0.009348392486572266, "ViewRequirementAgentConnector_ms": 0.3823239803314209}, "num_episodes": 22, "episode_return_max": 1910.0, "episode_return_min": 100.0, "episode_return_mean": 995.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.557203678662912, "num_env_steps_trained_throughput_per_sec": 21.557203678662912, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 186584.601, "restore_workers_time_ms": 0.011, "training_step_time_ms": 186584.552, "sample_time_ms": 2624.855, "learn_time_ms": 183938.145, "learn_throughput": 21.746, "synch_weights_time_ms": 11.556}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "33e63_00000", "date": "2024-06-19_03-12-30", "timestamp": 1718781150, "time_this_iter_s": 185.56098294258118, "time_total_s": 21931.278519392014, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278e8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 21931.278519392014, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 16.649236641221375, "ram_util_percent": 79.96603053435113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6598775476756824, "cur_kl_coeff": 6.927618187665941, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003532978605912429, "vf_loss": 7.1340021757526015, "vf_explained_var": -0.0007283103224822381, "kl": Infinity, "entropy": 0.3696081209915895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": 100.0, "episode_reward_mean": 989.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 98.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1910.0, 945.0, 1650.0, 720.0, 950.0, 375.0, 1025.0, 710.0, 450.0, 440.0, 1505.0, 1730.0, 770.0, 250.0, 1040.0, 1320.0, 100.0, 1085.0, 520.0, 745.0, 1120.0, 750.0, 860.0, 1075.0, 300.0, 870.0, 1480.0, 560.0, 1020.0, 1390.0, 685.0, 1205.0, 1245.0, 425.0, 1380.0, 1010.0, 695.0, 620.0, 1570.0, 995.0, 1135.0, 820.0, 1740.0, 860.0, 620.0, 1600.0, 1470.0, 1145.0, 1620.0, 540.0, 620.0, 315.0, 700.0, 1260.0, 795.0, 240.0, 250.0, 1390.0, 1090.0, 830.0, 1090.0, 1120.0, 610.0, 1460.0, 950.0, 1350.0, 705.0, 570.0, 780.0, 780.0, 880.0, 1300.0, 1320.0, 1615.0, 995.0, 905.0, 1170.0, 855.0, 300.0, 1805.0, 755.0, 1650.0, 1195.0, 910.0, 620.0, 810.0, 1270.0, 1060.0, 1570.0, 650.0, 1270.0, 780.0, 1060.0, 820.0, 1480.0, 510.0, 1390.0, 950.0, 1765.0, 1375.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 220.0, -10.0, 490.0, 570.0, 30.0, 130.0, 260.0, 20.0, 30.0, 30.0, 70.0, 30.0, 70.0, 80.0, 210.0, 55.0, 170.0, 170.0, 60.0, 370.0, 170.0, 50.0, 90.0, 40.0, 600.0, 60.0, 10.0, 70.0, 190.0, 0.0, 80.0, 70.0, 20.0, 10.0, 20.0, 280.0, 40.0, 30.0, 170.0, 60.0, 120.0, 70.0, 130.0, 130.0, 300.0, 20.0, 20.0, 30.0, 70.0, 30.0, 35.0, 0.0, 30.0, 120.0, 30.0, 30.0, 40.0, 40.0, 20.0, 60.0, 60.0, 170.0, 30.0, 5.0, 60.0, 90.0, 70.0, 350.0, 130.0, 40.0, 140.0, 40.0, 130.0, 40.0, 40.0, 20.0, 10.0, 250.0, 0.0, 70.0, 10.0, 150.0, 30.0, -10.0, 30.0, 30.0, 90.0, 20.0, 30.0, 290.0, 10.0, 40.0, 60.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, -10.0, 110.0, 200.0, 115.0, 160.0, -30.0, 160.0, 550.0, 210.0, 100.0, 570.0, 170.0, 120.0, 60.0, 290.0, 80.0, 50.0, 130.0, 160.0, 170.0, 20.0, 220.0, 90.0, 90.0, 80.0, 0.0, 20.0, 40.0, 40.0, 0.0, 50.0, 40.0, 60.0, -30.0, 50.0, 0.0, 50.0, 0.0, 30.0, 10.0, 190.0, 120.0, 180.0, 80.0, 260.0, 10.0, 50.0, 100.0, 40.0, 20.0, 40.0, 120.0, 220.0, 100.0, 110.0, 40.0, 370.0, 230.0, 70.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 40.0, 0.0, -60.0, 140.0, 20.0, -5.0, 190.0, 160.0, 90.0, 230.0, 260.0, 60.0, 20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0, 190.0, 300.0, 20.0, 40.0, 60.0, 40.0, 160.0, -30.0, 15.0, -50.0, 10.0, 110.0, 60.0, 410.0, 10.0, 140.0, 20.0, 50.0, 30.0, 280.0, 50.0, 120.0, 70.0, 70.0, 40.0, 90.0, 70.0, 170.0, 0.0, 70.0, 10.0, 170.0, 180.0, 30.0, 20.0, 150.0, 30.0, 60.0, 30.0, 180.0, -55.0, 10.0, 340.0, 60.0, 300.0, 20.0, 70.0, 40.0, 30.0, 260.0, 30.0, 90.0, 20.0, 60.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 100.0, 50.0, 210.0, 70.0, 40.0, 170.0, 20.0, 10.0, 200.0, 0.0, 70.0, 110.0, 130.0, 90.0, 30.0, 220.0, 180.0, 50.0, 210.0, 390.0, 50.0, 40.0, 170.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 150.0, 0.0, 100.0, 200.0, 10.0, 230.0, 120.0, 120.0, 80.0, 120.0, 40.0, 40.0, -30.0, 100.0, 110.0, 450.0, 170.0, 310.0, 110.0, 20.0, 110.0, 10.0, 115.0, 160.0, 60.0, 40.0, 20.0, 20.0, 0.0, 80.0, 180.0, 50.0, 5.0, 130.0, 90.0, 0.0, 80.0, 110.0, 180.0, 170.0, 390.0, 90.0, 310.0, 80.0, 70.0, 300.0, 5.0, 110.0, 210.0, 40.0, 30.0, 0.0, 20.0, 60.0, 50.0, 220.0, 0.0, 25.0, 10.0, 30.0, 10.0, 50.0, 50.0, 240.0, 300.0, 280.0, 240.0, 190.0, 20.0, 10.0, 0.0, 530.0, 40.0, 30.0, 10.0, 90.0, 50.0, 30.0, 30.0, 120.0, 80.0, 20.0, 60.0, 30.0, 60.0, 15.0, 40.0, 20.0, 50.0, 160.0, 240.0, 40.0, 100.0, 40.0, 40.0, 80.0, 0.0, 160.0, 60.0, 60.0, 40.0, 30.0, 190.0, 10.0, 460.0, 30.0, 310.0, 290.0, 10.0, 120.0, 120.0, 65.0, 50.0, 40.0, 0.0, 70.0, 210.0, 30.0, 40.0, 10.0, 480.0, 120.0, 80.0, 60.0, 50.0, 320.0, 30.0, 60.0, 75.0, 210.0, 130.0, -35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0, 270.0, 200.0, 200.0, 190.0, 80.0, 30.0, 610.0, 70.0, 130.0, -40.0, 100.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 260.0, 250.0, 170.0, 80.0, 180.0, 0.0, 0.0, 40.0, 10.0, 60.0, 90.0, 120.0, 40.0, -5.0, 170.0, 60.0, -15.0, 420.0, 210.0, 40.0, 190.0, 450.0, 80.0, 60.0, 100.0, 340.0, 20.0, 110.0, 50.0, 330.0, 310.0, 80.0, 70.0, 100.0, 100.0, 20.0, 150.0, 420.0, 40.0, 50.0, 60.0, 15.0, 190.0, 400.0, 260.0, 250.0, 70.0, 40.0, 190.0, -10.0, 100.0, 220.0, 100.0, 310.0, 60.0, 120.0, 30.0, 0.0, 30.0, 10.0, -20.0, -10.0, 10.0, 50.0, 110.0, 120.0, 10.0, 10.0, 20.0, 30.0, 50.0, 20.0, 200.0, 50.0, 25.0, 50.0, -60.0, 20.0, 80.0, 20.0, 30.0, 40.0, 60.0, -40.0, -40.0, 90.0, 35.0, 20.0, 190.0, 0.0, 370.0, 20.0, 55.0, 350.0, 160.0, -20.0, 220.0, -40.0, 290.0, 60.0, 40.0, 40.0, 160.0, 50.0, 340.0, 170.0, 0.0, 60.0, 80.0, 0.0, 10.0, 45.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 30.0, 20.0, 20.0, 60.0, 10.0, 30.0, 10.0, 0.0, 320.0, 20.0, 220.0, 180.0, 100.0, 70.0, 90.0, 80.0, 110.0, 200.0, 20.0, 30.0, 160.0, 90.0, 50.0, 50.0, 210.0, 340.0, 110.0, 30.0, 50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0, 160.0, 120.0, 30.0, 80.0, 80.0, 80.0, 20.0, 80.0, 390.0, 50.0, 120.0, 60.0, 70.0, 40.0, 140.0, 0.0, 340.0, 180.0, 70.0, 100.0, 140.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, -20.0, 50.0, 300.0, 130.0, 100.0, 110.0, 80.0, 320.0, 280.0, 90.0, -20.0, -30.0, 400.0, 60.0, 110.0, 280.0, 40.0, 260.0, 70.0, -20.0, 30.0, 30.0, 90.0, 0.0, 20.0, 70.0, 140.0, 130.0, 90.0, 440.0, 110.0, 260.0, 90.0, -150.0, 40.0, 360.0, 40.0, 30.0, 35.0, 0.0, 300.0, 40.0, 10.0, 40.0, 90.0, 80.0, 90.0, 10.0, 160.0, 20.0, 20.0, 20.0, 40.0, 350.0, 40.0, 40.0, 80.0, 10.0, 20.0, 100.0, -40.0, 20.0, 160.0, 20.0, 40.0, 60.0, 10.0, -40.0, 30.0, 370.0, 290.0, -20.0, 20.0, 580.0, 10.0, 150.0, 300.0, -30.0, -50.0, -50.0, -40.0, -10.0, 20.0, 120.0, 190.0, 120.0, 310.0, 90.0, 20.0, 60.0, 180.0, 90.0, 120.0, 160.0, 270.0, 40.0, 80.0, 50.0, 60.0, 130.0, 70.0, 220.0, 240.0, 340.0, 40.0, 150.0, 0.0, 140.0, 55.0, 370.0, 20.0, 100.0, 400.0, 80.0, 10.0, 50.0, 130.0, 180.0, 50.0, 130.0, -35.0, 290.0, 110.0, 20.0, 40.0, 0.0, 40.0, 90.0, 300.0, 310.0, 60.0, 15.0, 30.0, 60.0, 30.0, 90.0, 100.0, 50.0, 80.0, 80.0, 60.0, 140.0, 480.0, 30.0, 20.0, 40.0, 85.0, 170.0, 150.0, 150.0, 170.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 15.0, 580.0, 50.0, 20.0, 150.0, 80.0, 90.0, 110.0, 250.0, 460.0, 190.0, 95.0, 100.0, 80.0, 30.0, 50.0, 100.0, 70.0, 40.0, 0.0, 50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0, 40.0, 70.0, 30.0, 330.0, 180.0, 100.0, 0.0, 290.0, 5.0, 150.0, 130.0, 90.0, 40.0, 90.0, 40.0, 300.0, 20.0, 60.0, 80.0, 60.0, 120.0, 30.0, 140.0, 0.0, 0.0, 70.0, 20.0, 180.0, 40.0, 20.0, -50.0, 120.0, 50.0, 170.0, 230.0, -10.0, 160.0, 30.0, 30.0, 80.0, 40.0, 10.0, 370.0, 280.0, 80.0, 90.0, 210.0, 40.0, 150.0, 0.0, 210.0, 60.0, 170.0, 50.0, 50.0, 340.0, 70.0, 20.0, 60.0, 30.0, 60.0, 320.0, 210.0, 270.0, 80.0, 140.0, 90.0, 50.0, 70.0, 280.0, 50.0, 100.0, 180.0, 90.0, 80.0, 30.0, 20.0, 20.0, 30.0, 50.0, 90.0, 10.0, 20.0, 690.0, 150.0, 0.0, 10.0, -60.0, 40.0, 320.0, 130.0, 30.0, 130.0, 50.0, 40.0, 10.0, 180.0, 120.0, 50.0, 40.0, 280.0, 70.0, 120.0, 110.0, 20.0, 0.0, 80.0, 180.0, 110.0, 90.0, 30.0, 0.0, 30.0, 70.0, 0.0, 60.0, 40.0, 10.0, 100.0, 480.0, 40.0, 80.0, 90.0, 380.0, 70.0, 340.0, 90.0, 110.0, 130.0, 150.0, 170.0, 20.0, 50.0, 80.0, 70.0, 0.0, 75.0, 15.0, 30.0, 0.0, 290.0, 100.0, 50.0, 0.0, 240.0, 140.0, 60.0, 100.0, 280.0, 130.0, 110.0, 50.0, 120.0, 200.0, 60.0, 100.0, 40.0, 120.0, 30.0, 120.0, 550.0, 170.0, 170.0, 320.0, 60.0, 45.0, 120.0, 110.0, 160.0, 60.0, 340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5246831861274603, "mean_inference_ms": 1.408089129921036, "mean_action_processing_ms": 0.4574436477306058, "mean_env_wait_ms": 1.242593561014454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012295722961425781, "StateBufferConnector_ms": 0.009147882461547852, "ViewRequirementAgentConnector_ms": 0.37692952156066895}, "num_episodes": 18, "episode_return_max": 1910.0, "episode_return_min": 100.0, "episode_return_mean": 989.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.55536591994262, "num_env_steps_trained_throughput_per_sec": 21.55536591994262, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 186643.378, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186643.328, "sample_time_ms": 2621.886, "learn_time_ms": 184000.049, "learn_throughput": 21.739, "synch_weights_time_ms": 11.503}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "33e63_00000", "date": "2024-06-19_03-15-35", "timestamp": 1718781335, "time_this_iter_s": 185.5893440246582, "time_total_s": 22116.86786341667, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277c4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22116.86786341667, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 16.418631178707223, "ram_util_percent": 79.34904942965781}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0235229623838227, "cur_kl_coeff": 10.39142728149891, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.570224746982383, "policy_loss": -0.0033302452576399262, "vf_loss": 7.570626669874588, "vf_explained_var": -0.00010690035276646558, "kl": 0.0002818014597340606, "entropy": 0.34657767227155584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1805.0, "episode_reward_min": 240.0, "episode_reward_mean": 1011.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 101.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 745.0, 1120.0, 750.0, 860.0, 1075.0, 300.0, 870.0, 1480.0, 560.0, 1020.0, 1390.0, 685.0, 1205.0, 1245.0, 425.0, 1380.0, 1010.0, 695.0, 620.0, 1570.0, 995.0, 1135.0, 820.0, 1740.0, 860.0, 620.0, 1600.0, 1470.0, 1145.0, 1620.0, 540.0, 620.0, 315.0, 700.0, 1260.0, 795.0, 240.0, 250.0, 1390.0, 1090.0, 830.0, 1090.0, 1120.0, 610.0, 1460.0, 950.0, 1350.0, 705.0, 570.0, 780.0, 780.0, 880.0, 1300.0, 1320.0, 1615.0, 995.0, 905.0, 1170.0, 855.0, 300.0, 1805.0, 755.0, 1650.0, 1195.0, 910.0, 620.0, 810.0, 1270.0, 1060.0, 1570.0, 650.0, 1270.0, 780.0, 1060.0, 820.0, 1480.0, 510.0, 1390.0, 950.0, 1765.0, 1375.0, 1480.0, 340.0, 1090.0, 360.0, 1030.0, 910.0, 980.0, 1250.0, 990.0, 920.0, 885.0, 1140.0, 1260.0, 1760.0, 1415.0, 840.0, 930.0, 1510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 130.0, 0.0, 40.0, 20.0, -10.0, 90.0, 40.0, 190.0, 0.0, 190.0, 300.0, 20.0, 40.0, 60.0, 40.0, 160.0, -30.0, 15.0, -50.0, 10.0, 110.0, 60.0, 410.0, 10.0, 140.0, 20.0, 50.0, 30.0, 280.0, 50.0, 120.0, 70.0, 70.0, 40.0, 90.0, 70.0, 170.0, 0.0, 70.0, 10.0, 170.0, 180.0, 30.0, 20.0, 150.0, 30.0, 60.0, 30.0, 180.0, -55.0, 10.0, 340.0, 60.0, 300.0, 20.0, 70.0, 40.0, 30.0, 260.0, 30.0, 90.0, 20.0, 60.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 100.0, 50.0, 210.0, 70.0, 40.0, 170.0, 20.0, 10.0, 200.0, 0.0, 70.0, 110.0, 130.0, 90.0, 30.0, 220.0, 180.0, 50.0, 210.0, 390.0, 50.0, 40.0, 170.0, 20.0, 20.0, 40.0, 20.0, 20.0, 30.0, 150.0, 0.0, 100.0, 200.0, 10.0, 230.0, 120.0, 120.0, 80.0, 120.0, 40.0, 40.0, -30.0, 100.0, 110.0, 450.0, 170.0, 310.0, 110.0, 20.0, 110.0, 10.0, 115.0, 160.0, 60.0, 40.0, 20.0, 20.0, 0.0, 80.0, 180.0, 50.0, 5.0, 130.0, 90.0, 0.0, 80.0, 110.0, 180.0, 170.0, 390.0, 90.0, 310.0, 80.0, 70.0, 300.0, 5.0, 110.0, 210.0, 40.0, 30.0, 0.0, 20.0, 60.0, 50.0, 220.0, 0.0, 25.0, 10.0, 30.0, 10.0, 50.0, 50.0, 240.0, 300.0, 280.0, 240.0, 190.0, 20.0, 10.0, 0.0, 530.0, 40.0, 30.0, 10.0, 90.0, 50.0, 30.0, 30.0, 120.0, 80.0, 20.0, 60.0, 30.0, 60.0, 15.0, 40.0, 20.0, 50.0, 160.0, 240.0, 40.0, 100.0, 40.0, 40.0, 80.0, 0.0, 160.0, 60.0, 60.0, 40.0, 30.0, 190.0, 10.0, 460.0, 30.0, 310.0, 290.0, 10.0, 120.0, 120.0, 65.0, 50.0, 40.0, 0.0, 70.0, 210.0, 30.0, 40.0, 10.0, 480.0, 120.0, 80.0, 60.0, 50.0, 320.0, 30.0, 60.0, 75.0, 210.0, 130.0, -35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0, 270.0, 200.0, 200.0, 190.0, 80.0, 30.0, 610.0, 70.0, 130.0, -40.0, 100.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 260.0, 250.0, 170.0, 80.0, 180.0, 0.0, 0.0, 40.0, 10.0, 60.0, 90.0, 120.0, 40.0, -5.0, 170.0, 60.0, -15.0, 420.0, 210.0, 40.0, 190.0, 450.0, 80.0, 60.0, 100.0, 340.0, 20.0, 110.0, 50.0, 330.0, 310.0, 80.0, 70.0, 100.0, 100.0, 20.0, 150.0, 420.0, 40.0, 50.0, 60.0, 15.0, 190.0, 400.0, 260.0, 250.0, 70.0, 40.0, 190.0, -10.0, 100.0, 220.0, 100.0, 310.0, 60.0, 120.0, 30.0, 0.0, 30.0, 10.0, -20.0, -10.0, 10.0, 50.0, 110.0, 120.0, 10.0, 10.0, 20.0, 30.0, 50.0, 20.0, 200.0, 50.0, 25.0, 50.0, -60.0, 20.0, 80.0, 20.0, 30.0, 40.0, 60.0, -40.0, -40.0, 90.0, 35.0, 20.0, 190.0, 0.0, 370.0, 20.0, 55.0, 350.0, 160.0, -20.0, 220.0, -40.0, 290.0, 60.0, 40.0, 40.0, 160.0, 50.0, 340.0, 170.0, 0.0, 60.0, 80.0, 0.0, 10.0, 45.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 30.0, 20.0, 20.0, 60.0, 10.0, 30.0, 10.0, 0.0, 320.0, 20.0, 220.0, 180.0, 100.0, 70.0, 90.0, 80.0, 110.0, 200.0, 20.0, 30.0, 160.0, 90.0, 50.0, 50.0, 210.0, 340.0, 110.0, 30.0, 50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0, 160.0, 120.0, 30.0, 80.0, 80.0, 80.0, 20.0, 80.0, 390.0, 50.0, 120.0, 60.0, 70.0, 40.0, 140.0, 0.0, 340.0, 180.0, 70.0, 100.0, 140.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, -20.0, 50.0, 300.0, 130.0, 100.0, 110.0, 80.0, 320.0, 280.0, 90.0, -20.0, -30.0, 400.0, 60.0, 110.0, 280.0, 40.0, 260.0, 70.0, -20.0, 30.0, 30.0, 90.0, 0.0, 20.0, 70.0, 140.0, 130.0, 90.0, 440.0, 110.0, 260.0, 90.0, -150.0, 40.0, 360.0, 40.0, 30.0, 35.0, 0.0, 300.0, 40.0, 10.0, 40.0, 90.0, 80.0, 90.0, 10.0, 160.0, 20.0, 20.0, 20.0, 40.0, 350.0, 40.0, 40.0, 80.0, 10.0, 20.0, 100.0, -40.0, 20.0, 160.0, 20.0, 40.0, 60.0, 10.0, -40.0, 30.0, 370.0, 290.0, -20.0, 20.0, 580.0, 10.0, 150.0, 300.0, -30.0, -50.0, -50.0, -40.0, -10.0, 20.0, 120.0, 190.0, 120.0, 310.0, 90.0, 20.0, 60.0, 180.0, 90.0, 120.0, 160.0, 270.0, 40.0, 80.0, 50.0, 60.0, 130.0, 70.0, 220.0, 240.0, 340.0, 40.0, 150.0, 0.0, 140.0, 55.0, 370.0, 20.0, 100.0, 400.0, 80.0, 10.0, 50.0, 130.0, 180.0, 50.0, 130.0, -35.0, 290.0, 110.0, 20.0, 40.0, 0.0, 40.0, 90.0, 300.0, 310.0, 60.0, 15.0, 30.0, 60.0, 30.0, 90.0, 100.0, 50.0, 80.0, 80.0, 60.0, 140.0, 480.0, 30.0, 20.0, 40.0, 85.0, 170.0, 150.0, 150.0, 170.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 15.0, 580.0, 50.0, 20.0, 150.0, 80.0, 90.0, 110.0, 250.0, 460.0, 190.0, 95.0, 100.0, 80.0, 30.0, 50.0, 100.0, 70.0, 40.0, 0.0, 50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0, 40.0, 70.0, 30.0, 330.0, 180.0, 100.0, 0.0, 290.0, 5.0, 150.0, 130.0, 90.0, 40.0, 90.0, 40.0, 300.0, 20.0, 60.0, 80.0, 60.0, 120.0, 30.0, 140.0, 0.0, 0.0, 70.0, 20.0, 180.0, 40.0, 20.0, -50.0, 120.0, 50.0, 170.0, 230.0, -10.0, 160.0, 30.0, 30.0, 80.0, 40.0, 10.0, 370.0, 280.0, 80.0, 90.0, 210.0, 40.0, 150.0, 0.0, 210.0, 60.0, 170.0, 50.0, 50.0, 340.0, 70.0, 20.0, 60.0, 30.0, 60.0, 320.0, 210.0, 270.0, 80.0, 140.0, 90.0, 50.0, 70.0, 280.0, 50.0, 100.0, 180.0, 90.0, 80.0, 30.0, 20.0, 20.0, 30.0, 50.0, 90.0, 10.0, 20.0, 690.0, 150.0, 0.0, 10.0, -60.0, 40.0, 320.0, 130.0, 30.0, 130.0, 50.0, 40.0, 10.0, 180.0, 120.0, 50.0, 40.0, 280.0, 70.0, 120.0, 110.0, 20.0, 0.0, 80.0, 180.0, 110.0, 90.0, 30.0, 0.0, 30.0, 70.0, 0.0, 60.0, 40.0, 10.0, 100.0, 480.0, 40.0, 80.0, 90.0, 380.0, 70.0, 340.0, 90.0, 110.0, 130.0, 150.0, 170.0, 20.0, 50.0, 80.0, 70.0, 0.0, 75.0, 15.0, 30.0, 0.0, 290.0, 100.0, 50.0, 0.0, 240.0, 140.0, 60.0, 100.0, 280.0, 130.0, 110.0, 50.0, 120.0, 200.0, 60.0, 100.0, 40.0, 120.0, 30.0, 120.0, 550.0, 170.0, 170.0, 320.0, 60.0, 45.0, 120.0, 110.0, 160.0, 60.0, 340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0, 40.0, 180.0, 350.0, 50.0, 70.0, 110.0, 80.0, 460.0, 120.0, 20.0, 40.0, 30.0, 0.0, 30.0, 20.0, 70.0, 60.0, 20.0, 40.0, 30.0, 110.0, 50.0, 300.0, 40.0, 180.0, 120.0, 110.0, 30.0, 180.0, -30.0, 20.0, 80.0, 20.0, 20.0, 50.0, 20.0, -40.0, 160.0, 10.0, 20.0, 60.0, 30.0, 130.0, 60.0, 280.0, 0.0, 290.0, 70.0, 40.0, 70.0, 0.0, 40.0, 160.0, 20.0, 90.0, 170.0, 80.0, 60.0, 40.0, 250.0, 60.0, 320.0, 40.0, 200.0, 10.0, 90.0, 260.0, 70.0, 80.0, -150.0, 100.0, 90.0, 180.0, 340.0, 40.0, 50.0, 170.0, 40.0, 70.0, 170.0, 50.0, 40.0, 120.0, 60.0, 50.0, 150.0, 300.0, 50.0, 200.0, -30.0, 110.0, 130.0, 80.0, 10.0, 120.0, 20.0, 40.0, 130.0, -70.0, 350.0, 130.0, 0.0, -5.0, 80.0, 70.0, 270.0, 100.0, -10.0, 210.0, 40.0, 110.0, 150.0, 80.0, 130.0, 230.0, 30.0, 170.0, 130.0, 30.0, 80.0, 90.0, 270.0, 350.0, 40.0, 60.0, 120.0, 150.0, 70.0, 80.0, 30.0, 20.0, 100.0, 200.0, 220.0, 580.0, 190.0, 80.0, 130.0, 140.0, 100.0, 100.0, 330.0, 330.0, 20.0, 20.0, 50.0, 55.0, 130.0, 340.0, 40.0, 10.0, 10.0, 70.0, 70.0, 10.0, 50.0, 80.0, 100.0, 140.0, 300.0, 0.0, 130.0, 60.0, 50.0, 330.0, 10.0, 40.0, 50.0, 160.0, 100.0, 150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5249027181776427, "mean_inference_ms": 1.4092154572890936, "mean_action_processing_ms": 0.46084883656343734, "mean_env_wait_ms": 1.2432879379216824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01253199577331543, "StateBufferConnector_ms": 0.009426116943359375, "ViewRequirementAgentConnector_ms": 0.3900892734527588}, "num_episodes": 18, "episode_return_max": 1805.0, "episode_return_min": 240.0, "episode_return_mean": 1011.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.47695192883818, "num_env_steps_trained_throughput_per_sec": 21.47695192883818, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 186612.268, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186612.217, "sample_time_ms": 2723.417, "learn_time_ms": 183867.55, "learn_throughput": 21.755, "synch_weights_time_ms": 11.486}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "33e63_00000", "date": "2024-06-19_03-18-41", "timestamp": 1718781521, "time_this_iter_s": 186.29254794120789, "time_total_s": 22303.16041135788, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277c4af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22303.16041135788, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 16.67338403041825, "ram_util_percent": 79.6235741444867}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0875771049239513, "cur_kl_coeff": 5.195713640749455, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.468716846258876, "policy_loss": -0.005075995454190773, "vf_loss": 7.470579417851279, "vf_explained_var": 0.001838676147440625, "kl": 0.0006184755798503476, "entropy": 0.35768723518640216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1805.0, "episode_reward_min": 240.0, "episode_reward_mean": 1041.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 104.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [820.0, 1740.0, 860.0, 620.0, 1600.0, 1470.0, 1145.0, 1620.0, 540.0, 620.0, 315.0, 700.0, 1260.0, 795.0, 240.0, 250.0, 1390.0, 1090.0, 830.0, 1090.0, 1120.0, 610.0, 1460.0, 950.0, 1350.0, 705.0, 570.0, 780.0, 780.0, 880.0, 1300.0, 1320.0, 1615.0, 995.0, 905.0, 1170.0, 855.0, 300.0, 1805.0, 755.0, 1650.0, 1195.0, 910.0, 620.0, 810.0, 1270.0, 1060.0, 1570.0, 650.0, 1270.0, 780.0, 1060.0, 820.0, 1480.0, 510.0, 1390.0, 950.0, 1765.0, 1375.0, 1480.0, 340.0, 1090.0, 360.0, 1030.0, 910.0, 980.0, 1250.0, 990.0, 920.0, 885.0, 1140.0, 1260.0, 1760.0, 1415.0, 840.0, 930.0, 1510.0, 750.0, 910.0, 1410.0, 1265.0, 1455.0, 1245.0, 670.0, 585.0, 1530.0, 920.0, 1170.0, 820.0, 1140.0, 800.0, 1410.0, 810.0, 670.0, 1260.0, 800.0, 1450.0, 1290.0, 1560.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-35.0, 50.0, 100.0, 340.0, 100.0, -110.0, 15.0, 0.0, 40.0, 320.0, 270.0, 200.0, 200.0, 190.0, 80.0, 30.0, 610.0, 70.0, 130.0, -40.0, 100.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 260.0, 250.0, 170.0, 80.0, 180.0, 0.0, 0.0, 40.0, 10.0, 60.0, 90.0, 120.0, 40.0, -5.0, 170.0, 60.0, -15.0, 420.0, 210.0, 40.0, 190.0, 450.0, 80.0, 60.0, 100.0, 340.0, 20.0, 110.0, 50.0, 330.0, 310.0, 80.0, 70.0, 100.0, 100.0, 20.0, 150.0, 420.0, 40.0, 50.0, 60.0, 15.0, 190.0, 400.0, 260.0, 250.0, 70.0, 40.0, 190.0, -10.0, 100.0, 220.0, 100.0, 310.0, 60.0, 120.0, 30.0, 0.0, 30.0, 10.0, -20.0, -10.0, 10.0, 50.0, 110.0, 120.0, 10.0, 10.0, 20.0, 30.0, 50.0, 20.0, 200.0, 50.0, 25.0, 50.0, -60.0, 20.0, 80.0, 20.0, 30.0, 40.0, 60.0, -40.0, -40.0, 90.0, 35.0, 20.0, 190.0, 0.0, 370.0, 20.0, 55.0, 350.0, 160.0, -20.0, 220.0, -40.0, 290.0, 60.0, 40.0, 40.0, 160.0, 50.0, 340.0, 170.0, 0.0, 60.0, 80.0, 0.0, 10.0, 45.0, 40.0, 0.0, 40.0, 30.0, 40.0, 30.0, 10.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 30.0, 20.0, 20.0, 60.0, 10.0, 30.0, 10.0, 0.0, 320.0, 20.0, 220.0, 180.0, 100.0, 70.0, 90.0, 80.0, 110.0, 200.0, 20.0, 30.0, 160.0, 90.0, 50.0, 50.0, 210.0, 340.0, 110.0, 30.0, 50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0, 160.0, 120.0, 30.0, 80.0, 80.0, 80.0, 20.0, 80.0, 390.0, 50.0, 120.0, 60.0, 70.0, 40.0, 140.0, 0.0, 340.0, 180.0, 70.0, 100.0, 140.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, -20.0, 50.0, 300.0, 130.0, 100.0, 110.0, 80.0, 320.0, 280.0, 90.0, -20.0, -30.0, 400.0, 60.0, 110.0, 280.0, 40.0, 260.0, 70.0, -20.0, 30.0, 30.0, 90.0, 0.0, 20.0, 70.0, 140.0, 130.0, 90.0, 440.0, 110.0, 260.0, 90.0, -150.0, 40.0, 360.0, 40.0, 30.0, 35.0, 0.0, 300.0, 40.0, 10.0, 40.0, 90.0, 80.0, 90.0, 10.0, 160.0, 20.0, 20.0, 20.0, 40.0, 350.0, 40.0, 40.0, 80.0, 10.0, 20.0, 100.0, -40.0, 20.0, 160.0, 20.0, 40.0, 60.0, 10.0, -40.0, 30.0, 370.0, 290.0, -20.0, 20.0, 580.0, 10.0, 150.0, 300.0, -30.0, -50.0, -50.0, -40.0, -10.0, 20.0, 120.0, 190.0, 120.0, 310.0, 90.0, 20.0, 60.0, 180.0, 90.0, 120.0, 160.0, 270.0, 40.0, 80.0, 50.0, 60.0, 130.0, 70.0, 220.0, 240.0, 340.0, 40.0, 150.0, 0.0, 140.0, 55.0, 370.0, 20.0, 100.0, 400.0, 80.0, 10.0, 50.0, 130.0, 180.0, 50.0, 130.0, -35.0, 290.0, 110.0, 20.0, 40.0, 0.0, 40.0, 90.0, 300.0, 310.0, 60.0, 15.0, 30.0, 60.0, 30.0, 90.0, 100.0, 50.0, 80.0, 80.0, 60.0, 140.0, 480.0, 30.0, 20.0, 40.0, 85.0, 170.0, 150.0, 150.0, 170.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 15.0, 580.0, 50.0, 20.0, 150.0, 80.0, 90.0, 110.0, 250.0, 460.0, 190.0, 95.0, 100.0, 80.0, 30.0, 50.0, 100.0, 70.0, 40.0, 0.0, 50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0, 40.0, 70.0, 30.0, 330.0, 180.0, 100.0, 0.0, 290.0, 5.0, 150.0, 130.0, 90.0, 40.0, 90.0, 40.0, 300.0, 20.0, 60.0, 80.0, 60.0, 120.0, 30.0, 140.0, 0.0, 0.0, 70.0, 20.0, 180.0, 40.0, 20.0, -50.0, 120.0, 50.0, 170.0, 230.0, -10.0, 160.0, 30.0, 30.0, 80.0, 40.0, 10.0, 370.0, 280.0, 80.0, 90.0, 210.0, 40.0, 150.0, 0.0, 210.0, 60.0, 170.0, 50.0, 50.0, 340.0, 70.0, 20.0, 60.0, 30.0, 60.0, 320.0, 210.0, 270.0, 80.0, 140.0, 90.0, 50.0, 70.0, 280.0, 50.0, 100.0, 180.0, 90.0, 80.0, 30.0, 20.0, 20.0, 30.0, 50.0, 90.0, 10.0, 20.0, 690.0, 150.0, 0.0, 10.0, -60.0, 40.0, 320.0, 130.0, 30.0, 130.0, 50.0, 40.0, 10.0, 180.0, 120.0, 50.0, 40.0, 280.0, 70.0, 120.0, 110.0, 20.0, 0.0, 80.0, 180.0, 110.0, 90.0, 30.0, 0.0, 30.0, 70.0, 0.0, 60.0, 40.0, 10.0, 100.0, 480.0, 40.0, 80.0, 90.0, 380.0, 70.0, 340.0, 90.0, 110.0, 130.0, 150.0, 170.0, 20.0, 50.0, 80.0, 70.0, 0.0, 75.0, 15.0, 30.0, 0.0, 290.0, 100.0, 50.0, 0.0, 240.0, 140.0, 60.0, 100.0, 280.0, 130.0, 110.0, 50.0, 120.0, 200.0, 60.0, 100.0, 40.0, 120.0, 30.0, 120.0, 550.0, 170.0, 170.0, 320.0, 60.0, 45.0, 120.0, 110.0, 160.0, 60.0, 340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0, 40.0, 180.0, 350.0, 50.0, 70.0, 110.0, 80.0, 460.0, 120.0, 20.0, 40.0, 30.0, 0.0, 30.0, 20.0, 70.0, 60.0, 20.0, 40.0, 30.0, 110.0, 50.0, 300.0, 40.0, 180.0, 120.0, 110.0, 30.0, 180.0, -30.0, 20.0, 80.0, 20.0, 20.0, 50.0, 20.0, -40.0, 160.0, 10.0, 20.0, 60.0, 30.0, 130.0, 60.0, 280.0, 0.0, 290.0, 70.0, 40.0, 70.0, 0.0, 40.0, 160.0, 20.0, 90.0, 170.0, 80.0, 60.0, 40.0, 250.0, 60.0, 320.0, 40.0, 200.0, 10.0, 90.0, 260.0, 70.0, 80.0, -150.0, 100.0, 90.0, 180.0, 340.0, 40.0, 50.0, 170.0, 40.0, 70.0, 170.0, 50.0, 40.0, 120.0, 60.0, 50.0, 150.0, 300.0, 50.0, 200.0, -30.0, 110.0, 130.0, 80.0, 10.0, 120.0, 20.0, 40.0, 130.0, -70.0, 350.0, 130.0, 0.0, -5.0, 80.0, 70.0, 270.0, 100.0, -10.0, 210.0, 40.0, 110.0, 150.0, 80.0, 130.0, 230.0, 30.0, 170.0, 130.0, 30.0, 80.0, 90.0, 270.0, 350.0, 40.0, 60.0, 120.0, 150.0, 70.0, 80.0, 30.0, 20.0, 100.0, 200.0, 220.0, 580.0, 190.0, 80.0, 130.0, 140.0, 100.0, 100.0, 330.0, 330.0, 20.0, 20.0, 50.0, 55.0, 130.0, 340.0, 40.0, 10.0, 10.0, 70.0, 70.0, 10.0, 50.0, 80.0, 100.0, 140.0, 300.0, 0.0, 130.0, 60.0, 50.0, 330.0, 10.0, 40.0, 50.0, 160.0, 100.0, 150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0, 200.0, 230.0, 50.0, 80.0, 30.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 350.0, -20.0, 15.0, 170.0, 10.0, 170.0, 40.0, 5.0, 80.0, 220.0, 220.0, 0.0, 160.0, 100.0, 310.0, 110.0, 200.0, 40.0, 50.0, 170.0, 50.0, 45.0, 20.0, 60.0, 90.0, 40.0, 410.0, 180.0, 200.0, 210.0, 125.0, 10.0, 350.0, 170.0, 350.0, 60.0, 10.0, 90.0, 80.0, 50.0, 440.0, 320.0, 260.0, 100.0, 105.0, 60.0, 40.0, 40.0, -170.0, 40.0, 40.0, 200.0, 100.0, 20.0, 150.0, 0.0, 0.0, 70.0, 50.0, 15.0, 0.0, 30.0, 0.0, 60.0, 50.0, 30.0, 0.0, 360.0, 40.0, 80.0, 70.0, 40.0, 210.0, 190.0, 90.0, 140.0, 390.0, 110.0, 210.0, 110.0, 10.0, 150.0, 80.0, 200.0, 150.0, 110.0, 40.0, 40.0, 30.0, 10.0, 80.0, 80.0, 130.0, 60.0, 180.0, 80.0, 300.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 20.0, 140.0, 110.0, 30.0, 0.0, 390.0, 280.0, 70.0, 190.0, 30.0, 200.0, 30.0, 180.0, -60.0, 180.0, 40.0, -20.0, 310.0, 60.0, 100.0, 60.0, 100.0, 60.0, 40.0, 0.0, 90.0, 220.0, 60.0, 20.0, 90.0, 190.0, 50.0, 160.0, 200.0, 210.0, 210.0, 40.0, 40.0, 40.0, 40.0, 50.0, 20.0, 440.0, 40.0, 10.0, 90.0, 50.0, 40.0, 110.0, 10.0, 30.0, 20.0, 130.0, 150.0, 70.0, 60.0, 170.0, 230.0, 0.0, 130.0, 150.0, 50.0, 40.0, 210.0, 50.0, 230.0, 40.0, 50.0, 220.0, 40.0, 60.0, 140.0, 160.0, 20.0, 30.0, 40.0, 330.0, 50.0, 50.0, 210.0, 160.0, 220.0, 160.0, 190.0, 30.0, 50.0, 90.0, 60.0, 270.0, 30.0, 50.0, 30.0, 280.0, 50.0, 130.0, 300.0, 100.0, 150.0, 340.0, 40.0, 90.0, 150.0, 420.0, 200.0, 0.0, 70.0, 30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5254408911892292, "mean_inference_ms": 1.4108722305640293, "mean_action_processing_ms": 0.462817185707248, "mean_env_wait_ms": 1.2442460131136683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012462615966796875, "StateBufferConnector_ms": 0.009337425231933594, "ViewRequirementAgentConnector_ms": 0.39551544189453125}, "num_episodes": 23, "episode_return_max": 1805.0, "episode_return_min": 240.0, "episode_return_mean": 1041.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.53913467750285, "num_env_steps_trained_throughput_per_sec": 21.53913467750285, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 186634.585, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186634.533, "sample_time_ms": 2721.111, "learn_time_ms": 183891.712, "learn_throughput": 21.752, "synch_weights_time_ms": 11.431}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "33e63_00000", "date": "2024-06-19_03-21-47", "timestamp": 1718781707, "time_this_iter_s": 185.7192099094391, "time_total_s": 22488.87962126732, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277c44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22488.87962126732, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 17.265779467680606, "ram_util_percent": 80.16844106463878}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.037119855953101, "cur_kl_coeff": 2.5978568203747274, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005423048432917394, "vf_loss": 7.358806673685709, "vf_explained_var": 0.0001344120730988134, "kl": Infinity, "entropy": 0.3573891252945787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1805.0, "episode_reward_min": 300.0, "episode_reward_mean": 1066.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 690.0}, "policy_reward_mean": {"policy_0": 106.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.0, 1090.0, 1120.0, 610.0, 1460.0, 950.0, 1350.0, 705.0, 570.0, 780.0, 780.0, 880.0, 1300.0, 1320.0, 1615.0, 995.0, 905.0, 1170.0, 855.0, 300.0, 1805.0, 755.0, 1650.0, 1195.0, 910.0, 620.0, 810.0, 1270.0, 1060.0, 1570.0, 650.0, 1270.0, 780.0, 1060.0, 820.0, 1480.0, 510.0, 1390.0, 950.0, 1765.0, 1375.0, 1480.0, 340.0, 1090.0, 360.0, 1030.0, 910.0, 980.0, 1250.0, 990.0, 920.0, 885.0, 1140.0, 1260.0, 1760.0, 1415.0, 840.0, 930.0, 1510.0, 750.0, 910.0, 1410.0, 1265.0, 1455.0, 1245.0, 670.0, 585.0, 1530.0, 920.0, 1170.0, 820.0, 1140.0, 800.0, 1410.0, 810.0, 670.0, 1260.0, 800.0, 1450.0, 1290.0, 1560.0, 770.0, 1220.0, 940.0, 1320.0, 1195.0, 1300.0, 1070.0, 1740.0, 880.0, 980.0, 1060.0, 1450.0, 1660.0, 1200.0, 560.0, 325.0, 1340.0, 300.0, 1080.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 70.0, 20.0, 120.0, 10.0, 90.0, 230.0, 0.0, 100.0, 140.0, 160.0, 120.0, 30.0, 80.0, 80.0, 80.0, 20.0, 80.0, 390.0, 50.0, 120.0, 60.0, 70.0, 40.0, 140.0, 0.0, 340.0, 180.0, 70.0, 100.0, 140.0, 0.0, 40.0, 40.0, 0.0, 30.0, 30.0, -20.0, 50.0, 300.0, 130.0, 100.0, 110.0, 80.0, 320.0, 280.0, 90.0, -20.0, -30.0, 400.0, 60.0, 110.0, 280.0, 40.0, 260.0, 70.0, -20.0, 30.0, 30.0, 90.0, 0.0, 20.0, 70.0, 140.0, 130.0, 90.0, 440.0, 110.0, 260.0, 90.0, -150.0, 40.0, 360.0, 40.0, 30.0, 35.0, 0.0, 300.0, 40.0, 10.0, 40.0, 90.0, 80.0, 90.0, 10.0, 160.0, 20.0, 20.0, 20.0, 40.0, 350.0, 40.0, 40.0, 80.0, 10.0, 20.0, 100.0, -40.0, 20.0, 160.0, 20.0, 40.0, 60.0, 10.0, -40.0, 30.0, 370.0, 290.0, -20.0, 20.0, 580.0, 10.0, 150.0, 300.0, -30.0, -50.0, -50.0, -40.0, -10.0, 20.0, 120.0, 190.0, 120.0, 310.0, 90.0, 20.0, 60.0, 180.0, 90.0, 120.0, 160.0, 270.0, 40.0, 80.0, 50.0, 60.0, 130.0, 70.0, 220.0, 240.0, 340.0, 40.0, 150.0, 0.0, 140.0, 55.0, 370.0, 20.0, 100.0, 400.0, 80.0, 10.0, 50.0, 130.0, 180.0, 50.0, 130.0, -35.0, 290.0, 110.0, 20.0, 40.0, 0.0, 40.0, 90.0, 300.0, 310.0, 60.0, 15.0, 30.0, 60.0, 30.0, 90.0, 100.0, 50.0, 80.0, 80.0, 60.0, 140.0, 480.0, 30.0, 20.0, 40.0, 85.0, 170.0, 150.0, 150.0, 170.0, 20.0, 20.0, 60.0, 80.0, 60.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 40.0, 15.0, 580.0, 50.0, 20.0, 150.0, 80.0, 90.0, 110.0, 250.0, 460.0, 190.0, 95.0, 100.0, 80.0, 30.0, 50.0, 100.0, 70.0, 40.0, 0.0, 50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0, 40.0, 70.0, 30.0, 330.0, 180.0, 100.0, 0.0, 290.0, 5.0, 150.0, 130.0, 90.0, 40.0, 90.0, 40.0, 300.0, 20.0, 60.0, 80.0, 60.0, 120.0, 30.0, 140.0, 0.0, 0.0, 70.0, 20.0, 180.0, 40.0, 20.0, -50.0, 120.0, 50.0, 170.0, 230.0, -10.0, 160.0, 30.0, 30.0, 80.0, 40.0, 10.0, 370.0, 280.0, 80.0, 90.0, 210.0, 40.0, 150.0, 0.0, 210.0, 60.0, 170.0, 50.0, 50.0, 340.0, 70.0, 20.0, 60.0, 30.0, 60.0, 320.0, 210.0, 270.0, 80.0, 140.0, 90.0, 50.0, 70.0, 280.0, 50.0, 100.0, 180.0, 90.0, 80.0, 30.0, 20.0, 20.0, 30.0, 50.0, 90.0, 10.0, 20.0, 690.0, 150.0, 0.0, 10.0, -60.0, 40.0, 320.0, 130.0, 30.0, 130.0, 50.0, 40.0, 10.0, 180.0, 120.0, 50.0, 40.0, 280.0, 70.0, 120.0, 110.0, 20.0, 0.0, 80.0, 180.0, 110.0, 90.0, 30.0, 0.0, 30.0, 70.0, 0.0, 60.0, 40.0, 10.0, 100.0, 480.0, 40.0, 80.0, 90.0, 380.0, 70.0, 340.0, 90.0, 110.0, 130.0, 150.0, 170.0, 20.0, 50.0, 80.0, 70.0, 0.0, 75.0, 15.0, 30.0, 0.0, 290.0, 100.0, 50.0, 0.0, 240.0, 140.0, 60.0, 100.0, 280.0, 130.0, 110.0, 50.0, 120.0, 200.0, 60.0, 100.0, 40.0, 120.0, 30.0, 120.0, 550.0, 170.0, 170.0, 320.0, 60.0, 45.0, 120.0, 110.0, 160.0, 60.0, 340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0, 40.0, 180.0, 350.0, 50.0, 70.0, 110.0, 80.0, 460.0, 120.0, 20.0, 40.0, 30.0, 0.0, 30.0, 20.0, 70.0, 60.0, 20.0, 40.0, 30.0, 110.0, 50.0, 300.0, 40.0, 180.0, 120.0, 110.0, 30.0, 180.0, -30.0, 20.0, 80.0, 20.0, 20.0, 50.0, 20.0, -40.0, 160.0, 10.0, 20.0, 60.0, 30.0, 130.0, 60.0, 280.0, 0.0, 290.0, 70.0, 40.0, 70.0, 0.0, 40.0, 160.0, 20.0, 90.0, 170.0, 80.0, 60.0, 40.0, 250.0, 60.0, 320.0, 40.0, 200.0, 10.0, 90.0, 260.0, 70.0, 80.0, -150.0, 100.0, 90.0, 180.0, 340.0, 40.0, 50.0, 170.0, 40.0, 70.0, 170.0, 50.0, 40.0, 120.0, 60.0, 50.0, 150.0, 300.0, 50.0, 200.0, -30.0, 110.0, 130.0, 80.0, 10.0, 120.0, 20.0, 40.0, 130.0, -70.0, 350.0, 130.0, 0.0, -5.0, 80.0, 70.0, 270.0, 100.0, -10.0, 210.0, 40.0, 110.0, 150.0, 80.0, 130.0, 230.0, 30.0, 170.0, 130.0, 30.0, 80.0, 90.0, 270.0, 350.0, 40.0, 60.0, 120.0, 150.0, 70.0, 80.0, 30.0, 20.0, 100.0, 200.0, 220.0, 580.0, 190.0, 80.0, 130.0, 140.0, 100.0, 100.0, 330.0, 330.0, 20.0, 20.0, 50.0, 55.0, 130.0, 340.0, 40.0, 10.0, 10.0, 70.0, 70.0, 10.0, 50.0, 80.0, 100.0, 140.0, 300.0, 0.0, 130.0, 60.0, 50.0, 330.0, 10.0, 40.0, 50.0, 160.0, 100.0, 150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0, 200.0, 230.0, 50.0, 80.0, 30.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 350.0, -20.0, 15.0, 170.0, 10.0, 170.0, 40.0, 5.0, 80.0, 220.0, 220.0, 0.0, 160.0, 100.0, 310.0, 110.0, 200.0, 40.0, 50.0, 170.0, 50.0, 45.0, 20.0, 60.0, 90.0, 40.0, 410.0, 180.0, 200.0, 210.0, 125.0, 10.0, 350.0, 170.0, 350.0, 60.0, 10.0, 90.0, 80.0, 50.0, 440.0, 320.0, 260.0, 100.0, 105.0, 60.0, 40.0, 40.0, -170.0, 40.0, 40.0, 200.0, 100.0, 20.0, 150.0, 0.0, 0.0, 70.0, 50.0, 15.0, 0.0, 30.0, 0.0, 60.0, 50.0, 30.0, 0.0, 360.0, 40.0, 80.0, 70.0, 40.0, 210.0, 190.0, 90.0, 140.0, 390.0, 110.0, 210.0, 110.0, 10.0, 150.0, 80.0, 200.0, 150.0, 110.0, 40.0, 40.0, 30.0, 10.0, 80.0, 80.0, 130.0, 60.0, 180.0, 80.0, 300.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 20.0, 140.0, 110.0, 30.0, 0.0, 390.0, 280.0, 70.0, 190.0, 30.0, 200.0, 30.0, 180.0, -60.0, 180.0, 40.0, -20.0, 310.0, 60.0, 100.0, 60.0, 100.0, 60.0, 40.0, 0.0, 90.0, 220.0, 60.0, 20.0, 90.0, 190.0, 50.0, 160.0, 200.0, 210.0, 210.0, 40.0, 40.0, 40.0, 40.0, 50.0, 20.0, 440.0, 40.0, 10.0, 90.0, 50.0, 40.0, 110.0, 10.0, 30.0, 20.0, 130.0, 150.0, 70.0, 60.0, 170.0, 230.0, 0.0, 130.0, 150.0, 50.0, 40.0, 210.0, 50.0, 230.0, 40.0, 50.0, 220.0, 40.0, 60.0, 140.0, 160.0, 20.0, 30.0, 40.0, 330.0, 50.0, 50.0, 210.0, 160.0, 220.0, 160.0, 190.0, 30.0, 50.0, 90.0, 60.0, 270.0, 30.0, 50.0, 30.0, 280.0, 50.0, 130.0, 300.0, 100.0, 150.0, 340.0, 40.0, 90.0, 150.0, 420.0, 200.0, 0.0, 70.0, 30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0, -100.0, 110.0, 90.0, 120.0, 80.0, 80.0, -30.0, 320.0, 500.0, 50.0, 390.0, 30.0, 60.0, 90.0, 50.0, 40.0, 50.0, 110.0, 90.0, 30.0, 50.0, 40.0, 140.0, 190.0, 20.0, 10.0, 240.0, 550.0, 80.0, 0.0, 160.0, 80.0, 0.0, 35.0, 150.0, 20.0, 460.0, -140.0, 150.0, 280.0, 180.0, 110.0, 100.0, 80.0, 180.0, 40.0, 180.0, 60.0, 0.0, 370.0, 20.0, 90.0, 330.0, 160.0, -30.0, 220.0, 100.0, 40.0, 90.0, 50.0, 430.0, 360.0, 50.0, 390.0, 100.0, 100.0, 30.0, 170.0, 40.0, 70.0, 20.0, 40.0, 0.0, 20.0, 160.0, 10.0, 170.0, 200.0, 190.0, 70.0, 120.0, -30.0, 30.0, -30.0, 150.0, 90.0, 60.0, 480.0, 20.0, 90.0, 60.0, 450.0, 100.0, 40.0, 30.0, 110.0, 100.0, 50.0, 0.0, 120.0, 320.0, 70.0, 200.0, 180.0, 120.0, 150.0, 230.0, 160.0, -40.0, 60.0, 370.0, 110.0, 50.0, 90.0, 100.0, 120.0, 390.0, 140.0, 90.0, 200.0, 0.0, 50.0, 50.0, 30.0, 10.0, 80.0, 400.0, 140.0, 400.0, 40.0, 0.0, 60.0, 410.0, 70.0, 10.0, 20.0, 50.0, -40.0, -50.0, 30.0, 30.0, 20.0, 0.0, 30.0, 60.0, 0.0, 10.0, 15.0, 140.0, 20.0, 260.0, 30.0, 40.0, 80.0, 30.0, 340.0, 180.0, 160.0, 80.0, 140.0, 40.0, 20.0, 10.0, 20.0, 60.0, 50.0, 80.0, -30.0, 30.0, 20.0, 60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526004006805075, "mean_inference_ms": 1.411986892880279, "mean_action_processing_ms": 0.4625820024005971, "mean_env_wait_ms": 1.2448823553761466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012505292892456055, "StateBufferConnector_ms": 0.009531974792480469, "ViewRequirementAgentConnector_ms": 0.40072083473205566}, "num_episodes": 18, "episode_return_max": 1805.0, "episode_return_min": 300.0, "episode_return_mean": 1066.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.588863732173536, "num_env_steps_trained_throughput_per_sec": 21.588863732173536, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 186648.597, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186648.543, "sample_time_ms": 2726.216, "learn_time_ms": 183899.73, "learn_throughput": 21.751, "synch_weights_time_ms": 11.065}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "33e63_00000", "date": "2024-06-19_03-24-53", "timestamp": 1718781893, "time_this_iter_s": 185.31095385551453, "time_total_s": 22674.190575122833, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278ec8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22674.190575122833, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 16.650763358778626, "ram_util_percent": 79.4885496183206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.876759573871208, "cur_kl_coeff": 3.8967852305620903, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005535484695756516, "vf_loss": 7.423340334247349, "vf_explained_var": 0.00038277690276043356, "kl": Infinity, "entropy": 0.357142383087113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": 300.0, "episode_reward_mean": 1095.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 109.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1650.0, 1195.0, 910.0, 620.0, 810.0, 1270.0, 1060.0, 1570.0, 650.0, 1270.0, 780.0, 1060.0, 820.0, 1480.0, 510.0, 1390.0, 950.0, 1765.0, 1375.0, 1480.0, 340.0, 1090.0, 360.0, 1030.0, 910.0, 980.0, 1250.0, 990.0, 920.0, 885.0, 1140.0, 1260.0, 1760.0, 1415.0, 840.0, 930.0, 1510.0, 750.0, 910.0, 1410.0, 1265.0, 1455.0, 1245.0, 670.0, 585.0, 1530.0, 920.0, 1170.0, 820.0, 1140.0, 800.0, 1410.0, 810.0, 670.0, 1260.0, 800.0, 1450.0, 1290.0, 1560.0, 770.0, 1220.0, 940.0, 1320.0, 1195.0, 1300.0, 1070.0, 1740.0, 880.0, 980.0, 1060.0, 1450.0, 1660.0, 1200.0, 560.0, 325.0, 1340.0, 300.0, 1080.0, 1310.0, 1530.0, 780.0, 860.0, 1840.0, 1005.0, 650.0, 1160.0, 1130.0, 1455.0, 1020.0, 1040.0, 995.0, 950.0, 1055.0, 1390.0, 1190.0, 620.0, 760.0, 2180.0, 1450.0, 615.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 130.0, 200.0, 190.0, 310.0, 90.0, 150.0, 360.0, 90.0, 80.0, 40.0, 70.0, 30.0, 330.0, 180.0, 100.0, 0.0, 290.0, 5.0, 150.0, 130.0, 90.0, 40.0, 90.0, 40.0, 300.0, 20.0, 60.0, 80.0, 60.0, 120.0, 30.0, 140.0, 0.0, 0.0, 70.0, 20.0, 180.0, 40.0, 20.0, -50.0, 120.0, 50.0, 170.0, 230.0, -10.0, 160.0, 30.0, 30.0, 80.0, 40.0, 10.0, 370.0, 280.0, 80.0, 90.0, 210.0, 40.0, 150.0, 0.0, 210.0, 60.0, 170.0, 50.0, 50.0, 340.0, 70.0, 20.0, 60.0, 30.0, 60.0, 320.0, 210.0, 270.0, 80.0, 140.0, 90.0, 50.0, 70.0, 280.0, 50.0, 100.0, 180.0, 90.0, 80.0, 30.0, 20.0, 20.0, 30.0, 50.0, 90.0, 10.0, 20.0, 690.0, 150.0, 0.0, 10.0, -60.0, 40.0, 320.0, 130.0, 30.0, 130.0, 50.0, 40.0, 10.0, 180.0, 120.0, 50.0, 40.0, 280.0, 70.0, 120.0, 110.0, 20.0, 0.0, 80.0, 180.0, 110.0, 90.0, 30.0, 0.0, 30.0, 70.0, 0.0, 60.0, 40.0, 10.0, 100.0, 480.0, 40.0, 80.0, 90.0, 380.0, 70.0, 340.0, 90.0, 110.0, 130.0, 150.0, 170.0, 20.0, 50.0, 80.0, 70.0, 0.0, 75.0, 15.0, 30.0, 0.0, 290.0, 100.0, 50.0, 0.0, 240.0, 140.0, 60.0, 100.0, 280.0, 130.0, 110.0, 50.0, 120.0, 200.0, 60.0, 100.0, 40.0, 120.0, 30.0, 120.0, 550.0, 170.0, 170.0, 320.0, 60.0, 45.0, 120.0, 110.0, 160.0, 60.0, 340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0, 40.0, 180.0, 350.0, 50.0, 70.0, 110.0, 80.0, 460.0, 120.0, 20.0, 40.0, 30.0, 0.0, 30.0, 20.0, 70.0, 60.0, 20.0, 40.0, 30.0, 110.0, 50.0, 300.0, 40.0, 180.0, 120.0, 110.0, 30.0, 180.0, -30.0, 20.0, 80.0, 20.0, 20.0, 50.0, 20.0, -40.0, 160.0, 10.0, 20.0, 60.0, 30.0, 130.0, 60.0, 280.0, 0.0, 290.0, 70.0, 40.0, 70.0, 0.0, 40.0, 160.0, 20.0, 90.0, 170.0, 80.0, 60.0, 40.0, 250.0, 60.0, 320.0, 40.0, 200.0, 10.0, 90.0, 260.0, 70.0, 80.0, -150.0, 100.0, 90.0, 180.0, 340.0, 40.0, 50.0, 170.0, 40.0, 70.0, 170.0, 50.0, 40.0, 120.0, 60.0, 50.0, 150.0, 300.0, 50.0, 200.0, -30.0, 110.0, 130.0, 80.0, 10.0, 120.0, 20.0, 40.0, 130.0, -70.0, 350.0, 130.0, 0.0, -5.0, 80.0, 70.0, 270.0, 100.0, -10.0, 210.0, 40.0, 110.0, 150.0, 80.0, 130.0, 230.0, 30.0, 170.0, 130.0, 30.0, 80.0, 90.0, 270.0, 350.0, 40.0, 60.0, 120.0, 150.0, 70.0, 80.0, 30.0, 20.0, 100.0, 200.0, 220.0, 580.0, 190.0, 80.0, 130.0, 140.0, 100.0, 100.0, 330.0, 330.0, 20.0, 20.0, 50.0, 55.0, 130.0, 340.0, 40.0, 10.0, 10.0, 70.0, 70.0, 10.0, 50.0, 80.0, 100.0, 140.0, 300.0, 0.0, 130.0, 60.0, 50.0, 330.0, 10.0, 40.0, 50.0, 160.0, 100.0, 150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0, 200.0, 230.0, 50.0, 80.0, 30.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 350.0, -20.0, 15.0, 170.0, 10.0, 170.0, 40.0, 5.0, 80.0, 220.0, 220.0, 0.0, 160.0, 100.0, 310.0, 110.0, 200.0, 40.0, 50.0, 170.0, 50.0, 45.0, 20.0, 60.0, 90.0, 40.0, 410.0, 180.0, 200.0, 210.0, 125.0, 10.0, 350.0, 170.0, 350.0, 60.0, 10.0, 90.0, 80.0, 50.0, 440.0, 320.0, 260.0, 100.0, 105.0, 60.0, 40.0, 40.0, -170.0, 40.0, 40.0, 200.0, 100.0, 20.0, 150.0, 0.0, 0.0, 70.0, 50.0, 15.0, 0.0, 30.0, 0.0, 60.0, 50.0, 30.0, 0.0, 360.0, 40.0, 80.0, 70.0, 40.0, 210.0, 190.0, 90.0, 140.0, 390.0, 110.0, 210.0, 110.0, 10.0, 150.0, 80.0, 200.0, 150.0, 110.0, 40.0, 40.0, 30.0, 10.0, 80.0, 80.0, 130.0, 60.0, 180.0, 80.0, 300.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 20.0, 140.0, 110.0, 30.0, 0.0, 390.0, 280.0, 70.0, 190.0, 30.0, 200.0, 30.0, 180.0, -60.0, 180.0, 40.0, -20.0, 310.0, 60.0, 100.0, 60.0, 100.0, 60.0, 40.0, 0.0, 90.0, 220.0, 60.0, 20.0, 90.0, 190.0, 50.0, 160.0, 200.0, 210.0, 210.0, 40.0, 40.0, 40.0, 40.0, 50.0, 20.0, 440.0, 40.0, 10.0, 90.0, 50.0, 40.0, 110.0, 10.0, 30.0, 20.0, 130.0, 150.0, 70.0, 60.0, 170.0, 230.0, 0.0, 130.0, 150.0, 50.0, 40.0, 210.0, 50.0, 230.0, 40.0, 50.0, 220.0, 40.0, 60.0, 140.0, 160.0, 20.0, 30.0, 40.0, 330.0, 50.0, 50.0, 210.0, 160.0, 220.0, 160.0, 190.0, 30.0, 50.0, 90.0, 60.0, 270.0, 30.0, 50.0, 30.0, 280.0, 50.0, 130.0, 300.0, 100.0, 150.0, 340.0, 40.0, 90.0, 150.0, 420.0, 200.0, 0.0, 70.0, 30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0, -100.0, 110.0, 90.0, 120.0, 80.0, 80.0, -30.0, 320.0, 500.0, 50.0, 390.0, 30.0, 60.0, 90.0, 50.0, 40.0, 50.0, 110.0, 90.0, 30.0, 50.0, 40.0, 140.0, 190.0, 20.0, 10.0, 240.0, 550.0, 80.0, 0.0, 160.0, 80.0, 0.0, 35.0, 150.0, 20.0, 460.0, -140.0, 150.0, 280.0, 180.0, 110.0, 100.0, 80.0, 180.0, 40.0, 180.0, 60.0, 0.0, 370.0, 20.0, 90.0, 330.0, 160.0, -30.0, 220.0, 100.0, 40.0, 90.0, 50.0, 430.0, 360.0, 50.0, 390.0, 100.0, 100.0, 30.0, 170.0, 40.0, 70.0, 20.0, 40.0, 0.0, 20.0, 160.0, 10.0, 170.0, 200.0, 190.0, 70.0, 120.0, -30.0, 30.0, -30.0, 150.0, 90.0, 60.0, 480.0, 20.0, 90.0, 60.0, 450.0, 100.0, 40.0, 30.0, 110.0, 100.0, 50.0, 0.0, 120.0, 320.0, 70.0, 200.0, 180.0, 120.0, 150.0, 230.0, 160.0, -40.0, 60.0, 370.0, 110.0, 50.0, 90.0, 100.0, 120.0, 390.0, 140.0, 90.0, 200.0, 0.0, 50.0, 50.0, 30.0, 10.0, 80.0, 400.0, 140.0, 400.0, 40.0, 0.0, 60.0, 410.0, 70.0, 10.0, 20.0, 50.0, -40.0, -50.0, 30.0, 30.0, 20.0, 0.0, 30.0, 60.0, 0.0, 10.0, 15.0, 140.0, 20.0, 260.0, 30.0, 40.0, 80.0, 30.0, 340.0, 180.0, 160.0, 80.0, 140.0, 40.0, 20.0, 10.0, 20.0, 60.0, 50.0, 80.0, -30.0, 30.0, 20.0, 60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0, 80.0, 70.0, 20.0, 340.0, 100.0, 80.0, 320.0, 40.0, 170.0, 90.0, 130.0, 40.0, 30.0, 260.0, 310.0, 160.0, 140.0, 260.0, 100.0, 100.0, 40.0, 20.0, 30.0, 0.0, 30.0, 120.0, 0.0, 50.0, 0.0, 490.0, 10.0, 60.0, 10.0, 340.0, 200.0, 70.0, 30.0, 70.0, 50.0, 20.0, 510.0, 130.0, 140.0, 160.0, 90.0, 90.0, 280.0, 190.0, 0.0, 250.0, 270.0, 100.0, 0.0, 35.0, 40.0, 30.0, 90.0, -100.0, 160.0, 380.0, 20.0, 90.0, 0.0, 0.0, 70.0, 40.0, 160.0, 30.0, 200.0, 40.0, 90.0, 80.0, 30.0, 40.0, 240.0, 330.0, 140.0, 80.0, 110.0, 20.0, 490.0, 30.0, 70.0, 20.0, 100.0, 20.0, 150.0, 110.0, 20.0, 120.0, 80.0, 130.0, 70.0, 60.0, 380.0, 45.0, 250.0, 160.0, 170.0, 110.0, 240.0, 50.0, 70.0, 70.0, 40.0, 20.0, 80.0, 20.0, 70.0, 360.0, 140.0, 50.0, 140.0, 130.0, 130.0, 100.0, 40.0, 210.0, 50.0, 50.0, 75.0, 210.0, -20.0, 20.0, 530.0, -50.0, 220.0, -30.0, 60.0, -20.0, 0.0, 30.0, 100.0, 270.0, 20.0, 200.0, 420.0, 130.0, 40.0, -260.0, 180.0, 200.0, 260.0, 80.0, 20.0, 80.0, 20.0, 70.0, 20.0, 125.0, 50.0, 110.0, 120.0, 140.0, 320.0, 70.0, 40.0, 50.0, 60.0, 430.0, 310.0, 90.0, 20.0, 120.0, 40.0, 100.0, 100.0, 60.0, 210.0, 140.0, 60.0, 30.0, 50.0, 80.0, 140.0, 50.0, 30.0, 40.0, 100.0, 40.0, 20.0, 40.0, 40.0, 140.0, 60.0, 0.0, 10.0, 10.0, 390.0, 50.0, 240.0, 160.0, 220.0, 140.0, 80.0, 110.0, 10.0, 290.0, 760.0, 170.0, 50.0, 90.0, 60.0, 230.0, 200.0, 340.0, 130.0, 50.0, 220.0, 80.0, 20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.526672104252837, "mean_inference_ms": 1.4133900530968928, "mean_action_processing_ms": 0.4620778849829164, "mean_env_wait_ms": 1.2456398094413004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012021303176879883, "StateBufferConnector_ms": 0.009474992752075195, "ViewRequirementAgentConnector_ms": 0.39746928215026855}, "num_episodes": 22, "episode_return_max": 2180.0, "episode_return_min": 300.0, "episode_return_mean": 1095.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.347863106478673, "num_env_steps_trained_throughput_per_sec": 21.347863106478673, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 186568.8, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186568.746, "sample_time_ms": 2731.683, "learn_time_ms": 183814.766, "learn_throughput": 21.761, "synch_weights_time_ms": 10.778}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "33e63_00000", "date": "2024-06-19_03-28-00", "timestamp": 1718782080, "time_this_iter_s": 187.38137698173523, "time_total_s": 22861.57195210457, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278ecd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 22861.57195210457, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.881132075471697, "ram_util_percent": 79.65396226415095}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0300063610394288, "cur_kl_coeff": 5.845177845843138, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004601917980068698, "vf_loss": 7.381153724901973, "vf_explained_var": 0.0006605408696955639, "kl": Infinity, "entropy": 0.3530751372472293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": 300.0, "episode_reward_mean": 1106.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 110.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1375.0, 1480.0, 340.0, 1090.0, 360.0, 1030.0, 910.0, 980.0, 1250.0, 990.0, 920.0, 885.0, 1140.0, 1260.0, 1760.0, 1415.0, 840.0, 930.0, 1510.0, 750.0, 910.0, 1410.0, 1265.0, 1455.0, 1245.0, 670.0, 585.0, 1530.0, 920.0, 1170.0, 820.0, 1140.0, 800.0, 1410.0, 810.0, 670.0, 1260.0, 800.0, 1450.0, 1290.0, 1560.0, 770.0, 1220.0, 940.0, 1320.0, 1195.0, 1300.0, 1070.0, 1740.0, 880.0, 980.0, 1060.0, 1450.0, 1660.0, 1200.0, 560.0, 325.0, 1340.0, 300.0, 1080.0, 1310.0, 1530.0, 780.0, 860.0, 1840.0, 1005.0, 650.0, 1160.0, 1130.0, 1455.0, 1020.0, 1040.0, 995.0, 950.0, 1055.0, 1390.0, 1190.0, 620.0, 760.0, 2180.0, 1450.0, 615.0, 885.0, 1745.0, 505.0, 1420.0, 1310.0, 1575.0, 1910.0, 375.0, 1180.0, 1315.0, 740.0, 1450.0, 1080.0, 1360.0, 1440.0, 650.0, 1490.0, 435.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [340.0, 80.0, 30.0, 30.0, 280.0, 80.0, 110.0, 40.0, -15.0, 400.0, 40.0, 180.0, 350.0, 50.0, 70.0, 110.0, 80.0, 460.0, 120.0, 20.0, 40.0, 30.0, 0.0, 30.0, 20.0, 70.0, 60.0, 20.0, 40.0, 30.0, 110.0, 50.0, 300.0, 40.0, 180.0, 120.0, 110.0, 30.0, 180.0, -30.0, 20.0, 80.0, 20.0, 20.0, 50.0, 20.0, -40.0, 160.0, 10.0, 20.0, 60.0, 30.0, 130.0, 60.0, 280.0, 0.0, 290.0, 70.0, 40.0, 70.0, 0.0, 40.0, 160.0, 20.0, 90.0, 170.0, 80.0, 60.0, 40.0, 250.0, 60.0, 320.0, 40.0, 200.0, 10.0, 90.0, 260.0, 70.0, 80.0, -150.0, 100.0, 90.0, 180.0, 340.0, 40.0, 50.0, 170.0, 40.0, 70.0, 170.0, 50.0, 40.0, 120.0, 60.0, 50.0, 150.0, 300.0, 50.0, 200.0, -30.0, 110.0, 130.0, 80.0, 10.0, 120.0, 20.0, 40.0, 130.0, -70.0, 350.0, 130.0, 0.0, -5.0, 80.0, 70.0, 270.0, 100.0, -10.0, 210.0, 40.0, 110.0, 150.0, 80.0, 130.0, 230.0, 30.0, 170.0, 130.0, 30.0, 80.0, 90.0, 270.0, 350.0, 40.0, 60.0, 120.0, 150.0, 70.0, 80.0, 30.0, 20.0, 100.0, 200.0, 220.0, 580.0, 190.0, 80.0, 130.0, 140.0, 100.0, 100.0, 330.0, 330.0, 20.0, 20.0, 50.0, 55.0, 130.0, 340.0, 40.0, 10.0, 10.0, 70.0, 70.0, 10.0, 50.0, 80.0, 100.0, 140.0, 300.0, 0.0, 130.0, 60.0, 50.0, 330.0, 10.0, 40.0, 50.0, 160.0, 100.0, 150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0, 200.0, 230.0, 50.0, 80.0, 30.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 350.0, -20.0, 15.0, 170.0, 10.0, 170.0, 40.0, 5.0, 80.0, 220.0, 220.0, 0.0, 160.0, 100.0, 310.0, 110.0, 200.0, 40.0, 50.0, 170.0, 50.0, 45.0, 20.0, 60.0, 90.0, 40.0, 410.0, 180.0, 200.0, 210.0, 125.0, 10.0, 350.0, 170.0, 350.0, 60.0, 10.0, 90.0, 80.0, 50.0, 440.0, 320.0, 260.0, 100.0, 105.0, 60.0, 40.0, 40.0, -170.0, 40.0, 40.0, 200.0, 100.0, 20.0, 150.0, 0.0, 0.0, 70.0, 50.0, 15.0, 0.0, 30.0, 0.0, 60.0, 50.0, 30.0, 0.0, 360.0, 40.0, 80.0, 70.0, 40.0, 210.0, 190.0, 90.0, 140.0, 390.0, 110.0, 210.0, 110.0, 10.0, 150.0, 80.0, 200.0, 150.0, 110.0, 40.0, 40.0, 30.0, 10.0, 80.0, 80.0, 130.0, 60.0, 180.0, 80.0, 300.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 20.0, 140.0, 110.0, 30.0, 0.0, 390.0, 280.0, 70.0, 190.0, 30.0, 200.0, 30.0, 180.0, -60.0, 180.0, 40.0, -20.0, 310.0, 60.0, 100.0, 60.0, 100.0, 60.0, 40.0, 0.0, 90.0, 220.0, 60.0, 20.0, 90.0, 190.0, 50.0, 160.0, 200.0, 210.0, 210.0, 40.0, 40.0, 40.0, 40.0, 50.0, 20.0, 440.0, 40.0, 10.0, 90.0, 50.0, 40.0, 110.0, 10.0, 30.0, 20.0, 130.0, 150.0, 70.0, 60.0, 170.0, 230.0, 0.0, 130.0, 150.0, 50.0, 40.0, 210.0, 50.0, 230.0, 40.0, 50.0, 220.0, 40.0, 60.0, 140.0, 160.0, 20.0, 30.0, 40.0, 330.0, 50.0, 50.0, 210.0, 160.0, 220.0, 160.0, 190.0, 30.0, 50.0, 90.0, 60.0, 270.0, 30.0, 50.0, 30.0, 280.0, 50.0, 130.0, 300.0, 100.0, 150.0, 340.0, 40.0, 90.0, 150.0, 420.0, 200.0, 0.0, 70.0, 30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0, -100.0, 110.0, 90.0, 120.0, 80.0, 80.0, -30.0, 320.0, 500.0, 50.0, 390.0, 30.0, 60.0, 90.0, 50.0, 40.0, 50.0, 110.0, 90.0, 30.0, 50.0, 40.0, 140.0, 190.0, 20.0, 10.0, 240.0, 550.0, 80.0, 0.0, 160.0, 80.0, 0.0, 35.0, 150.0, 20.0, 460.0, -140.0, 150.0, 280.0, 180.0, 110.0, 100.0, 80.0, 180.0, 40.0, 180.0, 60.0, 0.0, 370.0, 20.0, 90.0, 330.0, 160.0, -30.0, 220.0, 100.0, 40.0, 90.0, 50.0, 430.0, 360.0, 50.0, 390.0, 100.0, 100.0, 30.0, 170.0, 40.0, 70.0, 20.0, 40.0, 0.0, 20.0, 160.0, 10.0, 170.0, 200.0, 190.0, 70.0, 120.0, -30.0, 30.0, -30.0, 150.0, 90.0, 60.0, 480.0, 20.0, 90.0, 60.0, 450.0, 100.0, 40.0, 30.0, 110.0, 100.0, 50.0, 0.0, 120.0, 320.0, 70.0, 200.0, 180.0, 120.0, 150.0, 230.0, 160.0, -40.0, 60.0, 370.0, 110.0, 50.0, 90.0, 100.0, 120.0, 390.0, 140.0, 90.0, 200.0, 0.0, 50.0, 50.0, 30.0, 10.0, 80.0, 400.0, 140.0, 400.0, 40.0, 0.0, 60.0, 410.0, 70.0, 10.0, 20.0, 50.0, -40.0, -50.0, 30.0, 30.0, 20.0, 0.0, 30.0, 60.0, 0.0, 10.0, 15.0, 140.0, 20.0, 260.0, 30.0, 40.0, 80.0, 30.0, 340.0, 180.0, 160.0, 80.0, 140.0, 40.0, 20.0, 10.0, 20.0, 60.0, 50.0, 80.0, -30.0, 30.0, 20.0, 60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0, 80.0, 70.0, 20.0, 340.0, 100.0, 80.0, 320.0, 40.0, 170.0, 90.0, 130.0, 40.0, 30.0, 260.0, 310.0, 160.0, 140.0, 260.0, 100.0, 100.0, 40.0, 20.0, 30.0, 0.0, 30.0, 120.0, 0.0, 50.0, 0.0, 490.0, 10.0, 60.0, 10.0, 340.0, 200.0, 70.0, 30.0, 70.0, 50.0, 20.0, 510.0, 130.0, 140.0, 160.0, 90.0, 90.0, 280.0, 190.0, 0.0, 250.0, 270.0, 100.0, 0.0, 35.0, 40.0, 30.0, 90.0, -100.0, 160.0, 380.0, 20.0, 90.0, 0.0, 0.0, 70.0, 40.0, 160.0, 30.0, 200.0, 40.0, 90.0, 80.0, 30.0, 40.0, 240.0, 330.0, 140.0, 80.0, 110.0, 20.0, 490.0, 30.0, 70.0, 20.0, 100.0, 20.0, 150.0, 110.0, 20.0, 120.0, 80.0, 130.0, 70.0, 60.0, 380.0, 45.0, 250.0, 160.0, 170.0, 110.0, 240.0, 50.0, 70.0, 70.0, 40.0, 20.0, 80.0, 20.0, 70.0, 360.0, 140.0, 50.0, 140.0, 130.0, 130.0, 100.0, 40.0, 210.0, 50.0, 50.0, 75.0, 210.0, -20.0, 20.0, 530.0, -50.0, 220.0, -30.0, 60.0, -20.0, 0.0, 30.0, 100.0, 270.0, 20.0, 200.0, 420.0, 130.0, 40.0, -260.0, 180.0, 200.0, 260.0, 80.0, 20.0, 80.0, 20.0, 70.0, 20.0, 125.0, 50.0, 110.0, 120.0, 140.0, 320.0, 70.0, 40.0, 50.0, 60.0, 430.0, 310.0, 90.0, 20.0, 120.0, 40.0, 100.0, 100.0, 60.0, 210.0, 140.0, 60.0, 30.0, 50.0, 80.0, 140.0, 50.0, 30.0, 40.0, 100.0, 40.0, 20.0, 40.0, 40.0, 140.0, 60.0, 0.0, 10.0, 10.0, 390.0, 50.0, 240.0, 160.0, 220.0, 140.0, 80.0, 110.0, 10.0, 290.0, 760.0, 170.0, 50.0, 90.0, 60.0, 230.0, 200.0, 340.0, 130.0, 50.0, 220.0, 80.0, 20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0, 40.0, 165.0, 100.0, 70.0, 40.0, 190.0, 30.0, 60.0, 120.0, 70.0, 70.0, 340.0, 70.0, 510.0, 110.0, 280.0, 50.0, 105.0, 120.0, 90.0, 70.0, 10.0, 30.0, 25.0, 70.0, 30.0, 30.0, 50.0, 160.0, 30.0, -10.0, 410.0, 30.0, 90.0, 60.0, 110.0, 230.0, 170.0, 210.0, 120.0, 100.0, 180.0, 390.0, 70.0, 100.0, 150.0, 120.0, 60.0, 40.0, 100.0, 155.0, 450.0, 30.0, 410.0, 130.0, 30.0, 40.0, 50.0, 250.0, 30.0, 80.0, 220.0, 150.0, 170.0, -30.0, 40.0, 370.0, 130.0, 680.0, 100.0, 20.0, 30.0, 30.0, 45.0, 70.0, 50.0, 40.0, 0.0, 80.0, 10.0, 60.0, 160.0, 60.0, 80.0, 20.0, 310.0, 20.0, 100.0, 260.0, 110.0, -40.0, -5.0, 400.0, 110.0, 30.0, 250.0, 50.0, 20.0, 250.0, 250.0, 60.0, 30.0, 60.0, 20.0, 70.0, 0.0, 80.0, 160.0, 230.0, 30.0, 160.0, 50.0, -10.0, 230.0, 190.0, 130.0, 10.0, 170.0, 540.0, -20.0, 550.0, 120.0, 20.0, 170.0, 10.0, 40.0, 40.0, 40.0, 50.0, 40.0, 100.0, 190.0, 240.0, 70.0, 60.0, 210.0, 0.0, 40.0, 170.0, 280.0, 110.0, 80.0, 90.0, 320.0, 200.0, 110.0, 170.0, 190.0, 110.0, 60.0, 10.0, 60.0, -20.0, 60.0, 40.0, 0.0, 80.0, -50.0, 10.0, 460.0, 60.0, 190.0, 330.0, 20.0, 130.0, 90.0, 150.0, 250.0, -60.0, 330.0, 150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.527219372963647, "mean_inference_ms": 1.414361736007538, "mean_action_processing_ms": 0.4616722247924853, "mean_env_wait_ms": 1.2461650045446078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01207733154296875, "StateBufferConnector_ms": 0.009552240371704102, "ViewRequirementAgentConnector_ms": 0.4036417007446289}, "num_episodes": 18, "episode_return_max": 2180.0, "episode_return_min": 300.0, "episode_return_mean": 1106.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.093971533080644, "num_env_steps_trained_throughput_per_sec": 21.093971533080644, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 186953.84, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186953.787, "sample_time_ms": 2759.653, "learn_time_ms": 184171.205, "learn_throughput": 21.719, "synch_weights_time_ms": 10.909}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "33e63_00000", "date": "2024-06-19_03-31-10", "timestamp": 1718782270, "time_this_iter_s": 189.66933512687683, "time_total_s": 23051.241287231445, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23051.241287231445, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 18.504477611940302, "ram_util_percent": 80.42014925373134}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0303054305501638, "cur_kl_coeff": 8.767766768764703, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004565541939492535, "vf_loss": 6.883813881290099, "vf_explained_var": 0.0008602428106200327, "kl": Infinity, "entropy": 0.3919957709039489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": -50.0, "episode_reward_mean": 1093.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 109.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.0, 750.0, 910.0, 1410.0, 1265.0, 1455.0, 1245.0, 670.0, 585.0, 1530.0, 920.0, 1170.0, 820.0, 1140.0, 800.0, 1410.0, 810.0, 670.0, 1260.0, 800.0, 1450.0, 1290.0, 1560.0, 770.0, 1220.0, 940.0, 1320.0, 1195.0, 1300.0, 1070.0, 1740.0, 880.0, 980.0, 1060.0, 1450.0, 1660.0, 1200.0, 560.0, 325.0, 1340.0, 300.0, 1080.0, 1310.0, 1530.0, 780.0, 860.0, 1840.0, 1005.0, 650.0, 1160.0, 1130.0, 1455.0, 1020.0, 1040.0, 995.0, 950.0, 1055.0, 1390.0, 1190.0, 620.0, 760.0, 2180.0, 1450.0, 615.0, 885.0, 1745.0, 505.0, 1420.0, 1310.0, 1575.0, 1910.0, 375.0, 1180.0, 1315.0, 740.0, 1450.0, 1080.0, 1360.0, 1440.0, 650.0, 1490.0, 435.0, 1100.0, 1390.0, 1080.0, 640.0, 1575.0, -50.0, 425.0, 1140.0, 400.0, 1520.0, 1070.0, 945.0, 920.0, 395.0, 1610.0, 1510.0, 1300.0, 670.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 110.0, 530.0, 60.0, 200.0, 120.0, 110.0, 80.0, 60.0, 90.0, 200.0, 230.0, 50.0, 80.0, 30.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 350.0, -20.0, 15.0, 170.0, 10.0, 170.0, 40.0, 5.0, 80.0, 220.0, 220.0, 0.0, 160.0, 100.0, 310.0, 110.0, 200.0, 40.0, 50.0, 170.0, 50.0, 45.0, 20.0, 60.0, 90.0, 40.0, 410.0, 180.0, 200.0, 210.0, 125.0, 10.0, 350.0, 170.0, 350.0, 60.0, 10.0, 90.0, 80.0, 50.0, 440.0, 320.0, 260.0, 100.0, 105.0, 60.0, 40.0, 40.0, -170.0, 40.0, 40.0, 200.0, 100.0, 20.0, 150.0, 0.0, 0.0, 70.0, 50.0, 15.0, 0.0, 30.0, 0.0, 60.0, 50.0, 30.0, 0.0, 360.0, 40.0, 80.0, 70.0, 40.0, 210.0, 190.0, 90.0, 140.0, 390.0, 110.0, 210.0, 110.0, 10.0, 150.0, 80.0, 200.0, 150.0, 110.0, 40.0, 40.0, 30.0, 10.0, 80.0, 80.0, 130.0, 60.0, 180.0, 80.0, 300.0, 210.0, 40.0, 30.0, 20.0, 30.0, 50.0, 20.0, 140.0, 110.0, 30.0, 0.0, 390.0, 280.0, 70.0, 190.0, 30.0, 200.0, 30.0, 180.0, -60.0, 180.0, 40.0, -20.0, 310.0, 60.0, 100.0, 60.0, 100.0, 60.0, 40.0, 0.0, 90.0, 220.0, 60.0, 20.0, 90.0, 190.0, 50.0, 160.0, 200.0, 210.0, 210.0, 40.0, 40.0, 40.0, 40.0, 50.0, 20.0, 440.0, 40.0, 10.0, 90.0, 50.0, 40.0, 110.0, 10.0, 30.0, 20.0, 130.0, 150.0, 70.0, 60.0, 170.0, 230.0, 0.0, 130.0, 150.0, 50.0, 40.0, 210.0, 50.0, 230.0, 40.0, 50.0, 220.0, 40.0, 60.0, 140.0, 160.0, 20.0, 30.0, 40.0, 330.0, 50.0, 50.0, 210.0, 160.0, 220.0, 160.0, 190.0, 30.0, 50.0, 90.0, 60.0, 270.0, 30.0, 50.0, 30.0, 280.0, 50.0, 130.0, 300.0, 100.0, 150.0, 340.0, 40.0, 90.0, 150.0, 420.0, 200.0, 0.0, 70.0, 30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0, -100.0, 110.0, 90.0, 120.0, 80.0, 80.0, -30.0, 320.0, 500.0, 50.0, 390.0, 30.0, 60.0, 90.0, 50.0, 40.0, 50.0, 110.0, 90.0, 30.0, 50.0, 40.0, 140.0, 190.0, 20.0, 10.0, 240.0, 550.0, 80.0, 0.0, 160.0, 80.0, 0.0, 35.0, 150.0, 20.0, 460.0, -140.0, 150.0, 280.0, 180.0, 110.0, 100.0, 80.0, 180.0, 40.0, 180.0, 60.0, 0.0, 370.0, 20.0, 90.0, 330.0, 160.0, -30.0, 220.0, 100.0, 40.0, 90.0, 50.0, 430.0, 360.0, 50.0, 390.0, 100.0, 100.0, 30.0, 170.0, 40.0, 70.0, 20.0, 40.0, 0.0, 20.0, 160.0, 10.0, 170.0, 200.0, 190.0, 70.0, 120.0, -30.0, 30.0, -30.0, 150.0, 90.0, 60.0, 480.0, 20.0, 90.0, 60.0, 450.0, 100.0, 40.0, 30.0, 110.0, 100.0, 50.0, 0.0, 120.0, 320.0, 70.0, 200.0, 180.0, 120.0, 150.0, 230.0, 160.0, -40.0, 60.0, 370.0, 110.0, 50.0, 90.0, 100.0, 120.0, 390.0, 140.0, 90.0, 200.0, 0.0, 50.0, 50.0, 30.0, 10.0, 80.0, 400.0, 140.0, 400.0, 40.0, 0.0, 60.0, 410.0, 70.0, 10.0, 20.0, 50.0, -40.0, -50.0, 30.0, 30.0, 20.0, 0.0, 30.0, 60.0, 0.0, 10.0, 15.0, 140.0, 20.0, 260.0, 30.0, 40.0, 80.0, 30.0, 340.0, 180.0, 160.0, 80.0, 140.0, 40.0, 20.0, 10.0, 20.0, 60.0, 50.0, 80.0, -30.0, 30.0, 20.0, 60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0, 80.0, 70.0, 20.0, 340.0, 100.0, 80.0, 320.0, 40.0, 170.0, 90.0, 130.0, 40.0, 30.0, 260.0, 310.0, 160.0, 140.0, 260.0, 100.0, 100.0, 40.0, 20.0, 30.0, 0.0, 30.0, 120.0, 0.0, 50.0, 0.0, 490.0, 10.0, 60.0, 10.0, 340.0, 200.0, 70.0, 30.0, 70.0, 50.0, 20.0, 510.0, 130.0, 140.0, 160.0, 90.0, 90.0, 280.0, 190.0, 0.0, 250.0, 270.0, 100.0, 0.0, 35.0, 40.0, 30.0, 90.0, -100.0, 160.0, 380.0, 20.0, 90.0, 0.0, 0.0, 70.0, 40.0, 160.0, 30.0, 200.0, 40.0, 90.0, 80.0, 30.0, 40.0, 240.0, 330.0, 140.0, 80.0, 110.0, 20.0, 490.0, 30.0, 70.0, 20.0, 100.0, 20.0, 150.0, 110.0, 20.0, 120.0, 80.0, 130.0, 70.0, 60.0, 380.0, 45.0, 250.0, 160.0, 170.0, 110.0, 240.0, 50.0, 70.0, 70.0, 40.0, 20.0, 80.0, 20.0, 70.0, 360.0, 140.0, 50.0, 140.0, 130.0, 130.0, 100.0, 40.0, 210.0, 50.0, 50.0, 75.0, 210.0, -20.0, 20.0, 530.0, -50.0, 220.0, -30.0, 60.0, -20.0, 0.0, 30.0, 100.0, 270.0, 20.0, 200.0, 420.0, 130.0, 40.0, -260.0, 180.0, 200.0, 260.0, 80.0, 20.0, 80.0, 20.0, 70.0, 20.0, 125.0, 50.0, 110.0, 120.0, 140.0, 320.0, 70.0, 40.0, 50.0, 60.0, 430.0, 310.0, 90.0, 20.0, 120.0, 40.0, 100.0, 100.0, 60.0, 210.0, 140.0, 60.0, 30.0, 50.0, 80.0, 140.0, 50.0, 30.0, 40.0, 100.0, 40.0, 20.0, 40.0, 40.0, 140.0, 60.0, 0.0, 10.0, 10.0, 390.0, 50.0, 240.0, 160.0, 220.0, 140.0, 80.0, 110.0, 10.0, 290.0, 760.0, 170.0, 50.0, 90.0, 60.0, 230.0, 200.0, 340.0, 130.0, 50.0, 220.0, 80.0, 20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0, 40.0, 165.0, 100.0, 70.0, 40.0, 190.0, 30.0, 60.0, 120.0, 70.0, 70.0, 340.0, 70.0, 510.0, 110.0, 280.0, 50.0, 105.0, 120.0, 90.0, 70.0, 10.0, 30.0, 25.0, 70.0, 30.0, 30.0, 50.0, 160.0, 30.0, -10.0, 410.0, 30.0, 90.0, 60.0, 110.0, 230.0, 170.0, 210.0, 120.0, 100.0, 180.0, 390.0, 70.0, 100.0, 150.0, 120.0, 60.0, 40.0, 100.0, 155.0, 450.0, 30.0, 410.0, 130.0, 30.0, 40.0, 50.0, 250.0, 30.0, 80.0, 220.0, 150.0, 170.0, -30.0, 40.0, 370.0, 130.0, 680.0, 100.0, 20.0, 30.0, 30.0, 45.0, 70.0, 50.0, 40.0, 0.0, 80.0, 10.0, 60.0, 160.0, 60.0, 80.0, 20.0, 310.0, 20.0, 100.0, 260.0, 110.0, -40.0, -5.0, 400.0, 110.0, 30.0, 250.0, 50.0, 20.0, 250.0, 250.0, 60.0, 30.0, 60.0, 20.0, 70.0, 0.0, 80.0, 160.0, 230.0, 30.0, 160.0, 50.0, -10.0, 230.0, 190.0, 130.0, 10.0, 170.0, 540.0, -20.0, 550.0, 120.0, 20.0, 170.0, 10.0, 40.0, 40.0, 40.0, 50.0, 40.0, 100.0, 190.0, 240.0, 70.0, 60.0, 210.0, 0.0, 40.0, 170.0, 280.0, 110.0, 80.0, 90.0, 320.0, 200.0, 110.0, 170.0, 190.0, 110.0, 60.0, 10.0, 60.0, -20.0, 60.0, 40.0, 0.0, 80.0, -50.0, 10.0, 460.0, 60.0, 190.0, 330.0, 20.0, 130.0, 90.0, 150.0, 250.0, -60.0, 330.0, 150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0, 10.0, 270.0, 140.0, 70.0, 10.0, 300.0, 70.0, 70.0, 80.0, 80.0, 100.0, 70.0, 170.0, 420.0, 90.0, 50.0, 210.0, 90.0, 100.0, 90.0, 350.0, 40.0, 10.0, 30.0, 160.0, 280.0, 60.0, 70.0, 10.0, 70.0, 30.0, 30.0, 110.0, 20.0, 40.0, 170.0, 0.0, 20.0, 30.0, 190.0, 190.0, 40.0, 790.0, 20.0, 40.0, -45.0, 150.0, 150.0, 120.0, 120.0, 10.0, 20.0, 40.0, 10.0, 60.0, 90.0, 40.0, -490.0, 160.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 55.0, 480.0, 60.0, 30.0, 50.0, 200.0, 130.0, 90.0, -40.0, 70.0, 70.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 40.0, 40.0, 90.0, 150.0, 170.0, 260.0, 110.0, 330.0, 60.0, 70.0, 170.0, 120.0, 60.0, 170.0, -40.0, 90.0, 170.0, 140.0, 40.0, 500.0, 90.0, 30.0, -50.0, 100.0, 245.0, 180.0, 60.0, 110.0, 80.0, 30.0, -20.0, 220.0, 10.0, 30.0, 70.0, 120.0, 260.0, 80.0, 80.0, 110.0, 0.0, -20.0, 80.0, 140.0, 35.0, 30.0, 30.0, 140.0, 15.0, -30.0, 5.0, 10.0, 0.0, 160.0, 180.0, 260.0, 120.0, 160.0, 150.0, 50.0, 480.0, 100.0, 30.0, 80.0, 50.0, 70.0, 200.0, 250.0, 360.0, 150.0, 100.0, 40.0, 160.0, 130.0, 200.0, 50.0, 110.0, 200.0, 120.0, 70.0, 90.0, 230.0, 150.0, 80.0, 210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5271864074404902, "mean_inference_ms": 1.4143982393228902, "mean_action_processing_ms": 0.46107365011373713, "mean_env_wait_ms": 1.246069583079676, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011995792388916016, "StateBufferConnector_ms": 0.009381771087646484, "ViewRequirementAgentConnector_ms": 0.3989112377166748}, "num_episodes": 18, "episode_return_max": 2180.0, "episode_return_min": -50.0, "episode_return_mean": 1093.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.470066483917293, "num_env_steps_trained_throughput_per_sec": 21.470066483917293, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 186882.947, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186882.894, "sample_time_ms": 2755.026, "learn_time_ms": 184105.08, "learn_throughput": 21.727, "synch_weights_time_ms": 10.687}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "33e63_00000", "date": "2024-06-19_03-34-16", "timestamp": 1718782456, "time_this_iter_s": 186.3157730102539, "time_total_s": 23237.5570602417, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23237.5570602417, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 16.558555133079846, "ram_util_percent": 79.85323193916349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4371996465201575, "cur_kl_coeff": 13.151650153147054, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003346624869170883, "vf_loss": 7.312403503139687, "vf_explained_var": 0.0018948181432149153, "kl": Infinity, "entropy": 0.3578502846871829, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": -50.0, "episode_reward_mean": 1072.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 107.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 1220.0, 940.0, 1320.0, 1195.0, 1300.0, 1070.0, 1740.0, 880.0, 980.0, 1060.0, 1450.0, 1660.0, 1200.0, 560.0, 325.0, 1340.0, 300.0, 1080.0, 1310.0, 1530.0, 780.0, 860.0, 1840.0, 1005.0, 650.0, 1160.0, 1130.0, 1455.0, 1020.0, 1040.0, 995.0, 950.0, 1055.0, 1390.0, 1190.0, 620.0, 760.0, 2180.0, 1450.0, 615.0, 885.0, 1745.0, 505.0, 1420.0, 1310.0, 1575.0, 1910.0, 375.0, 1180.0, 1315.0, 740.0, 1450.0, 1080.0, 1360.0, 1440.0, 650.0, 1490.0, 435.0, 1100.0, 1390.0, 1080.0, 640.0, 1575.0, -50.0, 425.0, 1140.0, 400.0, 1520.0, 1070.0, 945.0, 920.0, 395.0, 1610.0, 1510.0, 1300.0, 670.0, 1590.0, 385.0, 920.0, 740.0, 690.0, 1150.0, 610.0, 1075.0, 1485.0, 1090.0, 1150.0, 330.0, 1445.0, 1020.0, 1250.0, 1590.0, 1220.0, 940.0, 1420.0, 1230.0, 360.0, 740.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 60.0, 100.0, 390.0, 10.0, 80.0, 40.0, 10.0, 20.0, -100.0, 110.0, 90.0, 120.0, 80.0, 80.0, -30.0, 320.0, 500.0, 50.0, 390.0, 30.0, 60.0, 90.0, 50.0, 40.0, 50.0, 110.0, 90.0, 30.0, 50.0, 40.0, 140.0, 190.0, 20.0, 10.0, 240.0, 550.0, 80.0, 0.0, 160.0, 80.0, 0.0, 35.0, 150.0, 20.0, 460.0, -140.0, 150.0, 280.0, 180.0, 110.0, 100.0, 80.0, 180.0, 40.0, 180.0, 60.0, 0.0, 370.0, 20.0, 90.0, 330.0, 160.0, -30.0, 220.0, 100.0, 40.0, 90.0, 50.0, 430.0, 360.0, 50.0, 390.0, 100.0, 100.0, 30.0, 170.0, 40.0, 70.0, 20.0, 40.0, 0.0, 20.0, 160.0, 10.0, 170.0, 200.0, 190.0, 70.0, 120.0, -30.0, 30.0, -30.0, 150.0, 90.0, 60.0, 480.0, 20.0, 90.0, 60.0, 450.0, 100.0, 40.0, 30.0, 110.0, 100.0, 50.0, 0.0, 120.0, 320.0, 70.0, 200.0, 180.0, 120.0, 150.0, 230.0, 160.0, -40.0, 60.0, 370.0, 110.0, 50.0, 90.0, 100.0, 120.0, 390.0, 140.0, 90.0, 200.0, 0.0, 50.0, 50.0, 30.0, 10.0, 80.0, 400.0, 140.0, 400.0, 40.0, 0.0, 60.0, 410.0, 70.0, 10.0, 20.0, 50.0, -40.0, -50.0, 30.0, 30.0, 20.0, 0.0, 30.0, 60.0, 0.0, 10.0, 15.0, 140.0, 20.0, 260.0, 30.0, 40.0, 80.0, 30.0, 340.0, 180.0, 160.0, 80.0, 140.0, 40.0, 20.0, 10.0, 20.0, 60.0, 50.0, 80.0, -30.0, 30.0, 20.0, 60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0, 80.0, 70.0, 20.0, 340.0, 100.0, 80.0, 320.0, 40.0, 170.0, 90.0, 130.0, 40.0, 30.0, 260.0, 310.0, 160.0, 140.0, 260.0, 100.0, 100.0, 40.0, 20.0, 30.0, 0.0, 30.0, 120.0, 0.0, 50.0, 0.0, 490.0, 10.0, 60.0, 10.0, 340.0, 200.0, 70.0, 30.0, 70.0, 50.0, 20.0, 510.0, 130.0, 140.0, 160.0, 90.0, 90.0, 280.0, 190.0, 0.0, 250.0, 270.0, 100.0, 0.0, 35.0, 40.0, 30.0, 90.0, -100.0, 160.0, 380.0, 20.0, 90.0, 0.0, 0.0, 70.0, 40.0, 160.0, 30.0, 200.0, 40.0, 90.0, 80.0, 30.0, 40.0, 240.0, 330.0, 140.0, 80.0, 110.0, 20.0, 490.0, 30.0, 70.0, 20.0, 100.0, 20.0, 150.0, 110.0, 20.0, 120.0, 80.0, 130.0, 70.0, 60.0, 380.0, 45.0, 250.0, 160.0, 170.0, 110.0, 240.0, 50.0, 70.0, 70.0, 40.0, 20.0, 80.0, 20.0, 70.0, 360.0, 140.0, 50.0, 140.0, 130.0, 130.0, 100.0, 40.0, 210.0, 50.0, 50.0, 75.0, 210.0, -20.0, 20.0, 530.0, -50.0, 220.0, -30.0, 60.0, -20.0, 0.0, 30.0, 100.0, 270.0, 20.0, 200.0, 420.0, 130.0, 40.0, -260.0, 180.0, 200.0, 260.0, 80.0, 20.0, 80.0, 20.0, 70.0, 20.0, 125.0, 50.0, 110.0, 120.0, 140.0, 320.0, 70.0, 40.0, 50.0, 60.0, 430.0, 310.0, 90.0, 20.0, 120.0, 40.0, 100.0, 100.0, 60.0, 210.0, 140.0, 60.0, 30.0, 50.0, 80.0, 140.0, 50.0, 30.0, 40.0, 100.0, 40.0, 20.0, 40.0, 40.0, 140.0, 60.0, 0.0, 10.0, 10.0, 390.0, 50.0, 240.0, 160.0, 220.0, 140.0, 80.0, 110.0, 10.0, 290.0, 760.0, 170.0, 50.0, 90.0, 60.0, 230.0, 200.0, 340.0, 130.0, 50.0, 220.0, 80.0, 20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0, 40.0, 165.0, 100.0, 70.0, 40.0, 190.0, 30.0, 60.0, 120.0, 70.0, 70.0, 340.0, 70.0, 510.0, 110.0, 280.0, 50.0, 105.0, 120.0, 90.0, 70.0, 10.0, 30.0, 25.0, 70.0, 30.0, 30.0, 50.0, 160.0, 30.0, -10.0, 410.0, 30.0, 90.0, 60.0, 110.0, 230.0, 170.0, 210.0, 120.0, 100.0, 180.0, 390.0, 70.0, 100.0, 150.0, 120.0, 60.0, 40.0, 100.0, 155.0, 450.0, 30.0, 410.0, 130.0, 30.0, 40.0, 50.0, 250.0, 30.0, 80.0, 220.0, 150.0, 170.0, -30.0, 40.0, 370.0, 130.0, 680.0, 100.0, 20.0, 30.0, 30.0, 45.0, 70.0, 50.0, 40.0, 0.0, 80.0, 10.0, 60.0, 160.0, 60.0, 80.0, 20.0, 310.0, 20.0, 100.0, 260.0, 110.0, -40.0, -5.0, 400.0, 110.0, 30.0, 250.0, 50.0, 20.0, 250.0, 250.0, 60.0, 30.0, 60.0, 20.0, 70.0, 0.0, 80.0, 160.0, 230.0, 30.0, 160.0, 50.0, -10.0, 230.0, 190.0, 130.0, 10.0, 170.0, 540.0, -20.0, 550.0, 120.0, 20.0, 170.0, 10.0, 40.0, 40.0, 40.0, 50.0, 40.0, 100.0, 190.0, 240.0, 70.0, 60.0, 210.0, 0.0, 40.0, 170.0, 280.0, 110.0, 80.0, 90.0, 320.0, 200.0, 110.0, 170.0, 190.0, 110.0, 60.0, 10.0, 60.0, -20.0, 60.0, 40.0, 0.0, 80.0, -50.0, 10.0, 460.0, 60.0, 190.0, 330.0, 20.0, 130.0, 90.0, 150.0, 250.0, -60.0, 330.0, 150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0, 10.0, 270.0, 140.0, 70.0, 10.0, 300.0, 70.0, 70.0, 80.0, 80.0, 100.0, 70.0, 170.0, 420.0, 90.0, 50.0, 210.0, 90.0, 100.0, 90.0, 350.0, 40.0, 10.0, 30.0, 160.0, 280.0, 60.0, 70.0, 10.0, 70.0, 30.0, 30.0, 110.0, 20.0, 40.0, 170.0, 0.0, 20.0, 30.0, 190.0, 190.0, 40.0, 790.0, 20.0, 40.0, -45.0, 150.0, 150.0, 120.0, 120.0, 10.0, 20.0, 40.0, 10.0, 60.0, 90.0, 40.0, -490.0, 160.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 55.0, 480.0, 60.0, 30.0, 50.0, 200.0, 130.0, 90.0, -40.0, 70.0, 70.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 40.0, 40.0, 90.0, 150.0, 170.0, 260.0, 110.0, 330.0, 60.0, 70.0, 170.0, 120.0, 60.0, 170.0, -40.0, 90.0, 170.0, 140.0, 40.0, 500.0, 90.0, 30.0, -50.0, 100.0, 245.0, 180.0, 60.0, 110.0, 80.0, 30.0, -20.0, 220.0, 10.0, 30.0, 70.0, 120.0, 260.0, 80.0, 80.0, 110.0, 0.0, -20.0, 80.0, 140.0, 35.0, 30.0, 30.0, 140.0, 15.0, -30.0, 5.0, 10.0, 0.0, 160.0, 180.0, 260.0, 120.0, 160.0, 150.0, 50.0, 480.0, 100.0, 30.0, 80.0, 50.0, 70.0, 200.0, 250.0, 360.0, 150.0, 100.0, 40.0, 160.0, 130.0, 200.0, 50.0, 110.0, 200.0, 120.0, 70.0, 90.0, 230.0, 150.0, 80.0, 210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0, 330.0, 160.0, 90.0, 310.0, 90.0, 30.0, 80.0, 170.0, 40.0, 290.0, 5.0, 10.0, -5.0, 90.0, 10.0, 170.0, 40.0, 40.0, 15.0, 10.0, 130.0, 10.0, 70.0, 60.0, 190.0, 270.0, 60.0, 50.0, 50.0, 30.0, 30.0, 30.0, 60.0, 30.0, 70.0, 240.0, 170.0, 40.0, 0.0, 70.0, 40.0, 170.0, -10.0, 10.0, 70.0, 20.0, 150.0, 80.0, 170.0, -10.0, 70.0, 60.0, 10.0, 10.0, 60.0, 110.0, 80.0, 190.0, 100.0, 460.0, 30.0, 10.0, 0.0, 180.0, 20.0, 30.0, 0.0, 20.0, 280.0, 40.0, 490.0, 30.0, 110.0, 10.0, -20.0, 90.0, 100.0, 70.0, 105.0, 90.0, 380.0, 80.0, 50.0, 190.0, 110.0, 15.0, 160.0, 380.0, 70.0, 50.0, 60.0, 170.0, 20.0, 30.0, 320.0, 140.0, 170.0, 70.0, 40.0, 70.0, 210.0, 70.0, 300.0, 50.0, 10.0, 0.0, 20.0, 410.0, 40.0, 40.0, 10.0, 30.0, 30.0, 50.0, 50.0, 30.0, 30.0, 80.0, 10.0, 10.0, 430.0, -10.0, -150.0, -10.0, 0.0, 300.0, 180.0, 10.0, 530.0, 165.0, 100.0, 180.0, 40.0, 40.0, 30.0, 0.0, 60.0, 60.0, 120.0, 390.0, 170.0, 50.0, 70.0, 110.0, 50.0, 380.0, 0.0, 120.0, 340.0, -40.0, 20.0, 180.0, 80.0, 630.0, 220.0, 230.0, 10.0, 60.0, 140.0, 20.0, 80.0, 40.0, 50.0, 20.0, 710.0, 50.0, -20.0, -80.0, 300.0, 70.0, 150.0, 30.0, 40.0, 30.0, 40.0, 5.0, 160.0, 370.0, 100.0, 15.0, 310.0, 110.0, 30.0, 120.0, 50.0, 400.0, 170.0, 60.0, 130.0, 40.0, 390.0, 110.0, 160.0, 20.0, 190.0, 150.0, 10.0, 30.0, 100.0, 70.0, 90.0, 0.0, 10.0, 70.0, 60.0, -10.0, 20.0, 110.0, -10.0, 20.0, 40.0, -30.0, 70.0, 170.0, 110.0, -20.0, 160.0, 70.0, 0.0, 170.0, 40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5272053323909074, "mean_inference_ms": 1.4144534333649341, "mean_action_processing_ms": 0.46037905088300124, "mean_env_wait_ms": 1.2459375437247653, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012129783630371094, "StateBufferConnector_ms": 0.0094757080078125, "ViewRequirementAgentConnector_ms": 0.4048647880554199}, "num_episodes": 23, "episode_return_max": 2180.0, "episode_return_min": -50.0, "episode_return_mean": 1072.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.283113912818756, "num_env_steps_trained_throughput_per_sec": 21.283113912818756, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 186714.813, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186714.759, "sample_time_ms": 2684.226, "learn_time_ms": 184008.208, "learn_throughput": 21.738, "synch_weights_time_ms": 10.075}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "33e63_00000", "date": "2024-06-19_03-37-24", "timestamp": 1718782644, "time_this_iter_s": 187.95112490653992, "time_total_s": 23425.50818514824, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3279191f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23425.50818514824, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 18.101879699248116, "ram_util_percent": 79.73796992481203}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3022642218774627, "cur_kl_coeff": 19.72747522972059, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.18850743757904, "policy_loss": -0.0021627534279442086, "vf_loss": 7.188067932606251, "vf_explained_var": 0.0025592870986499727, "kl": 0.00013191030694053457, "entropy": 0.3807147583260704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 2180.0, "episode_reward_min": -50.0, "episode_reward_mean": 1059.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 105.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1080.0, 1310.0, 1530.0, 780.0, 860.0, 1840.0, 1005.0, 650.0, 1160.0, 1130.0, 1455.0, 1020.0, 1040.0, 995.0, 950.0, 1055.0, 1390.0, 1190.0, 620.0, 760.0, 2180.0, 1450.0, 615.0, 885.0, 1745.0, 505.0, 1420.0, 1310.0, 1575.0, 1910.0, 375.0, 1180.0, 1315.0, 740.0, 1450.0, 1080.0, 1360.0, 1440.0, 650.0, 1490.0, 435.0, 1100.0, 1390.0, 1080.0, 640.0, 1575.0, -50.0, 425.0, 1140.0, 400.0, 1520.0, 1070.0, 945.0, 920.0, 395.0, 1610.0, 1510.0, 1300.0, 670.0, 1590.0, 385.0, 920.0, 740.0, 690.0, 1150.0, 610.0, 1075.0, 1485.0, 1090.0, 1150.0, 330.0, 1445.0, 1020.0, 1250.0, 1590.0, 1220.0, 940.0, 1420.0, 1230.0, 360.0, 740.0, 890.0, 1355.0, 645.0, 1210.0, 770.0, 770.0, 1370.0, 1010.0, 1180.0, 890.0, 1480.0, 675.0, 1410.0, 1250.0, 510.0, 810.0, 500.0, 1010.0, 1205.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 410.0, 80.0, 70.0, 40.0, 180.0, 50.0, 110.0, 0.0, 80.0, 80.0, 70.0, 20.0, 340.0, 100.0, 80.0, 320.0, 40.0, 170.0, 90.0, 130.0, 40.0, 30.0, 260.0, 310.0, 160.0, 140.0, 260.0, 100.0, 100.0, 40.0, 20.0, 30.0, 0.0, 30.0, 120.0, 0.0, 50.0, 0.0, 490.0, 10.0, 60.0, 10.0, 340.0, 200.0, 70.0, 30.0, 70.0, 50.0, 20.0, 510.0, 130.0, 140.0, 160.0, 90.0, 90.0, 280.0, 190.0, 0.0, 250.0, 270.0, 100.0, 0.0, 35.0, 40.0, 30.0, 90.0, -100.0, 160.0, 380.0, 20.0, 90.0, 0.0, 0.0, 70.0, 40.0, 160.0, 30.0, 200.0, 40.0, 90.0, 80.0, 30.0, 40.0, 240.0, 330.0, 140.0, 80.0, 110.0, 20.0, 490.0, 30.0, 70.0, 20.0, 100.0, 20.0, 150.0, 110.0, 20.0, 120.0, 80.0, 130.0, 70.0, 60.0, 380.0, 45.0, 250.0, 160.0, 170.0, 110.0, 240.0, 50.0, 70.0, 70.0, 40.0, 20.0, 80.0, 20.0, 70.0, 360.0, 140.0, 50.0, 140.0, 130.0, 130.0, 100.0, 40.0, 210.0, 50.0, 50.0, 75.0, 210.0, -20.0, 20.0, 530.0, -50.0, 220.0, -30.0, 60.0, -20.0, 0.0, 30.0, 100.0, 270.0, 20.0, 200.0, 420.0, 130.0, 40.0, -260.0, 180.0, 200.0, 260.0, 80.0, 20.0, 80.0, 20.0, 70.0, 20.0, 125.0, 50.0, 110.0, 120.0, 140.0, 320.0, 70.0, 40.0, 50.0, 60.0, 430.0, 310.0, 90.0, 20.0, 120.0, 40.0, 100.0, 100.0, 60.0, 210.0, 140.0, 60.0, 30.0, 50.0, 80.0, 140.0, 50.0, 30.0, 40.0, 100.0, 40.0, 20.0, 40.0, 40.0, 140.0, 60.0, 0.0, 10.0, 10.0, 390.0, 50.0, 240.0, 160.0, 220.0, 140.0, 80.0, 110.0, 10.0, 290.0, 760.0, 170.0, 50.0, 90.0, 60.0, 230.0, 200.0, 340.0, 130.0, 50.0, 220.0, 80.0, 20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0, 40.0, 165.0, 100.0, 70.0, 40.0, 190.0, 30.0, 60.0, 120.0, 70.0, 70.0, 340.0, 70.0, 510.0, 110.0, 280.0, 50.0, 105.0, 120.0, 90.0, 70.0, 10.0, 30.0, 25.0, 70.0, 30.0, 30.0, 50.0, 160.0, 30.0, -10.0, 410.0, 30.0, 90.0, 60.0, 110.0, 230.0, 170.0, 210.0, 120.0, 100.0, 180.0, 390.0, 70.0, 100.0, 150.0, 120.0, 60.0, 40.0, 100.0, 155.0, 450.0, 30.0, 410.0, 130.0, 30.0, 40.0, 50.0, 250.0, 30.0, 80.0, 220.0, 150.0, 170.0, -30.0, 40.0, 370.0, 130.0, 680.0, 100.0, 20.0, 30.0, 30.0, 45.0, 70.0, 50.0, 40.0, 0.0, 80.0, 10.0, 60.0, 160.0, 60.0, 80.0, 20.0, 310.0, 20.0, 100.0, 260.0, 110.0, -40.0, -5.0, 400.0, 110.0, 30.0, 250.0, 50.0, 20.0, 250.0, 250.0, 60.0, 30.0, 60.0, 20.0, 70.0, 0.0, 80.0, 160.0, 230.0, 30.0, 160.0, 50.0, -10.0, 230.0, 190.0, 130.0, 10.0, 170.0, 540.0, -20.0, 550.0, 120.0, 20.0, 170.0, 10.0, 40.0, 40.0, 40.0, 50.0, 40.0, 100.0, 190.0, 240.0, 70.0, 60.0, 210.0, 0.0, 40.0, 170.0, 280.0, 110.0, 80.0, 90.0, 320.0, 200.0, 110.0, 170.0, 190.0, 110.0, 60.0, 10.0, 60.0, -20.0, 60.0, 40.0, 0.0, 80.0, -50.0, 10.0, 460.0, 60.0, 190.0, 330.0, 20.0, 130.0, 90.0, 150.0, 250.0, -60.0, 330.0, 150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0, 10.0, 270.0, 140.0, 70.0, 10.0, 300.0, 70.0, 70.0, 80.0, 80.0, 100.0, 70.0, 170.0, 420.0, 90.0, 50.0, 210.0, 90.0, 100.0, 90.0, 350.0, 40.0, 10.0, 30.0, 160.0, 280.0, 60.0, 70.0, 10.0, 70.0, 30.0, 30.0, 110.0, 20.0, 40.0, 170.0, 0.0, 20.0, 30.0, 190.0, 190.0, 40.0, 790.0, 20.0, 40.0, -45.0, 150.0, 150.0, 120.0, 120.0, 10.0, 20.0, 40.0, 10.0, 60.0, 90.0, 40.0, -490.0, 160.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 55.0, 480.0, 60.0, 30.0, 50.0, 200.0, 130.0, 90.0, -40.0, 70.0, 70.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 40.0, 40.0, 90.0, 150.0, 170.0, 260.0, 110.0, 330.0, 60.0, 70.0, 170.0, 120.0, 60.0, 170.0, -40.0, 90.0, 170.0, 140.0, 40.0, 500.0, 90.0, 30.0, -50.0, 100.0, 245.0, 180.0, 60.0, 110.0, 80.0, 30.0, -20.0, 220.0, 10.0, 30.0, 70.0, 120.0, 260.0, 80.0, 80.0, 110.0, 0.0, -20.0, 80.0, 140.0, 35.0, 30.0, 30.0, 140.0, 15.0, -30.0, 5.0, 10.0, 0.0, 160.0, 180.0, 260.0, 120.0, 160.0, 150.0, 50.0, 480.0, 100.0, 30.0, 80.0, 50.0, 70.0, 200.0, 250.0, 360.0, 150.0, 100.0, 40.0, 160.0, 130.0, 200.0, 50.0, 110.0, 200.0, 120.0, 70.0, 90.0, 230.0, 150.0, 80.0, 210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0, 330.0, 160.0, 90.0, 310.0, 90.0, 30.0, 80.0, 170.0, 40.0, 290.0, 5.0, 10.0, -5.0, 90.0, 10.0, 170.0, 40.0, 40.0, 15.0, 10.0, 130.0, 10.0, 70.0, 60.0, 190.0, 270.0, 60.0, 50.0, 50.0, 30.0, 30.0, 30.0, 60.0, 30.0, 70.0, 240.0, 170.0, 40.0, 0.0, 70.0, 40.0, 170.0, -10.0, 10.0, 70.0, 20.0, 150.0, 80.0, 170.0, -10.0, 70.0, 60.0, 10.0, 10.0, 60.0, 110.0, 80.0, 190.0, 100.0, 460.0, 30.0, 10.0, 0.0, 180.0, 20.0, 30.0, 0.0, 20.0, 280.0, 40.0, 490.0, 30.0, 110.0, 10.0, -20.0, 90.0, 100.0, 70.0, 105.0, 90.0, 380.0, 80.0, 50.0, 190.0, 110.0, 15.0, 160.0, 380.0, 70.0, 50.0, 60.0, 170.0, 20.0, 30.0, 320.0, 140.0, 170.0, 70.0, 40.0, 70.0, 210.0, 70.0, 300.0, 50.0, 10.0, 0.0, 20.0, 410.0, 40.0, 40.0, 10.0, 30.0, 30.0, 50.0, 50.0, 30.0, 30.0, 80.0, 10.0, 10.0, 430.0, -10.0, -150.0, -10.0, 0.0, 300.0, 180.0, 10.0, 530.0, 165.0, 100.0, 180.0, 40.0, 40.0, 30.0, 0.0, 60.0, 60.0, 120.0, 390.0, 170.0, 50.0, 70.0, 110.0, 50.0, 380.0, 0.0, 120.0, 340.0, -40.0, 20.0, 180.0, 80.0, 630.0, 220.0, 230.0, 10.0, 60.0, 140.0, 20.0, 80.0, 40.0, 50.0, 20.0, 710.0, 50.0, -20.0, -80.0, 300.0, 70.0, 150.0, 30.0, 40.0, 30.0, 40.0, 5.0, 160.0, 370.0, 100.0, 15.0, 310.0, 110.0, 30.0, 120.0, 50.0, 400.0, 170.0, 60.0, 130.0, 40.0, 390.0, 110.0, 160.0, 20.0, 190.0, 150.0, 10.0, 30.0, 100.0, 70.0, 90.0, 0.0, 10.0, 70.0, 60.0, -10.0, 20.0, 110.0, -10.0, 20.0, 40.0, -30.0, 70.0, 170.0, 110.0, -20.0, 160.0, 70.0, 0.0, 170.0, 40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0, 120.0, 320.0, -65.0, 360.0, 90.0, -10.0, 200.0, 200.0, 60.0, 80.0, 100.0, 0.0, 20.0, 120.0, 45.0, 30.0, 100.0, 30.0, 120.0, 80.0, 40.0, 120.0, 110.0, 300.0, 210.0, 70.0, 260.0, -10.0, 110.0, 0.0, 30.0, 30.0, 20.0, 170.0, 280.0, 40.0, 30.0, 30.0, 100.0, 40.0, 60.0, 120.0, 40.0, 60.0, 60.0, 80.0, 60.0, 210.0, 30.0, 50.0, 30.0, 100.0, 250.0, 30.0, 350.0, 30.0, 330.0, 70.0, 140.0, 40.0, 80.0, 330.0, 90.0, 80.0, 70.0, 160.0, 0.0, 90.0, 30.0, 80.0, 40.0, 210.0, 210.0, 70.0, 110.0, 80.0, 300.0, 90.0, 40.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 160.0, 540.0, 40.0, 50.0, 30.0, 120.0, 40.0, 50.0, 100.0, 540.0, 80.0, 100.0, 170.0, 40.0, 240.0, 150.0, 40.0, 180.0, 130.0, 65.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 70.0, 60.0, 270.0, 310.0, 70.0, 30.0, 170.0, 310.0, 100.0, 60.0, 60.0, 270.0, 60.0, 50.0, 40.0, 390.0, 200.0, 60.0, 60.0, 190.0, 100.0, 20.0, 20.0, 40.0, 20.0, 20.0, 10.0, 70.0, 20.0, -40.0, 130.0, 30.0, 110.0, 300.0, 50.0, 70.0, 70.0, 40.0, 50.0, 0.0, 40.0, 10.0, 80.0, 90.0, 10.0, 20.0, 10.0, 30.0, 210.0, 200.0, 90.0, 170.0, 70.0, 30.0, 80.0, 50.0, 100.0, 130.0, 90.0, 45.0, 50.0, 210.0, 110.0, 30.0, 230.0, 310.0, 80.0, 50.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5273479163176356, "mean_inference_ms": 1.414412792708863, "mean_action_processing_ms": 0.4598217969226731, "mean_env_wait_ms": 1.2458271617053995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012137889862060547, "StateBufferConnector_ms": 0.009375572204589844, "ViewRequirementAgentConnector_ms": 0.3974790573120117}, "num_episodes": 18, "episode_return_max": 2180.0, "episode_return_min": -50.0, "episode_return_mean": 1059.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.383501870894037, "num_env_steps_trained_throughput_per_sec": 21.383501870894037, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 186666.537, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186666.483, "sample_time_ms": 2642.162, "learn_time_ms": 184002.123, "learn_throughput": 21.739, "synch_weights_time_ms": 9.792}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "33e63_00000", "date": "2024-06-19_03-40-31", "timestamp": 1718782831, "time_this_iter_s": 187.06776690483093, "time_total_s": 23612.57595205307, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23612.57595205307, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 16.369056603773586, "ram_util_percent": 80.00490566037736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.290384520306247, "cur_kl_coeff": 9.863737614860295, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0030394205828747764, "vf_loss": 6.694155519838912, "vf_explained_var": 0.0008519122648797731, "kl": Infinity, "entropy": 0.35800941600459324, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 1910.0, "episode_reward_min": -50.0, "episode_reward_mean": 1025.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 102.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [615.0, 885.0, 1745.0, 505.0, 1420.0, 1310.0, 1575.0, 1910.0, 375.0, 1180.0, 1315.0, 740.0, 1450.0, 1080.0, 1360.0, 1440.0, 650.0, 1490.0, 435.0, 1100.0, 1390.0, 1080.0, 640.0, 1575.0, -50.0, 425.0, 1140.0, 400.0, 1520.0, 1070.0, 945.0, 920.0, 395.0, 1610.0, 1510.0, 1300.0, 670.0, 1590.0, 385.0, 920.0, 740.0, 690.0, 1150.0, 610.0, 1075.0, 1485.0, 1090.0, 1150.0, 330.0, 1445.0, 1020.0, 1250.0, 1590.0, 1220.0, 940.0, 1420.0, 1230.0, 360.0, 740.0, 890.0, 1355.0, 645.0, 1210.0, 770.0, 770.0, 1370.0, 1010.0, 1180.0, 890.0, 1480.0, 675.0, 1410.0, 1250.0, 510.0, 810.0, 500.0, 1010.0, 1205.0, 1875.0, 900.0, 1310.0, 770.0, 410.0, 1390.0, 1410.0, 1370.0, 540.0, 540.0, 1290.0, 310.0, 840.0, 790.0, 1195.0, 1430.0, 1495.0, 130.0, 920.0, 830.0, 1000.0, 1290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 120.0, 30.0, 0.0, 50.0, 50.0, 160.0, 5.0, 30.0, 150.0, 40.0, 165.0, 100.0, 70.0, 40.0, 190.0, 30.0, 60.0, 120.0, 70.0, 70.0, 340.0, 70.0, 510.0, 110.0, 280.0, 50.0, 105.0, 120.0, 90.0, 70.0, 10.0, 30.0, 25.0, 70.0, 30.0, 30.0, 50.0, 160.0, 30.0, -10.0, 410.0, 30.0, 90.0, 60.0, 110.0, 230.0, 170.0, 210.0, 120.0, 100.0, 180.0, 390.0, 70.0, 100.0, 150.0, 120.0, 60.0, 40.0, 100.0, 155.0, 450.0, 30.0, 410.0, 130.0, 30.0, 40.0, 50.0, 250.0, 30.0, 80.0, 220.0, 150.0, 170.0, -30.0, 40.0, 370.0, 130.0, 680.0, 100.0, 20.0, 30.0, 30.0, 45.0, 70.0, 50.0, 40.0, 0.0, 80.0, 10.0, 60.0, 160.0, 60.0, 80.0, 20.0, 310.0, 20.0, 100.0, 260.0, 110.0, -40.0, -5.0, 400.0, 110.0, 30.0, 250.0, 50.0, 20.0, 250.0, 250.0, 60.0, 30.0, 60.0, 20.0, 70.0, 0.0, 80.0, 160.0, 230.0, 30.0, 160.0, 50.0, -10.0, 230.0, 190.0, 130.0, 10.0, 170.0, 540.0, -20.0, 550.0, 120.0, 20.0, 170.0, 10.0, 40.0, 40.0, 40.0, 50.0, 40.0, 100.0, 190.0, 240.0, 70.0, 60.0, 210.0, 0.0, 40.0, 170.0, 280.0, 110.0, 80.0, 90.0, 320.0, 200.0, 110.0, 170.0, 190.0, 110.0, 60.0, 10.0, 60.0, -20.0, 60.0, 40.0, 0.0, 80.0, -50.0, 10.0, 460.0, 60.0, 190.0, 330.0, 20.0, 130.0, 90.0, 150.0, 250.0, -60.0, 330.0, 150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0, 10.0, 270.0, 140.0, 70.0, 10.0, 300.0, 70.0, 70.0, 80.0, 80.0, 100.0, 70.0, 170.0, 420.0, 90.0, 50.0, 210.0, 90.0, 100.0, 90.0, 350.0, 40.0, 10.0, 30.0, 160.0, 280.0, 60.0, 70.0, 10.0, 70.0, 30.0, 30.0, 110.0, 20.0, 40.0, 170.0, 0.0, 20.0, 30.0, 190.0, 190.0, 40.0, 790.0, 20.0, 40.0, -45.0, 150.0, 150.0, 120.0, 120.0, 10.0, 20.0, 40.0, 10.0, 60.0, 90.0, 40.0, -490.0, 160.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 55.0, 480.0, 60.0, 30.0, 50.0, 200.0, 130.0, 90.0, -40.0, 70.0, 70.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 40.0, 40.0, 90.0, 150.0, 170.0, 260.0, 110.0, 330.0, 60.0, 70.0, 170.0, 120.0, 60.0, 170.0, -40.0, 90.0, 170.0, 140.0, 40.0, 500.0, 90.0, 30.0, -50.0, 100.0, 245.0, 180.0, 60.0, 110.0, 80.0, 30.0, -20.0, 220.0, 10.0, 30.0, 70.0, 120.0, 260.0, 80.0, 80.0, 110.0, 0.0, -20.0, 80.0, 140.0, 35.0, 30.0, 30.0, 140.0, 15.0, -30.0, 5.0, 10.0, 0.0, 160.0, 180.0, 260.0, 120.0, 160.0, 150.0, 50.0, 480.0, 100.0, 30.0, 80.0, 50.0, 70.0, 200.0, 250.0, 360.0, 150.0, 100.0, 40.0, 160.0, 130.0, 200.0, 50.0, 110.0, 200.0, 120.0, 70.0, 90.0, 230.0, 150.0, 80.0, 210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0, 330.0, 160.0, 90.0, 310.0, 90.0, 30.0, 80.0, 170.0, 40.0, 290.0, 5.0, 10.0, -5.0, 90.0, 10.0, 170.0, 40.0, 40.0, 15.0, 10.0, 130.0, 10.0, 70.0, 60.0, 190.0, 270.0, 60.0, 50.0, 50.0, 30.0, 30.0, 30.0, 60.0, 30.0, 70.0, 240.0, 170.0, 40.0, 0.0, 70.0, 40.0, 170.0, -10.0, 10.0, 70.0, 20.0, 150.0, 80.0, 170.0, -10.0, 70.0, 60.0, 10.0, 10.0, 60.0, 110.0, 80.0, 190.0, 100.0, 460.0, 30.0, 10.0, 0.0, 180.0, 20.0, 30.0, 0.0, 20.0, 280.0, 40.0, 490.0, 30.0, 110.0, 10.0, -20.0, 90.0, 100.0, 70.0, 105.0, 90.0, 380.0, 80.0, 50.0, 190.0, 110.0, 15.0, 160.0, 380.0, 70.0, 50.0, 60.0, 170.0, 20.0, 30.0, 320.0, 140.0, 170.0, 70.0, 40.0, 70.0, 210.0, 70.0, 300.0, 50.0, 10.0, 0.0, 20.0, 410.0, 40.0, 40.0, 10.0, 30.0, 30.0, 50.0, 50.0, 30.0, 30.0, 80.0, 10.0, 10.0, 430.0, -10.0, -150.0, -10.0, 0.0, 300.0, 180.0, 10.0, 530.0, 165.0, 100.0, 180.0, 40.0, 40.0, 30.0, 0.0, 60.0, 60.0, 120.0, 390.0, 170.0, 50.0, 70.0, 110.0, 50.0, 380.0, 0.0, 120.0, 340.0, -40.0, 20.0, 180.0, 80.0, 630.0, 220.0, 230.0, 10.0, 60.0, 140.0, 20.0, 80.0, 40.0, 50.0, 20.0, 710.0, 50.0, -20.0, -80.0, 300.0, 70.0, 150.0, 30.0, 40.0, 30.0, 40.0, 5.0, 160.0, 370.0, 100.0, 15.0, 310.0, 110.0, 30.0, 120.0, 50.0, 400.0, 170.0, 60.0, 130.0, 40.0, 390.0, 110.0, 160.0, 20.0, 190.0, 150.0, 10.0, 30.0, 100.0, 70.0, 90.0, 0.0, 10.0, 70.0, 60.0, -10.0, 20.0, 110.0, -10.0, 20.0, 40.0, -30.0, 70.0, 170.0, 110.0, -20.0, 160.0, 70.0, 0.0, 170.0, 40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0, 120.0, 320.0, -65.0, 360.0, 90.0, -10.0, 200.0, 200.0, 60.0, 80.0, 100.0, 0.0, 20.0, 120.0, 45.0, 30.0, 100.0, 30.0, 120.0, 80.0, 40.0, 120.0, 110.0, 300.0, 210.0, 70.0, 260.0, -10.0, 110.0, 0.0, 30.0, 30.0, 20.0, 170.0, 280.0, 40.0, 30.0, 30.0, 100.0, 40.0, 60.0, 120.0, 40.0, 60.0, 60.0, 80.0, 60.0, 210.0, 30.0, 50.0, 30.0, 100.0, 250.0, 30.0, 350.0, 30.0, 330.0, 70.0, 140.0, 40.0, 80.0, 330.0, 90.0, 80.0, 70.0, 160.0, 0.0, 90.0, 30.0, 80.0, 40.0, 210.0, 210.0, 70.0, 110.0, 80.0, 300.0, 90.0, 40.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 160.0, 540.0, 40.0, 50.0, 30.0, 120.0, 40.0, 50.0, 100.0, 540.0, 80.0, 100.0, 170.0, 40.0, 240.0, 150.0, 40.0, 180.0, 130.0, 65.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 70.0, 60.0, 270.0, 310.0, 70.0, 30.0, 170.0, 310.0, 100.0, 60.0, 60.0, 270.0, 60.0, 50.0, 40.0, 390.0, 200.0, 60.0, 60.0, 190.0, 100.0, 20.0, 20.0, 40.0, 20.0, 20.0, 10.0, 70.0, 20.0, -40.0, 130.0, 30.0, 110.0, 300.0, 50.0, 70.0, 70.0, 40.0, 50.0, 0.0, 40.0, 10.0, 80.0, 90.0, 10.0, 20.0, 10.0, 30.0, 210.0, 200.0, 90.0, 170.0, 70.0, 30.0, 80.0, 50.0, 100.0, 130.0, 90.0, 45.0, 50.0, 210.0, 110.0, 30.0, 230.0, 310.0, 80.0, 50.0, 90.0, 200.0, 30.0, 150.0, 160.0, 95.0, 110.0, 180.0, 250.0, 640.0, 60.0, 0.0, 50.0, 40.0, 200.0, 30.0, 40.0, 310.0, 110.0, 90.0, 30.0, 140.0, 70.0, -50.0, 470.0, 60.0, 380.0, 140.0, 60.0, -30.0, 70.0, 370.0, 60.0, 80.0, 20.0, 0.0, 70.0, 60.0, 30.0, 40.0, 40.0, 0.0, 60.0, 10.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 280.0, 190.0, 190.0, 20.0, 10.0, 260.0, 50.0, 130.0, 120.0, 30.0, 390.0, 60.0, 40.0, 130.0, 150.0, 200.0, 70.0, 80.0, 360.0, 120.0, 200.0, 630.0, 150.0, 20.0, 60.0, 60.0, 60.0, 115.0, 210.0, 65.0, 0.0, 0.0, 0.0, 60.0, 20.0, 40.0, 30.0, 150.0, 180.0, 20.0, 40.0, 30.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 20.0, 50.0, 150.0, 70.0, 100.0, 150.0, 120.0, 160.0, 120.0, 30.0, 90.0, 330.0, 120.0, 30.0, -5.0, 90.0, 30.0, 80.0, 20.0, 5.0, 0.0, 30.0, 30.0, -10.0, 70.0, 90.0, 30.0, 35.0, 120.0, 300.0, -5.0, 170.0, 40.0, 120.0, 190.0, 10.0, 40.0, 100.0, 10.0, 10.0, 40.0, 170.0, 100.0, 40.0, 100.0, 140.0, 50.0, 200.0, 120.0, 70.0, 220.0, 65.0, 190.0, 160.0, 90.0, 80.0, 270.0, 530.0, 60.0, 150.0, 30.0, 50.0, 10.0, 200.0, 45.0, 130.0, 110.0, 340.0, 160.0, 90.0, 70.0, 120.0, 230.0, 10.0, 10.0, 40.0, 10.0, -5.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 290.0, -40.0, 30.0, 20.0, 320.0, 30.0, 0.0, 10.0, 90.0, 5.0, 140.0, 260.0, 10.0, 10.0, 30.0, -35.0, 40.0, 350.0, 20.0, 60.0, 80.0, 200.0, 210.0, 30.0, 10.0, 30.0, 130.0, 130.0, 120.0, 290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5277185910088205, "mean_inference_ms": 1.414575467867924, "mean_action_processing_ms": 0.45917248483916195, "mean_env_wait_ms": 1.2457773527431206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012737274169921875, "StateBufferConnector_ms": 0.009577274322509766, "ViewRequirementAgentConnector_ms": 0.39821553230285645}, "num_episodes": 22, "episode_return_max": 1910.0, "episode_return_min": -50.0, "episode_return_mean": 1025.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.4022118238433, "num_env_steps_trained_throughput_per_sec": 21.4022118238433, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 186800.912, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186800.858, "sample_time_ms": 2677.571, "learn_time_ms": 184099.808, "learn_throughput": 21.727, "synch_weights_time_ms": 9.998}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "33e63_00000", "date": "2024-06-19_03-43-38", "timestamp": 1718783018, "time_this_iter_s": 186.90331602096558, "time_total_s": 23799.479268074036, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23799.479268074036, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 16.875757575757575, "ram_util_percent": 78.90492424242423}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.461275458919862, "cur_kl_coeff": 14.795606422290435, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0029674515281124508, "vf_loss": 6.690267339682046, "vf_explained_var": 0.00032799118243086455, "kl": Infinity, "entropy": 0.39416305031766274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 1875.0, "episode_reward_min": -50.0, "episode_reward_mean": 983.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -490.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 98.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [435.0, 1100.0, 1390.0, 1080.0, 640.0, 1575.0, -50.0, 425.0, 1140.0, 400.0, 1520.0, 1070.0, 945.0, 920.0, 395.0, 1610.0, 1510.0, 1300.0, 670.0, 1590.0, 385.0, 920.0, 740.0, 690.0, 1150.0, 610.0, 1075.0, 1485.0, 1090.0, 1150.0, 330.0, 1445.0, 1020.0, 1250.0, 1590.0, 1220.0, 940.0, 1420.0, 1230.0, 360.0, 740.0, 890.0, 1355.0, 645.0, 1210.0, 770.0, 770.0, 1370.0, 1010.0, 1180.0, 890.0, 1480.0, 675.0, 1410.0, 1250.0, 510.0, 810.0, 500.0, 1010.0, 1205.0, 1875.0, 900.0, 1310.0, 770.0, 410.0, 1390.0, 1410.0, 1370.0, 540.0, 540.0, 1290.0, 310.0, 840.0, 790.0, 1195.0, 1430.0, 1495.0, 130.0, 920.0, 830.0, 1000.0, 1290.0, 670.0, 220.0, 850.0, 145.0, 1005.0, 1020.0, 290.0, 650.0, 1200.0, 1810.0, 1220.0, 1590.0, 1170.0, 1180.0, 845.0, 1790.0, 780.0, 460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 10.0, 0.0, 20.0, 0.0, 30.0, 90.0, 40.0, 60.0, 35.0, 10.0, 270.0, 140.0, 70.0, 10.0, 300.0, 70.0, 70.0, 80.0, 80.0, 100.0, 70.0, 170.0, 420.0, 90.0, 50.0, 210.0, 90.0, 100.0, 90.0, 350.0, 40.0, 10.0, 30.0, 160.0, 280.0, 60.0, 70.0, 10.0, 70.0, 30.0, 30.0, 110.0, 20.0, 40.0, 170.0, 0.0, 20.0, 30.0, 190.0, 190.0, 40.0, 790.0, 20.0, 40.0, -45.0, 150.0, 150.0, 120.0, 120.0, 10.0, 20.0, 40.0, 10.0, 60.0, 90.0, 40.0, -490.0, 160.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 160.0, 10.0, 0.0, 150.0, 55.0, 480.0, 60.0, 30.0, 50.0, 200.0, 130.0, 90.0, -40.0, 70.0, 70.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 40.0, 40.0, 90.0, 150.0, 170.0, 260.0, 110.0, 330.0, 60.0, 70.0, 170.0, 120.0, 60.0, 170.0, -40.0, 90.0, 170.0, 140.0, 40.0, 500.0, 90.0, 30.0, -50.0, 100.0, 245.0, 180.0, 60.0, 110.0, 80.0, 30.0, -20.0, 220.0, 10.0, 30.0, 70.0, 120.0, 260.0, 80.0, 80.0, 110.0, 0.0, -20.0, 80.0, 140.0, 35.0, 30.0, 30.0, 140.0, 15.0, -30.0, 5.0, 10.0, 0.0, 160.0, 180.0, 260.0, 120.0, 160.0, 150.0, 50.0, 480.0, 100.0, 30.0, 80.0, 50.0, 70.0, 200.0, 250.0, 360.0, 150.0, 100.0, 40.0, 160.0, 130.0, 200.0, 50.0, 110.0, 200.0, 120.0, 70.0, 90.0, 230.0, 150.0, 80.0, 210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0, 330.0, 160.0, 90.0, 310.0, 90.0, 30.0, 80.0, 170.0, 40.0, 290.0, 5.0, 10.0, -5.0, 90.0, 10.0, 170.0, 40.0, 40.0, 15.0, 10.0, 130.0, 10.0, 70.0, 60.0, 190.0, 270.0, 60.0, 50.0, 50.0, 30.0, 30.0, 30.0, 60.0, 30.0, 70.0, 240.0, 170.0, 40.0, 0.0, 70.0, 40.0, 170.0, -10.0, 10.0, 70.0, 20.0, 150.0, 80.0, 170.0, -10.0, 70.0, 60.0, 10.0, 10.0, 60.0, 110.0, 80.0, 190.0, 100.0, 460.0, 30.0, 10.0, 0.0, 180.0, 20.0, 30.0, 0.0, 20.0, 280.0, 40.0, 490.0, 30.0, 110.0, 10.0, -20.0, 90.0, 100.0, 70.0, 105.0, 90.0, 380.0, 80.0, 50.0, 190.0, 110.0, 15.0, 160.0, 380.0, 70.0, 50.0, 60.0, 170.0, 20.0, 30.0, 320.0, 140.0, 170.0, 70.0, 40.0, 70.0, 210.0, 70.0, 300.0, 50.0, 10.0, 0.0, 20.0, 410.0, 40.0, 40.0, 10.0, 30.0, 30.0, 50.0, 50.0, 30.0, 30.0, 80.0, 10.0, 10.0, 430.0, -10.0, -150.0, -10.0, 0.0, 300.0, 180.0, 10.0, 530.0, 165.0, 100.0, 180.0, 40.0, 40.0, 30.0, 0.0, 60.0, 60.0, 120.0, 390.0, 170.0, 50.0, 70.0, 110.0, 50.0, 380.0, 0.0, 120.0, 340.0, -40.0, 20.0, 180.0, 80.0, 630.0, 220.0, 230.0, 10.0, 60.0, 140.0, 20.0, 80.0, 40.0, 50.0, 20.0, 710.0, 50.0, -20.0, -80.0, 300.0, 70.0, 150.0, 30.0, 40.0, 30.0, 40.0, 5.0, 160.0, 370.0, 100.0, 15.0, 310.0, 110.0, 30.0, 120.0, 50.0, 400.0, 170.0, 60.0, 130.0, 40.0, 390.0, 110.0, 160.0, 20.0, 190.0, 150.0, 10.0, 30.0, 100.0, 70.0, 90.0, 0.0, 10.0, 70.0, 60.0, -10.0, 20.0, 110.0, -10.0, 20.0, 40.0, -30.0, 70.0, 170.0, 110.0, -20.0, 160.0, 70.0, 0.0, 170.0, 40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0, 120.0, 320.0, -65.0, 360.0, 90.0, -10.0, 200.0, 200.0, 60.0, 80.0, 100.0, 0.0, 20.0, 120.0, 45.0, 30.0, 100.0, 30.0, 120.0, 80.0, 40.0, 120.0, 110.0, 300.0, 210.0, 70.0, 260.0, -10.0, 110.0, 0.0, 30.0, 30.0, 20.0, 170.0, 280.0, 40.0, 30.0, 30.0, 100.0, 40.0, 60.0, 120.0, 40.0, 60.0, 60.0, 80.0, 60.0, 210.0, 30.0, 50.0, 30.0, 100.0, 250.0, 30.0, 350.0, 30.0, 330.0, 70.0, 140.0, 40.0, 80.0, 330.0, 90.0, 80.0, 70.0, 160.0, 0.0, 90.0, 30.0, 80.0, 40.0, 210.0, 210.0, 70.0, 110.0, 80.0, 300.0, 90.0, 40.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 160.0, 540.0, 40.0, 50.0, 30.0, 120.0, 40.0, 50.0, 100.0, 540.0, 80.0, 100.0, 170.0, 40.0, 240.0, 150.0, 40.0, 180.0, 130.0, 65.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 70.0, 60.0, 270.0, 310.0, 70.0, 30.0, 170.0, 310.0, 100.0, 60.0, 60.0, 270.0, 60.0, 50.0, 40.0, 390.0, 200.0, 60.0, 60.0, 190.0, 100.0, 20.0, 20.0, 40.0, 20.0, 20.0, 10.0, 70.0, 20.0, -40.0, 130.0, 30.0, 110.0, 300.0, 50.0, 70.0, 70.0, 40.0, 50.0, 0.0, 40.0, 10.0, 80.0, 90.0, 10.0, 20.0, 10.0, 30.0, 210.0, 200.0, 90.0, 170.0, 70.0, 30.0, 80.0, 50.0, 100.0, 130.0, 90.0, 45.0, 50.0, 210.0, 110.0, 30.0, 230.0, 310.0, 80.0, 50.0, 90.0, 200.0, 30.0, 150.0, 160.0, 95.0, 110.0, 180.0, 250.0, 640.0, 60.0, 0.0, 50.0, 40.0, 200.0, 30.0, 40.0, 310.0, 110.0, 90.0, 30.0, 140.0, 70.0, -50.0, 470.0, 60.0, 380.0, 140.0, 60.0, -30.0, 70.0, 370.0, 60.0, 80.0, 20.0, 0.0, 70.0, 60.0, 30.0, 40.0, 40.0, 0.0, 60.0, 10.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 280.0, 190.0, 190.0, 20.0, 10.0, 260.0, 50.0, 130.0, 120.0, 30.0, 390.0, 60.0, 40.0, 130.0, 150.0, 200.0, 70.0, 80.0, 360.0, 120.0, 200.0, 630.0, 150.0, 20.0, 60.0, 60.0, 60.0, 115.0, 210.0, 65.0, 0.0, 0.0, 0.0, 60.0, 20.0, 40.0, 30.0, 150.0, 180.0, 20.0, 40.0, 30.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 20.0, 50.0, 150.0, 70.0, 100.0, 150.0, 120.0, 160.0, 120.0, 30.0, 90.0, 330.0, 120.0, 30.0, -5.0, 90.0, 30.0, 80.0, 20.0, 5.0, 0.0, 30.0, 30.0, -10.0, 70.0, 90.0, 30.0, 35.0, 120.0, 300.0, -5.0, 170.0, 40.0, 120.0, 190.0, 10.0, 40.0, 100.0, 10.0, 10.0, 40.0, 170.0, 100.0, 40.0, 100.0, 140.0, 50.0, 200.0, 120.0, 70.0, 220.0, 65.0, 190.0, 160.0, 90.0, 80.0, 270.0, 530.0, 60.0, 150.0, 30.0, 50.0, 10.0, 200.0, 45.0, 130.0, 110.0, 340.0, 160.0, 90.0, 70.0, 120.0, 230.0, 10.0, 10.0, 40.0, 10.0, -5.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 290.0, -40.0, 30.0, 20.0, 320.0, 30.0, 0.0, 10.0, 90.0, 5.0, 140.0, 260.0, 10.0, 10.0, 30.0, -35.0, 40.0, 350.0, 20.0, 60.0, 80.0, 200.0, 210.0, 30.0, 10.0, 30.0, 130.0, 130.0, 120.0, 290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0, 10.0, 0.0, 70.0, 20.0, 150.0, 70.0, 80.0, 40.0, 180.0, 50.0, 10.0, 0.0, 20.0, 50.0, 60.0, 20.0, 10.0, 30.0, 10.0, 10.0, 70.0, 220.0, 60.0, 80.0, 40.0, 30.0, 80.0, 30.0, 60.0, 180.0, 15.0, 5.0, 30.0, 30.0, 20.0, 20.0, 0.0, 15.0, 10.0, 0.0, 130.0, 70.0, 350.0, 30.0, 20.0, 20.0, 70.0, 200.0, 45.0, 70.0, 80.0, 360.0, 10.0, 200.0, 0.0, 60.0, 10.0, 50.0, 170.0, 80.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 30.0, -10.0, 30.0, 30.0, 70.0, 70.0, 130.0, 0.0, 140.0, 90.0, 20.0, 90.0, 40.0, 0.0, 130.0, 130.0, 360.0, 10.0, 240.0, 30.0, 50.0, 100.0, 70.0, 80.0, 420.0, 210.0, 110.0, 300.0, 180.0, 55.0, 90.0, 280.0, 35.0, 130.0, 110.0, 250.0, 170.0, 140.0, 100.0, 200.0, -10.0, 120.0, 60.0, 80.0, 0.0, 150.0, 170.0, 540.0, 40.0, 70.0, 50.0, 50.0, 410.0, 110.0, 240.0, 130.0, 160.0, 90.0, 140.0, 60.0, 160.0, 90.0, 70.0, 30.0, 180.0, 40.0, 260.0, 250.0, 90.0, 40.0, 140.0, 80.0, 60.0, 40.0, 35.0, 30.0, 150.0, 20.0, 130.0, 130.0, 50.0, 260.0, 0.0, 40.0, 10.0, 230.0, 360.0, 70.0, 400.0, 120.0, 50.0, 300.0, 50.0, 200.0, -40.0, 20.0, 30.0, 280.0, 180.0, 0.0, 270.0, 0.0, 10.0, 30.0, 60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5280381857988823, "mean_inference_ms": 1.4149629313304783, "mean_action_processing_ms": 0.4587046950804234, "mean_env_wait_ms": 1.2458346702800212, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012631893157958984, "StateBufferConnector_ms": 0.00952911376953125, "ViewRequirementAgentConnector_ms": 0.390958309173584}, "num_episodes": 18, "episode_return_max": 1875.0, "episode_return_min": -50.0, "episode_return_mean": 983.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.394232050557118, "num_env_steps_trained_throughput_per_sec": 21.394232050557118, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 186940.676, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186940.623, "sample_time_ms": 2683.945, "learn_time_ms": 184232.936, "learn_throughput": 21.712, "synch_weights_time_ms": 10.0}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "33e63_00000", "date": "2024-06-19_03-46-45", "timestamp": 1718783205, "time_this_iter_s": 186.97258806228638, "time_total_s": 23986.451856136322, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 23986.451856136322, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 16.626893939393938, "ram_util_percent": 80.19507575757575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.303528373786055, "cur_kl_coeff": 22.193409633435657, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.2321178176786445, "policy_loss": -0.0022378636169752167, "vf_loss": 7.2316974825752425, "vf_explained_var": 0.000335463211813166, "kl": 0.00011977384677107144, "entropy": 0.3869450424695675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 1875.0, "episode_reward_min": 130.0, "episode_reward_mean": 1001.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 710.0}, "policy_reward_mean": {"policy_0": 100.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [670.0, 1590.0, 385.0, 920.0, 740.0, 690.0, 1150.0, 610.0, 1075.0, 1485.0, 1090.0, 1150.0, 330.0, 1445.0, 1020.0, 1250.0, 1590.0, 1220.0, 940.0, 1420.0, 1230.0, 360.0, 740.0, 890.0, 1355.0, 645.0, 1210.0, 770.0, 770.0, 1370.0, 1010.0, 1180.0, 890.0, 1480.0, 675.0, 1410.0, 1250.0, 510.0, 810.0, 500.0, 1010.0, 1205.0, 1875.0, 900.0, 1310.0, 770.0, 410.0, 1390.0, 1410.0, 1370.0, 540.0, 540.0, 1290.0, 310.0, 840.0, 790.0, 1195.0, 1430.0, 1495.0, 130.0, 920.0, 830.0, 1000.0, 1290.0, 670.0, 220.0, 850.0, 145.0, 1005.0, 1020.0, 290.0, 650.0, 1200.0, 1810.0, 1220.0, 1590.0, 1170.0, 1180.0, 845.0, 1790.0, 780.0, 460.0, 1015.0, 130.0, 1330.0, 1145.0, 1490.0, 555.0, 1390.0, 1870.0, 1210.0, 980.0, 1390.0, 1000.0, 940.0, 1090.0, 840.0, 780.0, 825.0, 1155.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 160.0, 110.0, 40.0, 10.0, 40.0, 0.0, 0.0, 20.0, 80.0, 330.0, 160.0, 90.0, 310.0, 90.0, 30.0, 80.0, 170.0, 40.0, 290.0, 5.0, 10.0, -5.0, 90.0, 10.0, 170.0, 40.0, 40.0, 15.0, 10.0, 130.0, 10.0, 70.0, 60.0, 190.0, 270.0, 60.0, 50.0, 50.0, 30.0, 30.0, 30.0, 60.0, 30.0, 70.0, 240.0, 170.0, 40.0, 0.0, 70.0, 40.0, 170.0, -10.0, 10.0, 70.0, 20.0, 150.0, 80.0, 170.0, -10.0, 70.0, 60.0, 10.0, 10.0, 60.0, 110.0, 80.0, 190.0, 100.0, 460.0, 30.0, 10.0, 0.0, 180.0, 20.0, 30.0, 0.0, 20.0, 280.0, 40.0, 490.0, 30.0, 110.0, 10.0, -20.0, 90.0, 100.0, 70.0, 105.0, 90.0, 380.0, 80.0, 50.0, 190.0, 110.0, 15.0, 160.0, 380.0, 70.0, 50.0, 60.0, 170.0, 20.0, 30.0, 320.0, 140.0, 170.0, 70.0, 40.0, 70.0, 210.0, 70.0, 300.0, 50.0, 10.0, 0.0, 20.0, 410.0, 40.0, 40.0, 10.0, 30.0, 30.0, 50.0, 50.0, 30.0, 30.0, 80.0, 10.0, 10.0, 430.0, -10.0, -150.0, -10.0, 0.0, 300.0, 180.0, 10.0, 530.0, 165.0, 100.0, 180.0, 40.0, 40.0, 30.0, 0.0, 60.0, 60.0, 120.0, 390.0, 170.0, 50.0, 70.0, 110.0, 50.0, 380.0, 0.0, 120.0, 340.0, -40.0, 20.0, 180.0, 80.0, 630.0, 220.0, 230.0, 10.0, 60.0, 140.0, 20.0, 80.0, 40.0, 50.0, 20.0, 710.0, 50.0, -20.0, -80.0, 300.0, 70.0, 150.0, 30.0, 40.0, 30.0, 40.0, 5.0, 160.0, 370.0, 100.0, 15.0, 310.0, 110.0, 30.0, 120.0, 50.0, 400.0, 170.0, 60.0, 130.0, 40.0, 390.0, 110.0, 160.0, 20.0, 190.0, 150.0, 10.0, 30.0, 100.0, 70.0, 90.0, 0.0, 10.0, 70.0, 60.0, -10.0, 20.0, 110.0, -10.0, 20.0, 40.0, -30.0, 70.0, 170.0, 110.0, -20.0, 160.0, 70.0, 0.0, 170.0, 40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0, 120.0, 320.0, -65.0, 360.0, 90.0, -10.0, 200.0, 200.0, 60.0, 80.0, 100.0, 0.0, 20.0, 120.0, 45.0, 30.0, 100.0, 30.0, 120.0, 80.0, 40.0, 120.0, 110.0, 300.0, 210.0, 70.0, 260.0, -10.0, 110.0, 0.0, 30.0, 30.0, 20.0, 170.0, 280.0, 40.0, 30.0, 30.0, 100.0, 40.0, 60.0, 120.0, 40.0, 60.0, 60.0, 80.0, 60.0, 210.0, 30.0, 50.0, 30.0, 100.0, 250.0, 30.0, 350.0, 30.0, 330.0, 70.0, 140.0, 40.0, 80.0, 330.0, 90.0, 80.0, 70.0, 160.0, 0.0, 90.0, 30.0, 80.0, 40.0, 210.0, 210.0, 70.0, 110.0, 80.0, 300.0, 90.0, 40.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 160.0, 540.0, 40.0, 50.0, 30.0, 120.0, 40.0, 50.0, 100.0, 540.0, 80.0, 100.0, 170.0, 40.0, 240.0, 150.0, 40.0, 180.0, 130.0, 65.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 70.0, 60.0, 270.0, 310.0, 70.0, 30.0, 170.0, 310.0, 100.0, 60.0, 60.0, 270.0, 60.0, 50.0, 40.0, 390.0, 200.0, 60.0, 60.0, 190.0, 100.0, 20.0, 20.0, 40.0, 20.0, 20.0, 10.0, 70.0, 20.0, -40.0, 130.0, 30.0, 110.0, 300.0, 50.0, 70.0, 70.0, 40.0, 50.0, 0.0, 40.0, 10.0, 80.0, 90.0, 10.0, 20.0, 10.0, 30.0, 210.0, 200.0, 90.0, 170.0, 70.0, 30.0, 80.0, 50.0, 100.0, 130.0, 90.0, 45.0, 50.0, 210.0, 110.0, 30.0, 230.0, 310.0, 80.0, 50.0, 90.0, 200.0, 30.0, 150.0, 160.0, 95.0, 110.0, 180.0, 250.0, 640.0, 60.0, 0.0, 50.0, 40.0, 200.0, 30.0, 40.0, 310.0, 110.0, 90.0, 30.0, 140.0, 70.0, -50.0, 470.0, 60.0, 380.0, 140.0, 60.0, -30.0, 70.0, 370.0, 60.0, 80.0, 20.0, 0.0, 70.0, 60.0, 30.0, 40.0, 40.0, 0.0, 60.0, 10.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 280.0, 190.0, 190.0, 20.0, 10.0, 260.0, 50.0, 130.0, 120.0, 30.0, 390.0, 60.0, 40.0, 130.0, 150.0, 200.0, 70.0, 80.0, 360.0, 120.0, 200.0, 630.0, 150.0, 20.0, 60.0, 60.0, 60.0, 115.0, 210.0, 65.0, 0.0, 0.0, 0.0, 60.0, 20.0, 40.0, 30.0, 150.0, 180.0, 20.0, 40.0, 30.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 20.0, 50.0, 150.0, 70.0, 100.0, 150.0, 120.0, 160.0, 120.0, 30.0, 90.0, 330.0, 120.0, 30.0, -5.0, 90.0, 30.0, 80.0, 20.0, 5.0, 0.0, 30.0, 30.0, -10.0, 70.0, 90.0, 30.0, 35.0, 120.0, 300.0, -5.0, 170.0, 40.0, 120.0, 190.0, 10.0, 40.0, 100.0, 10.0, 10.0, 40.0, 170.0, 100.0, 40.0, 100.0, 140.0, 50.0, 200.0, 120.0, 70.0, 220.0, 65.0, 190.0, 160.0, 90.0, 80.0, 270.0, 530.0, 60.0, 150.0, 30.0, 50.0, 10.0, 200.0, 45.0, 130.0, 110.0, 340.0, 160.0, 90.0, 70.0, 120.0, 230.0, 10.0, 10.0, 40.0, 10.0, -5.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 290.0, -40.0, 30.0, 20.0, 320.0, 30.0, 0.0, 10.0, 90.0, 5.0, 140.0, 260.0, 10.0, 10.0, 30.0, -35.0, 40.0, 350.0, 20.0, 60.0, 80.0, 200.0, 210.0, 30.0, 10.0, 30.0, 130.0, 130.0, 120.0, 290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0, 10.0, 0.0, 70.0, 20.0, 150.0, 70.0, 80.0, 40.0, 180.0, 50.0, 10.0, 0.0, 20.0, 50.0, 60.0, 20.0, 10.0, 30.0, 10.0, 10.0, 70.0, 220.0, 60.0, 80.0, 40.0, 30.0, 80.0, 30.0, 60.0, 180.0, 15.0, 5.0, 30.0, 30.0, 20.0, 20.0, 0.0, 15.0, 10.0, 0.0, 130.0, 70.0, 350.0, 30.0, 20.0, 20.0, 70.0, 200.0, 45.0, 70.0, 80.0, 360.0, 10.0, 200.0, 0.0, 60.0, 10.0, 50.0, 170.0, 80.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 30.0, -10.0, 30.0, 30.0, 70.0, 70.0, 130.0, 0.0, 140.0, 90.0, 20.0, 90.0, 40.0, 0.0, 130.0, 130.0, 360.0, 10.0, 240.0, 30.0, 50.0, 100.0, 70.0, 80.0, 420.0, 210.0, 110.0, 300.0, 180.0, 55.0, 90.0, 280.0, 35.0, 130.0, 110.0, 250.0, 170.0, 140.0, 100.0, 200.0, -10.0, 120.0, 60.0, 80.0, 0.0, 150.0, 170.0, 540.0, 40.0, 70.0, 50.0, 50.0, 410.0, 110.0, 240.0, 130.0, 160.0, 90.0, 140.0, 60.0, 160.0, 90.0, 70.0, 30.0, 180.0, 40.0, 260.0, 250.0, 90.0, 40.0, 140.0, 80.0, 60.0, 40.0, 35.0, 30.0, 150.0, 20.0, 130.0, 130.0, 50.0, 260.0, 0.0, 40.0, 10.0, 230.0, 360.0, 70.0, 400.0, 120.0, 50.0, 300.0, 50.0, 200.0, -40.0, 20.0, 30.0, 280.0, 180.0, 0.0, 270.0, 0.0, 10.0, 30.0, 60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0, 270.0, 30.0, 35.0, 80.0, 100.0, 80.0, 70.0, 230.0, 60.0, 60.0, -230.0, 70.0, 30.0, 70.0, -50.0, 20.0, 30.0, 60.0, 60.0, 70.0, 470.0, 110.0, 0.0, 120.0, 40.0, -40.0, 200.0, 150.0, 10.0, 270.0, 210.0, 160.0, 5.0, 70.0, 50.0, 200.0, 40.0, 270.0, 60.0, 80.0, 20.0, 110.0, 120.0, 300.0, 120.0, 240.0, 10.0, 280.0, 210.0, 80.0, 55.0, 170.0, 0.0, 30.0, 50.0, 0.0, 30.0, 110.0, 30.0, 80.0, 360.0, 80.0, 120.0, 110.0, 20.0, 20.0, 90.0, 110.0, 130.0, 350.0, 340.0, -20.0, 110.0, 130.0, 180.0, 230.0, 360.0, 40.0, 280.0, 220.0, 30.0, 180.0, 80.0, 30.0, 420.0, 60.0, 150.0, 110.0, 110.0, 40.0, 70.0, 270.0, 20.0, 70.0, 110.0, 320.0, 50.0, 20.0, 30.0, 20.0, 240.0, 120.0, 220.0, 100.0, 240.0, 10.0, 450.0, -390.0, 280.0, 120.0, 110.0, 140.0, 80.0, 220.0, 200.0, 70.0, 30.0, 40.0, 70.0, 40.0, 130.0, -10.0, 50.0, 20.0, 80.0, 80.0, 470.0, -100.0, 120.0, 100.0, 90.0, 100.0, 390.0, 40.0, 20.0, 100.0, 170.0, 20.0, 50.0, 110.0, 290.0, 50.0, 50.0, 70.0, 70.0, 0.0, 80.0, 130.0, 70.0, 30.0, 40.0, 320.0, 100.0, 50.0, 100.0, 20.0, 60.0, 30.0, 40.0, 20.0, 130.0, 200.0, 10.0, 170.0, 60.0, 60.0, 35.0, 30.0, 100.0, 30.0, 100.0, 100.0, 210.0, 120.0, 45.0, 170.0, 150.0, 40.0, 80.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5282777751968977, "mean_inference_ms": 1.4154504659926257, "mean_action_processing_ms": 0.4582425364913434, "mean_env_wait_ms": 1.245874409439936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012597084045410156, "StateBufferConnector_ms": 0.009491205215454102, "ViewRequirementAgentConnector_ms": 0.3843975067138672}, "num_episodes": 18, "episode_return_max": 1875.0, "episode_return_min": 130.0, "episode_return_mean": 1001.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.54252691863753, "num_env_steps_trained_throughput_per_sec": 21.54252691863753, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 186883.983, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186883.931, "sample_time_ms": 2605.197, "learn_time_ms": 184255.056, "learn_throughput": 21.709, "synch_weights_time_ms": 9.879}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "33e63_00000", "date": "2024-06-19_03-49-51", "timestamp": 1718783391, "time_this_iter_s": 185.687922000885, "time_total_s": 24172.139778137207, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3279800d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24172.139778137207, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 16.404562737642586, "ram_util_percent": 79.3083650190114}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3901011388268842, "cur_kl_coeff": 11.096704816717828, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0036433100402087403, "vf_loss": 7.1766090583496585, "vf_explained_var": -0.00235138876369586, "kl": Infinity, "entropy": 0.3852221689126489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 1875.0, "episode_reward_min": 130.0, "episode_reward_mean": 996.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 640.0}, "policy_reward_mean": {"policy_0": 99.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 1355.0, 645.0, 1210.0, 770.0, 770.0, 1370.0, 1010.0, 1180.0, 890.0, 1480.0, 675.0, 1410.0, 1250.0, 510.0, 810.0, 500.0, 1010.0, 1205.0, 1875.0, 900.0, 1310.0, 770.0, 410.0, 1390.0, 1410.0, 1370.0, 540.0, 540.0, 1290.0, 310.0, 840.0, 790.0, 1195.0, 1430.0, 1495.0, 130.0, 920.0, 830.0, 1000.0, 1290.0, 670.0, 220.0, 850.0, 145.0, 1005.0, 1020.0, 290.0, 650.0, 1200.0, 1810.0, 1220.0, 1590.0, 1170.0, 1180.0, 845.0, 1790.0, 780.0, 460.0, 1015.0, 130.0, 1330.0, 1145.0, 1490.0, 555.0, 1390.0, 1870.0, 1210.0, 980.0, 1390.0, 1000.0, 940.0, 1090.0, 840.0, 780.0, 825.0, 1155.0, 1170.0, 1030.0, 1650.0, 340.0, 1450.0, 790.0, 810.0, 800.0, 470.0, 950.0, 360.0, 610.0, 1310.0, 1350.0, 1310.0, 1240.0, 1150.0, 845.0, 1230.0, 1040.0, 900.0, 1345.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 40.0, 110.0, 230.0, 110.0, 140.0, 60.0, 110.0, 40.0, 120.0, 320.0, -65.0, 360.0, 90.0, -10.0, 200.0, 200.0, 60.0, 80.0, 100.0, 0.0, 20.0, 120.0, 45.0, 30.0, 100.0, 30.0, 120.0, 80.0, 40.0, 120.0, 110.0, 300.0, 210.0, 70.0, 260.0, -10.0, 110.0, 0.0, 30.0, 30.0, 20.0, 170.0, 280.0, 40.0, 30.0, 30.0, 100.0, 40.0, 60.0, 120.0, 40.0, 60.0, 60.0, 80.0, 60.0, 210.0, 30.0, 50.0, 30.0, 100.0, 250.0, 30.0, 350.0, 30.0, 330.0, 70.0, 140.0, 40.0, 80.0, 330.0, 90.0, 80.0, 70.0, 160.0, 0.0, 90.0, 30.0, 80.0, 40.0, 210.0, 210.0, 70.0, 110.0, 80.0, 300.0, 90.0, 40.0, 30.0, 0.0, 0.0, 40.0, 30.0, 0.0, 160.0, 540.0, 40.0, 50.0, 30.0, 120.0, 40.0, 50.0, 100.0, 540.0, 80.0, 100.0, 170.0, 40.0, 240.0, 150.0, 40.0, 180.0, 130.0, 65.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 70.0, 60.0, 270.0, 310.0, 70.0, 30.0, 170.0, 310.0, 100.0, 60.0, 60.0, 270.0, 60.0, 50.0, 40.0, 390.0, 200.0, 60.0, 60.0, 190.0, 100.0, 20.0, 20.0, 40.0, 20.0, 20.0, 10.0, 70.0, 20.0, -40.0, 130.0, 30.0, 110.0, 300.0, 50.0, 70.0, 70.0, 40.0, 50.0, 0.0, 40.0, 10.0, 80.0, 90.0, 10.0, 20.0, 10.0, 30.0, 210.0, 200.0, 90.0, 170.0, 70.0, 30.0, 80.0, 50.0, 100.0, 130.0, 90.0, 45.0, 50.0, 210.0, 110.0, 30.0, 230.0, 310.0, 80.0, 50.0, 90.0, 200.0, 30.0, 150.0, 160.0, 95.0, 110.0, 180.0, 250.0, 640.0, 60.0, 0.0, 50.0, 40.0, 200.0, 30.0, 40.0, 310.0, 110.0, 90.0, 30.0, 140.0, 70.0, -50.0, 470.0, 60.0, 380.0, 140.0, 60.0, -30.0, 70.0, 370.0, 60.0, 80.0, 20.0, 0.0, 70.0, 60.0, 30.0, 40.0, 40.0, 0.0, 60.0, 10.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 280.0, 190.0, 190.0, 20.0, 10.0, 260.0, 50.0, 130.0, 120.0, 30.0, 390.0, 60.0, 40.0, 130.0, 150.0, 200.0, 70.0, 80.0, 360.0, 120.0, 200.0, 630.0, 150.0, 20.0, 60.0, 60.0, 60.0, 115.0, 210.0, 65.0, 0.0, 0.0, 0.0, 60.0, 20.0, 40.0, 30.0, 150.0, 180.0, 20.0, 40.0, 30.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 20.0, 50.0, 150.0, 70.0, 100.0, 150.0, 120.0, 160.0, 120.0, 30.0, 90.0, 330.0, 120.0, 30.0, -5.0, 90.0, 30.0, 80.0, 20.0, 5.0, 0.0, 30.0, 30.0, -10.0, 70.0, 90.0, 30.0, 35.0, 120.0, 300.0, -5.0, 170.0, 40.0, 120.0, 190.0, 10.0, 40.0, 100.0, 10.0, 10.0, 40.0, 170.0, 100.0, 40.0, 100.0, 140.0, 50.0, 200.0, 120.0, 70.0, 220.0, 65.0, 190.0, 160.0, 90.0, 80.0, 270.0, 530.0, 60.0, 150.0, 30.0, 50.0, 10.0, 200.0, 45.0, 130.0, 110.0, 340.0, 160.0, 90.0, 70.0, 120.0, 230.0, 10.0, 10.0, 40.0, 10.0, -5.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 290.0, -40.0, 30.0, 20.0, 320.0, 30.0, 0.0, 10.0, 90.0, 5.0, 140.0, 260.0, 10.0, 10.0, 30.0, -35.0, 40.0, 350.0, 20.0, 60.0, 80.0, 200.0, 210.0, 30.0, 10.0, 30.0, 130.0, 130.0, 120.0, 290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0, 10.0, 0.0, 70.0, 20.0, 150.0, 70.0, 80.0, 40.0, 180.0, 50.0, 10.0, 0.0, 20.0, 50.0, 60.0, 20.0, 10.0, 30.0, 10.0, 10.0, 70.0, 220.0, 60.0, 80.0, 40.0, 30.0, 80.0, 30.0, 60.0, 180.0, 15.0, 5.0, 30.0, 30.0, 20.0, 20.0, 0.0, 15.0, 10.0, 0.0, 130.0, 70.0, 350.0, 30.0, 20.0, 20.0, 70.0, 200.0, 45.0, 70.0, 80.0, 360.0, 10.0, 200.0, 0.0, 60.0, 10.0, 50.0, 170.0, 80.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 30.0, -10.0, 30.0, 30.0, 70.0, 70.0, 130.0, 0.0, 140.0, 90.0, 20.0, 90.0, 40.0, 0.0, 130.0, 130.0, 360.0, 10.0, 240.0, 30.0, 50.0, 100.0, 70.0, 80.0, 420.0, 210.0, 110.0, 300.0, 180.0, 55.0, 90.0, 280.0, 35.0, 130.0, 110.0, 250.0, 170.0, 140.0, 100.0, 200.0, -10.0, 120.0, 60.0, 80.0, 0.0, 150.0, 170.0, 540.0, 40.0, 70.0, 50.0, 50.0, 410.0, 110.0, 240.0, 130.0, 160.0, 90.0, 140.0, 60.0, 160.0, 90.0, 70.0, 30.0, 180.0, 40.0, 260.0, 250.0, 90.0, 40.0, 140.0, 80.0, 60.0, 40.0, 35.0, 30.0, 150.0, 20.0, 130.0, 130.0, 50.0, 260.0, 0.0, 40.0, 10.0, 230.0, 360.0, 70.0, 400.0, 120.0, 50.0, 300.0, 50.0, 200.0, -40.0, 20.0, 30.0, 280.0, 180.0, 0.0, 270.0, 0.0, 10.0, 30.0, 60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0, 270.0, 30.0, 35.0, 80.0, 100.0, 80.0, 70.0, 230.0, 60.0, 60.0, -230.0, 70.0, 30.0, 70.0, -50.0, 20.0, 30.0, 60.0, 60.0, 70.0, 470.0, 110.0, 0.0, 120.0, 40.0, -40.0, 200.0, 150.0, 10.0, 270.0, 210.0, 160.0, 5.0, 70.0, 50.0, 200.0, 40.0, 270.0, 60.0, 80.0, 20.0, 110.0, 120.0, 300.0, 120.0, 240.0, 10.0, 280.0, 210.0, 80.0, 55.0, 170.0, 0.0, 30.0, 50.0, 0.0, 30.0, 110.0, 30.0, 80.0, 360.0, 80.0, 120.0, 110.0, 20.0, 20.0, 90.0, 110.0, 130.0, 350.0, 340.0, -20.0, 110.0, 130.0, 180.0, 230.0, 360.0, 40.0, 280.0, 220.0, 30.0, 180.0, 80.0, 30.0, 420.0, 60.0, 150.0, 110.0, 110.0, 40.0, 70.0, 270.0, 20.0, 70.0, 110.0, 320.0, 50.0, 20.0, 30.0, 20.0, 240.0, 120.0, 220.0, 100.0, 240.0, 10.0, 450.0, -390.0, 280.0, 120.0, 110.0, 140.0, 80.0, 220.0, 200.0, 70.0, 30.0, 40.0, 70.0, 40.0, 130.0, -10.0, 50.0, 20.0, 80.0, 80.0, 470.0, -100.0, 120.0, 100.0, 90.0, 100.0, 390.0, 40.0, 20.0, 100.0, 170.0, 20.0, 50.0, 110.0, 290.0, 50.0, 50.0, 70.0, 70.0, 0.0, 80.0, 130.0, 70.0, 30.0, 40.0, 320.0, 100.0, 50.0, 100.0, 20.0, 60.0, 30.0, 40.0, 20.0, 130.0, 200.0, 10.0, 170.0, 60.0, 60.0, 35.0, 30.0, 100.0, 30.0, 100.0, 100.0, 210.0, 120.0, 45.0, 170.0, 150.0, 40.0, 80.0, 140.0, 30.0, 40.0, 190.0, -40.0, 0.0, 250.0, 10.0, 200.0, 150.0, 340.0, 50.0, 80.0, 20.0, 20.0, 80.0, 110.0, 260.0, 220.0, 120.0, 70.0, 560.0, 230.0, 120.0, 50.0, 80.0, 50.0, 70.0, 130.0, 100.0, 260.0, 90.0, 40.0, 10.0, 10.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 120.0, 130.0, 120.0, 170.0, 130.0, 250.0, 150.0, 200.0, 140.0, 40.0, 80.0, 40.0, 20.0, 10.0, 220.0, 300.0, -40.0, 60.0, 90.0, 10.0, 50.0, 300.0, 70.0, 60.0, 80.0, 180.0, 40.0, -20.0, 40.0, 10.0, 250.0, 120.0, 60.0, 30.0, 20.0, 70.0, 30.0, 120.0, 40.0, 60.0, 130.0, 30.0, 0.0, 10.0, 30.0, 150.0, -10.0, 50.0, 70.0, 10.0, 30.0, -10.0, 80.0, -10.0, 180.0, 40.0, 30.0, 180.0, 360.0, 70.0, 40.0, 40.0, 30.0, 0.0, 0.0, 180.0, 20.0, 10.0, 20.0, 20.0, 60.0, 30.0, 10.0, 140.0, 0.0, 180.0, 80.0, 60.0, 40.0, 10.0, 180.0, 340.0, 200.0, 110.0, 50.0, 70.0, 150.0, 40.0, 40.0, 130.0, 150.0, 10.0, 130.0, -240.0, 80.0, 440.0, 300.0, 100.0, 210.0, 170.0, 70.0, 100.0, 220.0, 60.0, 200.0, 340.0, 50.0, 100.0, 180.0, -10.0, 120.0, 110.0, 220.0, 200.0, 20.0, 50.0, 100.0, 250.0, 130.0, 40.0, 230.0, -40.0, 55.0, 120.0, 70.0, 95.0, 160.0, 160.0, 100.0, 200.0, 90.0, 30.0, 250.0, 40.0, 40.0, 100.0, 85.0, 100.0, 60.0, 50.0, 150.0, 90.0, 300.0, 40.0, 60.0, 70.0, 170.0, 40.0, 150.0, 160.0, 190.0, 310.0, 50.0, 40.0, 50.0, 170.0, 60.0, 100.0, 30.0, 40.0, 130.0, 100.0, 40.0, 40.0, 80.0, 190.0, 70.0, 50.0, 80.0, 120.0, 80.0, -5.0, 20.0, 80.0, 110.0, 240.0, 140.0, 200.0, 80.0, 400.0, 30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5285627666068589, "mean_inference_ms": 1.4162293890080548, "mean_action_processing_ms": 0.4576692207529958, "mean_env_wait_ms": 1.24591468393327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01363682746887207, "StateBufferConnector_ms": 0.010253190994262695, "ViewRequirementAgentConnector_ms": 0.38858866691589355}, "num_episodes": 23, "episode_return_max": 1875.0, "episode_return_min": 130.0, "episode_return_mean": 996.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.443629322647123, "num_env_steps_trained_throughput_per_sec": 21.443629322647123, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 186966.693, "restore_workers_time_ms": 0.012, "training_step_time_ms": 186966.642, "sample_time_ms": 2629.971, "learn_time_ms": 184314.218, "learn_throughput": 21.702, "synch_weights_time_ms": 9.852}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "33e63_00000", "date": "2024-06-19_03-52-57", "timestamp": 1718783577, "time_this_iter_s": 186.54348230361938, "time_total_s": 24358.683260440826, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327980790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24358.683260440826, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 16.249242424242425, "ram_util_percent": 79.78977272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2901144819201247, "cur_kl_coeff": 16.645057225076748, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.5970215031133295, "policy_loss": -0.0023142268266023013, "vf_loss": 6.596646093078061, "vf_explained_var": -4.564017152633911e-05, "kl": 0.0001615875780280725, "entropy": 0.39554362477332006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": -20.0, "episode_reward_mean": 954.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 95.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 410.0, 1390.0, 1410.0, 1370.0, 540.0, 540.0, 1290.0, 310.0, 840.0, 790.0, 1195.0, 1430.0, 1495.0, 130.0, 920.0, 830.0, 1000.0, 1290.0, 670.0, 220.0, 850.0, 145.0, 1005.0, 1020.0, 290.0, 650.0, 1200.0, 1810.0, 1220.0, 1590.0, 1170.0, 1180.0, 845.0, 1790.0, 780.0, 460.0, 1015.0, 130.0, 1330.0, 1145.0, 1490.0, 555.0, 1390.0, 1870.0, 1210.0, 980.0, 1390.0, 1000.0, 940.0, 1090.0, 840.0, 780.0, 825.0, 1155.0, 1170.0, 1030.0, 1650.0, 340.0, 1450.0, 790.0, 810.0, 800.0, 470.0, 950.0, 360.0, 610.0, 1310.0, 1350.0, 1310.0, 1240.0, 1150.0, 845.0, 1230.0, 1040.0, 900.0, 1345.0, 500.0, 1680.0, 285.0, 1035.0, 645.0, 620.0, 840.0, -20.0, 935.0, 1540.0, 1005.0, 830.0, 640.0, 1180.0, 1190.0, 540.0, 440.0, 840.0, 990.0, 935.0, 480.0, 1330.0, 890.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [370.0, 60.0, 80.0, 20.0, 0.0, 70.0, 60.0, 30.0, 40.0, 40.0, 0.0, 60.0, 10.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 280.0, 190.0, 190.0, 20.0, 10.0, 260.0, 50.0, 130.0, 120.0, 30.0, 390.0, 60.0, 40.0, 130.0, 150.0, 200.0, 70.0, 80.0, 360.0, 120.0, 200.0, 630.0, 150.0, 20.0, 60.0, 60.0, 60.0, 115.0, 210.0, 65.0, 0.0, 0.0, 0.0, 60.0, 20.0, 40.0, 30.0, 150.0, 180.0, 20.0, 40.0, 30.0, 10.0, 40.0, 90.0, 40.0, 50.0, 60.0, 20.0, 50.0, 150.0, 70.0, 100.0, 150.0, 120.0, 160.0, 120.0, 30.0, 90.0, 330.0, 120.0, 30.0, -5.0, 90.0, 30.0, 80.0, 20.0, 5.0, 0.0, 30.0, 30.0, -10.0, 70.0, 90.0, 30.0, 35.0, 120.0, 300.0, -5.0, 170.0, 40.0, 120.0, 190.0, 10.0, 40.0, 100.0, 10.0, 10.0, 40.0, 170.0, 100.0, 40.0, 100.0, 140.0, 50.0, 200.0, 120.0, 70.0, 220.0, 65.0, 190.0, 160.0, 90.0, 80.0, 270.0, 530.0, 60.0, 150.0, 30.0, 50.0, 10.0, 200.0, 45.0, 130.0, 110.0, 340.0, 160.0, 90.0, 70.0, 120.0, 230.0, 10.0, 10.0, 40.0, 10.0, -5.0, 20.0, 30.0, 5.0, 10.0, 0.0, 170.0, 290.0, -40.0, 30.0, 20.0, 320.0, 30.0, 0.0, 10.0, 90.0, 5.0, 140.0, 260.0, 10.0, 10.0, 30.0, -35.0, 40.0, 350.0, 20.0, 60.0, 80.0, 200.0, 210.0, 30.0, 10.0, 30.0, 130.0, 130.0, 120.0, 290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0, 10.0, 0.0, 70.0, 20.0, 150.0, 70.0, 80.0, 40.0, 180.0, 50.0, 10.0, 0.0, 20.0, 50.0, 60.0, 20.0, 10.0, 30.0, 10.0, 10.0, 70.0, 220.0, 60.0, 80.0, 40.0, 30.0, 80.0, 30.0, 60.0, 180.0, 15.0, 5.0, 30.0, 30.0, 20.0, 20.0, 0.0, 15.0, 10.0, 0.0, 130.0, 70.0, 350.0, 30.0, 20.0, 20.0, 70.0, 200.0, 45.0, 70.0, 80.0, 360.0, 10.0, 200.0, 0.0, 60.0, 10.0, 50.0, 170.0, 80.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 30.0, -10.0, 30.0, 30.0, 70.0, 70.0, 130.0, 0.0, 140.0, 90.0, 20.0, 90.0, 40.0, 0.0, 130.0, 130.0, 360.0, 10.0, 240.0, 30.0, 50.0, 100.0, 70.0, 80.0, 420.0, 210.0, 110.0, 300.0, 180.0, 55.0, 90.0, 280.0, 35.0, 130.0, 110.0, 250.0, 170.0, 140.0, 100.0, 200.0, -10.0, 120.0, 60.0, 80.0, 0.0, 150.0, 170.0, 540.0, 40.0, 70.0, 50.0, 50.0, 410.0, 110.0, 240.0, 130.0, 160.0, 90.0, 140.0, 60.0, 160.0, 90.0, 70.0, 30.0, 180.0, 40.0, 260.0, 250.0, 90.0, 40.0, 140.0, 80.0, 60.0, 40.0, 35.0, 30.0, 150.0, 20.0, 130.0, 130.0, 50.0, 260.0, 0.0, 40.0, 10.0, 230.0, 360.0, 70.0, 400.0, 120.0, 50.0, 300.0, 50.0, 200.0, -40.0, 20.0, 30.0, 280.0, 180.0, 0.0, 270.0, 0.0, 10.0, 30.0, 60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0, 270.0, 30.0, 35.0, 80.0, 100.0, 80.0, 70.0, 230.0, 60.0, 60.0, -230.0, 70.0, 30.0, 70.0, -50.0, 20.0, 30.0, 60.0, 60.0, 70.0, 470.0, 110.0, 0.0, 120.0, 40.0, -40.0, 200.0, 150.0, 10.0, 270.0, 210.0, 160.0, 5.0, 70.0, 50.0, 200.0, 40.0, 270.0, 60.0, 80.0, 20.0, 110.0, 120.0, 300.0, 120.0, 240.0, 10.0, 280.0, 210.0, 80.0, 55.0, 170.0, 0.0, 30.0, 50.0, 0.0, 30.0, 110.0, 30.0, 80.0, 360.0, 80.0, 120.0, 110.0, 20.0, 20.0, 90.0, 110.0, 130.0, 350.0, 340.0, -20.0, 110.0, 130.0, 180.0, 230.0, 360.0, 40.0, 280.0, 220.0, 30.0, 180.0, 80.0, 30.0, 420.0, 60.0, 150.0, 110.0, 110.0, 40.0, 70.0, 270.0, 20.0, 70.0, 110.0, 320.0, 50.0, 20.0, 30.0, 20.0, 240.0, 120.0, 220.0, 100.0, 240.0, 10.0, 450.0, -390.0, 280.0, 120.0, 110.0, 140.0, 80.0, 220.0, 200.0, 70.0, 30.0, 40.0, 70.0, 40.0, 130.0, -10.0, 50.0, 20.0, 80.0, 80.0, 470.0, -100.0, 120.0, 100.0, 90.0, 100.0, 390.0, 40.0, 20.0, 100.0, 170.0, 20.0, 50.0, 110.0, 290.0, 50.0, 50.0, 70.0, 70.0, 0.0, 80.0, 130.0, 70.0, 30.0, 40.0, 320.0, 100.0, 50.0, 100.0, 20.0, 60.0, 30.0, 40.0, 20.0, 130.0, 200.0, 10.0, 170.0, 60.0, 60.0, 35.0, 30.0, 100.0, 30.0, 100.0, 100.0, 210.0, 120.0, 45.0, 170.0, 150.0, 40.0, 80.0, 140.0, 30.0, 40.0, 190.0, -40.0, 0.0, 250.0, 10.0, 200.0, 150.0, 340.0, 50.0, 80.0, 20.0, 20.0, 80.0, 110.0, 260.0, 220.0, 120.0, 70.0, 560.0, 230.0, 120.0, 50.0, 80.0, 50.0, 70.0, 130.0, 100.0, 260.0, 90.0, 40.0, 10.0, 10.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 120.0, 130.0, 120.0, 170.0, 130.0, 250.0, 150.0, 200.0, 140.0, 40.0, 80.0, 40.0, 20.0, 10.0, 220.0, 300.0, -40.0, 60.0, 90.0, 10.0, 50.0, 300.0, 70.0, 60.0, 80.0, 180.0, 40.0, -20.0, 40.0, 10.0, 250.0, 120.0, 60.0, 30.0, 20.0, 70.0, 30.0, 120.0, 40.0, 60.0, 130.0, 30.0, 0.0, 10.0, 30.0, 150.0, -10.0, 50.0, 70.0, 10.0, 30.0, -10.0, 80.0, -10.0, 180.0, 40.0, 30.0, 180.0, 360.0, 70.0, 40.0, 40.0, 30.0, 0.0, 0.0, 180.0, 20.0, 10.0, 20.0, 20.0, 60.0, 30.0, 10.0, 140.0, 0.0, 180.0, 80.0, 60.0, 40.0, 10.0, 180.0, 340.0, 200.0, 110.0, 50.0, 70.0, 150.0, 40.0, 40.0, 130.0, 150.0, 10.0, 130.0, -240.0, 80.0, 440.0, 300.0, 100.0, 210.0, 170.0, 70.0, 100.0, 220.0, 60.0, 200.0, 340.0, 50.0, 100.0, 180.0, -10.0, 120.0, 110.0, 220.0, 200.0, 20.0, 50.0, 100.0, 250.0, 130.0, 40.0, 230.0, -40.0, 55.0, 120.0, 70.0, 95.0, 160.0, 160.0, 100.0, 200.0, 90.0, 30.0, 250.0, 40.0, 40.0, 100.0, 85.0, 100.0, 60.0, 50.0, 150.0, 90.0, 300.0, 40.0, 60.0, 70.0, 170.0, 40.0, 150.0, 160.0, 190.0, 310.0, 50.0, 40.0, 50.0, 170.0, 60.0, 100.0, 30.0, 40.0, 130.0, 100.0, 40.0, 40.0, 80.0, 190.0, 70.0, 50.0, 80.0, 120.0, 80.0, -5.0, 20.0, 80.0, 110.0, 240.0, 140.0, 200.0, 80.0, 400.0, 30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0, 0.0, 180.0, 450.0, 300.0, 300.0, 120.0, 60.0, 170.0, 40.0, 60.0, 20.0, 50.0, 40.0, 30.0, 30.0, -5.0, 20.0, 20.0, 40.0, 40.0, 110.0, 80.0, 340.0, 65.0, 90.0, 40.0, 30.0, 140.0, 60.0, 80.0, 60.0, 5.0, 35.0, 40.0, 180.0, 0.0, 230.0, 60.0, 30.0, 5.0, 50.0, 60.0, 30.0, 70.0, 90.0, 150.0, 50.0, 10.0, 70.0, 40.0, 10.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 0.0, 190.0, 90.0, -50.0, 30.0, 160.0, 10.0, 30.0, 30.0, 150.0, 0.0, 10.0, -390.0, 40.0, -50.0, 120.0, 55.0, 10.0, 120.0, 330.0, 0.0, 150.0, 160.0, 30.0, 490.0, 280.0, 20.0, 110.0, 80.0, 60.0, 340.0, 100.0, 30.0, 80.0, 60.0, 200.0, 20.0, 110.0, 270.0, 30.0, 250.0, -55.0, 40.0, 50.0, 50.0, 450.0, 0.0, 60.0, 40.0, 100.0, 70.0, 10.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 40.0, 100.0, 30.0, 10.0, 270.0, 70.0, 280.0, 70.0, 140.0, 190.0, 50.0, 150.0, 130.0, 10.0, 90.0, 160.0, 60.0, 360.0, 0.0, 110.0, 40.0, 260.0, -20.0, 130.0, 90.0, 40.0, 10.0, 10.0, 180.0, 0.0, 10.0, 190.0, 80.0, 20.0, 0.0, -30.0, 10.0, 10.0, 50.0, 260.0, 0.0, 30.0, 40.0, 40.0, 30.0, 120.0, 320.0, 80.0, 80.0, 20.0, 60.0, 20.0, -50.0, 30.0, 160.0, 90.0, 30.0, 390.0, 210.0, 90.0, 30.0, 60.0, 70.0, -30.0, 50.0, 20.0, 350.0, 240.0, 90.0, 10.0, 50.0, 0.0, 15.0, 50.0, 110.0, 0.0, 120.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, 20.0, -30.0, 130.0, 100.0, 70.0, 90.0, 80.0, 110.0, 350.0, 290.0, 50.0, 60.0, 20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5278638675351848, "mean_inference_ms": 1.4159412268055944, "mean_action_processing_ms": 0.4574969663736529, "mean_env_wait_ms": 1.245956607434043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013690948486328125, "StateBufferConnector_ms": 0.010528326034545898, "ViewRequirementAgentConnector_ms": 0.40323591232299805}, "num_episodes": 22, "episode_return_max": 1870.0, "episode_return_min": -20.0, "episode_return_mean": 954.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.247494436009884, "num_env_steps_trained_throughput_per_sec": 21.247494436009884, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 187264.371, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187264.322, "sample_time_ms": 2656.325, "learn_time_ms": 184585.938, "learn_throughput": 21.67, "synch_weights_time_ms": 10.532}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "33e63_00000", "date": "2024-06-19_03-56-06", "timestamp": 1718783766, "time_this_iter_s": 188.2911238670349, "time_total_s": 24546.97438430786, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327980d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24546.97438430786, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 18.38609022556391, "ram_util_percent": 78.78458646616542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8565840515973595, "cur_kl_coeff": 8.322528612538374, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003837199314746359, "vf_loss": 6.765958574252387, "vf_explained_var": -0.00036564801320735133, "kl": Infinity, "entropy": 0.37699684001449835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": -20.0, "episode_reward_mean": 973.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 630.0}, "policy_reward_mean": {"policy_0": 97.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1290.0, 670.0, 220.0, 850.0, 145.0, 1005.0, 1020.0, 290.0, 650.0, 1200.0, 1810.0, 1220.0, 1590.0, 1170.0, 1180.0, 845.0, 1790.0, 780.0, 460.0, 1015.0, 130.0, 1330.0, 1145.0, 1490.0, 555.0, 1390.0, 1870.0, 1210.0, 980.0, 1390.0, 1000.0, 940.0, 1090.0, 840.0, 780.0, 825.0, 1155.0, 1170.0, 1030.0, 1650.0, 340.0, 1450.0, 790.0, 810.0, 800.0, 470.0, 950.0, 360.0, 610.0, 1310.0, 1350.0, 1310.0, 1240.0, 1150.0, 845.0, 1230.0, 1040.0, 900.0, 1345.0, 500.0, 1680.0, 285.0, 1035.0, 645.0, 620.0, 840.0, -20.0, 935.0, 1540.0, 1005.0, 830.0, 640.0, 1180.0, 1190.0, 540.0, 440.0, 840.0, 990.0, 935.0, 480.0, 1330.0, 890.0, 610.0, 440.0, 1730.0, 510.0, 1320.0, 645.0, 1450.0, 1820.0, 1420.0, 650.0, 1000.0, 990.0, 740.0, 930.0, 470.0, 1070.0, 1270.0, 1440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, 400.0, 50.0, 80.0, 20.0, 20.0, 60.0, 30.0, 130.0, 210.0, 10.0, 0.0, 70.0, 20.0, 150.0, 70.0, 80.0, 40.0, 180.0, 50.0, 10.0, 0.0, 20.0, 50.0, 60.0, 20.0, 10.0, 30.0, 10.0, 10.0, 70.0, 220.0, 60.0, 80.0, 40.0, 30.0, 80.0, 30.0, 60.0, 180.0, 15.0, 5.0, 30.0, 30.0, 20.0, 20.0, 0.0, 15.0, 10.0, 0.0, 130.0, 70.0, 350.0, 30.0, 20.0, 20.0, 70.0, 200.0, 45.0, 70.0, 80.0, 360.0, 10.0, 200.0, 0.0, 60.0, 10.0, 50.0, 170.0, 80.0, 10.0, 10.0, 20.0, 60.0, 40.0, 70.0, 30.0, -10.0, 30.0, 30.0, 70.0, 70.0, 130.0, 0.0, 140.0, 90.0, 20.0, 90.0, 40.0, 0.0, 130.0, 130.0, 360.0, 10.0, 240.0, 30.0, 50.0, 100.0, 70.0, 80.0, 420.0, 210.0, 110.0, 300.0, 180.0, 55.0, 90.0, 280.0, 35.0, 130.0, 110.0, 250.0, 170.0, 140.0, 100.0, 200.0, -10.0, 120.0, 60.0, 80.0, 0.0, 150.0, 170.0, 540.0, 40.0, 70.0, 50.0, 50.0, 410.0, 110.0, 240.0, 130.0, 160.0, 90.0, 140.0, 60.0, 160.0, 90.0, 70.0, 30.0, 180.0, 40.0, 260.0, 250.0, 90.0, 40.0, 140.0, 80.0, 60.0, 40.0, 35.0, 30.0, 150.0, 20.0, 130.0, 130.0, 50.0, 260.0, 0.0, 40.0, 10.0, 230.0, 360.0, 70.0, 400.0, 120.0, 50.0, 300.0, 50.0, 200.0, -40.0, 20.0, 30.0, 280.0, 180.0, 0.0, 270.0, 0.0, 10.0, 30.0, 60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0, 270.0, 30.0, 35.0, 80.0, 100.0, 80.0, 70.0, 230.0, 60.0, 60.0, -230.0, 70.0, 30.0, 70.0, -50.0, 20.0, 30.0, 60.0, 60.0, 70.0, 470.0, 110.0, 0.0, 120.0, 40.0, -40.0, 200.0, 150.0, 10.0, 270.0, 210.0, 160.0, 5.0, 70.0, 50.0, 200.0, 40.0, 270.0, 60.0, 80.0, 20.0, 110.0, 120.0, 300.0, 120.0, 240.0, 10.0, 280.0, 210.0, 80.0, 55.0, 170.0, 0.0, 30.0, 50.0, 0.0, 30.0, 110.0, 30.0, 80.0, 360.0, 80.0, 120.0, 110.0, 20.0, 20.0, 90.0, 110.0, 130.0, 350.0, 340.0, -20.0, 110.0, 130.0, 180.0, 230.0, 360.0, 40.0, 280.0, 220.0, 30.0, 180.0, 80.0, 30.0, 420.0, 60.0, 150.0, 110.0, 110.0, 40.0, 70.0, 270.0, 20.0, 70.0, 110.0, 320.0, 50.0, 20.0, 30.0, 20.0, 240.0, 120.0, 220.0, 100.0, 240.0, 10.0, 450.0, -390.0, 280.0, 120.0, 110.0, 140.0, 80.0, 220.0, 200.0, 70.0, 30.0, 40.0, 70.0, 40.0, 130.0, -10.0, 50.0, 20.0, 80.0, 80.0, 470.0, -100.0, 120.0, 100.0, 90.0, 100.0, 390.0, 40.0, 20.0, 100.0, 170.0, 20.0, 50.0, 110.0, 290.0, 50.0, 50.0, 70.0, 70.0, 0.0, 80.0, 130.0, 70.0, 30.0, 40.0, 320.0, 100.0, 50.0, 100.0, 20.0, 60.0, 30.0, 40.0, 20.0, 130.0, 200.0, 10.0, 170.0, 60.0, 60.0, 35.0, 30.0, 100.0, 30.0, 100.0, 100.0, 210.0, 120.0, 45.0, 170.0, 150.0, 40.0, 80.0, 140.0, 30.0, 40.0, 190.0, -40.0, 0.0, 250.0, 10.0, 200.0, 150.0, 340.0, 50.0, 80.0, 20.0, 20.0, 80.0, 110.0, 260.0, 220.0, 120.0, 70.0, 560.0, 230.0, 120.0, 50.0, 80.0, 50.0, 70.0, 130.0, 100.0, 260.0, 90.0, 40.0, 10.0, 10.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 120.0, 130.0, 120.0, 170.0, 130.0, 250.0, 150.0, 200.0, 140.0, 40.0, 80.0, 40.0, 20.0, 10.0, 220.0, 300.0, -40.0, 60.0, 90.0, 10.0, 50.0, 300.0, 70.0, 60.0, 80.0, 180.0, 40.0, -20.0, 40.0, 10.0, 250.0, 120.0, 60.0, 30.0, 20.0, 70.0, 30.0, 120.0, 40.0, 60.0, 130.0, 30.0, 0.0, 10.0, 30.0, 150.0, -10.0, 50.0, 70.0, 10.0, 30.0, -10.0, 80.0, -10.0, 180.0, 40.0, 30.0, 180.0, 360.0, 70.0, 40.0, 40.0, 30.0, 0.0, 0.0, 180.0, 20.0, 10.0, 20.0, 20.0, 60.0, 30.0, 10.0, 140.0, 0.0, 180.0, 80.0, 60.0, 40.0, 10.0, 180.0, 340.0, 200.0, 110.0, 50.0, 70.0, 150.0, 40.0, 40.0, 130.0, 150.0, 10.0, 130.0, -240.0, 80.0, 440.0, 300.0, 100.0, 210.0, 170.0, 70.0, 100.0, 220.0, 60.0, 200.0, 340.0, 50.0, 100.0, 180.0, -10.0, 120.0, 110.0, 220.0, 200.0, 20.0, 50.0, 100.0, 250.0, 130.0, 40.0, 230.0, -40.0, 55.0, 120.0, 70.0, 95.0, 160.0, 160.0, 100.0, 200.0, 90.0, 30.0, 250.0, 40.0, 40.0, 100.0, 85.0, 100.0, 60.0, 50.0, 150.0, 90.0, 300.0, 40.0, 60.0, 70.0, 170.0, 40.0, 150.0, 160.0, 190.0, 310.0, 50.0, 40.0, 50.0, 170.0, 60.0, 100.0, 30.0, 40.0, 130.0, 100.0, 40.0, 40.0, 80.0, 190.0, 70.0, 50.0, 80.0, 120.0, 80.0, -5.0, 20.0, 80.0, 110.0, 240.0, 140.0, 200.0, 80.0, 400.0, 30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0, 0.0, 180.0, 450.0, 300.0, 300.0, 120.0, 60.0, 170.0, 40.0, 60.0, 20.0, 50.0, 40.0, 30.0, 30.0, -5.0, 20.0, 20.0, 40.0, 40.0, 110.0, 80.0, 340.0, 65.0, 90.0, 40.0, 30.0, 140.0, 60.0, 80.0, 60.0, 5.0, 35.0, 40.0, 180.0, 0.0, 230.0, 60.0, 30.0, 5.0, 50.0, 60.0, 30.0, 70.0, 90.0, 150.0, 50.0, 10.0, 70.0, 40.0, 10.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 0.0, 190.0, 90.0, -50.0, 30.0, 160.0, 10.0, 30.0, 30.0, 150.0, 0.0, 10.0, -390.0, 40.0, -50.0, 120.0, 55.0, 10.0, 120.0, 330.0, 0.0, 150.0, 160.0, 30.0, 490.0, 280.0, 20.0, 110.0, 80.0, 60.0, 340.0, 100.0, 30.0, 80.0, 60.0, 200.0, 20.0, 110.0, 270.0, 30.0, 250.0, -55.0, 40.0, 50.0, 50.0, 450.0, 0.0, 60.0, 40.0, 100.0, 70.0, 10.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 40.0, 100.0, 30.0, 10.0, 270.0, 70.0, 280.0, 70.0, 140.0, 190.0, 50.0, 150.0, 130.0, 10.0, 90.0, 160.0, 60.0, 360.0, 0.0, 110.0, 40.0, 260.0, -20.0, 130.0, 90.0, 40.0, 10.0, 10.0, 180.0, 0.0, 10.0, 190.0, 80.0, 20.0, 0.0, -30.0, 10.0, 10.0, 50.0, 260.0, 0.0, 30.0, 40.0, 40.0, 30.0, 120.0, 320.0, 80.0, 80.0, 20.0, 60.0, 20.0, -50.0, 30.0, 160.0, 90.0, 30.0, 390.0, 210.0, 90.0, 30.0, 60.0, 70.0, -30.0, 50.0, 20.0, 350.0, 240.0, 90.0, 10.0, 50.0, 0.0, 15.0, 50.0, 110.0, 0.0, 120.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, 20.0, -30.0, 130.0, 100.0, 70.0, 90.0, 80.0, 110.0, 350.0, 290.0, 50.0, 60.0, 20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0, 30.0, 80.0, 40.0, 210.0, 90.0, 100.0, 20.0, 10.0, 20.0, 10.0, 30.0, 110.0, 10.0, 20.0, 0.0, 10.0, 110.0, 20.0, 60.0, 70.0, -10.0, 70.0, 280.0, 110.0, 100.0, 100.0, 380.0, -20.0, 290.0, 430.0, 180.0, 120.0, -10.0, 40.0, 0.0, 10.0, 0.0, 90.0, 60.0, 20.0, 50.0, 190.0, 230.0, 80.0, 40.0, 300.0, 140.0, 170.0, 100.0, 20.0, 0.0, 70.0, 35.0, 40.0, 120.0, 190.0, 60.0, -20.0, 130.0, 20.0, 70.0, 110.0, 0.0, -40.0, 30.0, 250.0, 630.0, 10.0, 310.0, 80.0, 190.0, 60.0, 540.0, 90.0, 150.0, 190.0, 160.0, 280.0, 120.0, 40.0, 60.0, 90.0, 70.0, 40.0, 540.0, 140.0, 180.0, 210.0, 20.0, 70.0, 10.0, 70.0, 20.0, 0.0, 40.0, 5.0, 190.0, 280.0, 25.0, 10.0, 50.0, 0.0, 50.0, 20.0, 40.0, 430.0, 230.0, 10.0, 80.0, 90.0, 30.0, 70.0, 30.0, 80.0, 50.0, 40.0, 250.0, 200.0, 50.0, 190.0, 50.0, 10.0, 90.0, 100.0, 60.0, 90.0, 370.0, 20.0, -40.0, -10.0, 110.0, 120.0, 10.0, 50.0, 20.0, 90.0, 40.0, 250.0, 20.0, 220.0, 170.0, 40.0, 160.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 10.0, 90.0, 20.0, 230.0, 120.0, 180.0, 70.0, 0.0, 240.0, 100.0, 20.0, 50.0, 70.0, 100.0, 80.0, 50.0, 160.0, 380.0, 260.0, 100.0, 20.0, 30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5285588991051855, "mean_inference_ms": 1.4173975439060877, "mean_action_processing_ms": 0.4565842008230841, "mean_env_wait_ms": 1.2458606656582611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013139724731445312, "StateBufferConnector_ms": 0.01054692268371582, "ViewRequirementAgentConnector_ms": 0.39844536781311035}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": -20.0, "episode_return_mean": 973.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.175218267817076, "num_env_steps_trained_throughput_per_sec": 21.175218267817076, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 187417.139, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187417.09, "sample_time_ms": 2651.451, "learn_time_ms": 184743.231, "learn_throughput": 21.652, "synch_weights_time_ms": 11.139}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "33e63_00000", "date": "2024-06-19_03-59-14", "timestamp": 1718783954, "time_this_iter_s": 188.90869212150574, "time_total_s": 24735.883076429367, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3279809d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24735.883076429367, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.576779026217228, "ram_util_percent": 79.92397003745319}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8493027914954197, "cur_kl_coeff": 12.483792918807556, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.0749883742632065, "policy_loss": -0.002964176376339314, "vf_loss": 7.075208343002108, "vf_explained_var": -0.0011672592645509048, "kl": 0.00021982137414393017, "entropy": 0.36871013857971746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": -20.0, "episode_reward_mean": 990.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 99.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 1015.0, 130.0, 1330.0, 1145.0, 1490.0, 555.0, 1390.0, 1870.0, 1210.0, 980.0, 1390.0, 1000.0, 940.0, 1090.0, 840.0, 780.0, 825.0, 1155.0, 1170.0, 1030.0, 1650.0, 340.0, 1450.0, 790.0, 810.0, 800.0, 470.0, 950.0, 360.0, 610.0, 1310.0, 1350.0, 1310.0, 1240.0, 1150.0, 845.0, 1230.0, 1040.0, 900.0, 1345.0, 500.0, 1680.0, 285.0, 1035.0, 645.0, 620.0, 840.0, -20.0, 935.0, 1540.0, 1005.0, 830.0, 640.0, 1180.0, 1190.0, 540.0, 440.0, 840.0, 990.0, 935.0, 480.0, 1330.0, 890.0, 610.0, 440.0, 1730.0, 510.0, 1320.0, 645.0, 1450.0, 1820.0, 1420.0, 650.0, 1000.0, 990.0, 740.0, 930.0, 470.0, 1070.0, 1270.0, 1440.0, 1150.0, 1380.0, 840.0, 1340.0, 1150.0, 890.0, 960.0, 670.0, 900.0, 1225.0, 1375.0, 1535.0, 1040.0, 1060.0, 790.0, 770.0, 1450.0, 875.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 20.0, 20.0, 0.0, 60.0, 60.0, 0.0, 30.0, 150.0, 60.0, 270.0, 30.0, 35.0, 80.0, 100.0, 80.0, 70.0, 230.0, 60.0, 60.0, -230.0, 70.0, 30.0, 70.0, -50.0, 20.0, 30.0, 60.0, 60.0, 70.0, 470.0, 110.0, 0.0, 120.0, 40.0, -40.0, 200.0, 150.0, 10.0, 270.0, 210.0, 160.0, 5.0, 70.0, 50.0, 200.0, 40.0, 270.0, 60.0, 80.0, 20.0, 110.0, 120.0, 300.0, 120.0, 240.0, 10.0, 280.0, 210.0, 80.0, 55.0, 170.0, 0.0, 30.0, 50.0, 0.0, 30.0, 110.0, 30.0, 80.0, 360.0, 80.0, 120.0, 110.0, 20.0, 20.0, 90.0, 110.0, 130.0, 350.0, 340.0, -20.0, 110.0, 130.0, 180.0, 230.0, 360.0, 40.0, 280.0, 220.0, 30.0, 180.0, 80.0, 30.0, 420.0, 60.0, 150.0, 110.0, 110.0, 40.0, 70.0, 270.0, 20.0, 70.0, 110.0, 320.0, 50.0, 20.0, 30.0, 20.0, 240.0, 120.0, 220.0, 100.0, 240.0, 10.0, 450.0, -390.0, 280.0, 120.0, 110.0, 140.0, 80.0, 220.0, 200.0, 70.0, 30.0, 40.0, 70.0, 40.0, 130.0, -10.0, 50.0, 20.0, 80.0, 80.0, 470.0, -100.0, 120.0, 100.0, 90.0, 100.0, 390.0, 40.0, 20.0, 100.0, 170.0, 20.0, 50.0, 110.0, 290.0, 50.0, 50.0, 70.0, 70.0, 0.0, 80.0, 130.0, 70.0, 30.0, 40.0, 320.0, 100.0, 50.0, 100.0, 20.0, 60.0, 30.0, 40.0, 20.0, 130.0, 200.0, 10.0, 170.0, 60.0, 60.0, 35.0, 30.0, 100.0, 30.0, 100.0, 100.0, 210.0, 120.0, 45.0, 170.0, 150.0, 40.0, 80.0, 140.0, 30.0, 40.0, 190.0, -40.0, 0.0, 250.0, 10.0, 200.0, 150.0, 340.0, 50.0, 80.0, 20.0, 20.0, 80.0, 110.0, 260.0, 220.0, 120.0, 70.0, 560.0, 230.0, 120.0, 50.0, 80.0, 50.0, 70.0, 130.0, 100.0, 260.0, 90.0, 40.0, 10.0, 10.0, 30.0, 20.0, 40.0, 60.0, 20.0, 20.0, 120.0, 130.0, 120.0, 170.0, 130.0, 250.0, 150.0, 200.0, 140.0, 40.0, 80.0, 40.0, 20.0, 10.0, 220.0, 300.0, -40.0, 60.0, 90.0, 10.0, 50.0, 300.0, 70.0, 60.0, 80.0, 180.0, 40.0, -20.0, 40.0, 10.0, 250.0, 120.0, 60.0, 30.0, 20.0, 70.0, 30.0, 120.0, 40.0, 60.0, 130.0, 30.0, 0.0, 10.0, 30.0, 150.0, -10.0, 50.0, 70.0, 10.0, 30.0, -10.0, 80.0, -10.0, 180.0, 40.0, 30.0, 180.0, 360.0, 70.0, 40.0, 40.0, 30.0, 0.0, 0.0, 180.0, 20.0, 10.0, 20.0, 20.0, 60.0, 30.0, 10.0, 140.0, 0.0, 180.0, 80.0, 60.0, 40.0, 10.0, 180.0, 340.0, 200.0, 110.0, 50.0, 70.0, 150.0, 40.0, 40.0, 130.0, 150.0, 10.0, 130.0, -240.0, 80.0, 440.0, 300.0, 100.0, 210.0, 170.0, 70.0, 100.0, 220.0, 60.0, 200.0, 340.0, 50.0, 100.0, 180.0, -10.0, 120.0, 110.0, 220.0, 200.0, 20.0, 50.0, 100.0, 250.0, 130.0, 40.0, 230.0, -40.0, 55.0, 120.0, 70.0, 95.0, 160.0, 160.0, 100.0, 200.0, 90.0, 30.0, 250.0, 40.0, 40.0, 100.0, 85.0, 100.0, 60.0, 50.0, 150.0, 90.0, 300.0, 40.0, 60.0, 70.0, 170.0, 40.0, 150.0, 160.0, 190.0, 310.0, 50.0, 40.0, 50.0, 170.0, 60.0, 100.0, 30.0, 40.0, 130.0, 100.0, 40.0, 40.0, 80.0, 190.0, 70.0, 50.0, 80.0, 120.0, 80.0, -5.0, 20.0, 80.0, 110.0, 240.0, 140.0, 200.0, 80.0, 400.0, 30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0, 0.0, 180.0, 450.0, 300.0, 300.0, 120.0, 60.0, 170.0, 40.0, 60.0, 20.0, 50.0, 40.0, 30.0, 30.0, -5.0, 20.0, 20.0, 40.0, 40.0, 110.0, 80.0, 340.0, 65.0, 90.0, 40.0, 30.0, 140.0, 60.0, 80.0, 60.0, 5.0, 35.0, 40.0, 180.0, 0.0, 230.0, 60.0, 30.0, 5.0, 50.0, 60.0, 30.0, 70.0, 90.0, 150.0, 50.0, 10.0, 70.0, 40.0, 10.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 0.0, 190.0, 90.0, -50.0, 30.0, 160.0, 10.0, 30.0, 30.0, 150.0, 0.0, 10.0, -390.0, 40.0, -50.0, 120.0, 55.0, 10.0, 120.0, 330.0, 0.0, 150.0, 160.0, 30.0, 490.0, 280.0, 20.0, 110.0, 80.0, 60.0, 340.0, 100.0, 30.0, 80.0, 60.0, 200.0, 20.0, 110.0, 270.0, 30.0, 250.0, -55.0, 40.0, 50.0, 50.0, 450.0, 0.0, 60.0, 40.0, 100.0, 70.0, 10.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 40.0, 100.0, 30.0, 10.0, 270.0, 70.0, 280.0, 70.0, 140.0, 190.0, 50.0, 150.0, 130.0, 10.0, 90.0, 160.0, 60.0, 360.0, 0.0, 110.0, 40.0, 260.0, -20.0, 130.0, 90.0, 40.0, 10.0, 10.0, 180.0, 0.0, 10.0, 190.0, 80.0, 20.0, 0.0, -30.0, 10.0, 10.0, 50.0, 260.0, 0.0, 30.0, 40.0, 40.0, 30.0, 120.0, 320.0, 80.0, 80.0, 20.0, 60.0, 20.0, -50.0, 30.0, 160.0, 90.0, 30.0, 390.0, 210.0, 90.0, 30.0, 60.0, 70.0, -30.0, 50.0, 20.0, 350.0, 240.0, 90.0, 10.0, 50.0, 0.0, 15.0, 50.0, 110.0, 0.0, 120.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, 20.0, -30.0, 130.0, 100.0, 70.0, 90.0, 80.0, 110.0, 350.0, 290.0, 50.0, 60.0, 20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0, 30.0, 80.0, 40.0, 210.0, 90.0, 100.0, 20.0, 10.0, 20.0, 10.0, 30.0, 110.0, 10.0, 20.0, 0.0, 10.0, 110.0, 20.0, 60.0, 70.0, -10.0, 70.0, 280.0, 110.0, 100.0, 100.0, 380.0, -20.0, 290.0, 430.0, 180.0, 120.0, -10.0, 40.0, 0.0, 10.0, 0.0, 90.0, 60.0, 20.0, 50.0, 190.0, 230.0, 80.0, 40.0, 300.0, 140.0, 170.0, 100.0, 20.0, 0.0, 70.0, 35.0, 40.0, 120.0, 190.0, 60.0, -20.0, 130.0, 20.0, 70.0, 110.0, 0.0, -40.0, 30.0, 250.0, 630.0, 10.0, 310.0, 80.0, 190.0, 60.0, 540.0, 90.0, 150.0, 190.0, 160.0, 280.0, 120.0, 40.0, 60.0, 90.0, 70.0, 40.0, 540.0, 140.0, 180.0, 210.0, 20.0, 70.0, 10.0, 70.0, 20.0, 0.0, 40.0, 5.0, 190.0, 280.0, 25.0, 10.0, 50.0, 0.0, 50.0, 20.0, 40.0, 430.0, 230.0, 10.0, 80.0, 90.0, 30.0, 70.0, 30.0, 80.0, 50.0, 40.0, 250.0, 200.0, 50.0, 190.0, 50.0, 10.0, 90.0, 100.0, 60.0, 90.0, 370.0, 20.0, -40.0, -10.0, 110.0, 120.0, 10.0, 50.0, 20.0, 90.0, 40.0, 250.0, 20.0, 220.0, 170.0, 40.0, 160.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 10.0, 90.0, 20.0, 230.0, 120.0, 180.0, 70.0, 0.0, 240.0, 100.0, 20.0, 50.0, 70.0, 100.0, 80.0, 50.0, 160.0, 380.0, 260.0, 100.0, 20.0, 30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0, 30.0, 100.0, 130.0, 120.0, 190.0, -10.0, 10.0, 250.0, 300.0, 30.0, 90.0, 300.0, 10.0, -10.0, 170.0, 10.0, 60.0, 180.0, 380.0, 190.0, 260.0, 0.0, 200.0, -20.0, -50.0, 130.0, 30.0, 90.0, 70.0, 130.0, 170.0, 80.0, 230.0, 90.0, 70.0, 160.0, 70.0, 80.0, 310.0, 80.0, 130.0, 70.0, 80.0, 160.0, 500.0, 50.0, 0.0, 70.0, 60.0, 30.0, 60.0, -20.0, 20.0, 280.0, 170.0, 20.0, 160.0, 40.0, -20.0, 180.0, 240.0, 30.0, 370.0, 20.0, 100.0, 70.0, 20.0, 10.0, 60.0, 40.0, 90.0, 60.0, -70.0, 180.0, 130.0, 210.0, 40.0, -30.0, 60.0, 0.0, 90.0, 20.0, 80.0, 80.0, 90.0, 260.0, 70.0, 70.0, 80.0, 60.0, 10.0, 40.0, 25.0, 20.0, 200.0, 180.0, 400.0, 190.0, 110.0, 50.0, 110.0, 20.0, 720.0, -35.0, 130.0, 20.0, 160.0, 50.0, 170.0, 30.0, 380.0, 110.0, 90.0, 210.0, 55.0, 110.0, 310.0, 90.0, 140.0, 40.0, 60.0, 100.0, 80.0, 280.0, 50.0, 80.0, 230.0, 80.0, -10.0, 90.0, 10.0, 50.0, 30.0, 30.0, 20.0, 120.0, 380.0, 330.0, 0.0, 90.0, 190.0, 60.0, 30.0, 80.0, 80.0, 80.0, 50.0, 80.0, 100.0, 40.0, 410.0, 30.0, 0.0, 20.0, 120.0, 30.0, 30.0, 20.0, 20.0, 90.0, 90.0, 110.0, -10.0, 80.0, 120.0, 170.0, 110.0, 50.0, 420.0, 310.0, 200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5283376217711986, "mean_inference_ms": 1.417640914415121, "mean_action_processing_ms": 0.45607991819282384, "mean_env_wait_ms": 1.2457329677974933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224601745605469, "StateBufferConnector_ms": 0.01050710678100586, "ViewRequirementAgentConnector_ms": 0.3976457118988037}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": -20.0, "episode_return_mean": 990.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.090086038347696, "num_env_steps_trained_throughput_per_sec": 21.090086038347696, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 187420.633, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187420.587, "sample_time_ms": 2637.541, "learn_time_ms": 184762.173, "learn_throughput": 21.649, "synch_weights_time_ms": 10.936}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "33e63_00000", "date": "2024-06-19_04-02-24", "timestamp": 1718784144, "time_this_iter_s": 189.66903400421143, "time_total_s": 24925.55211043358, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278fe5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24925.55211043358, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 18.95671641791045, "ram_util_percent": 80.60111940298506}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7853868421845545, "cur_kl_coeff": 6.241896459403778, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004475664349567419, "vf_loss": 6.72213645778652, "vf_explained_var": -0.000802852418095159, "kl": Infinity, "entropy": 0.4029575680264523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 2160.0, "episode_reward_min": -20.0, "episode_reward_mean": 996.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 99.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1450.0, 790.0, 810.0, 800.0, 470.0, 950.0, 360.0, 610.0, 1310.0, 1350.0, 1310.0, 1240.0, 1150.0, 845.0, 1230.0, 1040.0, 900.0, 1345.0, 500.0, 1680.0, 285.0, 1035.0, 645.0, 620.0, 840.0, -20.0, 935.0, 1540.0, 1005.0, 830.0, 640.0, 1180.0, 1190.0, 540.0, 440.0, 840.0, 990.0, 935.0, 480.0, 1330.0, 890.0, 610.0, 440.0, 1730.0, 510.0, 1320.0, 645.0, 1450.0, 1820.0, 1420.0, 650.0, 1000.0, 990.0, 740.0, 930.0, 470.0, 1070.0, 1270.0, 1440.0, 1150.0, 1380.0, 840.0, 1340.0, 1150.0, 890.0, 960.0, 670.0, 900.0, 1225.0, 1375.0, 1535.0, 1040.0, 1060.0, 790.0, 770.0, 1450.0, 875.0, 2160.0, 1110.0, 1540.0, 330.0, 1300.0, 610.0, 1105.0, 1550.0, 560.0, 995.0, 1530.0, 1140.0, 595.0, 1145.0, 675.0, 990.0, 1710.0, 1140.0, 885.0, 1110.0, 740.0, 1125.0, 360.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 130.0, 120.0, 170.0, 130.0, 250.0, 150.0, 200.0, 140.0, 40.0, 80.0, 40.0, 20.0, 10.0, 220.0, 300.0, -40.0, 60.0, 90.0, 10.0, 50.0, 300.0, 70.0, 60.0, 80.0, 180.0, 40.0, -20.0, 40.0, 10.0, 250.0, 120.0, 60.0, 30.0, 20.0, 70.0, 30.0, 120.0, 40.0, 60.0, 130.0, 30.0, 0.0, 10.0, 30.0, 150.0, -10.0, 50.0, 70.0, 10.0, 30.0, -10.0, 80.0, -10.0, 180.0, 40.0, 30.0, 180.0, 360.0, 70.0, 40.0, 40.0, 30.0, 0.0, 0.0, 180.0, 20.0, 10.0, 20.0, 20.0, 60.0, 30.0, 10.0, 140.0, 0.0, 180.0, 80.0, 60.0, 40.0, 10.0, 180.0, 340.0, 200.0, 110.0, 50.0, 70.0, 150.0, 40.0, 40.0, 130.0, 150.0, 10.0, 130.0, -240.0, 80.0, 440.0, 300.0, 100.0, 210.0, 170.0, 70.0, 100.0, 220.0, 60.0, 200.0, 340.0, 50.0, 100.0, 180.0, -10.0, 120.0, 110.0, 220.0, 200.0, 20.0, 50.0, 100.0, 250.0, 130.0, 40.0, 230.0, -40.0, 55.0, 120.0, 70.0, 95.0, 160.0, 160.0, 100.0, 200.0, 90.0, 30.0, 250.0, 40.0, 40.0, 100.0, 85.0, 100.0, 60.0, 50.0, 150.0, 90.0, 300.0, 40.0, 60.0, 70.0, 170.0, 40.0, 150.0, 160.0, 190.0, 310.0, 50.0, 40.0, 50.0, 170.0, 60.0, 100.0, 30.0, 40.0, 130.0, 100.0, 40.0, 40.0, 80.0, 190.0, 70.0, 50.0, 80.0, 120.0, 80.0, -5.0, 20.0, 80.0, 110.0, 240.0, 140.0, 200.0, 80.0, 400.0, 30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0, 0.0, 180.0, 450.0, 300.0, 300.0, 120.0, 60.0, 170.0, 40.0, 60.0, 20.0, 50.0, 40.0, 30.0, 30.0, -5.0, 20.0, 20.0, 40.0, 40.0, 110.0, 80.0, 340.0, 65.0, 90.0, 40.0, 30.0, 140.0, 60.0, 80.0, 60.0, 5.0, 35.0, 40.0, 180.0, 0.0, 230.0, 60.0, 30.0, 5.0, 50.0, 60.0, 30.0, 70.0, 90.0, 150.0, 50.0, 10.0, 70.0, 40.0, 10.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 0.0, 190.0, 90.0, -50.0, 30.0, 160.0, 10.0, 30.0, 30.0, 150.0, 0.0, 10.0, -390.0, 40.0, -50.0, 120.0, 55.0, 10.0, 120.0, 330.0, 0.0, 150.0, 160.0, 30.0, 490.0, 280.0, 20.0, 110.0, 80.0, 60.0, 340.0, 100.0, 30.0, 80.0, 60.0, 200.0, 20.0, 110.0, 270.0, 30.0, 250.0, -55.0, 40.0, 50.0, 50.0, 450.0, 0.0, 60.0, 40.0, 100.0, 70.0, 10.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 40.0, 100.0, 30.0, 10.0, 270.0, 70.0, 280.0, 70.0, 140.0, 190.0, 50.0, 150.0, 130.0, 10.0, 90.0, 160.0, 60.0, 360.0, 0.0, 110.0, 40.0, 260.0, -20.0, 130.0, 90.0, 40.0, 10.0, 10.0, 180.0, 0.0, 10.0, 190.0, 80.0, 20.0, 0.0, -30.0, 10.0, 10.0, 50.0, 260.0, 0.0, 30.0, 40.0, 40.0, 30.0, 120.0, 320.0, 80.0, 80.0, 20.0, 60.0, 20.0, -50.0, 30.0, 160.0, 90.0, 30.0, 390.0, 210.0, 90.0, 30.0, 60.0, 70.0, -30.0, 50.0, 20.0, 350.0, 240.0, 90.0, 10.0, 50.0, 0.0, 15.0, 50.0, 110.0, 0.0, 120.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, 20.0, -30.0, 130.0, 100.0, 70.0, 90.0, 80.0, 110.0, 350.0, 290.0, 50.0, 60.0, 20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0, 30.0, 80.0, 40.0, 210.0, 90.0, 100.0, 20.0, 10.0, 20.0, 10.0, 30.0, 110.0, 10.0, 20.0, 0.0, 10.0, 110.0, 20.0, 60.0, 70.0, -10.0, 70.0, 280.0, 110.0, 100.0, 100.0, 380.0, -20.0, 290.0, 430.0, 180.0, 120.0, -10.0, 40.0, 0.0, 10.0, 0.0, 90.0, 60.0, 20.0, 50.0, 190.0, 230.0, 80.0, 40.0, 300.0, 140.0, 170.0, 100.0, 20.0, 0.0, 70.0, 35.0, 40.0, 120.0, 190.0, 60.0, -20.0, 130.0, 20.0, 70.0, 110.0, 0.0, -40.0, 30.0, 250.0, 630.0, 10.0, 310.0, 80.0, 190.0, 60.0, 540.0, 90.0, 150.0, 190.0, 160.0, 280.0, 120.0, 40.0, 60.0, 90.0, 70.0, 40.0, 540.0, 140.0, 180.0, 210.0, 20.0, 70.0, 10.0, 70.0, 20.0, 0.0, 40.0, 5.0, 190.0, 280.0, 25.0, 10.0, 50.0, 0.0, 50.0, 20.0, 40.0, 430.0, 230.0, 10.0, 80.0, 90.0, 30.0, 70.0, 30.0, 80.0, 50.0, 40.0, 250.0, 200.0, 50.0, 190.0, 50.0, 10.0, 90.0, 100.0, 60.0, 90.0, 370.0, 20.0, -40.0, -10.0, 110.0, 120.0, 10.0, 50.0, 20.0, 90.0, 40.0, 250.0, 20.0, 220.0, 170.0, 40.0, 160.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 10.0, 90.0, 20.0, 230.0, 120.0, 180.0, 70.0, 0.0, 240.0, 100.0, 20.0, 50.0, 70.0, 100.0, 80.0, 50.0, 160.0, 380.0, 260.0, 100.0, 20.0, 30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0, 30.0, 100.0, 130.0, 120.0, 190.0, -10.0, 10.0, 250.0, 300.0, 30.0, 90.0, 300.0, 10.0, -10.0, 170.0, 10.0, 60.0, 180.0, 380.0, 190.0, 260.0, 0.0, 200.0, -20.0, -50.0, 130.0, 30.0, 90.0, 70.0, 130.0, 170.0, 80.0, 230.0, 90.0, 70.0, 160.0, 70.0, 80.0, 310.0, 80.0, 130.0, 70.0, 80.0, 160.0, 500.0, 50.0, 0.0, 70.0, 60.0, 30.0, 60.0, -20.0, 20.0, 280.0, 170.0, 20.0, 160.0, 40.0, -20.0, 180.0, 240.0, 30.0, 370.0, 20.0, 100.0, 70.0, 20.0, 10.0, 60.0, 40.0, 90.0, 60.0, -70.0, 180.0, 130.0, 210.0, 40.0, -30.0, 60.0, 0.0, 90.0, 20.0, 80.0, 80.0, 90.0, 260.0, 70.0, 70.0, 80.0, 60.0, 10.0, 40.0, 25.0, 20.0, 200.0, 180.0, 400.0, 190.0, 110.0, 50.0, 110.0, 20.0, 720.0, -35.0, 130.0, 20.0, 160.0, 50.0, 170.0, 30.0, 380.0, 110.0, 90.0, 210.0, 55.0, 110.0, 310.0, 90.0, 140.0, 40.0, 60.0, 100.0, 80.0, 280.0, 50.0, 80.0, 230.0, 80.0, -10.0, 90.0, 10.0, 50.0, 30.0, 30.0, 20.0, 120.0, 380.0, 330.0, 0.0, 90.0, 190.0, 60.0, 30.0, 80.0, 80.0, 80.0, 50.0, 80.0, 100.0, 40.0, 410.0, 30.0, 0.0, 20.0, 120.0, 30.0, 30.0, 20.0, 20.0, 90.0, 90.0, 110.0, -10.0, 80.0, 120.0, 170.0, 110.0, 50.0, 420.0, 310.0, 200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0, 650.0, 220.0, -10.0, 620.0, 40.0, 320.0, 100.0, 50.0, 20.0, 150.0, 190.0, 90.0, 10.0, 100.0, -80.0, 470.0, 200.0, 70.0, 0.0, 60.0, 270.0, 120.0, 30.0, 50.0, 50.0, 70.0, 60.0, 410.0, 130.0, 350.0, 20.0, -30.0, 30.0, 10.0, 0.0, 20.0, 260.0, 10.0, 0.0, 10.0, 160.0, 360.0, 290.0, 210.0, 40.0, 120.0, 80.0, 20.0, -30.0, 50.0, 40.0, 40.0, 20.0, 10.0, 180.0, -30.0, 40.0, 260.0, 20.0, 30.0, 20.0, 150.0, 130.0, 30.0, 170.0, 20.0, 390.0, 80.0, -45.0, 160.0, 60.0, 60.0, 130.0, 50.0, 70.0, 70.0, 560.0, 100.0, 230.0, 220.0, -20.0, 10.0, 40.0, 10.0, 60.0, 30.0, 40.0, 470.0, 60.0, -140.0, 100.0, 75.0, 40.0, 580.0, 0.0, 50.0, 80.0, 70.0, -30.0, 30.0, 490.0, 140.0, 80.0, 50.0, 230.0, 130.0, 110.0, 190.0, 60.0, 50.0, 30.0, 280.0, 40.0, 220.0, 30.0, 90.0, 80.0, 150.0, 200.0, 20.0, 40.0, 140.0, 30.0, 30.0, 25.0, 170.0, 40.0, 20.0, 20.0, 80.0, 70.0, 80.0, 160.0, 360.0, 100.0, 150.0, 180.0, 55.0, -30.0, 20.0, 40.0, 30.0, 260.0, 125.0, -80.0, -30.0, 30.0, 50.0, 90.0, 160.0, 200.0, 20.0, 40.0, 0.0, 170.0, 70.0, 50.0, 0.0, 360.0, 80.0, 20.0, 140.0, 80.0, 170.0, 360.0, 500.0, 120.0, 190.0, 20.0, 110.0, 130.0, 10.0, 360.0, 120.0, 70.0, 180.0, 150.0, 40.0, 60.0, 20.0, 60.0, 40.0, 270.0, 70.0, 310.0, 35.0, 40.0, 35.0, 5.0, 20.0, 40.0, 60.0, 60.0, 240.0, 290.0, 40.0, 0.0, 40.0, 230.0, 110.0, 60.0, 130.0, 50.0, 60.0, 20.0, 140.0, 80.0, 20.0, 120.0, 60.0, 430.0, 150.0, 210.0, 20.0, 90.0, 55.0, 60.0, 50.0, 30.0, 30.0, 0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.528553314559758, "mean_inference_ms": 1.416796884578521, "mean_action_processing_ms": 0.45417823264206925, "mean_env_wait_ms": 1.2455137997182855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013249874114990234, "StateBufferConnector_ms": 0.010525941848754883, "ViewRequirementAgentConnector_ms": 0.39849257469177246}, "num_episodes": 23, "episode_return_max": 2160.0, "episode_return_min": -20.0, "episode_return_mean": 996.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.036510643006356, "num_env_steps_trained_throughput_per_sec": 21.036510643006356, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 187804.604, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187804.558, "sample_time_ms": 2665.168, "learn_time_ms": 185116.877, "learn_throughput": 21.608, "synch_weights_time_ms": 11.265}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "33e63_00000", "date": "2024-06-19_04-05-34", "timestamp": 1718784334, "time_this_iter_s": 190.16652297973633, "time_total_s": 25115.718633413315, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278fee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25115.718633413315, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 18.460594795539034, "ram_util_percent": 79.98438661710037}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1186635750360763, "cur_kl_coeff": 9.362844689105668, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003364975755033505, "vf_loss": 7.501999004047138, "vf_explained_var": 0.0008098525741991524, "kl": Infinity, "entropy": 0.3618580542607937, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 2160.0, "episode_reward_min": -20.0, "episode_reward_mean": 1005.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -390.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 100.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 1680.0, 285.0, 1035.0, 645.0, 620.0, 840.0, -20.0, 935.0, 1540.0, 1005.0, 830.0, 640.0, 1180.0, 1190.0, 540.0, 440.0, 840.0, 990.0, 935.0, 480.0, 1330.0, 890.0, 610.0, 440.0, 1730.0, 510.0, 1320.0, 645.0, 1450.0, 1820.0, 1420.0, 650.0, 1000.0, 990.0, 740.0, 930.0, 470.0, 1070.0, 1270.0, 1440.0, 1150.0, 1380.0, 840.0, 1340.0, 1150.0, 890.0, 960.0, 670.0, 900.0, 1225.0, 1375.0, 1535.0, 1040.0, 1060.0, 790.0, 770.0, 1450.0, 875.0, 2160.0, 1110.0, 1540.0, 330.0, 1300.0, 610.0, 1105.0, 1550.0, 560.0, 995.0, 1530.0, 1140.0, 595.0, 1145.0, 675.0, 990.0, 1710.0, 1140.0, 885.0, 1110.0, 740.0, 1125.0, 360.0, 1570.0, 1780.0, 650.0, 925.0, 1000.0, 665.0, 540.0, 1590.0, 1420.0, 740.0, 1300.0, 1310.0, 770.0, 505.0, 1100.0, 1335.0, 890.0, 800.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 170.0, 40.0, 10.0, 120.0, 10.0, 0.0, 60.0, 30.0, 30.0, 0.0, 180.0, 450.0, 300.0, 300.0, 120.0, 60.0, 170.0, 40.0, 60.0, 20.0, 50.0, 40.0, 30.0, 30.0, -5.0, 20.0, 20.0, 40.0, 40.0, 110.0, 80.0, 340.0, 65.0, 90.0, 40.0, 30.0, 140.0, 60.0, 80.0, 60.0, 5.0, 35.0, 40.0, 180.0, 0.0, 230.0, 60.0, 30.0, 5.0, 50.0, 60.0, 30.0, 70.0, 90.0, 150.0, 50.0, 10.0, 70.0, 40.0, 10.0, 80.0, 40.0, 180.0, 70.0, 90.0, 90.0, 0.0, 190.0, 90.0, -50.0, 30.0, 160.0, 10.0, 30.0, 30.0, 150.0, 0.0, 10.0, -390.0, 40.0, -50.0, 120.0, 55.0, 10.0, 120.0, 330.0, 0.0, 150.0, 160.0, 30.0, 490.0, 280.0, 20.0, 110.0, 80.0, 60.0, 340.0, 100.0, 30.0, 80.0, 60.0, 200.0, 20.0, 110.0, 270.0, 30.0, 250.0, -55.0, 40.0, 50.0, 50.0, 450.0, 0.0, 60.0, 40.0, 100.0, 70.0, 10.0, 0.0, 40.0, 60.0, 50.0, 30.0, 10.0, 40.0, 100.0, 30.0, 10.0, 270.0, 70.0, 280.0, 70.0, 140.0, 190.0, 50.0, 150.0, 130.0, 10.0, 90.0, 160.0, 60.0, 360.0, 0.0, 110.0, 40.0, 260.0, -20.0, 130.0, 90.0, 40.0, 10.0, 10.0, 180.0, 0.0, 10.0, 190.0, 80.0, 20.0, 0.0, -30.0, 10.0, 10.0, 50.0, 260.0, 0.0, 30.0, 40.0, 40.0, 30.0, 120.0, 320.0, 80.0, 80.0, 20.0, 60.0, 20.0, -50.0, 30.0, 160.0, 90.0, 30.0, 390.0, 210.0, 90.0, 30.0, 60.0, 70.0, -30.0, 50.0, 20.0, 350.0, 240.0, 90.0, 10.0, 50.0, 0.0, 15.0, 50.0, 110.0, 0.0, 120.0, 0.0, 40.0, 90.0, 190.0, 10.0, 40.0, 20.0, -30.0, 130.0, 100.0, 70.0, 90.0, 80.0, 110.0, 350.0, 290.0, 50.0, 60.0, 20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0, 30.0, 80.0, 40.0, 210.0, 90.0, 100.0, 20.0, 10.0, 20.0, 10.0, 30.0, 110.0, 10.0, 20.0, 0.0, 10.0, 110.0, 20.0, 60.0, 70.0, -10.0, 70.0, 280.0, 110.0, 100.0, 100.0, 380.0, -20.0, 290.0, 430.0, 180.0, 120.0, -10.0, 40.0, 0.0, 10.0, 0.0, 90.0, 60.0, 20.0, 50.0, 190.0, 230.0, 80.0, 40.0, 300.0, 140.0, 170.0, 100.0, 20.0, 0.0, 70.0, 35.0, 40.0, 120.0, 190.0, 60.0, -20.0, 130.0, 20.0, 70.0, 110.0, 0.0, -40.0, 30.0, 250.0, 630.0, 10.0, 310.0, 80.0, 190.0, 60.0, 540.0, 90.0, 150.0, 190.0, 160.0, 280.0, 120.0, 40.0, 60.0, 90.0, 70.0, 40.0, 540.0, 140.0, 180.0, 210.0, 20.0, 70.0, 10.0, 70.0, 20.0, 0.0, 40.0, 5.0, 190.0, 280.0, 25.0, 10.0, 50.0, 0.0, 50.0, 20.0, 40.0, 430.0, 230.0, 10.0, 80.0, 90.0, 30.0, 70.0, 30.0, 80.0, 50.0, 40.0, 250.0, 200.0, 50.0, 190.0, 50.0, 10.0, 90.0, 100.0, 60.0, 90.0, 370.0, 20.0, -40.0, -10.0, 110.0, 120.0, 10.0, 50.0, 20.0, 90.0, 40.0, 250.0, 20.0, 220.0, 170.0, 40.0, 160.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 10.0, 90.0, 20.0, 230.0, 120.0, 180.0, 70.0, 0.0, 240.0, 100.0, 20.0, 50.0, 70.0, 100.0, 80.0, 50.0, 160.0, 380.0, 260.0, 100.0, 20.0, 30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0, 30.0, 100.0, 130.0, 120.0, 190.0, -10.0, 10.0, 250.0, 300.0, 30.0, 90.0, 300.0, 10.0, -10.0, 170.0, 10.0, 60.0, 180.0, 380.0, 190.0, 260.0, 0.0, 200.0, -20.0, -50.0, 130.0, 30.0, 90.0, 70.0, 130.0, 170.0, 80.0, 230.0, 90.0, 70.0, 160.0, 70.0, 80.0, 310.0, 80.0, 130.0, 70.0, 80.0, 160.0, 500.0, 50.0, 0.0, 70.0, 60.0, 30.0, 60.0, -20.0, 20.0, 280.0, 170.0, 20.0, 160.0, 40.0, -20.0, 180.0, 240.0, 30.0, 370.0, 20.0, 100.0, 70.0, 20.0, 10.0, 60.0, 40.0, 90.0, 60.0, -70.0, 180.0, 130.0, 210.0, 40.0, -30.0, 60.0, 0.0, 90.0, 20.0, 80.0, 80.0, 90.0, 260.0, 70.0, 70.0, 80.0, 60.0, 10.0, 40.0, 25.0, 20.0, 200.0, 180.0, 400.0, 190.0, 110.0, 50.0, 110.0, 20.0, 720.0, -35.0, 130.0, 20.0, 160.0, 50.0, 170.0, 30.0, 380.0, 110.0, 90.0, 210.0, 55.0, 110.0, 310.0, 90.0, 140.0, 40.0, 60.0, 100.0, 80.0, 280.0, 50.0, 80.0, 230.0, 80.0, -10.0, 90.0, 10.0, 50.0, 30.0, 30.0, 20.0, 120.0, 380.0, 330.0, 0.0, 90.0, 190.0, 60.0, 30.0, 80.0, 80.0, 80.0, 50.0, 80.0, 100.0, 40.0, 410.0, 30.0, 0.0, 20.0, 120.0, 30.0, 30.0, 20.0, 20.0, 90.0, 90.0, 110.0, -10.0, 80.0, 120.0, 170.0, 110.0, 50.0, 420.0, 310.0, 200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0, 650.0, 220.0, -10.0, 620.0, 40.0, 320.0, 100.0, 50.0, 20.0, 150.0, 190.0, 90.0, 10.0, 100.0, -80.0, 470.0, 200.0, 70.0, 0.0, 60.0, 270.0, 120.0, 30.0, 50.0, 50.0, 70.0, 60.0, 410.0, 130.0, 350.0, 20.0, -30.0, 30.0, 10.0, 0.0, 20.0, 260.0, 10.0, 0.0, 10.0, 160.0, 360.0, 290.0, 210.0, 40.0, 120.0, 80.0, 20.0, -30.0, 50.0, 40.0, 40.0, 20.0, 10.0, 180.0, -30.0, 40.0, 260.0, 20.0, 30.0, 20.0, 150.0, 130.0, 30.0, 170.0, 20.0, 390.0, 80.0, -45.0, 160.0, 60.0, 60.0, 130.0, 50.0, 70.0, 70.0, 560.0, 100.0, 230.0, 220.0, -20.0, 10.0, 40.0, 10.0, 60.0, 30.0, 40.0, 470.0, 60.0, -140.0, 100.0, 75.0, 40.0, 580.0, 0.0, 50.0, 80.0, 70.0, -30.0, 30.0, 490.0, 140.0, 80.0, 50.0, 230.0, 130.0, 110.0, 190.0, 60.0, 50.0, 30.0, 280.0, 40.0, 220.0, 30.0, 90.0, 80.0, 150.0, 200.0, 20.0, 40.0, 140.0, 30.0, 30.0, 25.0, 170.0, 40.0, 20.0, 20.0, 80.0, 70.0, 80.0, 160.0, 360.0, 100.0, 150.0, 180.0, 55.0, -30.0, 20.0, 40.0, 30.0, 260.0, 125.0, -80.0, -30.0, 30.0, 50.0, 90.0, 160.0, 200.0, 20.0, 40.0, 0.0, 170.0, 70.0, 50.0, 0.0, 360.0, 80.0, 20.0, 140.0, 80.0, 170.0, 360.0, 500.0, 120.0, 190.0, 20.0, 110.0, 130.0, 10.0, 360.0, 120.0, 70.0, 180.0, 150.0, 40.0, 60.0, 20.0, 60.0, 40.0, 270.0, 70.0, 310.0, 35.0, 40.0, 35.0, 5.0, 20.0, 40.0, 60.0, 60.0, 240.0, 290.0, 40.0, 0.0, 40.0, 230.0, 110.0, 60.0, 130.0, 50.0, 60.0, 20.0, 140.0, 80.0, 20.0, 120.0, 60.0, 430.0, 150.0, 210.0, 20.0, 90.0, 55.0, 60.0, 50.0, 30.0, 30.0, 0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0, 120.0, 10.0, 40.0, 220.0, -10.0, 110.0, 70.0, 460.0, 190.0, 360.0, 80.0, 80.0, 280.0, 370.0, 90.0, 70.0, 80.0, 490.0, 200.0, 40.0, 20.0, 0.0, 290.0, 30.0, 20.0, 50.0, 20.0, 20.0, 170.0, 30.0, 25.0, 550.0, 100.0, 50.0, -30.0, 50.0, 50.0, 40.0, 60.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 500.0, 250.0, 100.0, 290.0, 80.0, 40.0, 25.0, 40.0, 50.0, 10.0, 90.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 110.0, 270.0, 0.0, 60.0, 0.0, 30.0, 50.0, 300.0, 240.0, 80.0, -10.0, 120.0, 220.0, 100.0, 460.0, 30.0, 230.0, 110.0, 170.0, 50.0, 50.0, 70.0, 90.0, 90.0, 50.0, 510.0, 10.0, 10.0, 20.0, 70.0, -30.0, 40.0, 40.0, -20.0, 120.0, 480.0, 40.0, 180.0, 30.0, 50.0, 20.0, 80.0, 100.0, 160.0, 80.0, 560.0, 200.0, 70.0, 60.0, 50.0, 60.0, 180.0, 40.0, 110.0, 130.0, 410.0, 40.0, 80.0, 20.0, 10.0, 10.0, 190.0, 90.0, 90.0, 120.0, 120.0, 0.0, 80.0, 40.0, 35.0, 10.0, 30.0, 30.0, 20.0, 90.0, 170.0, 90.0, 40.0, -30.0, 40.0, 160.0, 300.0, 20.0, 180.0, 290.0, 10.0, 55.0, 120.0, 40.0, -30.0, 680.0, 310.0, 40.0, 20.0, 30.0, 70.0, 100.0, 40.0, 50.0, 200.0, 150.0, 100.0, 180.0, 10.0, 40.0, 20.0, 20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5284439978439108, "mean_inference_ms": 1.4178873437258415, "mean_action_processing_ms": 0.4550794991208552, "mean_env_wait_ms": 1.2455558753115434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012266397476196289, "StateBufferConnector_ms": 0.010449886322021484, "ViewRequirementAgentConnector_ms": 0.393341064453125}, "num_episodes": 18, "episode_return_max": 2160.0, "episode_return_min": -20.0, "episode_return_mean": 1005.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.31537339551393, "num_env_steps_trained_throughput_per_sec": 21.31537339551393, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 187776.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187776.114, "sample_time_ms": 2688.704, "learn_time_ms": 185063.82, "learn_throughput": 21.614, "synch_weights_time_ms": 11.344}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "33e63_00000", "date": "2024-06-19_04-08-42", "timestamp": 1718784522, "time_this_iter_s": 187.68840909004211, "time_total_s": 25303.407042503357, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278feee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25303.407042503357, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 17.136466165413538, "ram_util_percent": 79.47105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7149116906368187, "cur_kl_coeff": 14.044267033658507, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0032078695551445656, "vf_loss": 7.296661182968253, "vf_explained_var": 0.00027498557798651715, "kl": Infinity, "entropy": 0.35210008514098845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 2160.0, "episode_reward_min": 240.0, "episode_reward_mean": 1059.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 105.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [890.0, 610.0, 440.0, 1730.0, 510.0, 1320.0, 645.0, 1450.0, 1820.0, 1420.0, 650.0, 1000.0, 990.0, 740.0, 930.0, 470.0, 1070.0, 1270.0, 1440.0, 1150.0, 1380.0, 840.0, 1340.0, 1150.0, 890.0, 960.0, 670.0, 900.0, 1225.0, 1375.0, 1535.0, 1040.0, 1060.0, 790.0, 770.0, 1450.0, 875.0, 2160.0, 1110.0, 1540.0, 330.0, 1300.0, 610.0, 1105.0, 1550.0, 560.0, 995.0, 1530.0, 1140.0, 595.0, 1145.0, 675.0, 990.0, 1710.0, 1140.0, 885.0, 1110.0, 740.0, 1125.0, 360.0, 1570.0, 1780.0, 650.0, 925.0, 1000.0, 665.0, 540.0, 1590.0, 1420.0, 740.0, 1300.0, 1310.0, 770.0, 505.0, 1100.0, 1335.0, 890.0, 800.0, 1190.0, 910.0, 715.0, 870.0, 995.0, 1620.0, 695.0, 1950.0, 630.0, 1460.0, 1280.0, 1170.0, 820.0, 1360.0, 240.0, 1165.0, 600.0, 1230.0, 1170.0, 1595.0, 680.0, 1530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 150.0, 10.0, 30.0, 0.0, 180.0, 40.0, 190.0, 30.0, 240.0, 30.0, 80.0, 40.0, 210.0, 90.0, 100.0, 20.0, 10.0, 20.0, 10.0, 30.0, 110.0, 10.0, 20.0, 0.0, 10.0, 110.0, 20.0, 60.0, 70.0, -10.0, 70.0, 280.0, 110.0, 100.0, 100.0, 380.0, -20.0, 290.0, 430.0, 180.0, 120.0, -10.0, 40.0, 0.0, 10.0, 0.0, 90.0, 60.0, 20.0, 50.0, 190.0, 230.0, 80.0, 40.0, 300.0, 140.0, 170.0, 100.0, 20.0, 0.0, 70.0, 35.0, 40.0, 120.0, 190.0, 60.0, -20.0, 130.0, 20.0, 70.0, 110.0, 0.0, -40.0, 30.0, 250.0, 630.0, 10.0, 310.0, 80.0, 190.0, 60.0, 540.0, 90.0, 150.0, 190.0, 160.0, 280.0, 120.0, 40.0, 60.0, 90.0, 70.0, 40.0, 540.0, 140.0, 180.0, 210.0, 20.0, 70.0, 10.0, 70.0, 20.0, 0.0, 40.0, 5.0, 190.0, 280.0, 25.0, 10.0, 50.0, 0.0, 50.0, 20.0, 40.0, 430.0, 230.0, 10.0, 80.0, 90.0, 30.0, 70.0, 30.0, 80.0, 50.0, 40.0, 250.0, 200.0, 50.0, 190.0, 50.0, 10.0, 90.0, 100.0, 60.0, 90.0, 370.0, 20.0, -40.0, -10.0, 110.0, 120.0, 10.0, 50.0, 20.0, 90.0, 40.0, 250.0, 20.0, 220.0, 170.0, 40.0, 160.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 10.0, 90.0, 20.0, 230.0, 120.0, 180.0, 70.0, 0.0, 240.0, 100.0, 20.0, 50.0, 70.0, 100.0, 80.0, 50.0, 160.0, 380.0, 260.0, 100.0, 20.0, 30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0, 30.0, 100.0, 130.0, 120.0, 190.0, -10.0, 10.0, 250.0, 300.0, 30.0, 90.0, 300.0, 10.0, -10.0, 170.0, 10.0, 60.0, 180.0, 380.0, 190.0, 260.0, 0.0, 200.0, -20.0, -50.0, 130.0, 30.0, 90.0, 70.0, 130.0, 170.0, 80.0, 230.0, 90.0, 70.0, 160.0, 70.0, 80.0, 310.0, 80.0, 130.0, 70.0, 80.0, 160.0, 500.0, 50.0, 0.0, 70.0, 60.0, 30.0, 60.0, -20.0, 20.0, 280.0, 170.0, 20.0, 160.0, 40.0, -20.0, 180.0, 240.0, 30.0, 370.0, 20.0, 100.0, 70.0, 20.0, 10.0, 60.0, 40.0, 90.0, 60.0, -70.0, 180.0, 130.0, 210.0, 40.0, -30.0, 60.0, 0.0, 90.0, 20.0, 80.0, 80.0, 90.0, 260.0, 70.0, 70.0, 80.0, 60.0, 10.0, 40.0, 25.0, 20.0, 200.0, 180.0, 400.0, 190.0, 110.0, 50.0, 110.0, 20.0, 720.0, -35.0, 130.0, 20.0, 160.0, 50.0, 170.0, 30.0, 380.0, 110.0, 90.0, 210.0, 55.0, 110.0, 310.0, 90.0, 140.0, 40.0, 60.0, 100.0, 80.0, 280.0, 50.0, 80.0, 230.0, 80.0, -10.0, 90.0, 10.0, 50.0, 30.0, 30.0, 20.0, 120.0, 380.0, 330.0, 0.0, 90.0, 190.0, 60.0, 30.0, 80.0, 80.0, 80.0, 50.0, 80.0, 100.0, 40.0, 410.0, 30.0, 0.0, 20.0, 120.0, 30.0, 30.0, 20.0, 20.0, 90.0, 90.0, 110.0, -10.0, 80.0, 120.0, 170.0, 110.0, 50.0, 420.0, 310.0, 200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0, 650.0, 220.0, -10.0, 620.0, 40.0, 320.0, 100.0, 50.0, 20.0, 150.0, 190.0, 90.0, 10.0, 100.0, -80.0, 470.0, 200.0, 70.0, 0.0, 60.0, 270.0, 120.0, 30.0, 50.0, 50.0, 70.0, 60.0, 410.0, 130.0, 350.0, 20.0, -30.0, 30.0, 10.0, 0.0, 20.0, 260.0, 10.0, 0.0, 10.0, 160.0, 360.0, 290.0, 210.0, 40.0, 120.0, 80.0, 20.0, -30.0, 50.0, 40.0, 40.0, 20.0, 10.0, 180.0, -30.0, 40.0, 260.0, 20.0, 30.0, 20.0, 150.0, 130.0, 30.0, 170.0, 20.0, 390.0, 80.0, -45.0, 160.0, 60.0, 60.0, 130.0, 50.0, 70.0, 70.0, 560.0, 100.0, 230.0, 220.0, -20.0, 10.0, 40.0, 10.0, 60.0, 30.0, 40.0, 470.0, 60.0, -140.0, 100.0, 75.0, 40.0, 580.0, 0.0, 50.0, 80.0, 70.0, -30.0, 30.0, 490.0, 140.0, 80.0, 50.0, 230.0, 130.0, 110.0, 190.0, 60.0, 50.0, 30.0, 280.0, 40.0, 220.0, 30.0, 90.0, 80.0, 150.0, 200.0, 20.0, 40.0, 140.0, 30.0, 30.0, 25.0, 170.0, 40.0, 20.0, 20.0, 80.0, 70.0, 80.0, 160.0, 360.0, 100.0, 150.0, 180.0, 55.0, -30.0, 20.0, 40.0, 30.0, 260.0, 125.0, -80.0, -30.0, 30.0, 50.0, 90.0, 160.0, 200.0, 20.0, 40.0, 0.0, 170.0, 70.0, 50.0, 0.0, 360.0, 80.0, 20.0, 140.0, 80.0, 170.0, 360.0, 500.0, 120.0, 190.0, 20.0, 110.0, 130.0, 10.0, 360.0, 120.0, 70.0, 180.0, 150.0, 40.0, 60.0, 20.0, 60.0, 40.0, 270.0, 70.0, 310.0, 35.0, 40.0, 35.0, 5.0, 20.0, 40.0, 60.0, 60.0, 240.0, 290.0, 40.0, 0.0, 40.0, 230.0, 110.0, 60.0, 130.0, 50.0, 60.0, 20.0, 140.0, 80.0, 20.0, 120.0, 60.0, 430.0, 150.0, 210.0, 20.0, 90.0, 55.0, 60.0, 50.0, 30.0, 30.0, 0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0, 120.0, 10.0, 40.0, 220.0, -10.0, 110.0, 70.0, 460.0, 190.0, 360.0, 80.0, 80.0, 280.0, 370.0, 90.0, 70.0, 80.0, 490.0, 200.0, 40.0, 20.0, 0.0, 290.0, 30.0, 20.0, 50.0, 20.0, 20.0, 170.0, 30.0, 25.0, 550.0, 100.0, 50.0, -30.0, 50.0, 50.0, 40.0, 60.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 500.0, 250.0, 100.0, 290.0, 80.0, 40.0, 25.0, 40.0, 50.0, 10.0, 90.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 110.0, 270.0, 0.0, 60.0, 0.0, 30.0, 50.0, 300.0, 240.0, 80.0, -10.0, 120.0, 220.0, 100.0, 460.0, 30.0, 230.0, 110.0, 170.0, 50.0, 50.0, 70.0, 90.0, 90.0, 50.0, 510.0, 10.0, 10.0, 20.0, 70.0, -30.0, 40.0, 40.0, -20.0, 120.0, 480.0, 40.0, 180.0, 30.0, 50.0, 20.0, 80.0, 100.0, 160.0, 80.0, 560.0, 200.0, 70.0, 60.0, 50.0, 60.0, 180.0, 40.0, 110.0, 130.0, 410.0, 40.0, 80.0, 20.0, 10.0, 10.0, 190.0, 90.0, 90.0, 120.0, 120.0, 0.0, 80.0, 40.0, 35.0, 10.0, 30.0, 30.0, 20.0, 90.0, 170.0, 90.0, 40.0, -30.0, 40.0, 160.0, 300.0, 20.0, 180.0, 290.0, 10.0, 55.0, 120.0, 40.0, -30.0, 680.0, 310.0, 40.0, 20.0, 30.0, 70.0, 100.0, 40.0, 50.0, 200.0, 150.0, 100.0, 180.0, 10.0, 40.0, 20.0, 20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0, 110.0, 170.0, 150.0, 50.0, 110.0, 210.0, 270.0, 80.0, 20.0, 20.0, 90.0, 70.0, 130.0, 200.0, 70.0, 40.0, 40.0, 20.0, 60.0, 190.0, 40.0, 150.0, 50.0, 250.0, 50.0, 10.0, 120.0, 10.0, 10.0, 25.0, 180.0, 0.0, 90.0, 30.0, 150.0, 70.0, 70.0, 40.0, 120.0, 120.0, 250.0, 40.0, 150.0, 165.0, 30.0, 100.0, 20.0, 230.0, 60.0, -50.0, 40.0, 80.0, 190.0, 50.0, 290.0, -20.0, 210.0, 240.0, 410.0, 130.0, 30.0, -5.0, 35.0, 190.0, 20.0, 30.0, 70.0, 100.0, 25.0, 200.0, 70.0, 160.0, 210.0, 180.0, 10.0, 590.0, 230.0, 140.0, 60.0, 300.0, 10.0, 70.0, 20.0, 70.0, 90.0, 20.0, 310.0, 10.0, 30.0, 0.0, 160.0, 230.0, 150.0, 80.0, 120.0, 190.0, 70.0, 130.0, 240.0, 90.0, 200.0, 80.0, 100.0, 50.0, 150.0, 40.0, 320.0, 160.0, 110.0, 70.0, 140.0, 100.0, 110.0, 180.0, 50.0, 160.0, 70.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 260.0, 20.0, 370.0, 40.0, 20.0, -10.0, 10.0, 270.0, 50.0, -10.0, 210.0, 50.0, 230.0, 30.0, 40.0, 30.0, 460.0, 40.0, 10.0, 30.0, 0.0, 0.0, 10.0, 50.0, 40.0, 50.0, 10.0, 100.0, 20.0, 40.0, 230.0, 90.0, 150.0, 40.0, -5.0, 60.0, 440.0, 20.0, 70.0, 60.0, 20.0, 80.0, 80.0, 40.0, 10.0, 130.0, 90.0, 130.0, 20.0, 50.0, 10.0, -30.0, 220.0, 220.0, 570.0, 20.0, 20.0, 60.0, 70.0, 100.0, 230.0, 80.0, 30.0, 210.0, 200.0, 120.0, 70.0, 150.0, 210.0, 100.0, 175.0, 360.0, 230.0, 40.0, -50.0, 330.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 545.0, -15.0, 20.0, 30.0, 20.0, 60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5288358364035226, "mean_inference_ms": 1.4180910254534091, "mean_action_processing_ms": 0.4545575567944411, "mean_env_wait_ms": 1.2455636127475316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011991262435913086, "StateBufferConnector_ms": 0.010105133056640625, "ViewRequirementAgentConnector_ms": 0.382340669631958}, "num_episodes": 22, "episode_return_max": 2160.0, "episode_return_min": 240.0, "episode_return_mean": 1059.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.420583303994736, "num_env_steps_trained_throughput_per_sec": 21.420583303994736, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 187743.777, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187743.731, "sample_time_ms": 2684.033, "learn_time_ms": 185035.67, "learn_throughput": 21.617, "synch_weights_time_ms": 11.796}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "33e63_00000", "date": "2024-06-19_04-11-49", "timestamp": 1718784709, "time_this_iter_s": 186.7464690208435, "time_total_s": 25490.1535115242, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3279690d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25490.1535115242, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 16.227272727272727, "ram_util_percent": 77.91401515151514}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5124209692874273, "cur_kl_coeff": 21.06640055048775, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.292965943719379, "policy_loss": -0.0025333405890391944, "vf_loss": 7.292647960620186, "vf_explained_var": -0.0001346428744709149, "kl": 0.00013534953590598376, "entropy": 0.3477912003160539, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 210.0, "episode_reward_mean": 1084.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 108.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1440.0, 1150.0, 1380.0, 840.0, 1340.0, 1150.0, 890.0, 960.0, 670.0, 900.0, 1225.0, 1375.0, 1535.0, 1040.0, 1060.0, 790.0, 770.0, 1450.0, 875.0, 2160.0, 1110.0, 1540.0, 330.0, 1300.0, 610.0, 1105.0, 1550.0, 560.0, 995.0, 1530.0, 1140.0, 595.0, 1145.0, 675.0, 990.0, 1710.0, 1140.0, 885.0, 1110.0, 740.0, 1125.0, 360.0, 1570.0, 1780.0, 650.0, 925.0, 1000.0, 665.0, 540.0, 1590.0, 1420.0, 740.0, 1300.0, 1310.0, 770.0, 505.0, 1100.0, 1335.0, 890.0, 800.0, 1190.0, 910.0, 715.0, 870.0, 995.0, 1620.0, 695.0, 1950.0, 630.0, 1460.0, 1280.0, 1170.0, 820.0, 1360.0, 240.0, 1165.0, 600.0, 1230.0, 1170.0, 1595.0, 680.0, 1530.0, 1200.0, 1050.0, 2270.0, 570.0, 1460.0, 1295.0, 1130.0, 625.0, 210.0, 1390.0, 1440.0, 1120.0, 690.0, 1135.0, 1600.0, 1635.0, 630.0, 1030.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 500.0, 90.0, 30.0, 180.0, 70.0, 300.0, 70.0, 50.0, 120.0, 30.0, 100.0, 130.0, 120.0, 190.0, -10.0, 10.0, 250.0, 300.0, 30.0, 90.0, 300.0, 10.0, -10.0, 170.0, 10.0, 60.0, 180.0, 380.0, 190.0, 260.0, 0.0, 200.0, -20.0, -50.0, 130.0, 30.0, 90.0, 70.0, 130.0, 170.0, 80.0, 230.0, 90.0, 70.0, 160.0, 70.0, 80.0, 310.0, 80.0, 130.0, 70.0, 80.0, 160.0, 500.0, 50.0, 0.0, 70.0, 60.0, 30.0, 60.0, -20.0, 20.0, 280.0, 170.0, 20.0, 160.0, 40.0, -20.0, 180.0, 240.0, 30.0, 370.0, 20.0, 100.0, 70.0, 20.0, 10.0, 60.0, 40.0, 90.0, 60.0, -70.0, 180.0, 130.0, 210.0, 40.0, -30.0, 60.0, 0.0, 90.0, 20.0, 80.0, 80.0, 90.0, 260.0, 70.0, 70.0, 80.0, 60.0, 10.0, 40.0, 25.0, 20.0, 200.0, 180.0, 400.0, 190.0, 110.0, 50.0, 110.0, 20.0, 720.0, -35.0, 130.0, 20.0, 160.0, 50.0, 170.0, 30.0, 380.0, 110.0, 90.0, 210.0, 55.0, 110.0, 310.0, 90.0, 140.0, 40.0, 60.0, 100.0, 80.0, 280.0, 50.0, 80.0, 230.0, 80.0, -10.0, 90.0, 10.0, 50.0, 30.0, 30.0, 20.0, 120.0, 380.0, 330.0, 0.0, 90.0, 190.0, 60.0, 30.0, 80.0, 80.0, 80.0, 50.0, 80.0, 100.0, 40.0, 410.0, 30.0, 0.0, 20.0, 120.0, 30.0, 30.0, 20.0, 20.0, 90.0, 90.0, 110.0, -10.0, 80.0, 120.0, 170.0, 110.0, 50.0, 420.0, 310.0, 200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0, 650.0, 220.0, -10.0, 620.0, 40.0, 320.0, 100.0, 50.0, 20.0, 150.0, 190.0, 90.0, 10.0, 100.0, -80.0, 470.0, 200.0, 70.0, 0.0, 60.0, 270.0, 120.0, 30.0, 50.0, 50.0, 70.0, 60.0, 410.0, 130.0, 350.0, 20.0, -30.0, 30.0, 10.0, 0.0, 20.0, 260.0, 10.0, 0.0, 10.0, 160.0, 360.0, 290.0, 210.0, 40.0, 120.0, 80.0, 20.0, -30.0, 50.0, 40.0, 40.0, 20.0, 10.0, 180.0, -30.0, 40.0, 260.0, 20.0, 30.0, 20.0, 150.0, 130.0, 30.0, 170.0, 20.0, 390.0, 80.0, -45.0, 160.0, 60.0, 60.0, 130.0, 50.0, 70.0, 70.0, 560.0, 100.0, 230.0, 220.0, -20.0, 10.0, 40.0, 10.0, 60.0, 30.0, 40.0, 470.0, 60.0, -140.0, 100.0, 75.0, 40.0, 580.0, 0.0, 50.0, 80.0, 70.0, -30.0, 30.0, 490.0, 140.0, 80.0, 50.0, 230.0, 130.0, 110.0, 190.0, 60.0, 50.0, 30.0, 280.0, 40.0, 220.0, 30.0, 90.0, 80.0, 150.0, 200.0, 20.0, 40.0, 140.0, 30.0, 30.0, 25.0, 170.0, 40.0, 20.0, 20.0, 80.0, 70.0, 80.0, 160.0, 360.0, 100.0, 150.0, 180.0, 55.0, -30.0, 20.0, 40.0, 30.0, 260.0, 125.0, -80.0, -30.0, 30.0, 50.0, 90.0, 160.0, 200.0, 20.0, 40.0, 0.0, 170.0, 70.0, 50.0, 0.0, 360.0, 80.0, 20.0, 140.0, 80.0, 170.0, 360.0, 500.0, 120.0, 190.0, 20.0, 110.0, 130.0, 10.0, 360.0, 120.0, 70.0, 180.0, 150.0, 40.0, 60.0, 20.0, 60.0, 40.0, 270.0, 70.0, 310.0, 35.0, 40.0, 35.0, 5.0, 20.0, 40.0, 60.0, 60.0, 240.0, 290.0, 40.0, 0.0, 40.0, 230.0, 110.0, 60.0, 130.0, 50.0, 60.0, 20.0, 140.0, 80.0, 20.0, 120.0, 60.0, 430.0, 150.0, 210.0, 20.0, 90.0, 55.0, 60.0, 50.0, 30.0, 30.0, 0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0, 120.0, 10.0, 40.0, 220.0, -10.0, 110.0, 70.0, 460.0, 190.0, 360.0, 80.0, 80.0, 280.0, 370.0, 90.0, 70.0, 80.0, 490.0, 200.0, 40.0, 20.0, 0.0, 290.0, 30.0, 20.0, 50.0, 20.0, 20.0, 170.0, 30.0, 25.0, 550.0, 100.0, 50.0, -30.0, 50.0, 50.0, 40.0, 60.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 500.0, 250.0, 100.0, 290.0, 80.0, 40.0, 25.0, 40.0, 50.0, 10.0, 90.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 110.0, 270.0, 0.0, 60.0, 0.0, 30.0, 50.0, 300.0, 240.0, 80.0, -10.0, 120.0, 220.0, 100.0, 460.0, 30.0, 230.0, 110.0, 170.0, 50.0, 50.0, 70.0, 90.0, 90.0, 50.0, 510.0, 10.0, 10.0, 20.0, 70.0, -30.0, 40.0, 40.0, -20.0, 120.0, 480.0, 40.0, 180.0, 30.0, 50.0, 20.0, 80.0, 100.0, 160.0, 80.0, 560.0, 200.0, 70.0, 60.0, 50.0, 60.0, 180.0, 40.0, 110.0, 130.0, 410.0, 40.0, 80.0, 20.0, 10.0, 10.0, 190.0, 90.0, 90.0, 120.0, 120.0, 0.0, 80.0, 40.0, 35.0, 10.0, 30.0, 30.0, 20.0, 90.0, 170.0, 90.0, 40.0, -30.0, 40.0, 160.0, 300.0, 20.0, 180.0, 290.0, 10.0, 55.0, 120.0, 40.0, -30.0, 680.0, 310.0, 40.0, 20.0, 30.0, 70.0, 100.0, 40.0, 50.0, 200.0, 150.0, 100.0, 180.0, 10.0, 40.0, 20.0, 20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0, 110.0, 170.0, 150.0, 50.0, 110.0, 210.0, 270.0, 80.0, 20.0, 20.0, 90.0, 70.0, 130.0, 200.0, 70.0, 40.0, 40.0, 20.0, 60.0, 190.0, 40.0, 150.0, 50.0, 250.0, 50.0, 10.0, 120.0, 10.0, 10.0, 25.0, 180.0, 0.0, 90.0, 30.0, 150.0, 70.0, 70.0, 40.0, 120.0, 120.0, 250.0, 40.0, 150.0, 165.0, 30.0, 100.0, 20.0, 230.0, 60.0, -50.0, 40.0, 80.0, 190.0, 50.0, 290.0, -20.0, 210.0, 240.0, 410.0, 130.0, 30.0, -5.0, 35.0, 190.0, 20.0, 30.0, 70.0, 100.0, 25.0, 200.0, 70.0, 160.0, 210.0, 180.0, 10.0, 590.0, 230.0, 140.0, 60.0, 300.0, 10.0, 70.0, 20.0, 70.0, 90.0, 20.0, 310.0, 10.0, 30.0, 0.0, 160.0, 230.0, 150.0, 80.0, 120.0, 190.0, 70.0, 130.0, 240.0, 90.0, 200.0, 80.0, 100.0, 50.0, 150.0, 40.0, 320.0, 160.0, 110.0, 70.0, 140.0, 100.0, 110.0, 180.0, 50.0, 160.0, 70.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 260.0, 20.0, 370.0, 40.0, 20.0, -10.0, 10.0, 270.0, 50.0, -10.0, 210.0, 50.0, 230.0, 30.0, 40.0, 30.0, 460.0, 40.0, 10.0, 30.0, 0.0, 0.0, 10.0, 50.0, 40.0, 50.0, 10.0, 100.0, 20.0, 40.0, 230.0, 90.0, 150.0, 40.0, -5.0, 60.0, 440.0, 20.0, 70.0, 60.0, 20.0, 80.0, 80.0, 40.0, 10.0, 130.0, 90.0, 130.0, 20.0, 50.0, 10.0, -30.0, 220.0, 220.0, 570.0, 20.0, 20.0, 60.0, 70.0, 100.0, 230.0, 80.0, 30.0, 210.0, 200.0, 120.0, 70.0, 150.0, 210.0, 100.0, 175.0, 360.0, 230.0, 40.0, -50.0, 330.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 545.0, -15.0, 20.0, 30.0, 20.0, 60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0, 80.0, 60.0, 0.0, 360.0, 130.0, 130.0, 30.0, 180.0, 170.0, 60.0, 10.0, -10.0, 180.0, 320.0, -50.0, 170.0, 60.0, 260.0, 90.0, 20.0, 140.0, 190.0, 360.0, 130.0, 230.0, 560.0, 210.0, 180.0, 160.0, 110.0, 40.0, 20.0, 90.0, 40.0, 80.0, 60.0, 40.0, 90.0, 30.0, 80.0, 90.0, 60.0, 60.0, 50.0, 170.0, 130.0, 260.0, 420.0, 90.0, 130.0, 10.0, 60.0, 120.0, 190.0, 210.0, 115.0, -20.0, 180.0, 400.0, 30.0, -180.0, 560.0, 120.0, 90.0, 250.0, 60.0, 70.0, 10.0, 30.0, 120.0, 70.0, 0.0, 60.0, 160.0, 50.0, 120.0, 70.0, 0.0, 15.0, 80.0, 20.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 190.0, 370.0, 170.0, 30.0, 0.0, 40.0, 380.0, 90.0, 90.0, 50.0, 310.0, 50.0, 70.0, 300.0, 300.0, 220.0, -50.0, 100.0, 160.0, 20.0, 320.0, 100.0, 40.0, 70.0, 30.0, 110.0, 210.0, 60.0, -10.0, 60.0, 200.0, 40.0, 0.0, 30.0, 150.0, 260.0, -10.0, -30.0, 380.0, 40.0, 50.0, 110.0, 10.0, 40.0, 65.0, 200.0, 190.0, 50.0, 450.0, 450.0, 160.0, 370.0, 80.0, -10.0, 80.0, 40.0, 50.0, -70.0, 80.0, 400.0, 55.0, 190.0, 90.0, 200.0, 70.0, 120.0, 210.0, 220.0, 40.0, 60.0, 260.0, 30.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5290079815401771, "mean_inference_ms": 1.418226336859328, "mean_action_processing_ms": 0.4541386043288787, "mean_env_wait_ms": 1.2455202443328617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011899471282958984, "StateBufferConnector_ms": 0.009999513626098633, "ViewRequirementAgentConnector_ms": 0.37813591957092285}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 210.0, "episode_return_mean": 1084.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.455773481840243, "num_env_steps_trained_throughput_per_sec": 21.455773481840243, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 187697.121, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187697.075, "sample_time_ms": 2625.673, "learn_time_ms": 185048.723, "learn_throughput": 21.616, "synch_weights_time_ms": 11.552}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "33e63_00000", "date": "2024-06-19_04-14-55", "timestamp": 1718784895, "time_this_iter_s": 186.44036316871643, "time_total_s": 25676.593874692917, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327969d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25676.593874692917, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 16.45209125475285, "ram_util_percent": 77.91140684410648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.058248047878186, "cur_kl_coeff": 10.533200275243875, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0034187479946029367, "vf_loss": 7.300335161119731, "vf_explained_var": 0.00016725405463522363, "kl": Infinity, "entropy": 0.3762968678158312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 2270.0, "episode_reward_min": 70.0, "episode_reward_mean": 1060.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 106.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [875.0, 2160.0, 1110.0, 1540.0, 330.0, 1300.0, 610.0, 1105.0, 1550.0, 560.0, 995.0, 1530.0, 1140.0, 595.0, 1145.0, 675.0, 990.0, 1710.0, 1140.0, 885.0, 1110.0, 740.0, 1125.0, 360.0, 1570.0, 1780.0, 650.0, 925.0, 1000.0, 665.0, 540.0, 1590.0, 1420.0, 740.0, 1300.0, 1310.0, 770.0, 505.0, 1100.0, 1335.0, 890.0, 800.0, 1190.0, 910.0, 715.0, 870.0, 995.0, 1620.0, 695.0, 1950.0, 630.0, 1460.0, 1280.0, 1170.0, 820.0, 1360.0, 240.0, 1165.0, 600.0, 1230.0, 1170.0, 1595.0, 680.0, 1530.0, 1200.0, 1050.0, 2270.0, 570.0, 1460.0, 1295.0, 1130.0, 625.0, 210.0, 1390.0, 1440.0, 1120.0, 690.0, 1135.0, 1600.0, 1635.0, 630.0, 1030.0, 1005.0, 870.0, 540.0, 1110.0, 710.0, 1380.0, 520.0, 1640.0, 680.0, 1140.0, 1210.0, 855.0, 1080.0, 70.0, 1820.0, 1240.0, 920.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [200.0, 40.0, 90.0, 100.0, 140.0, 180.0, 20.0, -40.0, 60.0, 85.0, 650.0, 220.0, -10.0, 620.0, 40.0, 320.0, 100.0, 50.0, 20.0, 150.0, 190.0, 90.0, 10.0, 100.0, -80.0, 470.0, 200.0, 70.0, 0.0, 60.0, 270.0, 120.0, 30.0, 50.0, 50.0, 70.0, 60.0, 410.0, 130.0, 350.0, 20.0, -30.0, 30.0, 10.0, 0.0, 20.0, 260.0, 10.0, 0.0, 10.0, 160.0, 360.0, 290.0, 210.0, 40.0, 120.0, 80.0, 20.0, -30.0, 50.0, 40.0, 40.0, 20.0, 10.0, 180.0, -30.0, 40.0, 260.0, 20.0, 30.0, 20.0, 150.0, 130.0, 30.0, 170.0, 20.0, 390.0, 80.0, -45.0, 160.0, 60.0, 60.0, 130.0, 50.0, 70.0, 70.0, 560.0, 100.0, 230.0, 220.0, -20.0, 10.0, 40.0, 10.0, 60.0, 30.0, 40.0, 470.0, 60.0, -140.0, 100.0, 75.0, 40.0, 580.0, 0.0, 50.0, 80.0, 70.0, -30.0, 30.0, 490.0, 140.0, 80.0, 50.0, 230.0, 130.0, 110.0, 190.0, 60.0, 50.0, 30.0, 280.0, 40.0, 220.0, 30.0, 90.0, 80.0, 150.0, 200.0, 20.0, 40.0, 140.0, 30.0, 30.0, 25.0, 170.0, 40.0, 20.0, 20.0, 80.0, 70.0, 80.0, 160.0, 360.0, 100.0, 150.0, 180.0, 55.0, -30.0, 20.0, 40.0, 30.0, 260.0, 125.0, -80.0, -30.0, 30.0, 50.0, 90.0, 160.0, 200.0, 20.0, 40.0, 0.0, 170.0, 70.0, 50.0, 0.0, 360.0, 80.0, 20.0, 140.0, 80.0, 170.0, 360.0, 500.0, 120.0, 190.0, 20.0, 110.0, 130.0, 10.0, 360.0, 120.0, 70.0, 180.0, 150.0, 40.0, 60.0, 20.0, 60.0, 40.0, 270.0, 70.0, 310.0, 35.0, 40.0, 35.0, 5.0, 20.0, 40.0, 60.0, 60.0, 240.0, 290.0, 40.0, 0.0, 40.0, 230.0, 110.0, 60.0, 130.0, 50.0, 60.0, 20.0, 140.0, 80.0, 20.0, 120.0, 60.0, 430.0, 150.0, 210.0, 20.0, 90.0, 55.0, 60.0, 50.0, 30.0, 30.0, 0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0, 120.0, 10.0, 40.0, 220.0, -10.0, 110.0, 70.0, 460.0, 190.0, 360.0, 80.0, 80.0, 280.0, 370.0, 90.0, 70.0, 80.0, 490.0, 200.0, 40.0, 20.0, 0.0, 290.0, 30.0, 20.0, 50.0, 20.0, 20.0, 170.0, 30.0, 25.0, 550.0, 100.0, 50.0, -30.0, 50.0, 50.0, 40.0, 60.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 500.0, 250.0, 100.0, 290.0, 80.0, 40.0, 25.0, 40.0, 50.0, 10.0, 90.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 110.0, 270.0, 0.0, 60.0, 0.0, 30.0, 50.0, 300.0, 240.0, 80.0, -10.0, 120.0, 220.0, 100.0, 460.0, 30.0, 230.0, 110.0, 170.0, 50.0, 50.0, 70.0, 90.0, 90.0, 50.0, 510.0, 10.0, 10.0, 20.0, 70.0, -30.0, 40.0, 40.0, -20.0, 120.0, 480.0, 40.0, 180.0, 30.0, 50.0, 20.0, 80.0, 100.0, 160.0, 80.0, 560.0, 200.0, 70.0, 60.0, 50.0, 60.0, 180.0, 40.0, 110.0, 130.0, 410.0, 40.0, 80.0, 20.0, 10.0, 10.0, 190.0, 90.0, 90.0, 120.0, 120.0, 0.0, 80.0, 40.0, 35.0, 10.0, 30.0, 30.0, 20.0, 90.0, 170.0, 90.0, 40.0, -30.0, 40.0, 160.0, 300.0, 20.0, 180.0, 290.0, 10.0, 55.0, 120.0, 40.0, -30.0, 680.0, 310.0, 40.0, 20.0, 30.0, 70.0, 100.0, 40.0, 50.0, 200.0, 150.0, 100.0, 180.0, 10.0, 40.0, 20.0, 20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0, 110.0, 170.0, 150.0, 50.0, 110.0, 210.0, 270.0, 80.0, 20.0, 20.0, 90.0, 70.0, 130.0, 200.0, 70.0, 40.0, 40.0, 20.0, 60.0, 190.0, 40.0, 150.0, 50.0, 250.0, 50.0, 10.0, 120.0, 10.0, 10.0, 25.0, 180.0, 0.0, 90.0, 30.0, 150.0, 70.0, 70.0, 40.0, 120.0, 120.0, 250.0, 40.0, 150.0, 165.0, 30.0, 100.0, 20.0, 230.0, 60.0, -50.0, 40.0, 80.0, 190.0, 50.0, 290.0, -20.0, 210.0, 240.0, 410.0, 130.0, 30.0, -5.0, 35.0, 190.0, 20.0, 30.0, 70.0, 100.0, 25.0, 200.0, 70.0, 160.0, 210.0, 180.0, 10.0, 590.0, 230.0, 140.0, 60.0, 300.0, 10.0, 70.0, 20.0, 70.0, 90.0, 20.0, 310.0, 10.0, 30.0, 0.0, 160.0, 230.0, 150.0, 80.0, 120.0, 190.0, 70.0, 130.0, 240.0, 90.0, 200.0, 80.0, 100.0, 50.0, 150.0, 40.0, 320.0, 160.0, 110.0, 70.0, 140.0, 100.0, 110.0, 180.0, 50.0, 160.0, 70.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 260.0, 20.0, 370.0, 40.0, 20.0, -10.0, 10.0, 270.0, 50.0, -10.0, 210.0, 50.0, 230.0, 30.0, 40.0, 30.0, 460.0, 40.0, 10.0, 30.0, 0.0, 0.0, 10.0, 50.0, 40.0, 50.0, 10.0, 100.0, 20.0, 40.0, 230.0, 90.0, 150.0, 40.0, -5.0, 60.0, 440.0, 20.0, 70.0, 60.0, 20.0, 80.0, 80.0, 40.0, 10.0, 130.0, 90.0, 130.0, 20.0, 50.0, 10.0, -30.0, 220.0, 220.0, 570.0, 20.0, 20.0, 60.0, 70.0, 100.0, 230.0, 80.0, 30.0, 210.0, 200.0, 120.0, 70.0, 150.0, 210.0, 100.0, 175.0, 360.0, 230.0, 40.0, -50.0, 330.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 545.0, -15.0, 20.0, 30.0, 20.0, 60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0, 80.0, 60.0, 0.0, 360.0, 130.0, 130.0, 30.0, 180.0, 170.0, 60.0, 10.0, -10.0, 180.0, 320.0, -50.0, 170.0, 60.0, 260.0, 90.0, 20.0, 140.0, 190.0, 360.0, 130.0, 230.0, 560.0, 210.0, 180.0, 160.0, 110.0, 40.0, 20.0, 90.0, 40.0, 80.0, 60.0, 40.0, 90.0, 30.0, 80.0, 90.0, 60.0, 60.0, 50.0, 170.0, 130.0, 260.0, 420.0, 90.0, 130.0, 10.0, 60.0, 120.0, 190.0, 210.0, 115.0, -20.0, 180.0, 400.0, 30.0, -180.0, 560.0, 120.0, 90.0, 250.0, 60.0, 70.0, 10.0, 30.0, 120.0, 70.0, 0.0, 60.0, 160.0, 50.0, 120.0, 70.0, 0.0, 15.0, 80.0, 20.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 190.0, 370.0, 170.0, 30.0, 0.0, 40.0, 380.0, 90.0, 90.0, 50.0, 310.0, 50.0, 70.0, 300.0, 300.0, 220.0, -50.0, 100.0, 160.0, 20.0, 320.0, 100.0, 40.0, 70.0, 30.0, 110.0, 210.0, 60.0, -10.0, 60.0, 200.0, 40.0, 0.0, 30.0, 150.0, 260.0, -10.0, -30.0, 380.0, 40.0, 50.0, 110.0, 10.0, 40.0, 65.0, 200.0, 190.0, 50.0, 450.0, 450.0, 160.0, 370.0, 80.0, -10.0, 80.0, 40.0, 50.0, -70.0, 80.0, 400.0, 55.0, 190.0, 90.0, 200.0, 70.0, 120.0, 210.0, 220.0, 40.0, 60.0, 260.0, 30.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0, 240.0, 110.0, 110.0, 20.0, 200.0, 80.0, 120.0, 40.0, 50.0, 35.0, 70.0, 240.0, 70.0, 80.0, 10.0, 50.0, 160.0, -50.0, 20.0, 220.0, 70.0, 30.0, 10.0, 40.0, 20.0, 60.0, 140.0, 110.0, 20.0, 40.0, 60.0, 300.0, 50.0, 10.0, 90.0, 40.0, 110.0, 40.0, 220.0, 190.0, 30.0, -50.0, 170.0, 80.0, 60.0, 30.0, 20.0, 40.0, 210.0, 120.0, 170.0, 310.0, 80.0, 80.0, 110.0, 40.0, 110.0, -10.0, 420.0, 70.0, 0.0, 70.0, 30.0, 230.0, 10.0, 50.0, 10.0, 100.0, 10.0, 10.0, 190.0, 150.0, 110.0, 230.0, 140.0, 250.0, 270.0, 140.0, 130.0, 30.0, 30.0, 60.0, 40.0, 20.0, 10.0, 80.0, 0.0, 20.0, 50.0, 370.0, 60.0, 70.0, 190.0, 40.0, 50.0, 510.0, 40.0, 20.0, 90.0, 70.0, 50.0, 80.0, 40.0, 340.0, 150.0, 20.0, 120.0, 60.0, 220.0, 130.0, 120.0, 60.0, 120.0, 60.0, 30.0, 170.0, 180.0, 40.0, 80.0, -5.0, 220.0, 30.0, 140.0, 250.0, 110.0, 0.0, -20.0, 170.0, 130.0, 50.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 190.0, 130.0, 150.0, 350.0, 130.0, 270.0, 70.0, 310.0, 190.0, 30.0, 140.0, 60.0, 160.0, 130.0, -30.0, 90.0, 320.0, 20.0, 300.0, 50.0, 10.0, 180.0, 80.0, 110.0, 90.0, 160.0, 70.0, -40.0, 20.0, 240.0, 120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5290630901712818, "mean_inference_ms": 1.4183273182225502, "mean_action_processing_ms": 0.4537252784043257, "mean_env_wait_ms": 1.2454733886465952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01205134391784668, "StateBufferConnector_ms": 0.011432647705078125, "ViewRequirementAgentConnector_ms": 0.3793909549713135}, "num_episodes": 18, "episode_return_max": 2270.0, "episode_return_min": 70.0, "episode_return_mean": 1060.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.393706260758012, "num_env_steps_trained_throughput_per_sec": 21.393706260758012, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 187697.581, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187697.535, "sample_time_ms": 2600.223, "learn_time_ms": 185075.066, "learn_throughput": 21.613, "synch_weights_time_ms": 11.403}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "33e63_00000", "date": "2024-06-19_04-18-02", "timestamp": 1718785082, "time_this_iter_s": 186.9817090034485, "time_total_s": 25863.575583696365, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32794c1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25863.575583696365, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 16.58, "ram_util_percent": 78.22905660377359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1212641215679873, "cur_kl_coeff": 15.799800412865814, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0027786611153494223, "vf_loss": 7.198148224986018, "vf_explained_var": 0.0002709876170681434, "kl": Infinity, "entropy": 0.3550196003847229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 2760.0, "episode_reward_min": 70.0, "episode_reward_mean": 1064.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 106.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 1570.0, 1780.0, 650.0, 925.0, 1000.0, 665.0, 540.0, 1590.0, 1420.0, 740.0, 1300.0, 1310.0, 770.0, 505.0, 1100.0, 1335.0, 890.0, 800.0, 1190.0, 910.0, 715.0, 870.0, 995.0, 1620.0, 695.0, 1950.0, 630.0, 1460.0, 1280.0, 1170.0, 820.0, 1360.0, 240.0, 1165.0, 600.0, 1230.0, 1170.0, 1595.0, 680.0, 1530.0, 1200.0, 1050.0, 2270.0, 570.0, 1460.0, 1295.0, 1130.0, 625.0, 210.0, 1390.0, 1440.0, 1120.0, 690.0, 1135.0, 1600.0, 1635.0, 630.0, 1030.0, 1005.0, 870.0, 540.0, 1110.0, 710.0, 1380.0, 520.0, 1640.0, 680.0, 1140.0, 1210.0, 855.0, 1080.0, 70.0, 1820.0, 1240.0, 920.0, 760.0, 1340.0, 870.0, 720.0, 680.0, 640.0, 570.0, 330.0, 1430.0, 1680.0, 1220.0, 830.0, 1940.0, 1395.0, 2760.0, 1380.0, 680.0, 1330.0, 900.0, 760.0, 715.0, 965.0, 1390.0, 780.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 70.0, 10.0, 0.0, 50.0, 80.0, 50.0, 100.0, 0.0, 0.0, 120.0, 10.0, 40.0, 220.0, -10.0, 110.0, 70.0, 460.0, 190.0, 360.0, 80.0, 80.0, 280.0, 370.0, 90.0, 70.0, 80.0, 490.0, 200.0, 40.0, 20.0, 0.0, 290.0, 30.0, 20.0, 50.0, 20.0, 20.0, 170.0, 30.0, 25.0, 550.0, 100.0, 50.0, -30.0, 50.0, 50.0, 40.0, 60.0, 30.0, 20.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 500.0, 250.0, 100.0, 290.0, 80.0, 40.0, 25.0, 40.0, 50.0, 10.0, 90.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 110.0, 270.0, 0.0, 60.0, 0.0, 30.0, 50.0, 300.0, 240.0, 80.0, -10.0, 120.0, 220.0, 100.0, 460.0, 30.0, 230.0, 110.0, 170.0, 50.0, 50.0, 70.0, 90.0, 90.0, 50.0, 510.0, 10.0, 10.0, 20.0, 70.0, -30.0, 40.0, 40.0, -20.0, 120.0, 480.0, 40.0, 180.0, 30.0, 50.0, 20.0, 80.0, 100.0, 160.0, 80.0, 560.0, 200.0, 70.0, 60.0, 50.0, 60.0, 180.0, 40.0, 110.0, 130.0, 410.0, 40.0, 80.0, 20.0, 10.0, 10.0, 190.0, 90.0, 90.0, 120.0, 120.0, 0.0, 80.0, 40.0, 35.0, 10.0, 30.0, 30.0, 20.0, 90.0, 170.0, 90.0, 40.0, -30.0, 40.0, 160.0, 300.0, 20.0, 180.0, 290.0, 10.0, 55.0, 120.0, 40.0, -30.0, 680.0, 310.0, 40.0, 20.0, 30.0, 70.0, 100.0, 40.0, 50.0, 200.0, 150.0, 100.0, 180.0, 10.0, 40.0, 20.0, 20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0, 110.0, 170.0, 150.0, 50.0, 110.0, 210.0, 270.0, 80.0, 20.0, 20.0, 90.0, 70.0, 130.0, 200.0, 70.0, 40.0, 40.0, 20.0, 60.0, 190.0, 40.0, 150.0, 50.0, 250.0, 50.0, 10.0, 120.0, 10.0, 10.0, 25.0, 180.0, 0.0, 90.0, 30.0, 150.0, 70.0, 70.0, 40.0, 120.0, 120.0, 250.0, 40.0, 150.0, 165.0, 30.0, 100.0, 20.0, 230.0, 60.0, -50.0, 40.0, 80.0, 190.0, 50.0, 290.0, -20.0, 210.0, 240.0, 410.0, 130.0, 30.0, -5.0, 35.0, 190.0, 20.0, 30.0, 70.0, 100.0, 25.0, 200.0, 70.0, 160.0, 210.0, 180.0, 10.0, 590.0, 230.0, 140.0, 60.0, 300.0, 10.0, 70.0, 20.0, 70.0, 90.0, 20.0, 310.0, 10.0, 30.0, 0.0, 160.0, 230.0, 150.0, 80.0, 120.0, 190.0, 70.0, 130.0, 240.0, 90.0, 200.0, 80.0, 100.0, 50.0, 150.0, 40.0, 320.0, 160.0, 110.0, 70.0, 140.0, 100.0, 110.0, 180.0, 50.0, 160.0, 70.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 260.0, 20.0, 370.0, 40.0, 20.0, -10.0, 10.0, 270.0, 50.0, -10.0, 210.0, 50.0, 230.0, 30.0, 40.0, 30.0, 460.0, 40.0, 10.0, 30.0, 0.0, 0.0, 10.0, 50.0, 40.0, 50.0, 10.0, 100.0, 20.0, 40.0, 230.0, 90.0, 150.0, 40.0, -5.0, 60.0, 440.0, 20.0, 70.0, 60.0, 20.0, 80.0, 80.0, 40.0, 10.0, 130.0, 90.0, 130.0, 20.0, 50.0, 10.0, -30.0, 220.0, 220.0, 570.0, 20.0, 20.0, 60.0, 70.0, 100.0, 230.0, 80.0, 30.0, 210.0, 200.0, 120.0, 70.0, 150.0, 210.0, 100.0, 175.0, 360.0, 230.0, 40.0, -50.0, 330.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 545.0, -15.0, 20.0, 30.0, 20.0, 60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0, 80.0, 60.0, 0.0, 360.0, 130.0, 130.0, 30.0, 180.0, 170.0, 60.0, 10.0, -10.0, 180.0, 320.0, -50.0, 170.0, 60.0, 260.0, 90.0, 20.0, 140.0, 190.0, 360.0, 130.0, 230.0, 560.0, 210.0, 180.0, 160.0, 110.0, 40.0, 20.0, 90.0, 40.0, 80.0, 60.0, 40.0, 90.0, 30.0, 80.0, 90.0, 60.0, 60.0, 50.0, 170.0, 130.0, 260.0, 420.0, 90.0, 130.0, 10.0, 60.0, 120.0, 190.0, 210.0, 115.0, -20.0, 180.0, 400.0, 30.0, -180.0, 560.0, 120.0, 90.0, 250.0, 60.0, 70.0, 10.0, 30.0, 120.0, 70.0, 0.0, 60.0, 160.0, 50.0, 120.0, 70.0, 0.0, 15.0, 80.0, 20.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 190.0, 370.0, 170.0, 30.0, 0.0, 40.0, 380.0, 90.0, 90.0, 50.0, 310.0, 50.0, 70.0, 300.0, 300.0, 220.0, -50.0, 100.0, 160.0, 20.0, 320.0, 100.0, 40.0, 70.0, 30.0, 110.0, 210.0, 60.0, -10.0, 60.0, 200.0, 40.0, 0.0, 30.0, 150.0, 260.0, -10.0, -30.0, 380.0, 40.0, 50.0, 110.0, 10.0, 40.0, 65.0, 200.0, 190.0, 50.0, 450.0, 450.0, 160.0, 370.0, 80.0, -10.0, 80.0, 40.0, 50.0, -70.0, 80.0, 400.0, 55.0, 190.0, 90.0, 200.0, 70.0, 120.0, 210.0, 220.0, 40.0, 60.0, 260.0, 30.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0, 240.0, 110.0, 110.0, 20.0, 200.0, 80.0, 120.0, 40.0, 50.0, 35.0, 70.0, 240.0, 70.0, 80.0, 10.0, 50.0, 160.0, -50.0, 20.0, 220.0, 70.0, 30.0, 10.0, 40.0, 20.0, 60.0, 140.0, 110.0, 20.0, 40.0, 60.0, 300.0, 50.0, 10.0, 90.0, 40.0, 110.0, 40.0, 220.0, 190.0, 30.0, -50.0, 170.0, 80.0, 60.0, 30.0, 20.0, 40.0, 210.0, 120.0, 170.0, 310.0, 80.0, 80.0, 110.0, 40.0, 110.0, -10.0, 420.0, 70.0, 0.0, 70.0, 30.0, 230.0, 10.0, 50.0, 10.0, 100.0, 10.0, 10.0, 190.0, 150.0, 110.0, 230.0, 140.0, 250.0, 270.0, 140.0, 130.0, 30.0, 30.0, 60.0, 40.0, 20.0, 10.0, 80.0, 0.0, 20.0, 50.0, 370.0, 60.0, 70.0, 190.0, 40.0, 50.0, 510.0, 40.0, 20.0, 90.0, 70.0, 50.0, 80.0, 40.0, 340.0, 150.0, 20.0, 120.0, 60.0, 220.0, 130.0, 120.0, 60.0, 120.0, 60.0, 30.0, 170.0, 180.0, 40.0, 80.0, -5.0, 220.0, 30.0, 140.0, 250.0, 110.0, 0.0, -20.0, 170.0, 130.0, 50.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 190.0, 130.0, 150.0, 350.0, 130.0, 270.0, 70.0, 310.0, 190.0, 30.0, 140.0, 60.0, 160.0, 130.0, -30.0, 90.0, 320.0, 20.0, 300.0, 50.0, 10.0, 180.0, 80.0, 110.0, 90.0, 160.0, 70.0, -40.0, 20.0, 240.0, 120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0, 50.0, 470.0, 80.0, 380.0, 50.0, 30.0, 70.0, 30.0, 40.0, 140.0, 20.0, 20.0, 90.0, 300.0, 180.0, 100.0, 20.0, 90.0, 50.0, 0.0, 50.0, 20.0, 50.0, 40.0, 380.0, 210.0, -10.0, 10.0, -40.0, 10.0, 10.0, 90.0, 210.0, 20.0, 10.0, 0.0, 0.0, 350.0, 30.0, -40.0, 100.0, 10.0, 20.0, 50.0, 30.0, 110.0, 60.0, 60.0, 60.0, 140.0, 70.0, 30.0, 120.0, 40.0, 80.0, 0.0, 10.0, 10.0, 20.0, 190.0, 20.0, 0.0, 40.0, 40.0, 50.0, 20.0, 90.0, 10.0, 20.0, 40.0, 50.0, 200.0, 100.0, 130.0, 50.0, 170.0, 60.0, 430.0, 60.0, 180.0, 120.0, 70.0, 240.0, -20.0, 490.0, 240.0, 260.0, 110.0, 70.0, 100.0, 210.0, 70.0, 130.0, 100.0, 70.0, 260.0, 60.0, 50.0, 140.0, 130.0, 60.0, 0.0, 70.0, 60.0, 30.0, 40.0, 80.0, 70.0, 360.0, 60.0, 600.0, 120.0, 140.0, 80.0, 130.0, 120.0, 390.0, 70.0, 170.0, 120.0, 560.0, 210.0, 90.0, 40.0, 5.0, 10.0, 300.0, 150.0, -30.0, 60.0, 510.0, 160.0, 60.0, 180.0, 430.0, 250.0, 360.0, 170.0, 50.0, 590.0, 140.0, 60.0, 180.0, 100.0, 10.0, 500.0, 100.0, 120.0, 50.0, 120.0, 80.0, 0.0, 10.0, 110.0, 50.0, 30.0, 140.0, 60.0, 140.0, 60.0, 140.0, 50.0, 150.0, 260.0, 10.0, 10.0, 80.0, -30.0, 610.0, 50.0, 60.0, 30.0, 350.0, 100.0, 220.0, 0.0, 20.0, -10.0, 40.0, 90.0, 220.0, 20.0, 30.0, 170.0, 80.0, 100.0, 90.0, 30.0, 10.0, 10.0, 25.0, 80.0, 50.0, 40.0, 130.0, 40.0, 60.0, 20.0, 250.0, 20.0, 70.0, 130.0, 60.0, 410.0, 20.0, 130.0, -65.0, 30.0, 20.0, 160.0, 350.0, -10.0, 40.0, 0.0, 110.0, 60.0, 500.0, 90.0, 70.0, 180.0, 20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5287215929568918, "mean_inference_ms": 1.4182454716521176, "mean_action_processing_ms": 0.4531950220386169, "mean_env_wait_ms": 1.2453432274527843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011973857879638672, "StateBufferConnector_ms": 0.011402130126953125, "ViewRequirementAgentConnector_ms": 0.37711524963378906}, "num_episodes": 23, "episode_return_max": 2760.0, "episode_return_min": 70.0, "episode_return_mean": 1064.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.37904170775865, "num_env_steps_trained_throughput_per_sec": 21.37904170775865, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 187839.569, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187839.519, "sample_time_ms": 2577.701, "learn_time_ms": 185239.247, "learn_throughput": 21.594, "synch_weights_time_ms": 11.488}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "33e63_00000", "date": "2024-06-19_04-21-09", "timestamp": 1718785269, "time_this_iter_s": 187.10671496391296, "time_total_s": 26050.68229866028, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32794c700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26050.68229866028, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 16.2625, "ram_util_percent": 78.35113636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6865112535615827, "cur_kl_coeff": 23.699700619298717, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0019452324403768269, "vf_loss": 7.643315828747896, "vf_explained_var": -8.27939936909051e-05, "kl": Infinity, "entropy": 0.36762402892049256, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 2760.0, "episode_reward_min": 70.0, "episode_reward_mean": 1084.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 108.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 1190.0, 910.0, 715.0, 870.0, 995.0, 1620.0, 695.0, 1950.0, 630.0, 1460.0, 1280.0, 1170.0, 820.0, 1360.0, 240.0, 1165.0, 600.0, 1230.0, 1170.0, 1595.0, 680.0, 1530.0, 1200.0, 1050.0, 2270.0, 570.0, 1460.0, 1295.0, 1130.0, 625.0, 210.0, 1390.0, 1440.0, 1120.0, 690.0, 1135.0, 1600.0, 1635.0, 630.0, 1030.0, 1005.0, 870.0, 540.0, 1110.0, 710.0, 1380.0, 520.0, 1640.0, 680.0, 1140.0, 1210.0, 855.0, 1080.0, 70.0, 1820.0, 1240.0, 920.0, 760.0, 1340.0, 870.0, 720.0, 680.0, 640.0, 570.0, 330.0, 1430.0, 1680.0, 1220.0, 830.0, 1940.0, 1395.0, 2760.0, 1380.0, 680.0, 1330.0, 900.0, 760.0, 715.0, 965.0, 1390.0, 780.0, 735.0, 1690.0, 1100.0, 1010.0, 1255.0, 945.0, 1840.0, 1050.0, 740.0, 680.0, 1400.0, 770.0, 840.0, 1300.0, 1470.0, 1290.0, 1650.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 120.0, 20.0, 320.0, 60.0, 50.0, 50.0, 20.0, 50.0, 90.0, 110.0, 170.0, 150.0, 50.0, 110.0, 210.0, 270.0, 80.0, 20.0, 20.0, 90.0, 70.0, 130.0, 200.0, 70.0, 40.0, 40.0, 20.0, 60.0, 190.0, 40.0, 150.0, 50.0, 250.0, 50.0, 10.0, 120.0, 10.0, 10.0, 25.0, 180.0, 0.0, 90.0, 30.0, 150.0, 70.0, 70.0, 40.0, 120.0, 120.0, 250.0, 40.0, 150.0, 165.0, 30.0, 100.0, 20.0, 230.0, 60.0, -50.0, 40.0, 80.0, 190.0, 50.0, 290.0, -20.0, 210.0, 240.0, 410.0, 130.0, 30.0, -5.0, 35.0, 190.0, 20.0, 30.0, 70.0, 100.0, 25.0, 200.0, 70.0, 160.0, 210.0, 180.0, 10.0, 590.0, 230.0, 140.0, 60.0, 300.0, 10.0, 70.0, 20.0, 70.0, 90.0, 20.0, 310.0, 10.0, 30.0, 0.0, 160.0, 230.0, 150.0, 80.0, 120.0, 190.0, 70.0, 130.0, 240.0, 90.0, 200.0, 80.0, 100.0, 50.0, 150.0, 40.0, 320.0, 160.0, 110.0, 70.0, 140.0, 100.0, 110.0, 180.0, 50.0, 160.0, 70.0, 40.0, 290.0, 30.0, 30.0, 20.0, 60.0, 260.0, 20.0, 370.0, 40.0, 20.0, -10.0, 10.0, 270.0, 50.0, -10.0, 210.0, 50.0, 230.0, 30.0, 40.0, 30.0, 460.0, 40.0, 10.0, 30.0, 0.0, 0.0, 10.0, 50.0, 40.0, 50.0, 10.0, 100.0, 20.0, 40.0, 230.0, 90.0, 150.0, 40.0, -5.0, 60.0, 440.0, 20.0, 70.0, 60.0, 20.0, 80.0, 80.0, 40.0, 10.0, 130.0, 90.0, 130.0, 20.0, 50.0, 10.0, -30.0, 220.0, 220.0, 570.0, 20.0, 20.0, 60.0, 70.0, 100.0, 230.0, 80.0, 30.0, 210.0, 200.0, 120.0, 70.0, 150.0, 210.0, 100.0, 175.0, 360.0, 230.0, 40.0, -50.0, 330.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 545.0, -15.0, 20.0, 30.0, 20.0, 60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0, 80.0, 60.0, 0.0, 360.0, 130.0, 130.0, 30.0, 180.0, 170.0, 60.0, 10.0, -10.0, 180.0, 320.0, -50.0, 170.0, 60.0, 260.0, 90.0, 20.0, 140.0, 190.0, 360.0, 130.0, 230.0, 560.0, 210.0, 180.0, 160.0, 110.0, 40.0, 20.0, 90.0, 40.0, 80.0, 60.0, 40.0, 90.0, 30.0, 80.0, 90.0, 60.0, 60.0, 50.0, 170.0, 130.0, 260.0, 420.0, 90.0, 130.0, 10.0, 60.0, 120.0, 190.0, 210.0, 115.0, -20.0, 180.0, 400.0, 30.0, -180.0, 560.0, 120.0, 90.0, 250.0, 60.0, 70.0, 10.0, 30.0, 120.0, 70.0, 0.0, 60.0, 160.0, 50.0, 120.0, 70.0, 0.0, 15.0, 80.0, 20.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 190.0, 370.0, 170.0, 30.0, 0.0, 40.0, 380.0, 90.0, 90.0, 50.0, 310.0, 50.0, 70.0, 300.0, 300.0, 220.0, -50.0, 100.0, 160.0, 20.0, 320.0, 100.0, 40.0, 70.0, 30.0, 110.0, 210.0, 60.0, -10.0, 60.0, 200.0, 40.0, 0.0, 30.0, 150.0, 260.0, -10.0, -30.0, 380.0, 40.0, 50.0, 110.0, 10.0, 40.0, 65.0, 200.0, 190.0, 50.0, 450.0, 450.0, 160.0, 370.0, 80.0, -10.0, 80.0, 40.0, 50.0, -70.0, 80.0, 400.0, 55.0, 190.0, 90.0, 200.0, 70.0, 120.0, 210.0, 220.0, 40.0, 60.0, 260.0, 30.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0, 240.0, 110.0, 110.0, 20.0, 200.0, 80.0, 120.0, 40.0, 50.0, 35.0, 70.0, 240.0, 70.0, 80.0, 10.0, 50.0, 160.0, -50.0, 20.0, 220.0, 70.0, 30.0, 10.0, 40.0, 20.0, 60.0, 140.0, 110.0, 20.0, 40.0, 60.0, 300.0, 50.0, 10.0, 90.0, 40.0, 110.0, 40.0, 220.0, 190.0, 30.0, -50.0, 170.0, 80.0, 60.0, 30.0, 20.0, 40.0, 210.0, 120.0, 170.0, 310.0, 80.0, 80.0, 110.0, 40.0, 110.0, -10.0, 420.0, 70.0, 0.0, 70.0, 30.0, 230.0, 10.0, 50.0, 10.0, 100.0, 10.0, 10.0, 190.0, 150.0, 110.0, 230.0, 140.0, 250.0, 270.0, 140.0, 130.0, 30.0, 30.0, 60.0, 40.0, 20.0, 10.0, 80.0, 0.0, 20.0, 50.0, 370.0, 60.0, 70.0, 190.0, 40.0, 50.0, 510.0, 40.0, 20.0, 90.0, 70.0, 50.0, 80.0, 40.0, 340.0, 150.0, 20.0, 120.0, 60.0, 220.0, 130.0, 120.0, 60.0, 120.0, 60.0, 30.0, 170.0, 180.0, 40.0, 80.0, -5.0, 220.0, 30.0, 140.0, 250.0, 110.0, 0.0, -20.0, 170.0, 130.0, 50.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 190.0, 130.0, 150.0, 350.0, 130.0, 270.0, 70.0, 310.0, 190.0, 30.0, 140.0, 60.0, 160.0, 130.0, -30.0, 90.0, 320.0, 20.0, 300.0, 50.0, 10.0, 180.0, 80.0, 110.0, 90.0, 160.0, 70.0, -40.0, 20.0, 240.0, 120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0, 50.0, 470.0, 80.0, 380.0, 50.0, 30.0, 70.0, 30.0, 40.0, 140.0, 20.0, 20.0, 90.0, 300.0, 180.0, 100.0, 20.0, 90.0, 50.0, 0.0, 50.0, 20.0, 50.0, 40.0, 380.0, 210.0, -10.0, 10.0, -40.0, 10.0, 10.0, 90.0, 210.0, 20.0, 10.0, 0.0, 0.0, 350.0, 30.0, -40.0, 100.0, 10.0, 20.0, 50.0, 30.0, 110.0, 60.0, 60.0, 60.0, 140.0, 70.0, 30.0, 120.0, 40.0, 80.0, 0.0, 10.0, 10.0, 20.0, 190.0, 20.0, 0.0, 40.0, 40.0, 50.0, 20.0, 90.0, 10.0, 20.0, 40.0, 50.0, 200.0, 100.0, 130.0, 50.0, 170.0, 60.0, 430.0, 60.0, 180.0, 120.0, 70.0, 240.0, -20.0, 490.0, 240.0, 260.0, 110.0, 70.0, 100.0, 210.0, 70.0, 130.0, 100.0, 70.0, 260.0, 60.0, 50.0, 140.0, 130.0, 60.0, 0.0, 70.0, 60.0, 30.0, 40.0, 80.0, 70.0, 360.0, 60.0, 600.0, 120.0, 140.0, 80.0, 130.0, 120.0, 390.0, 70.0, 170.0, 120.0, 560.0, 210.0, 90.0, 40.0, 5.0, 10.0, 300.0, 150.0, -30.0, 60.0, 510.0, 160.0, 60.0, 180.0, 430.0, 250.0, 360.0, 170.0, 50.0, 590.0, 140.0, 60.0, 180.0, 100.0, 10.0, 500.0, 100.0, 120.0, 50.0, 120.0, 80.0, 0.0, 10.0, 110.0, 50.0, 30.0, 140.0, 60.0, 140.0, 60.0, 140.0, 50.0, 150.0, 260.0, 10.0, 10.0, 80.0, -30.0, 610.0, 50.0, 60.0, 30.0, 350.0, 100.0, 220.0, 0.0, 20.0, -10.0, 40.0, 90.0, 220.0, 20.0, 30.0, 170.0, 80.0, 100.0, 90.0, 30.0, 10.0, 10.0, 25.0, 80.0, 50.0, 40.0, 130.0, 40.0, 60.0, 20.0, 250.0, 20.0, 70.0, 130.0, 60.0, 410.0, 20.0, 130.0, -65.0, 30.0, 20.0, 160.0, 350.0, -10.0, 40.0, 0.0, 110.0, 60.0, 500.0, 90.0, 70.0, 180.0, 20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0, 160.0, 215.0, 170.0, 60.0, 80.0, -250.0, 40.0, 20.0, 170.0, 70.0, 230.0, 90.0, 120.0, 190.0, 80.0, 230.0, 80.0, 220.0, 130.0, 320.0, 80.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 230.0, 100.0, 10.0, 140.0, 50.0, 60.0, 140.0, 60.0, 190.0, 190.0, -30.0, 120.0, 90.0, 60.0, 80.0, 70.0, 50.0, -30.0, -15.0, 630.0, 230.0, 140.0, 40.0, 160.0, 40.0, 210.0, 190.0, 30.0, 0.0, 130.0, -5.0, 180.0, 10.0, 320.0, 40.0, -10.0, 120.0, 170.0, 240.0, 760.0, 20.0, 290.0, -110.0, 40.0, 310.0, 310.0, 170.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 110.0, 180.0, 70.0, 40.0, 70.0, 40.0, 20.0, 10.0, 200.0, 0.0, 30.0, 190.0, 130.0, 30.0, 180.0, 40.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 20.0, 90.0, 50.0, 450.0, 50.0, 130.0, 100.0, 230.0, 40.0, 180.0, 70.0, 70.0, 110.0, 70.0, 30.0, 190.0, -20.0, 30.0, 0.0, 130.0, 120.0, 20.0, 15.0, 40.0, 5.0, 40.0, 230.0, 240.0, 390.0, 90.0, 50.0, 100.0, 10.0, 10.0, 40.0, 130.0, 190.0, 290.0, 220.0, 60.0, 470.0, 30.0, 180.0, 90.0, 100.0, 50.0, 150.0, 120.0, 90.0, 210.0, 110.0, 80.0, 60.0, 360.0, 40.0, 100.0, 180.0, 60.0, 80.0, 70.0, 100.0, 710.0, 400.0, 60.0, 80.0, 90.0, 20.0, 40.0, 110.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 200.0, 100.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.528214784441892, "mean_inference_ms": 1.4180149010941252, "mean_action_processing_ms": 0.4527251268893505, "mean_env_wait_ms": 1.2451296922546036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012016534805297852, "StateBufferConnector_ms": 0.010742664337158203, "ViewRequirementAgentConnector_ms": 0.3706076145172119}, "num_episodes": 18, "episode_return_max": 2760.0, "episode_return_min": 70.0, "episode_return_mean": 1084.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.439661795599967, "num_env_steps_trained_throughput_per_sec": 21.439661795599967, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 187843.021, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187842.971, "sample_time_ms": 2557.807, "learn_time_ms": 185262.681, "learn_throughput": 21.591, "synch_weights_time_ms": 11.398}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "33e63_00000", "date": "2024-06-19_04-24-16", "timestamp": 1718785456, "time_this_iter_s": 186.57933712005615, "time_total_s": 26237.261635780334, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32794cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26237.261635780334, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 15.867803030303032, "ram_util_percent": 78.78030303030303}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.412986184689945, "cur_kl_coeff": 35.54955092894808, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.850664398591485, "policy_loss": -0.0017666442818390215, "vf_loss": 6.849708912090753, "vf_explained_var": 0.00012572780330848897, "kl": 7.657296464597688e-05, "entropy": 0.3519102847582489, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 2760.0, "episode_reward_min": 70.0, "episode_reward_mean": 1071.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 107.14}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0, 1200.0, 1050.0, 2270.0, 570.0, 1460.0, 1295.0, 1130.0, 625.0, 210.0, 1390.0, 1440.0, 1120.0, 690.0, 1135.0, 1600.0, 1635.0, 630.0, 1030.0, 1005.0, 870.0, 540.0, 1110.0, 710.0, 1380.0, 520.0, 1640.0, 680.0, 1140.0, 1210.0, 855.0, 1080.0, 70.0, 1820.0, 1240.0, 920.0, 760.0, 1340.0, 870.0, 720.0, 680.0, 640.0, 570.0, 330.0, 1430.0, 1680.0, 1220.0, 830.0, 1940.0, 1395.0, 2760.0, 1380.0, 680.0, 1330.0, 900.0, 760.0, 715.0, 965.0, 1390.0, 780.0, 735.0, 1690.0, 1100.0, 1010.0, 1255.0, 945.0, 1840.0, 1050.0, 740.0, 680.0, 1400.0, 770.0, 840.0, 1300.0, 1470.0, 1290.0, 1650.0, 680.0, 1230.0, 1160.0, 680.0, 1130.0, 770.0, 2030.0, 1070.0, 520.0, 1130.0, 390.0, 910.0, 1120.0, 840.0, 1070.0, 570.0, 160.0, 990.0, 1915.0, 1110.0, 1230.0, 875.0, 930.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 50.0, 60.0, 220.0, 30.0, 50.0, 320.0, 70.0, 650.0, 20.0, 80.0, 60.0, 0.0, 360.0, 130.0, 130.0, 30.0, 180.0, 170.0, 60.0, 10.0, -10.0, 180.0, 320.0, -50.0, 170.0, 60.0, 260.0, 90.0, 20.0, 140.0, 190.0, 360.0, 130.0, 230.0, 560.0, 210.0, 180.0, 160.0, 110.0, 40.0, 20.0, 90.0, 40.0, 80.0, 60.0, 40.0, 90.0, 30.0, 80.0, 90.0, 60.0, 60.0, 50.0, 170.0, 130.0, 260.0, 420.0, 90.0, 130.0, 10.0, 60.0, 120.0, 190.0, 210.0, 115.0, -20.0, 180.0, 400.0, 30.0, -180.0, 560.0, 120.0, 90.0, 250.0, 60.0, 70.0, 10.0, 30.0, 120.0, 70.0, 0.0, 60.0, 160.0, 50.0, 120.0, 70.0, 0.0, 15.0, 80.0, 20.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 190.0, 370.0, 170.0, 30.0, 0.0, 40.0, 380.0, 90.0, 90.0, 50.0, 310.0, 50.0, 70.0, 300.0, 300.0, 220.0, -50.0, 100.0, 160.0, 20.0, 320.0, 100.0, 40.0, 70.0, 30.0, 110.0, 210.0, 60.0, -10.0, 60.0, 200.0, 40.0, 0.0, 30.0, 150.0, 260.0, -10.0, -30.0, 380.0, 40.0, 50.0, 110.0, 10.0, 40.0, 65.0, 200.0, 190.0, 50.0, 450.0, 450.0, 160.0, 370.0, 80.0, -10.0, 80.0, 40.0, 50.0, -70.0, 80.0, 400.0, 55.0, 190.0, 90.0, 200.0, 70.0, 120.0, 210.0, 220.0, 40.0, 60.0, 260.0, 30.0, 70.0, 80.0, 20.0, 30.0, 30.0, 10.0, 170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0, 240.0, 110.0, 110.0, 20.0, 200.0, 80.0, 120.0, 40.0, 50.0, 35.0, 70.0, 240.0, 70.0, 80.0, 10.0, 50.0, 160.0, -50.0, 20.0, 220.0, 70.0, 30.0, 10.0, 40.0, 20.0, 60.0, 140.0, 110.0, 20.0, 40.0, 60.0, 300.0, 50.0, 10.0, 90.0, 40.0, 110.0, 40.0, 220.0, 190.0, 30.0, -50.0, 170.0, 80.0, 60.0, 30.0, 20.0, 40.0, 210.0, 120.0, 170.0, 310.0, 80.0, 80.0, 110.0, 40.0, 110.0, -10.0, 420.0, 70.0, 0.0, 70.0, 30.0, 230.0, 10.0, 50.0, 10.0, 100.0, 10.0, 10.0, 190.0, 150.0, 110.0, 230.0, 140.0, 250.0, 270.0, 140.0, 130.0, 30.0, 30.0, 60.0, 40.0, 20.0, 10.0, 80.0, 0.0, 20.0, 50.0, 370.0, 60.0, 70.0, 190.0, 40.0, 50.0, 510.0, 40.0, 20.0, 90.0, 70.0, 50.0, 80.0, 40.0, 340.0, 150.0, 20.0, 120.0, 60.0, 220.0, 130.0, 120.0, 60.0, 120.0, 60.0, 30.0, 170.0, 180.0, 40.0, 80.0, -5.0, 220.0, 30.0, 140.0, 250.0, 110.0, 0.0, -20.0, 170.0, 130.0, 50.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 190.0, 130.0, 150.0, 350.0, 130.0, 270.0, 70.0, 310.0, 190.0, 30.0, 140.0, 60.0, 160.0, 130.0, -30.0, 90.0, 320.0, 20.0, 300.0, 50.0, 10.0, 180.0, 80.0, 110.0, 90.0, 160.0, 70.0, -40.0, 20.0, 240.0, 120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0, 50.0, 470.0, 80.0, 380.0, 50.0, 30.0, 70.0, 30.0, 40.0, 140.0, 20.0, 20.0, 90.0, 300.0, 180.0, 100.0, 20.0, 90.0, 50.0, 0.0, 50.0, 20.0, 50.0, 40.0, 380.0, 210.0, -10.0, 10.0, -40.0, 10.0, 10.0, 90.0, 210.0, 20.0, 10.0, 0.0, 0.0, 350.0, 30.0, -40.0, 100.0, 10.0, 20.0, 50.0, 30.0, 110.0, 60.0, 60.0, 60.0, 140.0, 70.0, 30.0, 120.0, 40.0, 80.0, 0.0, 10.0, 10.0, 20.0, 190.0, 20.0, 0.0, 40.0, 40.0, 50.0, 20.0, 90.0, 10.0, 20.0, 40.0, 50.0, 200.0, 100.0, 130.0, 50.0, 170.0, 60.0, 430.0, 60.0, 180.0, 120.0, 70.0, 240.0, -20.0, 490.0, 240.0, 260.0, 110.0, 70.0, 100.0, 210.0, 70.0, 130.0, 100.0, 70.0, 260.0, 60.0, 50.0, 140.0, 130.0, 60.0, 0.0, 70.0, 60.0, 30.0, 40.0, 80.0, 70.0, 360.0, 60.0, 600.0, 120.0, 140.0, 80.0, 130.0, 120.0, 390.0, 70.0, 170.0, 120.0, 560.0, 210.0, 90.0, 40.0, 5.0, 10.0, 300.0, 150.0, -30.0, 60.0, 510.0, 160.0, 60.0, 180.0, 430.0, 250.0, 360.0, 170.0, 50.0, 590.0, 140.0, 60.0, 180.0, 100.0, 10.0, 500.0, 100.0, 120.0, 50.0, 120.0, 80.0, 0.0, 10.0, 110.0, 50.0, 30.0, 140.0, 60.0, 140.0, 60.0, 140.0, 50.0, 150.0, 260.0, 10.0, 10.0, 80.0, -30.0, 610.0, 50.0, 60.0, 30.0, 350.0, 100.0, 220.0, 0.0, 20.0, -10.0, 40.0, 90.0, 220.0, 20.0, 30.0, 170.0, 80.0, 100.0, 90.0, 30.0, 10.0, 10.0, 25.0, 80.0, 50.0, 40.0, 130.0, 40.0, 60.0, 20.0, 250.0, 20.0, 70.0, 130.0, 60.0, 410.0, 20.0, 130.0, -65.0, 30.0, 20.0, 160.0, 350.0, -10.0, 40.0, 0.0, 110.0, 60.0, 500.0, 90.0, 70.0, 180.0, 20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0, 160.0, 215.0, 170.0, 60.0, 80.0, -250.0, 40.0, 20.0, 170.0, 70.0, 230.0, 90.0, 120.0, 190.0, 80.0, 230.0, 80.0, 220.0, 130.0, 320.0, 80.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 230.0, 100.0, 10.0, 140.0, 50.0, 60.0, 140.0, 60.0, 190.0, 190.0, -30.0, 120.0, 90.0, 60.0, 80.0, 70.0, 50.0, -30.0, -15.0, 630.0, 230.0, 140.0, 40.0, 160.0, 40.0, 210.0, 190.0, 30.0, 0.0, 130.0, -5.0, 180.0, 10.0, 320.0, 40.0, -10.0, 120.0, 170.0, 240.0, 760.0, 20.0, 290.0, -110.0, 40.0, 310.0, 310.0, 170.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 110.0, 180.0, 70.0, 40.0, 70.0, 40.0, 20.0, 10.0, 200.0, 0.0, 30.0, 190.0, 130.0, 30.0, 180.0, 40.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 20.0, 90.0, 50.0, 450.0, 50.0, 130.0, 100.0, 230.0, 40.0, 180.0, 70.0, 70.0, 110.0, 70.0, 30.0, 190.0, -20.0, 30.0, 0.0, 130.0, 120.0, 20.0, 15.0, 40.0, 5.0, 40.0, 230.0, 240.0, 390.0, 90.0, 50.0, 100.0, 10.0, 10.0, 40.0, 130.0, 190.0, 290.0, 220.0, 60.0, 470.0, 30.0, 180.0, 90.0, 100.0, 50.0, 150.0, 120.0, 90.0, 210.0, 110.0, 80.0, 60.0, 360.0, 40.0, 100.0, 180.0, 60.0, 80.0, 70.0, 100.0, 710.0, 400.0, 60.0, 80.0, 90.0, 20.0, 40.0, 110.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 200.0, 100.0, 40.0, -90.0, 100.0, 580.0, 350.0, 90.0, 20.0, 110.0, -20.0, 90.0, 0.0, -10.0, 440.0, 50.0, 50.0, 100.0, 0.0, 230.0, 200.0, 80.0, 20.0, 20.0, 30.0, 120.0, 210.0, 100.0, 60.0, 40.0, 20.0, 60.0, 20.0, 320.0, 50.0, 90.0, 60.0, 300.0, 20.0, -10.0, 120.0, 100.0, 80.0, 90.0, 90.0, 20.0, 40.0, 70.0, 180.0, 70.0, 30.0, 70.0, 110.0, 560.0, 330.0, 80.0, 600.0, -10.0, -40.0, 150.0, 20.0, 150.0, 190.0, 10.0, 30.0, 240.0, 70.0, 110.0, 310.0, 60.0, 20.0, 60.0, 160.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 190.0, 30.0, 90.0, 90.0, 180.0, 200.0, 20.0, 110.0, 30.0, 40.0, 80.0, 40.0, 330.0, 100.0, 20.0, 10.0, 40.0, 10.0, 30.0, 130.0, 80.0, 10.0, 40.0, 20.0, 10.0, 90.0, 150.0, 230.0, 0.0, 40.0, 300.0, 60.0, -20.0, 50.0, 220.0, 20.0, 80.0, 20.0, 320.0, 0.0, 80.0, 40.0, 130.0, 210.0, 20.0, -30.0, 30.0, 80.0, 240.0, 310.0, 170.0, 30.0, 30.0, -40.0, 40.0, 30.0, 110.0, 190.0, 130.0, 200.0, 90.0, 190.0, 30.0, 60.0, 20.0, 0.0, 120.0, 80.0, 10.0, 120.0, 10.0, 50.0, 130.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 0.0, 0.0, 0.0, 0.0, 30.0, 260.0, 260.0, 20.0, 180.0, 70.0, 60.0, 40.0, 10.0, 60.0, 30.0, 30.0, 70.0, 650.0, 330.0, 70.0, 270.0, 10.0, 50.0, 295.0, 140.0, 270.0, 230.0, 70.0, 30.0, 190.0, 90.0, 10.0, 180.0, 40.0, 0.0, -20.0, 10.0, 180.0, 210.0, 40.0, 320.0, 110.0, 40.0, 280.0, 60.0, 95.0, 240.0, 40.0, 40.0, 50.0, 130.0, 110.0, 80.0, 20.0, 70.0, 20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5274817138603132, "mean_inference_ms": 1.417667021908868, "mean_action_processing_ms": 0.45213107168499744, "mean_env_wait_ms": 1.2448477590307834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013361692428588867, "StateBufferConnector_ms": 0.010837793350219727, "ViewRequirementAgentConnector_ms": 0.3662734031677246}, "num_episodes": 22, "episode_return_max": 2760.0, "episode_return_min": 70.0, "episode_return_mean": 1071.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.031769816151176, "num_env_steps_trained_throughput_per_sec": 21.031769816151176, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 188036.119, "restore_workers_time_ms": 0.012, "training_step_time_ms": 188036.07, "sample_time_ms": 2526.377, "learn_time_ms": 185487.986, "learn_throughput": 21.565, "synch_weights_time_ms": 10.934}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "33e63_00000", "date": "2024-06-19_04-27-26", "timestamp": 1718785646, "time_this_iter_s": 190.2125289440155, "time_total_s": 26427.47416472435, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32794ca60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26427.47416472435, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 19.474349442379182, "ram_util_percent": 79.06282527881041}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8063799421119486, "cur_kl_coeff": 17.77477546447404, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0024611263664234013, "vf_loss": 7.391028924897329, "vf_explained_var": -3.337468456028623e-05, "kl": Infinity, "entropy": 0.3566219437141388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 2760.0, "episode_reward_min": 70.0, "episode_reward_mean": 1054.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 105.455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1030.0, 1005.0, 870.0, 540.0, 1110.0, 710.0, 1380.0, 520.0, 1640.0, 680.0, 1140.0, 1210.0, 855.0, 1080.0, 70.0, 1820.0, 1240.0, 920.0, 760.0, 1340.0, 870.0, 720.0, 680.0, 640.0, 570.0, 330.0, 1430.0, 1680.0, 1220.0, 830.0, 1940.0, 1395.0, 2760.0, 1380.0, 680.0, 1330.0, 900.0, 760.0, 715.0, 965.0, 1390.0, 780.0, 735.0, 1690.0, 1100.0, 1010.0, 1255.0, 945.0, 1840.0, 1050.0, 740.0, 680.0, 1400.0, 770.0, 840.0, 1300.0, 1470.0, 1290.0, 1650.0, 680.0, 1230.0, 1160.0, 680.0, 1130.0, 770.0, 2030.0, 1070.0, 520.0, 1130.0, 390.0, 910.0, 1120.0, 840.0, 1070.0, 570.0, 160.0, 990.0, 1915.0, 1110.0, 1230.0, 875.0, 930.0, 770.0, 890.0, 1155.0, 665.0, 660.0, 610.0, 890.0, 1215.0, 1050.0, 970.0, 1310.0, 900.0, 590.0, 1310.0, 1300.0, 1340.0, 1760.0, 1910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 70.0, 50.0, 50.0, 260.0, 130.0, 30.0, 20.0, 160.0, 90.0, 240.0, 110.0, 110.0, 20.0, 200.0, 80.0, 120.0, 40.0, 50.0, 35.0, 70.0, 240.0, 70.0, 80.0, 10.0, 50.0, 160.0, -50.0, 20.0, 220.0, 70.0, 30.0, 10.0, 40.0, 20.0, 60.0, 140.0, 110.0, 20.0, 40.0, 60.0, 300.0, 50.0, 10.0, 90.0, 40.0, 110.0, 40.0, 220.0, 190.0, 30.0, -50.0, 170.0, 80.0, 60.0, 30.0, 20.0, 40.0, 210.0, 120.0, 170.0, 310.0, 80.0, 80.0, 110.0, 40.0, 110.0, -10.0, 420.0, 70.0, 0.0, 70.0, 30.0, 230.0, 10.0, 50.0, 10.0, 100.0, 10.0, 10.0, 190.0, 150.0, 110.0, 230.0, 140.0, 250.0, 270.0, 140.0, 130.0, 30.0, 30.0, 60.0, 40.0, 20.0, 10.0, 80.0, 0.0, 20.0, 50.0, 370.0, 60.0, 70.0, 190.0, 40.0, 50.0, 510.0, 40.0, 20.0, 90.0, 70.0, 50.0, 80.0, 40.0, 340.0, 150.0, 20.0, 120.0, 60.0, 220.0, 130.0, 120.0, 60.0, 120.0, 60.0, 30.0, 170.0, 180.0, 40.0, 80.0, -5.0, 220.0, 30.0, 140.0, 250.0, 110.0, 0.0, -20.0, 170.0, 130.0, 50.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 190.0, 130.0, 150.0, 350.0, 130.0, 270.0, 70.0, 310.0, 190.0, 30.0, 140.0, 60.0, 160.0, 130.0, -30.0, 90.0, 320.0, 20.0, 300.0, 50.0, 10.0, 180.0, 80.0, 110.0, 90.0, 160.0, 70.0, -40.0, 20.0, 240.0, 120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0, 50.0, 470.0, 80.0, 380.0, 50.0, 30.0, 70.0, 30.0, 40.0, 140.0, 20.0, 20.0, 90.0, 300.0, 180.0, 100.0, 20.0, 90.0, 50.0, 0.0, 50.0, 20.0, 50.0, 40.0, 380.0, 210.0, -10.0, 10.0, -40.0, 10.0, 10.0, 90.0, 210.0, 20.0, 10.0, 0.0, 0.0, 350.0, 30.0, -40.0, 100.0, 10.0, 20.0, 50.0, 30.0, 110.0, 60.0, 60.0, 60.0, 140.0, 70.0, 30.0, 120.0, 40.0, 80.0, 0.0, 10.0, 10.0, 20.0, 190.0, 20.0, 0.0, 40.0, 40.0, 50.0, 20.0, 90.0, 10.0, 20.0, 40.0, 50.0, 200.0, 100.0, 130.0, 50.0, 170.0, 60.0, 430.0, 60.0, 180.0, 120.0, 70.0, 240.0, -20.0, 490.0, 240.0, 260.0, 110.0, 70.0, 100.0, 210.0, 70.0, 130.0, 100.0, 70.0, 260.0, 60.0, 50.0, 140.0, 130.0, 60.0, 0.0, 70.0, 60.0, 30.0, 40.0, 80.0, 70.0, 360.0, 60.0, 600.0, 120.0, 140.0, 80.0, 130.0, 120.0, 390.0, 70.0, 170.0, 120.0, 560.0, 210.0, 90.0, 40.0, 5.0, 10.0, 300.0, 150.0, -30.0, 60.0, 510.0, 160.0, 60.0, 180.0, 430.0, 250.0, 360.0, 170.0, 50.0, 590.0, 140.0, 60.0, 180.0, 100.0, 10.0, 500.0, 100.0, 120.0, 50.0, 120.0, 80.0, 0.0, 10.0, 110.0, 50.0, 30.0, 140.0, 60.0, 140.0, 60.0, 140.0, 50.0, 150.0, 260.0, 10.0, 10.0, 80.0, -30.0, 610.0, 50.0, 60.0, 30.0, 350.0, 100.0, 220.0, 0.0, 20.0, -10.0, 40.0, 90.0, 220.0, 20.0, 30.0, 170.0, 80.0, 100.0, 90.0, 30.0, 10.0, 10.0, 25.0, 80.0, 50.0, 40.0, 130.0, 40.0, 60.0, 20.0, 250.0, 20.0, 70.0, 130.0, 60.0, 410.0, 20.0, 130.0, -65.0, 30.0, 20.0, 160.0, 350.0, -10.0, 40.0, 0.0, 110.0, 60.0, 500.0, 90.0, 70.0, 180.0, 20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0, 160.0, 215.0, 170.0, 60.0, 80.0, -250.0, 40.0, 20.0, 170.0, 70.0, 230.0, 90.0, 120.0, 190.0, 80.0, 230.0, 80.0, 220.0, 130.0, 320.0, 80.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 230.0, 100.0, 10.0, 140.0, 50.0, 60.0, 140.0, 60.0, 190.0, 190.0, -30.0, 120.0, 90.0, 60.0, 80.0, 70.0, 50.0, -30.0, -15.0, 630.0, 230.0, 140.0, 40.0, 160.0, 40.0, 210.0, 190.0, 30.0, 0.0, 130.0, -5.0, 180.0, 10.0, 320.0, 40.0, -10.0, 120.0, 170.0, 240.0, 760.0, 20.0, 290.0, -110.0, 40.0, 310.0, 310.0, 170.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 110.0, 180.0, 70.0, 40.0, 70.0, 40.0, 20.0, 10.0, 200.0, 0.0, 30.0, 190.0, 130.0, 30.0, 180.0, 40.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 20.0, 90.0, 50.0, 450.0, 50.0, 130.0, 100.0, 230.0, 40.0, 180.0, 70.0, 70.0, 110.0, 70.0, 30.0, 190.0, -20.0, 30.0, 0.0, 130.0, 120.0, 20.0, 15.0, 40.0, 5.0, 40.0, 230.0, 240.0, 390.0, 90.0, 50.0, 100.0, 10.0, 10.0, 40.0, 130.0, 190.0, 290.0, 220.0, 60.0, 470.0, 30.0, 180.0, 90.0, 100.0, 50.0, 150.0, 120.0, 90.0, 210.0, 110.0, 80.0, 60.0, 360.0, 40.0, 100.0, 180.0, 60.0, 80.0, 70.0, 100.0, 710.0, 400.0, 60.0, 80.0, 90.0, 20.0, 40.0, 110.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 200.0, 100.0, 40.0, -90.0, 100.0, 580.0, 350.0, 90.0, 20.0, 110.0, -20.0, 90.0, 0.0, -10.0, 440.0, 50.0, 50.0, 100.0, 0.0, 230.0, 200.0, 80.0, 20.0, 20.0, 30.0, 120.0, 210.0, 100.0, 60.0, 40.0, 20.0, 60.0, 20.0, 320.0, 50.0, 90.0, 60.0, 300.0, 20.0, -10.0, 120.0, 100.0, 80.0, 90.0, 90.0, 20.0, 40.0, 70.0, 180.0, 70.0, 30.0, 70.0, 110.0, 560.0, 330.0, 80.0, 600.0, -10.0, -40.0, 150.0, 20.0, 150.0, 190.0, 10.0, 30.0, 240.0, 70.0, 110.0, 310.0, 60.0, 20.0, 60.0, 160.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 190.0, 30.0, 90.0, 90.0, 180.0, 200.0, 20.0, 110.0, 30.0, 40.0, 80.0, 40.0, 330.0, 100.0, 20.0, 10.0, 40.0, 10.0, 30.0, 130.0, 80.0, 10.0, 40.0, 20.0, 10.0, 90.0, 150.0, 230.0, 0.0, 40.0, 300.0, 60.0, -20.0, 50.0, 220.0, 20.0, 80.0, 20.0, 320.0, 0.0, 80.0, 40.0, 130.0, 210.0, 20.0, -30.0, 30.0, 80.0, 240.0, 310.0, 170.0, 30.0, 30.0, -40.0, 40.0, 30.0, 110.0, 190.0, 130.0, 200.0, 90.0, 190.0, 30.0, 60.0, 20.0, 0.0, 120.0, 80.0, 10.0, 120.0, 10.0, 50.0, 130.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 0.0, 0.0, 0.0, 0.0, 30.0, 260.0, 260.0, 20.0, 180.0, 70.0, 60.0, 40.0, 10.0, 60.0, 30.0, 30.0, 70.0, 650.0, 330.0, 70.0, 270.0, 10.0, 50.0, 295.0, 140.0, 270.0, 230.0, 70.0, 30.0, 190.0, 90.0, 10.0, 180.0, 40.0, 0.0, -20.0, 10.0, 180.0, 210.0, 40.0, 320.0, 110.0, 40.0, 280.0, 60.0, 95.0, 240.0, 40.0, 40.0, 50.0, 130.0, 110.0, 80.0, 20.0, 70.0, 20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0, 60.0, -40.0, 60.0, 410.0, 30.0, 40.0, 70.0, 70.0, 30.0, 40.0, 80.0, 60.0, 30.0, 90.0, 60.0, 80.0, 20.0, 350.0, 60.0, 60.0, 170.0, 80.0, 50.0, -50.0, 100.0, -15.0, 30.0, 360.0, 170.0, 260.0, -50.0, 20.0, 150.0, 40.0, 25.0, 150.0, 80.0, 0.0, 70.0, 180.0, 10.0, 0.0, 20.0, 120.0, 140.0, 40.0, 50.0, 20.0, 140.0, 120.0, 30.0, 10.0, 30.0, 100.0, 230.0, 30.0, 10.0, 0.0, 80.0, 90.0, 60.0, 70.0, 0.0, 140.0, 40.0, 20.0, 500.0, -10.0, 50.0, 20.0, 75.0, 180.0, 250.0, 30.0, 50.0, 350.0, 60.0, 70.0, 10.0, 140.0, 100.0, 30.0, 10.0, 30.0, 550.0, 70.0, 130.0, 70.0, 70.0, -10.0, 30.0, -50.0, 170.0, 180.0, 140.0, 30.0, 200.0, 50.0, 150.0, 70.0, 110.0, 150.0, 80.0, 60.0, 100.0, 410.0, 10.0, 110.0, 220.0, 60.0, 80.0, 150.0, 40.0, 190.0, 40.0, 90.0, 140.0, 110.0, 10.0, 50.0, 10.0, 220.0, 20.0, 100.0, 90.0, 40.0, 0.0, 40.0, 70.0, 0.0, 110.0, 160.0, -10.0, 140.0, 340.0, 120.0, 230.0, 110.0, 80.0, 30.0, 140.0, 10.0, 290.0, 40.0, 440.0, 60.0, 20.0, 30.0, 180.0, 90.0, 70.0, 120.0, 180.0, 30.0, 130.0, 130.0, 20.0, 170.0, 360.0, 130.0, 140.0, 60.0, 430.0, 290.0, 230.0, 100.0, 160.0, 190.0, 70.0, 90.0, 460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5269588700422896, "mean_inference_ms": 1.417462647489372, "mean_action_processing_ms": 0.45167324890483174, "mean_env_wait_ms": 1.2446416213900533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013418912887573242, "StateBufferConnector_ms": 0.010918140411376953, "ViewRequirementAgentConnector_ms": 0.3733348846435547}, "num_episodes": 18, "episode_return_max": 2760.0, "episode_return_min": 70.0, "episode_return_mean": 1054.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.300898049763916, "num_env_steps_trained_throughput_per_sec": 21.300898049763916, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 187924.663, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187924.614, "sample_time_ms": 2538.222, "learn_time_ms": 185363.976, "learn_throughput": 21.579, "synch_weights_time_ms": 11.406}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "33e63_00000", "date": "2024-06-19_04-30-34", "timestamp": 1718785834, "time_this_iter_s": 187.8154580593109, "time_total_s": 26615.28962278366, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278fe430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26615.28962278366, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 16.773308270676694, "ram_util_percent": 79.08458646616542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8058986016228813, "cur_kl_coeff": 26.662163196711052, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.291774919518013, "policy_loss": -0.0020599387070864314, "vf_loss": 7.29097983113493, "vf_explained_var": 0.00060272531641431, "kl": 0.00010708145898136466, "entropy": 0.37301776595453356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 2760.0, "episode_reward_min": 160.0, "episode_reward_mean": 1074.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 107.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 1340.0, 870.0, 720.0, 680.0, 640.0, 570.0, 330.0, 1430.0, 1680.0, 1220.0, 830.0, 1940.0, 1395.0, 2760.0, 1380.0, 680.0, 1330.0, 900.0, 760.0, 715.0, 965.0, 1390.0, 780.0, 735.0, 1690.0, 1100.0, 1010.0, 1255.0, 945.0, 1840.0, 1050.0, 740.0, 680.0, 1400.0, 770.0, 840.0, 1300.0, 1470.0, 1290.0, 1650.0, 680.0, 1230.0, 1160.0, 680.0, 1130.0, 770.0, 2030.0, 1070.0, 520.0, 1130.0, 390.0, 910.0, 1120.0, 840.0, 1070.0, 570.0, 160.0, 990.0, 1915.0, 1110.0, 1230.0, 875.0, 930.0, 770.0, 890.0, 1155.0, 665.0, 660.0, 610.0, 890.0, 1215.0, 1050.0, 970.0, 1310.0, 900.0, 590.0, 1310.0, 1300.0, 1340.0, 1760.0, 1910.0, 775.0, 1820.0, 1245.0, 650.0, 1340.0, 1350.0, 820.0, 560.0, 1225.0, 690.0, 645.0, 1280.0, 1350.0, 1320.0, 1485.0, 1325.0, 1010.0, 875.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [120.0, 60.0, 20.0, 130.0, 50.0, 0.0, 30.0, 20.0, 50.0, 280.0, 50.0, 470.0, 80.0, 380.0, 50.0, 30.0, 70.0, 30.0, 40.0, 140.0, 20.0, 20.0, 90.0, 300.0, 180.0, 100.0, 20.0, 90.0, 50.0, 0.0, 50.0, 20.0, 50.0, 40.0, 380.0, 210.0, -10.0, 10.0, -40.0, 10.0, 10.0, 90.0, 210.0, 20.0, 10.0, 0.0, 0.0, 350.0, 30.0, -40.0, 100.0, 10.0, 20.0, 50.0, 30.0, 110.0, 60.0, 60.0, 60.0, 140.0, 70.0, 30.0, 120.0, 40.0, 80.0, 0.0, 10.0, 10.0, 20.0, 190.0, 20.0, 0.0, 40.0, 40.0, 50.0, 20.0, 90.0, 10.0, 20.0, 40.0, 50.0, 200.0, 100.0, 130.0, 50.0, 170.0, 60.0, 430.0, 60.0, 180.0, 120.0, 70.0, 240.0, -20.0, 490.0, 240.0, 260.0, 110.0, 70.0, 100.0, 210.0, 70.0, 130.0, 100.0, 70.0, 260.0, 60.0, 50.0, 140.0, 130.0, 60.0, 0.0, 70.0, 60.0, 30.0, 40.0, 80.0, 70.0, 360.0, 60.0, 600.0, 120.0, 140.0, 80.0, 130.0, 120.0, 390.0, 70.0, 170.0, 120.0, 560.0, 210.0, 90.0, 40.0, 5.0, 10.0, 300.0, 150.0, -30.0, 60.0, 510.0, 160.0, 60.0, 180.0, 430.0, 250.0, 360.0, 170.0, 50.0, 590.0, 140.0, 60.0, 180.0, 100.0, 10.0, 500.0, 100.0, 120.0, 50.0, 120.0, 80.0, 0.0, 10.0, 110.0, 50.0, 30.0, 140.0, 60.0, 140.0, 60.0, 140.0, 50.0, 150.0, 260.0, 10.0, 10.0, 80.0, -30.0, 610.0, 50.0, 60.0, 30.0, 350.0, 100.0, 220.0, 0.0, 20.0, -10.0, 40.0, 90.0, 220.0, 20.0, 30.0, 170.0, 80.0, 100.0, 90.0, 30.0, 10.0, 10.0, 25.0, 80.0, 50.0, 40.0, 130.0, 40.0, 60.0, 20.0, 250.0, 20.0, 70.0, 130.0, 60.0, 410.0, 20.0, 130.0, -65.0, 30.0, 20.0, 160.0, 350.0, -10.0, 40.0, 0.0, 110.0, 60.0, 500.0, 90.0, 70.0, 180.0, 20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0, 160.0, 215.0, 170.0, 60.0, 80.0, -250.0, 40.0, 20.0, 170.0, 70.0, 230.0, 90.0, 120.0, 190.0, 80.0, 230.0, 80.0, 220.0, 130.0, 320.0, 80.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 230.0, 100.0, 10.0, 140.0, 50.0, 60.0, 140.0, 60.0, 190.0, 190.0, -30.0, 120.0, 90.0, 60.0, 80.0, 70.0, 50.0, -30.0, -15.0, 630.0, 230.0, 140.0, 40.0, 160.0, 40.0, 210.0, 190.0, 30.0, 0.0, 130.0, -5.0, 180.0, 10.0, 320.0, 40.0, -10.0, 120.0, 170.0, 240.0, 760.0, 20.0, 290.0, -110.0, 40.0, 310.0, 310.0, 170.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 110.0, 180.0, 70.0, 40.0, 70.0, 40.0, 20.0, 10.0, 200.0, 0.0, 30.0, 190.0, 130.0, 30.0, 180.0, 40.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 20.0, 90.0, 50.0, 450.0, 50.0, 130.0, 100.0, 230.0, 40.0, 180.0, 70.0, 70.0, 110.0, 70.0, 30.0, 190.0, -20.0, 30.0, 0.0, 130.0, 120.0, 20.0, 15.0, 40.0, 5.0, 40.0, 230.0, 240.0, 390.0, 90.0, 50.0, 100.0, 10.0, 10.0, 40.0, 130.0, 190.0, 290.0, 220.0, 60.0, 470.0, 30.0, 180.0, 90.0, 100.0, 50.0, 150.0, 120.0, 90.0, 210.0, 110.0, 80.0, 60.0, 360.0, 40.0, 100.0, 180.0, 60.0, 80.0, 70.0, 100.0, 710.0, 400.0, 60.0, 80.0, 90.0, 20.0, 40.0, 110.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 200.0, 100.0, 40.0, -90.0, 100.0, 580.0, 350.0, 90.0, 20.0, 110.0, -20.0, 90.0, 0.0, -10.0, 440.0, 50.0, 50.0, 100.0, 0.0, 230.0, 200.0, 80.0, 20.0, 20.0, 30.0, 120.0, 210.0, 100.0, 60.0, 40.0, 20.0, 60.0, 20.0, 320.0, 50.0, 90.0, 60.0, 300.0, 20.0, -10.0, 120.0, 100.0, 80.0, 90.0, 90.0, 20.0, 40.0, 70.0, 180.0, 70.0, 30.0, 70.0, 110.0, 560.0, 330.0, 80.0, 600.0, -10.0, -40.0, 150.0, 20.0, 150.0, 190.0, 10.0, 30.0, 240.0, 70.0, 110.0, 310.0, 60.0, 20.0, 60.0, 160.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 190.0, 30.0, 90.0, 90.0, 180.0, 200.0, 20.0, 110.0, 30.0, 40.0, 80.0, 40.0, 330.0, 100.0, 20.0, 10.0, 40.0, 10.0, 30.0, 130.0, 80.0, 10.0, 40.0, 20.0, 10.0, 90.0, 150.0, 230.0, 0.0, 40.0, 300.0, 60.0, -20.0, 50.0, 220.0, 20.0, 80.0, 20.0, 320.0, 0.0, 80.0, 40.0, 130.0, 210.0, 20.0, -30.0, 30.0, 80.0, 240.0, 310.0, 170.0, 30.0, 30.0, -40.0, 40.0, 30.0, 110.0, 190.0, 130.0, 200.0, 90.0, 190.0, 30.0, 60.0, 20.0, 0.0, 120.0, 80.0, 10.0, 120.0, 10.0, 50.0, 130.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 0.0, 0.0, 0.0, 0.0, 30.0, 260.0, 260.0, 20.0, 180.0, 70.0, 60.0, 40.0, 10.0, 60.0, 30.0, 30.0, 70.0, 650.0, 330.0, 70.0, 270.0, 10.0, 50.0, 295.0, 140.0, 270.0, 230.0, 70.0, 30.0, 190.0, 90.0, 10.0, 180.0, 40.0, 0.0, -20.0, 10.0, 180.0, 210.0, 40.0, 320.0, 110.0, 40.0, 280.0, 60.0, 95.0, 240.0, 40.0, 40.0, 50.0, 130.0, 110.0, 80.0, 20.0, 70.0, 20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0, 60.0, -40.0, 60.0, 410.0, 30.0, 40.0, 70.0, 70.0, 30.0, 40.0, 80.0, 60.0, 30.0, 90.0, 60.0, 80.0, 20.0, 350.0, 60.0, 60.0, 170.0, 80.0, 50.0, -50.0, 100.0, -15.0, 30.0, 360.0, 170.0, 260.0, -50.0, 20.0, 150.0, 40.0, 25.0, 150.0, 80.0, 0.0, 70.0, 180.0, 10.0, 0.0, 20.0, 120.0, 140.0, 40.0, 50.0, 20.0, 140.0, 120.0, 30.0, 10.0, 30.0, 100.0, 230.0, 30.0, 10.0, 0.0, 80.0, 90.0, 60.0, 70.0, 0.0, 140.0, 40.0, 20.0, 500.0, -10.0, 50.0, 20.0, 75.0, 180.0, 250.0, 30.0, 50.0, 350.0, 60.0, 70.0, 10.0, 140.0, 100.0, 30.0, 10.0, 30.0, 550.0, 70.0, 130.0, 70.0, 70.0, -10.0, 30.0, -50.0, 170.0, 180.0, 140.0, 30.0, 200.0, 50.0, 150.0, 70.0, 110.0, 150.0, 80.0, 60.0, 100.0, 410.0, 10.0, 110.0, 220.0, 60.0, 80.0, 150.0, 40.0, 190.0, 40.0, 90.0, 140.0, 110.0, 10.0, 50.0, 10.0, 220.0, 20.0, 100.0, 90.0, 40.0, 0.0, 40.0, 70.0, 0.0, 110.0, 160.0, -10.0, 140.0, 340.0, 120.0, 230.0, 110.0, 80.0, 30.0, 140.0, 10.0, 290.0, 40.0, 440.0, 60.0, 20.0, 30.0, 180.0, 90.0, 70.0, 120.0, 180.0, 30.0, 130.0, 130.0, 20.0, 170.0, 360.0, 130.0, 140.0, 60.0, 430.0, 290.0, 230.0, 100.0, 160.0, 190.0, 70.0, 90.0, 460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0, 20.0, 110.0, 0.0, 30.0, 15.0, 0.0, 20.0, -10.0, 30.0, 560.0, 200.0, 90.0, 230.0, 560.0, 70.0, 210.0, 220.0, 30.0, 90.0, 120.0, 150.0, 40.0, -10.0, 150.0, 145.0, 240.0, 170.0, 50.0, 70.0, 240.0, 50.0, 30.0, 10.0, 90.0, 40.0, 250.0, 30.0, 90.0, 40.0, 20.0, 80.0, 230.0, 170.0, 20.0, 70.0, 70.0, 180.0, 200.0, 200.0, 120.0, 70.0, 40.0, 170.0, 160.0, 210.0, 100.0, 420.0, 80.0, 30.0, 70.0, 190.0, 20.0, 80.0, 0.0, 20.0, 40.0, 30.0, 380.0, 20.0, 40.0, 70.0, 80.0, 90.0, 50.0, -100.0, 30.0, 70.0, 180.0, 70.0, 20.0, 450.0, -40.0, 170.0, -5.0, 140.0, 50.0, 160.0, 120.0, 150.0, 30.0, 160.0, 70.0, 40.0, 40.0, 170.0, 40.0, 40.0, 90.0, 20.0, 20.0, 10.0, 30.0, 355.0, 90.0, 110.0, 10.0, 20.0, 30.0, -50.0, 40.0, 170.0, 240.0, -45.0, 100.0, -35.0, 590.0, 30.0, 30.0, 80.0, 120.0, -10.0, 190.0, 300.0, 70.0, 160.0, 190.0, 60.0, 70.0, 260.0, 60.0, 110.0, 170.0, 30.0, 140.0, 110.0, 210.0, 60.0, 190.0, 60.0, 240.0, 50.0, 470.0, 90.0, 120.0, 280.0, 140.0, 130.0, 75.0, 50.0, 80.0, 280.0, 110.0, 110.0, 80.0, 315.0, 110.0, 180.0, 30.0, 80.0, 30.0, 40.0, 100.0, 170.0, 220.0, 90.0, 150.0, 60.0, 50.0, 90.0, 40.0, 90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5274085734549971, "mean_inference_ms": 1.4179370296912992, "mean_action_processing_ms": 0.4513209747624768, "mean_env_wait_ms": 1.2449141209310475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01373434066772461, "StateBufferConnector_ms": 0.009221315383911133, "ViewRequirementAgentConnector_ms": 0.37323880195617676}, "num_episodes": 18, "episode_return_max": 2760.0, "episode_return_min": 160.0, "episode_return_mean": 1074.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.27828285988681, "num_env_steps_trained_throughput_per_sec": 21.27828285988681, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 187756.915, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187756.865, "sample_time_ms": 2647.11, "learn_time_ms": 185087.507, "learn_throughput": 21.611, "synch_weights_time_ms": 11.305}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "33e63_00000", "date": "2024-06-19_04-33-42", "timestamp": 1718786022, "time_this_iter_s": 187.9935438632965, "time_total_s": 26803.283166646957, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3278fe9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26803.283166646957, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 16.547169811320753, "ram_util_percent": 79.79207547169811}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1198496278863366, "cur_kl_coeff": 13.331081598355526, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002961662565397656, "vf_loss": 7.590456001040019, "vf_explained_var": 0.0001774898479286982, "kl": Infinity, "entropy": 0.344775654784978, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 2030.0, "episode_reward_min": 160.0, "episode_reward_mean": 1056.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 105.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [780.0, 735.0, 1690.0, 1100.0, 1010.0, 1255.0, 945.0, 1840.0, 1050.0, 740.0, 680.0, 1400.0, 770.0, 840.0, 1300.0, 1470.0, 1290.0, 1650.0, 680.0, 1230.0, 1160.0, 680.0, 1130.0, 770.0, 2030.0, 1070.0, 520.0, 1130.0, 390.0, 910.0, 1120.0, 840.0, 1070.0, 570.0, 160.0, 990.0, 1915.0, 1110.0, 1230.0, 875.0, 930.0, 770.0, 890.0, 1155.0, 665.0, 660.0, 610.0, 890.0, 1215.0, 1050.0, 970.0, 1310.0, 900.0, 590.0, 1310.0, 1300.0, 1340.0, 1760.0, 1910.0, 775.0, 1820.0, 1245.0, 650.0, 1340.0, 1350.0, 820.0, 560.0, 1225.0, 690.0, 645.0, 1280.0, 1350.0, 1320.0, 1485.0, 1325.0, 1010.0, 875.0, 1510.0, 1280.0, 840.0, 930.0, 625.0, 640.0, 860.0, 1370.0, 635.0, 1700.0, 1050.0, 400.0, 1330.0, 895.0, 1420.0, 730.0, 960.0, 665.0, 1240.0, 1335.0, 1110.0, 1435.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 190.0, 30.0, 70.0, 70.0, 270.0, 40.0, 0.0, 60.0, 30.0, 160.0, 215.0, 170.0, 60.0, 80.0, -250.0, 40.0, 20.0, 170.0, 70.0, 230.0, 90.0, 120.0, 190.0, 80.0, 230.0, 80.0, 220.0, 130.0, 320.0, 80.0, 100.0, 130.0, 90.0, 180.0, 110.0, 70.0, 230.0, 100.0, 10.0, 140.0, 50.0, 60.0, 140.0, 60.0, 190.0, 190.0, -30.0, 120.0, 90.0, 60.0, 80.0, 70.0, 50.0, -30.0, -15.0, 630.0, 230.0, 140.0, 40.0, 160.0, 40.0, 210.0, 190.0, 30.0, 0.0, 130.0, -5.0, 180.0, 10.0, 320.0, 40.0, -10.0, 120.0, 170.0, 240.0, 760.0, 20.0, 290.0, -110.0, 40.0, 310.0, 310.0, 170.0, 20.0, 50.0, 20.0, 80.0, 40.0, 10.0, 110.0, 180.0, 70.0, 40.0, 70.0, 40.0, 20.0, 10.0, 200.0, 0.0, 30.0, 190.0, 130.0, 30.0, 180.0, 40.0, 10.0, 20.0, 20.0, 30.0, 80.0, 200.0, 20.0, 90.0, 50.0, 450.0, 50.0, 130.0, 100.0, 230.0, 40.0, 180.0, 70.0, 70.0, 110.0, 70.0, 30.0, 190.0, -20.0, 30.0, 0.0, 130.0, 120.0, 20.0, 15.0, 40.0, 5.0, 40.0, 230.0, 240.0, 390.0, 90.0, 50.0, 100.0, 10.0, 10.0, 40.0, 130.0, 190.0, 290.0, 220.0, 60.0, 470.0, 30.0, 180.0, 90.0, 100.0, 50.0, 150.0, 120.0, 90.0, 210.0, 110.0, 80.0, 60.0, 360.0, 40.0, 100.0, 180.0, 60.0, 80.0, 70.0, 100.0, 710.0, 400.0, 60.0, 80.0, 90.0, 20.0, 40.0, 110.0, 40.0, 20.0, 20.0, 70.0, 60.0, 20.0, 200.0, 100.0, 40.0, -90.0, 100.0, 580.0, 350.0, 90.0, 20.0, 110.0, -20.0, 90.0, 0.0, -10.0, 440.0, 50.0, 50.0, 100.0, 0.0, 230.0, 200.0, 80.0, 20.0, 20.0, 30.0, 120.0, 210.0, 100.0, 60.0, 40.0, 20.0, 60.0, 20.0, 320.0, 50.0, 90.0, 60.0, 300.0, 20.0, -10.0, 120.0, 100.0, 80.0, 90.0, 90.0, 20.0, 40.0, 70.0, 180.0, 70.0, 30.0, 70.0, 110.0, 560.0, 330.0, 80.0, 600.0, -10.0, -40.0, 150.0, 20.0, 150.0, 190.0, 10.0, 30.0, 240.0, 70.0, 110.0, 310.0, 60.0, 20.0, 60.0, 160.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 190.0, 30.0, 90.0, 90.0, 180.0, 200.0, 20.0, 110.0, 30.0, 40.0, 80.0, 40.0, 330.0, 100.0, 20.0, 10.0, 40.0, 10.0, 30.0, 130.0, 80.0, 10.0, 40.0, 20.0, 10.0, 90.0, 150.0, 230.0, 0.0, 40.0, 300.0, 60.0, -20.0, 50.0, 220.0, 20.0, 80.0, 20.0, 320.0, 0.0, 80.0, 40.0, 130.0, 210.0, 20.0, -30.0, 30.0, 80.0, 240.0, 310.0, 170.0, 30.0, 30.0, -40.0, 40.0, 30.0, 110.0, 190.0, 130.0, 200.0, 90.0, 190.0, 30.0, 60.0, 20.0, 0.0, 120.0, 80.0, 10.0, 120.0, 10.0, 50.0, 130.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 0.0, 0.0, 0.0, 0.0, 30.0, 260.0, 260.0, 20.0, 180.0, 70.0, 60.0, 40.0, 10.0, 60.0, 30.0, 30.0, 70.0, 650.0, 330.0, 70.0, 270.0, 10.0, 50.0, 295.0, 140.0, 270.0, 230.0, 70.0, 30.0, 190.0, 90.0, 10.0, 180.0, 40.0, 0.0, -20.0, 10.0, 180.0, 210.0, 40.0, 320.0, 110.0, 40.0, 280.0, 60.0, 95.0, 240.0, 40.0, 40.0, 50.0, 130.0, 110.0, 80.0, 20.0, 70.0, 20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0, 60.0, -40.0, 60.0, 410.0, 30.0, 40.0, 70.0, 70.0, 30.0, 40.0, 80.0, 60.0, 30.0, 90.0, 60.0, 80.0, 20.0, 350.0, 60.0, 60.0, 170.0, 80.0, 50.0, -50.0, 100.0, -15.0, 30.0, 360.0, 170.0, 260.0, -50.0, 20.0, 150.0, 40.0, 25.0, 150.0, 80.0, 0.0, 70.0, 180.0, 10.0, 0.0, 20.0, 120.0, 140.0, 40.0, 50.0, 20.0, 140.0, 120.0, 30.0, 10.0, 30.0, 100.0, 230.0, 30.0, 10.0, 0.0, 80.0, 90.0, 60.0, 70.0, 0.0, 140.0, 40.0, 20.0, 500.0, -10.0, 50.0, 20.0, 75.0, 180.0, 250.0, 30.0, 50.0, 350.0, 60.0, 70.0, 10.0, 140.0, 100.0, 30.0, 10.0, 30.0, 550.0, 70.0, 130.0, 70.0, 70.0, -10.0, 30.0, -50.0, 170.0, 180.0, 140.0, 30.0, 200.0, 50.0, 150.0, 70.0, 110.0, 150.0, 80.0, 60.0, 100.0, 410.0, 10.0, 110.0, 220.0, 60.0, 80.0, 150.0, 40.0, 190.0, 40.0, 90.0, 140.0, 110.0, 10.0, 50.0, 10.0, 220.0, 20.0, 100.0, 90.0, 40.0, 0.0, 40.0, 70.0, 0.0, 110.0, 160.0, -10.0, 140.0, 340.0, 120.0, 230.0, 110.0, 80.0, 30.0, 140.0, 10.0, 290.0, 40.0, 440.0, 60.0, 20.0, 30.0, 180.0, 90.0, 70.0, 120.0, 180.0, 30.0, 130.0, 130.0, 20.0, 170.0, 360.0, 130.0, 140.0, 60.0, 430.0, 290.0, 230.0, 100.0, 160.0, 190.0, 70.0, 90.0, 460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0, 20.0, 110.0, 0.0, 30.0, 15.0, 0.0, 20.0, -10.0, 30.0, 560.0, 200.0, 90.0, 230.0, 560.0, 70.0, 210.0, 220.0, 30.0, 90.0, 120.0, 150.0, 40.0, -10.0, 150.0, 145.0, 240.0, 170.0, 50.0, 70.0, 240.0, 50.0, 30.0, 10.0, 90.0, 40.0, 250.0, 30.0, 90.0, 40.0, 20.0, 80.0, 230.0, 170.0, 20.0, 70.0, 70.0, 180.0, 200.0, 200.0, 120.0, 70.0, 40.0, 170.0, 160.0, 210.0, 100.0, 420.0, 80.0, 30.0, 70.0, 190.0, 20.0, 80.0, 0.0, 20.0, 40.0, 30.0, 380.0, 20.0, 40.0, 70.0, 80.0, 90.0, 50.0, -100.0, 30.0, 70.0, 180.0, 70.0, 20.0, 450.0, -40.0, 170.0, -5.0, 140.0, 50.0, 160.0, 120.0, 150.0, 30.0, 160.0, 70.0, 40.0, 40.0, 170.0, 40.0, 40.0, 90.0, 20.0, 20.0, 10.0, 30.0, 355.0, 90.0, 110.0, 10.0, 20.0, 30.0, -50.0, 40.0, 170.0, 240.0, -45.0, 100.0, -35.0, 590.0, 30.0, 30.0, 80.0, 120.0, -10.0, 190.0, 300.0, 70.0, 160.0, 190.0, 60.0, 70.0, 260.0, 60.0, 110.0, 170.0, 30.0, 140.0, 110.0, 210.0, 60.0, 190.0, 60.0, 240.0, 50.0, 470.0, 90.0, 120.0, 280.0, 140.0, 130.0, 75.0, 50.0, 80.0, 280.0, 110.0, 110.0, 80.0, 315.0, 110.0, 180.0, 30.0, 80.0, 30.0, 40.0, 100.0, 170.0, 220.0, 90.0, 150.0, 60.0, 50.0, 90.0, 40.0, 90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0, 100.0, 180.0, 30.0, 130.0, 340.0, 80.0, 250.0, 180.0, 110.0, 110.0, 190.0, 60.0, 210.0, 130.0, 140.0, 20.0, 190.0, 160.0, 100.0, 80.0, 160.0, 40.0, -20.0, -20.0, 40.0, 0.0, 90.0, 350.0, 10.0, 190.0, 50.0, 130.0, 180.0, 140.0, 200.0, 20.0, -260.0, 330.0, 90.0, 50.0, 50.0, 40.0, 40.0, 0.0, 290.0, 180.0, -5.0, 10.0, 40.0, -20.0, 20.0, 110.0, 180.0, 0.0, 20.0, 10.0, 20.0, 20.0, 240.0, 20.0, 50.0, 660.0, -70.0, 60.0, 30.0, 20.0, 30.0, 70.0, 30.0, -20.0, 200.0, 40.0, 50.0, 200.0, 120.0, -20.0, 30.0, 450.0, 0.0, 300.0, 190.0, 0.0, 0.0, 20.0, 20.0, 170.0, 110.0, 80.0, 40.0, 5.0, 580.0, 0.0, 90.0, 80.0, 50.0, 100.0, 100.0, 150.0, 450.0, 100.0, 70.0, 140.0, 90.0, 30.0, 190.0, 150.0, 160.0, 70.0, 90.0, 60.0, 10.0, 20.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, -20.0, 160.0, 90.0, 0.0, 70.0, 80.0, 100.0, 170.0, 120.0, 150.0, 410.0, 140.0, 120.0, 120.0, 20.0, 10.0, 110.0, 230.0, 90.0, 190.0, 5.0, 0.0, 230.0, 70.0, 80.0, 210.0, 390.0, 20.0, 30.0, 70.0, 170.0, 150.0, 10.0, 180.0, 30.0, 60.0, 160.0, 10.0, 10.0, 200.0, 50.0, 20.0, 110.0, 90.0, 140.0, 40.0, 50.0, 20.0, 130.0, 110.0, 100.0, 170.0, 30.0, 60.0, 180.0, 260.0, -85.0, 60.0, 30.0, 60.0, 60.0, 10.0, 60.0, 10.0, 190.0, 190.0, 360.0, 20.0, 60.0, 100.0, 200.0, 50.0, 70.0, -5.0, -150.0, 380.0, 310.0, 160.0, 190.0, 150.0, 80.0, 150.0, 210.0, 40.0, 90.0, 150.0, 340.0, 40.0, 50.0, 70.0, 40.0, 80.0, 20.0, 180.0, -10.0, 140.0, 75.0, 210.0, 140.0, 290.0, 370.0, 20.0, 20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5279524720829725, "mean_inference_ms": 1.4186526083912947, "mean_action_processing_ms": 0.4525299704538328, "mean_env_wait_ms": 1.245293759455811, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013864517211914062, "StateBufferConnector_ms": 0.009405851364135742, "ViewRequirementAgentConnector_ms": 0.37322378158569336}, "num_episodes": 23, "episode_return_max": 2030.0, "episode_return_min": 160.0, "episode_return_mean": 1056.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 20.540175794804707, "num_env_steps_trained_throughput_per_sec": 20.540175794804707, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 188216.385, "restore_workers_time_ms": 0.013, "training_step_time_ms": 188216.335, "sample_time_ms": 2715.176, "learn_time_ms": 185480.463, "learn_throughput": 21.566, "synch_weights_time_ms": 11.052}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "33e63_00000", "date": "2024-06-19_04-36-57", "timestamp": 1718786217, "time_this_iter_s": 194.74977159500122, "time_total_s": 26998.03293824196, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3277080d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26998.03293824196, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 22.767391304347825, "ram_util_percent": 80.73224637681159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6919508790817503, "cur_kl_coeff": 19.996622397533297, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.465621822710616, "policy_loss": -0.0024070561512376364, "vf_loss": 7.465284295432483, "vf_explained_var": 0.00027811644684138515, "kl": 0.00013725222744093916, "entropy": 0.3531065367233639, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 2030.0, "episode_reward_min": 160.0, "episode_reward_mean": 1050.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -260.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 105.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.0, 770.0, 2030.0, 1070.0, 520.0, 1130.0, 390.0, 910.0, 1120.0, 840.0, 1070.0, 570.0, 160.0, 990.0, 1915.0, 1110.0, 1230.0, 875.0, 930.0, 770.0, 890.0, 1155.0, 665.0, 660.0, 610.0, 890.0, 1215.0, 1050.0, 970.0, 1310.0, 900.0, 590.0, 1310.0, 1300.0, 1340.0, 1760.0, 1910.0, 775.0, 1820.0, 1245.0, 650.0, 1340.0, 1350.0, 820.0, 560.0, 1225.0, 690.0, 645.0, 1280.0, 1350.0, 1320.0, 1485.0, 1325.0, 1010.0, 875.0, 1510.0, 1280.0, 840.0, 930.0, 625.0, 640.0, 860.0, 1370.0, 635.0, 1700.0, 1050.0, 400.0, 1330.0, 895.0, 1420.0, 730.0, 960.0, 665.0, 1240.0, 1335.0, 1110.0, 1435.0, 620.0, 1060.0, 705.0, 410.0, 570.0, 1920.0, 1175.0, 1300.0, 1270.0, 1620.0, 900.0, 1485.0, 1130.0, 520.0, 1115.0, 450.0, 1930.0, 720.0, 1345.0, 1070.0, 850.0, 595.0, 1510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [320.0, 50.0, 90.0, 60.0, 300.0, 20.0, -10.0, 120.0, 100.0, 80.0, 90.0, 90.0, 20.0, 40.0, 70.0, 180.0, 70.0, 30.0, 70.0, 110.0, 560.0, 330.0, 80.0, 600.0, -10.0, -40.0, 150.0, 20.0, 150.0, 190.0, 10.0, 30.0, 240.0, 70.0, 110.0, 310.0, 60.0, 20.0, 60.0, 160.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 190.0, 30.0, 90.0, 90.0, 180.0, 200.0, 20.0, 110.0, 30.0, 40.0, 80.0, 40.0, 330.0, 100.0, 20.0, 10.0, 40.0, 10.0, 30.0, 130.0, 80.0, 10.0, 40.0, 20.0, 10.0, 90.0, 150.0, 230.0, 0.0, 40.0, 300.0, 60.0, -20.0, 50.0, 220.0, 20.0, 80.0, 20.0, 320.0, 0.0, 80.0, 40.0, 130.0, 210.0, 20.0, -30.0, 30.0, 80.0, 240.0, 310.0, 170.0, 30.0, 30.0, -40.0, 40.0, 30.0, 110.0, 190.0, 130.0, 200.0, 90.0, 190.0, 30.0, 60.0, 20.0, 0.0, 120.0, 80.0, 10.0, 120.0, 10.0, 50.0, 130.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 0.0, 0.0, 0.0, 0.0, 30.0, 260.0, 260.0, 20.0, 180.0, 70.0, 60.0, 40.0, 10.0, 60.0, 30.0, 30.0, 70.0, 650.0, 330.0, 70.0, 270.0, 10.0, 50.0, 295.0, 140.0, 270.0, 230.0, 70.0, 30.0, 190.0, 90.0, 10.0, 180.0, 40.0, 0.0, -20.0, 10.0, 180.0, 210.0, 40.0, 320.0, 110.0, 40.0, 280.0, 60.0, 95.0, 240.0, 40.0, 40.0, 50.0, 130.0, 110.0, 80.0, 20.0, 70.0, 20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0, 60.0, -40.0, 60.0, 410.0, 30.0, 40.0, 70.0, 70.0, 30.0, 40.0, 80.0, 60.0, 30.0, 90.0, 60.0, 80.0, 20.0, 350.0, 60.0, 60.0, 170.0, 80.0, 50.0, -50.0, 100.0, -15.0, 30.0, 360.0, 170.0, 260.0, -50.0, 20.0, 150.0, 40.0, 25.0, 150.0, 80.0, 0.0, 70.0, 180.0, 10.0, 0.0, 20.0, 120.0, 140.0, 40.0, 50.0, 20.0, 140.0, 120.0, 30.0, 10.0, 30.0, 100.0, 230.0, 30.0, 10.0, 0.0, 80.0, 90.0, 60.0, 70.0, 0.0, 140.0, 40.0, 20.0, 500.0, -10.0, 50.0, 20.0, 75.0, 180.0, 250.0, 30.0, 50.0, 350.0, 60.0, 70.0, 10.0, 140.0, 100.0, 30.0, 10.0, 30.0, 550.0, 70.0, 130.0, 70.0, 70.0, -10.0, 30.0, -50.0, 170.0, 180.0, 140.0, 30.0, 200.0, 50.0, 150.0, 70.0, 110.0, 150.0, 80.0, 60.0, 100.0, 410.0, 10.0, 110.0, 220.0, 60.0, 80.0, 150.0, 40.0, 190.0, 40.0, 90.0, 140.0, 110.0, 10.0, 50.0, 10.0, 220.0, 20.0, 100.0, 90.0, 40.0, 0.0, 40.0, 70.0, 0.0, 110.0, 160.0, -10.0, 140.0, 340.0, 120.0, 230.0, 110.0, 80.0, 30.0, 140.0, 10.0, 290.0, 40.0, 440.0, 60.0, 20.0, 30.0, 180.0, 90.0, 70.0, 120.0, 180.0, 30.0, 130.0, 130.0, 20.0, 170.0, 360.0, 130.0, 140.0, 60.0, 430.0, 290.0, 230.0, 100.0, 160.0, 190.0, 70.0, 90.0, 460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0, 20.0, 110.0, 0.0, 30.0, 15.0, 0.0, 20.0, -10.0, 30.0, 560.0, 200.0, 90.0, 230.0, 560.0, 70.0, 210.0, 220.0, 30.0, 90.0, 120.0, 150.0, 40.0, -10.0, 150.0, 145.0, 240.0, 170.0, 50.0, 70.0, 240.0, 50.0, 30.0, 10.0, 90.0, 40.0, 250.0, 30.0, 90.0, 40.0, 20.0, 80.0, 230.0, 170.0, 20.0, 70.0, 70.0, 180.0, 200.0, 200.0, 120.0, 70.0, 40.0, 170.0, 160.0, 210.0, 100.0, 420.0, 80.0, 30.0, 70.0, 190.0, 20.0, 80.0, 0.0, 20.0, 40.0, 30.0, 380.0, 20.0, 40.0, 70.0, 80.0, 90.0, 50.0, -100.0, 30.0, 70.0, 180.0, 70.0, 20.0, 450.0, -40.0, 170.0, -5.0, 140.0, 50.0, 160.0, 120.0, 150.0, 30.0, 160.0, 70.0, 40.0, 40.0, 170.0, 40.0, 40.0, 90.0, 20.0, 20.0, 10.0, 30.0, 355.0, 90.0, 110.0, 10.0, 20.0, 30.0, -50.0, 40.0, 170.0, 240.0, -45.0, 100.0, -35.0, 590.0, 30.0, 30.0, 80.0, 120.0, -10.0, 190.0, 300.0, 70.0, 160.0, 190.0, 60.0, 70.0, 260.0, 60.0, 110.0, 170.0, 30.0, 140.0, 110.0, 210.0, 60.0, 190.0, 60.0, 240.0, 50.0, 470.0, 90.0, 120.0, 280.0, 140.0, 130.0, 75.0, 50.0, 80.0, 280.0, 110.0, 110.0, 80.0, 315.0, 110.0, 180.0, 30.0, 80.0, 30.0, 40.0, 100.0, 170.0, 220.0, 90.0, 150.0, 60.0, 50.0, 90.0, 40.0, 90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0, 100.0, 180.0, 30.0, 130.0, 340.0, 80.0, 250.0, 180.0, 110.0, 110.0, 190.0, 60.0, 210.0, 130.0, 140.0, 20.0, 190.0, 160.0, 100.0, 80.0, 160.0, 40.0, -20.0, -20.0, 40.0, 0.0, 90.0, 350.0, 10.0, 190.0, 50.0, 130.0, 180.0, 140.0, 200.0, 20.0, -260.0, 330.0, 90.0, 50.0, 50.0, 40.0, 40.0, 0.0, 290.0, 180.0, -5.0, 10.0, 40.0, -20.0, 20.0, 110.0, 180.0, 0.0, 20.0, 10.0, 20.0, 20.0, 240.0, 20.0, 50.0, 660.0, -70.0, 60.0, 30.0, 20.0, 30.0, 70.0, 30.0, -20.0, 200.0, 40.0, 50.0, 200.0, 120.0, -20.0, 30.0, 450.0, 0.0, 300.0, 190.0, 0.0, 0.0, 20.0, 20.0, 170.0, 110.0, 80.0, 40.0, 5.0, 580.0, 0.0, 90.0, 80.0, 50.0, 100.0, 100.0, 150.0, 450.0, 100.0, 70.0, 140.0, 90.0, 30.0, 190.0, 150.0, 160.0, 70.0, 90.0, 60.0, 10.0, 20.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, -20.0, 160.0, 90.0, 0.0, 70.0, 80.0, 100.0, 170.0, 120.0, 150.0, 410.0, 140.0, 120.0, 120.0, 20.0, 10.0, 110.0, 230.0, 90.0, 190.0, 5.0, 0.0, 230.0, 70.0, 80.0, 210.0, 390.0, 20.0, 30.0, 70.0, 170.0, 150.0, 10.0, 180.0, 30.0, 60.0, 160.0, 10.0, 10.0, 200.0, 50.0, 20.0, 110.0, 90.0, 140.0, 40.0, 50.0, 20.0, 130.0, 110.0, 100.0, 170.0, 30.0, 60.0, 180.0, 260.0, -85.0, 60.0, 30.0, 60.0, 60.0, 10.0, 60.0, 10.0, 190.0, 190.0, 360.0, 20.0, 60.0, 100.0, 200.0, 50.0, 70.0, -5.0, -150.0, 380.0, 310.0, 160.0, 190.0, 150.0, 80.0, 150.0, 210.0, 40.0, 90.0, 150.0, 340.0, 40.0, 50.0, 70.0, 40.0, 80.0, 20.0, 180.0, -10.0, 140.0, 75.0, 210.0, 140.0, 290.0, 370.0, 20.0, 20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0, 160.0, 90.0, 90.0, 70.0, 110.0, 160.0, -30.0, 260.0, 170.0, -20.0, 10.0, 80.0, 110.0, 40.0, 15.0, 200.0, 10.0, 90.0, 110.0, 40.0, 90.0, 10.0, 20.0, 20.0, 130.0, 15.0, 30.0, 10.0, 15.0, 70.0, 110.0, 160.0, 50.0, 0.0, 30.0, 110.0, 10.0, 20.0, 30.0, 50.0, 180.0, 200.0, 90.0, 50.0, 90.0, 40.0, 170.0, 310.0, 70.0, 720.0, 160.0, 320.0, 140.0, 70.0, 70.0, 150.0, 5.0, 80.0, 0.0, 180.0, 50.0, 310.0, 250.0, 160.0, 70.0, 30.0, 90.0, 180.0, 40.0, 120.0, 90.0, 190.0, 90.0, 110.0, 90.0, 170.0, 140.0, 120.0, 110.0, 160.0, 90.0, 220.0, 280.0, 60.0, 440.0, 40.0, 120.0, 110.0, 100.0, 160.0, 80.0, 70.0, 20.0, 90.0, 30.0, 50.0, 80.0, 10.0, 90.0, 380.0, 0.0, 60.0, 360.0, 5.0, 100.0, 20.0, 370.0, 480.0, 40.0, 50.0, 60.0, 230.0, 440.0, 0.0, 270.0, 50.0, 60.0, 50.0, 20.0, -50.0, 50.0, 20.0, 90.0, 20.0, 70.0, 40.0, 10.0, 80.0, 90.0, 50.0, 65.0, 60.0, 30.0, 100.0, 130.0, 270.0, 170.0, 10.0, 70.0, 210.0, 30.0, 0.0, 40.0, 50.0, 30.0, 20.0, 10.0, 20.0, 170.0, 80.0, 30.0, 200.0, 60.0, 750.0, 80.0, 160.0, 110.0, 140.0, 350.0, 50.0, 40.0, 140.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 280.0, 40.0, 210.0, 130.0, 150.0, 75.0, 90.0, 130.0, 90.0, 170.0, 100.0, 200.0, 300.0, -140.0, 40.0, 80.0, 140.0, 0.0, 140.0, 20.0, 20.0, 470.0, 40.0, 90.0, 140.0, 110.0, 380.0, 10.0, 40.0, -30.0, 40.0, 30.0, -15.0, 130.0, 180.0, 170.0, 50.0, 20.0, 0.0, -50.0, 0.0, 110.0, 140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5277894266036964, "mean_inference_ms": 1.4186074144349545, "mean_action_processing_ms": 0.45494609679673204, "mean_env_wait_ms": 1.245684800508374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013442516326904297, "StateBufferConnector_ms": 0.009550333023071289, "ViewRequirementAgentConnector_ms": 0.370283842086792}, "num_episodes": 22, "episode_return_max": 2030.0, "episode_return_min": 160.0, "episode_return_mean": 1050.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.573679083216778, "num_env_steps_trained_throughput_per_sec": 21.573679083216778, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 187991.699, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187991.648, "sample_time_ms": 2696.214, "learn_time_ms": 185276.073, "learn_throughput": 21.589, "synch_weights_time_ms": 11.035}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "33e63_00000", "date": "2024-06-19_04-40-02", "timestamp": 1718786402, "time_this_iter_s": 185.4200541973114, "time_total_s": 27183.45299243927, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27183.45299243927, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 16.188167938931297, "ram_util_percent": 79.39236641221373}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.099131462393731, "cur_kl_coeff": 9.998311198766649, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0038368463988095536, "vf_loss": 7.174944286376904, "vf_explained_var": -0.0005853628452085713, "kl": Infinity, "entropy": 0.37368492953503096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 1930.0, "episode_reward_min": -200.0, "episode_reward_mean": 1030.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -540.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 103.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [930.0, 770.0, 890.0, 1155.0, 665.0, 660.0, 610.0, 890.0, 1215.0, 1050.0, 970.0, 1310.0, 900.0, 590.0, 1310.0, 1300.0, 1340.0, 1760.0, 1910.0, 775.0, 1820.0, 1245.0, 650.0, 1340.0, 1350.0, 820.0, 560.0, 1225.0, 690.0, 645.0, 1280.0, 1350.0, 1320.0, 1485.0, 1325.0, 1010.0, 875.0, 1510.0, 1280.0, 840.0, 930.0, 625.0, 640.0, 860.0, 1370.0, 635.0, 1700.0, 1050.0, 400.0, 1330.0, 895.0, 1420.0, 730.0, 960.0, 665.0, 1240.0, 1335.0, 1110.0, 1435.0, 620.0, 1060.0, 705.0, 410.0, 570.0, 1920.0, 1175.0, 1300.0, 1270.0, 1620.0, 900.0, 1485.0, 1130.0, 520.0, 1115.0, 450.0, 1930.0, 720.0, 1345.0, 1070.0, 850.0, 595.0, 1510.0, 1250.0, 1065.0, 325.0, 750.0, 1260.0, -200.0, 880.0, 670.0, 610.0, 585.0, 1175.0, 1490.0, 1190.0, 1400.0, 440.0, 1065.0, 1260.0, 660.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 160.0, 90.0, 40.0, 160.0, 30.0, 180.0, 70.0, 10.0, 170.0, 60.0, -40.0, 60.0, 410.0, 30.0, 40.0, 70.0, 70.0, 30.0, 40.0, 80.0, 60.0, 30.0, 90.0, 60.0, 80.0, 20.0, 350.0, 60.0, 60.0, 170.0, 80.0, 50.0, -50.0, 100.0, -15.0, 30.0, 360.0, 170.0, 260.0, -50.0, 20.0, 150.0, 40.0, 25.0, 150.0, 80.0, 0.0, 70.0, 180.0, 10.0, 0.0, 20.0, 120.0, 140.0, 40.0, 50.0, 20.0, 140.0, 120.0, 30.0, 10.0, 30.0, 100.0, 230.0, 30.0, 10.0, 0.0, 80.0, 90.0, 60.0, 70.0, 0.0, 140.0, 40.0, 20.0, 500.0, -10.0, 50.0, 20.0, 75.0, 180.0, 250.0, 30.0, 50.0, 350.0, 60.0, 70.0, 10.0, 140.0, 100.0, 30.0, 10.0, 30.0, 550.0, 70.0, 130.0, 70.0, 70.0, -10.0, 30.0, -50.0, 170.0, 180.0, 140.0, 30.0, 200.0, 50.0, 150.0, 70.0, 110.0, 150.0, 80.0, 60.0, 100.0, 410.0, 10.0, 110.0, 220.0, 60.0, 80.0, 150.0, 40.0, 190.0, 40.0, 90.0, 140.0, 110.0, 10.0, 50.0, 10.0, 220.0, 20.0, 100.0, 90.0, 40.0, 0.0, 40.0, 70.0, 0.0, 110.0, 160.0, -10.0, 140.0, 340.0, 120.0, 230.0, 110.0, 80.0, 30.0, 140.0, 10.0, 290.0, 40.0, 440.0, 60.0, 20.0, 30.0, 180.0, 90.0, 70.0, 120.0, 180.0, 30.0, 130.0, 130.0, 20.0, 170.0, 360.0, 130.0, 140.0, 60.0, 430.0, 290.0, 230.0, 100.0, 160.0, 190.0, 70.0, 90.0, 460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0, 20.0, 110.0, 0.0, 30.0, 15.0, 0.0, 20.0, -10.0, 30.0, 560.0, 200.0, 90.0, 230.0, 560.0, 70.0, 210.0, 220.0, 30.0, 90.0, 120.0, 150.0, 40.0, -10.0, 150.0, 145.0, 240.0, 170.0, 50.0, 70.0, 240.0, 50.0, 30.0, 10.0, 90.0, 40.0, 250.0, 30.0, 90.0, 40.0, 20.0, 80.0, 230.0, 170.0, 20.0, 70.0, 70.0, 180.0, 200.0, 200.0, 120.0, 70.0, 40.0, 170.0, 160.0, 210.0, 100.0, 420.0, 80.0, 30.0, 70.0, 190.0, 20.0, 80.0, 0.0, 20.0, 40.0, 30.0, 380.0, 20.0, 40.0, 70.0, 80.0, 90.0, 50.0, -100.0, 30.0, 70.0, 180.0, 70.0, 20.0, 450.0, -40.0, 170.0, -5.0, 140.0, 50.0, 160.0, 120.0, 150.0, 30.0, 160.0, 70.0, 40.0, 40.0, 170.0, 40.0, 40.0, 90.0, 20.0, 20.0, 10.0, 30.0, 355.0, 90.0, 110.0, 10.0, 20.0, 30.0, -50.0, 40.0, 170.0, 240.0, -45.0, 100.0, -35.0, 590.0, 30.0, 30.0, 80.0, 120.0, -10.0, 190.0, 300.0, 70.0, 160.0, 190.0, 60.0, 70.0, 260.0, 60.0, 110.0, 170.0, 30.0, 140.0, 110.0, 210.0, 60.0, 190.0, 60.0, 240.0, 50.0, 470.0, 90.0, 120.0, 280.0, 140.0, 130.0, 75.0, 50.0, 80.0, 280.0, 110.0, 110.0, 80.0, 315.0, 110.0, 180.0, 30.0, 80.0, 30.0, 40.0, 100.0, 170.0, 220.0, 90.0, 150.0, 60.0, 50.0, 90.0, 40.0, 90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0, 100.0, 180.0, 30.0, 130.0, 340.0, 80.0, 250.0, 180.0, 110.0, 110.0, 190.0, 60.0, 210.0, 130.0, 140.0, 20.0, 190.0, 160.0, 100.0, 80.0, 160.0, 40.0, -20.0, -20.0, 40.0, 0.0, 90.0, 350.0, 10.0, 190.0, 50.0, 130.0, 180.0, 140.0, 200.0, 20.0, -260.0, 330.0, 90.0, 50.0, 50.0, 40.0, 40.0, 0.0, 290.0, 180.0, -5.0, 10.0, 40.0, -20.0, 20.0, 110.0, 180.0, 0.0, 20.0, 10.0, 20.0, 20.0, 240.0, 20.0, 50.0, 660.0, -70.0, 60.0, 30.0, 20.0, 30.0, 70.0, 30.0, -20.0, 200.0, 40.0, 50.0, 200.0, 120.0, -20.0, 30.0, 450.0, 0.0, 300.0, 190.0, 0.0, 0.0, 20.0, 20.0, 170.0, 110.0, 80.0, 40.0, 5.0, 580.0, 0.0, 90.0, 80.0, 50.0, 100.0, 100.0, 150.0, 450.0, 100.0, 70.0, 140.0, 90.0, 30.0, 190.0, 150.0, 160.0, 70.0, 90.0, 60.0, 10.0, 20.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, -20.0, 160.0, 90.0, 0.0, 70.0, 80.0, 100.0, 170.0, 120.0, 150.0, 410.0, 140.0, 120.0, 120.0, 20.0, 10.0, 110.0, 230.0, 90.0, 190.0, 5.0, 0.0, 230.0, 70.0, 80.0, 210.0, 390.0, 20.0, 30.0, 70.0, 170.0, 150.0, 10.0, 180.0, 30.0, 60.0, 160.0, 10.0, 10.0, 200.0, 50.0, 20.0, 110.0, 90.0, 140.0, 40.0, 50.0, 20.0, 130.0, 110.0, 100.0, 170.0, 30.0, 60.0, 180.0, 260.0, -85.0, 60.0, 30.0, 60.0, 60.0, 10.0, 60.0, 10.0, 190.0, 190.0, 360.0, 20.0, 60.0, 100.0, 200.0, 50.0, 70.0, -5.0, -150.0, 380.0, 310.0, 160.0, 190.0, 150.0, 80.0, 150.0, 210.0, 40.0, 90.0, 150.0, 340.0, 40.0, 50.0, 70.0, 40.0, 80.0, 20.0, 180.0, -10.0, 140.0, 75.0, 210.0, 140.0, 290.0, 370.0, 20.0, 20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0, 160.0, 90.0, 90.0, 70.0, 110.0, 160.0, -30.0, 260.0, 170.0, -20.0, 10.0, 80.0, 110.0, 40.0, 15.0, 200.0, 10.0, 90.0, 110.0, 40.0, 90.0, 10.0, 20.0, 20.0, 130.0, 15.0, 30.0, 10.0, 15.0, 70.0, 110.0, 160.0, 50.0, 0.0, 30.0, 110.0, 10.0, 20.0, 30.0, 50.0, 180.0, 200.0, 90.0, 50.0, 90.0, 40.0, 170.0, 310.0, 70.0, 720.0, 160.0, 320.0, 140.0, 70.0, 70.0, 150.0, 5.0, 80.0, 0.0, 180.0, 50.0, 310.0, 250.0, 160.0, 70.0, 30.0, 90.0, 180.0, 40.0, 120.0, 90.0, 190.0, 90.0, 110.0, 90.0, 170.0, 140.0, 120.0, 110.0, 160.0, 90.0, 220.0, 280.0, 60.0, 440.0, 40.0, 120.0, 110.0, 100.0, 160.0, 80.0, 70.0, 20.0, 90.0, 30.0, 50.0, 80.0, 10.0, 90.0, 380.0, 0.0, 60.0, 360.0, 5.0, 100.0, 20.0, 370.0, 480.0, 40.0, 50.0, 60.0, 230.0, 440.0, 0.0, 270.0, 50.0, 60.0, 50.0, 20.0, -50.0, 50.0, 20.0, 90.0, 20.0, 70.0, 40.0, 10.0, 80.0, 90.0, 50.0, 65.0, 60.0, 30.0, 100.0, 130.0, 270.0, 170.0, 10.0, 70.0, 210.0, 30.0, 0.0, 40.0, 50.0, 30.0, 20.0, 10.0, 20.0, 170.0, 80.0, 30.0, 200.0, 60.0, 750.0, 80.0, 160.0, 110.0, 140.0, 350.0, 50.0, 40.0, 140.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 280.0, 40.0, 210.0, 130.0, 150.0, 75.0, 90.0, 130.0, 90.0, 170.0, 100.0, 200.0, 300.0, -140.0, 40.0, 80.0, 140.0, 0.0, 140.0, 20.0, 20.0, 470.0, 40.0, 90.0, 140.0, 110.0, 380.0, 10.0, 40.0, -30.0, 40.0, 30.0, -15.0, 130.0, 180.0, 170.0, 50.0, 20.0, 0.0, -50.0, 0.0, 110.0, 140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0, 70.0, 280.0, 60.0, 260.0, 120.0, 320.0, 90.0, 60.0, -100.0, 90.0, 90.0, 60.0, 260.0, 50.0, 40.0, 70.0, 170.0, 280.0, 20.0, 25.0, 20.0, -5.0, 70.0, 130.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 110.0, 130.0, 170.0, 10.0, 270.0, 0.0, 30.0, 0.0, 10.0, 20.0, -30.0, 100.0, 50.0, 290.0, 70.0, 390.0, 240.0, 50.0, 80.0, 20.0, 30.0, 40.0, -40.0, -540.0, 20.0, 60.0, 20.0, -30.0, 90.0, 150.0, 10.0, 100.0, 220.0, 50.0, 200.0, 40.0, -70.0, 200.0, 110.0, 20.0, 10.0, 70.0, 30.0, 40.0, 140.0, 0.0, 40.0, 180.0, 0.0, 160.0, 90.0, 40.0, 70.0, 110.0, -110.0, 280.0, 60.0, 40.0, 30.0, 0.0, 190.0, 40.0, 20.0, 90.0, -15.0, 10.0, 100.0, 60.0, 30.0, 60.0, 30.0, 10.0, 80.0, 215.0, 370.0, 20.0, 180.0, 140.0, 120.0, 10.0, 210.0, 410.0, 70.0, 120.0, 110.0, 60.0, 120.0, 70.0, 120.0, 200.0, 380.0, 10.0, 60.0, 50.0, 140.0, 50.0, 320.0, 70.0, 50.0, 60.0, 30.0, 60.0, 180.0, 110.0, 240.0, 230.0, 100.0, 130.0, 260.0, 60.0, 50.0, 140.0, 0.0, 50.0, 90.0, 0.0, -10.0, 20.0, 0.0, 100.0, 65.0, 140.0, 230.0, 110.0, 50.0, 20.0, 290.0, 20.0, 120.0, 20.0, 150.0, 160.0, 160.0, 90.0, 80.0, 130.0, 240.0, 110.0, 90.0, 50.0, 110.0, 130.0, 90.0, 80.0, 50.0, 80.0, -180.0, 90.0, 230.0, -20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5289992391641374, "mean_inference_ms": 1.4201870690375404, "mean_action_processing_ms": 0.45584907537564573, "mean_env_wait_ms": 1.245990137643802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012538671493530273, "StateBufferConnector_ms": 0.009474992752075195, "ViewRequirementAgentConnector_ms": 0.37038755416870117}, "num_episodes": 18, "episode_return_max": 1930.0, "episode_return_min": -200.0, "episode_return_mean": 1030.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.532059778896993, "num_env_steps_trained_throughput_per_sec": 21.532059778896993, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 187895.021, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187894.971, "sample_time_ms": 2674.766, "learn_time_ms": 185201.303, "learn_throughput": 21.598, "synch_weights_time_ms": 10.734}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "33e63_00000", "date": "2024-06-19_04-43-08", "timestamp": 1718786588, "time_this_iter_s": 185.79724192619324, "time_total_s": 27369.250234365463, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32799f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27369.250234365463, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 16.474904942965782, "ram_util_percent": 79.52129277566539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4078110096934506, "cur_kl_coeff": 14.997466798149965, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002318557714562391, "vf_loss": 6.419475664447544, "vf_explained_var": -0.0004453729580258663, "kl": Infinity, "entropy": 0.40212773941258906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 1930.0, "episode_reward_min": -200.0, "episode_reward_mean": 1002.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -540.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 100.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1910.0, 775.0, 1820.0, 1245.0, 650.0, 1340.0, 1350.0, 820.0, 560.0, 1225.0, 690.0, 645.0, 1280.0, 1350.0, 1320.0, 1485.0, 1325.0, 1010.0, 875.0, 1510.0, 1280.0, 840.0, 930.0, 625.0, 640.0, 860.0, 1370.0, 635.0, 1700.0, 1050.0, 400.0, 1330.0, 895.0, 1420.0, 730.0, 960.0, 665.0, 1240.0, 1335.0, 1110.0, 1435.0, 620.0, 1060.0, 705.0, 410.0, 570.0, 1920.0, 1175.0, 1300.0, 1270.0, 1620.0, 900.0, 1485.0, 1130.0, 520.0, 1115.0, 450.0, 1930.0, 720.0, 1345.0, 1070.0, 850.0, 595.0, 1510.0, 1250.0, 1065.0, 325.0, 750.0, 1260.0, -200.0, 880.0, 670.0, 610.0, 585.0, 1175.0, 1490.0, 1190.0, 1400.0, 440.0, 1065.0, 1260.0, 660.0, 215.0, 350.0, 930.0, 410.0, 1690.0, 500.0, 1320.0, 1430.0, 1120.0, 825.0, 980.0, 420.0, 900.0, 890.0, 1030.0, 1380.0, 860.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [460.0, 80.0, 170.0, 230.0, 130.0, 270.0, 20.0, 350.0, 80.0, 120.0, 20.0, 110.0, 0.0, 30.0, 15.0, 0.0, 20.0, -10.0, 30.0, 560.0, 200.0, 90.0, 230.0, 560.0, 70.0, 210.0, 220.0, 30.0, 90.0, 120.0, 150.0, 40.0, -10.0, 150.0, 145.0, 240.0, 170.0, 50.0, 70.0, 240.0, 50.0, 30.0, 10.0, 90.0, 40.0, 250.0, 30.0, 90.0, 40.0, 20.0, 80.0, 230.0, 170.0, 20.0, 70.0, 70.0, 180.0, 200.0, 200.0, 120.0, 70.0, 40.0, 170.0, 160.0, 210.0, 100.0, 420.0, 80.0, 30.0, 70.0, 190.0, 20.0, 80.0, 0.0, 20.0, 40.0, 30.0, 380.0, 20.0, 40.0, 70.0, 80.0, 90.0, 50.0, -100.0, 30.0, 70.0, 180.0, 70.0, 20.0, 450.0, -40.0, 170.0, -5.0, 140.0, 50.0, 160.0, 120.0, 150.0, 30.0, 160.0, 70.0, 40.0, 40.0, 170.0, 40.0, 40.0, 90.0, 20.0, 20.0, 10.0, 30.0, 355.0, 90.0, 110.0, 10.0, 20.0, 30.0, -50.0, 40.0, 170.0, 240.0, -45.0, 100.0, -35.0, 590.0, 30.0, 30.0, 80.0, 120.0, -10.0, 190.0, 300.0, 70.0, 160.0, 190.0, 60.0, 70.0, 260.0, 60.0, 110.0, 170.0, 30.0, 140.0, 110.0, 210.0, 60.0, 190.0, 60.0, 240.0, 50.0, 470.0, 90.0, 120.0, 280.0, 140.0, 130.0, 75.0, 50.0, 80.0, 280.0, 110.0, 110.0, 80.0, 315.0, 110.0, 180.0, 30.0, 80.0, 30.0, 40.0, 100.0, 170.0, 220.0, 90.0, 150.0, 60.0, 50.0, 90.0, 40.0, 90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0, 100.0, 180.0, 30.0, 130.0, 340.0, 80.0, 250.0, 180.0, 110.0, 110.0, 190.0, 60.0, 210.0, 130.0, 140.0, 20.0, 190.0, 160.0, 100.0, 80.0, 160.0, 40.0, -20.0, -20.0, 40.0, 0.0, 90.0, 350.0, 10.0, 190.0, 50.0, 130.0, 180.0, 140.0, 200.0, 20.0, -260.0, 330.0, 90.0, 50.0, 50.0, 40.0, 40.0, 0.0, 290.0, 180.0, -5.0, 10.0, 40.0, -20.0, 20.0, 110.0, 180.0, 0.0, 20.0, 10.0, 20.0, 20.0, 240.0, 20.0, 50.0, 660.0, -70.0, 60.0, 30.0, 20.0, 30.0, 70.0, 30.0, -20.0, 200.0, 40.0, 50.0, 200.0, 120.0, -20.0, 30.0, 450.0, 0.0, 300.0, 190.0, 0.0, 0.0, 20.0, 20.0, 170.0, 110.0, 80.0, 40.0, 5.0, 580.0, 0.0, 90.0, 80.0, 50.0, 100.0, 100.0, 150.0, 450.0, 100.0, 70.0, 140.0, 90.0, 30.0, 190.0, 150.0, 160.0, 70.0, 90.0, 60.0, 10.0, 20.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, -20.0, 160.0, 90.0, 0.0, 70.0, 80.0, 100.0, 170.0, 120.0, 150.0, 410.0, 140.0, 120.0, 120.0, 20.0, 10.0, 110.0, 230.0, 90.0, 190.0, 5.0, 0.0, 230.0, 70.0, 80.0, 210.0, 390.0, 20.0, 30.0, 70.0, 170.0, 150.0, 10.0, 180.0, 30.0, 60.0, 160.0, 10.0, 10.0, 200.0, 50.0, 20.0, 110.0, 90.0, 140.0, 40.0, 50.0, 20.0, 130.0, 110.0, 100.0, 170.0, 30.0, 60.0, 180.0, 260.0, -85.0, 60.0, 30.0, 60.0, 60.0, 10.0, 60.0, 10.0, 190.0, 190.0, 360.0, 20.0, 60.0, 100.0, 200.0, 50.0, 70.0, -5.0, -150.0, 380.0, 310.0, 160.0, 190.0, 150.0, 80.0, 150.0, 210.0, 40.0, 90.0, 150.0, 340.0, 40.0, 50.0, 70.0, 40.0, 80.0, 20.0, 180.0, -10.0, 140.0, 75.0, 210.0, 140.0, 290.0, 370.0, 20.0, 20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0, 160.0, 90.0, 90.0, 70.0, 110.0, 160.0, -30.0, 260.0, 170.0, -20.0, 10.0, 80.0, 110.0, 40.0, 15.0, 200.0, 10.0, 90.0, 110.0, 40.0, 90.0, 10.0, 20.0, 20.0, 130.0, 15.0, 30.0, 10.0, 15.0, 70.0, 110.0, 160.0, 50.0, 0.0, 30.0, 110.0, 10.0, 20.0, 30.0, 50.0, 180.0, 200.0, 90.0, 50.0, 90.0, 40.0, 170.0, 310.0, 70.0, 720.0, 160.0, 320.0, 140.0, 70.0, 70.0, 150.0, 5.0, 80.0, 0.0, 180.0, 50.0, 310.0, 250.0, 160.0, 70.0, 30.0, 90.0, 180.0, 40.0, 120.0, 90.0, 190.0, 90.0, 110.0, 90.0, 170.0, 140.0, 120.0, 110.0, 160.0, 90.0, 220.0, 280.0, 60.0, 440.0, 40.0, 120.0, 110.0, 100.0, 160.0, 80.0, 70.0, 20.0, 90.0, 30.0, 50.0, 80.0, 10.0, 90.0, 380.0, 0.0, 60.0, 360.0, 5.0, 100.0, 20.0, 370.0, 480.0, 40.0, 50.0, 60.0, 230.0, 440.0, 0.0, 270.0, 50.0, 60.0, 50.0, 20.0, -50.0, 50.0, 20.0, 90.0, 20.0, 70.0, 40.0, 10.0, 80.0, 90.0, 50.0, 65.0, 60.0, 30.0, 100.0, 130.0, 270.0, 170.0, 10.0, 70.0, 210.0, 30.0, 0.0, 40.0, 50.0, 30.0, 20.0, 10.0, 20.0, 170.0, 80.0, 30.0, 200.0, 60.0, 750.0, 80.0, 160.0, 110.0, 140.0, 350.0, 50.0, 40.0, 140.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 280.0, 40.0, 210.0, 130.0, 150.0, 75.0, 90.0, 130.0, 90.0, 170.0, 100.0, 200.0, 300.0, -140.0, 40.0, 80.0, 140.0, 0.0, 140.0, 20.0, 20.0, 470.0, 40.0, 90.0, 140.0, 110.0, 380.0, 10.0, 40.0, -30.0, 40.0, 30.0, -15.0, 130.0, 180.0, 170.0, 50.0, 20.0, 0.0, -50.0, 0.0, 110.0, 140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0, 70.0, 280.0, 60.0, 260.0, 120.0, 320.0, 90.0, 60.0, -100.0, 90.0, 90.0, 60.0, 260.0, 50.0, 40.0, 70.0, 170.0, 280.0, 20.0, 25.0, 20.0, -5.0, 70.0, 130.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 110.0, 130.0, 170.0, 10.0, 270.0, 0.0, 30.0, 0.0, 10.0, 20.0, -30.0, 100.0, 50.0, 290.0, 70.0, 390.0, 240.0, 50.0, 80.0, 20.0, 30.0, 40.0, -40.0, -540.0, 20.0, 60.0, 20.0, -30.0, 90.0, 150.0, 10.0, 100.0, 220.0, 50.0, 200.0, 40.0, -70.0, 200.0, 110.0, 20.0, 10.0, 70.0, 30.0, 40.0, 140.0, 0.0, 40.0, 180.0, 0.0, 160.0, 90.0, 40.0, 70.0, 110.0, -110.0, 280.0, 60.0, 40.0, 30.0, 0.0, 190.0, 40.0, 20.0, 90.0, -15.0, 10.0, 100.0, 60.0, 30.0, 60.0, 30.0, 10.0, 80.0, 215.0, 370.0, 20.0, 180.0, 140.0, 120.0, 10.0, 210.0, 410.0, 70.0, 120.0, 110.0, 60.0, 120.0, 70.0, 120.0, 200.0, 380.0, 10.0, 60.0, 50.0, 140.0, 50.0, 320.0, 70.0, 50.0, 60.0, 30.0, 60.0, 180.0, 110.0, 240.0, 230.0, 100.0, 130.0, 260.0, 60.0, 50.0, 140.0, 0.0, 50.0, 90.0, 0.0, -10.0, 20.0, 0.0, 100.0, 65.0, 140.0, 230.0, 110.0, 50.0, 20.0, 290.0, 20.0, 120.0, 20.0, 150.0, 160.0, 160.0, 90.0, 80.0, 130.0, 240.0, 110.0, 90.0, 50.0, 110.0, 130.0, 90.0, 80.0, 50.0, 80.0, -180.0, 90.0, 230.0, -20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 25.0, 50.0, 30.0, -10.0, 0.0, 20.0, 10.0, 140.0, 20.0, 30.0, 30.0, 20.0, 10.0, 30.0, 40.0, 290.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 40.0, 70.0, 20.0, 190.0, 25.0, 10.0, 10.0, 25.0, 10.0, 60.0, 10.0, 20.0, 50.0, 70.0, 50.0, 110.0, 270.0, 110.0, 300.0, 60.0, 300.0, 140.0, 280.0, 60.0, 20.0, 60.0, 60.0, 20.0, 110.0, 110.0, 10.0, 0.0, 50.0, 110.0, 50.0, 270.0, 80.0, 270.0, 20.0, 0.0, 80.0, 160.0, 280.0, 340.0, 50.0, 70.0, 20.0, 220.0, 230.0, 20.0, 150.0, 80.0, 250.0, 90.0, 190.0, 20.0, 60.0, 190.0, 170.0, 50.0, 190.0, 30.0, 130.0, 50.0, 180.0, 50.0, 30.0, 0.0, 110.0, 5.0, 280.0, 90.0, 30.0, 170.0, 20.0, 70.0, 80.0, 250.0, 180.0, 20.0, 80.0, 30.0, 80.0, 30.0, 40.0, 120.0, 40.0, 20.0, 70.0, 40.0, 0.0, 20.0, 40.0, 30.0, 120.0, 50.0, 70.0, 80.0, 50.0, 70.0, 150.0, 70.0, 210.0, 80.0, 80.0, 130.0, 290.0, 40.0, 70.0, 40.0, 30.0, 110.0, 20.0, 120.0, 120.0, 10.0, 20.0, 80.0, 320.0, 70.0, 280.0, 40.0, -30.0, 490.0, 40.0, 20.0, 350.0, 190.0, 60.0, 20.0, 80.0, 60.0, 70.0, 110.0, 80.0, 20.0, 10.0, 190.0, 200.0, 50.0, 90.0, 120.0, -10.0, 10.0, 70.0, -30.0, 10.0, -20.0, 10.0, 30.0, 60.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5294030226678377, "mean_inference_ms": 1.4209617382088482, "mean_action_processing_ms": 0.4571422296118283, "mean_env_wait_ms": 1.246390833153936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012836933135986328, "StateBufferConnector_ms": 0.009587287902832031, "ViewRequirementAgentConnector_ms": 0.3681166172027588}, "num_episodes": 18, "episode_return_max": 1930.0, "episode_return_min": -200.0, "episode_return_mean": 1002.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.418364812481535, "num_env_steps_trained_throughput_per_sec": 21.418364812481535, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 187927.582, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187927.532, "sample_time_ms": 2689.587, "learn_time_ms": 185218.701, "learn_throughput": 21.596, "synch_weights_time_ms": 10.864}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "33e63_00000", "date": "2024-06-19_04-46-15", "timestamp": 1718786775, "time_this_iter_s": 186.76180219650269, "time_total_s": 27556.012036561966, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327992c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27556.012036561966, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.28219696969697, "ram_util_percent": 80.41477272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6993099601631854, "cur_kl_coeff": 22.496200197224955, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002142532894941279, "vf_loss": 7.193083340926165, "vf_explained_var": 0.0005240342995356193, "kl": Infinity, "entropy": 0.3757686368573588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 1930.0, "episode_reward_min": -200.0, "episode_reward_mean": 985.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -540.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 98.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [875.0, 1510.0, 1280.0, 840.0, 930.0, 625.0, 640.0, 860.0, 1370.0, 635.0, 1700.0, 1050.0, 400.0, 1330.0, 895.0, 1420.0, 730.0, 960.0, 665.0, 1240.0, 1335.0, 1110.0, 1435.0, 620.0, 1060.0, 705.0, 410.0, 570.0, 1920.0, 1175.0, 1300.0, 1270.0, 1620.0, 900.0, 1485.0, 1130.0, 520.0, 1115.0, 450.0, 1930.0, 720.0, 1345.0, 1070.0, 850.0, 595.0, 1510.0, 1250.0, 1065.0, 325.0, 750.0, 1260.0, -200.0, 880.0, 670.0, 610.0, 585.0, 1175.0, 1490.0, 1190.0, 1400.0, 440.0, 1065.0, 1260.0, 660.0, 215.0, 350.0, 930.0, 410.0, 1690.0, 500.0, 1320.0, 1430.0, 1120.0, 825.0, 980.0, 420.0, 900.0, 890.0, 1030.0, 1380.0, 860.0, 200.0, 1640.0, 640.0, 660.0, 1010.0, 1180.0, 1100.0, 1210.0, 1580.0, 450.0, 930.0, 230.0, 1520.0, 990.0, 1750.0, 1555.0, 1185.0, 840.0, 605.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 130.0, 320.0, 50.0, 35.0, -25.0, 60.0, 0.0, 15.0, 200.0, 100.0, 180.0, 30.0, 130.0, 340.0, 80.0, 250.0, 180.0, 110.0, 110.0, 190.0, 60.0, 210.0, 130.0, 140.0, 20.0, 190.0, 160.0, 100.0, 80.0, 160.0, 40.0, -20.0, -20.0, 40.0, 0.0, 90.0, 350.0, 10.0, 190.0, 50.0, 130.0, 180.0, 140.0, 200.0, 20.0, -260.0, 330.0, 90.0, 50.0, 50.0, 40.0, 40.0, 0.0, 290.0, 180.0, -5.0, 10.0, 40.0, -20.0, 20.0, 110.0, 180.0, 0.0, 20.0, 10.0, 20.0, 20.0, 240.0, 20.0, 50.0, 660.0, -70.0, 60.0, 30.0, 20.0, 30.0, 70.0, 30.0, -20.0, 200.0, 40.0, 50.0, 200.0, 120.0, -20.0, 30.0, 450.0, 0.0, 300.0, 190.0, 0.0, 0.0, 20.0, 20.0, 170.0, 110.0, 80.0, 40.0, 5.0, 580.0, 0.0, 90.0, 80.0, 50.0, 100.0, 100.0, 150.0, 450.0, 100.0, 70.0, 140.0, 90.0, 30.0, 190.0, 150.0, 160.0, 70.0, 90.0, 60.0, 10.0, 20.0, 20.0, 20.0, 40.0, 100.0, 10.0, 40.0, -20.0, 160.0, 90.0, 0.0, 70.0, 80.0, 100.0, 170.0, 120.0, 150.0, 410.0, 140.0, 120.0, 120.0, 20.0, 10.0, 110.0, 230.0, 90.0, 190.0, 5.0, 0.0, 230.0, 70.0, 80.0, 210.0, 390.0, 20.0, 30.0, 70.0, 170.0, 150.0, 10.0, 180.0, 30.0, 60.0, 160.0, 10.0, 10.0, 200.0, 50.0, 20.0, 110.0, 90.0, 140.0, 40.0, 50.0, 20.0, 130.0, 110.0, 100.0, 170.0, 30.0, 60.0, 180.0, 260.0, -85.0, 60.0, 30.0, 60.0, 60.0, 10.0, 60.0, 10.0, 190.0, 190.0, 360.0, 20.0, 60.0, 100.0, 200.0, 50.0, 70.0, -5.0, -150.0, 380.0, 310.0, 160.0, 190.0, 150.0, 80.0, 150.0, 210.0, 40.0, 90.0, 150.0, 340.0, 40.0, 50.0, 70.0, 40.0, 80.0, 20.0, 180.0, -10.0, 140.0, 75.0, 210.0, 140.0, 290.0, 370.0, 20.0, 20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0, 160.0, 90.0, 90.0, 70.0, 110.0, 160.0, -30.0, 260.0, 170.0, -20.0, 10.0, 80.0, 110.0, 40.0, 15.0, 200.0, 10.0, 90.0, 110.0, 40.0, 90.0, 10.0, 20.0, 20.0, 130.0, 15.0, 30.0, 10.0, 15.0, 70.0, 110.0, 160.0, 50.0, 0.0, 30.0, 110.0, 10.0, 20.0, 30.0, 50.0, 180.0, 200.0, 90.0, 50.0, 90.0, 40.0, 170.0, 310.0, 70.0, 720.0, 160.0, 320.0, 140.0, 70.0, 70.0, 150.0, 5.0, 80.0, 0.0, 180.0, 50.0, 310.0, 250.0, 160.0, 70.0, 30.0, 90.0, 180.0, 40.0, 120.0, 90.0, 190.0, 90.0, 110.0, 90.0, 170.0, 140.0, 120.0, 110.0, 160.0, 90.0, 220.0, 280.0, 60.0, 440.0, 40.0, 120.0, 110.0, 100.0, 160.0, 80.0, 70.0, 20.0, 90.0, 30.0, 50.0, 80.0, 10.0, 90.0, 380.0, 0.0, 60.0, 360.0, 5.0, 100.0, 20.0, 370.0, 480.0, 40.0, 50.0, 60.0, 230.0, 440.0, 0.0, 270.0, 50.0, 60.0, 50.0, 20.0, -50.0, 50.0, 20.0, 90.0, 20.0, 70.0, 40.0, 10.0, 80.0, 90.0, 50.0, 65.0, 60.0, 30.0, 100.0, 130.0, 270.0, 170.0, 10.0, 70.0, 210.0, 30.0, 0.0, 40.0, 50.0, 30.0, 20.0, 10.0, 20.0, 170.0, 80.0, 30.0, 200.0, 60.0, 750.0, 80.0, 160.0, 110.0, 140.0, 350.0, 50.0, 40.0, 140.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 280.0, 40.0, 210.0, 130.0, 150.0, 75.0, 90.0, 130.0, 90.0, 170.0, 100.0, 200.0, 300.0, -140.0, 40.0, 80.0, 140.0, 0.0, 140.0, 20.0, 20.0, 470.0, 40.0, 90.0, 140.0, 110.0, 380.0, 10.0, 40.0, -30.0, 40.0, 30.0, -15.0, 130.0, 180.0, 170.0, 50.0, 20.0, 0.0, -50.0, 0.0, 110.0, 140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0, 70.0, 280.0, 60.0, 260.0, 120.0, 320.0, 90.0, 60.0, -100.0, 90.0, 90.0, 60.0, 260.0, 50.0, 40.0, 70.0, 170.0, 280.0, 20.0, 25.0, 20.0, -5.0, 70.0, 130.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 110.0, 130.0, 170.0, 10.0, 270.0, 0.0, 30.0, 0.0, 10.0, 20.0, -30.0, 100.0, 50.0, 290.0, 70.0, 390.0, 240.0, 50.0, 80.0, 20.0, 30.0, 40.0, -40.0, -540.0, 20.0, 60.0, 20.0, -30.0, 90.0, 150.0, 10.0, 100.0, 220.0, 50.0, 200.0, 40.0, -70.0, 200.0, 110.0, 20.0, 10.0, 70.0, 30.0, 40.0, 140.0, 0.0, 40.0, 180.0, 0.0, 160.0, 90.0, 40.0, 70.0, 110.0, -110.0, 280.0, 60.0, 40.0, 30.0, 0.0, 190.0, 40.0, 20.0, 90.0, -15.0, 10.0, 100.0, 60.0, 30.0, 60.0, 30.0, 10.0, 80.0, 215.0, 370.0, 20.0, 180.0, 140.0, 120.0, 10.0, 210.0, 410.0, 70.0, 120.0, 110.0, 60.0, 120.0, 70.0, 120.0, 200.0, 380.0, 10.0, 60.0, 50.0, 140.0, 50.0, 320.0, 70.0, 50.0, 60.0, 30.0, 60.0, 180.0, 110.0, 240.0, 230.0, 100.0, 130.0, 260.0, 60.0, 50.0, 140.0, 0.0, 50.0, 90.0, 0.0, -10.0, 20.0, 0.0, 100.0, 65.0, 140.0, 230.0, 110.0, 50.0, 20.0, 290.0, 20.0, 120.0, 20.0, 150.0, 160.0, 160.0, 90.0, 80.0, 130.0, 240.0, 110.0, 90.0, 50.0, 110.0, 130.0, 90.0, 80.0, 50.0, 80.0, -180.0, 90.0, 230.0, -20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 25.0, 50.0, 30.0, -10.0, 0.0, 20.0, 10.0, 140.0, 20.0, 30.0, 30.0, 20.0, 10.0, 30.0, 40.0, 290.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 40.0, 70.0, 20.0, 190.0, 25.0, 10.0, 10.0, 25.0, 10.0, 60.0, 10.0, 20.0, 50.0, 70.0, 50.0, 110.0, 270.0, 110.0, 300.0, 60.0, 300.0, 140.0, 280.0, 60.0, 20.0, 60.0, 60.0, 20.0, 110.0, 110.0, 10.0, 0.0, 50.0, 110.0, 50.0, 270.0, 80.0, 270.0, 20.0, 0.0, 80.0, 160.0, 280.0, 340.0, 50.0, 70.0, 20.0, 220.0, 230.0, 20.0, 150.0, 80.0, 250.0, 90.0, 190.0, 20.0, 60.0, 190.0, 170.0, 50.0, 190.0, 30.0, 130.0, 50.0, 180.0, 50.0, 30.0, 0.0, 110.0, 5.0, 280.0, 90.0, 30.0, 170.0, 20.0, 70.0, 80.0, 250.0, 180.0, 20.0, 80.0, 30.0, 80.0, 30.0, 40.0, 120.0, 40.0, 20.0, 70.0, 40.0, 0.0, 20.0, 40.0, 30.0, 120.0, 50.0, 70.0, 80.0, 50.0, 70.0, 150.0, 70.0, 210.0, 80.0, 80.0, 130.0, 290.0, 40.0, 70.0, 40.0, 30.0, 110.0, 20.0, 120.0, 120.0, 10.0, 20.0, 80.0, 320.0, 70.0, 280.0, 40.0, -30.0, 490.0, 40.0, 20.0, 350.0, 190.0, 60.0, 20.0, 80.0, 60.0, 70.0, 110.0, 80.0, 20.0, 10.0, 190.0, 200.0, 50.0, 90.0, 120.0, -10.0, 10.0, 70.0, -30.0, 10.0, -20.0, 10.0, 30.0, 60.0, 40.0, 20.0, 440.0, 100.0, 20.0, 320.0, 210.0, 100.0, 60.0, 90.0, 110.0, 190.0, 380.0, -100.0, 70.0, -90.0, 230.0, 230.0, -100.0, 0.0, -50.0, 70.0, 10.0, 140.0, 20.0, 70.0, 40.0, 0.0, 40.0, 160.0, 180.0, 0.0, 70.0, 70.0, 180.0, 0.0, 10.0, 370.0, 70.0, 20.0, 160.0, 60.0, 0.0, 300.0, -20.0, 20.0, 90.0, 10.0, 290.0, 130.0, 200.0, 160.0, 0.0, 210.0, 80.0, 100.0, 210.0, 80.0, 0.0, 380.0, 30.0, 10.0, -40.0, 370.0, 200.0, 340.0, 50.0, 40.0, 10.0, 60.0, 20.0, 160.0, 130.0, 300.0, 60.0, 110.0, 170.0, -30.0, 70.0, 90.0, 350.0, 330.0, 30.0, 70.0, 20.0, 20.0, 200.0, 50.0, 10.0, 10.0, 20.0, 20.0, 110.0, 570.0, 10.0, 160.0, 0.0, 30.0, 50.0, 20.0, 0.0, -20.0, 15.0, 10.0, 50.0, 20.0, -15.0, 30.0, 100.0, 20.0, 0.0, 0.0, 70.0, 30.0, 60.0, 310.0, 30.0, 80.0, 240.0, 320.0, 300.0, 80.0, -30.0, 180.0, -30.0, -10.0, 130.0, 410.0, 100.0, 70.0, 150.0, 20.0, 170.0, 70.0, 80.0, 440.0, 80.0, 120.0, 90.0, 160.0, 320.0, 220.0, 140.0, 210.0, 165.0, 350.0, 60.0, 130.0, 150.0, 250.0, 60.0, 40.0, 220.0, 80.0, 100.0, 200.0, 220.0, 200.0, 40.0, 30.0, 90.0, 5.0, 40.0, 120.0, 90.0, 390.0, 70.0, 0.0, 60.0, 10.0, 60.0, 0.0, 20.0, 30.0, 260.0, 20.0, 40.0, 180.0, 0.0, 15.0, 40.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5290414025909687, "mean_inference_ms": 1.421042010438025, "mean_action_processing_ms": 0.45832539155895374, "mean_env_wait_ms": 1.2463640659775401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01265859603881836, "StateBufferConnector_ms": 0.009558439254760742, "ViewRequirementAgentConnector_ms": 0.36807990074157715}, "num_episodes": 18, "episode_return_max": 1930.0, "episode_return_min": -200.0, "episode_return_mean": 985.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.68820393374459, "num_env_steps_trained_throughput_per_sec": 21.68820393374459, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 187673.7, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187673.65, "sample_time_ms": 2713.731, "learn_time_ms": 184940.578, "learn_throughput": 21.629, "synch_weights_time_ms": 10.836}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "33e63_00000", "date": "2024-06-19_04-49-19", "timestamp": 1718786959, "time_this_iter_s": 184.439288854599, "time_total_s": 27740.451325416565, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3279448b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27740.451325416565, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 15.862452107279696, "ram_util_percent": 78.7816091954023}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.142185195921836, "cur_kl_coeff": 33.744300295837434, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.271918309001496, "policy_loss": -0.0020710528094254046, "vf_loss": 7.271092384031659, "vf_explained_var": -0.0001078504469955818, "kl": 8.585100904330593e-05, "entropy": 0.37254674947712496, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": -200.0, "episode_reward_mean": 982.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -540.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 98.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 1060.0, 705.0, 410.0, 570.0, 1920.0, 1175.0, 1300.0, 1270.0, 1620.0, 900.0, 1485.0, 1130.0, 520.0, 1115.0, 450.0, 1930.0, 720.0, 1345.0, 1070.0, 850.0, 595.0, 1510.0, 1250.0, 1065.0, 325.0, 750.0, 1260.0, -200.0, 880.0, 670.0, 610.0, 585.0, 1175.0, 1490.0, 1190.0, 1400.0, 440.0, 1065.0, 1260.0, 660.0, 215.0, 350.0, 930.0, 410.0, 1690.0, 500.0, 1320.0, 1430.0, 1120.0, 825.0, 980.0, 420.0, 900.0, 890.0, 1030.0, 1380.0, 860.0, 200.0, 1640.0, 640.0, 660.0, 1010.0, 1180.0, 1100.0, 1210.0, 1580.0, 450.0, 930.0, 230.0, 1520.0, 990.0, 1750.0, 1555.0, 1185.0, 840.0, 605.0, 1410.0, 185.0, 930.0, 1010.0, 1045.0, 910.0, 260.0, 1440.0, 1200.0, 785.0, 295.0, 1020.0, 1320.0, 2170.0, 1060.0, 1670.0, 980.0, 610.0, 1190.0, 1230.0, 970.0, 720.0, 1215.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 300.0, 20.0, -90.0, 110.0, 60.0, 30.0, 10.0, 170.0, -10.0, 160.0, 90.0, 90.0, 70.0, 110.0, 160.0, -30.0, 260.0, 170.0, -20.0, 10.0, 80.0, 110.0, 40.0, 15.0, 200.0, 10.0, 90.0, 110.0, 40.0, 90.0, 10.0, 20.0, 20.0, 130.0, 15.0, 30.0, 10.0, 15.0, 70.0, 110.0, 160.0, 50.0, 0.0, 30.0, 110.0, 10.0, 20.0, 30.0, 50.0, 180.0, 200.0, 90.0, 50.0, 90.0, 40.0, 170.0, 310.0, 70.0, 720.0, 160.0, 320.0, 140.0, 70.0, 70.0, 150.0, 5.0, 80.0, 0.0, 180.0, 50.0, 310.0, 250.0, 160.0, 70.0, 30.0, 90.0, 180.0, 40.0, 120.0, 90.0, 190.0, 90.0, 110.0, 90.0, 170.0, 140.0, 120.0, 110.0, 160.0, 90.0, 220.0, 280.0, 60.0, 440.0, 40.0, 120.0, 110.0, 100.0, 160.0, 80.0, 70.0, 20.0, 90.0, 30.0, 50.0, 80.0, 10.0, 90.0, 380.0, 0.0, 60.0, 360.0, 5.0, 100.0, 20.0, 370.0, 480.0, 40.0, 50.0, 60.0, 230.0, 440.0, 0.0, 270.0, 50.0, 60.0, 50.0, 20.0, -50.0, 50.0, 20.0, 90.0, 20.0, 70.0, 40.0, 10.0, 80.0, 90.0, 50.0, 65.0, 60.0, 30.0, 100.0, 130.0, 270.0, 170.0, 10.0, 70.0, 210.0, 30.0, 0.0, 40.0, 50.0, 30.0, 20.0, 10.0, 20.0, 170.0, 80.0, 30.0, 200.0, 60.0, 750.0, 80.0, 160.0, 110.0, 140.0, 350.0, 50.0, 40.0, 140.0, 30.0, 30.0, 50.0, 20.0, 80.0, 10.0, 280.0, 40.0, 210.0, 130.0, 150.0, 75.0, 90.0, 130.0, 90.0, 170.0, 100.0, 200.0, 300.0, -140.0, 40.0, 80.0, 140.0, 0.0, 140.0, 20.0, 20.0, 470.0, 40.0, 90.0, 140.0, 110.0, 380.0, 10.0, 40.0, -30.0, 40.0, 30.0, -15.0, 130.0, 180.0, 170.0, 50.0, 20.0, 0.0, -50.0, 0.0, 110.0, 140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0, 70.0, 280.0, 60.0, 260.0, 120.0, 320.0, 90.0, 60.0, -100.0, 90.0, 90.0, 60.0, 260.0, 50.0, 40.0, 70.0, 170.0, 280.0, 20.0, 25.0, 20.0, -5.0, 70.0, 130.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 110.0, 130.0, 170.0, 10.0, 270.0, 0.0, 30.0, 0.0, 10.0, 20.0, -30.0, 100.0, 50.0, 290.0, 70.0, 390.0, 240.0, 50.0, 80.0, 20.0, 30.0, 40.0, -40.0, -540.0, 20.0, 60.0, 20.0, -30.0, 90.0, 150.0, 10.0, 100.0, 220.0, 50.0, 200.0, 40.0, -70.0, 200.0, 110.0, 20.0, 10.0, 70.0, 30.0, 40.0, 140.0, 0.0, 40.0, 180.0, 0.0, 160.0, 90.0, 40.0, 70.0, 110.0, -110.0, 280.0, 60.0, 40.0, 30.0, 0.0, 190.0, 40.0, 20.0, 90.0, -15.0, 10.0, 100.0, 60.0, 30.0, 60.0, 30.0, 10.0, 80.0, 215.0, 370.0, 20.0, 180.0, 140.0, 120.0, 10.0, 210.0, 410.0, 70.0, 120.0, 110.0, 60.0, 120.0, 70.0, 120.0, 200.0, 380.0, 10.0, 60.0, 50.0, 140.0, 50.0, 320.0, 70.0, 50.0, 60.0, 30.0, 60.0, 180.0, 110.0, 240.0, 230.0, 100.0, 130.0, 260.0, 60.0, 50.0, 140.0, 0.0, 50.0, 90.0, 0.0, -10.0, 20.0, 0.0, 100.0, 65.0, 140.0, 230.0, 110.0, 50.0, 20.0, 290.0, 20.0, 120.0, 20.0, 150.0, 160.0, 160.0, 90.0, 80.0, 130.0, 240.0, 110.0, 90.0, 50.0, 110.0, 130.0, 90.0, 80.0, 50.0, 80.0, -180.0, 90.0, 230.0, -20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 25.0, 50.0, 30.0, -10.0, 0.0, 20.0, 10.0, 140.0, 20.0, 30.0, 30.0, 20.0, 10.0, 30.0, 40.0, 290.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 40.0, 70.0, 20.0, 190.0, 25.0, 10.0, 10.0, 25.0, 10.0, 60.0, 10.0, 20.0, 50.0, 70.0, 50.0, 110.0, 270.0, 110.0, 300.0, 60.0, 300.0, 140.0, 280.0, 60.0, 20.0, 60.0, 60.0, 20.0, 110.0, 110.0, 10.0, 0.0, 50.0, 110.0, 50.0, 270.0, 80.0, 270.0, 20.0, 0.0, 80.0, 160.0, 280.0, 340.0, 50.0, 70.0, 20.0, 220.0, 230.0, 20.0, 150.0, 80.0, 250.0, 90.0, 190.0, 20.0, 60.0, 190.0, 170.0, 50.0, 190.0, 30.0, 130.0, 50.0, 180.0, 50.0, 30.0, 0.0, 110.0, 5.0, 280.0, 90.0, 30.0, 170.0, 20.0, 70.0, 80.0, 250.0, 180.0, 20.0, 80.0, 30.0, 80.0, 30.0, 40.0, 120.0, 40.0, 20.0, 70.0, 40.0, 0.0, 20.0, 40.0, 30.0, 120.0, 50.0, 70.0, 80.0, 50.0, 70.0, 150.0, 70.0, 210.0, 80.0, 80.0, 130.0, 290.0, 40.0, 70.0, 40.0, 30.0, 110.0, 20.0, 120.0, 120.0, 10.0, 20.0, 80.0, 320.0, 70.0, 280.0, 40.0, -30.0, 490.0, 40.0, 20.0, 350.0, 190.0, 60.0, 20.0, 80.0, 60.0, 70.0, 110.0, 80.0, 20.0, 10.0, 190.0, 200.0, 50.0, 90.0, 120.0, -10.0, 10.0, 70.0, -30.0, 10.0, -20.0, 10.0, 30.0, 60.0, 40.0, 20.0, 440.0, 100.0, 20.0, 320.0, 210.0, 100.0, 60.0, 90.0, 110.0, 190.0, 380.0, -100.0, 70.0, -90.0, 230.0, 230.0, -100.0, 0.0, -50.0, 70.0, 10.0, 140.0, 20.0, 70.0, 40.0, 0.0, 40.0, 160.0, 180.0, 0.0, 70.0, 70.0, 180.0, 0.0, 10.0, 370.0, 70.0, 20.0, 160.0, 60.0, 0.0, 300.0, -20.0, 20.0, 90.0, 10.0, 290.0, 130.0, 200.0, 160.0, 0.0, 210.0, 80.0, 100.0, 210.0, 80.0, 0.0, 380.0, 30.0, 10.0, -40.0, 370.0, 200.0, 340.0, 50.0, 40.0, 10.0, 60.0, 20.0, 160.0, 130.0, 300.0, 60.0, 110.0, 170.0, -30.0, 70.0, 90.0, 350.0, 330.0, 30.0, 70.0, 20.0, 20.0, 200.0, 50.0, 10.0, 10.0, 20.0, 20.0, 110.0, 570.0, 10.0, 160.0, 0.0, 30.0, 50.0, 20.0, 0.0, -20.0, 15.0, 10.0, 50.0, 20.0, -15.0, 30.0, 100.0, 20.0, 0.0, 0.0, 70.0, 30.0, 60.0, 310.0, 30.0, 80.0, 240.0, 320.0, 300.0, 80.0, -30.0, 180.0, -30.0, -10.0, 130.0, 410.0, 100.0, 70.0, 150.0, 20.0, 170.0, 70.0, 80.0, 440.0, 80.0, 120.0, 90.0, 160.0, 320.0, 220.0, 140.0, 210.0, 165.0, 350.0, 60.0, 130.0, 150.0, 250.0, 60.0, 40.0, 220.0, 80.0, 100.0, 200.0, 220.0, 200.0, 40.0, 30.0, 90.0, 5.0, 40.0, 120.0, 90.0, 390.0, 70.0, 0.0, 60.0, 10.0, 60.0, 0.0, 20.0, 30.0, 260.0, 20.0, 40.0, 180.0, 0.0, 15.0, 40.0, 0.0, 80.0, 70.0, 90.0, 510.0, 240.0, 70.0, 10.0, 190.0, 120.0, 30.0, 10.0, 0.0, 55.0, 50.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 60.0, 30.0, 300.0, 160.0, 40.0, 70.0, 110.0, 60.0, 40.0, 100.0, 70.0, 190.0, 140.0, 90.0, 120.0, 120.0, 60.0, 40.0, 80.0, 10.0, 170.0, 70.0, 370.0, 80.0, 70.0, 210.0, 20.0, 0.0, 45.0, 170.0, 30.0, 0.0, 70.0, 80.0, 60.0, 50.0, 150.0, 260.0, 40.0, 30.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 70.0, 270.0, 110.0, 280.0, 80.0, 100.0, 160.0, 110.0, 60.0, 200.0, 40.0, -10.0, 170.0, 40.0, 150.0, 20.0, 360.0, 50.0, 350.0, 30.0, 60.0, 110.0, 80.0, 30.0, 40.0, 10.0, 70.0, 320.0, -10.0, 75.0, 80.0, 20.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 20.0, 210.0, 180.0, 190.0, 20.0, 50.0, -130.0, 190.0, 0.0, 20.0, 290.0, 115.0, 115.0, 70.0, 290.0, 30.0, 0.0, 320.0, 240.0, 70.0, 70.0, 60.0, 780.0, 380.0, 100.0, 110.0, 80.0, 170.0, 260.0, 50.0, 180.0, 30.0, 30.0, 80.0, 100.0, 320.0, 140.0, 30.0, 100.0, 80.0, 150.0, -20.0, 120.0, 30.0, 280.0, 560.0, 60.0, 210.0, 180.0, 0.0, 250.0, 60.0, 100.0, 80.0, 80.0, 240.0, 60.0, 30.0, 130.0, 60.0, 140.0, 0.0, 30.0, 160.0, 20.0, 20.0, 120.0, 170.0, 40.0, 40.0, 10.0, 90.0, 30.0, 110.0, 280.0, 170.0, 310.0, 80.0, 20.0, 30.0, 70.0, 30.0, 30.0, 50.0, 340.0, 40.0, 70.0, 200.0, 230.0, 110.0, 130.0, 170.0, 90.0, 30.0, 170.0, 90.0, 0.0, -30.0, 320.0, 90.0, 40.0, 30.0, 40.0, 170.0, 470.0, -10.0, -50.0, 10.0, 60.0, 30.0, -30.0, 170.0, -105.0, 410.0, 10.0, 220.0, 80.0, -40.0, 400.0, -70.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5285630381309334, "mean_inference_ms": 1.4211399904218518, "mean_action_processing_ms": 0.4577803237317824, "mean_env_wait_ms": 1.2462760745387103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01244354248046875, "StateBufferConnector_ms": 0.009478330612182617, "ViewRequirementAgentConnector_ms": 0.3735971450805664}, "num_episodes": 23, "episode_return_max": 2170.0, "episode_return_min": -200.0, "episode_return_mean": 982.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.560805573035495, "num_env_steps_trained_throughput_per_sec": 21.560805573035495, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 187515.97, "restore_workers_time_ms": 0.013, "training_step_time_ms": 187515.924, "sample_time_ms": 2712.886, "learn_time_ms": 184783.611, "learn_throughput": 21.647, "synch_weights_time_ms": 10.979}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "33e63_00000", "date": "2024-06-19_04-52-25", "timestamp": 1718787145, "time_this_iter_s": 185.53055810928345, "time_total_s": 27925.98188352585, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x32794ce50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27925.98188352585, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 16.291603053435114, "ram_util_percent": 79.06030534351146}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3052056348615815, "cur_kl_coeff": 16.872150147918717, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002473846122947808, "vf_loss": 7.814888304668748, "vf_explained_var": -0.00024520313016141945, "kl": Infinity, "entropy": 0.33904351559690776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 2170.0, "episode_reward_min": -200.0, "episode_reward_mean": 1033.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -540.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 103.33}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1510.0, 1250.0, 1065.0, 325.0, 750.0, 1260.0, -200.0, 880.0, 670.0, 610.0, 585.0, 1175.0, 1490.0, 1190.0, 1400.0, 440.0, 1065.0, 1260.0, 660.0, 215.0, 350.0, 930.0, 410.0, 1690.0, 500.0, 1320.0, 1430.0, 1120.0, 825.0, 980.0, 420.0, 900.0, 890.0, 1030.0, 1380.0, 860.0, 200.0, 1640.0, 640.0, 660.0, 1010.0, 1180.0, 1100.0, 1210.0, 1580.0, 450.0, 930.0, 230.0, 1520.0, 990.0, 1750.0, 1555.0, 1185.0, 840.0, 605.0, 1410.0, 185.0, 930.0, 1010.0, 1045.0, 910.0, 260.0, 1440.0, 1200.0, 785.0, 295.0, 1020.0, 1320.0, 2170.0, 1060.0, 1670.0, 980.0, 610.0, 1190.0, 1230.0, 970.0, 720.0, 1215.0, 1920.0, 900.0, 1590.0, 1355.0, 1120.0, 1760.0, 1390.0, 910.0, 1130.0, 1775.0, 1165.0, 1430.0, 1070.0, 290.0, 1100.0, 1120.0, 1530.0, 1710.0, 1470.0, 1025.0, 850.0, 1185.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [140.0, 50.0, 80.0, 50.0, 360.0, 80.0, 400.0, 60.0, 120.0, 170.0, 70.0, 280.0, 60.0, 260.0, 120.0, 320.0, 90.0, 60.0, -100.0, 90.0, 90.0, 60.0, 260.0, 50.0, 40.0, 70.0, 170.0, 280.0, 20.0, 25.0, 20.0, -5.0, 70.0, 130.0, 10.0, 10.0, 40.0, 10.0, 40.0, 0.0, 110.0, 130.0, 170.0, 10.0, 270.0, 0.0, 30.0, 0.0, 10.0, 20.0, -30.0, 100.0, 50.0, 290.0, 70.0, 390.0, 240.0, 50.0, 80.0, 20.0, 30.0, 40.0, -40.0, -540.0, 20.0, 60.0, 20.0, -30.0, 90.0, 150.0, 10.0, 100.0, 220.0, 50.0, 200.0, 40.0, -70.0, 200.0, 110.0, 20.0, 10.0, 70.0, 30.0, 40.0, 140.0, 0.0, 40.0, 180.0, 0.0, 160.0, 90.0, 40.0, 70.0, 110.0, -110.0, 280.0, 60.0, 40.0, 30.0, 0.0, 190.0, 40.0, 20.0, 90.0, -15.0, 10.0, 100.0, 60.0, 30.0, 60.0, 30.0, 10.0, 80.0, 215.0, 370.0, 20.0, 180.0, 140.0, 120.0, 10.0, 210.0, 410.0, 70.0, 120.0, 110.0, 60.0, 120.0, 70.0, 120.0, 200.0, 380.0, 10.0, 60.0, 50.0, 140.0, 50.0, 320.0, 70.0, 50.0, 60.0, 30.0, 60.0, 180.0, 110.0, 240.0, 230.0, 100.0, 130.0, 260.0, 60.0, 50.0, 140.0, 0.0, 50.0, 90.0, 0.0, -10.0, 20.0, 0.0, 100.0, 65.0, 140.0, 230.0, 110.0, 50.0, 20.0, 290.0, 20.0, 120.0, 20.0, 150.0, 160.0, 160.0, 90.0, 80.0, 130.0, 240.0, 110.0, 90.0, 50.0, 110.0, 130.0, 90.0, 80.0, 50.0, 80.0, -180.0, 90.0, 230.0, -20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 25.0, 50.0, 30.0, -10.0, 0.0, 20.0, 10.0, 140.0, 20.0, 30.0, 30.0, 20.0, 10.0, 30.0, 40.0, 290.0, 90.0, 120.0, 60.0, 90.0, 60.0, 90.0, 40.0, 70.0, 20.0, 190.0, 25.0, 10.0, 10.0, 25.0, 10.0, 60.0, 10.0, 20.0, 50.0, 70.0, 50.0, 110.0, 270.0, 110.0, 300.0, 60.0, 300.0, 140.0, 280.0, 60.0, 20.0, 60.0, 60.0, 20.0, 110.0, 110.0, 10.0, 0.0, 50.0, 110.0, 50.0, 270.0, 80.0, 270.0, 20.0, 0.0, 80.0, 160.0, 280.0, 340.0, 50.0, 70.0, 20.0, 220.0, 230.0, 20.0, 150.0, 80.0, 250.0, 90.0, 190.0, 20.0, 60.0, 190.0, 170.0, 50.0, 190.0, 30.0, 130.0, 50.0, 180.0, 50.0, 30.0, 0.0, 110.0, 5.0, 280.0, 90.0, 30.0, 170.0, 20.0, 70.0, 80.0, 250.0, 180.0, 20.0, 80.0, 30.0, 80.0, 30.0, 40.0, 120.0, 40.0, 20.0, 70.0, 40.0, 0.0, 20.0, 40.0, 30.0, 120.0, 50.0, 70.0, 80.0, 50.0, 70.0, 150.0, 70.0, 210.0, 80.0, 80.0, 130.0, 290.0, 40.0, 70.0, 40.0, 30.0, 110.0, 20.0, 120.0, 120.0, 10.0, 20.0, 80.0, 320.0, 70.0, 280.0, 40.0, -30.0, 490.0, 40.0, 20.0, 350.0, 190.0, 60.0, 20.0, 80.0, 60.0, 70.0, 110.0, 80.0, 20.0, 10.0, 190.0, 200.0, 50.0, 90.0, 120.0, -10.0, 10.0, 70.0, -30.0, 10.0, -20.0, 10.0, 30.0, 60.0, 40.0, 20.0, 440.0, 100.0, 20.0, 320.0, 210.0, 100.0, 60.0, 90.0, 110.0, 190.0, 380.0, -100.0, 70.0, -90.0, 230.0, 230.0, -100.0, 0.0, -50.0, 70.0, 10.0, 140.0, 20.0, 70.0, 40.0, 0.0, 40.0, 160.0, 180.0, 0.0, 70.0, 70.0, 180.0, 0.0, 10.0, 370.0, 70.0, 20.0, 160.0, 60.0, 0.0, 300.0, -20.0, 20.0, 90.0, 10.0, 290.0, 130.0, 200.0, 160.0, 0.0, 210.0, 80.0, 100.0, 210.0, 80.0, 0.0, 380.0, 30.0, 10.0, -40.0, 370.0, 200.0, 340.0, 50.0, 40.0, 10.0, 60.0, 20.0, 160.0, 130.0, 300.0, 60.0, 110.0, 170.0, -30.0, 70.0, 90.0, 350.0, 330.0, 30.0, 70.0, 20.0, 20.0, 200.0, 50.0, 10.0, 10.0, 20.0, 20.0, 110.0, 570.0, 10.0, 160.0, 0.0, 30.0, 50.0, 20.0, 0.0, -20.0, 15.0, 10.0, 50.0, 20.0, -15.0, 30.0, 100.0, 20.0, 0.0, 0.0, 70.0, 30.0, 60.0, 310.0, 30.0, 80.0, 240.0, 320.0, 300.0, 80.0, -30.0, 180.0, -30.0, -10.0, 130.0, 410.0, 100.0, 70.0, 150.0, 20.0, 170.0, 70.0, 80.0, 440.0, 80.0, 120.0, 90.0, 160.0, 320.0, 220.0, 140.0, 210.0, 165.0, 350.0, 60.0, 130.0, 150.0, 250.0, 60.0, 40.0, 220.0, 80.0, 100.0, 200.0, 220.0, 200.0, 40.0, 30.0, 90.0, 5.0, 40.0, 120.0, 90.0, 390.0, 70.0, 0.0, 60.0, 10.0, 60.0, 0.0, 20.0, 30.0, 260.0, 20.0, 40.0, 180.0, 0.0, 15.0, 40.0, 0.0, 80.0, 70.0, 90.0, 510.0, 240.0, 70.0, 10.0, 190.0, 120.0, 30.0, 10.0, 0.0, 55.0, 50.0, 10.0, 0.0, 40.0, 0.0, 20.0, 0.0, 60.0, 60.0, 30.0, 300.0, 160.0, 40.0, 70.0, 110.0, 60.0, 40.0, 100.0, 70.0, 190.0, 140.0, 90.0, 120.0, 120.0, 60.0, 40.0, 80.0, 10.0, 170.0, 70.0, 370.0, 80.0, 70.0, 210.0, 20.0, 0.0, 45.0, 170.0, 30.0, 0.0, 70.0, 80.0, 60.0, 50.0, 150.0, 260.0, 40.0, 30.0, 20.0, 40.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 70.0, 270.0, 110.0, 280.0, 80.0, 100.0, 160.0, 110.0, 60.0, 200.0, 40.0, -10.0, 170.0, 40.0, 150.0, 20.0, 360.0, 50.0, 350.0, 30.0, 60.0, 110.0, 80.0, 30.0, 40.0, 10.0, 70.0, 320.0, -10.0, 75.0, 80.0, 20.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 30.0, 20.0, 210.0, 180.0, 190.0, 20.0, 50.0, -130.0, 190.0, 0.0, 20.0, 290.0, 115.0, 115.0, 70.0, 290.0, 30.0, 0.0, 320.0, 240.0, 70.0, 70.0, 60.0, 780.0, 380.0, 100.0, 110.0, 80.0, 170.0, 260.0, 50.0, 180.0, 30.0, 30.0, 80.0, 100.0, 320.0, 140.0, 30.0, 100.0, 80.0, 150.0, -20.0, 120.0, 30.0, 280.0, 560.0, 60.0, 210.0, 180.0, 0.0, 250.0, 60.0, 100.0, 80.0, 80.0, 240.0, 60.0, 30.0, 130.0, 60.0, 140.0, 0.0, 30.0, 160.0, 20.0, 20.0, 120.0, 170.0, 40.0, 40.0, 10.0, 90.0, 30.0, 110.0, 280.0, 170.0, 310.0, 80.0, 20.0, 30.0, 70.0, 30.0, 30.0, 50.0, 340.0, 40.0, 70.0, 200.0, 230.0, 110.0, 130.0, 170.0, 90.0, 30.0, 170.0, 90.0, 0.0, -30.0, 320.0, 90.0, 40.0, 30.0, 40.0, 170.0, 470.0, -10.0, -50.0, 10.0, 60.0, 30.0, -30.0, 170.0, -105.0, 410.0, 10.0, 220.0, 80.0, -40.0, 400.0, -70.0, 140.0, 360.0, 280.0, 130.0, 170.0, 90.0, 40.0, 370.0, 90.0, 340.0, 50.0, 60.0, 70.0, 20.0, 70.0, 30.0, 20.0, 370.0, 180.0, 80.0, 0.0, 20.0, 190.0, -40.0, 0.0, 310.0, 190.0, 140.0, 220.0, 100.0, 460.0, 65.0, 230.0, 300.0, 50.0, 100.0, 60.0, 100.0, 90.0, 270.0, 90.0, 80.0, 70.0, 100.0, 100.0, 90.0, 200.0, 180.0, 90.0, 150.0, 60.0, 420.0, 70.0, 380.0, 230.0, 140.0, 160.0, 80.0, 120.0, 60.0, 100.0, 40.0, 60.0, 10.0, 440.0, 40.0, 150.0, 130.0, 110.0, 0.0, 410.0, 70.0, 10.0, 80.0, 70.0, 20.0, -60.0, -20.0, 70.0, 600.0, 70.0, 10.0, 10.0, 100.0, -40.0, 400.0, 120.0, 260.0, 120.0, 140.0, 10.0, 240.0, 20.0, 90.0, 200.0, 45.0, 230.0, 500.0, 110.0, 40.0, 300.0, 160.0, 80.0, 40.0, 240.0, 15.0, 40.0, 400.0, 40.0, 80.0, 70.0, 90.0, 30.0, 370.0, 70.0, 10.0, 50.0, 330.0, 70.0, 130.0, 280.0, 190.0, 150.0, 30.0, 30.0, 60.0, 270.0, -50.0, 200.0, 100.0, 90.0, -40.0, -10.0, 20.0, 60.0, 90.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 130.0, 80.0, 40.0, 50.0, 330.0, 170.0, 190.0, 40.0, 20.0, 260.0, -20.0, 10.0, 120.0, 90.0, 270.0, 100.0, 30.0, 170.0, 90.0, 120.0, 40.0, 210.0, 260.0, 0.0, 30.0, 10.0, 70.0, 310.0, 480.0, 80.0, 320.0, 140.0, 20.0, 340.0, 380.0, 230.0, 0.0, 40.0, 160.0, 150.0, 40.0, 300.0, 220.0, 80.0, 40.0, 70.0, 220.0, 180.0, 170.0, 250.0, 360.0, 90.0, 45.0, 50.0, 50.0, 20.0, 20.0, 60.0, 80.0, 30.0, 260.0, 20.0, 90.0, 0.0, 230.0, 40.0, 20.0, 130.0, 30.0, 270.0, 30.0, 170.0, 50.0, 150.0, 15.0, 110.0, 80.0, 210.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5279622657052354, "mean_inference_ms": 1.4212046446820932, "mean_action_processing_ms": 0.457194742031398, "mean_env_wait_ms": 1.2461978078851559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012592315673828125, "StateBufferConnector_ms": 0.00927114486694336, "ViewRequirementAgentConnector_ms": 0.37385129928588867}, "num_episodes": 22, "episode_return_max": 2170.0, "episode_return_min": -200.0, "episode_return_mean": 1033.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 21.61510179340537, "num_env_steps_trained_throughput_per_sec": 21.61510179340537, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 187364.539, "restore_workers_time_ms": 0.012, "training_step_time_ms": 187364.493, "sample_time_ms": 2690.206, "learn_time_ms": 184654.863, "learn_throughput": 21.662, "synch_weights_time_ms": 11.056}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "33e63_00000", "date": "2024-06-19_04-55-30", "timestamp": 1718787330, "time_this_iter_s": 185.06538772583008, "time_total_s": 28111.04727125168, "pid": 23945, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "boost_duration": 10, "cooldown": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x327944430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Box(0.0, 1.0, (24, 24, 3), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28111.04727125168, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 16.56450381679389, "ram_util_percent": 79.56145038167938}}
