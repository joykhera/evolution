{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5903641891857935, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.880098236931694, "policy_loss": -0.006518335530790623, "vf_loss": 9.884675542135087, "vf_explained_var": -0.0002807223292254897, "kl": 0.009705194624148039, "entropy": 1.5998755234889883, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4883046968036858, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.8800874177741, "policy_loss": -0.00638859434023736, "vf_loss": 8.884485744799255, "vf_explained_var": 1.39285647679889e-05, "kl": 0.009951222200304973, "entropy": 1.5994946293099217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 315.8585365676693, "episode_reward_min": -7.105427357601002e-15, "episode_reward_mean": 70.80627549885304, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -2914.20652487586, "predator_policy": -2132.0901508851357}, "policy_reward_max": {"prey_policy": 1543.6105959051552, "predator_policy": 2771.0977508197957}, "policy_reward_mean": {"prey_policy": -557.4795494554996, "predator_policy": 592.8826872049262}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5987211554602254e-14, 2.1316282072803006e-14, 0.0, 0.0, 307.39586347187526, 0.0, 303.961511234275, 315.8585365676693, 0.0, 7.105427357601002e-15, 235.91567928227286, 0.0, 0.0, 111.38136842326232, 0.0, -7.105427357601002e-15, 0.0, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2006.3520335526891, -538.8856640824133, 560.3432712758741, -2769.3966095899987, -2218.1435197090577, -560.0155173212951, -2851.282153266751, 229.69126699115066, -1770.4043149603185, 1186.2999520609997, 535.8018155585337, 768.2201023831525, -1593.6238669468967, 1410.2059238749423, 656.7055943201293, 1396.66586422908, 1338.2897440763386, -932.3391692947438, -2498.141012322584, -1076.9880254887473, -1707.653613534008, -404.9534033649227, 548.9124709663049, -538.2057487594277, -1159.1618906405836, 1543.6105959051552, -168.30744130079378, -1635.3844953726525, 643.1629160191266, -851.9411866649616, 1.1164070659329965, -2914.20652487586, -627.3845731858718, -1381.2360477686755, 115.35030327985461, -799.6331964013068], "policy_predator_policy_reward": [2022.797570579704, 522.4401270553988, 929.5513318290601, 1279.502006485065, 180.63847331612894, 2597.520563714223, 634.5852569626031, 1987.0056293129965, 0.0, 891.5002263711942, -2132.0901508851357, 828.0682329434504, 1097.7444217684172, -610.3649674621886, -1396.66586422908, -340.8470577524605, 0.0, -405.9505747815943, 1759.7480280361187, 1815.381009775212, 518.8880365401105, 1829.6346596410935, 70.75483025926154, -81.46155246613861, 89.58443090835495, -474.033136172926, 1655.822571812991, 259.25073328371775, 265.02375559971813, -56.245484953882844, 141.99236699013133, 2771.0977508197957, 1667.8035061017026, 340.81711485284416, 1251.3309932843658, -567.0481001629136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7597007809286586, "mean_inference_ms": 1.616706391149894, "mean_action_processing_ms": 0.31581469689415637, "mean_env_wait_ms": 0.14088692400844594, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008485714594523111, "StateBufferConnector_ms": 0.004017353057861328, "ViewRequirementAgentConnector_ms": 0.15582508511013454}, "num_episodes": 18, "episode_return_max": 315.8585365676693, "episode_return_min": -7.105427357601002e-15, "episode_return_mean": 70.80627549885304, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.2534736497201, "num_env_steps_trained_throughput_per_sec": 259.2534736497201, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15428.924, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15428.837, "sample_time_ms": 1323.824, "learn_time_ms": 14087.879, "learn_throughput": 283.932, "synch_weights_time_ms": 15.803}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "6751e_00000", "date": "2024-08-11_19-07-23", "timestamp": 1723417643, "time_this_iter_s": 15.48337721824646, "time_total_s": 15.48337721824646, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea2f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 15.48337721824646, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 51.93478260869566, "ram_util_percent": 83.35652173913044}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7696140148021556, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.868548008752247, "policy_loss": -0.009575745391551031, "vf_loss": 9.875506022115234, "vf_explained_var": -0.0004076361025451983, "kl": 0.013088548872964935, "entropy": 1.5661957005344371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5815431135356741, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.275723181325922, "policy_loss": -0.007311540765739564, "vf_loss": 8.280585499163028, "vf_explained_var": -0.00013183796847308124, "kl": 0.012246107221170975, "entropy": 1.5675397691272555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 448.976086069936, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 73.8816162239237, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -4495.026582948653, "predator_policy": -5411.447374389358}, "policy_reward_max": {"prey_policy": 2816.620579727158, "predator_policy": 7871.732645628149}, "policy_reward_mean": {"prey_policy": -538.039941829361, "predator_policy": 574.9807499413229}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5987211554602254e-14, 2.1316282072803006e-14, 0.0, 0.0, 307.39586347187526, 0.0, 303.961511234275, 315.8585365676693, 0.0, 7.105427357601002e-15, 235.91567928227286, 0.0, 0.0, 111.38136842326232, 0.0, -7.105427357601002e-15, 0.0, 0.0, 0.0, 0.0, 448.976086069936, 0.0, 0.0, 7.105427357601002e-15, 0.0, -3.552713678800501e-15, 103.63302587492778, 412.6642571642152, -1.4210854715202004e-14, 0.0, 0.0, 310.83233029326766, 0.0, 0.0, 109.11952567955177, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2006.3520335526891, -538.8856640824133, 560.3432712758741, -2769.3966095899987, -2218.1435197090577, -560.0155173212951, -2851.282153266751, 229.69126699115066, -1770.4043149603185, 1186.2999520609997, 535.8018155585337, 768.2201023831525, -1593.6238669468967, 1410.2059238749423, 656.7055943201293, 1396.66586422908, 1338.2897440763386, -932.3391692947438, -2498.141012322584, -1076.9880254887473, -1707.653613534008, -404.9534033649227, 548.9124709663049, -538.2057487594277, -1159.1618906405836, 1543.6105959051552, -168.30744130079378, -1635.3844953726525, 643.1629160191266, -851.9411866649616, 1.1164070659329965, -2914.20652487586, -627.3845731858718, -1381.2360477686755, 115.35030327985461, -799.6331964013068, 27.70197937264814, 21.573272368420838, -1701.5176473392694, 27.318602126055602, 663.0006145108455, 70.61557993533323, -2282.519921982865, 1294.0580902114584, -2355.5739725257226, 994.5486082358564, -1669.5166281132754, -1293.6938666611668, -649.2578954367098, 703.8724262205981, -800.9522447209599, -2179.025112152869, 2698.459820537125, 2816.620579727158, -4495.026582948653, -3164.949704274842, -2062.0317847724577, -2074.9707629046325, 1886.7419794269479, -520.5059728226668, -1390.7381577446035, -2430.56066432549, -1023.9618216606133, 33.415831670294764, 577.1250834714201, -260.2101707821843, 1442.7734066501912, 287.90711129309904, -1128.9064308220377, -47.25943148375528, 535.4338319573914, -1219.6000755560785], "policy_predator_policy_reward": [2022.797570579704, 522.4401270553988, 929.5513318290601, 1279.502006485065, 180.63847331612894, 2597.520563714223, 634.5852569626031, 1987.0056293129965, 0.0, 891.5002263711942, -2132.0901508851357, 828.0682329434504, 1097.7444217684172, -610.3649674621886, -1396.66586422908, -340.8470577524605, 0.0, -405.9505747815943, 1759.7480280361187, 1815.381009775212, 518.8880365401105, 1829.6346596410935, 70.75483025926154, -81.46155246613861, 89.58443090835495, -474.033136172926, 1655.822571812991, 259.25073328371775, 265.02375559971813, -56.245484953882844, 141.99236699013133, 2771.0977508197957, 1667.8035061017026, 340.81711485284416, 1251.3309932843658, -567.0481001629136, -18.08157670389724, -31.193675037171765, -23.4763789861998, 1697.6754241994133, 466.11544426059004, -750.7555526368327, -1084.0934924983503, 2072.555324269758, 112.66569734730744, 1248.359666942557, 2056.6766119220893, 906.5338828523546, -119.42758023877619, 64.81304945488718, 2501.1706055418144, 478.80675133201703, -5411.447374389358, 0.0, 7871.732645628149, 200.9078987595607, 2047.5663401720808, 2089.4362075050103, -1076.667209853286, -289.56879675099646, 2428.9780315332246, 1392.3207905368686, 571.6441837955473, 729.7341364880385, 280.8127783707954, -597.7276910600312, -1730.6805179432902, 0.0, 377.27988439459546, 908.0055035907494, 1243.3327053525434, -559.1664617538559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7606410425894988, "mean_inference_ms": 1.6182797275553928, "mean_action_processing_ms": 0.3114344963186348, "mean_env_wait_ms": 0.13752446084743294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009362896283467611, "StateBufferConnector_ms": 0.0034746196534898546, "ViewRequirementAgentConnector_ms": 0.13567606608072916}, "num_episodes": 18, "episode_return_max": 448.976086069936, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 73.8816162239237, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 240.83374688344517, "num_env_steps_trained_throughput_per_sec": 240.83374688344517, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 16018.988, "restore_workers_time_ms": 0.143, "training_step_time_ms": 16018.613, "sample_time_ms": 1333.555, "learn_time_ms": 14661.294, "learn_throughput": 272.827, "synch_weights_time_ms": 20.072}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "6751e_00000", "date": "2024-08-11_19-07-43", "timestamp": 1723417663, "time_this_iter_s": 16.64058017730713, "time_total_s": 32.12395739555359, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16e9cbb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.12395739555359, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 63.48518518518518, "ram_util_percent": 83.45555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7418945118154168, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.95184155671054, "policy_loss": -0.00403529838474083, "vf_loss": 9.954569485073998, "vf_explained_var": -0.009302402804137537, "kl": 0.006536817992090854, "entropy": 1.5373035738077114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.710978497651519, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.776531807329288, "policy_loss": -0.004639103880309791, "vf_loss": 8.779787454907856, "vf_explained_var": -0.0003482232333491088, "kl": 0.00691727755069377, "entropy": 1.558106614546801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 459.86957539750483, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 71.66991322579157, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -4495.026582948653, "predator_policy": -5411.447374389358}, "policy_reward_max": {"prey_policy": 3115.029529080091, "predator_policy": 7871.732645628149}, "policy_reward_mean": {"prey_policy": -562.9257576627219, "predator_policy": 598.7607142756177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5987211554602254e-14, 2.1316282072803006e-14, 0.0, 0.0, 307.39586347187526, 0.0, 303.961511234275, 315.8585365676693, 0.0, 7.105427357601002e-15, 235.91567928227286, 0.0, 0.0, 111.38136842326232, 0.0, -7.105427357601002e-15, 0.0, 0.0, 0.0, 0.0, 448.976086069936, 0.0, 0.0, 7.105427357601002e-15, 0.0, -3.552713678800501e-15, 103.63302587492778, 412.6642571642152, -1.4210854715202004e-14, 0.0, 0.0, 310.83233029326766, 0.0, 0.0, 109.11952567955177, 0.0, -1.7763568394002505e-15, -3.552713678800501e-15, 0.0, 0.0, 0.0, 1.4210854715202004e-14, 459.86957539750483, 0.0, 0.0, -7.105427357601002e-15, 0.0, 115.72962972589632, 0.0, -7.105427357601002e-15, 0.0, 205.9715289939385, 0.0, 428.86639601415175], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2006.3520335526891, -538.8856640824133, 560.3432712758741, -2769.3966095899987, -2218.1435197090577, -560.0155173212951, -2851.282153266751, 229.69126699115066, -1770.4043149603185, 1186.2999520609997, 535.8018155585337, 768.2201023831525, -1593.6238669468967, 1410.2059238749423, 656.7055943201293, 1396.66586422908, 1338.2897440763386, -932.3391692947438, -2498.141012322584, -1076.9880254887473, -1707.653613534008, -404.9534033649227, 548.9124709663049, -538.2057487594277, -1159.1618906405836, 1543.6105959051552, -168.30744130079378, -1635.3844953726525, 643.1629160191266, -851.9411866649616, 1.1164070659329965, -2914.20652487586, -627.3845731858718, -1381.2360477686755, 115.35030327985461, -799.6331964013068, 27.70197937264814, 21.573272368420838, -1701.5176473392694, 27.318602126055602, 663.0006145108455, 70.61557993533323, -2282.519921982865, 1294.0580902114584, -2355.5739725257226, 994.5486082358564, -1669.5166281132754, -1293.6938666611668, -649.2578954367098, 703.8724262205981, -800.9522447209599, -2179.025112152869, 2698.459820537125, 2816.620579727158, -4495.026582948653, -3164.949704274842, -2062.0317847724577, -2074.9707629046325, 1886.7419794269479, -520.5059728226668, -1390.7381577446035, -2430.56066432549, -1023.9618216606133, 33.415831670294764, 577.1250834714201, -260.2101707821843, 1442.7734066501912, 287.90711129309904, -1128.9064308220377, -47.25943148375528, 535.4338319573914, -1219.6000755560785, -986.0134361267166, -622.6430771355284, -1034.0148101042528, -1349.9126529306639, 947.3255147869069, -373.6581939678174, -1176.449874633333, -1927.4129981701155, -1497.0923323581262, -696.3938194861324, -534.7263964168467, -3302.701043297869, 2456.424991077804, -1788.0770361960035, 717.4068435658784, -672.835912697631, -1257.1516158710947, 397.1701342435901, 3115.029529080091, 871.2798294324655, -2013.5709748939164, -2814.5487096513484, -1530.2577738602788, -821.86356048581, 543.4718937632607, -404.61625581244164, -2271.3374512940245, -1241.5032647185658, 2080.6322054119105, -1007.9784148596805, -955.709459243355, 1228.243781679369, -1634.086252696138, -886.5707250234835, -725.9028277891823, -887.061869180897], "policy_predator_policy_reward": [2022.797570579704, 522.4401270553988, 929.5513318290601, 1279.502006485065, 180.63847331612894, 2597.520563714223, 634.5852569626031, 1987.0056293129965, 0.0, 891.5002263711942, -2132.0901508851357, 828.0682329434504, 1097.7444217684172, -610.3649674621886, -1396.66586422908, -340.8470577524605, 0.0, -405.9505747815943, 1759.7480280361187, 1815.381009775212, 518.8880365401105, 1829.6346596410935, 70.75483025926154, -81.46155246613861, 89.58443090835495, -474.033136172926, 1655.822571812991, 259.25073328371775, 265.02375559971813, -56.245484953882844, 141.99236699013133, 2771.0977508197957, 1667.8035061017026, 340.81711485284416, 1251.3309932843658, -567.0481001629136, -18.08157670389724, -31.193675037171765, -23.4763789861998, 1697.6754241994133, 466.11544426059004, -750.7555526368327, -1084.0934924983503, 2072.555324269758, 112.66569734730744, 1248.359666942557, 2056.6766119220893, 906.5338828523546, -119.42758023877619, 64.81304945488718, 2501.1706055418144, 478.80675133201703, -5411.447374389358, 0.0, 7871.732645628149, 200.9078987595607, 2047.5663401720808, 2089.4362075050103, -1076.667209853286, -289.56879675099646, 2428.9780315332246, 1392.3207905368686, 571.6441837955473, 729.7341364880385, 280.8127783707954, -597.7276910600312, -1730.6805179432902, 0.0, 377.27988439459546, 908.0055035907494, 1243.3327053525434, -559.1664617538559, 792.6326384954322, 816.0238747668127, 1439.529668921705, 944.3977941132118, 244.2579002262153, -817.9252210453046, 1046.854300825407, 2057.0085719780423, 899.3810286026318, 1294.1051232416262, 3302.701043297869, 534.7263964168467, -2456.424991077804, 2247.946611593509, -44.57093086824781, 0.0, 564.9423973428652, 295.0390842846392, -1449.0903215671844, -2537.219036945373, 1113.9346391877052, 3714.1850453575566, 2467.850964071986, 0.0, -212.1096234209588, 73.25398547013975, 2352.191507381868, 1160.649208630724, -1117.8788244998748, 45.22503394764699, 962.0313778638251, -1028.5941713059003, 2520.6569777196223, 0.0, 987.8108027376704, 1054.0202902465608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.763390867464665, "mean_inference_ms": 1.6280194411487174, "mean_action_processing_ms": 0.3095218658813775, "mean_env_wait_ms": 0.13712199437082684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00830513459664804, "StateBufferConnector_ms": 0.004388005645186813, "ViewRequirementAgentConnector_ms": 0.14958977699279785}, "num_episodes": 18, "episode_return_max": 459.86957539750483, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 71.66991322579157, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.2971091322702, "num_env_steps_trained_throughput_per_sec": 268.2971091322702, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 15648.946, "restore_workers_time_ms": 0.135, "training_step_time_ms": 15648.636, "sample_time_ms": 1339.558, "learn_time_ms": 14287.067, "learn_throughput": 279.973, "synch_weights_time_ms": 18.54}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "6751e_00000", "date": "2024-08-11_19-07-58", "timestamp": 1723417678, "time_this_iter_s": 14.964195728302002, "time_total_s": 47.08815312385559, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea2fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 47.08815312385559, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 49.90909090909091, "ram_util_percent": 83.27727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7442076805880461, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.962009247270212, "policy_loss": -0.008085790921431331, "vf_loss": 9.967609849556414, "vf_explained_var": 0.00037615939422889995, "kl": 0.01242590005475203, "entropy": 1.497494809968131, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6307574956505387, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.59057500324552, "policy_loss": -0.006764404545414936, "vf_loss": 9.59525622362813, "vf_explained_var": -0.0003650188761413413, "kl": 0.010416004861688049, "entropy": 1.5319313641578431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 459.86957539750483, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 66.4432079482925, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -4495.026582948653, "predator_policy": -5411.447374389358}, "policy_reward_max": {"prey_policy": 4974.695733312715, "predator_policy": 7871.732645628149}, "policy_reward_mean": {"prey_policy": -363.5232004409974, "predator_policy": 396.7448044151436}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5987211554602254e-14, 2.1316282072803006e-14, 0.0, 0.0, 307.39586347187526, 0.0, 303.961511234275, 315.8585365676693, 0.0, 7.105427357601002e-15, 235.91567928227286, 0.0, 0.0, 111.38136842326232, 0.0, -7.105427357601002e-15, 0.0, 0.0, 0.0, 0.0, 448.976086069936, 0.0, 0.0, 7.105427357601002e-15, 0.0, -3.552713678800501e-15, 103.63302587492778, 412.6642571642152, -1.4210854715202004e-14, 0.0, 0.0, 310.83233029326766, 0.0, 0.0, 109.11952567955177, 0.0, -1.7763568394002505e-15, -3.552713678800501e-15, 0.0, 0.0, 0.0, 1.4210854715202004e-14, 459.86957539750483, 0.0, 0.0, -7.105427357601002e-15, 0.0, 115.72962972589632, 0.0, -7.105427357601002e-15, 0.0, 205.9715289939385, 0.0, 428.86639601415175, 1.7763568394002505e-15, 400.050073866923, 0.0, 0.0, 0.0, 0.0, 3.552713678800501e-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.552713678800501e-15, 203.91760997084953, 110.92077555962737, 7.105427357601002e-15, 198.8471986869155], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2006.3520335526891, -538.8856640824133, 560.3432712758741, -2769.3966095899987, -2218.1435197090577, -560.0155173212951, -2851.282153266751, 229.69126699115066, -1770.4043149603185, 1186.2999520609997, 535.8018155585337, 768.2201023831525, -1593.6238669468967, 1410.2059238749423, 656.7055943201293, 1396.66586422908, 1338.2897440763386, -932.3391692947438, -2498.141012322584, -1076.9880254887473, -1707.653613534008, -404.9534033649227, 548.9124709663049, -538.2057487594277, -1159.1618906405836, 1543.6105959051552, -168.30744130079378, -1635.3844953726525, 643.1629160191266, -851.9411866649616, 1.1164070659329965, -2914.20652487586, -627.3845731858718, -1381.2360477686755, 115.35030327985461, -799.6331964013068, 27.70197937264814, 21.573272368420838, -1701.5176473392694, 27.318602126055602, 663.0006145108455, 70.61557993533323, -2282.519921982865, 1294.0580902114584, -2355.5739725257226, 994.5486082358564, -1669.5166281132754, -1293.6938666611668, -649.2578954367098, 703.8724262205981, -800.9522447209599, -2179.025112152869, 2698.459820537125, 2816.620579727158, -4495.026582948653, -3164.949704274842, -2062.0317847724577, -2074.9707629046325, 1886.7419794269479, -520.5059728226668, -1390.7381577446035, -2430.56066432549, -1023.9618216606133, 33.415831670294764, 577.1250834714201, -260.2101707821843, 1442.7734066501912, 287.90711129309904, -1128.9064308220377, -47.25943148375528, 535.4338319573914, -1219.6000755560785, -986.0134361267166, -622.6430771355284, -1034.0148101042528, -1349.9126529306639, 947.3255147869069, -373.6581939678174, -1176.449874633333, -1927.4129981701155, -1497.0923323581262, -696.3938194861324, -534.7263964168467, -3302.701043297869, 2456.424991077804, -1788.0770361960035, 717.4068435658784, -672.835912697631, -1257.1516158710947, 397.1701342435901, 3115.029529080091, 871.2798294324655, -2013.5709748939164, -2814.5487096513484, -1530.2577738602788, -821.86356048581, 543.4718937632607, -404.61625581244164, -2271.3374512940245, -1241.5032647185658, 2080.6322054119105, -1007.9784148596805, -955.709459243355, 1228.243781679369, -1634.086252696138, -886.5707250234835, -725.9028277891823, -887.061869180897, 2418.338060594708, 2418.180897123422, 2568.3935148693167, -3955.504637269808, -273.3471706578862, 1817.901912868638, -374.28162353966474, -1928.361568200895, 2237.134117914651, -1362.3275225003902, 3302.289583270296, -694.0975617061241, -26.868970098778153, -805.3575828763156, -436.18258553374335, -2346.926614056676, 1501.247709775581, -366.1589911900378, 1674.3606606596059, -660.446020621016, 2658.8031606832747, -2756.841036605241, -678.3708270500415, -403.0543272941874, -231.4462468459918, -1223.358500394635, 234.0299597278421, -1152.7340638627586, 2620.371278081767, 2506.641205588752, -733.8286728115479, -3104.1997037896763, -1063.088136961172, -53.32300356563048, 4974.695733312715, 2146.358537031997], "policy_predator_policy_reward": [2022.797570579704, 522.4401270553988, 929.5513318290601, 1279.502006485065, 180.63847331612894, 2597.520563714223, 634.5852569626031, 1987.0056293129965, 0.0, 891.5002263711942, -2132.0901508851357, 828.0682329434504, 1097.7444217684172, -610.3649674621886, -1396.66586422908, -340.8470577524605, 0.0, -405.9505747815943, 1759.7480280361187, 1815.381009775212, 518.8880365401105, 1829.6346596410935, 70.75483025926154, -81.46155246613861, 89.58443090835495, -474.033136172926, 1655.822571812991, 259.25073328371775, 265.02375559971813, -56.245484953882844, 141.99236699013133, 2771.0977508197957, 1667.8035061017026, 340.81711485284416, 1251.3309932843658, -567.0481001629136, -18.08157670389724, -31.193675037171765, -23.4763789861998, 1697.6754241994133, 466.11544426059004, -750.7555526368327, -1084.0934924983503, 2072.555324269758, 112.66569734730744, 1248.359666942557, 2056.6766119220893, 906.5338828523546, -119.42758023877619, 64.81304945488718, 2501.1706055418144, 478.80675133201703, -5411.447374389358, 0.0, 7871.732645628149, 200.9078987595607, 2047.5663401720808, 2089.4362075050103, -1076.667209853286, -289.56879675099646, 2428.9780315332246, 1392.3207905368686, 571.6441837955473, 729.7341364880385, 280.8127783707954, -597.7276910600312, -1730.6805179432902, 0.0, 377.27988439459546, 908.0055035907494, 1243.3327053525434, -559.1664617538559, 792.6326384954322, 816.0238747668127, 1439.529668921705, 944.3977941132118, 244.2579002262153, -817.9252210453046, 1046.854300825407, 2057.0085719780423, 899.3810286026318, 1294.1051232416262, 3302.701043297869, 534.7263964168467, -2456.424991077804, 2247.946611593509, -44.57093086824781, 0.0, 564.9423973428652, 295.0390842846392, -1449.0903215671844, -2537.219036945373, 1113.9346391877052, 3714.1850453575566, 2467.850964071986, 0.0, -212.1096234209588, 73.25398547013975, 2352.191507381868, 1160.649208630724, -1117.8788244998748, 45.22503394764699, 962.0313778638251, -1028.5941713059003, 2520.6569777196223, 0.0, 987.8108027376704, 1054.0202902465608, -3192.240318773496, -1644.278638944633, 3519.9222952569867, -1732.761098989574, -1817.901912868638, 273.3471706578862, 2088.232137279495, 214.41105446106607, -1155.4907027318716, 280.6841073176099, -2534.2624068173504, -73.92961474682312, 80.19453875441691, 752.0320142206766, 2418.6185513843334, 364.4906482060861, -529.4400572058345, -605.6486613797078, -622.2135875208687, -391.7010525177207, 2763.908641686524, -2665.8707657645577, 388.8356255540184, 692.5895287902105, 162.98967855938074, 1291.8150686812464, -133.46298285984537, 1052.1670869947611, -4923.094873699669, 0.0, 2368.5694165686573, 1580.379735592195, -251.36421314516897, 1367.7753536719713, -1947.5113383450825, -4974.695733312715]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7530789852918438, "mean_inference_ms": 1.6111078232083436, "mean_action_processing_ms": 0.3048312485782778, "mean_env_wait_ms": 0.13536576478869217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007557372252146403, "StateBufferConnector_ms": 0.004758271906110976, "ViewRequirementAgentConnector_ms": 0.13670888211992052}, "num_episodes": 18, "episode_return_max": 459.86957539750483, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 66.4432079482925, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1307779718757, "num_env_steps_trained_throughput_per_sec": 269.1307779718757, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 15452.377, "restore_workers_time_ms": 0.104, "training_step_time_ms": 15452.131, "sample_time_ms": 1264.582, "learn_time_ms": 14166.745, "learn_throughput": 282.351, "synch_weights_time_ms": 17.67}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "6751e_00000", "date": "2024-08-11_19-08-13", "timestamp": 1723417693, "time_this_iter_s": 14.904990196228027, "time_total_s": 61.99314332008362, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.99314332008362, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.02380952380952, "ram_util_percent": 83.21904761904761}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8555126713539557, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.877603873500117, "policy_loss": -0.007216092049779873, "vf_loss": 9.882520888595984, "vf_explained_var": -0.001459141730000733, "kl": 0.011495384220460465, "entropy": 1.451910771327044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7929868810706668, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.477273839617533, "policy_loss": -0.005608376386949901, "vf_loss": 9.481388364014801, "vf_explained_var": -0.0001947689624059768, "kl": 0.00746922103880086, "entropy": 1.5191524734572759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 1411.6931618768854, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 95.91535725550176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -4495.026582948653, "predator_policy": -5556.103321006501}, "policy_reward_max": {"prey_policy": 5686.482140100691, "predator_policy": 7871.732645628149}, "policy_reward_mean": {"prey_policy": -65.55205956370021, "predator_policy": 113.50973819145109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.5987211554602254e-14, 2.1316282072803006e-14, 0.0, 0.0, 307.39586347187526, 0.0, 303.961511234275, 315.8585365676693, 0.0, 7.105427357601002e-15, 235.91567928227286, 0.0, 0.0, 111.38136842326232, 0.0, -7.105427357601002e-15, 0.0, 0.0, 0.0, 0.0, 448.976086069936, 0.0, 0.0, 7.105427357601002e-15, 0.0, -3.552713678800501e-15, 103.63302587492778, 412.6642571642152, -1.4210854715202004e-14, 0.0, 0.0, 310.83233029326766, 0.0, 0.0, 109.11952567955177, 0.0, -1.7763568394002505e-15, -3.552713678800501e-15, 0.0, 0.0, 0.0, 1.4210854715202004e-14, 459.86957539750483, 0.0, 0.0, -7.105427357601002e-15, 0.0, 115.72962972589632, 0.0, -7.105427357601002e-15, 0.0, 205.9715289939385, 0.0, 428.86639601415175, 1.7763568394002505e-15, 400.050073866923, 0.0, 0.0, 0.0, 0.0, 3.552713678800501e-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.552713678800501e-15, 203.91760997084953, 110.92077555962737, 7.105427357601002e-15, 198.8471986869155, 8.881784197001252e-15, 0.0, 105.25071973639905, 568.1246113164705, 0.0, 348.1340661956843, 1146.8314119539136, 0.0, 107.88362560983404, 0.0, 0.0, 0.0, 1411.6931618768854, -8.881784197001252e-15, 0.0, 0.0, 0.0, 213.65369600902602, 0.0, 440.37763609771594, 3.552713678800501e-15, 369.76046722168593, 0.0, 0.0, 0.0, 1.4210854715202004e-14, -3.552713678800501e-15], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2006.3520335526891, -538.8856640824133, 560.3432712758741, -2769.3966095899987, -2218.1435197090577, -560.0155173212951, -2851.282153266751, 229.69126699115066, -1770.4043149603185, 1186.2999520609997, 535.8018155585337, 768.2201023831525, -1593.6238669468967, 1410.2059238749423, 656.7055943201293, 1396.66586422908, 1338.2897440763386, -932.3391692947438, -2498.141012322584, -1076.9880254887473, -1707.653613534008, -404.9534033649227, 548.9124709663049, -538.2057487594277, -1159.1618906405836, 1543.6105959051552, -168.30744130079378, -1635.3844953726525, 643.1629160191266, -851.9411866649616, 1.1164070659329965, -2914.20652487586, -627.3845731858718, -1381.2360477686755, 115.35030327985461, -799.6331964013068, 27.70197937264814, 21.573272368420838, -1701.5176473392694, 27.318602126055602, 663.0006145108455, 70.61557993533323, -2282.519921982865, 1294.0580902114584, -2355.5739725257226, 994.5486082358564, -1669.5166281132754, -1293.6938666611668, -649.2578954367098, 703.8724262205981, -800.9522447209599, -2179.025112152869, 2698.459820537125, 2816.620579727158, -4495.026582948653, -3164.949704274842, -2062.0317847724577, -2074.9707629046325, 1886.7419794269479, -520.5059728226668, -1390.7381577446035, -2430.56066432549, -1023.9618216606133, 33.415831670294764, 577.1250834714201, -260.2101707821843, 1442.7734066501912, 287.90711129309904, -1128.9064308220377, -47.25943148375528, 535.4338319573914, -1219.6000755560785, -986.0134361267166, -622.6430771355284, -1034.0148101042528, -1349.9126529306639, 947.3255147869069, -373.6581939678174, -1176.449874633333, -1927.4129981701155, -1497.0923323581262, -696.3938194861324, -534.7263964168467, -3302.701043297869, 2456.424991077804, -1788.0770361960035, 717.4068435658784, -672.835912697631, -1257.1516158710947, 397.1701342435901, 3115.029529080091, 871.2798294324655, -2013.5709748939164, -2814.5487096513484, -1530.2577738602788, -821.86356048581, 543.4718937632607, -404.61625581244164, -2271.3374512940245, -1241.5032647185658, 2080.6322054119105, -1007.9784148596805, -955.709459243355, 1228.243781679369, -1634.086252696138, -886.5707250234835, -725.9028277891823, -887.061869180897, 2418.338060594708, 2418.180897123422, 2568.3935148693167, -3955.504637269808, -273.3471706578862, 1817.901912868638, -374.28162353966474, -1928.361568200895, 2237.134117914651, -1362.3275225003902, 3302.289583270296, -694.0975617061241, -26.868970098778153, -805.3575828763156, -436.18258553374335, -2346.926614056676, 1501.247709775581, -366.1589911900378, 1674.3606606596059, -660.446020621016, 2658.8031606832747, -2756.841036605241, -678.3708270500415, -403.0543272941874, -231.4462468459918, -1223.358500394635, 234.0299597278421, -1152.7340638627586, 2620.371278081767, 2506.641205588752, -733.8286728115479, -3104.1997037896763, -1063.088136961172, -53.32300356563048, 4974.695733312715, 2146.358537031997, 790.5425743456304, 2673.8935172899232, 121.80815737342516, -427.59339504346264, 448.51077635141166, 529.6028673539499, -1214.8327310767643, -277.8687935700318, 3061.9447363859495, -1684.8236185026017, 3933.1144088558563, -1173.191844533003, -1127.9103372846162, -2004.2221321843385, 2285.5462678411654, -1275.6863047587663, 2818.497183947956, 3365.4515169485558, 3026.458942768475, 1647.5693225774482, -228.63529656064898, 243.89660839032072, 61.182833648762454, -609.0797136016689, -904.695986590523, -1777.840718227192, 5417.297407179652, 1732.304282904876, 2553.6917755571994, 1392.1603998406486, 309.2536950893576, -592.4160321316776, 2964.328924054106, 741.146461879674, -2731.27538691107, -162.83008098775213, 1644.260256272356, 488.9874085546794, 1071.1577363703072, -501.26085656799523, 1431.2057256637172, -177.623018003053, -447.3798506983328, -2795.0596688592286, 3349.3906569587193, -1254.481334174801, -26.169957163101476, -2994.527952362024, 277.57830098319846, 3959.4916342221504, 5686.482140100691, 2598.7885191692867, 4210.300743056589, -1078.4077022524077], "policy_predator_policy_reward": [2022.797570579704, 522.4401270553988, 929.5513318290601, 1279.502006485065, 180.63847331612894, 2597.520563714223, 634.5852569626031, 1987.0056293129965, 0.0, 891.5002263711942, -2132.0901508851357, 828.0682329434504, 1097.7444217684172, -610.3649674621886, -1396.66586422908, -340.8470577524605, 0.0, -405.9505747815943, 1759.7480280361187, 1815.381009775212, 518.8880365401105, 1829.6346596410935, 70.75483025926154, -81.46155246613861, 89.58443090835495, -474.033136172926, 1655.822571812991, 259.25073328371775, 265.02375559971813, -56.245484953882844, 141.99236699013133, 2771.0977508197957, 1667.8035061017026, 340.81711485284416, 1251.3309932843658, -567.0481001629136, -18.08157670389724, -31.193675037171765, -23.4763789861998, 1697.6754241994133, 466.11544426059004, -750.7555526368327, -1084.0934924983503, 2072.555324269758, 112.66569734730744, 1248.359666942557, 2056.6766119220893, 906.5338828523546, -119.42758023877619, 64.81304945488718, 2501.1706055418144, 478.80675133201703, -5411.447374389358, 0.0, 7871.732645628149, 200.9078987595607, 2047.5663401720808, 2089.4362075050103, -1076.667209853286, -289.56879675099646, 2428.9780315332246, 1392.3207905368686, 571.6441837955473, 729.7341364880385, 280.8127783707954, -597.7276910600312, -1730.6805179432902, 0.0, 377.27988439459546, 908.0055035907494, 1243.3327053525434, -559.1664617538559, 792.6326384954322, 816.0238747668127, 1439.529668921705, 944.3977941132118, 244.2579002262153, -817.9252210453046, 1046.854300825407, 2057.0085719780423, 899.3810286026318, 1294.1051232416262, 3302.701043297869, 534.7263964168467, -2456.424991077804, 2247.946611593509, -44.57093086824781, 0.0, 564.9423973428652, 295.0390842846392, -1449.0903215671844, -2537.219036945373, 1113.9346391877052, 3714.1850453575566, 2467.850964071986, 0.0, -212.1096234209588, 73.25398547013975, 2352.191507381868, 1160.649208630724, -1117.8788244998748, 45.22503394764699, 962.0313778638251, -1028.5941713059003, 2520.6569777196223, 0.0, 987.8108027376704, 1054.0202902465608, -3192.240318773496, -1644.278638944633, 3519.9222952569867, -1732.761098989574, -1817.901912868638, 273.3471706578862, 2088.232137279495, 214.41105446106607, -1155.4907027318716, 280.6841073176099, -2534.2624068173504, -73.92961474682312, 80.19453875441691, 752.0320142206766, 2418.6185513843334, 364.4906482060861, -529.4400572058345, -605.6486613797078, -622.2135875208687, -391.7010525177207, 2763.908641686524, -2665.8707657645577, 388.8356255540184, 692.5895287902105, 162.98967855938074, 1291.8150686812464, -133.46298285984537, 1052.1670869947611, -4923.094873699669, 0.0, 2368.5694165686573, 1580.379735592195, -251.36421314516897, 1367.7753536719713, -1947.5113383450825, -4974.695733312715, -3565.710123857229, 101.27403222167275, 776.2469463087596, -470.4617086387226, -872.8629239689639, 0.0, 826.0283433726167, 1234.7977925906503, -1738.4841912800434, 361.363073396695, -3933.1144088558563, 1521.3259107286872, 987.9123691744302, 3291.05151224844, -984.9637541895939, -24.896208892803365, -3128.494154948852, -2947.5709203378256, -3183.3121599034575, -1490.7161054424662, -470.78462300643605, 455.52331117676454, -112.68912029966847, 660.5860002525749, 1523.0115317733012, 2571.218334921297, -5024.807302084853, -2124.794387999677, -1760.6704163183426, -2185.1817590795054, 233.86938722241487, 49.2929498199043, -493.17313870838046, -3212.302247225399, 2448.7343441256653, 659.0248197821847, -2167.1685850387, 33.92092021166492, -185.32558767445192, 55.806343969855696, -1436.4225386977655, 182.83983103710136, 2495.327085186904, 1116.8729015923432, 28.488592321716073, -2123.397915105634, 3172.6535205265855, -151.9556110014596, -1759.9744718950806, -2477.0954633102715, -5556.103321006501, -2729.167338263475, 146.781367519576, -3278.674408323758]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7401878171630262, "mean_inference_ms": 1.5856123730628016, "mean_action_processing_ms": 0.298985163441641, "mean_env_wait_ms": 0.133390852832165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009623200002342763, "StateBufferConnector_ms": 0.004380881184279316, "ViewRequirementAgentConnector_ms": 0.1278540100714173}, "num_episodes": 27, "episode_return_max": 1411.6931618768854, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 95.91535725550176, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.6533168132968, "num_env_steps_trained_throughput_per_sec": 275.6533168132968, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 15264.1, "restore_workers_time_ms": 0.088, "training_step_time_ms": 15263.891, "sample_time_ms": 1245.824, "learn_time_ms": 13998.043, "learn_throughput": 285.754, "synch_weights_time_ms": 17.325}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "6751e_00000", "date": "2024-08-11_19-08-27", "timestamp": 1723417707, "time_this_iter_s": 14.565183162689209, "time_total_s": 76.55832648277283, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 76.55832648277283, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.88571428571429, "ram_util_percent": 83.35714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7810356130991033, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.947609684959291, "policy_loss": -0.006748035787629387, "vf_loss": 9.952573401839645, "vf_explained_var": 0.0002924145844878343, "kl": 0.008921754061808526, "entropy": 1.4249046326945067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7760990764413561, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.394214263794915, "policy_loss": -0.008930262498232344, "vf_loss": 9.401342475729644, "vf_explained_var": -0.0007808435530889602, "kl": 0.009010112288389572, "entropy": 1.5059342418398176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 1411.6931618768854, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 94.65757616558722, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4495.026582948653, "predator_policy": -6019.307146144798}, "policy_reward_max": {"prey_policy": 6847.521092455301, "predator_policy": 7871.732645628149}, "policy_reward_mean": {"prey_policy": 164.06138863830267, "predator_policy": -116.73260055550898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 448.976086069936, 0.0, 0.0, 7.105427357601002e-15, 0.0, -3.552713678800501e-15, 103.63302587492778, 412.6642571642152, -1.4210854715202004e-14, 0.0, 0.0, 310.83233029326766, 0.0, 0.0, 109.11952567955177, 0.0, -1.7763568394002505e-15, -3.552713678800501e-15, 0.0, 0.0, 0.0, 1.4210854715202004e-14, 459.86957539750483, 0.0, 0.0, -7.105427357601002e-15, 0.0, 115.72962972589632, 0.0, -7.105427357601002e-15, 0.0, 205.9715289939385, 0.0, 428.86639601415175, 1.7763568394002505e-15, 400.050073866923, 0.0, 0.0, 0.0, 0.0, 3.552713678800501e-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.552713678800501e-15, 203.91760997084953, 110.92077555962737, 7.105427357601002e-15, 198.8471986869155, 8.881784197001252e-15, 0.0, 105.25071973639905, 568.1246113164705, 0.0, 348.1340661956843, 1146.8314119539136, 0.0, 107.88362560983404, 0.0, 0.0, 0.0, 1411.6931618768854, -8.881784197001252e-15, 0.0, 0.0, 0.0, 213.65369600902602, 0.0, 440.37763609771594, 3.552713678800501e-15, 369.76046722168593, 0.0, 0.0, 0.0, 1.4210854715202004e-14, -3.552713678800501e-15, 0.0, 0.0, 464.2949611492685, 7.105427357601002e-15, 113.05712045470615, 0.0, 0.0, -3.552713678800501e-15, 234.23071979297507, 1.7763568394002505e-15, 0.0, 102.84194704652732, 0.0, 0.0, 208.56039254043827, 3.552713678800501e-15, 0.0, 121.66506625948773], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [115.35030327985461, -799.6331964013068, 27.70197937264814, 21.573272368420838, -1701.5176473392694, 27.318602126055602, 663.0006145108455, 70.61557993533323, -2282.519921982865, 1294.0580902114584, -2355.5739725257226, 994.5486082358564, -1669.5166281132754, -1293.6938666611668, -649.2578954367098, 703.8724262205981, -800.9522447209599, -2179.025112152869, 2698.459820537125, 2816.620579727158, -4495.026582948653, -3164.949704274842, -2062.0317847724577, -2074.9707629046325, 1886.7419794269479, -520.5059728226668, -1390.7381577446035, -2430.56066432549, -1023.9618216606133, 33.415831670294764, 577.1250834714201, -260.2101707821843, 1442.7734066501912, 287.90711129309904, -1128.9064308220377, -47.25943148375528, 535.4338319573914, -1219.6000755560785, -986.0134361267166, -622.6430771355284, -1034.0148101042528, -1349.9126529306639, 947.3255147869069, -373.6581939678174, -1176.449874633333, -1927.4129981701155, -1497.0923323581262, -696.3938194861324, -534.7263964168467, -3302.701043297869, 2456.424991077804, -1788.0770361960035, 717.4068435658784, -672.835912697631, -1257.1516158710947, 397.1701342435901, 3115.029529080091, 871.2798294324655, -2013.5709748939164, -2814.5487096513484, -1530.2577738602788, -821.86356048581, 543.4718937632607, -404.61625581244164, -2271.3374512940245, -1241.5032647185658, 2080.6322054119105, -1007.9784148596805, -955.709459243355, 1228.243781679369, -1634.086252696138, -886.5707250234835, -725.9028277891823, -887.061869180897, 2418.338060594708, 2418.180897123422, 2568.3935148693167, -3955.504637269808, -273.3471706578862, 1817.901912868638, -374.28162353966474, -1928.361568200895, 2237.134117914651, -1362.3275225003902, 3302.289583270296, -694.0975617061241, -26.868970098778153, -805.3575828763156, -436.18258553374335, -2346.926614056676, 1501.247709775581, -366.1589911900378, 1674.3606606596059, -660.446020621016, 2658.8031606832747, -2756.841036605241, -678.3708270500415, -403.0543272941874, -231.4462468459918, -1223.358500394635, 234.0299597278421, -1152.7340638627586, 2620.371278081767, 2506.641205588752, -733.8286728115479, -3104.1997037896763, -1063.088136961172, -53.32300356563048, 4974.695733312715, 2146.358537031997, 790.5425743456304, 2673.8935172899232, 121.80815737342516, -427.59339504346264, 448.51077635141166, 529.6028673539499, -1214.8327310767643, -277.8687935700318, 3061.9447363859495, -1684.8236185026017, 3933.1144088558563, -1173.191844533003, -1127.9103372846162, -2004.2221321843385, 2285.5462678411654, -1275.6863047587663, 2818.497183947956, 3365.4515169485558, 3026.458942768475, 1647.5693225774482, -228.63529656064898, 243.89660839032072, 61.182833648762454, -609.0797136016689, -904.695986590523, -1777.840718227192, 5417.297407179652, 1732.304282904876, 2553.6917755571994, 1392.1603998406486, 309.2536950893576, -592.4160321316776, 2964.328924054106, 741.146461879674, -2731.27538691107, -162.83008098775213, 1644.260256272356, 488.9874085546794, 1071.1577363703072, -501.26085656799523, 1431.2057256637172, -177.623018003053, -447.3798506983328, -2795.0596688592286, 3349.3906569587193, -1254.481334174801, -26.169957163101476, -2994.527952362024, 277.57830098319846, 3959.4916342221504, 5686.482140100691, 2598.7885191692867, 4210.300743056589, -1078.4077022524077, -2275.5042229542405, -3429.9133128144017, 4378.070657745053, -57.04763056826279, -2362.3996356622165, -1466.498358442278, 6847.521092455301, -2022.4158105494173, 5108.778547278185, 455.3200677203167, 4299.316176186349, 920.3591305530997, 2591.566384944486, -502.65996288467534, -1006.7631545559402, -1987.8752391213238, 1998.584031883239, -2212.802778818521, 3287.3932429565243, 1106.1837271451143, 2477.837563763059, -2949.9043594238124, 6253.566251783639, -2334.15142989847, 1947.9463955617255, -1921.8895741113542, 2726.5710309064048, 761.4602278395017, -1657.7844248067938, 919.2624754461647, 1638.5068355799147, -1619.5213885817584, 5820.690877970473, 56.432043164226684, 570.9672523300711, 47.401903977254825], "policy_predator_policy_reward": [1251.3309932843658, -567.0481001629136, -18.08157670389724, -31.193675037171765, -23.4763789861998, 1697.6754241994133, 466.11544426059004, -750.7555526368327, -1084.0934924983503, 2072.555324269758, 112.66569734730744, 1248.359666942557, 2056.6766119220893, 906.5338828523546, -119.42758023877619, 64.81304945488718, 2501.1706055418144, 478.80675133201703, -5411.447374389358, 0.0, 7871.732645628149, 200.9078987595607, 2047.5663401720808, 2089.4362075050103, -1076.667209853286, -289.56879675099646, 2428.9780315332246, 1392.3207905368686, 571.6441837955473, 729.7341364880385, 280.8127783707954, -597.7276910600312, -1730.6805179432902, 0.0, 377.27988439459546, 908.0055035907494, 1243.3327053525434, -559.1664617538559, 792.6326384954322, 816.0238747668127, 1439.529668921705, 944.3977941132118, 244.2579002262153, -817.9252210453046, 1046.854300825407, 2057.0085719780423, 899.3810286026318, 1294.1051232416262, 3302.701043297869, 534.7263964168467, -2456.424991077804, 2247.946611593509, -44.57093086824781, 0.0, 564.9423973428652, 295.0390842846392, -1449.0903215671844, -2537.219036945373, 1113.9346391877052, 3714.1850453575566, 2467.850964071986, 0.0, -212.1096234209588, 73.25398547013975, 2352.191507381868, 1160.649208630724, -1117.8788244998748, 45.22503394764699, 962.0313778638251, -1028.5941713059003, 2520.6569777196223, 0.0, 987.8108027376704, 1054.0202902465608, -3192.240318773496, -1644.278638944633, 3519.9222952569867, -1732.761098989574, -1817.901912868638, 273.3471706578862, 2088.232137279495, 214.41105446106607, -1155.4907027318716, 280.6841073176099, -2534.2624068173504, -73.92961474682312, 80.19453875441691, 752.0320142206766, 2418.6185513843334, 364.4906482060861, -529.4400572058345, -605.6486613797078, -622.2135875208687, -391.7010525177207, 2763.908641686524, -2665.8707657645577, 388.8356255540184, 692.5895287902105, 162.98967855938074, 1291.8150686812464, -133.46298285984537, 1052.1670869947611, -4923.094873699669, 0.0, 2368.5694165686573, 1580.379735592195, -251.36421314516897, 1367.7753536719713, -1947.5113383450825, -4974.695733312715, -3565.710123857229, 101.27403222167275, 776.2469463087596, -470.4617086387226, -872.8629239689639, 0.0, 826.0283433726167, 1234.7977925906503, -1738.4841912800434, 361.363073396695, -3933.1144088558563, 1521.3259107286872, 987.9123691744302, 3291.05151224844, -984.9637541895939, -24.896208892803365, -3128.494154948852, -2947.5709203378256, -3183.3121599034575, -1490.7161054424662, -470.78462300643605, 455.52331117676454, -112.68912029966847, 660.5860002525749, 1523.0115317733012, 2571.218334921297, -5024.807302084853, -2124.794387999677, -1760.6704163183426, -2185.1817590795054, 233.86938722241487, 49.2929498199043, -493.17313870838046, -3212.302247225399, 2448.7343441256653, 659.0248197821847, -2167.1685850387, 33.92092021166492, -185.32558767445192, 55.806343969855696, -1436.4225386977655, 182.83983103710136, 2495.327085186904, 1116.8729015923432, 28.488592321716073, -2123.397915105634, 3172.6535205265855, -151.9556110014596, -1759.9744718950806, -2477.0954633102715, -5556.103321006501, -2729.167338263475, 146.781367519576, -3278.674408323758, 2013.7677036435746, 3691.649832125067, -1251.6495429213571, -3069.373484255432, 2217.090489564346, 2076.102465689416, 684.3655669174526, -5509.470848823339, -3700.257637007462, -1750.783857536326, -1679.1284651565738, -3540.546841582875, -506.7468315375595, -1582.1595905222498, 1907.177515634122, 1087.460878043142, -570.5955371881736, 1019.0450039164285, -2107.093832071112, -2286.4831380305263, 1476.764503631145, -1004.6977079703929, 2202.734271306158, -6019.307146144798, -1979.0671583885057, 1953.0103369381345, 659.5841143545649, -4147.615373100469, -250.33391571138952, 1197.416257612456, 290.5332405378293, -309.5186875359859, -1132.1843230561587, -4744.938598078542, 1226.8541338022874, -1723.5582238501258]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7283042984168523, "mean_inference_ms": 1.563333406967259, "mean_action_processing_ms": 0.2919393190451056, "mean_env_wait_ms": 0.1319348432446209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008720755577087402, "StateBufferConnector_ms": 0.004489302635192871, "ViewRequirementAgentConnector_ms": 0.11797308921813965}, "num_episodes": 18, "episode_return_max": 1411.6931618768854, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 94.65757616558722, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.82491542366796, "num_env_steps_trained_throughput_per_sec": 274.82491542366796, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 15145.872, "restore_workers_time_ms": 0.076, "training_step_time_ms": 15145.69, "sample_time_ms": 1222.57, "learn_time_ms": 13904.049, "learn_throughput": 287.686, "synch_weights_time_ms": 16.593}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "6751e_00000", "date": "2024-08-11_19-08-42", "timestamp": 1723417722, "time_this_iter_s": 14.619404077529907, "time_total_s": 91.17773056030273, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 91.17773056030273, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 47.18571428571429, "ram_util_percent": 83.39047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.774931223067657, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.949204249609084, "policy_loss": -0.007406998931543615, "vf_loss": 9.954786016575243, "vf_explained_var": -0.005152981117288903, "kl": 0.009126318153036215, "entropy": 1.4260829837233933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7050768731605439, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.165656761391453, "policy_loss": -0.0054946054535715905, "vf_loss": 9.169363263548997, "vf_explained_var": -0.0005623337768373035, "kl": 0.008940511363284538, "entropy": 1.4721305369700073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 1473.6325662569895, "episode_reward_min": -1.7763568394002505e-14, "episode_reward_mean": 106.88469027435907, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4460.465381997898, "predator_policy": -6019.307146144798}, "policy_reward_max": {"prey_policy": 6847.521092455301, "predator_policy": 8104.130669461123}, "policy_reward_mean": {"prey_policy": 265.33050647246364, "predator_policy": -211.88816133528414}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -1.7763568394002505e-15, -3.552713678800501e-15, 0.0, 0.0, 0.0, 1.4210854715202004e-14, 459.86957539750483, 0.0, 0.0, -7.105427357601002e-15, 0.0, 115.72962972589632, 0.0, -7.105427357601002e-15, 0.0, 205.9715289939385, 0.0, 428.86639601415175, 1.7763568394002505e-15, 400.050073866923, 0.0, 0.0, 0.0, 0.0, 3.552713678800501e-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.552713678800501e-15, 203.91760997084953, 110.92077555962737, 7.105427357601002e-15, 198.8471986869155, 8.881784197001252e-15, 0.0, 105.25071973639905, 568.1246113164705, 0.0, 348.1340661956843, 1146.8314119539136, 0.0, 107.88362560983404, 0.0, 0.0, 0.0, 1411.6931618768854, -8.881784197001252e-15, 0.0, 0.0, 0.0, 213.65369600902602, 0.0, 440.37763609771594, 3.552713678800501e-15, 369.76046722168593, 0.0, 0.0, 0.0, 1.4210854715202004e-14, -3.552713678800501e-15, 0.0, 0.0, 464.2949611492685, 7.105427357601002e-15, 113.05712045470615, 0.0, 0.0, -3.552713678800501e-15, 234.23071979297507, 1.7763568394002505e-15, 0.0, 102.84194704652732, 0.0, 0.0, 208.56039254043827, 3.552713678800501e-15, 0.0, 121.66506625948773, 243.99309258360017, 512.5310090520784, 130.7153480808605, -1.7763568394002505e-14, 0.0, -1.0658141036401503e-14, 1473.6325662569895, 2.1316282072803006e-14, -1.4210854715202004e-14, 0.0, 0.0, 0.0, -1.7763568394002505e-15, -1.4210854715202004e-14, 0.0, 0.0, -3.552713678800501e-15, 247.06461998555528], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [535.4338319573914, -1219.6000755560785, -986.0134361267166, -622.6430771355284, -1034.0148101042528, -1349.9126529306639, 947.3255147869069, -373.6581939678174, -1176.449874633333, -1927.4129981701155, -1497.0923323581262, -696.3938194861324, -534.7263964168467, -3302.701043297869, 2456.424991077804, -1788.0770361960035, 717.4068435658784, -672.835912697631, -1257.1516158710947, 397.1701342435901, 3115.029529080091, 871.2798294324655, -2013.5709748939164, -2814.5487096513484, -1530.2577738602788, -821.86356048581, 543.4718937632607, -404.61625581244164, -2271.3374512940245, -1241.5032647185658, 2080.6322054119105, -1007.9784148596805, -955.709459243355, 1228.243781679369, -1634.086252696138, -886.5707250234835, -725.9028277891823, -887.061869180897, 2418.338060594708, 2418.180897123422, 2568.3935148693167, -3955.504637269808, -273.3471706578862, 1817.901912868638, -374.28162353966474, -1928.361568200895, 2237.134117914651, -1362.3275225003902, 3302.289583270296, -694.0975617061241, -26.868970098778153, -805.3575828763156, -436.18258553374335, -2346.926614056676, 1501.247709775581, -366.1589911900378, 1674.3606606596059, -660.446020621016, 2658.8031606832747, -2756.841036605241, -678.3708270500415, -403.0543272941874, -231.4462468459918, -1223.358500394635, 234.0299597278421, -1152.7340638627586, 2620.371278081767, 2506.641205588752, -733.8286728115479, -3104.1997037896763, -1063.088136961172, -53.32300356563048, 4974.695733312715, 2146.358537031997, 790.5425743456304, 2673.8935172899232, 121.80815737342516, -427.59339504346264, 448.51077635141166, 529.6028673539499, -1214.8327310767643, -277.8687935700318, 3061.9447363859495, -1684.8236185026017, 3933.1144088558563, -1173.191844533003, -1127.9103372846162, -2004.2221321843385, 2285.5462678411654, -1275.6863047587663, 2818.497183947956, 3365.4515169485558, 3026.458942768475, 1647.5693225774482, -228.63529656064898, 243.89660839032072, 61.182833648762454, -609.0797136016689, -904.695986590523, -1777.840718227192, 5417.297407179652, 1732.304282904876, 2553.6917755571994, 1392.1603998406486, 309.2536950893576, -592.4160321316776, 2964.328924054106, 741.146461879674, -2731.27538691107, -162.83008098775213, 1644.260256272356, 488.9874085546794, 1071.1577363703072, -501.26085656799523, 1431.2057256637172, -177.623018003053, -447.3798506983328, -2795.0596688592286, 3349.3906569587193, -1254.481334174801, -26.169957163101476, -2994.527952362024, 277.57830098319846, 3959.4916342221504, 5686.482140100691, 2598.7885191692867, 4210.300743056589, -1078.4077022524077, -2275.5042229542405, -3429.9133128144017, 4378.070657745053, -57.04763056826279, -2362.3996356622165, -1466.498358442278, 6847.521092455301, -2022.4158105494173, 5108.778547278185, 455.3200677203167, 4299.316176186349, 920.3591305530997, 2591.566384944486, -502.65996288467534, -1006.7631545559402, -1987.8752391213238, 1998.584031883239, -2212.802778818521, 3287.3932429565243, 1106.1837271451143, 2477.837563763059, -2949.9043594238124, 6253.566251783639, -2334.15142989847, 1947.9463955617255, -1921.8895741113542, 2726.5710309064048, 761.4602278395017, -1657.7844248067938, 919.2624754461647, 1638.5068355799147, -1619.5213885817584, 5820.690877970473, 56.432043164226684, 570.9672523300711, 47.401903977254825, -2087.369491253221, -2432.573943493584, 3086.500591958696, -2568.952325558581, -1382.1092014261028, -3064.9273864390448, 5091.809172765341, -615.7954610187985, 1351.728933615835, -3880.361865970923, -207.78054605460267, -3499.006562446458, -3843.953984803683, -3041.4235511002476, 4433.5433008886, -94.15632749190617, 5761.393158585513, 1247.9077181188868, 1635.2242852677973, -100.83828756571936, 466.6192722885574, -1129.8355206237652, 1496.992633233347, -2758.6195249016973, 3882.682633579395, 818.1438370948131, 4171.410409660316, 1546.8002275759077, 4430.636663183043, -4460.465381997898, 468.2263971245333, -225.68854752899054, 2116.4822389674787, -272.74987211020334, -2314.39455616753, -2441.004249961665], "policy_predator_policy_reward": [1243.3327053525434, -559.1664617538559, 792.6326384954322, 816.0238747668127, 1439.529668921705, 944.3977941132118, 244.2579002262153, -817.9252210453046, 1046.854300825407, 2057.0085719780423, 899.3810286026318, 1294.1051232416262, 3302.701043297869, 534.7263964168467, -2456.424991077804, 2247.946611593509, -44.57093086824781, 0.0, 564.9423973428652, 295.0390842846392, -1449.0903215671844, -2537.219036945373, 1113.9346391877052, 3714.1850453575566, 2467.850964071986, 0.0, -212.1096234209588, 73.25398547013975, 2352.191507381868, 1160.649208630724, -1117.8788244998748, 45.22503394764699, 962.0313778638251, -1028.5941713059003, 2520.6569777196223, 0.0, 987.8108027376704, 1054.0202902465608, -3192.240318773496, -1644.278638944633, 3519.9222952569867, -1732.761098989574, -1817.901912868638, 273.3471706578862, 2088.232137279495, 214.41105446106607, -1155.4907027318716, 280.6841073176099, -2534.2624068173504, -73.92961474682312, 80.19453875441691, 752.0320142206766, 2418.6185513843334, 364.4906482060861, -529.4400572058345, -605.6486613797078, -622.2135875208687, -391.7010525177207, 2763.908641686524, -2665.8707657645577, 388.8356255540184, 692.5895287902105, 162.98967855938074, 1291.8150686812464, -133.46298285984537, 1052.1670869947611, -4923.094873699669, 0.0, 2368.5694165686573, 1580.379735592195, -251.36421314516897, 1367.7753536719713, -1947.5113383450825, -4974.695733312715, -3565.710123857229, 101.27403222167275, 776.2469463087596, -470.4617086387226, -872.8629239689639, 0.0, 826.0283433726167, 1234.7977925906503, -1738.4841912800434, 361.363073396695, -3933.1144088558563, 1521.3259107286872, 987.9123691744302, 3291.05151224844, -984.9637541895939, -24.896208892803365, -3128.494154948852, -2947.5709203378256, -3183.3121599034575, -1490.7161054424662, -470.78462300643605, 455.52331117676454, -112.68912029966847, 660.5860002525749, 1523.0115317733012, 2571.218334921297, -5024.807302084853, -2124.794387999677, -1760.6704163183426, -2185.1817590795054, 233.86938722241487, 49.2929498199043, -493.17313870838046, -3212.302247225399, 2448.7343441256653, 659.0248197821847, -2167.1685850387, 33.92092021166492, -185.32558767445192, 55.806343969855696, -1436.4225386977655, 182.83983103710136, 2495.327085186904, 1116.8729015923432, 28.488592321716073, -2123.397915105634, 3172.6535205265855, -151.9556110014596, -1759.9744718950806, -2477.0954633102715, -5556.103321006501, -2729.167338263475, 146.781367519576, -3278.674408323758, 2013.7677036435746, 3691.649832125067, -1251.6495429213571, -3069.373484255432, 2217.090489564346, 2076.102465689416, 684.3655669174526, -5509.470848823339, -3700.257637007462, -1750.783857536326, -1679.1284651565738, -3540.546841582875, -506.7468315375595, -1582.1595905222498, 1907.177515634122, 1087.460878043142, -570.5955371881736, 1019.0450039164285, -2107.093832071112, -2286.4831380305263, 1476.764503631145, -1004.6977079703929, 2202.734271306158, -6019.307146144798, -1979.0671583885057, 1953.0103369381345, 659.5841143545649, -4147.615373100469, -250.33391571138952, 1197.416257612456, 290.5332405378293, -309.5186875359859, -1132.1843230561587, -4744.938598078542, 1226.8541338022874, -1723.5582238501258, 0.0, 4763.936527330402, -3008.342153239962, 3003.324895891926, 2923.5023938156287, 1654.2495421303781, -5091.809172765341, 615.7954610187985, 3283.4597983594663, -754.826866004377, 3393.1949373278935, 313.59217117316643, 8104.130669461123, 254.87943269979849, 94.15632749190617, -4433.5433008886, -1964.6848543111007, -5044.6160223932975, -1398.881312170347, -135.5046855317308, -236.76834998642667, 899.9845983216337, 2686.931641767326, -1425.304750098976, 89.02320129632902, -4789.849671970536, -1546.8002275759077, -4171.410409660316, -411.7733310448271, 441.60204985967977, 0.0, -242.5378495955448, 272.74987211020334, -2116.4822389674787, 4470.835549801009, 531.6278763137427]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7168611448317077, "mean_inference_ms": 1.54811935552757, "mean_action_processing_ms": 0.2882850530803839, "mean_env_wait_ms": 0.13062090489781522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075615644454956055, "StateBufferConnector_ms": 0.004522919654846191, "ViewRequirementAgentConnector_ms": 0.11693251132965088}, "num_episodes": 18, "episode_return_max": 1473.6325662569895, "episode_return_min": -1.7763568394002505e-14, "episode_return_mean": 106.88469027435907, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.20224144666383, "num_env_steps_trained_throughput_per_sec": 270.20224144666383, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 15096.995, "restore_workers_time_ms": 0.067, "training_step_time_ms": 15096.833, "sample_time_ms": 1246.766, "learn_time_ms": 13830.708, "learn_throughput": 289.212, "synch_weights_time_ms": 17.005}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "6751e_00000", "date": "2024-08-11_19-08-57", "timestamp": 1723417737, "time_this_iter_s": 14.860310077667236, "time_total_s": 106.03804063796997, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 106.03804063796997, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 47.08571428571428, "ram_util_percent": 83.17619047619048}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7741434239678913, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.916960834826112, "policy_loss": -0.005330600378857482, "vf_loss": 9.92112083081846, "vf_explained_var": 0.0010249982435236531, "kl": 0.005853062192309405, "entropy": 1.454980449954038, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7338311591634044, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.675043909890311, "policy_loss": -0.003587869340898814, "vf_loss": 9.67750799088251, "vf_explained_var": -0.0001182493078645575, "kl": 0.0056188251100222795, "entropy": 1.46301309406442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 1473.6325662569895, "episode_reward_min": -1.7763568394002505e-14, "episode_reward_mean": 134.04181960670857, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4460.465381997898, "predator_policy": -6496.526842280181}, "policy_reward_max": {"prey_policy": 7445.237468938743, "predator_policy": 8104.130669461123}, "policy_reward_mean": {"prey_policy": 443.2499147120059, "predator_policy": -376.22900490865163}, "custom_metrics": {}, "hist_stats": {"episode_reward": [428.86639601415175, 1.7763568394002505e-15, 400.050073866923, 0.0, 0.0, 0.0, 0.0, 3.552713678800501e-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -3.552713678800501e-15, 203.91760997084953, 110.92077555962737, 7.105427357601002e-15, 198.8471986869155, 8.881784197001252e-15, 0.0, 105.25071973639905, 568.1246113164705, 0.0, 348.1340661956843, 1146.8314119539136, 0.0, 107.88362560983404, 0.0, 0.0, 0.0, 1411.6931618768854, -8.881784197001252e-15, 0.0, 0.0, 0.0, 213.65369600902602, 0.0, 440.37763609771594, 3.552713678800501e-15, 369.76046722168593, 0.0, 0.0, 0.0, 1.4210854715202004e-14, -3.552713678800501e-15, 0.0, 0.0, 464.2949611492685, 7.105427357601002e-15, 113.05712045470615, 0.0, 0.0, -3.552713678800501e-15, 234.23071979297507, 1.7763568394002505e-15, 0.0, 102.84194704652732, 0.0, 0.0, 208.56039254043827, 3.552713678800501e-15, 0.0, 121.66506625948773, 243.99309258360017, 512.5310090520784, 130.7153480808605, -1.7763568394002505e-14, 0.0, -1.0658141036401503e-14, 1473.6325662569895, 2.1316282072803006e-14, -1.4210854715202004e-14, 0.0, 0.0, 0.0, -1.7763568394002505e-15, -1.4210854715202004e-14, 0.0, 0.0, -3.552713678800501e-15, 247.06461998555528, 201.76396347012167, 131.58932847650627, 371.6269689448641, 0.0, 321.48439015130134, 0.0, 258.3435732506671, 131.5390168782971, 0.0, 0.0, 0.0, 4.973799150320701e-14, 716.5452227622413, 0.0, -1.7763568394002505e-15, 0.0, 1.0658141036401503e-14, 1364.3912034182893], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-725.9028277891823, -887.061869180897, 2418.338060594708, 2418.180897123422, 2568.3935148693167, -3955.504637269808, -273.3471706578862, 1817.901912868638, -374.28162353966474, -1928.361568200895, 2237.134117914651, -1362.3275225003902, 3302.289583270296, -694.0975617061241, -26.868970098778153, -805.3575828763156, -436.18258553374335, -2346.926614056676, 1501.247709775581, -366.1589911900378, 1674.3606606596059, -660.446020621016, 2658.8031606832747, -2756.841036605241, -678.3708270500415, -403.0543272941874, -231.4462468459918, -1223.358500394635, 234.0299597278421, -1152.7340638627586, 2620.371278081767, 2506.641205588752, -733.8286728115479, -3104.1997037896763, -1063.088136961172, -53.32300356563048, 4974.695733312715, 2146.358537031997, 790.5425743456304, 2673.8935172899232, 121.80815737342516, -427.59339504346264, 448.51077635141166, 529.6028673539499, -1214.8327310767643, -277.8687935700318, 3061.9447363859495, -1684.8236185026017, 3933.1144088558563, -1173.191844533003, -1127.9103372846162, -2004.2221321843385, 2285.5462678411654, -1275.6863047587663, 2818.497183947956, 3365.4515169485558, 3026.458942768475, 1647.5693225774482, -228.63529656064898, 243.89660839032072, 61.182833648762454, -609.0797136016689, -904.695986590523, -1777.840718227192, 5417.297407179652, 1732.304282904876, 2553.6917755571994, 1392.1603998406486, 309.2536950893576, -592.4160321316776, 2964.328924054106, 741.146461879674, -2731.27538691107, -162.83008098775213, 1644.260256272356, 488.9874085546794, 1071.1577363703072, -501.26085656799523, 1431.2057256637172, -177.623018003053, -447.3798506983328, -2795.0596688592286, 3349.3906569587193, -1254.481334174801, -26.169957163101476, -2994.527952362024, 277.57830098319846, 3959.4916342221504, 5686.482140100691, 2598.7885191692867, 4210.300743056589, -1078.4077022524077, -2275.5042229542405, -3429.9133128144017, 4378.070657745053, -57.04763056826279, -2362.3996356622165, -1466.498358442278, 6847.521092455301, -2022.4158105494173, 5108.778547278185, 455.3200677203167, 4299.316176186349, 920.3591305530997, 2591.566384944486, -502.65996288467534, -1006.7631545559402, -1987.8752391213238, 1998.584031883239, -2212.802778818521, 3287.3932429565243, 1106.1837271451143, 2477.837563763059, -2949.9043594238124, 6253.566251783639, -2334.15142989847, 1947.9463955617255, -1921.8895741113542, 2726.5710309064048, 761.4602278395017, -1657.7844248067938, 919.2624754461647, 1638.5068355799147, -1619.5213885817584, 5820.690877970473, 56.432043164226684, 570.9672523300711, 47.401903977254825, -2087.369491253221, -2432.573943493584, 3086.500591958696, -2568.952325558581, -1382.1092014261028, -3064.9273864390448, 5091.809172765341, -615.7954610187985, 1351.728933615835, -3880.361865970923, -207.78054605460267, -3499.006562446458, -3843.953984803683, -3041.4235511002476, 4433.5433008886, -94.15632749190617, 5761.393158585513, 1247.9077181188868, 1635.2242852677973, -100.83828756571936, 466.6192722885574, -1129.8355206237652, 1496.992633233347, -2758.6195249016973, 3882.682633579395, 818.1438370948131, 4171.410409660316, 1546.8002275759077, 4430.636663183043, -4460.465381997898, 468.2263971245333, -225.68854752899054, 2116.4822389674787, -272.74987211020334, -2314.39455616753, -2441.004249961665, 4533.270090062573, 3101.5390908727486, -1446.4692330201826, -3624.0111781193423, -1437.5988908025925, -518.4947419126046, 5551.7243303823325, -2090.6609707686853, 791.8905931579172, -93.3292495382429, 42.70533877069866, -1155.2737226348052, 1567.557984485248, -1256.4405929611448, 2790.4178584963947, -3789.767604009078, 2629.7326032509955, 2019.5472328953372, 75.57803792086304, -2046.9522259163962, 1543.9322413953082, -3183.7983312730753, 7445.237468938743, -1120.8211403592024, 755.0644208065706, -2864.6443134755, -2092.6924297376722, -75.66146063538095, 3810.690622401099, 398.8693186487877, 1332.5541913914285, 674.3102583546021, 4372.100068057956, 1764.8572249528281, -1063.0922973713275, -2886.296507287343], "policy_predator_policy_reward": [987.8108027376704, 1054.0202902465608, -3192.240318773496, -1644.278638944633, 3519.9222952569867, -1732.761098989574, -1817.901912868638, 273.3471706578862, 2088.232137279495, 214.41105446106607, -1155.4907027318716, 280.6841073176099, -2534.2624068173504, -73.92961474682312, 80.19453875441691, 752.0320142206766, 2418.6185513843334, 364.4906482060861, -529.4400572058345, -605.6486613797078, -622.2135875208687, -391.7010525177207, 2763.908641686524, -2665.8707657645577, 388.8356255540184, 692.5895287902105, 162.98967855938074, 1291.8150686812464, -133.46298285984537, 1052.1670869947611, -4923.094873699669, 0.0, 2368.5694165686573, 1580.379735592195, -251.36421314516897, 1367.7753536719713, -1947.5113383450825, -4974.695733312715, -3565.710123857229, 101.27403222167275, 776.2469463087596, -470.4617086387226, -872.8629239689639, 0.0, 826.0283433726167, 1234.7977925906503, -1738.4841912800434, 361.363073396695, -3933.1144088558563, 1521.3259107286872, 987.9123691744302, 3291.05151224844, -984.9637541895939, -24.896208892803365, -3128.494154948852, -2947.5709203378256, -3183.3121599034575, -1490.7161054424662, -470.78462300643605, 455.52331117676454, -112.68912029966847, 660.5860002525749, 1523.0115317733012, 2571.218334921297, -5024.807302084853, -2124.794387999677, -1760.6704163183426, -2185.1817590795054, 233.86938722241487, 49.2929498199043, -493.17313870838046, -3212.302247225399, 2448.7343441256653, 659.0248197821847, -2167.1685850387, 33.92092021166492, -185.32558767445192, 55.806343969855696, -1436.4225386977655, 182.83983103710136, 2495.327085186904, 1116.8729015923432, 28.488592321716073, -2123.397915105634, 3172.6535205265855, -151.9556110014596, -1759.9744718950806, -2477.0954633102715, -5556.103321006501, -2729.167338263475, 146.781367519576, -3278.674408323758, 2013.7677036435746, 3691.649832125067, -1251.6495429213571, -3069.373484255432, 2217.090489564346, 2076.102465689416, 684.3655669174526, -5509.470848823339, -3700.257637007462, -1750.783857536326, -1679.1284651565738, -3540.546841582875, -506.7468315375595, -1582.1595905222498, 1907.177515634122, 1087.460878043142, -570.5955371881736, 1019.0450039164285, -2107.093832071112, -2286.4831380305263, 1476.764503631145, -1004.6977079703929, 2202.734271306158, -6019.307146144798, -1979.0671583885057, 1953.0103369381345, 659.5841143545649, -4147.615373100469, -250.33391571138952, 1197.416257612456, 290.5332405378293, -309.5186875359859, -1132.1843230561587, -4744.938598078542, 1226.8541338022874, -1723.5582238501258, 0.0, 4763.936527330402, -3008.342153239962, 3003.324895891926, 2923.5023938156287, 1654.2495421303781, -5091.809172765341, 615.7954610187985, 3283.4597983594663, -754.826866004377, 3393.1949373278935, 313.59217117316643, 8104.130669461123, 254.87943269979849, 94.15632749190617, -4433.5433008886, -1964.6848543111007, -5044.6160223932975, -1398.881312170347, -135.5046855317308, -236.76834998642667, 899.9845983216337, 2686.931641767326, -1425.304750098976, 89.02320129632902, -4789.849671970536, -1546.8002275759077, -4171.410409660316, -411.7733310448271, 441.60204985967977, 0.0, -242.5378495955448, 272.74987211020334, -2116.4822389674787, 4470.835549801009, 531.6278763137427, -3006.6433246116467, -4426.401892853553, 1359.5012429474766, 3842.568496668559, 2077.789005936485, 249.93159572357487, -1007.2334882081318, -2453.8298714055168, 363.8011092185893, -740.8780626869623, 176.8285770349336, 935.7398068291736, -60.782471417697906, 8.008653144261459, 3215.528189924599, -2084.639427533619, -3461.768787957928, -1187.5110481884044, -309.06323326856904, 2280.4374212641032, 2234.2783476044233, -594.4122577266573, 172.11051370064143, -6496.526842280181, 2799.7373096361002, 26.387805795072342, 1249.3474802299527, 919.0064101431017, -3829.775254973766, -379.7846860761207, -1792.042036733088, -214.82241301294192, -3274.2881116932153, -2862.6691813175707, 4288.373721229145, 1025.406286847818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7040755314169955, "mean_inference_ms": 1.5256339536067944, "mean_action_processing_ms": 0.2837286173863392, "mean_env_wait_ms": 0.12921673831178104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007107734680175781, "StateBufferConnector_ms": 0.003939032554626465, "ViewRequirementAgentConnector_ms": 0.10284125804901123}, "num_episodes": 18, "episode_return_max": 1473.6325662569895, "episode_return_min": -1.7763568394002505e-14, "episode_return_mean": 134.04181960670857, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.8936292327222, "num_env_steps_trained_throughput_per_sec": 268.8936292327222, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 15069.343, "restore_workers_time_ms": 0.06, "training_step_time_ms": 15069.195, "sample_time_ms": 1236.39, "learn_time_ms": 13813.531, "learn_throughput": 289.571, "synch_weights_time_ms": 17.028}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "6751e_00000", "date": "2024-08-11_19-09-12", "timestamp": 1723417752, "time_this_iter_s": 14.892378091812134, "time_total_s": 120.9304187297821, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 120.9304187297821, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 50.12857142857142, "ram_util_percent": 83.1190476190476}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7344723736167584, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.934331227862646, "policy_loss": -0.0047600168819790555, "vf_loss": 9.93795805078335, "vf_explained_var": -0.0036244072611369784, "kl": 0.0056659384038615646, "entropy": 1.4725336385782433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7833677880820774, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.723190160781618, "policy_loss": -0.006722075001351417, "vf_loss": 9.728416962093776, "vf_explained_var": -0.0006109342057868917, "kl": 0.007476357641666752, "entropy": 1.4545711130692214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 1473.6325662569895, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 148.8944213500644, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5237.591955956592, "predator_policy": -6496.526842280181}, "policy_reward_max": {"prey_policy": 7445.237468938743, "predator_policy": 8104.130669461123}, "policy_reward_mean": {"prey_policy": 420.19244645443337, "predator_policy": -345.74523577940107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [568.1246113164705, 0.0, 348.1340661956843, 1146.8314119539136, 0.0, 107.88362560983404, 0.0, 0.0, 0.0, 1411.6931618768854, -8.881784197001252e-15, 0.0, 0.0, 0.0, 213.65369600902602, 0.0, 440.37763609771594, 3.552713678800501e-15, 369.76046722168593, 0.0, 0.0, 0.0, 1.4210854715202004e-14, -3.552713678800501e-15, 0.0, 0.0, 464.2949611492685, 7.105427357601002e-15, 113.05712045470615, 0.0, 0.0, -3.552713678800501e-15, 234.23071979297507, 1.7763568394002505e-15, 0.0, 102.84194704652732, 0.0, 0.0, 208.56039254043827, 3.552713678800501e-15, 0.0, 121.66506625948773, 243.99309258360017, 512.5310090520784, 130.7153480808605, -1.7763568394002505e-14, 0.0, -1.0658141036401503e-14, 1473.6325662569895, 2.1316282072803006e-14, -1.4210854715202004e-14, 0.0, 0.0, 0.0, -1.7763568394002505e-15, -1.4210854715202004e-14, 0.0, 0.0, -3.552713678800501e-15, 247.06461998555528, 201.76396347012167, 131.58932847650627, 371.6269689448641, 0.0, 321.48439015130134, 0.0, 258.3435732506671, 131.5390168782971, 0.0, 0.0, 0.0, 4.973799150320701e-14, 716.5452227622413, 0.0, -1.7763568394002505e-15, 0.0, 1.0658141036401503e-14, 1364.3912034182893, 0.0, 3.552713678800501e-15, 124.33686564731488, 221.56044186867064, 0.0, 268.91884186279447, 0.0, 929.0370759382049, 107.59798629111287, -3.552713678800501e-15, 3.552713678800501e-15, 0.0, 0.0, 368.8884212727414, -1.7763568394002505e-15, -2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 365.4260918384487, -7.105427357601002e-15, 0.0, 547.3472234511607], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1214.8327310767643, -277.8687935700318, 3061.9447363859495, -1684.8236185026017, 3933.1144088558563, -1173.191844533003, -1127.9103372846162, -2004.2221321843385, 2285.5462678411654, -1275.6863047587663, 2818.497183947956, 3365.4515169485558, 3026.458942768475, 1647.5693225774482, -228.63529656064898, 243.89660839032072, 61.182833648762454, -609.0797136016689, -904.695986590523, -1777.840718227192, 5417.297407179652, 1732.304282904876, 2553.6917755571994, 1392.1603998406486, 309.2536950893576, -592.4160321316776, 2964.328924054106, 741.146461879674, -2731.27538691107, -162.83008098775213, 1644.260256272356, 488.9874085546794, 1071.1577363703072, -501.26085656799523, 1431.2057256637172, -177.623018003053, -447.3798506983328, -2795.0596688592286, 3349.3906569587193, -1254.481334174801, -26.169957163101476, -2994.527952362024, 277.57830098319846, 3959.4916342221504, 5686.482140100691, 2598.7885191692867, 4210.300743056589, -1078.4077022524077, -2275.5042229542405, -3429.9133128144017, 4378.070657745053, -57.04763056826279, -2362.3996356622165, -1466.498358442278, 6847.521092455301, -2022.4158105494173, 5108.778547278185, 455.3200677203167, 4299.316176186349, 920.3591305530997, 2591.566384944486, -502.65996288467534, -1006.7631545559402, -1987.8752391213238, 1998.584031883239, -2212.802778818521, 3287.3932429565243, 1106.1837271451143, 2477.837563763059, -2949.9043594238124, 6253.566251783639, -2334.15142989847, 1947.9463955617255, -1921.8895741113542, 2726.5710309064048, 761.4602278395017, -1657.7844248067938, 919.2624754461647, 1638.5068355799147, -1619.5213885817584, 5820.690877970473, 56.432043164226684, 570.9672523300711, 47.401903977254825, -2087.369491253221, -2432.573943493584, 3086.500591958696, -2568.952325558581, -1382.1092014261028, -3064.9273864390448, 5091.809172765341, -615.7954610187985, 1351.728933615835, -3880.361865970923, -207.78054605460267, -3499.006562446458, -3843.953984803683, -3041.4235511002476, 4433.5433008886, -94.15632749190617, 5761.393158585513, 1247.9077181188868, 1635.2242852677973, -100.83828756571936, 466.6192722885574, -1129.8355206237652, 1496.992633233347, -2758.6195249016973, 3882.682633579395, 818.1438370948131, 4171.410409660316, 1546.8002275759077, 4430.636663183043, -4460.465381997898, 468.2263971245333, -225.68854752899054, 2116.4822389674787, -272.74987211020334, -2314.39455616753, -2441.004249961665, 4533.270090062573, 3101.5390908727486, -1446.4692330201826, -3624.0111781193423, -1437.5988908025925, -518.4947419126046, 5551.7243303823325, -2090.6609707686853, 791.8905931579172, -93.3292495382429, 42.70533877069866, -1155.2737226348052, 1567.557984485248, -1256.4405929611448, 2790.4178584963947, -3789.767604009078, 2629.7326032509955, 2019.5472328953372, 75.57803792086304, -2046.9522259163962, 1543.9322413953082, -3183.7983312730753, 7445.237468938743, -1120.8211403592024, 755.0644208065706, -2864.6443134755, -2092.6924297376722, -75.66146063538095, 3810.690622401099, 398.8693186487877, 1332.5541913914285, 674.3102583546021, 4372.100068057956, 1764.8572249528281, -1063.0922973713275, -2886.296507287343, 5109.20423661828, -1535.304785785905, 116.07281549920503, -752.5526973134656, 2041.9373488187164, -2478.456630365734, 5498.7104815206185, -1590.7206914050587, -172.21526235813815, 156.04964986046465, 2811.655803100025, -4081.3469381453356, 4473.4164611428705, -1900.7412320217206, 2444.2102336635526, -997.777509757495, 2694.4074407391004, 334.36747874863073, 289.091723931004, -866.3376230451023, 3646.25880662248, 591.3812178975396, 4473.857200904718, -2927.4358905796867, 5001.404403933703, -4507.875000657744, 795.4655344594911, -3604.7189269833198, -2771.026433794308, 749.4326276770626, -3396.7089571697684, 310.8875476675134, -182.53702161130133, -1644.1914222254306, 2175.3515774410794, -2526.958580731291, 440.9971566112609, -1718.5328531735088, 1800.3480108957585, 644.608993933508, 2409.427637643359, 658.8816120563131, -413.44847504870694, -5237.591955956592], "policy_predator_policy_reward": [826.0283433726167, 1234.7977925906503, -1738.4841912800434, 361.363073396695, -3933.1144088558563, 1521.3259107286872, 987.9123691744302, 3291.05151224844, -984.9637541895939, -24.896208892803365, -3128.494154948852, -2947.5709203378256, -3183.3121599034575, -1490.7161054424662, -470.78462300643605, 455.52331117676454, -112.68912029966847, 660.5860002525749, 1523.0115317733012, 2571.218334921297, -5024.807302084853, -2124.794387999677, -1760.6704163183426, -2185.1817590795054, 233.86938722241487, 49.2929498199043, -493.17313870838046, -3212.302247225399, 2448.7343441256653, 659.0248197821847, -2167.1685850387, 33.92092021166492, -185.32558767445192, 55.806343969855696, -1436.4225386977655, 182.83983103710136, 2495.327085186904, 1116.8729015923432, 28.488592321716073, -2123.397915105634, 3172.6535205265855, -151.9556110014596, -1759.9744718950806, -2477.0954633102715, -5556.103321006501, -2729.167338263475, 146.781367519576, -3278.674408323758, 2013.7677036435746, 3691.649832125067, -1251.6495429213571, -3069.373484255432, 2217.090489564346, 2076.102465689416, 684.3655669174526, -5509.470848823339, -3700.257637007462, -1750.783857536326, -1679.1284651565738, -3540.546841582875, -506.7468315375595, -1582.1595905222498, 1907.177515634122, 1087.460878043142, -570.5955371881736, 1019.0450039164285, -2107.093832071112, -2286.4831380305263, 1476.764503631145, -1004.6977079703929, 2202.734271306158, -6019.307146144798, -1979.0671583885057, 1953.0103369381345, 659.5841143545649, -4147.615373100469, -250.33391571138952, 1197.416257612456, 290.5332405378293, -309.5186875359859, -1132.1843230561587, -4744.938598078542, 1226.8541338022874, -1723.5582238501258, 0.0, 4763.936527330402, -3008.342153239962, 3003.324895891926, 2923.5023938156287, 1654.2495421303781, -5091.809172765341, 615.7954610187985, 3283.4597983594663, -754.826866004377, 3393.1949373278935, 313.59217117316643, 8104.130669461123, 254.87943269979849, 94.15632749190617, -4433.5433008886, -1964.6848543111007, -5044.6160223932975, -1398.881312170347, -135.5046855317308, -236.76834998642667, 899.9845983216337, 2686.931641767326, -1425.304750098976, 89.02320129632902, -4789.849671970536, -1546.8002275759077, -4171.410409660316, -411.7733310448271, 441.60204985967977, 0.0, -242.5378495955448, 272.74987211020334, -2116.4822389674787, 4470.835549801009, 531.6278763137427, -3006.6433246116467, -4426.401892853553, 1359.5012429474766, 3842.568496668559, 2077.789005936485, 249.93159572357487, -1007.2334882081318, -2453.8298714055168, 363.8011092185893, -740.8780626869623, 176.8285770349336, 935.7398068291736, -60.782471417697906, 8.008653144261459, 3215.528189924599, -2084.639427533619, -3461.768787957928, -1187.5110481884044, -309.06323326856904, 2280.4374212641032, 2234.2783476044233, -594.4122577266573, 172.11051370064143, -6496.526842280181, 2799.7373096361002, 26.387805795072342, 1249.3474802299527, 919.0064101431017, -3829.775254973766, -379.7846860761207, -1792.042036733088, -214.82241301294192, -3274.2881116932153, -2862.6691813175707, 4288.373721229145, 1025.406286847818, 163.80349755975178, -3737.7029483921233, 635.4457993236999, 1.0340824905605146, -2020.0767605691124, 2580.932907763445, -4367.2280708200915, 680.7987225732044, -525.4353369892552, 541.600949486928, -2335.1243359468567, 3873.7343128549637, -3120.1556509425645, 547.4804218214123, -1667.74522577704, 1150.3495778091883, -1015.2659768080957, -1905.910956388523, -742.9193769929216, 1320.1652761070186, -2958.21042419193, -1279.429600328088, -1795.43717768187, 249.01586735683549, -1401.7067411601186, 908.1773378841583, 1705.6985549570275, 1472.4432588395434, 387.6422503783192, 1633.9515557389261, -155.68295143050284, 3241.504360932758, 1191.0391836685994, 635.6892601681333, 1478.3175481415567, -1126.7105448513446, 1279.656957939506, 363.304830461191, -1133.0989824470405, -1311.858022382227, -142.56647353757262, -2925.7427761620993, 520.2705918327055, 5678.117062623755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6971778195507506, "mean_inference_ms": 1.5144289919267373, "mean_action_processing_ms": 0.28055950678266134, "mean_env_wait_ms": 0.12873483089945548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006617903709411621, "StateBufferConnector_ms": 0.0046634674072265625, "ViewRequirementAgentConnector_ms": 0.10812604427337646}, "num_episodes": 22, "episode_return_max": 1473.6325662569895, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 148.8944213500644, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.7141190307175, "num_env_steps_trained_throughput_per_sec": 289.7141190307175, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 14929.052, "restore_workers_time_ms": 0.055, "training_step_time_ms": 14928.914, "sample_time_ms": 1223.929, "learn_time_ms": 13685.878, "learn_throughput": 292.272, "synch_weights_time_ms": 17.027}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "6751e_00000", "date": "2024-08-11_19-09-26", "timestamp": 1723417766, "time_this_iter_s": 13.879520893096924, "time_total_s": 134.80993962287903, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16e9cb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 134.80993962287903, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 48.74499999999999, "ram_util_percent": 83.13000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7448781005131504, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.954180557513363, "policy_loss": -0.003888879236691291, "vf_loss": 9.956920756486358, "vf_explained_var": -0.003426572223189016, "kl": 0.005743380649518874, "entropy": 1.4759051094610225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7398523901978498, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.592416116926405, "policy_loss": -0.0069640152824047225, "vf_loss": 9.597492785680862, "vf_explained_var": -0.0001961198433366402, "kl": 0.009436784368494293, "entropy": 1.424045581477029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 2343.853489883908, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 198.70358879344937, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5237.591955956592, "predator_policy": -6496.526842280181}, "policy_reward_max": {"prey_policy": 7445.237468938743, "predator_policy": 8104.130669461123}, "policy_reward_mean": {"prey_policy": 350.0477690495424, "predator_policy": -250.6959746528177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.552713678800501e-15, 0.0, 0.0, 464.2949611492685, 7.105427357601002e-15, 113.05712045470615, 0.0, 0.0, -3.552713678800501e-15, 234.23071979297507, 1.7763568394002505e-15, 0.0, 102.84194704652732, 0.0, 0.0, 208.56039254043827, 3.552713678800501e-15, 0.0, 121.66506625948773, 243.99309258360017, 512.5310090520784, 130.7153480808605, -1.7763568394002505e-14, 0.0, -1.0658141036401503e-14, 1473.6325662569895, 2.1316282072803006e-14, -1.4210854715202004e-14, 0.0, 0.0, 0.0, -1.7763568394002505e-15, -1.4210854715202004e-14, 0.0, 0.0, -3.552713678800501e-15, 247.06461998555528, 201.76396347012167, 131.58932847650627, 371.6269689448641, 0.0, 321.48439015130134, 0.0, 258.3435732506671, 131.5390168782971, 0.0, 0.0, 0.0, 4.973799150320701e-14, 716.5452227622413, 0.0, -1.7763568394002505e-15, 0.0, 1.0658141036401503e-14, 1364.3912034182893, 0.0, 3.552713678800501e-15, 124.33686564731488, 221.56044186867064, 0.0, 268.91884186279447, 0.0, 929.0370759382049, 107.59798629111287, -3.552713678800501e-15, 3.552713678800501e-15, 0.0, 0.0, 368.8884212727414, -1.7763568394002505e-15, -2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 365.4260918384487, -7.105427357601002e-15, 0.0, 547.3472234511607, 123.64740241070248, 2343.853489883908, 1134.7489212662638, -1.7763568394002505e-14, 581.5074890394021, -7.105427357601002e-15, 0.0, 0.0, 241.89515985071648, 533.3008536029321, 0.0, 544.9977485588237, 337.28912451132044, 832.8913588446333, 0.0, -1.7763568394002505e-14, 241.1688632477546, 1.7763568394002505e-15, 220.72130147668534, 1.0658141036401503e-14, 0.0, 115.22343148883509, 2336.130276437741], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4210.300743056589, -1078.4077022524077, -2275.5042229542405, -3429.9133128144017, 4378.070657745053, -57.04763056826279, -2362.3996356622165, -1466.498358442278, 6847.521092455301, -2022.4158105494173, 5108.778547278185, 455.3200677203167, 4299.316176186349, 920.3591305530997, 2591.566384944486, -502.65996288467534, -1006.7631545559402, -1987.8752391213238, 1998.584031883239, -2212.802778818521, 3287.3932429565243, 1106.1837271451143, 2477.837563763059, -2949.9043594238124, 6253.566251783639, -2334.15142989847, 1947.9463955617255, -1921.8895741113542, 2726.5710309064048, 761.4602278395017, -1657.7844248067938, 919.2624754461647, 1638.5068355799147, -1619.5213885817584, 5820.690877970473, 56.432043164226684, 570.9672523300711, 47.401903977254825, -2087.369491253221, -2432.573943493584, 3086.500591958696, -2568.952325558581, -1382.1092014261028, -3064.9273864390448, 5091.809172765341, -615.7954610187985, 1351.728933615835, -3880.361865970923, -207.78054605460267, -3499.006562446458, -3843.953984803683, -3041.4235511002476, 4433.5433008886, -94.15632749190617, 5761.393158585513, 1247.9077181188868, 1635.2242852677973, -100.83828756571936, 466.6192722885574, -1129.8355206237652, 1496.992633233347, -2758.6195249016973, 3882.682633579395, 818.1438370948131, 4171.410409660316, 1546.8002275759077, 4430.636663183043, -4460.465381997898, 468.2263971245333, -225.68854752899054, 2116.4822389674787, -272.74987211020334, -2314.39455616753, -2441.004249961665, 4533.270090062573, 3101.5390908727486, -1446.4692330201826, -3624.0111781193423, -1437.5988908025925, -518.4947419126046, 5551.7243303823325, -2090.6609707686853, 791.8905931579172, -93.3292495382429, 42.70533877069866, -1155.2737226348052, 1567.557984485248, -1256.4405929611448, 2790.4178584963947, -3789.767604009078, 2629.7326032509955, 2019.5472328953372, 75.57803792086304, -2046.9522259163962, 1543.9322413953082, -3183.7983312730753, 7445.237468938743, -1120.8211403592024, 755.0644208065706, -2864.6443134755, -2092.6924297376722, -75.66146063538095, 3810.690622401099, 398.8693186487877, 1332.5541913914285, 674.3102583546021, 4372.100068057956, 1764.8572249528281, -1063.0922973713275, -2886.296507287343, 5109.20423661828, -1535.304785785905, 116.07281549920503, -752.5526973134656, 2041.9373488187164, -2478.456630365734, 5498.7104815206185, -1590.7206914050587, -172.21526235813815, 156.04964986046465, 2811.655803100025, -4081.3469381453356, 4473.4164611428705, -1900.7412320217206, 2444.2102336635526, -997.777509757495, 2694.4074407391004, 334.36747874863073, 289.091723931004, -866.3376230451023, 3646.25880662248, 591.3812178975396, 4473.857200904718, -2927.4358905796867, 5001.404403933703, -4507.875000657744, 795.4655344594911, -3604.7189269833198, -2771.026433794308, 749.4326276770626, -3396.7089571697684, 310.8875476675134, -182.53702161130133, -1644.1914222254306, 2175.3515774410794, -2526.958580731291, 440.9971566112609, -1718.5328531735088, 1800.3480108957585, 644.608993933508, 2409.427637643359, 658.8816120563131, -413.44847504870694, -5237.591955956592, 1846.0077317303378, -2496.456653194377, -482.5360018058527, -3052.9182240283594, 33.28550115131372, -2745.7717643157434, 4731.982056775364, -599.6815865399038, 4898.000063583629, -2735.7753549481235, -911.8560831192625, -284.7675444344951, 2784.193051644749, -2270.561581505083, 4918.343783182949, -1261.7872738081644, 3213.5061869071815, -2345.0422785311366, -263.63250234843156, -2105.596318119303, 1612.0246131424012, 889.2320419715007, 1059.726800255903, -1069.0572441752036, 6088.5704892582835, -901.2828449385662, -1846.4102601124941, -4715.717307033183, 3640.135553934737, -705.0229477115003, 2488.21079238162, 329.8831916444699, 2101.4526440224618, -821.3104122936729, 7186.004875833017, -1576.0207578470972, 1753.9363006252945, 358.83900797676233, 352.68363666339263, -2264.8967172478406, 529.5758493690174, -3327.392212829445, 2332.470507364528, -1049.246874027532, 6997.651448503223, -2242.5353325696337], "policy_predator_policy_reward": [146.781367519576, -3278.674408323758, 2013.7677036435746, 3691.649832125067, -1251.6495429213571, -3069.373484255432, 2217.090489564346, 2076.102465689416, 684.3655669174526, -5509.470848823339, -3700.257637007462, -1750.783857536326, -1679.1284651565738, -3540.546841582875, -506.7468315375595, -1582.1595905222498, 1907.177515634122, 1087.460878043142, -570.5955371881736, 1019.0450039164285, -2107.093832071112, -2286.4831380305263, 1476.764503631145, -1004.6977079703929, 2202.734271306158, -6019.307146144798, -1979.0671583885057, 1953.0103369381345, 659.5841143545649, -4147.615373100469, -250.33391571138952, 1197.416257612456, 290.5332405378293, -309.5186875359859, -1132.1843230561587, -4744.938598078542, 1226.8541338022874, -1723.5582238501258, 0.0, 4763.936527330402, -3008.342153239962, 3003.324895891926, 2923.5023938156287, 1654.2495421303781, -5091.809172765341, 615.7954610187985, 3283.4597983594663, -754.826866004377, 3393.1949373278935, 313.59217117316643, 8104.130669461123, 254.87943269979849, 94.15632749190617, -4433.5433008886, -1964.6848543111007, -5044.6160223932975, -1398.881312170347, -135.5046855317308, -236.76834998642667, 899.9845983216337, 2686.931641767326, -1425.304750098976, 89.02320129632902, -4789.849671970536, -1546.8002275759077, -4171.410409660316, -411.7733310448271, 441.60204985967977, 0.0, -242.5378495955448, 272.74987211020334, -2116.4822389674787, 4470.835549801009, 531.6278763137427, -3006.6433246116467, -4426.401892853553, 1359.5012429474766, 3842.568496668559, 2077.789005936485, 249.93159572357487, -1007.2334882081318, -2453.8298714055168, 363.8011092185893, -740.8780626869623, 176.8285770349336, 935.7398068291736, -60.782471417697906, 8.008653144261459, 3215.528189924599, -2084.639427533619, -3461.768787957928, -1187.5110481884044, -309.06323326856904, 2280.4374212641032, 2234.2783476044233, -594.4122577266573, 172.11051370064143, -6496.526842280181, 2799.7373096361002, 26.387805795072342, 1249.3474802299527, 919.0064101431017, -3829.775254973766, -379.7846860761207, -1792.042036733088, -214.82241301294192, -3274.2881116932153, -2862.6691813175707, 4288.373721229145, 1025.406286847818, 163.80349755975178, -3737.7029483921233, 635.4457993236999, 1.0340824905605146, -2020.0767605691124, 2580.932907763445, -4367.2280708200915, 680.7987225732044, -525.4353369892552, 541.600949486928, -2335.1243359468567, 3873.7343128549637, -3120.1556509425645, 547.4804218214123, -1667.74522577704, 1150.3495778091883, -1015.2659768080957, -1905.910956388523, -742.9193769929216, 1320.1652761070186, -2958.21042419193, -1279.429600328088, -1795.43717768187, 249.01586735683549, -1401.7067411601186, 908.1773378841583, 1705.6985549570275, 1472.4432588395434, 387.6422503783192, 1633.9515557389261, -155.68295143050284, 3241.504360932758, 1191.0391836685994, 635.6892601681333, 1478.3175481415567, -1126.7105448513446, 1279.656957939506, 363.304830461191, -1133.0989824470405, -1311.858022382227, -142.56647353757262, -2925.7427761620993, 520.2705918327055, 5678.117062623755, 297.4070590614471, 476.68926481329515, 5781.525781892327, 97.78193382579946, 3194.0247389549577, 653.2104454757348, -1606.3755707229634, -2525.924899512497, 1402.087062721149, -2982.804282317257, -160.2007150333407, 1356.8243425870985, 1181.76856580016, -1695.4000359398244, -3639.527847217959, -17.028662156831857, -2966.645424367443, 2340.076675842113, 3335.122782922777, -432.5931088521102, -527.6573430341101, -1973.5993120797898, 433.0082320100708, 121.31996046805331, -5935.799752819452, 1085.8012330110555, 1775.9696319050252, 5619.049294085285, -1641.039635727265, -1294.0729704959688, -1164.7898627193038, -1653.3041213067847, 1906.2933034679152, -2945.2666719489484, -6495.701839827442, 885.7177218415253, -1224.568835340517, -667.4851717848535, 2237.9241160642014, -325.71103547975287, -404.9142846490549, 3202.730648109482, -261.9094456978003, -906.0907561503609, 847.6115043777216, -3266.5973438735755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6930080806028058, "mean_inference_ms": 1.5054748755228708, "mean_action_processing_ms": 0.2793512061661328, "mean_env_wait_ms": 0.12845397646576404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004248261451721191, "StateBufferConnector_ms": 0.004750490188598633, "ViewRequirementAgentConnector_ms": 0.12043488025665283}, "num_episodes": 23, "episode_return_max": 2343.853489883908, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 198.70358879344937, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.79101835318244, "num_env_steps_trained_throughput_per_sec": 271.79101835318244, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 14907.866, "restore_workers_time_ms": 0.051, "training_step_time_ms": 14907.739, "sample_time_ms": 1206.676, "learn_time_ms": 13682.454, "learn_throughput": 292.345, "synch_weights_time_ms": 16.633}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "6751e_00000", "date": "2024-08-11_19-09-40", "timestamp": 1723417780, "time_this_iter_s": 14.78731083869934, "time_total_s": 149.59725046157837, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 149.59725046157837, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 49.36666666666667, "ram_util_percent": 83.05714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7280200826427924, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.954626114658577, "policy_loss": -0.004414945214410268, "vf_loss": 9.957783234813226, "vf_explained_var": -0.0002249310887049115, "kl": 0.006289033759283439, "entropy": 1.4876591872285914, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6791642925568989, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.766404522789848, "policy_loss": -0.006120714336811077, "vf_loss": 9.770929233106987, "vf_explained_var": -7.813569729921048e-06, "kl": 0.007979962295552055, "entropy": 1.422690316987416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 2388.842838236041, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 302.9069288458431, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5237.591955956592, "predator_policy": -6496.526842280181}, "policy_reward_max": {"prey_policy": 7445.237468938743, "predator_policy": 8104.130669461123}, "policy_reward_mean": {"prey_policy": 24.613172006402255, "predator_policy": 126.84029241651925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [121.66506625948773, 243.99309258360017, 512.5310090520784, 130.7153480808605, -1.7763568394002505e-14, 0.0, -1.0658141036401503e-14, 1473.6325662569895, 2.1316282072803006e-14, -1.4210854715202004e-14, 0.0, 0.0, 0.0, -1.7763568394002505e-15, -1.4210854715202004e-14, 0.0, 0.0, -3.552713678800501e-15, 247.06461998555528, 201.76396347012167, 131.58932847650627, 371.6269689448641, 0.0, 321.48439015130134, 0.0, 258.3435732506671, 131.5390168782971, 0.0, 0.0, 0.0, 4.973799150320701e-14, 716.5452227622413, 0.0, -1.7763568394002505e-15, 0.0, 1.0658141036401503e-14, 1364.3912034182893, 0.0, 3.552713678800501e-15, 124.33686564731488, 221.56044186867064, 0.0, 268.91884186279447, 0.0, 929.0370759382049, 107.59798629111287, -3.552713678800501e-15, 3.552713678800501e-15, 0.0, 0.0, 368.8884212727414, -1.7763568394002505e-15, -2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 365.4260918384487, -7.105427357601002e-15, 0.0, 547.3472234511607, 123.64740241070248, 2343.853489883908, 1134.7489212662638, -1.7763568394002505e-14, 581.5074890394021, -7.105427357601002e-15, 0.0, 0.0, 241.89515985071648, 533.3008536029321, 0.0, 544.9977485588237, 337.28912451132044, 832.8913588446333, 0.0, -1.7763568394002505e-14, 241.1688632477546, 1.7763568394002505e-15, 220.72130147668534, 1.0658141036401503e-14, 0.0, 115.22343148883509, 2336.130276437741, 2388.842838236041, 597.1122568071919, 0.0, 498.023083244723, 893.2171250463045, 139.67748246725702, 1739.5052424512467, 513.9502304766447, 245.63825547724213, 1102.3409499322984, 0.0, 400.13458899633014, 4.263256414560601e-14, 301.10095697862954, 1868.992352742336, 0.0, 139.25995293929662, 715.5238304277416], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [570.9672523300711, 47.401903977254825, -2087.369491253221, -2432.573943493584, 3086.500591958696, -2568.952325558581, -1382.1092014261028, -3064.9273864390448, 5091.809172765341, -615.7954610187985, 1351.728933615835, -3880.361865970923, -207.78054605460267, -3499.006562446458, -3843.953984803683, -3041.4235511002476, 4433.5433008886, -94.15632749190617, 5761.393158585513, 1247.9077181188868, 1635.2242852677973, -100.83828756571936, 466.6192722885574, -1129.8355206237652, 1496.992633233347, -2758.6195249016973, 3882.682633579395, 818.1438370948131, 4171.410409660316, 1546.8002275759077, 4430.636663183043, -4460.465381997898, 468.2263971245333, -225.68854752899054, 2116.4822389674787, -272.74987211020334, -2314.39455616753, -2441.004249961665, 4533.270090062573, 3101.5390908727486, -1446.4692330201826, -3624.0111781193423, -1437.5988908025925, -518.4947419126046, 5551.7243303823325, -2090.6609707686853, 791.8905931579172, -93.3292495382429, 42.70533877069866, -1155.2737226348052, 1567.557984485248, -1256.4405929611448, 2790.4178584963947, -3789.767604009078, 2629.7326032509955, 2019.5472328953372, 75.57803792086304, -2046.9522259163962, 1543.9322413953082, -3183.7983312730753, 7445.237468938743, -1120.8211403592024, 755.0644208065706, -2864.6443134755, -2092.6924297376722, -75.66146063538095, 3810.690622401099, 398.8693186487877, 1332.5541913914285, 674.3102583546021, 4372.100068057956, 1764.8572249528281, -1063.0922973713275, -2886.296507287343, 5109.20423661828, -1535.304785785905, 116.07281549920503, -752.5526973134656, 2041.9373488187164, -2478.456630365734, 5498.7104815206185, -1590.7206914050587, -172.21526235813815, 156.04964986046465, 2811.655803100025, -4081.3469381453356, 4473.4164611428705, -1900.7412320217206, 2444.2102336635526, -997.777509757495, 2694.4074407391004, 334.36747874863073, 289.091723931004, -866.3376230451023, 3646.25880662248, 591.3812178975396, 4473.857200904718, -2927.4358905796867, 5001.404403933703, -4507.875000657744, 795.4655344594911, -3604.7189269833198, -2771.026433794308, 749.4326276770626, -3396.7089571697684, 310.8875476675134, -182.53702161130133, -1644.1914222254306, 2175.3515774410794, -2526.958580731291, 440.9971566112609, -1718.5328531735088, 1800.3480108957585, 644.608993933508, 2409.427637643359, 658.8816120563131, -413.44847504870694, -5237.591955956592, 1846.0077317303378, -2496.456653194377, -482.5360018058527, -3052.9182240283594, 33.28550115131372, -2745.7717643157434, 4731.982056775364, -599.6815865399038, 4898.000063583629, -2735.7753549481235, -911.8560831192625, -284.7675444344951, 2784.193051644749, -2270.561581505083, 4918.343783182949, -1261.7872738081644, 3213.5061869071815, -2345.0422785311366, -263.63250234843156, -2105.596318119303, 1612.0246131424012, 889.2320419715007, 1059.726800255903, -1069.0572441752036, 6088.5704892582835, -901.2828449385662, -1846.4102601124941, -4715.717307033183, 3640.135553934737, -705.0229477115003, 2488.21079238162, 329.8831916444699, 2101.4526440224618, -821.3104122936729, 7186.004875833017, -1576.0207578470972, 1753.9363006252945, 358.83900797676233, 352.68363666339263, -2264.8967172478406, 529.5758493690174, -3327.392212829445, 2332.470507364528, -1049.246874027532, 6997.651448503223, -2242.5353325696337, 1860.0830513568742, -1570.1887265861392, -5074.393971051909, -147.25431328119214, 586.4301667428667, -1685.3861111055219, 3879.452675474817, -2240.614580233271, -3828.2771155312194, -1084.1798143132314, 5585.393436910543, -5192.944589651446, 5807.988593084739, -2069.580349448641, 4848.517878713533, -3224.7443694006165, 1232.7579748068463, -4106.728914897292, -2509.743553060434, -2681.589724965619, 1480.933184880956, -4139.232924265004, -1161.3557115495282, -3885.813338105179, -2369.0345285523654, -3638.561823564958, -249.4429357949048, -2984.9938611274665, -1923.6579272241622, -1335.264719718036, 3573.706824711205, -2971.6470737999266, 1647.4317137173068, -3766.518558744494, -1019.0760370849722, -1809.2608174766856], "policy_predator_policy_reward": [1226.8541338022874, -1723.5582238501258, 0.0, 4763.936527330402, -3008.342153239962, 3003.324895891926, 2923.5023938156287, 1654.2495421303781, -5091.809172765341, 615.7954610187985, 3283.4597983594663, -754.826866004377, 3393.1949373278935, 313.59217117316643, 8104.130669461123, 254.87943269979849, 94.15632749190617, -4433.5433008886, -1964.6848543111007, -5044.6160223932975, -1398.881312170347, -135.5046855317308, -236.76834998642667, 899.9845983216337, 2686.931641767326, -1425.304750098976, 89.02320129632902, -4789.849671970536, -1546.8002275759077, -4171.410409660316, -411.7733310448271, 441.60204985967977, 0.0, -242.5378495955448, 272.74987211020334, -2116.4822389674787, 4470.835549801009, 531.6278763137427, -3006.6433246116467, -4426.401892853553, 1359.5012429474766, 3842.568496668559, 2077.789005936485, 249.93159572357487, -1007.2334882081318, -2453.8298714055168, 363.8011092185893, -740.8780626869623, 176.8285770349336, 935.7398068291736, -60.782471417697906, 8.008653144261459, 3215.528189924599, -2084.639427533619, -3461.768787957928, -1187.5110481884044, -309.06323326856904, 2280.4374212641032, 2234.2783476044233, -594.4122577266573, 172.11051370064143, -6496.526842280181, 2799.7373096361002, 26.387805795072342, 1249.3474802299527, 919.0064101431017, -3829.775254973766, -379.7846860761207, -1792.042036733088, -214.82241301294192, -3274.2881116932153, -2862.6691813175707, 4288.373721229145, 1025.406286847818, 163.80349755975178, -3737.7029483921233, 635.4457993236999, 1.0340824905605146, -2020.0767605691124, 2580.932907763445, -4367.2280708200915, 680.7987225732044, -525.4353369892552, 541.600949486928, -2335.1243359468567, 3873.7343128549637, -3120.1556509425645, 547.4804218214123, -1667.74522577704, 1150.3495778091883, -1015.2659768080957, -1905.910956388523, -742.9193769929216, 1320.1652761070186, -2958.21042419193, -1279.429600328088, -1795.43717768187, 249.01586735683549, -1401.7067411601186, 908.1773378841583, 1705.6985549570275, 1472.4432588395434, 387.6422503783192, 1633.9515557389261, -155.68295143050284, 3241.504360932758, 1191.0391836685994, 635.6892601681333, 1478.3175481415567, -1126.7105448513446, 1279.656957939506, 363.304830461191, -1133.0989824470405, -1311.858022382227, -142.56647353757262, -2925.7427761620993, 520.2705918327055, 5678.117062623755, 297.4070590614471, 476.68926481329515, 5781.525781892327, 97.78193382579946, 3194.0247389549577, 653.2104454757348, -1606.3755707229634, -2525.924899512497, 1402.087062721149, -2982.804282317257, -160.2007150333407, 1356.8243425870985, 1181.76856580016, -1695.4000359398244, -3639.527847217959, -17.028662156831857, -2966.645424367443, 2340.076675842113, 3335.122782922777, -432.5931088521102, -527.6573430341101, -1973.5993120797898, 433.0082320100708, 121.31996046805331, -5935.799752819452, 1085.8012330110555, 1775.9696319050252, 5619.049294085285, -1641.039635727265, -1294.0729704959688, -1164.7898627193038, -1653.3041213067847, 1906.2933034679152, -2945.2666719489484, -6495.701839827442, 885.7177218415253, -1224.568835340517, -667.4851717848535, 2237.9241160642014, -325.71103547975287, -404.9142846490549, 3202.730648109482, -261.9094456978003, -906.0907561503609, 847.6115043777216, -3266.5973438735755, 981.3169358782243, 1117.6315775870814, 237.12783153476695, 5581.632709605525, -171.58374229692996, 1270.5396866595845, -3281.713299478916, 2140.898287482093, 3458.2792116550563, 2347.3948432356974, -3001.7059949554778, 2748.9346301636397, -3010.47624391436, 1011.5732427295079, -39.635756401016664, -1070.1875224352568, 2575.6465646694855, 543.9626308981998, 2393.4859760172917, 3900.188251941057, 3203.419697340731, -545.1199579566824, 3608.3596114364836, 1838.9440272145534, 3054.7539345692803, 2952.842417548045, 4232.566023935325, -697.0282700343223, 4105.113333958951, 1022.8016657255811, 2770.7292558437525, -3372.78900675503, -564.3202032741168, 2822.6670012406, 579.8976721187368, 2963.963012870662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6918945157130372, "mean_inference_ms": 1.5026054471826038, "mean_action_processing_ms": 0.27885108599916597, "mean_env_wait_ms": 0.12812418554295457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004242897033691406, "StateBufferConnector_ms": 0.004485487937927246, "ViewRequirementAgentConnector_ms": 0.12015533447265625}, "num_episodes": 18, "episode_return_max": 2388.842838236041, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 302.9069288458431, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.81231045229487, "num_env_steps_trained_throughput_per_sec": 277.81231045229487, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 14804.796, "restore_workers_time_ms": 0.05, "training_step_time_ms": 14804.672, "sample_time_ms": 1196.104, "learn_time_ms": 13589.702, "learn_throughput": 294.341, "synch_weights_time_ms": 16.695}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "6751e_00000", "date": "2024-08-11_19-09-55", "timestamp": 1723417795, "time_this_iter_s": 14.479570865631104, "time_total_s": 164.07682132720947, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 164.07682132720947, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.80499999999999, "ram_util_percent": 83.21000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.702035048399022, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.980154268577616, "policy_loss": -0.007555270469846036, "vf_loss": 9.98601041319509, "vf_explained_var": 0.0019673144375836407, "kl": 0.00849566244825724, "entropy": 1.4815295171485376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7680277221417301, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.548996390489043, "policy_loss": -0.0074608503502088955, "vf_loss": 9.554277725320645, "vf_explained_var": 0.0001908842848722266, "kl": 0.010897625467772773, "entropy": 1.4008008679384907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 2388.842838236041, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 324.9008958894312, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5237.591955956592, "predator_policy": -6496.526842280181}, "policy_reward_max": {"prey_policy": 7445.237468938743, "predator_policy": 5781.525781892327}, "policy_reward_mean": {"prey_policy": -149.97934168879544, "predator_policy": 312.429789633511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [247.06461998555528, 201.76396347012167, 131.58932847650627, 371.6269689448641, 0.0, 321.48439015130134, 0.0, 258.3435732506671, 131.5390168782971, 0.0, 0.0, 0.0, 4.973799150320701e-14, 716.5452227622413, 0.0, -1.7763568394002505e-15, 0.0, 1.0658141036401503e-14, 1364.3912034182893, 0.0, 3.552713678800501e-15, 124.33686564731488, 221.56044186867064, 0.0, 268.91884186279447, 0.0, 929.0370759382049, 107.59798629111287, -3.552713678800501e-15, 3.552713678800501e-15, 0.0, 0.0, 368.8884212727414, -1.7763568394002505e-15, -2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 365.4260918384487, -7.105427357601002e-15, 0.0, 547.3472234511607, 123.64740241070248, 2343.853489883908, 1134.7489212662638, -1.7763568394002505e-14, 581.5074890394021, -7.105427357601002e-15, 0.0, 0.0, 241.89515985071648, 533.3008536029321, 0.0, 544.9977485588237, 337.28912451132044, 832.8913588446333, 0.0, -1.7763568394002505e-14, 241.1688632477546, 1.7763568394002505e-15, 220.72130147668534, 1.0658141036401503e-14, 0.0, 115.22343148883509, 2336.130276437741, 2388.842838236041, 597.1122568071919, 0.0, 498.023083244723, 893.2171250463045, 139.67748246725702, 1739.5052424512467, 513.9502304766447, 245.63825547724213, 1102.3409499322984, 0.0, 400.13458899633014, 4.263256414560601e-14, 301.10095697862954, 1868.992352742336, 0.0, 139.25995293929662, 715.5238304277416, 138.26145261132191, 525.9035025706462, 103.3089928714259, 0.0, 128.12031408282792, 653.9148375922613, 0.0, 0.0, -7.105427357601002e-15, 7.105427357601002e-15, 325.01704062353514, -1.4210854715202004e-14, 306.43063808811706, 0.0, 681.2768342479853, 561.3487464492955, -1.4210854715202004e-14, 1258.3514274544054], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2314.39455616753, -2441.004249961665, 4533.270090062573, 3101.5390908727486, -1446.4692330201826, -3624.0111781193423, -1437.5988908025925, -518.4947419126046, 5551.7243303823325, -2090.6609707686853, 791.8905931579172, -93.3292495382429, 42.70533877069866, -1155.2737226348052, 1567.557984485248, -1256.4405929611448, 2790.4178584963947, -3789.767604009078, 2629.7326032509955, 2019.5472328953372, 75.57803792086304, -2046.9522259163962, 1543.9322413953082, -3183.7983312730753, 7445.237468938743, -1120.8211403592024, 755.0644208065706, -2864.6443134755, -2092.6924297376722, -75.66146063538095, 3810.690622401099, 398.8693186487877, 1332.5541913914285, 674.3102583546021, 4372.100068057956, 1764.8572249528281, -1063.0922973713275, -2886.296507287343, 5109.20423661828, -1535.304785785905, 116.07281549920503, -752.5526973134656, 2041.9373488187164, -2478.456630365734, 5498.7104815206185, -1590.7206914050587, -172.21526235813815, 156.04964986046465, 2811.655803100025, -4081.3469381453356, 4473.4164611428705, -1900.7412320217206, 2444.2102336635526, -997.777509757495, 2694.4074407391004, 334.36747874863073, 289.091723931004, -866.3376230451023, 3646.25880662248, 591.3812178975396, 4473.857200904718, -2927.4358905796867, 5001.404403933703, -4507.875000657744, 795.4655344594911, -3604.7189269833198, -2771.026433794308, 749.4326276770626, -3396.7089571697684, 310.8875476675134, -182.53702161130133, -1644.1914222254306, 2175.3515774410794, -2526.958580731291, 440.9971566112609, -1718.5328531735088, 1800.3480108957585, 644.608993933508, 2409.427637643359, 658.8816120563131, -413.44847504870694, -5237.591955956592, 1846.0077317303378, -2496.456653194377, -482.5360018058527, -3052.9182240283594, 33.28550115131372, -2745.7717643157434, 4731.982056775364, -599.6815865399038, 4898.000063583629, -2735.7753549481235, -911.8560831192625, -284.7675444344951, 2784.193051644749, -2270.561581505083, 4918.343783182949, -1261.7872738081644, 3213.5061869071815, -2345.0422785311366, -263.63250234843156, -2105.596318119303, 1612.0246131424012, 889.2320419715007, 1059.726800255903, -1069.0572441752036, 6088.5704892582835, -901.2828449385662, -1846.4102601124941, -4715.717307033183, 3640.135553934737, -705.0229477115003, 2488.21079238162, 329.8831916444699, 2101.4526440224618, -821.3104122936729, 7186.004875833017, -1576.0207578470972, 1753.9363006252945, 358.83900797676233, 352.68363666339263, -2264.8967172478406, 529.5758493690174, -3327.392212829445, 2332.470507364528, -1049.246874027532, 6997.651448503223, -2242.5353325696337, 1860.0830513568742, -1570.1887265861392, -5074.393971051909, -147.25431328119214, 586.4301667428667, -1685.3861111055219, 3879.452675474817, -2240.614580233271, -3828.2771155312194, -1084.1798143132314, 5585.393436910543, -5192.944589651446, 5807.988593084739, -2069.580349448641, 4848.517878713533, -3224.7443694006165, 1232.7579748068463, -4106.728914897292, -2509.743553060434, -2681.589724965619, 1480.933184880956, -4139.232924265004, -1161.3557115495282, -3885.813338105179, -2369.0345285523654, -3638.561823564958, -249.4429357949048, -2984.9938611274665, -1923.6579272241622, -1335.264719718036, 3573.706824711205, -2971.6470737999266, 1647.4317137173068, -3766.518558744494, -1019.0760370849722, -1809.2608174766856, -1622.570516369032, -4467.523307583886, 5340.339191183722, -2394.529610629216, 1992.2453631594517, -3711.3623006701014, 3709.6167575389663, -3182.4552958734052, -4094.161332172997, -3964.646799822161, 246.54083074746376, -2959.9871215852463, 810.8790192294862, -505.8126992383416, 821.8959003212701, -1609.9657561916194, -888.912904651597, -1262.5843238625844, 2611.8638337259445, -2702.1212266161738, 259.35482183004154, -1410.3531135657715, 2850.9064189448413, -4370.317924641834, 3064.511372743855, -37.5816827829315, 3407.4840513077565, -4899.962881130136, 794.3926968109638, -1036.4031376777407, 2489.9466637421183, -5225.524578604465, 1193.3268304479584, -3315.7249225967453, -197.67660031699472, -3693.7656057604436], "policy_predator_policy_reward": [4470.835549801009, 531.6278763137427, -3006.6433246116467, -4426.401892853553, 1359.5012429474766, 3842.568496668559, 2077.789005936485, 249.93159572357487, -1007.2334882081318, -2453.8298714055168, 363.8011092185893, -740.8780626869623, 176.8285770349336, 935.7398068291736, -60.782471417697906, 8.008653144261459, 3215.528189924599, -2084.639427533619, -3461.768787957928, -1187.5110481884044, -309.06323326856904, 2280.4374212641032, 2234.2783476044233, -594.4122577266573, 172.11051370064143, -6496.526842280181, 2799.7373096361002, 26.387805795072342, 1249.3474802299527, 919.0064101431017, -3829.775254973766, -379.7846860761207, -1792.042036733088, -214.82241301294192, -3274.2881116932153, -2862.6691813175707, 4288.373721229145, 1025.406286847818, 163.80349755975178, -3737.7029483921233, 635.4457993236999, 1.0340824905605146, -2020.0767605691124, 2580.932907763445, -4367.2280708200915, 680.7987225732044, -525.4353369892552, 541.600949486928, -2335.1243359468567, 3873.7343128549637, -3120.1556509425645, 547.4804218214123, -1667.74522577704, 1150.3495778091883, -1015.2659768080957, -1905.910956388523, -742.9193769929216, 1320.1652761070186, -2958.21042419193, -1279.429600328088, -1795.43717768187, 249.01586735683549, -1401.7067411601186, 908.1773378841583, 1705.6985549570275, 1472.4432588395434, 387.6422503783192, 1633.9515557389261, -155.68295143050284, 3241.504360932758, 1191.0391836685994, 635.6892601681333, 1478.3175481415567, -1126.7105448513446, 1279.656957939506, 363.304830461191, -1133.0989824470405, -1311.858022382227, -142.56647353757262, -2925.7427761620993, 520.2705918327055, 5678.117062623755, 297.4070590614471, 476.68926481329515, 5781.525781892327, 97.78193382579946, 3194.0247389549577, 653.2104454757348, -1606.3755707229634, -2525.924899512497, 1402.087062721149, -2982.804282317257, -160.2007150333407, 1356.8243425870985, 1181.76856580016, -1695.4000359398244, -3639.527847217959, -17.028662156831857, -2966.645424367443, 2340.076675842113, 3335.122782922777, -432.5931088521102, -527.6573430341101, -1973.5993120797898, 433.0082320100708, 121.31996046805331, -5935.799752819452, 1085.8012330110555, 1775.9696319050252, 5619.049294085285, -1641.039635727265, -1294.0729704959688, -1164.7898627193038, -1653.3041213067847, 1906.2933034679152, -2945.2666719489484, -6495.701839827442, 885.7177218415253, -1224.568835340517, -667.4851717848535, 2237.9241160642014, -325.71103547975287, -404.9142846490549, 3202.730648109482, -261.9094456978003, -906.0907561503609, 847.6115043777216, -3266.5973438735755, 981.3169358782243, 1117.6315775870814, 237.12783153476695, 5581.632709605525, -171.58374229692996, 1270.5396866595845, -3281.713299478916, 2140.898287482093, 3458.2792116550563, 2347.3948432356974, -3001.7059949554778, 2748.9346301636397, -3010.47624391436, 1011.5732427295079, -39.635756401016664, -1070.1875224352568, 2575.6465646694855, 543.9626308981998, 2393.4859760172917, 3900.188251941057, 3203.419697340731, -545.1199579566824, 3608.3596114364836, 1838.9440272145534, 3054.7539345692803, 2952.842417548045, 4232.566023935325, -697.0282700343223, 4105.113333958951, 1022.8016657255811, 2770.7292558437525, -3372.78900675503, -564.3202032741168, 2822.6670012406, 579.8976721187368, 2963.963012870662, 5238.920703256076, 989.4345733081648, -302.7680060806342, -2117.1380719032272, 1176.6654823572305, 645.7604480248443, -1390.1703540763071, 863.0088924107436, 4532.632107752964, 3654.296338325022, 1094.5468275520718, 2272.8143008779753, -75.13911366525988, -229.9272063258844, 1429.2837783364528, -641.2139224661026, 317.203921135108, 1834.2933073790734, -511.03918423641596, 601.2965771266469, 501.38641863013, 974.6289137291367, 1147.1162401839597, 372.29526551303286, -619.9551546828309, -2100.5438971899757, 1926.7649527543772, -434.28612293199285, 371.2621710229898, 552.0251040917738, 5633.299786724381, -2336.3731254127397, 1957.609817518289, 164.78827463049896, 3745.898642117589, 1403.8949914142577]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6887221833853855, "mean_inference_ms": 1.4922275912289942, "mean_action_processing_ms": 0.2774799812948602, "mean_env_wait_ms": 0.12758729011064712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004590153694152832, "StateBufferConnector_ms": 0.0044831037521362305, "ViewRequirementAgentConnector_ms": 0.11906111240386963}, "num_episodes": 18, "episode_return_max": 2388.842838236041, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 324.9008958894312, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.8541913137511, "num_env_steps_trained_throughput_per_sec": 281.8541913137511, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 14563.065, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14563.003, "sample_time_ms": 1183.005, "learn_time_ms": 13362.369, "learn_throughput": 299.348, "synch_weights_time_ms": 15.881}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "6751e_00000", "date": "2024-08-11_19-10-09", "timestamp": 1723417809, "time_this_iter_s": 14.26231575012207, "time_total_s": 178.33913707733154, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea8f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 178.33913707733154, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 46.90952380952381, "ram_util_percent": 82.61428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7025767755729181, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.973411183634763, "policy_loss": -0.005069095947257386, "vf_loss": 9.977511662780923, "vf_explained_var": -0.0012664299162607345, "kl": 0.004843047931930409, "entropy": 1.459991802614202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7575436522720983, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.528362670272747, "policy_loss": -0.005932846393869825, "vf_loss": 9.532557967352489, "vf_explained_var": 0.0001555654422315971, "kl": 0.008687761760070715, "entropy": 1.3735001462477225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 3240.264026086594, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 445.4453304755265, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6787.938525749904, "predator_policy": -6495.701839827442}, "policy_reward_max": {"prey_policy": 7186.004875833017, "predator_policy": 6313.942163978278}, "policy_reward_mean": {"prey_policy": -382.02803800531854, "predator_policy": 604.7507032430818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1364.3912034182893, 0.0, 3.552713678800501e-15, 124.33686564731488, 221.56044186867064, 0.0, 268.91884186279447, 0.0, 929.0370759382049, 107.59798629111287, -3.552713678800501e-15, 3.552713678800501e-15, 0.0, 0.0, 368.8884212727414, -1.7763568394002505e-15, -2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 365.4260918384487, -7.105427357601002e-15, 0.0, 547.3472234511607, 123.64740241070248, 2343.853489883908, 1134.7489212662638, -1.7763568394002505e-14, 581.5074890394021, -7.105427357601002e-15, 0.0, 0.0, 241.89515985071648, 533.3008536029321, 0.0, 544.9977485588237, 337.28912451132044, 832.8913588446333, 0.0, -1.7763568394002505e-14, 241.1688632477546, 1.7763568394002505e-15, 220.72130147668534, 1.0658141036401503e-14, 0.0, 115.22343148883509, 2336.130276437741, 2388.842838236041, 597.1122568071919, 0.0, 498.023083244723, 893.2171250463045, 139.67748246725702, 1739.5052424512467, 513.9502304766447, 245.63825547724213, 1102.3409499322984, 0.0, 400.13458899633014, 4.263256414560601e-14, 301.10095697862954, 1868.992352742336, 0.0, 139.25995293929662, 715.5238304277416, 138.26145261132191, 525.9035025706462, 103.3089928714259, 0.0, 128.12031408282792, 653.9148375922613, 0.0, 0.0, -7.105427357601002e-15, 7.105427357601002e-15, 325.01704062353514, -1.4210854715202004e-14, 306.43063808811706, 0.0, 681.2768342479853, 561.3487464492955, -1.4210854715202004e-14, 1258.3514274544054, 0.0, 509.74992373172495, 1081.7893503263592, 387.2445778533605, 0.0, 0.0, 466.25077706243155, 3240.264026086594, 420.3796117095885, 737.2960118003369, 2486.9280881101226, 722.7323796628057, 0.0, 255.23046628930547, 1740.3141243953548, 1478.7250650547383, 785.0145765393256, 122.48156390703757], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1063.0922973713275, -2886.296507287343, 5109.20423661828, -1535.304785785905, 116.07281549920503, -752.5526973134656, 2041.9373488187164, -2478.456630365734, 5498.7104815206185, -1590.7206914050587, -172.21526235813815, 156.04964986046465, 2811.655803100025, -4081.3469381453356, 4473.4164611428705, -1900.7412320217206, 2444.2102336635526, -997.777509757495, 2694.4074407391004, 334.36747874863073, 289.091723931004, -866.3376230451023, 3646.25880662248, 591.3812178975396, 4473.857200904718, -2927.4358905796867, 5001.404403933703, -4507.875000657744, 795.4655344594911, -3604.7189269833198, -2771.026433794308, 749.4326276770626, -3396.7089571697684, 310.8875476675134, -182.53702161130133, -1644.1914222254306, 2175.3515774410794, -2526.958580731291, 440.9971566112609, -1718.5328531735088, 1800.3480108957585, 644.608993933508, 2409.427637643359, 658.8816120563131, -413.44847504870694, -5237.591955956592, 1846.0077317303378, -2496.456653194377, -482.5360018058527, -3052.9182240283594, 33.28550115131372, -2745.7717643157434, 4731.982056775364, -599.6815865399038, 4898.000063583629, -2735.7753549481235, -911.8560831192625, -284.7675444344951, 2784.193051644749, -2270.561581505083, 4918.343783182949, -1261.7872738081644, 3213.5061869071815, -2345.0422785311366, -263.63250234843156, -2105.596318119303, 1612.0246131424012, 889.2320419715007, 1059.726800255903, -1069.0572441752036, 6088.5704892582835, -901.2828449385662, -1846.4102601124941, -4715.717307033183, 3640.135553934737, -705.0229477115003, 2488.21079238162, 329.8831916444699, 2101.4526440224618, -821.3104122936729, 7186.004875833017, -1576.0207578470972, 1753.9363006252945, 358.83900797676233, 352.68363666339263, -2264.8967172478406, 529.5758493690174, -3327.392212829445, 2332.470507364528, -1049.246874027532, 6997.651448503223, -2242.5353325696337, 1860.0830513568742, -1570.1887265861392, -5074.393971051909, -147.25431328119214, 586.4301667428667, -1685.3861111055219, 3879.452675474817, -2240.614580233271, -3828.2771155312194, -1084.1798143132314, 5585.393436910543, -5192.944589651446, 5807.988593084739, -2069.580349448641, 4848.517878713533, -3224.7443694006165, 1232.7579748068463, -4106.728914897292, -2509.743553060434, -2681.589724965619, 1480.933184880956, -4139.232924265004, -1161.3557115495282, -3885.813338105179, -2369.0345285523654, -3638.561823564958, -249.4429357949048, -2984.9938611274665, -1923.6579272241622, -1335.264719718036, 3573.706824711205, -2971.6470737999266, 1647.4317137173068, -3766.518558744494, -1019.0760370849722, -1809.2608174766856, -1622.570516369032, -4467.523307583886, 5340.339191183722, -2394.529610629216, 1992.2453631594517, -3711.3623006701014, 3709.6167575389663, -3182.4552958734052, -4094.161332172997, -3964.646799822161, 246.54083074746376, -2959.9871215852463, 810.8790192294862, -505.8126992383416, 821.8959003212701, -1609.9657561916194, -888.912904651597, -1262.5843238625844, 2611.8638337259445, -2702.1212266161738, 259.35482183004154, -1410.3531135657715, 2850.9064189448413, -4370.317924641834, 3064.511372743855, -37.5816827829315, 3407.4840513077565, -4899.962881130136, 794.3926968109638, -1036.4031376777407, 2489.9466637421183, -5225.524578604465, 1193.3268304479584, -3315.7249225967453, -197.67660031699472, -3693.7656057604436, 1455.4173773870475, -5985.9253533867195, 2955.752862086533, -2987.84474027428, -2994.8767143015525, -4590.724767763935, -3639.84572640472, -1954.9343859215994, 2739.555981431072, -3843.8743120077975, 1128.1020428313263, -2200.507912578573, 6516.514755924594, -1533.1769173705277, -793.793440309938, -852.0585321960584, -2975.7905416122435, -5112.1707113326165, 385.8853912582811, -964.9235441246376, 1746.2609976018905, -3437.363424717075, 5647.473976733197, -2847.6849906334523, 2740.7680563707527, -907.4630931809793, 281.0137036237355, -2777.703940590921, -408.13288885118607, -4667.091761029539, 3630.062860366839, -6787.938525749904, 1457.9958340248068, -3785.63716017679, 5709.757119314228, -3105.27275379455], "policy_predator_policy_reward": [4288.373721229145, 1025.406286847818, 163.80349755975178, -3737.7029483921233, 635.4457993236999, 1.0340824905605146, -2020.0767605691124, 2580.932907763445, -4367.2280708200915, 680.7987225732044, -525.4353369892552, 541.600949486928, -2335.1243359468567, 3873.7343128549637, -3120.1556509425645, 547.4804218214123, -1667.74522577704, 1150.3495778091883, -1015.2659768080957, -1905.910956388523, -742.9193769929216, 1320.1652761070186, -2958.21042419193, -1279.429600328088, -1795.43717768187, 249.01586735683549, -1401.7067411601186, 908.1773378841583, 1705.6985549570275, 1472.4432588395434, 387.6422503783192, 1633.9515557389261, -155.68295143050284, 3241.504360932758, 1191.0391836685994, 635.6892601681333, 1478.3175481415567, -1126.7105448513446, 1279.656957939506, 363.304830461191, -1133.0989824470405, -1311.858022382227, -142.56647353757262, -2925.7427761620993, 520.2705918327055, 5678.117062623755, 297.4070590614471, 476.68926481329515, 5781.525781892327, 97.78193382579946, 3194.0247389549577, 653.2104454757348, -1606.3755707229634, -2525.924899512497, 1402.087062721149, -2982.804282317257, -160.2007150333407, 1356.8243425870985, 1181.76856580016, -1695.4000359398244, -3639.527847217959, -17.028662156831857, -2966.645424367443, 2340.076675842113, 3335.122782922777, -432.5931088521102, -527.6573430341101, -1973.5993120797898, 433.0082320100708, 121.31996046805331, -5935.799752819452, 1085.8012330110555, 1775.9696319050252, 5619.049294085285, -1641.039635727265, -1294.0729704959688, -1164.7898627193038, -1653.3041213067847, 1906.2933034679152, -2945.2666719489484, -6495.701839827442, 885.7177218415253, -1224.568835340517, -667.4851717848535, 2237.9241160642014, -325.71103547975287, -404.9142846490549, 3202.730648109482, -261.9094456978003, -906.0907561503609, 847.6115043777216, -3266.5973438735755, 981.3169358782243, 1117.6315775870814, 237.12783153476695, 5581.632709605525, -171.58374229692996, 1270.5396866595845, -3281.713299478916, 2140.898287482093, 3458.2792116550563, 2347.3948432356974, -3001.7059949554778, 2748.9346301636397, -3010.47624391436, 1011.5732427295079, -39.635756401016664, -1070.1875224352568, 2575.6465646694855, 543.9626308981998, 2393.4859760172917, 3900.188251941057, 3203.419697340731, -545.1199579566824, 3608.3596114364836, 1838.9440272145534, 3054.7539345692803, 2952.842417548045, 4232.566023935325, -697.0282700343223, 4105.113333958951, 1022.8016657255811, 2770.7292558437525, -3372.78900675503, -564.3202032741168, 2822.6670012406, 579.8976721187368, 2963.963012870662, 5238.920703256076, 989.4345733081648, -302.7680060806342, -2117.1380719032272, 1176.6654823572305, 645.7604480248443, -1390.1703540763071, 863.0088924107436, 4532.632107752964, 3654.296338325022, 1094.5468275520718, 2272.8143008779753, -75.13911366525988, -229.9272063258844, 1429.2837783364528, -641.2139224661026, 317.203921135108, 1834.2933073790734, -511.03918423641596, 601.2965771266469, 501.38641863013, 974.6289137291367, 1147.1162401839597, 372.29526551303286, -619.9551546828309, -2100.5438971899757, 1926.7649527543772, -434.28612293199285, 371.2621710229898, 552.0251040917738, 5633.299786724381, -2336.3731254127397, 1957.609817518289, 164.78827463049896, 3745.898642117589, 1403.8949914142577, -660.7425359582536, 5191.250511957922, 935.1097583476297, -393.26795642816046, 6313.942163978278, 2353.448668413566, 1691.053588988966, 4290.971101190713, 965.2918317690101, 139.02649880771656, 541.474118224892, 530.9317515223547, -555.1189741764337, -3961.9680873151965, 2946.3383354145544, 1939.777663178033, 4989.176505986536, 3519.164358667913, 0.9987533030823705, 1315.3354113636094, 2454.2821296013162, 1723.7483856239899, 1764.5871963423756, -3841.6438027793115, -841.6037068776234, -991.7012563121478, -251.16277498367737, 3003.0834782401666, 3225.397684630888, 3590.14108964519, -1008.9521034835684, 5645.552833921381, 3727.570864455254, -614.9149617639456, 1261.0961232201294, -3743.098924832776]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6858471485136184, "mean_inference_ms": 1.4822108588560865, "mean_action_processing_ms": 0.2761499356459328, "mean_env_wait_ms": 0.12701579937306448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00474238395690918, "StateBufferConnector_ms": 0.005272865295410156, "ViewRequirementAgentConnector_ms": 0.11700272560119629}, "num_episodes": 18, "episode_return_max": 3240.264026086594, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 445.4453304755265, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.84984084392363, "num_env_steps_trained_throughput_per_sec": 287.84984084392363, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 14461.794, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14461.741, "sample_time_ms": 1160.977, "learn_time_ms": 13282.878, "learn_throughput": 301.14, "synch_weights_time_ms": 15.758}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "6751e_00000", "date": "2024-08-11_19-10-23", "timestamp": 1723417823, "time_this_iter_s": 13.92929482460022, "time_total_s": 192.26843190193176, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 192.26843190193176, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 45.35789473684211, "ram_util_percent": 82.27894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7324049696405098, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.966171110244025, "policy_loss": -0.003997045548179399, "vf_loss": 9.969692522886568, "vf_explained_var": -0.005022304966336205, "kl": 0.004756251771623969, "entropy": 1.4548569507069058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.809443874207754, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.287282328126292, "policy_loss": -0.00691320187296403, "vf_loss": 9.292585197327629, "vf_explained_var": 0.000339333279422982, "kl": 0.008051478629277265, "entropy": 1.3546751448717067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 3240.264026086594, "episode_reward_min": -1.7763568394002505e-14, "episode_reward_mean": 523.6380436508108, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6787.938525749904, "predator_policy": -6600.321311678329}, "policy_reward_max": {"prey_policy": 8540.221837665056, "predator_policy": 6727.479224462965}, "policy_reward_mean": {"prey_policy": -598.3818266567415, "predator_policy": 860.2008484821467}, "custom_metrics": {}, "hist_stats": {"episode_reward": [581.5074890394021, -7.105427357601002e-15, 0.0, 0.0, 241.89515985071648, 533.3008536029321, 0.0, 544.9977485588237, 337.28912451132044, 832.8913588446333, 0.0, -1.7763568394002505e-14, 241.1688632477546, 1.7763568394002505e-15, 220.72130147668534, 1.0658141036401503e-14, 0.0, 115.22343148883509, 2336.130276437741, 2388.842838236041, 597.1122568071919, 0.0, 498.023083244723, 893.2171250463045, 139.67748246725702, 1739.5052424512467, 513.9502304766447, 245.63825547724213, 1102.3409499322984, 0.0, 400.13458899633014, 4.263256414560601e-14, 301.10095697862954, 1868.992352742336, 0.0, 139.25995293929662, 715.5238304277416, 138.26145261132191, 525.9035025706462, 103.3089928714259, 0.0, 128.12031408282792, 653.9148375922613, 0.0, 0.0, -7.105427357601002e-15, 7.105427357601002e-15, 325.01704062353514, -1.4210854715202004e-14, 306.43063808811706, 0.0, 681.2768342479853, 561.3487464492955, -1.4210854715202004e-14, 1258.3514274544054, 0.0, 509.74992373172495, 1081.7893503263592, 387.2445778533605, 0.0, 0.0, 466.25077706243155, 3240.264026086594, 420.3796117095885, 737.2960118003369, 2486.9280881101226, 722.7323796628057, 0.0, 255.23046628930547, 1740.3141243953548, 1478.7250650547383, 785.0145765393256, 122.48156390703757, 860.794319781932, 768.3121386588191, 140.0622745217017, 0.0, 2060.837290292151, 1573.179199502335, 0.0, 477.0713992559214, 994.5377249974209, 446.15446038632166, 232.71409658375026, 0.0, 240.70352607571994, 217.7416197691337, 977.9888071709295, 7.105427357601002e-15, 1206.1538571001868, 520.0882781857495, 757.8567630073221, 121.14388898351493, 136.77305612702847, 258.7405177904548, 0.0, 869.3213096650488, 242.57471982661582, 1909.5711516282167, 706.7048833677701], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4898.000063583629, -2735.7753549481235, -911.8560831192625, -284.7675444344951, 2784.193051644749, -2270.561581505083, 4918.343783182949, -1261.7872738081644, 3213.5061869071815, -2345.0422785311366, -263.63250234843156, -2105.596318119303, 1612.0246131424012, 889.2320419715007, 1059.726800255903, -1069.0572441752036, 6088.5704892582835, -901.2828449385662, -1846.4102601124941, -4715.717307033183, 3640.135553934737, -705.0229477115003, 2488.21079238162, 329.8831916444699, 2101.4526440224618, -821.3104122936729, 7186.004875833017, -1576.0207578470972, 1753.9363006252945, 358.83900797676233, 352.68363666339263, -2264.8967172478406, 529.5758493690174, -3327.392212829445, 2332.470507364528, -1049.246874027532, 6997.651448503223, -2242.5353325696337, 1860.0830513568742, -1570.1887265861392, -5074.393971051909, -147.25431328119214, 586.4301667428667, -1685.3861111055219, 3879.452675474817, -2240.614580233271, -3828.2771155312194, -1084.1798143132314, 5585.393436910543, -5192.944589651446, 5807.988593084739, -2069.580349448641, 4848.517878713533, -3224.7443694006165, 1232.7579748068463, -4106.728914897292, -2509.743553060434, -2681.589724965619, 1480.933184880956, -4139.232924265004, -1161.3557115495282, -3885.813338105179, -2369.0345285523654, -3638.561823564958, -249.4429357949048, -2984.9938611274665, -1923.6579272241622, -1335.264719718036, 3573.706824711205, -2971.6470737999266, 1647.4317137173068, -3766.518558744494, -1019.0760370849722, -1809.2608174766856, -1622.570516369032, -4467.523307583886, 5340.339191183722, -2394.529610629216, 1992.2453631594517, -3711.3623006701014, 3709.6167575389663, -3182.4552958734052, -4094.161332172997, -3964.646799822161, 246.54083074746376, -2959.9871215852463, 810.8790192294862, -505.8126992383416, 821.8959003212701, -1609.9657561916194, -888.912904651597, -1262.5843238625844, 2611.8638337259445, -2702.1212266161738, 259.35482183004154, -1410.3531135657715, 2850.9064189448413, -4370.317924641834, 3064.511372743855, -37.5816827829315, 3407.4840513077565, -4899.962881130136, 794.3926968109638, -1036.4031376777407, 2489.9466637421183, -5225.524578604465, 1193.3268304479584, -3315.7249225967453, -197.67660031699472, -3693.7656057604436, 1455.4173773870475, -5985.9253533867195, 2955.752862086533, -2987.84474027428, -2994.8767143015525, -4590.724767763935, -3639.84572640472, -1954.9343859215994, 2739.555981431072, -3843.8743120077975, 1128.1020428313263, -2200.507912578573, 6516.514755924594, -1533.1769173705277, -793.793440309938, -852.0585321960584, -2975.7905416122435, -5112.1707113326165, 385.8853912582811, -964.9235441246376, 1746.2609976018905, -3437.363424717075, 5647.473976733197, -2847.6849906334523, 2740.7680563707527, -907.4630931809793, 281.0137036237355, -2777.703940590921, -408.13288885118607, -4667.091761029539, 3630.062860366839, -6787.938525749904, 1457.9958340248068, -3785.63716017679, 5709.757119314228, -3105.27275379455, 161.8320547200957, -1870.9296416444085, 2075.700792749769, -3657.540899813261, -28.412202334594156, -3135.1116004190944, 117.6926321847026, -2142.5462784363685, -2541.4495178031575, -2792.867388948366, -493.92732298210393, -2588.030508672089, 3529.6388195560135, -4627.93607031754, -5538.030672192011, -1264.433252184829, 2028.9805580544835, -4229.858412635161, 8540.221837665056, -5176.317225386651, 845.8369974131577, -1763.8758538357722, -653.3569360926199, -838.7994782685096, -5182.699701976446, -3486.9288667728792, 7256.308966518716, -677.3932236285009, 1859.574270434405, -674.2377846009969, 4558.764994713317, -2215.084856656191, 6203.0080784009315, -5219.843572336285, 4217.888867608175, -3324.431342589272, 4290.098647700837, -2654.751829514437, -844.3608527196226, -1529.707997075449, 1813.248972143105, -1938.6526499003066, -4090.3889863961235, -3740.501946131631, -832.6921536927414, -4939.917545816169, 6567.83763670798, -2960.784900308707, -1625.1940403859442, -3217.6659655091366, -4738.2989220361105, -2075.1683319591752, 2524.669687912667, -904.4634444245777], "policy_predator_policy_reward": [1402.087062721149, -2982.804282317257, -160.2007150333407, 1356.8243425870985, 1181.76856580016, -1695.4000359398244, -3639.527847217959, -17.028662156831857, -2966.645424367443, 2340.076675842113, 3335.122782922777, -432.5931088521102, -527.6573430341101, -1973.5993120797898, 433.0082320100708, 121.31996046805331, -5935.799752819452, 1085.8012330110555, 1775.9696319050252, 5619.049294085285, -1641.039635727265, -1294.0729704959688, -1164.7898627193038, -1653.3041213067847, 1906.2933034679152, -2945.2666719489484, -6495.701839827442, 885.7177218415253, -1224.568835340517, -667.4851717848535, 2237.9241160642014, -325.71103547975287, -404.9142846490549, 3202.730648109482, -261.9094456978003, -906.0907561503609, 847.6115043777216, -3266.5973438735755, 981.3169358782243, 1117.6315775870814, 237.12783153476695, 5581.632709605525, -171.58374229692996, 1270.5396866595845, -3281.713299478916, 2140.898287482093, 3458.2792116550563, 2347.3948432356974, -3001.7059949554778, 2748.9346301636397, -3010.47624391436, 1011.5732427295079, -39.635756401016664, -1070.1875224352568, 2575.6465646694855, 543.9626308981998, 2393.4859760172917, 3900.188251941057, 3203.419697340731, -545.1199579566824, 3608.3596114364836, 1838.9440272145534, 3054.7539345692803, 2952.842417548045, 4232.566023935325, -697.0282700343223, 4105.113333958951, 1022.8016657255811, 2770.7292558437525, -3372.78900675503, -564.3202032741168, 2822.6670012406, 579.8976721187368, 2963.963012870662, 5238.920703256076, 989.4345733081648, -302.7680060806342, -2117.1380719032272, 1176.6654823572305, 645.7604480248443, -1390.1703540763071, 863.0088924107436, 4532.632107752964, 3654.296338325022, 1094.5468275520718, 2272.8143008779753, -75.13911366525988, -229.9272063258844, 1429.2837783364528, -641.2139224661026, 317.203921135108, 1834.2933073790734, -511.03918423641596, 601.2965771266469, 501.38641863013, 974.6289137291367, 1147.1162401839597, 372.29526551303286, -619.9551546828309, -2100.5438971899757, 1926.7649527543772, -434.28612293199285, 371.2621710229898, 552.0251040917738, 5633.299786724381, -2336.3731254127397, 1957.609817518289, 164.78827463049896, 3745.898642117589, 1403.8949914142577, -660.7425359582536, 5191.250511957922, 935.1097583476297, -393.26795642816046, 6313.942163978278, 2353.448668413566, 1691.053588988966, 4290.971101190713, 965.2918317690101, 139.02649880771656, 541.474118224892, 530.9317515223547, -555.1189741764337, -3961.9680873151965, 2946.3383354145544, 1939.777663178033, 4989.176505986536, 3519.164358667913, 0.9987533030823705, 1315.3354113636094, 2454.2821296013162, 1723.7483856239899, 1764.5871963423756, -3841.6438027793115, -841.6037068776234, -991.7012563121478, -251.16277498367737, 3003.0834782401666, 3225.397684630888, 3590.14108964519, -1008.9521034835684, 5645.552833921381, 3727.570864455254, -614.9149617639456, 1261.0961232201294, -3743.098924832776, 859.6435168283007, 1710.2483898779433, 146.37314723218014, 2203.779098490132, 2960.660526399614, 342.92555087578, 1398.3894266797602, 626.4642195719057, 5163.8599154753265, 2231.2942815683473, 487.522102228819, 4167.614928927708, -1521.279858271919, 2619.577109033439, 2998.3610689064003, 4281.1742547263575, 2232.1774969246794, 963.2380826534168, 3682.5711597862473, -6600.321311678329, 1654.0429446635949, -503.289991657231, -238.99560902874427, 1731.1520233898746, 2182.8528703620786, 6727.479224462965, -4162.295844907771, -2198.878278213305, -13.708381677185073, -193.6392969852954, -778.2207489650893, -1565.4593890920403, 5140.843017754139, -4917.8536667186045, -646.2142202368185, 272.84497340366266, 256.31539512304084, -1133.805450302122, 1145.5704691857795, 1349.6422695928056, -2763.391534156688, 3025.5682680409195, 6131.427265631023, 1958.2041846871882, 4116.889725546233, 1655.7199739626774, -307.55996626278363, -2430.1714604714466, 3500.10816304007, 1585.326562681628, 4467.141255111586, 4255.897150511915, -189.75912561442163, -723.7422345058974]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6807757819283938, "mean_inference_ms": 1.4707458875131028, "mean_action_processing_ms": 0.2747286896717446, "mean_env_wait_ms": 0.1264586353645987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004816174507141113, "StateBufferConnector_ms": 0.004068732261657715, "ViewRequirementAgentConnector_ms": 0.11089169979095459}, "num_episodes": 27, "episode_return_max": 3240.264026086594, "episode_return_min": -1.7763568394002505e-14, "episode_return_mean": 523.6380436508108, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.56913338517893, "num_env_steps_trained_throughput_per_sec": 285.56913338517893, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 14376.239, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14376.187, "sample_time_ms": 1164.24, "learn_time_ms": 13194.271, "learn_throughput": 303.162, "synch_weights_time_ms": 15.644}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "6751e_00000", "date": "2024-08-11_19-10-37", "timestamp": 1723417837, "time_this_iter_s": 14.058088064193726, "time_total_s": 206.3265199661255, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 206.3265199661255, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 45.635000000000005, "ram_util_percent": 82.54499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7183171230333822, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.954687095823742, "policy_loss": -0.007952870601891643, "vf_loss": 9.961910018214473, "vf_explained_var": -0.003833825562996839, "kl": 0.014599076669219899, "entropy": 1.4487209084803465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7077247439395814, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.515023892014115, "policy_loss": -0.006449415246960978, "vf_loss": 9.519654769998379, "vf_explained_var": 0.0001181238227420383, "kl": 0.009092684599704266, "entropy": 1.3355080921183187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 3240.264026086594, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 571.7317521207315, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6787.938525749904, "predator_policy": -6600.321311678329}, "policy_reward_max": {"prey_policy": 8540.221837665056, "predator_policy": 7599.60650303683}, "policy_reward_mean": {"prey_policy": -707.9672722165749, "predator_policy": 993.8331482769404}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2336.130276437741, 2388.842838236041, 597.1122568071919, 0.0, 498.023083244723, 893.2171250463045, 139.67748246725702, 1739.5052424512467, 513.9502304766447, 245.63825547724213, 1102.3409499322984, 0.0, 400.13458899633014, 4.263256414560601e-14, 301.10095697862954, 1868.992352742336, 0.0, 139.25995293929662, 715.5238304277416, 138.26145261132191, 525.9035025706462, 103.3089928714259, 0.0, 128.12031408282792, 653.9148375922613, 0.0, 0.0, -7.105427357601002e-15, 7.105427357601002e-15, 325.01704062353514, -1.4210854715202004e-14, 306.43063808811706, 0.0, 681.2768342479853, 561.3487464492955, -1.4210854715202004e-14, 1258.3514274544054, 0.0, 509.74992373172495, 1081.7893503263592, 387.2445778533605, 0.0, 0.0, 466.25077706243155, 3240.264026086594, 420.3796117095885, 737.2960118003369, 2486.9280881101226, 722.7323796628057, 0.0, 255.23046628930547, 1740.3141243953548, 1478.7250650547383, 785.0145765393256, 122.48156390703757, 860.794319781932, 768.3121386588191, 140.0622745217017, 0.0, 2060.837290292151, 1573.179199502335, 0.0, 477.0713992559214, 994.5377249974209, 446.15446038632166, 232.71409658375026, 0.0, 240.70352607571994, 217.7416197691337, 977.9888071709295, 7.105427357601002e-15, 1206.1538571001868, 520.0882781857495, 757.8567630073221, 121.14388898351493, 136.77305612702847, 258.7405177904548, 0.0, 869.3213096650488, 242.57471982661582, 1909.5711516282167, 706.7048833677701, 1.7763568394002505e-15, 738.1442541848003, -3.552713678800501e-15, 363.6109132304482, 737.9368853508934, 0.0, 0.0, 1234.9957441447243, 112.38769611528319, 0.0, 0.0, 482.08289980625483, 0.0, 0.0, 0.0, 1604.376171296062, 3184.8316134846955, 2.1316282072803006e-14], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6997.651448503223, -2242.5353325696337, 1860.0830513568742, -1570.1887265861392, -5074.393971051909, -147.25431328119214, 586.4301667428667, -1685.3861111055219, 3879.452675474817, -2240.614580233271, -3828.2771155312194, -1084.1798143132314, 5585.393436910543, -5192.944589651446, 5807.988593084739, -2069.580349448641, 4848.517878713533, -3224.7443694006165, 1232.7579748068463, -4106.728914897292, -2509.743553060434, -2681.589724965619, 1480.933184880956, -4139.232924265004, -1161.3557115495282, -3885.813338105179, -2369.0345285523654, -3638.561823564958, -249.4429357949048, -2984.9938611274665, -1923.6579272241622, -1335.264719718036, 3573.706824711205, -2971.6470737999266, 1647.4317137173068, -3766.518558744494, -1019.0760370849722, -1809.2608174766856, -1622.570516369032, -4467.523307583886, 5340.339191183722, -2394.529610629216, 1992.2453631594517, -3711.3623006701014, 3709.6167575389663, -3182.4552958734052, -4094.161332172997, -3964.646799822161, 246.54083074746376, -2959.9871215852463, 810.8790192294862, -505.8126992383416, 821.8959003212701, -1609.9657561916194, -888.912904651597, -1262.5843238625844, 2611.8638337259445, -2702.1212266161738, 259.35482183004154, -1410.3531135657715, 2850.9064189448413, -4370.317924641834, 3064.511372743855, -37.5816827829315, 3407.4840513077565, -4899.962881130136, 794.3926968109638, -1036.4031376777407, 2489.9466637421183, -5225.524578604465, 1193.3268304479584, -3315.7249225967453, -197.67660031699472, -3693.7656057604436, 1455.4173773870475, -5985.9253533867195, 2955.752862086533, -2987.84474027428, -2994.8767143015525, -4590.724767763935, -3639.84572640472, -1954.9343859215994, 2739.555981431072, -3843.8743120077975, 1128.1020428313263, -2200.507912578573, 6516.514755924594, -1533.1769173705277, -793.793440309938, -852.0585321960584, -2975.7905416122435, -5112.1707113326165, 385.8853912582811, -964.9235441246376, 1746.2609976018905, -3437.363424717075, 5647.473976733197, -2847.6849906334523, 2740.7680563707527, -907.4630931809793, 281.0137036237355, -2777.703940590921, -408.13288885118607, -4667.091761029539, 3630.062860366839, -6787.938525749904, 1457.9958340248068, -3785.63716017679, 5709.757119314228, -3105.27275379455, 161.8320547200957, -1870.9296416444085, 2075.700792749769, -3657.540899813261, -28.412202334594156, -3135.1116004190944, 117.6926321847026, -2142.5462784363685, -2541.4495178031575, -2792.867388948366, -493.92732298210393, -2588.030508672089, 3529.6388195560135, -4627.93607031754, -5538.030672192011, -1264.433252184829, 2028.9805580544835, -4229.858412635161, 8540.221837665056, -5176.317225386651, 845.8369974131577, -1763.8758538357722, -653.3569360926199, -838.7994782685096, -5182.699701976446, -3486.9288667728792, 7256.308966518716, -677.3932236285009, 1859.574270434405, -674.2377846009969, 4558.764994713317, -2215.084856656191, 6203.0080784009315, -5219.843572336285, 4217.888867608175, -3324.431342589272, 4290.098647700837, -2654.751829514437, -844.3608527196226, -1529.707997075449, 1813.248972143105, -1938.6526499003066, -4090.3889863961235, -3740.501946131631, -832.6921536927414, -4939.917545816169, 6567.83763670798, -2960.784900308707, -1625.1940403859442, -3217.6659655091366, -4738.2989220361105, -2075.1683319591752, 2524.669687912667, -904.4634444245777, 1499.7844522864857, -360.1138085863507, -2110.0790541592373, -3305.0927576039307, 1793.0230154277654, -864.8201167894267, 1081.9850753847404, -1682.3050645598028, 4793.172940056335, -2942.807813881104, 2017.3928412970367, -3322.767907928871, 2710.0036547851896, -4390.336815365301, -2984.250916439233, -1750.206612146179, 3914.3788520081316, -892.6315747520526, 168.76366451945768, -2660.837114955449, 2785.619888800234, 1039.6215233715516, 4250.814495175483, -3078.985508635077, 1440.2773582283899, -1697.0167138346226, 5181.114020173202, -1924.6057857499964, 2564.459466611542, -1881.457392790999, 1362.5410728842423, -1763.5422966276378, -4143.356854048061, -6154.979013660566, 5515.25839939611, -43.69383512731153], "policy_predator_policy_reward": [847.6115043777216, -3266.5973438735755, 981.3169358782243, 1117.6315775870814, 237.12783153476695, 5581.632709605525, -171.58374229692996, 1270.5396866595845, -3281.713299478916, 2140.898287482093, 3458.2792116550563, 2347.3948432356974, -3001.7059949554778, 2748.9346301636397, -3010.47624391436, 1011.5732427295079, -39.635756401016664, -1070.1875224352568, 2575.6465646694855, 543.9626308981998, 2393.4859760172917, 3900.188251941057, 3203.419697340731, -545.1199579566824, 3608.3596114364836, 1838.9440272145534, 3054.7539345692803, 2952.842417548045, 4232.566023935325, -697.0282700343223, 4105.113333958951, 1022.8016657255811, 2770.7292558437525, -3372.78900675503, -564.3202032741168, 2822.6670012406, 579.8976721187368, 2963.963012870662, 5238.920703256076, 989.4345733081648, -302.7680060806342, -2117.1380719032272, 1176.6654823572305, 645.7604480248443, -1390.1703540763071, 863.0088924107436, 4532.632107752964, 3654.296338325022, 1094.5468275520718, 2272.8143008779753, -75.13911366525988, -229.9272063258844, 1429.2837783364528, -641.2139224661026, 317.203921135108, 1834.2933073790734, -511.03918423641596, 601.2965771266469, 501.38641863013, 974.6289137291367, 1147.1162401839597, 372.29526551303286, -619.9551546828309, -2100.5438971899757, 1926.7649527543772, -434.28612293199285, 371.2621710229898, 552.0251040917738, 5633.299786724381, -2336.3731254127397, 1957.609817518289, 164.78827463049896, 3745.898642117589, 1403.8949914142577, -660.7425359582536, 5191.250511957922, 935.1097583476297, -393.26795642816046, 6313.942163978278, 2353.448668413566, 1691.053588988966, 4290.971101190713, 965.2918317690101, 139.02649880771656, 541.474118224892, 530.9317515223547, -555.1189741764337, -3961.9680873151965, 2946.3383354145544, 1939.777663178033, 4989.176505986536, 3519.164358667913, 0.9987533030823705, 1315.3354113636094, 2454.2821296013162, 1723.7483856239899, 1764.5871963423756, -3841.6438027793115, -841.6037068776234, -991.7012563121478, -251.16277498367737, 3003.0834782401666, 3225.397684630888, 3590.14108964519, -1008.9521034835684, 5645.552833921381, 3727.570864455254, -614.9149617639456, 1261.0961232201294, -3743.098924832776, 859.6435168283007, 1710.2483898779433, 146.37314723218014, 2203.779098490132, 2960.660526399614, 342.92555087578, 1398.3894266797602, 626.4642195719057, 5163.8599154753265, 2231.2942815683473, 487.522102228819, 4167.614928927708, -1521.279858271919, 2619.577109033439, 2998.3610689064003, 4281.1742547263575, 2232.1774969246794, 963.2380826534168, 3682.5711597862473, -6600.321311678329, 1654.0429446635949, -503.289991657231, -238.99560902874427, 1731.1520233898746, 2182.8528703620786, 6727.479224462965, -4162.295844907771, -2198.878278213305, -13.708381677185073, -193.6392969852954, -778.2207489650893, -1565.4593890920403, 5140.843017754139, -4917.8536667186045, -646.2142202368185, 272.84497340366266, 256.31539512304084, -1133.805450302122, 1145.5704691857795, 1349.6422695928056, -2763.391534156688, 3025.5682680409195, 6131.427265631023, 1958.2041846871882, 4116.889725546233, 1655.7199739626774, -307.55996626278363, -2430.1714604714466, 3500.10816304007, 1585.326562681628, 4467.141255111586, 4255.897150511915, -189.75912561442163, -723.7422345058974, -288.53576832762633, -851.1348753725084, 1588.1425905686376, 4565.173475379332, -808.3047151403778, -119.89818349796107, 718.8032809476379, 245.12762145787164, 458.9321954290494, -1571.3604362533865, 498.7410702498435, 806.6339963819926, 2395.383360349023, -715.0501997689153, 3311.700326655508, 2657.7529460746277, -341.0835594665077, -2568.276021674287, 670.2940097663651, 1821.7794406696257, -613.9672736197102, -3211.2741385520753, 160.025589211894, -849.7716759460444, 745.0778156047467, -488.33845999851457, -4128.945346714845, 872.4371122916416, -428.71331714181474, -254.28875667872822, 136.35527108477078, 1869.0221239546881, 5883.560978156492, 7599.60650303683, -1124.555614537875, -4347.00894973092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6783786040623407, "mean_inference_ms": 1.4642643240720945, "mean_action_processing_ms": 0.27354305617066815, "mean_env_wait_ms": 0.12599659249700712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004270434379577637, "StateBufferConnector_ms": 0.0038962364196777344, "ViewRequirementAgentConnector_ms": 0.09903872013092041}, "num_episodes": 18, "episode_return_max": 3240.264026086594, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 571.7317521207315, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.64281165145326, "num_env_steps_trained_throughput_per_sec": 287.64281165145326, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 14315.755, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14315.704, "sample_time_ms": 1155.454, "learn_time_ms": 13141.094, "learn_throughput": 304.389, "synch_weights_time_ms": 16.983}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "6751e_00000", "date": "2024-08-11_19-10-51", "timestamp": 1723417851, "time_this_iter_s": 13.991452932357788, "time_total_s": 220.31797289848328, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea2f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.31797289848328, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 44.36, "ram_util_percent": 83.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.787030478791585, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.960653406476217, "policy_loss": -0.006149370996059761, "vf_loss": 9.96629188376129, "vf_explained_var": -0.0020138799828827068, "kl": 0.010218054808324377, "entropy": 1.4423862947358026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6997173231903208, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.422054922013055, "policy_loss": -0.004925722051559696, "vf_loss": 9.42571769744631, "vf_explained_var": 5.5038897448746615e-05, "kl": 0.006314737950644242, "entropy": 1.2835497250001897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 3240.264026086594, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 559.661517811214, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6787.938525749904, "predator_policy": -6600.321311678329}, "policy_reward_max": {"prey_policy": 8540.221837665056, "predator_policy": 7599.60650303683}, "policy_reward_mean": {"prey_policy": -535.2930801874725, "predator_policy": 815.1238390930795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [715.5238304277416, 138.26145261132191, 525.9035025706462, 103.3089928714259, 0.0, 128.12031408282792, 653.9148375922613, 0.0, 0.0, -7.105427357601002e-15, 7.105427357601002e-15, 325.01704062353514, -1.4210854715202004e-14, 306.43063808811706, 0.0, 681.2768342479853, 561.3487464492955, -1.4210854715202004e-14, 1258.3514274544054, 0.0, 509.74992373172495, 1081.7893503263592, 387.2445778533605, 0.0, 0.0, 466.25077706243155, 3240.264026086594, 420.3796117095885, 737.2960118003369, 2486.9280881101226, 722.7323796628057, 0.0, 255.23046628930547, 1740.3141243953548, 1478.7250650547383, 785.0145765393256, 122.48156390703757, 860.794319781932, 768.3121386588191, 140.0622745217017, 0.0, 2060.837290292151, 1573.179199502335, 0.0, 477.0713992559214, 994.5377249974209, 446.15446038632166, 232.71409658375026, 0.0, 240.70352607571994, 217.7416197691337, 977.9888071709295, 7.105427357601002e-15, 1206.1538571001868, 520.0882781857495, 757.8567630073221, 121.14388898351493, 136.77305612702847, 258.7405177904548, 0.0, 869.3213096650488, 242.57471982661582, 1909.5711516282167, 706.7048833677701, 1.7763568394002505e-15, 738.1442541848003, -3.552713678800501e-15, 363.6109132304482, 737.9368853508934, 0.0, 0.0, 1234.9957441447243, 112.38769611528319, 0.0, 0.0, 482.08289980625483, 0.0, 0.0, 0.0, 1604.376171296062, 3184.8316134846955, 2.1316282072803006e-14, 124.24021924598229, 1561.4267017643756, 2929.4352733179885, 215.28977352108768, 0.0, 620.3404392325592, 1124.2653026882026, 602.5961057601621, 239.3749713580788, 563.6230990858461, -1.4210854715202004e-14, 241.63050782342015, 914.2944604506399, 1630.5288311089894, 1.4210854715202004e-14, 651.600073898878, 0.0, 538.2564020253441], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1019.0760370849722, -1809.2608174766856, -1622.570516369032, -4467.523307583886, 5340.339191183722, -2394.529610629216, 1992.2453631594517, -3711.3623006701014, 3709.6167575389663, -3182.4552958734052, -4094.161332172997, -3964.646799822161, 246.54083074746376, -2959.9871215852463, 810.8790192294862, -505.8126992383416, 821.8959003212701, -1609.9657561916194, -888.912904651597, -1262.5843238625844, 2611.8638337259445, -2702.1212266161738, 259.35482183004154, -1410.3531135657715, 2850.9064189448413, -4370.317924641834, 3064.511372743855, -37.5816827829315, 3407.4840513077565, -4899.962881130136, 794.3926968109638, -1036.4031376777407, 2489.9466637421183, -5225.524578604465, 1193.3268304479584, -3315.7249225967453, -197.67660031699472, -3693.7656057604436, 1455.4173773870475, -5985.9253533867195, 2955.752862086533, -2987.84474027428, -2994.8767143015525, -4590.724767763935, -3639.84572640472, -1954.9343859215994, 2739.555981431072, -3843.8743120077975, 1128.1020428313263, -2200.507912578573, 6516.514755924594, -1533.1769173705277, -793.793440309938, -852.0585321960584, -2975.7905416122435, -5112.1707113326165, 385.8853912582811, -964.9235441246376, 1746.2609976018905, -3437.363424717075, 5647.473976733197, -2847.6849906334523, 2740.7680563707527, -907.4630931809793, 281.0137036237355, -2777.703940590921, -408.13288885118607, -4667.091761029539, 3630.062860366839, -6787.938525749904, 1457.9958340248068, -3785.63716017679, 5709.757119314228, -3105.27275379455, 161.8320547200957, -1870.9296416444085, 2075.700792749769, -3657.540899813261, -28.412202334594156, -3135.1116004190944, 117.6926321847026, -2142.5462784363685, -2541.4495178031575, -2792.867388948366, -493.92732298210393, -2588.030508672089, 3529.6388195560135, -4627.93607031754, -5538.030672192011, -1264.433252184829, 2028.9805580544835, -4229.858412635161, 8540.221837665056, -5176.317225386651, 845.8369974131577, -1763.8758538357722, -653.3569360926199, -838.7994782685096, -5182.699701976446, -3486.9288667728792, 7256.308966518716, -677.3932236285009, 1859.574270434405, -674.2377846009969, 4558.764994713317, -2215.084856656191, 6203.0080784009315, -5219.843572336285, 4217.888867608175, -3324.431342589272, 4290.098647700837, -2654.751829514437, -844.3608527196226, -1529.707997075449, 1813.248972143105, -1938.6526499003066, -4090.3889863961235, -3740.501946131631, -832.6921536927414, -4939.917545816169, 6567.83763670798, -2960.784900308707, -1625.1940403859442, -3217.6659655091366, -4738.2989220361105, -2075.1683319591752, 2524.669687912667, -904.4634444245777, 1499.7844522864857, -360.1138085863507, -2110.0790541592373, -3305.0927576039307, 1793.0230154277654, -864.8201167894267, 1081.9850753847404, -1682.3050645598028, 4793.172940056335, -2942.807813881104, 2017.3928412970367, -3322.767907928871, 2710.0036547851896, -4390.336815365301, -2984.250916439233, -1750.206612146179, 3914.3788520081316, -892.6315747520526, 168.76366451945768, -2660.837114955449, 2785.619888800234, 1039.6215233715516, 4250.814495175483, -3078.985508635077, 1440.2773582283899, -1697.0167138346226, 5181.114020173202, -1924.6057857499964, 2564.459466611542, -1881.457392790999, 1362.5410728842423, -1763.5422966276378, -4143.356854048061, -6154.979013660566, 5515.25839939611, -43.69383512731153, 6717.786180227117, -1727.03237111345, 5668.045389131426, -2716.3915711009204, 4049.6840080301295, -1085.8546156815112, 4736.170516795191, -0.15351004814026403, 3074.1261857096224, -3612.3302233225286, -2322.242080633508, -2750.8650053654005, 1078.88688901933, -1255.8752775840678, 7317.681504582457, -3103.7406222687537, 8232.861606313123, -1531.2925960909806, 1719.6606141893687, -306.2367361439433, 1187.4436355757464, -3900.4963058613653, -343.27070608499963, -2033.2358913664166, -3273.3892503201555, -4431.905655868237, -844.0361888238301, -1011.7877845664688, 5239.214870046304, -861.2695581341746, -4307.1494497885915, -4328.675903161429, 5745.283288713417, -4720.151285667811, 6134.4049433839045, -4482.366556539288], "policy_predator_policy_reward": [579.8976721187368, 2963.963012870662, 5238.920703256076, 989.4345733081648, -302.7680060806342, -2117.1380719032272, 1176.6654823572305, 645.7604480248443, -1390.1703540763071, 863.0088924107436, 4532.632107752964, 3654.296338325022, 1094.5468275520718, 2272.8143008779753, -75.13911366525988, -229.9272063258844, 1429.2837783364528, -641.2139224661026, 317.203921135108, 1834.2933073790734, -511.03918423641596, 601.2965771266469, 501.38641863013, 974.6289137291367, 1147.1162401839597, 372.29526551303286, -619.9551546828309, -2100.5438971899757, 1926.7649527543772, -434.28612293199285, 371.2621710229898, 552.0251040917738, 5633.299786724381, -2336.3731254127397, 1957.609817518289, 164.78827463049896, 3745.898642117589, 1403.8949914142577, -660.7425359582536, 5191.250511957922, 935.1097583476297, -393.26795642816046, 6313.942163978278, 2353.448668413566, 1691.053588988966, 4290.971101190713, 965.2918317690101, 139.02649880771656, 541.474118224892, 530.9317515223547, -555.1189741764337, -3961.9680873151965, 2946.3383354145544, 1939.777663178033, 4989.176505986536, 3519.164358667913, 0.9987533030823705, 1315.3354113636094, 2454.2821296013162, 1723.7483856239899, 1764.5871963423756, -3841.6438027793115, -841.6037068776234, -991.7012563121478, -251.16277498367737, 3003.0834782401666, 3225.397684630888, 3590.14108964519, -1008.9521034835684, 5645.552833921381, 3727.570864455254, -614.9149617639456, 1261.0961232201294, -3743.098924832776, 859.6435168283007, 1710.2483898779433, 146.37314723218014, 2203.779098490132, 2960.660526399614, 342.92555087578, 1398.3894266797602, 626.4642195719057, 5163.8599154753265, 2231.2942815683473, 487.522102228819, 4167.614928927708, -1521.279858271919, 2619.577109033439, 2998.3610689064003, 4281.1742547263575, 2232.1774969246794, 963.2380826534168, 3682.5711597862473, -6600.321311678329, 1654.0429446635949, -503.289991657231, -238.99560902874427, 1731.1520233898746, 2182.8528703620786, 6727.479224462965, -4162.295844907771, -2198.878278213305, -13.708381677185073, -193.6392969852954, -778.2207489650893, -1565.4593890920403, 5140.843017754139, -4917.8536667186045, -646.2142202368185, 272.84497340366266, 256.31539512304084, -1133.805450302122, 1145.5704691857795, 1349.6422695928056, -2763.391534156688, 3025.5682680409195, 6131.427265631023, 1958.2041846871882, 4116.889725546233, 1655.7199739626774, -307.55996626278363, -2430.1714604714466, 3500.10816304007, 1585.326562681628, 4467.141255111586, 4255.897150511915, -189.75912561442163, -723.7422345058974, -288.53576832762633, -851.1348753725084, 1588.1425905686376, 4565.173475379332, -808.3047151403778, -119.89818349796107, 718.8032809476379, 245.12762145787164, 458.9321954290494, -1571.3604362533865, 498.7410702498435, 806.6339963819926, 2395.383360349023, -715.0501997689153, 3311.700326655508, 2657.7529460746277, -341.0835594665077, -2568.276021674287, 670.2940097663651, 1821.7794406696257, -613.9672736197102, -3211.2741385520753, 160.025589211894, -849.7716759460444, 745.0778156047467, -488.33845999851457, -4128.945346714845, 872.4371122916416, -428.71331714181474, -254.28875667872822, 136.35527108477078, 1869.0221239546881, 5883.560978156492, 7599.60650303683, -1124.555614537875, -4347.00894973092, -6275.593725251491, 1409.0801353838012, 1278.0784551756612, -2668.3055714417906, -482.4287288269942, 448.03460979636424, -4498.9528391957165, -21.774394030249187, -18.679191420952314, 556.8832290338562, 4622.767798216306, 1070.67972701516, 373.963656987264, 927.2900342656753, 286.9682952130172, -3898.313071766556, -1770.3603576381538, -4691.833681225914, 84.41967862316127, -934.2204575827404, 1462.9818932383985, 1250.070777047217, 1160.3478303247352, 1457.7892749501011, 5660.371211487372, 2959.218155151661, 2068.3951497217295, 1417.957654777563, -1963.7699977517752, -2414.1753141603594, 1964.6991103536961, 7322.726316495201, -1415.0496423259958, 389.9176392803838, -1289.1552618963299, 175.37327707705583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6816053569643572, "mean_inference_ms": 1.4758818462008403, "mean_action_processing_ms": 0.2767379845554984, "mean_env_wait_ms": 0.1271001923714128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004322648048400879, "StateBufferConnector_ms": 0.003935456275939941, "ViewRequirementAgentConnector_ms": 0.1429535150527954}, "num_episodes": 18, "episode_return_max": 3240.264026086594, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 559.661517811214, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.9062441447489, "num_env_steps_trained_throughput_per_sec": 268.9062441447489, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 14347.791, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14347.736, "sample_time_ms": 1280.577, "learn_time_ms": 13047.661, "learn_throughput": 306.568, "synch_weights_time_ms": 17.124}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "6751e_00000", "date": "2024-08-11_19-11-06", "timestamp": 1723417866, "time_this_iter_s": 14.910709857940674, "time_total_s": 235.22868275642395, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 235.22868275642395, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 48.63636363636363, "ram_util_percent": 83.31818181818181}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7808228408060377, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.951233780573284, "policy_loss": -0.0063372412728510364, "vf_loss": 9.956951080806672, "vf_explained_var": -0.010479437989532632, "kl": 0.012399088749378234, "entropy": 1.3263545714358174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8297490856477192, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.321012237084606, "policy_loss": -0.00885689285344804, "vf_loss": 9.32819452840815, "vf_explained_var": 0.00022471588124673832, "kl": 0.008373073967732726, "entropy": 1.2239256976142763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 653.1045549745463, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6787.938525749904, "predator_policy": -6600.321311678329}, "policy_reward_max": {"prey_policy": 9198.657762125342, "predator_policy": 7599.60650303683}, "policy_reward_mean": {"prey_policy": -261.5594411686186, "predator_policy": 588.1117186558914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1258.3514274544054, 0.0, 509.74992373172495, 1081.7893503263592, 387.2445778533605, 0.0, 0.0, 466.25077706243155, 3240.264026086594, 420.3796117095885, 737.2960118003369, 2486.9280881101226, 722.7323796628057, 0.0, 255.23046628930547, 1740.3141243953548, 1478.7250650547383, 785.0145765393256, 122.48156390703757, 860.794319781932, 768.3121386588191, 140.0622745217017, 0.0, 2060.837290292151, 1573.179199502335, 0.0, 477.0713992559214, 994.5377249974209, 446.15446038632166, 232.71409658375026, 0.0, 240.70352607571994, 217.7416197691337, 977.9888071709295, 7.105427357601002e-15, 1206.1538571001868, 520.0882781857495, 757.8567630073221, 121.14388898351493, 136.77305612702847, 258.7405177904548, 0.0, 869.3213096650488, 242.57471982661582, 1909.5711516282167, 706.7048833677701, 1.7763568394002505e-15, 738.1442541848003, -3.552713678800501e-15, 363.6109132304482, 737.9368853508934, 0.0, 0.0, 1234.9957441447243, 112.38769611528319, 0.0, 0.0, 482.08289980625483, 0.0, 0.0, 0.0, 1604.376171296062, 3184.8316134846955, 2.1316282072803006e-14, 124.24021924598229, 1561.4267017643756, 2929.4352733179885, 215.28977352108768, 0.0, 620.3404392325592, 1124.2653026882026, 602.5961057601621, 239.3749713580788, 563.6230990858461, -1.4210854715202004e-14, 241.63050782342015, 914.2944604506399, 1630.5288311089894, 1.4210854715202004e-14, 651.600073898878, 0.0, 538.2564020253441, 120.95695270304199, 358.396726932532, 1138.3866114228301, 2693.855417397459, 583.580805727313, 470.8117180937398, 1204.302834062687, 512.1950753621724, 107.98566239329159, 320.3149029093652, 429.4270144838132, 253.8107670529826, 106.27515989112304, 125.90882029178235, 0.0, 638.2515556082395, 995.2812088444034, 3423.668672721605], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-197.67660031699472, -3693.7656057604436, 1455.4173773870475, -5985.9253533867195, 2955.752862086533, -2987.84474027428, -2994.8767143015525, -4590.724767763935, -3639.84572640472, -1954.9343859215994, 2739.555981431072, -3843.8743120077975, 1128.1020428313263, -2200.507912578573, 6516.514755924594, -1533.1769173705277, -793.793440309938, -852.0585321960584, -2975.7905416122435, -5112.1707113326165, 385.8853912582811, -964.9235441246376, 1746.2609976018905, -3437.363424717075, 5647.473976733197, -2847.6849906334523, 2740.7680563707527, -907.4630931809793, 281.0137036237355, -2777.703940590921, -408.13288885118607, -4667.091761029539, 3630.062860366839, -6787.938525749904, 1457.9958340248068, -3785.63716017679, 5709.757119314228, -3105.27275379455, 161.8320547200957, -1870.9296416444085, 2075.700792749769, -3657.540899813261, -28.412202334594156, -3135.1116004190944, 117.6926321847026, -2142.5462784363685, -2541.4495178031575, -2792.867388948366, -493.92732298210393, -2588.030508672089, 3529.6388195560135, -4627.93607031754, -5538.030672192011, -1264.433252184829, 2028.9805580544835, -4229.858412635161, 8540.221837665056, -5176.317225386651, 845.8369974131577, -1763.8758538357722, -653.3569360926199, -838.7994782685096, -5182.699701976446, -3486.9288667728792, 7256.308966518716, -677.3932236285009, 1859.574270434405, -674.2377846009969, 4558.764994713317, -2215.084856656191, 6203.0080784009315, -5219.843572336285, 4217.888867608175, -3324.431342589272, 4290.098647700837, -2654.751829514437, -844.3608527196226, -1529.707997075449, 1813.248972143105, -1938.6526499003066, -4090.3889863961235, -3740.501946131631, -832.6921536927414, -4939.917545816169, 6567.83763670798, -2960.784900308707, -1625.1940403859442, -3217.6659655091366, -4738.2989220361105, -2075.1683319591752, 2524.669687912667, -904.4634444245777, 1499.7844522864857, -360.1138085863507, -2110.0790541592373, -3305.0927576039307, 1793.0230154277654, -864.8201167894267, 1081.9850753847404, -1682.3050645598028, 4793.172940056335, -2942.807813881104, 2017.3928412970367, -3322.767907928871, 2710.0036547851896, -4390.336815365301, -2984.250916439233, -1750.206612146179, 3914.3788520081316, -892.6315747520526, 168.76366451945768, -2660.837114955449, 2785.619888800234, 1039.6215233715516, 4250.814495175483, -3078.985508635077, 1440.2773582283899, -1697.0167138346226, 5181.114020173202, -1924.6057857499964, 2564.459466611542, -1881.457392790999, 1362.5410728842423, -1763.5422966276378, -4143.356854048061, -6154.979013660566, 5515.25839939611, -43.69383512731153, 6717.786180227117, -1727.03237111345, 5668.045389131426, -2716.3915711009204, 4049.6840080301295, -1085.8546156815112, 4736.170516795191, -0.15351004814026403, 3074.1261857096224, -3612.3302233225286, -2322.242080633508, -2750.8650053654005, 1078.88688901933, -1255.8752775840678, 7317.681504582457, -3103.7406222687537, 8232.861606313123, -1531.2925960909806, 1719.6606141893687, -306.2367361439433, 1187.4436355757464, -3900.4963058613653, -343.27070608499963, -2033.2358913664166, -3273.3892503201555, -4431.905655868237, -844.0361888238301, -1011.7877845664688, 5239.214870046304, -861.2695581341746, -4307.1494497885915, -4328.675903161429, 5745.283288713417, -4720.151285667811, 6134.4049433839045, -4482.366556539288, 3305.2528985583476, -2880.8924968714964, 2556.7379133574796, -5863.910675907335, 7869.93768541335, -2532.4867242758687, 5112.958986260308, -1445.4607343027778, 3707.1409449195266, -2424.738505888941, 3440.544550667794, -2856.169364271268, 9198.657762125342, -2182.379112514463, 4185.5914536463615, -2958.581992987016, -964.7851046345879, -88.46856117054234, 1089.2364956944377, 258.7576155554839, 4993.88678398899, -294.02334469332766, 1647.3191210891198, -3310.296326795609, -548.8727435421495, 950.3167197557568, 4026.1744171950522, -2380.2657264479067, 1076.7123644318772, -1365.174562760772, 4048.8021144141267, -4210.606407090165, 2040.3523311292383, -1465.1935442695221, 8306.355608191923, -2193.2365732937674], "policy_predator_policy_reward": [3745.898642117589, 1403.8949914142577, -660.7425359582536, 5191.250511957922, 935.1097583476297, -393.26795642816046, 6313.942163978278, 2353.448668413566, 1691.053588988966, 4290.971101190713, 965.2918317690101, 139.02649880771656, 541.474118224892, 530.9317515223547, -555.1189741764337, -3961.9680873151965, 2946.3383354145544, 1939.777663178033, 4989.176505986536, 3519.164358667913, 0.9987533030823705, 1315.3354113636094, 2454.2821296013162, 1723.7483856239899, 1764.5871963423756, -3841.6438027793115, -841.6037068776234, -991.7012563121478, -251.16277498367737, 3003.0834782401666, 3225.397684630888, 3590.14108964519, -1008.9521034835684, 5645.552833921381, 3727.570864455254, -614.9149617639456, 1261.0961232201294, -3743.098924832776, 859.6435168283007, 1710.2483898779433, 146.37314723218014, 2203.779098490132, 2960.660526399614, 342.92555087578, 1398.3894266797602, 626.4642195719057, 5163.8599154753265, 2231.2942815683473, 487.522102228819, 4167.614928927708, -1521.279858271919, 2619.577109033439, 2998.3610689064003, 4281.1742547263575, 2232.1774969246794, 963.2380826534168, 3682.5711597862473, -6600.321311678329, 1654.0429446635949, -503.289991657231, -238.99560902874427, 1731.1520233898746, 2182.8528703620786, 6727.479224462965, -4162.295844907771, -2198.878278213305, -13.708381677185073, -193.6392969852954, -778.2207489650893, -1565.4593890920403, 5140.843017754139, -4917.8536667186045, -646.2142202368185, 272.84497340366266, 256.31539512304084, -1133.805450302122, 1145.5704691857795, 1349.6422695928056, -2763.391534156688, 3025.5682680409195, 6131.427265631023, 1958.2041846871882, 4116.889725546233, 1655.7199739626774, -307.55996626278363, -2430.1714604714466, 3500.10816304007, 1585.326562681628, 4467.141255111586, 4255.897150511915, -189.75912561442163, -723.7422345058974, -288.53576832762633, -851.1348753725084, 1588.1425905686376, 4565.173475379332, -808.3047151403778, -119.89818349796107, 718.8032809476379, 245.12762145787164, 458.9321954290494, -1571.3604362533865, 498.7410702498435, 806.6339963819926, 2395.383360349023, -715.0501997689153, 3311.700326655508, 2657.7529460746277, -341.0835594665077, -2568.276021674287, 670.2940097663651, 1821.7794406696257, -613.9672736197102, -3211.2741385520753, 160.025589211894, -849.7716759460444, 745.0778156047467, -488.33845999851457, -4128.945346714845, 872.4371122916416, -428.71331714181474, -254.28875667872822, 136.35527108477078, 1869.0221239546881, 5883.560978156492, 7599.60650303683, -1124.555614537875, -4347.00894973092, -6275.593725251491, 1409.0801353838012, 1278.0784551756612, -2668.3055714417906, -482.4287288269942, 448.03460979636424, -4498.9528391957165, -21.774394030249187, -18.679191420952314, 556.8832290338562, 4622.767798216306, 1070.67972701516, 373.963656987264, 927.2900342656753, 286.9682952130172, -3898.313071766556, -1770.3603576381538, -4691.833681225914, 84.41967862316127, -934.2204575827404, 1462.9818932383985, 1250.070777047217, 1160.3478303247352, 1457.7892749501011, 5660.371211487372, 2959.218155151661, 2068.3951497217295, 1417.957654777563, -1963.7699977517752, -2414.1753141603594, 1964.6991103536961, 7322.726316495201, -1415.0496423259958, 389.9176392803838, -1289.1552618963299, 175.37327707705583, -602.9797419689457, 299.5762929851346, 1936.99418316696, 1728.5753063154307, 75.16716421003623, -4274.2315139246875, -2527.9136451033773, 1554.2708105433105, -1463.549582553236, 764.7279492499612, -851.3589195245073, 737.7954512217176, -5252.425743157289, -559.5500723909014, -3073.315588424479, 2358.501203127307, 1028.5203510259933, 132.7189771724279, -429.1525669189955, -598.52664142156, 21.037899605562444, -4291.474324417418, 686.028912898034, 1230.7590598614388, 1004.7810171395208, -1299.9498334620057, -485.9165335691125, -1034.0833368862511, 689.6947672182998, -401.23256888940364, 1293.4442190864024, -493.38837080212585, 696.9009972621565, -276.77857527746767, -3391.254036776483, 701.8036745999339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6861005983567574, "mean_inference_ms": 1.4875848420725648, "mean_action_processing_ms": 0.27995762971192883, "mean_env_wait_ms": 0.12830808418598066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004308938980102539, "StateBufferConnector_ms": 0.003922224044799805, "ViewRequirementAgentConnector_ms": 0.1442103385925293}, "num_episodes": 18, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 653.1045549745463, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.7748273218962, "num_env_steps_trained_throughput_per_sec": 273.7748273218962, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 14328.473, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14328.419, "sample_time_ms": 1271.948, "learn_time_ms": 13037.576, "learn_throughput": 306.805, "synch_weights_time_ms": 16.621}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "6751e_00000", "date": "2024-08-11_19-11-21", "timestamp": 1723417881, "time_this_iter_s": 14.669212102890015, "time_total_s": 249.89789485931396, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea8f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 249.89789485931396, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 46.67619047619048, "ram_util_percent": 83.28571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7565926800329218, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.966942035836517, "policy_loss": -0.006253039867681249, "vf_loss": 9.972792005286646, "vf_explained_var": -0.0008108696609577805, "kl": 0.00806138684388814, "entropy": 1.3025450550689899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9362990801927273, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.298662151861443, "policy_loss": -0.009525979640795086, "vf_loss": 9.306028324712521, "vf_explained_var": -0.0002648919663101277, "kl": 0.010799015793614856, "entropy": 1.1711014487755993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 574.6100331515339, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6154.979013660566, "predator_policy": -6600.321311678329}, "policy_reward_max": {"prey_policy": 9198.657762125342, "predator_policy": 7599.60650303683}, "policy_reward_mean": {"prey_policy": -15.554366969025196, "predator_policy": 302.85938354479185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 2060.837290292151, 1573.179199502335, 0.0, 477.0713992559214, 994.5377249974209, 446.15446038632166, 232.71409658375026, 0.0, 240.70352607571994, 217.7416197691337, 977.9888071709295, 7.105427357601002e-15, 1206.1538571001868, 520.0882781857495, 757.8567630073221, 121.14388898351493, 136.77305612702847, 258.7405177904548, 0.0, 869.3213096650488, 242.57471982661582, 1909.5711516282167, 706.7048833677701, 1.7763568394002505e-15, 738.1442541848003, -3.552713678800501e-15, 363.6109132304482, 737.9368853508934, 0.0, 0.0, 1234.9957441447243, 112.38769611528319, 0.0, 0.0, 482.08289980625483, 0.0, 0.0, 0.0, 1604.376171296062, 3184.8316134846955, 2.1316282072803006e-14, 124.24021924598229, 1561.4267017643756, 2929.4352733179885, 215.28977352108768, 0.0, 620.3404392325592, 1124.2653026882026, 602.5961057601621, 239.3749713580788, 563.6230990858461, -1.4210854715202004e-14, 241.63050782342015, 914.2944604506399, 1630.5288311089894, 1.4210854715202004e-14, 651.600073898878, 0.0, 538.2564020253441, 120.95695270304199, 358.396726932532, 1138.3866114228301, 2693.855417397459, 583.580805727313, 470.8117180937398, 1204.302834062687, 512.1950753621724, 107.98566239329159, 320.3149029093652, 429.4270144838132, 253.8107670529826, 106.27515989112304, 125.90882029178235, 0.0, 638.2515556082395, 995.2812088444034, 3423.668672721605, 0.0, 2195.553801210249, 0.0, 1056.4673710790414, 123.21802518244935, 120.327384671614, 901.7800734305356, 357.7740919282257, 219.4747207206206, 117.75733510004466, 0.0, 636.7649027027803, 363.0783117481466, 252.32612312412564, 0.0, 466.11466669823585, 126.665268316092, 2534.092383240092, 3.552713678800501e-15, 0.0, 2.842170943040401e-14, 141.07406149246117], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [117.6926321847026, -2142.5462784363685, -2541.4495178031575, -2792.867388948366, -493.92732298210393, -2588.030508672089, 3529.6388195560135, -4627.93607031754, -5538.030672192011, -1264.433252184829, 2028.9805580544835, -4229.858412635161, 8540.221837665056, -5176.317225386651, 845.8369974131577, -1763.8758538357722, -653.3569360926199, -838.7994782685096, -5182.699701976446, -3486.9288667728792, 7256.308966518716, -677.3932236285009, 1859.574270434405, -674.2377846009969, 4558.764994713317, -2215.084856656191, 6203.0080784009315, -5219.843572336285, 4217.888867608175, -3324.431342589272, 4290.098647700837, -2654.751829514437, -844.3608527196226, -1529.707997075449, 1813.248972143105, -1938.6526499003066, -4090.3889863961235, -3740.501946131631, -832.6921536927414, -4939.917545816169, 6567.83763670798, -2960.784900308707, -1625.1940403859442, -3217.6659655091366, -4738.2989220361105, -2075.1683319591752, 2524.669687912667, -904.4634444245777, 1499.7844522864857, -360.1138085863507, -2110.0790541592373, -3305.0927576039307, 1793.0230154277654, -864.8201167894267, 1081.9850753847404, -1682.3050645598028, 4793.172940056335, -2942.807813881104, 2017.3928412970367, -3322.767907928871, 2710.0036547851896, -4390.336815365301, -2984.250916439233, -1750.206612146179, 3914.3788520081316, -892.6315747520526, 168.76366451945768, -2660.837114955449, 2785.619888800234, 1039.6215233715516, 4250.814495175483, -3078.985508635077, 1440.2773582283899, -1697.0167138346226, 5181.114020173202, -1924.6057857499964, 2564.459466611542, -1881.457392790999, 1362.5410728842423, -1763.5422966276378, -4143.356854048061, -6154.979013660566, 5515.25839939611, -43.69383512731153, 6717.786180227117, -1727.03237111345, 5668.045389131426, -2716.3915711009204, 4049.6840080301295, -1085.8546156815112, 4736.170516795191, -0.15351004814026403, 3074.1261857096224, -3612.3302233225286, -2322.242080633508, -2750.8650053654005, 1078.88688901933, -1255.8752775840678, 7317.681504582457, -3103.7406222687537, 8232.861606313123, -1531.2925960909806, 1719.6606141893687, -306.2367361439433, 1187.4436355757464, -3900.4963058613653, -343.27070608499963, -2033.2358913664166, -3273.3892503201555, -4431.905655868237, -844.0361888238301, -1011.7877845664688, 5239.214870046304, -861.2695581341746, -4307.1494497885915, -4328.675903161429, 5745.283288713417, -4720.151285667811, 6134.4049433839045, -4482.366556539288, 3305.2528985583476, -2880.8924968714964, 2556.7379133574796, -5863.910675907335, 7869.93768541335, -2532.4867242758687, 5112.958986260308, -1445.4607343027778, 3707.1409449195266, -2424.738505888941, 3440.544550667794, -2856.169364271268, 9198.657762125342, -2182.379112514463, 4185.5914536463615, -2958.581992987016, -964.7851046345879, -88.46856117054234, 1089.2364956944377, 258.7576155554839, 4993.88678398899, -294.02334469332766, 1647.3191210891198, -3310.296326795609, -548.8727435421495, 950.3167197557568, 4026.1744171950522, -2380.2657264479067, 1076.7123644318772, -1365.174562760772, 4048.8021144141267, -4210.606407090165, 2040.3523311292383, -1465.1935442695221, 8306.355608191923, -2193.2365732937674, 3510.407401846511, -564.0415813087908, 7341.085442884356, -2244.96177901685, 3028.3469900593536, -3149.496779377727, -1699.4798324674318, -3560.923403681835, 4058.851566907936, -2324.755845977993, 4583.091428909875, -683.8876127176624, 7018.596548550642, -891.2505021189611, 2806.185785048876, -2677.044197645645, 9165.407055691034, 2.932403554767294, -1947.2200431015644, -3307.836457684477, 2530.450621051083, -1416.192045059656, 499.4008746540396, -3283.760528984442, 1832.1692419786514, -1276.9497992561792, -4319.37682285822, -1501.71839984682, 2927.2611475403073, -890.1665373352737, 1345.9168452611978, -1659.782846933108, 4145.417470080094, -3568.6012413739013, 3942.908433157257, -139.5622935706084, -896.7010954693309, -3085.836124145613, 2597.7466213514926, -2681.5707439507287, -4217.387223232311, -1784.5461776245688, 3236.071256571623, -4704.261262614944], "policy_predator_policy_reward": [1398.3894266797602, 626.4642195719057, 5163.8599154753265, 2231.2942815683473, 487.522102228819, 4167.614928927708, -1521.279858271919, 2619.577109033439, 2998.3610689064003, 4281.1742547263575, 2232.1774969246794, 963.2380826534168, 3682.5711597862473, -6600.321311678329, 1654.0429446635949, -503.289991657231, -238.99560902874427, 1731.1520233898746, 2182.8528703620786, 6727.479224462965, -4162.295844907771, -2198.878278213305, -13.708381677185073, -193.6392969852954, -778.2207489650893, -1565.4593890920403, 5140.843017754139, -4917.8536667186045, -646.2142202368185, 272.84497340366266, 256.31539512304084, -1133.805450302122, 1145.5704691857795, 1349.6422695928056, -2763.391534156688, 3025.5682680409195, 6131.427265631023, 1958.2041846871882, 4116.889725546233, 1655.7199739626774, -307.55996626278363, -2430.1714604714466, 3500.10816304007, 1585.326562681628, 4467.141255111586, 4255.897150511915, -189.75912561442163, -723.7422345058974, -288.53576832762633, -851.1348753725084, 1588.1425905686376, 4565.173475379332, -808.3047151403778, -119.89818349796107, 718.8032809476379, 245.12762145787164, 458.9321954290494, -1571.3604362533865, 498.7410702498435, 806.6339963819926, 2395.383360349023, -715.0501997689153, 3311.700326655508, 2657.7529460746277, -341.0835594665077, -2568.276021674287, 670.2940097663651, 1821.7794406696257, -613.9672736197102, -3211.2741385520753, 160.025589211894, -849.7716759460444, 745.0778156047467, -488.33845999851457, -4128.945346714845, 872.4371122916416, -428.71331714181474, -254.28875667872822, 136.35527108477078, 1869.0221239546881, 5883.560978156492, 7599.60650303683, -1124.555614537875, -4347.00894973092, -6275.593725251491, 1409.0801353838012, 1278.0784551756612, -2668.3055714417906, -482.4287288269942, 448.03460979636424, -4498.9528391957165, -21.774394030249187, -18.679191420952314, 556.8832290338562, 4622.767798216306, 1070.67972701516, 373.963656987264, 927.2900342656753, 286.9682952130172, -3898.313071766556, -1770.3603576381538, -4691.833681225914, 84.41967862316127, -934.2204575827404, 1462.9818932383985, 1250.070777047217, 1160.3478303247352, 1457.7892749501011, 5660.371211487372, 2959.218155151661, 2068.3951497217295, 1417.957654777563, -1963.7699977517752, -2414.1753141603594, 1964.6991103536961, 7322.726316495201, -1415.0496423259958, 389.9176392803838, -1289.1552618963299, 175.37327707705583, -602.9797419689457, 299.5762929851346, 1936.99418316696, 1728.5753063154307, 75.16716421003623, -4274.2315139246875, -2527.9136451033773, 1554.2708105433105, -1463.549582553236, 764.7279492499612, -851.3589195245073, 737.7954512217176, -5252.425743157289, -559.5500723909014, -3073.315588424479, 2358.501203127307, 1028.5203510259933, 132.7189771724279, -429.1525669189955, -598.52664142156, 21.037899605562444, -4291.474324417418, 686.028912898034, 1230.7590598614388, 1004.7810171395208, -1299.9498334620057, -485.9165335691125, -1034.0833368862511, 689.6947672182998, -401.23256888940364, 1293.4442190864024, -493.38837080212585, 696.9009972621565, -276.77857527746767, -3391.254036776483, 701.8036745999339, -1788.1731016573422, -1158.1927188803784, -2807.011275512921, -93.55858714434189, -194.15766567402423, 315.3074549923955, 4221.810440303332, 2095.0601669249795, 1467.9860919999433, -3078.8637877474375, -200.25378793239832, -3578.6226435881968, 156.5738802141098, -5382.139853215257, 210.510861799051, 18.1216427259469, -5482.517372077657, -3466.3473664475237, 2491.802722953438, 2881.011112932648, -2302.88841886998, 1188.6298428785542, 3247.564756659137, 173.5598003740483, -66.5482066610283, -125.59292431329933, -24.085586323660984, 6097.506932152831, 1185.325341024861, -3222.4199512298965, -346.4135383526685, 1126.3942067228156, -300.0354834796738, -150.11547691042853, -2448.065074104983, 1178.811317758426, 964.7695566098888, 3017.767663005057, 843.8009775622169, -759.9768549629822, 3570.9326876763716, 2431.000713180508, 1585.4275810018548, 23.836486533930845]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6910312641109396, "mean_inference_ms": 1.500552235324651, "mean_action_processing_ms": 0.28297934015612286, "mean_env_wait_ms": 0.12944961307392996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379788875579834, "StateBufferConnector_ms": 0.0032025575637817383, "ViewRequirementAgentConnector_ms": 0.14671850204467773}, "num_episodes": 22, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 574.6100331515339, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.29376815919466, "num_env_steps_trained_throughput_per_sec": 275.29376815919466, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 14293.889, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14293.836, "sample_time_ms": 1268.448, "learn_time_ms": 13006.952, "learn_throughput": 307.528, "synch_weights_time_ms": 16.255}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "6751e_00000", "date": "2024-08-11_19-11-36", "timestamp": 1723417896, "time_this_iter_s": 14.579360008239746, "time_total_s": 264.4772548675537, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea8f8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 264.4772548675537, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 45.8, "ram_util_percent": 83.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8317745220724237, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.957266540123673, "policy_loss": -0.0049522912824556, "vf_loss": 9.961728830690737, "vf_explained_var": 0.00434550059535516, "kl": 0.009799758866790914, "entropy": 1.3372650547633096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7775056747532395, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.286587179779376, "policy_loss": -0.006122894998314598, "vf_loss": 9.291101423899333, "vf_explained_var": 0.00018786015333952728, "kl": 0.00804315695206437, "entropy": 1.1814461113914612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 531.986946748676, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6827.168758978281, "predator_policy": -6275.593725251491}, "policy_reward_max": {"prey_policy": 9198.657762125342, "predator_policy": 7599.60650303683}, "policy_reward_mean": {"prey_policy": 275.3332078656213, "predator_policy": -9.339734491283416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [706.7048833677701, 1.7763568394002505e-15, 738.1442541848003, -3.552713678800501e-15, 363.6109132304482, 737.9368853508934, 0.0, 0.0, 1234.9957441447243, 112.38769611528319, 0.0, 0.0, 482.08289980625483, 0.0, 0.0, 0.0, 1604.376171296062, 3184.8316134846955, 2.1316282072803006e-14, 124.24021924598229, 1561.4267017643756, 2929.4352733179885, 215.28977352108768, 0.0, 620.3404392325592, 1124.2653026882026, 602.5961057601621, 239.3749713580788, 563.6230990858461, -1.4210854715202004e-14, 241.63050782342015, 914.2944604506399, 1630.5288311089894, 1.4210854715202004e-14, 651.600073898878, 0.0, 538.2564020253441, 120.95695270304199, 358.396726932532, 1138.3866114228301, 2693.855417397459, 583.580805727313, 470.8117180937398, 1204.302834062687, 512.1950753621724, 107.98566239329159, 320.3149029093652, 429.4270144838132, 253.8107670529826, 106.27515989112304, 125.90882029178235, 0.0, 638.2515556082395, 995.2812088444034, 3423.668672721605, 0.0, 2195.553801210249, 0.0, 1056.4673710790414, 123.21802518244935, 120.327384671614, 901.7800734305356, 357.7740919282257, 219.4747207206206, 117.75733510004466, 0.0, 636.7649027027803, 363.0783117481466, 252.32612312412564, 0.0, 466.11466669823585, 126.665268316092, 2534.092383240092, 3.552713678800501e-15, 0.0, 2.842170943040401e-14, 141.07406149246117, 130.95952312174742, 933.3644502915473, 0.0, 605.1181992732509, 849.0529452049469, 0.0, 391.86747473496837, 511.1732635977556, 699.8426811259512, 1318.800427690432, 0.0, 3.552713678800501e-15, 0.0, 3.552713678800501e-15, 518.6666899564948, 0.0, 1545.8895892832925, 142.8375179305212, 3.552713678800501e-15, 268.30007432154724, 454.71042587181665, 0.0, 610.2597636577511], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2524.669687912667, -904.4634444245777, 1499.7844522864857, -360.1138085863507, -2110.0790541592373, -3305.0927576039307, 1793.0230154277654, -864.8201167894267, 1081.9850753847404, -1682.3050645598028, 4793.172940056335, -2942.807813881104, 2017.3928412970367, -3322.767907928871, 2710.0036547851896, -4390.336815365301, -2984.250916439233, -1750.206612146179, 3914.3788520081316, -892.6315747520526, 168.76366451945768, -2660.837114955449, 2785.619888800234, 1039.6215233715516, 4250.814495175483, -3078.985508635077, 1440.2773582283899, -1697.0167138346226, 5181.114020173202, -1924.6057857499964, 2564.459466611542, -1881.457392790999, 1362.5410728842423, -1763.5422966276378, -4143.356854048061, -6154.979013660566, 5515.25839939611, -43.69383512731153, 6717.786180227117, -1727.03237111345, 5668.045389131426, -2716.3915711009204, 4049.6840080301295, -1085.8546156815112, 4736.170516795191, -0.15351004814026403, 3074.1261857096224, -3612.3302233225286, -2322.242080633508, -2750.8650053654005, 1078.88688901933, -1255.8752775840678, 7317.681504582457, -3103.7406222687537, 8232.861606313123, -1531.2925960909806, 1719.6606141893687, -306.2367361439433, 1187.4436355757464, -3900.4963058613653, -343.27070608499963, -2033.2358913664166, -3273.3892503201555, -4431.905655868237, -844.0361888238301, -1011.7877845664688, 5239.214870046304, -861.2695581341746, -4307.1494497885915, -4328.675903161429, 5745.283288713417, -4720.151285667811, 6134.4049433839045, -4482.366556539288, 3305.2528985583476, -2880.8924968714964, 2556.7379133574796, -5863.910675907335, 7869.93768541335, -2532.4867242758687, 5112.958986260308, -1445.4607343027778, 3707.1409449195266, -2424.738505888941, 3440.544550667794, -2856.169364271268, 9198.657762125342, -2182.379112514463, 4185.5914536463615, -2958.581992987016, -964.7851046345879, -88.46856117054234, 1089.2364956944377, 258.7576155554839, 4993.88678398899, -294.02334469332766, 1647.3191210891198, -3310.296326795609, -548.8727435421495, 950.3167197557568, 4026.1744171950522, -2380.2657264479067, 1076.7123644318772, -1365.174562760772, 4048.8021144141267, -4210.606407090165, 2040.3523311292383, -1465.1935442695221, 8306.355608191923, -2193.2365732937674, 3510.407401846511, -564.0415813087908, 7341.085442884356, -2244.96177901685, 3028.3469900593536, -3149.496779377727, -1699.4798324674318, -3560.923403681835, 4058.851566907936, -2324.755845977993, 4583.091428909875, -683.8876127176624, 7018.596548550642, -891.2505021189611, 2806.185785048876, -2677.044197645645, 9165.407055691034, 2.932403554767294, -1947.2200431015644, -3307.836457684477, 2530.450621051083, -1416.192045059656, 499.4008746540396, -3283.760528984442, 1832.1692419786514, -1276.9497992561792, -4319.37682285822, -1501.71839984682, 2927.2611475403073, -890.1665373352737, 1345.9168452611978, -1659.782846933108, 4145.417470080094, -3568.6012413739013, 3942.908433157257, -139.5622935706084, -896.7010954693309, -3085.836124145613, 2597.7466213514926, -2681.5707439507287, -4217.387223232311, -1784.5461776245688, 3236.071256571623, -4704.261262614944, 1181.7366582705379, -3390.7618616518052, 3201.2245859588375, -1988.894096025772, 5595.877288144208, -1908.148724029543, 7163.437314269891, -570.4197928660765, 1742.5468508914437, -4704.494970145066, 4966.198066644341, -1911.926133072139, 5221.391945171498, -3267.55528557934, 5988.288641610115, -3407.7445330605024, 6068.997233672692, 409.32725566489074, -2189.5842805412344, -2182.9159630746362, 3411.355786693519, -1975.8864085080766, 1996.7211216772482, -1729.7557306382494, 2847.791359348585, 9.48655382411325, 7859.937457926085, -1527.1625764294968, 6939.016941146768, -4001.1870583378723, -1592.4448268307026, -3894.657607990717, 1292.9914636610501, -2561.638149945916, 4513.207295811246, -6827.168758978281, 3118.965244845431, 742.2019306288953, -3625.632434039383, -4619.77317307547, 5614.13481858727, -4005.7439939891174, 4403.78859940026, -1760.4105425804796, 1017.4614822691526, -2275.6971364593287], "policy_predator_policy_reward": [-189.75912561442163, -723.7422345058974, -288.53576832762633, -851.1348753725084, 1588.1425905686376, 4565.173475379332, -808.3047151403778, -119.89818349796107, 718.8032809476379, 245.12762145787164, 458.9321954290494, -1571.3604362533865, 498.7410702498435, 806.6339963819926, 2395.383360349023, -715.0501997689153, 3311.700326655508, 2657.7529460746277, -341.0835594665077, -2568.276021674287, 670.2940097663651, 1821.7794406696257, -613.9672736197102, -3211.2741385520753, 160.025589211894, -849.7716759460444, 745.0778156047467, -488.33845999851457, -4128.945346714845, 872.4371122916416, -428.71331714181474, -254.28875667872822, 136.35527108477078, 1869.0221239546881, 5883.560978156492, 7599.60650303683, -1124.555614537875, -4347.00894973092, -6275.593725251491, 1409.0801353838012, 1278.0784551756612, -2668.3055714417906, -482.4287288269942, 448.03460979636424, -4498.9528391957165, -21.774394030249187, -18.679191420952314, 556.8832290338562, 4622.767798216306, 1070.67972701516, 373.963656987264, 927.2900342656753, 286.9682952130172, -3898.313071766556, -1770.3603576381538, -4691.833681225914, 84.41967862316127, -934.2204575827404, 1462.9818932383985, 1250.070777047217, 1160.3478303247352, 1457.7892749501011, 5660.371211487372, 2959.218155151661, 2068.3951497217295, 1417.957654777563, -1963.7699977517752, -2414.1753141603594, 1964.6991103536961, 7322.726316495201, -1415.0496423259958, 389.9176392803838, -1289.1552618963299, 175.37327707705583, -602.9797419689457, 299.5762929851346, 1936.99418316696, 1728.5753063154307, 75.16716421003623, -4274.2315139246875, -2527.9136451033773, 1554.2708105433105, -1463.549582553236, 764.7279492499612, -851.3589195245073, 737.7954512217176, -5252.425743157289, -559.5500723909014, -3073.315588424479, 2358.501203127307, 1028.5203510259933, 132.7189771724279, -429.1525669189955, -598.52664142156, 21.037899605562444, -4291.474324417418, 686.028912898034, 1230.7590598614388, 1004.7810171395208, -1299.9498334620057, -485.9165335691125, -1034.0833368862511, 689.6947672182998, -401.23256888940364, 1293.4442190864024, -493.38837080212585, 696.9009972621565, -276.77857527746767, -3391.254036776483, 701.8036745999339, -1788.1731016573422, -1158.1927188803784, -2807.011275512921, -93.55858714434189, -194.15766567402423, 315.3074549923955, 4221.810440303332, 2095.0601669249795, 1467.9860919999433, -3078.8637877474375, -200.25378793239832, -3578.6226435881968, 156.5738802141098, -5382.139853215257, 210.510861799051, 18.1216427259469, -5482.517372077657, -3466.3473664475237, 2491.802722953438, 2881.011112932648, -2302.88841886998, 1188.6298428785542, 3247.564756659137, 173.5598003740483, -66.5482066610283, -125.59292431329933, -24.085586323660984, 6097.506932152831, 1185.325341024861, -3222.4199512298965, -346.4135383526685, 1126.3942067228156, -300.0354834796738, -150.11547691042853, -2448.065074104983, 1178.811317758426, 964.7695566098888, 3017.767663005057, 843.8009775622169, -759.9768549629822, 3570.9326876763716, 2431.000713180508, 1585.4275810018548, 23.836486533930845, -208.90969659218663, 2548.8944230952025, -295.46563880007784, 16.49959915855692, -3025.611396495567, -662.1171676191008, -333.1442950630251, -5654.755027067536, 2364.0243452549003, 1446.9767192036657, -718.6581077095807, -2335.613825862621, -2371.542802635117, 809.5736177779263, -2983.9951220795274, 914.6242771276718, -4027.9711055908297, -1750.5107026208002, 4404.430657891985, 1286.8700134143162, 9.28960416552184, -1444.758982350965, 656.4486573140347, -923.4140483530349, -3002.450950170035, 145.17303699734128, -4915.498408246711, -1417.2764732498797, 110.05217140745627, -2529.215364259852, 2759.809417162902, 2727.293017658518, 776.5067592737757, 2038.0295162943853, 48.345741462255106, 2408.4532396353015, -3818.0557506827, -43.11142479162649, 4248.832689654205, 4264.872991782195, -1723.3604676285918, 569.6800689022552, -2257.150639337429, -386.2274174823538, 2426.5992748358008, -558.1038569878737]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6970733252237055, "mean_inference_ms": 1.5134748353045018, "mean_action_processing_ms": 0.2868428008374901, "mean_env_wait_ms": 0.13075701346906468, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004017829895019531, "StateBufferConnector_ms": 0.003287196159362793, "ViewRequirementAgentConnector_ms": 0.15529167652130127}, "num_episodes": 23, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 531.986946748676, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.7398818655617, "num_env_steps_trained_throughput_per_sec": 282.7398818655617, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 14327.945, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14327.893, "sample_time_ms": 1261.126, "learn_time_ms": 13048.812, "learn_throughput": 306.541, "synch_weights_time_ms": 15.797}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "6751e_00000", "date": "2024-08-11_19-11-50", "timestamp": 1723417910, "time_this_iter_s": 14.196784973144531, "time_total_s": 278.67403984069824, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea979d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 278.67403984069824, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 45.88095238095239, "ram_util_percent": 83.11428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7771746950174766, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.952997558835953, "policy_loss": -0.003870398985596482, "vf_loss": 9.956467963021899, "vf_explained_var": -0.006281595854532151, "kl": 0.008000347726804663, "entropy": 1.2721172716251756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.838021726441131, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.31872550217563, "policy_loss": -0.007369055346186672, "vf_loss": 9.324632142586683, "vf_explained_var": 2.8788444226381008e-05, "kl": 0.00731214046176158, "entropy": 1.1892405707369407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 552.0894998449126, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6827.168758978281, "predator_policy": -6275.593725251491}, "policy_reward_max": {"prey_policy": 9198.657762125342, "predator_policy": 7322.726316495201}, "policy_reward_mean": {"prey_policy": 453.78631566572216, "predator_policy": -177.74156574326622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.1316282072803006e-14, 124.24021924598229, 1561.4267017643756, 2929.4352733179885, 215.28977352108768, 0.0, 620.3404392325592, 1124.2653026882026, 602.5961057601621, 239.3749713580788, 563.6230990858461, -1.4210854715202004e-14, 241.63050782342015, 914.2944604506399, 1630.5288311089894, 1.4210854715202004e-14, 651.600073898878, 0.0, 538.2564020253441, 120.95695270304199, 358.396726932532, 1138.3866114228301, 2693.855417397459, 583.580805727313, 470.8117180937398, 1204.302834062687, 512.1950753621724, 107.98566239329159, 320.3149029093652, 429.4270144838132, 253.8107670529826, 106.27515989112304, 125.90882029178235, 0.0, 638.2515556082395, 995.2812088444034, 3423.668672721605, 0.0, 2195.553801210249, 0.0, 1056.4673710790414, 123.21802518244935, 120.327384671614, 901.7800734305356, 357.7740919282257, 219.4747207206206, 117.75733510004466, 0.0, 636.7649027027803, 363.0783117481466, 252.32612312412564, 0.0, 466.11466669823585, 126.665268316092, 2534.092383240092, 3.552713678800501e-15, 0.0, 2.842170943040401e-14, 141.07406149246117, 130.95952312174742, 933.3644502915473, 0.0, 605.1181992732509, 849.0529452049469, 0.0, 391.86747473496837, 511.1732635977556, 699.8426811259512, 1318.800427690432, 0.0, 3.552713678800501e-15, 0.0, 3.552713678800501e-15, 518.6666899564948, 0.0, 1545.8895892832925, 142.8375179305212, 3.552713678800501e-15, 268.30007432154724, 454.71042587181665, 0.0, 610.2597636577511, -3.552713678800501e-15, 1963.679212889075, 1.4210854715202004e-14, 2530.0528592241862, 242.4549182723061, 261.0831088084324, 0.0, 1061.9341173018074, 119.4756729285335, 372.02243500041646, 1137.432682154475, 747.748323037651, 494.63496979519323, 686.5996881821726, 0.0, 614.5459045407924, 943.6624784695285, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5515.25839939611, -43.69383512731153, 6717.786180227117, -1727.03237111345, 5668.045389131426, -2716.3915711009204, 4049.6840080301295, -1085.8546156815112, 4736.170516795191, -0.15351004814026403, 3074.1261857096224, -3612.3302233225286, -2322.242080633508, -2750.8650053654005, 1078.88688901933, -1255.8752775840678, 7317.681504582457, -3103.7406222687537, 8232.861606313123, -1531.2925960909806, 1719.6606141893687, -306.2367361439433, 1187.4436355757464, -3900.4963058613653, -343.27070608499963, -2033.2358913664166, -3273.3892503201555, -4431.905655868237, -844.0361888238301, -1011.7877845664688, 5239.214870046304, -861.2695581341746, -4307.1494497885915, -4328.675903161429, 5745.283288713417, -4720.151285667811, 6134.4049433839045, -4482.366556539288, 3305.2528985583476, -2880.8924968714964, 2556.7379133574796, -5863.910675907335, 7869.93768541335, -2532.4867242758687, 5112.958986260308, -1445.4607343027778, 3707.1409449195266, -2424.738505888941, 3440.544550667794, -2856.169364271268, 9198.657762125342, -2182.379112514463, 4185.5914536463615, -2958.581992987016, -964.7851046345879, -88.46856117054234, 1089.2364956944377, 258.7576155554839, 4993.88678398899, -294.02334469332766, 1647.3191210891198, -3310.296326795609, -548.8727435421495, 950.3167197557568, 4026.1744171950522, -2380.2657264479067, 1076.7123644318772, -1365.174562760772, 4048.8021144141267, -4210.606407090165, 2040.3523311292383, -1465.1935442695221, 8306.355608191923, -2193.2365732937674, 3510.407401846511, -564.0415813087908, 7341.085442884356, -2244.96177901685, 3028.3469900593536, -3149.496779377727, -1699.4798324674318, -3560.923403681835, 4058.851566907936, -2324.755845977993, 4583.091428909875, -683.8876127176624, 7018.596548550642, -891.2505021189611, 2806.185785048876, -2677.044197645645, 9165.407055691034, 2.932403554767294, -1947.2200431015644, -3307.836457684477, 2530.450621051083, -1416.192045059656, 499.4008746540396, -3283.760528984442, 1832.1692419786514, -1276.9497992561792, -4319.37682285822, -1501.71839984682, 2927.2611475403073, -890.1665373352737, 1345.9168452611978, -1659.782846933108, 4145.417470080094, -3568.6012413739013, 3942.908433157257, -139.5622935706084, -896.7010954693309, -3085.836124145613, 2597.7466213514926, -2681.5707439507287, -4217.387223232311, -1784.5461776245688, 3236.071256571623, -4704.261262614944, 1181.7366582705379, -3390.7618616518052, 3201.2245859588375, -1988.894096025772, 5595.877288144208, -1908.148724029543, 7163.437314269891, -570.4197928660765, 1742.5468508914437, -4704.494970145066, 4966.198066644341, -1911.926133072139, 5221.391945171498, -3267.55528557934, 5988.288641610115, -3407.7445330605024, 6068.997233672692, 409.32725566489074, -2189.5842805412344, -2182.9159630746362, 3411.355786693519, -1975.8864085080766, 1996.7211216772482, -1729.7557306382494, 2847.791359348585, 9.48655382411325, 7859.937457926085, -1527.1625764294968, 6939.016941146768, -4001.1870583378723, -1592.4448268307026, -3894.657607990717, 1292.9914636610501, -2561.638149945916, 4513.207295811246, -6827.168758978281, 3118.965244845431, 742.2019306288953, -3625.632434039383, -4619.77317307547, 5614.13481858727, -4005.7439939891174, 4403.78859940026, -1760.4105425804796, 1017.4614822691526, -2275.6971364593287, 269.05571565535087, 472.64083022815703, 2452.455921694775, -5411.631785138647, 1377.9203046134737, 135.65816517855617, 7865.139179272709, -5639.080521269564, 3774.4082785523615, -2229.5349143725584, -2543.9534862056353, -1517.6982199950814, 881.3434719060184, -3772.97890041287, -736.5602625827947, -741.6957126334152, 6394.429637945664, 37.900596943732495, 1770.8303477472039, -2870.9734801994973, 8315.936971875106, -2216.474197820041, 8317.525645564905, -2023.6339239561646, 3363.600557240919, -2756.4689791512374, 2801.4699397121913, -457.87638660179573, 3557.282512152777, -1667.3236155118207, 5977.275669557935, -3087.830200700525, 3108.46794025246, -2095.816100188215, 3659.7771107584335, 1239.9988918912663], "policy_predator_policy_reward": [-1124.555614537875, -4347.00894973092, -6275.593725251491, 1409.0801353838012, 1278.0784551756612, -2668.3055714417906, -482.4287288269942, 448.03460979636424, -4498.9528391957165, -21.774394030249187, -18.679191420952314, 556.8832290338562, 4622.767798216306, 1070.67972701516, 373.963656987264, 927.2900342656753, 286.9682952130172, -3898.313071766556, -1770.3603576381538, -4691.833681225914, 84.41967862316127, -934.2204575827404, 1462.9818932383985, 1250.070777047217, 1160.3478303247352, 1457.7892749501011, 5660.371211487372, 2959.218155151661, 2068.3951497217295, 1417.957654777563, -1963.7699977517752, -2414.1753141603594, 1964.6991103536961, 7322.726316495201, -1415.0496423259958, 389.9176392803838, -1289.1552618963299, 175.37327707705583, -602.9797419689457, 299.5762929851346, 1936.99418316696, 1728.5753063154307, 75.16716421003623, -4274.2315139246875, -2527.9136451033773, 1554.2708105433105, -1463.549582553236, 764.7279492499612, -851.3589195245073, 737.7954512217176, -5252.425743157289, -559.5500723909014, -3073.315588424479, 2358.501203127307, 1028.5203510259933, 132.7189771724279, -429.1525669189955, -598.52664142156, 21.037899605562444, -4291.474324417418, 686.028912898034, 1230.7590598614388, 1004.7810171395208, -1299.9498334620057, -485.9165335691125, -1034.0833368862511, 689.6947672182998, -401.23256888940364, 1293.4442190864024, -493.38837080212585, 696.9009972621565, -276.77857527746767, -3391.254036776483, 701.8036745999339, -1788.1731016573422, -1158.1927188803784, -2807.011275512921, -93.55858714434189, -194.15766567402423, 315.3074549923955, 4221.810440303332, 2095.0601669249795, 1467.9860919999433, -3078.8637877474375, -200.25378793239832, -3578.6226435881968, 156.5738802141098, -5382.139853215257, 210.510861799051, 18.1216427259469, -5482.517372077657, -3466.3473664475237, 2491.802722953438, 2881.011112932648, -2302.88841886998, 1188.6298428785542, 3247.564756659137, 173.5598003740483, -66.5482066610283, -125.59292431329933, -24.085586323660984, 6097.506932152831, 1185.325341024861, -3222.4199512298965, -346.4135383526685, 1126.3942067228156, -300.0354834796738, -150.11547691042853, -2448.065074104983, 1178.811317758426, 964.7695566098888, 3017.767663005057, 843.8009775622169, -759.9768549629822, 3570.9326876763716, 2431.000713180508, 1585.4275810018548, 23.836486533930845, -208.90969659218663, 2548.8944230952025, -295.46563880007784, 16.49959915855692, -3025.611396495567, -662.1171676191008, -333.1442950630251, -5654.755027067536, 2364.0243452549003, 1446.9767192036657, -718.6581077095807, -2335.613825862621, -2371.542802635117, 809.5736177779263, -2983.9951220795274, 914.6242771276718, -4027.9711055908297, -1750.5107026208002, 4404.430657891985, 1286.8700134143162, 9.28960416552184, -1444.758982350965, 656.4486573140347, -923.4140483530349, -3002.450950170035, 145.17303699734128, -4915.498408246711, -1417.2764732498797, 110.05217140745627, -2529.215364259852, 2759.809417162902, 2727.293017658518, 776.5067592737757, 2038.0295162943853, 48.345741462255106, 2408.4532396353015, -3818.0557506827, -43.11142479162649, 4248.832689654205, 4264.872991782195, -1723.3604676285918, 569.6800689022552, -2257.150639337429, -386.2274174823538, 2426.5992748358008, -558.1038569878737, 62.342912339640016, -804.0394582231481, 4136.030123499978, 786.8249528329711, -810.1997532391182, -703.3787165529128, 3421.1736345140725, -3117.1794332930444, -1680.4921043300728, 378.0736584225752, 1421.0542941922622, 2901.680520816888, 369.5820701698083, 2522.0533583370416, 531.1565862573232, 2009.033506260691, -4696.500074349321, -1616.3544876115418, 59.70285719317235, 1412.4627102595366, -335.3613358117897, -4626.66875608881, -4583.37506929436, -962.7683292767368, 984.1851335323538, -1096.681741826846, -735.08471654305, -921.9091483851734, -525.6889409941045, -1364.269955646853, 149.48843672321075, -2424.3880010398316, -133.65511535462866, 64.66575375991492, -1500.3894248078486, -3399.3865778418526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7009376514730021, "mean_inference_ms": 1.522170450529499, "mean_action_processing_ms": 0.28929887454559416, "mean_env_wait_ms": 0.13160319960192673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004052162170410156, "StateBufferConnector_ms": 0.003271937370300293, "ViewRequirementAgentConnector_ms": 0.15459418296813965}, "num_episodes": 18, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 552.0894998449126, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.79184833442, "num_env_steps_trained_throughput_per_sec": 275.79184833442, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 14306.596, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14306.542, "sample_time_ms": 1258.32, "learn_time_ms": 13030.316, "learn_throughput": 306.976, "synch_weights_time_ms": 15.694}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "6751e_00000", "date": "2024-08-11_19-12-05", "timestamp": 1723417925, "time_this_iter_s": 14.55463194847107, "time_total_s": 293.2286717891693, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 293.2286717891693, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 46.135000000000005, "ram_util_percent": 82.85000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8140756902082887, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.953198566638603, "policy_loss": -0.005849282963635035, "vf_loss": 9.958629629851648, "vf_explained_var": -0.003069552637281872, "kl": 0.008364190184025984, "entropy": 1.2817611352476492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7784684914287436, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.260506255538376, "policy_loss": -0.00638741995454347, "vf_loss": 9.26540829037863, "vf_explained_var": 0.0001679029414262721, "kl": 0.007426896328449077, "entropy": 1.199952067521514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 535.798529223466, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6827.168758978281, "predator_policy": -5654.755027067536}, "policy_reward_max": {"prey_policy": 9198.657762125342, "predator_policy": 6097.506932152831}, "policy_reward_mean": {"prey_policy": 460.6688129600084, "predator_policy": -192.76954834827558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [538.2564020253441, 120.95695270304199, 358.396726932532, 1138.3866114228301, 2693.855417397459, 583.580805727313, 470.8117180937398, 1204.302834062687, 512.1950753621724, 107.98566239329159, 320.3149029093652, 429.4270144838132, 253.8107670529826, 106.27515989112304, 125.90882029178235, 0.0, 638.2515556082395, 995.2812088444034, 3423.668672721605, 0.0, 2195.553801210249, 0.0, 1056.4673710790414, 123.21802518244935, 120.327384671614, 901.7800734305356, 357.7740919282257, 219.4747207206206, 117.75733510004466, 0.0, 636.7649027027803, 363.0783117481466, 252.32612312412564, 0.0, 466.11466669823585, 126.665268316092, 2534.092383240092, 3.552713678800501e-15, 0.0, 2.842170943040401e-14, 141.07406149246117, 130.95952312174742, 933.3644502915473, 0.0, 605.1181992732509, 849.0529452049469, 0.0, 391.86747473496837, 511.1732635977556, 699.8426811259512, 1318.800427690432, 0.0, 3.552713678800501e-15, 0.0, 3.552713678800501e-15, 518.6666899564948, 0.0, 1545.8895892832925, 142.8375179305212, 3.552713678800501e-15, 268.30007432154724, 454.71042587181665, 0.0, 610.2597636577511, -3.552713678800501e-15, 1963.679212889075, 1.4210854715202004e-14, 2530.0528592241862, 242.4549182723061, 261.0831088084324, 0.0, 1061.9341173018074, 119.4756729285335, 372.02243500041646, 1137.432682154475, 747.748323037651, 494.63496979519323, 686.5996881821726, 0.0, 614.5459045407924, 943.6624784695285, 0.0, 356.17319330553516, 110.43442944848246, -1.4210854715202004e-14, 1390.8563944675054, 784.4100495871983, 0.0, 2754.4741846856564, 0.0, 688.4960518138713, -7.105427357601002e-15, 893.6268061328312, 112.92848311048846, 566.0843429990473, 782.0070616559917, 0.0, 492.8456260725728, 380.57044596757567, 476.64162786481376], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6134.4049433839045, -4482.366556539288, 3305.2528985583476, -2880.8924968714964, 2556.7379133574796, -5863.910675907335, 7869.93768541335, -2532.4867242758687, 5112.958986260308, -1445.4607343027778, 3707.1409449195266, -2424.738505888941, 3440.544550667794, -2856.169364271268, 9198.657762125342, -2182.379112514463, 4185.5914536463615, -2958.581992987016, -964.7851046345879, -88.46856117054234, 1089.2364956944377, 258.7576155554839, 4993.88678398899, -294.02334469332766, 1647.3191210891198, -3310.296326795609, -548.8727435421495, 950.3167197557568, 4026.1744171950522, -2380.2657264479067, 1076.7123644318772, -1365.174562760772, 4048.8021144141267, -4210.606407090165, 2040.3523311292383, -1465.1935442695221, 8306.355608191923, -2193.2365732937674, 3510.407401846511, -564.0415813087908, 7341.085442884356, -2244.96177901685, 3028.3469900593536, -3149.496779377727, -1699.4798324674318, -3560.923403681835, 4058.851566907936, -2324.755845977993, 4583.091428909875, -683.8876127176624, 7018.596548550642, -891.2505021189611, 2806.185785048876, -2677.044197645645, 9165.407055691034, 2.932403554767294, -1947.2200431015644, -3307.836457684477, 2530.450621051083, -1416.192045059656, 499.4008746540396, -3283.760528984442, 1832.1692419786514, -1276.9497992561792, -4319.37682285822, -1501.71839984682, 2927.2611475403073, -890.1665373352737, 1345.9168452611978, -1659.782846933108, 4145.417470080094, -3568.6012413739013, 3942.908433157257, -139.5622935706084, -896.7010954693309, -3085.836124145613, 2597.7466213514926, -2681.5707439507287, -4217.387223232311, -1784.5461776245688, 3236.071256571623, -4704.261262614944, 1181.7366582705379, -3390.7618616518052, 3201.2245859588375, -1988.894096025772, 5595.877288144208, -1908.148724029543, 7163.437314269891, -570.4197928660765, 1742.5468508914437, -4704.494970145066, 4966.198066644341, -1911.926133072139, 5221.391945171498, -3267.55528557934, 5988.288641610115, -3407.7445330605024, 6068.997233672692, 409.32725566489074, -2189.5842805412344, -2182.9159630746362, 3411.355786693519, -1975.8864085080766, 1996.7211216772482, -1729.7557306382494, 2847.791359348585, 9.48655382411325, 7859.937457926085, -1527.1625764294968, 6939.016941146768, -4001.1870583378723, -1592.4448268307026, -3894.657607990717, 1292.9914636610501, -2561.638149945916, 4513.207295811246, -6827.168758978281, 3118.965244845431, 742.2019306288953, -3625.632434039383, -4619.77317307547, 5614.13481858727, -4005.7439939891174, 4403.78859940026, -1760.4105425804796, 1017.4614822691526, -2275.6971364593287, 269.05571565535087, 472.64083022815703, 2452.455921694775, -5411.631785138647, 1377.9203046134737, 135.65816517855617, 7865.139179272709, -5639.080521269564, 3774.4082785523615, -2229.5349143725584, -2543.9534862056353, -1517.6982199950814, 881.3434719060184, -3772.97890041287, -736.5602625827947, -741.6957126334152, 6394.429637945664, 37.900596943732495, 1770.8303477472039, -2870.9734801994973, 8315.936971875106, -2216.474197820041, 8317.525645564905, -2023.6339239561646, 3363.600557240919, -2756.4689791512374, 2801.4699397121913, -457.87638660179573, 3557.282512152777, -1667.3236155118207, 5977.275669557935, -3087.830200700525, 3108.46794025246, -2095.816100188215, 3659.7771107584335, 1239.9988918912663, -4049.2430790082476, -2389.7445759193006, 2264.7661450930086, -2934.640072957512, 5858.646520858854, -279.9364750244041, 372.452008839931, -2009.8420765586472, 3267.024946233376, -1182.8835997129302, 6162.039155525319, -2493.8053079982783, 4737.218741392269, -945.5261653849587, 1517.7934370512774, -606.9788445618731, 2894.935307335715, -2782.5437010974124, 3685.5946012148906, -1315.4107338503352, 5505.52323560154, -1372.640039095806, 124.17007478751933, -1386.0679319557178, 4270.8152592565475, -1708.0615983889857, 6787.591901365067, -4271.800028377285, 1526.199199900527, -5334.936186971686, 2816.6945994536077, -2322.1977087509185, 4099.477818721717, -3004.6028477651575, -3933.2266285296923, -419.32922825942023], "policy_predator_policy_reward": [-1289.1552618963299, 175.37327707705583, -602.9797419689457, 299.5762929851346, 1936.99418316696, 1728.5753063154307, 75.16716421003623, -4274.2315139246875, -2527.9136451033773, 1554.2708105433105, -1463.549582553236, 764.7279492499612, -851.3589195245073, 737.7954512217176, -5252.425743157289, -559.5500723909014, -3073.315588424479, 2358.501203127307, 1028.5203510259933, 132.7189771724279, -429.1525669189955, -598.52664142156, 21.037899605562444, -4291.474324417418, 686.028912898034, 1230.7590598614388, 1004.7810171395208, -1299.9498334620057, -485.9165335691125, -1034.0833368862511, 689.6947672182998, -401.23256888940364, 1293.4442190864024, -493.38837080212585, 696.9009972621565, -276.77857527746767, -3391.254036776483, 701.8036745999339, -1788.1731016573422, -1158.1927188803784, -2807.011275512921, -93.55858714434189, -194.15766567402423, 315.3074549923955, 4221.810440303332, 2095.0601669249795, 1467.9860919999433, -3078.8637877474375, -200.25378793239832, -3578.6226435881968, 156.5738802141098, -5382.139853215257, 210.510861799051, 18.1216427259469, -5482.517372077657, -3466.3473664475237, 2491.802722953438, 2881.011112932648, -2302.88841886998, 1188.6298428785542, 3247.564756659137, 173.5598003740483, -66.5482066610283, -125.59292431329933, -24.085586323660984, 6097.506932152831, 1185.325341024861, -3222.4199512298965, -346.4135383526685, 1126.3942067228156, -300.0354834796738, -150.11547691042853, -2448.065074104983, 1178.811317758426, 964.7695566098888, 3017.767663005057, 843.8009775622169, -759.9768549629822, 3570.9326876763716, 2431.000713180508, 1585.4275810018548, 23.836486533930845, -208.90969659218663, 2548.8944230952025, -295.46563880007784, 16.49959915855692, -3025.611396495567, -662.1171676191008, -333.1442950630251, -5654.755027067536, 2364.0243452549003, 1446.9767192036657, -718.6581077095807, -2335.613825862621, -2371.542802635117, 809.5736177779263, -2983.9951220795274, 914.6242771276718, -4027.9711055908297, -1750.5107026208002, 4404.430657891985, 1286.8700134143162, 9.28960416552184, -1444.758982350965, 656.4486573140347, -923.4140483530349, -3002.450950170035, 145.17303699734128, -4915.498408246711, -1417.2764732498797, 110.05217140745627, -2529.215364259852, 2759.809417162902, 2727.293017658518, 776.5067592737757, 2038.0295162943853, 48.345741462255106, 2408.4532396353015, -3818.0557506827, -43.11142479162649, 4248.832689654205, 4264.872991782195, -1723.3604676285918, 569.6800689022552, -2257.150639337429, -386.2274174823538, 2426.5992748358008, -558.1038569878737, 62.342912339640016, -804.0394582231481, 4136.030123499978, 786.8249528329711, -810.1997532391182, -703.3787165529128, 3421.1736345140725, -3117.1794332930444, -1680.4921043300728, 378.0736584225752, 1421.0542941922622, 2901.680520816888, 369.5820701698083, 2522.0533583370416, 531.1565862573232, 2009.033506260691, -4696.500074349321, -1616.3544876115418, 59.70285719317235, 1412.4627102595366, -335.3613358117897, -4626.66875608881, -4583.37506929436, -962.7683292767368, 984.1851335323538, -1096.681741826846, -735.08471654305, -921.9091483851734, -525.6889409941045, -1364.269955646853, 149.48843672321075, -2424.3880010398316, -133.65511535462866, 64.66575375991492, -1500.3894248078486, -3399.3865778418526, 5523.109869943047, 1272.050978290038, 442.5345535512434, 337.77380376174244, -2005.92938654723, -3572.780659287223, 417.18731823016003, 2611.0591439560585, -1275.3654858902578, -24.365811042988675, -2463.810822823585, -1204.4230247034584, 2495.9769172632673, -3533.1953085849195, 195.2027596542208, -1106.0173521436266, -1443.62252355928, 2019.7269691348517, -631.353427254541, -1738.8304401100113, -1085.617734294545, -2153.6386560783576, -1928.8341857749729, 3303.660526053661, -392.12277261510803, -1604.5465452534045, 896.8045318053544, -2630.5893431371533, 1950.3903390386972, 1858.3466480324587, -126.45104363242088, 124.7997790023088, 462.8223888552594, -1177.1269138442456, 4921.395994982349, -92.19851032842098]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6984512986913649, "mean_inference_ms": 1.5134453237751773, "mean_action_processing_ms": 0.2876743129513361, "mean_env_wait_ms": 0.13106769464969287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004438042640686035, "StateBufferConnector_ms": 0.0038796663284301758, "ViewRequirementAgentConnector_ms": 0.11945533752441406}, "num_episodes": 18, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 535.798529223466, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.28980674298407, "num_env_steps_trained_throughput_per_sec": 271.28980674298407, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 14341.213, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14341.16, "sample_time_ms": 1252.847, "learn_time_ms": 13070.662, "learn_throughput": 306.029, "synch_weights_time_ms": 15.643}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "6751e_00000", "date": "2024-08-11_19-12-20", "timestamp": 1723417940, "time_this_iter_s": 14.80254578590393, "time_total_s": 308.03121757507324, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 308.03121757507324, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 46.98636363636364, "ram_util_percent": 83.19545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8183587115987269, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.95185169593367, "policy_loss": -0.008314138557638717, "vf_loss": 9.959567426247572, "vf_explained_var": -0.00025281991277422225, "kl": 0.01196829506088503, "entropy": 1.1940506675255993, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8374155184106221, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.601414295479103, "policy_loss": -0.00793962244501229, "vf_loss": 9.607844238180332, "vf_explained_var": 0.00022501444059704978, "kl": 0.007548408628817455, "entropy": 1.1621047584468094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 3423.668672721605, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 534.5149579245189, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6827.168758978281, "predator_policy": -5654.755027067536}, "policy_reward_max": {"prey_policy": 9165.407055691034, "predator_policy": 6097.506932152831}, "policy_reward_mean": {"prey_policy": 323.3078038759877, "predator_policy": -56.05032491372852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3423.668672721605, 0.0, 2195.553801210249, 0.0, 1056.4673710790414, 123.21802518244935, 120.327384671614, 901.7800734305356, 357.7740919282257, 219.4747207206206, 117.75733510004466, 0.0, 636.7649027027803, 363.0783117481466, 252.32612312412564, 0.0, 466.11466669823585, 126.665268316092, 2534.092383240092, 3.552713678800501e-15, 0.0, 2.842170943040401e-14, 141.07406149246117, 130.95952312174742, 933.3644502915473, 0.0, 605.1181992732509, 849.0529452049469, 0.0, 391.86747473496837, 511.1732635977556, 699.8426811259512, 1318.800427690432, 0.0, 3.552713678800501e-15, 0.0, 3.552713678800501e-15, 518.6666899564948, 0.0, 1545.8895892832925, 142.8375179305212, 3.552713678800501e-15, 268.30007432154724, 454.71042587181665, 0.0, 610.2597636577511, -3.552713678800501e-15, 1963.679212889075, 1.4210854715202004e-14, 2530.0528592241862, 242.4549182723061, 261.0831088084324, 0.0, 1061.9341173018074, 119.4756729285335, 372.02243500041646, 1137.432682154475, 747.748323037651, 494.63496979519323, 686.5996881821726, 0.0, 614.5459045407924, 943.6624784695285, 0.0, 356.17319330553516, 110.43442944848246, -1.4210854715202004e-14, 1390.8563944675054, 784.4100495871983, 0.0, 2754.4741846856564, 0.0, 688.4960518138713, -7.105427357601002e-15, 893.6268061328312, 112.92848311048846, 566.0843429990473, 782.0070616559917, 0.0, 492.8456260725728, 380.57044596757567, 476.64162786481376, 341.3093701217018, 0.0, 653.7272252758962, 259.27913251209384, 1837.8352206004165, 545.4682632139053, 1302.8789587796316, 571.8215436012496, 209.33233136319106, 910.6168257454486, 645.75191995296, 547.5680405656607, 665.7556556635828, 490.7772769551465, 259.485287410288, 588.4481779970752, 502.4803175485621, 137.1049580005975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8306.355608191923, -2193.2365732937674, 3510.407401846511, -564.0415813087908, 7341.085442884356, -2244.96177901685, 3028.3469900593536, -3149.496779377727, -1699.4798324674318, -3560.923403681835, 4058.851566907936, -2324.755845977993, 4583.091428909875, -683.8876127176624, 7018.596548550642, -891.2505021189611, 2806.185785048876, -2677.044197645645, 9165.407055691034, 2.932403554767294, -1947.2200431015644, -3307.836457684477, 2530.450621051083, -1416.192045059656, 499.4008746540396, -3283.760528984442, 1832.1692419786514, -1276.9497992561792, -4319.37682285822, -1501.71839984682, 2927.2611475403073, -890.1665373352737, 1345.9168452611978, -1659.782846933108, 4145.417470080094, -3568.6012413739013, 3942.908433157257, -139.5622935706084, -896.7010954693309, -3085.836124145613, 2597.7466213514926, -2681.5707439507287, -4217.387223232311, -1784.5461776245688, 3236.071256571623, -4704.261262614944, 1181.7366582705379, -3390.7618616518052, 3201.2245859588375, -1988.894096025772, 5595.877288144208, -1908.148724029543, 7163.437314269891, -570.4197928660765, 1742.5468508914437, -4704.494970145066, 4966.198066644341, -1911.926133072139, 5221.391945171498, -3267.55528557934, 5988.288641610115, -3407.7445330605024, 6068.997233672692, 409.32725566489074, -2189.5842805412344, -2182.9159630746362, 3411.355786693519, -1975.8864085080766, 1996.7211216772482, -1729.7557306382494, 2847.791359348585, 9.48655382411325, 7859.937457926085, -1527.1625764294968, 6939.016941146768, -4001.1870583378723, -1592.4448268307026, -3894.657607990717, 1292.9914636610501, -2561.638149945916, 4513.207295811246, -6827.168758978281, 3118.965244845431, 742.2019306288953, -3625.632434039383, -4619.77317307547, 5614.13481858727, -4005.7439939891174, 4403.78859940026, -1760.4105425804796, 1017.4614822691526, -2275.6971364593287, 269.05571565535087, 472.64083022815703, 2452.455921694775, -5411.631785138647, 1377.9203046134737, 135.65816517855617, 7865.139179272709, -5639.080521269564, 3774.4082785523615, -2229.5349143725584, -2543.9534862056353, -1517.6982199950814, 881.3434719060184, -3772.97890041287, -736.5602625827947, -741.6957126334152, 6394.429637945664, 37.900596943732495, 1770.8303477472039, -2870.9734801994973, 8315.936971875106, -2216.474197820041, 8317.525645564905, -2023.6339239561646, 3363.600557240919, -2756.4689791512374, 2801.4699397121913, -457.87638660179573, 3557.282512152777, -1667.3236155118207, 5977.275669557935, -3087.830200700525, 3108.46794025246, -2095.816100188215, 3659.7771107584335, 1239.9988918912663, -4049.2430790082476, -2389.7445759193006, 2264.7661450930086, -2934.640072957512, 5858.646520858854, -279.9364750244041, 372.452008839931, -2009.8420765586472, 3267.024946233376, -1182.8835997129302, 6162.039155525319, -2493.8053079982783, 4737.218741392269, -945.5261653849587, 1517.7934370512774, -606.9788445618731, 2894.935307335715, -2782.5437010974124, 3685.5946012148906, -1315.4107338503352, 5505.52323560154, -1372.640039095806, 124.17007478751933, -1386.0679319557178, 4270.8152592565475, -1708.0615983889857, 6787.591901365067, -4271.800028377285, 1526.199199900527, -5334.936186971686, 2816.6945994536077, -2322.1977087509185, 4099.477818721717, -3004.6028477651575, -3933.2266285296923, -419.32922825942023, -1763.2218770359711, -979.6043455184174, -3500.3421508052443, -1234.1748509871572, 6405.552424899948, -3278.1029176452935, 7369.006597371129, -2099.288946329558, 5517.041230453784, -1336.4215452593137, -1935.049688509779, -3810.312109290691, 8403.897686606, -333.00043385478267, -739.8886277897079, -1691.0362657836492, 2154.0709300387616, 825.0075581708801, 2190.644427251584, -2697.430241164353, 3637.586851325001, 284.80101556923717, 308.6013647655359, -5558.31345117045, -1521.5352002131447, 622.9199085526102, 2157.3654829644634, -2317.1667216021456, 5160.222246130451, -1685.7595267978804, 3572.788933811029, -2349.4049241345747, -2903.2014017405318, -3359.781695654933, -3052.466266926819, -4548.092669876674], "policy_predator_policy_reward": [-3391.254036776483, 701.8036745999339, -1788.1731016573422, -1158.1927188803784, -2807.011275512921, -93.55858714434189, -194.15766567402423, 315.3074549923955, 4221.810440303332, 2095.0601669249795, 1467.9860919999433, -3078.8637877474375, -200.25378793239832, -3578.6226435881968, 156.5738802141098, -5382.139853215257, 210.510861799051, 18.1216427259469, -5482.517372077657, -3466.3473664475237, 2491.802722953438, 2881.011112932648, -2302.88841886998, 1188.6298428785542, 3247.564756659137, 173.5598003740483, -66.5482066610283, -125.59292431329933, -24.085586323660984, 6097.506932152831, 1185.325341024861, -3222.4199512298965, -346.4135383526685, 1126.3942067228156, -300.0354834796738, -150.11547691042853, -2448.065074104983, 1178.811317758426, 964.7695566098888, 3017.767663005057, 843.8009775622169, -759.9768549629822, 3570.9326876763716, 2431.000713180508, 1585.4275810018548, 23.836486533930845, -208.90969659218663, 2548.8944230952025, -295.46563880007784, 16.49959915855692, -3025.611396495567, -662.1171676191008, -333.1442950630251, -5654.755027067536, 2364.0243452549003, 1446.9767192036657, -718.6581077095807, -2335.613825862621, -2371.542802635117, 809.5736177779263, -2983.9951220795274, 914.6242771276718, -4027.9711055908297, -1750.5107026208002, 4404.430657891985, 1286.8700134143162, 9.28960416552184, -1444.758982350965, 656.4486573140347, -923.4140483530349, -3002.450950170035, 145.17303699734128, -4915.498408246711, -1417.2764732498797, 110.05217140745627, -2529.215364259852, 2759.809417162902, 2727.293017658518, 776.5067592737757, 2038.0295162943853, 48.345741462255106, 2408.4532396353015, -3818.0557506827, -43.11142479162649, 4248.832689654205, 4264.872991782195, -1723.3604676285918, 569.6800689022552, -2257.150639337429, -386.2274174823538, 2426.5992748358008, -558.1038569878737, 62.342912339640016, -804.0394582231481, 4136.030123499978, 786.8249528329711, -810.1997532391182, -703.3787165529128, 3421.1736345140725, -3117.1794332930444, -1680.4921043300728, 378.0736584225752, 1421.0542941922622, 2901.680520816888, 369.5820701698083, 2522.0533583370416, 531.1565862573232, 2009.033506260691, -4696.500074349321, -1616.3544876115418, 59.70285719317235, 1412.4627102595366, -335.3613358117897, -4626.66875608881, -4583.37506929436, -962.7683292767368, 984.1851335323538, -1096.681741826846, -735.08471654305, -921.9091483851734, -525.6889409941045, -1364.269955646853, 149.48843672321075, -2424.3880010398316, -133.65511535462866, 64.66575375991492, -1500.3894248078486, -3399.3865778418526, 5523.109869943047, 1272.050978290038, 442.5345535512434, 337.77380376174244, -2005.92938654723, -3572.780659287223, 417.18731823016003, 2611.0591439560585, -1275.3654858902578, -24.365811042988675, -2463.810822823585, -1204.4230247034584, 2495.9769172632673, -3533.1953085849195, 195.2027596542208, -1106.0173521436266, -1443.62252355928, 2019.7269691348517, -631.353427254541, -1738.8304401100113, -1085.617734294545, -2153.6386560783576, -1928.8341857749729, 3303.660526053661, -392.12277261510803, -1604.5465452534045, 896.8045318053544, -2630.5893431371533, 1950.3903390386972, 1858.3466480324587, -126.45104363242088, 124.7997790023088, 462.8223888552594, -1177.1269138442456, 4921.395994982349, -92.19851032842098, 596.5543812362853, 2487.581211439805, 3207.3753682912857, 1527.141633501115, -2156.6700917898283, -317.0521901889337, -2320.435721199677, -2690.002797329801, -3344.7233286186506, 1001.9388640245984, 4645.610108479719, 1645.2199525346587, -3016.0151861842996, -3752.003107787286, 908.7782258493213, 2093.968211325285, -2557.269057185689, -212.4770996607626, 1584.6414791658806, -167.23883950766074, -1225.5106552838695, -2051.1252916574085, 1113.7119363727768, 4683.5681905978, 987.7006169248081, 576.6703303993097, -517.7195090578871, 1168.2980246507134, 358.9976670745192, -3573.9750989968, -1696.9673714343273, 1062.0315397549487, 4786.143623820299, 1979.3197911237269, 3791.8093812075717, 3945.8545135965196]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6948004106852557, "mean_inference_ms": 1.5039167062723289, "mean_action_processing_ms": 0.2858838163973113, "mean_env_wait_ms": 0.13046809918877464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004530668258666992, "StateBufferConnector_ms": 0.00394892692565918, "ViewRequirementAgentConnector_ms": 0.11881709098815918}, "num_episodes": 18, "episode_return_max": 3423.668672721605, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 534.5149579245189, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.45692699222633, "num_env_steps_trained_throughput_per_sec": 287.45692699222633, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 14313.552, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14313.5, "sample_time_ms": 1241.618, "learn_time_ms": 13054.458, "learn_throughput": 306.409, "synch_weights_time_ms": 15.536}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "6751e_00000", "date": "2024-08-11_19-12-34", "timestamp": 1723417954, "time_this_iter_s": 13.976225137710571, "time_total_s": 322.0074427127838, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eab80d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 322.0074427127838, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 46.44736842105263, "ram_util_percent": 83.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8453988622893732, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.935518696194602, "policy_loss": -0.006342991883127344, "vf_loss": 9.941344967594853, "vf_explained_var": -0.00015417693783997228, "kl": 0.010334345212391865, "entropy": 1.17738454556339, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7825094451033879, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.278314569261338, "policy_loss": -0.006464609421700949, "vf_loss": 9.283387366804495, "vf_explained_var": 0.0002653105233712171, "kl": 0.006959021637811311, "entropy": 1.1672959945819996, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 2754.4741846856564, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 507.2887522398684, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6827.168758978281, "predator_policy": -6817.4782088785505}, "policy_reward_max": {"prey_policy": 8403.897686606, "predator_policy": 5523.109869943047}, "policy_reward_mean": {"prey_policy": 178.32662599503038, "predator_policy": 75.31775012490368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [849.0529452049469, 0.0, 391.86747473496837, 511.1732635977556, 699.8426811259512, 1318.800427690432, 0.0, 3.552713678800501e-15, 0.0, 3.552713678800501e-15, 518.6666899564948, 0.0, 1545.8895892832925, 142.8375179305212, 3.552713678800501e-15, 268.30007432154724, 454.71042587181665, 0.0, 610.2597636577511, -3.552713678800501e-15, 1963.679212889075, 1.4210854715202004e-14, 2530.0528592241862, 242.4549182723061, 261.0831088084324, 0.0, 1061.9341173018074, 119.4756729285335, 372.02243500041646, 1137.432682154475, 747.748323037651, 494.63496979519323, 686.5996881821726, 0.0, 614.5459045407924, 943.6624784695285, 0.0, 356.17319330553516, 110.43442944848246, -1.4210854715202004e-14, 1390.8563944675054, 784.4100495871983, 0.0, 2754.4741846856564, 0.0, 688.4960518138713, -7.105427357601002e-15, 893.6268061328312, 112.92848311048846, 566.0843429990473, 782.0070616559917, 0.0, 492.8456260725728, 380.57044596757567, 476.64162786481376, 341.3093701217018, 0.0, 653.7272252758962, 259.27913251209384, 1837.8352206004165, 545.4682632139053, 1302.8789587796316, 571.8215436012496, 209.33233136319106, 910.6168257454486, 645.75191995296, 547.5680405656607, 665.7556556635828, 490.7772769551465, 259.485287410288, 588.4481779970752, 502.4803175485621, 137.1049580005975, 1145.2231388369526, 0.0, 675.5798125704149, 0.0, -3.552713678800501e-15, 821.9818069050626, 111.35123536232541, 0.0, 485.48788064981164, 230.30293050291584, 0.0, -1.4210854715202004e-14, 0.0, 1.4210854715202004e-14, 0.0, 227.91989760336293, 199.25139867556047, 377.67890517275066, 1361.5634057327168, 220.8214237296738, 573.7877232786897, 0.0, 1243.9663775744605, 1.4210854715202004e-14, 330.35000488376664, 1977.3434252708248, 2000.3494308385286], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1742.5468508914437, -4704.494970145066, 4966.198066644341, -1911.926133072139, 5221.391945171498, -3267.55528557934, 5988.288641610115, -3407.7445330605024, 6068.997233672692, 409.32725566489074, -2189.5842805412344, -2182.9159630746362, 3411.355786693519, -1975.8864085080766, 1996.7211216772482, -1729.7557306382494, 2847.791359348585, 9.48655382411325, 7859.937457926085, -1527.1625764294968, 6939.016941146768, -4001.1870583378723, -1592.4448268307026, -3894.657607990717, 1292.9914636610501, -2561.638149945916, 4513.207295811246, -6827.168758978281, 3118.965244845431, 742.2019306288953, -3625.632434039383, -4619.77317307547, 5614.13481858727, -4005.7439939891174, 4403.78859940026, -1760.4105425804796, 1017.4614822691526, -2275.6971364593287, 269.05571565535087, 472.64083022815703, 2452.455921694775, -5411.631785138647, 1377.9203046134737, 135.65816517855617, 7865.139179272709, -5639.080521269564, 3774.4082785523615, -2229.5349143725584, -2543.9534862056353, -1517.6982199950814, 881.3434719060184, -3772.97890041287, -736.5602625827947, -741.6957126334152, 6394.429637945664, 37.900596943732495, 1770.8303477472039, -2870.9734801994973, 8315.936971875106, -2216.474197820041, 8317.525645564905, -2023.6339239561646, 3363.600557240919, -2756.4689791512374, 2801.4699397121913, -457.87638660179573, 3557.282512152777, -1667.3236155118207, 5977.275669557935, -3087.830200700525, 3108.46794025246, -2095.816100188215, 3659.7771107584335, 1239.9988918912663, -4049.2430790082476, -2389.7445759193006, 2264.7661450930086, -2934.640072957512, 5858.646520858854, -279.9364750244041, 372.452008839931, -2009.8420765586472, 3267.024946233376, -1182.8835997129302, 6162.039155525319, -2493.8053079982783, 4737.218741392269, -945.5261653849587, 1517.7934370512774, -606.9788445618731, 2894.935307335715, -2782.5437010974124, 3685.5946012148906, -1315.4107338503352, 5505.52323560154, -1372.640039095806, 124.17007478751933, -1386.0679319557178, 4270.8152592565475, -1708.0615983889857, 6787.591901365067, -4271.800028377285, 1526.199199900527, -5334.936186971686, 2816.6945994536077, -2322.1977087509185, 4099.477818721717, -3004.6028477651575, -3933.2266285296923, -419.32922825942023, -1763.2218770359711, -979.6043455184174, -3500.3421508052443, -1234.1748509871572, 6405.552424899948, -3278.1029176452935, 7369.006597371129, -2099.288946329558, 5517.041230453784, -1336.4215452593137, -1935.049688509779, -3810.312109290691, 8403.897686606, -333.00043385478267, -739.8886277897079, -1691.0362657836492, 2154.0709300387616, 825.0075581708801, 2190.644427251584, -2697.430241164353, 3637.586851325001, 284.80101556923717, 308.6013647655359, -5558.31345117045, -1521.5352002131447, 622.9199085526102, 2157.3654829644634, -2317.1667216021456, 5160.222246130451, -1685.7595267978804, 3572.788933811029, -2349.4049241345747, -2903.2014017405318, -3359.781695654933, -3052.466266926819, -4548.092669876674, -1836.9972669717447, -3006.8286917749433, -1512.243301023101, 269.79212393807245, -1063.1378101444675, -249.70455443817298, 2294.667506974149, -5673.03228428298, -303.77823631031794, -2719.540109079188, 5805.92406603295, -1869.1818142353889, -2633.717193613913, -1575.7493226799554, -1394.837574386366, -2557.197903519301, 7597.072671700084, -1704.054804072495, -1034.8398888304553, -1365.4276388711735, -99.57336645196962, -4055.9352741708994, 591.5516155674409, -817.5523074873801, 5297.799068042951, -2545.452239653688, 4458.341637331705, -1584.827998978672, 1929.2322369289084, 1047.6349405941505, 4840.668038262145, -2979.464939439858, 6935.1825609113575, 2111.6805086296135, -2910.7974248419246, -2071.9773759591053, -2123.4898007657384, -2106.522447625287, 965.4620496165861, 224.98258262407975, 6526.739259071452, 393.66458445880687, -2685.0808994450936, -2458.422467619544, 3732.1830155258026, -2115.561927264921, 3415.2325909396463, -706.6149597217956, 2599.2071081691693, -3299.129491484499, 610.2752850164485, -2577.80525221581, -1101.4012614909188, -2411.5448329630685], "policy_predator_policy_reward": [2364.0243452549003, 1446.9767192036657, -718.6581077095807, -2335.613825862621, -2371.542802635117, 809.5736177779263, -2983.9951220795274, 914.6242771276718, -4027.9711055908297, -1750.5107026208002, 4404.430657891985, 1286.8700134143162, 9.28960416552184, -1444.758982350965, 656.4486573140347, -923.4140483530349, -3002.450950170035, 145.17303699734128, -4915.498408246711, -1417.2764732498797, 110.05217140745627, -2529.215364259852, 2759.809417162902, 2727.293017658518, 776.5067592737757, 2038.0295162943853, 48.345741462255106, 2408.4532396353015, -3818.0557506827, -43.11142479162649, 4248.832689654205, 4264.872991782195, -1723.3604676285918, 569.6800689022552, -2257.150639337429, -386.2274174823538, 2426.5992748358008, -558.1038569878737, 62.342912339640016, -804.0394582231481, 4136.030123499978, 786.8249528329711, -810.1997532391182, -703.3787165529128, 3421.1736345140725, -3117.1794332930444, -1680.4921043300728, 378.0736584225752, 1421.0542941922622, 2901.680520816888, 369.5820701698083, 2522.0533583370416, 531.1565862573232, 2009.033506260691, -4696.500074349321, -1616.3544876115418, 59.70285719317235, 1412.4627102595366, -335.3613358117897, -4626.66875608881, -4583.37506929436, -962.7683292767368, 984.1851335323538, -1096.681741826846, -735.08471654305, -921.9091483851734, -525.6889409941045, -1364.269955646853, 149.48843672321075, -2424.3880010398316, -133.65511535462866, 64.66575375991492, -1500.3894248078486, -3399.3865778418526, 5523.109869943047, 1272.050978290038, 442.5345535512434, 337.77380376174244, -2005.92938654723, -3572.780659287223, 417.18731823016003, 2611.0591439560585, -1275.3654858902578, -24.365811042988675, -2463.810822823585, -1204.4230247034584, 2495.9769172632673, -3533.1953085849195, 195.2027596542208, -1106.0173521436266, -1443.62252355928, 2019.7269691348517, -631.353427254541, -1738.8304401100113, -1085.617734294545, -2153.6386560783576, -1928.8341857749729, 3303.660526053661, -392.12277261510803, -1604.5465452534045, 896.8045318053544, -2630.5893431371533, 1950.3903390386972, 1858.3466480324587, -126.45104363242088, 124.7997790023088, 462.8223888552594, -1177.1269138442456, 4921.395994982349, -92.19851032842098, 596.5543812362853, 2487.581211439805, 3207.3753682912857, 1527.141633501115, -2156.6700917898283, -317.0521901889337, -2320.435721199677, -2690.002797329801, -3344.7233286186506, 1001.9388640245984, 4645.610108479719, 1645.2199525346587, -3016.0151861842996, -3752.003107787286, 908.7782258493213, 2093.968211325285, -2557.269057185689, -212.4770996607626, 1584.6414791658806, -167.23883950766074, -1225.5106552838695, -2051.1252916574085, 1113.7119363727768, 4683.5681905978, 987.7006169248081, 576.6703303993097, -517.7195090578871, 1168.2980246507134, 358.9976670745192, -3573.9750989968, -1696.9673714343273, 1062.0315397549487, 4786.143623820299, 1979.3197911237269, 3791.8093812075717, 3945.8545135965196, 2060.2680181840237, 3928.7810793996173, 699.0132530534888, 543.4379240315401, 2525.630307547122, -537.2081303940657, 3057.7370296223935, 320.62774768644, 3145.949896105255, -122.63155071574751, -2148.498152807302, -966.2622920851995, 56.371506487484055, 4264.446245168708, 3160.1943583434536, 791.8411195622133, -6817.4782088785505, 1409.9482219007716, 228.04371375233444, 2402.5267444522106, 293.0224038620141, 3862.486236760858, 635.8259336439927, -409.8252417240522, -3392.8920551302926, 640.5452267410222, -3219.6543132726038, 346.1406749195692, -973.4719029522319, -2003.3952745708264, -2419.3473960910596, 786.064194872132, -4264.979566565858, -4582.632104299552, 3487.0816439693594, 1873.3720620044257, 1430.2227377274594, 4161.352916396282, -704.283161333753, -265.34004717723946, -2571.8053945442643, -3774.8107257073075, 1075.386861904652, 4068.1165051599837, -2546.1541961700054, 2173.4994854835854, -2479.764521327002, -228.85310989084957, 148.27211045061932, 882.0002777484789, 146.5167583865375, 3798.3566340836446, 1125.0763284260918, 4388.219196866423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6895114719662948, "mean_inference_ms": 1.4916942987441133, "mean_action_processing_ms": 0.2843892415266269, "mean_env_wait_ms": 0.13001489206930977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005516648292541504, "StateBufferConnector_ms": 0.004220366477966309, "ViewRequirementAgentConnector_ms": 0.12466061115264893}, "num_episodes": 27, "episode_return_max": 2754.4741846856564, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 507.2887522398684, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.5585575542881, "num_env_steps_trained_throughput_per_sec": 271.5585575542881, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 14396.916, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14396.868, "sample_time_ms": 1241.05, "learn_time_ms": 13138.242, "learn_throughput": 304.455, "synch_weights_time_ms": 16.237}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "6751e_00000", "date": "2024-08-11_19-12-48", "timestamp": 1723417968, "time_this_iter_s": 14.782554149627686, "time_total_s": 336.7899968624115, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea2f670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 336.7899968624115, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 52.30476190476191, "ram_util_percent": 83.33809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7504720190372417, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.955995650518508, "policy_loss": -0.007038708860251717, "vf_loss": 9.96259542697321, "vf_explained_var": 0.007478472637751745, "kl": 0.008778580564689772, "entropy": 1.2457590569264043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7181180434725272, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.39037158653219, "policy_loss": -0.0065415207950753115, "vf_loss": 9.395399465005864, "vf_explained_var": 0.00013286512364786137, "kl": 0.007568242438843941, "entropy": 1.2114014382084841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 2754.4741846856564, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 550.4184142357365, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5769.222532985445, "predator_policy": -6817.4782088785505}, "policy_reward_max": {"prey_policy": 8403.897686606, "predator_policy": 7532.618816670598}, "policy_reward_mean": {"prey_policy": 30.329427776484735, "predator_policy": 244.87977934138326}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.2597636577511, -3.552713678800501e-15, 1963.679212889075, 1.4210854715202004e-14, 2530.0528592241862, 242.4549182723061, 261.0831088084324, 0.0, 1061.9341173018074, 119.4756729285335, 372.02243500041646, 1137.432682154475, 747.748323037651, 494.63496979519323, 686.5996881821726, 0.0, 614.5459045407924, 943.6624784695285, 0.0, 356.17319330553516, 110.43442944848246, -1.4210854715202004e-14, 1390.8563944675054, 784.4100495871983, 0.0, 2754.4741846856564, 0.0, 688.4960518138713, -7.105427357601002e-15, 893.6268061328312, 112.92848311048846, 566.0843429990473, 782.0070616559917, 0.0, 492.8456260725728, 380.57044596757567, 476.64162786481376, 341.3093701217018, 0.0, 653.7272252758962, 259.27913251209384, 1837.8352206004165, 545.4682632139053, 1302.8789587796316, 571.8215436012496, 209.33233136319106, 910.6168257454486, 645.75191995296, 547.5680405656607, 665.7556556635828, 490.7772769551465, 259.485287410288, 588.4481779970752, 502.4803175485621, 137.1049580005975, 1145.2231388369526, 0.0, 675.5798125704149, 0.0, -3.552713678800501e-15, 821.9818069050626, 111.35123536232541, 0.0, 485.48788064981164, 230.30293050291584, 0.0, -1.4210854715202004e-14, 0.0, 1.4210854715202004e-14, 0.0, 227.91989760336293, 199.25139867556047, 377.67890517275066, 1361.5634057327168, 220.8214237296738, 573.7877232786897, 0.0, 1243.9663775744605, 1.4210854715202004e-14, 330.35000488376664, 1977.3434252708248, 2000.3494308385286, 725.0348234154994, 1043.2206679775757, 1039.0572023369136, 215.22256329691191, 0.0, 230.9497587932891, 2028.298966641916, 469.1434197257468, 0.0, 746.6390090045995, 0.0, 449.13147739050623, 0.0, 780.7227632916927, 2654.311845615396, 632.3747918144695, 0.0, -7.105427357601002e-15], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1017.4614822691526, -2275.6971364593287, 269.05571565535087, 472.64083022815703, 2452.455921694775, -5411.631785138647, 1377.9203046134737, 135.65816517855617, 7865.139179272709, -5639.080521269564, 3774.4082785523615, -2229.5349143725584, -2543.9534862056353, -1517.6982199950814, 881.3434719060184, -3772.97890041287, -736.5602625827947, -741.6957126334152, 6394.429637945664, 37.900596943732495, 1770.8303477472039, -2870.9734801994973, 8315.936971875106, -2216.474197820041, 8317.525645564905, -2023.6339239561646, 3363.600557240919, -2756.4689791512374, 2801.4699397121913, -457.87638660179573, 3557.282512152777, -1667.3236155118207, 5977.275669557935, -3087.830200700525, 3108.46794025246, -2095.816100188215, 3659.7771107584335, 1239.9988918912663, -4049.2430790082476, -2389.7445759193006, 2264.7661450930086, -2934.640072957512, 5858.646520858854, -279.9364750244041, 372.452008839931, -2009.8420765586472, 3267.024946233376, -1182.8835997129302, 6162.039155525319, -2493.8053079982783, 4737.218741392269, -945.5261653849587, 1517.7934370512774, -606.9788445618731, 2894.935307335715, -2782.5437010974124, 3685.5946012148906, -1315.4107338503352, 5505.52323560154, -1372.640039095806, 124.17007478751933, -1386.0679319557178, 4270.8152592565475, -1708.0615983889857, 6787.591901365067, -4271.800028377285, 1526.199199900527, -5334.936186971686, 2816.6945994536077, -2322.1977087509185, 4099.477818721717, -3004.6028477651575, -3933.2266285296923, -419.32922825942023, -1763.2218770359711, -979.6043455184174, -3500.3421508052443, -1234.1748509871572, 6405.552424899948, -3278.1029176452935, 7369.006597371129, -2099.288946329558, 5517.041230453784, -1336.4215452593137, -1935.049688509779, -3810.312109290691, 8403.897686606, -333.00043385478267, -739.8886277897079, -1691.0362657836492, 2154.0709300387616, 825.0075581708801, 2190.644427251584, -2697.430241164353, 3637.586851325001, 284.80101556923717, 308.6013647655359, -5558.31345117045, -1521.5352002131447, 622.9199085526102, 2157.3654829644634, -2317.1667216021456, 5160.222246130451, -1685.7595267978804, 3572.788933811029, -2349.4049241345747, -2903.2014017405318, -3359.781695654933, -3052.466266926819, -4548.092669876674, -1836.9972669717447, -3006.8286917749433, -1512.243301023101, 269.79212393807245, -1063.1378101444675, -249.70455443817298, 2294.667506974149, -5673.03228428298, -303.77823631031794, -2719.540109079188, 5805.92406603295, -1869.1818142353889, -2633.717193613913, -1575.7493226799554, -1394.837574386366, -2557.197903519301, 7597.072671700084, -1704.054804072495, -1034.8398888304553, -1365.4276388711735, -99.57336645196962, -4055.9352741708994, 591.5516155674409, -817.5523074873801, 5297.799068042951, -2545.452239653688, 4458.341637331705, -1584.827998978672, 1929.2322369289084, 1047.6349405941505, 4840.668038262145, -2979.464939439858, 6935.1825609113575, 2111.6805086296135, -2910.7974248419246, -2071.9773759591053, -2123.4898007657384, -2106.522447625287, 965.4620496165861, 224.98258262407975, 6526.739259071452, 393.66458445880687, -2685.0808994450936, -2458.422467619544, 3732.1830155258026, -2115.561927264921, 3415.2325909396463, -706.6149597217956, 2599.2071081691693, -3299.129491484499, 610.2752850164485, -2577.80525221581, -1101.4012614909188, -2411.5448329630685, 1514.329740287554, -2170.3956325055387, -3908.265355957561, -2204.6080934999395, 924.7858266017599, -2032.8093707691485, -427.41976825757456, 824.3065459415718, 1199.7752092403841, -1478.2133035796378, 3511.6989033815353, -960.3361610810222, 1488.6358202440192, 411.64052172422157, -699.4216342919959, -3072.349859019065, 6303.096059125376, -1337.714853419126, 1309.772176299709, -384.317794182377, 4597.267193294634, -3656.523104006841, 4536.55230611254, -157.15996397524697, 2265.5760629323445, -3803.250616327358, 2835.6717195165515, -3212.3250431528645, -4112.984050925242, -5529.310601050949, 1517.1777513234806, -2564.339204467573, -4231.86914656645, -5769.222532985445, 1827.1892345901142, -1593.4124839151887], "policy_predator_policy_reward": [2426.5992748358008, -558.1038569878737, 62.342912339640016, -804.0394582231481, 4136.030123499978, 786.8249528329711, -810.1997532391182, -703.3787165529128, 3421.1736345140725, -3117.1794332930444, -1680.4921043300728, 378.0736584225752, 1421.0542941922622, 2901.680520816888, 369.5820701698083, 2522.0533583370416, 531.1565862573232, 2009.033506260691, -4696.500074349321, -1616.3544876115418, 59.70285719317235, 1412.4627102595366, -335.3613358117897, -4626.66875608881, -4583.37506929436, -962.7683292767368, 984.1851335323538, -1096.681741826846, -735.08471654305, -921.9091483851734, -525.6889409941045, -1364.269955646853, 149.48843672321075, -2424.3880010398316, -133.65511535462866, 64.66575375991492, -1500.3894248078486, -3399.3865778418526, 5523.109869943047, 1272.050978290038, 442.5345535512434, 337.77380376174244, -2005.92938654723, -3572.780659287223, 417.18731823016003, 2611.0591439560585, -1275.3654858902578, -24.365811042988675, -2463.810822823585, -1204.4230247034584, 2495.9769172632673, -3533.1953085849195, 195.2027596542208, -1106.0173521436266, -1443.62252355928, 2019.7269691348517, -631.353427254541, -1738.8304401100113, -1085.617734294545, -2153.6386560783576, -1928.8341857749729, 3303.660526053661, -392.12277261510803, -1604.5465452534045, 896.8045318053544, -2630.5893431371533, 1950.3903390386972, 1858.3466480324587, -126.45104363242088, 124.7997790023088, 462.8223888552594, -1177.1269138442456, 4921.395994982349, -92.19851032842098, 596.5543812362853, 2487.581211439805, 3207.3753682912857, 1527.141633501115, -2156.6700917898283, -317.0521901889337, -2320.435721199677, -2690.002797329801, -3344.7233286186506, 1001.9388640245984, 4645.610108479719, 1645.2199525346587, -3016.0151861842996, -3752.003107787286, 908.7782258493213, 2093.968211325285, -2557.269057185689, -212.4770996607626, 1584.6414791658806, -167.23883950766074, -1225.5106552838695, -2051.1252916574085, 1113.7119363727768, 4683.5681905978, 987.7006169248081, 576.6703303993097, -517.7195090578871, 1168.2980246507134, 358.9976670745192, -3573.9750989968, -1696.9673714343273, 1062.0315397549487, 4786.143623820299, 1979.3197911237269, 3791.8093812075717, 3945.8545135965196, 2060.2680181840237, 3928.7810793996173, 699.0132530534888, 543.4379240315401, 2525.630307547122, -537.2081303940657, 3057.7370296223935, 320.62774768644, 3145.949896105255, -122.63155071574751, -2148.498152807302, -966.2622920851995, 56.371506487484055, 4264.446245168708, 3160.1943583434536, 791.8411195622133, -6817.4782088785505, 1409.9482219007716, 228.04371375233444, 2402.5267444522106, 293.0224038620141, 3862.486236760858, 635.8259336439927, -409.8252417240522, -3392.8920551302926, 640.5452267410222, -3219.6543132726038, 346.1406749195692, -973.4719029522319, -2003.3952745708264, -2419.3473960910596, 786.064194872132, -4264.979566565858, -4582.632104299552, 3487.0816439693594, 1873.3720620044257, 1430.2227377274594, 4161.352916396282, -704.283161333753, -265.34004717723946, -2571.8053945442643, -3774.8107257073075, 1075.386861904652, 4068.1165051599837, -2546.1541961700054, 2173.4994854835854, -2479.764521327002, -228.85310989084957, 148.27211045061932, 882.0002777484789, 146.5167583865375, 3798.3566340836446, 1125.0763284260918, 4388.219196866423, -116.04093602568308, 1497.1416516591682, 4421.228397813342, 2734.8657196217355, 2076.7389456400847, 70.3418008642176, 170.5618094101235, -352.226023797209, 259.7969384986289, 18.64115584062464, -3217.6562361699425, 897.2432526627174, 1282.3989289043695, -1154.376304230692, 1782.0208529099934, 2458.894060126815, 323.20972897724954, -5288.590934683492, -380.1160695107552, 201.3006963980225, -425.53661465616574, -515.2074746316242, -1332.6769891726774, -2597.5838755741106, -677.6488957579168, 2215.3234491529274, 1334.645499297029, -177.26941236902027, 4763.987680920981, 7532.618816670598, 2139.9521130840008, -460.41586812543875, 2519.9148632389474, 7481.17681631295, 898.522344202054, -1132.2990948769814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6863772574713076, "mean_inference_ms": 1.4825854587426324, "mean_action_processing_ms": 0.28217574986924854, "mean_env_wait_ms": 0.12960401924393256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056351423263549805, "StateBufferConnector_ms": 0.004151344299316406, "ViewRequirementAgentConnector_ms": 0.12084650993347168}, "num_episodes": 18, "episode_return_max": 2754.4741846856564, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 550.4184142357365, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.2409842206763, "num_env_steps_trained_throughput_per_sec": 272.2409842206763, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 14465.491, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14465.442, "sample_time_ms": 1235.699, "learn_time_ms": 13211.968, "learn_throughput": 302.756, "synch_weights_time_ms": 16.386}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "6751e_00000", "date": "2024-08-11_19-13-03", "timestamp": 1723417983, "time_this_iter_s": 14.973711967468262, "time_total_s": 351.76370882987976, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaddee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 351.76370882987976, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 54.559090909090905, "ram_util_percent": 83.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7466296367859714, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.972732564128895, "policy_loss": -0.005253506909745435, "vf_loss": 9.977597498515296, "vf_explained_var": 0.003664442565706041, "kl": 0.007770982059246667, "entropy": 1.1126292597679865, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6709150956105934, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.216538901051516, "policy_loss": -0.007393113646296558, "vf_loss": 9.222519127275579, "vf_explained_var": 0.00024912814614634035, "kl": 0.007064405938456817, "entropy": 1.131139371256349, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 3484.913825065826, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 607.41003027033, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5918.69578465438, "predator_policy": -6817.4782088785505}, "policy_reward_max": {"prey_policy": 8403.897686606, "predator_policy": 9358.536828709153}, "policy_reward_mean": {"prey_policy": -167.75585334537172, "predator_policy": 471.46086848053676}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 356.17319330553516, 110.43442944848246, -1.4210854715202004e-14, 1390.8563944675054, 784.4100495871983, 0.0, 2754.4741846856564, 0.0, 688.4960518138713, -7.105427357601002e-15, 893.6268061328312, 112.92848311048846, 566.0843429990473, 782.0070616559917, 0.0, 492.8456260725728, 380.57044596757567, 476.64162786481376, 341.3093701217018, 0.0, 653.7272252758962, 259.27913251209384, 1837.8352206004165, 545.4682632139053, 1302.8789587796316, 571.8215436012496, 209.33233136319106, 910.6168257454486, 645.75191995296, 547.5680405656607, 665.7556556635828, 490.7772769551465, 259.485287410288, 588.4481779970752, 502.4803175485621, 137.1049580005975, 1145.2231388369526, 0.0, 675.5798125704149, 0.0, -3.552713678800501e-15, 821.9818069050626, 111.35123536232541, 0.0, 485.48788064981164, 230.30293050291584, 0.0, -1.4210854715202004e-14, 0.0, 1.4210854715202004e-14, 0.0, 227.91989760336293, 199.25139867556047, 377.67890517275066, 1361.5634057327168, 220.8214237296738, 573.7877232786897, 0.0, 1243.9663775744605, 1.4210854715202004e-14, 330.35000488376664, 1977.3434252708248, 2000.3494308385286, 725.0348234154994, 1043.2206679775757, 1039.0572023369136, 215.22256329691191, 0.0, 230.9497587932891, 2028.298966641916, 469.1434197257468, 0.0, 746.6390090045995, 0.0, 449.13147739050623, 0.0, 780.7227632916927, 2654.311845615396, 632.3747918144695, 0.0, -7.105427357601002e-15, 0.0, 973.0023554912592, 1144.000260451628, 1696.2152392384032, 1753.0410398305198, 0.0, 276.28086506570514, 634.7009126985141, 3484.913825065826, 1359.3162080098757, 683.7135779735212, 0.0, -3.552713678800501e-15, 633.6298735880546, 0.0, 2643.9456309689904, 2201.9879493393983, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3659.7771107584335, 1239.9988918912663, -4049.2430790082476, -2389.7445759193006, 2264.7661450930086, -2934.640072957512, 5858.646520858854, -279.9364750244041, 372.452008839931, -2009.8420765586472, 3267.024946233376, -1182.8835997129302, 6162.039155525319, -2493.8053079982783, 4737.218741392269, -945.5261653849587, 1517.7934370512774, -606.9788445618731, 2894.935307335715, -2782.5437010974124, 3685.5946012148906, -1315.4107338503352, 5505.52323560154, -1372.640039095806, 124.17007478751933, -1386.0679319557178, 4270.8152592565475, -1708.0615983889857, 6787.591901365067, -4271.800028377285, 1526.199199900527, -5334.936186971686, 2816.6945994536077, -2322.1977087509185, 4099.477818721717, -3004.6028477651575, -3933.2266285296923, -419.32922825942023, -1763.2218770359711, -979.6043455184174, -3500.3421508052443, -1234.1748509871572, 6405.552424899948, -3278.1029176452935, 7369.006597371129, -2099.288946329558, 5517.041230453784, -1336.4215452593137, -1935.049688509779, -3810.312109290691, 8403.897686606, -333.00043385478267, -739.8886277897079, -1691.0362657836492, 2154.0709300387616, 825.0075581708801, 2190.644427251584, -2697.430241164353, 3637.586851325001, 284.80101556923717, 308.6013647655359, -5558.31345117045, -1521.5352002131447, 622.9199085526102, 2157.3654829644634, -2317.1667216021456, 5160.222246130451, -1685.7595267978804, 3572.788933811029, -2349.4049241345747, -2903.2014017405318, -3359.781695654933, -3052.466266926819, -4548.092669876674, -1836.9972669717447, -3006.8286917749433, -1512.243301023101, 269.79212393807245, -1063.1378101444675, -249.70455443817298, 2294.667506974149, -5673.03228428298, -303.77823631031794, -2719.540109079188, 5805.92406603295, -1869.1818142353889, -2633.717193613913, -1575.7493226799554, -1394.837574386366, -2557.197903519301, 7597.072671700084, -1704.054804072495, -1034.8398888304553, -1365.4276388711735, -99.57336645196962, -4055.9352741708994, 591.5516155674409, -817.5523074873801, 5297.799068042951, -2545.452239653688, 4458.341637331705, -1584.827998978672, 1929.2322369289084, 1047.6349405941505, 4840.668038262145, -2979.464939439858, 6935.1825609113575, 2111.6805086296135, -2910.7974248419246, -2071.9773759591053, -2123.4898007657384, -2106.522447625287, 965.4620496165861, 224.98258262407975, 6526.739259071452, 393.66458445880687, -2685.0808994450936, -2458.422467619544, 3732.1830155258026, -2115.561927264921, 3415.2325909396463, -706.6149597217956, 2599.2071081691693, -3299.129491484499, 610.2752850164485, -2577.80525221581, -1101.4012614909188, -2411.5448329630685, 1514.329740287554, -2170.3956325055387, -3908.265355957561, -2204.6080934999395, 924.7858266017599, -2032.8093707691485, -427.41976825757456, 824.3065459415718, 1199.7752092403841, -1478.2133035796378, 3511.6989033815353, -960.3361610810222, 1488.6358202440192, 411.64052172422157, -699.4216342919959, -3072.349859019065, 6303.096059125376, -1337.714853419126, 1309.772176299709, -384.317794182377, 4597.267193294634, -3656.523104006841, 4536.55230611254, -157.15996397524697, 2265.5760629323445, -3803.250616327358, 2835.6717195165515, -3212.3250431528645, -4112.984050925242, -5529.310601050949, 1517.1777513234806, -2564.339204467573, -4231.86914656645, -5769.222532985445, 1827.1892345901142, -1593.4124839151887, 3235.19740523987, -1488.3173150771333, -2015.3592811864594, -4654.417345849138, -1591.3513756176428, -3584.7035043350816, 3007.350140343991, -1660.1762908882888, 5443.286052351651, -2775.123128103727, 4729.013695879108, -4699.896460832059, 1699.1611773507504, -2082.9254311471022, 2579.939080145687, -354.9021922302246, 463.68828789336766, -2412.887834606292, 2504.5610734405454, -5178.341358402365, -329.89719236196413, -1124.710978638615, 4230.6811618726715, -5918.69578465438, -902.1477509719743, -904.3669716717899, 389.46410027979977, -3613.802755305543, 3565.0727523731352, -2799.16903567702, -5274.388047590678, -4589.325466648694, 3851.586087180269, -1440.8261556014816, 4995.97474404961, -1070.7249802098215], "policy_predator_policy_reward": [-1500.3894248078486, -3399.3865778418526, 5523.109869943047, 1272.050978290038, 442.5345535512434, 337.77380376174244, -2005.92938654723, -3572.780659287223, 417.18731823016003, 2611.0591439560585, -1275.3654858902578, -24.365811042988675, -2463.810822823585, -1204.4230247034584, 2495.9769172632673, -3533.1953085849195, 195.2027596542208, -1106.0173521436266, -1443.62252355928, 2019.7269691348517, -631.353427254541, -1738.8304401100113, -1085.617734294545, -2153.6386560783576, -1928.8341857749729, 3303.660526053661, -392.12277261510803, -1604.5465452534045, 896.8045318053544, -2630.5893431371533, 1950.3903390386972, 1858.3466480324587, -126.45104363242088, 124.7997790023088, 462.8223888552594, -1177.1269138442456, 4921.395994982349, -92.19851032842098, 596.5543812362853, 2487.581211439805, 3207.3753682912857, 1527.141633501115, -2156.6700917898283, -317.0521901889337, -2320.435721199677, -2690.002797329801, -3344.7233286186506, 1001.9388640245984, 4645.610108479719, 1645.2199525346587, -3016.0151861842996, -3752.003107787286, 908.7782258493213, 2093.968211325285, -2557.269057185689, -212.4770996607626, 1584.6414791658806, -167.23883950766074, -1225.5106552838695, -2051.1252916574085, 1113.7119363727768, 4683.5681905978, 987.7006169248081, 576.6703303993097, -517.7195090578871, 1168.2980246507134, 358.9976670745192, -3573.9750989968, -1696.9673714343273, 1062.0315397549487, 4786.143623820299, 1979.3197911237269, 3791.8093812075717, 3945.8545135965196, 2060.2680181840237, 3928.7810793996173, 699.0132530534888, 543.4379240315401, 2525.630307547122, -537.2081303940657, 3057.7370296223935, 320.62774768644, 3145.949896105255, -122.63155071574751, -2148.498152807302, -966.2622920851995, 56.371506487484055, 4264.446245168708, 3160.1943583434536, 791.8411195622133, -6817.4782088785505, 1409.9482219007716, 228.04371375233444, 2402.5267444522106, 293.0224038620141, 3862.486236760858, 635.8259336439927, -409.8252417240522, -3392.8920551302926, 640.5452267410222, -3219.6543132726038, 346.1406749195692, -973.4719029522319, -2003.3952745708264, -2419.3473960910596, 786.064194872132, -4264.979566565858, -4582.632104299552, 3487.0816439693594, 1873.3720620044257, 1430.2227377274594, 4161.352916396282, -704.283161333753, -265.34004717723946, -2571.8053945442643, -3774.8107257073075, 1075.386861904652, 4068.1165051599837, -2546.1541961700054, 2173.4994854835854, -2479.764521327002, -228.85310989084957, 148.27211045061932, 882.0002777484789, 146.5167583865375, 3798.3566340836446, 1125.0763284260918, 4388.219196866423, -116.04093602568308, 1497.1416516591682, 4421.228397813342, 2734.8657196217355, 2076.7389456400847, 70.3418008642176, 170.5618094101235, -352.226023797209, 259.7969384986289, 18.64115584062464, -3217.6562361699425, 897.2432526627174, 1282.3989289043695, -1154.376304230692, 1782.0208529099934, 2458.894060126815, 323.20972897724954, -5288.590934683492, -380.1160695107552, 201.3006963980225, -425.53661465616574, -515.2074746316242, -1332.6769891726774, -2597.5838755741106, -677.6488957579168, 2215.3234491529274, 1334.645499297029, -177.26941236902027, 4763.987680920981, 7532.618816670598, 2139.9521130840008, -460.41586812543875, 2519.9148632389474, 7481.17681631295, 898.522344202054, -1132.2990948769814, -577.4253919793964, -1169.4546981833412, 5949.070649199608, 1693.7083333272433, 1096.83214790911, 5223.2229924952435, 692.8592032648943, -343.81781348218937, -1545.8876816950867, 630.7657972776931, -1327.3251555284457, 1298.207920481393, -77.74084828206244, 737.7859671441198, -1389.1255012123959, -201.2104740045536, 4920.613448008179, 513.4999237705769, 3340.504134629405, 692.5923583422899, 371.53736563344694, 1766.784383340655, 379.7234873745503, 1308.2911354071593, 1529.7440556850108, 276.7706669587539, 2403.805209261324, 1454.1633193524794, -702.2967686220953, -63.60694807401692, 9358.536828709153, 3149.122316499204, 2288.414384368481, -2497.18636660787, -3216.2320090519693, -709.0177547878249]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6838881765675311, "mean_inference_ms": 1.4756053643722618, "mean_action_processing_ms": 0.2809755650983811, "mean_env_wait_ms": 0.1294134667642297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006003141403198242, "StateBufferConnector_ms": 0.004498124122619629, "ViewRequirementAgentConnector_ms": 0.12404263019561768}, "num_episodes": 18, "episode_return_max": 3484.913825065826, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 607.41003027033, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.87240754236404, "num_env_steps_trained_throughput_per_sec": 277.87240754236404, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 14514.387, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14514.338, "sample_time_ms": 1235.539, "learn_time_ms": 13262.514, "learn_throughput": 301.602, "synch_weights_time_ms": 15.074}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "6751e_00000", "date": "2024-08-11_19-13-18", "timestamp": 1723417998, "time_this_iter_s": 14.451319932937622, "time_total_s": 366.2150287628174, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea2f280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 366.2150287628174, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 54.125, "ram_util_percent": 83.22999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7270827504692885, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.959219866959506, "policy_loss": -0.006986427071310885, "vf_loss": 9.965843454492155, "vf_explained_var": -0.0009981286588800016, "kl": 0.007257274375498709, "entropy": 1.1194485113734292, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7503404060053447, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.164359858679394, "policy_loss": -0.006321612480786387, "vf_loss": 9.169217425553256, "vf_explained_var": 0.00023486488079898572, "kl": 0.007320277101281722, "entropy": 1.1327033701397125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 5901.123382611631, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 743.5530771410836, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5918.69578465438, "predator_policy": -6817.4782088785505}, "policy_reward_max": {"prey_policy": 8403.897686606, "predator_policy": 9358.536828709153}, "policy_reward_mean": {"prey_policy": -318.21347820861627, "predator_policy": 689.990016779158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [476.64162786481376, 341.3093701217018, 0.0, 653.7272252758962, 259.27913251209384, 1837.8352206004165, 545.4682632139053, 1302.8789587796316, 571.8215436012496, 209.33233136319106, 910.6168257454486, 645.75191995296, 547.5680405656607, 665.7556556635828, 490.7772769551465, 259.485287410288, 588.4481779970752, 502.4803175485621, 137.1049580005975, 1145.2231388369526, 0.0, 675.5798125704149, 0.0, -3.552713678800501e-15, 821.9818069050626, 111.35123536232541, 0.0, 485.48788064981164, 230.30293050291584, 0.0, -1.4210854715202004e-14, 0.0, 1.4210854715202004e-14, 0.0, 227.91989760336293, 199.25139867556047, 377.67890517275066, 1361.5634057327168, 220.8214237296738, 573.7877232786897, 0.0, 1243.9663775744605, 1.4210854715202004e-14, 330.35000488376664, 1977.3434252708248, 2000.3494308385286, 725.0348234154994, 1043.2206679775757, 1039.0572023369136, 215.22256329691191, 0.0, 230.9497587932891, 2028.298966641916, 469.1434197257468, 0.0, 746.6390090045995, 0.0, 449.13147739050623, 0.0, 780.7227632916927, 2654.311845615396, 632.3747918144695, 0.0, -7.105427357601002e-15, 0.0, 973.0023554912592, 1144.000260451628, 1696.2152392384032, 1753.0410398305198, 0.0, 276.28086506570514, 634.7009126985141, 3484.913825065826, 1359.3162080098757, 683.7135779735212, 0.0, -3.552713678800501e-15, 633.6298735880546, 0.0, 2643.9456309689904, 2201.9879493393983, 0.0, 1156.129635405075, 2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 7.105427357601002e-15, 1.4210854715202004e-14, 0.0, 385.1622118450207, 1.7763568394002505e-15, 5901.123382611631, 515.3442076692357, 0.0, 2509.7386683724403, 2646.989344245227, 3627.833383751868, 238.99215610047338, 4412.497346841589, 1533.4014194795452], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3933.2266285296923, -419.32922825942023, -1763.2218770359711, -979.6043455184174, -3500.3421508052443, -1234.1748509871572, 6405.552424899948, -3278.1029176452935, 7369.006597371129, -2099.288946329558, 5517.041230453784, -1336.4215452593137, -1935.049688509779, -3810.312109290691, 8403.897686606, -333.00043385478267, -739.8886277897079, -1691.0362657836492, 2154.0709300387616, 825.0075581708801, 2190.644427251584, -2697.430241164353, 3637.586851325001, 284.80101556923717, 308.6013647655359, -5558.31345117045, -1521.5352002131447, 622.9199085526102, 2157.3654829644634, -2317.1667216021456, 5160.222246130451, -1685.7595267978804, 3572.788933811029, -2349.4049241345747, -2903.2014017405318, -3359.781695654933, -3052.466266926819, -4548.092669876674, -1836.9972669717447, -3006.8286917749433, -1512.243301023101, 269.79212393807245, -1063.1378101444675, -249.70455443817298, 2294.667506974149, -5673.03228428298, -303.77823631031794, -2719.540109079188, 5805.92406603295, -1869.1818142353889, -2633.717193613913, -1575.7493226799554, -1394.837574386366, -2557.197903519301, 7597.072671700084, -1704.054804072495, -1034.8398888304553, -1365.4276388711735, -99.57336645196962, -4055.9352741708994, 591.5516155674409, -817.5523074873801, 5297.799068042951, -2545.452239653688, 4458.341637331705, -1584.827998978672, 1929.2322369289084, 1047.6349405941505, 4840.668038262145, -2979.464939439858, 6935.1825609113575, 2111.6805086296135, -2910.7974248419246, -2071.9773759591053, -2123.4898007657384, -2106.522447625287, 965.4620496165861, 224.98258262407975, 6526.739259071452, 393.66458445880687, -2685.0808994450936, -2458.422467619544, 3732.1830155258026, -2115.561927264921, 3415.2325909396463, -706.6149597217956, 2599.2071081691693, -3299.129491484499, 610.2752850164485, -2577.80525221581, -1101.4012614909188, -2411.5448329630685, 1514.329740287554, -2170.3956325055387, -3908.265355957561, -2204.6080934999395, 924.7858266017599, -2032.8093707691485, -427.41976825757456, 824.3065459415718, 1199.7752092403841, -1478.2133035796378, 3511.6989033815353, -960.3361610810222, 1488.6358202440192, 411.64052172422157, -699.4216342919959, -3072.349859019065, 6303.096059125376, -1337.714853419126, 1309.772176299709, -384.317794182377, 4597.267193294634, -3656.523104006841, 4536.55230611254, -157.15996397524697, 2265.5760629323445, -3803.250616327358, 2835.6717195165515, -3212.3250431528645, -4112.984050925242, -5529.310601050949, 1517.1777513234806, -2564.339204467573, -4231.86914656645, -5769.222532985445, 1827.1892345901142, -1593.4124839151887, 3235.19740523987, -1488.3173150771333, -2015.3592811864594, -4654.417345849138, -1591.3513756176428, -3584.7035043350816, 3007.350140343991, -1660.1762908882888, 5443.286052351651, -2775.123128103727, 4729.013695879108, -4699.896460832059, 1699.1611773507504, -2082.9254311471022, 2579.939080145687, -354.9021922302246, 463.68828789336766, -2412.887834606292, 2504.5610734405454, -5178.341358402365, -329.89719236196413, -1124.710978638615, 4230.6811618726715, -5918.69578465438, -902.1477509719743, -904.3669716717899, 389.46410027979977, -3613.802755305543, 3565.0727523731352, -2799.16903567702, -5274.388047590678, -4589.325466648694, 3851.586087180269, -1440.8261556014816, 4995.97474404961, -1070.7249802098215, 62.57086041375172, -3846.84445444879, 5323.575938305871, -3966.1252154029653, 6023.202607800312, 285.10513830391227, 74.49103575120657, -615.2571768566991, 5204.621108700887, -1382.8151858607262, -2730.0893323143687, -704.1766043498783, 3663.30208746624, -3609.9886369544897, 3559.78592040685, -3789.6075610841776, 453.37415682515024, -1407.231515686899, -354.3779677800166, -2112.521941492366, -2325.6322929605585, -3948.5823541748027, 145.6581119381122, -2684.3446292160306, 3665.1250377779334, -3422.646535731042, -1015.1059663709356, -1165.7304296652649, 819.4552028785032, -3028.8510989329907, 6232.565516769217, -2592.2005249780154, 3205.9005377631356, -1854.36597851482, 3785.4419480588854, -5639.34679713163], "policy_predator_policy_reward": [4921.395994982349, -92.19851032842098, 596.5543812362853, 2487.581211439805, 3207.3753682912857, 1527.141633501115, -2156.6700917898283, -317.0521901889337, -2320.435721199677, -2690.002797329801, -3344.7233286186506, 1001.9388640245984, 4645.610108479719, 1645.2199525346587, -3016.0151861842996, -3752.003107787286, 908.7782258493213, 2093.968211325285, -2557.269057185689, -212.4770996607626, 1584.6414791658806, -167.23883950766074, -1225.5106552838695, -2051.1252916574085, 1113.7119363727768, 4683.5681905978, 987.7006169248081, 576.6703303993097, -517.7195090578871, 1168.2980246507134, 358.9976670745192, -3573.9750989968, -1696.9673714343273, 1062.0315397549487, 4786.143623820299, 1979.3197911237269, 3791.8093812075717, 3945.8545135965196, 2060.2680181840237, 3928.7810793996173, 699.0132530534888, 543.4379240315401, 2525.630307547122, -537.2081303940657, 3057.7370296223935, 320.62774768644, 3145.949896105255, -122.63155071574751, -2148.498152807302, -966.2622920851995, 56.371506487484055, 4264.446245168708, 3160.1943583434536, 791.8411195622133, -6817.4782088785505, 1409.9482219007716, 228.04371375233444, 2402.5267444522106, 293.0224038620141, 3862.486236760858, 635.8259336439927, -409.8252417240522, -3392.8920551302926, 640.5452267410222, -3219.6543132726038, 346.1406749195692, -973.4719029522319, -2003.3952745708264, -2419.3473960910596, 786.064194872132, -4264.979566565858, -4582.632104299552, 3487.0816439693594, 1873.3720620044257, 1430.2227377274594, 4161.352916396282, -704.283161333753, -265.34004717723946, -2571.8053945442643, -3774.8107257073075, 1075.386861904652, 4068.1165051599837, -2546.1541961700054, 2173.4994854835854, -2479.764521327002, -228.85310989084957, 148.27211045061932, 882.0002777484789, 146.5167583865375, 3798.3566340836446, 1125.0763284260918, 4388.219196866423, -116.04093602568308, 1497.1416516591682, 4421.228397813342, 2734.8657196217355, 2076.7389456400847, 70.3418008642176, 170.5618094101235, -352.226023797209, 259.7969384986289, 18.64115584062464, -3217.6562361699425, 897.2432526627174, 1282.3989289043695, -1154.376304230692, 1782.0208529099934, 2458.894060126815, 323.20972897724954, -5288.590934683492, -380.1160695107552, 201.3006963980225, -425.53661465616574, -515.2074746316242, -1332.6769891726774, -2597.5838755741106, -677.6488957579168, 2215.3234491529274, 1334.645499297029, -177.26941236902027, 4763.987680920981, 7532.618816670598, 2139.9521130840008, -460.41586812543875, 2519.9148632389474, 7481.17681631295, 898.522344202054, -1132.2990948769814, -577.4253919793964, -1169.4546981833412, 5949.070649199608, 1693.7083333272433, 1096.83214790911, 5223.2229924952435, 692.8592032648943, -343.81781348218937, -1545.8876816950867, 630.7657972776931, -1327.3251555284457, 1298.207920481393, -77.74084828206244, 737.7859671441198, -1389.1255012123959, -201.2104740045536, 4920.613448008179, 513.4999237705769, 3340.504134629405, 692.5923583422899, 371.53736563344694, 1766.784383340655, 379.7234873745503, 1308.2911354071593, 1529.7440556850108, 276.7706669587539, 2403.805209261324, 1454.1633193524794, -702.2967686220953, -63.60694807401692, 9358.536828709153, 3149.122316499204, 2288.414384368481, -2497.18636660787, -3216.2320090519693, -709.0177547878249, 1385.862868525754, 3554.540360914361, 1165.410424795729, -2522.8611476986325, -4427.196105827558, -1881.1116402766697, -62.99667740413873, 603.7628185096312, -2635.400331818616, -1186.4055910215388, 3041.9273765201087, 392.33856014413914, 1492.9485070339883, -1546.2619575457418, -2139.5973049681443, 2754.5811574904956, 879.7327771556766, 74.12458170607331, 4219.435310842945, 4148.5879810410615, 2533.874239999266, 4255.68461480533, 693.2152482831701, 1845.4712689947485, 3534.3713757542214, -1267.1112094286716, 2321.967763279806, 2505.857977001627, 2699.157333130881, 3138.0719466754804, -1903.2921281869526, -1498.080707503777, 1875.713507311264, 1185.2492802820134, 5451.829649041263, -2064.5233804889644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6814494651670318, "mean_inference_ms": 1.4694165553541103, "mean_action_processing_ms": 0.27990437046627964, "mean_env_wait_ms": 0.12923597322829028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00602114200592041, "StateBufferConnector_ms": 0.0038704872131347656, "ViewRequirementAgentConnector_ms": 0.11414611339569092}, "num_episodes": 18, "episode_return_max": 5901.123382611631, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 743.5530771410836, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.80750561346935, "num_env_steps_trained_throughput_per_sec": 278.80750561346935, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 14461.56, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14461.515, "sample_time_ms": 1114.271, "learn_time_ms": 13330.603, "learn_throughput": 300.061, "synch_weights_time_ms": 15.666}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "6751e_00000", "date": "2024-08-11_19-13-32", "timestamp": 1723418012, "time_this_iter_s": 14.398393869400024, "time_total_s": 380.6134226322174, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 380.6134226322174, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 52.67999999999999, "ram_util_percent": 82.75000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7042427007798795, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.948237303072814, "policy_loss": -0.005500311232985012, "vf_loss": 9.953261574235542, "vf_explained_var": 0.011027149327848323, "kl": 0.009520952292430069, "entropy": 1.0958337414201604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7461953084462534, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.733118319132972, "policy_loss": -0.0052395990696149294, "vf_loss": 9.737171316903735, "vf_explained_var": 0.0002480949043596863, "kl": 0.005933126745620213, "entropy": 1.1437688709566833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 5901.123382611631, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 875.2202172114332, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6381.947975795694, "predator_policy": -6817.4782088785505}, "policy_reward_max": {"prey_policy": 7597.072671700084, "predator_policy": 9358.536828709153}, "policy_reward_mean": {"prey_policy": -150.130868730505, "predator_policy": 587.7409773362218}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, -3.552713678800501e-15, 821.9818069050626, 111.35123536232541, 0.0, 485.48788064981164, 230.30293050291584, 0.0, -1.4210854715202004e-14, 0.0, 1.4210854715202004e-14, 0.0, 227.91989760336293, 199.25139867556047, 377.67890517275066, 1361.5634057327168, 220.8214237296738, 573.7877232786897, 0.0, 1243.9663775744605, 1.4210854715202004e-14, 330.35000488376664, 1977.3434252708248, 2000.3494308385286, 725.0348234154994, 1043.2206679775757, 1039.0572023369136, 215.22256329691191, 0.0, 230.9497587932891, 2028.298966641916, 469.1434197257468, 0.0, 746.6390090045995, 0.0, 449.13147739050623, 0.0, 780.7227632916927, 2654.311845615396, 632.3747918144695, 0.0, -7.105427357601002e-15, 0.0, 973.0023554912592, 1144.000260451628, 1696.2152392384032, 1753.0410398305198, 0.0, 276.28086506570514, 634.7009126985141, 3484.913825065826, 1359.3162080098757, 683.7135779735212, 0.0, -3.552713678800501e-15, 633.6298735880546, 0.0, 2643.9456309689904, 2201.9879493393983, 0.0, 1156.129635405075, 2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 7.105427357601002e-15, 1.4210854715202004e-14, 0.0, 385.1622118450207, 1.7763568394002505e-15, 5901.123382611631, 515.3442076692357, 0.0, 2509.7386683724403, 2646.989344245227, 3627.833383751868, 238.99215610047338, 4412.497346841589, 1533.4014194795452, 722.8477210830986, 970.934324052962, 2964.5830472466087, 3565.722766998083, 4.263256414560601e-14, 1036.8932934594118, 113.66251353744636, 505.7797781679641, 240.79111337025697, 1.4210854715202004e-14, 749.8095312597119, 206.44032932727833, 221.82654832025275, 1448.9174829998403, 264.41342316582643, 3846.6993033140957, 116.22773081186253, 2532.400769046584, 1819.6972911042426, 2767.747812195548, 349.87514677474167, 1488.5291653787583], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2294.667506974149, -5673.03228428298, -303.77823631031794, -2719.540109079188, 5805.92406603295, -1869.1818142353889, -2633.717193613913, -1575.7493226799554, -1394.837574386366, -2557.197903519301, 7597.072671700084, -1704.054804072495, -1034.8398888304553, -1365.4276388711735, -99.57336645196962, -4055.9352741708994, 591.5516155674409, -817.5523074873801, 5297.799068042951, -2545.452239653688, 4458.341637331705, -1584.827998978672, 1929.2322369289084, 1047.6349405941505, 4840.668038262145, -2979.464939439858, 6935.1825609113575, 2111.6805086296135, -2910.7974248419246, -2071.9773759591053, -2123.4898007657384, -2106.522447625287, 965.4620496165861, 224.98258262407975, 6526.739259071452, 393.66458445880687, -2685.0808994450936, -2458.422467619544, 3732.1830155258026, -2115.561927264921, 3415.2325909396463, -706.6149597217956, 2599.2071081691693, -3299.129491484499, 610.2752850164485, -2577.80525221581, -1101.4012614909188, -2411.5448329630685, 1514.329740287554, -2170.3956325055387, -3908.265355957561, -2204.6080934999395, 924.7858266017599, -2032.8093707691485, -427.41976825757456, 824.3065459415718, 1199.7752092403841, -1478.2133035796378, 3511.6989033815353, -960.3361610810222, 1488.6358202440192, 411.64052172422157, -699.4216342919959, -3072.349859019065, 6303.096059125376, -1337.714853419126, 1309.772176299709, -384.317794182377, 4597.267193294634, -3656.523104006841, 4536.55230611254, -157.15996397524697, 2265.5760629323445, -3803.250616327358, 2835.6717195165515, -3212.3250431528645, -4112.984050925242, -5529.310601050949, 1517.1777513234806, -2564.339204467573, -4231.86914656645, -5769.222532985445, 1827.1892345901142, -1593.4124839151887, 3235.19740523987, -1488.3173150771333, -2015.3592811864594, -4654.417345849138, -1591.3513756176428, -3584.7035043350816, 3007.350140343991, -1660.1762908882888, 5443.286052351651, -2775.123128103727, 4729.013695879108, -4699.896460832059, 1699.1611773507504, -2082.9254311471022, 2579.939080145687, -354.9021922302246, 463.68828789336766, -2412.887834606292, 2504.5610734405454, -5178.341358402365, -329.89719236196413, -1124.710978638615, 4230.6811618726715, -5918.69578465438, -902.1477509719743, -904.3669716717899, 389.46410027979977, -3613.802755305543, 3565.0727523731352, -2799.16903567702, -5274.388047590678, -4589.325466648694, 3851.586087180269, -1440.8261556014816, 4995.97474404961, -1070.7249802098215, 62.57086041375172, -3846.84445444879, 5323.575938305871, -3966.1252154029653, 6023.202607800312, 285.10513830391227, 74.49103575120657, -615.2571768566991, 5204.621108700887, -1382.8151858607262, -2730.0893323143687, -704.1766043498783, 3663.30208746624, -3609.9886369544897, 3559.78592040685, -3789.6075610841776, 453.37415682515024, -1407.231515686899, -354.3779677800166, -2112.521941492366, -2325.6322929605585, -3948.5823541748027, 145.6581119381122, -2684.3446292160306, 3665.1250377779334, -3422.646535731042, -1015.1059663709356, -1165.7304296652649, 819.4552028785032, -3028.8510989329907, 6232.565516769217, -2592.2005249780154, 3205.9005377631356, -1854.36597851482, 3785.4419480588854, -5639.34679713163, -83.33815477125557, 113.36670363870734, 691.7018102289849, -1827.0477432642754, -412.0887744789166, 16.390113962750867, 4143.058498459767, -552.778229636109, 6586.874607638529, 973.9164154943207, 4607.177847199429, -1526.8253374907724, 1665.3031105249227, -1309.2114085090823, 3592.7289190438305, -2723.0931435744387, 4420.619809408659, -2638.1894894497773, 2691.741370265534, -2687.9002380768657, 7345.1421388163235, -1526.5904957971848, 353.8920701497517, 1714.5521240236849, 2385.2308383914924, -538.5283210486696, 5579.740252826254, -1347.2602312849447, 1478.7396279937811, -3313.2436890516833, -4180.978399763834, -3409.1446970891056, 3649.5157898889283, -1197.2537939031613, 1247.515826214058, -3882.2406273432525, -2111.3531639890275, -6381.947975795694, 898.0396553686813, -3316.3834589766375, 5129.077202441703, -332.0254065893687, 3668.656895287509, 125.19849085459302], "policy_predator_policy_reward": [3057.7370296223935, 320.62774768644, 3145.949896105255, -122.63155071574751, -2148.498152807302, -966.2622920851995, 56.371506487484055, 4264.446245168708, 3160.1943583434536, 791.8411195622133, -6817.4782088785505, 1409.9482219007716, 228.04371375233444, 2402.5267444522106, 293.0224038620141, 3862.486236760858, 635.8259336439927, -409.8252417240522, -3392.8920551302926, 640.5452267410222, -3219.6543132726038, 346.1406749195692, -973.4719029522319, -2003.3952745708264, -2419.3473960910596, 786.064194872132, -4264.979566565858, -4582.632104299552, 3487.0816439693594, 1873.3720620044257, 1430.2227377274594, 4161.352916396282, -704.283161333753, -265.34004717723946, -2571.8053945442643, -3774.8107257073075, 1075.386861904652, 4068.1165051599837, -2546.1541961700054, 2173.4994854835854, -2479.764521327002, -228.85310989084957, 148.27211045061932, 882.0002777484789, 146.5167583865375, 3798.3566340836446, 1125.0763284260918, 4388.219196866423, -116.04093602568308, 1497.1416516591682, 4421.228397813342, 2734.8657196217355, 2076.7389456400847, 70.3418008642176, 170.5618094101235, -352.226023797209, 259.7969384986289, 18.64115584062464, -3217.6562361699425, 897.2432526627174, 1282.3989289043695, -1154.376304230692, 1782.0208529099934, 2458.894060126815, 323.20972897724954, -5288.590934683492, -380.1160695107552, 201.3006963980225, -425.53661465616574, -515.2074746316242, -1332.6769891726774, -2597.5838755741106, -677.6488957579168, 2215.3234491529274, 1334.645499297029, -177.26941236902027, 4763.987680920981, 7532.618816670598, 2139.9521130840008, -460.41586812543875, 2519.9148632389474, 7481.17681631295, 898.522344202054, -1132.2990948769814, -577.4253919793964, -1169.4546981833412, 5949.070649199608, 1693.7083333272433, 1096.83214790911, 5223.2229924952435, 692.8592032648943, -343.81781348218937, -1545.8876816950867, 630.7657972776931, -1327.3251555284457, 1298.207920481393, -77.74084828206244, 737.7859671441198, -1389.1255012123959, -201.2104740045536, 4920.613448008179, 513.4999237705769, 3340.504134629405, 692.5923583422899, 371.53736563344694, 1766.784383340655, 379.7234873745503, 1308.2911354071593, 1529.7440556850108, 276.7706669587539, 2403.805209261324, 1454.1633193524794, -702.2967686220953, -63.60694807401692, 9358.536828709153, 3149.122316499204, 2288.414384368481, -2497.18636660787, -3216.2320090519693, -709.0177547878249, 1385.862868525754, 3554.540360914361, 1165.410424795729, -2522.8611476986325, -4427.196105827558, -1881.1116402766697, -62.99667740413873, 603.7628185096312, -2635.400331818616, -1186.4055910215388, 3041.9273765201087, 392.33856014413914, 1492.9485070339883, -1546.2619575457418, -2139.5973049681443, 2754.5811574904956, 879.7327771556766, 74.12458170607331, 4219.435310842945, 4148.5879810410615, 2533.874239999266, 4255.68461480533, 693.2152482831701, 1845.4712689947485, 3534.3713757542214, -1267.1112094286716, 2321.967763279806, 2505.857977001627, 2699.157333130881, 3138.0719466754804, -1903.2921281869526, -1498.080707503777, 1875.713507311264, 1185.2492802820134, 5451.829649041263, -2064.5233804889644, 543.2826155131049, 149.53655670254338, 2231.5340320386085, -125.25377495035855, 2394.500418179792, 965.7812895829811, 880.9401919521347, -905.4976937777132, -2744.022251478206, -4816.768771654642, -2889.825046660004, 846.3658304107591, 50.78651403125224, -293.2157025096443, 129.21736580140058, -493.07336310282824, -2586.6734769043396, 1045.0342703157162, -836.3244796291809, 832.4833474405114, -4870.053973616928, -198.688138142498, -1077.8710379080007, -784.1328269381575, -1666.511086971674, 41.635117949103176, 908.43509828166, -3691.9976368231255, 1189.353623729007, 909.5638604947229, 4286.999657585372, 7149.822742581667, -1026.5956444348933, -1309.4386207390148, 2364.535263765184, 2802.5903064105964, 5859.953207179554, 4453.045223709411, 3298.5245480703115, 1887.5670677331948, -3665.084935491818, -782.0917135857737, -1831.7125853069438, -473.61363545640074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6784433554865743, "mean_inference_ms": 1.4614855834301421, "mean_action_processing_ms": 0.27873078344306534, "mean_env_wait_ms": 0.1287908337428665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006642341613769531, "StateBufferConnector_ms": 0.0037180185317993164, "ViewRequirementAgentConnector_ms": 0.10744524002075195}, "num_episodes": 22, "episode_return_max": 5901.123382611631, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 875.2202172114332, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.43453838610435, "num_env_steps_trained_throughput_per_sec": 271.43453838610435, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 14474.157, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14474.112, "sample_time_ms": 1089.882, "learn_time_ms": 13367.17, "learn_throughput": 299.241, "synch_weights_time_ms": 16.047}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "6751e_00000", "date": "2024-08-11_19-13-47", "timestamp": 1723418027, "time_this_iter_s": 14.775867938995361, "time_total_s": 395.38929057121277, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 395.38929057121277, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 51.980952380952374, "ram_util_percent": 83.15238095238094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7766972653449528, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.947810652899364, "policy_loss": -0.004161870094735629, "vf_loss": 9.951620130690317, "vf_explained_var": -0.003944174101743749, "kl": 0.007047623069048608, "entropy": 1.0590852411335738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.734776902104181, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.981433655723693, "policy_loss": -0.007456930960336375, "vf_loss": 8.987040858293968, "vf_explained_var": 8.007048299072911e-06, "kl": 0.009248625188439965, "entropy": 1.1025633904038283, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 5901.123382611631, "episode_reward_min": -7.105427357601002e-15, "episode_reward_mean": 1010.6237844714924, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6381.947975795694, "predator_policy": -6123.09522904488}, "policy_reward_max": {"prey_policy": 8019.747571309179, "predator_policy": 9358.536828709153}, "policy_reward_mean": {"prey_policy": -56.75127859968678, "predator_policy": 562.0631708354331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2000.3494308385286, 725.0348234154994, 1043.2206679775757, 1039.0572023369136, 215.22256329691191, 0.0, 230.9497587932891, 2028.298966641916, 469.1434197257468, 0.0, 746.6390090045995, 0.0, 449.13147739050623, 0.0, 780.7227632916927, 2654.311845615396, 632.3747918144695, 0.0, -7.105427357601002e-15, 0.0, 973.0023554912592, 1144.000260451628, 1696.2152392384032, 1753.0410398305198, 0.0, 276.28086506570514, 634.7009126985141, 3484.913825065826, 1359.3162080098757, 683.7135779735212, 0.0, -3.552713678800501e-15, 633.6298735880546, 0.0, 2643.9456309689904, 2201.9879493393983, 0.0, 1156.129635405075, 2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 7.105427357601002e-15, 1.4210854715202004e-14, 0.0, 385.1622118450207, 1.7763568394002505e-15, 5901.123382611631, 515.3442076692357, 0.0, 2509.7386683724403, 2646.989344245227, 3627.833383751868, 238.99215610047338, 4412.497346841589, 1533.4014194795452, 722.8477210830986, 970.934324052962, 2964.5830472466087, 3565.722766998083, 4.263256414560601e-14, 1036.8932934594118, 113.66251353744636, 505.7797781679641, 240.79111337025697, 1.4210854715202004e-14, 749.8095312597119, 206.44032932727833, 221.82654832025275, 1448.9174829998403, 264.41342316582643, 3846.6993033140957, 116.22773081186253, 2532.400769046584, 1819.6972911042426, 2767.747812195548, 349.87514677474167, 1488.5291653787583, 0.0, 202.45026767112122, 777.0420597661459, 3.907985046680551e-14, 261.0314078524834, 2380.834663846888, 7.105427357601002e-15, 230.5012766288424, 3.552713678800501e-15, 722.920728050722, 0.0, 2076.3171634651385, 2341.2438652397996, 1695.7250441435629, 0.0, 3460.721251904944, 520.4599626781971, 899.0413392911979, 4256.723379902799, 0.0, 239.03507131316263, 1638.115659592805, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1101.4012614909188, -2411.5448329630685, 1514.329740287554, -2170.3956325055387, -3908.265355957561, -2204.6080934999395, 924.7858266017599, -2032.8093707691485, -427.41976825757456, 824.3065459415718, 1199.7752092403841, -1478.2133035796378, 3511.6989033815353, -960.3361610810222, 1488.6358202440192, 411.64052172422157, -699.4216342919959, -3072.349859019065, 6303.096059125376, -1337.714853419126, 1309.772176299709, -384.317794182377, 4597.267193294634, -3656.523104006841, 4536.55230611254, -157.15996397524697, 2265.5760629323445, -3803.250616327358, 2835.6717195165515, -3212.3250431528645, -4112.984050925242, -5529.310601050949, 1517.1777513234806, -2564.339204467573, -4231.86914656645, -5769.222532985445, 1827.1892345901142, -1593.4124839151887, 3235.19740523987, -1488.3173150771333, -2015.3592811864594, -4654.417345849138, -1591.3513756176428, -3584.7035043350816, 3007.350140343991, -1660.1762908882888, 5443.286052351651, -2775.123128103727, 4729.013695879108, -4699.896460832059, 1699.1611773507504, -2082.9254311471022, 2579.939080145687, -354.9021922302246, 463.68828789336766, -2412.887834606292, 2504.5610734405454, -5178.341358402365, -329.89719236196413, -1124.710978638615, 4230.6811618726715, -5918.69578465438, -902.1477509719743, -904.3669716717899, 389.46410027979977, -3613.802755305543, 3565.0727523731352, -2799.16903567702, -5274.388047590678, -4589.325466648694, 3851.586087180269, -1440.8261556014816, 4995.97474404961, -1070.7249802098215, 62.57086041375172, -3846.84445444879, 5323.575938305871, -3966.1252154029653, 6023.202607800312, 285.10513830391227, 74.49103575120657, -615.2571768566991, 5204.621108700887, -1382.8151858607262, -2730.0893323143687, -704.1766043498783, 3663.30208746624, -3609.9886369544897, 3559.78592040685, -3789.6075610841776, 453.37415682515024, -1407.231515686899, -354.3779677800166, -2112.521941492366, -2325.6322929605585, -3948.5823541748027, 145.6581119381122, -2684.3446292160306, 3665.1250377779334, -3422.646535731042, -1015.1059663709356, -1165.7304296652649, 819.4552028785032, -3028.8510989329907, 6232.565516769217, -2592.2005249780154, 3205.9005377631356, -1854.36597851482, 3785.4419480588854, -5639.34679713163, -83.33815477125557, 113.36670363870734, 691.7018102289849, -1827.0477432642754, -412.0887744789166, 16.390113962750867, 4143.058498459767, -552.778229636109, 6586.874607638529, 973.9164154943207, 4607.177847199429, -1526.8253374907724, 1665.3031105249227, -1309.2114085090823, 3592.7289190438305, -2723.0931435744387, 4420.619809408659, -2638.1894894497773, 2691.741370265534, -2687.9002380768657, 7345.1421388163235, -1526.5904957971848, 353.8920701497517, 1714.5521240236849, 2385.2308383914924, -538.5283210486696, 5579.740252826254, -1347.2602312849447, 1478.7396279937811, -3313.2436890516833, -4180.978399763834, -3409.1446970891056, 3649.5157898889283, -1197.2537939031613, 1247.515826214058, -3882.2406273432525, -2111.3531639890275, -6381.947975795694, 898.0396553686813, -3316.3834589766375, 5129.077202441703, -332.0254065893687, 3668.656895287509, 125.19849085459302, 4073.942136389844, -542.8065915318485, 2896.1291995458378, 101.7719558925257, 1845.3606654395612, -3006.660305775703, 2763.5134722980097, -1579.3794884518604, 4079.3413009009355, -1841.824737732149, 5319.861349437853, -473.4751754653916, 3099.195171644356, -2958.334045828305, 7880.718233598442, 1157.5306518659397, -264.88236468662734, -1970.6964155920036, 71.55947892624185, -2996.9019433537037, 8019.747571309179, -1965.7814025871837, -812.2711654560371, -811.7953150531865, 3742.3027607793247, 458.9898178225249, 4626.453192407281, -948.306698963023, 2798.668318765865, -2323.111793694262, -4038.8589031893825, -4492.731551182528, 2023.8225915788914, 2313.572152675178, -3541.795282234293, -5163.6420030193085, 6162.2317248859, -1160.9212834609139, 2933.4729138765874, -2666.0492922091644, -1675.214299091403, -2379.026944704822, 4438.928196341558, -912.577193476408, 5300.329071441215, -5496.54332153018], "policy_predator_policy_reward": [1125.0763284260918, 4388.219196866423, -116.04093602568308, 1497.1416516591682, 4421.228397813342, 2734.8657196217355, 2076.7389456400847, 70.3418008642176, 170.5618094101235, -352.226023797209, 259.7969384986289, 18.64115584062464, -3217.6562361699425, 897.2432526627174, 1282.3989289043695, -1154.376304230692, 1782.0208529099934, 2458.894060126815, 323.20972897724954, -5288.590934683492, -380.1160695107552, 201.3006963980225, -425.53661465616574, -515.2074746316242, -1332.6769891726774, -2597.5838755741106, -677.6488957579168, 2215.3234491529274, 1334.645499297029, -177.26941236902027, 4763.987680920981, 7532.618816670598, 2139.9521130840008, -460.41586812543875, 2519.9148632389474, 7481.17681631295, 898.522344202054, -1132.2990948769814, -577.4253919793964, -1169.4546981833412, 5949.070649199608, 1693.7083333272433, 1096.83214790911, 5223.2229924952435, 692.8592032648943, -343.81781348218937, -1545.8876816950867, 630.7657972776931, -1327.3251555284457, 1298.207920481393, -77.74084828206244, 737.7859671441198, -1389.1255012123959, -201.2104740045536, 4920.613448008179, 513.4999237705769, 3340.504134629405, 692.5923583422899, 371.53736563344694, 1766.784383340655, 379.7234873745503, 1308.2911354071593, 1529.7440556850108, 276.7706669587539, 2403.805209261324, 1454.1633193524794, -702.2967686220953, -63.60694807401692, 9358.536828709153, 3149.122316499204, 2288.414384368481, -2497.18636660787, -3216.2320090519693, -709.0177547878249, 1385.862868525754, 3554.540360914361, 1165.410424795729, -2522.8611476986325, -4427.196105827558, -1881.1116402766697, -62.99667740413873, 603.7628185096312, -2635.400331818616, -1186.4055910215388, 3041.9273765201087, 392.33856014413914, 1492.9485070339883, -1546.2619575457418, -2139.5973049681443, 2754.5811574904956, 879.7327771556766, 74.12458170607331, 4219.435310842945, 4148.5879810410615, 2533.874239999266, 4255.68461480533, 693.2152482831701, 1845.4712689947485, 3534.3713757542214, -1267.1112094286716, 2321.967763279806, 2505.857977001627, 2699.157333130881, 3138.0719466754804, -1903.2921281869526, -1498.080707503777, 1875.713507311264, 1185.2492802820134, 5451.829649041263, -2064.5233804889644, 543.2826155131049, 149.53655670254338, 2231.5340320386085, -125.25377495035855, 2394.500418179792, 965.7812895829811, 880.9401919521347, -905.4976937777132, -2744.022251478206, -4816.768771654642, -2889.825046660004, 846.3658304107591, 50.78651403125224, -293.2157025096443, 129.21736580140058, -493.07336310282824, -2586.6734769043396, 1045.0342703157162, -836.3244796291809, 832.4833474405114, -4870.053973616928, -198.688138142498, -1077.8710379080007, -784.1328269381575, -1666.511086971674, 41.635117949103176, 908.43509828166, -3691.9976368231255, 1189.353623729007, 909.5638604947229, 4286.999657585372, 7149.822742581667, -1026.5956444348933, -1309.4386207390148, 2364.535263765184, 2802.5903064105964, 5859.953207179554, 4453.045223709411, 3298.5245480703115, 1887.5670677331948, -3665.084935491818, -782.0917135857737, -1831.7125853069438, -473.61363545640074, -261.8335997552875, -3269.3019451027126, -2813.3641279309795, 17.9132401637371, 2156.1062885165734, -217.76458841428527, 1148.6729977671573, -2332.806981613307, -1026.6082304179754, -949.8769248983309, -1686.7924030195827, -778.7591071059915, -201.998422025772, 61.13729620972135, -4556.585412894382, -4251.162195941155, 387.93315575475583, 1847.6456245238758, 4014.3462443837534, -366.0830519055684, 69.12906032288204, -6123.09522904488, 1535.8528049097358, 2164.5308390646264, 224.12158293523407, -2084.170296297285, -1581.2548435742467, -401.16660572644844, 368.296274894773, -843.8527999663769, 7100.1534299351415, 4892.15827634171, -2362.887229940038, -1454.0475516358324, 6989.323539903669, 2615.1550846411265, 2409.3588012017663, -3153.9458627239733, 183.92382041708402, -451.34744208450985, 2317.8233923049934, 1975.4529228043941, 1584.1672935518075, -3472.402636824153, 2441.9979416019737, -2245.7836915130033]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6761220925143284, "mean_inference_ms": 1.4544471911847752, "mean_action_processing_ms": 0.27761018865481313, "mean_env_wait_ms": 0.12860902005078548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0062596797943115234, "StateBufferConnector_ms": 0.003446817398071289, "ViewRequirementAgentConnector_ms": 0.10126650333404541}, "num_episodes": 23, "episode_return_max": 5901.123382611631, "episode_return_min": -7.105427357601002e-15, "episode_return_mean": 1010.6237844714924, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.490617503835, "num_env_steps_trained_throughput_per_sec": 288.490617503835, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 14407.691, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14407.644, "sample_time_ms": 1084.244, "learn_time_ms": 13305.964, "learn_throughput": 300.617, "synch_weights_time_ms": 16.241}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "6751e_00000", "date": "2024-08-11_19-14-01", "timestamp": 1723418041, "time_this_iter_s": 13.906177043914795, "time_total_s": 409.29546761512756, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 409.29546761512756, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 49.015, "ram_util_percent": 82.69000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.716658295454487, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.977905075133792, "policy_loss": -0.007979871092176943, "vf_loss": 9.985381571956413, "vf_explained_var": -0.0020570798841103043, "kl": 0.010067586468402808, "entropy": 1.0727224448055186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7448373587910461, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.293333453728408, "policy_loss": -0.0075872085850547865, "vf_loss": 9.29905097850416, "vf_explained_var": 0.0002280005071529005, "kl": 0.009348471091636449, "entropy": 1.1253748602021938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 5901.123382611631, "episode_reward_min": -7.105427357601002e-15, "episode_reward_mean": 1148.4118337003672, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6381.947975795694, "predator_policy": -6123.09522904488}, "policy_reward_max": {"prey_policy": 8019.747571309179, "predator_policy": 9358.536828709153}, "policy_reward_mean": {"prey_policy": 13.94319121328077, "predator_policy": 560.2627256369029}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.105427357601002e-15, 0.0, 973.0023554912592, 1144.000260451628, 1696.2152392384032, 1753.0410398305198, 0.0, 276.28086506570514, 634.7009126985141, 3484.913825065826, 1359.3162080098757, 683.7135779735212, 0.0, -3.552713678800501e-15, 633.6298735880546, 0.0, 2643.9456309689904, 2201.9879493393983, 0.0, 1156.129635405075, 2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 7.105427357601002e-15, 1.4210854715202004e-14, 0.0, 385.1622118450207, 1.7763568394002505e-15, 5901.123382611631, 515.3442076692357, 0.0, 2509.7386683724403, 2646.989344245227, 3627.833383751868, 238.99215610047338, 4412.497346841589, 1533.4014194795452, 722.8477210830986, 970.934324052962, 2964.5830472466087, 3565.722766998083, 4.263256414560601e-14, 1036.8932934594118, 113.66251353744636, 505.7797781679641, 240.79111337025697, 1.4210854715202004e-14, 749.8095312597119, 206.44032932727833, 221.82654832025275, 1448.9174829998403, 264.41342316582643, 3846.6993033140957, 116.22773081186253, 2532.400769046584, 1819.6972911042426, 2767.747812195548, 349.87514677474167, 1488.5291653787583, 0.0, 202.45026767112122, 777.0420597661459, 3.907985046680551e-14, 261.0314078524834, 2380.834663846888, 7.105427357601002e-15, 230.5012766288424, 3.552713678800501e-15, 722.920728050722, 0.0, 2076.3171634651385, 2341.2438652397996, 1695.7250441435629, 0.0, 3460.721251904944, 520.4599626781971, 899.0413392911979, 4256.723379902799, 0.0, 239.03507131316263, 1638.115659592805, 0.0, 374.36420475028217, 246.4209821450596, 5050.133097921453, 1381.9342988058959, 0.0, 2979.939769591866, 140.79203081841752, 0.0, 0.0, 795.8947131623855, 0.0, 3208.8348617982756, 903.1504003718329, 479.46783888336313, 232.48266608731439, 343.57540133234386, 5815.642795321801, 4840.628582040261], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1827.1892345901142, -1593.4124839151887, 3235.19740523987, -1488.3173150771333, -2015.3592811864594, -4654.417345849138, -1591.3513756176428, -3584.7035043350816, 3007.350140343991, -1660.1762908882888, 5443.286052351651, -2775.123128103727, 4729.013695879108, -4699.896460832059, 1699.1611773507504, -2082.9254311471022, 2579.939080145687, -354.9021922302246, 463.68828789336766, -2412.887834606292, 2504.5610734405454, -5178.341358402365, -329.89719236196413, -1124.710978638615, 4230.6811618726715, -5918.69578465438, -902.1477509719743, -904.3669716717899, 389.46410027979977, -3613.802755305543, 3565.0727523731352, -2799.16903567702, -5274.388047590678, -4589.325466648694, 3851.586087180269, -1440.8261556014816, 4995.97474404961, -1070.7249802098215, 62.57086041375172, -3846.84445444879, 5323.575938305871, -3966.1252154029653, 6023.202607800312, 285.10513830391227, 74.49103575120657, -615.2571768566991, 5204.621108700887, -1382.8151858607262, -2730.0893323143687, -704.1766043498783, 3663.30208746624, -3609.9886369544897, 3559.78592040685, -3789.6075610841776, 453.37415682515024, -1407.231515686899, -354.3779677800166, -2112.521941492366, -2325.6322929605585, -3948.5823541748027, 145.6581119381122, -2684.3446292160306, 3665.1250377779334, -3422.646535731042, -1015.1059663709356, -1165.7304296652649, 819.4552028785032, -3028.8510989329907, 6232.565516769217, -2592.2005249780154, 3205.9005377631356, -1854.36597851482, 3785.4419480588854, -5639.34679713163, -83.33815477125557, 113.36670363870734, 691.7018102289849, -1827.0477432642754, -412.0887744789166, 16.390113962750867, 4143.058498459767, -552.778229636109, 6586.874607638529, 973.9164154943207, 4607.177847199429, -1526.8253374907724, 1665.3031105249227, -1309.2114085090823, 3592.7289190438305, -2723.0931435744387, 4420.619809408659, -2638.1894894497773, 2691.741370265534, -2687.9002380768657, 7345.1421388163235, -1526.5904957971848, 353.8920701497517, 1714.5521240236849, 2385.2308383914924, -538.5283210486696, 5579.740252826254, -1347.2602312849447, 1478.7396279937811, -3313.2436890516833, -4180.978399763834, -3409.1446970891056, 3649.5157898889283, -1197.2537939031613, 1247.515826214058, -3882.2406273432525, -2111.3531639890275, -6381.947975795694, 898.0396553686813, -3316.3834589766375, 5129.077202441703, -332.0254065893687, 3668.656895287509, 125.19849085459302, 4073.942136389844, -542.8065915318485, 2896.1291995458378, 101.7719558925257, 1845.3606654395612, -3006.660305775703, 2763.5134722980097, -1579.3794884518604, 4079.3413009009355, -1841.824737732149, 5319.861349437853, -473.4751754653916, 3099.195171644356, -2958.334045828305, 7880.718233598442, 1157.5306518659397, -264.88236468662734, -1970.6964155920036, 71.55947892624185, -2996.9019433537037, 8019.747571309179, -1965.7814025871837, -812.2711654560371, -811.7953150531865, 3742.3027607793247, 458.9898178225249, 4626.453192407281, -948.306698963023, 2798.668318765865, -2323.111793694262, -4038.8589031893825, -4492.731551182528, 2023.8225915788914, 2313.572152675178, -3541.795282234293, -5163.6420030193085, 6162.2317248859, -1160.9212834609139, 2933.4729138765874, -2666.0492922091644, -1675.214299091403, -2379.026944704822, 4438.928196341558, -912.577193476408, 5300.329071441215, -5496.54332153018, 3117.7002105405527, -1172.5414212187982, 742.7345001693475, -2840.9378432661288, -3971.64305956394, -1971.9698220981766, 2754.3845206480805, -3608.2727449292247, 6676.679007441709, 1312.7853936766926, 1144.2284546477151, -1978.445069140785, -2147.7480031513282, -4899.711239832753, 6572.689279703624, -5651.242140412019, 1601.975605983393, 880.7510670734648, 3961.781795826894, -4713.836360338428, 2320.4113738362707, 300.6990874768159, -863.2641575644344, -3724.036885120778, 5000.651548047728, -988.3339283959514, 1211.1605824190613, -1104.423435777836, 3813.7570840327458, -931.6068578619274, 3368.926215141786, -2574.1978409236476, -3938.450945259084, -178.90303545753648, -3320.319237595434, -2048.0340846134286], "policy_predator_policy_reward": [898.522344202054, -1132.2990948769814, -577.4253919793964, -1169.4546981833412, 5949.070649199608, 1693.7083333272433, 1096.83214790911, 5223.2229924952435, 692.8592032648943, -343.81781348218937, -1545.8876816950867, 630.7657972776931, -1327.3251555284457, 1298.207920481393, -77.74084828206244, 737.7859671441198, -1389.1255012123959, -201.2104740045536, 4920.613448008179, 513.4999237705769, 3340.504134629405, 692.5923583422899, 371.53736563344694, 1766.784383340655, 379.7234873745503, 1308.2911354071593, 1529.7440556850108, 276.7706669587539, 2403.805209261324, 1454.1633193524794, -702.2967686220953, -63.60694807401692, 9358.536828709153, 3149.122316499204, 2288.414384368481, -2497.18636660787, -3216.2320090519693, -709.0177547878249, 1385.862868525754, 3554.540360914361, 1165.410424795729, -2522.8611476986325, -4427.196105827558, -1881.1116402766697, -62.99667740413873, 603.7628185096312, -2635.400331818616, -1186.4055910215388, 3041.9273765201087, 392.33856014413914, 1492.9485070339883, -1546.2619575457418, -2139.5973049681443, 2754.5811574904956, 879.7327771556766, 74.12458170607331, 4219.435310842945, 4148.5879810410615, 2533.874239999266, 4255.68461480533, 693.2152482831701, 1845.4712689947485, 3534.3713757542214, -1267.1112094286716, 2321.967763279806, 2505.857977001627, 2699.157333130881, 3138.0719466754804, -1903.2921281869526, -1498.080707503777, 1875.713507311264, 1185.2492802820134, 5451.829649041263, -2064.5233804889644, 543.2826155131049, 149.53655670254338, 2231.5340320386085, -125.25377495035855, 2394.500418179792, 965.7812895829811, 880.9401919521347, -905.4976937777132, -2744.022251478206, -4816.768771654642, -2889.825046660004, 846.3658304107591, 50.78651403125224, -293.2157025096443, 129.21736580140058, -493.07336310282824, -2586.6734769043396, 1045.0342703157162, -836.3244796291809, 832.4833474405114, -4870.053973616928, -198.688138142498, -1077.8710379080007, -784.1328269381575, -1666.511086971674, 41.635117949103176, 908.43509828166, -3691.9976368231255, 1189.353623729007, 909.5638604947229, 4286.999657585372, 7149.822742581667, -1026.5956444348933, -1309.4386207390148, 2364.535263765184, 2802.5903064105964, 5859.953207179554, 4453.045223709411, 3298.5245480703115, 1887.5670677331948, -3665.084935491818, -782.0917135857737, -1831.7125853069438, -473.61363545640074, -261.8335997552875, -3269.3019451027126, -2813.3641279309795, 17.9132401637371, 2156.1062885165734, -217.76458841428527, 1148.6729977671573, -2332.806981613307, -1026.6082304179754, -949.8769248983309, -1686.7924030195827, -778.7591071059915, -201.998422025772, 61.13729620972135, -4556.585412894382, -4251.162195941155, 387.93315575475583, 1847.6456245238758, 4014.3462443837534, -366.0830519055684, 69.12906032288204, -6123.09522904488, 1535.8528049097358, 2164.5308390646264, 224.12158293523407, -2084.170296297285, -1581.2548435742467, -401.16660572644844, 368.296274894773, -843.8527999663769, 7100.1534299351415, 4892.15827634171, -2362.887229940038, -1454.0475516358324, 6989.323539903669, 2615.1550846411265, 2409.3588012017663, -3153.9458627239733, 183.92382041708402, -451.34744208450985, 2317.8233923049934, 1975.4529228043941, 1584.1672935518075, -3472.402636824153, 2441.9979416019737, -2245.7836915130033, 211.5172994686393, -1782.31188404011, 129.92508809059535, 2214.699237151247, 5868.6069263241025, 5125.139053259462, 1807.8995936492713, 427.9229294377742, -4681.0226153884305, -3308.4417857299695, 1416.5035678573947, 2397.6528162275463, 5386.946064970836, 1801.305208831653, 1638.2161002238909, -2559.6632395154925, -1490.7177758197467, -992.0088972371115, 1571.9697172872932, -24.020439613371003, 201.1345667058481, -2822.2450280189373, 3193.0509097903596, 4603.084994693122, -2237.1561623537978, -872.0110569261469, 1401.4757179247174, -1028.7450256825805, -3698.8219107727305, 1049.154350689225, -298.73730628270863, -152.41566660308504, 7422.710302822401, 2510.28647321602, 5745.144189039354, 4463.837715209773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6748007609962816, "mean_inference_ms": 1.4553892116012528, "mean_action_processing_ms": 0.2809697908923114, "mean_env_wait_ms": 0.12846513117736696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00589752197265625, "StateBufferConnector_ms": 0.003463149070739746, "ViewRequirementAgentConnector_ms": 0.1031794548034668}, "num_episodes": 18, "episode_return_max": 5901.123382611631, "episode_return_min": -7.105427357601002e-15, "episode_return_mean": 1148.4118337003672, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.5301150046534, "num_env_steps_trained_throughput_per_sec": 256.5301150046534, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 14552.234, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14552.187, "sample_time_ms": 1167.311, "learn_time_ms": 13366.81, "learn_throughput": 299.249, "synch_weights_time_ms": 16.782}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "6751e_00000", "date": "2024-08-11_19-14-17", "timestamp": 1723418057, "time_this_iter_s": 15.650519847869873, "time_total_s": 424.94598746299744, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea8f5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 424.94598746299744, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 55.61818181818182, "ram_util_percent": 83.17727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6924960949354702, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.955441023306872, "policy_loss": -0.008198027183528418, "vf_loss": 9.963029743880822, "vf_explained_var": 0.003194403711450163, "kl": 0.012186124522099407, "entropy": 1.0339563484860477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7742143263261785, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.27340706063326, "policy_loss": -0.006008728158477911, "vf_loss": 9.278112227828414, "vf_explained_var": -2.067417064041057e-05, "kl": 0.006517529503838827, "entropy": 1.0899967529786327, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 5901.123382611631, "episode_reward_min": 0.0, "episode_reward_mean": 1097.5559144468557, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6381.947975795694, "predator_policy": -6123.09522904488}, "policy_reward_max": {"prey_policy": 8019.747571309179, "predator_policy": 7422.710302822401}, "policy_reward_mean": {"prey_policy": 52.26340575694508, "predator_policy": 496.5145514664828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 1156.129635405075, 2.1316282072803006e-14, 7.105427357601002e-15, 0.0, 7.105427357601002e-15, 1.4210854715202004e-14, 0.0, 385.1622118450207, 1.7763568394002505e-15, 5901.123382611631, 515.3442076692357, 0.0, 2509.7386683724403, 2646.989344245227, 3627.833383751868, 238.99215610047338, 4412.497346841589, 1533.4014194795452, 722.8477210830986, 970.934324052962, 2964.5830472466087, 3565.722766998083, 4.263256414560601e-14, 1036.8932934594118, 113.66251353744636, 505.7797781679641, 240.79111337025697, 1.4210854715202004e-14, 749.8095312597119, 206.44032932727833, 221.82654832025275, 1448.9174829998403, 264.41342316582643, 3846.6993033140957, 116.22773081186253, 2532.400769046584, 1819.6972911042426, 2767.747812195548, 349.87514677474167, 1488.5291653787583, 0.0, 202.45026767112122, 777.0420597661459, 3.907985046680551e-14, 261.0314078524834, 2380.834663846888, 7.105427357601002e-15, 230.5012766288424, 3.552713678800501e-15, 722.920728050722, 0.0, 2076.3171634651385, 2341.2438652397996, 1695.7250441435629, 0.0, 3460.721251904944, 520.4599626781971, 899.0413392911979, 4256.723379902799, 0.0, 239.03507131316263, 1638.115659592805, 0.0, 374.36420475028217, 246.4209821450596, 5050.133097921453, 1381.9342988058959, 0.0, 2979.939769591866, 140.79203081841752, 0.0, 0.0, 795.8947131623855, 0.0, 3208.8348617982756, 903.1504003718329, 479.46783888336313, 232.48266608731439, 343.57540133234386, 5815.642795321801, 4840.628582040261, 121.11172312224731, 1127.2612770124251, 1425.2733134527598, 259.4449786901367, 973.2386756230928, 1291.5215940656826, 1034.5253999018419, 902.7708124665916, 712.3039550305973, 0.0, 338.194934206526, 109.92741248970673, 0.0, 979.4042932613702, 493.0637720635344, 480.44359234024773, 102.01132211870501, 2048.6587565250593], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4995.97474404961, -1070.7249802098215, 62.57086041375172, -3846.84445444879, 5323.575938305871, -3966.1252154029653, 6023.202607800312, 285.10513830391227, 74.49103575120657, -615.2571768566991, 5204.621108700887, -1382.8151858607262, -2730.0893323143687, -704.1766043498783, 3663.30208746624, -3609.9886369544897, 3559.78592040685, -3789.6075610841776, 453.37415682515024, -1407.231515686899, -354.3779677800166, -2112.521941492366, -2325.6322929605585, -3948.5823541748027, 145.6581119381122, -2684.3446292160306, 3665.1250377779334, -3422.646535731042, -1015.1059663709356, -1165.7304296652649, 819.4552028785032, -3028.8510989329907, 6232.565516769217, -2592.2005249780154, 3205.9005377631356, -1854.36597851482, 3785.4419480588854, -5639.34679713163, -83.33815477125557, 113.36670363870734, 691.7018102289849, -1827.0477432642754, -412.0887744789166, 16.390113962750867, 4143.058498459767, -552.778229636109, 6586.874607638529, 973.9164154943207, 4607.177847199429, -1526.8253374907724, 1665.3031105249227, -1309.2114085090823, 3592.7289190438305, -2723.0931435744387, 4420.619809408659, -2638.1894894497773, 2691.741370265534, -2687.9002380768657, 7345.1421388163235, -1526.5904957971848, 353.8920701497517, 1714.5521240236849, 2385.2308383914924, -538.5283210486696, 5579.740252826254, -1347.2602312849447, 1478.7396279937811, -3313.2436890516833, -4180.978399763834, -3409.1446970891056, 3649.5157898889283, -1197.2537939031613, 1247.515826214058, -3882.2406273432525, -2111.3531639890275, -6381.947975795694, 898.0396553686813, -3316.3834589766375, 5129.077202441703, -332.0254065893687, 3668.656895287509, 125.19849085459302, 4073.942136389844, -542.8065915318485, 2896.1291995458378, 101.7719558925257, 1845.3606654395612, -3006.660305775703, 2763.5134722980097, -1579.3794884518604, 4079.3413009009355, -1841.824737732149, 5319.861349437853, -473.4751754653916, 3099.195171644356, -2958.334045828305, 7880.718233598442, 1157.5306518659397, -264.88236468662734, -1970.6964155920036, 71.55947892624185, -2996.9019433537037, 8019.747571309179, -1965.7814025871837, -812.2711654560371, -811.7953150531865, 3742.3027607793247, 458.9898178225249, 4626.453192407281, -948.306698963023, 2798.668318765865, -2323.111793694262, -4038.8589031893825, -4492.731551182528, 2023.8225915788914, 2313.572152675178, -3541.795282234293, -5163.6420030193085, 6162.2317248859, -1160.9212834609139, 2933.4729138765874, -2666.0492922091644, -1675.214299091403, -2379.026944704822, 4438.928196341558, -912.577193476408, 5300.329071441215, -5496.54332153018, 3117.7002105405527, -1172.5414212187982, 742.7345001693475, -2840.9378432661288, -3971.64305956394, -1971.9698220981766, 2754.3845206480805, -3608.2727449292247, 6676.679007441709, 1312.7853936766926, 1144.2284546477151, -1978.445069140785, -2147.7480031513282, -4899.711239832753, 6572.689279703624, -5651.242140412019, 1601.975605983393, 880.7510670734648, 3961.781795826894, -4713.836360338428, 2320.4113738362707, 300.6990874768159, -863.2641575644344, -3724.036885120778, 5000.651548047728, -988.3339283959514, 1211.1605824190613, -1104.423435777836, 3813.7570840327458, -931.6068578619274, 3368.926215141786, -2574.1978409236476, -3938.450945259084, -178.90303545753648, -3320.319237595434, -2048.0340846134286, 5556.594030643968, -9.8108983405399, 3901.841965624579, -489.71312130031845, -996.7471267322726, -1268.5568357388483, 784.9874780068255, -2779.112208676067, 4964.647875136164, -3515.4494263977226, 881.5256046271494, -4651.154904923293, 7477.988931453655, -4015.047821571501, -878.3810531434244, -3000.7328444464974, -1146.929739080834, -926.5772634205072, 2350.009983971114, -2569.0151546899747, -102.56554907841004, -957.8163152252906, -1466.8152985627535, -2387.1384628187607, 260.7916630225425, -1865.2075685114423, 1272.113763242511, -6281.13155862623, 3429.888231724504, -1947.3462124144642, -2807.335594930624, -1500.762244877652, -1430.260716302067, 2215.0348515576206, 367.7180774226435, -2268.4455202627973], "policy_predator_policy_reward": [-3216.2320090519693, -709.0177547878249, 1385.862868525754, 3554.540360914361, 1165.410424795729, -2522.8611476986325, -4427.196105827558, -1881.1116402766697, -62.99667740413873, 603.7628185096312, -2635.400331818616, -1186.4055910215388, 3041.9273765201087, 392.33856014413914, 1492.9485070339883, -1546.2619575457418, -2139.5973049681443, 2754.5811574904956, 879.7327771556766, 74.12458170607331, 4219.435310842945, 4148.5879810410615, 2533.874239999266, 4255.68461480533, 693.2152482831701, 1845.4712689947485, 3534.3713757542214, -1267.1112094286716, 2321.967763279806, 2505.857977001627, 2699.157333130881, 3138.0719466754804, -1903.2921281869526, -1498.080707503777, 1875.713507311264, 1185.2492802820134, 5451.829649041263, -2064.5233804889644, 543.2826155131049, 149.53655670254338, 2231.5340320386085, -125.25377495035855, 2394.500418179792, 965.7812895829811, 880.9401919521347, -905.4976937777132, -2744.022251478206, -4816.768771654642, -2889.825046660004, 846.3658304107591, 50.78651403125224, -293.2157025096443, 129.21736580140058, -493.07336310282824, -2586.6734769043396, 1045.0342703157162, -836.3244796291809, 832.4833474405114, -4870.053973616928, -198.688138142498, -1077.8710379080007, -784.1328269381575, -1666.511086971674, 41.635117949103176, 908.43509828166, -3691.9976368231255, 1189.353623729007, 909.5638604947229, 4286.999657585372, 7149.822742581667, -1026.5956444348933, -1309.4386207390148, 2364.535263765184, 2802.5903064105964, 5859.953207179554, 4453.045223709411, 3298.5245480703115, 1887.5670677331948, -3665.084935491818, -782.0917135857737, -1831.7125853069438, -473.61363545640074, -261.8335997552875, -3269.3019451027126, -2813.3641279309795, 17.9132401637371, 2156.1062885165734, -217.76458841428527, 1148.6729977671573, -2332.806981613307, -1026.6082304179754, -949.8769248983309, -1686.7924030195827, -778.7591071059915, -201.998422025772, 61.13729620972135, -4556.585412894382, -4251.162195941155, 387.93315575475583, 1847.6456245238758, 4014.3462443837534, -366.0830519055684, 69.12906032288204, -6123.09522904488, 1535.8528049097358, 2164.5308390646264, 224.12158293523407, -2084.170296297285, -1581.2548435742467, -401.16660572644844, 368.296274894773, -843.8527999663769, 7100.1534299351415, 4892.15827634171, -2362.887229940038, -1454.0475516358324, 6989.323539903669, 2615.1550846411265, 2409.3588012017663, -3153.9458627239733, 183.92382041708402, -451.34744208450985, 2317.8233923049934, 1975.4529228043941, 1584.1672935518075, -3472.402636824153, 2441.9979416019737, -2245.7836915130033, 211.5172994686393, -1782.31188404011, 129.92508809059535, 2214.699237151247, 5868.6069263241025, 5125.139053259462, 1807.8995936492713, 427.9229294377742, -4681.0226153884305, -3308.4417857299695, 1416.5035678573947, 2397.6528162275463, 5386.946064970836, 1801.305208831653, 1638.2161002238909, -2559.6632395154925, -1490.7177758197467, -992.0088972371115, 1571.9697172872932, -24.020439613371003, 201.1345667058481, -2822.2450280189373, 3193.0509097903596, 4603.084994693122, -2237.1561623537978, -872.0110569261469, 1401.4757179247174, -1028.7450256825805, -3698.8219107727305, 1049.154350689225, -298.73730628270863, -152.41566660308504, 7422.710302822401, 2510.28647321602, 5745.144189039354, 4463.837715209773, -3131.448802078725, -2294.2226071024575, -1195.7158529108897, -1089.151714400944, 2503.59741954433, 1186.9798563795532, 1566.0649510805608, 687.5047582788171, -1667.8438439799268, 1191.8840708645803, 4011.6214715935007, 1049.5294227683262, -3620.416156202461, 1192.0004462221511, 2772.223055634681, 2009.6616544218298, 654.0902977114818, 2131.7206598204543, -1297.2159250566729, 1516.2210957755335, 135.8510783455857, 1262.7257201646405, 576.0622303091784, 3387.8189435620407, 2201.5888921448777, -597.1729866559751, 3962.38624530668, 2026.03584333841, -1081.9271345476216, 92.44888730111923, 3734.2992809979614, 1054.2421511505618, 510.34621019452277, -1193.1090233313723, 148.82354991831957, 3800.562649446895]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.673664230327715, "mean_inference_ms": 1.45672058330894, "mean_action_processing_ms": 0.2842442902562972, "mean_env_wait_ms": 0.1282747050803108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005454659461975098, "StateBufferConnector_ms": 0.0030821561813354492, "ViewRequirementAgentConnector_ms": 0.09939980506896973}, "num_episodes": 18, "episode_return_max": 5901.123382611631, "episode_return_min": 0.0, "episode_return_mean": 1097.5559144468557, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.71117109830845, "num_env_steps_trained_throughput_per_sec": 280.71117109830845, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 14526.817, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14526.771, "sample_time_ms": 1176.362, "learn_time_ms": 13332.261, "learn_throughput": 300.024, "synch_weights_time_ms": 16.958}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "6751e_00000", "date": "2024-08-11_19-14-31", "timestamp": 1723418071, "time_this_iter_s": 14.285691022872925, "time_total_s": 439.23167848587036, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 439.23167848587036, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 50.245, "ram_util_percent": 82.84}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7301316263183715, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.963855472443596, "policy_loss": -0.005361296095584751, "vf_loss": 9.968892158023895, "vf_explained_var": 0.005304739304951259, "kl": 0.006492119717770397, "entropy": 1.0116646633892463, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8104166353663439, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.348967638469878, "policy_loss": -0.00785578047393491, "vf_loss": 9.355445083234676, "vf_explained_var": 0.00017969806989034018, "kl": 0.006891638935491861, "entropy": 1.0205909696205584, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 5815.642795321801, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 985.2128235003017, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6381.947975795694, "predator_policy": -6470.1725508640775}, "policy_reward_max": {"prey_policy": 8019.747571309179, "predator_policy": 7422.710302822401}, "policy_reward_mean": {"prey_policy": 208.4313598752332, "predator_policy": 284.1750518749177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1533.4014194795452, 722.8477210830986, 970.934324052962, 2964.5830472466087, 3565.722766998083, 4.263256414560601e-14, 1036.8932934594118, 113.66251353744636, 505.7797781679641, 240.79111337025697, 1.4210854715202004e-14, 749.8095312597119, 206.44032932727833, 221.82654832025275, 1448.9174829998403, 264.41342316582643, 3846.6993033140957, 116.22773081186253, 2532.400769046584, 1819.6972911042426, 2767.747812195548, 349.87514677474167, 1488.5291653787583, 0.0, 202.45026767112122, 777.0420597661459, 3.907985046680551e-14, 261.0314078524834, 2380.834663846888, 7.105427357601002e-15, 230.5012766288424, 3.552713678800501e-15, 722.920728050722, 0.0, 2076.3171634651385, 2341.2438652397996, 1695.7250441435629, 0.0, 3460.721251904944, 520.4599626781971, 899.0413392911979, 4256.723379902799, 0.0, 239.03507131316263, 1638.115659592805, 0.0, 374.36420475028217, 246.4209821450596, 5050.133097921453, 1381.9342988058959, 0.0, 2979.939769591866, 140.79203081841752, 0.0, 0.0, 795.8947131623855, 0.0, 3208.8348617982756, 903.1504003718329, 479.46783888336313, 232.48266608731439, 343.57540133234386, 5815.642795321801, 4840.628582040261, 121.11172312224731, 1127.2612770124251, 1425.2733134527598, 259.4449786901367, 973.2386756230928, 1291.5215940656826, 1034.5253999018419, 902.7708124665916, 712.3039550305973, 0.0, 338.194934206526, 109.92741248970673, 0.0, 979.4042932613702, 493.0637720635344, 480.44359234024773, 102.01132211870501, 2048.6587565250593, 866.7034694307279, 1158.887316504995, 214.29207381932662, 132.62134000883037, 146.543055971946, 1795.339089832112, 0.0, -2.842170943040401e-14, 474.91075047449294, 396.0332261402216, 2253.384652154061, 775.5152871981194, 339.6705029316563, 627.0846379567558, 7.105427357601002e-15, 731.7170900139871, 246.79874974993118, 1.4210854715202004e-14], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3785.4419480588854, -5639.34679713163, -83.33815477125557, 113.36670363870734, 691.7018102289849, -1827.0477432642754, -412.0887744789166, 16.390113962750867, 4143.058498459767, -552.778229636109, 6586.874607638529, 973.9164154943207, 4607.177847199429, -1526.8253374907724, 1665.3031105249227, -1309.2114085090823, 3592.7289190438305, -2723.0931435744387, 4420.619809408659, -2638.1894894497773, 2691.741370265534, -2687.9002380768657, 7345.1421388163235, -1526.5904957971848, 353.8920701497517, 1714.5521240236849, 2385.2308383914924, -538.5283210486696, 5579.740252826254, -1347.2602312849447, 1478.7396279937811, -3313.2436890516833, -4180.978399763834, -3409.1446970891056, 3649.5157898889283, -1197.2537939031613, 1247.515826214058, -3882.2406273432525, -2111.3531639890275, -6381.947975795694, 898.0396553686813, -3316.3834589766375, 5129.077202441703, -332.0254065893687, 3668.656895287509, 125.19849085459302, 4073.942136389844, -542.8065915318485, 2896.1291995458378, 101.7719558925257, 1845.3606654395612, -3006.660305775703, 2763.5134722980097, -1579.3794884518604, 4079.3413009009355, -1841.824737732149, 5319.861349437853, -473.4751754653916, 3099.195171644356, -2958.334045828305, 7880.718233598442, 1157.5306518659397, -264.88236468662734, -1970.6964155920036, 71.55947892624185, -2996.9019433537037, 8019.747571309179, -1965.7814025871837, -812.2711654560371, -811.7953150531865, 3742.3027607793247, 458.9898178225249, 4626.453192407281, -948.306698963023, 2798.668318765865, -2323.111793694262, -4038.8589031893825, -4492.731551182528, 2023.8225915788914, 2313.572152675178, -3541.795282234293, -5163.6420030193085, 6162.2317248859, -1160.9212834609139, 2933.4729138765874, -2666.0492922091644, -1675.214299091403, -2379.026944704822, 4438.928196341558, -912.577193476408, 5300.329071441215, -5496.54332153018, 3117.7002105405527, -1172.5414212187982, 742.7345001693475, -2840.9378432661288, -3971.64305956394, -1971.9698220981766, 2754.3845206480805, -3608.2727449292247, 6676.679007441709, 1312.7853936766926, 1144.2284546477151, -1978.445069140785, -2147.7480031513282, -4899.711239832753, 6572.689279703624, -5651.242140412019, 1601.975605983393, 880.7510670734648, 3961.781795826894, -4713.836360338428, 2320.4113738362707, 300.6990874768159, -863.2641575644344, -3724.036885120778, 5000.651548047728, -988.3339283959514, 1211.1605824190613, -1104.423435777836, 3813.7570840327458, -931.6068578619274, 3368.926215141786, -2574.1978409236476, -3938.450945259084, -178.90303545753648, -3320.319237595434, -2048.0340846134286, 5556.594030643968, -9.8108983405399, 3901.841965624579, -489.71312130031845, -996.7471267322726, -1268.5568357388483, 784.9874780068255, -2779.112208676067, 4964.647875136164, -3515.4494263977226, 881.5256046271494, -4651.154904923293, 7477.988931453655, -4015.047821571501, -878.3810531434244, -3000.7328444464974, -1146.929739080834, -926.5772634205072, 2350.009983971114, -2569.0151546899747, -102.56554907841004, -957.8163152252906, -1466.8152985627535, -2387.1384628187607, 260.7916630225425, -1865.2075685114423, 1272.113763242511, -6281.13155862623, 3429.888231724504, -1947.3462124144642, -2807.335594930624, -1500.762244877652, -1430.260716302067, 2215.0348515576206, 367.7180774226435, -2268.4455202627973, 4201.126744233176, -3232.8389106862824, 7551.461521684936, -830.0404042204974, 5514.971063837623, 1588.2792300268611, 1569.3155401295903, -2118.9897910794743, 1498.116092127053, -4512.361281786711, 4005.9672191883606, -3579.048756235777, 4751.250271867975, -1876.8297542616986, 5709.683456754588, -1940.4264851973198, 1471.4547531251947, -5473.717442233921, 2625.4160358490785, -2196.9227971877413, -55.65876606265432, -1759.8459851623375, 3168.2156075598746, -2316.410416294856, 7113.201884484213, -1545.630530002313, 6273.070108259621, 99.30959319341588, -1275.7519549773597, -261.2191882268298, 5644.365465054773, -4254.1257947735885, 6412.51423064697, -2452.5216025851028, 243.6283106376218, -2437.9288218638144], "policy_predator_policy_reward": [5451.829649041263, -2064.5233804889644, 543.2826155131049, 149.53655670254338, 2231.5340320386085, -125.25377495035855, 2394.500418179792, 965.7812895829811, 880.9401919521347, -905.4976937777132, -2744.022251478206, -4816.768771654642, -2889.825046660004, 846.3658304107591, 50.78651403125224, -293.2157025096443, 129.21736580140058, -493.07336310282824, -2586.6734769043396, 1045.0342703157162, -836.3244796291809, 832.4833474405114, -4870.053973616928, -198.688138142498, -1077.8710379080007, -784.1328269381575, -1666.511086971674, 41.635117949103176, 908.43509828166, -3691.9976368231255, 1189.353623729007, 909.5638604947229, 4286.999657585372, 7149.822742581667, -1026.5956444348933, -1309.4386207390148, 2364.535263765184, 2802.5903064105964, 5859.953207179554, 4453.045223709411, 3298.5245480703115, 1887.5670677331948, -3665.084935491818, -782.0917135857737, -1831.7125853069438, -473.61363545640074, -261.8335997552875, -3269.3019451027126, -2813.3641279309795, 17.9132401637371, 2156.1062885165734, -217.76458841428527, 1148.6729977671573, -2332.806981613307, -1026.6082304179754, -949.8769248983309, -1686.7924030195827, -778.7591071059915, -201.998422025772, 61.13729620972135, -4556.585412894382, -4251.162195941155, 387.93315575475583, 1847.6456245238758, 4014.3462443837534, -366.0830519055684, 69.12906032288204, -6123.09522904488, 1535.8528049097358, 2164.5308390646264, 224.12158293523407, -2084.170296297285, -1581.2548435742467, -401.16660572644844, 368.296274894773, -843.8527999663769, 7100.1534299351415, 4892.15827634171, -2362.887229940038, -1454.0475516358324, 6989.323539903669, 2615.1550846411265, 2409.3588012017663, -3153.9458627239733, 183.92382041708402, -451.34744208450985, 2317.8233923049934, 1975.4529228043941, 1584.1672935518075, -3472.402636824153, 2441.9979416019737, -2245.7836915130033, 211.5172994686393, -1782.31188404011, 129.92508809059535, 2214.699237151247, 5868.6069263241025, 5125.139053259462, 1807.8995936492713, 427.9229294377742, -4681.0226153884305, -3308.4417857299695, 1416.5035678573947, 2397.6528162275463, 5386.946064970836, 1801.305208831653, 1638.2161002238909, -2559.6632395154925, -1490.7177758197467, -992.0088972371115, 1571.9697172872932, -24.020439613371003, 201.1345667058481, -2822.2450280189373, 3193.0509097903596, 4603.084994693122, -2237.1561623537978, -872.0110569261469, 1401.4757179247174, -1028.7450256825805, -3698.8219107727305, 1049.154350689225, -298.73730628270863, -152.41566660308504, 7422.710302822401, 2510.28647321602, 5745.144189039354, 4463.837715209773, -3131.448802078725, -2294.2226071024575, -1195.7158529108897, -1089.151714400944, 2503.59741954433, 1186.9798563795532, 1566.0649510805608, 687.5047582788171, -1667.8438439799268, 1191.8840708645803, 4011.6214715935007, 1049.5294227683262, -3620.416156202461, 1192.0004462221511, 2772.223055634681, 2009.6616544218298, 654.0902977114818, 2131.7206598204543, -1297.2159250566729, 1516.2210957755335, 135.8510783455857, 1262.7257201646405, 576.0622303091784, 3387.8189435620407, 2201.5888921448777, -597.1729866559751, 3962.38624530668, 2026.03584333841, -1081.9271345476216, 92.44888730111923, 3734.2992809979614, 1054.2421511505618, 510.34621019452277, -1193.1090233313723, 148.82354991831957, 3800.562649446895, -447.1251113485055, 345.54074723233504, -557.5902612719809, -5004.943539687459, -6470.1725508640775, -418.785669181081, 1504.2708357220417, -821.9752447633315, 3002.784387047633, 158.0038585839723, 281.19325138205465, 1087.2273754974751, 0.0, -2874.420517606275, 805.1467468503002, -4574.403718407568, 3643.455777551916, 833.717662031302, 1322.9019824889908, -1355.3619950101074, 1805.0061386247487, 2263.8832647543013, -1397.7563105218383, 1321.4664064549422, -4520.730605584022, -707.1702459662196, -760.6999324832001, -4984.5951310130795, 1590.5349471424295, -53.56380393823881, -881.8405852176495, 223.3180049504537, 701.5708806098751, -4414.764758921813, 804.3140443375299, 1389.9864668886617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6732218907686068, "mean_inference_ms": 1.4585163706069217, "mean_action_processing_ms": 0.2874875924265012, "mean_env_wait_ms": 0.1282453644728112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005265235900878906, "StateBufferConnector_ms": 0.0030945539474487305, "ViewRequirementAgentConnector_ms": 0.1007378101348877}, "num_episodes": 18, "episode_return_max": 5815.642795321801, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 985.2128235003017, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.7257345529906, "num_env_steps_trained_throughput_per_sec": 281.7257345529906, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 14472.2, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14472.152, "sample_time_ms": 1180.852, "learn_time_ms": 13272.988, "learn_throughput": 301.364, "synch_weights_time_ms": 17.043}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "6751e_00000", "date": "2024-08-11_19-14-45", "timestamp": 1723418085, "time_this_iter_s": 14.23613691329956, "time_total_s": 453.4678153991699, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 453.4678153991699, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 54.342857142857156, "ram_util_percent": 83.13333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8007820800971732, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.93420335931122, "policy_loss": -0.008687753181919337, "vf_loss": 9.942467760661291, "vf_explained_var": 0.007676672147064613, "kl": 0.008467126597332432, "entropy": 1.0533536043432024, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8345586780202452, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.374109387271618, "policy_loss": -0.007744309351355744, "vf_loss": 9.380589185442243, "vf_explained_var": 0.0003540859020576275, "kl": 0.006322430842347814, "entropy": 1.05133061364845, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 5815.642795321801, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 887.6876675982738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6281.13155862623, "predator_policy": -6470.1725508640775}, "policy_reward_max": {"prey_policy": 8019.747571309179, "predator_policy": 7422.710302822401}, "policy_reward_mean": {"prey_policy": 98.19129405486736, "predator_policy": 345.6525397442693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [261.0314078524834, 2380.834663846888, 7.105427357601002e-15, 230.5012766288424, 3.552713678800501e-15, 722.920728050722, 0.0, 2076.3171634651385, 2341.2438652397996, 1695.7250441435629, 0.0, 3460.721251904944, 520.4599626781971, 899.0413392911979, 4256.723379902799, 0.0, 239.03507131316263, 1638.115659592805, 0.0, 374.36420475028217, 246.4209821450596, 5050.133097921453, 1381.9342988058959, 0.0, 2979.939769591866, 140.79203081841752, 0.0, 0.0, 795.8947131623855, 0.0, 3208.8348617982756, 903.1504003718329, 479.46783888336313, 232.48266608731439, 343.57540133234386, 5815.642795321801, 4840.628582040261, 121.11172312224731, 1127.2612770124251, 1425.2733134527598, 259.4449786901367, 973.2386756230928, 1291.5215940656826, 1034.5253999018419, 902.7708124665916, 712.3039550305973, 0.0, 338.194934206526, 109.92741248970673, 0.0, 979.4042932613702, 493.0637720635344, 480.44359234024773, 102.01132211870501, 2048.6587565250593, 866.7034694307279, 1158.887316504995, 214.29207381932662, 132.62134000883037, 146.543055971946, 1795.339089832112, 0.0, -2.842170943040401e-14, 474.91075047449294, 396.0332261402216, 2253.384652154061, 775.5152871981194, 339.6705029316563, 627.0846379567558, 7.105427357601002e-15, 731.7170900139871, 246.79874974993118, 1.4210854715202004e-14, 969.9214343735064, 1233.3751118627224, 1583.1955121731019, 119.09528690260821, 278.0420502724979, 354.297901880411, 978.0783638961707, -1.4210854715202004e-14, 0.0, 700.5319323407246, 1302.390940543771, 628.4836671282754, 1129.3842604505576, 1922.9445704429722, 431.2381906518078, 1005.5498347528935, 0.0, 336.68990976538197, 1856.3298487749105, 903.168850888542, -1.7763568394002505e-14, 115.72425145510829, 1479.928007912415, 1113.6420834851876, 252.16523837502643, 0.0, -2.842170943040401e-14], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4079.3413009009355, -1841.824737732149, 5319.861349437853, -473.4751754653916, 3099.195171644356, -2958.334045828305, 7880.718233598442, 1157.5306518659397, -264.88236468662734, -1970.6964155920036, 71.55947892624185, -2996.9019433537037, 8019.747571309179, -1965.7814025871837, -812.2711654560371, -811.7953150531865, 3742.3027607793247, 458.9898178225249, 4626.453192407281, -948.306698963023, 2798.668318765865, -2323.111793694262, -4038.8589031893825, -4492.731551182528, 2023.8225915788914, 2313.572152675178, -3541.795282234293, -5163.6420030193085, 6162.2317248859, -1160.9212834609139, 2933.4729138765874, -2666.0492922091644, -1675.214299091403, -2379.026944704822, 4438.928196341558, -912.577193476408, 5300.329071441215, -5496.54332153018, 3117.7002105405527, -1172.5414212187982, 742.7345001693475, -2840.9378432661288, -3971.64305956394, -1971.9698220981766, 2754.3845206480805, -3608.2727449292247, 6676.679007441709, 1312.7853936766926, 1144.2284546477151, -1978.445069140785, -2147.7480031513282, -4899.711239832753, 6572.689279703624, -5651.242140412019, 1601.975605983393, 880.7510670734648, 3961.781795826894, -4713.836360338428, 2320.4113738362707, 300.6990874768159, -863.2641575644344, -3724.036885120778, 5000.651548047728, -988.3339283959514, 1211.1605824190613, -1104.423435777836, 3813.7570840327458, -931.6068578619274, 3368.926215141786, -2574.1978409236476, -3938.450945259084, -178.90303545753648, -3320.319237595434, -2048.0340846134286, 5556.594030643968, -9.8108983405399, 3901.841965624579, -489.71312130031845, -996.7471267322726, -1268.5568357388483, 784.9874780068255, -2779.112208676067, 4964.647875136164, -3515.4494263977226, 881.5256046271494, -4651.154904923293, 7477.988931453655, -4015.047821571501, -878.3810531434244, -3000.7328444464974, -1146.929739080834, -926.5772634205072, 2350.009983971114, -2569.0151546899747, -102.56554907841004, -957.8163152252906, -1466.8152985627535, -2387.1384628187607, 260.7916630225425, -1865.2075685114423, 1272.113763242511, -6281.13155862623, 3429.888231724504, -1947.3462124144642, -2807.335594930624, -1500.762244877652, -1430.260716302067, 2215.0348515576206, 367.7180774226435, -2268.4455202627973, 4201.126744233176, -3232.8389106862824, 7551.461521684936, -830.0404042204974, 5514.971063837623, 1588.2792300268611, 1569.3155401295903, -2118.9897910794743, 1498.116092127053, -4512.361281786711, 4005.9672191883606, -3579.048756235777, 4751.250271867975, -1876.8297542616986, 5709.683456754588, -1940.4264851973198, 1471.4547531251947, -5473.717442233921, 2625.4160358490785, -2196.9227971877413, -55.65876606265432, -1759.8459851623375, 3168.2156075598746, -2316.410416294856, 7113.201884484213, -1545.630530002313, 6273.070108259621, 99.30959319341588, -1275.7519549773597, -261.2191882268298, 5644.365465054773, -4254.1257947735885, 6412.51423064697, -2452.5216025851028, 243.6283106376218, -2437.9288218638144, 2258.327765438503, -1683.58131674931, -826.296201557736, -5236.999942143127, 6059.627166929913, -205.28763907249902, -273.69214562440624, -1345.0017338977682, 4769.571152835195, -5253.368862922874, 631.0857569224627, -2260.8404596669848, 3968.5374566535775, -1827.0665211027751, 2630.8049231445398, -4291.335521185061, -453.98742418701534, -315.87485532700373, -226.00589978162594, -968.0727397645769, 4261.157798106821, -2096.449568336363, -2337.4798779948524, -1419.4785282314165, -3232.0272527917346, -1094.2066617907005, 2977.938064271602, -1289.706478933072, 2392.3263641283247, -6175.520863874009, 5066.209907274104, -4307.456584027163, 1700.6844437950265, -2031.9287075991988, -897.5105086640042, -1873.373002249135, -1119.2413183933493, -908.2245558364987, -1015.4740830971053, -1596.7564891627549, 3115.7452766119027, -2519.5428230428747, 5724.736376461273, -1657.6092905699259, 6040.55363671014, -2049.94739359097, 5032.236367966267, -2204.9324850774187, 7115.15300582405, -2602.9958679946867, 1952.9815623910547, -2048.6986359667094, 7039.074918463692, -2660.069334823147], "policy_predator_policy_reward": [-1026.6082304179754, -949.8769248983309, -1686.7924030195827, -778.7591071059915, -201.998422025772, 61.13729620972135, -4556.585412894382, -4251.162195941155, 387.93315575475583, 1847.6456245238758, 4014.3462443837534, -366.0830519055684, 69.12906032288204, -6123.09522904488, 1535.8528049097358, 2164.5308390646264, 224.12158293523407, -2084.170296297285, -1581.2548435742467, -401.16660572644844, 368.296274894773, -843.8527999663769, 7100.1534299351415, 4892.15827634171, -2362.887229940038, -1454.0475516358324, 6989.323539903669, 2615.1550846411265, 2409.3588012017663, -3153.9458627239733, 183.92382041708402, -451.34744208450985, 2317.8233923049934, 1975.4529228043941, 1584.1672935518075, -3472.402636824153, 2441.9979416019737, -2245.7836915130033, 211.5172994686393, -1782.31188404011, 129.92508809059535, 2214.699237151247, 5868.6069263241025, 5125.139053259462, 1807.8995936492713, 427.9229294377742, -4681.0226153884305, -3308.4417857299695, 1416.5035678573947, 2397.6528162275463, 5386.946064970836, 1801.305208831653, 1638.2161002238909, -2559.6632395154925, -1490.7177758197467, -992.0088972371115, 1571.9697172872932, -24.020439613371003, 201.1345667058481, -2822.2450280189373, 3193.0509097903596, 4603.084994693122, -2237.1561623537978, -872.0110569261469, 1401.4757179247174, -1028.7450256825805, -3698.8219107727305, 1049.154350689225, -298.73730628270863, -152.41566660308504, 7422.710302822401, 2510.28647321602, 5745.144189039354, 4463.837715209773, -3131.448802078725, -2294.2226071024575, -1195.7158529108897, -1089.151714400944, 2503.59741954433, 1186.9798563795532, 1566.0649510805608, 687.5047582788171, -1667.8438439799268, 1191.8840708645803, 4011.6214715935007, 1049.5294227683262, -3620.416156202461, 1192.0004462221511, 2772.223055634681, 2009.6616544218298, 654.0902977114818, 2131.7206598204543, -1297.2159250566729, 1516.2210957755335, 135.8510783455857, 1262.7257201646405, 576.0622303091784, 3387.8189435620407, 2201.5888921448777, -597.1729866559751, 3962.38624530668, 2026.03584333841, -1081.9271345476216, 92.44888730111923, 3734.2992809979614, 1054.2421511505618, 510.34621019452277, -1193.1090233313723, 148.82354991831957, 3800.562649446895, -447.1251113485055, 345.54074723233504, -557.5902612719809, -5004.943539687459, -6470.1725508640775, -418.785669181081, 1504.2708357220417, -821.9752447633315, 3002.784387047633, 158.0038585839723, 281.19325138205465, 1087.2273754974751, 0.0, -2874.420517606275, 805.1467468503002, -4574.403718407568, 3643.455777551916, 833.717662031302, 1322.9019824889908, -1355.3619950101074, 1805.0061386247487, 2263.8832647543013, -1397.7563105218383, 1321.4664064549422, -4520.730605584022, -707.1702459662196, -760.6999324832001, -4984.5951310130795, 1590.5349471424295, -53.56380393823881, -881.8405852176495, 223.3180049504537, 701.5708806098751, -4414.764758921813, 804.3140443375299, 1389.9864668886617, -1143.6847487779287, 1538.8597344622408, 3698.430065132338, 3598.2411904312517, 147.35109784564682, -4418.495113529964, 1671.229867298968, 66.55929912581459, -373.30200995952544, 1135.1417703196928, 1731.1432715276576, 252.9093330972737, 337.60511410743936, -1500.997685762075, 3612.413594585173, -1951.8829965446594, 586.9011471323136, 182.96113238170545, 478.4581460987908, 1416.1524257881367, 1178.5319477541238, -2040.8492369808112, 923.8711574746022, 3461.5709158799427, 3020.8711184439107, 2434.7470565890817, -1522.6923988796243, 1757.405383984063, 4256.489347403971, -42.056657006478126, 1132.3098259343246, -885.5133144283695, 171.2303172803438, 160.01394652382686, 1983.0450402576012, 1124.5283804209212, 1532.381438976692, 2351.4142840280647, 958.4014964735053, 2556.9979266748956, -962.3851522264331, 366.18269865740785, -3751.099544360366, -200.30329007587125, 1683.6388171263284, -4194.317052333077, 931.3240557655542, -2644.985855169222, -52.3008923989617, -4207.691007055373, 235.32921298537144, -139.61213940971714, 645.5329186993883, -5024.538502339927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6727655722205367, "mean_inference_ms": 1.4635535534807846, "mean_action_processing_ms": 0.29287953395545313, "mean_env_wait_ms": 0.12830008095600498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004576921463012695, "StateBufferConnector_ms": 0.0034030675888061523, "ViewRequirementAgentConnector_ms": 0.11223101615905762}, "num_episodes": 27, "episode_return_max": 5815.642795321801, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 887.6876675982738, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.46411090693647, "num_env_steps_trained_throughput_per_sec": 276.46411090693647, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 14527.53, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14527.48, "sample_time_ms": 1181.572, "learn_time_ms": 13327.173, "learn_throughput": 300.139, "synch_weights_time_ms": 17.331}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "6751e_00000", "date": "2024-08-11_19-15-00", "timestamp": 1723418100, "time_this_iter_s": 14.529505968093872, "time_total_s": 467.9973213672638, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 467.9973213672638, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 52.455000000000005, "ram_util_percent": 83.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6866461346467967, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.975341424487887, "policy_loss": -0.003631494887587097, "vf_loss": 9.978709567034686, "vf_explained_var": 0.01588697625846459, "kl": 0.0052670094275575055, "entropy": 1.0193727381961055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7668282206096346, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.661679265360354, "policy_loss": -0.01109676707927729, "vf_loss": 9.670428737761481, "vf_explained_var": 0.0002412501466337335, "kl": 0.011736331319657956, "entropy": 1.082490488429549, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 5815.642795321801, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 878.9034277863294, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6281.13155862623, "predator_policy": -6470.1725508640775}, "policy_reward_max": {"prey_policy": 7551.461521684936, "predator_policy": 7422.710302822401}, "policy_reward_mean": {"prey_policy": -36.53826241888799, "predator_policy": 475.98997631205276}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 374.36420475028217, 246.4209821450596, 5050.133097921453, 1381.9342988058959, 0.0, 2979.939769591866, 140.79203081841752, 0.0, 0.0, 795.8947131623855, 0.0, 3208.8348617982756, 903.1504003718329, 479.46783888336313, 232.48266608731439, 343.57540133234386, 5815.642795321801, 4840.628582040261, 121.11172312224731, 1127.2612770124251, 1425.2733134527598, 259.4449786901367, 973.2386756230928, 1291.5215940656826, 1034.5253999018419, 902.7708124665916, 712.3039550305973, 0.0, 338.194934206526, 109.92741248970673, 0.0, 979.4042932613702, 493.0637720635344, 480.44359234024773, 102.01132211870501, 2048.6587565250593, 866.7034694307279, 1158.887316504995, 214.29207381932662, 132.62134000883037, 146.543055971946, 1795.339089832112, 0.0, -2.842170943040401e-14, 474.91075047449294, 396.0332261402216, 2253.384652154061, 775.5152871981194, 339.6705029316563, 627.0846379567558, 7.105427357601002e-15, 731.7170900139871, 246.79874974993118, 1.4210854715202004e-14, 969.9214343735064, 1233.3751118627224, 1583.1955121731019, 119.09528690260821, 278.0420502724979, 354.297901880411, 978.0783638961707, -1.4210854715202004e-14, 0.0, 700.5319323407246, 1302.390940543771, 628.4836671282754, 1129.3842604505576, 1922.9445704429722, 431.2381906518078, 1005.5498347528935, 0.0, 336.68990976538197, 1856.3298487749105, 903.168850888542, -1.7763568394002505e-14, 115.72425145510829, 1479.928007912415, 1113.6420834851876, 252.16523837502643, 0.0, -2.842170943040401e-14, 365.2464793535393, 2310.4267889816933, 938.3517045175307, 565.7174219615459, 732.7063359200504, 3548.0262330840956, 1.4210854715202004e-14, 1.4210854715202004e-14, 1449.2721624847206, 1846.3109980824827, 559.7454407863356, 1013.4656531944881, 497.1266071160482, 1121.0306381630237, 2559.8169756159677, 1346.4988595711895, 0.0, 990.5045338834069], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5300.329071441215, -5496.54332153018, 3117.7002105405527, -1172.5414212187982, 742.7345001693475, -2840.9378432661288, -3971.64305956394, -1971.9698220981766, 2754.3845206480805, -3608.2727449292247, 6676.679007441709, 1312.7853936766926, 1144.2284546477151, -1978.445069140785, -2147.7480031513282, -4899.711239832753, 6572.689279703624, -5651.242140412019, 1601.975605983393, 880.7510670734648, 3961.781795826894, -4713.836360338428, 2320.4113738362707, 300.6990874768159, -863.2641575644344, -3724.036885120778, 5000.651548047728, -988.3339283959514, 1211.1605824190613, -1104.423435777836, 3813.7570840327458, -931.6068578619274, 3368.926215141786, -2574.1978409236476, -3938.450945259084, -178.90303545753648, -3320.319237595434, -2048.0340846134286, 5556.594030643968, -9.8108983405399, 3901.841965624579, -489.71312130031845, -996.7471267322726, -1268.5568357388483, 784.9874780068255, -2779.112208676067, 4964.647875136164, -3515.4494263977226, 881.5256046271494, -4651.154904923293, 7477.988931453655, -4015.047821571501, -878.3810531434244, -3000.7328444464974, -1146.929739080834, -926.5772634205072, 2350.009983971114, -2569.0151546899747, -102.56554907841004, -957.8163152252906, -1466.8152985627535, -2387.1384628187607, 260.7916630225425, -1865.2075685114423, 1272.113763242511, -6281.13155862623, 3429.888231724504, -1947.3462124144642, -2807.335594930624, -1500.762244877652, -1430.260716302067, 2215.0348515576206, 367.7180774226435, -2268.4455202627973, 4201.126744233176, -3232.8389106862824, 7551.461521684936, -830.0404042204974, 5514.971063837623, 1588.2792300268611, 1569.3155401295903, -2118.9897910794743, 1498.116092127053, -4512.361281786711, 4005.9672191883606, -3579.048756235777, 4751.250271867975, -1876.8297542616986, 5709.683456754588, -1940.4264851973198, 1471.4547531251947, -5473.717442233921, 2625.4160358490785, -2196.9227971877413, -55.65876606265432, -1759.8459851623375, 3168.2156075598746, -2316.410416294856, 7113.201884484213, -1545.630530002313, 6273.070108259621, 99.30959319341588, -1275.7519549773597, -261.2191882268298, 5644.365465054773, -4254.1257947735885, 6412.51423064697, -2452.5216025851028, 243.6283106376218, -2437.9288218638144, 2258.327765438503, -1683.58131674931, -826.296201557736, -5236.999942143127, 6059.627166929913, -205.28763907249902, -273.69214562440624, -1345.0017338977682, 4769.571152835195, -5253.368862922874, 631.0857569224627, -2260.8404596669848, 3968.5374566535775, -1827.0665211027751, 2630.8049231445398, -4291.335521185061, -453.98742418701534, -315.87485532700373, -226.00589978162594, -968.0727397645769, 4261.157798106821, -2096.449568336363, -2337.4798779948524, -1419.4785282314165, -3232.0272527917346, -1094.2066617907005, 2977.938064271602, -1289.706478933072, 2392.3263641283247, -6175.520863874009, 5066.209907274104, -4307.456584027163, 1700.6844437950265, -2031.9287075991988, -897.5105086640042, -1873.373002249135, -1119.2413183933493, -908.2245558364987, -1015.4740830971053, -1596.7564891627549, 3115.7452766119027, -2519.5428230428747, 5724.736376461273, -1657.6092905699259, 6040.55363671014, -2049.94739359097, 5032.236367966267, -2204.9324850774187, 7115.15300582405, -2602.9958679946867, 1952.9815623910547, -2048.6986359667094, 7039.074918463692, -2660.069334823147, 5940.868408843329, -2134.9069450795546, 3345.891214673825, -369.3910804133949, 3140.113315790494, -3878.4529226542695, 5724.190082306136, -3578.5795352489586, 4528.810425469305, -2735.9986470957992, -2340.511594933517, -4839.146685892557, 6765.211687765867, -1632.9174990777835, 5184.193359472169, -2648.104144244756, 307.73495090872564, -162.69916957191316, 3851.727596941922, -2849.2585275119995, 2870.6617949896945, -2957.1605565058926, -1215.3857920298287, -999.4227734581675, -3557.0108892907156, -2927.945711115742, -4279.466941506474, -3111.837967530186, -608.4662798129627, -4909.284576829804, 4530.444421740548, -1056.9130864959704, 2138.014712701547, -3121.547505086224, 1723.7694487103827, -5354.936267842587], "policy_predator_policy_reward": [2441.9979416019737, -2245.7836915130033, 211.5172994686393, -1782.31188404011, 129.92508809059535, 2214.699237151247, 5868.6069263241025, 5125.139053259462, 1807.8995936492713, 427.9229294377742, -4681.0226153884305, -3308.4417857299695, 1416.5035678573947, 2397.6528162275463, 5386.946064970836, 1801.305208831653, 1638.2161002238909, -2559.6632395154925, -1490.7177758197467, -992.0088972371115, 1571.9697172872932, -24.020439613371003, 201.1345667058481, -2822.2450280189373, 3193.0509097903596, 4603.084994693122, -2237.1561623537978, -872.0110569261469, 1401.4757179247174, -1028.7450256825805, -3698.8219107727305, 1049.154350689225, -298.73730628270863, -152.41566660308504, 7422.710302822401, 2510.28647321602, 5745.144189039354, 4463.837715209773, -3131.448802078725, -2294.2226071024575, -1195.7158529108897, -1089.151714400944, 2503.59741954433, 1186.9798563795532, 1566.0649510805608, 687.5047582788171, -1667.8438439799268, 1191.8840708645803, 4011.6214715935007, 1049.5294227683262, -3620.416156202461, 1192.0004462221511, 2772.223055634681, 2009.6616544218298, 654.0902977114818, 2131.7206598204543, -1297.2159250566729, 1516.2210957755335, 135.8510783455857, 1262.7257201646405, 576.0622303091784, 3387.8189435620407, 2201.5888921448777, -597.1729866559751, 3962.38624530668, 2026.03584333841, -1081.9271345476216, 92.44888730111923, 3734.2992809979614, 1054.2421511505618, 510.34621019452277, -1193.1090233313723, 148.82354991831957, 3800.562649446895, -447.1251113485055, 345.54074723233504, -557.5902612719809, -5004.943539687459, -6470.1725508640775, -418.785669181081, 1504.2708357220417, -821.9752447633315, 3002.784387047633, 158.0038585839723, 281.19325138205465, 1087.2273754974751, 0.0, -2874.420517606275, 805.1467468503002, -4574.403718407568, 3643.455777551916, 833.717662031302, 1322.9019824889908, -1355.3619950101074, 1805.0061386247487, 2263.8832647543013, -1397.7563105218383, 1321.4664064549422, -4520.730605584022, -707.1702459662196, -760.6999324832001, -4984.5951310130795, 1590.5349471424295, -53.56380393823881, -881.8405852176495, 223.3180049504537, 701.5708806098751, -4414.764758921813, 804.3140443375299, 1389.9864668886617, -1143.6847487779287, 1538.8597344622408, 3698.430065132338, 3598.2411904312517, 147.35109784564682, -4418.495113529964, 1671.229867298968, 66.55929912581459, -373.30200995952544, 1135.1417703196928, 1731.1432715276576, 252.9093330972737, 337.60511410743936, -1500.997685762075, 3612.413594585173, -1951.8829965446594, 586.9011471323136, 182.96113238170545, 478.4581460987908, 1416.1524257881367, 1178.5319477541238, -2040.8492369808112, 923.8711574746022, 3461.5709158799427, 3020.8711184439107, 2434.7470565890817, -1522.6923988796243, 1757.405383984063, 4256.489347403971, -42.056657006478126, 1132.3098259343246, -885.5133144283695, 171.2303172803438, 160.01394652382686, 1983.0450402576012, 1124.5283804209212, 1532.381438976692, 2351.4142840280647, 958.4014964735053, 2556.9979266748956, -962.3851522264331, 366.18269865740785, -3751.099544360366, -200.30329007587125, 1683.6388171263284, -4194.317052333077, 931.3240557655542, -2644.985855169222, -52.3008923989617, -4207.691007055373, 235.32921298537144, -139.61213940971714, 645.5329186993883, -5024.538502339927, -1616.9529993526205, -1823.7619850576139, -1436.2759004558998, 770.2025551771636, 3052.941922351908, -1376.2506109706003, -1316.0291302735359, -263.8639948220977, -554.3394017483864, -505.76604070506625, 6611.66551990212, 4116.0189940080445, -3699.2860226305575, -1433.0081660575238, -849.6802581584219, -1686.4089570689907, -88.66209330544757, 1392.8984744533557, 1044.167291508294, -200.3253628557315, -755.0012686361279, 1401.2454709386604, 1409.0718567149493, 1819.2023619675354, 936.7064713365824, 6045.376736185926, 5616.41399166209, 2895.92155553759, 5167.5712208643545, 2909.996611394381, -2866.3633656380757, 739.3308899646881, -707.6180711027149, 1691.1508634873944, -279.26201675122775, 4900.933369766838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6737872499072385, "mean_inference_ms": 1.466189545497679, "mean_action_processing_ms": 0.2956704808153349, "mean_env_wait_ms": 0.12825566305482702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004367232322692871, "StateBufferConnector_ms": 0.003416776657104492, "ViewRequirementAgentConnector_ms": 0.11727392673492432}, "num_episodes": 18, "episode_return_max": 5815.642795321801, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 878.9034277863294, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.6428687045981, "num_env_steps_trained_throughput_per_sec": 275.6428687045981, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 14505.704, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14505.655, "sample_time_ms": 1200.299, "learn_time_ms": 13287.295, "learn_throughput": 301.039, "synch_weights_time_ms": 16.726}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "6751e_00000", "date": "2024-08-11_19-15-14", "timestamp": 1723418114, "time_this_iter_s": 14.53816819190979, "time_total_s": 482.5354895591736, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 482.5354895591736, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.314285714285724, "ram_util_percent": 83.2809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6590010198966536, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.963087157597618, "policy_loss": -0.008618191449173663, "vf_loss": 9.97101321750217, "vf_explained_var": 0.003218375532715409, "kl": 0.013842687139716314, "entropy": 0.9889152255323198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8025680219843274, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.1635275078829, "policy_loss": -0.006959573257586392, "vf_loss": 9.169082240957431, "vf_explained_var": 0.00030046622589151696, "kl": 0.0070241606987545635, "entropy": 1.032163886670713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 4840.628582040261, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 773.2965999019566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6281.13155862623, "predator_policy": -6470.1725508640775}, "policy_reward_max": {"prey_policy": 7551.461521684936, "predator_policy": 6810.631071318922}, "policy_reward_mean": {"prey_policy": -134.71322186415057, "predator_policy": 521.3615218151285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4840.628582040261, 121.11172312224731, 1127.2612770124251, 1425.2733134527598, 259.4449786901367, 973.2386756230928, 1291.5215940656826, 1034.5253999018419, 902.7708124665916, 712.3039550305973, 0.0, 338.194934206526, 109.92741248970673, 0.0, 979.4042932613702, 493.0637720635344, 480.44359234024773, 102.01132211870501, 2048.6587565250593, 866.7034694307279, 1158.887316504995, 214.29207381932662, 132.62134000883037, 146.543055971946, 1795.339089832112, 0.0, -2.842170943040401e-14, 474.91075047449294, 396.0332261402216, 2253.384652154061, 775.5152871981194, 339.6705029316563, 627.0846379567558, 7.105427357601002e-15, 731.7170900139871, 246.79874974993118, 1.4210854715202004e-14, 969.9214343735064, 1233.3751118627224, 1583.1955121731019, 119.09528690260821, 278.0420502724979, 354.297901880411, 978.0783638961707, -1.4210854715202004e-14, 0.0, 700.5319323407246, 1302.390940543771, 628.4836671282754, 1129.3842604505576, 1922.9445704429722, 431.2381906518078, 1005.5498347528935, 0.0, 336.68990976538197, 1856.3298487749105, 903.168850888542, -1.7763568394002505e-14, 115.72425145510829, 1479.928007912415, 1113.6420834851876, 252.16523837502643, 0.0, -2.842170943040401e-14, 365.2464793535393, 2310.4267889816933, 938.3517045175307, 565.7174219615459, 732.7063359200504, 3548.0262330840956, 1.4210854715202004e-14, 1.4210854715202004e-14, 1449.2721624847206, 1846.3109980824827, 559.7454407863356, 1013.4656531944881, 497.1266071160482, 1121.0306381630237, 2559.8169756159677, 1346.4988595711895, 0.0, 990.5045338834069, 1198.510236973463, 879.1518489301625, 683.1896913486069, 1.4210854715202004e-14, 123.69770384967234, 0.0, 122.81987680012058, 396.8488944240013, 2875.8933424089732, 130.43915247179052, 0.0, 0.0, 1639.7442327661618, 428.9849059487157, -3.552713678800501e-15, 1500.5453665103926, 154.3416979117375, 1257.7833222092058], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3320.319237595434, -2048.0340846134286, 5556.594030643968, -9.8108983405399, 3901.841965624579, -489.71312130031845, -996.7471267322726, -1268.5568357388483, 784.9874780068255, -2779.112208676067, 4964.647875136164, -3515.4494263977226, 881.5256046271494, -4651.154904923293, 7477.988931453655, -4015.047821571501, -878.3810531434244, -3000.7328444464974, -1146.929739080834, -926.5772634205072, 2350.009983971114, -2569.0151546899747, -102.56554907841004, -957.8163152252906, -1466.8152985627535, -2387.1384628187607, 260.7916630225425, -1865.2075685114423, 1272.113763242511, -6281.13155862623, 3429.888231724504, -1947.3462124144642, -2807.335594930624, -1500.762244877652, -1430.260716302067, 2215.0348515576206, 367.7180774226435, -2268.4455202627973, 4201.126744233176, -3232.8389106862824, 7551.461521684936, -830.0404042204974, 5514.971063837623, 1588.2792300268611, 1569.3155401295903, -2118.9897910794743, 1498.116092127053, -4512.361281786711, 4005.9672191883606, -3579.048756235777, 4751.250271867975, -1876.8297542616986, 5709.683456754588, -1940.4264851973198, 1471.4547531251947, -5473.717442233921, 2625.4160358490785, -2196.9227971877413, -55.65876606265432, -1759.8459851623375, 3168.2156075598746, -2316.410416294856, 7113.201884484213, -1545.630530002313, 6273.070108259621, 99.30959319341588, -1275.7519549773597, -261.2191882268298, 5644.365465054773, -4254.1257947735885, 6412.51423064697, -2452.5216025851028, 243.6283106376218, -2437.9288218638144, 2258.327765438503, -1683.58131674931, -826.296201557736, -5236.999942143127, 6059.627166929913, -205.28763907249902, -273.69214562440624, -1345.0017338977682, 4769.571152835195, -5253.368862922874, 631.0857569224627, -2260.8404596669848, 3968.5374566535775, -1827.0665211027751, 2630.8049231445398, -4291.335521185061, -453.98742418701534, -315.87485532700373, -226.00589978162594, -968.0727397645769, 4261.157798106821, -2096.449568336363, -2337.4798779948524, -1419.4785282314165, -3232.0272527917346, -1094.2066617907005, 2977.938064271602, -1289.706478933072, 2392.3263641283247, -6175.520863874009, 5066.209907274104, -4307.456584027163, 1700.6844437950265, -2031.9287075991988, -897.5105086640042, -1873.373002249135, -1119.2413183933493, -908.2245558364987, -1015.4740830971053, -1596.7564891627549, 3115.7452766119027, -2519.5428230428747, 5724.736376461273, -1657.6092905699259, 6040.55363671014, -2049.94739359097, 5032.236367966267, -2204.9324850774187, 7115.15300582405, -2602.9958679946867, 1952.9815623910547, -2048.6986359667094, 7039.074918463692, -2660.069334823147, 5940.868408843329, -2134.9069450795546, 3345.891214673825, -369.3910804133949, 3140.113315790494, -3878.4529226542695, 5724.190082306136, -3578.5795352489586, 4528.810425469305, -2735.9986470957992, -2340.511594933517, -4839.146685892557, 6765.211687765867, -1632.9174990777835, 5184.193359472169, -2648.104144244756, 307.73495090872564, -162.69916957191316, 3851.727596941922, -2849.2585275119995, 2870.6617949896945, -2957.1605565058926, -1215.3857920298287, -999.4227734581675, -3557.0108892907156, -2927.945711115742, -4279.466941506474, -3111.837967530186, -608.4662798129627, -4909.284576829804, 4530.444421740548, -1056.9130864959704, 2138.014712701547, -3121.547505086224, 1723.7694487103827, -5354.936267842587, 1494.9456347847417, -2282.1316087072996, 4871.768528425018, -5502.080510643541, -3068.297650342696, -5141.130888071196, 2569.679685946998, -1199.8385445355875, 5233.526262696786, -4155.728822742805, 6720.951966519764, -1560.7848095357604, -51.586574255118386, -1819.843368792376, 4785.00496458844, -4883.440671685563, -3717.001057923986, -2396.1420819294513, 6219.169374207174, -1266.096828480049, 5987.255354965058, -2302.2416835525805, -535.3800221475859, -4103.143965820845, -2905.8365161008214, -2199.5805847331053, -48.07537726100977, -30.243961222128085, -35.415406261326524, 4.312916954320404, -1328.3829241743802, -5073.27291390564, 3162.073486193064, -4164.958768415051, -1861.2706510045298, -1726.2371858252598], "policy_predator_policy_reward": [5745.144189039354, 4463.837715209773, -3131.448802078725, -2294.2226071024575, -1195.7158529108897, -1089.151714400944, 2503.59741954433, 1186.9798563795532, 1566.0649510805608, 687.5047582788171, -1667.8438439799268, 1191.8840708645803, 4011.6214715935007, 1049.5294227683262, -3620.416156202461, 1192.0004462221511, 2772.223055634681, 2009.6616544218298, 654.0902977114818, 2131.7206598204543, -1297.2159250566729, 1516.2210957755335, 135.8510783455857, 1262.7257201646405, 576.0622303091784, 3387.8189435620407, 2201.5888921448777, -597.1729866559751, 3962.38624530668, 2026.03584333841, -1081.9271345476216, 92.44888730111923, 3734.2992809979614, 1054.2421511505618, 510.34621019452277, -1193.1090233313723, 148.82354991831957, 3800.562649446895, -447.1251113485055, 345.54074723233504, -557.5902612719809, -5004.943539687459, -6470.1725508640775, -418.785669181081, 1504.2708357220417, -821.9752447633315, 3002.784387047633, 158.0038585839723, 281.19325138205465, 1087.2273754974751, 0.0, -2874.420517606275, 805.1467468503002, -4574.403718407568, 3643.455777551916, 833.717662031302, 1322.9019824889908, -1355.3619950101074, 1805.0061386247487, 2263.8832647543013, -1397.7563105218383, 1321.4664064549422, -4520.730605584022, -707.1702459662196, -760.6999324832001, -4984.5951310130795, 1590.5349471424295, -53.56380393823881, -881.8405852176495, 223.3180049504537, 701.5708806098751, -4414.764758921813, 804.3140443375299, 1389.9864668886617, -1143.6847487779287, 1538.8597344622408, 3698.430065132338, 3598.2411904312517, 147.35109784564682, -4418.495113529964, 1671.229867298968, 66.55929912581459, -373.30200995952544, 1135.1417703196928, 1731.1432715276576, 252.9093330972737, 337.60511410743936, -1500.997685762075, 3612.413594585173, -1951.8829965446594, 586.9011471323136, 182.96113238170545, 478.4581460987908, 1416.1524257881367, 1178.5319477541238, -2040.8492369808112, 923.8711574746022, 3461.5709158799427, 3020.8711184439107, 2434.7470565890817, -1522.6923988796243, 1757.405383984063, 4256.489347403971, -42.056657006478126, 1132.3098259343246, -885.5133144283695, 171.2303172803438, 160.01394652382686, 1983.0450402576012, 1124.5283804209212, 1532.381438976692, 2351.4142840280647, 958.4014964735053, 2556.9979266748956, -962.3851522264331, 366.18269865740785, -3751.099544360366, -200.30329007587125, 1683.6388171263284, -4194.317052333077, 931.3240557655542, -2644.985855169222, -52.3008923989617, -4207.691007055373, 235.32921298537144, -139.61213940971714, 645.5329186993883, -5024.538502339927, -1616.9529993526205, -1823.7619850576139, -1436.2759004558998, 770.2025551771636, 3052.941922351908, -1376.2506109706003, -1316.0291302735359, -263.8639948220977, -554.3394017483864, -505.76604070506625, 6611.66551990212, 4116.0189940080445, -3699.2860226305575, -1433.0081660575238, -849.6802581584219, -1686.4089570689907, -88.66209330544757, 1392.8984744533557, 1044.167291508294, -200.3253628557315, -755.0012686361279, 1401.2454709386604, 1409.0718567149493, 1819.2023619675354, 936.7064713365824, 6045.376736185926, 5616.41399166209, 2895.92155553759, 5167.5712208643545, 2909.996611394381, -2866.3633656380757, 739.3308899646881, -707.6180711027149, 1691.1508634873944, -279.26201675122775, 4900.933369766838, 2011.0154285224592, -25.319217626433982, 2397.5762627831587, -888.1124316344702, 5873.225773834793, 3019.392455927707, -1848.390541341357, 478.54939992994355, -739.4937014029872, -214.60603470131844, -4660.929767816832, -499.23738916717315, 1976.1502387425278, 18.099581105086806, -937.757482984506, 1433.0420845056299, 6810.631071318922, 2178.4054109434805, -4263.255022259596, -559.3783709957388, -4111.870204792903, 426.85653338042505, 2539.2008035026056, 2099.3231844658253, 1845.6791086817323, 4899.482224918355, 1377.7599816699517, -870.4557372380972, 130.3198539800365, -99.21736467302969, 2375.696541074277, 5526.504663516122, -109.92239071035185, 1267.1493708440712, 2578.048835127477, 2267.2423239115215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6749823297331977, "mean_inference_ms": 1.4661807163194753, "mean_action_processing_ms": 0.29525372949996737, "mean_env_wait_ms": 0.12839745076994882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004349946975708008, "StateBufferConnector_ms": 0.003386378288269043, "ViewRequirementAgentConnector_ms": 0.11485481262207031}, "num_episodes": 18, "episode_return_max": 4840.628582040261, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 773.2965999019566, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.4048854989396, "num_env_steps_trained_throughput_per_sec": 278.4048854989396, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 14473.174, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14473.125, "sample_time_ms": 1245.148, "learn_time_ms": 13210.179, "learn_throughput": 302.797, "synch_weights_time_ms": 16.557}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "6751e_00000", "date": "2024-08-11_19-15-29", "timestamp": 1723418129, "time_this_iter_s": 14.420421123504639, "time_total_s": 496.9559106826782, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 496.9559106826782, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 51.725, "ram_util_percent": 82.895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8020040289277122, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.9321079128003, "policy_loss": -0.0074482885918644055, "vf_loss": 9.938976329218143, "vf_explained_var": -0.0011328098950562655, "kl": 0.011596915608297136, "entropy": 0.9956415008300196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8539218374818721, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.131304673290757, "policy_loss": -0.006052189882753525, "vf_loss": 9.136261269907472, "vf_explained_var": 0.00022843287735389023, "kl": 0.0054779463019906235, "entropy": 1.0382552467326007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 3548.0262330840956, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 748.1129073564615, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6175.520863874009, "predator_policy": -6470.1725508640775}, "policy_reward_max": {"prey_policy": 7551.461521684936, "predator_policy": 7086.476854371672}, "policy_reward_mean": {"prey_policy": -145.5590016209102, "predator_policy": 519.615455299141}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2048.6587565250593, 866.7034694307279, 1158.887316504995, 214.29207381932662, 132.62134000883037, 146.543055971946, 1795.339089832112, 0.0, -2.842170943040401e-14, 474.91075047449294, 396.0332261402216, 2253.384652154061, 775.5152871981194, 339.6705029316563, 627.0846379567558, 7.105427357601002e-15, 731.7170900139871, 246.79874974993118, 1.4210854715202004e-14, 969.9214343735064, 1233.3751118627224, 1583.1955121731019, 119.09528690260821, 278.0420502724979, 354.297901880411, 978.0783638961707, -1.4210854715202004e-14, 0.0, 700.5319323407246, 1302.390940543771, 628.4836671282754, 1129.3842604505576, 1922.9445704429722, 431.2381906518078, 1005.5498347528935, 0.0, 336.68990976538197, 1856.3298487749105, 903.168850888542, -1.7763568394002505e-14, 115.72425145510829, 1479.928007912415, 1113.6420834851876, 252.16523837502643, 0.0, -2.842170943040401e-14, 365.2464793535393, 2310.4267889816933, 938.3517045175307, 565.7174219615459, 732.7063359200504, 3548.0262330840956, 1.4210854715202004e-14, 1.4210854715202004e-14, 1449.2721624847206, 1846.3109980824827, 559.7454407863356, 1013.4656531944881, 497.1266071160482, 1121.0306381630237, 2559.8169756159677, 1346.4988595711895, 0.0, 990.5045338834069, 1198.510236973463, 879.1518489301625, 683.1896913486069, 1.4210854715202004e-14, 123.69770384967234, 0.0, 122.81987680012058, 396.8488944240013, 2875.8933424089732, 130.43915247179052, 0.0, 0.0, 1639.7442327661618, 428.9849059487157, -3.552713678800501e-15, 1500.5453665103926, 154.3416979117375, 1257.7833222092058, 660.0588350883394, 346.16272227210715, 0.0, 411.12448598489016, 597.8505112336708, 426.4793446046568, 242.68971530324984, 273.1948369949663, 625.9323365928636, 0.0, 392.7344268456552, 494.2801641474144, 2583.461590972981, 1873.400173150995, 131.3015712697291, 1559.4250930373514, 558.6539447182882, 1496.0066311190665], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [367.7180774226435, -2268.4455202627973, 4201.126744233176, -3232.8389106862824, 7551.461521684936, -830.0404042204974, 5514.971063837623, 1588.2792300268611, 1569.3155401295903, -2118.9897910794743, 1498.116092127053, -4512.361281786711, 4005.9672191883606, -3579.048756235777, 4751.250271867975, -1876.8297542616986, 5709.683456754588, -1940.4264851973198, 1471.4547531251947, -5473.717442233921, 2625.4160358490785, -2196.9227971877413, -55.65876606265432, -1759.8459851623375, 3168.2156075598746, -2316.410416294856, 7113.201884484213, -1545.630530002313, 6273.070108259621, 99.30959319341588, -1275.7519549773597, -261.2191882268298, 5644.365465054773, -4254.1257947735885, 6412.51423064697, -2452.5216025851028, 243.6283106376218, -2437.9288218638144, 2258.327765438503, -1683.58131674931, -826.296201557736, -5236.999942143127, 6059.627166929913, -205.28763907249902, -273.69214562440624, -1345.0017338977682, 4769.571152835195, -5253.368862922874, 631.0857569224627, -2260.8404596669848, 3968.5374566535775, -1827.0665211027751, 2630.8049231445398, -4291.335521185061, -453.98742418701534, -315.87485532700373, -226.00589978162594, -968.0727397645769, 4261.157798106821, -2096.449568336363, -2337.4798779948524, -1419.4785282314165, -3232.0272527917346, -1094.2066617907005, 2977.938064271602, -1289.706478933072, 2392.3263641283247, -6175.520863874009, 5066.209907274104, -4307.456584027163, 1700.6844437950265, -2031.9287075991988, -897.5105086640042, -1873.373002249135, -1119.2413183933493, -908.2245558364987, -1015.4740830971053, -1596.7564891627549, 3115.7452766119027, -2519.5428230428747, 5724.736376461273, -1657.6092905699259, 6040.55363671014, -2049.94739359097, 5032.236367966267, -2204.9324850774187, 7115.15300582405, -2602.9958679946867, 1952.9815623910547, -2048.6986359667094, 7039.074918463692, -2660.069334823147, 5940.868408843329, -2134.9069450795546, 3345.891214673825, -369.3910804133949, 3140.113315790494, -3878.4529226542695, 5724.190082306136, -3578.5795352489586, 4528.810425469305, -2735.9986470957992, -2340.511594933517, -4839.146685892557, 6765.211687765867, -1632.9174990777835, 5184.193359472169, -2648.104144244756, 307.73495090872564, -162.69916957191316, 3851.727596941922, -2849.2585275119995, 2870.6617949896945, -2957.1605565058926, -1215.3857920298287, -999.4227734581675, -3557.0108892907156, -2927.945711115742, -4279.466941506474, -3111.837967530186, -608.4662798129627, -4909.284576829804, 4530.444421740548, -1056.9130864959704, 2138.014712701547, -3121.547505086224, 1723.7694487103827, -5354.936267842587, 1494.9456347847417, -2282.1316087072996, 4871.768528425018, -5502.080510643541, -3068.297650342696, -5141.130888071196, 2569.679685946998, -1199.8385445355875, 5233.526262696786, -4155.728822742805, 6720.951966519764, -1560.7848095357604, -51.586574255118386, -1819.843368792376, 4785.00496458844, -4883.440671685563, -3717.001057923986, -2396.1420819294513, 6219.169374207174, -1266.096828480049, 5987.255354965058, -2302.2416835525805, -535.3800221475859, -4103.143965820845, -2905.8365161008214, -2199.5805847331053, -48.07537726100977, -30.243961222128085, -35.415406261326524, 4.312916954320404, -1328.3829241743802, -5073.27291390564, 3162.073486193064, -4164.958768415051, -1861.2706510045298, -1726.2371858252598, 395.77240762291626, 783.9805850567274, 901.8517444938248, -1263.1722544652494, 3751.216879598795, -4947.76850536592, 4508.591959870187, -3028.000601700547, 5917.700301570455, -5360.420021651684, 1631.1349861871927, 1107.5137127349678, 1198.544536717267, -1026.1083072440374, -1741.2965074231302, -5967.853543660257, 600.4829834181619, -2622.7934629594865, -2208.0790532829033, -2683.6219922250857, -1253.9195612324656, -2796.905291282794, 5883.67476647884, -679.6310231257867, 3489.2191331526938, -2464.9135652569735, -443.4128395779119, -3590.8117043428165, -3130.8501889258096, -2851.7862340818774, 6347.358302742502, -2819.807572020765, 128.9265190133675, -76.92676319909643, -2749.9472103359453, -4373.635429657053], "policy_predator_policy_reward": [148.82354991831957, 3800.562649446895, -447.1251113485055, 345.54074723233504, -557.5902612719809, -5004.943539687459, -6470.1725508640775, -418.785669181081, 1504.2708357220417, -821.9752447633315, 3002.784387047633, 158.0038585839723, 281.19325138205465, 1087.2273754974751, 0.0, -2874.420517606275, 805.1467468503002, -4574.403718407568, 3643.455777551916, 833.717662031302, 1322.9019824889908, -1355.3619950101074, 1805.0061386247487, 2263.8832647543013, -1397.7563105218383, 1321.4664064549422, -4520.730605584022, -707.1702459662196, -760.6999324832001, -4984.5951310130795, 1590.5349471424295, -53.56380393823881, -881.8405852176495, 223.3180049504537, 701.5708806098751, -4414.764758921813, 804.3140443375299, 1389.9864668886617, -1143.6847487779287, 1538.8597344622408, 3698.430065132338, 3598.2411904312517, 147.35109784564682, -4418.495113529964, 1671.229867298968, 66.55929912581459, -373.30200995952544, 1135.1417703196928, 1731.1432715276576, 252.9093330972737, 337.60511410743936, -1500.997685762075, 3612.413594585173, -1951.8829965446594, 586.9011471323136, 182.96113238170545, 478.4581460987908, 1416.1524257881367, 1178.5319477541238, -2040.8492369808112, 923.8711574746022, 3461.5709158799427, 3020.8711184439107, 2434.7470565890817, -1522.6923988796243, 1757.405383984063, 4256.489347403971, -42.056657006478126, 1132.3098259343246, -885.5133144283695, 171.2303172803438, 160.01394652382686, 1983.0450402576012, 1124.5283804209212, 1532.381438976692, 2351.4142840280647, 958.4014964735053, 2556.9979266748956, -962.3851522264331, 366.18269865740785, -3751.099544360366, -200.30329007587125, 1683.6388171263284, -4194.317052333077, 931.3240557655542, -2644.985855169222, -52.3008923989617, -4207.691007055373, 235.32921298537144, -139.61213940971714, 645.5329186993883, -5024.538502339927, -1616.9529993526205, -1823.7619850576139, -1436.2759004558998, 770.2025551771636, 3052.941922351908, -1376.2506109706003, -1316.0291302735359, -263.8639948220977, -554.3394017483864, -505.76604070506625, 6611.66551990212, 4116.0189940080445, -3699.2860226305575, -1433.0081660575238, -849.6802581584219, -1686.4089570689907, -88.66209330544757, 1392.8984744533557, 1044.167291508294, -200.3253628557315, -755.0012686361279, 1401.2454709386604, 1409.0718567149493, 1819.2023619675354, 936.7064713365824, 6045.376736185926, 5616.41399166209, 2895.92155553759, 5167.5712208643545, 2909.996611394381, -2866.3633656380757, 739.3308899646881, -707.6180711027149, 1691.1508634873944, -279.26201675122775, 4900.933369766838, 2011.0154285224592, -25.319217626433982, 2397.5762627831587, -888.1124316344702, 5873.225773834793, 3019.392455927707, -1848.390541341357, 478.54939992994355, -739.4937014029872, -214.60603470131844, -4660.929767816832, -499.23738916717315, 1976.1502387425278, 18.099581105086806, -937.757482984506, 1433.0420845056299, 6810.631071318922, 2178.4054109434805, -4263.255022259596, -559.3783709957388, -4111.870204792903, 426.85653338042505, 2539.2008035026056, 2099.3231844658253, 1845.6791086817323, 4899.482224918355, 1377.7599816699517, -870.4557372380972, 130.3198539800365, -99.21736467302969, 2375.696541074277, 5526.504663516122, -109.92239071035185, 1267.1493708440712, 2578.048835127477, 2267.2423239115215, -485.3880031477977, -34.30615444350634, 758.5117050972439, -51.028472853712, -100.91503142570784, 1297.4666571928333, -2398.4174757218652, 1328.9506035371187, 1403.19895848087, -1362.6287271659735, -1312.9292609474724, -999.24009337003, -846.6959153659512, 916.9494011959728, 7086.476854371672, 895.8680337066769, 3048.407265042533, -400.1644489083441, 5450.429064898588, -558.7280193906075, 1178.9405769962857, 3264.6187023646303, -5310.777803339678, 601.0142241340479, 986.1575111978647, 572.9985118793952, 2924.4161007739785, 2983.2086162977444, 3307.900065369666, 2806.037928907751, 2345.99804434068, -4314.123682025072, 61.45866549914985, 445.19552340486894, 3714.6283961647746, 4904.960874947295]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.678856592862131, "mean_inference_ms": 1.4713528898189947, "mean_action_processing_ms": 0.29600333334872514, "mean_env_wait_ms": 0.12921746384677832, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006342887878417969, "StateBufferConnector_ms": 0.003504633903503418, "ViewRequirementAgentConnector_ms": 0.1226205825805664}, "num_episodes": 18, "episode_return_max": 3548.0262330840956, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 748.1129073564615, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.69425941597825, "num_env_steps_trained_throughput_per_sec": 259.69425941597825, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 14573.937, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14573.888, "sample_time_ms": 1341.734, "learn_time_ms": 13210.057, "learn_throughput": 302.8, "synch_weights_time_ms": 19.34}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "6751e_00000", "date": "2024-08-11_19-15-44", "timestamp": 1723418144, "time_this_iter_s": 15.481774091720581, "time_total_s": 512.4376847743988, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16e98e670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 512.4376847743988, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 53.25000000000001, "ram_util_percent": 83.22727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7463928054407161, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.94568209471526, "policy_loss": -0.0043501644395291805, "vf_loss": 9.94975280408506, "vf_explained_var": 0.005493278667409584, "kl": 0.005589579014649223, "entropy": 0.946688099134536, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8016884852023352, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.651913638341995, "policy_loss": -0.010256061602442983, "vf_loss": 9.660179301670619, "vf_explained_var": -0.00015031187622635453, "kl": 0.009952062251965592, "entropy": 0.9869725393555152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 12365.027604194163, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 928.8058177674501, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6175.520863874009, "predator_policy": -7432.349612258775}, "policy_reward_max": {"prey_policy": 8556.004993292161, "predator_policy": 13133.376807400704}, "policy_reward_mean": {"prey_policy": -268.3428904004592, "predator_policy": 732.745799284184}, "custom_metrics": {}, "hist_stats": {"episode_reward": [119.09528690260821, 278.0420502724979, 354.297901880411, 978.0783638961707, -1.4210854715202004e-14, 0.0, 700.5319323407246, 1302.390940543771, 628.4836671282754, 1129.3842604505576, 1922.9445704429722, 431.2381906518078, 1005.5498347528935, 0.0, 336.68990976538197, 1856.3298487749105, 903.168850888542, -1.7763568394002505e-14, 115.72425145510829, 1479.928007912415, 1113.6420834851876, 252.16523837502643, 0.0, -2.842170943040401e-14, 365.2464793535393, 2310.4267889816933, 938.3517045175307, 565.7174219615459, 732.7063359200504, 3548.0262330840956, 1.4210854715202004e-14, 1.4210854715202004e-14, 1449.2721624847206, 1846.3109980824827, 559.7454407863356, 1013.4656531944881, 497.1266071160482, 1121.0306381630237, 2559.8169756159677, 1346.4988595711895, 0.0, 990.5045338834069, 1198.510236973463, 879.1518489301625, 683.1896913486069, 1.4210854715202004e-14, 123.69770384967234, 0.0, 122.81987680012058, 396.8488944240013, 2875.8933424089732, 130.43915247179052, 0.0, 0.0, 1639.7442327661618, 428.9849059487157, -3.552713678800501e-15, 1500.5453665103926, 154.3416979117375, 1257.7833222092058, 660.0588350883394, 346.16272227210715, 0.0, 411.12448598489016, 597.8505112336708, 426.4793446046568, 242.68971530324984, 273.1948369949663, 625.9323365928636, 0.0, 392.7344268456552, 494.2801641474144, 2583.461590972981, 1873.400173150995, 131.3015712697291, 1559.4250930373514, 558.6539447182882, 1496.0066311190665, 3823.2604831290046, 7.105427357601002e-15, 590.2763204231056, 0.0, 4031.6753153524346, 347.84263791933455, 2307.3080413597286, 1111.7937305091305, 1096.4711307160076, 1215.8893094255, 1221.5118162704164, 2048.3270694884395, 208.79151121520155, 324.96933012413194, 489.9978514996966, 258.68568212778314, 260.53518950108474, 0.0, 118.56349331844416, 12365.027604194163, 2128.5582450798825, 114.45833656689851], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-273.69214562440624, -1345.0017338977682, 4769.571152835195, -5253.368862922874, 631.0857569224627, -2260.8404596669848, 3968.5374566535775, -1827.0665211027751, 2630.8049231445398, -4291.335521185061, -453.98742418701534, -315.87485532700373, -226.00589978162594, -968.0727397645769, 4261.157798106821, -2096.449568336363, -2337.4798779948524, -1419.4785282314165, -3232.0272527917346, -1094.2066617907005, 2977.938064271602, -1289.706478933072, 2392.3263641283247, -6175.520863874009, 5066.209907274104, -4307.456584027163, 1700.6844437950265, -2031.9287075991988, -897.5105086640042, -1873.373002249135, -1119.2413183933493, -908.2245558364987, -1015.4740830971053, -1596.7564891627549, 3115.7452766119027, -2519.5428230428747, 5724.736376461273, -1657.6092905699259, 6040.55363671014, -2049.94739359097, 5032.236367966267, -2204.9324850774187, 7115.15300582405, -2602.9958679946867, 1952.9815623910547, -2048.6986359667094, 7039.074918463692, -2660.069334823147, 5940.868408843329, -2134.9069450795546, 3345.891214673825, -369.3910804133949, 3140.113315790494, -3878.4529226542695, 5724.190082306136, -3578.5795352489586, 4528.810425469305, -2735.9986470957992, -2340.511594933517, -4839.146685892557, 6765.211687765867, -1632.9174990777835, 5184.193359472169, -2648.104144244756, 307.73495090872564, -162.69916957191316, 3851.727596941922, -2849.2585275119995, 2870.6617949896945, -2957.1605565058926, -1215.3857920298287, -999.4227734581675, -3557.0108892907156, -2927.945711115742, -4279.466941506474, -3111.837967530186, -608.4662798129627, -4909.284576829804, 4530.444421740548, -1056.9130864959704, 2138.014712701547, -3121.547505086224, 1723.7694487103827, -5354.936267842587, 1494.9456347847417, -2282.1316087072996, 4871.768528425018, -5502.080510643541, -3068.297650342696, -5141.130888071196, 2569.679685946998, -1199.8385445355875, 5233.526262696786, -4155.728822742805, 6720.951966519764, -1560.7848095357604, -51.586574255118386, -1819.843368792376, 4785.00496458844, -4883.440671685563, -3717.001057923986, -2396.1420819294513, 6219.169374207174, -1266.096828480049, 5987.255354965058, -2302.2416835525805, -535.3800221475859, -4103.143965820845, -2905.8365161008214, -2199.5805847331053, -48.07537726100977, -30.243961222128085, -35.415406261326524, 4.312916954320404, -1328.3829241743802, -5073.27291390564, 3162.073486193064, -4164.958768415051, -1861.2706510045298, -1726.2371858252598, 395.77240762291626, 783.9805850567274, 901.8517444938248, -1263.1722544652494, 3751.216879598795, -4947.76850536592, 4508.591959870187, -3028.000601700547, 5917.700301570455, -5360.420021651684, 1631.1349861871927, 1107.5137127349678, 1198.544536717267, -1026.1083072440374, -1741.2965074231302, -5967.853543660257, 600.4829834181619, -2622.7934629594865, -2208.0790532829033, -2683.6219922250857, -1253.9195612324656, -2796.905291282794, 5883.67476647884, -679.6310231257867, 3489.2191331526938, -2464.9135652569735, -443.4128395779119, -3590.8117043428165, -3130.8501889258096, -2851.7862340818774, 6347.358302742502, -2819.807572020765, 128.9265190133675, -76.92676319909643, -2749.9472103359453, -4373.635429657053, 410.6006057616101, -923.4729938974662, 11.638331182550772, -2131.6688050057805, 1082.0033160924547, -3408.303420021512, -45.42040190184509, -3737.223262798033, -930.677043610344, -2020.8202543212503, 1638.3853325119958, 286.37323713761066, -566.934555491656, -2884.3149054881274, 137.32492991096393, -1134.7204306518877, -1864.4757276947676, -3539.0675258923748, 8556.004993292161, 815.0843734111442, 4601.923378314001, -943.2730178585236, -2546.8471152091543, -5434.641170175031, 1913.020216097709, 1445.3647547732692, 2067.366205053767, 357.28963170793395, 677.3063170680374, -3939.964912965513, 2978.3200169533993, -3322.462219359831, 2673.355192318911, 142.54036317550617, 2681.680839547112, -2914.8133519633857, 5056.185107501468, 547.70466166516, 7432.349612258775, -768.3492032065551, -1511.0336665170983, -177.63966644686087, 3027.3969999547435, -2563.731685294841], "policy_predator_policy_reward": [1671.229867298968, 66.55929912581459, -373.30200995952544, 1135.1417703196928, 1731.1432715276576, 252.9093330972737, 337.60511410743936, -1500.997685762075, 3612.413594585173, -1951.8829965446594, 586.9011471323136, 182.96113238170545, 478.4581460987908, 1416.1524257881367, 1178.5319477541238, -2040.8492369808112, 923.8711574746022, 3461.5709158799427, 3020.8711184439107, 2434.7470565890817, -1522.6923988796243, 1757.405383984063, 4256.489347403971, -42.056657006478126, 1132.3098259343246, -885.5133144283695, 171.2303172803438, 160.01394652382686, 1983.0450402576012, 1124.5283804209212, 1532.381438976692, 2351.4142840280647, 958.4014964735053, 2556.9979266748956, -962.3851522264331, 366.18269865740785, -3751.099544360366, -200.30329007587125, 1683.6388171263284, -4194.317052333077, 931.3240557655542, -2644.985855169222, -52.3008923989617, -4207.691007055373, 235.32921298537144, -139.61213940971714, 645.5329186993883, -5024.538502339927, -1616.9529993526205, -1823.7619850576139, -1436.2759004558998, 770.2025551771636, 3052.941922351908, -1376.2506109706003, -1316.0291302735359, -263.8639948220977, -554.3394017483864, -505.76604070506625, 6611.66551990212, 4116.0189940080445, -3699.2860226305575, -1433.0081660575238, -849.6802581584219, -1686.4089570689907, -88.66209330544757, 1392.8984744533557, 1044.167291508294, -200.3253628557315, -755.0012686361279, 1401.2454709386604, 1409.0718567149493, 1819.2023619675354, 936.7064713365824, 6045.376736185926, 5616.41399166209, 2895.92155553759, 5167.5712208643545, 2909.996611394381, -2866.3633656380757, 739.3308899646881, -707.6180711027149, 1691.1508634873944, -279.26201675122775, 4900.933369766838, 2011.0154285224592, -25.319217626433982, 2397.5762627831587, -888.1124316344702, 5873.225773834793, 3019.392455927707, -1848.390541341357, 478.54939992994355, -739.4937014029872, -214.60603470131844, -4660.929767816832, -499.23738916717315, 1976.1502387425278, 18.099581105086806, -937.757482984506, 1433.0420845056299, 6810.631071318922, 2178.4054109434805, -4263.255022259596, -559.3783709957388, -4111.870204792903, 426.85653338042505, 2539.2008035026056, 2099.3231844658253, 1845.6791086817323, 4899.482224918355, 1377.7599816699517, -870.4557372380972, 130.3198539800365, -99.21736467302969, 2375.696541074277, 5526.504663516122, -109.92239071035185, 1267.1493708440712, 2578.048835127477, 2267.2423239115215, -485.3880031477977, -34.30615444350634, 758.5117050972439, -51.028472853712, -100.91503142570784, 1297.4666571928333, -2398.4174757218652, 1328.9506035371187, 1403.19895848087, -1362.6287271659735, -1312.9292609474724, -999.24009337003, -846.6959153659512, 916.9494011959728, 7086.476854371672, 895.8680337066769, 3048.407265042533, -400.1644489083441, 5450.429064898588, -558.7280193906075, 1178.9405769962857, 3264.6187023646303, -5310.777803339678, 601.0142241340479, 986.1575111978647, 572.9985118793952, 2924.4161007739785, 2983.2086162977444, 3307.900065369666, 2806.037928907751, 2345.99804434068, -4314.123682025072, 61.45866549914985, 445.19552340486894, 3714.6283961647746, 4904.960874947295, 3874.5007656474954, 461.63210561735934, 1239.7763145360252, 880.2541592872041, 1812.0946196048874, 1104.4818047472768, 3741.9909732083192, 40.6526914915591, 4858.991474332111, 2124.1811389519135, -1239.5239566034584, -337.3919751268159, 1781.9009453776034, 3976.656556961909, 1538.6571953238945, 570.532035926158, 5635.766202304827, 864.2481819983225, -3260.0550524700316, -4895.145004807769, 198.7675753549107, -2635.9061195399668, 6311.9912436212235, 3717.8241112514042, -447.80891908691063, -2701.7845405688668, -2575.6661836796925, 475.9796770421235, 1222.9200734563208, 2529.736373940851, -1567.0131218836855, 2169.8410064178984, -1391.420402042257, -1163.9399639510748, -1225.320351866361, 1458.4528642826365, -1932.9583867471033, -3552.3678891010804, 13133.376807400704, -7432.349612258775, 1734.6059324864184, 2082.6256455574216, 282.0559328868025, -631.262910979808]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6853288146873467, "mean_inference_ms": 1.4840174502838186, "mean_action_processing_ms": 0.29850585792148776, "mean_env_wait_ms": 0.130655533506708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006404995918273926, "StateBufferConnector_ms": 0.0035028457641601562, "ViewRequirementAgentConnector_ms": 0.14180278778076172}, "num_episodes": 22, "episode_return_max": 12365.027604194163, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 928.8058177674501, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.20331827310537, "num_env_steps_trained_throughput_per_sec": 260.20331827310537, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 14676.516, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14676.463, "sample_time_ms": 1430.682, "learn_time_ms": 13224.009, "learn_throughput": 302.48, "synch_weights_time_ms": 18.95}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "6751e_00000", "date": "2024-08-11_19-16-00", "timestamp": 1723418160, "time_this_iter_s": 15.429656028747559, "time_total_s": 527.8673408031464, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaabaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 527.8673408031464, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 55.595454545454544, "ram_util_percent": 82.96818181818179}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7556988340127405, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.928688233996194, "policy_loss": -0.00597211576914464, "vf_loss": 9.934306848112238, "vf_explained_var": -0.008308808513419337, "kl": 0.007070011919261915, "entropy": 0.9549042339362795, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8191113497214343, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.554654450391336, "policy_loss": -0.005982777067686791, "vf_loss": 9.559418611677867, "vf_explained_var": 0.000354055437461409, "kl": 0.0060931148321086955, "entropy": 1.0074455177027082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 12365.027604194163, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 1125.2096225339958, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5969.271655813797, "predator_policy": -7432.349612258775}, "policy_reward_max": {"prey_policy": 9035.18504549772, "predator_policy": 13133.376807400704}, "policy_reward_mean": {"prey_policy": -284.8933618631366, "predator_policy": 847.4981731301347}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.842170943040401e-14, 365.2464793535393, 2310.4267889816933, 938.3517045175307, 565.7174219615459, 732.7063359200504, 3548.0262330840956, 1.4210854715202004e-14, 1.4210854715202004e-14, 1449.2721624847206, 1846.3109980824827, 559.7454407863356, 1013.4656531944881, 497.1266071160482, 1121.0306381630237, 2559.8169756159677, 1346.4988595711895, 0.0, 990.5045338834069, 1198.510236973463, 879.1518489301625, 683.1896913486069, 1.4210854715202004e-14, 123.69770384967234, 0.0, 122.81987680012058, 396.8488944240013, 2875.8933424089732, 130.43915247179052, 0.0, 0.0, 1639.7442327661618, 428.9849059487157, -3.552713678800501e-15, 1500.5453665103926, 154.3416979117375, 1257.7833222092058, 660.0588350883394, 346.16272227210715, 0.0, 411.12448598489016, 597.8505112336708, 426.4793446046568, 242.68971530324984, 273.1948369949663, 625.9323365928636, 0.0, 392.7344268456552, 494.2801641474144, 2583.461590972981, 1873.400173150995, 131.3015712697291, 1559.4250930373514, 558.6539447182882, 1496.0066311190665, 3823.2604831290046, 7.105427357601002e-15, 590.2763204231056, 0.0, 4031.6753153524346, 347.84263791933455, 2307.3080413597286, 1111.7937305091305, 1096.4711307160076, 1215.8893094255, 1221.5118162704164, 2048.3270694884395, 208.79151121520155, 324.96933012413194, 489.9978514996966, 258.68568212778314, 260.53518950108474, 0.0, 118.56349331844416, 12365.027604194163, 2128.5582450798825, 114.45833656689851, 5499.224288624989, 871.7063729927465, 6754.359999346701, 510.16194422961075, 1274.9699108997386, 1612.682945498442, 248.69044759184584, 2248.4431410558623, 1831.773946144513, 743.2349054726648, 0.0, 1035.2193000545928, 816.9252832975947, 1.4210854715202004e-14, 2080.7344210651745, 1.4210854715202004e-14, 2520.8007766567157, 2329.398274808168, 595.8607788863309, 603.6534364680565, 2229.618962091599, 271.6020512476258, 469.0044801408794], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7039.074918463692, -2660.069334823147, 5940.868408843329, -2134.9069450795546, 3345.891214673825, -369.3910804133949, 3140.113315790494, -3878.4529226542695, 5724.190082306136, -3578.5795352489586, 4528.810425469305, -2735.9986470957992, -2340.511594933517, -4839.146685892557, 6765.211687765867, -1632.9174990777835, 5184.193359472169, -2648.104144244756, 307.73495090872564, -162.69916957191316, 3851.727596941922, -2849.2585275119995, 2870.6617949896945, -2957.1605565058926, -1215.3857920298287, -999.4227734581675, -3557.0108892907156, -2927.945711115742, -4279.466941506474, -3111.837967530186, -608.4662798129627, -4909.284576829804, 4530.444421740548, -1056.9130864959704, 2138.014712701547, -3121.547505086224, 1723.7694487103827, -5354.936267842587, 1494.9456347847417, -2282.1316087072996, 4871.768528425018, -5502.080510643541, -3068.297650342696, -5141.130888071196, 2569.679685946998, -1199.8385445355875, 5233.526262696786, -4155.728822742805, 6720.951966519764, -1560.7848095357604, -51.586574255118386, -1819.843368792376, 4785.00496458844, -4883.440671685563, -3717.001057923986, -2396.1420819294513, 6219.169374207174, -1266.096828480049, 5987.255354965058, -2302.2416835525805, -535.3800221475859, -4103.143965820845, -2905.8365161008214, -2199.5805847331053, -48.07537726100977, -30.243961222128085, -35.415406261326524, 4.312916954320404, -1328.3829241743802, -5073.27291390564, 3162.073486193064, -4164.958768415051, -1861.2706510045298, -1726.2371858252598, 395.77240762291626, 783.9805850567274, 901.8517444938248, -1263.1722544652494, 3751.216879598795, -4947.76850536592, 4508.591959870187, -3028.000601700547, 5917.700301570455, -5360.420021651684, 1631.1349861871927, 1107.5137127349678, 1198.544536717267, -1026.1083072440374, -1741.2965074231302, -5967.853543660257, 600.4829834181619, -2622.7934629594865, -2208.0790532829033, -2683.6219922250857, -1253.9195612324656, -2796.905291282794, 5883.67476647884, -679.6310231257867, 3489.2191331526938, -2464.9135652569735, -443.4128395779119, -3590.8117043428165, -3130.8501889258096, -2851.7862340818774, 6347.358302742502, -2819.807572020765, 128.9265190133675, -76.92676319909643, -2749.9472103359453, -4373.635429657053, 410.6006057616101, -923.4729938974662, 11.638331182550772, -2131.6688050057805, 1082.0033160924547, -3408.303420021512, -45.42040190184509, -3737.223262798033, -930.677043610344, -2020.8202543212503, 1638.3853325119958, 286.37323713761066, -566.934555491656, -2884.3149054881274, 137.32492991096393, -1134.7204306518877, -1864.4757276947676, -3539.0675258923748, 8556.004993292161, 815.0843734111442, 4601.923378314001, -943.2730178585236, -2546.8471152091543, -5434.641170175031, 1913.020216097709, 1445.3647547732692, 2067.366205053767, 357.28963170793395, 677.3063170680374, -3939.964912965513, 2978.3200169533993, -3322.462219359831, 2673.355192318911, 142.54036317550617, 2681.680839547112, -2914.8133519633857, 5056.185107501468, 547.70466166516, 7432.349612258775, -768.3492032065551, -1511.0336665170983, -177.63966644686087, 3027.3969999547435, -2563.731685294841, 9035.18504549772, -1168.9396200594674, 1342.3906569066976, -2371.2727552472024, 3063.1357300682726, -4256.543382221391, 587.2416230955878, -3321.366571193999, -398.5487087587818, -2817.946023156367, -2619.8200229935433, -5969.271655813797, 2429.159169051006, -2528.327723783876, 21.512940181621474, -2551.4956101091743, -3225.1956033443475, -4452.0657698419645, 3517.979065701987, -2673.747937052227, 6269.562022634613, 2167.561960856246, -3656.3763706454597, -2553.7621919710627, 3719.336303801251, -2163.3038165554617, 6435.002537657539, 165.71343166751598, 3110.7425564945406, -854.0050221722014, 8324.20595050542, -1954.546478598196, -496.9746644482233, -1413.2108942909006, -377.5562549602307, -834.4169284960388, 3004.032948012108, -168.6760403726534, 4827.129999154063, -2970.5124376942513, -3143.6973362388494, -4086.666558642636, 1234.281944821321, -3116.5860962907996, 1688.173141738713, -2421.6938930162983], "policy_predator_policy_reward": [645.5329186993883, -5024.538502339927, -1616.9529993526205, -1823.7619850576139, -1436.2759004558998, 770.2025551771636, 3052.941922351908, -1376.2506109706003, -1316.0291302735359, -263.8639948220977, -554.3394017483864, -505.76604070506625, 6611.66551990212, 4116.0189940080445, -3699.2860226305575, -1433.0081660575238, -849.6802581584219, -1686.4089570689907, -88.66209330544757, 1392.8984744533557, 1044.167291508294, -200.3253628557315, -755.0012686361279, 1401.2454709386604, 1409.0718567149493, 1819.2023619675354, 936.7064713365824, 6045.376736185926, 5616.41399166209, 2895.92155553759, 5167.5712208643545, 2909.996611394381, -2866.3633656380757, 739.3308899646881, -707.6180711027149, 1691.1508634873944, -279.26201675122775, 4900.933369766838, 2011.0154285224592, -25.319217626433982, 2397.5762627831587, -888.1124316344702, 5873.225773834793, 3019.392455927707, -1848.390541341357, 478.54939992994355, -739.4937014029872, -214.60603470131844, -4660.929767816832, -499.23738916717315, 1976.1502387425278, 18.099581105086806, -937.757482984506, 1433.0420845056299, 6810.631071318922, 2178.4054109434805, -4263.255022259596, -559.3783709957388, -4111.870204792903, 426.85653338042505, 2539.2008035026056, 2099.3231844658253, 1845.6791086817323, 4899.482224918355, 1377.7599816699517, -870.4557372380972, 130.3198539800365, -99.21736467302969, 2375.696541074277, 5526.504663516122, -109.92239071035185, 1267.1493708440712, 2578.048835127477, 2267.2423239115215, -485.3880031477977, -34.30615444350634, 758.5117050972439, -51.028472853712, -100.91503142570784, 1297.4666571928333, -2398.4174757218652, 1328.9506035371187, 1403.19895848087, -1362.6287271659735, -1312.9292609474724, -999.24009337003, -846.6959153659512, 916.9494011959728, 7086.476854371672, 895.8680337066769, 3048.407265042533, -400.1644489083441, 5450.429064898588, -558.7280193906075, 1178.9405769962857, 3264.6187023646303, -5310.777803339678, 601.0142241340479, 986.1575111978647, 572.9985118793952, 2924.4161007739785, 2983.2086162977444, 3307.900065369666, 2806.037928907751, 2345.99804434068, -4314.123682025072, 61.45866549914985, 445.19552340486894, 3714.6283961647746, 4904.960874947295, 3874.5007656474954, 461.63210561735934, 1239.7763145360252, 880.2541592872041, 1812.0946196048874, 1104.4818047472768, 3741.9909732083192, 40.6526914915591, 4858.991474332111, 2124.1811389519135, -1239.5239566034584, -337.3919751268159, 1781.9009453776034, 3976.656556961909, 1538.6571953238945, 570.532035926158, 5635.766202304827, 864.2481819983225, -3260.0550524700316, -4895.145004807769, 198.7675753549107, -2635.9061195399668, 6311.9912436212235, 3717.8241112514042, -447.80891908691063, -2701.7845405688668, -2575.6661836796925, 475.9796770421235, 1222.9200734563208, 2529.736373940851, -1567.0131218836855, 2169.8410064178984, -1391.420402042257, -1163.9399639510748, -1225.320351866361, 1458.4528642826365, -1932.9583867471033, -3552.3678891010804, 13133.376807400704, -7432.349612258775, 1734.6059324864184, 2082.6256455574216, 282.0559328868025, -631.262910979808, -6805.965544642745, 4438.944407829502, 1417.1688835106768, 483.41958782257717, 6594.790279579112, 1352.9773719207235, -777.8906707426128, 4022.1775630706356, 228.92139672574714, 4262.5432460891325, 6094.697521367833, 4107.0771029379475, -403.7573907405095, 751.6163930652192, 3362.4934387402054, 1415.9323722432086, 6700.087172040817, 2808.9481472900084, -1048.3857595836423, 947.3895364065509, -4506.402914488835, -3930.7210690020233, 3096.770076224558, 4148.587786446557, 1912.1609626603408, -2651.2681666085346, -2951.3515349144495, -3649.364434410607, 2455.3386063615094, -2631.341719618673, -1339.0276628457555, -5030.631809061468, 2186.2631710117366, 2244.7231643841046, 2252.278606868344, 1289.0928513960935, -761.9974217077715, -1477.49870704535, -1996.3771261111879, 743.4130011194301, 7050.1051504222605, 2409.8777065508248, 1652.8210695543169, 501.08513316278913, 586.1807155172437, 616.3445159012213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6928939652344909, "mean_inference_ms": 1.4985368363823626, "mean_action_processing_ms": 0.3005346786467679, "mean_env_wait_ms": 0.13267248780318197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006208062171936035, "StateBufferConnector_ms": 0.0033222436904907227, "ViewRequirementAgentConnector_ms": 0.13853967189788818}, "num_episodes": 23, "episode_return_max": 12365.027604194163, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 1125.2096225339958, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.7946998016141, "num_env_steps_trained_throughput_per_sec": 278.7946998016141, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 14637.611, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14637.558, "sample_time_ms": 1445.809, "learn_time_ms": 13170.182, "learn_throughput": 303.716, "synch_weights_time_ms": 18.777}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "6751e_00000", "date": "2024-08-11_19-16-14", "timestamp": 1723418174, "time_this_iter_s": 14.391588926315308, "time_total_s": 542.2589297294617, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eab89d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 542.2589297294617, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 53.06, "ram_util_percent": 82.97999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6480326793811939, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.969489570900246, "policy_loss": -0.0061755020903157334, "vf_loss": 9.975381807296996, "vf_explained_var": -0.005970361466130252, "kl": 0.005665435961971458, "entropy": 0.8432803501212408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8126097366134957, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.651934062110053, "policy_loss": -0.00912568559870124, "vf_loss": 9.659164357059216, "vf_explained_var": 0.00018125611638265942, "kl": 0.009476860444409693, "entropy": 0.9801141692532434, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 12365.027604194163, "episode_reward_min": -3.552713678800501e-15, "episode_reward_mean": 1136.7505318819979, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5969.271655813797, "predator_policy": -7432.349612258775}, "policy_reward_max": {"prey_policy": 9035.18504549772, "predator_policy": 13133.376807400704}, "policy_reward_mean": {"prey_policy": -269.2110561392569, "predator_policy": 837.5863220802561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [990.5045338834069, 1198.510236973463, 879.1518489301625, 683.1896913486069, 1.4210854715202004e-14, 123.69770384967234, 0.0, 122.81987680012058, 396.8488944240013, 2875.8933424089732, 130.43915247179052, 0.0, 0.0, 1639.7442327661618, 428.9849059487157, -3.552713678800501e-15, 1500.5453665103926, 154.3416979117375, 1257.7833222092058, 660.0588350883394, 346.16272227210715, 0.0, 411.12448598489016, 597.8505112336708, 426.4793446046568, 242.68971530324984, 273.1948369949663, 625.9323365928636, 0.0, 392.7344268456552, 494.2801641474144, 2583.461590972981, 1873.400173150995, 131.3015712697291, 1559.4250930373514, 558.6539447182882, 1496.0066311190665, 3823.2604831290046, 7.105427357601002e-15, 590.2763204231056, 0.0, 4031.6753153524346, 347.84263791933455, 2307.3080413597286, 1111.7937305091305, 1096.4711307160076, 1215.8893094255, 1221.5118162704164, 2048.3270694884395, 208.79151121520155, 324.96933012413194, 489.9978514996966, 258.68568212778314, 260.53518950108474, 0.0, 118.56349331844416, 12365.027604194163, 2128.5582450798825, 114.45833656689851, 5499.224288624989, 871.7063729927465, 6754.359999346701, 510.16194422961075, 1274.9699108997386, 1612.682945498442, 248.69044759184584, 2248.4431410558623, 1831.773946144513, 743.2349054726648, 0.0, 1035.2193000545928, 816.9252832975947, 1.4210854715202004e-14, 2080.7344210651745, 1.4210854715202004e-14, 2520.8007766567157, 2329.398274808168, 595.8607788863309, 603.6534364680565, 2229.618962091599, 271.6020512476258, 469.0044801408794, 109.00003335526047, 713.6837345565579, 331.65075072200756, 2688.113168670032, 126.29795627626743, 1.7763568394002505e-15, 1155.7646524982285, 749.1499584825383, 2555.3756859297855, 868.4786104183256, 2173.5643981117796, 1.5987211554602254e-14, 247.47136163970822, 4477.523759458097, 1617.389389554527, 424.2183168060672, 441.25428333573007, 1328.8971738179969], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1723.7694487103827, -5354.936267842587, 1494.9456347847417, -2282.1316087072996, 4871.768528425018, -5502.080510643541, -3068.297650342696, -5141.130888071196, 2569.679685946998, -1199.8385445355875, 5233.526262696786, -4155.728822742805, 6720.951966519764, -1560.7848095357604, -51.586574255118386, -1819.843368792376, 4785.00496458844, -4883.440671685563, -3717.001057923986, -2396.1420819294513, 6219.169374207174, -1266.096828480049, 5987.255354965058, -2302.2416835525805, -535.3800221475859, -4103.143965820845, -2905.8365161008214, -2199.5805847331053, -48.07537726100977, -30.243961222128085, -35.415406261326524, 4.312916954320404, -1328.3829241743802, -5073.27291390564, 3162.073486193064, -4164.958768415051, -1861.2706510045298, -1726.2371858252598, 395.77240762291626, 783.9805850567274, 901.8517444938248, -1263.1722544652494, 3751.216879598795, -4947.76850536592, 4508.591959870187, -3028.000601700547, 5917.700301570455, -5360.420021651684, 1631.1349861871927, 1107.5137127349678, 1198.544536717267, -1026.1083072440374, -1741.2965074231302, -5967.853543660257, 600.4829834181619, -2622.7934629594865, -2208.0790532829033, -2683.6219922250857, -1253.9195612324656, -2796.905291282794, 5883.67476647884, -679.6310231257867, 3489.2191331526938, -2464.9135652569735, -443.4128395779119, -3590.8117043428165, -3130.8501889258096, -2851.7862340818774, 6347.358302742502, -2819.807572020765, 128.9265190133675, -76.92676319909643, -2749.9472103359453, -4373.635429657053, 410.6006057616101, -923.4729938974662, 11.638331182550772, -2131.6688050057805, 1082.0033160924547, -3408.303420021512, -45.42040190184509, -3737.223262798033, -930.677043610344, -2020.8202543212503, 1638.3853325119958, 286.37323713761066, -566.934555491656, -2884.3149054881274, 137.32492991096393, -1134.7204306518877, -1864.4757276947676, -3539.0675258923748, 8556.004993292161, 815.0843734111442, 4601.923378314001, -943.2730178585236, -2546.8471152091543, -5434.641170175031, 1913.020216097709, 1445.3647547732692, 2067.366205053767, 357.28963170793395, 677.3063170680374, -3939.964912965513, 2978.3200169533993, -3322.462219359831, 2673.355192318911, 142.54036317550617, 2681.680839547112, -2914.8133519633857, 5056.185107501468, 547.70466166516, 7432.349612258775, -768.3492032065551, -1511.0336665170983, -177.63966644686087, 3027.3969999547435, -2563.731685294841, 9035.18504549772, -1168.9396200594674, 1342.3906569066976, -2371.2727552472024, 3063.1357300682726, -4256.543382221391, 587.2416230955878, -3321.366571193999, -398.5487087587818, -2817.946023156367, -2619.8200229935433, -5969.271655813797, 2429.159169051006, -2528.327723783876, 21.512940181621474, -2551.4956101091743, -3225.1956033443475, -4452.0657698419645, 3517.979065701987, -2673.747937052227, 6269.562022634613, 2167.561960856246, -3656.3763706454597, -2553.7621919710627, 3719.336303801251, -2163.3038165554617, 6435.002537657539, 165.71343166751598, 3110.7425564945406, -854.0050221722014, 8324.20595050542, -1954.546478598196, -496.9746644482233, -1413.2108942909006, -377.5562549602307, -834.4169284960388, 3004.032948012108, -168.6760403726534, 4827.129999154063, -2970.5124376942513, -3143.6973362388494, -4086.666558642636, 1234.281944821321, -3116.5860962907996, 1688.173141738713, -2421.6938930162983, 2977.929452030002, -464.10170576632373, 8121.090609816071, -4870.156690982476, 370.9541959690712, -793.6620055130126, 3877.30963093594, -5304.933174478146, -2228.3902231375187, -4843.328158960841, -4137.133988087144, -1477.1736008891023, 3913.079966408167, -2004.564427597965, -1006.9985675136335, 861.4996444974386, 6809.865358245714, -3676.052471111739, 1000.194086468107, -964.2346246700366, 2552.665341009887, -1042.090679045042, 2682.466096836736, -2065.105384616397, -1016.7176716572169, -3117.0103636031768, 6069.239395075572, -2254.865207269472, -174.53753755207856, -16.16845519991744, 1620.1685909790385, -4809.956234865967, 1925.7062618535824, -737.911797673206, 3471.2521019575647, 680.5921067410956], "policy_predator_policy_reward": [-279.26201675122775, 4900.933369766838, 2011.0154285224592, -25.319217626433982, 2397.5762627831587, -888.1124316344702, 5873.225773834793, 3019.392455927707, -1848.390541341357, 478.54939992994355, -739.4937014029872, -214.60603470131844, -4660.929767816832, -499.23738916717315, 1976.1502387425278, 18.099581105086806, -937.757482984506, 1433.0420845056299, 6810.631071318922, 2178.4054109434805, -4263.255022259596, -559.3783709957388, -4111.870204792903, 426.85653338042505, 2539.2008035026056, 2099.3231844658253, 1845.6791086817323, 4899.482224918355, 1377.7599816699517, -870.4557372380972, 130.3198539800365, -99.21736467302969, 2375.696541074277, 5526.504663516122, -109.92239071035185, 1267.1493708440712, 2578.048835127477, 2267.2423239115215, -485.3880031477977, -34.30615444350634, 758.5117050972439, -51.028472853712, -100.91503142570784, 1297.4666571928333, -2398.4174757218652, 1328.9506035371187, 1403.19895848087, -1362.6287271659735, -1312.9292609474724, -999.24009337003, -846.6959153659512, 916.9494011959728, 7086.476854371672, 895.8680337066769, 3048.407265042533, -400.1644489083441, 5450.429064898588, -558.7280193906075, 1178.9405769962857, 3264.6187023646303, -5310.777803339678, 601.0142241340479, 986.1575111978647, 572.9985118793952, 2924.4161007739785, 2983.2086162977444, 3307.900065369666, 2806.037928907751, 2345.99804434068, -4314.123682025072, 61.45866549914985, 445.19552340486894, 3714.6283961647746, 4904.960874947295, 3874.5007656474954, 461.63210561735934, 1239.7763145360252, 880.2541592872041, 1812.0946196048874, 1104.4818047472768, 3741.9909732083192, 40.6526914915591, 4858.991474332111, 2124.1811389519135, -1239.5239566034584, -337.3919751268159, 1781.9009453776034, 3976.656556961909, 1538.6571953238945, 570.532035926158, 5635.766202304827, 864.2481819983225, -3260.0550524700316, -4895.145004807769, 198.7675753549107, -2635.9061195399668, 6311.9912436212235, 3717.8241112514042, -447.80891908691063, -2701.7845405688668, -2575.6661836796925, 475.9796770421235, 1222.9200734563208, 2529.736373940851, -1567.0131218836855, 2169.8410064178984, -1391.420402042257, -1163.9399639510748, -1225.320351866361, 1458.4528642826365, -1932.9583867471033, -3552.3678891010804, 13133.376807400704, -7432.349612258775, 1734.6059324864184, 2082.6256455574216, 282.0559328868025, -631.262910979808, -6805.965544642745, 4438.944407829502, 1417.1688835106768, 483.41958782257717, 6594.790279579112, 1352.9773719207235, -777.8906707426128, 4022.1775630706356, 228.92139672574714, 4262.5432460891325, 6094.697521367833, 4107.0771029379475, -403.7573907405095, 751.6163930652192, 3362.4934387402054, 1415.9323722432086, 6700.087172040817, 2808.9481472900084, -1048.3857595836423, 947.3895364065509, -4506.402914488835, -3930.7210690020233, 3096.770076224558, 4148.587786446557, 1912.1609626603408, -2651.2681666085346, -2951.3515349144495, -3649.364434410607, 2455.3386063615094, -2631.341719618673, -1339.0276628457555, -5030.631809061468, 2186.2631710117366, 2244.7231643841046, 2252.278606868344, 1289.0928513960935, -761.9974217077715, -1477.49870704535, -1996.3771261111879, 743.4130011194301, 7050.1051504222605, 2409.8777065508248, 1652.8210695543169, 501.08513316278913, 586.1807155172437, 616.3445159012213, -2968.995714699323, 564.1680017909043, 3674.332835506104, -6211.583019783135, 279.3915175936075, 474.96704267234213, 2422.9080756899834, 1692.8286365222557, 3821.9210485954204, 3376.0952897792063, 3094.503994504687, 2519.803594471559, 1577.8196020845944, -2330.570488396567, 1160.6473144793417, -265.9984329806092, 2850.7542311612783, -3429.1914323654632, -668.7002472225292, 1501.219395842783, 1511.5981408411444, -848.6084046942102, -661.8121781164921, 44.45146589615408, 1283.5032594604795, 3097.6961374396224, 3266.5246054804566, -2603.375033828462, 1672.8710808083167, 135.2243014982103, 601.1249490361608, 3012.8810116568375, 649.0985282426897, -1395.6387090873345, 317.510321731301, -3140.4573566119643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6978544438819987, "mean_inference_ms": 1.5087553344320925, "mean_action_processing_ms": 0.3022024842147889, "mean_env_wait_ms": 0.1339749590456983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006392478942871094, "StateBufferConnector_ms": 0.0033233165740966797, "ViewRequirementAgentConnector_ms": 0.13695549964904785}, "num_episodes": 18, "episode_return_max": 12365.027604194163, "episode_return_min": -3.552713678800501e-15, "episode_return_mean": 1136.7505318819979, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.33231446635165, "num_env_steps_trained_throughput_per_sec": 281.33231446635165, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 14672.891, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14672.837, "sample_time_ms": 1453.161, "learn_time_ms": 13197.912, "learn_throughput": 303.078, "synch_weights_time_ms": 19.071}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "6751e_00000", "date": "2024-08-11_19-16-29", "timestamp": 1723418189, "time_this_iter_s": 14.2556631565094, "time_total_s": 556.5145928859711, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eab8040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 556.5145928859711, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 46.945, "ram_util_percent": 82.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7080030023263245, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.94679954316881, "policy_loss": -0.00594954328049743, "vf_loss": 9.952356621071145, "vf_explained_var": -0.001245476802190145, "kl": 0.007849270162286988, "entropy": 0.8630892316184977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7996385691973268, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.764088130123401, "policy_loss": -0.007500804316562911, "vf_loss": 9.770006974538168, "vf_explained_var": -1.5118733915702376e-05, "kl": 0.007909894399496431, "entropy": 0.9696065320855095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 12365.027604194163, "episode_reward_min": 0.0, "episode_reward_mean": 1210.862615001401, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5969.271655813797, "predator_policy": -7432.349612258775}, "policy_reward_max": {"prey_policy": 9035.18504549772, "predator_policy": 13133.376807400704}, "policy_reward_mean": {"prey_policy": -198.6581141393829, "predator_policy": 804.0894216400836}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1257.7833222092058, 660.0588350883394, 346.16272227210715, 0.0, 411.12448598489016, 597.8505112336708, 426.4793446046568, 242.68971530324984, 273.1948369949663, 625.9323365928636, 0.0, 392.7344268456552, 494.2801641474144, 2583.461590972981, 1873.400173150995, 131.3015712697291, 1559.4250930373514, 558.6539447182882, 1496.0066311190665, 3823.2604831290046, 7.105427357601002e-15, 590.2763204231056, 0.0, 4031.6753153524346, 347.84263791933455, 2307.3080413597286, 1111.7937305091305, 1096.4711307160076, 1215.8893094255, 1221.5118162704164, 2048.3270694884395, 208.79151121520155, 324.96933012413194, 489.9978514996966, 258.68568212778314, 260.53518950108474, 0.0, 118.56349331844416, 12365.027604194163, 2128.5582450798825, 114.45833656689851, 5499.224288624989, 871.7063729927465, 6754.359999346701, 510.16194422961075, 1274.9699108997386, 1612.682945498442, 248.69044759184584, 2248.4431410558623, 1831.773946144513, 743.2349054726648, 0.0, 1035.2193000545928, 816.9252832975947, 1.4210854715202004e-14, 2080.7344210651745, 1.4210854715202004e-14, 2520.8007766567157, 2329.398274808168, 595.8607788863309, 603.6534364680565, 2229.618962091599, 271.6020512476258, 469.0044801408794, 109.00003335526047, 713.6837345565579, 331.65075072200756, 2688.113168670032, 126.29795627626743, 1.7763568394002505e-15, 1155.7646524982285, 749.1499584825383, 2555.3756859297855, 868.4786104183256, 2173.5643981117796, 1.5987211554602254e-14, 247.47136163970822, 4477.523759458097, 1617.389389554527, 424.2183168060672, 441.25428333573007, 1328.8971738179969, 697.1789900318572, 106.77964359658634, 126.83841466922959, 1315.0263242935787, 1522.3416908478473, 2247.009801402496, 1462.0461027312224, 131.1630887916748, 1.4210854715202004e-14, 3287.381384496086, 473.1839490185775, 762.4895964691184, 1440.3074362741963, 2448.76850967024, 2249.9475858974683, 146.3346564921696, 119.08262148516619, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1861.2706510045298, -1726.2371858252598, 395.77240762291626, 783.9805850567274, 901.8517444938248, -1263.1722544652494, 3751.216879598795, -4947.76850536592, 4508.591959870187, -3028.000601700547, 5917.700301570455, -5360.420021651684, 1631.1349861871927, 1107.5137127349678, 1198.544536717267, -1026.1083072440374, -1741.2965074231302, -5967.853543660257, 600.4829834181619, -2622.7934629594865, -2208.0790532829033, -2683.6219922250857, -1253.9195612324656, -2796.905291282794, 5883.67476647884, -679.6310231257867, 3489.2191331526938, -2464.9135652569735, -443.4128395779119, -3590.8117043428165, -3130.8501889258096, -2851.7862340818774, 6347.358302742502, -2819.807572020765, 128.9265190133675, -76.92676319909643, -2749.9472103359453, -4373.635429657053, 410.6006057616101, -923.4729938974662, 11.638331182550772, -2131.6688050057805, 1082.0033160924547, -3408.303420021512, -45.42040190184509, -3737.223262798033, -930.677043610344, -2020.8202543212503, 1638.3853325119958, 286.37323713761066, -566.934555491656, -2884.3149054881274, 137.32492991096393, -1134.7204306518877, -1864.4757276947676, -3539.0675258923748, 8556.004993292161, 815.0843734111442, 4601.923378314001, -943.2730178585236, -2546.8471152091543, -5434.641170175031, 1913.020216097709, 1445.3647547732692, 2067.366205053767, 357.28963170793395, 677.3063170680374, -3939.964912965513, 2978.3200169533993, -3322.462219359831, 2673.355192318911, 142.54036317550617, 2681.680839547112, -2914.8133519633857, 5056.185107501468, 547.70466166516, 7432.349612258775, -768.3492032065551, -1511.0336665170983, -177.63966644686087, 3027.3969999547435, -2563.731685294841, 9035.18504549772, -1168.9396200594674, 1342.3906569066976, -2371.2727552472024, 3063.1357300682726, -4256.543382221391, 587.2416230955878, -3321.366571193999, -398.5487087587818, -2817.946023156367, -2619.8200229935433, -5969.271655813797, 2429.159169051006, -2528.327723783876, 21.512940181621474, -2551.4956101091743, -3225.1956033443475, -4452.0657698419645, 3517.979065701987, -2673.747937052227, 6269.562022634613, 2167.561960856246, -3656.3763706454597, -2553.7621919710627, 3719.336303801251, -2163.3038165554617, 6435.002537657539, 165.71343166751598, 3110.7425564945406, -854.0050221722014, 8324.20595050542, -1954.546478598196, -496.9746644482233, -1413.2108942909006, -377.5562549602307, -834.4169284960388, 3004.032948012108, -168.6760403726534, 4827.129999154063, -2970.5124376942513, -3143.6973362388494, -4086.666558642636, 1234.281944821321, -3116.5860962907996, 1688.173141738713, -2421.6938930162983, 2977.929452030002, -464.10170576632373, 8121.090609816071, -4870.156690982476, 370.9541959690712, -793.6620055130126, 3877.30963093594, -5304.933174478146, -2228.3902231375187, -4843.328158960841, -4137.133988087144, -1477.1736008891023, 3913.079966408167, -2004.564427597965, -1006.9985675136335, 861.4996444974386, 6809.865358245714, -3676.052471111739, 1000.194086468107, -964.2346246700366, 2552.665341009887, -1042.090679045042, 2682.466096836736, -2065.105384616397, -1016.7176716572169, -3117.0103636031768, 6069.239395075572, -2254.865207269472, -174.53753755207856, -16.16845519991744, 1620.1685909790385, -4809.956234865967, 1925.7062618535824, -737.911797673206, 3471.2521019575647, 680.5921067410956, 7174.510310294141, -5296.40223705202, 3145.498446422123, 273.7036824342085, -94.86011002420192, -2880.9052546154353, -811.6275879956277, -2450.317857230459, 1162.6143924708003, -2674.555232350278, 7533.532553658209, -2496.358172454886, 1666.578512261849, -4382.069487723721, -1357.89689038944, -3277.8861640141413, 1070.4877215767792, -358.73791484371566, 4109.983973570793, -2283.080920022812, 191.43828651284701, -1529.835285823116, 1037.3497795995797, -3812.1247082192845, 3580.2840446901887, -1428.9308757952333, 1692.7026629151785, -1669.8017592177393, 3601.436287099293, -2377.636677585253, -1831.2210589303609, -865.3002488680261, 1201.2484348286441, -2255.4691114861344, 2915.353296941582, -4464.23061575028], "policy_predator_policy_reward": [2578.048835127477, 2267.2423239115215, -485.3880031477977, -34.30615444350634, 758.5117050972439, -51.028472853712, -100.91503142570784, 1297.4666571928333, -2398.4174757218652, 1328.9506035371187, 1403.19895848087, -1362.6287271659735, -1312.9292609474724, -999.24009337003, -846.6959153659512, 916.9494011959728, 7086.476854371672, 895.8680337066769, 3048.407265042533, -400.1644489083441, 5450.429064898588, -558.7280193906075, 1178.9405769962857, 3264.6187023646303, -5310.777803339678, 601.0142241340479, 986.1575111978647, 572.9985118793952, 2924.4161007739785, 2983.2086162977444, 3307.900065369666, 2806.037928907751, 2345.99804434068, -4314.123682025072, 61.45866549914985, 445.19552340486894, 3714.6283961647746, 4904.960874947295, 3874.5007656474954, 461.63210561735934, 1239.7763145360252, 880.2541592872041, 1812.0946196048874, 1104.4818047472768, 3741.9909732083192, 40.6526914915591, 4858.991474332111, 2124.1811389519135, -1239.5239566034584, -337.3919751268159, 1781.9009453776034, 3976.656556961909, 1538.6571953238945, 570.532035926158, 5635.766202304827, 864.2481819983225, -3260.0550524700316, -4895.145004807769, 198.7675753549107, -2635.9061195399668, 6311.9912436212235, 3717.8241112514042, -447.80891908691063, -2701.7845405688668, -2575.6661836796925, 475.9796770421235, 1222.9200734563208, 2529.736373940851, -1567.0131218836855, 2169.8410064178984, -1391.420402042257, -1163.9399639510748, -1225.320351866361, 1458.4528642826365, -1932.9583867471033, -3552.3678891010804, 13133.376807400704, -7432.349612258775, 1734.6059324864184, 2082.6256455574216, 282.0559328868025, -631.262910979808, -6805.965544642745, 4438.944407829502, 1417.1688835106768, 483.41958782257717, 6594.790279579112, 1352.9773719207235, -777.8906707426128, 4022.1775630706356, 228.92139672574714, 4262.5432460891325, 6094.697521367833, 4107.0771029379475, -403.7573907405095, 751.6163930652192, 3362.4934387402054, 1415.9323722432086, 6700.087172040817, 2808.9481472900084, -1048.3857595836423, 947.3895364065509, -4506.402914488835, -3930.7210690020233, 3096.770076224558, 4148.587786446557, 1912.1609626603408, -2651.2681666085346, -2951.3515349144495, -3649.364434410607, 2455.3386063615094, -2631.341719618673, -1339.0276628457555, -5030.631809061468, 2186.2631710117366, 2244.7231643841046, 2252.278606868344, 1289.0928513960935, -761.9974217077715, -1477.49870704535, -1996.3771261111879, 743.4130011194301, 7050.1051504222605, 2409.8777065508248, 1652.8210695543169, 501.08513316278913, 586.1807155172437, 616.3445159012213, -2968.995714699323, 564.1680017909043, 3674.332835506104, -6211.583019783135, 279.3915175936075, 474.96704267234213, 2422.9080756899834, 1692.8286365222557, 3821.9210485954204, 3376.0952897792063, 3094.503994504687, 2519.803594471559, 1577.8196020845944, -2330.570488396567, 1160.6473144793417, -265.9984329806092, 2850.7542311612783, -3429.1914323654632, -668.7002472225292, 1501.219395842783, 1511.5981408411444, -848.6084046942102, -661.8121781164921, 44.45146589615408, 1283.5032594604795, 3097.6961374396224, 3266.5246054804566, -2603.375033828462, 1672.8710808083167, 135.2243014982103, 601.1249490361608, 3012.8810116568375, 649.0985282426897, -1395.6387090873345, 317.510321731301, -3140.4573566119643, -236.34758752473618, -944.5814956855394, 243.86614512264026, -3556.288630382388, 3077.683789199694, 24.919990109172456, 1567.455313666973, 3009.5164558526917, 801.4293982868309, 2232.853132440495, 3654.9817512115187, -6445.146331012346, 1785.4101640793763, 2392.126914113717, 1614.143179266953, 3152.802963928302, -1367.0750127459244, 655.3252060128632, 1785.029641287289, -324.551310339177, -299.3640615985576, 2110.9450099274, 1991.0300180471093, 1546.2345070417134, 1642.3712000764772, -2353.4169326972387, 1860.1914186868034, 565.6761872859985, -933.5784749779722, 1959.7264513614016, 206.5216724821551, 2636.334291808399, -641.1415071751214, 1814.444805317779, -312.92691675131607, 1861.8042355600064]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7018688953460921, "mean_inference_ms": 1.5176933263794268, "mean_action_processing_ms": 0.30353089512646125, "mean_env_wait_ms": 0.1351440130304406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006241559982299805, "StateBufferConnector_ms": 0.0032864809036254883, "ViewRequirementAgentConnector_ms": 0.13220858573913574}, "num_episodes": 18, "episode_return_max": 12365.027604194163, "episode_return_min": 0.0, "episode_return_mean": 1210.862615001401, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.301664150987, "num_env_steps_trained_throughput_per_sec": 285.301664150987, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 14515.644, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14515.591, "sample_time_ms": 1385.794, "learn_time_ms": 13108.1, "learn_throughput": 305.155, "synch_weights_time_ms": 18.983}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "6751e_00000", "date": "2024-08-11_19-16-43", "timestamp": 1723418203, "time_this_iter_s": 14.088199853897095, "time_total_s": 570.6027927398682, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 570.6027927398682, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 47.825, "ram_util_percent": 82.32000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6513916491043, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.970162539002757, "policy_loss": -0.0035550182124737787, "vf_loss": 9.973488525108055, "vf_explained_var": -0.005310667759526974, "kl": 0.004580938023259815, "entropy": 0.8496900995887776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.70051496090397, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.536129595741393, "policy_loss": -0.00549333209107832, "vf_loss": 9.54040343420846, "vf_explained_var": 0.00035276876555548776, "kl": 0.006097314106497246, "entropy": 0.9511950546786898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 12365.027604194163, "episode_reward_min": 0.0, "episode_reward_mean": 1360.6139789091292, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5969.271655813797, "predator_policy": -7432.349612258775}, "policy_reward_max": {"prey_policy": 9035.18504549772, "predator_policy": 13133.376807400704}, "policy_reward_mean": {"prey_policy": 15.06513192943743, "predator_policy": 665.2418575251274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4031.6753153524346, 347.84263791933455, 2307.3080413597286, 1111.7937305091305, 1096.4711307160076, 1215.8893094255, 1221.5118162704164, 2048.3270694884395, 208.79151121520155, 324.96933012413194, 489.9978514996966, 258.68568212778314, 260.53518950108474, 0.0, 118.56349331844416, 12365.027604194163, 2128.5582450798825, 114.45833656689851, 5499.224288624989, 871.7063729927465, 6754.359999346701, 510.16194422961075, 1274.9699108997386, 1612.682945498442, 248.69044759184584, 2248.4431410558623, 1831.773946144513, 743.2349054726648, 0.0, 1035.2193000545928, 816.9252832975947, 1.4210854715202004e-14, 2080.7344210651745, 1.4210854715202004e-14, 2520.8007766567157, 2329.398274808168, 595.8607788863309, 603.6534364680565, 2229.618962091599, 271.6020512476258, 469.0044801408794, 109.00003335526047, 713.6837345565579, 331.65075072200756, 2688.113168670032, 126.29795627626743, 1.7763568394002505e-15, 1155.7646524982285, 749.1499584825383, 2555.3756859297855, 868.4786104183256, 2173.5643981117796, 1.5987211554602254e-14, 247.47136163970822, 4477.523759458097, 1617.389389554527, 424.2183168060672, 441.25428333573007, 1328.8971738179969, 697.1789900318572, 106.77964359658634, 126.83841466922959, 1315.0263242935787, 1522.3416908478473, 2247.009801402496, 1462.0461027312224, 131.1630887916748, 1.4210854715202004e-14, 3287.381384496086, 473.1839490185775, 762.4895964691184, 1440.3074362741963, 2448.76850967024, 2249.9475858974683, 146.3346564921696, 119.08262148516619, 0.0, 244.42612896384932, 1179.6967081799655, 2752.625091347455, 1458.1640846493754, 919.3039235511512, 268.9531470010934, 276.2196515290732, 4879.8097079359695, 5880.37012992288, 3193.514395480316, 1010.3350719489453, 3395.718708072613, 347.41783559695716, 3496.290472915508, 0.0, 123.76652940114715, 2913.889176756995, 1.4210854715202004e-14, 978.7121366170719, 0.0, 3.552713678800501e-14, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-45.42040190184509, -3737.223262798033, -930.677043610344, -2020.8202543212503, 1638.3853325119958, 286.37323713761066, -566.934555491656, -2884.3149054881274, 137.32492991096393, -1134.7204306518877, -1864.4757276947676, -3539.0675258923748, 8556.004993292161, 815.0843734111442, 4601.923378314001, -943.2730178585236, -2546.8471152091543, -5434.641170175031, 1913.020216097709, 1445.3647547732692, 2067.366205053767, 357.28963170793395, 677.3063170680374, -3939.964912965513, 2978.3200169533993, -3322.462219359831, 2673.355192318911, 142.54036317550617, 2681.680839547112, -2914.8133519633857, 5056.185107501468, 547.70466166516, 7432.349612258775, -768.3492032065551, -1511.0336665170983, -177.63966644686087, 3027.3969999547435, -2563.731685294841, 9035.18504549772, -1168.9396200594674, 1342.3906569066976, -2371.2727552472024, 3063.1357300682726, -4256.543382221391, 587.2416230955878, -3321.366571193999, -398.5487087587818, -2817.946023156367, -2619.8200229935433, -5969.271655813797, 2429.159169051006, -2528.327723783876, 21.512940181621474, -2551.4956101091743, -3225.1956033443475, -4452.0657698419645, 3517.979065701987, -2673.747937052227, 6269.562022634613, 2167.561960856246, -3656.3763706454597, -2553.7621919710627, 3719.336303801251, -2163.3038165554617, 6435.002537657539, 165.71343166751598, 3110.7425564945406, -854.0050221722014, 8324.20595050542, -1954.546478598196, -496.9746644482233, -1413.2108942909006, -377.5562549602307, -834.4169284960388, 3004.032948012108, -168.6760403726534, 4827.129999154063, -2970.5124376942513, -3143.6973362388494, -4086.666558642636, 1234.281944821321, -3116.5860962907996, 1688.173141738713, -2421.6938930162983, 2977.929452030002, -464.10170576632373, 8121.090609816071, -4870.156690982476, 370.9541959690712, -793.6620055130126, 3877.30963093594, -5304.933174478146, -2228.3902231375187, -4843.328158960841, -4137.133988087144, -1477.1736008891023, 3913.079966408167, -2004.564427597965, -1006.9985675136335, 861.4996444974386, 6809.865358245714, -3676.052471111739, 1000.194086468107, -964.2346246700366, 2552.665341009887, -1042.090679045042, 2682.466096836736, -2065.105384616397, -1016.7176716572169, -3117.0103636031768, 6069.239395075572, -2254.865207269472, -174.53753755207856, -16.16845519991744, 1620.1685909790385, -4809.956234865967, 1925.7062618535824, -737.911797673206, 3471.2521019575647, 680.5921067410956, 7174.510310294141, -5296.40223705202, 3145.498446422123, 273.7036824342085, -94.86011002420192, -2880.9052546154353, -811.6275879956277, -2450.317857230459, 1162.6143924708003, -2674.555232350278, 7533.532553658209, -2496.358172454886, 1666.578512261849, -4382.069487723721, -1357.89689038944, -3277.8861640141413, 1070.4877215767792, -358.73791484371566, 4109.983973570793, -2283.080920022812, 191.43828651284701, -1529.835285823116, 1037.3497795995797, -3812.1247082192845, 3580.2840446901887, -1428.9308757952333, 1692.7026629151785, -1669.8017592177393, 3601.436287099293, -2377.636677585253, -1831.2210589303609, -865.3002488680261, 1201.2484348286441, -2255.4691114861344, 2915.353296941582, -4464.23061575028, 3657.746739310304, -315.17014563284056, 948.5753298913781, 1523.5342788913483, 1977.8650711219573, -2736.531689818299, 1701.304336720863, -1567.2215660757618, 458.30190437341344, -915.357583292008, 3058.338618689264, -3425.213571403125, -1400.0986339563337, -4484.581488800612, -1750.3093135012755, -3259.6236611251497, 420.0019151577771, -1290.3643592394176, -2340.38769955952, -1806.6912488026517, 3829.2978911639684, -3002.0158190521865, 5512.86468050525, -1740.135803771618, 8075.88347435031, -20.051196570188345, -1536.6680369413557, -2428.092342740687, 4575.963579987639, -1460.28818967848, 3278.4654944110607, -1968.4936377644076, 4247.7141749658695, -947.1791820494459, 1594.0812977815383, -2215.9641522949955, 2859.5562404965785, -2146.279397076418, 4657.037830446833, -883.2891019650762, 5347.44952909431, -324.4346875078317, 2988.2140323940957, -3985.5083144476266], "policy_predator_policy_reward": [3741.9909732083192, 40.6526914915591, 4858.991474332111, 2124.1811389519135, -1239.5239566034584, -337.3919751268159, 1781.9009453776034, 3976.656556961909, 1538.6571953238945, 570.532035926158, 5635.766202304827, 864.2481819983225, -3260.0550524700316, -4895.145004807769, 198.7675753549107, -2635.9061195399668, 6311.9912436212235, 3717.8241112514042, -447.80891908691063, -2701.7845405688668, -2575.6661836796925, 475.9796770421235, 1222.9200734563208, 2529.736373940851, -1567.0131218836855, 2169.8410064178984, -1391.420402042257, -1163.9399639510748, -1225.320351866361, 1458.4528642826365, -1932.9583867471033, -3552.3678891010804, 13133.376807400704, -7432.349612258775, 1734.6059324864184, 2082.6256455574216, 282.0559328868025, -631.262910979808, -6805.965544642745, 4438.944407829502, 1417.1688835106768, 483.41958782257717, 6594.790279579112, 1352.9773719207235, -777.8906707426128, 4022.1775630706356, 228.92139672574714, 4262.5432460891325, 6094.697521367833, 4107.0771029379475, -403.7573907405095, 751.6163930652192, 3362.4934387402054, 1415.9323722432086, 6700.087172040817, 2808.9481472900084, -1048.3857595836423, 947.3895364065509, -4506.402914488835, -3930.7210690020233, 3096.770076224558, 4148.587786446557, 1912.1609626603408, -2651.2681666085346, -2951.3515349144495, -3649.364434410607, 2455.3386063615094, -2631.341719618673, -1339.0276628457555, -5030.631809061468, 2186.2631710117366, 2244.7231643841046, 2252.278606868344, 1289.0928513960935, -761.9974217077715, -1477.49870704535, -1996.3771261111879, 743.4130011194301, 7050.1051504222605, 2409.8777065508248, 1652.8210695543169, 501.08513316278913, 586.1807155172437, 616.3445159012213, -2968.995714699323, 564.1680017909043, 3674.332835506104, -6211.583019783135, 279.3915175936075, 474.96704267234213, 2422.9080756899834, 1692.8286365222557, 3821.9210485954204, 3376.0952897792063, 3094.503994504687, 2519.803594471559, 1577.8196020845944, -2330.570488396567, 1160.6473144793417, -265.9984329806092, 2850.7542311612783, -3429.1914323654632, -668.7002472225292, 1501.219395842783, 1511.5981408411444, -848.6084046942102, -661.8121781164921, 44.45146589615408, 1283.5032594604795, 3097.6961374396224, 3266.5246054804566, -2603.375033828462, 1672.8710808083167, 135.2243014982103, 601.1249490361608, 3012.8810116568375, 649.0985282426897, -1395.6387090873345, 317.510321731301, -3140.4573566119643, -236.34758752473618, -944.5814956855394, 243.86614512264026, -3556.288630382388, 3077.683789199694, 24.919990109172456, 1567.455313666973, 3009.5164558526917, 801.4293982868309, 2232.853132440495, 3654.9817512115187, -6445.146331012346, 1785.4101640793763, 2392.126914113717, 1614.143179266953, 3152.802963928302, -1367.0750127459244, 655.3252060128632, 1785.029641287289, -324.551310339177, -299.3640615985576, 2110.9450099274, 1991.0300180471093, 1546.2345070417134, 1642.3712000764772, -2353.4169326972387, 1860.1914186868034, 565.6761872859985, -933.5784749779722, 1959.7264513614016, 206.5216724821551, 2636.334291808399, -641.1415071751214, 1814.444805317779, -312.92691675131607, 1861.8042355600064, -577.8460277436852, -2520.3044369699282, -1845.538629663313, 553.1257290605537, 1820.3357780272693, 1690.955932016529, 103.83890186446375, 1220.2424121398096, 26.816866361298977, 1349.5427361084464, -408.38587840607534, 1044.213978121032, 2704.2092113904005, 3456.6905628956147, 5569.316452846187, 4320.426229716208, 3780.407715055832, 2970.324858948685, 209.71690718903906, 7130.876436653454, -549.0441686387428, 732.0971684759086, -393.45743546518474, 16.447266804170106, -3644.2395451606794, -4064.17489702248, 6306.949686041754, 1154.1011665558026, -226.97825099345147, -2888.6971393157028, -610.0243687352742, -576.1809585102308, -255.37002301104397, -131.27579314838042, -351.3603737432589, 973.2432282567161, 17.41701145968965, 248.01828173721998, -2757.477359490599, -1016.2713689911624, -1984.887307631973, -3038.1275339545123, 1135.5686156468014, -138.27433359327014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7037466743943628, "mean_inference_ms": 1.5226482857025718, "mean_action_processing_ms": 0.3041074613187261, "mean_env_wait_ms": 0.1356637559315642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300117492675781, "StateBufferConnector_ms": 0.0032194852828979492, "ViewRequirementAgentConnector_ms": 0.1271895170211792}, "num_episodes": 22, "episode_return_max": 12365.027604194163, "episode_return_min": 0.0, "episode_return_mean": 1360.6139789091292, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.6848192680705, "num_env_steps_trained_throughput_per_sec": 278.6848192680705, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 14526.005, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14525.952, "sample_time_ms": 1414.272, "learn_time_ms": 13090.009, "learn_throughput": 305.577, "synch_weights_time_ms": 18.963}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "6751e_00000", "date": "2024-08-11_19-16-57", "timestamp": 1723418217, "time_this_iter_s": 14.436229228973389, "time_total_s": 585.0390219688416, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 585.0390219688416, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 46.85238095238095, "ram_util_percent": 82.64761904761906}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7516825380621763, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.933596166479525, "policy_loss": -0.006171815298379414, "vf_loss": 9.939564073653449, "vf_explained_var": 0.0005112961801902327, "kl": 0.00815610425884555, "entropy": 0.8236498070141626, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8339249843485141, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.129370472923158, "policy_loss": -0.011398329692966645, "vf_loss": 9.138740660652282, "vf_explained_var": 0.000488680916488486, "kl": 0.010140750195168517, "entropy": 0.937878918868524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 5880.37012992288, "episode_reward_min": 0.0, "episode_reward_mean": 1276.0007883536025, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5969.271655813797, "predator_policy": -6445.146331012346}, "policy_reward_max": {"prey_policy": 8324.20595050542, "predator_policy": 7130.876436653454}, "policy_reward_mean": {"prey_policy": -128.26197412611396, "predator_policy": 766.262368302915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1274.9699108997386, 1612.682945498442, 248.69044759184584, 2248.4431410558623, 1831.773946144513, 743.2349054726648, 0.0, 1035.2193000545928, 816.9252832975947, 1.4210854715202004e-14, 2080.7344210651745, 1.4210854715202004e-14, 2520.8007766567157, 2329.398274808168, 595.8607788863309, 603.6534364680565, 2229.618962091599, 271.6020512476258, 469.0044801408794, 109.00003335526047, 713.6837345565579, 331.65075072200756, 2688.113168670032, 126.29795627626743, 1.7763568394002505e-15, 1155.7646524982285, 749.1499584825383, 2555.3756859297855, 868.4786104183256, 2173.5643981117796, 1.5987211554602254e-14, 247.47136163970822, 4477.523759458097, 1617.389389554527, 424.2183168060672, 441.25428333573007, 1328.8971738179969, 697.1789900318572, 106.77964359658634, 126.83841466922959, 1315.0263242935787, 1522.3416908478473, 2247.009801402496, 1462.0461027312224, 131.1630887916748, 1.4210854715202004e-14, 3287.381384496086, 473.1839490185775, 762.4895964691184, 1440.3074362741963, 2448.76850967024, 2249.9475858974683, 146.3346564921696, 119.08262148516619, 0.0, 244.42612896384932, 1179.6967081799655, 2752.625091347455, 1458.1640846493754, 919.3039235511512, 268.9531470010934, 276.2196515290732, 4879.8097079359695, 5880.37012992288, 3193.514395480316, 1010.3350719489453, 3395.718708072613, 347.41783559695716, 3496.290472915508, 0.0, 123.76652940114715, 2913.889176756995, 1.4210854715202004e-14, 978.7121366170719, 0.0, 3.552713678800501e-14, 0.0, 0.0, 1070.8758650847785, 1765.0062098295514, 2646.9914731928243, 1637.8123956326885, 1972.7954597937717, 1709.8291525326727, 735.5602313539578, 1198.1333361402553, 815.1075256406377, 5682.982649416105, 318.0599915536888, 1984.8861624956387, 1332.5027566606236, 2.842170943040401e-14, 2432.6218355120245, 1552.9196063711722, 2151.0339234123576, 1170.838622792216, 1.4210854715202004e-14, 1019.5686510459308, 0.0, 3627.013995848738], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-398.5487087587818, -2817.946023156367, -2619.8200229935433, -5969.271655813797, 2429.159169051006, -2528.327723783876, 21.512940181621474, -2551.4956101091743, -3225.1956033443475, -4452.0657698419645, 3517.979065701987, -2673.747937052227, 6269.562022634613, 2167.561960856246, -3656.3763706454597, -2553.7621919710627, 3719.336303801251, -2163.3038165554617, 6435.002537657539, 165.71343166751598, 3110.7425564945406, -854.0050221722014, 8324.20595050542, -1954.546478598196, -496.9746644482233, -1413.2108942909006, -377.5562549602307, -834.4169284960388, 3004.032948012108, -168.6760403726534, 4827.129999154063, -2970.5124376942513, -3143.6973362388494, -4086.666558642636, 1234.281944821321, -3116.5860962907996, 1688.173141738713, -2421.6938930162983, 2977.929452030002, -464.10170576632373, 8121.090609816071, -4870.156690982476, 370.9541959690712, -793.6620055130126, 3877.30963093594, -5304.933174478146, -2228.3902231375187, -4843.328158960841, -4137.133988087144, -1477.1736008891023, 3913.079966408167, -2004.564427597965, -1006.9985675136335, 861.4996444974386, 6809.865358245714, -3676.052471111739, 1000.194086468107, -964.2346246700366, 2552.665341009887, -1042.090679045042, 2682.466096836736, -2065.105384616397, -1016.7176716572169, -3117.0103636031768, 6069.239395075572, -2254.865207269472, -174.53753755207856, -16.16845519991744, 1620.1685909790385, -4809.956234865967, 1925.7062618535824, -737.911797673206, 3471.2521019575647, 680.5921067410956, 7174.510310294141, -5296.40223705202, 3145.498446422123, 273.7036824342085, -94.86011002420192, -2880.9052546154353, -811.6275879956277, -2450.317857230459, 1162.6143924708003, -2674.555232350278, 7533.532553658209, -2496.358172454886, 1666.578512261849, -4382.069487723721, -1357.89689038944, -3277.8861640141413, 1070.4877215767792, -358.73791484371566, 4109.983973570793, -2283.080920022812, 191.43828651284701, -1529.835285823116, 1037.3497795995797, -3812.1247082192845, 3580.2840446901887, -1428.9308757952333, 1692.7026629151785, -1669.8017592177393, 3601.436287099293, -2377.636677585253, -1831.2210589303609, -865.3002488680261, 1201.2484348286441, -2255.4691114861344, 2915.353296941582, -4464.23061575028, 3657.746739310304, -315.17014563284056, 948.5753298913781, 1523.5342788913483, 1977.8650711219573, -2736.531689818299, 1701.304336720863, -1567.2215660757618, 458.30190437341344, -915.357583292008, 3058.338618689264, -3425.213571403125, -1400.0986339563337, -4484.581488800612, -1750.3093135012755, -3259.6236611251497, 420.0019151577771, -1290.3643592394176, -2340.38769955952, -1806.6912488026517, 3829.2978911639684, -3002.0158190521865, 5512.86468050525, -1740.135803771618, 8075.88347435031, -20.051196570188345, -1536.6680369413557, -2428.092342740687, 4575.963579987639, -1460.28818967848, 3278.4654944110607, -1968.4936377644076, 4247.7141749658695, -947.1791820494459, 1594.0812977815383, -2215.9641522949955, 2859.5562404965785, -2146.279397076418, 4657.037830446833, -883.2891019650762, 5347.44952909431, -324.4346875078317, 2988.2140323940957, -3985.5083144476266, 4856.305615017242, -265.8239488503672, 1486.0670509740294, -4624.720005408784, 2411.6318298867204, -939.9071797569669, 2230.4342344651755, -3883.408345398959, -4031.1027818817524, -2901.3281126307675, 142.96785532714767, -963.3873585385135, 45.46065753203575, -3658.3813290123553, 1515.4584565361288, -5479.327866601579, 1577.2077087730022, -1653.191913228462, 84.52927255764794, -3586.676948222267, 4282.285115068558, -1729.2019217288973, 3396.4432651674892, -949.4349448877003, -572.225169901493, -3237.076415281277, 3801.620662297886, -963.7276003069376, 3080.2009024685076, 2152.736383372603, -5533.288686558392, -2013.6663672989957, 1071.6759520609437, -859.3304548069805, 465.03241314114734, -1791.8592090062007, 2413.1853380117645, -3594.57718634413, 7424.336798566344, -2404.298821145361, 3228.1882858131107, -2946.8385343890213, 15.125695549691379, -881.2250653144926, -2478.5812959761665, -3305.3304685678163], "policy_predator_policy_reward": [228.92139672574714, 4262.5432460891325, 6094.697521367833, 4107.0771029379475, -403.7573907405095, 751.6163930652192, 3362.4934387402054, 1415.9323722432086, 6700.087172040817, 2808.9481472900084, -1048.3857595836423, 947.3895364065509, -4506.402914488835, -3930.7210690020233, 3096.770076224558, 4148.587786446557, 1912.1609626603408, -2651.2681666085346, -2951.3515349144495, -3649.364434410607, 2455.3386063615094, -2631.341719618673, -1339.0276628457555, -5030.631809061468, 2186.2631710117366, 2244.7231643841046, 2252.278606868344, 1289.0928513960935, -761.9974217077715, -1477.49870704535, -1996.3771261111879, 743.4130011194301, 7050.1051504222605, 2409.8777065508248, 1652.8210695543169, 501.08513316278913, 586.1807155172437, 616.3445159012213, -2968.995714699323, 564.1680017909043, 3674.332835506104, -6211.583019783135, 279.3915175936075, 474.96704267234213, 2422.9080756899834, 1692.8286365222557, 3821.9210485954204, 3376.0952897792063, 3094.503994504687, 2519.803594471559, 1577.8196020845944, -2330.570488396567, 1160.6473144793417, -265.9984329806092, 2850.7542311612783, -3429.1914323654632, -668.7002472225292, 1501.219395842783, 1511.5981408411444, -848.6084046942102, -661.8121781164921, 44.45146589615408, 1283.5032594604795, 3097.6961374396224, 3266.5246054804566, -2603.375033828462, 1672.8710808083167, 135.2243014982103, 601.1249490361608, 3012.8810116568375, 649.0985282426897, -1395.6387090873345, 317.510321731301, -3140.4573566119643, -236.34758752473618, -944.5814956855394, 243.86614512264026, -3556.288630382388, 3077.683789199694, 24.919990109172456, 1567.455313666973, 3009.5164558526917, 801.4293982868309, 2232.853132440495, 3654.9817512115187, -6445.146331012346, 1785.4101640793763, 2392.126914113717, 1614.143179266953, 3152.802963928302, -1367.0750127459244, 655.3252060128632, 1785.029641287289, -324.551310339177, -299.3640615985576, 2110.9450099274, 1991.0300180471093, 1546.2345070417134, 1642.3712000764772, -2353.4169326972387, 1860.1914186868034, 565.6761872859985, -933.5784749779722, 1959.7264513614016, 206.5216724821551, 2636.334291808399, -641.1415071751214, 1814.444805317779, -312.92691675131607, 1861.8042355600064, -577.8460277436852, -2520.3044369699282, -1845.538629663313, 553.1257290605537, 1820.3357780272693, 1690.955932016529, 103.83890186446375, 1220.2424121398096, 26.816866361298977, 1349.5427361084464, -408.38587840607534, 1044.213978121032, 2704.2092113904005, 3456.6905628956147, 5569.316452846187, 4320.426229716208, 3780.407715055832, 2970.324858948685, 209.71690718903906, 7130.876436653454, -549.0441686387428, 732.0971684759086, -393.45743546518474, 16.447266804170106, -3644.2395451606794, -4064.17489702248, 6306.949686041754, 1154.1011665558026, -226.97825099345147, -2888.6971393157028, -610.0243687352742, -576.1809585102308, -255.37002301104397, -131.27579314838042, -351.3603737432589, 973.2432282567161, 17.41701145968965, 248.01828173721998, -2757.477359490599, -1016.2713689911624, -1984.887307631973, -3038.1275339545123, 1135.5686156468014, -138.27433359327014, -4736.4760678506245, 145.9944016837533, 1423.3051569696572, 2786.2236625498704, 699.622836327022, -406.3412766272253, 1944.0149915255313, 2355.9505926010775, 5502.853923729525, 3067.3893664156803, 1093.5688458605186, 1699.646117144617, 2827.3195760235853, 2495.430247989405, 2492.067560140864, 2207.3620812785393, 1507.576738025959, -233.45919743024604, -53.8091767039248, 4371.06437800918, 6716.4406377494015, -3586.5411816729675, -1124.7084123787188, -1004.2399163473793, 1792.4806067487991, 4001.707140929609, -1505.3903053303302, 0.0, -2969.449062666237, -2263.4882231748743, 3190.637798913487, 6788.939090455929, 475.39860584834616, 865.1755032688616, 889.4577810358495, 2588.4029382415633, 3243.2180734986755, -890.9876023740998, -6074.72770554709, 1054.6897281261115, -2135.7509566500576, 2873.9698562719022, -145.73642641577783, 1011.8357961805785, 5114.885461902377, 4296.040298490346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7035737384230809, "mean_inference_ms": 1.52378058887745, "mean_action_processing_ms": 0.30186331046355463, "mean_env_wait_ms": 0.13610470273333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004609227180480957, "StateBufferConnector_ms": 0.003253459930419922, "ViewRequirementAgentConnector_ms": 0.11191797256469727}, "num_episodes": 23, "episode_return_max": 5880.37012992288, "episode_return_min": 0.0, "episode_return_mean": 1276.0007883536025, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.994157278707, "num_env_steps_trained_throughput_per_sec": 278.994157278707, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 14539.906, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14539.854, "sample_time_ms": 1402.441, "learn_time_ms": 13115.552, "learn_throughput": 304.981, "synch_weights_time_ms": 19.166}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "6751e_00000", "date": "2024-08-11_19-17-12", "timestamp": 1723418232, "time_this_iter_s": 14.413964033126831, "time_total_s": 599.4529860019684, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaab0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 599.4529860019684, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 46.065, "ram_util_percent": 82.79500000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.65521061261968, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.951785047722872, "policy_loss": -0.006073851574941602, "vf_loss": 9.957692676120335, "vf_explained_var": 0.004902502657875182, "kl": 0.006649637437458136, "entropy": 0.7756048348845628, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7058225796493903, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.520148485678213, "policy_loss": -0.006758964442766257, "vf_loss": 9.525611766936287, "vf_explained_var": 0.00011804800815683193, "kl": 0.006478443452298145, "entropy": 0.8934137895939842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 5880.37012992288, "episode_reward_min": 0.0, "episode_reward_mean": 1376.3195407483424, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6643.909543650132, "predator_policy": -6445.146331012346}, "policy_reward_max": {"prey_policy": 8121.090609816071, "predator_policy": 12190.216144806756}, "policy_reward_mean": {"prey_policy": -54.991007479657036, "predator_policy": 743.1507778538279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [469.0044801408794, 109.00003335526047, 713.6837345565579, 331.65075072200756, 2688.113168670032, 126.29795627626743, 1.7763568394002505e-15, 1155.7646524982285, 749.1499584825383, 2555.3756859297855, 868.4786104183256, 2173.5643981117796, 1.5987211554602254e-14, 247.47136163970822, 4477.523759458097, 1617.389389554527, 424.2183168060672, 441.25428333573007, 1328.8971738179969, 697.1789900318572, 106.77964359658634, 126.83841466922959, 1315.0263242935787, 1522.3416908478473, 2247.009801402496, 1462.0461027312224, 131.1630887916748, 1.4210854715202004e-14, 3287.381384496086, 473.1839490185775, 762.4895964691184, 1440.3074362741963, 2448.76850967024, 2249.9475858974683, 146.3346564921696, 119.08262148516619, 0.0, 244.42612896384932, 1179.6967081799655, 2752.625091347455, 1458.1640846493754, 919.3039235511512, 268.9531470010934, 276.2196515290732, 4879.8097079359695, 5880.37012992288, 3193.514395480316, 1010.3350719489453, 3395.718708072613, 347.41783559695716, 3496.290472915508, 0.0, 123.76652940114715, 2913.889176756995, 1.4210854715202004e-14, 978.7121366170719, 0.0, 3.552713678800501e-14, 0.0, 0.0, 1070.8758650847785, 1765.0062098295514, 2646.9914731928243, 1637.8123956326885, 1972.7954597937717, 1709.8291525326727, 735.5602313539578, 1198.1333361402553, 815.1075256406377, 5682.982649416105, 318.0599915536888, 1984.8861624956387, 1332.5027566606236, 2.842170943040401e-14, 2432.6218355120245, 1552.9196063711722, 2151.0339234123576, 1170.838622792216, 1.4210854715202004e-14, 1019.5686510459308, 0.0, 3627.013995848738, 4309.118664717007, 1311.1130818822332, 2196.5176462881072, 2.842170943040401e-14, 2406.224788507217, 104.07007158914152, 1191.4247084758995, 1623.0346673421932, 562.7302536511048, 1600.815946444422, 2263.387584665563, 122.62203766981823, 106.08726877994383, 4411.271090839773, 2081.661862472878, 2760.399583111886, 1728.245276420013, 1696.759287855728], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1688.173141738713, -2421.6938930162983, 2977.929452030002, -464.10170576632373, 8121.090609816071, -4870.156690982476, 370.9541959690712, -793.6620055130126, 3877.30963093594, -5304.933174478146, -2228.3902231375187, -4843.328158960841, -4137.133988087144, -1477.1736008891023, 3913.079966408167, -2004.564427597965, -1006.9985675136335, 861.4996444974386, 6809.865358245714, -3676.052471111739, 1000.194086468107, -964.2346246700366, 2552.665341009887, -1042.090679045042, 2682.466096836736, -2065.105384616397, -1016.7176716572169, -3117.0103636031768, 6069.239395075572, -2254.865207269472, -174.53753755207856, -16.16845519991744, 1620.1685909790385, -4809.956234865967, 1925.7062618535824, -737.911797673206, 3471.2521019575647, 680.5921067410956, 7174.510310294141, -5296.40223705202, 3145.498446422123, 273.7036824342085, -94.86011002420192, -2880.9052546154353, -811.6275879956277, -2450.317857230459, 1162.6143924708003, -2674.555232350278, 7533.532553658209, -2496.358172454886, 1666.578512261849, -4382.069487723721, -1357.89689038944, -3277.8861640141413, 1070.4877215767792, -358.73791484371566, 4109.983973570793, -2283.080920022812, 191.43828651284701, -1529.835285823116, 1037.3497795995797, -3812.1247082192845, 3580.2840446901887, -1428.9308757952333, 1692.7026629151785, -1669.8017592177393, 3601.436287099293, -2377.636677585253, -1831.2210589303609, -865.3002488680261, 1201.2484348286441, -2255.4691114861344, 2915.353296941582, -4464.23061575028, 3657.746739310304, -315.17014563284056, 948.5753298913781, 1523.5342788913483, 1977.8650711219573, -2736.531689818299, 1701.304336720863, -1567.2215660757618, 458.30190437341344, -915.357583292008, 3058.338618689264, -3425.213571403125, -1400.0986339563337, -4484.581488800612, -1750.3093135012755, -3259.6236611251497, 420.0019151577771, -1290.3643592394176, -2340.38769955952, -1806.6912488026517, 3829.2978911639684, -3002.0158190521865, 5512.86468050525, -1740.135803771618, 8075.88347435031, -20.051196570188345, -1536.6680369413557, -2428.092342740687, 4575.963579987639, -1460.28818967848, 3278.4654944110607, -1968.4936377644076, 4247.7141749658695, -947.1791820494459, 1594.0812977815383, -2215.9641522949955, 2859.5562404965785, -2146.279397076418, 4657.037830446833, -883.2891019650762, 5347.44952909431, -324.4346875078317, 2988.2140323940957, -3985.5083144476266, 4856.305615017242, -265.8239488503672, 1486.0670509740294, -4624.720005408784, 2411.6318298867204, -939.9071797569669, 2230.4342344651755, -3883.408345398959, -4031.1027818817524, -2901.3281126307675, 142.96785532714767, -963.3873585385135, 45.46065753203575, -3658.3813290123553, 1515.4584565361288, -5479.327866601579, 1577.2077087730022, -1653.191913228462, 84.52927255764794, -3586.676948222267, 4282.285115068558, -1729.2019217288973, 3396.4432651674892, -949.4349448877003, -572.225169901493, -3237.076415281277, 3801.620662297886, -963.7276003069376, 3080.2009024685076, 2152.736383372603, -5533.288686558392, -2013.6663672989957, 1071.6759520609437, -859.3304548069805, 465.03241314114734, -1791.8592090062007, 2413.1853380117645, -3594.57718634413, 7424.336798566344, -2404.298821145361, 3228.1882858131107, -2946.8385343890213, 15.125695549691379, -881.2250653144926, -2478.5812959761665, -3305.3304685678163, 3027.741964432694, -1139.0257872246898, 801.9014367905023, -1094.5559729379743, 2051.118022180706, -3929.5414278875614, 5927.673362708055, -246.74418886042125, 4496.2577986093165, -2955.063087845474, 7179.807529390573, -1917.2158185153776, 2097.842998016054, 926.2272168566853, 3050.7275574368487, -416.05671503143776, 3779.816756341816, -916.3066383336906, 3788.9234195993827, -4299.368093869687, 2099.8485491097185, -3732.8196906388416, 4099.6685838247895, -1486.752059290666, 3069.046487334143, 889.358899785478, 119.68226135728654, -769.5267479953709, -373.82035511574276, -5375.911668779704, 6715.918824298059, -1749.9210134780355, -5672.991803062228, -6643.909543650132, -2240.2675289868434, -4308.059512968657], "policy_predator_policy_reward": [586.1807155172437, 616.3445159012213, -2968.995714699323, 564.1680017909043, 3674.332835506104, -6211.583019783135, 279.3915175936075, 474.96704267234213, 2422.9080756899834, 1692.8286365222557, 3821.9210485954204, 3376.0952897792063, 3094.503994504687, 2519.803594471559, 1577.8196020845944, -2330.570488396567, 1160.6473144793417, -265.9984329806092, 2850.7542311612783, -3429.1914323654632, -668.7002472225292, 1501.219395842783, 1511.5981408411444, -848.6084046942102, -661.8121781164921, 44.45146589615408, 1283.5032594604795, 3097.6961374396224, 3266.5246054804566, -2603.375033828462, 1672.8710808083167, 135.2243014982103, 601.1249490361608, 3012.8810116568375, 649.0985282426897, -1395.6387090873345, 317.510321731301, -3140.4573566119643, -236.34758752473618, -944.5814956855394, 243.86614512264026, -3556.288630382388, 3077.683789199694, 24.919990109172456, 1567.455313666973, 3009.5164558526917, 801.4293982868309, 2232.853132440495, 3654.9817512115187, -6445.146331012346, 1785.4101640793763, 2392.126914113717, 1614.143179266953, 3152.802963928302, -1367.0750127459244, 655.3252060128632, 1785.029641287289, -324.551310339177, -299.3640615985576, 2110.9450099274, 1991.0300180471093, 1546.2345070417134, 1642.3712000764772, -2353.4169326972387, 1860.1914186868034, 565.6761872859985, -933.5784749779722, 1959.7264513614016, 206.5216724821551, 2636.334291808399, -641.1415071751214, 1814.444805317779, -312.92691675131607, 1861.8042355600064, -577.8460277436852, -2520.3044369699282, -1845.538629663313, 553.1257290605537, 1820.3357780272693, 1690.955932016529, 103.83890186446375, 1220.2424121398096, 26.816866361298977, 1349.5427361084464, -408.38587840607534, 1044.213978121032, 2704.2092113904005, 3456.6905628956147, 5569.316452846187, 4320.426229716208, 3780.407715055832, 2970.324858948685, 209.71690718903906, 7130.876436653454, -549.0441686387428, 732.0971684759086, -393.45743546518474, 16.447266804170106, -3644.2395451606794, -4064.17489702248, 6306.949686041754, 1154.1011665558026, -226.97825099345147, -2888.6971393157028, -610.0243687352742, -576.1809585102308, -255.37002301104397, -131.27579314838042, -351.3603737432589, 973.2432282567161, 17.41701145968965, 248.01828173721998, -2757.477359490599, -1016.2713689911624, -1984.887307631973, -3038.1275339545123, 1135.5686156468014, -138.27433359327014, -4736.4760678506245, 145.9944016837533, 1423.3051569696572, 2786.2236625498704, 699.622836327022, -406.3412766272253, 1944.0149915255313, 2355.9505926010775, 5502.853923729525, 3067.3893664156803, 1093.5688458605186, 1699.646117144617, 2827.3195760235853, 2495.430247989405, 2492.067560140864, 2207.3620812785393, 1507.576738025959, -233.45919743024604, -53.8091767039248, 4371.06437800918, 6716.4406377494015, -3586.5411816729675, -1124.7084123787188, -1004.2399163473793, 1792.4806067487991, 4001.707140929609, -1505.3903053303302, 0.0, -2969.449062666237, -2263.4882231748743, 3190.637798913487, 6788.939090455929, 475.39860584834616, 865.1755032688616, 889.4577810358495, 2588.4029382415633, 3243.2180734986755, -890.9876023740998, -6074.72770554709, 1054.6897281261115, -2135.7509566500576, 2873.9698562719022, -145.73642641577783, 1011.8357961805785, 5114.885461902377, 4296.040298490346, 1290.8729321475532, 1129.5295553614442, 1464.7770811810308, 138.99053684867556, 2666.528599131984, 1408.412452862978, -613.6915918970784, -5067.2375819505605, 704.0416924396884, 160.98838530368639, -5316.211907164065, 157.69026787801172, -461.3120873637476, -1371.3334190330934, 558.7629515471206, -1570.3991266103426, -2014.1501898128704, -286.62967454415156, 1337.87400302265, 773.3866176920749, 1270.7874736101917, 2625.5712525844883, -2490.294486864309, 0.0, -2723.022845941059, -1129.2952723986193, 4901.024594913046, 160.09098256481613, 6502.618594988064, 1328.7752913802583, -288.18218731198897, -1917.416040396156, 12190.216144806756, 1854.9304783256307, 4669.611178951524, 3575.4751508596983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7029639437128788, "mean_inference_ms": 1.5204453757250973, "mean_action_processing_ms": 0.30254109780941246, "mean_env_wait_ms": 0.1360106116136732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048340559005737305, "StateBufferConnector_ms": 0.003327608108520508, "ViewRequirementAgentConnector_ms": 0.10601139068603516}, "num_episodes": 18, "episode_return_max": 5880.37012992288, "episode_return_min": 0.0, "episode_return_mean": 1376.3195407483424, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.5904220805312, "num_env_steps_trained_throughput_per_sec": 280.5904220805312, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 14518.63, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14518.574, "sample_time_ms": 1409.204, "learn_time_ms": 13087.033, "learn_throughput": 305.646, "synch_weights_time_ms": 19.768}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "6751e_00000", "date": "2024-08-11_19-17-26", "timestamp": 1723418246, "time_this_iter_s": 14.328058958053589, "time_total_s": 613.781044960022, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaabf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 613.781044960022, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 46.73809523809524, "ram_util_percent": 82.90000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.602178503541404, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.940511615188033, "policy_loss": -0.008034350558568442, "vf_loss": 9.948240381069285, "vf_explained_var": -0.0030831938698178247, "kl": 0.012224326618499858, "entropy": 0.732524110936614, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.740640600774654, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.446838101886568, "policy_loss": -0.007712019771761286, "vf_loss": 9.453227453887777, "vf_explained_var": 0.00014862064962033872, "kl": 0.006613290175644794, "entropy": 0.8913162474909787, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 5880.37012992288, "episode_reward_min": 0.0, "episode_reward_mean": 1529.0992803488948, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6643.909543650132, "predator_policy": -6445.146331012346}, "policy_reward_max": {"prey_policy": 8075.88347435031, "predator_policy": 12190.216144806756}, "policy_reward_mean": {"prey_policy": -31.236941615951, "predator_policy": 795.786581790398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1328.8971738179969, 697.1789900318572, 106.77964359658634, 126.83841466922959, 1315.0263242935787, 1522.3416908478473, 2247.009801402496, 1462.0461027312224, 131.1630887916748, 1.4210854715202004e-14, 3287.381384496086, 473.1839490185775, 762.4895964691184, 1440.3074362741963, 2448.76850967024, 2249.9475858974683, 146.3346564921696, 119.08262148516619, 0.0, 244.42612896384932, 1179.6967081799655, 2752.625091347455, 1458.1640846493754, 919.3039235511512, 268.9531470010934, 276.2196515290732, 4879.8097079359695, 5880.37012992288, 3193.514395480316, 1010.3350719489453, 3395.718708072613, 347.41783559695716, 3496.290472915508, 0.0, 123.76652940114715, 2913.889176756995, 1.4210854715202004e-14, 978.7121366170719, 0.0, 3.552713678800501e-14, 0.0, 0.0, 1070.8758650847785, 1765.0062098295514, 2646.9914731928243, 1637.8123956326885, 1972.7954597937717, 1709.8291525326727, 735.5602313539578, 1198.1333361402553, 815.1075256406377, 5682.982649416105, 318.0599915536888, 1984.8861624956387, 1332.5027566606236, 2.842170943040401e-14, 2432.6218355120245, 1552.9196063711722, 2151.0339234123576, 1170.838622792216, 1.4210854715202004e-14, 1019.5686510459308, 0.0, 3627.013995848738, 4309.118664717007, 1311.1130818822332, 2196.5176462881072, 2.842170943040401e-14, 2406.224788507217, 104.07007158914152, 1191.4247084758995, 1623.0346673421932, 562.7302536511048, 1600.815946444422, 2263.387584665563, 122.62203766981823, 106.08726877994383, 4411.271090839773, 2081.661862472878, 2760.399583111886, 1728.245276420013, 1696.759287855728, 4217.183642041279, 5527.34925140205, 454.4729582553865, 1541.801260947974, 1393.8584360296406, 131.85686431508938, 5836.6416087721345, 1298.871813430803, 759.7326278989344, 1037.3894489552188, 375.1622848394353, 4955.016478502381, 1618.4775076193237, 212.51649015865058, 1091.211416678836, 558.6041757559536, 111.40493817134129, 3304.3632962366073], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3471.2521019575647, 680.5921067410956, 7174.510310294141, -5296.40223705202, 3145.498446422123, 273.7036824342085, -94.86011002420192, -2880.9052546154353, -811.6275879956277, -2450.317857230459, 1162.6143924708003, -2674.555232350278, 7533.532553658209, -2496.358172454886, 1666.578512261849, -4382.069487723721, -1357.89689038944, -3277.8861640141413, 1070.4877215767792, -358.73791484371566, 4109.983973570793, -2283.080920022812, 191.43828651284701, -1529.835285823116, 1037.3497795995797, -3812.1247082192845, 3580.2840446901887, -1428.9308757952333, 1692.7026629151785, -1669.8017592177393, 3601.436287099293, -2377.636677585253, -1831.2210589303609, -865.3002488680261, 1201.2484348286441, -2255.4691114861344, 2915.353296941582, -4464.23061575028, 3657.746739310304, -315.17014563284056, 948.5753298913781, 1523.5342788913483, 1977.8650711219573, -2736.531689818299, 1701.304336720863, -1567.2215660757618, 458.30190437341344, -915.357583292008, 3058.338618689264, -3425.213571403125, -1400.0986339563337, -4484.581488800612, -1750.3093135012755, -3259.6236611251497, 420.0019151577771, -1290.3643592394176, -2340.38769955952, -1806.6912488026517, 3829.2978911639684, -3002.0158190521865, 5512.86468050525, -1740.135803771618, 8075.88347435031, -20.051196570188345, -1536.6680369413557, -2428.092342740687, 4575.963579987639, -1460.28818967848, 3278.4654944110607, -1968.4936377644076, 4247.7141749658695, -947.1791820494459, 1594.0812977815383, -2215.9641522949955, 2859.5562404965785, -2146.279397076418, 4657.037830446833, -883.2891019650762, 5347.44952909431, -324.4346875078317, 2988.2140323940957, -3985.5083144476266, 4856.305615017242, -265.8239488503672, 1486.0670509740294, -4624.720005408784, 2411.6318298867204, -939.9071797569669, 2230.4342344651755, -3883.408345398959, -4031.1027818817524, -2901.3281126307675, 142.96785532714767, -963.3873585385135, 45.46065753203575, -3658.3813290123553, 1515.4584565361288, -5479.327866601579, 1577.2077087730022, -1653.191913228462, 84.52927255764794, -3586.676948222267, 4282.285115068558, -1729.2019217288973, 3396.4432651674892, -949.4349448877003, -572.225169901493, -3237.076415281277, 3801.620662297886, -963.7276003069376, 3080.2009024685076, 2152.736383372603, -5533.288686558392, -2013.6663672989957, 1071.6759520609437, -859.3304548069805, 465.03241314114734, -1791.8592090062007, 2413.1853380117645, -3594.57718634413, 7424.336798566344, -2404.298821145361, 3228.1882858131107, -2946.8385343890213, 15.125695549691379, -881.2250653144926, -2478.5812959761665, -3305.3304685678163, 3027.741964432694, -1139.0257872246898, 801.9014367905023, -1094.5559729379743, 2051.118022180706, -3929.5414278875614, 5927.673362708055, -246.74418886042125, 4496.2577986093165, -2955.063087845474, 7179.807529390573, -1917.2158185153776, 2097.842998016054, 926.2272168566853, 3050.7275574368487, -416.05671503143776, 3779.816756341816, -916.3066383336906, 3788.9234195993827, -4299.368093869687, 2099.8485491097185, -3732.8196906388416, 4099.6685838247895, -1486.752059290666, 3069.046487334143, 889.358899785478, 119.68226135728654, -769.5267479953709, -373.82035511574276, -5375.911668779704, 6715.918824298059, -1749.9210134780355, -5672.991803062228, -6643.909543650132, -2240.2675289868434, -4308.059512968657, 5486.7246946242, -2952.827737800214, -1771.0881749742134, -4441.272802541781, 2800.1290593093486, 591.5205734205216, 4934.659910344922, -677.90695157451, 1507.5182779942277, -4960.810489067486, 4669.092759490836, -3298.614422327247, -1757.056195341645, -400.105212890652, 6938.292611905805, -949.4641430430271, 4073.3707031787326, -1976.8864143036985, 2015.5814790472025, -1296.6412139748734, 295.7585110690423, -4464.266226942505, 5499.9325185621265, -1600.3793101190336, -3660.3300706400087, -935.838662589883, -797.682850989456, -535.8578258522181, 1149.482484081559, -3587.644880030406, 1926.8523912494588, 86.73555248404233, 1807.5667725792016, -346.47126374023384, -1306.9828280791278, -2270.72254112047], "policy_predator_policy_reward": [317.510321731301, -3140.4573566119643, -236.34758752473618, -944.5814956855394, 243.86614512264026, -3556.288630382388, 3077.683789199694, 24.919990109172456, 1567.455313666973, 3009.5164558526917, 801.4293982868309, 2232.853132440495, 3654.9817512115187, -6445.146331012346, 1785.4101640793763, 2392.126914113717, 1614.143179266953, 3152.802963928302, -1367.0750127459244, 655.3252060128632, 1785.029641287289, -324.551310339177, -299.3640615985576, 2110.9450099274, 1991.0300180471093, 1546.2345070417134, 1642.3712000764772, -2353.4169326972387, 1860.1914186868034, 565.6761872859985, -933.5784749779722, 1959.7264513614016, 206.5216724821551, 2636.334291808399, -641.1415071751214, 1814.444805317779, -312.92691675131607, 1861.8042355600064, -577.8460277436852, -2520.3044369699282, -1845.538629663313, 553.1257290605537, 1820.3357780272693, 1690.955932016529, 103.83890186446375, 1220.2424121398096, 26.816866361298977, 1349.5427361084464, -408.38587840607534, 1044.213978121032, 2704.2092113904005, 3456.6905628956147, 5569.316452846187, 4320.426229716208, 3780.407715055832, 2970.324858948685, 209.71690718903906, 7130.876436653454, -549.0441686387428, 732.0971684759086, -393.45743546518474, 16.447266804170106, -3644.2395451606794, -4064.17489702248, 6306.949686041754, 1154.1011665558026, -226.97825099345147, -2888.6971393157028, -610.0243687352742, -576.1809585102308, -255.37002301104397, -131.27579314838042, -351.3603737432589, 973.2432282567161, 17.41701145968965, 248.01828173721998, -2757.477359490599, -1016.2713689911624, -1984.887307631973, -3038.1275339545123, 1135.5686156468014, -138.27433359327014, -4736.4760678506245, 145.9944016837533, 1423.3051569696572, 2786.2236625498704, 699.622836327022, -406.3412766272253, 1944.0149915255313, 2355.9505926010775, 5502.853923729525, 3067.3893664156803, 1093.5688458605186, 1699.646117144617, 2827.3195760235853, 2495.430247989405, 2492.067560140864, 2207.3620812785393, 1507.576738025959, -233.45919743024604, -53.8091767039248, 4371.06437800918, 6716.4406377494015, -3586.5411816729675, -1124.7084123787188, -1004.2399163473793, 1792.4806067487991, 4001.707140929609, -1505.3903053303302, 0.0, -2969.449062666237, -2263.4882231748743, 3190.637798913487, 6788.939090455929, 475.39860584834616, 865.1755032688616, 889.4577810358495, 2588.4029382415633, 3243.2180734986755, -890.9876023740998, -6074.72770554709, 1054.6897281261115, -2135.7509566500576, 2873.9698562719022, -145.73642641577783, 1011.8357961805785, 5114.885461902377, 4296.040298490346, 1290.8729321475532, 1129.5295553614442, 1464.7770811810308, 138.99053684867556, 2666.528599131984, 1408.412452862978, -613.6915918970784, -5067.2375819505605, 704.0416924396884, 160.98838530368639, -5316.211907164065, 157.69026787801172, -461.3120873637476, -1371.3334190330934, 558.7629515471206, -1570.3991266103426, -2014.1501898128704, -286.62967454415156, 1337.87400302265, 773.3866176920749, 1270.7874736101917, 2625.5712525844883, -2490.294486864309, 0.0, -2723.022845941059, -1129.2952723986193, 4901.024594913046, 160.09098256481613, 6502.618594988064, 1328.7752913802583, -288.18218731198897, -1917.416040396156, 12190.216144806756, 1854.9304783256307, 4669.611178951524, 3575.4751508596983, 3035.5945089185434, -1352.3078237012364, 3609.24474192402, 8130.465486994024, -2569.2905868053545, -367.88608766913035, -26.1630038602647, -2688.7886939621753, 3761.168815845469, 1085.981831257428, 1492.8435541887707, -2731.4650270372745, 6235.7739646113205, 1758.0290523931128, 1439.3637575661048, -6129.3204129980895, 219.41153775923794, -1556.1631987353385, 587.6534536476192, -269.2042697647298, 2016.3522326384243, 2527.317768074472, 3719.38749983727, -2663.924229777974, 5086.247237414597, 1128.3990034346132, -1312.7980953334502, 2858.8552623337755, 2459.6912793092447, 1069.6825333184388, -1688.2015971799492, 233.21782920240022, 1263.847064277583, -2613.537634945204, 2572.317911423051, 4309.750754013147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7021564680029513, "mean_inference_ms": 1.5189358957705001, "mean_action_processing_ms": 0.30184759768707814, "mean_env_wait_ms": 0.1359685523534428, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004653334617614746, "StateBufferConnector_ms": 0.0033682584762573242, "ViewRequirementAgentConnector_ms": 0.10630154609680176}, "num_episodes": 18, "episode_return_max": 5880.37012992288, "episode_return_min": 0.0, "episode_return_mean": 1529.0992803488948, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.9273089652947, "num_env_steps_trained_throughput_per_sec": 291.9273089652947, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 14437.681, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14437.625, "sample_time_ms": 1384.791, "learn_time_ms": 13030.189, "learn_throughput": 306.979, "synch_weights_time_ms": 20.069}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "6751e_00000", "date": "2024-08-11_19-17-40", "timestamp": 1723418260, "time_this_iter_s": 13.759884119033813, "time_total_s": 627.5409290790558, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 627.5409290790558, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 42.39473684210526, "ram_util_percent": 83.15263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.696713896143058, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.95426521906777, "policy_loss": -0.005103886859225375, "vf_loss": 9.959204705051643, "vf_explained_var": 0.005632856220164627, "kl": 0.006575512455823737, "entropy": 0.7266471705108724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7777130446894459, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.24854886090314, "policy_loss": -0.0104779651575776, "vf_loss": 9.257300213909653, "vf_explained_var": 0.0008332146853996963, "kl": 0.008633076528085384, "entropy": 0.8510395978178297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 5880.37012992288, "episode_reward_min": 0.0, "episode_reward_mean": 1519.5332772915247, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6643.909543650132, "predator_policy": -6129.3204129980895}, "policy_reward_max": {"prey_policy": 8075.88347435031, "predator_policy": 12190.216144806756}, "policy_reward_mean": {"prey_policy": -29.487799160227677, "predator_policy": 789.2544378059897}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 244.42612896384932, 1179.6967081799655, 2752.625091347455, 1458.1640846493754, 919.3039235511512, 268.9531470010934, 276.2196515290732, 4879.8097079359695, 5880.37012992288, 3193.514395480316, 1010.3350719489453, 3395.718708072613, 347.41783559695716, 3496.290472915508, 0.0, 123.76652940114715, 2913.889176756995, 1.4210854715202004e-14, 978.7121366170719, 0.0, 3.552713678800501e-14, 0.0, 0.0, 1070.8758650847785, 1765.0062098295514, 2646.9914731928243, 1637.8123956326885, 1972.7954597937717, 1709.8291525326727, 735.5602313539578, 1198.1333361402553, 815.1075256406377, 5682.982649416105, 318.0599915536888, 1984.8861624956387, 1332.5027566606236, 2.842170943040401e-14, 2432.6218355120245, 1552.9196063711722, 2151.0339234123576, 1170.838622792216, 1.4210854715202004e-14, 1019.5686510459308, 0.0, 3627.013995848738, 4309.118664717007, 1311.1130818822332, 2196.5176462881072, 2.842170943040401e-14, 2406.224788507217, 104.07007158914152, 1191.4247084758995, 1623.0346673421932, 562.7302536511048, 1600.815946444422, 2263.387584665563, 122.62203766981823, 106.08726877994383, 4411.271090839773, 2081.661862472878, 2760.399583111886, 1728.245276420013, 1696.759287855728, 4217.183642041279, 5527.34925140205, 454.4729582553865, 1541.801260947974, 1393.8584360296406, 131.85686431508938, 5836.6416087721345, 1298.871813430803, 759.7326278989344, 1037.3894489552188, 375.1622848394353, 4955.016478502381, 1618.4775076193237, 212.51649015865058, 1091.211416678836, 558.6041757559536, 111.40493817134129, 3304.3632962366073, 959.3177986645585, 2.1316282072803006e-14, 1663.5356278358904, 319.7740910947815, 1098.7082431552917, 817.1550843786304, 1768.2733943548224, 0.0, 1756.9190417688587, 3338.520061639812, 1529.526248648669, 1647.6757688142698, 1779.3809243415526, 112.77617321421786, 925.120340845689, 819.9239942695043, 112.57783064815314, 258.99204057377176], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2915.353296941582, -4464.23061575028, 3657.746739310304, -315.17014563284056, 948.5753298913781, 1523.5342788913483, 1977.8650711219573, -2736.531689818299, 1701.304336720863, -1567.2215660757618, 458.30190437341344, -915.357583292008, 3058.338618689264, -3425.213571403125, -1400.0986339563337, -4484.581488800612, -1750.3093135012755, -3259.6236611251497, 420.0019151577771, -1290.3643592394176, -2340.38769955952, -1806.6912488026517, 3829.2978911639684, -3002.0158190521865, 5512.86468050525, -1740.135803771618, 8075.88347435031, -20.051196570188345, -1536.6680369413557, -2428.092342740687, 4575.963579987639, -1460.28818967848, 3278.4654944110607, -1968.4936377644076, 4247.7141749658695, -947.1791820494459, 1594.0812977815383, -2215.9641522949955, 2859.5562404965785, -2146.279397076418, 4657.037830446833, -883.2891019650762, 5347.44952909431, -324.4346875078317, 2988.2140323940957, -3985.5083144476266, 4856.305615017242, -265.8239488503672, 1486.0670509740294, -4624.720005408784, 2411.6318298867204, -939.9071797569669, 2230.4342344651755, -3883.408345398959, -4031.1027818817524, -2901.3281126307675, 142.96785532714767, -963.3873585385135, 45.46065753203575, -3658.3813290123553, 1515.4584565361288, -5479.327866601579, 1577.2077087730022, -1653.191913228462, 84.52927255764794, -3586.676948222267, 4282.285115068558, -1729.2019217288973, 3396.4432651674892, -949.4349448877003, -572.225169901493, -3237.076415281277, 3801.620662297886, -963.7276003069376, 3080.2009024685076, 2152.736383372603, -5533.288686558392, -2013.6663672989957, 1071.6759520609437, -859.3304548069805, 465.03241314114734, -1791.8592090062007, 2413.1853380117645, -3594.57718634413, 7424.336798566344, -2404.298821145361, 3228.1882858131107, -2946.8385343890213, 15.125695549691379, -881.2250653144926, -2478.5812959761665, -3305.3304685678163, 3027.741964432694, -1139.0257872246898, 801.9014367905023, -1094.5559729379743, 2051.118022180706, -3929.5414278875614, 5927.673362708055, -246.74418886042125, 4496.2577986093165, -2955.063087845474, 7179.807529390573, -1917.2158185153776, 2097.842998016054, 926.2272168566853, 3050.7275574368487, -416.05671503143776, 3779.816756341816, -916.3066383336906, 3788.9234195993827, -4299.368093869687, 2099.8485491097185, -3732.8196906388416, 4099.6685838247895, -1486.752059290666, 3069.046487334143, 889.358899785478, 119.68226135728654, -769.5267479953709, -373.82035511574276, -5375.911668779704, 6715.918824298059, -1749.9210134780355, -5672.991803062228, -6643.909543650132, -2240.2675289868434, -4308.059512968657, 5486.7246946242, -2952.827737800214, -1771.0881749742134, -4441.272802541781, 2800.1290593093486, 591.5205734205216, 4934.659910344922, -677.90695157451, 1507.5182779942277, -4960.810489067486, 4669.092759490836, -3298.614422327247, -1757.056195341645, -400.105212890652, 6938.292611905805, -949.4641430430271, 4073.3707031787326, -1976.8864143036985, 2015.5814790472025, -1296.6412139748734, 295.7585110690423, -4464.266226942505, 5499.9325185621265, -1600.3793101190336, -3660.3300706400087, -935.838662589883, -797.682850989456, -535.8578258522181, 1149.482484081559, -3587.644880030406, 1926.8523912494588, 86.73555248404233, 1807.5667725792016, -346.47126374023384, -1306.9828280791278, -2270.72254112047, 1578.9397071058472, -5038.510921884186, 2406.2422415023098, -304.01019922811287, -504.41135850380783, -4257.910873249647, 2099.877348858223, 1579.4491901380752, -856.5432773278724, 425.9422157665446, 4199.673687326639, -1135.215792589582, -81.78874382598569, -1762.2710257854098, 5144.152248028506, -6203.577042059657, 7418.793610514209, -1474.0886522993621, -3790.379008705154, -1639.2309541109375, 4364.922604235426, -4656.406093048177, 387.2076873109382, 405.84357132957905, -1564.0127048781674, -1494.8658361367557, 4483.837582347696, -740.0952943255894, 888.9746518872594, -2485.0638260231603, 6293.225103700785, -3847.5962401583097, 2790.7971354396896, -3270.374640484123, -848.9813815251197, -704.5204858065541], "policy_predator_policy_reward": [-312.92691675131607, 1861.8042355600064, -577.8460277436852, -2520.3044369699282, -1845.538629663313, 553.1257290605537, 1820.3357780272693, 1690.955932016529, 103.83890186446375, 1220.2424121398096, 26.816866361298977, 1349.5427361084464, -408.38587840607534, 1044.213978121032, 2704.2092113904005, 3456.6905628956147, 5569.316452846187, 4320.426229716208, 3780.407715055832, 2970.324858948685, 209.71690718903906, 7130.876436653454, -549.0441686387428, 732.0971684759086, -393.45743546518474, 16.447266804170106, -3644.2395451606794, -4064.17489702248, 6306.949686041754, 1154.1011665558026, -226.97825099345147, -2888.6971393157028, -610.0243687352742, -576.1809585102308, -255.37002301104397, -131.27579314838042, -351.3603737432589, 973.2432282567161, 17.41701145968965, 248.01828173721998, -2757.477359490599, -1016.2713689911624, -1984.887307631973, -3038.1275339545123, 1135.5686156468014, -138.27433359327014, -4736.4760678506245, 145.9944016837533, 1423.3051569696572, 2786.2236625498704, 699.622836327022, -406.3412766272253, 1944.0149915255313, 2355.9505926010775, 5502.853923729525, 3067.3893664156803, 1093.5688458605186, 1699.646117144617, 2827.3195760235853, 2495.430247989405, 2492.067560140864, 2207.3620812785393, 1507.576738025959, -233.45919743024604, -53.8091767039248, 4371.06437800918, 6716.4406377494015, -3586.5411816729675, -1124.7084123787188, -1004.2399163473793, 1792.4806067487991, 4001.707140929609, -1505.3903053303302, 0.0, -2969.449062666237, -2263.4882231748743, 3190.637798913487, 6788.939090455929, 475.39860584834616, 865.1755032688616, 889.4577810358495, 2588.4029382415633, 3243.2180734986755, -890.9876023740998, -6074.72770554709, 1054.6897281261115, -2135.7509566500576, 2873.9698562719022, -145.73642641577783, 1011.8357961805785, 5114.885461902377, 4296.040298490346, 1290.8729321475532, 1129.5295553614442, 1464.7770811810308, 138.99053684867556, 2666.528599131984, 1408.412452862978, -613.6915918970784, -5067.2375819505605, 704.0416924396884, 160.98838530368639, -5316.211907164065, 157.69026787801172, -461.3120873637476, -1371.3334190330934, 558.7629515471206, -1570.3991266103426, -2014.1501898128704, -286.62967454415156, 1337.87400302265, 773.3866176920749, 1270.7874736101917, 2625.5712525844883, -2490.294486864309, 0.0, -2723.022845941059, -1129.2952723986193, 4901.024594913046, 160.09098256481613, 6502.618594988064, 1328.7752913802583, -288.18218731198897, -1917.416040396156, 12190.216144806756, 1854.9304783256307, 4669.611178951524, 3575.4751508596983, 3035.5945089185434, -1352.3078237012364, 3609.24474192402, 8130.465486994024, -2569.2905868053545, -367.88608766913035, -26.1630038602647, -2688.7886939621753, 3761.168815845469, 1085.981831257428, 1492.8435541887707, -2731.4650270372745, 6235.7739646113205, 1758.0290523931128, 1439.3637575661048, -6129.3204129980895, 219.41153775923794, -1556.1631987353385, 587.6534536476192, -269.2042697647298, 2016.3522326384243, 2527.317768074472, 3719.38749983727, -2663.924229777974, 5086.247237414597, 1128.3990034346132, -1312.7980953334502, 2858.8552623337755, 2459.6912793092447, 1069.6825333184388, -1688.2015971799492, 233.21782920240022, 1263.847064277583, -2613.537634945204, 2572.317911423051, 4309.750754013147, 3720.286317888872, 698.6026955540312, -1876.5894388461686, -225.64260342802967, 2873.4656365368164, 3552.392223052528, -3170.2933400956936, -189.2591078058239, 814.2432524465463, 715.066052270074, -2383.583663052951, 136.28085269452393, 3929.551194658833, -317.21803069261745, 2377.9056138575256, -1318.4808198263702, -93.62587509752713, -4094.160041348462, 5884.655898957783, 2883.4741254981236, 113.68890368303994, 1707.3208337783794, 1624.5423651185263, -769.9178549447762, 2371.174397615652, 2467.085067740827, 202.05708680354027, -3833.0232016114296, 3653.977934679922, -1132.768419698334, 1358.8305100436226, -2984.53537931659, -311.56444466931544, 903.719780361902, 2377.4081272584835, -564.914219353038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7028292929714675, "mean_inference_ms": 1.5206667661051647, "mean_action_processing_ms": 0.30164877206252777, "mean_env_wait_ms": 0.13605955690636495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004765510559082031, "StateBufferConnector_ms": 0.005210280418395996, "ViewRequirementAgentConnector_ms": 0.1253136396408081}, "num_episodes": 18, "episode_return_max": 5880.37012992288, "episode_return_min": 0.0, "episode_return_mean": 1519.5332772915247, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.8789303908259, "num_env_steps_trained_throughput_per_sec": 274.8789303908259, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 14456.111, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14456.055, "sample_time_ms": 1408.157, "learn_time_ms": 13022.754, "learn_throughput": 307.155, "synch_weights_time_ms": 22.584}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "6751e_00000", "date": "2024-08-11_19-17-55", "timestamp": 1723418275, "time_this_iter_s": 14.631949186325073, "time_total_s": 642.1728782653809, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 642.1728782653809, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 47.71428571428572, "ram_util_percent": 83.21904761904763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6411147015277671, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.96029011509406, "policy_loss": -0.005810782499364996, "vf_loss": 9.96585632354494, "vf_explained_var": 0.005770628445993656, "kl": 0.009782605117345189, "entropy": 0.7421337128000915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7671795756413192, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.378828754122296, "policy_loss": -0.008093586722980179, "vf_loss": 9.385579570891364, "vf_explained_var": 0.0006046804170759898, "kl": 0.0067138737097501965, "entropy": 0.8379954188273697, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 5836.6416087721345, "episode_reward_min": 0.0, "episode_reward_mean": 1492.6221727585462, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6643.909543650132, "predator_policy": -6129.3204129980895}, "policy_reward_max": {"prey_policy": 7424.336798566344, "predator_policy": 12190.216144806756}, "policy_reward_mean": {"prey_policy": -23.18270241978087, "predator_policy": 769.4937887990536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 0.0, 1070.8758650847785, 1765.0062098295514, 2646.9914731928243, 1637.8123956326885, 1972.7954597937717, 1709.8291525326727, 735.5602313539578, 1198.1333361402553, 815.1075256406377, 5682.982649416105, 318.0599915536888, 1984.8861624956387, 1332.5027566606236, 2.842170943040401e-14, 2432.6218355120245, 1552.9196063711722, 2151.0339234123576, 1170.838622792216, 1.4210854715202004e-14, 1019.5686510459308, 0.0, 3627.013995848738, 4309.118664717007, 1311.1130818822332, 2196.5176462881072, 2.842170943040401e-14, 2406.224788507217, 104.07007158914152, 1191.4247084758995, 1623.0346673421932, 562.7302536511048, 1600.815946444422, 2263.387584665563, 122.62203766981823, 106.08726877994383, 4411.271090839773, 2081.661862472878, 2760.399583111886, 1728.245276420013, 1696.759287855728, 4217.183642041279, 5527.34925140205, 454.4729582553865, 1541.801260947974, 1393.8584360296406, 131.85686431508938, 5836.6416087721345, 1298.871813430803, 759.7326278989344, 1037.3894489552188, 375.1622848394353, 4955.016478502381, 1618.4775076193237, 212.51649015865058, 1091.211416678836, 558.6041757559536, 111.40493817134129, 3304.3632962366073, 959.3177986645585, 2.1316282072803006e-14, 1663.5356278358904, 319.7740910947815, 1098.7082431552917, 817.1550843786304, 1768.2733943548224, 0.0, 1756.9190417688587, 3338.520061639812, 1529.526248648669, 1647.6757688142698, 1779.3809243415526, 112.77617321421786, 925.120340845689, 819.9239942695043, 112.57783064815314, 258.99204057377176, 2488.0936058317725, 586.3663139116744, 5305.603878842715, 284.5258675000015, 1030.0606354967595, 123.78783545538265, 364.1710536665109, 2112.1801955354376, 556.5825308981211, 913.9186032385157, 2310.303580743424, 644.5651756308263, 119.83661834793878, 2035.4957536110367, 432.7932228241544, 7.105427357601002e-15, 644.2802029003544, 3349.0672326498843, 928.5650179517625, 1192.5067304517224, 1220.7289853035616, 3984.6694057809846], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2988.2140323940957, -3985.5083144476266, 4856.305615017242, -265.8239488503672, 1486.0670509740294, -4624.720005408784, 2411.6318298867204, -939.9071797569669, 2230.4342344651755, -3883.408345398959, -4031.1027818817524, -2901.3281126307675, 142.96785532714767, -963.3873585385135, 45.46065753203575, -3658.3813290123553, 1515.4584565361288, -5479.327866601579, 1577.2077087730022, -1653.191913228462, 84.52927255764794, -3586.676948222267, 4282.285115068558, -1729.2019217288973, 3396.4432651674892, -949.4349448877003, -572.225169901493, -3237.076415281277, 3801.620662297886, -963.7276003069376, 3080.2009024685076, 2152.736383372603, -5533.288686558392, -2013.6663672989957, 1071.6759520609437, -859.3304548069805, 465.03241314114734, -1791.8592090062007, 2413.1853380117645, -3594.57718634413, 7424.336798566344, -2404.298821145361, 3228.1882858131107, -2946.8385343890213, 15.125695549691379, -881.2250653144926, -2478.5812959761665, -3305.3304685678163, 3027.741964432694, -1139.0257872246898, 801.9014367905023, -1094.5559729379743, 2051.118022180706, -3929.5414278875614, 5927.673362708055, -246.74418886042125, 4496.2577986093165, -2955.063087845474, 7179.807529390573, -1917.2158185153776, 2097.842998016054, 926.2272168566853, 3050.7275574368487, -416.05671503143776, 3779.816756341816, -916.3066383336906, 3788.9234195993827, -4299.368093869687, 2099.8485491097185, -3732.8196906388416, 4099.6685838247895, -1486.752059290666, 3069.046487334143, 889.358899785478, 119.68226135728654, -769.5267479953709, -373.82035511574276, -5375.911668779704, 6715.918824298059, -1749.9210134780355, -5672.991803062228, -6643.909543650132, -2240.2675289868434, -4308.059512968657, 5486.7246946242, -2952.827737800214, -1771.0881749742134, -4441.272802541781, 2800.1290593093486, 591.5205734205216, 4934.659910344922, -677.90695157451, 1507.5182779942277, -4960.810489067486, 4669.092759490836, -3298.614422327247, -1757.056195341645, -400.105212890652, 6938.292611905805, -949.4641430430271, 4073.3707031787326, -1976.8864143036985, 2015.5814790472025, -1296.6412139748734, 295.7585110690423, -4464.266226942505, 5499.9325185621265, -1600.3793101190336, -3660.3300706400087, -935.838662589883, -797.682850989456, -535.8578258522181, 1149.482484081559, -3587.644880030406, 1926.8523912494588, 86.73555248404233, 1807.5667725792016, -346.47126374023384, -1306.9828280791278, -2270.72254112047, 1578.9397071058472, -5038.510921884186, 2406.2422415023098, -304.01019922811287, -504.41135850380783, -4257.910873249647, 2099.877348858223, 1579.4491901380752, -856.5432773278724, 425.9422157665446, 4199.673687326639, -1135.215792589582, -81.78874382598569, -1762.2710257854098, 5144.152248028506, -6203.577042059657, 7418.793610514209, -1474.0886522993621, -3790.379008705154, -1639.2309541109375, 4364.922604235426, -4656.406093048177, 387.2076873109382, 405.84357132957905, -1564.0127048781674, -1494.8658361367557, 4483.837582347696, -740.0952943255894, 888.9746518872594, -2485.0638260231603, 6293.225103700785, -3847.5962401583097, 2790.7971354396896, -3270.374640484123, -848.9813815251197, -704.5204858065541, -440.94391127884967, -2667.561281629475, 7408.570661550246, -1523.860803702206, 4710.343315870206, -2923.464561711173, 1184.6880991958433, -3268.307907170644, 2151.178866364077, -1970.3628488166626, 6188.029647960248, 486.5974442828883, 5539.66914127773, -1919.079883514431, -812.2266826392352, -2150.1286612730178, 4838.656239755494, -1730.8037604313172, 4911.186492335527, -3362.8712617551064, 3712.195538418038, 54.01414008780766, 2743.151041685805, -3228.298539290029, 1700.047044156222, -1626.9423392199062, 6081.906865416309, -4218.005085062473, 1502.6472179346902, -644.2291339860049, 3526.343172367483, -472.2714205934051, 694.0728739886922, -3389.3516334457972, -4051.283785094118, -1539.939353064358, -4744.923116069604, -1244.4914642868546, 4528.930684617877, -2255.6969465462885, 676.7481860452422, -3329.857120637575, 4071.748509849494, 275.85822607926457], "policy_predator_policy_reward": [1135.5686156468014, -138.27433359327014, -4736.4760678506245, 145.9944016837533, 1423.3051569696572, 2786.2236625498704, 699.622836327022, -406.3412766272253, 1944.0149915255313, 2355.9505926010775, 5502.853923729525, 3067.3893664156803, 1093.5688458605186, 1699.646117144617, 2827.3195760235853, 2495.430247989405, 2492.067560140864, 2207.3620812785393, 1507.576738025959, -233.45919743024604, -53.8091767039248, 4371.06437800918, 6716.4406377494015, -3586.5411816729675, -1124.7084123787188, -1004.2399163473793, 1792.4806067487991, 4001.707140929609, -1505.3903053303302, 0.0, -2969.449062666237, -2263.4882231748743, 3190.637798913487, 6788.939090455929, 475.39860584834616, 865.1755032688616, 889.4577810358495, 2588.4029382415633, 3243.2180734986755, -890.9876023740998, -6074.72770554709, 1054.6897281261115, -2135.7509566500576, 2873.9698562719022, -145.73642641577783, 1011.8357961805785, 5114.885461902377, 4296.040298490346, 1290.8729321475532, 1129.5295553614442, 1464.7770811810308, 138.99053684867556, 2666.528599131984, 1408.412452862978, -613.6915918970784, -5067.2375819505605, 704.0416924396884, 160.98838530368639, -5316.211907164065, 157.69026787801172, -461.3120873637476, -1371.3334190330934, 558.7629515471206, -1570.3991266103426, -2014.1501898128704, -286.62967454415156, 1337.87400302265, 773.3866176920749, 1270.7874736101917, 2625.5712525844883, -2490.294486864309, 0.0, -2723.022845941059, -1129.2952723986193, 4901.024594913046, 160.09098256481613, 6502.618594988064, 1328.7752913802583, -288.18218731198897, -1917.416040396156, 12190.216144806756, 1854.9304783256307, 4669.611178951524, 3575.4751508596983, 3035.5945089185434, -1352.3078237012364, 3609.24474192402, 8130.465486994024, -2569.2905868053545, -367.88608766913035, -26.1630038602647, -2688.7886939621753, 3761.168815845469, 1085.981831257428, 1492.8435541887707, -2731.4650270372745, 6235.7739646113205, 1758.0290523931128, 1439.3637575661048, -6129.3204129980895, 219.41153775923794, -1556.1631987353385, 587.6534536476192, -269.2042697647298, 2016.3522326384243, 2527.317768074472, 3719.38749983727, -2663.924229777974, 5086.247237414597, 1128.3990034346132, -1312.7980953334502, 2858.8552623337755, 2459.6912793092447, 1069.6825333184388, -1688.2015971799492, 233.21782920240022, 1263.847064277583, -2613.537634945204, 2572.317911423051, 4309.750754013147, 3720.286317888872, 698.6026955540312, -1876.5894388461686, -225.64260342802967, 2873.4656365368164, 3552.392223052528, -3170.2933400956936, -189.2591078058239, 814.2432524465463, 715.066052270074, -2383.583663052951, 136.28085269452393, 3929.551194658833, -317.21803069261745, 2377.9056138575256, -1318.4808198263702, -93.62587509752713, -4094.160041348462, 5884.655898957783, 2883.4741254981236, 113.68890368303994, 1707.3208337783794, 1624.5423651185263, -769.9178549447762, 2371.174397615652, 2467.085067740827, 202.05708680354027, -3833.0232016114296, 3653.977934679922, -1132.768419698334, 1358.8305100436226, -2984.53537931659, -311.56444466931544, 903.719780361902, 2377.4081272584835, -564.914219353038, 3783.1451611353878, 1813.4536376047056, -5329.83617639369, 31.49263245732788, -1358.9867334977203, 4877.711858181398, -220.89638856106248, 2589.042064035866, 2360.218430021995, -1510.9738120726508, -5648.62704750574, -902.2122092820098, 1012.7157283268538, -4269.133932423649, 2901.8052537769477, 2172.7302856707397, 394.2258819347875, -2945.4958303608378, -2197.265502387805, 1562.8688750458994, 1320.4548722953996, -2776.360970057821, -1659.588616666119, 2789.301289901172, 590.4106609824529, -543.678747570828, -1467.282065676521, 1638.876038933719, -840.9945962708935, 415.36973514636395, -524.0167767814132, -2530.054974992664, 1537.113838463843, 1802.4451238936135, 6318.514821210501, 2621.7755495978613, 3244.919556170497, 3673.0600421377217, -2975.860643130245, 1895.1336355103758, -695.7735196096914, 4569.611439505587, -3664.746915941418, 3301.8095857936423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7046862280648415, "mean_inference_ms": 1.5248945073988744, "mean_action_processing_ms": 0.30214518383428685, "mean_env_wait_ms": 0.13635213525560708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056455135345458984, "StateBufferConnector_ms": 0.005214095115661621, "ViewRequirementAgentConnector_ms": 0.13891661167144775}, "num_episodes": 22, "episode_return_max": 5836.6416087721345, "episode_return_min": 0.0, "episode_return_mean": 1492.6221727585462, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.0954409725822, "num_env_steps_trained_throughput_per_sec": 270.0954409725822, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 14396.796, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14396.74, "sample_time_ms": 1381.579, "learn_time_ms": 12994.139, "learn_throughput": 307.831, "synch_weights_time_ms": 19.961}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "6751e_00000", "date": "2024-08-11_19-18-10", "timestamp": 1723418290, "time_this_iter_s": 14.880327939987183, "time_total_s": 657.053206205368, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea975e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 657.053206205368, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 46.166666666666664, "ram_util_percent": 83.04285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5901414126709655, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.955074990489495, "policy_loss": -0.0062558423722823145, "vf_loss": 9.961102888319228, "vf_explained_var": 0.0021853553870367624, "kl": 0.009118761543372779, "entropy": 0.6560672479962546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7267816812036529, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.54243098364936, "policy_loss": -0.006904834742465662, "vf_loss": 9.547751305595277, "vf_explained_var": 0.00047584305364618856, "kl": 0.007922508677543998, "entropy": 0.7841537087051956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 5836.6416087721345, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 1504.5074242731068, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6643.909543650132, "predator_policy": -7518.392711530943}, "policy_reward_max": {"prey_policy": 7418.793610514209, "predator_policy": 12190.216144806756}, "policy_reward_mean": {"prey_policy": 80.12317637695195, "predator_policy": 672.1305357596013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3627.013995848738, 4309.118664717007, 1311.1130818822332, 2196.5176462881072, 2.842170943040401e-14, 2406.224788507217, 104.07007158914152, 1191.4247084758995, 1623.0346673421932, 562.7302536511048, 1600.815946444422, 2263.387584665563, 122.62203766981823, 106.08726877994383, 4411.271090839773, 2081.661862472878, 2760.399583111886, 1728.245276420013, 1696.759287855728, 4217.183642041279, 5527.34925140205, 454.4729582553865, 1541.801260947974, 1393.8584360296406, 131.85686431508938, 5836.6416087721345, 1298.871813430803, 759.7326278989344, 1037.3894489552188, 375.1622848394353, 4955.016478502381, 1618.4775076193237, 212.51649015865058, 1091.211416678836, 558.6041757559536, 111.40493817134129, 3304.3632962366073, 959.3177986645585, 2.1316282072803006e-14, 1663.5356278358904, 319.7740910947815, 1098.7082431552917, 817.1550843786304, 1768.2733943548224, 0.0, 1756.9190417688587, 3338.520061639812, 1529.526248648669, 1647.6757688142698, 1779.3809243415526, 112.77617321421786, 925.120340845689, 819.9239942695043, 112.57783064815314, 258.99204057377176, 2488.0936058317725, 586.3663139116744, 5305.603878842715, 284.5258675000015, 1030.0606354967595, 123.78783545538265, 364.1710536665109, 2112.1801955354376, 556.5825308981211, 913.9186032385157, 2310.303580743424, 644.5651756308263, 119.83661834793878, 2035.4957536110367, 432.7932228241544, 7.105427357601002e-15, 644.2802029003544, 3349.0672326498843, 928.5650179517625, 1192.5067304517224, 1220.7289853035616, 3984.6694057809846, 1289.4116553176627, 720.0249969737793, 0.0, 974.2218879747852, 1250.7562025729032, -2.842170943040401e-14, 126.16166629769478, 2752.934494534409, 655.0554562634586, 1237.1636422560778, 3719.6377491560975, 2943.0596690832913, 3490.5009873317, 1628.7159805670894, 560.0174006138388, 120.89172183131926, 4005.4065553788882, 1323.1983934278874, 239.29976967885946, 1736.1492108610848, 1756.2265991763059, 1857.216960619826, 7.105427357601002e-15], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2478.5812959761665, -3305.3304685678163, 3027.741964432694, -1139.0257872246898, 801.9014367905023, -1094.5559729379743, 2051.118022180706, -3929.5414278875614, 5927.673362708055, -246.74418886042125, 4496.2577986093165, -2955.063087845474, 7179.807529390573, -1917.2158185153776, 2097.842998016054, 926.2272168566853, 3050.7275574368487, -416.05671503143776, 3779.816756341816, -916.3066383336906, 3788.9234195993827, -4299.368093869687, 2099.8485491097185, -3732.8196906388416, 4099.6685838247895, -1486.752059290666, 3069.046487334143, 889.358899785478, 119.68226135728654, -769.5267479953709, -373.82035511574276, -5375.911668779704, 6715.918824298059, -1749.9210134780355, -5672.991803062228, -6643.909543650132, -2240.2675289868434, -4308.059512968657, 5486.7246946242, -2952.827737800214, -1771.0881749742134, -4441.272802541781, 2800.1290593093486, 591.5205734205216, 4934.659910344922, -677.90695157451, 1507.5182779942277, -4960.810489067486, 4669.092759490836, -3298.614422327247, -1757.056195341645, -400.105212890652, 6938.292611905805, -949.4641430430271, 4073.3707031787326, -1976.8864143036985, 2015.5814790472025, -1296.6412139748734, 295.7585110690423, -4464.266226942505, 5499.9325185621265, -1600.3793101190336, -3660.3300706400087, -935.838662589883, -797.682850989456, -535.8578258522181, 1149.482484081559, -3587.644880030406, 1926.8523912494588, 86.73555248404233, 1807.5667725792016, -346.47126374023384, -1306.9828280791278, -2270.72254112047, 1578.9397071058472, -5038.510921884186, 2406.2422415023098, -304.01019922811287, -504.41135850380783, -4257.910873249647, 2099.877348858223, 1579.4491901380752, -856.5432773278724, 425.9422157665446, 4199.673687326639, -1135.215792589582, -81.78874382598569, -1762.2710257854098, 5144.152248028506, -6203.577042059657, 7418.793610514209, -1474.0886522993621, -3790.379008705154, -1639.2309541109375, 4364.922604235426, -4656.406093048177, 387.2076873109382, 405.84357132957905, -1564.0127048781674, -1494.8658361367557, 4483.837582347696, -740.0952943255894, 888.9746518872594, -2485.0638260231603, 6293.225103700785, -3847.5962401583097, 2790.7971354396896, -3270.374640484123, -848.9813815251197, -704.5204858065541, -440.94391127884967, -2667.561281629475, 7408.570661550246, -1523.860803702206, 4710.343315870206, -2923.464561711173, 1184.6880991958433, -3268.307907170644, 2151.178866364077, -1970.3628488166626, 6188.029647960248, 486.5974442828883, 5539.66914127773, -1919.079883514431, -812.2266826392352, -2150.1286612730178, 4838.656239755494, -1730.8037604313172, 4911.186492335527, -3362.8712617551064, 3712.195538418038, 54.01414008780766, 2743.151041685805, -3228.298539290029, 1700.047044156222, -1626.9423392199062, 6081.906865416309, -4218.005085062473, 1502.6472179346902, -644.2291339860049, 3526.343172367483, -472.2714205934051, 694.0728739886922, -3389.3516334457972, -4051.283785094118, -1539.939353064358, -4744.923116069604, -1244.4914642868546, 4528.930684617877, -2255.6969465462885, 676.7481860452422, -3329.857120637575, 4071.748509849494, 275.85822607926457, 4189.006502845541, 574.8215645467811, 2575.016223757946, -1597.1555116925404, 6651.275991599807, -4801.209910406936, -3947.2602533270006, -1156.6462790357793, -840.9680706153449, -2754.5866441119124, 6211.971039342455, 139.704800036204, 3675.552730146435, -3718.9268046124002, 1488.145288684367, 245.44988961272932, 6457.099781691019, -5293.623199791587, 5880.0310789756895, -339.2211207902297, -1488.82287154752, -4552.346332240395, -1557.3761880816653, -1301.021728544011, 2722.125771334808, -2213.2336078316484, 1155.187348231928, -2266.1150735130395, 3387.233972122324, -322.1341155125109, 2432.8561358180955, -2075.621675474235, -1689.1609479227398, -2926.3651097979437, 2274.748041965514, -3309.3993753139493, 2103.1351074465283, -1117.37549687023, 1028.816580166572, -3262.4190178534996, -1270.1966026623754, -2079.779929555223, 1524.2067497798566, -513.510389121376, 5034.274693897278, 2524.5857676037585], "policy_predator_policy_reward": [5114.885461902377, 4296.040298490346, 1290.8729321475532, 1129.5295553614442, 1464.7770811810308, 138.99053684867556, 2666.528599131984, 1408.412452862978, -613.6915918970784, -5067.2375819505605, 704.0416924396884, 160.98838530368639, -5316.211907164065, 157.69026787801172, -461.3120873637476, -1371.3334190330934, 558.7629515471206, -1570.3991266103426, -2014.1501898128704, -286.62967454415156, 1337.87400302265, 773.3866176920749, 1270.7874736101917, 2625.5712525844883, -2490.294486864309, 0.0, -2723.022845941059, -1129.2952723986193, 4901.024594913046, 160.09098256481613, 6502.618594988064, 1328.7752913802583, -288.18218731198897, -1917.416040396156, 12190.216144806756, 1854.9304783256307, 4669.611178951524, 3575.4751508596983, 3035.5945089185434, -1352.3078237012364, 3609.24474192402, 8130.465486994024, -2569.2905868053545, -367.88608766913035, -26.1630038602647, -2688.7886939621753, 3761.168815845469, 1085.981831257428, 1492.8435541887707, -2731.4650270372745, 6235.7739646113205, 1758.0290523931128, 1439.3637575661048, -6129.3204129980895, 219.41153775923794, -1556.1631987353385, 587.6534536476192, -269.2042697647298, 2016.3522326384243, 2527.317768074472, 3719.38749983727, -2663.924229777974, 5086.247237414597, 1128.3990034346132, -1312.7980953334502, 2858.8552623337755, 2459.6912793092447, 1069.6825333184388, -1688.2015971799492, 233.21782920240022, 1263.847064277583, -2613.537634945204, 2572.317911423051, 4309.750754013147, 3720.286317888872, 698.6026955540312, -1876.5894388461686, -225.64260342802967, 2873.4656365368164, 3552.392223052528, -3170.2933400956936, -189.2591078058239, 814.2432524465463, 715.066052270074, -2383.583663052951, 136.28085269452393, 3929.551194658833, -317.21803069261745, 2377.9056138575256, -1318.4808198263702, -93.62587509752713, -4094.160041348462, 5884.655898957783, 2883.4741254981236, 113.68890368303994, 1707.3208337783794, 1624.5423651185263, -769.9178549447762, 2371.174397615652, 2467.085067740827, 202.05708680354027, -3833.0232016114296, 3653.977934679922, -1132.768419698334, 1358.8305100436226, -2984.53537931659, -311.56444466931544, 903.719780361902, 2377.4081272584835, -564.914219353038, 3783.1451611353878, 1813.4536376047056, -5329.83617639369, 31.49263245732788, -1358.9867334977203, 4877.711858181398, -220.89638856106248, 2589.042064035866, 2360.218430021995, -1510.9738120726508, -5648.62704750574, -902.2122092820098, 1012.7157283268538, -4269.133932423649, 2901.8052537769477, 2172.7302856707397, 394.2258819347875, -2945.4958303608378, -2197.265502387805, 1562.8688750458994, 1320.4548722953996, -2776.360970057821, -1659.588616666119, 2789.301289901172, 590.4106609824529, -543.678747570828, -1467.282065676521, 1638.876038933719, -840.9945962708935, 415.36973514636395, -524.0167767814132, -2530.054974992664, 1537.113838463843, 1802.4451238936135, 6318.514821210501, 2621.7755495978613, 3244.919556170497, 3673.0600421377217, -2975.860643130245, 1895.1336355103758, -695.7735196096914, 4569.611439505587, -3664.746915941418, 3301.8095857936423, -766.375745881117, -2708.040666193538, -337.73931754840197, 79.9036024567779, 754.9743922316447, -2605.040473424517, 1960.4426505418364, 4117.685769795729, 5526.638559151839, -680.3276418516798, -6146.614156663639, -205.06168271501977, -1278.385212124519, 1447.9209528881786, 1876.2648095758084, -856.925493338496, -2535.431461992005, 2027.0103363559988, -3571.8626537835917, -731.7836621457956, 5038.201025627395, 4722.605927316609, 4739.230083329321, 1062.2275023796603, 1863.2397550563066, 1118.3690687722333, -198.21929734361052, 2937.863003191816, -982.3280614592552, -1522.7543945367163, 460.363071028138, -696.7058095406788, 3899.311721279265, 4721.620891820309, 455.27213059042487, 1902.5775961858994, -204.37373218889377, -542.0861087085459, 597.1194483060577, 3372.632200241958, 3343.117429668551, 1763.0857017253527, 912.6797376152983, -66.1591376539532, -7518.392711530943, -40.46774997009203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7078174189636159, "mean_inference_ms": 1.5327419217504323, "mean_action_processing_ms": 0.303288948226694, "mean_env_wait_ms": 0.13686506531334144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005455374717712402, "StateBufferConnector_ms": 0.005003213882446289, "ViewRequirementAgentConnector_ms": 0.13468384742736816}, "num_episodes": 23, "episode_return_max": 5836.6416087721345, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 1504.5074242731068, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.8415127188335, "num_env_steps_trained_throughput_per_sec": 271.8415127188335, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 14330.983, "restore_workers_time_ms": 0.017, "training_step_time_ms": 14330.927, "sample_time_ms": 1333.619, "learn_time_ms": 12976.558, "learn_throughput": 308.248, "synch_weights_time_ms": 19.791}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "6751e_00000", "date": "2024-08-11_19-18-24", "timestamp": 1723418304, "time_this_iter_s": 14.762451171875, "time_total_s": 671.815657377243, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16e9bc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 671.815657377243, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.81904761904762, "ram_util_percent": 83.16190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6291041073029634, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.942419671760033, "policy_loss": -0.0079966854615748, "vf_loss": 9.950050950933386, "vf_explained_var": 0.0010253540737919075, "kl": 0.014615952632004972, "entropy": 0.731865643004261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7379983822820048, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.21089848261031, "policy_loss": -0.008349419857261987, "vf_loss": 9.217765507370077, "vf_explained_var": 0.0004823246330180496, "kl": 0.007411997011608566, "entropy": 0.8126651113941556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 11875.459443525433, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 1633.49606843941, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6203.577042059657, "predator_policy": -7518.392711530943}, "policy_reward_max": {"prey_policy": 7418.793610514209, "predator_policy": 8175.092435366448}, "policy_reward_mean": {"prey_policy": 89.91216895840734, "predator_policy": 726.8358652612977}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1696.759287855728, 4217.183642041279, 5527.34925140205, 454.4729582553865, 1541.801260947974, 1393.8584360296406, 131.85686431508938, 5836.6416087721345, 1298.871813430803, 759.7326278989344, 1037.3894489552188, 375.1622848394353, 4955.016478502381, 1618.4775076193237, 212.51649015865058, 1091.211416678836, 558.6041757559536, 111.40493817134129, 3304.3632962366073, 959.3177986645585, 2.1316282072803006e-14, 1663.5356278358904, 319.7740910947815, 1098.7082431552917, 817.1550843786304, 1768.2733943548224, 0.0, 1756.9190417688587, 3338.520061639812, 1529.526248648669, 1647.6757688142698, 1779.3809243415526, 112.77617321421786, 925.120340845689, 819.9239942695043, 112.57783064815314, 258.99204057377176, 2488.0936058317725, 586.3663139116744, 5305.603878842715, 284.5258675000015, 1030.0606354967595, 123.78783545538265, 364.1710536665109, 2112.1801955354376, 556.5825308981211, 913.9186032385157, 2310.303580743424, 644.5651756308263, 119.83661834793878, 2035.4957536110367, 432.7932228241544, 7.105427357601002e-15, 644.2802029003544, 3349.0672326498843, 928.5650179517625, 1192.5067304517224, 1220.7289853035616, 3984.6694057809846, 1289.4116553176627, 720.0249969737793, 0.0, 974.2218879747852, 1250.7562025729032, -2.842170943040401e-14, 126.16166629769478, 2752.934494534409, 655.0554562634586, 1237.1636422560778, 3719.6377491560975, 2943.0596690832913, 3490.5009873317, 1628.7159805670894, 560.0174006138388, 120.89172183131926, 4005.4065553788882, 1323.1983934278874, 239.29976967885946, 1736.1492108610848, 1756.2265991763059, 1857.216960619826, 7.105427357601002e-15, 2056.7684336159546, 0.0, 0.0, 3607.1630437799977, 4827.723072088396, 882.171356484416, 11875.459443525433, 2816.9188404867054, 2185.24745157243, 2034.5615724750762, 4279.717230649265, 1561.0249830278153, 124.25060247537927, 0.0, 1627.7460712504708, 1616.46615915651, 746.1235445108638, 5063.2611402375305], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2240.2675289868434, -4308.059512968657, 5486.7246946242, -2952.827737800214, -1771.0881749742134, -4441.272802541781, 2800.1290593093486, 591.5205734205216, 4934.659910344922, -677.90695157451, 1507.5182779942277, -4960.810489067486, 4669.092759490836, -3298.614422327247, -1757.056195341645, -400.105212890652, 6938.292611905805, -949.4641430430271, 4073.3707031787326, -1976.8864143036985, 2015.5814790472025, -1296.6412139748734, 295.7585110690423, -4464.266226942505, 5499.9325185621265, -1600.3793101190336, -3660.3300706400087, -935.838662589883, -797.682850989456, -535.8578258522181, 1149.482484081559, -3587.644880030406, 1926.8523912494588, 86.73555248404233, 1807.5667725792016, -346.47126374023384, -1306.9828280791278, -2270.72254112047, 1578.9397071058472, -5038.510921884186, 2406.2422415023098, -304.01019922811287, -504.41135850380783, -4257.910873249647, 2099.877348858223, 1579.4491901380752, -856.5432773278724, 425.9422157665446, 4199.673687326639, -1135.215792589582, -81.78874382598569, -1762.2710257854098, 5144.152248028506, -6203.577042059657, 7418.793610514209, -1474.0886522993621, -3790.379008705154, -1639.2309541109375, 4364.922604235426, -4656.406093048177, 387.2076873109382, 405.84357132957905, -1564.0127048781674, -1494.8658361367557, 4483.837582347696, -740.0952943255894, 888.9746518872594, -2485.0638260231603, 6293.225103700785, -3847.5962401583097, 2790.7971354396896, -3270.374640484123, -848.9813815251197, -704.5204858065541, -440.94391127884967, -2667.561281629475, 7408.570661550246, -1523.860803702206, 4710.343315870206, -2923.464561711173, 1184.6880991958433, -3268.307907170644, 2151.178866364077, -1970.3628488166626, 6188.029647960248, 486.5974442828883, 5539.66914127773, -1919.079883514431, -812.2266826392352, -2150.1286612730178, 4838.656239755494, -1730.8037604313172, 4911.186492335527, -3362.8712617551064, 3712.195538418038, 54.01414008780766, 2743.151041685805, -3228.298539290029, 1700.047044156222, -1626.9423392199062, 6081.906865416309, -4218.005085062473, 1502.6472179346902, -644.2291339860049, 3526.343172367483, -472.2714205934051, 694.0728739886922, -3389.3516334457972, -4051.283785094118, -1539.939353064358, -4744.923116069604, -1244.4914642868546, 4528.930684617877, -2255.6969465462885, 676.7481860452422, -3329.857120637575, 4071.748509849494, 275.85822607926457, 4189.006502845541, 574.8215645467811, 2575.016223757946, -1597.1555116925404, 6651.275991599807, -4801.209910406936, -3947.2602533270006, -1156.6462790357793, -840.9680706153449, -2754.5866441119124, 6211.971039342455, 139.704800036204, 3675.552730146435, -3718.9268046124002, 1488.145288684367, 245.44988961272932, 6457.099781691019, -5293.623199791587, 5880.0310789756895, -339.2211207902297, -1488.82287154752, -4552.346332240395, -1557.3761880816653, -1301.021728544011, 2722.125771334808, -2213.2336078316484, 1155.187348231928, -2266.1150735130395, 3387.233972122324, -322.1341155125109, 2432.8561358180955, -2075.621675474235, -1689.1609479227398, -2926.3651097979437, 2274.748041965514, -3309.3993753139493, 2103.1351074465283, -1117.37549687023, 1028.816580166572, -3262.4190178534996, -1270.1966026623754, -2079.779929555223, 1524.2067497798566, -513.510389121376, 5034.274693897278, 2524.5857676037585, 1177.802588363325, -2944.6198724940746, 3934.3230694590525, -3545.3055361506, 3279.9396679297383, -2168.322022527228, 2329.2096755967536, -4160.344526358177, 932.6170308269318, -619.263513448003, 3567.743195162442, -2204.1135664586022, 1935.5267620623254, -502.5812415391455, -339.2597590347102, -2802.020321909465, 6658.685953768498, -488.61289175486667, 4191.058283286998, -2630.0131827443706, -631.3772715408785, -4781.6038462496535, 6426.568289636877, 720.0360745563721, 2790.179868653436, -2088.2150854562174, 5326.770290044805, -1284.028700707774, 4086.9115965761894, 375.04838424462076, 3080.6396535629833, -3154.502919520315, -498.01829622869116, -3976.5333266350763, -1552.190803724473, -2866.215891946858], "policy_predator_policy_reward": [4669.611178951524, 3575.4751508596983, 3035.5945089185434, -1352.3078237012364, 3609.24474192402, 8130.465486994024, -2569.2905868053545, -367.88608766913035, -26.1630038602647, -2688.7886939621753, 3761.168815845469, 1085.981831257428, 1492.8435541887707, -2731.4650270372745, 6235.7739646113205, 1758.0290523931128, 1439.3637575661048, -6129.3204129980895, 219.41153775923794, -1556.1631987353385, 587.6534536476192, -269.2042697647298, 2016.3522326384243, 2527.317768074472, 3719.38749983727, -2663.924229777974, 5086.247237414597, 1128.3990034346132, -1312.7980953334502, 2858.8552623337755, 2459.6912793092447, 1069.6825333184388, -1688.2015971799492, 233.21782920240022, 1263.847064277583, -2613.537634945204, 2572.317911423051, 4309.750754013147, 3720.286317888872, 698.6026955540312, -1876.5894388461686, -225.64260342802967, 2873.4656365368164, 3552.392223052528, -3170.2933400956936, -189.2591078058239, 814.2432524465463, 715.066052270074, -2383.583663052951, 136.28085269452393, 3929.551194658833, -317.21803069261745, 2377.9056138575256, -1318.4808198263702, -93.62587509752713, -4094.160041348462, 5884.655898957783, 2883.4741254981236, 113.68890368303994, 1707.3208337783794, 1624.5423651185263, -769.9178549447762, 2371.174397615652, 2467.085067740827, 202.05708680354027, -3833.0232016114296, 3653.977934679922, -1132.768419698334, 1358.8305100436226, -2984.53537931659, -311.56444466931544, 903.719780361902, 2377.4081272584835, -564.914219353038, 3783.1451611353878, 1813.4536376047056, -5329.83617639369, 31.49263245732788, -1358.9867334977203, 4877.711858181398, -220.89638856106248, 2589.042064035866, 2360.218430021995, -1510.9738120726508, -5648.62704750574, -902.2122092820098, 1012.7157283268538, -4269.133932423649, 2901.8052537769477, 2172.7302856707397, 394.2258819347875, -2945.4958303608378, -2197.265502387805, 1562.8688750458994, 1320.4548722953996, -2776.360970057821, -1659.588616666119, 2789.301289901172, 590.4106609824529, -543.678747570828, -1467.282065676521, 1638.876038933719, -840.9945962708935, 415.36973514636395, -524.0167767814132, -2530.054974992664, 1537.113838463843, 1802.4451238936135, 6318.514821210501, 2621.7755495978613, 3244.919556170497, 3673.0600421377217, -2975.860643130245, 1895.1336355103758, -695.7735196096914, 4569.611439505587, -3664.746915941418, 3301.8095857936423, -766.375745881117, -2708.040666193538, -337.73931754840197, 79.9036024567779, 754.9743922316447, -2605.040473424517, 1960.4426505418364, 4117.685769795729, 5526.638559151839, -680.3276418516798, -6146.614156663639, -205.06168271501977, -1278.385212124519, 1447.9209528881786, 1876.2648095758084, -856.925493338496, -2535.431461992005, 2027.0103363559988, -3571.8626537835917, -731.7836621457956, 5038.201025627395, 4722.605927316609, 4739.230083329321, 1062.2275023796603, 1863.2397550563066, 1118.3690687722333, -198.21929734361052, 2937.863003191816, -982.3280614592552, -1522.7543945367163, 460.363071028138, -696.7058095406788, 3899.311721279265, 4721.620891820309, 455.27213059042487, 1902.5775961858994, -204.37373218889377, -542.0861087085459, 597.1194483060577, 3372.632200241958, 3343.117429668551, 1763.0857017253527, 912.6797376152983, -66.1591376539532, -7518.392711530943, -40.46774997009203, 2581.855125748401, 1241.7305919983055, -2624.158502742243, 2235.1409694337854, -2374.13142060429, 1262.513775201781, 3656.7039032258836, 1781.5939913155385, 2220.9323623118194, 2293.43719239765, 189.8383862144117, -671.2966584338385, 6059.989643244573, 4382.524279757699, 5248.416219843251, 709.7827015876298, 1861.9705719524115, -5846.796182393618, -1375.0985153102379, 1848.6149872426881, 4863.321621390295, 4829.376727049496, 663.051858505448, -6248.631239670878, -574.9701684289155, -2.7440122929259942, -4042.7415893370207, 0.0, -96.9572378953917, -2737.2566716749475, -1222.2446237841277, 2912.574048897974, 3579.551274142678, 1641.123893231959, 8175.092435366448, 1306.5754005424183]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7111004783126225, "mean_inference_ms": 1.5401433835967762, "mean_action_processing_ms": 0.30439860339027774, "mean_env_wait_ms": 0.13739324966635622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005644798278808594, "StateBufferConnector_ms": 0.004993081092834473, "ViewRequirementAgentConnector_ms": 0.13662183284759521}, "num_episodes": 18, "episode_return_max": 11875.459443525433, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 1633.49606843941, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.43575726650005, "num_env_steps_trained_throughput_per_sec": 286.43575726650005, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 14292.71, "restore_workers_time_ms": 0.067, "training_step_time_ms": 14292.6, "sample_time_ms": 1360.021, "learn_time_ms": 12910.873, "learn_throughput": 309.816, "synch_weights_time_ms": 20.661}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "6751e_00000", "date": "2024-08-11_19-18-38", "timestamp": 1723418318, "time_this_iter_s": 14.068374872207642, "time_total_s": 685.8840322494507, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaba280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 685.8840322494507, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 45.58, "ram_util_percent": 83.035}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5827606950566251, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.971908036993925, "policy_loss": -0.006728608990408402, "vf_loss": 9.978339974337784, "vf_explained_var": -0.011797230363522888, "kl": 0.01186685857065148, "entropy": 0.7062647626198159, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8053060524362735, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.423586142000067, "policy_loss": -0.006961319402781704, "vf_loss": 9.428845972737307, "vf_explained_var": 0.00030115341383313374, "kl": 0.008507394741385598, "entropy": 0.8448157305439944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 11875.459443525433, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 1897.9747570852153, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6203.577042059657, "predator_policy": -7518.392711530943}, "policy_reward_max": {"prey_policy": 7418.793610514209, "predator_policy": 8175.092435366448}, "policy_reward_mean": {"prey_policy": 159.77973015246187, "predator_policy": 789.2076483901459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3304.3632962366073, 959.3177986645585, 2.1316282072803006e-14, 1663.5356278358904, 319.7740910947815, 1098.7082431552917, 817.1550843786304, 1768.2733943548224, 0.0, 1756.9190417688587, 3338.520061639812, 1529.526248648669, 1647.6757688142698, 1779.3809243415526, 112.77617321421786, 925.120340845689, 819.9239942695043, 112.57783064815314, 258.99204057377176, 2488.0936058317725, 586.3663139116744, 5305.603878842715, 284.5258675000015, 1030.0606354967595, 123.78783545538265, 364.1710536665109, 2112.1801955354376, 556.5825308981211, 913.9186032385157, 2310.303580743424, 644.5651756308263, 119.83661834793878, 2035.4957536110367, 432.7932228241544, 7.105427357601002e-15, 644.2802029003544, 3349.0672326498843, 928.5650179517625, 1192.5067304517224, 1220.7289853035616, 3984.6694057809846, 1289.4116553176627, 720.0249969737793, 0.0, 974.2218879747852, 1250.7562025729032, -2.842170943040401e-14, 126.16166629769478, 2752.934494534409, 655.0554562634586, 1237.1636422560778, 3719.6377491560975, 2943.0596690832913, 3490.5009873317, 1628.7159805670894, 560.0174006138388, 120.89172183131926, 4005.4065553788882, 1323.1983934278874, 239.29976967885946, 1736.1492108610848, 1756.2265991763059, 1857.216960619826, 7.105427357601002e-15, 2056.7684336159546, 0.0, 0.0, 3607.1630437799977, 4827.723072088396, 882.171356484416, 11875.459443525433, 2816.9188404867054, 2185.24745157243, 2034.5615724750762, 4279.717230649265, 1561.0249830278153, 124.25060247537927, 0.0, 1627.7460712504708, 1616.46615915651, 746.1235445108638, 5063.2611402375305, 0.0, 3199.0645529187314, 4207.10711726605, 3493.6018250971333, 6735.691656629316, 1485.615150454729, 4019.7725382280337, 5881.409115485551, 336.8697551291941, 5659.857077442664, 139.61019105612945, 517.7565122429816, 5310.7914985620455, 6000.574303010028, 1901.9855867684653, 8022.558991613174, 1726.0922187935, 627.8212655129475], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1306.9828280791278, -2270.72254112047, 1578.9397071058472, -5038.510921884186, 2406.2422415023098, -304.01019922811287, -504.41135850380783, -4257.910873249647, 2099.877348858223, 1579.4491901380752, -856.5432773278724, 425.9422157665446, 4199.673687326639, -1135.215792589582, -81.78874382598569, -1762.2710257854098, 5144.152248028506, -6203.577042059657, 7418.793610514209, -1474.0886522993621, -3790.379008705154, -1639.2309541109375, 4364.922604235426, -4656.406093048177, 387.2076873109382, 405.84357132957905, -1564.0127048781674, -1494.8658361367557, 4483.837582347696, -740.0952943255894, 888.9746518872594, -2485.0638260231603, 6293.225103700785, -3847.5962401583097, 2790.7971354396896, -3270.374640484123, -848.9813815251197, -704.5204858065541, -440.94391127884967, -2667.561281629475, 7408.570661550246, -1523.860803702206, 4710.343315870206, -2923.464561711173, 1184.6880991958433, -3268.307907170644, 2151.178866364077, -1970.3628488166626, 6188.029647960248, 486.5974442828883, 5539.66914127773, -1919.079883514431, -812.2266826392352, -2150.1286612730178, 4838.656239755494, -1730.8037604313172, 4911.186492335527, -3362.8712617551064, 3712.195538418038, 54.01414008780766, 2743.151041685805, -3228.298539290029, 1700.047044156222, -1626.9423392199062, 6081.906865416309, -4218.005085062473, 1502.6472179346902, -644.2291339860049, 3526.343172367483, -472.2714205934051, 694.0728739886922, -3389.3516334457972, -4051.283785094118, -1539.939353064358, -4744.923116069604, -1244.4914642868546, 4528.930684617877, -2255.6969465462885, 676.7481860452422, -3329.857120637575, 4071.748509849494, 275.85822607926457, 4189.006502845541, 574.8215645467811, 2575.016223757946, -1597.1555116925404, 6651.275991599807, -4801.209910406936, -3947.2602533270006, -1156.6462790357793, -840.9680706153449, -2754.5866441119124, 6211.971039342455, 139.704800036204, 3675.552730146435, -3718.9268046124002, 1488.145288684367, 245.44988961272932, 6457.099781691019, -5293.623199791587, 5880.0310789756895, -339.2211207902297, -1488.82287154752, -4552.346332240395, -1557.3761880816653, -1301.021728544011, 2722.125771334808, -2213.2336078316484, 1155.187348231928, -2266.1150735130395, 3387.233972122324, -322.1341155125109, 2432.8561358180955, -2075.621675474235, -1689.1609479227398, -2926.3651097979437, 2274.748041965514, -3309.3993753139493, 2103.1351074465283, -1117.37549687023, 1028.816580166572, -3262.4190178534996, -1270.1966026623754, -2079.779929555223, 1524.2067497798566, -513.510389121376, 5034.274693897278, 2524.5857676037585, 1177.802588363325, -2944.6198724940746, 3934.3230694590525, -3545.3055361506, 3279.9396679297383, -2168.322022527228, 2329.2096755967536, -4160.344526358177, 932.6170308269318, -619.263513448003, 3567.743195162442, -2204.1135664586022, 1935.5267620623254, -502.5812415391455, -339.2597590347102, -2802.020321909465, 6658.685953768498, -488.61289175486667, 4191.058283286998, -2630.0131827443706, -631.3772715408785, -4781.6038462496535, 6426.568289636877, 720.0360745563721, 2790.179868653436, -2088.2150854562174, 5326.770290044805, -1284.028700707774, 4086.9115965761894, 375.04838424462076, 3080.6396535629833, -3154.502919520315, -498.01829622869116, -3976.5333266350763, -1552.190803724473, -2866.215891946858, 2199.3570603947073, -1354.56664327377, 3466.983793697972, -1427.8605153000942, 5295.543463106447, -1592.6448566867398, 5284.513883374555, -1905.501175107524, 1367.508503902317, -377.20135038919693, 6353.45929087983, -5659.481406199133, 3404.2519096139144, -1481.560163426177, 5337.558013748352, -177.15922330650233, 2182.760513100261, -1211.4453409990067, 752.0493669070745, -1744.8475020854041, -1937.623976753359, -4226.2419039539645, 2857.9131668222353, -4515.541776157212, -1812.8382416291502, -5019.69633479006, 3644.0502032587706, 121.40328757670972, 2802.0190871301047, -1179.9274184504927, -885.5571182441129, -153.68876848565245, 580.0364239062642, -3647.8646288411255, 3892.0414581117348, 1567.0575660009524], "policy_predator_policy_reward": [2572.317911423051, 4309.750754013147, 3720.286317888872, 698.6026955540312, -1876.5894388461686, -225.64260342802967, 2873.4656365368164, 3552.392223052528, -3170.2933400956936, -189.2591078058239, 814.2432524465463, 715.066052270074, -2383.583663052951, 136.28085269452393, 3929.551194658833, -317.21803069261745, 2377.9056138575256, -1318.4808198263702, -93.62587509752713, -4094.160041348462, 5884.655898957783, 2883.4741254981236, 113.68890368303994, 1707.3208337783794, 1624.5423651185263, -769.9178549447762, 2371.174397615652, 2467.085067740827, 202.05708680354027, -3833.0232016114296, 3653.977934679922, -1132.768419698334, 1358.8305100436226, -2984.53537931659, -311.56444466931544, 903.719780361902, 2377.4081272584835, -564.914219353038, 3783.1451611353878, 1813.4536376047056, -5329.83617639369, 31.49263245732788, -1358.9867334977203, 4877.711858181398, -220.89638856106248, 2589.042064035866, 2360.218430021995, -1510.9738120726508, -5648.62704750574, -902.2122092820098, 1012.7157283268538, -4269.133932423649, 2901.8052537769477, 2172.7302856707397, 394.2258819347875, -2945.4958303608378, -2197.265502387805, 1562.8688750458994, 1320.4548722953996, -2776.360970057821, -1659.588616666119, 2789.301289901172, 590.4106609824529, -543.678747570828, -1467.282065676521, 1638.876038933719, -840.9945962708935, 415.36973514636395, -524.0167767814132, -2530.054974992664, 1537.113838463843, 1802.4451238936135, 6318.514821210501, 2621.7755495978613, 3244.919556170497, 3673.0600421377217, -2975.860643130245, 1895.1336355103758, -695.7735196096914, 4569.611439505587, -3664.746915941418, 3301.8095857936423, -766.375745881117, -2708.040666193538, -337.73931754840197, 79.9036024567779, 754.9743922316447, -2605.040473424517, 1960.4426505418364, 4117.685769795729, 5526.638559151839, -680.3276418516798, -6146.614156663639, -205.06168271501977, -1278.385212124519, 1447.9209528881786, 1876.2648095758084, -856.925493338496, -2535.431461992005, 2027.0103363559988, -3571.8626537835917, -731.7836621457956, 5038.201025627395, 4722.605927316609, 4739.230083329321, 1062.2275023796603, 1863.2397550563066, 1118.3690687722333, -198.21929734361052, 2937.863003191816, -982.3280614592552, -1522.7543945367163, 460.363071028138, -696.7058095406788, 3899.311721279265, 4721.620891820309, 455.27213059042487, 1902.5775961858994, -204.37373218889377, -542.0861087085459, 597.1194483060577, 3372.632200241958, 3343.117429668551, 1763.0857017253527, 912.6797376152983, -66.1591376539532, -7518.392711530943, -40.46774997009203, 2581.855125748401, 1241.7305919983055, -2624.158502742243, 2235.1409694337854, -2374.13142060429, 1262.513775201781, 3656.7039032258836, 1781.5939913155385, 2220.9323623118194, 2293.43719239765, 189.8383862144117, -671.2966584338385, 6059.989643244573, 4382.524279757699, 5248.416219843251, 709.7827015876298, 1861.9705719524115, -5846.796182393618, -1375.0985153102379, 1848.6149872426881, 4863.321621390295, 4829.376727049496, 663.051858505448, -6248.631239670878, -574.9701684289155, -2.7440122929259942, -4042.7415893370207, 0.0, -96.9572378953917, -2737.2566716749475, -1222.2446237841277, 2912.574048897974, 3579.551274142678, 1641.123893231959, 8175.092435366448, 1306.5754005424183, -578.742157967312, -266.04825915362255, 550.8462295188106, 609.0950450020396, 2192.4956904114715, -1688.2871795651263, -1594.831355450004, 1709.4204722800978, 4307.720615954346, 1437.6638871618466, 776.5716170657239, 15.065648708311457, 3701.043109193939, -1603.962317153638, 1532.538778156345, -811.5284531126451, -225.63419390222901, -408.8112230698329, 4947.865675022908, 1704.7895375980816, 2662.7026347473247, 3640.7734370161274, 2258.6881109451915, -83.30298936723335, 6627.6350887771805, 5515.690986204079, 3753.5572290912187, -1518.4364169166527, -1498.645275680614, 1778.5391937694694, 7181.1402174077975, 1880.6646609351387, 1833.5579692834938, 2960.3624544448694, -2309.0827857920735, -2522.1949728076656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7151310200527874, "mean_inference_ms": 1.5496245398455712, "mean_action_processing_ms": 0.30603005200354083, "mean_env_wait_ms": 0.13808613511189738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005788207054138184, "StateBufferConnector_ms": 0.011065840721130371, "ViewRequirementAgentConnector_ms": 0.1352936029434204}, "num_episodes": 18, "episode_return_max": 11875.459443525433, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 1897.9747570852153, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.3647643093088, "num_env_steps_trained_throughput_per_sec": 279.3647643093088, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 14302.724, "restore_workers_time_ms": 0.069, "training_step_time_ms": 14302.607, "sample_time_ms": 1398.266, "learn_time_ms": 12880.92, "learn_throughput": 310.537, "synch_weights_time_ms": 22.454}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "6751e_00000", "date": "2024-08-11_19-18-53", "timestamp": 1723418333, "time_this_iter_s": 14.431561946868896, "time_total_s": 700.3155941963196, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaad700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 700.3155941963196, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 45.86, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5908045612236179, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.950351944676152, "policy_loss": -0.006573754133380674, "vf_loss": 9.956782037240487, "vf_explained_var": 0.005700981553900179, "kl": 0.005746859410734757, "entropy": 0.6963009245496579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6738005936303467, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.326777665072647, "policy_loss": -0.006383940967775527, "vf_loss": 9.332075058467804, "vf_explained_var": 0.00027053006111629426, "kl": 0.0054327322443503785, "entropy": 0.7987103527815884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 11875.459443525433, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 2223.0489748801397, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5659.481406199133, "predator_policy": -7899.48053969364}, "policy_reward_max": {"prey_policy": 7719.116759947441, "predator_policy": 13017.814960947693}, "policy_reward_mean": {"prey_policy": 298.7069609671252, "predator_policy": 812.8175264729449}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.5258675000015, 1030.0606354967595, 123.78783545538265, 364.1710536665109, 2112.1801955354376, 556.5825308981211, 913.9186032385157, 2310.303580743424, 644.5651756308263, 119.83661834793878, 2035.4957536110367, 432.7932228241544, 7.105427357601002e-15, 644.2802029003544, 3349.0672326498843, 928.5650179517625, 1192.5067304517224, 1220.7289853035616, 3984.6694057809846, 1289.4116553176627, 720.0249969737793, 0.0, 974.2218879747852, 1250.7562025729032, -2.842170943040401e-14, 126.16166629769478, 2752.934494534409, 655.0554562634586, 1237.1636422560778, 3719.6377491560975, 2943.0596690832913, 3490.5009873317, 1628.7159805670894, 560.0174006138388, 120.89172183131926, 4005.4065553788882, 1323.1983934278874, 239.29976967885946, 1736.1492108610848, 1756.2265991763059, 1857.216960619826, 7.105427357601002e-15, 2056.7684336159546, 0.0, 0.0, 3607.1630437799977, 4827.723072088396, 882.171356484416, 11875.459443525433, 2816.9188404867054, 2185.24745157243, 2034.5615724750762, 4279.717230649265, 1561.0249830278153, 124.25060247537927, 0.0, 1627.7460712504708, 1616.46615915651, 746.1235445108638, 5063.2611402375305, 0.0, 3199.0645529187314, 4207.10711726605, 3493.6018250971333, 6735.691656629316, 1485.615150454729, 4019.7725382280337, 5881.409115485551, 336.8697551291941, 5659.857077442664, 139.61019105612945, 517.7565122429816, 5310.7914985620455, 6000.574303010028, 1901.9855867684653, 8022.558991613174, 1726.0922187935, 627.8212655129475, 2935.3236274721758, 0.0, 2518.2002926369178, 1063.0035841940044, 2117.209929223765, 2367.3442545997304, 3.552713678800501e-15, 3921.558633443881, 1148.187273225826, 4632.947692912443, 1.4210854715202004e-14, 2917.975317218234, 2624.5271607806594, 8476.458834549827, 9952.229704559068, 2559.5895499826647, 2737.7988680731605, 281.1086635664403, 5554.693787230641, 1995.394885043536, 3645.823703312502, 1650.6497765382433], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1184.6880991958433, -3268.307907170644, 2151.178866364077, -1970.3628488166626, 6188.029647960248, 486.5974442828883, 5539.66914127773, -1919.079883514431, -812.2266826392352, -2150.1286612730178, 4838.656239755494, -1730.8037604313172, 4911.186492335527, -3362.8712617551064, 3712.195538418038, 54.01414008780766, 2743.151041685805, -3228.298539290029, 1700.047044156222, -1626.9423392199062, 6081.906865416309, -4218.005085062473, 1502.6472179346902, -644.2291339860049, 3526.343172367483, -472.2714205934051, 694.0728739886922, -3389.3516334457972, -4051.283785094118, -1539.939353064358, -4744.923116069604, -1244.4914642868546, 4528.930684617877, -2255.6969465462885, 676.7481860452422, -3329.857120637575, 4071.748509849494, 275.85822607926457, 4189.006502845541, 574.8215645467811, 2575.016223757946, -1597.1555116925404, 6651.275991599807, -4801.209910406936, -3947.2602533270006, -1156.6462790357793, -840.9680706153449, -2754.5866441119124, 6211.971039342455, 139.704800036204, 3675.552730146435, -3718.9268046124002, 1488.145288684367, 245.44988961272932, 6457.099781691019, -5293.623199791587, 5880.0310789756895, -339.2211207902297, -1488.82287154752, -4552.346332240395, -1557.3761880816653, -1301.021728544011, 2722.125771334808, -2213.2336078316484, 1155.187348231928, -2266.1150735130395, 3387.233972122324, -322.1341155125109, 2432.8561358180955, -2075.621675474235, -1689.1609479227398, -2926.3651097979437, 2274.748041965514, -3309.3993753139493, 2103.1351074465283, -1117.37549687023, 1028.816580166572, -3262.4190178534996, -1270.1966026623754, -2079.779929555223, 1524.2067497798566, -513.510389121376, 5034.274693897278, 2524.5857676037585, 1177.802588363325, -2944.6198724940746, 3934.3230694590525, -3545.3055361506, 3279.9396679297383, -2168.322022527228, 2329.2096755967536, -4160.344526358177, 932.6170308269318, -619.263513448003, 3567.743195162442, -2204.1135664586022, 1935.5267620623254, -502.5812415391455, -339.2597590347102, -2802.020321909465, 6658.685953768498, -488.61289175486667, 4191.058283286998, -2630.0131827443706, -631.3772715408785, -4781.6038462496535, 6426.568289636877, 720.0360745563721, 2790.179868653436, -2088.2150854562174, 5326.770290044805, -1284.028700707774, 4086.9115965761894, 375.04838424462076, 3080.6396535629833, -3154.502919520315, -498.01829622869116, -3976.5333266350763, -1552.190803724473, -2866.215891946858, 2199.3570603947073, -1354.56664327377, 3466.983793697972, -1427.8605153000942, 5295.543463106447, -1592.6448566867398, 5284.513883374555, -1905.501175107524, 1367.508503902317, -377.20135038919693, 6353.45929087983, -5659.481406199133, 3404.2519096139144, -1481.560163426177, 5337.558013748352, -177.15922330650233, 2182.760513100261, -1211.4453409990067, 752.0493669070745, -1744.8475020854041, -1937.623976753359, -4226.2419039539645, 2857.9131668222353, -4515.541776157212, -1812.8382416291502, -5019.69633479006, 3644.0502032587706, 121.40328757670972, 2802.0190871301047, -1179.9274184504927, -885.5571182441129, -153.68876848565245, 580.0364239062642, -3647.8646288411255, 3892.0414581117348, 1567.0575660009524, 2206.5860295016173, -2188.1373524894425, 4667.8073939773285, -4905.101549236044, 1976.0197716030618, -4922.14572756064, 414.8703155205265, -1459.7449071482633, 2668.0311626502976, -1105.0385518917028, 3417.4676526309113, 1870.95882517675, 1996.3747628083363, -4691.389496689376, 3713.6535348421003, -4672.198920281346, 2084.8582430629745, -3677.090177612986, 7719.116759947441, -611.4450413837277, 5985.820542837181, -1676.0707546234983, 7117.078639283871, -1659.9356626565145, 7371.865307824793, -1194.593141343976, -3429.530219638044, -3852.087518980111, 6969.52138510597, 1015.2071092136529, 6719.460884019134, -3862.010218095806, 3513.538258150172, -3134.141179853975, 4297.093567266218, -4772.963285968006, -553.4772785025089, -1831.2041158851937, 4834.269851362347, -2524.8632723923783, 5743.42677977097, -540.9795542221024, 481.58444386903443, -2941.6148476011476], "policy_predator_policy_reward": [-220.89638856106248, 2589.042064035866, 2360.218430021995, -1510.9738120726508, -5648.62704750574, -902.2122092820098, 1012.7157283268538, -4269.133932423649, 2901.8052537769477, 2172.7302856707397, 394.2258819347875, -2945.4958303608378, -2197.265502387805, 1562.8688750458994, 1320.4548722953996, -2776.360970057821, -1659.588616666119, 2789.301289901172, 590.4106609824529, -543.678747570828, -1467.282065676521, 1638.876038933719, -840.9945962708935, 415.36973514636395, -524.0167767814132, -2530.054974992664, 1537.113838463843, 1802.4451238936135, 6318.514821210501, 2621.7755495978613, 3244.919556170497, 3673.0600421377217, -2975.860643130245, 1895.1336355103758, -695.7735196096914, 4569.611439505587, -3664.746915941418, 3301.8095857936423, -766.375745881117, -2708.040666193538, -337.73931754840197, 79.9036024567779, 754.9743922316447, -2605.040473424517, 1960.4426505418364, 4117.685769795729, 5526.638559151839, -680.3276418516798, -6146.614156663639, -205.06168271501977, -1278.385212124519, 1447.9209528881786, 1876.2648095758084, -856.925493338496, -2535.431461992005, 2027.0103363559988, -3571.8626537835917, -731.7836621457956, 5038.201025627395, 4722.605927316609, 4739.230083329321, 1062.2275023796603, 1863.2397550563066, 1118.3690687722333, -198.21929734361052, 2937.863003191816, -982.3280614592552, -1522.7543945367163, 460.363071028138, -696.7058095406788, 3899.311721279265, 4721.620891820309, 455.27213059042487, 1902.5775961858994, -204.37373218889377, -542.0861087085459, 597.1194483060577, 3372.632200241958, 3343.117429668551, 1763.0857017253527, 912.6797376152983, -66.1591376539532, -7518.392711530943, -40.46774997009203, 2581.855125748401, 1241.7305919983055, -2624.158502742243, 2235.1409694337854, -2374.13142060429, 1262.513775201781, 3656.7039032258836, 1781.5939913155385, 2220.9323623118194, 2293.43719239765, 189.8383862144117, -671.2966584338385, 6059.989643244573, 4382.524279757699, 5248.416219843251, 709.7827015876298, 1861.9705719524115, -5846.796182393618, -1375.0985153102379, 1848.6149872426881, 4863.321621390295, 4829.376727049496, 663.051858505448, -6248.631239670878, -574.9701684289155, -2.7440122929259942, -4042.7415893370207, 0.0, -96.9572378953917, -2737.2566716749475, -1222.2446237841277, 2912.574048897974, 3579.551274142678, 1641.123893231959, 8175.092435366448, 1306.5754005424183, -578.742157967312, -266.04825915362255, 550.8462295188106, 609.0950450020396, 2192.4956904114715, -1688.2871795651263, -1594.831355450004, 1709.4204722800978, 4307.720615954346, 1437.6638871618466, 776.5716170657239, 15.065648708311457, 3701.043109193939, -1603.962317153638, 1532.538778156345, -811.5284531126451, -225.63419390222901, -408.8112230698329, 4947.865675022908, 1704.7895375980816, 2662.7026347473247, 3640.7734370161274, 2258.6881109451915, -83.30298936723335, 6627.6350887771805, 5515.690986204079, 3753.5572290912187, -1518.4364169166527, -1498.645275680614, 1778.5391937694694, 7181.1402174077975, 1880.6646609351387, 1833.5579692834938, 2960.3624544448694, -2309.0827857920735, -2522.1949728076656, 3384.8765314644593, -468.0015810044598, -363.67229085613053, 600.9664461148427, 5991.621893319674, -527.2956447251785, -701.7596571259751, 2809.6378329477207, 1155.874162902544, -601.6568444373793, -2200.2986872681645, -720.7835359397673, 523.9909088012007, 2171.023825079835, 7592.62034554961, -2712.516326666482, 1575.9698145548484, 1164.4493932209946, 5424.756514042374, -7899.48053969364, 467.47098067963725, -4777.220768893315, 1318.152257950583, -3857.3199173597036, -2260.1915254622304, -1292.5534802379184, 13017.814960947693, 2740.261612220257, -3289.4363139103016, 5256.93752414975, -3699.891924565992, 3402.030808625337, 1090.369195558151, 1268.0325942188101, 2992.411539841698, -2235.433157573466, 2063.303954100604, 5876.071227517739, -2228.9308680632266, 1914.9191741367997, 4663.369570220419, -6219.993092456787, 3422.1651924576986, 688.5149878126621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7191996256232579, "mean_inference_ms": 1.5598747718530552, "mean_action_processing_ms": 0.3082360710818462, "mean_env_wait_ms": 0.13880616549376062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006370425224304199, "StateBufferConnector_ms": 0.00925135612487793, "ViewRequirementAgentConnector_ms": 0.1352860927581787}, "num_episodes": 22, "episode_return_max": 11875.459443525433, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 2223.0489748801397, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.7489990395414, "num_env_steps_trained_throughput_per_sec": 283.7489990395414, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 14310.396, "restore_workers_time_ms": 0.069, "training_step_time_ms": 14310.278, "sample_time_ms": 1451.259, "learn_time_ms": 12835.639, "learn_throughput": 311.632, "synch_weights_time_ms": 22.336}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "6751e_00000", "date": "2024-08-11_19-19-07", "timestamp": 1723418347, "time_this_iter_s": 14.125623226165771, "time_total_s": 714.4412174224854, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaba8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 714.4412174224854, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 46.81428571428572, "ram_util_percent": 82.65238095238094}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5967881715723447, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.943322903769356, "policy_loss": -0.004287844376944045, "vf_loss": 9.947493261508841, "vf_explained_var": 0.0019292434371968425, "kl": 0.00470043560160505, "entropy": 0.7032625775803965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7031467114491438, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.646507405982446, "policy_loss": -0.006800784123938274, "vf_loss": 9.651987192870449, "vf_explained_var": 0.0007952950303516691, "kl": 0.006604819237935333, "entropy": 0.8128984222021053, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 11875.459443525433, "episode_reward_min": -2.842170943040401e-14, "episode_reward_mean": 2456.1491169299425, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5659.481406199133, "predator_policy": -7899.48053969364}, "policy_reward_max": {"prey_policy": 9725.568427162576, "predator_policy": 13017.814960947693}, "policy_reward_mean": {"prey_policy": 256.1504123939594, "predator_policy": 971.9241460710124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1250.7562025729032, -2.842170943040401e-14, 126.16166629769478, 2752.934494534409, 655.0554562634586, 1237.1636422560778, 3719.6377491560975, 2943.0596690832913, 3490.5009873317, 1628.7159805670894, 560.0174006138388, 120.89172183131926, 4005.4065553788882, 1323.1983934278874, 239.29976967885946, 1736.1492108610848, 1756.2265991763059, 1857.216960619826, 7.105427357601002e-15, 2056.7684336159546, 0.0, 0.0, 3607.1630437799977, 4827.723072088396, 882.171356484416, 11875.459443525433, 2816.9188404867054, 2185.24745157243, 2034.5615724750762, 4279.717230649265, 1561.0249830278153, 124.25060247537927, 0.0, 1627.7460712504708, 1616.46615915651, 746.1235445108638, 5063.2611402375305, 0.0, 3199.0645529187314, 4207.10711726605, 3493.6018250971333, 6735.691656629316, 1485.615150454729, 4019.7725382280337, 5881.409115485551, 336.8697551291941, 5659.857077442664, 139.61019105612945, 517.7565122429816, 5310.7914985620455, 6000.574303010028, 1901.9855867684653, 8022.558991613174, 1726.0922187935, 627.8212655129475, 2935.3236274721758, 0.0, 2518.2002926369178, 1063.0035841940044, 2117.209929223765, 2367.3442545997304, 3.552713678800501e-15, 3921.558633443881, 1148.187273225826, 4632.947692912443, 1.4210854715202004e-14, 2917.975317218234, 2624.5271607806594, 8476.458834549827, 9952.229704559068, 2559.5895499826647, 2737.7988680731605, 281.1086635664403, 5554.693787230641, 1995.394885043536, 3645.823703312502, 1650.6497765382433, 270.2338116360516, 6113.713073743578, 1473.6225683035768, 0.0, 1086.1347263380005, 1646.2762290321116, 1820.2381283627496, 1505.1757119646472, 6713.315499671995, 249.2882976821013, 3963.006706451234, 1304.7284288282033, 6567.351794063722, 274.8299142290641, 7.105427357601002e-15, 1774.5249242581338, 1576.3158313091735, 5940.426315990052, 496.6101349149675, 2436.635083268142, 0.0, 943.3129458791219, 2385.9712673062786], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-840.9680706153449, -2754.5866441119124, 6211.971039342455, 139.704800036204, 3675.552730146435, -3718.9268046124002, 1488.145288684367, 245.44988961272932, 6457.099781691019, -5293.623199791587, 5880.0310789756895, -339.2211207902297, -1488.82287154752, -4552.346332240395, -1557.3761880816653, -1301.021728544011, 2722.125771334808, -2213.2336078316484, 1155.187348231928, -2266.1150735130395, 3387.233972122324, -322.1341155125109, 2432.8561358180955, -2075.621675474235, -1689.1609479227398, -2926.3651097979437, 2274.748041965514, -3309.3993753139493, 2103.1351074465283, -1117.37549687023, 1028.816580166572, -3262.4190178534996, -1270.1966026623754, -2079.779929555223, 1524.2067497798566, -513.510389121376, 5034.274693897278, 2524.5857676037585, 1177.802588363325, -2944.6198724940746, 3934.3230694590525, -3545.3055361506, 3279.9396679297383, -2168.322022527228, 2329.2096755967536, -4160.344526358177, 932.6170308269318, -619.263513448003, 3567.743195162442, -2204.1135664586022, 1935.5267620623254, -502.5812415391455, -339.2597590347102, -2802.020321909465, 6658.685953768498, -488.61289175486667, 4191.058283286998, -2630.0131827443706, -631.3772715408785, -4781.6038462496535, 6426.568289636877, 720.0360745563721, 2790.179868653436, -2088.2150854562174, 5326.770290044805, -1284.028700707774, 4086.9115965761894, 375.04838424462076, 3080.6396535629833, -3154.502919520315, -498.01829622869116, -3976.5333266350763, -1552.190803724473, -2866.215891946858, 2199.3570603947073, -1354.56664327377, 3466.983793697972, -1427.8605153000942, 5295.543463106447, -1592.6448566867398, 5284.513883374555, -1905.501175107524, 1367.508503902317, -377.20135038919693, 6353.45929087983, -5659.481406199133, 3404.2519096139144, -1481.560163426177, 5337.558013748352, -177.15922330650233, 2182.760513100261, -1211.4453409990067, 752.0493669070745, -1744.8475020854041, -1937.623976753359, -4226.2419039539645, 2857.9131668222353, -4515.541776157212, -1812.8382416291502, -5019.69633479006, 3644.0502032587706, 121.40328757670972, 2802.0190871301047, -1179.9274184504927, -885.5571182441129, -153.68876848565245, 580.0364239062642, -3647.8646288411255, 3892.0414581117348, 1567.0575660009524, 2206.5860295016173, -2188.1373524894425, 4667.8073939773285, -4905.101549236044, 1976.0197716030618, -4922.14572756064, 414.8703155205265, -1459.7449071482633, 2668.0311626502976, -1105.0385518917028, 3417.4676526309113, 1870.95882517675, 1996.3747628083363, -4691.389496689376, 3713.6535348421003, -4672.198920281346, 2084.8582430629745, -3677.090177612986, 7719.116759947441, -611.4450413837277, 5985.820542837181, -1676.0707546234983, 7117.078639283871, -1659.9356626565145, 7371.865307824793, -1194.593141343976, -3429.530219638044, -3852.087518980111, 6969.52138510597, 1015.2071092136529, 6719.460884019134, -3862.010218095806, 3513.538258150172, -3134.141179853975, 4297.093567266218, -4772.963285968006, -553.4772785025089, -1831.2041158851937, 4834.269851362347, -2524.8632723923783, 5743.42677977097, -540.9795542221024, 481.58444386903443, -2941.6148476011476, 5958.638422503278, -4625.376030775763, 2705.2511650881247, -1247.149526590078, 2220.7774582421666, -3304.684252809445, 2920.0783036372004, -4929.910995258247, 518.3578210502263, -2168.9815232630795, 5389.428202755727, -4661.110337149002, 3208.0981355117588, -1527.6731883784514, 410.3633666197773, -731.1192647203609, 4377.236770333255, -914.5039736533095, -334.4692583161844, -2724.254973192126, 9725.568427162576, -81.81735643975728, 2616.175169623441, -478.8181218868008, -2140.1278603767437, -4278.722406640632, -663.9965825077439, -2874.6390064807397, 4055.129056949137, -4585.918800455058, 4809.950392320639, -2187.6031215044454, 971.4564129653552, -4471.657992398185, -3507.832911894553, -2380.961369185215, 1588.3272677009238, -1511.1345562420074, 5107.738843482621, 921.5950038402249, 1866.8029663311536, -2819.7267343400617, -1324.761711260809, -272.9882425316933, 4850.626878347634, -586.5228636381863], "policy_predator_policy_reward": [5526.638559151839, -680.3276418516798, -6146.614156663639, -205.06168271501977, -1278.385212124519, 1447.9209528881786, 1876.2648095758084, -856.925493338496, -2535.431461992005, 2027.0103363559988, -3571.8626537835917, -731.7836621457956, 5038.201025627395, 4722.605927316609, 4739.230083329321, 1062.2275023796603, 1863.2397550563066, 1118.3690687722333, -198.21929734361052, 2937.863003191816, -982.3280614592552, -1522.7543945367163, 460.363071028138, -696.7058095406788, 3899.311721279265, 4721.620891820309, 455.27213059042487, 1902.5775961858994, -204.37373218889377, -542.0861087085459, 597.1194483060577, 3372.632200241958, 3343.117429668551, 1763.0857017253527, 912.6797376152983, -66.1591376539532, -7518.392711530943, -40.46774997009203, 2581.855125748401, 1241.7305919983055, -2624.158502742243, 2235.1409694337854, -2374.13142060429, 1262.513775201781, 3656.7039032258836, 1781.5939913155385, 2220.9323623118194, 2293.43719239765, 189.8383862144117, -671.2966584338385, 6059.989643244573, 4382.524279757699, 5248.416219843251, 709.7827015876298, 1861.9705719524115, -5846.796182393618, -1375.0985153102379, 1848.6149872426881, 4863.321621390295, 4829.376727049496, 663.051858505448, -6248.631239670878, -574.9701684289155, -2.7440122929259942, -4042.7415893370207, 0.0, -96.9572378953917, -2737.2566716749475, -1222.2446237841277, 2912.574048897974, 3579.551274142678, 1641.123893231959, 8175.092435366448, 1306.5754005424183, -578.742157967312, -266.04825915362255, 550.8462295188106, 609.0950450020396, 2192.4956904114715, -1688.2871795651263, -1594.831355450004, 1709.4204722800978, 4307.720615954346, 1437.6638871618466, 776.5716170657239, 15.065648708311457, 3701.043109193939, -1603.962317153638, 1532.538778156345, -811.5284531126451, -225.63419390222901, -408.8112230698329, 4947.865675022908, 1704.7895375980816, 2662.7026347473247, 3640.7734370161274, 2258.6881109451915, -83.30298936723335, 6627.6350887771805, 5515.690986204079, 3753.5572290912187, -1518.4364169166527, -1498.645275680614, 1778.5391937694694, 7181.1402174077975, 1880.6646609351387, 1833.5579692834938, 2960.3624544448694, -2309.0827857920735, -2522.1949728076656, 3384.8765314644593, -468.0015810044598, -363.67229085613053, 600.9664461148427, 5991.621893319674, -527.2956447251785, -701.7596571259751, 2809.6378329477207, 1155.874162902544, -601.6568444373793, -2200.2986872681645, -720.7835359397673, 523.9909088012007, 2171.023825079835, 7592.62034554961, -2712.516326666482, 1575.9698145548484, 1164.4493932209946, 5424.756514042374, -7899.48053969364, 467.47098067963725, -4777.220768893315, 1318.152257950583, -3857.3199173597036, -2260.1915254622304, -1292.5534802379184, 13017.814960947693, 2740.261612220257, -3289.4363139103016, 5256.93752414975, -3699.891924565992, 3402.030808625337, 1090.369195558151, 1268.0325942188101, 2992.411539841698, -2235.433157573466, 2063.303954100604, 5876.071227517739, -2228.9308680632266, 1914.9191741367997, 4663.369570220419, -6219.993092456787, 3422.1651924576986, 688.5149878126621, -1378.792482718345, 315.7639026268836, 500.762415007895, 4154.849020237636, 340.282532280934, 2217.246830589921, 2574.7955254339327, -564.9628338128965, 1788.7588939826335, 947.999534568217, 1269.1928170474407, -351.23445362204563, 1050.7944172057034, -910.9812359762575, 1547.3707884599578, 278.5608216052746, 2497.9494117345753, 752.633291257478, 1002.1088110704137, 2305.903718119998, -5604.851772884177, -75.89259138739875, 962.9965375530568, -1795.625156461494, 7873.898751902028, 5112.303309179083, 2351.7941264943825, 1461.6713767231658, -1392.8351039506738, 1923.6248474565962, -1152.3592452003022, 304.5368986422406, 3532.9396641564394, 1543.577746585554, 9008.636675198166, 2820.5839218716574, -409.02460187607596, 828.442025332127, -3395.249155670116, -197.449608384584, -525.7159479827518, 1478.6397159916635, 808.8496865785011, 1732.2132130931222, -1269.6865687754414, -608.4461786277265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7247261521491084, "mean_inference_ms": 1.5740086481982893, "mean_action_processing_ms": 0.3089681836218713, "mean_env_wait_ms": 0.1401557674325909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006251931190490723, "StateBufferConnector_ms": 0.01188194751739502, "ViewRequirementAgentConnector_ms": 0.13794028759002686}, "num_episodes": 23, "episode_return_max": 11875.459443525433, "episode_return_min": -2.842170943040401e-14, "episode_return_mean": 2456.1491169299425, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.8077698993298, "num_env_steps_trained_throughput_per_sec": 283.8077698993298, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 14284.488, "restore_workers_time_ms": 0.069, "training_step_time_ms": 14284.37, "sample_time_ms": 1510.701, "learn_time_ms": 12750.208, "learn_throughput": 313.72, "synch_weights_time_ms": 22.417}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "6751e_00000", "date": "2024-08-11_19-19-21", "timestamp": 1723418361, "time_this_iter_s": 14.161020040512085, "time_total_s": 728.6022374629974, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.6022374629974, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 45.82000000000001, "ram_util_percent": 82.885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6744797584083345, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.936329136197529, "policy_loss": -0.004086783066608761, "vf_loss": 9.940339774177188, "vf_explained_var": -0.0054078919231576265, "kl": 0.006092034615677287, "entropy": 0.7565267905356392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8218275751701738, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.609746768991783, "policy_loss": -0.007450340682069067, "vf_loss": 9.615827498864876, "vf_explained_var": 0.00038362101272300435, "kl": 0.006848032530436586, "entropy": 0.8776013620946773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 12056.404596957944, "episode_reward_min": 0.0, "episode_reward_mean": 3096.5461721349275, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5873.04714576877, "predator_policy": -7899.48053969364}, "policy_reward_max": {"prey_policy": 9725.568427162576, "predator_policy": 13017.814960947693}, "policy_reward_mean": {"prey_policy": 337.1344100813092, "predator_policy": 1211.1386759861546}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.105427357601002e-15, 2056.7684336159546, 0.0, 0.0, 3607.1630437799977, 4827.723072088396, 882.171356484416, 11875.459443525433, 2816.9188404867054, 2185.24745157243, 2034.5615724750762, 4279.717230649265, 1561.0249830278153, 124.25060247537927, 0.0, 1627.7460712504708, 1616.46615915651, 746.1235445108638, 5063.2611402375305, 0.0, 3199.0645529187314, 4207.10711726605, 3493.6018250971333, 6735.691656629316, 1485.615150454729, 4019.7725382280337, 5881.409115485551, 336.8697551291941, 5659.857077442664, 139.61019105612945, 517.7565122429816, 5310.7914985620455, 6000.574303010028, 1901.9855867684653, 8022.558991613174, 1726.0922187935, 627.8212655129475, 2935.3236274721758, 0.0, 2518.2002926369178, 1063.0035841940044, 2117.209929223765, 2367.3442545997304, 3.552713678800501e-15, 3921.558633443881, 1148.187273225826, 4632.947692912443, 1.4210854715202004e-14, 2917.975317218234, 2624.5271607806594, 8476.458834549827, 9952.229704559068, 2559.5895499826647, 2737.7988680731605, 281.1086635664403, 5554.693787230641, 1995.394885043536, 3645.823703312502, 1650.6497765382433, 270.2338116360516, 6113.713073743578, 1473.6225683035768, 0.0, 1086.1347263380005, 1646.2762290321116, 1820.2381283627496, 1505.1757119646472, 6713.315499671995, 249.2882976821013, 3963.006706451234, 1304.7284288282033, 6567.351794063722, 274.8299142290641, 7.105427357601002e-15, 1774.5249242581338, 1576.3158313091735, 5940.426315990052, 496.6101349149675, 2436.635083268142, 0.0, 943.3129458791219, 2385.9712673062786, 4401.598517398886, 4106.676612988089, 7205.317431574514, 7545.794678104055, 7808.411367664426, 4132.810712905207, 12056.404596957944, 1877.956172411262, 2149.013270075603, 6728.590760410477, 11061.797053793714, 7573.122046779873, 1776.213301670536, 1583.6687330515044, 3990.7204106192967, 3559.099671578055, 3357.334028181961, 2527.568613983784], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5034.274693897278, 2524.5857676037585, 1177.802588363325, -2944.6198724940746, 3934.3230694590525, -3545.3055361506, 3279.9396679297383, -2168.322022527228, 2329.2096755967536, -4160.344526358177, 932.6170308269318, -619.263513448003, 3567.743195162442, -2204.1135664586022, 1935.5267620623254, -502.5812415391455, -339.2597590347102, -2802.020321909465, 6658.685953768498, -488.61289175486667, 4191.058283286998, -2630.0131827443706, -631.3772715408785, -4781.6038462496535, 6426.568289636877, 720.0360745563721, 2790.179868653436, -2088.2150854562174, 5326.770290044805, -1284.028700707774, 4086.9115965761894, 375.04838424462076, 3080.6396535629833, -3154.502919520315, -498.01829622869116, -3976.5333266350763, -1552.190803724473, -2866.215891946858, 2199.3570603947073, -1354.56664327377, 3466.983793697972, -1427.8605153000942, 5295.543463106447, -1592.6448566867398, 5284.513883374555, -1905.501175107524, 1367.508503902317, -377.20135038919693, 6353.45929087983, -5659.481406199133, 3404.2519096139144, -1481.560163426177, 5337.558013748352, -177.15922330650233, 2182.760513100261, -1211.4453409990067, 752.0493669070745, -1744.8475020854041, -1937.623976753359, -4226.2419039539645, 2857.9131668222353, -4515.541776157212, -1812.8382416291502, -5019.69633479006, 3644.0502032587706, 121.40328757670972, 2802.0190871301047, -1179.9274184504927, -885.5571182441129, -153.68876848565245, 580.0364239062642, -3647.8646288411255, 3892.0414581117348, 1567.0575660009524, 2206.5860295016173, -2188.1373524894425, 4667.8073939773285, -4905.101549236044, 1976.0197716030618, -4922.14572756064, 414.8703155205265, -1459.7449071482633, 2668.0311626502976, -1105.0385518917028, 3417.4676526309113, 1870.95882517675, 1996.3747628083363, -4691.389496689376, 3713.6535348421003, -4672.198920281346, 2084.8582430629745, -3677.090177612986, 7719.116759947441, -611.4450413837277, 5985.820542837181, -1676.0707546234983, 7117.078639283871, -1659.9356626565145, 7371.865307824793, -1194.593141343976, -3429.530219638044, -3852.087518980111, 6969.52138510597, 1015.2071092136529, 6719.460884019134, -3862.010218095806, 3513.538258150172, -3134.141179853975, 4297.093567266218, -4772.963285968006, -553.4772785025089, -1831.2041158851937, 4834.269851362347, -2524.8632723923783, 5743.42677977097, -540.9795542221024, 481.58444386903443, -2941.6148476011476, 5958.638422503278, -4625.376030775763, 2705.2511650881247, -1247.149526590078, 2220.7774582421666, -3304.684252809445, 2920.0783036372004, -4929.910995258247, 518.3578210502263, -2168.9815232630795, 5389.428202755727, -4661.110337149002, 3208.0981355117588, -1527.6731883784514, 410.3633666197773, -731.1192647203609, 4377.236770333255, -914.5039736533095, -334.4692583161844, -2724.254973192126, 9725.568427162576, -81.81735643975728, 2616.175169623441, -478.8181218868008, -2140.1278603767437, -4278.722406640632, -663.9965825077439, -2874.6390064807397, 4055.129056949137, -4585.918800455058, 4809.950392320639, -2187.6031215044454, 971.4564129653552, -4471.657992398185, -3507.832911894553, -2380.961369185215, 1588.3272677009238, -1511.1345562420074, 5107.738843482621, 921.5950038402249, 1866.8029663311536, -2819.7267343400617, -1324.761711260809, -272.9882425316933, 4850.626878347634, -586.5228636381863, 3270.326465527746, -1132.4793372309384, 6788.765306935606, -360.65015574555895, 971.5664858622769, -958.5524815248932, 749.2403879103946, -3256.5775429960186, 867.0913724282448, -1165.9345321636638, -1888.615077871294, -284.5457016177133, 1033.760240602445, -2714.7343764253997, 3430.798966937348, -3128.191879281433, 6200.832955543605, -2507.8195000602377, 4102.224852623681, -2602.5957652828424, 9059.436204556288, -884.4019571046465, 1244.777296883483, -4461.841949879506, -453.22602007658384, -1032.5352957433959, 7441.011032406284, -1344.9508419427639, -2662.9627267704955, -3113.1424272524127, 8629.882364549161, -2683.3151319374083, 3703.6631363093948, -1310.2912288263274, -1642.106442512978, -5873.04714576877], "policy_predator_policy_reward": [-7518.392711530943, -40.46774997009203, 2581.855125748401, 1241.7305919983055, -2624.158502742243, 2235.1409694337854, -2374.13142060429, 1262.513775201781, 3656.7039032258836, 1781.5939913155385, 2220.9323623118194, 2293.43719239765, 189.8383862144117, -671.2966584338385, 6059.989643244573, 4382.524279757699, 5248.416219843251, 709.7827015876298, 1861.9705719524115, -5846.796182393618, -1375.0985153102379, 1848.6149872426881, 4863.321621390295, 4829.376727049496, 663.051858505448, -6248.631239670878, -574.9701684289155, -2.7440122929259942, -4042.7415893370207, 0.0, -96.9572378953917, -2737.2566716749475, -1222.2446237841277, 2912.574048897974, 3579.551274142678, 1641.123893231959, 8175.092435366448, 1306.5754005424183, -578.742157967312, -266.04825915362255, 550.8462295188106, 609.0950450020396, 2192.4956904114715, -1688.2871795651263, -1594.831355450004, 1709.4204722800978, 4307.720615954346, 1437.6638871618466, 776.5716170657239, 15.065648708311457, 3701.043109193939, -1603.962317153638, 1532.538778156345, -811.5284531126451, -225.63419390222901, -408.8112230698329, 4947.865675022908, 1704.7895375980816, 2662.7026347473247, 3640.7734370161274, 2258.6881109451915, -83.30298936723335, 6627.6350887771805, 5515.690986204079, 3753.5572290912187, -1518.4364169166527, -1498.645275680614, 1778.5391937694694, 7181.1402174077975, 1880.6646609351387, 1833.5579692834938, 2960.3624544448694, -2309.0827857920735, -2522.1949728076656, 3384.8765314644593, -468.0015810044598, -363.67229085613053, 600.9664461148427, 5991.621893319674, -527.2956447251785, -701.7596571259751, 2809.6378329477207, 1155.874162902544, -601.6568444373793, -2200.2986872681645, -720.7835359397673, 523.9909088012007, 2171.023825079835, 7592.62034554961, -2712.516326666482, 1575.9698145548484, 1164.4493932209946, 5424.756514042374, -7899.48053969364, 467.47098067963725, -4777.220768893315, 1318.152257950583, -3857.3199173597036, -2260.1915254622304, -1292.5534802379184, 13017.814960947693, 2740.261612220257, -3289.4363139103016, 5256.93752414975, -3699.891924565992, 3402.030808625337, 1090.369195558151, 1268.0325942188101, 2992.411539841698, -2235.433157573466, 2063.303954100604, 5876.071227517739, -2228.9308680632266, 1914.9191741367997, 4663.369570220419, -6219.993092456787, 3422.1651924576986, 688.5149878126621, -1378.792482718345, 315.7639026268836, 500.762415007895, 4154.849020237636, 340.282532280934, 2217.246830589921, 2574.7955254339327, -564.9628338128965, 1788.7588939826335, 947.999534568217, 1269.1928170474407, -351.23445362204563, 1050.7944172057034, -910.9812359762575, 1547.3707884599578, 278.5608216052746, 2497.9494117345753, 752.633291257478, 1002.1088110704137, 2305.903718119998, -5604.851772884177, -75.89259138739875, 962.9965375530568, -1795.625156461494, 7873.898751902028, 5112.303309179083, 2351.7941264943825, 1461.6713767231658, -1392.8351039506738, 1923.6248474565962, -1152.3592452003022, 304.5368986422406, 3532.9396641564394, 1543.577746585554, 9008.636675198166, 2820.5839218716574, -409.02460187607596, 828.442025332127, -3395.249155670116, -197.449608384584, -525.7159479827518, 1478.6397159916635, 808.8496865785011, 1732.2132130931222, -1269.6865687754414, -608.4461786277265, 2104.739518349097, 159.01187075297182, 2619.7323132444826, -4941.170851446451, 6032.247917219082, 1160.055510018031, 6154.511127573826, 3898.620705615853, 5082.382329256479, 3024.872198143383, 2936.3029932489544, 3369.668499145261, 9521.633775307617, 4215.744957473292, 1560.636960129871, 14.712124625476733, 1649.5889695569667, -3193.5891549647185, 5113.116077077095, 115.84559599254658, -1839.5379337398742, 4726.30074008192, 5778.11103148416, 5012.075668291724, 97.596614603792, 3164.378002886724, -7158.965075451084, 2646.57361803906, 4142.390093042725, 5624.435471599498, -6092.004911759669, 3704.537350725955, 497.1919161967789, 466.7702045021151, 7447.5646746175835, 2595.1575276479352]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.728858438089828, "mean_inference_ms": 1.5802594486081876, "mean_action_processing_ms": 0.3115354190016926, "mean_env_wait_ms": 0.14084717508719485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00599980354309082, "StateBufferConnector_ms": 0.011997580528259277, "ViewRequirementAgentConnector_ms": 0.15500867366790771}, "num_episodes": 18, "episode_return_max": 12056.404596957944, "episode_return_min": 0.0, "episode_return_mean": 3096.5461721349275, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.6083284991731, "num_env_steps_trained_throughput_per_sec": 288.6083284991731, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 14236.728, "restore_workers_time_ms": 0.069, "training_step_time_ms": 14236.61, "sample_time_ms": 1551.353, "learn_time_ms": 12662.639, "learn_throughput": 315.89, "synch_weights_time_ms": 21.706}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "6751e_00000", "date": "2024-08-11_19-19-35", "timestamp": 1723418375, "time_this_iter_s": 13.93164873123169, "time_total_s": 742.5338861942291, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 742.5338861942291, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 45.205000000000005, "ram_util_percent": 82.715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8138866758299252, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.853727138357819, "policy_loss": -0.006106176819632609, "vf_loss": 9.859677728017171, "vf_explained_var": -0.001047530628385998, "kl": 0.012446063854247617, "entropy": 0.8077123138324294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6611197640577321, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.639927511871177, "policy_loss": -0.006241407027596204, "vf_loss": 9.644998270872408, "vf_explained_var": 0.00016543839974378152, "kl": 0.005853250803969752, "entropy": 0.8312203483606773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 12407.113637265968, "episode_reward_min": 0.0, "episode_reward_mean": 3649.823146580462, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5873.04714576877, "predator_policy": -7899.48053969364}, "policy_reward_max": {"prey_policy": 9725.568427162576, "predator_policy": 13017.814960947693}, "policy_reward_mean": {"prey_policy": 173.4410573610435, "predator_policy": 1651.470515929187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5063.2611402375305, 0.0, 3199.0645529187314, 4207.10711726605, 3493.6018250971333, 6735.691656629316, 1485.615150454729, 4019.7725382280337, 5881.409115485551, 336.8697551291941, 5659.857077442664, 139.61019105612945, 517.7565122429816, 5310.7914985620455, 6000.574303010028, 1901.9855867684653, 8022.558991613174, 1726.0922187935, 627.8212655129475, 2935.3236274721758, 0.0, 2518.2002926369178, 1063.0035841940044, 2117.209929223765, 2367.3442545997304, 3.552713678800501e-15, 3921.558633443881, 1148.187273225826, 4632.947692912443, 1.4210854715202004e-14, 2917.975317218234, 2624.5271607806594, 8476.458834549827, 9952.229704559068, 2559.5895499826647, 2737.7988680731605, 281.1086635664403, 5554.693787230641, 1995.394885043536, 3645.823703312502, 1650.6497765382433, 270.2338116360516, 6113.713073743578, 1473.6225683035768, 0.0, 1086.1347263380005, 1646.2762290321116, 1820.2381283627496, 1505.1757119646472, 6713.315499671995, 249.2882976821013, 3963.006706451234, 1304.7284288282033, 6567.351794063722, 274.8299142290641, 7.105427357601002e-15, 1774.5249242581338, 1576.3158313091735, 5940.426315990052, 496.6101349149675, 2436.635083268142, 0.0, 943.3129458791219, 2385.9712673062786, 4401.598517398886, 4106.676612988089, 7205.317431574514, 7545.794678104055, 7808.411367664426, 4132.810712905207, 12056.404596957944, 1877.956172411262, 2149.013270075603, 6728.590760410477, 11061.797053793714, 7573.122046779873, 1776.213301670536, 1583.6687330515044, 3990.7204106192967, 3559.099671578055, 3357.334028181961, 2527.568613983784, 0.0, 757.9810424856729, 10218.31715287463, 3968.2415884851775, 1468.458221834246, 4862.484998915523, 8857.504786304597, 3191.1129762217183, 4684.460280193798, 8323.398086015119, 1764.2587308003785, 10922.829661044092, 3457.6816107780655, 744.184591331936, 3157.4514807838113, 5865.344921344755, 12407.113637265968, 10918.215482972586], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1552.190803724473, -2866.215891946858, 2199.3570603947073, -1354.56664327377, 3466.983793697972, -1427.8605153000942, 5295.543463106447, -1592.6448566867398, 5284.513883374555, -1905.501175107524, 1367.508503902317, -377.20135038919693, 6353.45929087983, -5659.481406199133, 3404.2519096139144, -1481.560163426177, 5337.558013748352, -177.15922330650233, 2182.760513100261, -1211.4453409990067, 752.0493669070745, -1744.8475020854041, -1937.623976753359, -4226.2419039539645, 2857.9131668222353, -4515.541776157212, -1812.8382416291502, -5019.69633479006, 3644.0502032587706, 121.40328757670972, 2802.0190871301047, -1179.9274184504927, -885.5571182441129, -153.68876848565245, 580.0364239062642, -3647.8646288411255, 3892.0414581117348, 1567.0575660009524, 2206.5860295016173, -2188.1373524894425, 4667.8073939773285, -4905.101549236044, 1976.0197716030618, -4922.14572756064, 414.8703155205265, -1459.7449071482633, 2668.0311626502976, -1105.0385518917028, 3417.4676526309113, 1870.95882517675, 1996.3747628083363, -4691.389496689376, 3713.6535348421003, -4672.198920281346, 2084.8582430629745, -3677.090177612986, 7719.116759947441, -611.4450413837277, 5985.820542837181, -1676.0707546234983, 7117.078639283871, -1659.9356626565145, 7371.865307824793, -1194.593141343976, -3429.530219638044, -3852.087518980111, 6969.52138510597, 1015.2071092136529, 6719.460884019134, -3862.010218095806, 3513.538258150172, -3134.141179853975, 4297.093567266218, -4772.963285968006, -553.4772785025089, -1831.2041158851937, 4834.269851362347, -2524.8632723923783, 5743.42677977097, -540.9795542221024, 481.58444386903443, -2941.6148476011476, 5958.638422503278, -4625.376030775763, 2705.2511650881247, -1247.149526590078, 2220.7774582421666, -3304.684252809445, 2920.0783036372004, -4929.910995258247, 518.3578210502263, -2168.9815232630795, 5389.428202755727, -4661.110337149002, 3208.0981355117588, -1527.6731883784514, 410.3633666197773, -731.1192647203609, 4377.236770333255, -914.5039736533095, -334.4692583161844, -2724.254973192126, 9725.568427162576, -81.81735643975728, 2616.175169623441, -478.8181218868008, -2140.1278603767437, -4278.722406640632, -663.9965825077439, -2874.6390064807397, 4055.129056949137, -4585.918800455058, 4809.950392320639, -2187.6031215044454, 971.4564129653552, -4471.657992398185, -3507.832911894553, -2380.961369185215, 1588.3272677009238, -1511.1345562420074, 5107.738843482621, 921.5950038402249, 1866.8029663311536, -2819.7267343400617, -1324.761711260809, -272.9882425316933, 4850.626878347634, -586.5228636381863, 3270.326465527746, -1132.4793372309384, 6788.765306935606, -360.65015574555895, 971.5664858622769, -958.5524815248932, 749.2403879103946, -3256.5775429960186, 867.0913724282448, -1165.9345321636638, -1888.615077871294, -284.5457016177133, 1033.760240602445, -2714.7343764253997, 3430.798966937348, -3128.191879281433, 6200.832955543605, -2507.8195000602377, 4102.224852623681, -2602.5957652828424, 9059.436204556288, -884.4019571046465, 1244.777296883483, -4461.841949879506, -453.22602007658384, -1032.5352957433959, 7441.011032406284, -1344.9508419427639, -2662.9627267704955, -3113.1424272524127, 8629.882364549161, -2683.3151319374083, 3703.6631363093948, -1310.2912288263274, -1642.106442512978, -5873.04714576877, 7578.08063689625, -1183.4007218875122, 3507.079282313493, -3616.02776322853, -1990.4340767742883, -2687.079691731233, 3647.735958218182, -2220.5482764848807, -339.27853399834623, -4226.916272852153, 3889.939228921536, -4410.582013142577, -921.739224218653, -577.6710956539538, 2937.96427021563, -2.3451229906048114, -3191.661235470017, -729.5674988279873, 2854.9137339417994, -1921.5239043939634, 1303.600826929188, -3923.434010807021, 1388.4432248828514, -1184.7218098308713, 1853.2343501321454, -5581.2048682756185, 4868.686546622399, 354.99056096663605, 1084.8724951145057, -2569.2110790155875, 480.3343851510084, -1231.2613727602825, -991.1092083553406, -4373.426539081282, 444.93420861298034, -1507.1509687165221], "policy_predator_policy_reward": [8175.092435366448, 1306.5754005424183, -578.742157967312, -266.04825915362255, 550.8462295188106, 609.0950450020396, 2192.4956904114715, -1688.2871795651263, -1594.831355450004, 1709.4204722800978, 4307.720615954346, 1437.6638871618466, 776.5716170657239, 15.065648708311457, 3701.043109193939, -1603.962317153638, 1532.538778156345, -811.5284531126451, -225.63419390222901, -408.8112230698329, 4947.865675022908, 1704.7895375980816, 2662.7026347473247, 3640.7734370161274, 2258.6881109451915, -83.30298936723335, 6627.6350887771805, 5515.690986204079, 3753.5572290912187, -1518.4364169166527, -1498.645275680614, 1778.5391937694694, 7181.1402174077975, 1880.6646609351387, 1833.5579692834938, 2960.3624544448694, -2309.0827857920735, -2522.1949728076656, 3384.8765314644593, -468.0015810044598, -363.67229085613053, 600.9664461148427, 5991.621893319674, -527.2956447251785, -701.7596571259751, 2809.6378329477207, 1155.874162902544, -601.6568444373793, -2200.2986872681645, -720.7835359397673, 523.9909088012007, 2171.023825079835, 7592.62034554961, -2712.516326666482, 1575.9698145548484, 1164.4493932209946, 5424.756514042374, -7899.48053969364, 467.47098067963725, -4777.220768893315, 1318.152257950583, -3857.3199173597036, -2260.1915254622304, -1292.5534802379184, 13017.814960947693, 2740.261612220257, -3289.4363139103016, 5256.93752414975, -3699.891924565992, 3402.030808625337, 1090.369195558151, 1268.0325942188101, 2992.411539841698, -2235.433157573466, 2063.303954100604, 5876.071227517739, -2228.9308680632266, 1914.9191741367997, 4663.369570220419, -6219.993092456787, 3422.1651924576986, 688.5149878126621, -1378.792482718345, 315.7639026268836, 500.762415007895, 4154.849020237636, 340.282532280934, 2217.246830589921, 2574.7955254339327, -564.9628338128965, 1788.7588939826335, 947.999534568217, 1269.1928170474407, -351.23445362204563, 1050.7944172057034, -910.9812359762575, 1547.3707884599578, 278.5608216052746, 2497.9494117345753, 752.633291257478, 1002.1088110704137, 2305.903718119998, -5604.851772884177, -75.89259138739875, 962.9965375530568, -1795.625156461494, 7873.898751902028, 5112.303309179083, 2351.7941264943825, 1461.6713767231658, -1392.8351039506738, 1923.6248474565962, -1152.3592452003022, 304.5368986422406, 3532.9396641564394, 1543.577746585554, 9008.636675198166, 2820.5839218716574, -409.02460187607596, 828.442025332127, -3395.249155670116, -197.449608384584, -525.7159479827518, 1478.6397159916635, 808.8496865785011, 1732.2132130931222, -1269.6865687754414, -608.4461786277265, 2104.739518349097, 159.01187075297182, 2619.7323132444826, -4941.170851446451, 6032.247917219082, 1160.055510018031, 6154.511127573826, 3898.620705615853, 5082.382329256479, 3024.872198143383, 2936.3029932489544, 3369.668499145261, 9521.633775307617, 4215.744957473292, 1560.636960129871, 14.712124625476733, 1649.5889695569667, -3193.5891549647185, 5113.116077077095, 115.84559599254658, -1839.5379337398742, 4726.30074008192, 5778.11103148416, 5012.075668291724, 97.596614603792, 3164.378002886724, -7158.965075451084, 2646.57361803906, 4142.390093042725, 5624.435471599498, -6092.004911759669, 3704.537350725955, 497.1919161967789, 466.7702045021151, 7447.5646746175835, 2595.1575276479352, -776.3359209916622, -5618.343994017078, -1798.3645273850166, 2665.2940507857243, 12046.465032969973, 2849.3658884101787, 2553.615162117259, -12.561255365371437, 4028.62638341762, 2006.026645267119, 4295.164034765311, 1087.963748371248, 8717.429561507057, 1639.485544670147, 1652.2875448841369, -1396.793715887445, 5842.542913388591, 2763.146101103218, 4698.651509154943, 2691.3567473123385, 1635.2571624352004, 2748.8347522430117, 8110.960571203644, 2608.147674788479, 1796.697385234091, 5388.954743687453, -2957.6778496373418, -1521.814666619756, 1620.6740582800644, 3021.1160064048236, 3506.3714144298406, 3109.9004945241877, 11917.439492097827, 5854.209892604753, 9708.847668003298, 2271.5845750728245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7322395481505092, "mean_inference_ms": 1.5872878917627185, "mean_action_processing_ms": 0.31315473101048086, "mean_env_wait_ms": 0.14148416615814574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007633566856384277, "StateBufferConnector_ms": 0.012007355690002441, "ViewRequirementAgentConnector_ms": 0.1560525894165039}, "num_episodes": 18, "episode_return_max": 12407.113637265968, "episode_return_min": 0.0, "episode_return_mean": 3649.823146580462, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.02561291780563, "num_env_steps_trained_throughput_per_sec": 289.02561291780563, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 14195.121, "restore_workers_time_ms": 0.067, "training_step_time_ms": 14195.008, "sample_time_ms": 1564.167, "learn_time_ms": 12609.174, "learn_throughput": 317.229, "synch_weights_time_ms": 20.734}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "6751e_00000", "date": "2024-08-11_19-19-49", "timestamp": 1723418389, "time_this_iter_s": 13.890434980392456, "time_total_s": 756.4243211746216, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 756.4243211746216, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 46.96315789473684, "ram_util_percent": 83.07894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5900638458195817, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.958649674672928, "policy_loss": -0.005447803450521653, "vf_loss": 9.96398631151391, "vf_explained_var": -0.0034177215641768522, "kl": 0.008894082229059037, "entropy": 0.6890548685871104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7597377499417654, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.284220401319876, "policy_loss": -0.010308906810466575, "vf_loss": 9.292706903326449, "vf_explained_var": 0.0003355436539523816, "kl": 0.009112013840346196, "entropy": 0.8012740126362553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 12774.68231337311, "episode_reward_min": 0.0, "episode_reward_mean": 3632.945669513871, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6478.835618647361, "predator_policy": -7899.48053969364}, "policy_reward_max": {"prey_policy": 9725.568427162576, "predator_policy": 13017.814960947693}, "policy_reward_mean": {"prey_policy": 141.2918940082169, "predator_policy": 1675.1809407487185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [627.8212655129475, 2935.3236274721758, 0.0, 2518.2002926369178, 1063.0035841940044, 2117.209929223765, 2367.3442545997304, 3.552713678800501e-15, 3921.558633443881, 1148.187273225826, 4632.947692912443, 1.4210854715202004e-14, 2917.975317218234, 2624.5271607806594, 8476.458834549827, 9952.229704559068, 2559.5895499826647, 2737.7988680731605, 281.1086635664403, 5554.693787230641, 1995.394885043536, 3645.823703312502, 1650.6497765382433, 270.2338116360516, 6113.713073743578, 1473.6225683035768, 0.0, 1086.1347263380005, 1646.2762290321116, 1820.2381283627496, 1505.1757119646472, 6713.315499671995, 249.2882976821013, 3963.006706451234, 1304.7284288282033, 6567.351794063722, 274.8299142290641, 7.105427357601002e-15, 1774.5249242581338, 1576.3158313091735, 5940.426315990052, 496.6101349149675, 2436.635083268142, 0.0, 943.3129458791219, 2385.9712673062786, 4401.598517398886, 4106.676612988089, 7205.317431574514, 7545.794678104055, 7808.411367664426, 4132.810712905207, 12056.404596957944, 1877.956172411262, 2149.013270075603, 6728.590760410477, 11061.797053793714, 7573.122046779873, 1776.213301670536, 1583.6687330515044, 3990.7204106192967, 3559.099671578055, 3357.334028181961, 2527.568613983784, 0.0, 757.9810424856729, 10218.31715287463, 3968.2415884851775, 1468.458221834246, 4862.484998915523, 8857.504786304597, 3191.1129762217183, 4684.460280193798, 8323.398086015119, 1764.2587308003785, 10922.829661044092, 3457.6816107780655, 744.184591331936, 3157.4514807838113, 5865.344921344755, 12407.113637265968, 10918.215482972586, 3596.411958968007, 1844.803919575813, 12774.68231337311, 113.37111302593514, 488.3234526075192, 1309.1471475946832, 5775.533945798786, 2313.3913480199967, 4395.768378629504, 994.4157194954341, 3303.872406359957, 2849.3403803376946, 6938.817790952204, 1964.1396286730708, 986.1631223033843, 4558.907147973128, 6897.513056416989, 909.268694171064], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3892.0414581117348, 1567.0575660009524, 2206.5860295016173, -2188.1373524894425, 4667.8073939773285, -4905.101549236044, 1976.0197716030618, -4922.14572756064, 414.8703155205265, -1459.7449071482633, 2668.0311626502976, -1105.0385518917028, 3417.4676526309113, 1870.95882517675, 1996.3747628083363, -4691.389496689376, 3713.6535348421003, -4672.198920281346, 2084.8582430629745, -3677.090177612986, 7719.116759947441, -611.4450413837277, 5985.820542837181, -1676.0707546234983, 7117.078639283871, -1659.9356626565145, 7371.865307824793, -1194.593141343976, -3429.530219638044, -3852.087518980111, 6969.52138510597, 1015.2071092136529, 6719.460884019134, -3862.010218095806, 3513.538258150172, -3134.141179853975, 4297.093567266218, -4772.963285968006, -553.4772785025089, -1831.2041158851937, 4834.269851362347, -2524.8632723923783, 5743.42677977097, -540.9795542221024, 481.58444386903443, -2941.6148476011476, 5958.638422503278, -4625.376030775763, 2705.2511650881247, -1247.149526590078, 2220.7774582421666, -3304.684252809445, 2920.0783036372004, -4929.910995258247, 518.3578210502263, -2168.9815232630795, 5389.428202755727, -4661.110337149002, 3208.0981355117588, -1527.6731883784514, 410.3633666197773, -731.1192647203609, 4377.236770333255, -914.5039736533095, -334.4692583161844, -2724.254973192126, 9725.568427162576, -81.81735643975728, 2616.175169623441, -478.8181218868008, -2140.1278603767437, -4278.722406640632, -663.9965825077439, -2874.6390064807397, 4055.129056949137, -4585.918800455058, 4809.950392320639, -2187.6031215044454, 971.4564129653552, -4471.657992398185, -3507.832911894553, -2380.961369185215, 1588.3272677009238, -1511.1345562420074, 5107.738843482621, 921.5950038402249, 1866.8029663311536, -2819.7267343400617, -1324.761711260809, -272.9882425316933, 4850.626878347634, -586.5228636381863, 3270.326465527746, -1132.4793372309384, 6788.765306935606, -360.65015574555895, 971.5664858622769, -958.5524815248932, 749.2403879103946, -3256.5775429960186, 867.0913724282448, -1165.9345321636638, -1888.615077871294, -284.5457016177133, 1033.760240602445, -2714.7343764253997, 3430.798966937348, -3128.191879281433, 6200.832955543605, -2507.8195000602377, 4102.224852623681, -2602.5957652828424, 9059.436204556288, -884.4019571046465, 1244.777296883483, -4461.841949879506, -453.22602007658384, -1032.5352957433959, 7441.011032406284, -1344.9508419427639, -2662.9627267704955, -3113.1424272524127, 8629.882364549161, -2683.3151319374083, 3703.6631363093948, -1310.2912288263274, -1642.106442512978, -5873.04714576877, 7578.08063689625, -1183.4007218875122, 3507.079282313493, -3616.02776322853, -1990.4340767742883, -2687.079691731233, 3647.735958218182, -2220.5482764848807, -339.27853399834623, -4226.916272852153, 3889.939228921536, -4410.582013142577, -921.739224218653, -577.6710956539538, 2937.96427021563, -2.3451229906048114, -3191.661235470017, -729.5674988279873, 2854.9137339417994, -1921.5239043939634, 1303.600826929188, -3923.434010807021, 1388.4432248828514, -1184.7218098308713, 1853.2343501321454, -5581.2048682756185, 4868.686546622399, 354.99056096663605, 1084.8724951145057, -2569.2110790155875, 480.3343851510084, -1231.2613727602825, -991.1092083553406, -4373.426539081282, 444.93420861298034, -1507.1509687165221, 5534.3487598356, -2829.047072967355, -770.5358382976638, -1688.2759897535468, 1139.5493884699838, -2513.44793734529, 3114.8252439955945, -4640.83662810195, 4086.052034746821, -1420.598638868626, -3769.5689674956457, -4099.590459304033, 379.14866048135974, -1596.618244156804, 5353.656339055743, -3260.8805304339385, 736.9825007977294, 972.2321654000032, 6336.800556386457, 182.58945966585276, 1183.8368360556, 328.57699104189777, 4538.89464784118, -3572.977723339283, -1496.7156381951518, -4153.526125526116, 8655.373395195453, -290.5850573997358, 30.521741368607366, 33.95192974325667, -3615.3421885898274, -5940.207150842134, 7743.730259752884, -5089.583060009223, 1366.0222165438522, -6478.835618647361], "policy_predator_policy_reward": [-2309.0827857920735, -2522.1949728076656, 3384.8765314644593, -468.0015810044598, -363.67229085613053, 600.9664461148427, 5991.621893319674, -527.2956447251785, -701.7596571259751, 2809.6378329477207, 1155.874162902544, -601.6568444373793, -2200.2986872681645, -720.7835359397673, 523.9909088012007, 2171.023825079835, 7592.62034554961, -2712.516326666482, 1575.9698145548484, 1164.4493932209946, 5424.756514042374, -7899.48053969364, 467.47098067963725, -4777.220768893315, 1318.152257950583, -3857.3199173597036, -2260.1915254622304, -1292.5534802379184, 13017.814960947693, 2740.261612220257, -3289.4363139103016, 5256.93752414975, -3699.891924565992, 3402.030808625337, 1090.369195558151, 1268.0325942188101, 2992.411539841698, -2235.433157573466, 2063.303954100604, 5876.071227517739, -2228.9308680632266, 1914.9191741367997, 4663.369570220419, -6219.993092456787, 3422.1651924576986, 688.5149878126621, -1378.792482718345, 315.7639026268836, 500.762415007895, 4154.849020237636, 340.282532280934, 2217.246830589921, 2574.7955254339327, -564.9628338128965, 1788.7588939826335, 947.999534568217, 1269.1928170474407, -351.23445362204563, 1050.7944172057034, -910.9812359762575, 1547.3707884599578, 278.5608216052746, 2497.9494117345753, 752.633291257478, 1002.1088110704137, 2305.903718119998, -5604.851772884177, -75.89259138739875, 962.9965375530568, -1795.625156461494, 7873.898751902028, 5112.303309179083, 2351.7941264943825, 1461.6713767231658, -1392.8351039506738, 1923.6248474565962, -1152.3592452003022, 304.5368986422406, 3532.9396641564394, 1543.577746585554, 9008.636675198166, 2820.5839218716574, -409.02460187607596, 828.442025332127, -3395.249155670116, -197.449608384584, -525.7159479827518, 1478.6397159916635, 808.8496865785011, 1732.2132130931222, -1269.6865687754414, -608.4461786277265, 2104.739518349097, 159.01187075297182, 2619.7323132444826, -4941.170851446451, 6032.247917219082, 1160.055510018031, 6154.511127573826, 3898.620705615853, 5082.382329256479, 3024.872198143383, 2936.3029932489544, 3369.668499145261, 9521.633775307617, 4215.744957473292, 1560.636960129871, 14.712124625476733, 1649.5889695569667, -3193.5891549647185, 5113.116077077095, 115.84559599254658, -1839.5379337398742, 4726.30074008192, 5778.11103148416, 5012.075668291724, 97.596614603792, 3164.378002886724, -7158.965075451084, 2646.57361803906, 4142.390093042725, 5624.435471599498, -6092.004911759669, 3704.537350725955, 497.1919161967789, 466.7702045021151, 7447.5646746175835, 2595.1575276479352, -776.3359209916622, -5618.343994017078, -1798.3645273850166, 2665.2940507857243, 12046.465032969973, 2849.3658884101787, 2553.615162117259, -12.561255365371437, 4028.62638341762, 2006.026645267119, 4295.164034765311, 1087.963748371248, 8717.429561507057, 1639.485544670147, 1652.2875448841369, -1396.793715887445, 5842.542913388591, 2763.146101103218, 4698.651509154943, 2691.3567473123385, 1635.2571624352004, 2748.8347522430117, 8110.960571203644, 2608.147674788479, 1796.697385234091, 5388.954743687453, -2957.6778496373418, -1521.814666619756, 1620.6740582800644, 3021.1160064048236, 3506.3714144298406, 3109.9004945241877, 11917.439492097827, 5854.209892604753, 9708.847668003298, 2271.5845750728245, -53.28152940538442, 944.3918015051379, 1597.1975965063355, 2706.4181511206893, 7565.076665629129, 6583.504196619298, -2003.1334170312073, 3642.515914163499, -1274.86078802722, -902.2691552434507, 8341.221890155499, 837.084684238861, 5046.950830608811, 1946.052698865412, 1219.4034009114878, -998.7878615133, 2639.827599748341, 46.72611268343461, -2747.536210946972, -2777.4380856099083, 2542.186866894372, -750.7282876319133, 3592.492537225874, -1709.0690813900733, 7065.736511473479, 5523.323043199999, 180.71222416370748, -6581.360933286353, -1967.893506268348, 2889.582957459869, 6951.348068754795, 7163.1084186502985, -3688.9095369126526, 7932.2753935859755, 2258.741465713024, 3763.340630561548]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7347999910178612, "mean_inference_ms": 1.592210305835805, "mean_action_processing_ms": 0.3142290469074706, "mean_env_wait_ms": 0.14191894711361427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007256865501403809, "StateBufferConnector_ms": 0.006651878356933594, "ViewRequirementAgentConnector_ms": 0.15656828880310059}, "num_episodes": 18, "episode_return_max": 12774.68231337311, "episode_return_min": 0.0, "episode_return_mean": 3632.945669513871, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.60812473940797, "num_env_steps_trained_throughput_per_sec": 293.60812473940797, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 14187.277, "restore_workers_time_ms": 0.067, "training_step_time_ms": 14187.165, "sample_time_ms": 1563.513, "learn_time_ms": 12602.221, "learn_throughput": 317.404, "synch_weights_time_ms": 20.511}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "6751e_00000", "date": "2024-08-11_19-20-03", "timestamp": 1723418403, "time_this_iter_s": 13.683032989501953, "time_total_s": 770.1073541641235, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaadb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 770.1073541641235, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 45.045, "ram_util_percent": 82.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.634988496196333, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.942663151877268, "policy_loss": -0.004267408382320018, "vf_loss": 9.946838291107662, "vf_explained_var": -0.006205455493674707, "kl": 0.00738105493237354, "entropy": 0.709904028751232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6830537918541166, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.518231459017153, "policy_loss": -0.00865407473686097, "vf_loss": 9.524962048808103, "vf_explained_var": 0.00020764517405676464, "kl": 0.009617423871607753, "entropy": 0.7983080282097771, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 12774.68231337311, "episode_reward_min": -1.2434497875801753e-14, "episode_reward_mean": 3506.663006254937, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6478.835618647361, "predator_policy": -7158.965075451084}, "policy_reward_max": {"prey_policy": 9725.568427162576, "predator_policy": 12046.465032969973}, "policy_reward_mean": {"prey_policy": 14.835269996933611, "predator_policy": 1738.4962331305346}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1650.6497765382433, 270.2338116360516, 6113.713073743578, 1473.6225683035768, 0.0, 1086.1347263380005, 1646.2762290321116, 1820.2381283627496, 1505.1757119646472, 6713.315499671995, 249.2882976821013, 3963.006706451234, 1304.7284288282033, 6567.351794063722, 274.8299142290641, 7.105427357601002e-15, 1774.5249242581338, 1576.3158313091735, 5940.426315990052, 496.6101349149675, 2436.635083268142, 0.0, 943.3129458791219, 2385.9712673062786, 4401.598517398886, 4106.676612988089, 7205.317431574514, 7545.794678104055, 7808.411367664426, 4132.810712905207, 12056.404596957944, 1877.956172411262, 2149.013270075603, 6728.590760410477, 11061.797053793714, 7573.122046779873, 1776.213301670536, 1583.6687330515044, 3990.7204106192967, 3559.099671578055, 3357.334028181961, 2527.568613983784, 0.0, 757.9810424856729, 10218.31715287463, 3968.2415884851775, 1468.458221834246, 4862.484998915523, 8857.504786304597, 3191.1129762217183, 4684.460280193798, 8323.398086015119, 1764.2587308003785, 10922.829661044092, 3457.6816107780655, 744.184591331936, 3157.4514807838113, 5865.344921344755, 12407.113637265968, 10918.215482972586, 3596.411958968007, 1844.803919575813, 12774.68231337311, 113.37111302593514, 488.3234526075192, 1309.1471475946832, 5775.533945798786, 2313.3913480199967, 4395.768378629504, 994.4157194954341, 3303.872406359957, 2849.3403803376946, 6938.817790952204, 1964.1396286730708, 986.1631223033843, 4558.907147973128, 6897.513056416989, 909.268694171064, 1798.3983281799672, 1930.4159615133706, 3886.1192857935876, -1.2434497875801753e-14, 1971.4064919201826, 991.2847278464085, 3326.9375096661893, 3564.49334175401, 122.58925796491052, 1.4210854715202004e-14, 5795.015928963903, 575.8702670329021, 109.00523305114426, 1131.1479481335075, 6639.284132251206, 483.80155295398447, 991.248248344355, 2605.039797181395, 3899.23767600291, 1997.5743793199129, 4545.567636182282, 3084.4929975888717], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [481.58444386903443, -2941.6148476011476, 5958.638422503278, -4625.376030775763, 2705.2511650881247, -1247.149526590078, 2220.7774582421666, -3304.684252809445, 2920.0783036372004, -4929.910995258247, 518.3578210502263, -2168.9815232630795, 5389.428202755727, -4661.110337149002, 3208.0981355117588, -1527.6731883784514, 410.3633666197773, -731.1192647203609, 4377.236770333255, -914.5039736533095, -334.4692583161844, -2724.254973192126, 9725.568427162576, -81.81735643975728, 2616.175169623441, -478.8181218868008, -2140.1278603767437, -4278.722406640632, -663.9965825077439, -2874.6390064807397, 4055.129056949137, -4585.918800455058, 4809.950392320639, -2187.6031215044454, 971.4564129653552, -4471.657992398185, -3507.832911894553, -2380.961369185215, 1588.3272677009238, -1511.1345562420074, 5107.738843482621, 921.5950038402249, 1866.8029663311536, -2819.7267343400617, -1324.761711260809, -272.9882425316933, 4850.626878347634, -586.5228636381863, 3270.326465527746, -1132.4793372309384, 6788.765306935606, -360.65015574555895, 971.5664858622769, -958.5524815248932, 749.2403879103946, -3256.5775429960186, 867.0913724282448, -1165.9345321636638, -1888.615077871294, -284.5457016177133, 1033.760240602445, -2714.7343764253997, 3430.798966937348, -3128.191879281433, 6200.832955543605, -2507.8195000602377, 4102.224852623681, -2602.5957652828424, 9059.436204556288, -884.4019571046465, 1244.777296883483, -4461.841949879506, -453.22602007658384, -1032.5352957433959, 7441.011032406284, -1344.9508419427639, -2662.9627267704955, -3113.1424272524127, 8629.882364549161, -2683.3151319374083, 3703.6631363093948, -1310.2912288263274, -1642.106442512978, -5873.04714576877, 7578.08063689625, -1183.4007218875122, 3507.079282313493, -3616.02776322853, -1990.4340767742883, -2687.079691731233, 3647.735958218182, -2220.5482764848807, -339.27853399834623, -4226.916272852153, 3889.939228921536, -4410.582013142577, -921.739224218653, -577.6710956539538, 2937.96427021563, -2.3451229906048114, -3191.661235470017, -729.5674988279873, 2854.9137339417994, -1921.5239043939634, 1303.600826929188, -3923.434010807021, 1388.4432248828514, -1184.7218098308713, 1853.2343501321454, -5581.2048682756185, 4868.686546622399, 354.99056096663605, 1084.8724951145057, -2569.2110790155875, 480.3343851510084, -1231.2613727602825, -991.1092083553406, -4373.426539081282, 444.93420861298034, -1507.1509687165221, 5534.3487598356, -2829.047072967355, -770.5358382976638, -1688.2759897535468, 1139.5493884699838, -2513.44793734529, 3114.8252439955945, -4640.83662810195, 4086.052034746821, -1420.598638868626, -3769.5689674956457, -4099.590459304033, 379.14866048135974, -1596.618244156804, 5353.656339055743, -3260.8805304339385, 736.9825007977294, 972.2321654000032, 6336.800556386457, 182.58945966585276, 1183.8368360556, 328.57699104189777, 4538.89464784118, -3572.977723339283, -1496.7156381951518, -4153.526125526116, 8655.373395195453, -290.5850573997358, 30.521741368607366, 33.95192974325667, -3615.3421885898274, -5940.207150842134, 7743.730259752884, -5089.583060009223, 1366.0222165438522, -6478.835618647361, -2367.2258416746663, -3272.8674550911564, 2349.013931985666, -2931.807403526302, 231.39305172928226, -3869.791633960832, -1950.7569304306692, -5207.567339119201, -729.5287210990147, -884.0301825328211, -589.8213998647244, -1286.4009492523612, -2123.6806888230853, -3794.913656342331, -807.4495701951598, -764.2255400951776, -33.85415822892128, -491.33362802954645, 18.2248442141412, -644.3579398066676, 6431.997327114808, 1072.3484539651852, 4014.7314330816866, 886.097159852959, 3719.4817956508095, -469.072496960961, 5129.097790783298, -895.6827157917551, 8082.442488202125, -427.65152856388175, 3357.183089838859, -2149.6288097623933, 4550.335348630264, -2060.3743662606803, 5241.109594958435, -2241.7772770068627, 5688.322994774824, -531.8629048785556, -253.82238039617062, -5953.199147876994, 1026.602088602232, -448.9688385500947, 6850.312004771945, -2260.3868220794716], "policy_predator_policy_reward": [3422.1651924576986, 688.5149878126621, -1378.792482718345, 315.7639026268836, 500.762415007895, 4154.849020237636, 340.282532280934, 2217.246830589921, 2574.7955254339327, -564.9628338128965, 1788.7588939826335, 947.999534568217, 1269.1928170474407, -351.23445362204563, 1050.7944172057034, -910.9812359762575, 1547.3707884599578, 278.5608216052746, 2497.9494117345753, 752.633291257478, 1002.1088110704137, 2305.903718119998, -5604.851772884177, -75.89259138739875, 962.9965375530568, -1795.625156461494, 7873.898751902028, 5112.303309179083, 2351.7941264943825, 1461.6713767231658, -1392.8351039506738, 1923.6248474565962, -1152.3592452003022, 304.5368986422406, 3532.9396641564394, 1543.577746585554, 9008.636675198166, 2820.5839218716574, -409.02460187607596, 828.442025332127, -3395.249155670116, -197.449608384584, -525.7159479827518, 1478.6397159916635, 808.8496865785011, 1732.2132130931222, -1269.6865687754414, -608.4461786277265, 2104.739518349097, 159.01187075297182, 2619.7323132444826, -4941.170851446451, 6032.247917219082, 1160.055510018031, 6154.511127573826, 3898.620705615853, 5082.382329256479, 3024.872198143383, 2936.3029932489544, 3369.668499145261, 9521.633775307617, 4215.744957473292, 1560.636960129871, 14.712124625476733, 1649.5889695569667, -3193.5891549647185, 5113.116077077095, 115.84559599254658, -1839.5379337398742, 4726.30074008192, 5778.11103148416, 5012.075668291724, 97.596614603792, 3164.378002886724, -7158.965075451084, 2646.57361803906, 4142.390093042725, 5624.435471599498, -6092.004911759669, 3704.537350725955, 497.1919161967789, 466.7702045021151, 7447.5646746175835, 2595.1575276479352, -776.3359209916622, -5618.343994017078, -1798.3645273850166, 2665.2940507857243, 12046.465032969973, 2849.3658884101787, 2553.615162117259, -12.561255365371437, 4028.62638341762, 2006.026645267119, 4295.164034765311, 1087.963748371248, 8717.429561507057, 1639.485544670147, 1652.2875448841369, -1396.793715887445, 5842.542913388591, 2763.146101103218, 4698.651509154943, 2691.3567473123385, 1635.2571624352004, 2748.8347522430117, 8110.960571203644, 2608.147674788479, 1796.697385234091, 5388.954743687453, -2957.6778496373418, -1521.814666619756, 1620.6740582800644, 3021.1160064048236, 3506.3714144298406, 3109.9004945241877, 11917.439492097827, 5854.209892604753, 9708.847668003298, 2271.5845750728245, -53.28152940538442, 944.3918015051379, 1597.1975965063355, 2706.4181511206893, 7565.076665629129, 6583.504196619298, -2003.1334170312073, 3642.515914163499, -1274.86078802722, -902.2691552434507, 8341.221890155499, 837.084684238861, 5046.950830608811, 1946.052698865412, 1219.4034009114878, -998.7878615133, 2639.827599748341, 46.72611268343461, -2747.536210946972, -2777.4380856099083, 2542.186866894372, -750.7282876319133, 3592.492537225874, -1709.0690813900733, 7065.736511473479, 5523.323043199999, 180.71222416370748, -6581.360933286353, -1967.893506268348, 2889.582957459869, 6951.348068754795, 7163.1084186502985, -3688.9095369126526, 7932.2753935859755, 2258.741465713024, 3763.340630561548, 3471.468788230384, 3967.0228367154036, 2735.368365459238, -222.1589324052388, 3558.273090203177, 3966.2447778219594, 1134.9713646380815, 6023.352904911791, 1154.0186539046056, 2430.9467416474126, 2121.977232990367, 745.5298439731241, 6347.59128598492, 2897.940568846685, 2663.7506176958896, 2472.417834348465, 706.1398552394004, -58.362811016022206, 1343.7716656906478, -717.6385700981208, -99.42076594687022, -1609.9090861692175, 159.6431870254814, -4484.601512927231, -49.60105474959229, -3091.803010889112, -462.14705782136156, -2640.120069036679, -7117.510015886015, 6102.003188498974, 886.4303192537467, -1610.1830463762308, -4217.881734491184, 2719.1690004659545, 1014.8752547724215, -1409.1677755426026, -1907.099753587739, 649.8773396943776, 600.1583771412004, 7604.437530451877, 1703.85221923852, 2264.0821668916265, -742.3933244003239, -763.0388607032745]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7372940436747933, "mean_inference_ms": 1.5970179333161736, "mean_action_processing_ms": 0.3150517420836509, "mean_env_wait_ms": 0.1422700026663138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007418632507324219, "StateBufferConnector_ms": 0.006757497787475586, "ViewRequirementAgentConnector_ms": 0.1562047004699707}, "num_episodes": 22, "episode_return_max": 12774.68231337311, "episode_return_min": -1.2434497875801753e-14, "episode_return_mean": 3506.663006254937, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.23490196788043, "num_env_steps_trained_throughput_per_sec": 290.23490196788043, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 14110.285, "restore_workers_time_ms": 0.067, "training_step_time_ms": 14110.173, "sample_time_ms": 1547.424, "learn_time_ms": 12543.845, "learn_throughput": 318.881, "synch_weights_time_ms": 17.972}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "6751e_00000", "date": "2024-08-11_19-20-17", "timestamp": 1723418417, "time_this_iter_s": 13.822336912155151, "time_total_s": 783.9296910762787, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaaddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 783.9296910762787, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 47.77894736842104, "ram_util_percent": 83.19473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6525433185554687, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.92970666935835, "policy_loss": -0.004889010490662364, "vf_loss": 9.934494336950715, "vf_explained_var": -0.003231752675677103, "kl": 0.008105632752753028, "entropy": 0.7825498179783896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6934303051580197, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.510586585191191, "policy_loss": -0.006764717879039901, "vf_loss": 9.516127219528117, "vf_explained_var": 0.00029004285575220826, "kl": 0.006120315850757443, "entropy": 0.8010294902576971, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 16545.91588136818, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 3988.0894545567535, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6478.835618647361, "predator_policy": -7158.965075451084}, "policy_reward_max": {"prey_policy": 9059.436204556288, "predator_policy": 14488.360452312507}, "policy_reward_mean": {"prey_policy": -37.935885350318, "predator_policy": 2031.9806126286944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2385.9712673062786, 4401.598517398886, 4106.676612988089, 7205.317431574514, 7545.794678104055, 7808.411367664426, 4132.810712905207, 12056.404596957944, 1877.956172411262, 2149.013270075603, 6728.590760410477, 11061.797053793714, 7573.122046779873, 1776.213301670536, 1583.6687330515044, 3990.7204106192967, 3559.099671578055, 3357.334028181961, 2527.568613983784, 0.0, 757.9810424856729, 10218.31715287463, 3968.2415884851775, 1468.458221834246, 4862.484998915523, 8857.504786304597, 3191.1129762217183, 4684.460280193798, 8323.398086015119, 1764.2587308003785, 10922.829661044092, 3457.6816107780655, 744.184591331936, 3157.4514807838113, 5865.344921344755, 12407.113637265968, 10918.215482972586, 3596.411958968007, 1844.803919575813, 12774.68231337311, 113.37111302593514, 488.3234526075192, 1309.1471475946832, 5775.533945798786, 2313.3913480199967, 4395.768378629504, 994.4157194954341, 3303.872406359957, 2849.3403803376946, 6938.817790952204, 1964.1396286730708, 986.1631223033843, 4558.907147973128, 6897.513056416989, 909.268694171064, 1798.3983281799672, 1930.4159615133706, 3886.1192857935876, -1.2434497875801753e-14, 1971.4064919201826, 991.2847278464085, 3326.9375096661893, 3564.49334175401, 122.58925796491052, 1.4210854715202004e-14, 5795.015928963903, 575.8702670329021, 109.00523305114426, 1131.1479481335075, 6639.284132251206, 483.80155295398447, 991.248248344355, 2605.039797181395, 3899.23767600291, 1997.5743793199129, 4545.567636182282, 3084.4929975888717, -2.1316282072803006e-14, 9541.259518015204, 4514.2872459194605, 1014.8978033077417, 456.43051780271253, 6405.461792573083, 327.0472267675044, 2785.8239757469255, 119.9938373688015, 0.0, 10268.0075496382, 6418.448173949629, 4062.46444613586, 1047.6627760863385, 1498.8459479602402, 2751.221421508279, 2910.2422535642054, 150.97588193083095, 9958.861978598914, 4094.5560919865434, 7197.217733554468, 3879.412678863444, 16545.91588136818], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4850.626878347634, -586.5228636381863, 3270.326465527746, -1132.4793372309384, 6788.765306935606, -360.65015574555895, 971.5664858622769, -958.5524815248932, 749.2403879103946, -3256.5775429960186, 867.0913724282448, -1165.9345321636638, -1888.615077871294, -284.5457016177133, 1033.760240602445, -2714.7343764253997, 3430.798966937348, -3128.191879281433, 6200.832955543605, -2507.8195000602377, 4102.224852623681, -2602.5957652828424, 9059.436204556288, -884.4019571046465, 1244.777296883483, -4461.841949879506, -453.22602007658384, -1032.5352957433959, 7441.011032406284, -1344.9508419427639, -2662.9627267704955, -3113.1424272524127, 8629.882364549161, -2683.3151319374083, 3703.6631363093948, -1310.2912288263274, -1642.106442512978, -5873.04714576877, 7578.08063689625, -1183.4007218875122, 3507.079282313493, -3616.02776322853, -1990.4340767742883, -2687.079691731233, 3647.735958218182, -2220.5482764848807, -339.27853399834623, -4226.916272852153, 3889.939228921536, -4410.582013142577, -921.739224218653, -577.6710956539538, 2937.96427021563, -2.3451229906048114, -3191.661235470017, -729.5674988279873, 2854.9137339417994, -1921.5239043939634, 1303.600826929188, -3923.434010807021, 1388.4432248828514, -1184.7218098308713, 1853.2343501321454, -5581.2048682756185, 4868.686546622399, 354.99056096663605, 1084.8724951145057, -2569.2110790155875, 480.3343851510084, -1231.2613727602825, -991.1092083553406, -4373.426539081282, 444.93420861298034, -1507.1509687165221, 5534.3487598356, -2829.047072967355, -770.5358382976638, -1688.2759897535468, 1139.5493884699838, -2513.44793734529, 3114.8252439955945, -4640.83662810195, 4086.052034746821, -1420.598638868626, -3769.5689674956457, -4099.590459304033, 379.14866048135974, -1596.618244156804, 5353.656339055743, -3260.8805304339385, 736.9825007977294, 972.2321654000032, 6336.800556386457, 182.58945966585276, 1183.8368360556, 328.57699104189777, 4538.89464784118, -3572.977723339283, -1496.7156381951518, -4153.526125526116, 8655.373395195453, -290.5850573997358, 30.521741368607366, 33.95192974325667, -3615.3421885898274, -5940.207150842134, 7743.730259752884, -5089.583060009223, 1366.0222165438522, -6478.835618647361, -2367.2258416746663, -3272.8674550911564, 2349.013931985666, -2931.807403526302, 231.39305172928226, -3869.791633960832, -1950.7569304306692, -5207.567339119201, -729.5287210990147, -884.0301825328211, -589.8213998647244, -1286.4009492523612, -2123.6806888230853, -3794.913656342331, -807.4495701951598, -764.2255400951776, -33.85415822892128, -491.33362802954645, 18.2248442141412, -644.3579398066676, 6431.997327114808, 1072.3484539651852, 4014.7314330816866, 886.097159852959, 3719.4817956508095, -469.072496960961, 5129.097790783298, -895.6827157917551, 8082.442488202125, -427.65152856388175, 3357.183089838859, -2149.6288097623933, 4550.335348630264, -2060.3743662606803, 5241.109594958435, -2241.7772770068627, 5688.322994774824, -531.8629048785556, -253.82238039617062, -5953.199147876994, 1026.602088602232, -448.9688385500947, 6850.312004771945, -2260.3868220794716, 4297.69470347912, -427.7655223261137, 21.004286463650757, -1903.900666364948, 2239.096825773871, -5057.56431182838, 2709.763452723717, -1508.5358587254934, 4254.187781368831, -298.9109958543702, 884.180051354141, -1495.5849185023246, 1759.660113382232, 125.73293067245132, 1447.1394486327363, -4349.0979237463125, 1620.414569186371, -522.5456839387505, -1010.9559342226568, -3882.636942566095, 2206.347978013707, -340.7739191150957, 3293.429171213096, -1200.4423065802168, -840.4616005015273, -2796.8985187258336, -3637.8508213988166, -3797.128715905149, -2512.286150497668, -3481.1706724903947, 7164.925123962079, -671.999140970087, 4481.432749996558, 594.6909422331304, 220.71203969866374, -5599.564541136273, 81.27965802642628, -1523.4089774276968, 5375.705489726791, -1439.8628077274393, -1200.5178949624162, -2294.975803886653, 1676.5613355128776, -1839.7833303511177, -3984.5523910856327, -1228.0106858983513], "policy_predator_policy_reward": [-1269.6865687754414, -608.4461786277265, 2104.739518349097, 159.01187075297182, 2619.7323132444826, -4941.170851446451, 6032.247917219082, 1160.055510018031, 6154.511127573826, 3898.620705615853, 5082.382329256479, 3024.872198143383, 2936.3029932489544, 3369.668499145261, 9521.633775307617, 4215.744957473292, 1560.636960129871, 14.712124625476733, 1649.5889695569667, -3193.5891549647185, 5113.116077077095, 115.84559599254658, -1839.5379337398742, 4726.30074008192, 5778.11103148416, 5012.075668291724, 97.596614603792, 3164.378002886724, -7158.965075451084, 2646.57361803906, 4142.390093042725, 5624.435471599498, -6092.004911759669, 3704.537350725955, 497.1919161967789, 466.7702045021151, 7447.5646746175835, 2595.1575276479352, -776.3359209916622, -5618.343994017078, -1798.3645273850166, 2665.2940507857243, 12046.465032969973, 2849.3658884101787, 2553.615162117259, -12.561255365371437, 4028.62638341762, 2006.026645267119, 4295.164034765311, 1087.963748371248, 8717.429561507057, 1639.485544670147, 1652.2875448841369, -1396.793715887445, 5842.542913388591, 2763.146101103218, 4698.651509154943, 2691.3567473123385, 1635.2571624352004, 2748.8347522430117, 8110.960571203644, 2608.147674788479, 1796.697385234091, 5388.954743687453, -2957.6778496373418, -1521.814666619756, 1620.6740582800644, 3021.1160064048236, 3506.3714144298406, 3109.9004945241877, 11917.439492097827, 5854.209892604753, 9708.847668003298, 2271.5845750728245, -53.28152940538442, 944.3918015051379, 1597.1975965063355, 2706.4181511206893, 7565.076665629129, 6583.504196619298, -2003.1334170312073, 3642.515914163499, -1274.86078802722, -902.2691552434507, 8341.221890155499, 837.084684238861, 5046.950830608811, 1946.052698865412, 1219.4034009114878, -998.7878615133, 2639.827599748341, 46.72611268343461, -2747.536210946972, -2777.4380856099083, 2542.186866894372, -750.7282876319133, 3592.492537225874, -1709.0690813900733, 7065.736511473479, 5523.323043199999, 180.71222416370748, -6581.360933286353, -1967.893506268348, 2889.582957459869, 6951.348068754795, 7163.1084186502985, -3688.9095369126526, 7932.2753935859755, 2258.741465713024, 3763.340630561548, 3471.468788230384, 3967.0228367154036, 2735.368365459238, -222.1589324052388, 3558.273090203177, 3966.2447778219594, 1134.9713646380815, 6023.352904911791, 1154.0186539046056, 2430.9467416474126, 2121.977232990367, 745.5298439731241, 6347.59128598492, 2897.940568846685, 2663.7506176958896, 2472.417834348465, 706.1398552394004, -58.362811016022206, 1343.7716656906478, -717.6385700981208, -99.42076594687022, -1609.9090861692175, 159.6431870254814, -4484.601512927231, -49.60105474959229, -3091.803010889112, -462.14705782136156, -2640.120069036679, -7117.510015886015, 6102.003188498974, 886.4303192537467, -1610.1830463762308, -4217.881734491184, 2719.1690004659545, 1014.8752547724215, -1409.1677755426026, -1907.099753587739, 649.8773396943776, 600.1583771412004, 7604.437530451877, 1703.85221923852, 2264.0821668916265, -742.3933244003239, -763.0388607032745, -3617.3151410045934, -252.61404014841503, 4221.74354752057, 7202.4123503959245, 4222.599876792292, 3110.154855181682, -369.0881351010831, 182.75834441060198, -858.6399860697311, -2640.2062816420184, 3510.2541281540816, 3506.61253156719, -2334.701408858972, 776.3555915717925, 1849.2315607530827, 3838.550890107425, -593.5382236532754, -384.33682422553966, 957.4828562561876, 3936.110020532565, 6776.451312724707, 1625.9821780148864, 590.3718197786426, 3735.0894895381093, 3041.9325635355785, 4657.892001827643, 6013.8386204770195, 2468.8036929132854, 5749.655393237749, 1742.6473777105464, 1827.1564793722166, -5568.861040855934, 1081.6851581596918, -3247.566596825171, 3580.179167402001, 1949.6492159664424, 8234.289348847691, 3166.701949152492, 3128.517498182404, -2969.804088195206, 7686.2206967646625, 3006.4907356388853, 3936.198001180026, 106.4366725216542, 14488.360452312507, 7270.118506039663]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7371985570397008, "mean_inference_ms": 1.5964132391906156, "mean_action_processing_ms": 0.3150788332860668, "mean_env_wait_ms": 0.1423270495005702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006559252738952637, "StateBufferConnector_ms": 0.004125237464904785, "ViewRequirementAgentConnector_ms": 0.1367943286895752}, "num_episodes": 23, "episode_return_max": 16545.91588136818, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 3988.0894545567535, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.1043085803142, "num_env_steps_trained_throughput_per_sec": 303.1043085803142, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 13949.005, "restore_workers_time_ms": 0.067, "training_step_time_ms": 13948.892, "sample_time_ms": 1474.076, "learn_time_ms": 12455.763, "learn_throughput": 321.136, "synch_weights_time_ms": 17.92}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "6751e_00000", "date": "2024-08-11_19-20-30", "timestamp": 1723418430, "time_this_iter_s": 13.256747961044312, "time_total_s": 797.186439037323, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaabd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 797.186439037323, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 45.6578947368421, "ram_util_percent": 83.05263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6196828390240039, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.937085838923378, "policy_loss": -0.0043342029998601275, "vf_loss": 9.941342168636423, "vf_explained_var": 0.002075154219985639, "kl": 0.006231297432970773, "entropy": 0.7453585601672924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7432085662922531, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.331585474872085, "policy_loss": -0.009284263183535249, "vf_loss": 9.338919139539124, "vf_explained_var": 9.936778633682816e-05, "kl": 0.009752999635328894, "entropy": 0.8167029877188344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 16845.802148131024, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 3716.933181235799, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6478.835618647361, "predator_policy": -7117.510015886015}, "policy_reward_max": {"prey_policy": 8655.373395195453, "predator_policy": 14488.360452312507}, "policy_reward_mean": {"prey_policy": -29.69501423191072, "predator_policy": 1888.1616048498101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2527.568613983784, 0.0, 757.9810424856729, 10218.31715287463, 3968.2415884851775, 1468.458221834246, 4862.484998915523, 8857.504786304597, 3191.1129762217183, 4684.460280193798, 8323.398086015119, 1764.2587308003785, 10922.829661044092, 3457.6816107780655, 744.184591331936, 3157.4514807838113, 5865.344921344755, 12407.113637265968, 10918.215482972586, 3596.411958968007, 1844.803919575813, 12774.68231337311, 113.37111302593514, 488.3234526075192, 1309.1471475946832, 5775.533945798786, 2313.3913480199967, 4395.768378629504, 994.4157194954341, 3303.872406359957, 2849.3403803376946, 6938.817790952204, 1964.1396286730708, 986.1631223033843, 4558.907147973128, 6897.513056416989, 909.268694171064, 1798.3983281799672, 1930.4159615133706, 3886.1192857935876, -1.2434497875801753e-14, 1971.4064919201826, 991.2847278464085, 3326.9375096661893, 3564.49334175401, 122.58925796491052, 1.4210854715202004e-14, 5795.015928963903, 575.8702670329021, 109.00523305114426, 1131.1479481335075, 6639.284132251206, 483.80155295398447, 991.248248344355, 2605.039797181395, 3899.23767600291, 1997.5743793199129, 4545.567636182282, 3084.4929975888717, -2.1316282072803006e-14, 9541.259518015204, 4514.2872459194605, 1014.8978033077417, 456.43051780271253, 6405.461792573083, 327.0472267675044, 2785.8239757469255, 119.9938373688015, 0.0, 10268.0075496382, 6418.448173949629, 4062.46444613586, 1047.6627760863385, 1498.8459479602402, 2751.221421508279, 2910.2422535642054, 150.97588193083095, 9958.861978598914, 4094.5560919865434, 7197.217733554468, 3879.412678863444, 16545.91588136818, 4225.283495124161, 8421.18079643106, 1102.3040975213974, 2012.0426700407531, 5506.988628799343, 8231.928178863573, 214.54055946487972, 215.88837187533454, 16845.802148131024, 1417.7430060786528, 2956.0157563834946, 7120.8738623633835, 2194.5925308445258, 945.6105422564011, 0.0, 130.96836321348076, 3907.509918894547, 735.6003750902363], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1642.106442512978, -5873.04714576877, 7578.08063689625, -1183.4007218875122, 3507.079282313493, -3616.02776322853, -1990.4340767742883, -2687.079691731233, 3647.735958218182, -2220.5482764848807, -339.27853399834623, -4226.916272852153, 3889.939228921536, -4410.582013142577, -921.739224218653, -577.6710956539538, 2937.96427021563, -2.3451229906048114, -3191.661235470017, -729.5674988279873, 2854.9137339417994, -1921.5239043939634, 1303.600826929188, -3923.434010807021, 1388.4432248828514, -1184.7218098308713, 1853.2343501321454, -5581.2048682756185, 4868.686546622399, 354.99056096663605, 1084.8724951145057, -2569.2110790155875, 480.3343851510084, -1231.2613727602825, -991.1092083553406, -4373.426539081282, 444.93420861298034, -1507.1509687165221, 5534.3487598356, -2829.047072967355, -770.5358382976638, -1688.2759897535468, 1139.5493884699838, -2513.44793734529, 3114.8252439955945, -4640.83662810195, 4086.052034746821, -1420.598638868626, -3769.5689674956457, -4099.590459304033, 379.14866048135974, -1596.618244156804, 5353.656339055743, -3260.8805304339385, 736.9825007977294, 972.2321654000032, 6336.800556386457, 182.58945966585276, 1183.8368360556, 328.57699104189777, 4538.89464784118, -3572.977723339283, -1496.7156381951518, -4153.526125526116, 8655.373395195453, -290.5850573997358, 30.521741368607366, 33.95192974325667, -3615.3421885898274, -5940.207150842134, 7743.730259752884, -5089.583060009223, 1366.0222165438522, -6478.835618647361, -2367.2258416746663, -3272.8674550911564, 2349.013931985666, -2931.807403526302, 231.39305172928226, -3869.791633960832, -1950.7569304306692, -5207.567339119201, -729.5287210990147, -884.0301825328211, -589.8213998647244, -1286.4009492523612, -2123.6806888230853, -3794.913656342331, -807.4495701951598, -764.2255400951776, -33.85415822892128, -491.33362802954645, 18.2248442141412, -644.3579398066676, 6431.997327114808, 1072.3484539651852, 4014.7314330816866, 886.097159852959, 3719.4817956508095, -469.072496960961, 5129.097790783298, -895.6827157917551, 8082.442488202125, -427.65152856388175, 3357.183089838859, -2149.6288097623933, 4550.335348630264, -2060.3743662606803, 5241.109594958435, -2241.7772770068627, 5688.322994774824, -531.8629048785556, -253.82238039617062, -5953.199147876994, 1026.602088602232, -448.9688385500947, 6850.312004771945, -2260.3868220794716, 4297.69470347912, -427.7655223261137, 21.004286463650757, -1903.900666364948, 2239.096825773871, -5057.56431182838, 2709.763452723717, -1508.5358587254934, 4254.187781368831, -298.9109958543702, 884.180051354141, -1495.5849185023246, 1759.660113382232, 125.73293067245132, 1447.1394486327363, -4349.0979237463125, 1620.414569186371, -522.5456839387505, -1010.9559342226568, -3882.636942566095, 2206.347978013707, -340.7739191150957, 3293.429171213096, -1200.4423065802168, -840.4616005015273, -2796.8985187258336, -3637.8508213988166, -3797.128715905149, -2512.286150497668, -3481.1706724903947, 7164.925123962079, -671.999140970087, 4481.432749996558, 594.6909422331304, 220.71203969866374, -5599.564541136273, 81.27965802642628, -1523.4089774276968, 5375.705489726791, -1439.8628077274393, -1200.5178949624162, -2294.975803886653, 1676.5613355128776, -1839.7833303511177, -3984.5523910856327, -1228.0106858983513, 1243.5557659387214, -851.5694694335465, -689.8353108168154, -4572.2043132490935, -5746.601759292268, -4698.205297991381, 1423.8608913834116, -1785.5142157299567, 5195.265994849065, -1768.3771372881033, 7338.9200193557435, 533.8301983662379, 1977.592967007731, -1486.394583184085, 5909.755527476743, -1869.5829906945842, 3620.6273236050106, -1046.7688639528683, 872.2931480691113, -3863.707325382619, 5665.056751042461, -2907.4725883510373, 6225.384457590327, -942.2916693180284, 6786.336231131365, -2223.117562254601, 3257.987034915891, -1924.0595281376966, 7148.1918606952095, -3963.065660844597, 7614.801096478823, -4299.050680381981, 6596.512141246875, -795.5195251769672, 1239.1630978762487, -1757.504647815388], "policy_predator_policy_reward": [7447.5646746175835, 2595.1575276479352, -776.3359209916622, -5618.343994017078, -1798.3645273850166, 2665.2940507857243, 12046.465032969973, 2849.3658884101787, 2553.615162117259, -12.561255365371437, 4028.62638341762, 2006.026645267119, 4295.164034765311, 1087.963748371248, 8717.429561507057, 1639.485544670147, 1652.2875448841369, -1396.793715887445, 5842.542913388591, 2763.146101103218, 4698.651509154943, 2691.3567473123385, 1635.2571624352004, 2748.8347522430117, 8110.960571203644, 2608.147674788479, 1796.697385234091, 5388.954743687453, -2957.6778496373418, -1521.814666619756, 1620.6740582800644, 3021.1160064048236, 3506.3714144298406, 3109.9004945241877, 11917.439492097827, 5854.209892604753, 9708.847668003298, 2271.5845750728245, -53.28152940538442, 944.3918015051379, 1597.1975965063355, 2706.4181511206893, 7565.076665629129, 6583.504196619298, -2003.1334170312073, 3642.515914163499, -1274.86078802722, -902.2691552434507, 8341.221890155499, 837.084684238861, 5046.950830608811, 1946.052698865412, 1219.4034009114878, -998.7878615133, 2639.827599748341, 46.72611268343461, -2747.536210946972, -2777.4380856099083, 2542.186866894372, -750.7282876319133, 3592.492537225874, -1709.0690813900733, 7065.736511473479, 5523.323043199999, 180.71222416370748, -6581.360933286353, -1967.893506268348, 2889.582957459869, 6951.348068754795, 7163.1084186502985, -3688.9095369126526, 7932.2753935859755, 2258.741465713024, 3763.340630561548, 3471.468788230384, 3967.0228367154036, 2735.368365459238, -222.1589324052388, 3558.273090203177, 3966.2447778219594, 1134.9713646380815, 6023.352904911791, 1154.0186539046056, 2430.9467416474126, 2121.977232990367, 745.5298439731241, 6347.59128598492, 2897.940568846685, 2663.7506176958896, 2472.417834348465, 706.1398552394004, -58.362811016022206, 1343.7716656906478, -717.6385700981208, -99.42076594687022, -1609.9090861692175, 159.6431870254814, -4484.601512927231, -49.60105474959229, -3091.803010889112, -462.14705782136156, -2640.120069036679, -7117.510015886015, 6102.003188498974, 886.4303192537467, -1610.1830463762308, -4217.881734491184, 2719.1690004659545, 1014.8752547724215, -1409.1677755426026, -1907.099753587739, 649.8773396943776, 600.1583771412004, 7604.437530451877, 1703.85221923852, 2264.0821668916265, -742.3933244003239, -763.0388607032745, -3617.3151410045934, -252.61404014841503, 4221.74354752057, 7202.4123503959245, 4222.599876792292, 3110.154855181682, -369.0881351010831, 182.75834441060198, -858.6399860697311, -2640.2062816420184, 3510.2541281540816, 3506.61253156719, -2334.701408858972, 776.3555915717925, 1849.2315607530827, 3838.550890107425, -593.5382236532754, -384.33682422553966, 957.4828562561876, 3936.110020532565, 6776.451312724707, 1625.9821780148864, 590.3718197786426, 3735.0894895381093, 3041.9325635355785, 4657.892001827643, 6013.8386204770195, 2468.8036929132854, 5749.655393237749, 1742.6473777105464, 1827.1564793722166, -5568.861040855934, 1081.6851581596918, -3247.566596825171, 3580.179167402001, 1949.6492159664424, 8234.289348847691, 3166.701949152492, 3128.517498182404, -2969.804088195206, 7686.2206967646625, 3006.4907356388853, 3936.198001180026, 106.4366725216542, 14488.360452312507, 7270.118506039663, 2839.282963943555, 994.0142346754346, 8192.83601142002, 5490.384409076939, 4701.320100606576, 6845.791054198474, 924.3394048325691, 1449.3565895547301, -977.618378428853, 3057.7181496672406, -103.3018567047481, 462.47981784633754, 803.884312797708, -1080.5421371564755, -1850.5766329504147, -1973.7075319564149, 12641.463007915556, 1630.480680563316, 2615.6085920724754, 1793.5485913196874, 674.4092401495031, -475.977646457431, 2825.3002435672156, -987.5191694761398, 1602.3016512970084, -3970.927789329248, -606.0146974859101, 217.6977329641143, -2353.092655947426, -832.0335439031818, -5671.494093099581, 2486.7120402162195, 629.1016550583219, -2522.5843522336827, 553.8445963473226, 700.0973286820524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7361113435605761, "mean_inference_ms": 1.5946327977034207, "mean_action_processing_ms": 0.31484699439905994, "mean_env_wait_ms": 0.14223487107561905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064432621002197266, "StateBufferConnector_ms": 0.005122542381286621, "ViewRequirementAgentConnector_ms": 0.11840319633483887}, "num_episodes": 18, "episode_return_max": 16845.802148131024, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 3716.933181235799, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.17764220431985, "num_env_steps_trained_throughput_per_sec": 285.17764220431985, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 13880.193, "restore_workers_time_ms": 0.065, "training_step_time_ms": 13880.084, "sample_time_ms": 1429.319, "learn_time_ms": 12431.919, "learn_throughput": 321.752, "synch_weights_time_ms": 17.713}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "6751e_00000", "date": "2024-08-11_19-20-44", "timestamp": 1723418444, "time_this_iter_s": 14.08601713180542, "time_total_s": 811.2724561691284, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 811.2724561691284, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 50.15, "ram_util_percent": 83.27000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6462032161061726, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.865670238979279, "policy_loss": -0.006566395701485731, "vf_loss": 9.872097704145643, "vf_explained_var": -0.004477282491310563, "kl": 0.01111568439015328, "entropy": 0.7733480190789258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7247091788463491, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.4772660406809, "policy_loss": -0.006909654205221505, "vf_loss": 9.482568558687886, "vf_explained_var": 0.00016104906955093304, "kl": 0.008035614518405829, "entropy": 0.8315723119904755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 19923.017695159793, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 3951.6787263983133, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6478.835618647361, "predator_policy": -7491.606172469339}, "policy_reward_max": {"prey_policy": 8709.134733076304, "predator_policy": 15014.40693733097}, "policy_reward_mean": {"prey_policy": 140.62111095533513, "predator_policy": 1835.2182522438216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10918.215482972586, 3596.411958968007, 1844.803919575813, 12774.68231337311, 113.37111302593514, 488.3234526075192, 1309.1471475946832, 5775.533945798786, 2313.3913480199967, 4395.768378629504, 994.4157194954341, 3303.872406359957, 2849.3403803376946, 6938.817790952204, 1964.1396286730708, 986.1631223033843, 4558.907147973128, 6897.513056416989, 909.268694171064, 1798.3983281799672, 1930.4159615133706, 3886.1192857935876, -1.2434497875801753e-14, 1971.4064919201826, 991.2847278464085, 3326.9375096661893, 3564.49334175401, 122.58925796491052, 1.4210854715202004e-14, 5795.015928963903, 575.8702670329021, 109.00523305114426, 1131.1479481335075, 6639.284132251206, 483.80155295398447, 991.248248344355, 2605.039797181395, 3899.23767600291, 1997.5743793199129, 4545.567636182282, 3084.4929975888717, -2.1316282072803006e-14, 9541.259518015204, 4514.2872459194605, 1014.8978033077417, 456.43051780271253, 6405.461792573083, 327.0472267675044, 2785.8239757469255, 119.9938373688015, 0.0, 10268.0075496382, 6418.448173949629, 4062.46444613586, 1047.6627760863385, 1498.8459479602402, 2751.221421508279, 2910.2422535642054, 150.97588193083095, 9958.861978598914, 4094.5560919865434, 7197.217733554468, 3879.412678863444, 16545.91588136818, 4225.283495124161, 8421.18079643106, 1102.3040975213974, 2012.0426700407531, 5506.988628799343, 8231.928178863573, 214.54055946487972, 215.88837187533454, 16845.802148131024, 1417.7430060786528, 2956.0157563834946, 7120.8738623633835, 2194.5925308445258, 945.6105422564011, 0.0, 130.96836321348076, 3907.509918894547, 735.6003750902363, 12711.34667567598, 1670.790311532722, 736.1430627157563, 8317.280369165524, 3779.96837725906, 0.0, 1580.1336738912582, 2933.3315377896, 322.797153324653, 7722.998760026359, 5149.575567375901, 1639.3432472951772, 19923.017695159793, 8063.922999569026, 340.21721174494587, 16381.473215665941, 7157.424272078093, 12223.182766644844], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [444.93420861298034, -1507.1509687165221, 5534.3487598356, -2829.047072967355, -770.5358382976638, -1688.2759897535468, 1139.5493884699838, -2513.44793734529, 3114.8252439955945, -4640.83662810195, 4086.052034746821, -1420.598638868626, -3769.5689674956457, -4099.590459304033, 379.14866048135974, -1596.618244156804, 5353.656339055743, -3260.8805304339385, 736.9825007977294, 972.2321654000032, 6336.800556386457, 182.58945966585276, 1183.8368360556, 328.57699104189777, 4538.89464784118, -3572.977723339283, -1496.7156381951518, -4153.526125526116, 8655.373395195453, -290.5850573997358, 30.521741368607366, 33.95192974325667, -3615.3421885898274, -5940.207150842134, 7743.730259752884, -5089.583060009223, 1366.0222165438522, -6478.835618647361, -2367.2258416746663, -3272.8674550911564, 2349.013931985666, -2931.807403526302, 231.39305172928226, -3869.791633960832, -1950.7569304306692, -5207.567339119201, -729.5287210990147, -884.0301825328211, -589.8213998647244, -1286.4009492523612, -2123.6806888230853, -3794.913656342331, -807.4495701951598, -764.2255400951776, -33.85415822892128, -491.33362802954645, 18.2248442141412, -644.3579398066676, 6431.997327114808, 1072.3484539651852, 4014.7314330816866, 886.097159852959, 3719.4817956508095, -469.072496960961, 5129.097790783298, -895.6827157917551, 8082.442488202125, -427.65152856388175, 3357.183089838859, -2149.6288097623933, 4550.335348630264, -2060.3743662606803, 5241.109594958435, -2241.7772770068627, 5688.322994774824, -531.8629048785556, -253.82238039617062, -5953.199147876994, 1026.602088602232, -448.9688385500947, 6850.312004771945, -2260.3868220794716, 4297.69470347912, -427.7655223261137, 21.004286463650757, -1903.900666364948, 2239.096825773871, -5057.56431182838, 2709.763452723717, -1508.5358587254934, 4254.187781368831, -298.9109958543702, 884.180051354141, -1495.5849185023246, 1759.660113382232, 125.73293067245132, 1447.1394486327363, -4349.0979237463125, 1620.414569186371, -522.5456839387505, -1010.9559342226568, -3882.636942566095, 2206.347978013707, -340.7739191150957, 3293.429171213096, -1200.4423065802168, -840.4616005015273, -2796.8985187258336, -3637.8508213988166, -3797.128715905149, -2512.286150497668, -3481.1706724903947, 7164.925123962079, -671.999140970087, 4481.432749996558, 594.6909422331304, 220.71203969866374, -5599.564541136273, 81.27965802642628, -1523.4089774276968, 5375.705489726791, -1439.8628077274393, -1200.5178949624162, -2294.975803886653, 1676.5613355128776, -1839.7833303511177, -3984.5523910856327, -1228.0106858983513, 1243.5557659387214, -851.5694694335465, -689.8353108168154, -4572.2043132490935, -5746.601759292268, -4698.205297991381, 1423.8608913834116, -1785.5142157299567, 5195.265994849065, -1768.3771372881033, 7338.9200193557435, 533.8301983662379, 1977.592967007731, -1486.394583184085, 5909.755527476743, -1869.5829906945842, 3620.6273236050106, -1046.7688639528683, 872.2931480691113, -3863.707325382619, 5665.056751042461, -2907.4725883510373, 6225.384457590327, -942.2916693180284, 6786.336231131365, -2223.117562254601, 3257.987034915891, -1924.0595281376966, 7148.1918606952095, -3963.065660844597, 7614.801096478823, -4299.050680381981, 6596.512141246875, -795.5195251769672, 1239.1630978762487, -1757.504647815388, -2401.748036362844, -340.29957484776565, 1179.1858086632164, -229.02142143224688, 4246.575234493345, -2586.7907654830906, -265.4241192854437, -3300.1325442114007, 8709.134733076304, -119.93531609132765, 5988.1722439153355, -2723.539300196334, 2725.927373732665, -3025.450095136589, -1252.4723701880725, 290.89735144100547, 7026.995813448902, -1400.756575034636, 6527.790897107691, -2629.1322197898976, 5779.002725972292, 2773.8810723621136, 451.61844882243685, -3565.5911550732544, 709.4651307310613, -642.6739105461238, 134.86608009123339, -1584.459869584278, -871.7035301361194, -405.22942178614244, 869.2230285006178, -896.4831564131272, 2941.4739534301866, -2781.612205266452, -1019.6990712052277, -3887.2526080256976], "policy_predator_policy_reward": [9708.847668003298, 2271.5845750728245, -53.28152940538442, 944.3918015051379, 1597.1975965063355, 2706.4181511206893, 7565.076665629129, 6583.504196619298, -2003.1334170312073, 3642.515914163499, -1274.86078802722, -902.2691552434507, 8341.221890155499, 837.084684238861, 5046.950830608811, 1946.052698865412, 1219.4034009114878, -998.7878615133, 2639.827599748341, 46.72611268343461, -2747.536210946972, -2777.4380856099083, 2542.186866894372, -750.7282876319133, 3592.492537225874, -1709.0690813900733, 7065.736511473479, 5523.323043199999, 180.71222416370748, -6581.360933286353, -1967.893506268348, 2889.582957459869, 6951.348068754795, 7163.1084186502985, -3688.9095369126526, 7932.2753935859755, 2258.741465713024, 3763.340630561548, 3471.468788230384, 3967.0228367154036, 2735.368365459238, -222.1589324052388, 3558.273090203177, 3966.2447778219594, 1134.9713646380815, 6023.352904911791, 1154.0186539046056, 2430.9467416474126, 2121.977232990367, 745.5298439731241, 6347.59128598492, 2897.940568846685, 2663.7506176958896, 2472.417834348465, 706.1398552394004, -58.362811016022206, 1343.7716656906478, -717.6385700981208, -99.42076594687022, -1609.9090861692175, 159.6431870254814, -4484.601512927231, -49.60105474959229, -3091.803010889112, -462.14705782136156, -2640.120069036679, -7117.510015886015, 6102.003188498974, 886.4303192537467, -1610.1830463762308, -4217.881734491184, 2719.1690004659545, 1014.8752547724215, -1409.1677755426026, -1907.099753587739, 649.8773396943776, 600.1583771412004, 7604.437530451877, 1703.85221923852, 2264.0821668916265, -742.3933244003239, -763.0388607032745, -3617.3151410045934, -252.61404014841503, 4221.74354752057, 7202.4123503959245, 4222.599876792292, 3110.154855181682, -369.0881351010831, 182.75834441060198, -858.6399860697311, -2640.2062816420184, 3510.2541281540816, 3506.61253156719, -2334.701408858972, 776.3555915717925, 1849.2315607530827, 3838.550890107425, -593.5382236532754, -384.33682422553966, 957.4828562561876, 3936.110020532565, 6776.451312724707, 1625.9821780148864, 590.3718197786426, 3735.0894895381093, 3041.9325635355785, 4657.892001827643, 6013.8386204770195, 2468.8036929132854, 5749.655393237749, 1742.6473777105464, 1827.1564793722166, -5568.861040855934, 1081.6851581596918, -3247.566596825171, 3580.179167402001, 1949.6492159664424, 8234.289348847691, 3166.701949152492, 3128.517498182404, -2969.804088195206, 7686.2206967646625, 3006.4907356388853, 3936.198001180026, 106.4366725216542, 14488.360452312507, 7270.118506039663, 2839.282963943555, 994.0142346754346, 8192.83601142002, 5490.384409076939, 4701.320100606576, 6845.791054198474, 924.3394048325691, 1449.3565895547301, -977.618378428853, 3057.7181496672406, -103.3018567047481, 462.47981784633754, 803.884312797708, -1080.5421371564755, -1850.5766329504147, -1973.7075319564149, 12641.463007915556, 1630.480680563316, 2615.6085920724754, 1793.5485913196874, 674.4092401495031, -475.977646457431, 2825.3002435672156, -987.5191694761398, 1602.3016512970084, -3970.927789329248, -606.0146974859101, 217.6977329641143, -2353.092655947426, -832.0335439031818, -5671.494093099581, 2486.7120402162195, 629.1016550583219, -2522.5843522336827, 553.8445963473226, 700.0973286820524, 12328.00605633458, 3125.388230552001, -520.1141537259396, 1240.740078027693, -747.637974075602, -176.0034322189005, 10177.902430297794, 1704.9346023645837, -7491.606172469339, 2682.375132743434, -3685.0988649043557, 420.4659211853585, 793.1974937718464, 1086.4589015233437, 2891.988693617953, 1002.9178629187065, -4233.320373680359, -1070.1217114092537, 1960.142276305955, 1864.1978064026111, -2169.427419635272, -1233.880811323227, 1683.5394792811157, 3069.7764742648797, 15014.40693733097, 4841.81953764391, 6052.126378425465, 3461.3904106366163, 506.63534554019543, 1110.5148181270129, 12043.437093122173, 4365.296250456256, 5069.617672853965, 1927.944851060403, 8863.885890972148, 8266.248554903605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7350080284512246, "mean_inference_ms": 1.592997667031272, "mean_action_processing_ms": 0.31429390875780533, "mean_env_wait_ms": 0.14213298094327007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004524707794189453, "StateBufferConnector_ms": 0.005076885223388672, "ViewRequirementAgentConnector_ms": 0.11713075637817383}, "num_episodes": 18, "episode_return_max": 19923.017695159793, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 3951.6787263983133, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.9446406481017, "num_env_steps_trained_throughput_per_sec": 287.9446406481017, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 13872.874, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13872.82, "sample_time_ms": 1411.733, "learn_time_ms": 12443.38, "learn_throughput": 321.456, "synch_weights_time_ms": 16.669}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "6751e_00000", "date": "2024-08-11_19-20-58", "timestamp": 1723418458, "time_this_iter_s": 13.945318937301636, "time_total_s": 825.21777510643, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea97670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 825.21777510643, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 46.05499999999999, "ram_util_percent": 82.795}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6839840711503432, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.808029120813602, "policy_loss": -0.005990288140025561, "vf_loss": 9.813939463903033, "vf_explained_var": -0.00672063912664141, "kl": 0.006393597388214451, "entropy": 0.7621210704089473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6291701259121062, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.484687505954158, "policy_loss": -0.0054526162523500345, "vf_loss": 9.48888807195835, "vf_explained_var": 0.00017111638866404376, "kl": 0.006260245918657497, "entropy": 0.9071041206203441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 30177.784707741484, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 4609.68612494191, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5953.199147876994, "predator_policy": -7511.649687447052}, "policy_reward_max": {"prey_policy": 8939.809826062336, "predator_policy": 24606.970613817823}, "policy_reward_mean": {"prey_policy": 365.1725171109612, "predator_policy": 1939.6705453599936}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1.2434497875801753e-14, 1971.4064919201826, 991.2847278464085, 3326.9375096661893, 3564.49334175401, 122.58925796491052, 1.4210854715202004e-14, 5795.015928963903, 575.8702670329021, 109.00523305114426, 1131.1479481335075, 6639.284132251206, 483.80155295398447, 991.248248344355, 2605.039797181395, 3899.23767600291, 1997.5743793199129, 4545.567636182282, 3084.4929975888717, -2.1316282072803006e-14, 9541.259518015204, 4514.2872459194605, 1014.8978033077417, 456.43051780271253, 6405.461792573083, 327.0472267675044, 2785.8239757469255, 119.9938373688015, 0.0, 10268.0075496382, 6418.448173949629, 4062.46444613586, 1047.6627760863385, 1498.8459479602402, 2751.221421508279, 2910.2422535642054, 150.97588193083095, 9958.861978598914, 4094.5560919865434, 7197.217733554468, 3879.412678863444, 16545.91588136818, 4225.283495124161, 8421.18079643106, 1102.3040975213974, 2012.0426700407531, 5506.988628799343, 8231.928178863573, 214.54055946487972, 215.88837187533454, 16845.802148131024, 1417.7430060786528, 2956.0157563834946, 7120.8738623633835, 2194.5925308445258, 945.6105422564011, 0.0, 130.96836321348076, 3907.509918894547, 735.6003750902363, 12711.34667567598, 1670.790311532722, 736.1430627157563, 8317.280369165524, 3779.96837725906, 0.0, 1580.1336738912582, 2933.3315377896, 322.797153324653, 7722.998760026359, 5149.575567375901, 1639.3432472951772, 19923.017695159793, 8063.922999569026, 340.21721174494587, 16381.473215665941, 7157.424272078093, 12223.182766644844, 10098.619825324497, 5558.84485649983, 3479.3299397842093, 2819.384126409906, 1982.8017313520131, 1279.566649246206, 16545.38069571099, 428.8271057460402, 3407.765883675431, 9202.21084071175, 5941.708946553712, 1010.4653692504917, 5446.382885010976, 6803.602653788998, 5304.941411456985, 11240.853618328707, 952.9210900172499, 8228.816454617647, 1630.5546331691437, 30177.784707741484, 3446.5319108938033, 11360.46510180548], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1950.7569304306692, -5207.567339119201, -729.5287210990147, -884.0301825328211, -589.8213998647244, -1286.4009492523612, -2123.6806888230853, -3794.913656342331, -807.4495701951598, -764.2255400951776, -33.85415822892128, -491.33362802954645, 18.2248442141412, -644.3579398066676, 6431.997327114808, 1072.3484539651852, 4014.7314330816866, 886.097159852959, 3719.4817956508095, -469.072496960961, 5129.097790783298, -895.6827157917551, 8082.442488202125, -427.65152856388175, 3357.183089838859, -2149.6288097623933, 4550.335348630264, -2060.3743662606803, 5241.109594958435, -2241.7772770068627, 5688.322994774824, -531.8629048785556, -253.82238039617062, -5953.199147876994, 1026.602088602232, -448.9688385500947, 6850.312004771945, -2260.3868220794716, 4297.69470347912, -427.7655223261137, 21.004286463650757, -1903.900666364948, 2239.096825773871, -5057.56431182838, 2709.763452723717, -1508.5358587254934, 4254.187781368831, -298.9109958543702, 884.180051354141, -1495.5849185023246, 1759.660113382232, 125.73293067245132, 1447.1394486327363, -4349.0979237463125, 1620.414569186371, -522.5456839387505, -1010.9559342226568, -3882.636942566095, 2206.347978013707, -340.7739191150957, 3293.429171213096, -1200.4423065802168, -840.4616005015273, -2796.8985187258336, -3637.8508213988166, -3797.128715905149, -2512.286150497668, -3481.1706724903947, 7164.925123962079, -671.999140970087, 4481.432749996558, 594.6909422331304, 220.71203969866374, -5599.564541136273, 81.27965802642628, -1523.4089774276968, 5375.705489726791, -1439.8628077274393, -1200.5178949624162, -2294.975803886653, 1676.5613355128776, -1839.7833303511177, -3984.5523910856327, -1228.0106858983513, 1243.5557659387214, -851.5694694335465, -689.8353108168154, -4572.2043132490935, -5746.601759292268, -4698.205297991381, 1423.8608913834116, -1785.5142157299567, 5195.265994849065, -1768.3771372881033, 7338.9200193557435, 533.8301983662379, 1977.592967007731, -1486.394583184085, 5909.755527476743, -1869.5829906945842, 3620.6273236050106, -1046.7688639528683, 872.2931480691113, -3863.707325382619, 5665.056751042461, -2907.4725883510373, 6225.384457590327, -942.2916693180284, 6786.336231131365, -2223.117562254601, 3257.987034915891, -1924.0595281376966, 7148.1918606952095, -3963.065660844597, 7614.801096478823, -4299.050680381981, 6596.512141246875, -795.5195251769672, 1239.1630978762487, -1757.504647815388, -2401.748036362844, -340.29957484776565, 1179.1858086632164, -229.02142143224688, 4246.575234493345, -2586.7907654830906, -265.4241192854437, -3300.1325442114007, 8709.134733076304, -119.93531609132765, 5988.1722439153355, -2723.539300196334, 2725.927373732665, -3025.450095136589, -1252.4723701880725, 290.89735144100547, 7026.995813448902, -1400.756575034636, 6527.790897107691, -2629.1322197898976, 5779.002725972292, 2773.8810723621136, 451.61844882243685, -3565.5911550732544, 709.4651307310613, -642.6739105461238, 134.86608009123339, -1584.459869584278, -871.7035301361194, -405.22942178614244, 869.2230285006178, -896.4831564131272, 2941.4739534301866, -2781.612205266452, -1019.6990712052277, -3887.2526080256976, -328.1039009790125, -2202.284468474824, 2673.051134242071, -726.6204453564603, 5694.633860948193, 22.239278930746636, 8767.203345971646, -3931.2576318490824, 8640.234929897664, 1482.8425043246996, -747.2382661503959, -3323.80262441261, 3036.317648023743, -2963.0851329448224, 1413.1772426745297, -5889.938541811347, -1031.8049806162142, -1914.9053631251404, 2262.761600207033, 151.61596531863583, 7336.699258393671, -578.4855576146282, 8939.809826062336, 504.80102385739656, -1999.404390983584, -3352.7622425822574, 3028.0275431584105, -397.92781808881455, 4764.793570226494, -1621.909188390526, 3886.7630947251596, -1575.329243907917, 4931.492016999436, 1384.7012531374987, 3998.055919321336, -920.5920380638663, -662.0623676698077, -1014.3368261493159, -796.3955790059963, -1495.0108834398886, -776.8211741799397, -1526.3447674851334, -2161.3741601614765, -2504.7240453897793], "policy_predator_policy_reward": [1134.9713646380815, 6023.352904911791, 1154.0186539046056, 2430.9467416474126, 2121.977232990367, 745.5298439731241, 6347.59128598492, 2897.940568846685, 2663.7506176958896, 2472.417834348465, 706.1398552394004, -58.362811016022206, 1343.7716656906478, -717.6385700981208, -99.42076594687022, -1609.9090861692175, 159.6431870254814, -4484.601512927231, -49.60105474959229, -3091.803010889112, -462.14705782136156, -2640.120069036679, -7117.510015886015, 6102.003188498974, 886.4303192537467, -1610.1830463762308, -4217.881734491184, 2719.1690004659545, 1014.8752547724215, -1409.1677755426026, -1907.099753587739, 649.8773396943776, 600.1583771412004, 7604.437530451877, 1703.85221923852, 2264.0821668916265, -742.3933244003239, -763.0388607032745, -3617.3151410045934, -252.61404014841503, 4221.74354752057, 7202.4123503959245, 4222.599876792292, 3110.154855181682, -369.0881351010831, 182.75834441060198, -858.6399860697311, -2640.2062816420184, 3510.2541281540816, 3506.61253156719, -2334.701408858972, 776.3555915717925, 1849.2315607530827, 3838.550890107425, -593.5382236532754, -384.33682422553966, 957.4828562561876, 3936.110020532565, 6776.451312724707, 1625.9821780148864, 590.3718197786426, 3735.0894895381093, 3041.9325635355785, 4657.892001827643, 6013.8386204770195, 2468.8036929132854, 5749.655393237749, 1742.6473777105464, 1827.1564793722166, -5568.861040855934, 1081.6851581596918, -3247.566596825171, 3580.179167402001, 1949.6492159664424, 8234.289348847691, 3166.701949152492, 3128.517498182404, -2969.804088195206, 7686.2206967646625, 3006.4907356388853, 3936.198001180026, 106.4366725216542, 14488.360452312507, 7270.118506039663, 2839.282963943555, 994.0142346754346, 8192.83601142002, 5490.384409076939, 4701.320100606576, 6845.791054198474, 924.3394048325691, 1449.3565895547301, -977.618378428853, 3057.7181496672406, -103.3018567047481, 462.47981784633754, 803.884312797708, -1080.5421371564755, -1850.5766329504147, -1973.7075319564149, 12641.463007915556, 1630.480680563316, 2615.6085920724754, 1793.5485913196874, 674.4092401495031, -475.977646457431, 2825.3002435672156, -987.5191694761398, 1602.3016512970084, -3970.927789329248, -606.0146974859101, 217.6977329641143, -2353.092655947426, -832.0335439031818, -5671.494093099581, 2486.7120402162195, 629.1016550583219, -2522.5843522336827, 553.8445963473226, 700.0973286820524, 12328.00605633458, 3125.388230552001, -520.1141537259396, 1240.740078027693, -747.637974075602, -176.0034322189005, 10177.902430297794, 1704.9346023645837, -7491.606172469339, 2682.375132743434, -3685.0988649043557, 420.4659211853585, 793.1974937718464, 1086.4589015233437, 2891.988693617953, 1002.9178629187065, -4233.320373680359, -1070.1217114092537, 1960.142276305955, 1864.1978064026111, -2169.427419635272, -1233.880811323227, 1683.5394792811157, 3069.7764742648797, 15014.40693733097, 4841.81953764391, 6052.126378425465, 3461.3904106366163, 506.63534554019543, 1110.5148181270129, 12043.437093122173, 4365.296250456256, 5069.617672853965, 1927.944851060403, 8863.885890972148, 8266.248554903605, 7195.660152527701, 5433.348042250634, 1283.3099441044262, 2329.1042235098034, -1841.7436758078766, -395.79952428685937, -2780.8206092125974, 764.2590214999286, -3780.4917733148422, -4359.783929555524, 2311.6502790294508, 3038.957260779763, 14269.086105287402, 2203.0620753446647, 2541.791678425869, 2363.796726456986, 1701.288058297483, 4653.188169119302, 5871.993213695438, 915.8400614906565, -842.4886755758249, 25.983921350480472, -7511.649687447052, -922.4957932221837, 5529.351965603154, 5269.197552973689, 1287.7265942805725, 2885.77633443883, 3448.2873236162663, -1286.230293995265, 6078.3525727007545, 2851.067194810667, -1724.9696544574224, -3638.302525662265, -142.5621551004052, 5293.914728460577, 1414.573060726623, 1892.3807662616434, 24606.970613817823, 7862.220556369565, 5072.917834541501, 676.7800180173754, 9579.508546252924, 6447.0547611038055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7335706807747779, "mean_inference_ms": 1.5903940738235736, "mean_action_processing_ms": 0.3137359716168996, "mean_env_wait_ms": 0.14171684389159492, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004679441452026367, "StateBufferConnector_ms": 0.004263639450073242, "ViewRequirementAgentConnector_ms": 0.11411857604980469}, "num_episodes": 22, "episode_return_max": 30177.784707741484, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 4609.68612494191, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.37946430636106, "num_env_steps_trained_throughput_per_sec": 287.37946430636106, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 13832.941, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13832.896, "sample_time_ms": 1371.785, "learn_time_ms": 12445.311, "learn_throughput": 321.406, "synch_weights_time_ms": 14.751}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "6751e_00000", "date": "2024-08-11_19-21-12", "timestamp": 1723418472, "time_this_iter_s": 13.98889708518982, "time_total_s": 839.2066721916199, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaa4790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 839.2066721916199, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 49.74, "ram_util_percent": 83.22}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5665845853232202, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.873642309380587, "policy_loss": -0.004406222849887199, "vf_loss": 9.877953688303629, "vf_explained_var": -0.005880833838982557, "kl": 0.007586181918778601, "entropy": 0.7071440364317919, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6944647502646875, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.584224615147505, "policy_loss": -0.0031831867188441927, "vf_loss": 9.586635034551065, "vf_explained_var": 0.00016783400187416682, "kl": 0.0038638486639612515, "entropy": 0.8954600861148229, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 30177.784707741484, "episode_reward_min": -2.1316282072803006e-14, "episode_reward_mean": 5598.599480548905, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -8152.483054718267, "predator_policy": -7511.649687447052}, "policy_reward_max": {"prey_policy": 9385.446745014662, "predator_policy": 24606.970613817823}, "policy_reward_mean": {"prey_policy": 379.2594033684621, "predator_policy": 2420.0403369059904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [3084.4929975888717, -2.1316282072803006e-14, 9541.259518015204, 4514.2872459194605, 1014.8978033077417, 456.43051780271253, 6405.461792573083, 327.0472267675044, 2785.8239757469255, 119.9938373688015, 0.0, 10268.0075496382, 6418.448173949629, 4062.46444613586, 1047.6627760863385, 1498.8459479602402, 2751.221421508279, 2910.2422535642054, 150.97588193083095, 9958.861978598914, 4094.5560919865434, 7197.217733554468, 3879.412678863444, 16545.91588136818, 4225.283495124161, 8421.18079643106, 1102.3040975213974, 2012.0426700407531, 5506.988628799343, 8231.928178863573, 214.54055946487972, 215.88837187533454, 16845.802148131024, 1417.7430060786528, 2956.0157563834946, 7120.8738623633835, 2194.5925308445258, 945.6105422564011, 0.0, 130.96836321348076, 3907.509918894547, 735.6003750902363, 12711.34667567598, 1670.790311532722, 736.1430627157563, 8317.280369165524, 3779.96837725906, 0.0, 1580.1336738912582, 2933.3315377896, 322.797153324653, 7722.998760026359, 5149.575567375901, 1639.3432472951772, 19923.017695159793, 8063.922999569026, 340.21721174494587, 16381.473215665941, 7157.424272078093, 12223.182766644844, 10098.619825324497, 5558.84485649983, 3479.3299397842093, 2819.384126409906, 1982.8017313520131, 1279.566649246206, 16545.38069571099, 428.8271057460402, 3407.765883675431, 9202.21084071175, 5941.708946553712, 1010.4653692504917, 5446.382885010976, 6803.602653788998, 5304.941411456985, 11240.853618328707, 952.9210900172499, 8228.816454617647, 1630.5546331691437, 30177.784707741484, 3446.5319108938033, 11360.46510180548, 4963.097477285158, 1033.6018638956841, 8284.483966396738, 4788.323222258133, 28851.3372608086, 5632.195086599458, 13568.24808869159, 1852.518836040412, 5642.374230046695, 226.99953512047517, 22698.16818704257, 6945.1223854125965, 6108.209986084664, 4859.440210043575, 0.0, 7785.4017993844645, 808.7181920372961, 13592.59936212053], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6850.312004771945, -2260.3868220794716, 4297.69470347912, -427.7655223261137, 21.004286463650757, -1903.900666364948, 2239.096825773871, -5057.56431182838, 2709.763452723717, -1508.5358587254934, 4254.187781368831, -298.9109958543702, 884.180051354141, -1495.5849185023246, 1759.660113382232, 125.73293067245132, 1447.1394486327363, -4349.0979237463125, 1620.414569186371, -522.5456839387505, -1010.9559342226568, -3882.636942566095, 2206.347978013707, -340.7739191150957, 3293.429171213096, -1200.4423065802168, -840.4616005015273, -2796.8985187258336, -3637.8508213988166, -3797.128715905149, -2512.286150497668, -3481.1706724903947, 7164.925123962079, -671.999140970087, 4481.432749996558, 594.6909422331304, 220.71203969866374, -5599.564541136273, 81.27965802642628, -1523.4089774276968, 5375.705489726791, -1439.8628077274393, -1200.5178949624162, -2294.975803886653, 1676.5613355128776, -1839.7833303511177, -3984.5523910856327, -1228.0106858983513, 1243.5557659387214, -851.5694694335465, -689.8353108168154, -4572.2043132490935, -5746.601759292268, -4698.205297991381, 1423.8608913834116, -1785.5142157299567, 5195.265994849065, -1768.3771372881033, 7338.9200193557435, 533.8301983662379, 1977.592967007731, -1486.394583184085, 5909.755527476743, -1869.5829906945842, 3620.6273236050106, -1046.7688639528683, 872.2931480691113, -3863.707325382619, 5665.056751042461, -2907.4725883510373, 6225.384457590327, -942.2916693180284, 6786.336231131365, -2223.117562254601, 3257.987034915891, -1924.0595281376966, 7148.1918606952095, -3963.065660844597, 7614.801096478823, -4299.050680381981, 6596.512141246875, -795.5195251769672, 1239.1630978762487, -1757.504647815388, -2401.748036362844, -340.29957484776565, 1179.1858086632164, -229.02142143224688, 4246.575234493345, -2586.7907654830906, -265.4241192854437, -3300.1325442114007, 8709.134733076304, -119.93531609132765, 5988.1722439153355, -2723.539300196334, 2725.927373732665, -3025.450095136589, -1252.4723701880725, 290.89735144100547, 7026.995813448902, -1400.756575034636, 6527.790897107691, -2629.1322197898976, 5779.002725972292, 2773.8810723621136, 451.61844882243685, -3565.5911550732544, 709.4651307310613, -642.6739105461238, 134.86608009123339, -1584.459869584278, -871.7035301361194, -405.22942178614244, 869.2230285006178, -896.4831564131272, 2941.4739534301866, -2781.612205266452, -1019.6990712052277, -3887.2526080256976, -328.1039009790125, -2202.284468474824, 2673.051134242071, -726.6204453564603, 5694.633860948193, 22.239278930746636, 8767.203345971646, -3931.2576318490824, 8640.234929897664, 1482.8425043246996, -747.2382661503959, -3323.80262441261, 3036.317648023743, -2963.0851329448224, 1413.1772426745297, -5889.938541811347, -1031.8049806162142, -1914.9053631251404, 2262.761600207033, 151.61596531863583, 7336.699258393671, -578.4855576146282, 8939.809826062336, 504.80102385739656, -1999.404390983584, -3352.7622425822574, 3028.0275431584105, -397.92781808881455, 4764.793570226494, -1621.909188390526, 3886.7630947251596, -1575.329243907917, 4931.492016999436, 1384.7012531374987, 3998.055919321336, -920.5920380638663, -662.0623676698077, -1014.3368261493159, -796.3955790059963, -1495.0108834398886, -776.8211741799397, -1526.3447674851334, -2161.3741601614765, -2504.7240453897793, 5855.843165210088, -2742.937030193579, 3087.3582415003766, -1464.490096944499, 9385.446745014662, -2677.791563570033, 5330.420133257259, 2500.7755259618, -1754.2978531527085, -389.79081301793997, 8851.813940534621, 352.5234684641807, 5848.926309438139, -2298.5600953545595, -2364.0656353111353, -1997.7218081717704, 2102.747105710689, -4414.556181020785, 1602.345407050591, -4690.613575846809, -1870.3198658190759, -904.0364207222094, 654.3547309495921, -2398.246163965054, 2036.8377636741195, -2159.575446613697, 3245.8600092021065, -1918.39902954242, 6315.064065870862, -2062.850125835287, 1007.8653831972724, -2068.355504422819, 556.3430356460026, -8152.483054718267, 5952.6547001930485, -1062.698975350995], "policy_predator_policy_reward": [-742.3933244003239, -763.0388607032745, -3617.3151410045934, -252.61404014841503, 4221.74354752057, 7202.4123503959245, 4222.599876792292, 3110.154855181682, -369.0881351010831, 182.75834441060198, -858.6399860697311, -2640.2062816420184, 3510.2541281540816, 3506.61253156719, -2334.701408858972, 776.3555915717925, 1849.2315607530827, 3838.550890107425, -593.5382236532754, -384.33682422553966, 957.4828562561876, 3936.110020532565, 6776.451312724707, 1625.9821780148864, 590.3718197786426, 3735.0894895381093, 3041.9325635355785, 4657.892001827643, 6013.8386204770195, 2468.8036929132854, 5749.655393237749, 1742.6473777105464, 1827.1564793722166, -5568.861040855934, 1081.6851581596918, -3247.566596825171, 3580.179167402001, 1949.6492159664424, 8234.289348847691, 3166.701949152492, 3128.517498182404, -2969.804088195206, 7686.2206967646625, 3006.4907356388853, 3936.198001180026, 106.4366725216542, 14488.360452312507, 7270.118506039663, 2839.282963943555, 994.0142346754346, 8192.83601142002, 5490.384409076939, 4701.320100606576, 6845.791054198474, 924.3394048325691, 1449.3565895547301, -977.618378428853, 3057.7181496672406, -103.3018567047481, 462.47981784633754, 803.884312797708, -1080.5421371564755, -1850.5766329504147, -1973.7075319564149, 12641.463007915556, 1630.480680563316, 2615.6085920724754, 1793.5485913196874, 674.4092401495031, -475.977646457431, 2825.3002435672156, -987.5191694761398, 1602.3016512970084, -3970.927789329248, -606.0146974859101, 217.6977329641143, -2353.092655947426, -832.0335439031818, -5671.494093099581, 2486.7120402162195, 629.1016550583219, -2522.5843522336827, 553.8445963473226, 700.0973286820524, 12328.00605633458, 3125.388230552001, -520.1141537259396, 1240.740078027693, -747.637974075602, -176.0034322189005, 10177.902430297794, 1704.9346023645837, -7491.606172469339, 2682.375132743434, -3685.0988649043557, 420.4659211853585, 793.1974937718464, 1086.4589015233437, 2891.988693617953, 1002.9178629187065, -4233.320373680359, -1070.1217114092537, 1960.142276305955, 1864.1978064026111, -2169.427419635272, -1233.880811323227, 1683.5394792811157, 3069.7764742648797, 15014.40693733097, 4841.81953764391, 6052.126378425465, 3461.3904106366163, 506.63534554019543, 1110.5148181270129, 12043.437093122173, 4365.296250456256, 5069.617672853965, 1927.944851060403, 8863.885890972148, 8266.248554903605, 7195.660152527701, 5433.348042250634, 1283.3099441044262, 2329.1042235098034, -1841.7436758078766, -395.79952428685937, -2780.8206092125974, 764.2590214999286, -3780.4917733148422, -4359.783929555524, 2311.6502790294508, 3038.957260779763, 14269.086105287402, 2203.0620753446647, 2541.791678425869, 2363.796726456986, 1701.288058297483, 4653.188169119302, 5871.993213695438, 915.8400614906565, -842.4886755758249, 25.983921350480472, -7511.649687447052, -922.4957932221837, 5529.351965603154, 5269.197552973689, 1287.7265942805725, 2885.77633443883, 3448.2873236162663, -1286.230293995265, 6078.3525727007545, 2851.067194810667, -1724.9696544574224, -3638.302525662265, -142.5621551004052, 5293.914728460577, 1414.573060726623, 1892.3807662616434, 24606.970613817823, 7862.220556369565, 5072.917834541501, 676.7800180173754, 9579.508546252924, 6447.0547611038055, 637.8389961931949, 1212.3523460754566, 1740.7019487429293, -2329.968229403124, 5800.982594515725, -4224.153809563629, -2366.5243899820016, -676.3480469789254, 24461.167407060097, 6534.258519919132, -3797.6567934593536, 225.51447106000646, 7779.724600984607, 2238.1572736234475, 3106.7560423601635, 3107.550237163148, 5369.442280931189, 2584.7410244256052, 3599.5621372248756, -284.29443330818185, 16560.772412952312, 8911.75206063152, 4219.924224801082, 4469.089593626977, 5041.611824007789, 1189.3358450164535, -659.5849510805033, 4191.564181464386, -4548.97118229098, 296.7572422554058, 4724.289453848731, 4121.602466761277, 5929.5281925221925, 2475.3300185873686, 8822.90438180728, -120.26074452878503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.732008346085899, "mean_inference_ms": 1.587292866066764, "mean_action_processing_ms": 0.312793829290734, "mean_env_wait_ms": 0.1417328978076512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003825068473815918, "StateBufferConnector_ms": 0.0041561126708984375, "ViewRequirementAgentConnector_ms": 0.10324013233184814}, "num_episodes": 18, "episode_return_max": 30177.784707741484, "episode_return_min": -2.1316282072803006e-14, "episode_return_mean": 5598.599480548905, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.024609225089, "num_env_steps_trained_throughput_per_sec": 291.024609225089, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 13797.699, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13797.654, "sample_time_ms": 1306.965, "learn_time_ms": 12475.316, "learn_throughput": 320.633, "synch_weights_time_ms": 14.492}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "6751e_00000", "date": "2024-08-11_19-21-26", "timestamp": 1723418486, "time_this_iter_s": 13.789664268493652, "time_total_s": 852.9963364601135, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaa4820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 852.9963364601135, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 46.805, "ram_util_percent": 83.23}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7087542141161899, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.766754681218869, "policy_loss": -0.005210441369169131, "vf_loss": 9.771836001280123, "vf_explained_var": -0.0011175687035555563, "kl": 0.010332165686231787, "entropy": 0.718424418489769, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5470848789606145, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.44035964642883, "policy_loss": -0.00667660829793445, "vf_loss": 9.446156128373726, "vf_explained_var": 0.00010373970818898035, "kl": 0.008801377138764317, "entropy": 0.8053143014037419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 33385.83395252258, "episode_reward_min": 0.0, "episode_reward_mean": 6191.22948520853, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -8152.483054718267, "predator_policy": -7511.649687447052}, "policy_reward_max": {"prey_policy": 9385.446745014662, "predator_policy": 33816.31318680089}, "policy_reward_mean": {"prey_policy": 392.8512721730983, "predator_policy": 2702.763470431166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16545.91588136818, 4225.283495124161, 8421.18079643106, 1102.3040975213974, 2012.0426700407531, 5506.988628799343, 8231.928178863573, 214.54055946487972, 215.88837187533454, 16845.802148131024, 1417.7430060786528, 2956.0157563834946, 7120.8738623633835, 2194.5925308445258, 945.6105422564011, 0.0, 130.96836321348076, 3907.509918894547, 735.6003750902363, 12711.34667567598, 1670.790311532722, 736.1430627157563, 8317.280369165524, 3779.96837725906, 0.0, 1580.1336738912582, 2933.3315377896, 322.797153324653, 7722.998760026359, 5149.575567375901, 1639.3432472951772, 19923.017695159793, 8063.922999569026, 340.21721174494587, 16381.473215665941, 7157.424272078093, 12223.182766644844, 10098.619825324497, 5558.84485649983, 3479.3299397842093, 2819.384126409906, 1982.8017313520131, 1279.566649246206, 16545.38069571099, 428.8271057460402, 3407.765883675431, 9202.21084071175, 5941.708946553712, 1010.4653692504917, 5446.382885010976, 6803.602653788998, 5304.941411456985, 11240.853618328707, 952.9210900172499, 8228.816454617647, 1630.5546331691437, 30177.784707741484, 3446.5319108938033, 11360.46510180548, 4963.097477285158, 1033.6018638956841, 8284.483966396738, 4788.323222258133, 28851.3372608086, 5632.195086599458, 13568.24808869159, 1852.518836040412, 5642.374230046695, 226.99953512047517, 22698.16818704257, 6945.1223854125965, 6108.209986084664, 4859.440210043575, 0.0, 7785.4017993844645, 808.7181920372961, 13592.59936212053, 3868.5937811238614, 5588.866914297074, 3623.8049350491133, 1034.0858672672273, 5568.147528440198, 9496.43917279811, 123.9632298664726, 2406.9542737850306, 9117.328162319207, 6689.520038562219, 6900.992278861621, 9132.794726056898, 33385.83395252258, 9988.799381033316, 5112.523003605043, 5909.432978480855, 4042.3669222039366, 1967.4971361205237, 243.1120770226368, 4106.400962090306, 1733.663735276573, 4312.303194667861, 7397.188063378943], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3984.5523910856327, -1228.0106858983513, 1243.5557659387214, -851.5694694335465, -689.8353108168154, -4572.2043132490935, -5746.601759292268, -4698.205297991381, 1423.8608913834116, -1785.5142157299567, 5195.265994849065, -1768.3771372881033, 7338.9200193557435, 533.8301983662379, 1977.592967007731, -1486.394583184085, 5909.755527476743, -1869.5829906945842, 3620.6273236050106, -1046.7688639528683, 872.2931480691113, -3863.707325382619, 5665.056751042461, -2907.4725883510373, 6225.384457590327, -942.2916693180284, 6786.336231131365, -2223.117562254601, 3257.987034915891, -1924.0595281376966, 7148.1918606952095, -3963.065660844597, 7614.801096478823, -4299.050680381981, 6596.512141246875, -795.5195251769672, 1239.1630978762487, -1757.504647815388, -2401.748036362844, -340.29957484776565, 1179.1858086632164, -229.02142143224688, 4246.575234493345, -2586.7907654830906, -265.4241192854437, -3300.1325442114007, 8709.134733076304, -119.93531609132765, 5988.1722439153355, -2723.539300196334, 2725.927373732665, -3025.450095136589, -1252.4723701880725, 290.89735144100547, 7026.995813448902, -1400.756575034636, 6527.790897107691, -2629.1322197898976, 5779.002725972292, 2773.8810723621136, 451.61844882243685, -3565.5911550732544, 709.4651307310613, -642.6739105461238, 134.86608009123339, -1584.459869584278, -871.7035301361194, -405.22942178614244, 869.2230285006178, -896.4831564131272, 2941.4739534301866, -2781.612205266452, -1019.6990712052277, -3887.2526080256976, -328.1039009790125, -2202.284468474824, 2673.051134242071, -726.6204453564603, 5694.633860948193, 22.239278930746636, 8767.203345971646, -3931.2576318490824, 8640.234929897664, 1482.8425043246996, -747.2382661503959, -3323.80262441261, 3036.317648023743, -2963.0851329448224, 1413.1772426745297, -5889.938541811347, -1031.8049806162142, -1914.9053631251404, 2262.761600207033, 151.61596531863583, 7336.699258393671, -578.4855576146282, 8939.809826062336, 504.80102385739656, -1999.404390983584, -3352.7622425822574, 3028.0275431584105, -397.92781808881455, 4764.793570226494, -1621.909188390526, 3886.7630947251596, -1575.329243907917, 4931.492016999436, 1384.7012531374987, 3998.055919321336, -920.5920380638663, -662.0623676698077, -1014.3368261493159, -796.3955790059963, -1495.0108834398886, -776.8211741799397, -1526.3447674851334, -2161.3741601614765, -2504.7240453897793, 5855.843165210088, -2742.937030193579, 3087.3582415003766, -1464.490096944499, 9385.446745014662, -2677.791563570033, 5330.420133257259, 2500.7755259618, -1754.2978531527085, -389.79081301793997, 8851.813940534621, 352.5234684641807, 5848.926309438139, -2298.5600953545595, -2364.0656353111353, -1997.7218081717704, 2102.747105710689, -4414.556181020785, 1602.345407050591, -4690.613575846809, -1870.3198658190759, -904.0364207222094, 654.3547309495921, -2398.246163965054, 2036.8377636741195, -2159.575446613697, 3245.8600092021065, -1918.39902954242, 6315.064065870862, -2062.850125835287, 1007.8653831972724, -2068.355504422819, 556.3430356460026, -8152.483054718267, 5952.6547001930485, -1062.698975350995, 6243.1863066069245, -3642.688891677937, 1467.6495137192458, -4571.575067379078, -473.6399850856528, -4494.710911543349, -946.5715507704106, 126.60917199121407, 1034.6660755866078, -2812.230330786875, -489.4075374597576, -2288.5348168758387, 51.95495295386932, -1520.4160661116678, 4133.128666531019, -614.6912866884967, 8295.841638128375, -1204.8220086120496, 2656.1312277311563, -2750.1797372907185, -3468.99263584259, -4910.894459971593, 4808.798535169645, -1338.7568892315599, -2181.2385021213304, -2157.403145796246, -481.05860833974936, -3512.1168781172255, 297.7840461189614, -2091.788256643643, -629.6022265014012, 1498.946083426358, 1175.9684016492276, -751.0503491983593, 3711.279278511766, -3215.0523985022583, 6184.65297962244, -2445.9766739653337, 6849.0237856547765, -143.55042333233501, 642.0553156708424, -897.112482933244, 4571.300745521253, -1304.331621349485, 1029.4165283999118, -1312.3658755770778], "policy_predator_policy_reward": [14488.360452312507, 7270.118506039663, 2839.282963943555, 994.0142346754346, 8192.83601142002, 5490.384409076939, 4701.320100606576, 6845.791054198474, 924.3394048325691, 1449.3565895547301, -977.618378428853, 3057.7181496672406, -103.3018567047481, 462.47981784633754, 803.884312797708, -1080.5421371564755, -1850.5766329504147, -1973.7075319564149, 12641.463007915556, 1630.480680563316, 2615.6085920724754, 1793.5485913196874, 674.4092401495031, -475.977646457431, 2825.3002435672156, -987.5191694761398, 1602.3016512970084, -3970.927789329248, -606.0146974859101, 217.6977329641143, -2353.092655947426, -832.0335439031818, -5671.494093099581, 2486.7120402162195, 629.1016550583219, -2522.5843522336827, 553.8445963473226, 700.0973286820524, 12328.00605633458, 3125.388230552001, -520.1141537259396, 1240.740078027693, -747.637974075602, -176.0034322189005, 10177.902430297794, 1704.9346023645837, -7491.606172469339, 2682.375132743434, -3685.0988649043557, 420.4659211853585, 793.1974937718464, 1086.4589015233437, 2891.988693617953, 1002.9178629187065, -4233.320373680359, -1070.1217114092537, 1960.142276305955, 1864.1978064026111, -2169.427419635272, -1233.880811323227, 1683.5394792811157, 3069.7764742648797, 15014.40693733097, 4841.81953764391, 6052.126378425465, 3461.3904106366163, 506.63534554019543, 1110.5148181270129, 12043.437093122173, 4365.296250456256, 5069.617672853965, 1927.944851060403, 8863.885890972148, 8266.248554903605, 7195.660152527701, 5433.348042250634, 1283.3099441044262, 2329.1042235098034, -1841.7436758078766, -395.79952428685937, -2780.8206092125974, 764.2590214999286, -3780.4917733148422, -4359.783929555524, 2311.6502790294508, 3038.957260779763, 14269.086105287402, 2203.0620753446647, 2541.791678425869, 2363.796726456986, 1701.288058297483, 4653.188169119302, 5871.993213695438, 915.8400614906565, -842.4886755758249, 25.983921350480472, -7511.649687447052, -922.4957932221837, 5529.351965603154, 5269.197552973689, 1287.7265942805725, 2885.77633443883, 3448.2873236162663, -1286.230293995265, 6078.3525727007545, 2851.067194810667, -1724.9696544574224, -3638.302525662265, -142.5621551004052, 5293.914728460577, 1414.573060726623, 1892.3807662616434, 24606.970613817823, 7862.220556369565, 5072.917834541501, 676.7800180173754, 9579.508546252924, 6447.0547611038055, 637.8389961931949, 1212.3523460754566, 1740.7019487429293, -2329.968229403124, 5800.982594515725, -4224.153809563629, -2366.5243899820016, -676.3480469789254, 24461.167407060097, 6534.258519919132, -3797.6567934593536, 225.51447106000646, 7779.724600984607, 2238.1572736234475, 3106.7560423601635, 3107.550237163148, 5369.442280931189, 2584.7410244256052, 3599.5621372248756, -284.29443330818185, 16560.772412952312, 8911.75206063152, 4219.924224801082, 4469.089593626977, 5041.611824007789, 1189.3358450164535, -659.5849510805033, 4191.564181464386, -4548.97118229098, 296.7572422554058, 4724.289453848731, 4121.602466761277, 5929.5281925221925, 2475.3300185873686, 8822.90438180728, -120.26074452878503, -1851.1718573085404, 3119.2682235034063, 6500.793451615118, 2191.9990163417947, 6127.143403293258, 2465.0124283848613, 1704.534089380222, 149.5141566662018, 3116.0880433955317, 4229.623740244928, 9850.50599640353, 2423.8755307301726, 1010.0219233497357, 582.4024196745353, -386.8523328053061, -724.6307732521846, -547.5418573576453, 2573.8503901605354, 4132.848767431116, 2650.7197806906615, 5944.794147038659, 9336.085227637132, 4568.031731508195, 1094.7213486106184, 33816.31318680089, 3908.1624136392775, 10125.786806527369, 3856.188060962913, 5289.502570154169, 1617.0246439755638, 3450.248600070297, 1589.840521485602, 2538.8824356759596, 1078.5664340771104, -874.1775141024975, 2345.447770213517, -3361.8363508575508, -133.72787777691514, -418.1031191464939, -2180.969281085637, 1375.2418033283368, 613.4790992106391, -1312.868312085307, 2358.202382581388, 4520.540413439848, 3159.5969971162563]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7299882223565362, "mean_inference_ms": 1.582612879851294, "mean_action_processing_ms": 0.3117856597615685, "mean_env_wait_ms": 0.14134496597617013, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004811406135559082, "StateBufferConnector_ms": 0.004731416702270508, "ViewRequirementAgentConnector_ms": 0.13444507122039795}, "num_episodes": 23, "episode_return_max": 33385.83395252258, "episode_return_min": 0.0, "episode_return_mean": 6191.22948520853, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.25035443862083, "num_env_steps_trained_throughput_per_sec": 286.25035443862083, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 13785.672, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13785.628, "sample_time_ms": 1216.618, "learn_time_ms": 12553.471, "learn_throughput": 318.637, "synch_weights_time_ms": 14.636}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "6751e_00000", "date": "2024-08-11_19-21-40", "timestamp": 1723418500, "time_this_iter_s": 14.02633285522461, "time_total_s": 867.0226693153381, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaa4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 867.0226693153381, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 49.59, "ram_util_percent": 83.13}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6964537880881123, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.757406532449066, "policy_loss": -0.004039992914638585, "vf_loss": 9.761388256436302, "vf_explained_var": -0.001101951561276875, "kl": 0.004661512450860225, "entropy": 0.6538526926406477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8184400879043751, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.66928360399115, "policy_loss": -0.009694847064499286, "vf_loss": 9.677931408655075, "vf_explained_var": -0.00013972662744067964, "kl": 0.010470441087511563, "entropy": 0.8698013499300316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 33385.83395252258, "episode_reward_min": 0.0, "episode_reward_mean": 6530.059534570681, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -8152.483054718267, "predator_policy": -7511.649687447052}, "policy_reward_max": {"prey_policy": 9385.446745014662, "predator_policy": 33816.31318680089}, "policy_reward_mean": {"prey_policy": 501.1038037517357, "predator_policy": 2763.9259635336043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [735.6003750902363, 12711.34667567598, 1670.790311532722, 736.1430627157563, 8317.280369165524, 3779.96837725906, 0.0, 1580.1336738912582, 2933.3315377896, 322.797153324653, 7722.998760026359, 5149.575567375901, 1639.3432472951772, 19923.017695159793, 8063.922999569026, 340.21721174494587, 16381.473215665941, 7157.424272078093, 12223.182766644844, 10098.619825324497, 5558.84485649983, 3479.3299397842093, 2819.384126409906, 1982.8017313520131, 1279.566649246206, 16545.38069571099, 428.8271057460402, 3407.765883675431, 9202.21084071175, 5941.708946553712, 1010.4653692504917, 5446.382885010976, 6803.602653788998, 5304.941411456985, 11240.853618328707, 952.9210900172499, 8228.816454617647, 1630.5546331691437, 30177.784707741484, 3446.5319108938033, 11360.46510180548, 4963.097477285158, 1033.6018638956841, 8284.483966396738, 4788.323222258133, 28851.3372608086, 5632.195086599458, 13568.24808869159, 1852.518836040412, 5642.374230046695, 226.99953512047517, 22698.16818704257, 6945.1223854125965, 6108.209986084664, 4859.440210043575, 0.0, 7785.4017993844645, 808.7181920372961, 13592.59936212053, 3868.5937811238614, 5588.866914297074, 3623.8049350491133, 1034.0858672672273, 5568.147528440198, 9496.43917279811, 123.9632298664726, 2406.9542737850306, 9117.328162319207, 6689.520038562219, 6900.992278861621, 9132.794726056898, 33385.83395252258, 9988.799381033316, 5112.523003605043, 5909.432978480855, 4042.3669222039366, 1967.4971361205237, 243.1120770226368, 4106.400962090306, 1733.663735276573, 4312.303194667861, 7397.188063378943, 1122.521777289881, 9492.290547767565, 6229.1258984655005, 4211.247612739453, 11676.416198500989, 2044.0463975528644, 496.3194895856286, 17111.773896624694, 16558.168660611693, 7409.228756603368, 3888.4531635199696, 122.90241576888454, 6938.013293693187, 3106.5015294033133, 12101.206874275853, 9944.006466577805, 3425.9707648887957, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1239.1630978762487, -1757.504647815388, -2401.748036362844, -340.29957484776565, 1179.1858086632164, -229.02142143224688, 4246.575234493345, -2586.7907654830906, -265.4241192854437, -3300.1325442114007, 8709.134733076304, -119.93531609132765, 5988.1722439153355, -2723.539300196334, 2725.927373732665, -3025.450095136589, -1252.4723701880725, 290.89735144100547, 7026.995813448902, -1400.756575034636, 6527.790897107691, -2629.1322197898976, 5779.002725972292, 2773.8810723621136, 451.61844882243685, -3565.5911550732544, 709.4651307310613, -642.6739105461238, 134.86608009123339, -1584.459869584278, -871.7035301361194, -405.22942178614244, 869.2230285006178, -896.4831564131272, 2941.4739534301866, -2781.612205266452, -1019.6990712052277, -3887.2526080256976, -328.1039009790125, -2202.284468474824, 2673.051134242071, -726.6204453564603, 5694.633860948193, 22.239278930746636, 8767.203345971646, -3931.2576318490824, 8640.234929897664, 1482.8425043246996, -747.2382661503959, -3323.80262441261, 3036.317648023743, -2963.0851329448224, 1413.1772426745297, -5889.938541811347, -1031.8049806162142, -1914.9053631251404, 2262.761600207033, 151.61596531863583, 7336.699258393671, -578.4855576146282, 8939.809826062336, 504.80102385739656, -1999.404390983584, -3352.7622425822574, 3028.0275431584105, -397.92781808881455, 4764.793570226494, -1621.909188390526, 3886.7630947251596, -1575.329243907917, 4931.492016999436, 1384.7012531374987, 3998.055919321336, -920.5920380638663, -662.0623676698077, -1014.3368261493159, -796.3955790059963, -1495.0108834398886, -776.8211741799397, -1526.3447674851334, -2161.3741601614765, -2504.7240453897793, 5855.843165210088, -2742.937030193579, 3087.3582415003766, -1464.490096944499, 9385.446745014662, -2677.791563570033, 5330.420133257259, 2500.7755259618, -1754.2978531527085, -389.79081301793997, 8851.813940534621, 352.5234684641807, 5848.926309438139, -2298.5600953545595, -2364.0656353111353, -1997.7218081717704, 2102.747105710689, -4414.556181020785, 1602.345407050591, -4690.613575846809, -1870.3198658190759, -904.0364207222094, 654.3547309495921, -2398.246163965054, 2036.8377636741195, -2159.575446613697, 3245.8600092021065, -1918.39902954242, 6315.064065870862, -2062.850125835287, 1007.8653831972724, -2068.355504422819, 556.3430356460026, -8152.483054718267, 5952.6547001930485, -1062.698975350995, 6243.1863066069245, -3642.688891677937, 1467.6495137192458, -4571.575067379078, -473.6399850856528, -4494.710911543349, -946.5715507704106, 126.60917199121407, 1034.6660755866078, -2812.230330786875, -489.4075374597576, -2288.5348168758387, 51.95495295386932, -1520.4160661116678, 4133.128666531019, -614.6912866884967, 8295.841638128375, -1204.8220086120496, 2656.1312277311563, -2750.1797372907185, -3468.99263584259, -4910.894459971593, 4808.798535169645, -1338.7568892315599, -2181.2385021213304, -2157.403145796246, -481.05860833974936, -3512.1168781172255, 297.7840461189614, -2091.788256643643, -629.6022265014012, 1498.946083426358, 1175.9684016492276, -751.0503491983593, 3711.279278511766, -3215.0523985022583, 6184.65297962244, -2445.9766739653337, 6849.0237856547765, -143.55042333233501, 642.0553156708424, -897.112482933244, 4571.300745521253, -1304.331621349485, 1029.4165283999118, -1312.3658755770778, 6575.679517670887, 1012.7999635376103, 3831.4432117470683, -126.12042845313287, -2806.1943491196116, -1639.8688843047485, -895.6182544258995, -2729.9349911650224, 1061.35838942858, -1087.3768967795042, 6941.196652735829, -852.1614692724149, -474.6614932609818, -2320.0874511599827, 6913.610555582855, -735.8523899328321, 4797.275099793919, -1407.590247840782, -219.26483347692607, 576.4423000040302, 6020.461304747613, -501.35964001154105, 3222.654898549139, -373.00314287640845, 4198.602154822589, -2082.539558320359, 4727.923634070595, -1128.8652174701401, 6809.130999548079, -2047.4884690878205, 4360.671476494342, -877.9225668634216, 3491.573149142918, -2025.071854235975, 3116.9609931628297, -912.2259965653858], "policy_predator_policy_reward": [553.8445963473226, 700.0973286820524, 12328.00605633458, 3125.388230552001, -520.1141537259396, 1240.740078027693, -747.637974075602, -176.0034322189005, 10177.902430297794, 1704.9346023645837, -7491.606172469339, 2682.375132743434, -3685.0988649043557, 420.4659211853585, 793.1974937718464, 1086.4589015233437, 2891.988693617953, 1002.9178629187065, -4233.320373680359, -1070.1217114092537, 1960.142276305955, 1864.1978064026111, -2169.427419635272, -1233.880811323227, 1683.5394792811157, 3069.7764742648797, 15014.40693733097, 4841.81953764391, 6052.126378425465, 3461.3904106366163, 506.63534554019543, 1110.5148181270129, 12043.437093122173, 4365.296250456256, 5069.617672853965, 1927.944851060403, 8863.885890972148, 8266.248554903605, 7195.660152527701, 5433.348042250634, 1283.3099441044262, 2329.1042235098034, -1841.7436758078766, -395.79952428685937, -2780.8206092125974, 764.2590214999286, -3780.4917733148422, -4359.783929555524, 2311.6502790294508, 3038.957260779763, 14269.086105287402, 2203.0620753446647, 2541.791678425869, 2363.796726456986, 1701.288058297483, 4653.188169119302, 5871.993213695438, 915.8400614906565, -842.4886755758249, 25.983921350480472, -7511.649687447052, -922.4957932221837, 5529.351965603154, 5269.197552973689, 1287.7265942805725, 2885.77633443883, 3448.2873236162663, -1286.230293995265, 6078.3525727007545, 2851.067194810667, -1724.9696544574224, -3638.302525662265, -142.5621551004052, 5293.914728460577, 1414.573060726623, 1892.3807662616434, 24606.970613817823, 7862.220556369565, 5072.917834541501, 676.7800180173754, 9579.508546252924, 6447.0547611038055, 637.8389961931949, 1212.3523460754566, 1740.7019487429293, -2329.968229403124, 5800.982594515725, -4224.153809563629, -2366.5243899820016, -676.3480469789254, 24461.167407060097, 6534.258519919132, -3797.6567934593536, 225.51447106000646, 7779.724600984607, 2238.1572736234475, 3106.7560423601635, 3107.550237163148, 5369.442280931189, 2584.7410244256052, 3599.5621372248756, -284.29443330818185, 16560.772412952312, 8911.75206063152, 4219.924224801082, 4469.089593626977, 5041.611824007789, 1189.3358450164535, -659.5849510805033, 4191.564181464386, -4548.97118229098, 296.7572422554058, 4724.289453848731, 4121.602466761277, 5929.5281925221925, 2475.3300185873686, 8822.90438180728, -120.26074452878503, -1851.1718573085404, 3119.2682235034063, 6500.793451615118, 2191.9990163417947, 6127.143403293258, 2465.0124283848613, 1704.534089380222, 149.5141566662018, 3116.0880433955317, 4229.623740244928, 9850.50599640353, 2423.8755307301726, 1010.0219233497357, 582.4024196745353, -386.8523328053061, -724.6307732521846, -547.5418573576453, 2573.8503901605354, 4132.848767431116, 2650.7197806906615, 5944.794147038659, 9336.085227637132, 4568.031731508195, 1094.7213486106184, 33816.31318680089, 3908.1624136392775, 10125.786806527369, 3856.188060962913, 5289.502570154169, 1617.0246439755638, 3450.248600070297, 1589.840521485602, 2538.8824356759596, 1078.5664340771104, -874.1775141024975, 2345.447770213517, -3361.8363508575508, -133.72787777691514, -418.1031191464939, -2180.969281085637, 1375.2418033283368, 613.4790992106391, -1312.868312085307, 2358.202382581388, 4520.540413439848, 3159.5969971162563, -3736.6244322600382, -2729.333271658586, 6290.333475779651, -503.36571130601664, 7353.600158293114, 3321.5889735967403, 3634.482313499753, 4202.318544830625, 5104.122611358947, 6598.312094492939, 327.8238672663936, -4372.812653176957, 2480.499692384007, 810.5687416225857, 10442.071628417665, 491.94410255696437, 7582.533999851835, 5585.9498088067, 7838.248792576669, -786.197502500404, 1302.9653238803685, -2933.613825096467, 1156.263376059476, -3883.0127159633234, 5916.533049510562, -1094.5823523195922, -1395.7273060395394, 903.170418842399, 7530.069255854771, -190.50491203916982, 6564.636410361551, -103.37885341465613, 863.3543270057614, 1096.1151429760926, -1719.7786549335663, -484.9563416638756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.728554836918946, "mean_inference_ms": 1.5793229539112428, "mean_action_processing_ms": 0.31102808916131947, "mean_env_wait_ms": 0.14105949207645735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004982471466064453, "StateBufferConnector_ms": 0.003924250602722168, "ViewRequirementAgentConnector_ms": 0.14492201805114746}, "num_episodes": 18, "episode_return_max": 33385.83395252258, "episode_return_min": 0.0, "episode_return_mean": 6530.059534570681, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.42119046246677, "num_env_steps_trained_throughput_per_sec": 283.42119046246677, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 13811.038, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13810.993, "sample_time_ms": 1186.589, "learn_time_ms": 12608.508, "learn_throughput": 317.246, "synch_weights_time_ms": 14.992}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "6751e_00000", "date": "2024-08-11_19-21-54", "timestamp": 1723418514, "time_this_iter_s": 14.149643898010254, "time_total_s": 881.1723132133484, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eabaa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 881.1723132133484, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 55.435, "ram_util_percent": 83.08}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6768562282203997, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.754444545160526, "policy_loss": -0.007025300506034265, "vf_loss": 9.761390845485465, "vf_explained_var": -0.0007442998192297718, "kl": 0.012635842557494042, "entropy": 0.6963180475134068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6680599016171914, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.14182937107389, "policy_loss": -0.007938040017825429, "vf_loss": 9.148739734023968, "vf_explained_var": 9.529931204659597e-06, "kl": 0.01027696920537424, "entropy": 0.8357429604366343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 33385.83395252258, "episode_reward_min": 0.0, "episode_reward_mean": 6790.980677056894, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -8152.483054718267, "predator_policy": -7511.649687447052}, "policy_reward_max": {"prey_policy": 9385.446745014662, "predator_policy": 33816.31318680089}, "policy_reward_mean": {"prey_policy": 453.9504895175739, "predator_policy": 2941.5398490108714}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12223.182766644844, 10098.619825324497, 5558.84485649983, 3479.3299397842093, 2819.384126409906, 1982.8017313520131, 1279.566649246206, 16545.38069571099, 428.8271057460402, 3407.765883675431, 9202.21084071175, 5941.708946553712, 1010.4653692504917, 5446.382885010976, 6803.602653788998, 5304.941411456985, 11240.853618328707, 952.9210900172499, 8228.816454617647, 1630.5546331691437, 30177.784707741484, 3446.5319108938033, 11360.46510180548, 4963.097477285158, 1033.6018638956841, 8284.483966396738, 4788.323222258133, 28851.3372608086, 5632.195086599458, 13568.24808869159, 1852.518836040412, 5642.374230046695, 226.99953512047517, 22698.16818704257, 6945.1223854125965, 6108.209986084664, 4859.440210043575, 0.0, 7785.4017993844645, 808.7181920372961, 13592.59936212053, 3868.5937811238614, 5588.866914297074, 3623.8049350491133, 1034.0858672672273, 5568.147528440198, 9496.43917279811, 123.9632298664726, 2406.9542737850306, 9117.328162319207, 6689.520038562219, 6900.992278861621, 9132.794726056898, 33385.83395252258, 9988.799381033316, 5112.523003605043, 5909.432978480855, 4042.3669222039366, 1967.4971361205237, 243.1120770226368, 4106.400962090306, 1733.663735276573, 4312.303194667861, 7397.188063378943, 1122.521777289881, 9492.290547767565, 6229.1258984655005, 4211.247612739453, 11676.416198500989, 2044.0463975528644, 496.3194895856286, 17111.773896624694, 16558.168660611693, 7409.228756603368, 3888.4531635199696, 122.90241576888454, 6938.013293693187, 3106.5015294033133, 12101.206874275853, 9944.006466577805, 3425.9707648887957, 0.0, 4642.116985447797, 438.74705963463697, 2077.605762237234, 11348.65439743326, 771.3548869530047, 120.93682324362175, 4583.211754436544, 18033.684062576784, 3809.3906765110073, 17516.52159369395, 12901.24653027112, 13060.567464563494, 5777.976922813744, 11371.244016974048, 0.0, 12159.185050083182, 247.9515521784663, 6397.083214929342], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1019.6990712052277, -3887.2526080256976, -328.1039009790125, -2202.284468474824, 2673.051134242071, -726.6204453564603, 5694.633860948193, 22.239278930746636, 8767.203345971646, -3931.2576318490824, 8640.234929897664, 1482.8425043246996, -747.2382661503959, -3323.80262441261, 3036.317648023743, -2963.0851329448224, 1413.1772426745297, -5889.938541811347, -1031.8049806162142, -1914.9053631251404, 2262.761600207033, 151.61596531863583, 7336.699258393671, -578.4855576146282, 8939.809826062336, 504.80102385739656, -1999.404390983584, -3352.7622425822574, 3028.0275431584105, -397.92781808881455, 4764.793570226494, -1621.909188390526, 3886.7630947251596, -1575.329243907917, 4931.492016999436, 1384.7012531374987, 3998.055919321336, -920.5920380638663, -662.0623676698077, -1014.3368261493159, -796.3955790059963, -1495.0108834398886, -776.8211741799397, -1526.3447674851334, -2161.3741601614765, -2504.7240453897793, 5855.843165210088, -2742.937030193579, 3087.3582415003766, -1464.490096944499, 9385.446745014662, -2677.791563570033, 5330.420133257259, 2500.7755259618, -1754.2978531527085, -389.79081301793997, 8851.813940534621, 352.5234684641807, 5848.926309438139, -2298.5600953545595, -2364.0656353111353, -1997.7218081717704, 2102.747105710689, -4414.556181020785, 1602.345407050591, -4690.613575846809, -1870.3198658190759, -904.0364207222094, 654.3547309495921, -2398.246163965054, 2036.8377636741195, -2159.575446613697, 3245.8600092021065, -1918.39902954242, 6315.064065870862, -2062.850125835287, 1007.8653831972724, -2068.355504422819, 556.3430356460026, -8152.483054718267, 5952.6547001930485, -1062.698975350995, 6243.1863066069245, -3642.688891677937, 1467.6495137192458, -4571.575067379078, -473.6399850856528, -4494.710911543349, -946.5715507704106, 126.60917199121407, 1034.6660755866078, -2812.230330786875, -489.4075374597576, -2288.5348168758387, 51.95495295386932, -1520.4160661116678, 4133.128666531019, -614.6912866884967, 8295.841638128375, -1204.8220086120496, 2656.1312277311563, -2750.1797372907185, -3468.99263584259, -4910.894459971593, 4808.798535169645, -1338.7568892315599, -2181.2385021213304, -2157.403145796246, -481.05860833974936, -3512.1168781172255, 297.7840461189614, -2091.788256643643, -629.6022265014012, 1498.946083426358, 1175.9684016492276, -751.0503491983593, 3711.279278511766, -3215.0523985022583, 6184.65297962244, -2445.9766739653337, 6849.0237856547765, -143.55042333233501, 642.0553156708424, -897.112482933244, 4571.300745521253, -1304.331621349485, 1029.4165283999118, -1312.3658755770778, 6575.679517670887, 1012.7999635376103, 3831.4432117470683, -126.12042845313287, -2806.1943491196116, -1639.8688843047485, -895.6182544258995, -2729.9349911650224, 1061.35838942858, -1087.3768967795042, 6941.196652735829, -852.1614692724149, -474.6614932609818, -2320.0874511599827, 6913.610555582855, -735.8523899328321, 4797.275099793919, -1407.590247840782, -219.26483347692607, 576.4423000040302, 6020.461304747613, -501.35964001154105, 3222.654898549139, -373.00314287640845, 4198.602154822589, -2082.539558320359, 4727.923634070595, -1128.8652174701401, 6809.130999548079, -2047.4884690878205, 4360.671476494342, -877.9225668634216, 3491.573149142918, -2025.071854235975, 3116.9609931628297, -912.2259965653858, 1588.6057318199894, -1652.7646220584925, 4051.0656588119477, -6121.952160945381, 5424.1975691641865, -1232.2710244711764, -1941.9830749487076, -3048.3417121386974, 4283.337047416001, -990.8495150773967, 3284.7304063118695, -2669.228771334728, 7755.089147685808, -1496.5397666455447, -117.16513038477085, -2011.5532437379024, 2892.2755480051346, -2615.9453011410196, 6343.566256691943, -308.70771511455735, -839.9967816083025, -1118.7223520664174, 4784.941906880652, -2655.885005496597, -1559.9374009012824, -3959.6246868990665, 5650.805952598343, -2281.430801589364, 1925.4916502580604, -1920.530438448482, 3518.3123262088393, -952.8837571684626, 2182.195932330036, -4338.976793344767, 1199.30273575083, -1665.8779022607798], "policy_predator_policy_reward": [8863.885890972148, 8266.248554903605, 7195.660152527701, 5433.348042250634, 1283.3099441044262, 2329.1042235098034, -1841.7436758078766, -395.79952428685937, -2780.8206092125974, 764.2590214999286, -3780.4917733148422, -4359.783929555524, 2311.6502790294508, 3038.957260779763, 14269.086105287402, 2203.0620753446647, 2541.791678425869, 2363.796726456986, 1701.288058297483, 4653.188169119302, 5871.993213695438, 915.8400614906565, -842.4886755758249, 25.983921350480472, -7511.649687447052, -922.4957932221837, 5529.351965603154, 5269.197552973689, 1287.7265942805725, 2885.77633443883, 3448.2873236162663, -1286.230293995265, 6078.3525727007545, 2851.067194810667, -1724.9696544574224, -3638.302525662265, -142.5621551004052, 5293.914728460577, 1414.573060726623, 1892.3807662616434, 24606.970613817823, 7862.220556369565, 5072.917834541501, 676.7800180173754, 9579.508546252924, 6447.0547611038055, 637.8389961931949, 1212.3523460754566, 1740.7019487429293, -2329.968229403124, 5800.982594515725, -4224.153809563629, -2366.5243899820016, -676.3480469789254, 24461.167407060097, 6534.258519919132, -3797.6567934593536, 225.51447106000646, 7779.724600984607, 2238.1572736234475, 3106.7560423601635, 3107.550237163148, 5369.442280931189, 2584.7410244256052, 3599.5621372248756, -284.29443330818185, 16560.772412952312, 8911.75206063152, 4219.924224801082, 4469.089593626977, 5041.611824007789, 1189.3358450164535, -659.5849510805033, 4191.564181464386, -4548.97118229098, 296.7572422554058, 4724.289453848731, 4121.602466761277, 5929.5281925221925, 2475.3300185873686, 8822.90438180728, -120.26074452878503, -1851.1718573085404, 3119.2682235034063, 6500.793451615118, 2191.9990163417947, 6127.143403293258, 2465.0124283848613, 1704.534089380222, 149.5141566662018, 3116.0880433955317, 4229.623740244928, 9850.50599640353, 2423.8755307301726, 1010.0219233497357, 582.4024196745353, -386.8523328053061, -724.6307732521846, -547.5418573576453, 2573.8503901605354, 4132.848767431116, 2650.7197806906615, 5944.794147038659, 9336.085227637132, 4568.031731508195, 1094.7213486106184, 33816.31318680089, 3908.1624136392775, 10125.786806527369, 3856.188060962913, 5289.502570154169, 1617.0246439755638, 3450.248600070297, 1589.840521485602, 2538.8824356759596, 1078.5664340771104, -874.1775141024975, 2345.447770213517, -3361.8363508575508, -133.72787777691514, -418.1031191464939, -2180.969281085637, 1375.2418033283368, 613.4790992106391, -1312.868312085307, 2358.202382581388, 4520.540413439848, 3159.5969971162563, -3736.6244322600382, -2729.333271658586, 6290.333475779651, -503.36571130601664, 7353.600158293114, 3321.5889735967403, 3634.482313499753, 4202.318544830625, 5104.122611358947, 6598.312094492939, 327.8238672663936, -4372.812653176957, 2480.499692384007, 810.5687416225857, 10442.071628417665, 491.94410255696437, 7582.533999851835, 5585.9498088067, 7838.248792576669, -786.197502500404, 1302.9653238803685, -2933.613825096467, 1156.263376059476, -3883.0127159633234, 5916.533049510562, -1094.5823523195922, -1395.7273060395394, 903.170418842399, 7530.069255854771, -190.50491203916982, 6564.636410361551, -103.37885341465613, 863.3543270057614, 1096.1151429760926, -1719.7786549335663, -484.9563416638756, 2902.2287316416205, 1804.0471440446802, -582.4305673915431, 3092.064129159592, -4771.196852796876, 2656.8760703410985, 11690.080819649595, 4648.898364871073, -2930.4981051638047, 409.3654597782112, -1784.8745581747103, 1290.309746441191, -991.4355951420758, -683.9020314616334, 17622.109293486887, 2540.293143212545, 4615.644363161398, -1082.5839335145035, 11895.093212021788, -413.4301599052891, 8902.511213342868, 5957.45445060295, 3982.2318370257235, 6949.278726153712, 4696.397433074366, 6601.141577539733, 5553.5405247357785, 2448.3283412293017, -1283.457768165326, 1278.496556355745, 7925.672375697466, 1668.0841053453212, 1257.409306434425, 1147.3231067587674, 5370.410014563586, 1493.2483668757054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7269582797989969, "mean_inference_ms": 1.5755029463291592, "mean_action_processing_ms": 0.31020808900773944, "mean_env_wait_ms": 0.1406947437976073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004932880401611328, "StateBufferConnector_ms": 0.003969788551330566, "ViewRequirementAgentConnector_ms": 0.14255547523498535}, "num_episodes": 18, "episode_return_max": 33385.83395252258, "episode_return_min": 0.0, "episode_return_mean": 6790.980677056894, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.4517014284797, "num_env_steps_trained_throughput_per_sec": 287.4517014284797, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 13818.615, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13818.571, "sample_time_ms": 1165.165, "learn_time_ms": 12637.429, "learn_throughput": 316.52, "synch_weights_time_ms": 15.059}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "6751e_00000", "date": "2024-08-11_19-22-08", "timestamp": 1723418528, "time_this_iter_s": 13.988412857055664, "time_total_s": 895.160726070404, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaba280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 895.160726070404, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 53.29473684210526, "ram_util_percent": 82.31052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8130350881310368, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.13629594631296, "policy_loss": -0.0038656998216297736, "vf_loss": 9.140131439733757, "vf_explained_var": -0.003936755720269743, "kl": 0.004828403536312038, "entropy": 0.7825165494409188, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6360734462264984, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.179793028856711, "policy_loss": -0.004836858504589785, "vf_loss": 9.183924919713743, "vf_explained_var": 9.325357971998749e-05, "kl": 0.007049542192423116, "entropy": 0.806771299006447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 33385.83395252258, "episode_reward_min": 0.0, "episode_reward_mean": 7905.040967060566, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -8152.483054718267, "predator_policy": -5956.9761377153545}, "policy_reward_max": {"prey_policy": 10461.158842582, "predator_policy": 33816.31318680089}, "policy_reward_mean": {"prey_policy": 331.9021728651927, "predator_policy": 3620.6183106650888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11360.46510180548, 4963.097477285158, 1033.6018638956841, 8284.483966396738, 4788.323222258133, 28851.3372608086, 5632.195086599458, 13568.24808869159, 1852.518836040412, 5642.374230046695, 226.99953512047517, 22698.16818704257, 6945.1223854125965, 6108.209986084664, 4859.440210043575, 0.0, 7785.4017993844645, 808.7181920372961, 13592.59936212053, 3868.5937811238614, 5588.866914297074, 3623.8049350491133, 1034.0858672672273, 5568.147528440198, 9496.43917279811, 123.9632298664726, 2406.9542737850306, 9117.328162319207, 6689.520038562219, 6900.992278861621, 9132.794726056898, 33385.83395252258, 9988.799381033316, 5112.523003605043, 5909.432978480855, 4042.3669222039366, 1967.4971361205237, 243.1120770226368, 4106.400962090306, 1733.663735276573, 4312.303194667861, 7397.188063378943, 1122.521777289881, 9492.290547767565, 6229.1258984655005, 4211.247612739453, 11676.416198500989, 2044.0463975528644, 496.3194895856286, 17111.773896624694, 16558.168660611693, 7409.228756603368, 3888.4531635199696, 122.90241576888454, 6938.013293693187, 3106.5015294033133, 12101.206874275853, 9944.006466577805, 3425.9707648887957, 0.0, 4642.116985447797, 438.74705963463697, 2077.605762237234, 11348.65439743326, 771.3548869530047, 120.93682324362175, 4583.211754436544, 18033.684062576784, 3809.3906765110073, 17516.52159369395, 12901.24653027112, 13060.567464563494, 5777.976922813744, 11371.244016974048, 0.0, 12159.185050083182, 247.9515521784663, 6397.083214929342, 5895.237117895222, 0.0, 19453.957167976834, 0.0, 10163.849469610674, 20850.647284158633, 9624.72356711219, 20463.29667634374, 5409.235599166466, 20772.09002964631, 0.0, 14440.027261865853, 14021.860088401254, 529.0201765745217, 14798.722819333723, 24894.443596128556, 16826.212556749593, 20231.97356015877, 4406.586422200146, 24152.651337094845, 2515.6828164399285, 9166.28955544492], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2161.3741601614765, -2504.7240453897793, 5855.843165210088, -2742.937030193579, 3087.3582415003766, -1464.490096944499, 9385.446745014662, -2677.791563570033, 5330.420133257259, 2500.7755259618, -1754.2978531527085, -389.79081301793997, 8851.813940534621, 352.5234684641807, 5848.926309438139, -2298.5600953545595, -2364.0656353111353, -1997.7218081717704, 2102.747105710689, -4414.556181020785, 1602.345407050591, -4690.613575846809, -1870.3198658190759, -904.0364207222094, 654.3547309495921, -2398.246163965054, 2036.8377636741195, -2159.575446613697, 3245.8600092021065, -1918.39902954242, 6315.064065870862, -2062.850125835287, 1007.8653831972724, -2068.355504422819, 556.3430356460026, -8152.483054718267, 5952.6547001930485, -1062.698975350995, 6243.1863066069245, -3642.688891677937, 1467.6495137192458, -4571.575067379078, -473.6399850856528, -4494.710911543349, -946.5715507704106, 126.60917199121407, 1034.6660755866078, -2812.230330786875, -489.4075374597576, -2288.5348168758387, 51.95495295386932, -1520.4160661116678, 4133.128666531019, -614.6912866884967, 8295.841638128375, -1204.8220086120496, 2656.1312277311563, -2750.1797372907185, -3468.99263584259, -4910.894459971593, 4808.798535169645, -1338.7568892315599, -2181.2385021213304, -2157.403145796246, -481.05860833974936, -3512.1168781172255, 297.7840461189614, -2091.788256643643, -629.6022265014012, 1498.946083426358, 1175.9684016492276, -751.0503491983593, 3711.279278511766, -3215.0523985022583, 6184.65297962244, -2445.9766739653337, 6849.0237856547765, -143.55042333233501, 642.0553156708424, -897.112482933244, 4571.300745521253, -1304.331621349485, 1029.4165283999118, -1312.3658755770778, 6575.679517670887, 1012.7999635376103, 3831.4432117470683, -126.12042845313287, -2806.1943491196116, -1639.8688843047485, -895.6182544258995, -2729.9349911650224, 1061.35838942858, -1087.3768967795042, 6941.196652735829, -852.1614692724149, -474.6614932609818, -2320.0874511599827, 6913.610555582855, -735.8523899328321, 4797.275099793919, -1407.590247840782, -219.26483347692607, 576.4423000040302, 6020.461304747613, -501.35964001154105, 3222.654898549139, -373.00314287640845, 4198.602154822589, -2082.539558320359, 4727.923634070595, -1128.8652174701401, 6809.130999548079, -2047.4884690878205, 4360.671476494342, -877.9225668634216, 3491.573149142918, -2025.071854235975, 3116.9609931628297, -912.2259965653858, 1588.6057318199894, -1652.7646220584925, 4051.0656588119477, -6121.952160945381, 5424.1975691641865, -1232.2710244711764, -1941.9830749487076, -3048.3417121386974, 4283.337047416001, -990.8495150773967, 3284.7304063118695, -2669.228771334728, 7755.089147685808, -1496.5397666455447, -117.16513038477085, -2011.5532437379024, 2892.2755480051346, -2615.9453011410196, 6343.566256691943, -308.70771511455735, -839.9967816083025, -1118.7223520664174, 4784.941906880652, -2655.885005496597, -1559.9374009012824, -3959.6246868990665, 5650.805952598343, -2281.430801589364, 1925.4916502580604, -1920.530438448482, 3518.3123262088393, -952.8837571684626, 2182.195932330036, -4338.976793344767, 1199.30273575083, -1665.8779022607798, -1977.5633454735914, -2724.0146141434584, 5530.819476371169, -2402.766125247632, 10461.158842582, -552.9146654080989, 5011.365009822133, -4442.736630460169, -3142.251674179686, -3040.8823992785383, 1246.3526750415172, -533.4655308675998, 2347.647734145456, -2417.095958008325, 3946.979304624402, -1565.383530209881, 1555.2506418278408, -2955.4686592761636, 696.7281641681317, -732.0830689427615, -83.72633856800005, 311.9549506127745, 1885.0004448802442, -1913.3359136203571, -2698.6290798635696, -2230.85947943589, -169.41344171295182, -1456.1434906775355, 3059.2257612742724, -1635.6751723427353, 594.4989136681738, -1287.9736024541128, -1574.1252677546925, -3560.5515310199767, -1706.1738344136254, -908.15505069792, 7427.0136022006645, -1884.8120272209032, -1768.039884851964, -564.7669527062238, 4807.607643337835, 611.299546475601, 4135.440971158109, 126.84616007798977], "policy_predator_policy_reward": [9579.508546252924, 6447.0547611038055, 637.8389961931949, 1212.3523460754566, 1740.7019487429293, -2329.968229403124, 5800.982594515725, -4224.153809563629, -2366.5243899820016, -676.3480469789254, 24461.167407060097, 6534.258519919132, -3797.6567934593536, 225.51447106000646, 7779.724600984607, 2238.1572736234475, 3106.7560423601635, 3107.550237163148, 5369.442280931189, 2584.7410244256052, 3599.5621372248756, -284.29443330818185, 16560.772412952312, 8911.75206063152, 4219.924224801082, 4469.089593626977, 5041.611824007789, 1189.3358450164535, -659.5849510805033, 4191.564181464386, -4548.97118229098, 296.7572422554058, 4724.289453848731, 4121.602466761277, 5929.5281925221925, 2475.3300185873686, 8822.90438180728, -120.26074452878503, -1851.1718573085404, 3119.2682235034063, 6500.793451615118, 2191.9990163417947, 6127.143403293258, 2465.0124283848613, 1704.534089380222, 149.5141566662018, 3116.0880433955317, 4229.623740244928, 9850.50599640353, 2423.8755307301726, 1010.0219233497357, 582.4024196745353, -386.8523328053061, -724.6307732521846, -547.5418573576453, 2573.8503901605354, 4132.848767431116, 2650.7197806906615, 5944.794147038659, 9336.085227637132, 4568.031731508195, 1094.7213486106184, 33816.31318680089, 3908.1624136392775, 10125.786806527369, 3856.188060962913, 5289.502570154169, 1617.0246439755638, 3450.248600070297, 1589.840521485602, 2538.8824356759596, 1078.5664340771104, -874.1775141024975, 2345.447770213517, -3361.8363508575508, -133.72787777691514, -418.1031191464939, -2180.969281085637, 1375.2418033283368, 613.4790992106391, -1312.868312085307, 2358.202382581388, 4520.540413439848, 3159.5969971162563, -3736.6244322600382, -2729.333271658586, 6290.333475779651, -503.36571130601664, 7353.600158293114, 3321.5889735967403, 3634.482313499753, 4202.318544830625, 5104.122611358947, 6598.312094492939, 327.8238672663936, -4372.812653176957, 2480.499692384007, 810.5687416225857, 10442.071628417665, 491.94410255696437, 7582.533999851835, 5585.9498088067, 7838.248792576669, -786.197502500404, 1302.9653238803685, -2933.613825096467, 1156.263376059476, -3883.0127159633234, 5916.533049510562, -1094.5823523195922, -1395.7273060395394, 903.170418842399, 7530.069255854771, -190.50491203916982, 6564.636410361551, -103.37885341465613, 863.3543270057614, 1096.1151429760926, -1719.7786549335663, -484.9563416638756, 2902.2287316416205, 1804.0471440446802, -582.4305673915431, 3092.064129159592, -4771.196852796876, 2656.8760703410985, 11690.080819649595, 4648.898364871073, -2930.4981051638047, 409.3654597782112, -1784.8745581747103, 1290.309746441191, -991.4355951420758, -683.9020314616334, 17622.109293486887, 2540.293143212545, 4615.644363161398, -1082.5839335145035, 11895.093212021788, -413.4301599052891, 8902.511213342868, 5957.45445060295, 3982.2318370257235, 6949.278726153712, 4696.397433074366, 6601.141577539733, 5553.5405247357785, 2448.3283412293017, -1283.457768165326, 1278.496556355745, 7925.672375697466, 1668.0841053453212, 1257.409306434425, 1147.3231067587674, 5370.410014563586, 1493.2483668757054, 6750.222980057511, 3846.592097454748, -3769.1377597953797, 641.0844086718447, 12044.025246964427, -2498.312256161433, -568.6283793619607, 0.0, 9669.318629439813, 6677.664913629056, 18813.387630362955, 1324.372509621736, 4002.7634016112206, 5691.408389363836, 18675.265894321103, -593.5649923918974, 662.0270932114475, 6147.426523403342, 19326.020979190056, 1481.4239552308943, 528.1139155768135, -756.3425276215881, 11974.665290783027, 2493.6974398229345, 6646.137443643276, 12305.211204057441, 3113.15223210551, -958.5751231405026, 13296.93875171712, 78.23347868506283, 21243.22331572545, 4344.694969189052, 19409.623501083508, 2551.265854440768, 15711.360339542054, 7134.9421057283025, -5956.9761377153545, 4821.360984935726, 24411.74860630058, 2073.7095683524703, -1413.6716107706316, -1489.5527626028766, 5195.949481434257, -291.9470572254784]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7250138286672562, "mean_inference_ms": 1.5706780731760568, "mean_action_processing_ms": 0.3091158783919534, "mean_env_wait_ms": 0.14031529611712762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005737662315368652, "StateBufferConnector_ms": 0.004121303558349609, "ViewRequirementAgentConnector_ms": 0.1439903974533081}, "num_episodes": 22, "episode_return_max": 33385.83395252258, "episode_return_min": 0.0, "episode_return_mean": 7905.040967060566, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.7636722206026, "num_env_steps_trained_throughput_per_sec": 297.7636722206026, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 13799.602, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13799.558, "sample_time_ms": 1165.173, "learn_time_ms": 12618.526, "learn_throughput": 316.994, "synch_weights_time_ms": 14.938}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "6751e_00000", "date": "2024-08-11_19-22-22", "timestamp": 1723418542, "time_this_iter_s": 13.480999946594238, "time_total_s": 908.6417260169983, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30a242e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 908.6417260169983, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 52.94210526315789, "ram_util_percent": 82.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6560275790631456, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.643176547560111, "policy_loss": -0.007350314874202013, "vf_loss": 9.650490403049206, "vf_explained_var": -0.0017153853777224426, "kl": 0.011672177281613825, "entropy": 0.7302444912138439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6085378335108833, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.456220616234674, "policy_loss": -0.006669054844258994, "vf_loss": 9.461987129594913, "vf_explained_var": -1.7141885858364207e-05, "kl": 0.00902505533968117, "entropy": 0.7865181692693599, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 33385.83395252258, "episode_reward_min": -1.5987211554602254e-14, "episode_reward_mean": 8487.33063480336, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6121.952160945381, "predator_policy": -5956.9761377153545}, "policy_reward_max": {"prey_policy": 10461.158842582, "predator_policy": 33816.31318680089}, "policy_reward_mean": {"prey_policy": 404.94283599280186, "predator_policy": 3838.722481408878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5568.147528440198, 9496.43917279811, 123.9632298664726, 2406.9542737850306, 9117.328162319207, 6689.520038562219, 6900.992278861621, 9132.794726056898, 33385.83395252258, 9988.799381033316, 5112.523003605043, 5909.432978480855, 4042.3669222039366, 1967.4971361205237, 243.1120770226368, 4106.400962090306, 1733.663735276573, 4312.303194667861, 7397.188063378943, 1122.521777289881, 9492.290547767565, 6229.1258984655005, 4211.247612739453, 11676.416198500989, 2044.0463975528644, 496.3194895856286, 17111.773896624694, 16558.168660611693, 7409.228756603368, 3888.4531635199696, 122.90241576888454, 6938.013293693187, 3106.5015294033133, 12101.206874275853, 9944.006466577805, 3425.9707648887957, 0.0, 4642.116985447797, 438.74705963463697, 2077.605762237234, 11348.65439743326, 771.3548869530047, 120.93682324362175, 4583.211754436544, 18033.684062576784, 3809.3906765110073, 17516.52159369395, 12901.24653027112, 13060.567464563494, 5777.976922813744, 11371.244016974048, 0.0, 12159.185050083182, 247.9515521784663, 6397.083214929342, 5895.237117895222, 0.0, 19453.957167976834, 0.0, 10163.849469610674, 20850.647284158633, 9624.72356711219, 20463.29667634374, 5409.235599166466, 20772.09002964631, 0.0, 14440.027261865853, 14021.860088401254, 529.0201765745217, 14798.722819333723, 24894.443596128556, 16826.212556749593, 20231.97356015877, 4406.586422200146, 24152.651337094845, 2515.6828164399285, 9166.28955544492, 2393.680157915908, 11749.67943229469, 4640.6319435708265, 9089.838294825593, 12375.709312574289, 694.6379635305302, -1.5987211554602254e-14, 17239.802476571323, 20002.086698296964, 8767.90576521537, 8896.80742638455, 6782.547064309766, 6207.06843356948, 32005.235655184413, 15380.590348160995, 1377.1759359574417, 13664.08430394007, 9507.088458235132, 1503.485061420822, 4531.121330178592, 18818.833348295873, 120.57649843221955, 15597.037154226144], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1034.6660755866078, -2812.230330786875, -489.4075374597576, -2288.5348168758387, 51.95495295386932, -1520.4160661116678, 4133.128666531019, -614.6912866884967, 8295.841638128375, -1204.8220086120496, 2656.1312277311563, -2750.1797372907185, -3468.99263584259, -4910.894459971593, 4808.798535169645, -1338.7568892315599, -2181.2385021213304, -2157.403145796246, -481.05860833974936, -3512.1168781172255, 297.7840461189614, -2091.788256643643, -629.6022265014012, 1498.946083426358, 1175.9684016492276, -751.0503491983593, 3711.279278511766, -3215.0523985022583, 6184.65297962244, -2445.9766739653337, 6849.0237856547765, -143.55042333233501, 642.0553156708424, -897.112482933244, 4571.300745521253, -1304.331621349485, 1029.4165283999118, -1312.3658755770778, 6575.679517670887, 1012.7999635376103, 3831.4432117470683, -126.12042845313287, -2806.1943491196116, -1639.8688843047485, -895.6182544258995, -2729.9349911650224, 1061.35838942858, -1087.3768967795042, 6941.196652735829, -852.1614692724149, -474.6614932609818, -2320.0874511599827, 6913.610555582855, -735.8523899328321, 4797.275099793919, -1407.590247840782, -219.26483347692607, 576.4423000040302, 6020.461304747613, -501.35964001154105, 3222.654898549139, -373.00314287640845, 4198.602154822589, -2082.539558320359, 4727.923634070595, -1128.8652174701401, 6809.130999548079, -2047.4884690878205, 4360.671476494342, -877.9225668634216, 3491.573149142918, -2025.071854235975, 3116.9609931628297, -912.2259965653858, 1588.6057318199894, -1652.7646220584925, 4051.0656588119477, -6121.952160945381, 5424.1975691641865, -1232.2710244711764, -1941.9830749487076, -3048.3417121386974, 4283.337047416001, -990.8495150773967, 3284.7304063118695, -2669.228771334728, 7755.089147685808, -1496.5397666455447, -117.16513038477085, -2011.5532437379024, 2892.2755480051346, -2615.9453011410196, 6343.566256691943, -308.70771511455735, -839.9967816083025, -1118.7223520664174, 4784.941906880652, -2655.885005496597, -1559.9374009012824, -3959.6246868990665, 5650.805952598343, -2281.430801589364, 1925.4916502580604, -1920.530438448482, 3518.3123262088393, -952.8837571684626, 2182.195932330036, -4338.976793344767, 1199.30273575083, -1665.8779022607798, -1977.5633454735914, -2724.0146141434584, 5530.819476371169, -2402.766125247632, 10461.158842582, -552.9146654080989, 5011.365009822133, -4442.736630460169, -3142.251674179686, -3040.8823992785383, 1246.3526750415172, -533.4655308675998, 2347.647734145456, -2417.095958008325, 3946.979304624402, -1565.383530209881, 1555.2506418278408, -2955.4686592761636, 696.7281641681317, -732.0830689427615, -83.72633856800005, 311.9549506127745, 1885.0004448802442, -1913.3359136203571, -2698.6290798635696, -2230.85947943589, -169.41344171295182, -1456.1434906775355, 3059.2257612742724, -1635.6751723427353, 594.4989136681738, -1287.9736024541128, -1574.1252677546925, -3560.5515310199767, -1706.1738344136254, -908.15505069792, 7427.0136022006645, -1884.8120272209032, -1768.039884851964, -564.7669527062238, 4807.607643337835, 611.299546475601, 4135.440971158109, 126.84616007798977, 832.9175170437093, -4778.828587877621, -246.73602777822373, -171.31444602673017, 5824.627940594128, 280.58395435291703, -495.44432930551477, -1134.9323700537957, 4804.850749430324, -1139.6068225815163, 1888.512814291631, -2465.54797776038, 4041.3108769741602, -1017.2642873120839, -2168.688185895203, -1909.3806224535354, -366.2984702436076, -994.8317834888079, 3741.0568335677303, -1478.836825287542, 890.6621834048217, -1448.544654396957, 381.6909024058905, -4237.421537839405, -1462.5467719652102, -1636.6306706277028, -704.2206895389772, -272.26113569117945, 6135.160775754583, -497.0217164253408, -1969.8266289001592, -2863.542279741155, 4929.947654097356, -0.4727378457611273, -2072.3219684652586, -3072.8389861142773, 5226.1316582888185, -968.6082423441449, 2847.9601082364716, -26.486675982154072, 8291.008387822612, -95.01727329345567, 5884.933768640849, -909.4187423989665, 6594.8771213471955, -1045.6583014852072], "policy_predator_policy_reward": [3116.0880433955317, 4229.623740244928, 9850.50599640353, 2423.8755307301726, 1010.0219233497357, 582.4024196745353, -386.8523328053061, -724.6307732521846, -547.5418573576453, 2573.8503901605354, 4132.848767431116, 2650.7197806906615, 5944.794147038659, 9336.085227637132, 4568.031731508195, 1094.7213486106184, 33816.31318680089, 3908.1624136392775, 10125.786806527369, 3856.188060962913, 5289.502570154169, 1617.0246439755638, 3450.248600070297, 1589.840521485602, 2538.8824356759596, 1078.5664340771104, -874.1775141024975, 2345.447770213517, -3361.8363508575508, -133.72787777691514, -418.1031191464939, -2180.969281085637, 1375.2418033283368, 613.4790992106391, -1312.868312085307, 2358.202382581388, 4520.540413439848, 3159.5969971162563, -3736.6244322600382, -2729.333271658586, 6290.333475779651, -503.36571130601664, 7353.600158293114, 3321.5889735967403, 3634.482313499753, 4202.318544830625, 5104.122611358947, 6598.312094492939, 327.8238672663936, -4372.812653176957, 2480.499692384007, 810.5687416225857, 10442.071628417665, 491.94410255696437, 7582.533999851835, 5585.9498088067, 7838.248792576669, -786.197502500404, 1302.9653238803685, -2933.613825096467, 1156.263376059476, -3883.0127159633234, 5916.533049510562, -1094.5823523195922, -1395.7273060395394, 903.170418842399, 7530.069255854771, -190.50491203916982, 6564.636410361551, -103.37885341465613, 863.3543270057614, 1096.1151429760926, -1719.7786549335663, -484.9563416638756, 2902.2287316416205, 1804.0471440446802, -582.4305673915431, 3092.064129159592, -4771.196852796876, 2656.8760703410985, 11690.080819649595, 4648.898364871073, -2930.4981051638047, 409.3654597782112, -1784.8745581747103, 1290.309746441191, -991.4355951420758, -683.9020314616334, 17622.109293486887, 2540.293143212545, 4615.644363161398, -1082.5839335145035, 11895.093212021788, -413.4301599052891, 8902.511213342868, 5957.45445060295, 3982.2318370257235, 6949.278726153712, 4696.397433074366, 6601.141577539733, 5553.5405247357785, 2448.3283412293017, -1283.457768165326, 1278.496556355745, 7925.672375697466, 1668.0841053453212, 1257.409306434425, 1147.3231067587674, 5370.410014563586, 1493.2483668757054, 6750.222980057511, 3846.592097454748, -3769.1377597953797, 641.0844086718447, 12044.025246964427, -2498.312256161433, -568.6283793619607, 0.0, 9669.318629439813, 6677.664913629056, 18813.387630362955, 1324.372509621736, 4002.7634016112206, 5691.408389363836, 18675.265894321103, -593.5649923918974, 662.0270932114475, 6147.426523403342, 19326.020979190056, 1481.4239552308943, 528.1139155768135, -756.3425276215881, 11974.665290783027, 2493.6974398229345, 6646.137443643276, 12305.211204057441, 3113.15223210551, -958.5751231405026, 13296.93875171712, 78.23347868506283, 21243.22331572545, 4344.694969189052, 19409.623501083508, 2551.265854440768, 15711.360339542054, 7134.9421057283025, -5956.9761377153545, 4821.360984935726, 24411.74860630058, 2073.7095683524703, -1413.6716107706316, -1489.5527626028766, 5195.949481434257, -291.9470572254784, 2404.645006223512, 3934.9462225263014, 8472.607033815111, 3695.1228722845453, 437.4545610272429, -1902.0345124034802, 5138.218642006028, 5581.996352178889, 7806.107606471652, 904.3577792538325, -207.45844908973072, 1479.1315760890084, -1495.5338263419005, -1528.5127633201776, 10611.430322209517, 10706.440962710523, 20458.96006758388, 904.2568844454947, 4239.116867881178, 2266.568889053995, 5207.147438568706, 4247.542458807972, 6776.630656069777, 3861.6470436735062, 6002.581531913389, 3303.664344249003, 31372.29505674123, 1609.42242367334, 9846.843934179677, -104.39264534791897, 1624.3241374071754, 4586.220707191584, 7508.67904663361, 1225.9303410548418, 7287.244082136423, 7365.00533067826, -2095.6246299070162, -658.4137246168344, -2791.95838708773, 4501.606285012003, 10974.956086137001, -352.11385237021057, -745.1282832649159, -4109.810244544749, 9715.532629752865, 332.2857046112489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.723279476138443, "mean_inference_ms": 1.567798397122206, "mean_action_processing_ms": 0.3073516121743903, "mean_env_wait_ms": 0.1400887224636578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005830526351928711, "StateBufferConnector_ms": 0.004104971885681152, "ViewRequirementAgentConnector_ms": 0.13612830638885498}, "num_episodes": 23, "episode_return_max": 33385.83395252258, "episode_return_min": -1.5987211554602254e-14, "episode_return_mean": 8487.33063480336, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.295028288558, "num_env_steps_trained_throughput_per_sec": 259.295028288558, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 13964.053, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13964.007, "sample_time_ms": 1114.065, "learn_time_ms": 12833.775, "learn_throughput": 311.678, "synch_weights_time_ms": 15.051}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "6751e_00000", "date": "2024-08-11_19-22-37", "timestamp": 1723418557, "time_this_iter_s": 15.502782106399536, "time_total_s": 924.1445081233978, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eac1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 924.1445081233978, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 66.13181818181818, "ram_util_percent": 82.71818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5423394696185828, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.900677551289714, "policy_loss": -0.003226740948397607, "vf_loss": 9.903884887190722, "vf_explained_var": -0.0051960321015151086, "kl": 0.006211533171859431, "entropy": 0.6963926906623538, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8053865531922648, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.497285943813425, "policy_loss": -0.008182828716327629, "vf_loss": 9.504656337556385, "vf_explained_var": 0.00018178552546829142, "kl": 0.008124487851441008, "entropy": 0.7961944285523954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 32005.235655184413, "episode_reward_min": -1.5987211554602254e-14, "episode_reward_mean": 8275.264800779738, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6121.952160945381, "predator_policy": -7018.744356661446}, "policy_reward_max": {"prey_policy": 10461.158842582, "predator_policy": 31372.29505674123}, "policy_reward_mean": {"prey_policy": 358.8120703673227, "predator_policy": 3778.820330022547}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7397.188063378943, 1122.521777289881, 9492.290547767565, 6229.1258984655005, 4211.247612739453, 11676.416198500989, 2044.0463975528644, 496.3194895856286, 17111.773896624694, 16558.168660611693, 7409.228756603368, 3888.4531635199696, 122.90241576888454, 6938.013293693187, 3106.5015294033133, 12101.206874275853, 9944.006466577805, 3425.9707648887957, 0.0, 4642.116985447797, 438.74705963463697, 2077.605762237234, 11348.65439743326, 771.3548869530047, 120.93682324362175, 4583.211754436544, 18033.684062576784, 3809.3906765110073, 17516.52159369395, 12901.24653027112, 13060.567464563494, 5777.976922813744, 11371.244016974048, 0.0, 12159.185050083182, 247.9515521784663, 6397.083214929342, 5895.237117895222, 0.0, 19453.957167976834, 0.0, 10163.849469610674, 20850.647284158633, 9624.72356711219, 20463.29667634374, 5409.235599166466, 20772.09002964631, 0.0, 14440.027261865853, 14021.860088401254, 529.0201765745217, 14798.722819333723, 24894.443596128556, 16826.212556749593, 20231.97356015877, 4406.586422200146, 24152.651337094845, 2515.6828164399285, 9166.28955544492, 2393.680157915908, 11749.67943229469, 4640.6319435708265, 9089.838294825593, 12375.709312574289, 694.6379635305302, -1.5987211554602254e-14, 17239.802476571323, 20002.086698296964, 8767.90576521537, 8896.80742638455, 6782.547064309766, 6207.06843356948, 32005.235655184413, 15380.590348160995, 1377.1759359574417, 13664.08430394007, 9507.088458235132, 1503.485061420822, 4531.121330178592, 18818.833348295873, 120.57649843221955, 15597.037154226144, 6829.216421035561, 3652.593659694967, 6185.607693369129, 12491.210940696865, 6093.639888119848, 8434.982887375014, 2126.4745803806004, 411.8323567047151, 19917.787141172324, 559.9108843956942, 2223.610741421307, 6031.9913441279, 2089.6011722258727, 0.0, 4102.587984448445, 6098.94319224288, 2990.2278172279584, 8791.27064671204], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1029.4165283999118, -1312.3658755770778, 6575.679517670887, 1012.7999635376103, 3831.4432117470683, -126.12042845313287, -2806.1943491196116, -1639.8688843047485, -895.6182544258995, -2729.9349911650224, 1061.35838942858, -1087.3768967795042, 6941.196652735829, -852.1614692724149, -474.6614932609818, -2320.0874511599827, 6913.610555582855, -735.8523899328321, 4797.275099793919, -1407.590247840782, -219.26483347692607, 576.4423000040302, 6020.461304747613, -501.35964001154105, 3222.654898549139, -373.00314287640845, 4198.602154822589, -2082.539558320359, 4727.923634070595, -1128.8652174701401, 6809.130999548079, -2047.4884690878205, 4360.671476494342, -877.9225668634216, 3491.573149142918, -2025.071854235975, 3116.9609931628297, -912.2259965653858, 1588.6057318199894, -1652.7646220584925, 4051.0656588119477, -6121.952160945381, 5424.1975691641865, -1232.2710244711764, -1941.9830749487076, -3048.3417121386974, 4283.337047416001, -990.8495150773967, 3284.7304063118695, -2669.228771334728, 7755.089147685808, -1496.5397666455447, -117.16513038477085, -2011.5532437379024, 2892.2755480051346, -2615.9453011410196, 6343.566256691943, -308.70771511455735, -839.9967816083025, -1118.7223520664174, 4784.941906880652, -2655.885005496597, -1559.9374009012824, -3959.6246868990665, 5650.805952598343, -2281.430801589364, 1925.4916502580604, -1920.530438448482, 3518.3123262088393, -952.8837571684626, 2182.195932330036, -4338.976793344767, 1199.30273575083, -1665.8779022607798, -1977.5633454735914, -2724.0146141434584, 5530.819476371169, -2402.766125247632, 10461.158842582, -552.9146654080989, 5011.365009822133, -4442.736630460169, -3142.251674179686, -3040.8823992785383, 1246.3526750415172, -533.4655308675998, 2347.647734145456, -2417.095958008325, 3946.979304624402, -1565.383530209881, 1555.2506418278408, -2955.4686592761636, 696.7281641681317, -732.0830689427615, -83.72633856800005, 311.9549506127745, 1885.0004448802442, -1913.3359136203571, -2698.6290798635696, -2230.85947943589, -169.41344171295182, -1456.1434906775355, 3059.2257612742724, -1635.6751723427353, 594.4989136681738, -1287.9736024541128, -1574.1252677546925, -3560.5515310199767, -1706.1738344136254, -908.15505069792, 7427.0136022006645, -1884.8120272209032, -1768.039884851964, -564.7669527062238, 4807.607643337835, 611.299546475601, 4135.440971158109, 126.84616007798977, 832.9175170437093, -4778.828587877621, -246.73602777822373, -171.31444602673017, 5824.627940594128, 280.58395435291703, -495.44432930551477, -1134.9323700537957, 4804.850749430324, -1139.6068225815163, 1888.512814291631, -2465.54797776038, 4041.3108769741602, -1017.2642873120839, -2168.688185895203, -1909.3806224535354, -366.2984702436076, -994.8317834888079, 3741.0568335677303, -1478.836825287542, 890.6621834048217, -1448.544654396957, 381.6909024058905, -4237.421537839405, -1462.5467719652102, -1636.6306706277028, -704.2206895389772, -272.26113569117945, 6135.160775754583, -497.0217164253408, -1969.8266289001592, -2863.542279741155, 4929.947654097356, -0.4727378457611273, -2072.3219684652586, -3072.8389861142773, 5226.1316582888185, -968.6082423441449, 2847.9601082364716, -26.486675982154072, 8291.008387822612, -95.01727329345567, 5884.933768640849, -909.4187423989665, 6594.8771213471955, -1045.6583014852072, 2935.8020675154808, -2194.95865743192, -1724.5662587033703, 708.7842355999913, -4004.9258294721767, -4673.750029087272, 2508.64134062879, -3412.6023110504475, 2800.839809419967, -1928.4938524741362, 8054.233977407191, -1394.3084555624398, 4223.215109016802, -4027.850606245963, 2613.735575215807, -3013.4040967751403, 1481.2624938296156, -736.1823975504532, 2551.4794373831814, -5005.554148419101, -861.7254873934914, -2680.6340283161007, -224.08372320343315, -3671.663757179078, 380.7685900621273, -2660.086419227126, 7437.711151884987, 130.61959573613908, 1004.9324428677559, -3657.977298466109, 3445.9464903506923, -1198.6968633947868, 6004.528130578616, -4572.003949659307, 3517.31956823181, -2680.1805746084174], "policy_predator_policy_reward": [4520.540413439848, 3159.5969971162563, -3736.6244322600382, -2729.333271658586, 6290.333475779651, -503.36571130601664, 7353.600158293114, 3321.5889735967403, 3634.482313499753, 4202.318544830625, 5104.122611358947, 6598.312094492939, 327.8238672663936, -4372.812653176957, 2480.499692384007, 810.5687416225857, 10442.071628417665, 491.94410255696437, 7582.533999851835, 5585.9498088067, 7838.248792576669, -786.197502500404, 1302.9653238803685, -2933.613825096467, 1156.263376059476, -3883.0127159633234, 5916.533049510562, -1094.5823523195922, -1395.7273060395394, 903.170418842399, 7530.069255854771, -190.50491203916982, 6564.636410361551, -103.37885341465613, 863.3543270057614, 1096.1151429760926, -1719.7786549335663, -484.9563416638756, 2902.2287316416205, 1804.0471440446802, -582.4305673915431, 3092.064129159592, -4771.196852796876, 2656.8760703410985, 11690.080819649595, 4648.898364871073, -2930.4981051638047, 409.3654597782112, -1784.8745581747103, 1290.309746441191, -991.4355951420758, -683.9020314616334, 17622.109293486887, 2540.293143212545, 4615.644363161398, -1082.5839335145035, 11895.093212021788, -413.4301599052891, 8902.511213342868, 5957.45445060295, 3982.2318370257235, 6949.278726153712, 4696.397433074366, 6601.141577539733, 5553.5405247357785, 2448.3283412293017, -1283.457768165326, 1278.496556355745, 7925.672375697466, 1668.0841053453212, 1257.409306434425, 1147.3231067587674, 5370.410014563586, 1493.2483668757054, 6750.222980057511, 3846.592097454748, -3769.1377597953797, 641.0844086718447, 12044.025246964427, -2498.312256161433, -568.6283793619607, 0.0, 9669.318629439813, 6677.664913629056, 18813.387630362955, 1324.372509621736, 4002.7634016112206, 5691.408389363836, 18675.265894321103, -593.5649923918974, 662.0270932114475, 6147.426523403342, 19326.020979190056, 1481.4239552308943, 528.1139155768135, -756.3425276215881, 11974.665290783027, 2493.6974398229345, 6646.137443643276, 12305.211204057441, 3113.15223210551, -958.5751231405026, 13296.93875171712, 78.23347868506283, 21243.22331572545, 4344.694969189052, 19409.623501083508, 2551.265854440768, 15711.360339542054, 7134.9421057283025, -5956.9761377153545, 4821.360984935726, 24411.74860630058, 2073.7095683524703, -1413.6716107706316, -1489.5527626028766, 5195.949481434257, -291.9470572254784, 2404.645006223512, 3934.9462225263014, 8472.607033815111, 3695.1228722845453, 437.4545610272429, -1902.0345124034802, 5138.218642006028, 5581.996352178889, 7806.107606471652, 904.3577792538325, -207.45844908973072, 1479.1315760890084, -1495.5338263419005, -1528.5127633201776, 10611.430322209517, 10706.440962710523, 20458.96006758388, 904.2568844454947, 4239.116867881178, 2266.568889053995, 5207.147438568706, 4247.542458807972, 6776.630656069777, 3861.6470436735062, 6002.581531913389, 3303.664344249003, 31372.29505674123, 1609.42242367334, 9846.843934179677, -104.39264534791897, 1624.3241374071754, 4586.220707191584, 7508.67904663361, 1225.9303410548418, 7287.244082136423, 7365.00533067826, -2095.6246299070162, -658.4137246168344, -2791.95838708773, 4501.606285012003, 10974.956086137001, -352.11385237021057, -745.1282832649159, -4109.810244544749, 9715.532629752865, 332.2857046112489, 4772.844358052942, 1315.5286528990396, 3325.5053616820423, 1342.87032111631, 7767.796457350867, 7096.487094577708, 12208.114703040977, 1187.0572080775376, 1193.5105343132623, 4027.783396860754, 7205.466809769473, -5430.4094442392125, 46.315413548217926, 1884.7946640615478, 1283.2981398538175, -471.7972615897671, 17662.26057896843, 1510.4464659248088, 272.3173756006041, 2741.668219831011, 2554.1767349899287, 3211.7935221409675, 4162.551865695798, 5765.186958814614, 2419.9371822728235, 1948.9818191180461, -549.586390959676, -7018.744356661446, 5171.073656238379, 1584.5591838084154, 3253.2062115013077, 598.4873537856745, 2315.9970604675173, -758.2934241588596, 5822.385012517553, 2131.7466405710943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.722004657128456, "mean_inference_ms": 1.5626912238995263, "mean_action_processing_ms": 0.30755487068773607, "mean_env_wait_ms": 0.13968035094492703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004909634590148926, "StateBufferConnector_ms": 0.0036284923553466797, "ViewRequirementAgentConnector_ms": 0.11094629764556885}, "num_episodes": 18, "episode_return_max": 32005.235655184413, "episode_return_min": -1.5987211554602254e-14, "episode_return_mean": 8275.264800779738, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.70868583826, "num_env_steps_trained_throughput_per_sec": 281.70868583826, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 14064.281, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14064.237, "sample_time_ms": 1120.251, "learn_time_ms": 12928.151, "learn_throughput": 309.402, "synch_weights_time_ms": 14.923}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "6751e_00000", "date": "2024-08-11_19-22-52", "timestamp": 1723418572, "time_this_iter_s": 14.221190929412842, "time_total_s": 938.3656990528107, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eac1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 938.3656990528107, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 54.814285714285724, "ram_util_percent": 83.1904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5246628159331896, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.88919447691983, "policy_loss": -0.005077931652167102, "vf_loss": 9.894245996424761, "vf_explained_var": -0.0015957051484042375, "kl": 0.00845010096796334, "entropy": 0.6977584847066768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7328336868967329, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.580182454447266, "policy_loss": -0.005863426499334829, "vf_loss": 9.585274688781254, "vf_explained_var": 8.156649650089324e-05, "kl": 0.007711995063065359, "entropy": 0.7391102053816356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 32005.235655184413, "episode_reward_min": -1.5987211554602254e-14, "episode_reward_mean": 7601.966553188699, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6160.393408826019, "predator_policy": -7018.744356661446}, "policy_reward_max": {"prey_policy": 10461.158842582, "predator_policy": 31372.29505674123}, "policy_reward_mean": {"prey_policy": 160.66017716546307, "predator_policy": 3640.323099428887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 4642.116985447797, 438.74705963463697, 2077.605762237234, 11348.65439743326, 771.3548869530047, 120.93682324362175, 4583.211754436544, 18033.684062576784, 3809.3906765110073, 17516.52159369395, 12901.24653027112, 13060.567464563494, 5777.976922813744, 11371.244016974048, 0.0, 12159.185050083182, 247.9515521784663, 6397.083214929342, 5895.237117895222, 0.0, 19453.957167976834, 0.0, 10163.849469610674, 20850.647284158633, 9624.72356711219, 20463.29667634374, 5409.235599166466, 20772.09002964631, 0.0, 14440.027261865853, 14021.860088401254, 529.0201765745217, 14798.722819333723, 24894.443596128556, 16826.212556749593, 20231.97356015877, 4406.586422200146, 24152.651337094845, 2515.6828164399285, 9166.28955544492, 2393.680157915908, 11749.67943229469, 4640.6319435708265, 9089.838294825593, 12375.709312574289, 694.6379635305302, -1.5987211554602254e-14, 17239.802476571323, 20002.086698296964, 8767.90576521537, 8896.80742638455, 6782.547064309766, 6207.06843356948, 32005.235655184413, 15380.590348160995, 1377.1759359574417, 13664.08430394007, 9507.088458235132, 1503.485061420822, 4531.121330178592, 18818.833348295873, 120.57649843221955, 15597.037154226144, 6829.216421035561, 3652.593659694967, 6185.607693369129, 12491.210940696865, 6093.639888119848, 8434.982887375014, 2126.4745803806004, 411.8323567047151, 19917.787141172324, 559.9108843956942, 2223.610741421307, 6031.9913441279, 2089.6011722258727, 0.0, 4102.587984448445, 6098.94319224288, 2990.2278172279584, 8791.27064671204, 9390.121401768693, 2117.9830569618, 5942.896724736376, 105.88170156535574, 855.5866405301763, 1845.051644831131, 840.8063841740783, 128.94625421951827, 1990.872478655417, 10735.43792061482, 825.0042002344301, 4319.382622516594, 1802.7639671874629, 4824.471871389543, 799.8207872590162, 1229.2177247837437, 577.0457703203908, 7614.265896395962], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3116.9609931628297, -912.2259965653858, 1588.6057318199894, -1652.7646220584925, 4051.0656588119477, -6121.952160945381, 5424.1975691641865, -1232.2710244711764, -1941.9830749487076, -3048.3417121386974, 4283.337047416001, -990.8495150773967, 3284.7304063118695, -2669.228771334728, 7755.089147685808, -1496.5397666455447, -117.16513038477085, -2011.5532437379024, 2892.2755480051346, -2615.9453011410196, 6343.566256691943, -308.70771511455735, -839.9967816083025, -1118.7223520664174, 4784.941906880652, -2655.885005496597, -1559.9374009012824, -3959.6246868990665, 5650.805952598343, -2281.430801589364, 1925.4916502580604, -1920.530438448482, 3518.3123262088393, -952.8837571684626, 2182.195932330036, -4338.976793344767, 1199.30273575083, -1665.8779022607798, -1977.5633454735914, -2724.0146141434584, 5530.819476371169, -2402.766125247632, 10461.158842582, -552.9146654080989, 5011.365009822133, -4442.736630460169, -3142.251674179686, -3040.8823992785383, 1246.3526750415172, -533.4655308675998, 2347.647734145456, -2417.095958008325, 3946.979304624402, -1565.383530209881, 1555.2506418278408, -2955.4686592761636, 696.7281641681317, -732.0830689427615, -83.72633856800005, 311.9549506127745, 1885.0004448802442, -1913.3359136203571, -2698.6290798635696, -2230.85947943589, -169.41344171295182, -1456.1434906775355, 3059.2257612742724, -1635.6751723427353, 594.4989136681738, -1287.9736024541128, -1574.1252677546925, -3560.5515310199767, -1706.1738344136254, -908.15505069792, 7427.0136022006645, -1884.8120272209032, -1768.039884851964, -564.7669527062238, 4807.607643337835, 611.299546475601, 4135.440971158109, 126.84616007798977, 832.9175170437093, -4778.828587877621, -246.73602777822373, -171.31444602673017, 5824.627940594128, 280.58395435291703, -495.44432930551477, -1134.9323700537957, 4804.850749430324, -1139.6068225815163, 1888.512814291631, -2465.54797776038, 4041.3108769741602, -1017.2642873120839, -2168.688185895203, -1909.3806224535354, -366.2984702436076, -994.8317834888079, 3741.0568335677303, -1478.836825287542, 890.6621834048217, -1448.544654396957, 381.6909024058905, -4237.421537839405, -1462.5467719652102, -1636.6306706277028, -704.2206895389772, -272.26113569117945, 6135.160775754583, -497.0217164253408, -1969.8266289001592, -2863.542279741155, 4929.947654097356, -0.4727378457611273, -2072.3219684652586, -3072.8389861142773, 5226.1316582888185, -968.6082423441449, 2847.9601082364716, -26.486675982154072, 8291.008387822612, -95.01727329345567, 5884.933768640849, -909.4187423989665, 6594.8771213471955, -1045.6583014852072, 2935.8020675154808, -2194.95865743192, -1724.5662587033703, 708.7842355999913, -4004.9258294721767, -4673.750029087272, 2508.64134062879, -3412.6023110504475, 2800.839809419967, -1928.4938524741362, 8054.233977407191, -1394.3084555624398, 4223.215109016802, -4027.850606245963, 2613.735575215807, -3013.4040967751403, 1481.2624938296156, -736.1823975504532, 2551.4794373831814, -5005.554148419101, -861.7254873934914, -2680.6340283161007, -224.08372320343315, -3671.663757179078, 380.7685900621273, -2660.086419227126, 7437.711151884987, 130.61959573613908, 1004.9324428677559, -3657.977298466109, 3445.9464903506923, -1198.6968633947868, 6004.528130578616, -4572.003949659307, 3517.31956823181, -2680.1805746084174, -226.76746871347805, -1925.587052368195, 2868.166173199314, -1826.3928786887807, -2608.442077604626, -3296.5408874531054, 1468.2375795524006, -752.0011067047366, 1698.9353067017094, -2230.3985017626783, 2988.5256579148604, -2259.250433005287, -1409.0114390463953, -1144.0353817433352, 3934.1405848075915, -2754.928475329134, 9745.196626900468, 2096.924749604749, 1930.1968155684663, -1733.2066046820228, 5232.469811088741, -5636.191009247843, 5961.2896895455115, -4298.501306275675, 3959.604085486493, -6160.393408826019, 3139.769037184311, -2386.9978950320133, -378.14854224633405, -855.0569680144704, 359.26382870014584, -3461.177216221562, 3717.7379086964984, -2735.872996046982, 1396.1959505056327, -2121.238974174748], "policy_predator_policy_reward": [-1719.7786549335663, -484.9563416638756, 2902.2287316416205, 1804.0471440446802, -582.4305673915431, 3092.064129159592, -4771.196852796876, 2656.8760703410985, 11690.080819649595, 4648.898364871073, -2930.4981051638047, 409.3654597782112, -1784.8745581747103, 1290.309746441191, -991.4355951420758, -683.9020314616334, 17622.109293486887, 2540.293143212545, 4615.644363161398, -1082.5839335145035, 11895.093212021788, -413.4301599052891, 8902.511213342868, 5957.45445060295, 3982.2318370257235, 6949.278726153712, 4696.397433074366, 6601.141577539733, 5553.5405247357785, 2448.3283412293017, -1283.457768165326, 1278.496556355745, 7925.672375697466, 1668.0841053453212, 1257.409306434425, 1147.3231067587674, 5370.410014563586, 1493.2483668757054, 6750.222980057511, 3846.592097454748, -3769.1377597953797, 641.0844086718447, 12044.025246964427, -2498.312256161433, -568.6283793619607, 0.0, 9669.318629439813, 6677.664913629056, 18813.387630362955, 1324.372509621736, 4002.7634016112206, 5691.408389363836, 18675.265894321103, -593.5649923918974, 662.0270932114475, 6147.426523403342, 19326.020979190056, 1481.4239552308943, 528.1139155768135, -756.3425276215881, 11974.665290783027, 2493.6974398229345, 6646.137443643276, 12305.211204057441, 3113.15223210551, -958.5751231405026, 13296.93875171712, 78.23347868506283, 21243.22331572545, 4344.694969189052, 19409.623501083508, 2551.265854440768, 15711.360339542054, 7134.9421057283025, -5956.9761377153545, 4821.360984935726, 24411.74860630058, 2073.7095683524703, -1413.6716107706316, -1489.5527626028766, 5195.949481434257, -291.9470572254784, 2404.645006223512, 3934.9462225263014, 8472.607033815111, 3695.1228722845453, 437.4545610272429, -1902.0345124034802, 5138.218642006028, 5581.996352178889, 7806.107606471652, 904.3577792538325, -207.45844908973072, 1479.1315760890084, -1495.5338263419005, -1528.5127633201776, 10611.430322209517, 10706.440962710523, 20458.96006758388, 904.2568844454947, 4239.116867881178, 2266.568889053995, 5207.147438568706, 4247.542458807972, 6776.630656069777, 3861.6470436735062, 6002.581531913389, 3303.664344249003, 31372.29505674123, 1609.42242367334, 9846.843934179677, -104.39264534791897, 1624.3241374071754, 4586.220707191584, 7508.67904663361, 1225.9303410548418, 7287.244082136423, 7365.00533067826, -2095.6246299070162, -658.4137246168344, -2791.95838708773, 4501.606285012003, 10974.956086137001, -352.11385237021057, -745.1282832649159, -4109.810244544749, 9715.532629752865, 332.2857046112489, 4772.844358052942, 1315.5286528990396, 3325.5053616820423, 1342.87032111631, 7767.796457350867, 7096.487094577708, 12208.114703040977, 1187.0572080775376, 1193.5105343132623, 4027.783396860754, 7205.466809769473, -5430.4094442392125, 46.315413548217926, 1884.7946640615478, 1283.2981398538175, -471.7972615897671, 17662.26057896843, 1510.4464659248088, 272.3173756006041, 2741.668219831011, 2554.1767349899287, 3211.7935221409675, 4162.551865695798, 5765.186958814614, 2419.9371822728235, 1948.9818191180461, -549.586390959676, -7018.744356661446, 5171.073656238379, 1584.5591838084154, 3253.2062115013077, 598.4873537856745, 2315.9970604675173, -758.2934241588596, 5822.385012517553, 2131.7466405710943, 6746.50274327711, 4795.973179573265, -864.0176481028229, 1940.2274105540757, 11243.441067946665, 604.4386218474481, -510.3037587882303, -100.05101249407667, 1891.873823125557, -504.82398753441396, 688.0730094034053, 427.7034105181548, 2518.8447238140843, 875.0084811497238, 499.2249298605785, -1549.4907851195164, -5230.971134816636, -4620.277763033181, 7888.455259351403, 2649.992450376986, 2125.1778062587878, -896.452407865253, 735.1249860836045, 1921.4692531631517, 3202.7394160100134, 800.8138745169757, 2874.788461717019, 1196.9122675202293, 1349.2066575660292, 683.8196399537892, 2820.1205092636983, 1511.0106030414627, -334.8253316890602, -69.99381064006567, 8360.49702345823, -21.188103393153625]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7205421868212304, "mean_inference_ms": 1.5589476339923563, "mean_action_processing_ms": 0.3068493851497014, "mean_env_wait_ms": 0.1393995564814972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004766106605529785, "StateBufferConnector_ms": 0.0035632848739624023, "ViewRequirementAgentConnector_ms": 0.1003943681716919}, "num_episodes": 18, "episode_return_max": 32005.235655184413, "episode_return_min": -1.5987211554602254e-14, "episode_return_mean": 7601.966553188699, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.211082393524, "num_env_steps_trained_throughput_per_sec": 280.211082393524, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 14089.142, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14089.098, "sample_time_ms": 1122.975, "learn_time_ms": 12949.962, "learn_throughput": 308.881, "synch_weights_time_ms": 15.086}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "6751e_00000", "date": "2024-08-11_19-23-06", "timestamp": 1723418586, "time_this_iter_s": 14.33215594291687, "time_total_s": 952.6978549957275, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1777b3310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.6978549957275, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 54.7, "ram_util_percent": 83.09}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6033549655051459, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.883255658326325, "policy_loss": -0.005954404439156254, "vf_loss": 9.889185679904998, "vf_explained_var": -0.0008843290112005971, "kl": 0.007802113303440044, "entropy": 0.7556191359562848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7003253229238369, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.465677646354393, "policy_loss": -0.005047062754867569, "vf_loss": 9.470061339524689, "vf_explained_var": 6.885720939232559e-05, "kl": 0.006633873886224042, "entropy": 0.7125836757125047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 32005.235655184413, "episode_reward_min": -1.5987211554602254e-14, "episode_reward_mean": 7579.772793483629, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7128.1623163413715, "predator_policy": -7018.744356661446}, "policy_reward_max": {"prey_policy": 9745.196626900468, "predator_policy": 31372.29505674123}, "policy_reward_mean": {"prey_policy": 3.6094424651607735, "predator_policy": 3786.2769542766537}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 10163.849469610674, 20850.647284158633, 9624.72356711219, 20463.29667634374, 5409.235599166466, 20772.09002964631, 0.0, 14440.027261865853, 14021.860088401254, 529.0201765745217, 14798.722819333723, 24894.443596128556, 16826.212556749593, 20231.97356015877, 4406.586422200146, 24152.651337094845, 2515.6828164399285, 9166.28955544492, 2393.680157915908, 11749.67943229469, 4640.6319435708265, 9089.838294825593, 12375.709312574289, 694.6379635305302, -1.5987211554602254e-14, 17239.802476571323, 20002.086698296964, 8767.90576521537, 8896.80742638455, 6782.547064309766, 6207.06843356948, 32005.235655184413, 15380.590348160995, 1377.1759359574417, 13664.08430394007, 9507.088458235132, 1503.485061420822, 4531.121330178592, 18818.833348295873, 120.57649843221955, 15597.037154226144, 6829.216421035561, 3652.593659694967, 6185.607693369129, 12491.210940696865, 6093.639888119848, 8434.982887375014, 2126.4745803806004, 411.8323567047151, 19917.787141172324, 559.9108843956942, 2223.610741421307, 6031.9913441279, 2089.6011722258727, 0.0, 4102.587984448445, 6098.94319224288, 2990.2278172279584, 8791.27064671204, 9390.121401768693, 2117.9830569618, 5942.896724736376, 105.88170156535574, 855.5866405301763, 1845.051644831131, 840.8063841740783, 128.94625421951827, 1990.872478655417, 10735.43792061482, 825.0042002344301, 4319.382622516594, 1802.7639671874629, 4824.471871389543, 799.8207872590162, 1229.2177247837437, 577.0457703203908, 7614.265896395962, 14205.563424671724, 5184.781820799037, 14788.36213051093, 1352.2984024304342, 1.1546319456101628e-14, 112.72057534376152, 12018.887869848093, 6348.1899054514, 20684.702697690464, 7750.49069518483, 3301.1137496472143, 4159.256232409962, 3291.8742495505785, 7875.794446751632, 9452.104733325872, 8614.04419489973, 4410.623576844503, 1651.2999120568456, 2193.4921769150815, 15908.606774449097, -1.4210854715202004e-14, 5083.089500565024], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5011.365009822133, -4442.736630460169, -3142.251674179686, -3040.8823992785383, 1246.3526750415172, -533.4655308675998, 2347.647734145456, -2417.095958008325, 3946.979304624402, -1565.383530209881, 1555.2506418278408, -2955.4686592761636, 696.7281641681317, -732.0830689427615, -83.72633856800005, 311.9549506127745, 1885.0004448802442, -1913.3359136203571, -2698.6290798635696, -2230.85947943589, -169.41344171295182, -1456.1434906775355, 3059.2257612742724, -1635.6751723427353, 594.4989136681738, -1287.9736024541128, -1574.1252677546925, -3560.5515310199767, -1706.1738344136254, -908.15505069792, 7427.0136022006645, -1884.8120272209032, -1768.039884851964, -564.7669527062238, 4807.607643337835, 611.299546475601, 4135.440971158109, 126.84616007798977, 832.9175170437093, -4778.828587877621, -246.73602777822373, -171.31444602673017, 5824.627940594128, 280.58395435291703, -495.44432930551477, -1134.9323700537957, 4804.850749430324, -1139.6068225815163, 1888.512814291631, -2465.54797776038, 4041.3108769741602, -1017.2642873120839, -2168.688185895203, -1909.3806224535354, -366.2984702436076, -994.8317834888079, 3741.0568335677303, -1478.836825287542, 890.6621834048217, -1448.544654396957, 381.6909024058905, -4237.421537839405, -1462.5467719652102, -1636.6306706277028, -704.2206895389772, -272.26113569117945, 6135.160775754583, -497.0217164253408, -1969.8266289001592, -2863.542279741155, 4929.947654097356, -0.4727378457611273, -2072.3219684652586, -3072.8389861142773, 5226.1316582888185, -968.6082423441449, 2847.9601082364716, -26.486675982154072, 8291.008387822612, -95.01727329345567, 5884.933768640849, -909.4187423989665, 6594.8771213471955, -1045.6583014852072, 2935.8020675154808, -2194.95865743192, -1724.5662587033703, 708.7842355999913, -4004.9258294721767, -4673.750029087272, 2508.64134062879, -3412.6023110504475, 2800.839809419967, -1928.4938524741362, 8054.233977407191, -1394.3084555624398, 4223.215109016802, -4027.850606245963, 2613.735575215807, -3013.4040967751403, 1481.2624938296156, -736.1823975504532, 2551.4794373831814, -5005.554148419101, -861.7254873934914, -2680.6340283161007, -224.08372320343315, -3671.663757179078, 380.7685900621273, -2660.086419227126, 7437.711151884987, 130.61959573613908, 1004.9324428677559, -3657.977298466109, 3445.9464903506923, -1198.6968633947868, 6004.528130578616, -4572.003949659307, 3517.31956823181, -2680.1805746084174, -226.76746871347805, -1925.587052368195, 2868.166173199314, -1826.3928786887807, -2608.442077604626, -3296.5408874531054, 1468.2375795524006, -752.0011067047366, 1698.9353067017094, -2230.3985017626783, 2988.5256579148604, -2259.250433005287, -1409.0114390463953, -1144.0353817433352, 3934.1405848075915, -2754.928475329134, 9745.196626900468, 2096.924749604749, 1930.1968155684663, -1733.2066046820228, 5232.469811088741, -5636.191009247843, 5961.2896895455115, -4298.501306275675, 3959.604085486493, -6160.393408826019, 3139.769037184311, -2386.9978950320133, -378.14854224633405, -855.0569680144704, 359.26382870014584, -3461.177216221562, 3717.7379086964984, -2735.872996046982, 1396.1959505056327, -2121.238974174748, -433.603658051364, 1137.0874893182747, 7566.097934070354, -3381.941087636179, 279.14307175456963, -2725.163618782482, 1203.630430488766, -2405.3017893474926, 3362.338887915612, 1432.6809779700563, 2553.7677579337774, -1042.6690243903076, 6717.82595113883, -1004.259859002355, -3736.792729647402, -3937.336934955213, -1479.2384384901645, -1471.3853047976986, 736.0660379094406, -1948.2719691275522, -946.0664400490601, -735.8279941274374, 1251.8269091941086, -2873.5947707369896, 3023.128871655991, -2879.1524311402345, 1354.6606263542985, -739.0465710464024, -205.60125051578245, -2138.921161636491, 5751.850611871785, -2851.500862017228, 3038.6471410785634, -4343.593249315028, -868.2156531280606, -4722.1864593660985, 4379.612632815375, -24.65245387633775, 6487.33269110701, -1211.8889127211964, 169.49791966503213, -7128.1623163413715, -2302.3115169773487, -4396.45194764944], "policy_predator_policy_reward": [-568.6283793619607, 0.0, 9669.318629439813, 6677.664913629056, 18813.387630362955, 1324.372509621736, 4002.7634016112206, 5691.408389363836, 18675.265894321103, -593.5649923918974, 662.0270932114475, 6147.426523403342, 19326.020979190056, 1481.4239552308943, 528.1139155768135, -756.3425276215881, 11974.665290783027, 2493.6974398229345, 6646.137443643276, 12305.211204057441, 3113.15223210551, -958.5751231405026, 13296.93875171712, 78.23347868506283, 21243.22331572545, 4344.694969189052, 19409.623501083508, 2551.265854440768, 15711.360339542054, 7134.9421057283025, -5956.9761377153545, 4821.360984935726, 24411.74860630058, 2073.7095683524703, -1413.6716107706316, -1489.5527626028766, 5195.949481434257, -291.9470572254784, 2404.645006223512, 3934.9462225263014, 8472.607033815111, 3695.1228722845453, 437.4545610272429, -1902.0345124034802, 5138.218642006028, 5581.996352178889, 7806.107606471652, 904.3577792538325, -207.45844908973072, 1479.1315760890084, -1495.5338263419005, -1528.5127633201776, 10611.430322209517, 10706.440962710523, 20458.96006758388, 904.2568844454947, 4239.116867881178, 2266.568889053995, 5207.147438568706, 4247.542458807972, 6776.630656069777, 3861.6470436735062, 6002.581531913389, 3303.664344249003, 31372.29505674123, 1609.42242367334, 9846.843934179677, -104.39264534791897, 1624.3241374071754, 4586.220707191584, 7508.67904663361, 1225.9303410548418, 7287.244082136423, 7365.00533067826, -2095.6246299070162, -658.4137246168344, -2791.95838708773, 4501.606285012003, 10974.956086137001, -352.11385237021057, -745.1282832649159, -4109.810244544749, 9715.532629752865, 332.2857046112489, 4772.844358052942, 1315.5286528990396, 3325.5053616820423, 1342.87032111631, 7767.796457350867, 7096.487094577708, 12208.114703040977, 1187.0572080775376, 1193.5105343132623, 4027.783396860754, 7205.466809769473, -5430.4094442392125, 46.315413548217926, 1884.7946640615478, 1283.2981398538175, -471.7972615897671, 17662.26057896843, 1510.4464659248088, 272.3173756006041, 2741.668219831011, 2554.1767349899287, 3211.7935221409675, 4162.551865695798, 5765.186958814614, 2419.9371822728235, 1948.9818191180461, -549.586390959676, -7018.744356661446, 5171.073656238379, 1584.5591838084154, 3253.2062115013077, 598.4873537856745, 2315.9970604675173, -758.2934241588596, 5822.385012517553, 2131.7466405710943, 6746.50274327711, 4795.973179573265, -864.0176481028229, 1940.2274105540757, 11243.441067946665, 604.4386218474481, -510.3037587882303, -100.05101249407667, 1891.873823125557, -504.82398753441396, 688.0730094034053, 427.7034105181548, 2518.8447238140843, 875.0084811497238, 499.2249298605785, -1549.4907851195164, -5230.971134816636, -4620.277763033181, 7888.455259351403, 2649.992450376986, 2125.1778062587878, -896.452407865253, 735.1249860836045, 1921.4692531631517, 3202.7394160100134, 800.8138745169757, 2874.788461717019, 1196.9122675202293, 1349.2066575660292, 683.8196399537892, 2820.1205092636983, 1511.0106030414627, -334.8253316890602, -69.99381064006567, 8360.49702345823, -21.188103393153625, 12038.020687121098, 1464.0589062836975, 5398.540564782271, -4397.915590417398, 16712.71208026044, 521.6705972783968, -31.52123285220847, 2585.4909941413725, -181.39685665401717, -4613.623009231648, 62.87277805542336, -1461.2509362551323, 4656.960109304259, 1648.3616684073338, 6442.642644553215, 7579.67692550079, 19608.046787346077, 4027.2796536322485, 8433.902652401202, 528.7939740017389, 2657.9377027981004, 2325.07048102561, 4230.302784986376, 1550.7213089664579, 2389.279906071256, 758.6179029635574, 6511.010276082725, 749.1701153610122, 5388.095024974323, 6408.532120503829, 5514.166349119929, 199.52809592522456, 1801.3082864296377, 3914.2613986513293, 3638.460980028235, 3603.2410445227715, 506.56427412309256, -2668.032276147044, 9606.112299112383, 1027.0506969508835, 4871.271462102592, 2087.3929345737474, 5654.277038139574, 6127.575927052214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.718917753704013, "mean_inference_ms": 1.5543304241447375, "mean_action_processing_ms": 0.306139335499695, "mean_env_wait_ms": 0.13882783885644126, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004544973373413086, "StateBufferConnector_ms": 0.0034630298614501953, "ViewRequirementAgentConnector_ms": 0.10145735740661621}, "num_episodes": 22, "episode_return_max": 32005.235655184413, "episode_return_min": -1.5987211554602254e-14, "episode_return_mean": 7579.772793483629, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.9521660264395, "num_env_steps_trained_throughput_per_sec": 289.9521660264395, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 14079.524, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14079.48, "sample_time_ms": 1113.301, "learn_time_ms": 12950.087, "learn_throughput": 308.878, "synch_weights_time_ms": 14.884}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "6751e_00000", "date": "2024-08-11_19-23-20", "timestamp": 1723418600, "time_this_iter_s": 13.84624719619751, "time_total_s": 966.544102191925, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eac1940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 966.544102191925, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 52.54736842105263, "ram_util_percent": 82.99473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49142707092736765, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.653231779229705, "policy_loss": -0.004456256116769972, "vf_loss": 9.657653612308401, "vf_explained_var": -0.0033401418615270546, "kl": 0.011016552653524664, "entropy": 0.6535235384784678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6478617913193173, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.377824346350614, "policy_loss": -0.004327424518424013, "vf_loss": 9.38134276425397, "vf_explained_var": 0.00020722828844867687, "kl": 0.008089654204360596, "entropy": 0.7820321641586445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 32005.235655184413, "episode_reward_min": -1.5987211554602254e-14, "episode_reward_mean": 6639.904576874655, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7128.1623163413715, "predator_policy": -7018.744356661446}, "policy_reward_max": {"prey_policy": 9745.196626900468, "predator_policy": 31372.29505674123}, "policy_reward_mean": {"prey_policy": 112.34692905749964, "predator_policy": 3207.6053593798274}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9166.28955544492, 2393.680157915908, 11749.67943229469, 4640.6319435708265, 9089.838294825593, 12375.709312574289, 694.6379635305302, -1.5987211554602254e-14, 17239.802476571323, 20002.086698296964, 8767.90576521537, 8896.80742638455, 6782.547064309766, 6207.06843356948, 32005.235655184413, 15380.590348160995, 1377.1759359574417, 13664.08430394007, 9507.088458235132, 1503.485061420822, 4531.121330178592, 18818.833348295873, 120.57649843221955, 15597.037154226144, 6829.216421035561, 3652.593659694967, 6185.607693369129, 12491.210940696865, 6093.639888119848, 8434.982887375014, 2126.4745803806004, 411.8323567047151, 19917.787141172324, 559.9108843956942, 2223.610741421307, 6031.9913441279, 2089.6011722258727, 0.0, 4102.587984448445, 6098.94319224288, 2990.2278172279584, 8791.27064671204, 9390.121401768693, 2117.9830569618, 5942.896724736376, 105.88170156535574, 855.5866405301763, 1845.051644831131, 840.8063841740783, 128.94625421951827, 1990.872478655417, 10735.43792061482, 825.0042002344301, 4319.382622516594, 1802.7639671874629, 4824.471871389543, 799.8207872590162, 1229.2177247837437, 577.0457703203908, 7614.265896395962, 14205.563424671724, 5184.781820799037, 14788.36213051093, 1352.2984024304342, 1.1546319456101628e-14, 112.72057534376152, 12018.887869848093, 6348.1899054514, 20684.702697690464, 7750.49069518483, 3301.1137496472143, 4159.256232409962, 3291.8742495505785, 7875.794446751632, 9452.104733325872, 8614.04419489973, 4410.623576844503, 1651.2999120568456, 2193.4921769150815, 15908.606774449097, -1.4210854715202004e-14, 5083.089500565024, 3539.8390300062347, 11649.785438677147, 4850.083079483387, 2733.373765850395, 8435.214668655244, 1682.9292566032786, 7055.9080005607475, 16429.337618450438, 1578.1359316586759, 11268.27080423556, 0.0, 28554.927292872995, 7172.13435974223, 664.8273794694311, 2370.832160852164, 11092.022711759972, 2335.55745453215, 8701.02264667763], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4135.440971158109, 126.84616007798977, 832.9175170437093, -4778.828587877621, -246.73602777822373, -171.31444602673017, 5824.627940594128, 280.58395435291703, -495.44432930551477, -1134.9323700537957, 4804.850749430324, -1139.6068225815163, 1888.512814291631, -2465.54797776038, 4041.3108769741602, -1017.2642873120839, -2168.688185895203, -1909.3806224535354, -366.2984702436076, -994.8317834888079, 3741.0568335677303, -1478.836825287542, 890.6621834048217, -1448.544654396957, 381.6909024058905, -4237.421537839405, -1462.5467719652102, -1636.6306706277028, -704.2206895389772, -272.26113569117945, 6135.160775754583, -497.0217164253408, -1969.8266289001592, -2863.542279741155, 4929.947654097356, -0.4727378457611273, -2072.3219684652586, -3072.8389861142773, 5226.1316582888185, -968.6082423441449, 2847.9601082364716, -26.486675982154072, 8291.008387822612, -95.01727329345567, 5884.933768640849, -909.4187423989665, 6594.8771213471955, -1045.6583014852072, 2935.8020675154808, -2194.95865743192, -1724.5662587033703, 708.7842355999913, -4004.9258294721767, -4673.750029087272, 2508.64134062879, -3412.6023110504475, 2800.839809419967, -1928.4938524741362, 8054.233977407191, -1394.3084555624398, 4223.215109016802, -4027.850606245963, 2613.735575215807, -3013.4040967751403, 1481.2624938296156, -736.1823975504532, 2551.4794373831814, -5005.554148419101, -861.7254873934914, -2680.6340283161007, -224.08372320343315, -3671.663757179078, 380.7685900621273, -2660.086419227126, 7437.711151884987, 130.61959573613908, 1004.9324428677559, -3657.977298466109, 3445.9464903506923, -1198.6968633947868, 6004.528130578616, -4572.003949659307, 3517.31956823181, -2680.1805746084174, -226.76746871347805, -1925.587052368195, 2868.166173199314, -1826.3928786887807, -2608.442077604626, -3296.5408874531054, 1468.2375795524006, -752.0011067047366, 1698.9353067017094, -2230.3985017626783, 2988.5256579148604, -2259.250433005287, -1409.0114390463953, -1144.0353817433352, 3934.1405848075915, -2754.928475329134, 9745.196626900468, 2096.924749604749, 1930.1968155684663, -1733.2066046820228, 5232.469811088741, -5636.191009247843, 5961.2896895455115, -4298.501306275675, 3959.604085486493, -6160.393408826019, 3139.769037184311, -2386.9978950320133, -378.14854224633405, -855.0569680144704, 359.26382870014584, -3461.177216221562, 3717.7379086964984, -2735.872996046982, 1396.1959505056327, -2121.238974174748, -433.603658051364, 1137.0874893182747, 7566.097934070354, -3381.941087636179, 279.14307175456963, -2725.163618782482, 1203.630430488766, -2405.3017893474926, 3362.338887915612, 1432.6809779700563, 2553.7677579337774, -1042.6690243903076, 6717.82595113883, -1004.259859002355, -3736.792729647402, -3937.336934955213, -1479.2384384901645, -1471.3853047976986, 736.0660379094406, -1948.2719691275522, -946.0664400490601, -735.8279941274374, 1251.8269091941086, -2873.5947707369896, 3023.128871655991, -2879.1524311402345, 1354.6606263542985, -739.0465710464024, -205.60125051578245, -2138.921161636491, 5751.850611871785, -2851.500862017228, 3038.6471410785634, -4343.593249315028, -868.2156531280606, -4722.1864593660985, 4379.612632815375, -24.65245387633775, 6487.33269110701, -1211.8889127211964, 169.49791966503213, -7128.1623163413715, -2302.3115169773487, -4396.45194764944, 804.3741350507731, -5722.465372067685, -859.2174443092212, -97.08541435623502, 6820.2837438287515, 185.6010790541275, 5529.368580645302, 2504.75134517713, 6942.3571852451505, -302.0335837527529, 4955.110114882482, -467.5865711017708, -492.61076098654485, -3563.1897611007844, -1960.5170436230333, -1155.1063202133562, 3194.504141446709, -2076.134524496453, 1296.3203701997568, -2982.909320228802, 6139.658964284429, -256.58785666427116, -1519.4931292453825, -1989.4250656446018, 1516.5023385930833, -2526.151337844154, 5713.929559766022, -3942.1038938302518, -3032.539695963953, -4457.335932309388, 3903.0338511576106, -1394.4796061645566, 1037.6336642250533, -1933.6380244826275, 3956.93373001389, -793.0789532012278], "policy_predator_policy_reward": [5195.949481434257, -291.9470572254784, 2404.645006223512, 3934.9462225263014, 8472.607033815111, 3695.1228722845453, 437.4545610272429, -1902.0345124034802, 5138.218642006028, 5581.996352178889, 7806.107606471652, 904.3577792538325, -207.45844908973072, 1479.1315760890084, -1495.5338263419005, -1528.5127633201776, 10611.430322209517, 10706.440962710523, 20458.96006758388, 904.2568844454947, 4239.116867881178, 2266.568889053995, 5207.147438568706, 4247.542458807972, 6776.630656069777, 3861.6470436735062, 6002.581531913389, 3303.664344249003, 31372.29505674123, 1609.42242367334, 9846.843934179677, -104.39264534791897, 1624.3241374071754, 4586.220707191584, 7508.67904663361, 1225.9303410548418, 7287.244082136423, 7365.00533067826, -2095.6246299070162, -658.4137246168344, -2791.95838708773, 4501.606285012003, 10974.956086137001, -352.11385237021057, -745.1282832649159, -4109.810244544749, 9715.532629752865, 332.2857046112489, 4772.844358052942, 1315.5286528990396, 3325.5053616820423, 1342.87032111631, 7767.796457350867, 7096.487094577708, 12208.114703040977, 1187.0572080775376, 1193.5105343132623, 4027.783396860754, 7205.466809769473, -5430.4094442392125, 46.315413548217926, 1884.7946640615478, 1283.2981398538175, -471.7972615897671, 17662.26057896843, 1510.4464659248088, 272.3173756006041, 2741.668219831011, 2554.1767349899287, 3211.7935221409675, 4162.551865695798, 5765.186958814614, 2419.9371822728235, 1948.9818191180461, -549.586390959676, -7018.744356661446, 5171.073656238379, 1584.5591838084154, 3253.2062115013077, 598.4873537856745, 2315.9970604675173, -758.2934241588596, 5822.385012517553, 2131.7466405710943, 6746.50274327711, 4795.973179573265, -864.0176481028229, 1940.2274105540757, 11243.441067946665, 604.4386218474481, -510.3037587882303, -100.05101249407667, 1891.873823125557, -504.82398753441396, 688.0730094034053, 427.7034105181548, 2518.8447238140843, 875.0084811497238, 499.2249298605785, -1549.4907851195164, -5230.971134816636, -4620.277763033181, 7888.455259351403, 2649.992450376986, 2125.1778062587878, -896.452407865253, 735.1249860836045, 1921.4692531631517, 3202.7394160100134, 800.8138745169757, 2874.788461717019, 1196.9122675202293, 1349.2066575660292, 683.8196399537892, 2820.1205092636983, 1511.0106030414627, -334.8253316890602, -69.99381064006567, 8360.49702345823, -21.188103393153625, 12038.020687121098, 1464.0589062836975, 5398.540564782271, -4397.915590417398, 16712.71208026044, 521.6705972783968, -31.52123285220847, 2585.4909941413725, -181.39685665401717, -4613.623009231648, 62.87277805542336, -1461.2509362551323, 4656.960109304259, 1648.3616684073338, 6442.642644553215, 7579.67692550079, 19608.046787346077, 4027.2796536322485, 8433.902652401202, 528.7939740017389, 2657.9377027981004, 2325.07048102561, 4230.302784986376, 1550.7213089664579, 2389.279906071256, 758.6179029635574, 6511.010276082725, 749.1701153610122, 5388.095024974323, 6408.532120503829, 5514.166349119929, 199.52809592522456, 1801.3082864296377, 3914.2613986513293, 3638.460980028235, 3603.2410445227715, 506.56427412309256, -2668.032276147044, 9606.112299112383, 1027.0506969508835, 4871.271462102592, 2087.3929345737474, 5654.277038139574, 6127.575927052214, 2705.71928260592, 5752.210984417227, 4632.350602366492, 7973.737694976137, 129.3003257456828, -2285.102069145153, -4502.896467358951, -797.8496926130668, 3821.766010173697, -2026.8749430108428, -3998.872164213232, 1194.2778770357945, 7309.887539507169, 3801.820983140901, 15018.334392028986, 4526.626590257836, -929.6880983083361, 1389.4544130167567, 7592.55932871108, 5362.300425553523, 0.0, -5883.071107620167, 28553.06994182706, 3510.775545935957, 5980.848980353406, 2200.934378639889, 444.6059478908311, -1551.6042343571726, 4280.932968936389, 5579.7748201891145, 7936.167624021133, 647.3008427457866, 67.28912987813474, 3164.2726849115907, 4657.532896000547, 879.6349738644415]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7179264377632626, "mean_inference_ms": 1.5517215967428932, "mean_action_processing_ms": 0.3055235952560875, "mean_env_wait_ms": 0.1388516748010721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040416717529296875, "StateBufferConnector_ms": 0.003320455551147461, "ViewRequirementAgentConnector_ms": 0.09962522983551025}, "num_episodes": 18, "episode_return_max": 32005.235655184413, "episode_return_min": -1.5987211554602254e-14, "episode_return_mean": 6639.904576874655, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.4186400030004, "num_env_steps_trained_throughput_per_sec": 282.4186400030004, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 14103.973, "restore_workers_time_ms": 0.013, "training_step_time_ms": 14103.929, "sample_time_ms": 1110.532, "learn_time_ms": 12977.604, "learn_throughput": 308.223, "synch_weights_time_ms": 14.562}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "6751e_00000", "date": "2024-08-11_19-23-34", "timestamp": 1723418614, "time_this_iter_s": 14.228129863739014, "time_total_s": 980.7722320556641, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaabee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 980.7722320556641, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 52.39, "ram_util_percent": 82.845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49060315671105864, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.838445192670065, "policy_loss": -0.006137108399222295, "vf_loss": 9.844558799582183, "vf_explained_var": -0.00023368174436861876, "kl": 0.0075157057638029, "entropy": 0.6251875214475803, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.862248168184013, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.4544165712185, "policy_loss": -0.011063305805092332, "vf_loss": 9.464398744371202, "vf_explained_var": -9.960216819924652e-05, "kl": 0.010811106956613158, "entropy": 0.7147779753599217, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 28554.927292872995, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 6153.714204334691, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7128.1623163413715, "predator_policy": -7018.744356661446}, "policy_reward_max": {"prey_policy": 9745.196626900468, "predator_policy": 28553.06994182706}, "policy_reward_mean": {"prey_policy": 184.25109340671372, "predator_policy": 2892.606008760631}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15597.037154226144, 6829.216421035561, 3652.593659694967, 6185.607693369129, 12491.210940696865, 6093.639888119848, 8434.982887375014, 2126.4745803806004, 411.8323567047151, 19917.787141172324, 559.9108843956942, 2223.610741421307, 6031.9913441279, 2089.6011722258727, 0.0, 4102.587984448445, 6098.94319224288, 2990.2278172279584, 8791.27064671204, 9390.121401768693, 2117.9830569618, 5942.896724736376, 105.88170156535574, 855.5866405301763, 1845.051644831131, 840.8063841740783, 128.94625421951827, 1990.872478655417, 10735.43792061482, 825.0042002344301, 4319.382622516594, 1802.7639671874629, 4824.471871389543, 799.8207872590162, 1229.2177247837437, 577.0457703203908, 7614.265896395962, 14205.563424671724, 5184.781820799037, 14788.36213051093, 1352.2984024304342, 1.1546319456101628e-14, 112.72057534376152, 12018.887869848093, 6348.1899054514, 20684.702697690464, 7750.49069518483, 3301.1137496472143, 4159.256232409962, 3291.8742495505785, 7875.794446751632, 9452.104733325872, 8614.04419489973, 4410.623576844503, 1651.2999120568456, 2193.4921769150815, 15908.606774449097, -1.4210854715202004e-14, 5083.089500565024, 3539.8390300062347, 11649.785438677147, 4850.083079483387, 2733.373765850395, 8435.214668655244, 1682.9292566032786, 7055.9080005607475, 16429.337618450438, 1578.1359316586759, 11268.27080423556, 0.0, 28554.927292872995, 7172.13435974223, 664.8273794694311, 2370.832160852164, 11092.022711759972, 2335.55745453215, 8701.02264667763, 224.35891190531163, 15420.419759168524, 15675.718305415538, 1559.1467345203525, 9011.935018039734, 7473.135246232855, 3737.6654289304875, 6331.46261040949, 9203.428642666697, 1578.9570010661055, 5141.370737012215, 25071.3434596783, 332.6542916512298, 12791.41596725236, 2355.9557985677648, 7926.859666911017, 0.0, 3674.8615075784064, 223.33790365702157, 13512.485723931479, 4897.553978171738, 9317.678158566956, 10834.093358979922], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6594.8771213471955, -1045.6583014852072, 2935.8020675154808, -2194.95865743192, -1724.5662587033703, 708.7842355999913, -4004.9258294721767, -4673.750029087272, 2508.64134062879, -3412.6023110504475, 2800.839809419967, -1928.4938524741362, 8054.233977407191, -1394.3084555624398, 4223.215109016802, -4027.850606245963, 2613.735575215807, -3013.4040967751403, 1481.2624938296156, -736.1823975504532, 2551.4794373831814, -5005.554148419101, -861.7254873934914, -2680.6340283161007, -224.08372320343315, -3671.663757179078, 380.7685900621273, -2660.086419227126, 7437.711151884987, 130.61959573613908, 1004.9324428677559, -3657.977298466109, 3445.9464903506923, -1198.6968633947868, 6004.528130578616, -4572.003949659307, 3517.31956823181, -2680.1805746084174, -226.76746871347805, -1925.587052368195, 2868.166173199314, -1826.3928786887807, -2608.442077604626, -3296.5408874531054, 1468.2375795524006, -752.0011067047366, 1698.9353067017094, -2230.3985017626783, 2988.5256579148604, -2259.250433005287, -1409.0114390463953, -1144.0353817433352, 3934.1405848075915, -2754.928475329134, 9745.196626900468, 2096.924749604749, 1930.1968155684663, -1733.2066046820228, 5232.469811088741, -5636.191009247843, 5961.2896895455115, -4298.501306275675, 3959.604085486493, -6160.393408826019, 3139.769037184311, -2386.9978950320133, -378.14854224633405, -855.0569680144704, 359.26382870014584, -3461.177216221562, 3717.7379086964984, -2735.872996046982, 1396.1959505056327, -2121.238974174748, -433.603658051364, 1137.0874893182747, 7566.097934070354, -3381.941087636179, 279.14307175456963, -2725.163618782482, 1203.630430488766, -2405.3017893474926, 3362.338887915612, 1432.6809779700563, 2553.7677579337774, -1042.6690243903076, 6717.82595113883, -1004.259859002355, -3736.792729647402, -3937.336934955213, -1479.2384384901645, -1471.3853047976986, 736.0660379094406, -1948.2719691275522, -946.0664400490601, -735.8279941274374, 1251.8269091941086, -2873.5947707369896, 3023.128871655991, -2879.1524311402345, 1354.6606263542985, -739.0465710464024, -205.60125051578245, -2138.921161636491, 5751.850611871785, -2851.500862017228, 3038.6471410785634, -4343.593249315028, -868.2156531280606, -4722.1864593660985, 4379.612632815375, -24.65245387633775, 6487.33269110701, -1211.8889127211964, 169.49791966503213, -7128.1623163413715, -2302.3115169773487, -4396.45194764944, 804.3741350507731, -5722.465372067685, -859.2174443092212, -97.08541435623502, 6820.2837438287515, 185.6010790541275, 5529.368580645302, 2504.75134517713, 6942.3571852451505, -302.0335837527529, 4955.110114882482, -467.5865711017708, -492.61076098654485, -3563.1897611007844, -1960.5170436230333, -1155.1063202133562, 3194.504141446709, -2076.134524496453, 1296.3203701997568, -2982.909320228802, 6139.658964284429, -256.58785666427116, -1519.4931292453825, -1989.4250656446018, 1516.5023385930833, -2526.151337844154, 5713.929559766022, -3942.1038938302518, -3032.539695963953, -4457.335932309388, 3903.0338511576106, -1394.4796061645566, 1037.6336642250533, -1933.6380244826275, 3956.93373001389, -793.0789532012278, -721.0764283792136, 1231.3413623856452, 1314.7963457712797, -66.86048023719918, 7133.930381349922, -447.63734441402676, 6494.972693865866, -1005.4632572876544, 4980.29276834797, -898.6335331866009, 2650.593117562602, 686.8307888865671, 4486.057469637414, -3942.148296468192, 2423.597244034234, -2671.2274117473467, 2430.34828083728, -4417.927761101455, -1770.9015849153066, -3503.28727414569, 5850.416739446961, -3412.286497152647, -764.5742149845179, -835.7369202063288, 5822.306029513332, -125.46183606552313, 4577.568668907729, -2088.644289194419, 5325.576867529431, -2092.221075157343, 1402.8180675794047, -456.9296552669998, 7293.234173679577, -5863.466085051123, 3674.448785599918, -44.0830693306623, 2589.051420235526, 162.31563548157584, -1041.1644050963794, -4572.529569634007, -883.8512992132592, -4719.0013764299265, 6208.53486816876, -1202.9296582992388, 5492.05821883308, -643.461926338782], "policy_predator_policy_reward": [9715.532629752865, 332.2857046112489, 4772.844358052942, 1315.5286528990396, 3325.5053616820423, 1342.87032111631, 7767.796457350867, 7096.487094577708, 12208.114703040977, 1187.0572080775376, 1193.5105343132623, 4027.783396860754, 7205.466809769473, -5430.4094442392125, 46.315413548217926, 1884.7946640615478, 1283.2981398538175, -471.7972615897671, 17662.26057896843, 1510.4464659248088, 272.3173756006041, 2741.668219831011, 2554.1767349899287, 3211.7935221409675, 4162.551865695798, 5765.186958814614, 2419.9371822728235, 1948.9818191180461, -549.586390959676, -7018.744356661446, 5171.073656238379, 1584.5591838084154, 3253.2062115013077, 598.4873537856745, 2315.9970604675173, -758.2934241588596, 5822.385012517553, 2131.7466405710943, 6746.50274327711, 4795.973179573265, -864.0176481028229, 1940.2274105540757, 11243.441067946665, 604.4386218474481, -510.3037587882303, -100.05101249407667, 1891.873823125557, -504.82398753441396, 688.0730094034053, 427.7034105181548, 2518.8447238140843, 875.0084811497238, 499.2249298605785, -1549.4907851195164, -5230.971134816636, -4620.277763033181, 7888.455259351403, 2649.992450376986, 2125.1778062587878, -896.452407865253, 735.1249860836045, 1921.4692531631517, 3202.7394160100134, 800.8138745169757, 2874.788461717019, 1196.9122675202293, 1349.2066575660292, 683.8196399537892, 2820.1205092636983, 1511.0106030414627, -334.8253316890602, -69.99381064006567, 8360.49702345823, -21.188103393153625, 12038.020687121098, 1464.0589062836975, 5398.540564782271, -4397.915590417398, 16712.71208026044, 521.6705972783968, -31.52123285220847, 2585.4909941413725, -181.39685665401717, -4613.623009231648, 62.87277805542336, -1461.2509362551323, 4656.960109304259, 1648.3616684073338, 6442.642644553215, 7579.67692550079, 19608.046787346077, 4027.2796536322485, 8433.902652401202, 528.7939740017389, 2657.9377027981004, 2325.07048102561, 4230.302784986376, 1550.7213089664579, 2389.279906071256, 758.6179029635574, 6511.010276082725, 749.1701153610122, 5388.095024974323, 6408.532120503829, 5514.166349119929, 199.52809592522456, 1801.3082864296377, 3914.2613986513293, 3638.460980028235, 3603.2410445227715, 506.56427412309256, -2668.032276147044, 9606.112299112383, 1027.0506969508835, 4871.271462102592, 2087.3929345737474, 5654.277038139574, 6127.575927052214, 2705.71928260592, 5752.210984417227, 4632.350602366492, 7973.737694976137, 129.3003257456828, -2285.102069145153, -4502.896467358951, -797.8496926130668, 3821.766010173697, -2026.8749430108428, -3998.872164213232, 1194.2778770357945, 7309.887539507169, 3801.820983140901, 15018.334392028986, 4526.626590257836, -929.6880983083361, 1389.4544130167567, 7592.55932871108, 5362.300425553523, 0.0, -5883.071107620167, 28553.06994182706, 3510.775545935957, 5980.848980353406, 2200.934378639889, 444.6059478908311, -1551.6042343571726, 4280.932968936389, 5579.7748201891145, 7936.167624021133, 647.3008427457866, 67.28912987813474, 3164.2726849115907, 4657.532896000547, 879.6349738644415, -1053.9829353330397, 768.0769132319225, 11270.608350670775, 2901.8755429636494, 10026.098622846193, -1036.6733543666055, -249.8844694947904, -3680.478232563064, 4807.757923526448, 122.51785935192092, 5477.644011853921, -1341.9326720702607, 1240.5244183507218, 1953.2318374105382, 1788.5719012210432, 4790.520876901568, 5705.88649714292, 5485.121625787949, 6436.981991860744, 416.163868266357, -2154.3406407372718, 4857.581135455181, 25434.9915361931, 1236.663058676064, -4265.9191176856275, -1098.2707841109523, 6421.202140684213, 3881.2894468548184, -1848.1532752812855, 970.7532814769615, 5713.888826606797, 1267.0824279918118, -1268.6842316979878, -161.08385693046537, 14.542915720281655, 29.952875588868693, -1258.069948603885, -1269.9592034561942, 14516.351821574577, 4609.827877087282, 9079.734115971098, 1420.6725378437973, 7740.183267709217, -3428.110319011887, 7746.114311851599, -1760.617245365964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7165609407107324, "mean_inference_ms": 1.54816782159749, "mean_action_processing_ms": 0.3048667893008268, "mean_env_wait_ms": 0.13851763371665687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00556790828704834, "StateBufferConnector_ms": 0.0038743019104003906, "ViewRequirementAgentConnector_ms": 0.11368942260742188}, "num_episodes": 23, "episode_return_max": 28554.927292872995, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 6153.714204334691, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.4326230031097, "num_env_steps_trained_throughput_per_sec": 279.4326230031097, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 14160.991, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14160.946, "sample_time_ms": 1112.88, "learn_time_ms": 13031.715, "learn_throughput": 306.943, "synch_weights_time_ms": 14.944}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "6751e_00000", "date": "2024-08-11_19-23-49", "timestamp": 1723418629, "time_this_iter_s": 14.359127044677734, "time_total_s": 995.1313591003418, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16e9cb1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 995.1313591003418, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 53.65714285714286, "ram_util_percent": 82.95238095238096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.494770248234272, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.851515109450729, "policy_loss": -0.007332578701307139, "vf_loss": 9.858801894717747, "vf_explained_var": -0.0026005873604426307, "kl": 0.014645224149914725, "entropy": 0.6589250405629475, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.808859284371926, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.4630371335953, "policy_loss": -0.007582277286842111, "vf_loss": 9.469469055801472, "vf_explained_var": 7.209642223580174e-05, "kl": 0.01150374190186713, "entropy": 0.7438586960078547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 28554.927292872995, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 6691.9263564681205, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7128.1623163413715, "predator_policy": -6845.459780106166}, "policy_reward_max": {"prey_policy": 9745.196626900468, "predator_policy": 28553.06994182706}, "policy_reward_mean": {"prey_policy": 188.83182505873535, "predator_policy": 3157.1313531753235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [8791.27064671204, 9390.121401768693, 2117.9830569618, 5942.896724736376, 105.88170156535574, 855.5866405301763, 1845.051644831131, 840.8063841740783, 128.94625421951827, 1990.872478655417, 10735.43792061482, 825.0042002344301, 4319.382622516594, 1802.7639671874629, 4824.471871389543, 799.8207872590162, 1229.2177247837437, 577.0457703203908, 7614.265896395962, 14205.563424671724, 5184.781820799037, 14788.36213051093, 1352.2984024304342, 1.1546319456101628e-14, 112.72057534376152, 12018.887869848093, 6348.1899054514, 20684.702697690464, 7750.49069518483, 3301.1137496472143, 4159.256232409962, 3291.8742495505785, 7875.794446751632, 9452.104733325872, 8614.04419489973, 4410.623576844503, 1651.2999120568456, 2193.4921769150815, 15908.606774449097, -1.4210854715202004e-14, 5083.089500565024, 3539.8390300062347, 11649.785438677147, 4850.083079483387, 2733.373765850395, 8435.214668655244, 1682.9292566032786, 7055.9080005607475, 16429.337618450438, 1578.1359316586759, 11268.27080423556, 0.0, 28554.927292872995, 7172.13435974223, 664.8273794694311, 2370.832160852164, 11092.022711759972, 2335.55745453215, 8701.02264667763, 224.35891190531163, 15420.419759168524, 15675.718305415538, 1559.1467345203525, 9011.935018039734, 7473.135246232855, 3737.6654289304875, 6331.46261040949, 9203.428642666697, 1578.9570010661055, 5141.370737012215, 25071.3434596783, 332.6542916512298, 12791.41596725236, 2355.9557985677648, 7926.859666911017, 0.0, 3674.8615075784064, 223.33790365702157, 13512.485723931479, 4897.553978171738, 9317.678158566956, 10834.093358979922, 6492.968361263639, 15547.067944845123, 14940.250617006877, 17207.54110318394, 12367.960965247627, 14142.804631155132, 3416.6755417260893, 7578.013115662643, 17920.17789747662, 5529.213739312042, 2800.170425637181, 2451.463747849115, 3705.5703058007766, 14051.031508536522, 3223.332168049351, 13074.386324088175, 4682.92947497608, 526.9132003912526], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3517.31956823181, -2680.1805746084174, -226.76746871347805, -1925.587052368195, 2868.166173199314, -1826.3928786887807, -2608.442077604626, -3296.5408874531054, 1468.2375795524006, -752.0011067047366, 1698.9353067017094, -2230.3985017626783, 2988.5256579148604, -2259.250433005287, -1409.0114390463953, -1144.0353817433352, 3934.1405848075915, -2754.928475329134, 9745.196626900468, 2096.924749604749, 1930.1968155684663, -1733.2066046820228, 5232.469811088741, -5636.191009247843, 5961.2896895455115, -4298.501306275675, 3959.604085486493, -6160.393408826019, 3139.769037184311, -2386.9978950320133, -378.14854224633405, -855.0569680144704, 359.26382870014584, -3461.177216221562, 3717.7379086964984, -2735.872996046982, 1396.1959505056327, -2121.238974174748, -433.603658051364, 1137.0874893182747, 7566.097934070354, -3381.941087636179, 279.14307175456963, -2725.163618782482, 1203.630430488766, -2405.3017893474926, 3362.338887915612, 1432.6809779700563, 2553.7677579337774, -1042.6690243903076, 6717.82595113883, -1004.259859002355, -3736.792729647402, -3937.336934955213, -1479.2384384901645, -1471.3853047976986, 736.0660379094406, -1948.2719691275522, -946.0664400490601, -735.8279941274374, 1251.8269091941086, -2873.5947707369896, 3023.128871655991, -2879.1524311402345, 1354.6606263542985, -739.0465710464024, -205.60125051578245, -2138.921161636491, 5751.850611871785, -2851.500862017228, 3038.6471410785634, -4343.593249315028, -868.2156531280606, -4722.1864593660985, 4379.612632815375, -24.65245387633775, 6487.33269110701, -1211.8889127211964, 169.49791966503213, -7128.1623163413715, -2302.3115169773487, -4396.45194764944, 804.3741350507731, -5722.465372067685, -859.2174443092212, -97.08541435623502, 6820.2837438287515, 185.6010790541275, 5529.368580645302, 2504.75134517713, 6942.3571852451505, -302.0335837527529, 4955.110114882482, -467.5865711017708, -492.61076098654485, -3563.1897611007844, -1960.5170436230333, -1155.1063202133562, 3194.504141446709, -2076.134524496453, 1296.3203701997568, -2982.909320228802, 6139.658964284429, -256.58785666427116, -1519.4931292453825, -1989.4250656446018, 1516.5023385930833, -2526.151337844154, 5713.929559766022, -3942.1038938302518, -3032.539695963953, -4457.335932309388, 3903.0338511576106, -1394.4796061645566, 1037.6336642250533, -1933.6380244826275, 3956.93373001389, -793.0789532012278, -721.0764283792136, 1231.3413623856452, 1314.7963457712797, -66.86048023719918, 7133.930381349922, -447.63734441402676, 6494.972693865866, -1005.4632572876544, 4980.29276834797, -898.6335331866009, 2650.593117562602, 686.8307888865671, 4486.057469637414, -3942.148296468192, 2423.597244034234, -2671.2274117473467, 2430.34828083728, -4417.927761101455, -1770.9015849153066, -3503.28727414569, 5850.416739446961, -3412.286497152647, -764.5742149845179, -835.7369202063288, 5822.306029513332, -125.46183606552313, 4577.568668907729, -2088.644289194419, 5325.576867529431, -2092.221075157343, 1402.8180675794047, -456.9296552669998, 7293.234173679577, -5863.466085051123, 3674.448785599918, -44.0830693306623, 2589.051420235526, 162.31563548157584, -1041.1644050963794, -4572.529569634007, -883.8512992132592, -4719.0013764299265, 6208.53486816876, -1202.9296582992388, 5492.05821883308, -643.461926338782, 6832.253470426036, -2148.2687085873827, 2570.1883142752345, -2199.248900569862, 1133.8617635024157, -2594.1824072321238, 2315.54978470964, -1783.7825382920778, 3381.4169137196136, -1345.1932315196361, -405.66847150252977, -1187.2739740493535, -1382.425620269739, -1072.4661102564526, -2510.987697367637, -702.2532274984667, 340.19438182307437, -2656.9994498336146, -3930.6914217573603, -4207.310438669263, 2524.8355248083217, -2511.4697486869154, 8033.438525714824, 1846.813340338313, -2715.4753214285274, -2604.192185791667, -70.14496949654571, -1970.4813622333957, 8469.617339504737, 89.78956054581371, 6894.011088256951, -2889.318119363031, 2779.3438417606144, -4235.374076759094, 4414.669757155647, -5398.378197224941], "policy_predator_policy_reward": [5822.385012517553, 2131.7466405710943, 6746.50274327711, 4795.973179573265, -864.0176481028229, 1940.2274105540757, 11243.441067946665, 604.4386218474481, -510.3037587882303, -100.05101249407667, 1891.873823125557, -504.82398753441396, 688.0730094034053, 427.7034105181548, 2518.8447238140843, 875.0084811497238, 499.2249298605785, -1549.4907851195164, -5230.971134816636, -4620.277763033181, 7888.455259351403, 2649.992450376986, 2125.1778062587878, -896.452407865253, 735.1249860836045, 1921.4692531631517, 3202.7394160100134, 800.8138745169757, 2874.788461717019, 1196.9122675202293, 1349.2066575660292, 683.8196399537892, 2820.1205092636983, 1511.0106030414627, -334.8253316890602, -69.99381064006567, 8360.49702345823, -21.188103393153625, 12038.020687121098, 1464.0589062836975, 5398.540564782271, -4397.915590417398, 16712.71208026044, 521.6705972783968, -31.52123285220847, 2585.4909941413725, -181.39685665401717, -4613.623009231648, 62.87277805542336, -1461.2509362551323, 4656.960109304259, 1648.3616684073338, 6442.642644553215, 7579.67692550079, 19608.046787346077, 4027.2796536322485, 8433.902652401202, 528.7939740017389, 2657.9377027981004, 2325.07048102561, 4230.302784986376, 1550.7213089664579, 2389.279906071256, 758.6179029635574, 6511.010276082725, 749.1701153610122, 5388.095024974323, 6408.532120503829, 5514.166349119929, 199.52809592522456, 1801.3082864296377, 3914.2613986513293, 3638.460980028235, 3603.2410445227715, 506.56427412309256, -2668.032276147044, 9606.112299112383, 1027.0506969508835, 4871.271462102592, 2087.3929345737474, 5654.277038139574, 6127.575927052214, 2705.71928260592, 5752.210984417227, 4632.350602366492, 7973.737694976137, 129.3003257456828, -2285.102069145153, -4502.896467358951, -797.8496926130668, 3821.766010173697, -2026.8749430108428, -3998.872164213232, 1194.2778770357945, 7309.887539507169, 3801.820983140901, 15018.334392028986, 4526.626590257836, -929.6880983083361, 1389.4544130167567, 7592.55932871108, 5362.300425553523, 0.0, -5883.071107620167, 28553.06994182706, 3510.775545935957, 5980.848980353406, 2200.934378639889, 444.6059478908311, -1551.6042343571726, 4280.932968936389, 5579.7748201891145, 7936.167624021133, 647.3008427457866, 67.28912987813474, 3164.2726849115907, 4657.532896000547, 879.6349738644415, -1053.9829353330397, 768.0769132319225, 11270.608350670775, 2901.8755429636494, 10026.098622846193, -1036.6733543666055, -249.8844694947904, -3680.478232563064, 4807.757923526448, 122.51785935192092, 5477.644011853921, -1341.9326720702607, 1240.5244183507218, 1953.2318374105382, 1788.5719012210432, 4790.520876901568, 5705.88649714292, 5485.121625787949, 6436.981991860744, 416.163868266357, -2154.3406407372718, 4857.581135455181, 25434.9915361931, 1236.663058676064, -4265.9191176856275, -1098.2707841109523, 6421.202140684213, 3881.2894468548184, -1848.1532752812855, 970.7532814769615, 5713.888826606797, 1267.0824279918118, -1268.6842316979878, -161.08385693046537, 14.542915720281655, 29.952875588868693, -1258.069948603885, -1269.9592034561942, 14516.351821574577, 4609.827877087282, 9079.734115971098, 1420.6725378437973, 7740.183267709217, -3428.110319011887, 7746.114311851599, -1760.617245365964, 1827.3242021723597, -18.340602747379975, 13003.706958681938, 2172.4215724578353, 15961.22210931425, 439.3491514223261, 13343.890336904418, 3331.883519861941, 9001.586755263488, 1330.1505277841477, 14733.004406881333, 1002.7426698256908, 3056.84518650011, 2814.722085752168, 8638.59117626373, 2152.6628642650107, 18836.70339092941, 1400.2795745577555, 6583.130264335222, 7084.085335403429, 3255.5561074146235, -468.7514578988417, -6845.459780106166, -583.328338097871, 6376.9001213194815, 2648.3376917014807, 14371.376639804454, 1720.2812004620414, -2897.181157179522, -2438.893574821686, 4573.40526003124, 4496.288095162937, 2549.859724128732, 3589.099985845832, 1681.120832833322, -170.49919237277777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7155151321478804, "mean_inference_ms": 1.545271375516591, "mean_action_processing_ms": 0.304302135166476, "mean_env_wait_ms": 0.13826881878304548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005818605422973633, "StateBufferConnector_ms": 0.003800630569458008, "ViewRequirementAgentConnector_ms": 0.11322522163391113}, "num_episodes": 18, "episode_return_max": 28554.927292872995, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 6691.9263564681205, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.5488953361346, "num_env_steps_trained_throughput_per_sec": 290.5488953361346, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 14140.318, "restore_workers_time_ms": 0.012, "training_step_time_ms": 14140.273, "sample_time_ms": 1111.01, "learn_time_ms": 13012.278, "learn_throughput": 307.402, "synch_weights_time_ms": 15.564}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "6751e_00000", "date": "2024-08-11_19-24-02", "timestamp": 1723418642, "time_this_iter_s": 13.819808959960938, "time_total_s": 1008.9511680603027, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea7f430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1008.9511680603027, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 51.81578947368422, "ram_util_percent": 82.79473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46543329166514535, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.577645899252916, "policy_loss": -0.005476041247380809, "vf_loss": 9.583103714796602, "vf_explained_var": -0.003369938254987121, "kl": 0.005826712492701674, "entropy": 0.6319733148214047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6374309124927672, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.341539718991234, "policy_loss": -0.00493400508584701, "vf_loss": 9.345829782031831, "vf_explained_var": 0.00011772068720015269, "kl": 0.006439474297402148, "entropy": 0.7231195990370695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 28554.927292872995, "episode_reward_min": -1.4210854715202004e-14, "episode_reward_mean": 6996.129518972698, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7128.1623163413715, "predator_policy": -6845.459780106166}, "policy_reward_max": {"prey_policy": 8469.617339504737, "predator_policy": 28553.06994182706}, "policy_reward_mean": {"prey_policy": 223.0281298137775, "predator_policy": 3275.03662967257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7614.265896395962, 14205.563424671724, 5184.781820799037, 14788.36213051093, 1352.2984024304342, 1.1546319456101628e-14, 112.72057534376152, 12018.887869848093, 6348.1899054514, 20684.702697690464, 7750.49069518483, 3301.1137496472143, 4159.256232409962, 3291.8742495505785, 7875.794446751632, 9452.104733325872, 8614.04419489973, 4410.623576844503, 1651.2999120568456, 2193.4921769150815, 15908.606774449097, -1.4210854715202004e-14, 5083.089500565024, 3539.8390300062347, 11649.785438677147, 4850.083079483387, 2733.373765850395, 8435.214668655244, 1682.9292566032786, 7055.9080005607475, 16429.337618450438, 1578.1359316586759, 11268.27080423556, 0.0, 28554.927292872995, 7172.13435974223, 664.8273794694311, 2370.832160852164, 11092.022711759972, 2335.55745453215, 8701.02264667763, 224.35891190531163, 15420.419759168524, 15675.718305415538, 1559.1467345203525, 9011.935018039734, 7473.135246232855, 3737.6654289304875, 6331.46261040949, 9203.428642666697, 1578.9570010661055, 5141.370737012215, 25071.3434596783, 332.6542916512298, 12791.41596725236, 2355.9557985677648, 7926.859666911017, 0.0, 3674.8615075784064, 223.33790365702157, 13512.485723931479, 4897.553978171738, 9317.678158566956, 10834.093358979922, 6492.968361263639, 15547.067944845123, 14940.250617006877, 17207.54110318394, 12367.960965247627, 14142.804631155132, 3416.6755417260893, 7578.013115662643, 17920.17789747662, 5529.213739312042, 2800.170425637181, 2451.463747849115, 3705.5703058007766, 14051.031508536522, 3223.332168049351, 13074.386324088175, 4682.92947497608, 526.9132003912526, 4588.548375656472, 2579.2033684369894, 891.9904774742683, 1481.3547291446255, 2973.6091408994816, 871.187603835846, 446.6169026570569, 11982.307248854499, 775.5123223021558, 6893.701574070126, 7891.329752468009, 5153.160433168803, 13134.11890573383, 9272.216378378575, 10968.872749599146, 1840.1014319396288, 1379.2532050273367, 4419.793449271447], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1396.1959505056327, -2121.238974174748, -433.603658051364, 1137.0874893182747, 7566.097934070354, -3381.941087636179, 279.14307175456963, -2725.163618782482, 1203.630430488766, -2405.3017893474926, 3362.338887915612, 1432.6809779700563, 2553.7677579337774, -1042.6690243903076, 6717.82595113883, -1004.259859002355, -3736.792729647402, -3937.336934955213, -1479.2384384901645, -1471.3853047976986, 736.0660379094406, -1948.2719691275522, -946.0664400490601, -735.8279941274374, 1251.8269091941086, -2873.5947707369896, 3023.128871655991, -2879.1524311402345, 1354.6606263542985, -739.0465710464024, -205.60125051578245, -2138.921161636491, 5751.850611871785, -2851.500862017228, 3038.6471410785634, -4343.593249315028, -868.2156531280606, -4722.1864593660985, 4379.612632815375, -24.65245387633775, 6487.33269110701, -1211.8889127211964, 169.49791966503213, -7128.1623163413715, -2302.3115169773487, -4396.45194764944, 804.3741350507731, -5722.465372067685, -859.2174443092212, -97.08541435623502, 6820.2837438287515, 185.6010790541275, 5529.368580645302, 2504.75134517713, 6942.3571852451505, -302.0335837527529, 4955.110114882482, -467.5865711017708, -492.61076098654485, -3563.1897611007844, -1960.5170436230333, -1155.1063202133562, 3194.504141446709, -2076.134524496453, 1296.3203701997568, -2982.909320228802, 6139.658964284429, -256.58785666427116, -1519.4931292453825, -1989.4250656446018, 1516.5023385930833, -2526.151337844154, 5713.929559766022, -3942.1038938302518, -3032.539695963953, -4457.335932309388, 3903.0338511576106, -1394.4796061645566, 1037.6336642250533, -1933.6380244826275, 3956.93373001389, -793.0789532012278, -721.0764283792136, 1231.3413623856452, 1314.7963457712797, -66.86048023719918, 7133.930381349922, -447.63734441402676, 6494.972693865866, -1005.4632572876544, 4980.29276834797, -898.6335331866009, 2650.593117562602, 686.8307888865671, 4486.057469637414, -3942.148296468192, 2423.597244034234, -2671.2274117473467, 2430.34828083728, -4417.927761101455, -1770.9015849153066, -3503.28727414569, 5850.416739446961, -3412.286497152647, -764.5742149845179, -835.7369202063288, 5822.306029513332, -125.46183606552313, 4577.568668907729, -2088.644289194419, 5325.576867529431, -2092.221075157343, 1402.8180675794047, -456.9296552669998, 7293.234173679577, -5863.466085051123, 3674.448785599918, -44.0830693306623, 2589.051420235526, 162.31563548157584, -1041.1644050963794, -4572.529569634007, -883.8512992132592, -4719.0013764299265, 6208.53486816876, -1202.9296582992388, 5492.05821883308, -643.461926338782, 6832.253470426036, -2148.2687085873827, 2570.1883142752345, -2199.248900569862, 1133.8617635024157, -2594.1824072321238, 2315.54978470964, -1783.7825382920778, 3381.4169137196136, -1345.1932315196361, -405.66847150252977, -1187.2739740493535, -1382.425620269739, -1072.4661102564526, -2510.987697367637, -702.2532274984667, 340.19438182307437, -2656.9994498336146, -3930.6914217573603, -4207.310438669263, 2524.8355248083217, -2511.4697486869154, 8033.438525714824, 1846.813340338313, -2715.4753214285274, -2604.192185791667, -70.14496949654571, -1970.4813622333957, 8469.617339504737, 89.78956054581371, 6894.011088256951, -2889.318119363031, 2779.3438417606144, -4235.374076759094, 4414.669757155647, -5398.378197224941, 459.0593474069726, -3889.829370085492, 8409.314921757505, -2648.606488910819, -1409.0767052715214, -3503.61592439482, 3984.703292766297, -2102.270922666472, 819.9850322660739, 374.7509200341274, 492.24886796756965, -2376.585637155524, 3046.445268314111, -3.056372452945638, -3038.3730973620904, -884.0936476596906, 2931.4449281172283, -2729.578289277594, 3483.58409869919, -2398.2626400705853, -520.8447811340836, -1677.7338274654376, -659.2170723275076, -675.8875773452219, 6614.2202086974685, -321.47018145160473, 122.74202085589332, -3536.745361455405, -2146.606727290024, -3064.5222774906265, 2678.3173760756035, -3830.9253579142064, 5620.926905376084, 1747.9666396901682, 7855.727192851893, 1473.8213888759203], "policy_predator_policy_reward": [8360.49702345823, -21.188103393153625, 12038.020687121098, 1464.0589062836975, 5398.540564782271, -4397.915590417398, 16712.71208026044, 521.6705972783968, -31.52123285220847, 2585.4909941413725, -181.39685665401717, -4613.623009231648, 62.87277805542336, -1461.2509362551323, 4656.960109304259, 1648.3616684073338, 6442.642644553215, 7579.67692550079, 19608.046787346077, 4027.2796536322485, 8433.902652401202, 528.7939740017389, 2657.9377027981004, 2325.07048102561, 4230.302784986376, 1550.7213089664579, 2389.279906071256, 758.6179029635574, 6511.010276082725, 749.1701153610122, 5388.095024974323, 6408.532120503829, 5514.166349119929, 199.52809592522456, 1801.3082864296377, 3914.2613986513293, 3638.460980028235, 3603.2410445227715, 506.56427412309256, -2668.032276147044, 9606.112299112383, 1027.0506969508835, 4871.271462102592, 2087.3929345737474, 5654.277038139574, 6127.575927052214, 2705.71928260592, 5752.210984417227, 4632.350602366492, 7973.737694976137, 129.3003257456828, -2285.102069145153, -4502.896467358951, -797.8496926130668, 3821.766010173697, -2026.8749430108428, -3998.872164213232, 1194.2778770357945, 7309.887539507169, 3801.820983140901, 15018.334392028986, 4526.626590257836, -929.6880983083361, 1389.4544130167567, 7592.55932871108, 5362.300425553523, 0.0, -5883.071107620167, 28553.06994182706, 3510.775545935957, 5980.848980353406, 2200.934378639889, 444.6059478908311, -1551.6042343571726, 4280.932968936389, 5579.7748201891145, 7936.167624021133, 647.3008427457866, 67.28912987813474, 3164.2726849115907, 4657.532896000547, 879.6349738644415, -1053.9829353330397, 768.0769132319225, 11270.608350670775, 2901.8755429636494, 10026.098622846193, -1036.6733543666055, -249.8844694947904, -3680.478232563064, 4807.757923526448, 122.51785935192092, 5477.644011853921, -1341.9326720702607, 1240.5244183507218, 1953.2318374105382, 1788.5719012210432, 4790.520876901568, 5705.88649714292, 5485.121625787949, 6436.981991860744, 416.163868266357, -2154.3406407372718, 4857.581135455181, 25434.9915361931, 1236.663058676064, -4265.9191176856275, -1098.2707841109523, 6421.202140684213, 3881.2894468548184, -1848.1532752812855, 970.7532814769615, 5713.888826606797, 1267.0824279918118, -1268.6842316979878, -161.08385693046537, 14.542915720281655, 29.952875588868693, -1258.069948603885, -1269.9592034561942, 14516.351821574577, 4609.827877087282, 9079.734115971098, 1420.6725378437973, 7740.183267709217, -3428.110319011887, 7746.114311851599, -1760.617245365964, 1827.3242021723597, -18.340602747379975, 13003.706958681938, 2172.4215724578353, 15961.22210931425, 439.3491514223261, 13343.890336904418, 3331.883519861941, 9001.586755263488, 1330.1505277841477, 14733.004406881333, 1002.7426698256908, 3056.84518650011, 2814.722085752168, 8638.59117626373, 2152.6628642650107, 18836.70339092941, 1400.2795745577555, 6583.130264335222, 7084.085335403429, 3255.5561074146235, -468.7514578988417, -6845.459780106166, -583.328338097871, 6376.9001213194815, 2648.3376917014807, 14371.376639804454, 1720.2812004620414, -2897.181157179522, -2438.893574821686, 4573.40526003124, 4496.288095162937, 2549.859724128732, 3589.099985845832, 1681.120832833322, -170.49919237277777, 6458.360687769998, 1560.9577105650033, 2668.3410045017813, -5849.846068911466, 2534.7227076446893, 3269.960399495923, -602.5848591605148, 201.50721820531507, 2297.4472144449423, -518.5740258456594, 687.5136581319006, 2068.0107148918983, -4224.992042165819, 1628.2200489617076, 11157.701888046966, 4747.072105829339, -1610.1228236518132, 2183.7685071143337, 7031.456155241605, -1223.0760398000787, 5767.877220204845, 4322.031140862687, 4853.266070453861, 1634.9990123876728, 8256.202751839981, -1414.8338733520313, 5733.112269223144, 6953.107449754957, 12161.090637239531, 4018.911117140265, 1017.1000324697509, 1975.6093813084815, -1518.2303758886983, -4471.409964150221, -1102.624961138079, -3807.1301713182315]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7152266277050632, "mean_inference_ms": 1.5447966938728306, "mean_action_processing_ms": 0.3041966575639432, "mean_env_wait_ms": 0.13822688764739335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006397128105163574, "StateBufferConnector_ms": 0.0037642717361450195, "ViewRequirementAgentConnector_ms": 0.13483691215515137}, "num_episodes": 18, "episode_return_max": 28554.927292872995, "episode_return_min": -1.4210854715202004e-14, "episode_return_mean": 6996.129518972698, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.8525086146433, "num_env_steps_trained_throughput_per_sec": 268.8525086146433, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 14216.795, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14216.748, "sample_time_ms": 1163.672, "learn_time_ms": 13036.016, "learn_throughput": 306.842, "synch_weights_time_ms": 15.528}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "6751e_00000", "date": "2024-08-11_19-24-17", "timestamp": 1723418657, "time_this_iter_s": 14.936600685119629, "time_total_s": 1023.8877687454224, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eadac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1023.8877687454224, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 55.554545454545455, "ram_util_percent": 83.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5177136301600113, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35926653695485, "policy_loss": -0.004986408719221356, "vf_loss": 9.364217335332638, "vf_explained_var": -0.001981212537755411, "kl": 0.011389998720671967, "entropy": 0.6321309310103219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.599518694622176, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.22964950389963, "policy_loss": -0.0059658799113498796, "vf_loss": 9.234707217241722, "vf_explained_var": -0.00010162651854217368, "kl": 0.00908145365076693, "entropy": 0.6854332450205687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 29361.80804357204, "episode_reward_min": 0.0, "episode_reward_mean": 8197.519434177997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5863.466085051123, "predator_policy": -6845.459780106166}, "policy_reward_max": {"prey_policy": 8469.617339504737, "predator_policy": 30452.140027804777}, "policy_reward_mean": {"prey_policy": 197.0272248629134, "predator_policy": 3901.732492226085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5083.089500565024, 3539.8390300062347, 11649.785438677147, 4850.083079483387, 2733.373765850395, 8435.214668655244, 1682.9292566032786, 7055.9080005607475, 16429.337618450438, 1578.1359316586759, 11268.27080423556, 0.0, 28554.927292872995, 7172.13435974223, 664.8273794694311, 2370.832160852164, 11092.022711759972, 2335.55745453215, 8701.02264667763, 224.35891190531163, 15420.419759168524, 15675.718305415538, 1559.1467345203525, 9011.935018039734, 7473.135246232855, 3737.6654289304875, 6331.46261040949, 9203.428642666697, 1578.9570010661055, 5141.370737012215, 25071.3434596783, 332.6542916512298, 12791.41596725236, 2355.9557985677648, 7926.859666911017, 0.0, 3674.8615075784064, 223.33790365702157, 13512.485723931479, 4897.553978171738, 9317.678158566956, 10834.093358979922, 6492.968361263639, 15547.067944845123, 14940.250617006877, 17207.54110318394, 12367.960965247627, 14142.804631155132, 3416.6755417260893, 7578.013115662643, 17920.17789747662, 5529.213739312042, 2800.170425637181, 2451.463747849115, 3705.5703058007766, 14051.031508536522, 3223.332168049351, 13074.386324088175, 4682.92947497608, 526.9132003912526, 4588.548375656472, 2579.2033684369894, 891.9904774742683, 1481.3547291446255, 2973.6091408994816, 871.187603835846, 446.6169026570569, 11982.307248854499, 775.5123223021558, 6893.701574070126, 7891.329752468009, 5153.160433168803, 13134.11890573383, 9272.216378378575, 10968.872749599146, 1840.1014319396288, 1379.2532050273367, 4419.793449271447, 29361.80804357204, 12699.20990268287, 1576.8308483544051, 778.2579657863967, 19114.24262660969, 9346.73488550814, 4500.951986364673, 7216.884052878169, 1629.047421175362, 15028.966032042794, 28762.63075034115, 13869.552689420516, 5056.966420401089, 7797.990337306488, 11878.042145713089, 13228.640900675968, 5478.424520229648, 14942.17451301918, 991.1328194421723, 18727.180417047006, 21457.358877179664, 27614.436829956612], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-2302.3115169773487, -4396.45194764944, 804.3741350507731, -5722.465372067685, -859.2174443092212, -97.08541435623502, 6820.2837438287515, 185.6010790541275, 5529.368580645302, 2504.75134517713, 6942.3571852451505, -302.0335837527529, 4955.110114882482, -467.5865711017708, -492.61076098654485, -3563.1897611007844, -1960.5170436230333, -1155.1063202133562, 3194.504141446709, -2076.134524496453, 1296.3203701997568, -2982.909320228802, 6139.658964284429, -256.58785666427116, -1519.4931292453825, -1989.4250656446018, 1516.5023385930833, -2526.151337844154, 5713.929559766022, -3942.1038938302518, -3032.539695963953, -4457.335932309388, 3903.0338511576106, -1394.4796061645566, 1037.6336642250533, -1933.6380244826275, 3956.93373001389, -793.0789532012278, -721.0764283792136, 1231.3413623856452, 1314.7963457712797, -66.86048023719918, 7133.930381349922, -447.63734441402676, 6494.972693865866, -1005.4632572876544, 4980.29276834797, -898.6335331866009, 2650.593117562602, 686.8307888865671, 4486.057469637414, -3942.148296468192, 2423.597244034234, -2671.2274117473467, 2430.34828083728, -4417.927761101455, -1770.9015849153066, -3503.28727414569, 5850.416739446961, -3412.286497152647, -764.5742149845179, -835.7369202063288, 5822.306029513332, -125.46183606552313, 4577.568668907729, -2088.644289194419, 5325.576867529431, -2092.221075157343, 1402.8180675794047, -456.9296552669998, 7293.234173679577, -5863.466085051123, 3674.448785599918, -44.0830693306623, 2589.051420235526, 162.31563548157584, -1041.1644050963794, -4572.529569634007, -883.8512992132592, -4719.0013764299265, 6208.53486816876, -1202.9296582992388, 5492.05821883308, -643.461926338782, 6832.253470426036, -2148.2687085873827, 2570.1883142752345, -2199.248900569862, 1133.8617635024157, -2594.1824072321238, 2315.54978470964, -1783.7825382920778, 3381.4169137196136, -1345.1932315196361, -405.66847150252977, -1187.2739740493535, -1382.425620269739, -1072.4661102564526, -2510.987697367637, -702.2532274984667, 340.19438182307437, -2656.9994498336146, -3930.6914217573603, -4207.310438669263, 2524.8355248083217, -2511.4697486869154, 8033.438525714824, 1846.813340338313, -2715.4753214285274, -2604.192185791667, -70.14496949654571, -1970.4813622333957, 8469.617339504737, 89.78956054581371, 6894.011088256951, -2889.318119363031, 2779.3438417606144, -4235.374076759094, 4414.669757155647, -5398.378197224941, 459.0593474069726, -3889.829370085492, 8409.314921757505, -2648.606488910819, -1409.0767052715214, -3503.61592439482, 3984.703292766297, -2102.270922666472, 819.9850322660739, 374.7509200341274, 492.24886796756965, -2376.585637155524, 3046.445268314111, -3.056372452945638, -3038.3730973620904, -884.0936476596906, 2931.4449281172283, -2729.578289277594, 3483.58409869919, -2398.2626400705853, -520.8447811340836, -1677.7338274654376, -659.2170723275076, -675.8875773452219, 6614.2202086974685, -321.47018145160473, 122.74202085589332, -3536.745361455405, -2146.606727290024, -3064.5222774906265, 2678.3173760756035, -3830.9253579142064, 5620.926905376084, 1747.9666396901682, 7855.727192851893, 1473.8213888759203, -1975.4625842766854, -1632.0171485341316, -3118.0856876756816, -2706.238476501814, 1965.7496590575033, 462.03636300078756, 5813.18983982088, -5749.556256173684, -2235.869404543433, -1382.8183190934665, 3228.7563833268428, -2505.8133037971184, 536.3765026045392, -4129.7613593825845, 1112.3225797939356, -3386.0892213649613, 1858.2006069973286, -3001.061020980133, -405.95781260274487, -3635.8073509018254, -893.3047903667467, -252.50280872040247, 5567.631098114188, -535.4921459587754, 5421.773276336599, -2519.1965075575304, 665.1785314239929, -3187.920839485927, -3411.192542983185, -1030.1499244002673, 794.4974929854504, -1113.4839739385243, 4282.895389383577, -1568.1022452445332, 636.2310822253046, -3349.9500620206477, 1269.411660625939, -1287.7354577430333, 7464.316490189997, -246.30496124784867, 5724.481860005021, -759.7340124195814, -544.8804382294384, -952.963171593203], "policy_predator_policy_reward": [5654.277038139574, 6127.575927052214, 2705.71928260592, 5752.210984417227, 4632.350602366492, 7973.737694976137, 129.3003257456828, -2285.102069145153, -4502.896467358951, -797.8496926130668, 3821.766010173697, -2026.8749430108428, -3998.872164213232, 1194.2778770357945, 7309.887539507169, 3801.820983140901, 15018.334392028986, 4526.626590257836, -929.6880983083361, 1389.4544130167567, 7592.55932871108, 5362.300425553523, 0.0, -5883.071107620167, 28553.06994182706, 3510.775545935957, 5980.848980353406, 2200.934378639889, 444.6059478908311, -1551.6042343571726, 4280.932968936389, 5579.7748201891145, 7936.167624021133, 647.3008427457866, 67.28912987813474, 3164.2726849115907, 4657.532896000547, 879.6349738644415, -1053.9829353330397, 768.0769132319225, 11270.608350670775, 2901.8755429636494, 10026.098622846193, -1036.6733543666055, -249.8844694947904, -3680.478232563064, 4807.757923526448, 122.51785935192092, 5477.644011853921, -1341.9326720702607, 1240.5244183507218, 1953.2318374105382, 1788.5719012210432, 4790.520876901568, 5705.88649714292, 5485.121625787949, 6436.981991860744, 416.163868266357, -2154.3406407372718, 4857.581135455181, 25434.9915361931, 1236.663058676064, -4265.9191176856275, -1098.2707841109523, 6421.202140684213, 3881.2894468548184, -1848.1532752812855, 970.7532814769615, 5713.888826606797, 1267.0824279918118, -1268.6842316979878, -161.08385693046537, 14.542915720281655, 29.952875588868693, -1258.069948603885, -1269.9592034561942, 14516.351821574577, 4609.827877087282, 9079.734115971098, 1420.6725378437973, 7740.183267709217, -3428.110319011887, 7746.114311851599, -1760.617245365964, 1827.3242021723597, -18.340602747379975, 13003.706958681938, 2172.4215724578353, 15961.22210931425, 439.3491514223261, 13343.890336904418, 3331.883519861941, 9001.586755263488, 1330.1505277841477, 14733.004406881333, 1002.7426698256908, 3056.84518650011, 2814.722085752168, 8638.59117626373, 2152.6628642650107, 18836.70339092941, 1400.2795745577555, 6583.130264335222, 7084.085335403429, 3255.5561074146235, -468.7514578988417, -6845.459780106166, -583.328338097871, 6376.9001213194815, 2648.3376917014807, 14371.376639804454, 1720.2812004620414, -2897.181157179522, -2438.893574821686, 4573.40526003124, 4496.288095162937, 2549.859724128732, 3589.099985845832, 1681.120832833322, -170.49919237277777, 6458.360687769998, 1560.9577105650033, 2668.3410045017813, -5849.846068911466, 2534.7227076446893, 3269.960399495923, -602.5848591605148, 201.50721820531507, 2297.4472144449423, -518.5740258456594, 687.5136581319006, 2068.0107148918983, -4224.992042165819, 1628.2200489617076, 11157.701888046966, 4747.072105829339, -1610.1228236518132, 2183.7685071143337, 7031.456155241605, -1223.0760398000787, 5767.877220204845, 4322.031140862687, 4853.266070453861, 1634.9990123876728, 8256.202751839981, -1414.8338733520313, 5733.112269223144, 6953.107449754957, 12161.090637239531, 4018.911117140265, 1017.1000324697509, 1975.6093813084815, -1518.2303758886983, -4471.409964150221, -1102.624961138079, -3807.1301713182315, 30452.140027804777, 2517.1477485780333, 14074.946206755438, 4448.5878601049135, -1255.4420299161889, 404.48685621231147, -534.4926882250612, 1249.1170703642576, 19319.36732641771, 3413.563023828885, 6220.273289051463, 2403.5185169269607, 2707.530705964239, 5386.806137178479, 7012.688602091041, 2477.962092358144, 90.09611580617235, 2681.8117193519947, 14111.480898326761, 4959.250297220599, 28286.435109685575, 1622.0032397427271, 5714.4624083808085, 3122.9513288842572, 183.20105342799178, 1971.188598194026, 5751.979138164469, 4568.753507203953, 16058.204112084315, 261.180501012309, 13338.269965650634, 209.35741597840354, -999.2284358870302, 3762.8598119776307, 15204.165797595046, 2451.7276952194866, 156.76910649752912, 852.6875100617398, 11034.426979025735, 474.74190907917654, 12008.045943358811, 4484.565086235432, 26645.85768544422, 2466.4227543350394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7145479430086473, "mean_inference_ms": 1.5437421147541661, "mean_action_processing_ms": 0.3039297537689511, "mean_env_wait_ms": 0.13814579204269017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006916046142578125, "StateBufferConnector_ms": 0.003833174705505371, "ViewRequirementAgentConnector_ms": 0.13519442081451416}, "num_episodes": 22, "episode_return_max": 29361.80804357204, "episode_return_min": 0.0, "episode_return_mean": 8197.519434177997, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.94131901274665, "num_env_steps_trained_throughput_per_sec": 296.94131901274665, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 14172.325, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14172.272, "sample_time_ms": 1158.559, "learn_time_ms": 12996.642, "learn_throughput": 307.772, "synch_weights_time_ms": 15.579}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "6751e_00000", "date": "2024-08-11_19-24-31", "timestamp": 1723418671, "time_this_iter_s": 13.525064945220947, "time_total_s": 1037.4128336906433, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eadae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1037.4128336906433, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 51.32105263157895, "ram_util_percent": 83.14736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5085058914448218, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.12193349000638, "policy_loss": -0.0061112423562912875, "vf_loss": 9.128023952907986, "vf_explained_var": -0.001356850099311304, "kl": 0.006654075080676971, "entropy": 0.6444438430051955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6802330510405006, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.331922585119015, "policy_loss": -0.005391244249783022, "vf_loss": 9.336644457761572, "vf_explained_var": -3.798298104099496e-05, "kl": 0.006693669748290075, "entropy": 0.7028921651777136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 29361.80804357204, "episode_reward_min": 0.0, "episode_reward_mean": 9061.46336585327, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5863.466085051123, "predator_policy": -6845.459780106166}, "policy_reward_max": {"prey_policy": 8469.617339504737, "predator_policy": 30452.140027804777}, "policy_reward_mean": {"prey_policy": 186.3604146166955, "predator_policy": 4344.371268309939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9011.935018039734, 7473.135246232855, 3737.6654289304875, 6331.46261040949, 9203.428642666697, 1578.9570010661055, 5141.370737012215, 25071.3434596783, 332.6542916512298, 12791.41596725236, 2355.9557985677648, 7926.859666911017, 0.0, 3674.8615075784064, 223.33790365702157, 13512.485723931479, 4897.553978171738, 9317.678158566956, 10834.093358979922, 6492.968361263639, 15547.067944845123, 14940.250617006877, 17207.54110318394, 12367.960965247627, 14142.804631155132, 3416.6755417260893, 7578.013115662643, 17920.17789747662, 5529.213739312042, 2800.170425637181, 2451.463747849115, 3705.5703058007766, 14051.031508536522, 3223.332168049351, 13074.386324088175, 4682.92947497608, 526.9132003912526, 4588.548375656472, 2579.2033684369894, 891.9904774742683, 1481.3547291446255, 2973.6091408994816, 871.187603835846, 446.6169026570569, 11982.307248854499, 775.5123223021558, 6893.701574070126, 7891.329752468009, 5153.160433168803, 13134.11890573383, 9272.216378378575, 10968.872749599146, 1840.1014319396288, 1379.2532050273367, 4419.793449271447, 29361.80804357204, 12699.20990268287, 1576.8308483544051, 778.2579657863967, 19114.24262660969, 9346.73488550814, 4500.951986364673, 7216.884052878169, 1629.047421175362, 15028.966032042794, 28762.63075034115, 13869.552689420516, 5056.966420401089, 7797.990337306488, 11878.042145713089, 13228.640900675968, 5478.424520229648, 14942.17451301918, 991.1328194421723, 18727.180417047006, 21457.358877179664, 27614.436829956612, 15160.261862797426, 5958.099082999158, 17825.06652817716, 6528.656080268489, 6527.183390193144, 3068.1794254050646, 4072.80173326078, 10230.682276068948, 4507.205804098513, 0.0, 19558.145022591983, 15817.462764256665, 16899.31190976037, 7177.966948172204, 21931.288287312567, 12933.981082136872, 17941.604597975762, 9171.432870654791, 15917.462491935763, 2759.0682193676653, 10305.479626510676, 17361.897310371853, 12818.090664873736], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4980.29276834797, -898.6335331866009, 2650.593117562602, 686.8307888865671, 4486.057469637414, -3942.148296468192, 2423.597244034234, -2671.2274117473467, 2430.34828083728, -4417.927761101455, -1770.9015849153066, -3503.28727414569, 5850.416739446961, -3412.286497152647, -764.5742149845179, -835.7369202063288, 5822.306029513332, -125.46183606552313, 4577.568668907729, -2088.644289194419, 5325.576867529431, -2092.221075157343, 1402.8180675794047, -456.9296552669998, 7293.234173679577, -5863.466085051123, 3674.448785599918, -44.0830693306623, 2589.051420235526, 162.31563548157584, -1041.1644050963794, -4572.529569634007, -883.8512992132592, -4719.0013764299265, 6208.53486816876, -1202.9296582992388, 5492.05821883308, -643.461926338782, 6832.253470426036, -2148.2687085873827, 2570.1883142752345, -2199.248900569862, 1133.8617635024157, -2594.1824072321238, 2315.54978470964, -1783.7825382920778, 3381.4169137196136, -1345.1932315196361, -405.66847150252977, -1187.2739740493535, -1382.425620269739, -1072.4661102564526, -2510.987697367637, -702.2532274984667, 340.19438182307437, -2656.9994498336146, -3930.6914217573603, -4207.310438669263, 2524.8355248083217, -2511.4697486869154, 8033.438525714824, 1846.813340338313, -2715.4753214285274, -2604.192185791667, -70.14496949654571, -1970.4813622333957, 8469.617339504737, 89.78956054581371, 6894.011088256951, -2889.318119363031, 2779.3438417606144, -4235.374076759094, 4414.669757155647, -5398.378197224941, 459.0593474069726, -3889.829370085492, 8409.314921757505, -2648.606488910819, -1409.0767052715214, -3503.61592439482, 3984.703292766297, -2102.270922666472, 819.9850322660739, 374.7509200341274, 492.24886796756965, -2376.585637155524, 3046.445268314111, -3.056372452945638, -3038.3730973620904, -884.0936476596906, 2931.4449281172283, -2729.578289277594, 3483.58409869919, -2398.2626400705853, -520.8447811340836, -1677.7338274654376, -659.2170723275076, -675.8875773452219, 6614.2202086974685, -321.47018145160473, 122.74202085589332, -3536.745361455405, -2146.606727290024, -3064.5222774906265, 2678.3173760756035, -3830.9253579142064, 5620.926905376084, 1747.9666396901682, 7855.727192851893, 1473.8213888759203, -1975.4625842766854, -1632.0171485341316, -3118.0856876756816, -2706.238476501814, 1965.7496590575033, 462.03636300078756, 5813.18983982088, -5749.556256173684, -2235.869404543433, -1382.8183190934665, 3228.7563833268428, -2505.8133037971184, 536.3765026045392, -4129.7613593825845, 1112.3225797939356, -3386.0892213649613, 1858.2006069973286, -3001.061020980133, -405.95781260274487, -3635.8073509018254, -893.3047903667467, -252.50280872040247, 5567.631098114188, -535.4921459587754, 5421.773276336599, -2519.1965075575304, 665.1785314239929, -3187.920839485927, -3411.192542983185, -1030.1499244002673, 794.4974929854504, -1113.4839739385243, 4282.895389383577, -1568.1022452445332, 636.2310822253046, -3349.9500620206477, 1269.411660625939, -1287.7354577430333, 7464.316490189997, -246.30496124784867, 5724.481860005021, -759.7340124195814, -544.8804382294384, -952.963171593203, 2999.7054759727894, -719.7034460935407, -231.62903758150023, -2180.6147784393725, 1577.929447536376, -599.1097655124112, 3723.19797230178, -597.0295787594549, 4363.893491478134, -1983.4188346344556, 6380.085635552004, -3353.4050694411912, 2425.7917919171296, -3721.198263757622, 4951.225060701452, -2232.2450128077353, -2343.8759758621745, -4154.966217621612, 4338.6476985894415, 2184.4884161237737, -1741.1323508173514, -1892.5241349399507, -141.00471696484723, -1820.2737411839607, -631.9571641262645, -2169.734776722432, 2374.204029489576, 1415.7255348384704, -495.94131073458817, -400.47953317861266, 336.6117505145886, -3159.5594804610837, 7055.82438836726, -267.7077608563384, 1418.1034398301513, -742.8053309272138, -1739.4657852572775, -3048.490640638854, 5062.629970791443, -1417.4360631071, 1018.3416208198697, -2219.346376460134, 6740.813239557313, -731.4951156029251, 5466.510480389809, -1018.6282311138988], "policy_predator_policy_reward": [4807.757923526448, 122.51785935192092, 5477.644011853921, -1341.9326720702607, 1240.5244183507218, 1953.2318374105382, 1788.5719012210432, 4790.520876901568, 5705.88649714292, 5485.121625787949, 6436.981991860744, 416.163868266357, -2154.3406407372718, 4857.581135455181, 25434.9915361931, 1236.663058676064, -4265.9191176856275, -1098.2707841109523, 6421.202140684213, 3881.2894468548184, -1848.1532752812855, 970.7532814769615, 5713.888826606797, 1267.0824279918118, -1268.6842316979878, -161.08385693046537, 14.542915720281655, 29.952875588868693, -1258.069948603885, -1269.9592034561942, 14516.351821574577, 4609.827877087282, 9079.734115971098, 1420.6725378437973, 7740.183267709217, -3428.110319011887, 7746.114311851599, -1760.617245365964, 1827.3242021723597, -18.340602747379975, 13003.706958681938, 2172.4215724578353, 15961.22210931425, 439.3491514223261, 13343.890336904418, 3331.883519861941, 9001.586755263488, 1330.1505277841477, 14733.004406881333, 1002.7426698256908, 3056.84518650011, 2814.722085752168, 8638.59117626373, 2152.6628642650107, 18836.70339092941, 1400.2795745577555, 6583.130264335222, 7084.085335403429, 3255.5561074146235, -468.7514578988417, -6845.459780106166, -583.328338097871, 6376.9001213194815, 2648.3376917014807, 14371.376639804454, 1720.2812004620414, -2897.181157179522, -2438.893574821686, 4573.40526003124, 4496.288095162937, 2549.859724128732, 3589.099985845832, 1681.120832833322, -170.49919237277777, 6458.360687769998, 1560.9577105650033, 2668.3410045017813, -5849.846068911466, 2534.7227076446893, 3269.960399495923, -602.5848591605148, 201.50721820531507, 2297.4472144449423, -518.5740258456594, 687.5136581319006, 2068.0107148918983, -4224.992042165819, 1628.2200489617076, 11157.701888046966, 4747.072105829339, -1610.1228236518132, 2183.7685071143337, 7031.456155241605, -1223.0760398000787, 5767.877220204845, 4322.031140862687, 4853.266070453861, 1634.9990123876728, 8256.202751839981, -1414.8338733520313, 5733.112269223144, 6953.107449754957, 12161.090637239531, 4018.911117140265, 1017.1000324697509, 1975.6093813084815, -1518.2303758886983, -4471.409964150221, -1102.624961138079, -3807.1301713182315, 30452.140027804777, 2517.1477485780333, 14074.946206755438, 4448.5878601049135, -1255.4420299161889, 404.48685621231147, -534.4926882250612, 1249.1170703642576, 19319.36732641771, 3413.563023828885, 6220.273289051463, 2403.5185169269607, 2707.530705964239, 5386.806137178479, 7012.688602091041, 2477.962092358144, 90.09611580617235, 2681.8117193519947, 14111.480898326761, 4959.250297220599, 28286.435109685575, 1622.0032397427271, 5714.4624083808085, 3122.9513288842572, 183.20105342799178, 1971.188598194026, 5751.979138164469, 4568.753507203953, 16058.204112084315, 261.180501012309, 13338.269965650634, 209.35741597840354, -999.2284358870302, 3762.8598119776307, 15204.165797595046, 2451.7276952194866, 156.76910649752912, 852.6875100617398, 11034.426979025735, 474.74190907917654, 12008.045943358811, 4484.565086235432, 26645.85768544422, 2466.4227543350394, 14773.996744203547, -1893.7369112853648, 6721.004303367988, 1649.338595652039, 13526.53835609385, 3319.708490059354, 3088.19605692098, 314.29162980519357, 2068.5604086699313, 2078.1483246795096, 1713.661021711169, -1672.1621624169356, 5368.356285828525, -0.1480807272520508, 4949.393713160677, 2562.3085150145516, 6461.039166804335, 4545.008830777965, -1396.7151293660202, -5126.420985347189, 21761.811804236084, 1429.9897041132076, 15611.937936759286, 2166.803285646186, 16902.179325539695, 2798.8245250693763, 3509.5605447516796, -121.52316090751168, 21588.655628959594, 1239.053502266177, 13205.156857495766, 2551.7719545876234, 12945.588181255336, -1792.100210790474, 7053.583625973213, 1442.5511357786493, 17666.58332645883, 3038.8355913730666, -4125.875965423061, 3239.7502771063855, 9907.518779941212, 1598.9656022097276, 8254.637240438364, 3097.9419459791156, 9204.812796162267, -834.604380564464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7139487306196124, "mean_inference_ms": 1.5443436111009599, "mean_action_processing_ms": 0.30286368842606615, "mean_env_wait_ms": 0.1381754487610962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007265686988830566, "StateBufferConnector_ms": 0.003953456878662109, "ViewRequirementAgentConnector_ms": 0.13841843605041504}, "num_episodes": 23, "episode_return_max": 29361.80804357204, "episode_return_min": 0.0, "episode_return_mean": 9061.46336585327, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.00796300828387, "num_env_steps_trained_throughput_per_sec": 289.00796300828387, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 14213.023, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14212.97, "sample_time_ms": 1156.355, "learn_time_ms": 13039.271, "learn_throughput": 306.766, "synch_weights_time_ms": 15.723}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "6751e_00000", "date": "2024-08-11_19-24-45", "timestamp": 1723418685, "time_this_iter_s": 13.872071266174316, "time_total_s": 1051.2849049568176, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eada0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1051.2849049568176, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 54.25789473684211, "ram_util_percent": 83.15263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.49496433396661094, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.331948653730766, "policy_loss": -0.0065028785459362165, "vf_loss": 9.338397528128649, "vf_explained_var": -0.003314858422708259, "kl": 0.017276342197431068, "entropy": 0.6525913736492238, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7085198139072095, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.417844705228452, "policy_loss": -0.004870120987601618, "vf_loss": 9.422064268525945, "vf_explained_var": 4.951058241425368e-05, "kl": 0.006505644822080386, "entropy": 0.7330391059792231, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 29361.80804357204, "episode_reward_min": 0.0, "episode_reward_mean": 9749.831386450249, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5749.556256173684, "predator_policy": -6845.459780106166}, "policy_reward_max": {"prey_policy": 10275.29061303005, "predator_policy": 30452.140027804777}, "policy_reward_mean": {"prey_policy": 233.31072916967176, "predator_policy": 4641.604964055453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10834.093358979922, 6492.968361263639, 15547.067944845123, 14940.250617006877, 17207.54110318394, 12367.960965247627, 14142.804631155132, 3416.6755417260893, 7578.013115662643, 17920.17789747662, 5529.213739312042, 2800.170425637181, 2451.463747849115, 3705.5703058007766, 14051.031508536522, 3223.332168049351, 13074.386324088175, 4682.92947497608, 526.9132003912526, 4588.548375656472, 2579.2033684369894, 891.9904774742683, 1481.3547291446255, 2973.6091408994816, 871.187603835846, 446.6169026570569, 11982.307248854499, 775.5123223021558, 6893.701574070126, 7891.329752468009, 5153.160433168803, 13134.11890573383, 9272.216378378575, 10968.872749599146, 1840.1014319396288, 1379.2532050273367, 4419.793449271447, 29361.80804357204, 12699.20990268287, 1576.8308483544051, 778.2579657863967, 19114.24262660969, 9346.73488550814, 4500.951986364673, 7216.884052878169, 1629.047421175362, 15028.966032042794, 28762.63075034115, 13869.552689420516, 5056.966420401089, 7797.990337306488, 11878.042145713089, 13228.640900675968, 5478.424520229648, 14942.17451301918, 991.1328194421723, 18727.180417047006, 21457.358877179664, 27614.436829956612, 15160.261862797426, 5958.099082999158, 17825.06652817716, 6528.656080268489, 6527.183390193144, 3068.1794254050646, 4072.80173326078, 10230.682276068948, 4507.205804098513, 0.0, 19558.145022591983, 15817.462764256665, 16899.31190976037, 7177.966948172204, 21931.288287312567, 12933.981082136872, 17941.604597975762, 9171.432870654791, 15917.462491935763, 2759.0682193676653, 10305.479626510676, 17361.897310371853, 12818.090664873736, 9230.290364968141, 18356.913403530896, 8488.23400653549, 16538.202542984458, 11966.124032983897, 4238.666528208301, 856.2440890123275, 16456.87147457559, 7986.030842259749, 7515.10902627768, 0.0, 18225.526670431063, 16853.85728397889, 6336.273324583746, 5422.526707018848, 16021.769627830752, 6906.71932744655, 20019.54394739549], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5492.05821883308, -643.461926338782, 6832.253470426036, -2148.2687085873827, 2570.1883142752345, -2199.248900569862, 1133.8617635024157, -2594.1824072321238, 2315.54978470964, -1783.7825382920778, 3381.4169137196136, -1345.1932315196361, -405.66847150252977, -1187.2739740493535, -1382.425620269739, -1072.4661102564526, -2510.987697367637, -702.2532274984667, 340.19438182307437, -2656.9994498336146, -3930.6914217573603, -4207.310438669263, 2524.8355248083217, -2511.4697486869154, 8033.438525714824, 1846.813340338313, -2715.4753214285274, -2604.192185791667, -70.14496949654571, -1970.4813622333957, 8469.617339504737, 89.78956054581371, 6894.011088256951, -2889.318119363031, 2779.3438417606144, -4235.374076759094, 4414.669757155647, -5398.378197224941, 459.0593474069726, -3889.829370085492, 8409.314921757505, -2648.606488910819, -1409.0767052715214, -3503.61592439482, 3984.703292766297, -2102.270922666472, 819.9850322660739, 374.7509200341274, 492.24886796756965, -2376.585637155524, 3046.445268314111, -3.056372452945638, -3038.3730973620904, -884.0936476596906, 2931.4449281172283, -2729.578289277594, 3483.58409869919, -2398.2626400705853, -520.8447811340836, -1677.7338274654376, -659.2170723275076, -675.8875773452219, 6614.2202086974685, -321.47018145160473, 122.74202085589332, -3536.745361455405, -2146.606727290024, -3064.5222774906265, 2678.3173760756035, -3830.9253579142064, 5620.926905376084, 1747.9666396901682, 7855.727192851893, 1473.8213888759203, -1975.4625842766854, -1632.0171485341316, -3118.0856876756816, -2706.238476501814, 1965.7496590575033, 462.03636300078756, 5813.18983982088, -5749.556256173684, -2235.869404543433, -1382.8183190934665, 3228.7563833268428, -2505.8133037971184, 536.3765026045392, -4129.7613593825845, 1112.3225797939356, -3386.0892213649613, 1858.2006069973286, -3001.061020980133, -405.95781260274487, -3635.8073509018254, -893.3047903667467, -252.50280872040247, 5567.631098114188, -535.4921459587754, 5421.773276336599, -2519.1965075575304, 665.1785314239929, -3187.920839485927, -3411.192542983185, -1030.1499244002673, 794.4974929854504, -1113.4839739385243, 4282.895389383577, -1568.1022452445332, 636.2310822253046, -3349.9500620206477, 1269.411660625939, -1287.7354577430333, 7464.316490189997, -246.30496124784867, 5724.481860005021, -759.7340124195814, -544.8804382294384, -952.963171593203, 2999.7054759727894, -719.7034460935407, -231.62903758150023, -2180.6147784393725, 1577.929447536376, -599.1097655124112, 3723.19797230178, -597.0295787594549, 4363.893491478134, -1983.4188346344556, 6380.085635552004, -3353.4050694411912, 2425.7917919171296, -3721.198263757622, 4951.225060701452, -2232.2450128077353, -2343.8759758621745, -4154.966217621612, 4338.6476985894415, 2184.4884161237737, -1741.1323508173514, -1892.5241349399507, -141.00471696484723, -1820.2737411839607, -631.9571641262645, -2169.734776722432, 2374.204029489576, 1415.7255348384704, -495.94131073458817, -400.47953317861266, 336.6117505145886, -3159.5594804610837, 7055.82438836726, -267.7077608563384, 1418.1034398301513, -742.8053309272138, -1739.4657852572775, -3048.490640638854, 5062.629970791443, -1417.4360631071, 1018.3416208198697, -2219.346376460134, 6740.813239557313, -731.4951156029251, 5466.510480389809, -1018.6282311138988, 7488.68754707571, -1902.646216366074, 302.77721754508184, -1130.6698343579797, -3110.781245422452, -2504.3852272313334, -43.181680910859015, -589.3553602803884, 6815.1275552412435, -1482.8911689101146, 3001.980515577665, -817.699803963014, 943.3490982927885, -2116.8559195815824, 2918.488566900048, -200.40618085469126, 3913.3414021560134, 338.2671067788774, 6941.869064220052, -1524.2920510648028, 2170.2912520773925, -3859.36840956089, 10275.29061303005, -491.08604925210847, 5683.41226831879, -815.3827622384703, 764.5307644435627, -1679.9765091411218, 403.5264563134341, -4200.091292895776, 3366.154473201723, -699.2227371956287, 1978.947893392738, -3319.3801352296236, -322.2185741393598, -1849.1026125723538], "policy_predator_policy_reward": [7746.114311851599, -1760.617245365964, 1827.3242021723597, -18.340602747379975, 13003.706958681938, 2172.4215724578353, 15961.22210931425, 439.3491514223261, 13343.890336904418, 3331.883519861941, 9001.586755263488, 1330.1505277841477, 14733.004406881333, 1002.7426698256908, 3056.84518650011, 2814.722085752168, 8638.59117626373, 2152.6628642650107, 18836.70339092941, 1400.2795745577555, 6583.130264335222, 7084.085335403429, 3255.5561074146235, -468.7514578988417, -6845.459780106166, -583.328338097871, 6376.9001213194815, 2648.3376917014807, 14371.376639804454, 1720.2812004620414, -2897.181157179522, -2438.893574821686, 4573.40526003124, 4496.288095162937, 2549.859724128732, 3589.099985845832, 1681.120832833322, -170.49919237277777, 6458.360687769998, 1560.9577105650033, 2668.3410045017813, -5849.846068911466, 2534.7227076446893, 3269.960399495923, -602.5848591605148, 201.50721820531507, 2297.4472144449423, -518.5740258456594, 687.5136581319006, 2068.0107148918983, -4224.992042165819, 1628.2200489617076, 11157.701888046966, 4747.072105829339, -1610.1228236518132, 2183.7685071143337, 7031.456155241605, -1223.0760398000787, 5767.877220204845, 4322.031140862687, 4853.266070453861, 1634.9990123876728, 8256.202751839981, -1414.8338733520313, 5733.112269223144, 6953.107449754957, 12161.090637239531, 4018.911117140265, 1017.1000324697509, 1975.6093813084815, -1518.2303758886983, -4471.409964150221, -1102.624961138079, -3807.1301713182315, 30452.140027804777, 2517.1477485780333, 14074.946206755438, 4448.5878601049135, -1255.4420299161889, 404.48685621231147, -534.4926882250612, 1249.1170703642576, 19319.36732641771, 3413.563023828885, 6220.273289051463, 2403.5185169269607, 2707.530705964239, 5386.806137178479, 7012.688602091041, 2477.962092358144, 90.09611580617235, 2681.8117193519947, 14111.480898326761, 4959.250297220599, 28286.435109685575, 1622.0032397427271, 5714.4624083808085, 3122.9513288842572, 183.20105342799178, 1971.188598194026, 5751.979138164469, 4568.753507203953, 16058.204112084315, 261.180501012309, 13338.269965650634, 209.35741597840354, -999.2284358870302, 3762.8598119776307, 15204.165797595046, 2451.7276952194866, 156.76910649752912, 852.6875100617398, 11034.426979025735, 474.74190907917654, 12008.045943358811, 4484.565086235432, 26645.85768544422, 2466.4227543350394, 14773.996744203547, -1893.7369112853648, 6721.004303367988, 1649.338595652039, 13526.53835609385, 3319.708490059354, 3088.19605692098, 314.29162980519357, 2068.5604086699313, 2078.1483246795096, 1713.661021711169, -1672.1621624169356, 5368.356285828525, -0.1480807272520508, 4949.393713160677, 2562.3085150145516, 6461.039166804335, 4545.008830777965, -1396.7151293660202, -5126.420985347189, 21761.811804236084, 1429.9897041132076, 15611.937936759286, 2166.803285646186, 16902.179325539695, 2798.8245250693763, 3509.5605447516796, -121.52316090751168, 21588.655628959594, 1239.053502266177, 13205.156857495766, 2551.7719545876234, 12945.588181255336, -1792.100210790474, 7053.583625973213, 1442.5511357786493, 17666.58332645883, 3038.8355913730666, -4125.875965423061, 3239.7502771063855, 9907.518779941212, 1598.9656022097276, 8254.637240438364, 3097.9419459791156, 9204.812796162267, -834.604380564464, 457.12535600456266, 3187.1236782539436, 14305.72586477438, 4879.080155569425, 7604.570174167728, 6498.8303050215745, 14351.359408021677, 2819.380176154017, -134.98145667399405, 6768.8691033267505, 1907.836364541753, 146.54945205189432, -710.4020942885934, 2740.153004589707, 15072.864369195493, -1334.0752806652079, 588.2745953826537, 3146.1477379422013, 3772.9401872627086, -1675.4081741402883, 272.18560080547843, 1416.8915566780186, 6087.971559474371, 2353.350547178671, 8688.259673764911, 3297.5681041336816, 5030.6699867154775, 2221.049082565827, 6700.905379379376, 2518.186164221809, 10122.683629145204, 3232.1542626794103, 3420.2276814878146, 4826.923887795607, 17910.1338139673, 4280.731320139915]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7135577742577164, "mean_inference_ms": 1.5419325444339196, "mean_action_processing_ms": 0.3034561285186236, "mean_env_wait_ms": 0.1380087468957909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00612485408782959, "StateBufferConnector_ms": 0.0034112930297851562, "ViewRequirementAgentConnector_ms": 0.1333998441696167}, "num_episodes": 18, "episode_return_max": 29361.80804357204, "episode_return_min": 0.0, "episode_return_mean": 9749.831386450249, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.08518689143983, "num_env_steps_trained_throughput_per_sec": 283.08518689143983, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 14083.381, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14083.328, "sample_time_ms": 1174.132, "learn_time_ms": 12892.334, "learn_throughput": 310.262, "synch_weights_time_ms": 15.428}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "6751e_00000", "date": "2024-08-11_19-24-59", "timestamp": 1723418699, "time_this_iter_s": 14.19990086555481, "time_total_s": 1065.4848058223724, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaa4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1065.4848058223724, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 55.295, "ram_util_percent": 83.25000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5029521712865779, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.145906573502476, "policy_loss": -0.006090688071258011, "vf_loss": 9.151969182049786, "vf_explained_var": -0.00211965697152274, "kl": 0.008988477063300127, "entropy": 0.7002821725512308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6265454249959144, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.283643408174868, "policy_loss": -0.00538609598482412, "vf_loss": 9.288266791994609, "vf_explained_var": -7.205819957470768e-05, "kl": 0.007626967596843405, "entropy": 0.7674589158681334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 29583.865003356426, "episode_reward_min": 0.0, "episode_reward_mean": 9933.37595074232, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5749.556256173684, "predator_policy": -5849.846068911466}, "policy_reward_max": {"prey_policy": 10275.29061303005, "predator_policy": 30452.140027804777}, "policy_reward_mean": {"prey_policy": 357.87596703769776, "predator_policy": 4608.812008333463}, "custom_metrics": {}, "hist_stats": {"episode_reward": [526.9132003912526, 4588.548375656472, 2579.2033684369894, 891.9904774742683, 1481.3547291446255, 2973.6091408994816, 871.187603835846, 446.6169026570569, 11982.307248854499, 775.5123223021558, 6893.701574070126, 7891.329752468009, 5153.160433168803, 13134.11890573383, 9272.216378378575, 10968.872749599146, 1840.1014319396288, 1379.2532050273367, 4419.793449271447, 29361.80804357204, 12699.20990268287, 1576.8308483544051, 778.2579657863967, 19114.24262660969, 9346.73488550814, 4500.951986364673, 7216.884052878169, 1629.047421175362, 15028.966032042794, 28762.63075034115, 13869.552689420516, 5056.966420401089, 7797.990337306488, 11878.042145713089, 13228.640900675968, 5478.424520229648, 14942.17451301918, 991.1328194421723, 18727.180417047006, 21457.358877179664, 27614.436829956612, 15160.261862797426, 5958.099082999158, 17825.06652817716, 6528.656080268489, 6527.183390193144, 3068.1794254050646, 4072.80173326078, 10230.682276068948, 4507.205804098513, 0.0, 19558.145022591983, 15817.462764256665, 16899.31190976037, 7177.966948172204, 21931.288287312567, 12933.981082136872, 17941.604597975762, 9171.432870654791, 15917.462491935763, 2759.0682193676653, 10305.479626510676, 17361.897310371853, 12818.090664873736, 9230.290364968141, 18356.913403530896, 8488.23400653549, 16538.202542984458, 11966.124032983897, 4238.666528208301, 856.2440890123275, 16456.87147457559, 7986.030842259749, 7515.10902627768, 0.0, 18225.526670431063, 16853.85728397889, 6336.273324583746, 5422.526707018848, 16021.769627830752, 6906.71932744655, 20019.54394739549, 6924.323896551014, 7626.805998417995, 12417.348344959217, 15212.358918098764, 2260.4319769732274, 3001.177863472239, 15767.267868435389, 16840.373699915577, 29583.865003356426, 9915.199832056196, 13905.694872108284, 1399.2080632794339, 9154.258531083322, 1539.679472206709, 10234.377576138098, 6650.050834052323, 21954.4182483938, 3933.2666605059744], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [4414.669757155647, -5398.378197224941, 459.0593474069726, -3889.829370085492, 8409.314921757505, -2648.606488910819, -1409.0767052715214, -3503.61592439482, 3984.703292766297, -2102.270922666472, 819.9850322660739, 374.7509200341274, 492.24886796756965, -2376.585637155524, 3046.445268314111, -3.056372452945638, -3038.3730973620904, -884.0936476596906, 2931.4449281172283, -2729.578289277594, 3483.58409869919, -2398.2626400705853, -520.8447811340836, -1677.7338274654376, -659.2170723275076, -675.8875773452219, 6614.2202086974685, -321.47018145160473, 122.74202085589332, -3536.745361455405, -2146.606727290024, -3064.5222774906265, 2678.3173760756035, -3830.9253579142064, 5620.926905376084, 1747.9666396901682, 7855.727192851893, 1473.8213888759203, -1975.4625842766854, -1632.0171485341316, -3118.0856876756816, -2706.238476501814, 1965.7496590575033, 462.03636300078756, 5813.18983982088, -5749.556256173684, -2235.869404543433, -1382.8183190934665, 3228.7563833268428, -2505.8133037971184, 536.3765026045392, -4129.7613593825845, 1112.3225797939356, -3386.0892213649613, 1858.2006069973286, -3001.061020980133, -405.95781260274487, -3635.8073509018254, -893.3047903667467, -252.50280872040247, 5567.631098114188, -535.4921459587754, 5421.773276336599, -2519.1965075575304, 665.1785314239929, -3187.920839485927, -3411.192542983185, -1030.1499244002673, 794.4974929854504, -1113.4839739385243, 4282.895389383577, -1568.1022452445332, 636.2310822253046, -3349.9500620206477, 1269.411660625939, -1287.7354577430333, 7464.316490189997, -246.30496124784867, 5724.481860005021, -759.7340124195814, -544.8804382294384, -952.963171593203, 2999.7054759727894, -719.7034460935407, -231.62903758150023, -2180.6147784393725, 1577.929447536376, -599.1097655124112, 3723.19797230178, -597.0295787594549, 4363.893491478134, -1983.4188346344556, 6380.085635552004, -3353.4050694411912, 2425.7917919171296, -3721.198263757622, 4951.225060701452, -2232.2450128077353, -2343.8759758621745, -4154.966217621612, 4338.6476985894415, 2184.4884161237737, -1741.1323508173514, -1892.5241349399507, -141.00471696484723, -1820.2737411839607, -631.9571641262645, -2169.734776722432, 2374.204029489576, 1415.7255348384704, -495.94131073458817, -400.47953317861266, 336.6117505145886, -3159.5594804610837, 7055.82438836726, -267.7077608563384, 1418.1034398301513, -742.8053309272138, -1739.4657852572775, -3048.490640638854, 5062.629970791443, -1417.4360631071, 1018.3416208198697, -2219.346376460134, 6740.813239557313, -731.4951156029251, 5466.510480389809, -1018.6282311138988, 7488.68754707571, -1902.646216366074, 302.77721754508184, -1130.6698343579797, -3110.781245422452, -2504.3852272313334, -43.181680910859015, -589.3553602803884, 6815.1275552412435, -1482.8911689101146, 3001.980515577665, -817.699803963014, 943.3490982927885, -2116.8559195815824, 2918.488566900048, -200.40618085469126, 3913.3414021560134, 338.2671067788774, 6941.869064220052, -1524.2920510648028, 2170.2912520773925, -3859.36840956089, 10275.29061303005, -491.08604925210847, 5683.41226831879, -815.3827622384703, 764.5307644435627, -1679.9765091411218, 403.5264563134341, -4200.091292895776, 3366.154473201723, -699.2227371956287, 1978.947893392738, -3319.3801352296236, -322.2185741393598, -1849.1026125723538, 3048.422122963203, -1817.64085233497, 2043.4815598282662, -496.73248876279905, 4343.401381743317, -1021.1043003386063, 7060.73825152114, -1724.0790215199177, 744.2968483752015, -1935.3194387815781, 3398.8579430170425, -2356.7127020517355, 7116.250872911934, -448.3092258191842, -867.1654615126507, -1463.6878325538892, -1088.6263829888655, -1307.9098023241845, 5292.077000902744, -1537.9440282270284, 6085.9925698370025, -1127.1428482232582, 1560.6713712342594, -2644.7360410034403, 4866.382801915375, -353.56685906075546, 5573.284399086867, -1999.5915407890247, 637.7202110006336, -882.598059165617, 1406.6508060252158, -2104.597309473951, 1938.8035174446973, -587.3943187221832, 5933.510209658376, -3435.9336194911957], "policy_predator_policy_reward": [1681.120832833322, -170.49919237277777, 6458.360687769998, 1560.9577105650033, 2668.3410045017813, -5849.846068911466, 2534.7227076446893, 3269.960399495923, -602.5848591605148, 201.50721820531507, 2297.4472144449423, -518.5740258456594, 687.5136581319006, 2068.0107148918983, -4224.992042165819, 1628.2200489617076, 11157.701888046966, 4747.072105829339, -1610.1228236518132, 2183.7685071143337, 7031.456155241605, -1223.0760398000787, 5767.877220204845, 4322.031140862687, 4853.266070453861, 1634.9990123876728, 8256.202751839981, -1414.8338733520313, 5733.112269223144, 6953.107449754957, 12161.090637239531, 4018.911117140265, 1017.1000324697509, 1975.6093813084815, -1518.2303758886983, -4471.409964150221, -1102.624961138079, -3807.1301713182315, 30452.140027804777, 2517.1477485780333, 14074.946206755438, 4448.5878601049135, -1255.4420299161889, 404.48685621231147, -534.4926882250612, 1249.1170703642576, 19319.36732641771, 3413.563023828885, 6220.273289051463, 2403.5185169269607, 2707.530705964239, 5386.806137178479, 7012.688602091041, 2477.962092358144, 90.09611580617235, 2681.8117193519947, 14111.480898326761, 4959.250297220599, 28286.435109685575, 1622.0032397427271, 5714.4624083808085, 3122.9513288842572, 183.20105342799178, 1971.188598194026, 5751.979138164469, 4568.753507203953, 16058.204112084315, 261.180501012309, 13338.269965650634, 209.35741597840354, -999.2284358870302, 3762.8598119776307, 15204.165797595046, 2451.7276952194866, 156.76910649752912, 852.6875100617398, 11034.426979025735, 474.74190907917654, 12008.045943358811, 4484.565086235432, 26645.85768544422, 2466.4227543350394, 14773.996744203547, -1893.7369112853648, 6721.004303367988, 1649.338595652039, 13526.53835609385, 3319.708490059354, 3088.19605692098, 314.29162980519357, 2068.5604086699313, 2078.1483246795096, 1713.661021711169, -1672.1621624169356, 5368.356285828525, -0.1480807272520508, 4949.393713160677, 2562.3085150145516, 6461.039166804335, 4545.008830777965, -1396.7151293660202, -5126.420985347189, 21761.811804236084, 1429.9897041132076, 15611.937936759286, 2166.803285646186, 16902.179325539695, 2798.8245250693763, 3509.5605447516796, -121.52316090751168, 21588.655628959594, 1239.053502266177, 13205.156857495766, 2551.7719545876234, 12945.588181255336, -1792.100210790474, 7053.583625973213, 1442.5511357786493, 17666.58332645883, 3038.8355913730666, -4125.875965423061, 3239.7502771063855, 9907.518779941212, 1598.9656022097276, 8254.637240438364, 3097.9419459791156, 9204.812796162267, -834.604380564464, 457.12535600456266, 3187.1236782539436, 14305.72586477438, 4879.080155569425, 7604.570174167728, 6498.8303050215745, 14351.359408021677, 2819.380176154017, -134.98145667399405, 6768.8691033267505, 1907.836364541753, 146.54945205189432, -710.4020942885934, 2740.153004589707, 15072.864369195493, -1334.0752806652079, 588.2745953826537, 3146.1477379422013, 3772.9401872627086, -1675.4081741402883, 272.18560080547843, 1416.8915566780186, 6087.971559474371, 2353.350547178671, 8688.259673764911, 3297.5681041336816, 5030.6699867154775, 2221.049082565827, 6700.905379379376, 2518.186164221809, 10122.683629145204, 3232.1542626794103, 3420.2276814878146, 4826.923887795607, 17910.1338139673, 4280.731320139915, 5101.43056635398, 592.1120595688053, 5672.832975100068, 407.2239522524576, 10329.382915859715, -1234.3316523052306, 8491.135958506507, 1384.5637295909607, 648.992356992177, 2802.462210387425, 692.9724557342811, 1266.0601667726526, 10712.95638498547, -1613.6301636427968, 16189.740205793336, 2981.486788188755, 29690.982956927255, 2289.4182317422255, 3770.3797485312257, 2390.687110849257, 8590.706162082577, 356.1389884119551, 826.0079461388094, 1657.2647869098046, 3479.1788352907347, 1162.2637529379754, -2596.06911216179, 562.0557260706598, 7776.606194005799, 2702.649230297281, 6718.075239000404, 629.9220985006694, 14317.061056665496, 6285.947993005831, 3553.6755226595415, -2117.98545232076]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7132460563545624, "mean_inference_ms": 1.5414849968424829, "mean_action_processing_ms": 0.30337847955185804, "mean_env_wait_ms": 0.13795934968466453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005791306495666504, "StateBufferConnector_ms": 0.0033960342407226562, "ViewRequirementAgentConnector_ms": 0.1297616958618164}, "num_episodes": 18, "episode_return_max": 29583.865003356426, "episode_return_min": 0.0, "episode_return_mean": 9933.37595074232, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.48712918883416, "num_env_steps_trained_throughput_per_sec": 286.48712918883416, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 14059.697, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14059.644, "sample_time_ms": 1176.077, "learn_time_ms": 12866.344, "learn_throughput": 310.889, "synch_weights_time_ms": 15.788}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "6751e_00000", "date": "2024-08-11_19-25-13", "timestamp": 1723418713, "time_this_iter_s": 14.006943941116333, "time_total_s": 1079.4917497634888, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eaab0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1079.4917497634888, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 54.225, "ram_util_percent": 83.32000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5034222891091039, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.23078246848293, "policy_loss": -0.004293555933144436, "vf_loss": 9.235049292145582, "vf_explained_var": -0.0014688074588775635, "kl": 0.008553598014769941, "entropy": 0.6908909806183406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.71009258072843, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.236078988938104, "policy_loss": -0.006880847113970766, "vf_loss": 9.242013451914309, "vf_explained_var": -2.9865364549021242e-05, "kl": 0.00946393278092726, "entropy": 0.7786068549231877, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 29583.865003356426, "episode_reward_min": 0.0, "episode_reward_mean": 10970.313031220221, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5749.556256173684, "predator_policy": -5126.420985347189}, "policy_reward_max": {"prey_policy": 10705.960475171441, "predator_policy": 29690.982956927255}, "policy_reward_mean": {"prey_policy": 555.7934204702059, "predator_policy": 4929.363095139904}, "custom_metrics": {}, "hist_stats": {"episode_reward": [778.2579657863967, 19114.24262660969, 9346.73488550814, 4500.951986364673, 7216.884052878169, 1629.047421175362, 15028.966032042794, 28762.63075034115, 13869.552689420516, 5056.966420401089, 7797.990337306488, 11878.042145713089, 13228.640900675968, 5478.424520229648, 14942.17451301918, 991.1328194421723, 18727.180417047006, 21457.358877179664, 27614.436829956612, 15160.261862797426, 5958.099082999158, 17825.06652817716, 6528.656080268489, 6527.183390193144, 3068.1794254050646, 4072.80173326078, 10230.682276068948, 4507.205804098513, 0.0, 19558.145022591983, 15817.462764256665, 16899.31190976037, 7177.966948172204, 21931.288287312567, 12933.981082136872, 17941.604597975762, 9171.432870654791, 15917.462491935763, 2759.0682193676653, 10305.479626510676, 17361.897310371853, 12818.090664873736, 9230.290364968141, 18356.913403530896, 8488.23400653549, 16538.202542984458, 11966.124032983897, 4238.666528208301, 856.2440890123275, 16456.87147457559, 7986.030842259749, 7515.10902627768, 0.0, 18225.526670431063, 16853.85728397889, 6336.273324583746, 5422.526707018848, 16021.769627830752, 6906.71932744655, 20019.54394739549, 6924.323896551014, 7626.805998417995, 12417.348344959217, 15212.358918098764, 2260.4319769732274, 3001.177863472239, 15767.267868435389, 16840.373699915577, 29583.865003356426, 9915.199832056196, 13905.694872108284, 1399.2080632794339, 9154.258531083322, 1539.679472206709, 10234.377576138098, 6650.050834052323, 21954.4182483938, 3933.2666605059744, 11711.410236746922, 21378.93744417719, 888.4574357994644, 21908.242301112175, 1812.7943143210755, 17672.891828899414, 10394.44935679533, 19198.064642077454, 4712.540221587321, 11054.045307300517, 11900.003178651838, 20132.396974446256, 11173.055858328407, 0.0, 18550.704352252847, 4769.169247151606, 0.0, 9026.298802781073, 12965.167021678211, 21812.280086291616, 4340.439481310059, 0.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5813.18983982088, -5749.556256173684, -2235.869404543433, -1382.8183190934665, 3228.7563833268428, -2505.8133037971184, 536.3765026045392, -4129.7613593825845, 1112.3225797939356, -3386.0892213649613, 1858.2006069973286, -3001.061020980133, -405.95781260274487, -3635.8073509018254, -893.3047903667467, -252.50280872040247, 5567.631098114188, -535.4921459587754, 5421.773276336599, -2519.1965075575304, 665.1785314239929, -3187.920839485927, -3411.192542983185, -1030.1499244002673, 794.4974929854504, -1113.4839739385243, 4282.895389383577, -1568.1022452445332, 636.2310822253046, -3349.9500620206477, 1269.411660625939, -1287.7354577430333, 7464.316490189997, -246.30496124784867, 5724.481860005021, -759.7340124195814, -544.8804382294384, -952.963171593203, 2999.7054759727894, -719.7034460935407, -231.62903758150023, -2180.6147784393725, 1577.929447536376, -599.1097655124112, 3723.19797230178, -597.0295787594549, 4363.893491478134, -1983.4188346344556, 6380.085635552004, -3353.4050694411912, 2425.7917919171296, -3721.198263757622, 4951.225060701452, -2232.2450128077353, -2343.8759758621745, -4154.966217621612, 4338.6476985894415, 2184.4884161237737, -1741.1323508173514, -1892.5241349399507, -141.00471696484723, -1820.2737411839607, -631.9571641262645, -2169.734776722432, 2374.204029489576, 1415.7255348384704, -495.94131073458817, -400.47953317861266, 336.6117505145886, -3159.5594804610837, 7055.82438836726, -267.7077608563384, 1418.1034398301513, -742.8053309272138, -1739.4657852572775, -3048.490640638854, 5062.629970791443, -1417.4360631071, 1018.3416208198697, -2219.346376460134, 6740.813239557313, -731.4951156029251, 5466.510480389809, -1018.6282311138988, 7488.68754707571, -1902.646216366074, 302.77721754508184, -1130.6698343579797, -3110.781245422452, -2504.3852272313334, -43.181680910859015, -589.3553602803884, 6815.1275552412435, -1482.8911689101146, 3001.980515577665, -817.699803963014, 943.3490982927885, -2116.8559195815824, 2918.488566900048, -200.40618085469126, 3913.3414021560134, 338.2671067788774, 6941.869064220052, -1524.2920510648028, 2170.2912520773925, -3859.36840956089, 10275.29061303005, -491.08604925210847, 5683.41226831879, -815.3827622384703, 764.5307644435627, -1679.9765091411218, 403.5264563134341, -4200.091292895776, 3366.154473201723, -699.2227371956287, 1978.947893392738, -3319.3801352296236, -322.2185741393598, -1849.1026125723538, 3048.422122963203, -1817.64085233497, 2043.4815598282662, -496.73248876279905, 4343.401381743317, -1021.1043003386063, 7060.73825152114, -1724.0790215199177, 744.2968483752015, -1935.3194387815781, 3398.8579430170425, -2356.7127020517355, 7116.250872911934, -448.3092258191842, -867.1654615126507, -1463.6878325538892, -1088.6263829888655, -1307.9098023241845, 5292.077000902744, -1537.9440282270284, 6085.9925698370025, -1127.1428482232582, 1560.6713712342594, -2644.7360410034403, 4866.382801915375, -353.56685906075546, 5573.284399086867, -1999.5915407890247, 637.7202110006336, -882.598059165617, 1406.6508060252158, -2104.597309473951, 1938.8035174446973, -587.3943187221832, 5933.510209658376, -3435.9336194911957, 6259.212212119028, -1251.686392671222, 31.245333323884424, -1218.302739235151, 3246.269943653189, -946.929830021209, -1414.54201577922, -1228.3233636600203, 3006.311141336422, -2983.931082616572, 9154.433484526167, -703.6216389233446, 2409.4250652235764, -1372.280883871371, 1736.2779443116935, -1614.4854100090736, 919.9679211653341, -3863.938935265654, 2688.1033109728082, -797.340221048045, -3286.2647993560513, -1092.0933352473844, 5489.192539018602, -446.94736304481313, 1547.667197589126, -1524.1520609301717, 2951.435806032643, -2135.219615498111, 3435.2464494821234, -548.5306876907063, 1831.0307070676981, -867.7277187292157, 5724.147784654533, -2816.7407454577765, 6579.889066059453, -1749.5510809049833, 10705.960475171441, -1436.5500329769825, 9620.378781724548, -1022.0847460218125, 869.0487274231857, -920.5787270944985, -1160.728521119498, -1508.971421609851], "policy_predator_policy_reward": [-534.4926882250612, 1249.1170703642576, 19319.36732641771, 3413.563023828885, 6220.273289051463, 2403.5185169269607, 2707.530705964239, 5386.806137178479, 7012.688602091041, 2477.962092358144, 90.09611580617235, 2681.8117193519947, 14111.480898326761, 4959.250297220599, 28286.435109685575, 1622.0032397427271, 5714.4624083808085, 3122.9513288842572, 183.20105342799178, 1971.188598194026, 5751.979138164469, 4568.753507203953, 16058.204112084315, 261.180501012309, 13338.269965650634, 209.35741597840354, -999.2284358870302, 3762.8598119776307, 15204.165797595046, 2451.7276952194866, 156.76910649752912, 852.6875100617398, 11034.426979025735, 474.74190907917654, 12008.045943358811, 4484.565086235432, 26645.85768544422, 2466.4227543350394, 14773.996744203547, -1893.7369112853648, 6721.004303367988, 1649.338595652039, 13526.53835609385, 3319.708490059354, 3088.19605692098, 314.29162980519357, 2068.5604086699313, 2078.1483246795096, 1713.661021711169, -1672.1621624169356, 5368.356285828525, -0.1480807272520508, 4949.393713160677, 2562.3085150145516, 6461.039166804335, 4545.008830777965, -1396.7151293660202, -5126.420985347189, 21761.811804236084, 1429.9897041132076, 15611.937936759286, 2166.803285646186, 16902.179325539695, 2798.8245250693763, 3509.5605447516796, -121.52316090751168, 21588.655628959594, 1239.053502266177, 13205.156857495766, 2551.7719545876234, 12945.588181255336, -1792.100210790474, 7053.583625973213, 1442.5511357786493, 17666.58332645883, 3038.8355913730666, -4125.875965423061, 3239.7502771063855, 9907.518779941212, 1598.9656022097276, 8254.637240438364, 3097.9419459791156, 9204.812796162267, -834.604380564464, 457.12535600456266, 3187.1236782539436, 14305.72586477438, 4879.080155569425, 7604.570174167728, 6498.8303050215745, 14351.359408021677, 2819.380176154017, -134.98145667399405, 6768.8691033267505, 1907.836364541753, 146.54945205189432, -710.4020942885934, 2740.153004589707, 15072.864369195493, -1334.0752806652079, 588.2745953826537, 3146.1477379422013, 3772.9401872627086, -1675.4081741402883, 272.18560080547843, 1416.8915566780186, 6087.971559474371, 2353.350547178671, 8688.259673764911, 3297.5681041336816, 5030.6699867154775, 2221.049082565827, 6700.905379379376, 2518.186164221809, 10122.683629145204, 3232.1542626794103, 3420.2276814878146, 4826.923887795607, 17910.1338139673, 4280.731320139915, 5101.43056635398, 592.1120595688053, 5672.832975100068, 407.2239522524576, 10329.382915859715, -1234.3316523052306, 8491.135958506507, 1384.5637295909607, 648.992356992177, 2802.462210387425, 692.9724557342811, 1266.0601667726526, 10712.95638498547, -1613.6301636427968, 16189.740205793336, 2981.486788188755, 29690.982956927255, 2289.4182317422255, 3770.3797485312257, 2390.687110849257, 8590.706162082577, 356.1389884119551, 826.0079461388094, 1657.2647869098046, 3479.1788352907347, 1162.2637529379754, -2596.06911216179, 562.0557260706598, 7776.606194005799, 2702.649230297281, 6718.075239000404, 629.9220985006694, 14317.061056665496, 6285.947993005831, 3553.6755226595415, -2117.98545232076, 2090.717702937736, 4613.166714361351, 20877.798910462086, 1688.1959396263755, 472.08646173805755, -1882.969139570574, 20510.442529647757, 4040.665150903649, 59.82243645711576, 1730.5918191441094, 9739.171374722495, -517.0913914259067, 8466.393182348493, 890.911993094646, 15550.360031276621, 3525.9120764982117, 2833.721801176826, 4822.789434510807, 9422.298732577516, -259.0165152017586, 12530.502266865937, 3747.8590463893324, 12493.570762338164, 2596.5810361342938, 10071.851857874088, 1077.6888637953637, -890.6114804898485, 74.39528995532427, 11655.768696140483, 4008.219894320939, 4779.625776861036, -973.7595180479179, -838.6535339403804, -2068.75350525637, 3258.6132886167466, 937.3475290098665, 998.2405261156218, 2697.5160533681146, 6323.55146737192, 6890.43458321682, 4097.065677620413, 294.90380336096047, 2135.635649799004, 534.0642929303408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7120153707025113, "mean_inference_ms": 1.537842383747684, "mean_action_processing_ms": 0.30274305164094956, "mean_env_wait_ms": 0.1374385017085585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004960298538208008, "StateBufferConnector_ms": 0.0031970739364624023, "ViewRequirementAgentConnector_ms": 0.10698270797729492}, "num_episodes": 22, "episode_return_max": 29583.865003356426, "episode_return_min": 0.0, "episode_return_mean": 10970.313031220221, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.7323123011325, "num_env_steps_trained_throughput_per_sec": 294.7323123011325, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 13989.366, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13989.312, "sample_time_ms": 1171.508, "learn_time_ms": 12799.918, "learn_throughput": 312.502, "synch_weights_time_ms": 16.608}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "6751e_00000", "date": "2024-08-11_19-25-27", "timestamp": 1723418727, "time_this_iter_s": 13.610490083694458, "time_total_s": 1093.1022398471832, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1093.1022398471832, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 51.69, "ram_util_percent": 82.70000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4812104958784643, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.148471824706547, "policy_loss": -0.004687092383145773, "vf_loss": 9.153122028471932, "vf_explained_var": -0.001516406151352736, "kl": 0.011804047366084416, "entropy": 0.7430068646789227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6368184847885339, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.441746985218513, "policy_loss": -0.005677357897847378, "vf_loss": 9.446490011265668, "vf_explained_var": 4.56493682962246e-05, "kl": 0.009343097041575089, "entropy": 0.7643696119545629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 37323.65661094396, "episode_reward_min": 0.0, "episode_reward_mean": 11491.161924796663, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4430.96623180069, "predator_policy": -5126.420985347189}, "policy_reward_max": {"prey_policy": 10705.960475171441, "predator_policy": 38235.15384379868}, "policy_reward_mean": {"prey_policy": 671.5558458962929, "predator_policy": 5074.025116502036}, "custom_metrics": {}, "hist_stats": {"episode_reward": [27614.436829956612, 15160.261862797426, 5958.099082999158, 17825.06652817716, 6528.656080268489, 6527.183390193144, 3068.1794254050646, 4072.80173326078, 10230.682276068948, 4507.205804098513, 0.0, 19558.145022591983, 15817.462764256665, 16899.31190976037, 7177.966948172204, 21931.288287312567, 12933.981082136872, 17941.604597975762, 9171.432870654791, 15917.462491935763, 2759.0682193676653, 10305.479626510676, 17361.897310371853, 12818.090664873736, 9230.290364968141, 18356.913403530896, 8488.23400653549, 16538.202542984458, 11966.124032983897, 4238.666528208301, 856.2440890123275, 16456.87147457559, 7986.030842259749, 7515.10902627768, 0.0, 18225.526670431063, 16853.85728397889, 6336.273324583746, 5422.526707018848, 16021.769627830752, 6906.71932744655, 20019.54394739549, 6924.323896551014, 7626.805998417995, 12417.348344959217, 15212.358918098764, 2260.4319769732274, 3001.177863472239, 15767.267868435389, 16840.373699915577, 29583.865003356426, 9915.199832056196, 13905.694872108284, 1399.2080632794339, 9154.258531083322, 1539.679472206709, 10234.377576138098, 6650.050834052323, 21954.4182483938, 3933.2666605059744, 11711.410236746922, 21378.93744417719, 888.4574357994644, 21908.242301112175, 1812.7943143210755, 17672.891828899414, 10394.44935679533, 19198.064642077454, 4712.540221587321, 11054.045307300517, 11900.003178651838, 20132.396974446256, 11173.055858328407, 0.0, 18550.704352252847, 4769.169247151606, 0.0, 9026.298802781073, 12965.167021678211, 21812.280086291616, 4340.439481310059, 0.0, 15034.825973868314, 17703.036535385203, 20325.064263268898, 12860.825906807964, 4446.641044305891, 37323.65661094396, 17491.906554602545, 17351.816509804772, 34730.337489216945, 8568.140973105084, 4725.291723616667, 7294.437729066465, 6839.457477622431, 18210.7486565585, 1586.7082593445907, 3057.993685288893, 7172.753557078505, 17166.425768899644], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-544.8804382294384, -952.963171593203, 2999.7054759727894, -719.7034460935407, -231.62903758150023, -2180.6147784393725, 1577.929447536376, -599.1097655124112, 3723.19797230178, -597.0295787594549, 4363.893491478134, -1983.4188346344556, 6380.085635552004, -3353.4050694411912, 2425.7917919171296, -3721.198263757622, 4951.225060701452, -2232.2450128077353, -2343.8759758621745, -4154.966217621612, 4338.6476985894415, 2184.4884161237737, -1741.1323508173514, -1892.5241349399507, -141.00471696484723, -1820.2737411839607, -631.9571641262645, -2169.734776722432, 2374.204029489576, 1415.7255348384704, -495.94131073458817, -400.47953317861266, 336.6117505145886, -3159.5594804610837, 7055.82438836726, -267.7077608563384, 1418.1034398301513, -742.8053309272138, -1739.4657852572775, -3048.490640638854, 5062.629970791443, -1417.4360631071, 1018.3416208198697, -2219.346376460134, 6740.813239557313, -731.4951156029251, 5466.510480389809, -1018.6282311138988, 7488.68754707571, -1902.646216366074, 302.77721754508184, -1130.6698343579797, -3110.781245422452, -2504.3852272313334, -43.181680910859015, -589.3553602803884, 6815.1275552412435, -1482.8911689101146, 3001.980515577665, -817.699803963014, 943.3490982927885, -2116.8559195815824, 2918.488566900048, -200.40618085469126, 3913.3414021560134, 338.2671067788774, 6941.869064220052, -1524.2920510648028, 2170.2912520773925, -3859.36840956089, 10275.29061303005, -491.08604925210847, 5683.41226831879, -815.3827622384703, 764.5307644435627, -1679.9765091411218, 403.5264563134341, -4200.091292895776, 3366.154473201723, -699.2227371956287, 1978.947893392738, -3319.3801352296236, -322.2185741393598, -1849.1026125723538, 3048.422122963203, -1817.64085233497, 2043.4815598282662, -496.73248876279905, 4343.401381743317, -1021.1043003386063, 7060.73825152114, -1724.0790215199177, 744.2968483752015, -1935.3194387815781, 3398.8579430170425, -2356.7127020517355, 7116.250872911934, -448.3092258191842, -867.1654615126507, -1463.6878325538892, -1088.6263829888655, -1307.9098023241845, 5292.077000902744, -1537.9440282270284, 6085.9925698370025, -1127.1428482232582, 1560.6713712342594, -2644.7360410034403, 4866.382801915375, -353.56685906075546, 5573.284399086867, -1999.5915407890247, 637.7202110006336, -882.598059165617, 1406.6508060252158, -2104.597309473951, 1938.8035174446973, -587.3943187221832, 5933.510209658376, -3435.9336194911957, 6259.212212119028, -1251.686392671222, 31.245333323884424, -1218.302739235151, 3246.269943653189, -946.929830021209, -1414.54201577922, -1228.3233636600203, 3006.311141336422, -2983.931082616572, 9154.433484526167, -703.6216389233446, 2409.4250652235764, -1372.280883871371, 1736.2779443116935, -1614.4854100090736, 919.9679211653341, -3863.938935265654, 2688.1033109728082, -797.340221048045, -3286.2647993560513, -1092.0933352473844, 5489.192539018602, -446.94736304481313, 1547.667197589126, -1524.1520609301717, 2951.435806032643, -2135.219615498111, 3435.2464494821234, -548.5306876907063, 1831.0307070676981, -867.7277187292157, 5724.147784654533, -2816.7407454577765, 6579.889066059453, -1749.5510809049833, 10705.960475171441, -1436.5500329769825, 9620.378781724548, -1022.0847460218125, 869.0487274231857, -920.5787270944985, -1160.728521119498, -1508.971421609851, 8195.407978738149, -143.3779111471163, 6693.055647264011, -868.1903926607637, -2210.1771403475454, -2061.0464100841677, -4063.0948100617015, -4430.96623180069, 310.0400756871333, -3277.4946504793033, -684.6450066155187, -495.06541832939564, 6902.661454883979, -710.7385720501555, 8936.915110103644, -1073.2788658831194, -985.1219279157623, -580.4982142140905, 882.2912132520133, -3217.8887274760614, -2107.022812515114, -3754.2851279497827, 4275.280876817217, -3334.023797285446, 1403.3902102255395, -3193.9540255626644, 7172.253972153943, -848.0078715050984, 3214.1800421259345, -1525.7071905948121, 137.64538019191093, -993.6808817116297, 4655.0930831121395, -1439.8462596881634, 10531.975289709248, -372.134530262703], "policy_predator_policy_reward": [26645.85768544422, 2466.4227543350394, 14773.996744203547, -1893.7369112853648, 6721.004303367988, 1649.338595652039, 13526.53835609385, 3319.708490059354, 3088.19605692098, 314.29162980519357, 2068.5604086699313, 2078.1483246795096, 1713.661021711169, -1672.1621624169356, 5368.356285828525, -0.1480807272520508, 4949.393713160677, 2562.3085150145516, 6461.039166804335, 4545.008830777965, -1396.7151293660202, -5126.420985347189, 21761.811804236084, 1429.9897041132076, 15611.937936759286, 2166.803285646186, 16902.179325539695, 2798.8245250693763, 3509.5605447516796, -121.52316090751168, 21588.655628959594, 1239.053502266177, 13205.156857495766, 2551.7719545876234, 12945.588181255336, -1792.100210790474, 7053.583625973213, 1442.5511357786493, 17666.58332645883, 3038.8355913730666, -4125.875965423061, 3239.7502771063855, 9907.518779941212, 1598.9656022097276, 8254.637240438364, 3097.9419459791156, 9204.812796162267, -834.604380564464, 457.12535600456266, 3187.1236782539436, 14305.72586477438, 4879.080155569425, 7604.570174167728, 6498.8303050215745, 14351.359408021677, 2819.380176154017, -134.98145667399405, 6768.8691033267505, 1907.836364541753, 146.54945205189432, -710.4020942885934, 2740.153004589707, 15072.864369195493, -1334.0752806652079, 588.2745953826537, 3146.1477379422013, 3772.9401872627086, -1675.4081741402883, 272.18560080547843, 1416.8915566780186, 6087.971559474371, 2353.350547178671, 8688.259673764911, 3297.5681041336816, 5030.6699867154775, 2221.049082565827, 6700.905379379376, 2518.186164221809, 10122.683629145204, 3232.1542626794103, 3420.2276814878146, 4826.923887795607, 17910.1338139673, 4280.731320139915, 5101.43056635398, 592.1120595688053, 5672.832975100068, 407.2239522524576, 10329.382915859715, -1234.3316523052306, 8491.135958506507, 1384.5637295909607, 648.992356992177, 2802.462210387425, 692.9724557342811, 1266.0601667726526, 10712.95638498547, -1613.6301636427968, 16189.740205793336, 2981.486788188755, 29690.982956927255, 2289.4182317422255, 3770.3797485312257, 2390.687110849257, 8590.706162082577, 356.1389884119551, 826.0079461388094, 1657.2647869098046, 3479.1788352907347, 1162.2637529379754, -2596.06911216179, 562.0557260706598, 7776.606194005799, 2702.649230297281, 6718.075239000404, 629.9220985006694, 14317.061056665496, 6285.947993005831, 3553.6755226595415, -2117.98545232076, 2090.717702937736, 4613.166714361351, 20877.798910462086, 1688.1959396263755, 472.08646173805755, -1882.969139570574, 20510.442529647757, 4040.665150903649, 59.82243645711576, 1730.5918191441094, 9739.171374722495, -517.0913914259067, 8466.393182348493, 890.911993094646, 15550.360031276621, 3525.9120764982117, 2833.721801176826, 4822.789434510807, 9422.298732577516, -259.0165152017586, 12530.502266865937, 3747.8590463893324, 12493.570762338164, 2596.5810361342938, 10071.851857874088, 1077.6888637953637, -890.6114804898485, 74.39528995532427, 11655.768696140483, 4008.219894320939, 4779.625776861036, -973.7595180479179, -838.6535339403804, -2068.75350525637, 3258.6132886167466, 937.3475290098665, 998.2405261156218, 2697.5160533681146, 6323.55146737192, 6890.43458321682, 4097.065677620413, 294.90380336096047, 2135.635649799004, 534.0642929303408, 8439.871385455146, -1457.0754791778606, 13976.027901687381, -2097.856620905483, 18308.594480161566, 6287.6933335390095, 15009.216564244894, 6345.670384425471, 4189.576011517828, 3224.5196075802314, 38235.15384379868, 268.2131920901849, 12228.407444257396, -928.4237724887006, 5432.528366087451, 4055.651899496822, 31491.84525889869, 4804.11237244813, 3911.58063118591, 6992.157856143226, 5594.609835199709, 4991.989828881859, 5161.347912806323, 1191.8327367283723, 3010.4280849974703, 5619.593207962088, 12404.65624951032, -518.153693600623, -819.8693557744218, 718.1047635878892, 3529.3175773650846, 384.71160944352863, 3268.965306482391, 688.5414271721371, 7235.794300949138, -229.20929149603307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7111511471559472, "mean_inference_ms": 1.5359092882773198, "mean_action_processing_ms": 0.30222957084309066, "mean_env_wait_ms": 0.13750315813773378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044286251068115234, "StateBufferConnector_ms": 0.0032546520233154297, "ViewRequirementAgentConnector_ms": 0.10256803035736084}, "num_episodes": 18, "episode_return_max": 37323.65661094396, "episode_return_min": 0.0, "episode_return_mean": 11491.161924796663, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.8141609836909, "num_env_steps_trained_throughput_per_sec": 289.8141609836909, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 13990.023, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13989.969, "sample_time_ms": 1160.776, "learn_time_ms": 12811.118, "learn_throughput": 312.229, "synch_weights_time_ms": 16.853}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "6751e_00000", "date": "2024-08-11_19-25-41", "timestamp": 1723418741, "time_this_iter_s": 13.848826885223389, "time_total_s": 1106.9510667324066, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81e8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1106.9510667324066, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 53.089473684210525, "ram_util_percent": 82.72631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.48264610590758145, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.180446630306346, "policy_loss": -0.005956488130761991, "vf_loss": 9.186377837670543, "vf_explained_var": 0.0002652388716500903, "kl": 0.008086422230014531, "entropy": 0.690064916818861, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8147766017724597, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.127922595997967, "policy_loss": -0.006230093586682367, "vf_loss": 9.133502911259889, "vf_explained_var": -0.00010848997761963536, "kl": 0.006497602078080474, "entropy": 0.7989784280143718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 37323.65661094396, "episode_reward_min": 0.0, "episode_reward_mean": 11148.966151687677, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4430.96623180069, "predator_policy": -2596.06911216179}, "policy_reward_max": {"prey_policy": 10705.960475171441, "predator_policy": 38235.15384379868}, "policy_reward_mean": {"prey_policy": 896.4529849267955, "predator_policy": 4678.030090917043}, "custom_metrics": {}, "hist_stats": {"episode_reward": [12818.090664873736, 9230.290364968141, 18356.913403530896, 8488.23400653549, 16538.202542984458, 11966.124032983897, 4238.666528208301, 856.2440890123275, 16456.87147457559, 7986.030842259749, 7515.10902627768, 0.0, 18225.526670431063, 16853.85728397889, 6336.273324583746, 5422.526707018848, 16021.769627830752, 6906.71932744655, 20019.54394739549, 6924.323896551014, 7626.805998417995, 12417.348344959217, 15212.358918098764, 2260.4319769732274, 3001.177863472239, 15767.267868435389, 16840.373699915577, 29583.865003356426, 9915.199832056196, 13905.694872108284, 1399.2080632794339, 9154.258531083322, 1539.679472206709, 10234.377576138098, 6650.050834052323, 21954.4182483938, 3933.2666605059744, 11711.410236746922, 21378.93744417719, 888.4574357994644, 21908.242301112175, 1812.7943143210755, 17672.891828899414, 10394.44935679533, 19198.064642077454, 4712.540221587321, 11054.045307300517, 11900.003178651838, 20132.396974446256, 11173.055858328407, 0.0, 18550.704352252847, 4769.169247151606, 0.0, 9026.298802781073, 12965.167021678211, 21812.280086291616, 4340.439481310059, 0.0, 15034.825973868314, 17703.036535385203, 20325.064263268898, 12860.825906807964, 4446.641044305891, 37323.65661094396, 17491.906554602545, 17351.816509804772, 34730.337489216945, 8568.140973105084, 4725.291723616667, 7294.437729066465, 6839.457477622431, 18210.7486565585, 1586.7082593445907, 3057.993685288893, 7172.753557078505, 17166.425768899644, 10355.474026170363, 2190.6316150818607, 8744.277435174718, 18588.520080410945, 17398.769817106797, 12426.2848856377, 13423.354927191298, 1709.9364629243576, 4482.924351081765, 9288.215215019372, 16756.064112833992, 7311.975582992531, 4426.682360107202, 4533.5342598437865, 9633.500467552474, 18516.45332172782, 8406.451493930083, 8787.70998608151, 3973.5050764709604, 12087.501156525328, 18431.226924741066, 4591.295092997032, 18983.808181771168], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5466.510480389809, -1018.6282311138988, 7488.68754707571, -1902.646216366074, 302.77721754508184, -1130.6698343579797, -3110.781245422452, -2504.3852272313334, -43.181680910859015, -589.3553602803884, 6815.1275552412435, -1482.8911689101146, 3001.980515577665, -817.699803963014, 943.3490982927885, -2116.8559195815824, 2918.488566900048, -200.40618085469126, 3913.3414021560134, 338.2671067788774, 6941.869064220052, -1524.2920510648028, 2170.2912520773925, -3859.36840956089, 10275.29061303005, -491.08604925210847, 5683.41226831879, -815.3827622384703, 764.5307644435627, -1679.9765091411218, 403.5264563134341, -4200.091292895776, 3366.154473201723, -699.2227371956287, 1978.947893392738, -3319.3801352296236, -322.2185741393598, -1849.1026125723538, 3048.422122963203, -1817.64085233497, 2043.4815598282662, -496.73248876279905, 4343.401381743317, -1021.1043003386063, 7060.73825152114, -1724.0790215199177, 744.2968483752015, -1935.3194387815781, 3398.8579430170425, -2356.7127020517355, 7116.250872911934, -448.3092258191842, -867.1654615126507, -1463.6878325538892, -1088.6263829888655, -1307.9098023241845, 5292.077000902744, -1537.9440282270284, 6085.9925698370025, -1127.1428482232582, 1560.6713712342594, -2644.7360410034403, 4866.382801915375, -353.56685906075546, 5573.284399086867, -1999.5915407890247, 637.7202110006336, -882.598059165617, 1406.6508060252158, -2104.597309473951, 1938.8035174446973, -587.3943187221832, 5933.510209658376, -3435.9336194911957, 6259.212212119028, -1251.686392671222, 31.245333323884424, -1218.302739235151, 3246.269943653189, -946.929830021209, -1414.54201577922, -1228.3233636600203, 3006.311141336422, -2983.931082616572, 9154.433484526167, -703.6216389233446, 2409.4250652235764, -1372.280883871371, 1736.2779443116935, -1614.4854100090736, 919.9679211653341, -3863.938935265654, 2688.1033109728082, -797.340221048045, -3286.2647993560513, -1092.0933352473844, 5489.192539018602, -446.94736304481313, 1547.667197589126, -1524.1520609301717, 2951.435806032643, -2135.219615498111, 3435.2464494821234, -548.5306876907063, 1831.0307070676981, -867.7277187292157, 5724.147784654533, -2816.7407454577765, 6579.889066059453, -1749.5510809049833, 10705.960475171441, -1436.5500329769825, 9620.378781724548, -1022.0847460218125, 869.0487274231857, -920.5787270944985, -1160.728521119498, -1508.971421609851, 8195.407978738149, -143.3779111471163, 6693.055647264011, -868.1903926607637, -2210.1771403475454, -2061.0464100841677, -4063.0948100617015, -4430.96623180069, 310.0400756871333, -3277.4946504793033, -684.6450066155187, -495.06541832939564, 6902.661454883979, -710.7385720501555, 8936.915110103644, -1073.2788658831194, -985.1219279157623, -580.4982142140905, 882.2912132520133, -3217.8887274760614, -2107.022812515114, -3754.2851279497827, 4275.280876817217, -3334.023797285446, 1403.3902102255395, -3193.9540255626644, 7172.253972153943, -848.0078715050984, 3214.1800421259345, -1525.7071905948121, 137.64538019191093, -993.6808817116297, 4655.0930831121395, -1439.8462596881634, 10531.975289709248, -372.134530262703, 677.5432609977471, -2382.6597534495154, 4757.2705656853095, -1358.7696993979794, 5794.002624057492, -1357.4086757379348, 8796.481604892584, -977.0128363175984, 3653.6603272250222, -502.74141867685904, 7657.696191594733, -381.37050365692943, 6758.547633880255, -105.78016258438981, 4552.378523792081, -2548.900657587711, 635.4849057199635, -3818.3802888066816, 7295.649293862005, -2554.353554576354, 8050.652314117371, -227.62437551751316, 1572.2150556833722, -1468.1301270739068, -596.9753705452031, -3808.363608690936, 3136.7263439377243, -2105.8097455083644, 349.5933467709549, -3273.6949557460566, 1053.19271816462, -1137.1282670975183, 2346.801544426921, -1917.7282323597403, 6079.346081052899, -1557.5446795816838, 5196.06878213569, -2834.076097557542, 7481.582220940946, -715.4580876287309, 925.4560199917595, -2396.2406680562804, 3666.35774168435, -574.7587762215093, 5453.970001166562, -177.51366123402033], "policy_predator_policy_reward": [9204.812796162267, -834.604380564464, 457.12535600456266, 3187.1236782539436, 14305.72586477438, 4879.080155569425, 7604.570174167728, 6498.8303050215745, 14351.359408021677, 2819.380176154017, -134.98145667399405, 6768.8691033267505, 1907.836364541753, 146.54945205189432, -710.4020942885934, 2740.153004589707, 15072.864369195493, -1334.0752806652079, 588.2745953826537, 3146.1477379422013, 3772.9401872627086, -1675.4081741402883, 272.18560080547843, 1416.8915566780186, 6087.971559474371, 2353.350547178671, 8688.259673764911, 3297.5681041336816, 5030.6699867154775, 2221.049082565827, 6700.905379379376, 2518.186164221809, 10122.683629145204, 3232.1542626794103, 3420.2276814878146, 4826.923887795607, 17910.1338139673, 4280.731320139915, 5101.43056635398, 592.1120595688053, 5672.832975100068, 407.2239522524576, 10329.382915859715, -1234.3316523052306, 8491.135958506507, 1384.5637295909607, 648.992356992177, 2802.462210387425, 692.9724557342811, 1266.0601667726526, 10712.95638498547, -1613.6301636427968, 16189.740205793336, 2981.486788188755, 29690.982956927255, 2289.4182317422255, 3770.3797485312257, 2390.687110849257, 8590.706162082577, 356.1389884119551, 826.0079461388094, 1657.2647869098046, 3479.1788352907347, 1162.2637529379754, -2596.06911216179, 562.0557260706598, 7776.606194005799, 2702.649230297281, 6718.075239000404, 629.9220985006694, 14317.061056665496, 6285.947993005831, 3553.6755226595415, -2117.98545232076, 2090.717702937736, 4613.166714361351, 20877.798910462086, 1688.1959396263755, 472.08646173805755, -1882.969139570574, 20510.442529647757, 4040.665150903649, 59.82243645711576, 1730.5918191441094, 9739.171374722495, -517.0913914259067, 8466.393182348493, 890.911993094646, 15550.360031276621, 3525.9120764982117, 2833.721801176826, 4822.789434510807, 9422.298732577516, -259.0165152017586, 12530.502266865937, 3747.8590463893324, 12493.570762338164, 2596.5810361342938, 10071.851857874088, 1077.6888637953637, -890.6114804898485, 74.39528995532427, 11655.768696140483, 4008.219894320939, 4779.625776861036, -973.7595180479179, -838.6535339403804, -2068.75350525637, 3258.6132886167466, 937.3475290098665, 998.2405261156218, 2697.5160533681146, 6323.55146737192, 6890.43458321682, 4097.065677620413, 294.90380336096047, 2135.635649799004, 534.0642929303408, 8439.871385455146, -1457.0754791778606, 13976.027901687381, -2097.856620905483, 18308.594480161566, 6287.6933335390095, 15009.216564244894, 6345.670384425471, 4189.576011517828, 3224.5196075802314, 38235.15384379868, 268.2131920901849, 12228.407444257396, -928.4237724887006, 5432.528366087451, 4055.651899496822, 31491.84525889869, 4804.11237244813, 3911.58063118591, 6992.157856143226, 5594.609835199709, 4991.989828881859, 5161.347912806323, 1191.8327367283723, 3010.4280849974703, 5619.593207962088, 12404.65624951032, -518.153693600623, -819.8693557744218, 718.1047635878892, 3529.3175773650846, 384.71160944352863, 3268.965306482391, 688.5414271721371, 7235.794300949138, -229.20929149603307, 5959.276804828813, 6101.31371379334, 889.1645037053206, -2097.0337549107885, 2793.4023686535297, 1514.2811182016399, 8535.134181012725, 2233.9171308232144, 14433.977822699362, -186.1269141407284, 7586.30084809067, -2436.341650390722, 8676.97635311005, -1906.3888972146221, -229.70397910804823, -63.83742417196544, 2880.870611412445, 4784.949122756027, 3989.4598178460997, 557.4596578876315, 7174.402455158731, 1758.6337190753857, 7874.965863383451, -667.0752090003904, 7051.856856540654, 1780.164482802676, 1313.568496043556, 2189.049165370871, 8117.6486679717955, 4439.953408555782, 11796.447365408372, 6803.94150525242, 2830.498887277359, 5146.879294585553, 5503.847847397907, -1237.9392627876023, -2116.664725137815, 3728.177117030641, 4454.856974237273, 866.5200489758724, 17453.82145332665, 2448.1901194789293, 2443.866990491564, -944.1708629573741, 13608.034638656321, 99.31720318227575]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7104079316971442, "mean_inference_ms": 1.5336722975601031, "mean_action_processing_ms": 0.30176922214003216, "mean_env_wait_ms": 0.13727649293663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003944873809814453, "StateBufferConnector_ms": 0.003586888313293457, "ViewRequirementAgentConnector_ms": 0.10814404487609863}, "num_episodes": 23, "episode_return_max": 37323.65661094396, "episode_return_min": 0.0, "episode_return_mean": 11148.966151687677, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.214555168314, "num_env_steps_trained_throughput_per_sec": 278.214555168314, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 14011.425, "restore_workers_time_ms": 0.014, "training_step_time_ms": 14011.371, "sample_time_ms": 1183.547, "learn_time_ms": 12809.824, "learn_throughput": 312.26, "synch_weights_time_ms": 16.748}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "6751e_00000", "date": "2024-08-11_19-25-55", "timestamp": 1723418755, "time_this_iter_s": 14.408354043960571, "time_total_s": 1121.3594207763672, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacd9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1121.3594207763672, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 55.2095238095238, "ram_util_percent": 82.9095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.496782007009264, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.62188221184665, "policy_loss": -0.003644996535072409, "vf_loss": 8.625496454844399, "vf_explained_var": 0.000888978678082663, "kl": 0.009829174295254999, "entropy": 0.6707744366908199, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9014599277071221, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.893882976511799, "policy_loss": -0.00663601257271631, "vf_loss": 8.899653007113745, "vf_explained_var": 2.9820897591807856e-05, "kl": 0.008659791403215687, "entropy": 0.8233957249020774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 42270.19964566711, "episode_reward_min": 0.0, "episode_reward_mean": 12198.852888064115, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4958.025694707608, "predator_policy": -2596.06911216179}, "policy_reward_max": {"prey_policy": 10705.960475171441, "predator_policy": 38235.15384379868}, "policy_reward_mean": {"prey_policy": 813.1690006960421, "predator_policy": 5286.257443336013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20019.54394739549, 6924.323896551014, 7626.805998417995, 12417.348344959217, 15212.358918098764, 2260.4319769732274, 3001.177863472239, 15767.267868435389, 16840.373699915577, 29583.865003356426, 9915.199832056196, 13905.694872108284, 1399.2080632794339, 9154.258531083322, 1539.679472206709, 10234.377576138098, 6650.050834052323, 21954.4182483938, 3933.2666605059744, 11711.410236746922, 21378.93744417719, 888.4574357994644, 21908.242301112175, 1812.7943143210755, 17672.891828899414, 10394.44935679533, 19198.064642077454, 4712.540221587321, 11054.045307300517, 11900.003178651838, 20132.396974446256, 11173.055858328407, 0.0, 18550.704352252847, 4769.169247151606, 0.0, 9026.298802781073, 12965.167021678211, 21812.280086291616, 4340.439481310059, 0.0, 15034.825973868314, 17703.036535385203, 20325.064263268898, 12860.825906807964, 4446.641044305891, 37323.65661094396, 17491.906554602545, 17351.816509804772, 34730.337489216945, 8568.140973105084, 4725.291723616667, 7294.437729066465, 6839.457477622431, 18210.7486565585, 1586.7082593445907, 3057.993685288893, 7172.753557078505, 17166.425768899644, 10355.474026170363, 2190.6316150818607, 8744.277435174718, 18588.520080410945, 17398.769817106797, 12426.2848856377, 13423.354927191298, 1709.9364629243576, 4482.924351081765, 9288.215215019372, 16756.064112833992, 7311.975582992531, 4426.682360107202, 4533.5342598437865, 9633.500467552474, 18516.45332172782, 8406.451493930083, 8787.70998608151, 3973.5050764709604, 12087.501156525328, 18431.226924741066, 4591.295092997032, 18983.808181771168, 42270.19964566711, 18135.266365769698, 15085.822940406808, 370.8189331477002, 21740.07071214021, 11746.914436045441, 18966.774427609274, 13361.729516746238, 20420.92014450332, 18322.616903109967, 21075.82646996559, 17764.794844376866, 15131.242338400047, 6291.369432447169, 4424.726699022699, 6167.382081570229, 20873.57504513195, 17056.072619083043], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-322.2185741393598, -1849.1026125723538, 3048.422122963203, -1817.64085233497, 2043.4815598282662, -496.73248876279905, 4343.401381743317, -1021.1043003386063, 7060.73825152114, -1724.0790215199177, 744.2968483752015, -1935.3194387815781, 3398.8579430170425, -2356.7127020517355, 7116.250872911934, -448.3092258191842, -867.1654615126507, -1463.6878325538892, -1088.6263829888655, -1307.9098023241845, 5292.077000902744, -1537.9440282270284, 6085.9925698370025, -1127.1428482232582, 1560.6713712342594, -2644.7360410034403, 4866.382801915375, -353.56685906075546, 5573.284399086867, -1999.5915407890247, 637.7202110006336, -882.598059165617, 1406.6508060252158, -2104.597309473951, 1938.8035174446973, -587.3943187221832, 5933.510209658376, -3435.9336194911957, 6259.212212119028, -1251.686392671222, 31.245333323884424, -1218.302739235151, 3246.269943653189, -946.929830021209, -1414.54201577922, -1228.3233636600203, 3006.311141336422, -2983.931082616572, 9154.433484526167, -703.6216389233446, 2409.4250652235764, -1372.280883871371, 1736.2779443116935, -1614.4854100090736, 919.9679211653341, -3863.938935265654, 2688.1033109728082, -797.340221048045, -3286.2647993560513, -1092.0933352473844, 5489.192539018602, -446.94736304481313, 1547.667197589126, -1524.1520609301717, 2951.435806032643, -2135.219615498111, 3435.2464494821234, -548.5306876907063, 1831.0307070676981, -867.7277187292157, 5724.147784654533, -2816.7407454577765, 6579.889066059453, -1749.5510809049833, 10705.960475171441, -1436.5500329769825, 9620.378781724548, -1022.0847460218125, 869.0487274231857, -920.5787270944985, -1160.728521119498, -1508.971421609851, 8195.407978738149, -143.3779111471163, 6693.055647264011, -868.1903926607637, -2210.1771403475454, -2061.0464100841677, -4063.0948100617015, -4430.96623180069, 310.0400756871333, -3277.4946504793033, -684.6450066155187, -495.06541832939564, 6902.661454883979, -710.7385720501555, 8936.915110103644, -1073.2788658831194, -985.1219279157623, -580.4982142140905, 882.2912132520133, -3217.8887274760614, -2107.022812515114, -3754.2851279497827, 4275.280876817217, -3334.023797285446, 1403.3902102255395, -3193.9540255626644, 7172.253972153943, -848.0078715050984, 3214.1800421259345, -1525.7071905948121, 137.64538019191093, -993.6808817116297, 4655.0930831121395, -1439.8462596881634, 10531.975289709248, -372.134530262703, 677.5432609977471, -2382.6597534495154, 4757.2705656853095, -1358.7696993979794, 5794.002624057492, -1357.4086757379348, 8796.481604892584, -977.0128363175984, 3653.6603272250222, -502.74141867685904, 7657.696191594733, -381.37050365692943, 6758.547633880255, -105.78016258438981, 4552.378523792081, -2548.900657587711, 635.4849057199635, -3818.3802888066816, 7295.649293862005, -2554.353554576354, 8050.652314117371, -227.62437551751316, 1572.2150556833722, -1468.1301270739068, -596.9753705452031, -3808.363608690936, 3136.7263439377243, -2105.8097455083644, 349.5933467709549, -3273.6949557460566, 1053.19271816462, -1137.1282670975183, 2346.801544426921, -1917.7282323597403, 6079.346081052899, -1557.5446795816838, 5196.06878213569, -2834.076097557542, 7481.582220940946, -715.4580876287309, 925.4560199917595, -2396.2406680562804, 3666.35774168435, -574.7587762215093, 5453.970001166562, -177.51366123402033, -663.096610733963, -260.43160738837275, 1043.7115358650426, -738.3507298228863, -4958.025694707608, -828.1614416562369, 2676.076524613192, -1180.6152521185502, 5785.3895558311915, -1100.4316204391644, 1127.888343006433, -2006.355989953583, -801.762016079648, -1182.2925853935528, -882.5065779967146, -4353.364012943263, 4412.1020615495645, -130.8174962520038, 3498.2215190657976, -402.0679730860621, 6303.877514059831, -370.2039129574013, 686.635757225676, -132.71549228378782, 6544.917984400457, -845.570955864629, 1087.4360256171128, -4796.903222979629, 3468.0205051175576, -4783.905193228424, 2148.6789909691756, -3486.1867328404105, 3359.235046997796, -1137.8094093138627, 8489.943295213972, -981.1055182595338], "policy_predator_policy_reward": [17910.1338139673, 4280.731320139915, 5101.43056635398, 592.1120595688053, 5672.832975100068, 407.2239522524576, 10329.382915859715, -1234.3316523052306, 8491.135958506507, 1384.5637295909607, 648.992356992177, 2802.462210387425, 692.9724557342811, 1266.0601667726526, 10712.95638498547, -1613.6301636427968, 16189.740205793336, 2981.486788188755, 29690.982956927255, 2289.4182317422255, 3770.3797485312257, 2390.687110849257, 8590.706162082577, 356.1389884119551, 826.0079461388094, 1657.2647869098046, 3479.1788352907347, 1162.2637529379754, -2596.06911216179, 562.0557260706598, 7776.606194005799, 2702.649230297281, 6718.075239000404, 629.9220985006694, 14317.061056665496, 6285.947993005831, 3553.6755226595415, -2117.98545232076, 2090.717702937736, 4613.166714361351, 20877.798910462086, 1688.1959396263755, 472.08646173805755, -1882.969139570574, 20510.442529647757, 4040.665150903649, 59.82243645711576, 1730.5918191441094, 9739.171374722495, -517.0913914259067, 8466.393182348493, 890.911993094646, 15550.360031276621, 3525.9120764982117, 2833.721801176826, 4822.789434510807, 9422.298732577516, -259.0165152017586, 12530.502266865937, 3747.8590463893324, 12493.570762338164, 2596.5810361342938, 10071.851857874088, 1077.6888637953637, -890.6114804898485, 74.39528995532427, 11655.768696140483, 4008.219894320939, 4779.625776861036, -973.7595180479179, -838.6535339403804, -2068.75350525637, 3258.6132886167466, 937.3475290098665, 998.2405261156218, 2697.5160533681146, 6323.55146737192, 6890.43458321682, 4097.065677620413, 294.90380336096047, 2135.635649799004, 534.0642929303408, 8439.871385455146, -1457.0754791778606, 13976.027901687381, -2097.856620905483, 18308.594480161566, 6287.6933335390095, 15009.216564244894, 6345.670384425471, 4189.576011517828, 3224.5196075802314, 38235.15384379868, 268.2131920901849, 12228.407444257396, -928.4237724887006, 5432.528366087451, 4055.651899496822, 31491.84525889869, 4804.11237244813, 3911.58063118591, 6992.157856143226, 5594.609835199709, 4991.989828881859, 5161.347912806323, 1191.8327367283723, 3010.4280849974703, 5619.593207962088, 12404.65624951032, -518.153693600623, -819.8693557744218, 718.1047635878892, 3529.3175773650846, 384.71160944352863, 3268.965306482391, 688.5414271721371, 7235.794300949138, -229.20929149603307, 5959.276804828813, 6101.31371379334, 889.1645037053206, -2097.0337549107885, 2793.4023686535297, 1514.2811182016399, 8535.134181012725, 2233.9171308232144, 14433.977822699362, -186.1269141407284, 7586.30084809067, -2436.341650390722, 8676.97635311005, -1906.3888972146221, -229.70397910804823, -63.83742417196544, 2880.870611412445, 4784.949122756027, 3989.4598178460997, 557.4596578876315, 7174.402455158731, 1758.6337190753857, 7874.965863383451, -667.0752090003904, 7051.856856540654, 1780.164482802676, 1313.568496043556, 2189.049165370871, 8117.6486679717955, 4439.953408555782, 11796.447365408372, 6803.94150525242, 2830.498887277359, 5146.879294585553, 5503.847847397907, -1237.9392627876023, -2116.664725137815, 3728.177117030641, 4454.856974237273, 866.5200489758724, 17453.82145332665, 2448.1901194789293, 2443.866990491564, -944.1708629573741, 13608.034638656321, 99.31720318227575, 35985.52519428625, 7208.202669503273, 15196.989682444324, 2632.915877283246, 14064.671189029035, 6807.338887741631, -1803.9441793575695, 679.3018400106288, 12495.112347190832, 4560.000429557376, 10516.882049097805, 2108.500033894784, 15948.30937052129, 5002.519658561184, 15760.394944332344, 2837.205163353873, 14119.967755632286, 2019.6678235734953, 12065.778999160097, 3160.6843579701203, 11677.386509126554, 3464.7663597365895, 13944.847629733264, 3266.0269497016866, 6760.896230125736, 2670.999079738443, 5437.548239952635, 4563.288389857051, 7093.831097625136, -1353.2197104915779, 7864.5090220579095, -359.6191986164415, 15807.025812805066, 2845.123594642908, 8406.696028346272, 1140.5388137823256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7097467748999384, "mean_inference_ms": 1.5316995585306865, "mean_action_processing_ms": 0.30130174517760494, "mean_env_wait_ms": 0.1370822435221058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042487382888793945, "StateBufferConnector_ms": 0.003661632537841797, "ViewRequirementAgentConnector_ms": 0.10392868518829346}, "num_episodes": 18, "episode_return_max": 42270.19964566711, "episode_return_min": 0.0, "episode_return_mean": 12198.852888064115, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.27829196701066, "num_env_steps_trained_throughput_per_sec": 288.27829196701066, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 13967.501, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13967.446, "sample_time_ms": 1179.378, "learn_time_ms": 12770.44, "learn_throughput": 313.223, "synch_weights_time_ms": 16.422}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "6751e_00000", "date": "2024-08-11_19-26-09", "timestamp": 1723418769, "time_this_iter_s": 13.951370239257812, "time_total_s": 1135.310791015625, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1777c3160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1135.310791015625, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 52.81578947368421, "ram_util_percent": 82.30526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5288068930781077, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.663241371275886, "policy_loss": -0.006641197453681675, "vf_loss": 8.669848676711794, "vf_explained_var": 0.002470533904575166, "kl": 0.010842994784568105, "entropy": 0.7245635979074649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7479829653072609, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.057786228290942, "policy_loss": -0.006415446217679394, "vf_loss": 9.063183911641438, "vf_explained_var": 9.46973997449118e-05, "kl": 0.01017742409766698, "entropy": 0.7960973270986446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 42270.19964566711, "episode_reward_min": 0.0, "episode_reward_mean": 13003.163197404923, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4958.025694707608, "predator_policy": -3896.4167023516443}, "policy_reward_max": {"prey_policy": 10705.960475171441, "predator_policy": 38235.15384379868}, "policy_reward_mean": {"prey_policy": 805.702255467824, "predator_policy": 5695.879343234639}, "custom_metrics": {}, "hist_stats": {"episode_reward": [21908.242301112175, 1812.7943143210755, 17672.891828899414, 10394.44935679533, 19198.064642077454, 4712.540221587321, 11054.045307300517, 11900.003178651838, 20132.396974446256, 11173.055858328407, 0.0, 18550.704352252847, 4769.169247151606, 0.0, 9026.298802781073, 12965.167021678211, 21812.280086291616, 4340.439481310059, 0.0, 15034.825973868314, 17703.036535385203, 20325.064263268898, 12860.825906807964, 4446.641044305891, 37323.65661094396, 17491.906554602545, 17351.816509804772, 34730.337489216945, 8568.140973105084, 4725.291723616667, 7294.437729066465, 6839.457477622431, 18210.7486565585, 1586.7082593445907, 3057.993685288893, 7172.753557078505, 17166.425768899644, 10355.474026170363, 2190.6316150818607, 8744.277435174718, 18588.520080410945, 17398.769817106797, 12426.2848856377, 13423.354927191298, 1709.9364629243576, 4482.924351081765, 9288.215215019372, 16756.064112833992, 7311.975582992531, 4426.682360107202, 4533.5342598437865, 9633.500467552474, 18516.45332172782, 8406.451493930083, 8787.70998608151, 3973.5050764709604, 12087.501156525328, 18431.226924741066, 4591.295092997032, 18983.808181771168, 42270.19964566711, 18135.266365769698, 15085.822940406808, 370.8189331477002, 21740.07071214021, 11746.914436045441, 18966.774427609274, 13361.729516746238, 20420.92014450332, 18322.616903109967, 21075.82646996559, 17764.794844376866, 15131.242338400047, 6291.369432447169, 4424.726699022699, 6167.382081570229, 20873.57504513195, 17056.072619083043, 14166.562976701698, 19061.139761177346, 27514.751511371087, 26277.428851135224, 14472.306351728852, 8555.84474516748, 15425.491903236883, 15209.685393615218, 14567.347369911842, 20846.715226974513, 15658.291148918557, 16494.302505096173, 6446.278004320286, 12854.573283441476, 3281.193752841376, 16868.66338847607, 10589.326177023984, 11336.314083930634, 3770.0855600138084, 16415.356667354543, 16104.270083395406, 16833.55891237228], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1414.54201577922, -1228.3233636600203, 3006.311141336422, -2983.931082616572, 9154.433484526167, -703.6216389233446, 2409.4250652235764, -1372.280883871371, 1736.2779443116935, -1614.4854100090736, 919.9679211653341, -3863.938935265654, 2688.1033109728082, -797.340221048045, -3286.2647993560513, -1092.0933352473844, 5489.192539018602, -446.94736304481313, 1547.667197589126, -1524.1520609301717, 2951.435806032643, -2135.219615498111, 3435.2464494821234, -548.5306876907063, 1831.0307070676981, -867.7277187292157, 5724.147784654533, -2816.7407454577765, 6579.889066059453, -1749.5510809049833, 10705.960475171441, -1436.5500329769825, 9620.378781724548, -1022.0847460218125, 869.0487274231857, -920.5787270944985, -1160.728521119498, -1508.971421609851, 8195.407978738149, -143.3779111471163, 6693.055647264011, -868.1903926607637, -2210.1771403475454, -2061.0464100841677, -4063.0948100617015, -4430.96623180069, 310.0400756871333, -3277.4946504793033, -684.6450066155187, -495.06541832939564, 6902.661454883979, -710.7385720501555, 8936.915110103644, -1073.2788658831194, -985.1219279157623, -580.4982142140905, 882.2912132520133, -3217.8887274760614, -2107.022812515114, -3754.2851279497827, 4275.280876817217, -3334.023797285446, 1403.3902102255395, -3193.9540255626644, 7172.253972153943, -848.0078715050984, 3214.1800421259345, -1525.7071905948121, 137.64538019191093, -993.6808817116297, 4655.0930831121395, -1439.8462596881634, 10531.975289709248, -372.134530262703, 677.5432609977471, -2382.6597534495154, 4757.2705656853095, -1358.7696993979794, 5794.002624057492, -1357.4086757379348, 8796.481604892584, -977.0128363175984, 3653.6603272250222, -502.74141867685904, 7657.696191594733, -381.37050365692943, 6758.547633880255, -105.78016258438981, 4552.378523792081, -2548.900657587711, 635.4849057199635, -3818.3802888066816, 7295.649293862005, -2554.353554576354, 8050.652314117371, -227.62437551751316, 1572.2150556833722, -1468.1301270739068, -596.9753705452031, -3808.363608690936, 3136.7263439377243, -2105.8097455083644, 349.5933467709549, -3273.6949557460566, 1053.19271816462, -1137.1282670975183, 2346.801544426921, -1917.7282323597403, 6079.346081052899, -1557.5446795816838, 5196.06878213569, -2834.076097557542, 7481.582220940946, -715.4580876287309, 925.4560199917595, -2396.2406680562804, 3666.35774168435, -574.7587762215093, 5453.970001166562, -177.51366123402033, -663.096610733963, -260.43160738837275, 1043.7115358650426, -738.3507298228863, -4958.025694707608, -828.1614416562369, 2676.076524613192, -1180.6152521185502, 5785.3895558311915, -1100.4316204391644, 1127.888343006433, -2006.355989953583, -801.762016079648, -1182.2925853935528, -882.5065779967146, -4353.364012943263, 4412.1020615495645, -130.8174962520038, 3498.2215190657976, -402.0679730860621, 6303.877514059831, -370.2039129574013, 686.635757225676, -132.71549228378782, 6544.917984400457, -845.570955864629, 1087.4360256171128, -4796.903222979629, 3468.0205051175576, -4783.905193228424, 2148.6789909691756, -3486.1867328404105, 3359.235046997796, -1137.8094093138627, 8489.943295213972, -981.1055182595338, 9439.53740656725, -1457.3293908803373, -1172.303453881462, -2280.198726306133, -598.8505003835677, -345.47601969170756, -2042.4803195127308, -807.0400613135631, 1361.0832941071424, -1450.8228699583988, 4328.60933488708, -3746.415788357093, 6595.7757792542125, -854.8329743140948, 3293.812097173036, -277.59188856225103, 6210.645379482656, 56.81637548902246, 5397.364566243302, -310.3578970880722, 2805.116423141684, -415.6242687241933, 3832.7208777923465, -345.546134528005, -871.7449020000774, -1402.951982362369, 1667.055981557173, -1326.6426383583848, -29.540494282020227, -2708.0312561518904, -4391.945164816855, -1295.8446890680198, 3315.321687698656, -1219.625925321823, 5670.618627197675, -2030.441942759596, 163.42477894691217, -288.4331857814196, 1296.232083639791, -918.190789208319, 4133.673442442745, -1022.3125588240526, 9008.42344319406, -660.7677272446626], "policy_predator_policy_reward": [20510.442529647757, 4040.665150903649, 59.82243645711576, 1730.5918191441094, 9739.171374722495, -517.0913914259067, 8466.393182348493, 890.911993094646, 15550.360031276621, 3525.9120764982117, 2833.721801176826, 4822.789434510807, 9422.298732577516, -259.0165152017586, 12530.502266865937, 3747.8590463893324, 12493.570762338164, 2596.5810361342938, 10071.851857874088, 1077.6888637953637, -890.6114804898485, 74.39528995532427, 11655.768696140483, 4008.219894320939, 4779.625776861036, -973.7595180479179, -838.6535339403804, -2068.75350525637, 3258.6132886167466, 937.3475290098665, 998.2405261156218, 2697.5160533681146, 6323.55146737192, 6890.43458321682, 4097.065677620413, 294.90380336096047, 2135.635649799004, 534.0642929303408, 8439.871385455146, -1457.0754791778606, 13976.027901687381, -2097.856620905483, 18308.594480161566, 6287.6933335390095, 15009.216564244894, 6345.670384425471, 4189.576011517828, 3224.5196075802314, 38235.15384379868, 268.2131920901849, 12228.407444257396, -928.4237724887006, 5432.528366087451, 4055.651899496822, 31491.84525889869, 4804.11237244813, 3911.58063118591, 6992.157856143226, 5594.609835199709, 4991.989828881859, 5161.347912806323, 1191.8327367283723, 3010.4280849974703, 5619.593207962088, 12404.65624951032, -518.153693600623, -819.8693557744218, 718.1047635878892, 3529.3175773650846, 384.71160944352863, 3268.965306482391, 688.5414271721371, 7235.794300949138, -229.20929149603307, 5959.276804828813, 6101.31371379334, 889.1645037053206, -2097.0337549107885, 2793.4023686535297, 1514.2811182016399, 8535.134181012725, 2233.9171308232144, 14433.977822699362, -186.1269141407284, 7586.30084809067, -2436.341650390722, 8676.97635311005, -1906.3888972146221, -229.70397910804823, -63.83742417196544, 2880.870611412445, 4784.949122756027, 3989.4598178460997, 557.4596578876315, 7174.402455158731, 1758.6337190753857, 7874.965863383451, -667.0752090003904, 7051.856856540654, 1780.164482802676, 1313.568496043556, 2189.049165370871, 8117.6486679717955, 4439.953408555782, 11796.447365408372, 6803.94150525242, 2830.498887277359, 5146.879294585553, 5503.847847397907, -1237.9392627876023, -2116.664725137815, 3728.177117030641, 4454.856974237273, 866.5200489758724, 17453.82145332665, 2448.1901194789293, 2443.866990491564, -944.1708629573741, 13608.034638656321, 99.31720318227575, 35985.52519428625, 7208.202669503273, 15196.989682444324, 2632.915877283246, 14064.671189029035, 6807.338887741631, -1803.9441793575695, 679.3018400106288, 12495.112347190832, 4560.000429557376, 10516.882049097805, 2108.500033894784, 15948.30937052129, 5002.519658561184, 15760.394944332344, 2837.205163353873, 14119.967755632286, 2019.6678235734953, 12065.778999160097, 3160.6843579701203, 11677.386509126554, 3464.7663597365895, 13944.847629733264, 3266.0269497016866, 6760.896230125736, 2670.999079738443, 5437.548239952635, 4563.288389857051, 7093.831097625136, -1353.2197104915779, 7864.5090220579095, -359.6191986164415, 15807.025812805066, 2845.123594642908, 8406.696028346272, 1140.5388137823256, 10080.771663366435, -3896.4167023516443, 17471.363644565612, 5042.278296799309, 24820.943530336488, 3638.134501109874, 24755.680643257103, 4371.268588704413, 11838.604943347962, 2723.440984232112, 8506.58554024933, -532.9343416118448, 11011.346556568902, -1326.797458272147, 9927.415513571448, 2266.0496714330197, 6856.587957412143, 1443.2976575280013, 13448.113005560323, 2311.59555225896, 14547.273057959543, -1278.4740634584978, 12100.79163688957, 906.3361249422835, 7210.877201856391, 1510.097686826351, 12017.345365732812, 496.8145745098934, 3132.3754399835398, 2886.39006329175, 14899.314246205327, 7657.138996155616, 6125.255899176203, 2368.3745154709427, 7061.654417446723, 634.4829820458424, 887.8705640254216, 3007.2234028228945, 15670.058513795913, 367.256859127188, 12303.50076959102, 689.4084301857444, 9197.560849076392, -711.6576526535184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7087009686224266, "mean_inference_ms": 1.5287006173988402, "mean_action_processing_ms": 0.3006773997333324, "mean_env_wait_ms": 0.13660402890500878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004289031028747559, "StateBufferConnector_ms": 0.0037058591842651367, "ViewRequirementAgentConnector_ms": 0.10358285903930664}, "num_episodes": 22, "episode_return_max": 42270.19964566711, "episode_return_min": 0.0, "episode_return_mean": 13003.163197404923, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.2722951366661, "num_env_steps_trained_throughput_per_sec": 294.2722951366661, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 13950.082, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13950.026, "sample_time_ms": 1179.581, "learn_time_ms": 12753.266, "learn_throughput": 313.645, "synch_weights_time_ms": 15.89}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "6751e_00000", "date": "2024-08-11_19-26-23", "timestamp": 1723418783, "time_this_iter_s": 13.641074895858765, "time_total_s": 1148.9518659114838, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16ea77280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1148.9518659114838, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 52.14000000000001, "ram_util_percent": 82.49499999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.46746994369717504, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.96378282062591, "policy_loss": -0.0037260487818568154, "vf_loss": 8.967492075571938, "vf_explained_var": -0.0002472355882957499, "kl": 0.005372122596414572, "entropy": 0.6213337259317832, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8004913270788848, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.20543536685762, "policy_loss": -0.007468830065175931, "vf_loss": 9.211827204971717, "vf_explained_var": 5.5106953969077457e-05, "kl": 0.010769867883397493, "entropy": 0.8352836371414245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 42270.19964566711, "episode_reward_min": 0.0, "episode_reward_mean": 13343.344307337173, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4958.025694707608, "predator_policy": -3896.4167023516443}, "policy_reward_max": {"prey_policy": 11508.640673058158, "predator_policy": 38235.15384379868}, "policy_reward_mean": {"prey_policy": 855.1806713449934, "predator_policy": 5816.491482323596}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.0, 15034.825973868314, 17703.036535385203, 20325.064263268898, 12860.825906807964, 4446.641044305891, 37323.65661094396, 17491.906554602545, 17351.816509804772, 34730.337489216945, 8568.140973105084, 4725.291723616667, 7294.437729066465, 6839.457477622431, 18210.7486565585, 1586.7082593445907, 3057.993685288893, 7172.753557078505, 17166.425768899644, 10355.474026170363, 2190.6316150818607, 8744.277435174718, 18588.520080410945, 17398.769817106797, 12426.2848856377, 13423.354927191298, 1709.9364629243576, 4482.924351081765, 9288.215215019372, 16756.064112833992, 7311.975582992531, 4426.682360107202, 4533.5342598437865, 9633.500467552474, 18516.45332172782, 8406.451493930083, 8787.70998608151, 3973.5050764709604, 12087.501156525328, 18431.226924741066, 4591.295092997032, 18983.808181771168, 42270.19964566711, 18135.266365769698, 15085.822940406808, 370.8189331477002, 21740.07071214021, 11746.914436045441, 18966.774427609274, 13361.729516746238, 20420.92014450332, 18322.616903109967, 21075.82646996559, 17764.794844376866, 15131.242338400047, 6291.369432447169, 4424.726699022699, 6167.382081570229, 20873.57504513195, 17056.072619083043, 14166.562976701698, 19061.139761177346, 27514.751511371087, 26277.428851135224, 14472.306351728852, 8555.84474516748, 15425.491903236883, 15209.685393615218, 14567.347369911842, 20846.715226974513, 15658.291148918557, 16494.302505096173, 6446.278004320286, 12854.573283441476, 3281.193752841376, 16868.66338847607, 10589.326177023984, 11336.314083930634, 3770.0855600138084, 16415.356667354543, 16104.270083395406, 16833.55891237228, 6694.397633542558, 16305.757943657085, 8751.703471747896, 15714.854544760808, 252.67454680462822, 18292.51258573229, 7333.746431508818, 15415.059101197563, 16649.566693435812, 17035.688606840486, 1538.4569434905893, 2615.9398331406364, 27971.857239548215, 18215.08892226674, 15055.807558610002, 19846.629153014946, 18004.232396813422, 9746.680362097499], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1160.728521119498, -1508.971421609851, 8195.407978738149, -143.3779111471163, 6693.055647264011, -868.1903926607637, -2210.1771403475454, -2061.0464100841677, -4063.0948100617015, -4430.96623180069, 310.0400756871333, -3277.4946504793033, -684.6450066155187, -495.06541832939564, 6902.661454883979, -710.7385720501555, 8936.915110103644, -1073.2788658831194, -985.1219279157623, -580.4982142140905, 882.2912132520133, -3217.8887274760614, -2107.022812515114, -3754.2851279497827, 4275.280876817217, -3334.023797285446, 1403.3902102255395, -3193.9540255626644, 7172.253972153943, -848.0078715050984, 3214.1800421259345, -1525.7071905948121, 137.64538019191093, -993.6808817116297, 4655.0930831121395, -1439.8462596881634, 10531.975289709248, -372.134530262703, 677.5432609977471, -2382.6597534495154, 4757.2705656853095, -1358.7696993979794, 5794.002624057492, -1357.4086757379348, 8796.481604892584, -977.0128363175984, 3653.6603272250222, -502.74141867685904, 7657.696191594733, -381.37050365692943, 6758.547633880255, -105.78016258438981, 4552.378523792081, -2548.900657587711, 635.4849057199635, -3818.3802888066816, 7295.649293862005, -2554.353554576354, 8050.652314117371, -227.62437551751316, 1572.2150556833722, -1468.1301270739068, -596.9753705452031, -3808.363608690936, 3136.7263439377243, -2105.8097455083644, 349.5933467709549, -3273.6949557460566, 1053.19271816462, -1137.1282670975183, 2346.801544426921, -1917.7282323597403, 6079.346081052899, -1557.5446795816838, 5196.06878213569, -2834.076097557542, 7481.582220940946, -715.4580876287309, 925.4560199917595, -2396.2406680562804, 3666.35774168435, -574.7587762215093, 5453.970001166562, -177.51366123402033, -663.096610733963, -260.43160738837275, 1043.7115358650426, -738.3507298228863, -4958.025694707608, -828.1614416562369, 2676.076524613192, -1180.6152521185502, 5785.3895558311915, -1100.4316204391644, 1127.888343006433, -2006.355989953583, -801.762016079648, -1182.2925853935528, -882.5065779967146, -4353.364012943263, 4412.1020615495645, -130.8174962520038, 3498.2215190657976, -402.0679730860621, 6303.877514059831, -370.2039129574013, 686.635757225676, -132.71549228378782, 6544.917984400457, -845.570955864629, 1087.4360256171128, -4796.903222979629, 3468.0205051175576, -4783.905193228424, 2148.6789909691756, -3486.1867328404105, 3359.235046997796, -1137.8094093138627, 8489.943295213972, -981.1055182595338, 9439.53740656725, -1457.3293908803373, -1172.303453881462, -2280.198726306133, -598.8505003835677, -345.47601969170756, -2042.4803195127308, -807.0400613135631, 1361.0832941071424, -1450.8228699583988, 4328.60933488708, -3746.415788357093, 6595.7757792542125, -854.8329743140948, 3293.812097173036, -277.59188856225103, 6210.645379482656, 56.81637548902246, 5397.364566243302, -310.3578970880722, 2805.116423141684, -415.6242687241933, 3832.7208777923465, -345.546134528005, -871.7449020000774, -1402.951982362369, 1667.055981557173, -1326.6426383583848, -29.540494282020227, -2708.0312561518904, -4391.945164816855, -1295.8446890680198, 3315.321687698656, -1219.625925321823, 5670.618627197675, -2030.441942759596, 163.42477894691217, -288.4331857814196, 1296.232083639791, -918.190789208319, 4133.673442442745, -1022.3125588240526, 9008.42344319406, -660.7677272446626, 3566.5746329836616, -2920.833321845287, 1786.760510946192, -133.3753085247126, 3623.8135729080896, -929.8470467176949, 4815.32785864573, -412.3559340786112, -100.15167198737284, -1176.1268313430844, 6804.7454045610375, -252.2297785673741, 2350.16833265101, -1422.1454786300014, 6056.753622353766, -746.9900971841889, 11508.640673058158, -547.9610757185487, 6929.496118896908, -1727.645151126587, 273.19851337019213, -1920.8386173118163, 1601.9366926376897, -4846.281692235271, -460.8299738814133, -1103.8713021990677, -753.1263048140161, -2233.4733331712464, 6853.915393767718, 87.25606095196162, 5656.951756626942, -1400.007984273412, 6586.8201869209015, -2004.537230093839, 5839.240481978845, -2509.6765664878358], "policy_predator_policy_reward": [2135.635649799004, 534.0642929303408, 8439.871385455146, -1457.0754791778606, 13976.027901687381, -2097.856620905483, 18308.594480161566, 6287.6933335390095, 15009.216564244894, 6345.670384425471, 4189.576011517828, 3224.5196075802314, 38235.15384379868, 268.2131920901849, 12228.407444257396, -928.4237724887006, 5432.528366087451, 4055.651899496822, 31491.84525889869, 4804.11237244813, 3911.58063118591, 6992.157856143226, 5594.609835199709, 4991.989828881859, 5161.347912806323, 1191.8327367283723, 3010.4280849974703, 5619.593207962088, 12404.65624951032, -518.153693600623, -819.8693557744218, 718.1047635878892, 3529.3175773650846, 384.71160944352863, 3268.965306482391, 688.5414271721371, 7235.794300949138, -229.20929149603307, 5959.276804828813, 6101.31371379334, 889.1645037053206, -2097.0337549107885, 2793.4023686535297, 1514.2811182016399, 8535.134181012725, 2233.9171308232144, 14433.977822699362, -186.1269141407284, 7586.30084809067, -2436.341650390722, 8676.97635311005, -1906.3888972146221, -229.70397910804823, -63.83742417196544, 2880.870611412445, 4784.949122756027, 3989.4598178460997, 557.4596578876315, 7174.402455158731, 1758.6337190753857, 7874.965863383451, -667.0752090003904, 7051.856856540654, 1780.164482802676, 1313.568496043556, 2189.049165370871, 8117.6486679717955, 4439.953408555782, 11796.447365408372, 6803.94150525242, 2830.498887277359, 5146.879294585553, 5503.847847397907, -1237.9392627876023, -2116.664725137815, 3728.177117030641, 4454.856974237273, 866.5200489758724, 17453.82145332665, 2448.1901194789293, 2443.866990491564, -944.1708629573741, 13608.034638656321, 99.31720318227575, 35985.52519428625, 7208.202669503273, 15196.989682444324, 2632.915877283246, 14064.671189029035, 6807.338887741631, -1803.9441793575695, 679.3018400106288, 12495.112347190832, 4560.000429557376, 10516.882049097805, 2108.500033894784, 15948.30937052129, 5002.519658561184, 15760.394944332344, 2837.205163353873, 14119.967755632286, 2019.6678235734953, 12065.778999160097, 3160.6843579701203, 11677.386509126554, 3464.7663597365895, 13944.847629733264, 3266.0269497016866, 6760.896230125736, 2670.999079738443, 5437.548239952635, 4563.288389857051, 7093.831097625136, -1353.2197104915779, 7864.5090220579095, -359.6191986164415, 15807.025812805066, 2845.123594642908, 8406.696028346272, 1140.5388137823256, 10080.771663366435, -3896.4167023516443, 17471.363644565612, 5042.278296799309, 24820.943530336488, 3638.134501109874, 24755.680643257103, 4371.268588704413, 11838.604943347962, 2723.440984232112, 8506.58554024933, -532.9343416118448, 11011.346556568902, -1326.797458272147, 9927.415513571448, 2266.0496714330197, 6856.587957412143, 1443.2976575280013, 13448.113005560323, 2311.59555225896, 14547.273057959543, -1278.4740634584978, 12100.79163688957, 906.3361249422835, 7210.877201856391, 1510.097686826351, 12017.345365732812, 496.8145745098934, 3132.3754399835398, 2886.39006329175, 14899.314246205327, 7657.138996155616, 6125.255899176203, 2368.3745154709427, 7061.654417446723, 634.4829820458424, 887.8705640254216, 3007.2234028228945, 15670.058513795913, 367.256859127188, 12303.50076959102, 689.4084301857444, 9197.560849076392, -711.6576526535184, 4936.042055708628, 1112.6142666955595, 13004.712504690564, 1647.6602365450801, 3060.0877247190206, 2997.6492208384975, 9283.656591797648, 2028.22602839601, 2223.8066391878847, -694.8535890527985, 8599.32621239529, 3140.6707473432525, 5920.080819979885, 485.6427575079284, 10021.360120366664, 83.93545566134546, 5012.058511437704, 676.8285846584613, 9757.93716199721, 2075.9004770729193, 2363.626295732011, 822.4707517002005, 3037.6040440204274, 2822.680788717792, 25250.182463724974, 4286.376051903739, 17087.22656531963, 4114.461994932371, 9125.658241869174, -1011.0221379787545, 16286.263126071699, -696.5777454102378, 12306.84216278785, 1115.1072771985541, 8099.246547005153, -1682.130100398649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7081184980870927, "mean_inference_ms": 1.527531665971368, "mean_action_processing_ms": 0.3002023100976434, "mean_env_wait_ms": 0.13668125211987958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004296660423278809, "StateBufferConnector_ms": 0.0039931535720825195, "ViewRequirementAgentConnector_ms": 0.10684037208557129}, "num_episodes": 18, "episode_return_max": 42270.19964566711, "episode_return_min": 0.0, "episode_return_mean": 13343.344307337173, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6421825107627, "num_env_steps_trained_throughput_per_sec": 299.6421825107627, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 13797.202, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13797.15, "sample_time_ms": 1118.791, "learn_time_ms": 12661.111, "learn_throughput": 315.928, "synch_weights_time_ms": 15.925}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "6751e_00000", "date": "2024-08-11_19-26-36", "timestamp": 1723418796, "time_this_iter_s": 13.404161214828491, "time_total_s": 1162.3560271263123, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eadac10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1162.3560271263123, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 54.247368421052634, "ram_util_percent": 82.57368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4877044013410649, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.024169303752759, "policy_loss": -0.005962904848567353, "vf_loss": 9.030093195072558, "vf_explained_var": -0.0016343313234823721, "kl": 0.012480632869007267, "entropy": 0.5879801351241964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7099100623338942, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.368914529507753, "policy_loss": -0.00600714190794086, "vf_loss": 9.374223030938042, "vf_explained_var": 3.1797343460971086e-06, "kl": 0.00698617357406118, "entropy": 0.8041883724076407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 42270.19964566711, "episode_reward_min": 252.67454680462822, "episode_reward_mean": 13698.820644714942, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5355.647359478684, "predator_policy": -5021.103560301733}, "policy_reward_max": {"prey_policy": 11508.640673058158, "predator_policy": 35985.52519428625}, "policy_reward_mean": {"prey_policy": 963.2459008601676, "predator_policy": 5886.164421497304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17398.769817106797, 12426.2848856377, 13423.354927191298, 1709.9364629243576, 4482.924351081765, 9288.215215019372, 16756.064112833992, 7311.975582992531, 4426.682360107202, 4533.5342598437865, 9633.500467552474, 18516.45332172782, 8406.451493930083, 8787.70998608151, 3973.5050764709604, 12087.501156525328, 18431.226924741066, 4591.295092997032, 18983.808181771168, 42270.19964566711, 18135.266365769698, 15085.822940406808, 370.8189331477002, 21740.07071214021, 11746.914436045441, 18966.774427609274, 13361.729516746238, 20420.92014450332, 18322.616903109967, 21075.82646996559, 17764.794844376866, 15131.242338400047, 6291.369432447169, 4424.726699022699, 6167.382081570229, 20873.57504513195, 17056.072619083043, 14166.562976701698, 19061.139761177346, 27514.751511371087, 26277.428851135224, 14472.306351728852, 8555.84474516748, 15425.491903236883, 15209.685393615218, 14567.347369911842, 20846.715226974513, 15658.291148918557, 16494.302505096173, 6446.278004320286, 12854.573283441476, 3281.193752841376, 16868.66338847607, 10589.326177023984, 11336.314083930634, 3770.0855600138084, 16415.356667354543, 16104.270083395406, 16833.55891237228, 6694.397633542558, 16305.757943657085, 8751.703471747896, 15714.854544760808, 252.67454680462822, 18292.51258573229, 7333.746431508818, 15415.059101197563, 16649.566693435812, 17035.688606840486, 1538.4569434905893, 2615.9398331406364, 27971.857239548215, 18215.08892226674, 15055.807558610002, 19846.629153014946, 18004.232396813422, 9746.680362097499, 1912.9133103270083, 2731.1214888960917, 5557.884729513305, 18427.343998210505, 12731.766250979483, 13788.982059622964, 6192.011961338658, 11993.073169816767, 17550.015516037744, 17420.294962616303, 13160.295065718754, 12892.697791417937, 15082.890750637618, 19663.12308052304, 27715.962027798178, 8862.818983218325, 22468.521697423606, 17387.31104774666, 18305.594285766096, 16441.638280419233, 6390.578772166513, 25213.573985585583, 15426.192397619641], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [3653.6603272250222, -502.74141867685904, 7657.696191594733, -381.37050365692943, 6758.547633880255, -105.78016258438981, 4552.378523792081, -2548.900657587711, 635.4849057199635, -3818.3802888066816, 7295.649293862005, -2554.353554576354, 8050.652314117371, -227.62437551751316, 1572.2150556833722, -1468.1301270739068, -596.9753705452031, -3808.363608690936, 3136.7263439377243, -2105.8097455083644, 349.5933467709549, -3273.6949557460566, 1053.19271816462, -1137.1282670975183, 2346.801544426921, -1917.7282323597403, 6079.346081052899, -1557.5446795816838, 5196.06878213569, -2834.076097557542, 7481.582220940946, -715.4580876287309, 925.4560199917595, -2396.2406680562804, 3666.35774168435, -574.7587762215093, 5453.970001166562, -177.51366123402033, -663.096610733963, -260.43160738837275, 1043.7115358650426, -738.3507298228863, -4958.025694707608, -828.1614416562369, 2676.076524613192, -1180.6152521185502, 5785.3895558311915, -1100.4316204391644, 1127.888343006433, -2006.355989953583, -801.762016079648, -1182.2925853935528, -882.5065779967146, -4353.364012943263, 4412.1020615495645, -130.8174962520038, 3498.2215190657976, -402.0679730860621, 6303.877514059831, -370.2039129574013, 686.635757225676, -132.71549228378782, 6544.917984400457, -845.570955864629, 1087.4360256171128, -4796.903222979629, 3468.0205051175576, -4783.905193228424, 2148.6789909691756, -3486.1867328404105, 3359.235046997796, -1137.8094093138627, 8489.943295213972, -981.1055182595338, 9439.53740656725, -1457.3293908803373, -1172.303453881462, -2280.198726306133, -598.8505003835677, -345.47601969170756, -2042.4803195127308, -807.0400613135631, 1361.0832941071424, -1450.8228699583988, 4328.60933488708, -3746.415788357093, 6595.7757792542125, -854.8329743140948, 3293.812097173036, -277.59188856225103, 6210.645379482656, 56.81637548902246, 5397.364566243302, -310.3578970880722, 2805.116423141684, -415.6242687241933, 3832.7208777923465, -345.546134528005, -871.7449020000774, -1402.951982362369, 1667.055981557173, -1326.6426383583848, -29.540494282020227, -2708.0312561518904, -4391.945164816855, -1295.8446890680198, 3315.321687698656, -1219.625925321823, 5670.618627197675, -2030.441942759596, 163.42477894691217, -288.4331857814196, 1296.232083639791, -918.190789208319, 4133.673442442745, -1022.3125588240526, 9008.42344319406, -660.7677272446626, 3566.5746329836616, -2920.833321845287, 1786.760510946192, -133.3753085247126, 3623.8135729080896, -929.8470467176949, 4815.32785864573, -412.3559340786112, -100.15167198737284, -1176.1268313430844, 6804.7454045610375, -252.2297785673741, 2350.16833265101, -1422.1454786300014, 6056.753622353766, -746.9900971841889, 11508.640673058158, -547.9610757185487, 6929.496118896908, -1727.645151126587, 273.19851337019213, -1920.8386173118163, 1601.9366926376897, -4846.281692235271, -460.8299738814133, -1103.8713021990677, -753.1263048140161, -2233.4733331712464, 6853.915393767718, 87.25606095196162, 5656.951756626942, -1400.007984273412, 6586.8201869209015, -2004.537230093839, 5839.240481978845, -2509.6765664878358, 5837.635510471518, -5355.647359478684, 3124.186838053966, -2033.664505508271, 4707.539598183445, -3796.2327182468275, -1093.378599296955, -456.5886136395812, 3632.0439546984403, 87.247301230213, 6233.40461034506, -949.6119683269151, 3618.354338589169, -3599.618430769986, 989.0288786033407, -2097.976207551397, 5545.64033760835, -1029.4188860183253, 7273.019457667773, -1170.9545297547577, 7608.811612425564, -2025.9936584037796, 8576.15665992222, -1420.3629682685653, 10833.57374815508, -223.58737271253472, 3872.42478902888, -460.00449669600573, -659.5502070320731, -155.3056610835465, 4515.066413356218, -2738.2876379900167, -2110.375360482316, -1870.0054195980267, 6994.50744676513, -268.4175685257091, 5968.909536139327, -698.2611080427776, 3268.60466603218, -323.31430836665953, 7257.054511011864, -945.5516861138357, -2834.8156539634283, -1772.9916739116977, -3901.391286599001, -2119.165712746432], "policy_predator_policy_reward": [14433.977822699362, -186.1269141407284, 7586.30084809067, -2436.341650390722, 8676.97635311005, -1906.3888972146221, -229.70397910804823, -63.83742417196544, 2880.870611412445, 4784.949122756027, 3989.4598178460997, 557.4596578876315, 7174.402455158731, 1758.6337190753857, 7874.965863383451, -667.0752090003904, 7051.856856540654, 1780.164482802676, 1313.568496043556, 2189.049165370871, 8117.6486679717955, 4439.953408555782, 11796.447365408372, 6803.94150525242, 2830.498887277359, 5146.879294585553, 5503.847847397907, -1237.9392627876023, -2116.664725137815, 3728.177117030641, 4454.856974237273, 866.5200489758724, 17453.82145332665, 2448.1901194789293, 2443.866990491564, -944.1708629573741, 13608.034638656321, 99.31720318227575, 35985.52519428625, 7208.202669503273, 15196.989682444324, 2632.915877283246, 14064.671189029035, 6807.338887741631, -1803.9441793575695, 679.3018400106288, 12495.112347190832, 4560.000429557376, 10516.882049097805, 2108.500033894784, 15948.30937052129, 5002.519658561184, 15760.394944332344, 2837.205163353873, 14119.967755632286, 2019.6678235734953, 12065.778999160097, 3160.6843579701203, 11677.386509126554, 3464.7663597365895, 13944.847629733264, 3266.0269497016866, 6760.896230125736, 2670.999079738443, 5437.548239952635, 4563.288389857051, 7093.831097625136, -1353.2197104915779, 7864.5090220579095, -359.6191986164415, 15807.025812805066, 2845.123594642908, 8406.696028346272, 1140.5388137823256, 10080.771663366435, -3896.4167023516443, 17471.363644565612, 5042.278296799309, 24820.943530336488, 3638.134501109874, 24755.680643257103, 4371.268588704413, 11838.604943347962, 2723.440984232112, 8506.58554024933, -532.9343416118448, 11011.346556568902, -1326.797458272147, 9927.415513571448, 2266.0496714330197, 6856.587957412143, 1443.2976575280013, 13448.113005560323, 2311.59555225896, 14547.273057959543, -1278.4740634584978, 12100.79163688957, 906.3361249422835, 7210.877201856391, 1510.097686826351, 12017.345365732812, 496.8145745098934, 3132.3754399835398, 2886.39006329175, 14899.314246205327, 7657.138996155616, 6125.255899176203, 2368.3745154709427, 7061.654417446723, 634.4829820458424, 887.8705640254216, 3007.2234028228945, 15670.058513795913, 367.256859127188, 12303.50076959102, 689.4084301857444, 9197.560849076392, -711.6576526535184, 4936.042055708628, 1112.6142666955595, 13004.712504690564, 1647.6602365450801, 3060.0877247190206, 2997.6492208384975, 9283.656591797648, 2028.22602839601, 2223.8066391878847, -694.8535890527985, 8599.32621239529, 3140.6707473432525, 5920.080819979885, 485.6427575079284, 10021.360120366664, 83.93545566134546, 5012.058511437704, 676.8285846584613, 9757.93716199721, 2075.9004770729193, 2363.626295732011, 822.4707517002005, 3037.6040440204274, 2822.680788717792, 25250.182463724974, 4286.376051903739, 17087.22656531963, 4114.461994932371, 9125.658241869174, -1011.0221379787545, 16286.263126071699, -696.5777454102378, 12306.84216278785, 1115.1072771985541, 8099.246547005153, -1682.130100398649, -363.7326908569059, 1794.6578501910865, 1202.802068118414, 437.797088231983, 3726.812701246994, 919.7651483296958, 13853.202823958954, 6124.108387188073, 8134.162183980348, 878.3128110704971, 8125.733337245211, 379.4560803595832, 6701.867886265074, -528.5918327455919, 12229.854758650063, 872.165740114742, 11927.35038215953, 1106.4436822882058, 13341.45953405031, -2023.2294993470134, 5326.099880965025, 2251.377230731924, 6329.924655469467, -593.02055570521, 4125.803204400441, 347.1011707945874, 11213.623419288275, 5037.079368901844, 21904.903849143186, 6625.914046770549, 9715.177053186391, -2629.1368453342816, 20144.272351759693, 6304.630125744264, 7601.5971238249695, 3059.624045682309, 12378.515466829893, 656.4303908396249, 13602.617061698445, -106.26913894476901, 5100.179507570224, -5021.103560301733, 26355.38466624463, 3465.99664721609, 11946.299427700797, 9500.44996926429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7072245185403916, "mean_inference_ms": 1.5267795855694521, "mean_action_processing_ms": 0.2988971098491699, "mean_env_wait_ms": 0.13656137282757128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004316210746765137, "StateBufferConnector_ms": 0.0038486719131469727, "ViewRequirementAgentConnector_ms": 0.10849559307098389}, "num_episodes": 23, "episode_return_max": 42270.19964566711, "episode_return_min": 252.67454680462822, "episode_return_mean": 13698.820644714942, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.9235611753211, "num_env_steps_trained_throughput_per_sec": 308.9235611753211, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 13744.953, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13744.906, "sample_time_ms": 1113.237, "learn_time_ms": 12614.584, "learn_throughput": 317.093, "synch_weights_time_ms": 15.727}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "6751e_00000", "date": "2024-08-11_19-26-49", "timestamp": 1723418809, "time_this_iter_s": 13.001605749130249, "time_total_s": 1175.3576328754425, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eada160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1175.3576328754425, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 51.25555555555556, "ram_util_percent": 81.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5246926995418059, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.25535185122616, "policy_loss": -0.0038977962503426527, "vf_loss": 9.259225459830471, "vf_explained_var": -0.0024102978920810436, "kl": 0.007737861501754662, "entropy": 0.5703781719245608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7083453454510875, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.360726897930974, "policy_loss": -0.007299335694517053, "vf_loss": 9.36716415718119, "vf_explained_var": -4.504408155168806e-06, "kl": 0.008620423419033999, "entropy": 0.7823424229861567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 42270.19964566711, "episode_reward_min": 252.67454680462822, "episode_reward_mean": 14032.413176854505, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5355.647359478684, "predator_policy": -5021.103560301733}, "policy_reward_max": {"prey_policy": 11508.640673058158, "predator_policy": 35985.52519428625}, "policy_reward_mean": {"prey_policy": 927.1065032984959, "predator_policy": 6089.100085128757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18983.808181771168, 42270.19964566711, 18135.266365769698, 15085.822940406808, 370.8189331477002, 21740.07071214021, 11746.914436045441, 18966.774427609274, 13361.729516746238, 20420.92014450332, 18322.616903109967, 21075.82646996559, 17764.794844376866, 15131.242338400047, 6291.369432447169, 4424.726699022699, 6167.382081570229, 20873.57504513195, 17056.072619083043, 14166.562976701698, 19061.139761177346, 27514.751511371087, 26277.428851135224, 14472.306351728852, 8555.84474516748, 15425.491903236883, 15209.685393615218, 14567.347369911842, 20846.715226974513, 15658.291148918557, 16494.302505096173, 6446.278004320286, 12854.573283441476, 3281.193752841376, 16868.66338847607, 10589.326177023984, 11336.314083930634, 3770.0855600138084, 16415.356667354543, 16104.270083395406, 16833.55891237228, 6694.397633542558, 16305.757943657085, 8751.703471747896, 15714.854544760808, 252.67454680462822, 18292.51258573229, 7333.746431508818, 15415.059101197563, 16649.566693435812, 17035.688606840486, 1538.4569434905893, 2615.9398331406364, 27971.857239548215, 18215.08892226674, 15055.807558610002, 19846.629153014946, 18004.232396813422, 9746.680362097499, 1912.9133103270083, 2731.1214888960917, 5557.884729513305, 18427.343998210505, 12731.766250979483, 13788.982059622964, 6192.011961338658, 11993.073169816767, 17550.015516037744, 17420.294962616303, 13160.295065718754, 12892.697791417937, 15082.890750637618, 19663.12308052304, 27715.962027798178, 8862.818983218325, 22468.521697423606, 17387.31104774666, 18305.594285766096, 16441.638280419233, 6390.578772166513, 25213.573985585583, 15426.192397619641, 17677.298708478094, 16627.84820438795, 2063.4727626466447, 5784.414663689519, 5726.460477616471, 16400.809193821737, 26352.079071747004, 19899.75917884681, 9680.65978878323, 11344.758658277933, 10903.509854064761, 13839.277051303725, 4398.190411178973, 6221.194750102201, 15361.640666780837, 8232.669773058202, 7653.828027146976, 11376.767466790332], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5453.970001166562, -177.51366123402033, -663.096610733963, -260.43160738837275, 1043.7115358650426, -738.3507298228863, -4958.025694707608, -828.1614416562369, 2676.076524613192, -1180.6152521185502, 5785.3895558311915, -1100.4316204391644, 1127.888343006433, -2006.355989953583, -801.762016079648, -1182.2925853935528, -882.5065779967146, -4353.364012943263, 4412.1020615495645, -130.8174962520038, 3498.2215190657976, -402.0679730860621, 6303.877514059831, -370.2039129574013, 686.635757225676, -132.71549228378782, 6544.917984400457, -845.570955864629, 1087.4360256171128, -4796.903222979629, 3468.0205051175576, -4783.905193228424, 2148.6789909691756, -3486.1867328404105, 3359.235046997796, -1137.8094093138627, 8489.943295213972, -981.1055182595338, 9439.53740656725, -1457.3293908803373, -1172.303453881462, -2280.198726306133, -598.8505003835677, -345.47601969170756, -2042.4803195127308, -807.0400613135631, 1361.0832941071424, -1450.8228699583988, 4328.60933488708, -3746.415788357093, 6595.7757792542125, -854.8329743140948, 3293.812097173036, -277.59188856225103, 6210.645379482656, 56.81637548902246, 5397.364566243302, -310.3578970880722, 2805.116423141684, -415.6242687241933, 3832.7208777923465, -345.546134528005, -871.7449020000774, -1402.951982362369, 1667.055981557173, -1326.6426383583848, -29.540494282020227, -2708.0312561518904, -4391.945164816855, -1295.8446890680198, 3315.321687698656, -1219.625925321823, 5670.618627197675, -2030.441942759596, 163.42477894691217, -288.4331857814196, 1296.232083639791, -918.190789208319, 4133.673442442745, -1022.3125588240526, 9008.42344319406, -660.7677272446626, 3566.5746329836616, -2920.833321845287, 1786.760510946192, -133.3753085247126, 3623.8135729080896, -929.8470467176949, 4815.32785864573, -412.3559340786112, -100.15167198737284, -1176.1268313430844, 6804.7454045610375, -252.2297785673741, 2350.16833265101, -1422.1454786300014, 6056.753622353766, -746.9900971841889, 11508.640673058158, -547.9610757185487, 6929.496118896908, -1727.645151126587, 273.19851337019213, -1920.8386173118163, 1601.9366926376897, -4846.281692235271, -460.8299738814133, -1103.8713021990677, -753.1263048140161, -2233.4733331712464, 6853.915393767718, 87.25606095196162, 5656.951756626942, -1400.007984273412, 6586.8201869209015, -2004.537230093839, 5839.240481978845, -2509.6765664878358, 5837.635510471518, -5355.647359478684, 3124.186838053966, -2033.664505508271, 4707.539598183445, -3796.2327182468275, -1093.378599296955, -456.5886136395812, 3632.0439546984403, 87.247301230213, 6233.40461034506, -949.6119683269151, 3618.354338589169, -3599.618430769986, 989.0288786033407, -2097.976207551397, 5545.64033760835, -1029.4188860183253, 7273.019457667773, -1170.9545297547577, 7608.811612425564, -2025.9936584037796, 8576.15665992222, -1420.3629682685653, 10833.57374815508, -223.58737271253472, 3872.42478902888, -460.00449669600573, -659.5502070320731, -155.3056610835465, 4515.066413356218, -2738.2876379900167, -2110.375360482316, -1870.0054195980267, 6994.50744676513, -268.4175685257091, 5968.909536139327, -698.2611080427776, 3268.60466603218, -323.31430836665953, 7257.054511011864, -945.5516861138357, -2834.8156539634283, -1772.9916739116977, -3901.391286599001, -2119.165712746432, -2876.344332972451, -777.3831674542154, 316.8678622722009, -2084.522796823923, 5019.342767371631, -2642.5811143219894, -248.46709391168946, -3731.41178207963, 3152.1488377932565, -2510.0430593272267, 7192.483395815837, -253.6244456988213, -55.83655415664485, -726.6302142574704, 451.5445719295834, -1295.4966234844424, 1417.143876008976, -1597.462392193144, 2094.768315365389, -2280.1382041331008, 6597.990823660838, -1102.8028599461306, 10111.131914301595, -535.9266528493598, 1019.8921111459894, -3539.45766037024, 329.5201768230331, -1206.2405867241507, 8471.000720213618, -106.22363448519765, 7480.2174229217635, -1005.4376551334125, 4024.6983306394964, -2795.6644012341576, 5723.072717660999, -1371.6586571943426], "policy_predator_policy_reward": [13608.034638656321, 99.31720318227575, 35985.52519428625, 7208.202669503273, 15196.989682444324, 2632.915877283246, 14064.671189029035, 6807.338887741631, -1803.9441793575695, 679.3018400106288, 12495.112347190832, 4560.000429557376, 10516.882049097805, 2108.500033894784, 15948.30937052129, 5002.519658561184, 15760.394944332344, 2837.205163353873, 14119.967755632286, 2019.6678235734953, 12065.778999160097, 3160.6843579701203, 11677.386509126554, 3464.7663597365895, 13944.847629733264, 3266.0269497016866, 6760.896230125736, 2670.999079738443, 5437.548239952635, 4563.288389857051, 7093.831097625136, -1353.2197104915779, 7864.5090220579095, -359.6191986164415, 15807.025812805066, 2845.123594642908, 8406.696028346272, 1140.5388137823256, 10080.771663366435, -3896.4167023516443, 17471.363644565612, 5042.278296799309, 24820.943530336488, 3638.134501109874, 24755.680643257103, 4371.268588704413, 11838.604943347962, 2723.440984232112, 8506.58554024933, -532.9343416118448, 11011.346556568902, -1326.797458272147, 9927.415513571448, 2266.0496714330197, 6856.587957412143, 1443.2976575280013, 13448.113005560323, 2311.59555225896, 14547.273057959543, -1278.4740634584978, 12100.79163688957, 906.3361249422835, 7210.877201856391, 1510.097686826351, 12017.345365732812, 496.8145745098934, 3132.3754399835398, 2886.39006329175, 14899.314246205327, 7657.138996155616, 6125.255899176203, 2368.3745154709427, 7061.654417446723, 634.4829820458424, 887.8705640254216, 3007.2234028228945, 15670.058513795913, 367.256859127188, 12303.50076959102, 689.4084301857444, 9197.560849076392, -711.6576526535184, 4936.042055708628, 1112.6142666955595, 13004.712504690564, 1647.6602365450801, 3060.0877247190206, 2997.6492208384975, 9283.656591797648, 2028.22602839601, 2223.8066391878847, -694.8535890527985, 8599.32621239529, 3140.6707473432525, 5920.080819979885, 485.6427575079284, 10021.360120366664, 83.93545566134546, 5012.058511437704, 676.8285846584613, 9757.93716199721, 2075.9004770729193, 2363.626295732011, 822.4707517002005, 3037.6040440204274, 2822.680788717792, 25250.182463724974, 4286.376051903739, 17087.22656531963, 4114.461994932371, 9125.658241869174, -1011.0221379787545, 16286.263126071699, -696.5777454102378, 12306.84216278785, 1115.1072771985541, 8099.246547005153, -1682.130100398649, -363.7326908569059, 1794.6578501910865, 1202.802068118414, 437.797088231983, 3726.812701246994, 919.7651483296958, 13853.202823958954, 6124.108387188073, 8134.162183980348, 878.3128110704971, 8125.733337245211, 379.4560803595832, 6701.867886265074, -528.5918327455919, 12229.854758650063, 872.165740114742, 11927.35038215953, 1106.4436822882058, 13341.45953405031, -2023.2294993470134, 5326.099880965025, 2251.377230731924, 6329.924655469467, -593.02055570521, 4125.803204400441, 347.1011707945874, 11213.623419288275, 5037.079368901844, 21904.903849143186, 6625.914046770549, 9715.177053186391, -2629.1368453342816, 20144.272351759693, 6304.630125744264, 7601.5971238249695, 3059.624045682309, 12378.515466829893, 656.4303908396249, 13602.617061698445, -106.26913894476901, 5100.179507570224, -5021.103560301733, 26355.38466624463, 3465.99664721609, 11946.299427700797, 9500.44996926429, 12964.826284167355, 8366.199924737419, 12116.33833237734, 6279.164806562347, 1335.1855428130318, -1648.4744332160308, 5845.236197326737, 3919.0573423541023, 3733.1183553920932, 1351.2363437583404, 11775.745233144577, -2313.794989439821, 21845.683483226592, 5288.862356934535, 18678.91964651666, 2064.791583885006, 6450.298538901966, 3410.6797660654393, 6581.243497114774, 4948.8850499308655, 5269.733432939231, 138.5884574108208, 3289.1770918293482, 974.894698022161, 5692.9112253322355, 1224.8447350709976, 4031.407230358133, 3066.507929645189, 8670.121034278638, -1673.2574532262752, 4494.362741703651, -2736.472736433797, 1587.3565741273721, 4837.437523614265, 8001.541958471514, -976.1885521478569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7061454512658151, "mean_inference_ms": 1.5223317398998932, "mean_action_processing_ms": 0.29903525393696506, "mean_env_wait_ms": 0.13621373140111215, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004211306571960449, "StateBufferConnector_ms": 0.0037497282028198242, "ViewRequirementAgentConnector_ms": 0.10466861724853516}, "num_episodes": 18, "episode_return_max": 42270.19964566711, "episode_return_min": 252.67454680462822, "episode_return_mean": 14032.413176854505, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.14830558723577, "num_env_steps_trained_throughput_per_sec": 319.14830558723577, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 13614.244, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13614.197, "sample_time_ms": 1110.099, "learn_time_ms": 12486.834, "learn_throughput": 320.337, "synch_weights_time_ms": 15.909}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "6751e_00000", "date": "2024-08-11_19-27-02", "timestamp": 1723418822, "time_this_iter_s": 12.559936046600342, "time_total_s": 1187.9175689220428, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacd280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1187.9175689220428, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 46.43333333333334, "ram_util_percent": 81.54444444444442}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4871811410027837, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.887526312580816, "policy_loss": -0.003929722439325242, "vf_loss": 8.891436562210163, "vf_explained_var": -0.006246173571026514, "kl": 0.006236075337434188, "entropy": 0.5253061218867227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6823390099106642, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.070490677646859, "policy_loss": -0.0056267509451283825, "vf_loss": 9.075573928772457, "vf_explained_var": 4.355639376968303e-05, "kl": 0.00543446512218021, "entropy": 0.8118107258642792, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 34137.540789961815, "episode_reward_min": 252.67454680462822, "episode_reward_mean": 13670.79877254091, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5355.647359478684, "predator_policy": -5021.103560301733}, "policy_reward_max": {"prey_policy": 11508.640673058158, "predator_policy": 31798.989192377983}, "policy_reward_mean": {"prey_policy": 934.0167706363749, "predator_policy": 5901.382615634079}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17056.072619083043, 14166.562976701698, 19061.139761177346, 27514.751511371087, 26277.428851135224, 14472.306351728852, 8555.84474516748, 15425.491903236883, 15209.685393615218, 14567.347369911842, 20846.715226974513, 15658.291148918557, 16494.302505096173, 6446.278004320286, 12854.573283441476, 3281.193752841376, 16868.66338847607, 10589.326177023984, 11336.314083930634, 3770.0855600138084, 16415.356667354543, 16104.270083395406, 16833.55891237228, 6694.397633542558, 16305.757943657085, 8751.703471747896, 15714.854544760808, 252.67454680462822, 18292.51258573229, 7333.746431508818, 15415.059101197563, 16649.566693435812, 17035.688606840486, 1538.4569434905893, 2615.9398331406364, 27971.857239548215, 18215.08892226674, 15055.807558610002, 19846.629153014946, 18004.232396813422, 9746.680362097499, 1912.9133103270083, 2731.1214888960917, 5557.884729513305, 18427.343998210505, 12731.766250979483, 13788.982059622964, 6192.011961338658, 11993.073169816767, 17550.015516037744, 17420.294962616303, 13160.295065718754, 12892.697791417937, 15082.890750637618, 19663.12308052304, 27715.962027798178, 8862.818983218325, 22468.521697423606, 17387.31104774666, 18305.594285766096, 16441.638280419233, 6390.578772166513, 25213.573985585583, 15426.192397619641, 17677.298708478094, 16627.84820438795, 2063.4727626466447, 5784.414663689519, 5726.460477616471, 16400.809193821737, 26352.079071747004, 19899.75917884681, 9680.65978878323, 11344.758658277933, 10903.509854064761, 13839.277051303725, 4398.190411178973, 6221.194750102201, 15361.640666780837, 8232.669773058202, 7653.828027146976, 11376.767466790332, 16836.948559118122, 9050.98053184506, 628.4787433032233, 15255.980563443545, 680.2673103683393, 6208.6572771542005, 31336.746900491038, 26386.65129723998, 16767.495837062284, 34137.540789961815, 6121.370155837284, 13695.477349761415, 21171.110113233684, 22963.828529357645, 18641.7462389164, 3431.909495021322, 4037.933139816412, 7619.29585454008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [8489.943295213972, -981.1055182595338, 9439.53740656725, -1457.3293908803373, -1172.303453881462, -2280.198726306133, -598.8505003835677, -345.47601969170756, -2042.4803195127308, -807.0400613135631, 1361.0832941071424, -1450.8228699583988, 4328.60933488708, -3746.415788357093, 6595.7757792542125, -854.8329743140948, 3293.812097173036, -277.59188856225103, 6210.645379482656, 56.81637548902246, 5397.364566243302, -310.3578970880722, 2805.116423141684, -415.6242687241933, 3832.7208777923465, -345.546134528005, -871.7449020000774, -1402.951982362369, 1667.055981557173, -1326.6426383583848, -29.540494282020227, -2708.0312561518904, -4391.945164816855, -1295.8446890680198, 3315.321687698656, -1219.625925321823, 5670.618627197675, -2030.441942759596, 163.42477894691217, -288.4331857814196, 1296.232083639791, -918.190789208319, 4133.673442442745, -1022.3125588240526, 9008.42344319406, -660.7677272446626, 3566.5746329836616, -2920.833321845287, 1786.760510946192, -133.3753085247126, 3623.8135729080896, -929.8470467176949, 4815.32785864573, -412.3559340786112, -100.15167198737284, -1176.1268313430844, 6804.7454045610375, -252.2297785673741, 2350.16833265101, -1422.1454786300014, 6056.753622353766, -746.9900971841889, 11508.640673058158, -547.9610757185487, 6929.496118896908, -1727.645151126587, 273.19851337019213, -1920.8386173118163, 1601.9366926376897, -4846.281692235271, -460.8299738814133, -1103.8713021990677, -753.1263048140161, -2233.4733331712464, 6853.915393767718, 87.25606095196162, 5656.951756626942, -1400.007984273412, 6586.8201869209015, -2004.537230093839, 5839.240481978845, -2509.6765664878358, 5837.635510471518, -5355.647359478684, 3124.186838053966, -2033.664505508271, 4707.539598183445, -3796.2327182468275, -1093.378599296955, -456.5886136395812, 3632.0439546984403, 87.247301230213, 6233.40461034506, -949.6119683269151, 3618.354338589169, -3599.618430769986, 989.0288786033407, -2097.976207551397, 5545.64033760835, -1029.4188860183253, 7273.019457667773, -1170.9545297547577, 7608.811612425564, -2025.9936584037796, 8576.15665992222, -1420.3629682685653, 10833.57374815508, -223.58737271253472, 3872.42478902888, -460.00449669600573, -659.5502070320731, -155.3056610835465, 4515.066413356218, -2738.2876379900167, -2110.375360482316, -1870.0054195980267, 6994.50744676513, -268.4175685257091, 5968.909536139327, -698.2611080427776, 3268.60466603218, -323.31430836665953, 7257.054511011864, -945.5516861138357, -2834.8156539634283, -1772.9916739116977, -3901.391286599001, -2119.165712746432, -2876.344332972451, -777.3831674542154, 316.8678622722009, -2084.522796823923, 5019.342767371631, -2642.5811143219894, -248.46709391168946, -3731.41178207963, 3152.1488377932565, -2510.0430593272267, 7192.483395815837, -253.6244456988213, -55.83655415664485, -726.6302142574704, 451.5445719295834, -1295.4966234844424, 1417.143876008976, -1597.462392193144, 2094.768315365389, -2280.1382041331008, 6597.990823660838, -1102.8028599461306, 10111.131914301595, -535.9266528493598, 1019.8921111459894, -3539.45766037024, 329.5201768230331, -1206.2405867241507, 8471.000720213618, -106.22363448519765, 7480.2174229217635, -1005.4376551334125, 4024.6983306394964, -2795.6644012341576, 5723.072717660999, -1371.6586571943426, 9466.550496553149, -973.7108615704904, 2333.750690656281, -1522.3433108447202, 4805.826409888214, -2648.9689252726134, 3944.412010356604, -1187.148338914099, 6029.625808117244, -4203.8694691261235, -4122.263953877628, -1271.704643901681, -617.4489357946165, -178.31403312174544, -3597.1143137565427, -1107.5979046814607, 828.526773662419, -1123.7210756662153, -1112.9387954999331, -715.135107722808, 3897.3796863737566, -1008.27513647408, -695.4104372258004, -966.8218001100797, 8912.030604009358, -47.7026131677362, -2674.8103209323554, -2653.922581153419, 6678.374719749387, -1921.3861913036367, 4742.530862475609, -1148.025750921965, 2953.917887248478, -2459.811308300705, 672.8525489209842, -3548.206044883666], "policy_predator_policy_reward": [8406.696028346272, 1140.5388137823256, 10080.771663366435, -3896.4167023516443, 17471.363644565612, 5042.278296799309, 24820.943530336488, 3638.134501109874, 24755.680643257103, 4371.268588704413, 11838.604943347962, 2723.440984232112, 8506.58554024933, -532.9343416118448, 11011.346556568902, -1326.797458272147, 9927.415513571448, 2266.0496714330197, 6856.587957412143, 1443.2976575280013, 13448.113005560323, 2311.59555225896, 14547.273057959543, -1278.4740634584978, 12100.79163688957, 906.3361249422835, 7210.877201856391, 1510.097686826351, 12017.345365732812, 496.8145745098934, 3132.3754399835398, 2886.39006329175, 14899.314246205327, 7657.138996155616, 6125.255899176203, 2368.3745154709427, 7061.654417446723, 634.4829820458424, 887.8705640254216, 3007.2234028228945, 15670.058513795913, 367.256859127188, 12303.50076959102, 689.4084301857444, 9197.560849076392, -711.6576526535184, 4936.042055708628, 1112.6142666955595, 13004.712504690564, 1647.6602365450801, 3060.0877247190206, 2997.6492208384975, 9283.656591797648, 2028.22602839601, 2223.8066391878847, -694.8535890527985, 8599.32621239529, 3140.6707473432525, 5920.080819979885, 485.6427575079284, 10021.360120366664, 83.93545566134546, 5012.058511437704, 676.8285846584613, 9757.93716199721, 2075.9004770729193, 2363.626295732011, 822.4707517002005, 3037.6040440204274, 2822.680788717792, 25250.182463724974, 4286.376051903739, 17087.22656531963, 4114.461994932371, 9125.658241869174, -1011.0221379787545, 16286.263126071699, -696.5777454102378, 12306.84216278785, 1115.1072771985541, 8099.246547005153, -1682.130100398649, -363.7326908569059, 1794.6578501910865, 1202.802068118414, 437.797088231983, 3726.812701246994, 919.7651483296958, 13853.202823958954, 6124.108387188073, 8134.162183980348, 878.3128110704971, 8125.733337245211, 379.4560803595832, 6701.867886265074, -528.5918327455919, 12229.854758650063, 872.165740114742, 11927.35038215953, 1106.4436822882058, 13341.45953405031, -2023.2294993470134, 5326.099880965025, 2251.377230731924, 6329.924655469467, -593.02055570521, 4125.803204400441, 347.1011707945874, 11213.623419288275, 5037.079368901844, 21904.903849143186, 6625.914046770549, 9715.177053186391, -2629.1368453342816, 20144.272351759693, 6304.630125744264, 7601.5971238249695, 3059.624045682309, 12378.515466829893, 656.4303908396249, 13602.617061698445, -106.26913894476901, 5100.179507570224, -5021.103560301733, 26355.38466624463, 3465.99664721609, 11946.299427700797, 9500.44996926429, 12964.826284167355, 8366.199924737419, 12116.33833237734, 6279.164806562347, 1335.1855428130318, -1648.4744332160308, 5845.236197326737, 3919.0573423541023, 3733.1183553920932, 1351.2363437583404, 11775.745233144577, -2313.794989439821, 21845.683483226592, 5288.862356934535, 18678.91964651666, 2064.791583885006, 6450.298538901966, 3410.6797660654393, 6581.243497114774, 4948.8850499308655, 5269.733432939231, 138.5884574108208, 3289.1770918293482, 974.894698022161, 5692.9112253322355, 1224.8447350709976, 4031.407230358133, 3066.507929645189, 8670.121034278638, -1673.2574532262752, 4494.362741703651, -2736.472736433797, 1587.3565741273721, 4837.437523614265, 8001.541958471514, -976.1885521478569, 7818.912637972326, 525.1962861630868, 8225.427992953515, 14.145159079970739, -2628.196775115909, 1099.8180338035288, 13754.821935899246, -1256.105043898149, 2229.7739169064203, -3375.2629455292035, 6376.316724564158, 5226.3091503693595, 29485.675375333783, 2646.8344940735983, 24469.236068485057, 6622.127447192929, 13480.856797656334, 3581.8333414097183, 31798.989192377983, 4166.625500806571, 5769.128953902713, -2536.8633479651053, 8739.886502347304, 6617.82308474998, 8721.157433115573, 3585.6246892765475, 21211.095517154405, 7081.465914289008, 12378.173103320776, 1506.5846071498302, 708.5082693657516, -871.1038858980825, 3281.527928253785, 262.2986326148548, 3468.8203096215248, 7025.829040881243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7049293364043879, "mean_inference_ms": 1.5193075770597477, "mean_action_processing_ms": 0.2984485475748146, "mean_env_wait_ms": 0.13594722819089114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036640167236328125, "StateBufferConnector_ms": 0.0033402442932128906, "ViewRequirementAgentConnector_ms": 0.1038438081741333}, "num_episodes": 18, "episode_return_max": 34137.540789961815, "episode_return_min": 252.67454680462822, "episode_return_mean": 13670.79877254091, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.612904298697, "num_env_steps_trained_throughput_per_sec": 315.612904298697, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 13468.617, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13468.572, "sample_time_ms": 1087.37, "learn_time_ms": 12363.564, "learn_throughput": 323.531, "synch_weights_time_ms": 16.204}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "6751e_00000", "date": "2024-08-11_19-27-15", "timestamp": 1723418835, "time_this_iter_s": 12.729722261428833, "time_total_s": 1200.6472911834717, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1200.6472911834717, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 49.205555555555556, "ram_util_percent": 81.5611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.41190076943822007, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.369081462123406, "policy_loss": -0.007507131171471898, "vf_loss": 8.376527575336436, "vf_explained_var": -0.0054131236656633, "kl": 0.019529073856919276, "entropy": 0.5539483542795535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7099323012920283, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.28128188602508, "policy_loss": -0.006605966686561862, "vf_loss": 9.28696934129826, "vf_explained_var": 0.00012873143115371623, "kl": 0.009184753052967183, "entropy": 0.7947796713738214, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 34137.540789961815, "episode_reward_min": 252.67454680462822, "episode_reward_mean": 13462.319284024637, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5978.898620943573, "predator_policy": -5021.103560301733}, "policy_reward_max": {"prey_policy": 11508.640673058158, "predator_policy": 31798.989192377983}, "policy_reward_mean": {"prey_policy": 963.1247928460053, "predator_policy": 5768.034849166313}, "custom_metrics": {}, "hist_stats": {"episode_reward": [16833.55891237228, 6694.397633542558, 16305.757943657085, 8751.703471747896, 15714.854544760808, 252.67454680462822, 18292.51258573229, 7333.746431508818, 15415.059101197563, 16649.566693435812, 17035.688606840486, 1538.4569434905893, 2615.9398331406364, 27971.857239548215, 18215.08892226674, 15055.807558610002, 19846.629153014946, 18004.232396813422, 9746.680362097499, 1912.9133103270083, 2731.1214888960917, 5557.884729513305, 18427.343998210505, 12731.766250979483, 13788.982059622964, 6192.011961338658, 11993.073169816767, 17550.015516037744, 17420.294962616303, 13160.295065718754, 12892.697791417937, 15082.890750637618, 19663.12308052304, 27715.962027798178, 8862.818983218325, 22468.521697423606, 17387.31104774666, 18305.594285766096, 16441.638280419233, 6390.578772166513, 25213.573985585583, 15426.192397619641, 17677.298708478094, 16627.84820438795, 2063.4727626466447, 5784.414663689519, 5726.460477616471, 16400.809193821737, 26352.079071747004, 19899.75917884681, 9680.65978878323, 11344.758658277933, 10903.509854064761, 13839.277051303725, 4398.190411178973, 6221.194750102201, 15361.640666780837, 8232.669773058202, 7653.828027146976, 11376.767466790332, 16836.948559118122, 9050.98053184506, 628.4787433032233, 15255.980563443545, 680.2673103683393, 6208.6572771542005, 31336.746900491038, 26386.65129723998, 16767.495837062284, 34137.540789961815, 6121.370155837284, 13695.477349761415, 21171.110113233684, 22963.828529357645, 18641.7462389164, 3431.909495021322, 4037.933139816412, 7619.29585454008, 8714.70040478073, 15253.21132185334, 21342.35009147713, 10818.493353363292, 6135.271073485656, 14203.497680349314, 19384.264497540928, 15358.172846969781, 11585.459215966268, 14861.843872807744, 11110.336353910921, 11409.715518240311, 13378.339358392614, 18788.37750915573, 1092.1966308943881, 14515.690026275019, 18855.04541521561, 24486.55783818536, 17703.293168559667, 10195.498065157188, 4261.479561374045, 18670.258709333368], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [9008.42344319406, -660.7677272446626, 3566.5746329836616, -2920.833321845287, 1786.760510946192, -133.3753085247126, 3623.8135729080896, -929.8470467176949, 4815.32785864573, -412.3559340786112, -100.15167198737284, -1176.1268313430844, 6804.7454045610375, -252.2297785673741, 2350.16833265101, -1422.1454786300014, 6056.753622353766, -746.9900971841889, 11508.640673058158, -547.9610757185487, 6929.496118896908, -1727.645151126587, 273.19851337019213, -1920.8386173118163, 1601.9366926376897, -4846.281692235271, -460.8299738814133, -1103.8713021990677, -753.1263048140161, -2233.4733331712464, 6853.915393767718, 87.25606095196162, 5656.951756626942, -1400.007984273412, 6586.8201869209015, -2004.537230093839, 5839.240481978845, -2509.6765664878358, 5837.635510471518, -5355.647359478684, 3124.186838053966, -2033.664505508271, 4707.539598183445, -3796.2327182468275, -1093.378599296955, -456.5886136395812, 3632.0439546984403, 87.247301230213, 6233.40461034506, -949.6119683269151, 3618.354338589169, -3599.618430769986, 989.0288786033407, -2097.976207551397, 5545.64033760835, -1029.4188860183253, 7273.019457667773, -1170.9545297547577, 7608.811612425564, -2025.9936584037796, 8576.15665992222, -1420.3629682685653, 10833.57374815508, -223.58737271253472, 3872.42478902888, -460.00449669600573, -659.5502070320731, -155.3056610835465, 4515.066413356218, -2738.2876379900167, -2110.375360482316, -1870.0054195980267, 6994.50744676513, -268.4175685257091, 5968.909536139327, -698.2611080427776, 3268.60466603218, -323.31430836665953, 7257.054511011864, -945.5516861138357, -2834.8156539634283, -1772.9916739116977, -3901.391286599001, -2119.165712746432, -2876.344332972451, -777.3831674542154, 316.8678622722009, -2084.522796823923, 5019.342767371631, -2642.5811143219894, -248.46709391168946, -3731.41178207963, 3152.1488377932565, -2510.0430593272267, 7192.483395815837, -253.6244456988213, -55.83655415664485, -726.6302142574704, 451.5445719295834, -1295.4966234844424, 1417.143876008976, -1597.462392193144, 2094.768315365389, -2280.1382041331008, 6597.990823660838, -1102.8028599461306, 10111.131914301595, -535.9266528493598, 1019.8921111459894, -3539.45766037024, 329.5201768230331, -1206.2405867241507, 8471.000720213618, -106.22363448519765, 7480.2174229217635, -1005.4376551334125, 4024.6983306394964, -2795.6644012341576, 5723.072717660999, -1371.6586571943426, 9466.550496553149, -973.7108615704904, 2333.750690656281, -1522.3433108447202, 4805.826409888214, -2648.9689252726134, 3944.412010356604, -1187.148338914099, 6029.625808117244, -4203.8694691261235, -4122.263953877628, -1271.704643901681, -617.4489357946165, -178.31403312174544, -3597.1143137565427, -1107.5979046814607, 828.526773662419, -1123.7210756662153, -1112.9387954999331, -715.135107722808, 3897.3796863737566, -1008.27513647408, -695.4104372258004, -966.8218001100797, 8912.030604009358, -47.7026131677362, -2674.8103209323554, -2653.922581153419, 6678.374719749387, -1921.3861913036367, 4742.530862475609, -1148.025750921965, 2953.917887248478, -2459.811308300705, 672.8525489209842, -3548.206044883666, -1007.3256667550221, -2467.8996102982283, 6269.36591847067, -1473.8673934385988, -1387.0231395445453, -1113.9630784311998, 7275.697070380344, -2234.1217576578124, 4175.3942074619035, -3872.2415362127113, 3431.6309219380673, -972.938502549272, 5540.064671817588, -524.9738018684818, -2607.760731866553, -1018.9203177545946, 2207.754963860166, -841.7758774187081, 7362.322603667151, -1357.2597939955851, -224.35466054333125, -1140.9048626499275, -5978.898620943573, -4936.234497889668, 10178.78257915261, -671.4076627184396, 845.8245352816664, -1502.4788958221409, 6301.279811895583, -931.7223274990671, 2533.456221314823, -1034.469285512161, 6333.929340984269, -801.1855731423935, 138.86646972059174, -749.8252117911978, 4055.786238676414, -1.4894932766964808, 4029.314934972962, -772.9542897856599, 3337.1450176967705, -484.9108057925062, 5684.035145120338, -302.0687251890348], "policy_predator_policy_reward": [9197.560849076392, -711.6576526535184, 4936.042055708628, 1112.6142666955595, 13004.712504690564, 1647.6602365450801, 3060.0877247190206, 2997.6492208384975, 9283.656591797648, 2028.22602839601, 2223.8066391878847, -694.8535890527985, 8599.32621239529, 3140.6707473432525, 5920.080819979885, 485.6427575079284, 10021.360120366664, 83.93545566134546, 5012.058511437704, 676.8285846584613, 9757.93716199721, 2075.9004770729193, 2363.626295732011, 822.4707517002005, 3037.6040440204274, 2822.680788717792, 25250.182463724974, 4286.376051903739, 17087.22656531963, 4114.461994932371, 9125.658241869174, -1011.0221379787545, 16286.263126071699, -696.5777454102378, 12306.84216278785, 1115.1072771985541, 8099.246547005153, -1682.130100398649, -363.7326908569059, 1794.6578501910865, 1202.802068118414, 437.797088231983, 3726.812701246994, 919.7651483296958, 13853.202823958954, 6124.108387188073, 8134.162183980348, 878.3128110704971, 8125.733337245211, 379.4560803595832, 6701.867886265074, -528.5918327455919, 12229.854758650063, 872.165740114742, 11927.35038215953, 1106.4436822882058, 13341.45953405031, -2023.2294993470134, 5326.099880965025, 2251.377230731924, 6329.924655469467, -593.02055570521, 4125.803204400441, 347.1011707945874, 11213.623419288275, 5037.079368901844, 21904.903849143186, 6625.914046770549, 9715.177053186391, -2629.1368453342816, 20144.272351759693, 6304.630125744264, 7601.5971238249695, 3059.624045682309, 12378.515466829893, 656.4303908396249, 13602.617061698445, -106.26913894476901, 5100.179507570224, -5021.103560301733, 26355.38466624463, 3465.99664721609, 11946.299427700797, 9500.44996926429, 12964.826284167355, 8366.199924737419, 12116.33833237734, 6279.164806562347, 1335.1855428130318, -1648.4744332160308, 5845.236197326737, 3919.0573423541023, 3733.1183553920932, 1351.2363437583404, 11775.745233144577, -2313.794989439821, 21845.683483226592, 5288.862356934535, 18678.91964651666, 2064.791583885006, 6450.298538901966, 3410.6797660654393, 6581.243497114774, 4948.8850499308655, 5269.733432939231, 138.5884574108208, 3289.1770918293482, 974.894698022161, 5692.9112253322355, 1224.8447350709976, 4031.407230358133, 3066.507929645189, 8670.121034278638, -1673.2574532262752, 4494.362741703651, -2736.472736433797, 1587.3565741273721, 4837.437523614265, 8001.541958471514, -976.1885521478569, 7818.912637972326, 525.1962861630868, 8225.427992953515, 14.145159079970739, -2628.196775115909, 1099.8180338035288, 13754.821935899246, -1256.105043898149, 2229.7739169064203, -3375.2629455292035, 6376.316724564158, 5226.3091503693595, 29485.675375333783, 2646.8344940735983, 24469.236068485057, 6622.127447192929, 13480.856797656334, 3581.8333414097183, 31798.989192377983, 4166.625500806571, 5769.128953902713, -2536.8633479651053, 8739.886502347304, 6617.82308474998, 8721.157433115573, 3585.6246892765475, 21211.095517154405, 7081.465914289008, 12378.173103320776, 1506.5846071498302, 708.5082693657516, -871.1038858980825, 3281.527928253785, 262.2986326148548, 3468.8203096215248, 7025.829040881243, 2738.308410919276, 9451.617270914707, 8668.523417145443, 1789.1893796758256, 16327.312896358046, 7516.0234130947865, 4125.119499214969, 1651.7985414257662, 4177.031694600553, 1655.0867076358995, 10287.41748080417, 1457.3877801563106, 12024.479959733375, 2344.6936678584334, 11828.649661702057, 7156.204234888886, 6011.191217162818, 4208.288912361983, 9030.169422515424, -173.38835937923713, 5338.9924982236535, 7136.603378880539, 11048.592462202107, 11276.256174871434, 5564.580065043149, -1693.6156230846607, 18568.310156917378, 876.7217127788252, -3757.2286783504624, -520.132175151662, 11414.066654185117, 1602.6364362872323, 13031.439954074573, 290.8616932991247, 24400.688830605726, 696.8277496502392, 13823.786938035808, -174.79051487583334, 6149.286369954262, 789.8510500156306, 3166.634865348367, -1757.3895158785892, 13231.168547755024, 57.12374164700401]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7034431078554181, "mean_inference_ms": 1.5153829681197133, "mean_action_processing_ms": 0.29765925228059237, "mean_env_wait_ms": 0.13559764100715785, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036699771881103516, "StateBufferConnector_ms": 0.003339052200317383, "ViewRequirementAgentConnector_ms": 0.10280227661132812}, "num_episodes": 22, "episode_return_max": 34137.540789961815, "episode_return_min": 252.67454680462822, "episode_return_mean": 13462.319284024637, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.262908536393, "num_env_steps_trained_throughput_per_sec": 315.262908536393, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 13341.176, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13341.131, "sample_time_ms": 1077.937, "learn_time_ms": 12246.068, "learn_throughput": 326.635, "synch_weights_time_ms": 15.669}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "6751e_00000", "date": "2024-08-11_19-27-27", "timestamp": 1723418847, "time_this_iter_s": 12.692684173583984, "time_total_s": 1213.3399753570557, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eada430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1213.3399753570557, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 46.95000000000001, "ram_util_percent": 81.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4898808951415713, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.542745327823377, "policy_loss": -0.004677155611928178, "vf_loss": 8.547398405226451, "vf_explained_var": -0.0016722316464419088, "kl": 0.007694848988453599, "entropy": 0.5678390518540428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7402351145391111, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.20069111465777, "policy_loss": -0.004080131276949215, "vf_loss": 9.204141146543796, "vf_explained_var": -8.898103047931006e-05, "kl": 0.006300867846358444, "entropy": 0.8059526725105508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 44226.06226067444, "episode_reward_min": 497.1314680219556, "episode_reward_mean": 13913.352239125497, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5978.898620943573, "predator_policy": -5021.103560301733}, "policy_reward_max": {"prey_policy": 10833.57374815508, "predator_policy": 32437.965600816617}, "policy_reward_mean": {"prey_policy": 967.2706719962906, "predator_policy": 5989.405447566458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [9746.680362097499, 1912.9133103270083, 2731.1214888960917, 5557.884729513305, 18427.343998210505, 12731.766250979483, 13788.982059622964, 6192.011961338658, 11993.073169816767, 17550.015516037744, 17420.294962616303, 13160.295065718754, 12892.697791417937, 15082.890750637618, 19663.12308052304, 27715.962027798178, 8862.818983218325, 22468.521697423606, 17387.31104774666, 18305.594285766096, 16441.638280419233, 6390.578772166513, 25213.573985585583, 15426.192397619641, 17677.298708478094, 16627.84820438795, 2063.4727626466447, 5784.414663689519, 5726.460477616471, 16400.809193821737, 26352.079071747004, 19899.75917884681, 9680.65978878323, 11344.758658277933, 10903.509854064761, 13839.277051303725, 4398.190411178973, 6221.194750102201, 15361.640666780837, 8232.669773058202, 7653.828027146976, 11376.767466790332, 16836.948559118122, 9050.98053184506, 628.4787433032233, 15255.980563443545, 680.2673103683393, 6208.6572771542005, 31336.746900491038, 26386.65129723998, 16767.495837062284, 34137.540789961815, 6121.370155837284, 13695.477349761415, 21171.110113233684, 22963.828529357645, 18641.7462389164, 3431.909495021322, 4037.933139816412, 7619.29585454008, 8714.70040478073, 15253.21132185334, 21342.35009147713, 10818.493353363292, 6135.271073485656, 14203.497680349314, 19384.264497540928, 15358.172846969781, 11585.459215966268, 14861.843872807744, 11110.336353910921, 11409.715518240311, 13378.339358392614, 18788.37750915573, 1092.1966308943881, 14515.690026275019, 18855.04541521561, 24486.55783818536, 17703.293168559667, 10195.498065157188, 4261.479561374045, 18670.258709333368, 15925.046294002312, 44226.06226067444, 18513.410460054358, 14885.93199443964, 14269.2424932243, 14107.144269157441, 9008.95976459601, 15792.811071297396, 15811.120745360968, 16752.253350905234, 19173.352148984763, 15947.151945768946, 23746.232660046415, 497.1314680219556, 15851.784507089948, 7140.9762521727, 7515.570551291874, 18466.645791482242], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5839.240481978845, -2509.6765664878358, 5837.635510471518, -5355.647359478684, 3124.186838053966, -2033.664505508271, 4707.539598183445, -3796.2327182468275, -1093.378599296955, -456.5886136395812, 3632.0439546984403, 87.247301230213, 6233.40461034506, -949.6119683269151, 3618.354338589169, -3599.618430769986, 989.0288786033407, -2097.976207551397, 5545.64033760835, -1029.4188860183253, 7273.019457667773, -1170.9545297547577, 7608.811612425564, -2025.9936584037796, 8576.15665992222, -1420.3629682685653, 10833.57374815508, -223.58737271253472, 3872.42478902888, -460.00449669600573, -659.5502070320731, -155.3056610835465, 4515.066413356218, -2738.2876379900167, -2110.375360482316, -1870.0054195980267, 6994.50744676513, -268.4175685257091, 5968.909536139327, -698.2611080427776, 3268.60466603218, -323.31430836665953, 7257.054511011864, -945.5516861138357, -2834.8156539634283, -1772.9916739116977, -3901.391286599001, -2119.165712746432, -2876.344332972451, -777.3831674542154, 316.8678622722009, -2084.522796823923, 5019.342767371631, -2642.5811143219894, -248.46709391168946, -3731.41178207963, 3152.1488377932565, -2510.0430593272267, 7192.483395815837, -253.6244456988213, -55.83655415664485, -726.6302142574704, 451.5445719295834, -1295.4966234844424, 1417.143876008976, -1597.462392193144, 2094.768315365389, -2280.1382041331008, 6597.990823660838, -1102.8028599461306, 10111.131914301595, -535.9266528493598, 1019.8921111459894, -3539.45766037024, 329.5201768230331, -1206.2405867241507, 8471.000720213618, -106.22363448519765, 7480.2174229217635, -1005.4376551334125, 4024.6983306394964, -2795.6644012341576, 5723.072717660999, -1371.6586571943426, 9466.550496553149, -973.7108615704904, 2333.750690656281, -1522.3433108447202, 4805.826409888214, -2648.9689252726134, 3944.412010356604, -1187.148338914099, 6029.625808117244, -4203.8694691261235, -4122.263953877628, -1271.704643901681, -617.4489357946165, -178.31403312174544, -3597.1143137565427, -1107.5979046814607, 828.526773662419, -1123.7210756662153, -1112.9387954999331, -715.135107722808, 3897.3796863737566, -1008.27513647408, -695.4104372258004, -966.8218001100797, 8912.030604009358, -47.7026131677362, -2674.8103209323554, -2653.922581153419, 6678.374719749387, -1921.3861913036367, 4742.530862475609, -1148.025750921965, 2953.917887248478, -2459.811308300705, 672.8525489209842, -3548.206044883666, -1007.3256667550221, -2467.8996102982283, 6269.36591847067, -1473.8673934385988, -1387.0231395445453, -1113.9630784311998, 7275.697070380344, -2234.1217576578124, 4175.3942074619035, -3872.2415362127113, 3431.6309219380673, -972.938502549272, 5540.064671817588, -524.9738018684818, -2607.760731866553, -1018.9203177545946, 2207.754963860166, -841.7758774187081, 7362.322603667151, -1357.2597939955851, -224.35466054333125, -1140.9048626499275, -5978.898620943573, -4936.234497889668, 10178.78257915261, -671.4076627184396, 845.8245352816664, -1502.4788958221409, 6301.279811895583, -931.7223274990671, 2533.456221314823, -1034.469285512161, 6333.929340984269, -801.1855731423935, 138.86646972059174, -749.8252117911978, 4055.786238676414, -1.4894932766964808, 4029.314934972962, -772.9542897856599, 3337.1450176967705, -484.9108057925062, 5684.035145120338, -302.0687251890348, 6773.226110310019, -282.50345502597446, -187.62033638810334, -295.9009450604643, 2982.320747371317, -945.7215932963583, 9816.153493786596, -1207.1556584169393, 5388.329741882025, -751.3181132149675, 4640.416635440471, -177.94691562511622, 6101.382255125598, -1532.9438028115733, 3265.7770898234344, -1585.9918493081937, 3329.8180520603787, -359.88033886803186, 4221.107013170573, -945.6269843103576, 7482.777974012754, -238.75594953103186, 3268.980273153072, -1267.2302096517762, 118.9635914302713, -341.33501245337436, 4552.746844389287, -3099.425180651077, 1305.0920030922025, -358.7316598966905, 2817.9712363092094, -3355.8904796754814, 2675.4667296610824, -1395.660980708287, 3007.078734312422, -831.4063168540843], "policy_predator_policy_reward": [8099.246547005153, -1682.130100398649, -363.7326908569059, 1794.6578501910865, 1202.802068118414, 437.797088231983, 3726.812701246994, 919.7651483296958, 13853.202823958954, 6124.108387188073, 8134.162183980348, 878.3128110704971, 8125.733337245211, 379.4560803595832, 6701.867886265074, -528.5918327455919, 12229.854758650063, 872.165740114742, 11927.35038215953, 1106.4436822882058, 13341.45953405031, -2023.2294993470134, 5326.099880965025, 2251.377230731924, 6329.924655469467, -593.02055570521, 4125.803204400441, 347.1011707945874, 11213.623419288275, 5037.079368901844, 21904.903849143186, 6625.914046770549, 9715.177053186391, -2629.1368453342816, 20144.272351759693, 6304.630125744264, 7601.5971238249695, 3059.624045682309, 12378.515466829893, 656.4303908396249, 13602.617061698445, -106.26913894476901, 5100.179507570224, -5021.103560301733, 26355.38466624463, 3465.99664721609, 11946.299427700797, 9500.44996926429, 12964.826284167355, 8366.199924737419, 12116.33833237734, 6279.164806562347, 1335.1855428130318, -1648.4744332160308, 5845.236197326737, 3919.0573423541023, 3733.1183553920932, 1351.2363437583404, 11775.745233144577, -2313.794989439821, 21845.683483226592, 5288.862356934535, 18678.91964651666, 2064.791583885006, 6450.298538901966, 3410.6797660654393, 6581.243497114774, 4948.8850499308655, 5269.733432939231, 138.5884574108208, 3289.1770918293482, 974.894698022161, 5692.9112253322355, 1224.8447350709976, 4031.407230358133, 3066.507929645189, 8670.121034278638, -1673.2574532262752, 4494.362741703651, -2736.472736433797, 1587.3565741273721, 4837.437523614265, 8001.541958471514, -976.1885521478569, 7818.912637972326, 525.1962861630868, 8225.427992953515, 14.145159079970739, -2628.196775115909, 1099.8180338035288, 13754.821935899246, -1256.105043898149, 2229.7739169064203, -3375.2629455292035, 6376.316724564158, 5226.3091503693595, 29485.675375333783, 2646.8344940735983, 24469.236068485057, 6622.127447192929, 13480.856797656334, 3581.8333414097183, 31798.989192377983, 4166.625500806571, 5769.128953902713, -2536.8633479651053, 8739.886502347304, 6617.82308474998, 8721.157433115573, 3585.6246892765475, 21211.095517154405, 7081.465914289008, 12378.173103320776, 1506.5846071498302, 708.5082693657516, -871.1038858980825, 3281.527928253785, 262.2986326148548, 3468.8203096215248, 7025.829040881243, 2738.308410919276, 9451.617270914707, 8668.523417145443, 1789.1893796758256, 16327.312896358046, 7516.0234130947865, 4125.119499214969, 1651.7985414257662, 4177.031694600553, 1655.0867076358995, 10287.41748080417, 1457.3877801563106, 12024.479959733375, 2344.6936678584334, 11828.649661702057, 7156.204234888886, 6011.191217162818, 4208.288912361983, 9030.169422515424, -173.38835937923713, 5338.9924982236535, 7136.603378880539, 11048.592462202107, 11276.256174871434, 5564.580065043149, -1693.6156230846607, 18568.310156917378, 876.7217127788252, -3757.2286783504624, -520.132175151662, 11414.066654185117, 1602.6364362872323, 13031.439954074573, 290.8616932991247, 24400.688830605726, 696.8277496502392, 13823.786938035808, -174.79051487583334, 6149.286369954262, 789.8510500156306, 3166.634865348367, -1757.3895158785892, 13231.168547755024, 57.12374164700401, 8124.516414677837, 1309.807224040421, 32437.965600816617, 12271.617941306367, 12708.503363570173, 3768.307942409223, 2417.162355708579, 3859.771803361393, 9750.845314458096, -118.61444990089342, 7912.527062055195, 1732.147487286931, 2676.5019045033628, 1764.0194077786152, 13890.405828386178, 222.62000239599746, 13741.260664812979, -900.0776326443588, 13498.121570369294, -21.348248324263892, 10977.839503088873, 951.4906214141679, 11619.318965017039, 2326.0829172505596, 17494.72877119597, 6473.875309873562, -1682.3802897393418, 726.1900940230878, 14717.61335284342, 187.81081105103, 6261.389422816741, 1417.506072722236, 4135.200382899338, 2100.5644194397246, 11536.663416172305, 4754.309957851644]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7020316892476817, "mean_inference_ms": 1.5115588776859354, "mean_action_processing_ms": 0.29693511427348207, "mean_env_wait_ms": 0.13523899300272138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690004348754883, "StateBufferConnector_ms": 0.003011465072631836, "ViewRequirementAgentConnector_ms": 0.09886324405670166}, "num_episodes": 18, "episode_return_max": 44226.06226067444, "episode_return_min": 497.1314680219556, "episode_return_mean": 13913.352239125497, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.78245054063683, "num_env_steps_trained_throughput_per_sec": 320.78245054063683, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 13230.963, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13230.919, "sample_time_ms": 1060.529, "learn_time_ms": 12153.981, "learn_throughput": 329.11, "synch_weights_time_ms": 14.961}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "6751e_00000", "date": "2024-08-11_19-27-40", "timestamp": 1723418860, "time_this_iter_s": 12.504449844360352, "time_total_s": 1225.844425201416, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eada550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1225.844425201416, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 47.54444444444445, "ram_util_percent": 81.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4902534221136381, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.700642758071738, "policy_loss": -0.003758100309611234, "vf_loss": 7.704367247838823, "vf_explained_var": 8.009602783848999e-05, "kl": 0.010750863148343372, "entropy": 0.6658179578642366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6444077331474218, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.923302643135111, "policy_loss": -0.00430569546518936, "vf_loss": 8.926859896271317, "vf_explained_var": 3.621048397488064e-05, "kl": 0.007484076953995638, "entropy": 0.7363861570282588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 44226.06226067444, "episode_reward_min": 497.1314680219556, "episode_reward_mean": 15023.811286437858, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5978.898620943573, "predator_policy": -3757.2286783504624}, "policy_reward_max": {"prey_policy": 10833.432569840948, "predator_policy": 36342.887794368675}, "policy_reward_mean": {"prey_policy": 788.9056611269232, "predator_policy": 6722.999982092006}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15426.192397619641, 17677.298708478094, 16627.84820438795, 2063.4727626466447, 5784.414663689519, 5726.460477616471, 16400.809193821737, 26352.079071747004, 19899.75917884681, 9680.65978878323, 11344.758658277933, 10903.509854064761, 13839.277051303725, 4398.190411178973, 6221.194750102201, 15361.640666780837, 8232.669773058202, 7653.828027146976, 11376.767466790332, 16836.948559118122, 9050.98053184506, 628.4787433032233, 15255.980563443545, 680.2673103683393, 6208.6572771542005, 31336.746900491038, 26386.65129723998, 16767.495837062284, 34137.540789961815, 6121.370155837284, 13695.477349761415, 21171.110113233684, 22963.828529357645, 18641.7462389164, 3431.909495021322, 4037.933139816412, 7619.29585454008, 8714.70040478073, 15253.21132185334, 21342.35009147713, 10818.493353363292, 6135.271073485656, 14203.497680349314, 19384.264497540928, 15358.172846969781, 11585.459215966268, 14861.843872807744, 11110.336353910921, 11409.715518240311, 13378.339358392614, 18788.37750915573, 1092.1966308943881, 14515.690026275019, 18855.04541521561, 24486.55783818536, 17703.293168559667, 10195.498065157188, 4261.479561374045, 18670.258709333368, 15925.046294002312, 44226.06226067444, 18513.410460054358, 14885.93199443964, 14269.2424932243, 14107.144269157441, 9008.95976459601, 15792.811071297396, 15811.120745360968, 16752.253350905234, 19173.352148984763, 15947.151945768946, 23746.232660046415, 497.1314680219556, 15851.784507089948, 7140.9762521727, 7515.570551291874, 18466.645791482242, 12798.03481596966, 14824.226362161662, 9776.178429247799, 17122.639946704247, 26931.105963049333, 12700.97976385005, 21332.443955733626, 37692.35783072579, 9008.50115998066, 25366.375572536446, 37882.35337817884, 6939.281217758537, 15780.016011735435, 17548.70742519143, 19487.052790278412, 22857.83520975968, 20952.311763399994, 7784.925445524622, 33901.29862819805, 15915.694173544056, 17186.040288134336, 8559.675203476721, 20334.96297397432], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-3901.391286599001, -2119.165712746432, -2876.344332972451, -777.3831674542154, 316.8678622722009, -2084.522796823923, 5019.342767371631, -2642.5811143219894, -248.46709391168946, -3731.41178207963, 3152.1488377932565, -2510.0430593272267, 7192.483395815837, -253.6244456988213, -55.83655415664485, -726.6302142574704, 451.5445719295834, -1295.4966234844424, 1417.143876008976, -1597.462392193144, 2094.768315365389, -2280.1382041331008, 6597.990823660838, -1102.8028599461306, 10111.131914301595, -535.9266528493598, 1019.8921111459894, -3539.45766037024, 329.5201768230331, -1206.2405867241507, 8471.000720213618, -106.22363448519765, 7480.2174229217635, -1005.4376551334125, 4024.6983306394964, -2795.6644012341576, 5723.072717660999, -1371.6586571943426, 9466.550496553149, -973.7108615704904, 2333.750690656281, -1522.3433108447202, 4805.826409888214, -2648.9689252726134, 3944.412010356604, -1187.148338914099, 6029.625808117244, -4203.8694691261235, -4122.263953877628, -1271.704643901681, -617.4489357946165, -178.31403312174544, -3597.1143137565427, -1107.5979046814607, 828.526773662419, -1123.7210756662153, -1112.9387954999331, -715.135107722808, 3897.3796863737566, -1008.27513647408, -695.4104372258004, -966.8218001100797, 8912.030604009358, -47.7026131677362, -2674.8103209323554, -2653.922581153419, 6678.374719749387, -1921.3861913036367, 4742.530862475609, -1148.025750921965, 2953.917887248478, -2459.811308300705, 672.8525489209842, -3548.206044883666, -1007.3256667550221, -2467.8996102982283, 6269.36591847067, -1473.8673934385988, -1387.0231395445453, -1113.9630784311998, 7275.697070380344, -2234.1217576578124, 4175.3942074619035, -3872.2415362127113, 3431.6309219380673, -972.938502549272, 5540.064671817588, -524.9738018684818, -2607.760731866553, -1018.9203177545946, 2207.754963860166, -841.7758774187081, 7362.322603667151, -1357.2597939955851, -224.35466054333125, -1140.9048626499275, -5978.898620943573, -4936.234497889668, 10178.78257915261, -671.4076627184396, 845.8245352816664, -1502.4788958221409, 6301.279811895583, -931.7223274990671, 2533.456221314823, -1034.469285512161, 6333.929340984269, -801.1855731423935, 138.86646972059174, -749.8252117911978, 4055.786238676414, -1.4894932766964808, 4029.314934972962, -772.9542897856599, 3337.1450176967705, -484.9108057925062, 5684.035145120338, -302.0687251890348, 6773.226110310019, -282.50345502597446, -187.62033638810334, -295.9009450604643, 2982.320747371317, -945.7215932963583, 9816.153493786596, -1207.1556584169393, 5388.329741882025, -751.3181132149675, 4640.416635440471, -177.94691562511622, 6101.382255125598, -1532.9438028115733, 3265.7770898234344, -1585.9918493081937, 3329.8180520603787, -359.88033886803186, 4221.107013170573, -945.6269843103576, 7482.777974012754, -238.75594953103186, 3268.980273153072, -1267.2302096517762, 118.9635914302713, -341.33501245337436, 4552.746844389287, -3099.425180651077, 1305.0920030922025, -358.7316598966905, 2817.9712363092094, -3355.8904796754814, 2675.4667296610824, -1395.660980708287, 3007.078734312422, -831.4063168540843, 5657.647519382578, -2295.809482253709, 8511.089727752178, -1566.5456600505295, 4367.166121357808, -3798.3090128462395, 3824.817531235464, -679.2143860277064, -622.6089485098232, 116.95986134473779, 3068.2981708450334, -1438.9618718573604, 1564.1070144477253, -200.93216296341978, -928.9826411666809, -585.7923050652043, 3832.2503009410316, -3662.8935905656604, -2513.0358741607893, -882.5448951134183, -759.1140848121665, -607.8657369302384, 2460.0912446628167, -1762.6114529717604, 3010.0563978620416, -579.1407829733896, 10833.432569840948, 65.61039137411471, 9602.725838383823, -271.07623192847876, -225.58481231187395, -1576.7390083691998, -2237.449303916831, -1329.881645029392, 4626.163026334867, -3215.2156651709856, -1720.8888052326513, -1127.7947904434477, 4269.093958108881, -482.3706520375796, -1910.2477596863396, -1676.2810974954684, -2103.148212140226, -2595.7047252071966, 6176.98281993827, -1119.8915464519337], "policy_predator_policy_reward": [11946.299427700797, 9500.44996926429, 12964.826284167355, 8366.199924737419, 12116.33833237734, 6279.164806562347, 1335.1855428130318, -1648.4744332160308, 5845.236197326737, 3919.0573423541023, 3733.1183553920932, 1351.2363437583404, 11775.745233144577, -2313.794989439821, 21845.683483226592, 5288.862356934535, 18678.91964651666, 2064.791583885006, 6450.298538901966, 3410.6797660654393, 6581.243497114774, 4948.8850499308655, 5269.733432939231, 138.5884574108208, 3289.1770918293482, 974.894698022161, 5692.9112253322355, 1224.8447350709976, 4031.407230358133, 3066.507929645189, 8670.121034278638, -1673.2574532262752, 4494.362741703651, -2736.472736433797, 1587.3565741273721, 4837.437523614265, 8001.541958471514, -976.1885521478569, 7818.912637972326, 525.1962861630868, 8225.427992953515, 14.145159079970739, -2628.196775115909, 1099.8180338035288, 13754.821935899246, -1256.105043898149, 2229.7739169064203, -3375.2629455292035, 6376.316724564158, 5226.3091503693595, 29485.675375333783, 2646.8344940735983, 24469.236068485057, 6622.127447192929, 13480.856797656334, 3581.8333414097183, 31798.989192377983, 4166.625500806571, 5769.128953902713, -2536.8633479651053, 8739.886502347304, 6617.82308474998, 8721.157433115573, 3585.6246892765475, 21211.095517154405, 7081.465914289008, 12378.173103320776, 1506.5846071498302, 708.5082693657516, -871.1038858980825, 3281.527928253785, 262.2986326148548, 3468.8203096215248, 7025.829040881243, 2738.308410919276, 9451.617270914707, 8668.523417145443, 1789.1893796758256, 16327.312896358046, 7516.0234130947865, 4125.119499214969, 1651.7985414257662, 4177.031694600553, 1655.0867076358995, 10287.41748080417, 1457.3877801563106, 12024.479959733375, 2344.6936678584334, 11828.649661702057, 7156.204234888886, 6011.191217162818, 4208.288912361983, 9030.169422515424, -173.38835937923713, 5338.9924982236535, 7136.603378880539, 11048.592462202107, 11276.256174871434, 5564.580065043149, -1693.6156230846607, 18568.310156917378, 876.7217127788252, -3757.2286783504624, -520.132175151662, 11414.066654185117, 1602.6364362872323, 13031.439954074573, 290.8616932991247, 24400.688830605726, 696.8277496502392, 13823.786938035808, -174.79051487583334, 6149.286369954262, 789.8510500156306, 3166.634865348367, -1757.3895158785892, 13231.168547755024, 57.12374164700401, 8124.516414677837, 1309.807224040421, 32437.965600816617, 12271.617941306367, 12708.503363570173, 3768.307942409223, 2417.162355708579, 3859.771803361393, 9750.845314458096, -118.61444990089342, 7912.527062055195, 1732.147487286931, 2676.5019045033628, 1764.0194077786152, 13890.405828386178, 222.62000239599746, 13741.260664812979, -900.0776326443588, 13498.121570369294, -21.348248324263892, 10977.839503088873, 951.4906214141679, 11619.318965017039, 2326.0829172505596, 17494.72877119597, 6473.875309873562, -1682.3802897393418, 726.1900940230878, 14717.61335284342, 187.81081105103, 6261.389422816741, 1417.506072722236, 4135.200382899338, 2100.5644194397246, 11536.663416172305, 4754.309957851644, 5425.4876897241975, 4010.7090891166126, 5179.648004242756, 2700.034290217259, 5362.341522692561, 3844.9797980436674, 13447.219977197972, 529.8168242984862, 23981.3863160393, 3455.368734175115, 9561.220113121793, 1510.4233517405626, 13577.737599061533, 6391.531505187831, 32882.83015856559, 6324.302618392114, 7467.015893920309, 1372.1285556849832, 27216.442193975126, 1545.5141478355392, 36342.887794368675, 2906.44540555256, 5738.567065267723, 503.2343607997569, 14888.879668721485, -1539.7792718746966, 3468.060294059313, 3181.60416991708, 5317.623252904373, 4837.7799309187185, 17838.987361436586, 6821.171669004152, 18186.25270852651, 6333.3900038197235, 7374.411743795817, -1000.4336594350775, 31638.677028667007, 5111.305195207158, 13861.114909031816, -1732.1440415590082, 13613.43178771801, 7159.137357598138, 9099.93489330698, 4158.593247517162, 16884.342455752405, -1606.470755264384]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7002889053074592, "mean_inference_ms": 1.5072510394347867, "mean_action_processing_ms": 0.2961937420820205, "mean_env_wait_ms": 0.13485375811875586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003701925277709961, "StateBufferConnector_ms": 0.0030156373977661133, "ViewRequirementAgentConnector_ms": 0.09735524654388428}, "num_episodes": 23, "episode_return_max": 44226.06226067444, "episode_return_min": 497.1314680219556, "episode_return_mean": 15023.811286437858, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.1738575654198, "num_env_steps_trained_throughput_per_sec": 317.1738575654198, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 13111.907, "restore_workers_time_ms": 0.012, "training_step_time_ms": 13111.862, "sample_time_ms": 1069.649, "learn_time_ms": 12025.556, "learn_throughput": 332.625, "synch_weights_time_ms": 15.275}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "6751e_00000", "date": "2024-08-11_19-27-53", "timestamp": 1723418873, "time_this_iter_s": 12.653846025466919, "time_total_s": 1238.498271226883, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eadd550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1238.498271226883, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 48.29999999999999, "ram_util_percent": 81.61666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4891057645675366, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.961277674619483, "policy_loss": -0.007894072546894667, "vf_loss": 7.969111538690234, "vf_explained_var": 0.0010307453296802662, "kl": 0.019266358592939816, "entropy": 0.6565978987822457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.65924649943435, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.592103898588311, "policy_loss": -0.006407845053309328, "vf_loss": 8.597286451682843, "vf_explained_var": -6.342429332632236e-05, "kl": 0.012252522486552085, "entropy": 0.7228695740775456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 44226.06226067444, "episode_reward_min": 497.1314680219556, "episode_reward_mean": 16346.6725449025, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5978.898620943573, "predator_policy": -3757.2286783504624}, "policy_reward_max": {"prey_policy": 10833.432569840948, "predator_policy": 36342.887794368675}, "policy_reward_mean": {"prey_policy": 848.7974715965462, "predator_policy": 7324.538800854704}, "custom_metrics": {}, "hist_stats": {"episode_reward": [11376.767466790332, 16836.948559118122, 9050.98053184506, 628.4787433032233, 15255.980563443545, 680.2673103683393, 6208.6572771542005, 31336.746900491038, 26386.65129723998, 16767.495837062284, 34137.540789961815, 6121.370155837284, 13695.477349761415, 21171.110113233684, 22963.828529357645, 18641.7462389164, 3431.909495021322, 4037.933139816412, 7619.29585454008, 8714.70040478073, 15253.21132185334, 21342.35009147713, 10818.493353363292, 6135.271073485656, 14203.497680349314, 19384.264497540928, 15358.172846969781, 11585.459215966268, 14861.843872807744, 11110.336353910921, 11409.715518240311, 13378.339358392614, 18788.37750915573, 1092.1966308943881, 14515.690026275019, 18855.04541521561, 24486.55783818536, 17703.293168559667, 10195.498065157188, 4261.479561374045, 18670.258709333368, 15925.046294002312, 44226.06226067444, 18513.410460054358, 14885.93199443964, 14269.2424932243, 14107.144269157441, 9008.95976459601, 15792.811071297396, 15811.120745360968, 16752.253350905234, 19173.352148984763, 15947.151945768946, 23746.232660046415, 497.1314680219556, 15851.784507089948, 7140.9762521727, 7515.570551291874, 18466.645791482242, 12798.03481596966, 14824.226362161662, 9776.178429247799, 17122.639946704247, 26931.105963049333, 12700.97976385005, 21332.443955733626, 37692.35783072579, 9008.50115998066, 25366.375572536446, 37882.35337817884, 6939.281217758537, 15780.016011735435, 17548.70742519143, 19487.052790278412, 22857.83520975968, 20952.311763399994, 7784.925445524622, 33901.29862819805, 15915.694173544056, 17186.040288134336, 8559.675203476721, 20334.96297397432, 29217.34730441208, 32661.1921446949, 15724.072712269284, 39991.46331546604, 19072.703717598382, 8210.940091464301, 18023.848702198313, 13946.44616999452, 1447.8054173940577, 9192.492921286952, 18999.119934460414, 13787.753559180977, 19929.459620417394, 31533.819135464764, 20348.6972376668, 15973.381991941002, 18186.11774418881, 19633.52776591588], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5723.072717660999, -1371.6586571943426, 9466.550496553149, -973.7108615704904, 2333.750690656281, -1522.3433108447202, 4805.826409888214, -2648.9689252726134, 3944.412010356604, -1187.148338914099, 6029.625808117244, -4203.8694691261235, -4122.263953877628, -1271.704643901681, -617.4489357946165, -178.31403312174544, -3597.1143137565427, -1107.5979046814607, 828.526773662419, -1123.7210756662153, -1112.9387954999331, -715.135107722808, 3897.3796863737566, -1008.27513647408, -695.4104372258004, -966.8218001100797, 8912.030604009358, -47.7026131677362, -2674.8103209323554, -2653.922581153419, 6678.374719749387, -1921.3861913036367, 4742.530862475609, -1148.025750921965, 2953.917887248478, -2459.811308300705, 672.8525489209842, -3548.206044883666, -1007.3256667550221, -2467.8996102982283, 6269.36591847067, -1473.8673934385988, -1387.0231395445453, -1113.9630784311998, 7275.697070380344, -2234.1217576578124, 4175.3942074619035, -3872.2415362127113, 3431.6309219380673, -972.938502549272, 5540.064671817588, -524.9738018684818, -2607.760731866553, -1018.9203177545946, 2207.754963860166, -841.7758774187081, 7362.322603667151, -1357.2597939955851, -224.35466054333125, -1140.9048626499275, -5978.898620943573, -4936.234497889668, 10178.78257915261, -671.4076627184396, 845.8245352816664, -1502.4788958221409, 6301.279811895583, -931.7223274990671, 2533.456221314823, -1034.469285512161, 6333.929340984269, -801.1855731423935, 138.86646972059174, -749.8252117911978, 4055.786238676414, -1.4894932766964808, 4029.314934972962, -772.9542897856599, 3337.1450176967705, -484.9108057925062, 5684.035145120338, -302.0687251890348, 6773.226110310019, -282.50345502597446, -187.62033638810334, -295.9009450604643, 2982.320747371317, -945.7215932963583, 9816.153493786596, -1207.1556584169393, 5388.329741882025, -751.3181132149675, 4640.416635440471, -177.94691562511622, 6101.382255125598, -1532.9438028115733, 3265.7770898234344, -1585.9918493081937, 3329.8180520603787, -359.88033886803186, 4221.107013170573, -945.6269843103576, 7482.777974012754, -238.75594953103186, 3268.980273153072, -1267.2302096517762, 118.9635914302713, -341.33501245337436, 4552.746844389287, -3099.425180651077, 1305.0920030922025, -358.7316598966905, 2817.9712363092094, -3355.8904796754814, 2675.4667296610824, -1395.660980708287, 3007.078734312422, -831.4063168540843, 5657.647519382578, -2295.809482253709, 8511.089727752178, -1566.5456600505295, 4367.166121357808, -3798.3090128462395, 3824.817531235464, -679.2143860277064, -622.6089485098232, 116.95986134473779, 3068.2981708450334, -1438.9618718573604, 1564.1070144477253, -200.93216296341978, -928.9826411666809, -585.7923050652043, 3832.2503009410316, -3662.8935905656604, -2513.0358741607893, -882.5448951134183, -759.1140848121665, -607.8657369302384, 2460.0912446628167, -1762.6114529717604, 3010.0563978620416, -579.1407829733896, 10833.432569840948, 65.61039137411471, 9602.725838383823, -271.07623192847876, -225.58481231187395, -1576.7390083691998, -2237.449303916831, -1329.881645029392, 4626.163026334867, -3215.2156651709856, -1720.8888052326513, -1127.7947904434477, 4269.093958108881, -482.3706520375796, -1910.2477596863396, -1676.2810974954684, -2103.148212140226, -2595.7047252071966, 6176.98281993827, -1119.8915464519337, -160.9062133166745, -172.78346939113902, -928.3137690503623, -71.0276886043124, 2897.4003653843, -944.7870739525769, -144.44867154641102, -647.3732872079556, 2200.7242130232135, -549.0952089345146, 4354.5634747666945, -1101.3628616150615, 6893.199125330287, -1526.40377080836, -1077.6301344902013, -960.0777245851779, 4284.279266559032, -4978.924254298275, 5162.173852515076, -1749.8471675369221, 8807.135041688487, -1138.9963590043856, 7032.717274660644, -692.8234823064142, 1104.1923375252181, -840.2526648344106, -15.478019934371169, 172.68761895189954, 7111.046057316835, -250.8344734217701, 4503.416958108923, -420.8650583424828, -307.8534816820183, -1738.996421741353, 730.1337982974732, -2569.7271382379517], "policy_predator_policy_reward": [8001.541958471514, -976.1885521478569, 7818.912637972326, 525.1962861630868, 8225.427992953515, 14.145159079970739, -2628.196775115909, 1099.8180338035288, 13754.821935899246, -1256.105043898149, 2229.7739169064203, -3375.2629455292035, 6376.316724564158, 5226.3091503693595, 29485.675375333783, 2646.8344940735983, 24469.236068485057, 6622.127447192929, 13480.856797656334, 3581.8333414097183, 31798.989192377983, 4166.625500806571, 5769.128953902713, -2536.8633479651053, 8739.886502347304, 6617.82308474998, 8721.157433115573, 3585.6246892765475, 21211.095517154405, 7081.465914289008, 12378.173103320776, 1506.5846071498302, 708.5082693657516, -871.1038858980825, 3281.527928253785, 262.2986326148548, 3468.8203096215248, 7025.829040881243, 2738.308410919276, 9451.617270914707, 8668.523417145443, 1789.1893796758256, 16327.312896358046, 7516.0234130947865, 4125.119499214969, 1651.7985414257662, 4177.031694600553, 1655.0867076358995, 10287.41748080417, 1457.3877801563106, 12024.479959733375, 2344.6936678584334, 11828.649661702057, 7156.204234888886, 6011.191217162818, 4208.288912361983, 9030.169422515424, -173.38835937923713, 5338.9924982236535, 7136.603378880539, 11048.592462202107, 11276.256174871434, 5564.580065043149, -1693.6156230846607, 18568.310156917378, 876.7217127788252, -3757.2286783504624, -520.132175151662, 11414.066654185117, 1602.6364362872323, 13031.439954074573, 290.8616932991247, 24400.688830605726, 696.8277496502392, 13823.786938035808, -174.79051487583334, 6149.286369954262, 789.8510500156306, 3166.634865348367, -1757.3895158785892, 13231.168547755024, 57.12374164700401, 8124.516414677837, 1309.807224040421, 32437.965600816617, 12271.617941306367, 12708.503363570173, 3768.307942409223, 2417.162355708579, 3859.771803361393, 9750.845314458096, -118.61444990089342, 7912.527062055195, 1732.147487286931, 2676.5019045033628, 1764.0194077786152, 13890.405828386178, 222.62000239599746, 13741.260664812979, -900.0776326443588, 13498.121570369294, -21.348248324263892, 10977.839503088873, 951.4906214141679, 11619.318965017039, 2326.0829172505596, 17494.72877119597, 6473.875309873562, -1682.3802897393418, 726.1900940230878, 14717.61335284342, 187.81081105103, 6261.389422816741, 1417.506072722236, 4135.200382899338, 2100.5644194397246, 11536.663416172305, 4754.309957851644, 5425.4876897241975, 4010.7090891166126, 5179.648004242756, 2700.034290217259, 5362.341522692561, 3844.9797980436674, 13447.219977197972, 529.8168242984862, 23981.3863160393, 3455.368734175115, 9561.220113121793, 1510.4233517405626, 13577.737599061533, 6391.531505187831, 32882.83015856559, 6324.302618392114, 7467.015893920309, 1372.1285556849832, 27216.442193975126, 1545.5141478355392, 36342.887794368675, 2906.44540555256, 5738.567065267723, 503.2343607997569, 14888.879668721485, -1539.7792718746966, 3468.060294059313, 3181.60416991708, 5317.623252904373, 4837.7799309187185, 17838.987361436586, 6821.171669004152, 18186.25270852651, 6333.3900038197235, 7374.411743795817, -1000.4336594350775, 31638.677028667007, 5111.305195207158, 13861.114909031816, -1732.1440415590082, 13613.43178771801, 7159.137357598138, 9099.93489330698, 4158.593247517162, 16884.342455752405, -1606.470755264384, 27225.184703710835, 2325.852283409048, 27901.282664363767, 5759.250937985827, 10195.345602738893, 3576.1138180986495, 31336.474552692263, 9446.810721528143, 13841.432676315831, 3579.6420371938784, 1853.8766693154364, 3103.8628089972485, 14486.737486223761, -1829.6841385473604, 11448.807992801241, 4535.34603626866, 3504.244639459022, -1361.7942343257237, 3902.33261902176, 1877.8336172870372, 7586.287844775987, 3744.6934070003044, 9444.204538920676, -1996.3447720939312, 20453.106267382776, -787.5863196561697, 30945.50476446499, 431.10477198224146, 11055.318429952607, 2433.1672238191354, 9635.255278565275, 2255.5748136092407, 18286.736880651613, 1946.2307669605716, 17603.502377461926, 3869.6187283944555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6989116840840474, "mean_inference_ms": 1.5039834980974, "mean_action_processing_ms": 0.2956101535058692, "mean_env_wait_ms": 0.13454839687959871, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036933422088623047, "StateBufferConnector_ms": 0.003209710121154785, "ViewRequirementAgentConnector_ms": 0.0945199728012085}, "num_episodes": 18, "episode_return_max": 44226.06226067444, "episode_return_min": 497.1314680219556, "episode_return_mean": 16346.6725449025, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.12471730801116, "num_env_steps_trained_throughput_per_sec": 315.12471730801116, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 12943.506, "restore_workers_time_ms": 0.012, "training_step_time_ms": 12943.462, "sample_time_ms": 1034.558, "learn_time_ms": 11892.25, "learn_throughput": 336.354, "synch_weights_time_ms": 15.276}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "6751e_00000", "date": "2024-08-11_19-28-05", "timestamp": 1723418885, "time_this_iter_s": 12.705283641815186, "time_total_s": 1251.2035548686981, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81e0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1251.2035548686981, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 45.361111111111114, "ram_util_percent": 80.96111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5087593295586803, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.99241034770138, "policy_loss": -0.005072493541729514, "vf_loss": 7.997448081818838, "vf_explained_var": -0.002695579598189662, "kl": 0.011125450296482282, "entropy": 0.6357120346297662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6481817662479386, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.616355116657479, "policy_loss": -0.006629558520825215, "vf_loss": 8.6216238922543, "vf_explained_var": -3.261071033578701e-05, "kl": 0.01360793031670425, "entropy": 0.7236715155303793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 46419.836991418924, "episode_reward_min": 497.1314680219556, "episode_reward_mean": 17897.443402140147, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5978.898620943573, "predator_policy": -3757.2286783504624}, "policy_reward_max": {"prey_policy": 10833.432569840948, "predator_policy": 43520.27026197599}, "policy_reward_mean": {"prey_policy": 934.5235780245124, "predator_policy": 8014.198123045564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10818.493353363292, 6135.271073485656, 14203.497680349314, 19384.264497540928, 15358.172846969781, 11585.459215966268, 14861.843872807744, 11110.336353910921, 11409.715518240311, 13378.339358392614, 18788.37750915573, 1092.1966308943881, 14515.690026275019, 18855.04541521561, 24486.55783818536, 17703.293168559667, 10195.498065157188, 4261.479561374045, 18670.258709333368, 15925.046294002312, 44226.06226067444, 18513.410460054358, 14885.93199443964, 14269.2424932243, 14107.144269157441, 9008.95976459601, 15792.811071297396, 15811.120745360968, 16752.253350905234, 19173.352148984763, 15947.151945768946, 23746.232660046415, 497.1314680219556, 15851.784507089948, 7140.9762521727, 7515.570551291874, 18466.645791482242, 12798.03481596966, 14824.226362161662, 9776.178429247799, 17122.639946704247, 26931.105963049333, 12700.97976385005, 21332.443955733626, 37692.35783072579, 9008.50115998066, 25366.375572536446, 37882.35337817884, 6939.281217758537, 15780.016011735435, 17548.70742519143, 19487.052790278412, 22857.83520975968, 20952.311763399994, 7784.925445524622, 33901.29862819805, 15915.694173544056, 17186.040288134336, 8559.675203476721, 20334.96297397432, 29217.34730441208, 32661.1921446949, 15724.072712269284, 39991.46331546604, 19072.703717598382, 8210.940091464301, 18023.848702198313, 13946.44616999452, 1447.8054173940577, 9192.492921286952, 18999.119934460414, 13787.753559180977, 19929.459620417394, 31533.819135464764, 20348.6972376668, 15973.381991941002, 18186.11774418881, 19633.52776591588, 35265.699595494065, 17181.753254531533, 5942.1250190004985, 18316.404739028418, 29347.84547394261, 38920.80414958693, 45724.373167969585, 17490.534097478965, 17982.185906051585, 4309.372706996051, 6716.285427638947, 16469.86681026114, 16551.73655262478, 46419.836991418924, 16606.41013478763, 21939.360172113593, 4385.625115810385, 17731.035969237408, 20586.59222352235, 20833.88561954977, 32916.041274880175, 15098.7592932127], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [7275.697070380344, -2234.1217576578124, 4175.3942074619035, -3872.2415362127113, 3431.6309219380673, -972.938502549272, 5540.064671817588, -524.9738018684818, -2607.760731866553, -1018.9203177545946, 2207.754963860166, -841.7758774187081, 7362.322603667151, -1357.2597939955851, -224.35466054333125, -1140.9048626499275, -5978.898620943573, -4936.234497889668, 10178.78257915261, -671.4076627184396, 845.8245352816664, -1502.4788958221409, 6301.279811895583, -931.7223274990671, 2533.456221314823, -1034.469285512161, 6333.929340984269, -801.1855731423935, 138.86646972059174, -749.8252117911978, 4055.786238676414, -1.4894932766964808, 4029.314934972962, -772.9542897856599, 3337.1450176967705, -484.9108057925062, 5684.035145120338, -302.0687251890348, 6773.226110310019, -282.50345502597446, -187.62033638810334, -295.9009450604643, 2982.320747371317, -945.7215932963583, 9816.153493786596, -1207.1556584169393, 5388.329741882025, -751.3181132149675, 4640.416635440471, -177.94691562511622, 6101.382255125598, -1532.9438028115733, 3265.7770898234344, -1585.9918493081937, 3329.8180520603787, -359.88033886803186, 4221.107013170573, -945.6269843103576, 7482.777974012754, -238.75594953103186, 3268.980273153072, -1267.2302096517762, 118.9635914302713, -341.33501245337436, 4552.746844389287, -3099.425180651077, 1305.0920030922025, -358.7316598966905, 2817.9712363092094, -3355.8904796754814, 2675.4667296610824, -1395.660980708287, 3007.078734312422, -831.4063168540843, 5657.647519382578, -2295.809482253709, 8511.089727752178, -1566.5456600505295, 4367.166121357808, -3798.3090128462395, 3824.817531235464, -679.2143860277064, -622.6089485098232, 116.95986134473779, 3068.2981708450334, -1438.9618718573604, 1564.1070144477253, -200.93216296341978, -928.9826411666809, -585.7923050652043, 3832.2503009410316, -3662.8935905656604, -2513.0358741607893, -882.5448951134183, -759.1140848121665, -607.8657369302384, 2460.0912446628167, -1762.6114529717604, 3010.0563978620416, -579.1407829733896, 10833.432569840948, 65.61039137411471, 9602.725838383823, -271.07623192847876, -225.58481231187395, -1576.7390083691998, -2237.449303916831, -1329.881645029392, 4626.163026334867, -3215.2156651709856, -1720.8888052326513, -1127.7947904434477, 4269.093958108881, -482.3706520375796, -1910.2477596863396, -1676.2810974954684, -2103.148212140226, -2595.7047252071966, 6176.98281993827, -1119.8915464519337, -160.9062133166745, -172.78346939113902, -928.3137690503623, -71.0276886043124, 2897.4003653843, -944.7870739525769, -144.44867154641102, -647.3732872079556, 2200.7242130232135, -549.0952089345146, 4354.5634747666945, -1101.3628616150615, 6893.199125330287, -1526.40377080836, -1077.6301344902013, -960.0777245851779, 4284.279266559032, -4978.924254298275, 5162.173852515076, -1749.8471675369221, 8807.135041688487, -1138.9963590043856, 7032.717274660644, -692.8234823064142, 1104.1923375252181, -840.2526648344106, -15.478019934371169, 172.68761895189954, 7111.046057316835, -250.8344734217701, 4503.416958108923, -420.8650583424828, -307.8534816820183, -1738.996421741353, 730.1337982974732, -2569.7271382379517, -258.27537883678684, -365.61112513301754, 3711.2415321129893, -605.8545410385764, 4332.045559483278, -3109.57738116633, 7052.402157616894, -1641.0701881051598, 38.89354868386468, -402.052985638978, 257.1352982234379, -49.29251897472746, -562.7101229917766, -137.99433230171257, 1690.675158096607, -205.82087167599673, 249.48861583587023, -860.9551760839712, 5681.261223881715, -2558.8272072658497, 9012.577018648879, -2354.5172901015444, 7079.76699880366, -85.4209751131191, 3447.310146632719, -526.8603535095806, -646.1315036799454, -336.5279361560373, 4559.588240447486, -547.808021528307, 894.6538735430356, -191.15092797215718, -768.2816383508855, -4119.221439032223, 5036.308048270571, -1402.4702740195385, 5276.065833846866, -1192.5574714393676, -318.1956351858883, -1181.431409661449, -1237.1129486697648, -567.3322525526778, 2800.9939705073903, -812.2962985995805], "policy_predator_policy_reward": [4125.119499214969, 1651.7985414257662, 4177.031694600553, 1655.0867076358995, 10287.41748080417, 1457.3877801563106, 12024.479959733375, 2344.6936678584334, 11828.649661702057, 7156.204234888886, 6011.191217162818, 4208.288912361983, 9030.169422515424, -173.38835937923713, 5338.9924982236535, 7136.603378880539, 11048.592462202107, 11276.256174871434, 5564.580065043149, -1693.6156230846607, 18568.310156917378, 876.7217127788252, -3757.2286783504624, -520.132175151662, 11414.066654185117, 1602.6364362872323, 13031.439954074573, 290.8616932991247, 24400.688830605726, 696.8277496502392, 13823.786938035808, -174.79051487583334, 6149.286369954262, 789.8510500156306, 3166.634865348367, -1757.3895158785892, 13231.168547755024, 57.12374164700401, 8124.516414677837, 1309.807224040421, 32437.965600816617, 12271.617941306367, 12708.503363570173, 3768.307942409223, 2417.162355708579, 3859.771803361393, 9750.845314458096, -118.61444990089342, 7912.527062055195, 1732.147487286931, 2676.5019045033628, 1764.0194077786152, 13890.405828386178, 222.62000239599746, 13741.260664812979, -900.0776326443588, 13498.121570369294, -21.348248324263892, 10977.839503088873, 951.4906214141679, 11619.318965017039, 2326.0829172505596, 17494.72877119597, 6473.875309873562, -1682.3802897393418, 726.1900940230878, 14717.61335284342, 187.81081105103, 6261.389422816741, 1417.506072722236, 4135.200382899338, 2100.5644194397246, 11536.663416172305, 4754.309957851644, 5425.4876897241975, 4010.7090891166126, 5179.648004242756, 2700.034290217259, 5362.341522692561, 3844.9797980436674, 13447.219977197972, 529.8168242984862, 23981.3863160393, 3455.368734175115, 9561.220113121793, 1510.4233517405626, 13577.737599061533, 6391.531505187831, 32882.83015856559, 6324.302618392114, 7467.015893920309, 1372.1285556849832, 27216.442193975126, 1545.5141478355392, 36342.887794368675, 2906.44540555256, 5738.567065267723, 503.2343607997569, 14888.879668721485, -1539.7792718746966, 3468.060294059313, 3181.60416991708, 5317.623252904373, 4837.7799309187185, 17838.987361436586, 6821.171669004152, 18186.25270852651, 6333.3900038197235, 7374.411743795817, -1000.4336594350775, 31638.677028667007, 5111.305195207158, 13861.114909031816, -1732.1440415590082, 13613.43178771801, 7159.137357598138, 9099.93489330698, 4158.593247517162, 16884.342455752405, -1606.470755264384, 27225.184703710835, 2325.852283409048, 27901.282664363767, 5759.250937985827, 10195.345602738893, 3576.1138180986495, 31336.474552692263, 9446.810721528143, 13841.432676315831, 3579.6420371938784, 1853.8766693154364, 3103.8628089972485, 14486.737486223761, -1829.6841385473604, 11448.807992801241, 4535.34603626866, 3504.244639459022, -1361.7942343257237, 3902.33261902176, 1877.8336172870372, 7586.287844775987, 3744.6934070003044, 9444.204538920676, -1996.3447720939312, 20453.106267382776, -787.5863196561697, 30945.50476446499, 431.10477198224146, 11055.318429952607, 2433.1672238191354, 9635.255278565275, 2255.5748136092407, 18286.736880651613, 1946.2307669605716, 17603.502377461926, 3869.6187283944555, 35821.85165479393, 67.73444466994721, 9353.696156315678, 4722.670107141439, 2189.271521395262, 2530.385319288287, 11310.612803899254, 1594.4599656173953, 28812.079760508943, 898.9251503887779, 29608.574436130653, 9104.386934207516, 31802.233493329233, 14622.844129934, 13129.810533233458, 2875.8692778249224, 16821.304400314704, 1772.3480659849588, -332.2017884082952, 1519.1404787884808, 2421.523147044533, -2363.2974479529107, 7835.670435617401, 1639.8503509532711, 13317.721410017852, 313.5653494837875, 43520.27026197599, 3882.2261692789516, 12474.008597652946, 120.62131821549005, 18156.416536106564, 3079.4406904362545, 5917.660097316687, 3355.4680958767963, 13270.013975080119, 827.1842199062237, 16410.49234090384, 92.591520210992, 20532.06912455771, 1801.4435398393366, 30113.38492857437, 4607.1015475282475, 9469.546044948016, 3640.515576356847]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6969604632921222, "mean_inference_ms": 1.4991366340663275, "mean_action_processing_ms": 0.2948230612415568, "mean_env_wait_ms": 0.13392485986407324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003663778305053711, "StateBufferConnector_ms": 0.0031692981719970703, "ViewRequirementAgentConnector_ms": 0.0921332836151123}, "num_episodes": 22, "episode_return_max": 46419.836991418924, "episode_return_min": 497.1314680219556, "episode_return_mean": 17897.443402140147, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 371.30726981812927, "num_env_steps_trained_throughput_per_sec": 371.30726981812927, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 12633.233, "restore_workers_time_ms": 0.012, "training_step_time_ms": 12633.19, "sample_time_ms": 1006.836, "learn_time_ms": 11609.977, "learn_throughput": 344.531, "synch_weights_time_ms": 15.153}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "6751e_00000", "date": "2024-08-11_19-28-16", "timestamp": 1723418896, "time_this_iter_s": 10.776160955429077, "time_total_s": 1261.9797158241272, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f83b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1261.9797158241272, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 31.879999999999995, "ram_util_percent": 74.48000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44777624454920884, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.732365454820098, "policy_loss": -0.005211834442584958, "vf_loss": 7.737515658676309, "vf_explained_var": 0.0009451319616307657, "kl": 0.019717837841251716, "entropy": 0.6623531337137576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6461264012430711, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.91864218081116, "policy_loss": -0.005760562741665771, "vf_loss": 8.923398301210353, "vf_explained_var": -1.1111283428454525e-05, "kl": 0.0100441096738809, "entropy": 0.76383165035929, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 46419.836991418924, "episode_reward_min": 497.1314680219556, "episode_reward_mean": 18790.32641411467, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4978.924254298275, "predator_policy": -2363.2974479529107}, "policy_reward_max": {"prey_policy": 10833.432569840948, "predator_policy": 43520.27026197599}, "policy_reward_mean": {"prey_policy": 838.1038054986562, "predator_policy": 8557.059401558678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [18670.258709333368, 15925.046294002312, 44226.06226067444, 18513.410460054358, 14885.93199443964, 14269.2424932243, 14107.144269157441, 9008.95976459601, 15792.811071297396, 15811.120745360968, 16752.253350905234, 19173.352148984763, 15947.151945768946, 23746.232660046415, 497.1314680219556, 15851.784507089948, 7140.9762521727, 7515.570551291874, 18466.645791482242, 12798.03481596966, 14824.226362161662, 9776.178429247799, 17122.639946704247, 26931.105963049333, 12700.97976385005, 21332.443955733626, 37692.35783072579, 9008.50115998066, 25366.375572536446, 37882.35337817884, 6939.281217758537, 15780.016011735435, 17548.70742519143, 19487.052790278412, 22857.83520975968, 20952.311763399994, 7784.925445524622, 33901.29862819805, 15915.694173544056, 17186.040288134336, 8559.675203476721, 20334.96297397432, 29217.34730441208, 32661.1921446949, 15724.072712269284, 39991.46331546604, 19072.703717598382, 8210.940091464301, 18023.848702198313, 13946.44616999452, 1447.8054173940577, 9192.492921286952, 18999.119934460414, 13787.753559180977, 19929.459620417394, 31533.819135464764, 20348.6972376668, 15973.381991941002, 18186.11774418881, 19633.52776591588, 35265.699595494065, 17181.753254531533, 5942.1250190004985, 18316.404739028418, 29347.84547394261, 38920.80414958693, 45724.373167969585, 17490.534097478965, 17982.185906051585, 4309.372706996051, 6716.285427638947, 16469.86681026114, 16551.73655262478, 46419.836991418924, 16606.41013478763, 21939.360172113593, 4385.625115810385, 17731.035969237408, 20586.59222352235, 20833.88561954977, 32916.041274880175, 15098.7592932127, 13705.635806710954, 40970.037823126855, 18545.59452936344, 18027.007383130054, 15934.456460455538, 5886.508201315242, 19646.025510729803, 9705.156685685743, 16140.998170768551, 19438.831022794217, 22251.922957724517, 18594.66598121004, 16589.199640323015, 19993.629151262936, 8821.856817780208, 36692.40675310317, 16021.476895788062, 10466.42339202348], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5684.035145120338, -302.0687251890348, 6773.226110310019, -282.50345502597446, -187.62033638810334, -295.9009450604643, 2982.320747371317, -945.7215932963583, 9816.153493786596, -1207.1556584169393, 5388.329741882025, -751.3181132149675, 4640.416635440471, -177.94691562511622, 6101.382255125598, -1532.9438028115733, 3265.7770898234344, -1585.9918493081937, 3329.8180520603787, -359.88033886803186, 4221.107013170573, -945.6269843103576, 7482.777974012754, -238.75594953103186, 3268.980273153072, -1267.2302096517762, 118.9635914302713, -341.33501245337436, 4552.746844389287, -3099.425180651077, 1305.0920030922025, -358.7316598966905, 2817.9712363092094, -3355.8904796754814, 2675.4667296610824, -1395.660980708287, 3007.078734312422, -831.4063168540843, 5657.647519382578, -2295.809482253709, 8511.089727752178, -1566.5456600505295, 4367.166121357808, -3798.3090128462395, 3824.817531235464, -679.2143860277064, -622.6089485098232, 116.95986134473779, 3068.2981708450334, -1438.9618718573604, 1564.1070144477253, -200.93216296341978, -928.9826411666809, -585.7923050652043, 3832.2503009410316, -3662.8935905656604, -2513.0358741607893, -882.5448951134183, -759.1140848121665, -607.8657369302384, 2460.0912446628167, -1762.6114529717604, 3010.0563978620416, -579.1407829733896, 10833.432569840948, 65.61039137411471, 9602.725838383823, -271.07623192847876, -225.58481231187395, -1576.7390083691998, -2237.449303916831, -1329.881645029392, 4626.163026334867, -3215.2156651709856, -1720.8888052326513, -1127.7947904434477, 4269.093958108881, -482.3706520375796, -1910.2477596863396, -1676.2810974954684, -2103.148212140226, -2595.7047252071966, 6176.98281993827, -1119.8915464519337, -160.9062133166745, -172.78346939113902, -928.3137690503623, -71.0276886043124, 2897.4003653843, -944.7870739525769, -144.44867154641102, -647.3732872079556, 2200.7242130232135, -549.0952089345146, 4354.5634747666945, -1101.3628616150615, 6893.199125330287, -1526.40377080836, -1077.6301344902013, -960.0777245851779, 4284.279266559032, -4978.924254298275, 5162.173852515076, -1749.8471675369221, 8807.135041688487, -1138.9963590043856, 7032.717274660644, -692.8234823064142, 1104.1923375252181, -840.2526648344106, -15.478019934371169, 172.68761895189954, 7111.046057316835, -250.8344734217701, 4503.416958108923, -420.8650583424828, -307.8534816820183, -1738.996421741353, 730.1337982974732, -2569.7271382379517, -258.27537883678684, -365.61112513301754, 3711.2415321129893, -605.8545410385764, 4332.045559483278, -3109.57738116633, 7052.402157616894, -1641.0701881051598, 38.89354868386468, -402.052985638978, 257.1352982234379, -49.29251897472746, -562.7101229917766, -137.99433230171257, 1690.675158096607, -205.82087167599673, 249.48861583587023, -860.9551760839712, 5681.261223881715, -2558.8272072658497, 9012.577018648879, -2354.5172901015444, 7079.76699880366, -85.4209751131191, 3447.310146632719, -526.8603535095806, -646.1315036799454, -336.5279361560373, 4559.588240447486, -547.808021528307, 894.6538735430356, -191.15092797215718, -768.2816383508855, -4119.221439032223, 5036.308048270571, -1402.4702740195385, 5276.065833846866, -1192.5574714393676, -318.1956351858883, -1181.431409661449, -1237.1129486697648, -567.3322525526778, 2800.9939705073903, -812.2962985995805, 4948.213091807298, -1612.830131690289, -1104.7334383157076, -508.6485948825902, 4398.721192621323, -437.84633387574934, 5392.082403624732, -229.6906461680521, 10031.69335033369, -1343.3918323043613, 773.1827787621392, -4338.067542036829, 7097.768744758397, -185.59736341100026, -3895.852766656829, -3981.6892503491003, -1120.4203015794399, -2277.52540543276, 9334.75827881691, -279.2728798516538, -681.8526233941767, -1444.914883872411, 1829.7798583933445, -170.22750034745536, 1080.1924440551634, -1883.6495570256045, 1602.1561075192883, -1100.1576784961014, 1060.0990197917786, -3440.2428503539677, -520.1800838108999, -416.91512859535527, 777.1588490895406, -1851.3690991164256, 2756.7297249108237, -2454.9933759584455], "policy_predator_policy_reward": [13231.168547755024, 57.12374164700401, 8124.516414677837, 1309.807224040421, 32437.965600816617, 12271.617941306367, 12708.503363570173, 3768.307942409223, 2417.162355708579, 3859.771803361393, 9750.845314458096, -118.61444990089342, 7912.527062055195, 1732.147487286931, 2676.5019045033628, 1764.0194077786152, 13890.405828386178, 222.62000239599746, 13741.260664812979, -900.0776326443588, 13498.121570369294, -21.348248324263892, 10977.839503088873, 951.4906214141679, 11619.318965017039, 2326.0829172505596, 17494.72877119597, 6473.875309873562, -1682.3802897393418, 726.1900940230878, 14717.61335284342, 187.81081105103, 6261.389422816741, 1417.506072722236, 4135.200382899338, 2100.5644194397246, 11536.663416172305, 4754.309957851644, 5425.4876897241975, 4010.7090891166126, 5179.648004242756, 2700.034290217259, 5362.341522692561, 3844.9797980436674, 13447.219977197972, 529.8168242984862, 23981.3863160393, 3455.368734175115, 9561.220113121793, 1510.4233517405626, 13577.737599061533, 6391.531505187831, 32882.83015856559, 6324.302618392114, 7467.015893920309, 1372.1285556849832, 27216.442193975126, 1545.5141478355392, 36342.887794368675, 2906.44540555256, 5738.567065267723, 503.2343607997569, 14888.879668721485, -1539.7792718746966, 3468.060294059313, 3181.60416991708, 5317.623252904373, 4837.7799309187185, 17838.987361436586, 6821.171669004152, 18186.25270852651, 6333.3900038197235, 7374.411743795817, -1000.4336594350775, 31638.677028667007, 5111.305195207158, 13861.114909031816, -1732.1440415590082, 13613.43178771801, 7159.137357598138, 9099.93489330698, 4158.593247517162, 16884.342455752405, -1606.470755264384, 27225.184703710835, 2325.852283409048, 27901.282664363767, 5759.250937985827, 10195.345602738893, 3576.1138180986495, 31336.474552692263, 9446.810721528143, 13841.432676315831, 3579.6420371938784, 1853.8766693154364, 3103.8628089972485, 14486.737486223761, -1829.6841385473604, 11448.807992801241, 4535.34603626866, 3504.244639459022, -1361.7942343257237, 3902.33261902176, 1877.8336172870372, 7586.287844775987, 3744.6934070003044, 9444.204538920676, -1996.3447720939312, 20453.106267382776, -787.5863196561697, 30945.50476446499, 431.10477198224146, 11055.318429952607, 2433.1672238191354, 9635.255278565275, 2255.5748136092407, 18286.736880651613, 1946.2307669605716, 17603.502377461926, 3869.6187283944555, 35821.85165479393, 67.73444466994721, 9353.696156315678, 4722.670107141439, 2189.271521395262, 2530.385319288287, 11310.612803899254, 1594.4599656173953, 28812.079760508943, 898.9251503887779, 29608.574436130653, 9104.386934207516, 31802.233493329233, 14622.844129934, 13129.810533233458, 2875.8692778249224, 16821.304400314704, 1772.3480659849588, -332.2017884082952, 1519.1404787884808, 2421.523147044533, -2363.2974479529107, 7835.670435617401, 1639.8503509532711, 13317.721410017852, 313.5653494837875, 43520.27026197599, 3882.2261692789516, 12474.008597652946, 120.62131821549005, 18156.416536106564, 3079.4406904362545, 5917.660097316687, 3355.4680958767963, 13270.013975080119, 827.1842199062237, 16410.49234090384, 92.591520210992, 20532.06912455771, 1801.4435398393366, 30113.38492857437, 4607.1015475282475, 9469.546044948016, 3640.515576356847, 9000.359441941378, 1369.8934046526097, 42583.41985632515, 0.0, 13270.353843575167, 1314.3658270426754, 10011.913809275477, 2852.701816397911, 4443.938949508215, 2802.2159929179365, 5839.790841312771, 3611.6021232771645, 12270.332830009225, 463.5212993730472, 10598.9160967868, 6983.78260590488, 13380.136520482436, 6158.807357298315, 10465.424010953237, -82.07838712430032, 22322.29349700483, 2056.396967986274, 16058.964512759463, 876.1491104047177, 14018.831763097027, 3373.824990196445, 17649.93102479348, 1841.6996974463048, 7542.793387144687, 3659.207261197703, 37629.50196550943, 0.0, 13562.881854633448, 3532.8052911815353, 7891.666397665122, 2273.020645405973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6953754290622857, "mean_inference_ms": 1.495732857026831, "mean_action_processing_ms": 0.29414252443196975, "mean_env_wait_ms": 0.13378334842577574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034706592559814453, "StateBufferConnector_ms": 0.0030640363693237305, "ViewRequirementAgentConnector_ms": 0.08872091770172119}, "num_episodes": 18, "episode_return_max": 46419.836991418924, "episode_return_min": 497.1314680219556, "episode_return_mean": 18790.32641411467, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.0755041190027, "num_env_steps_trained_throughput_per_sec": 372.0755041190027, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 12348.998, "restore_workers_time_ms": 0.012, "training_step_time_ms": 12348.957, "sample_time_ms": 983.004, "learn_time_ms": 11350.379, "learn_throughput": 352.411, "synch_weights_time_ms": 14.479}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "6751e_00000", "date": "2024-08-11_19-28-27", "timestamp": 1723418907, "time_this_iter_s": 10.75387191772461, "time_total_s": 1272.7335877418518, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f83b3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1272.7335877418518, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 30.086666666666666, "ram_util_percent": 74.21333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5284040500089605, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.17003067334493, "policy_loss": -0.0051120293319284445, "vf_loss": 8.175110286631913, "vf_explained_var": 0.0006234603899496573, "kl": 0.010373522453564887, "entropy": 0.690598615515169, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6517032565105529, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.038421501936735, "policy_loss": -0.004470552260144835, "vf_loss": 9.042064304452724, "vf_explained_var": 8.139007936709772e-05, "kl": 0.008276968819132272, "entropy": 0.7249275357950301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 46419.836991418924, "episode_reward_min": 0.0, "episode_reward_mean": 18260.13740538105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5028.36335343772, "predator_policy": -2363.2974479529107}, "policy_reward_max": {"prey_policy": 10833.432569840948, "predator_policy": 43520.27026197599}, "policy_reward_mean": {"prey_policy": 620.8960347620587, "predator_policy": 8509.17266792847}, "custom_metrics": {}, "hist_stats": {"episode_reward": [26931.105963049333, 12700.97976385005, 21332.443955733626, 37692.35783072579, 9008.50115998066, 25366.375572536446, 37882.35337817884, 6939.281217758537, 15780.016011735435, 17548.70742519143, 19487.052790278412, 22857.83520975968, 20952.311763399994, 7784.925445524622, 33901.29862819805, 15915.694173544056, 17186.040288134336, 8559.675203476721, 20334.96297397432, 29217.34730441208, 32661.1921446949, 15724.072712269284, 39991.46331546604, 19072.703717598382, 8210.940091464301, 18023.848702198313, 13946.44616999452, 1447.8054173940577, 9192.492921286952, 18999.119934460414, 13787.753559180977, 19929.459620417394, 31533.819135464764, 20348.6972376668, 15973.381991941002, 18186.11774418881, 19633.52776591588, 35265.699595494065, 17181.753254531533, 5942.1250190004985, 18316.404739028418, 29347.84547394261, 38920.80414958693, 45724.373167969585, 17490.534097478965, 17982.185906051585, 4309.372706996051, 6716.285427638947, 16469.86681026114, 16551.73655262478, 46419.836991418924, 16606.41013478763, 21939.360172113593, 4385.625115810385, 17731.035969237408, 20586.59222352235, 20833.88561954977, 32916.041274880175, 15098.7592932127, 13705.635806710954, 40970.037823126855, 18545.59452936344, 18027.007383130054, 15934.456460455538, 5886.508201315242, 19646.025510729803, 9705.156685685743, 16140.998170768551, 19438.831022794217, 22251.922957724517, 18594.66598121004, 16589.199640323015, 19993.629151262936, 8821.856817780208, 36692.40675310317, 16021.476895788062, 10466.42339202348, 11104.299564301717, 17329.7012344866, 21091.107295783484, 17273.81507515954, 2151.1265040105227, 5487.4230402136645, 27554.273695202606, 12392.206609122453, 22873.273762458313, 13709.782863337583, 40775.61725435763, 3834.184121439531, 7.105427357601002e-15, 6838.384224638664, 3043.3016558308273, 0.0, 11946.206731753122, 15687.141075484284, 3333.3120908374403, 20723.59900593998, 13111.548757810937, 11887.184937267157, 25655.775919190048], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-622.6089485098232, 116.95986134473779, 3068.2981708450334, -1438.9618718573604, 1564.1070144477253, -200.93216296341978, -928.9826411666809, -585.7923050652043, 3832.2503009410316, -3662.8935905656604, -2513.0358741607893, -882.5448951134183, -759.1140848121665, -607.8657369302384, 2460.0912446628167, -1762.6114529717604, 3010.0563978620416, -579.1407829733896, 10833.432569840948, 65.61039137411471, 9602.725838383823, -271.07623192847876, -225.58481231187395, -1576.7390083691998, -2237.449303916831, -1329.881645029392, 4626.163026334867, -3215.2156651709856, -1720.8888052326513, -1127.7947904434477, 4269.093958108881, -482.3706520375796, -1910.2477596863396, -1676.2810974954684, -2103.148212140226, -2595.7047252071966, 6176.98281993827, -1119.8915464519337, -160.9062133166745, -172.78346939113902, -928.3137690503623, -71.0276886043124, 2897.4003653843, -944.7870739525769, -144.44867154641102, -647.3732872079556, 2200.7242130232135, -549.0952089345146, 4354.5634747666945, -1101.3628616150615, 6893.199125330287, -1526.40377080836, -1077.6301344902013, -960.0777245851779, 4284.279266559032, -4978.924254298275, 5162.173852515076, -1749.8471675369221, 8807.135041688487, -1138.9963590043856, 7032.717274660644, -692.8234823064142, 1104.1923375252181, -840.2526648344106, -15.478019934371169, 172.68761895189954, 7111.046057316835, -250.8344734217701, 4503.416958108923, -420.8650583424828, -307.8534816820183, -1738.996421741353, 730.1337982974732, -2569.7271382379517, -258.27537883678684, -365.61112513301754, 3711.2415321129893, -605.8545410385764, 4332.045559483278, -3109.57738116633, 7052.402157616894, -1641.0701881051598, 38.89354868386468, -402.052985638978, 257.1352982234379, -49.29251897472746, -562.7101229917766, -137.99433230171257, 1690.675158096607, -205.82087167599673, 249.48861583587023, -860.9551760839712, 5681.261223881715, -2558.8272072658497, 9012.577018648879, -2354.5172901015444, 7079.76699880366, -85.4209751131191, 3447.310146632719, -526.8603535095806, -646.1315036799454, -336.5279361560373, 4559.588240447486, -547.808021528307, 894.6538735430356, -191.15092797215718, -768.2816383508855, -4119.221439032223, 5036.308048270571, -1402.4702740195385, 5276.065833846866, -1192.5574714393676, -318.1956351858883, -1181.431409661449, -1237.1129486697648, -567.3322525526778, 2800.9939705073903, -812.2962985995805, 4948.213091807298, -1612.830131690289, -1104.7334383157076, -508.6485948825902, 4398.721192621323, -437.84633387574934, 5392.082403624732, -229.6906461680521, 10031.69335033369, -1343.3918323043613, 773.1827787621392, -4338.067542036829, 7097.768744758397, -185.59736341100026, -3895.852766656829, -3981.6892503491003, -1120.4203015794399, -2277.52540543276, 9334.75827881691, -279.2728798516538, -681.8526233941767, -1444.914883872411, 1829.7798583933445, -170.22750034745536, 1080.1924440551634, -1883.6495570256045, 1602.1561075192883, -1100.1576784961014, 1060.0990197917786, -3440.2428503539677, -520.1800838108999, -416.91512859535527, 777.1588490895406, -1851.3690991164256, 2756.7297249108237, -2454.9933759584455, 5797.897336659394, -845.831063141365, 1873.729898432657, -767.168045140488, -528.9901213098842, -84.1128742825261, 4422.623946690215, -702.3867591156178, -1323.6437579224034, -4116.035801184964, 4716.265930705359, 149.91575803336536, -1005.1496303042164, -1098.4155402268734, 6946.82782452911, -1330.7056572801364, -1303.395036616813, -637.346777338058, 2833.1699757180445, -2979.9729127327832, -391.80777938094866, -244.14498555680302, 5811.844162013607, -2258.3916803303487, 5309.684528125569, -5028.36335343772, 3152.071027002302, -2962.5432108299146, 3274.540036981622, -2102.523646275832, 5316.029610618394, -3474.5725408313315, 4314.697526342088, -1151.6420251274678, 5420.467894181321, -1625.714789928356, 456.1410538480944, -3486.629966472833, 1243.3953711540926, -419.1388874509217, 4793.666594991295, -743.2582300867249, 5399.203415799842, -1170.3844371125272, -735.6200241493565, -166.46498351472036], "policy_predator_policy_reward": [23981.3863160393, 3455.368734175115, 9561.220113121793, 1510.4233517405626, 13577.737599061533, 6391.531505187831, 32882.83015856559, 6324.302618392114, 7467.015893920309, 1372.1285556849832, 27216.442193975126, 1545.5141478355392, 36342.887794368675, 2906.44540555256, 5738.567065267723, 503.2343607997569, 14888.879668721485, -1539.7792718746966, 3468.060294059313, 3181.60416991708, 5317.623252904373, 4837.7799309187185, 17838.987361436586, 6821.171669004152, 18186.25270852651, 6333.3900038197235, 7374.411743795817, -1000.4336594350775, 31638.677028667007, 5111.305195207158, 13861.114909031816, -1732.1440415590082, 13613.43178771801, 7159.137357598138, 9099.93489330698, 4158.593247517162, 16884.342455752405, -1606.470755264384, 27225.184703710835, 2325.852283409048, 27901.282664363767, 5759.250937985827, 10195.345602738893, 3576.1138180986495, 31336.474552692263, 9446.810721528143, 13841.432676315831, 3579.6420371938784, 1853.8766693154364, 3103.8628089972485, 14486.737486223761, -1829.6841385473604, 11448.807992801241, 4535.34603626866, 3504.244639459022, -1361.7942343257237, 3902.33261902176, 1877.8336172870372, 7586.287844775987, 3744.6934070003044, 9444.204538920676, -1996.3447720939312, 20453.106267382776, -787.5863196561697, 30945.50476446499, 431.10477198224146, 11055.318429952607, 2433.1672238191354, 9635.255278565275, 2255.5748136092407, 18286.736880651613, 1946.2307669605716, 17603.502377461926, 3869.6187283944555, 35821.85165479393, 67.73444466994721, 9353.696156315678, 4722.670107141439, 2189.271521395262, 2530.385319288287, 11310.612803899254, 1594.4599656173953, 28812.079760508943, 898.9251503887779, 29608.574436130653, 9104.386934207516, 31802.233493329233, 14622.844129934, 13129.810533233458, 2875.8692778249224, 16821.304400314704, 1772.3480659849588, -332.2017884082952, 1519.1404787884808, 2421.523147044533, -2363.2974479529107, 7835.670435617401, 1639.8503509532711, 13317.721410017852, 313.5653494837875, 43520.27026197599, 3882.2261692789516, 12474.008597652946, 120.62131821549005, 18156.416536106564, 3079.4406904362545, 5917.660097316687, 3355.4680958767963, 13270.013975080119, 827.1842199062237, 16410.49234090384, 92.591520210992, 20532.06912455771, 1801.4435398393366, 30113.38492857437, 4607.1015475282475, 9469.546044948016, 3640.515576356847, 9000.359441941378, 1369.8934046526097, 42583.41985632515, 0.0, 13270.353843575167, 1314.3658270426754, 10011.913809275477, 2852.701816397911, 4443.938949508215, 2802.2159929179365, 5839.790841312771, 3611.6021232771645, 12270.332830009225, 463.5212993730472, 10598.9160967868, 6983.78260590488, 13380.136520482436, 6158.807357298315, 10465.424010953237, -82.07838712430032, 22322.29349700483, 2056.396967986274, 16058.964512759463, 876.1491104047177, 14018.831763097027, 3373.824990196445, 17649.93102479348, 1841.6996974463048, 7542.793387144687, 3659.207261197703, 37629.50196550943, 0.0, 13562.881854633448, 3532.8052911815353, 7891.666397665122, 2273.020645405973, 8328.567008220707, -2176.3337174369594, 12331.028640794717, 3892.1107403997007, 16915.089535778898, 4789.120755596966, 11072.761440245164, 2480.816447339749, 4595.206770118947, 2995.599292998945, 1261.162153208501, -639.9208017335588, 25651.76266488987, 4006.0762008438364, 6395.188937779565, 380.89550409393735, 17901.747634198444, 6912.267942214705, 12722.71648809511, 1133.8693122572192, 37328.1303802448, 4083.4396390506295, -707.3250649305876, 988.0567046868642, 1285.483008591005, -1566.8041832788442, 3924.632970995678, 2724.2234374706004, 3562.491186706233, -1691.2059215811937, -1751.525904312327, -89.931165474722, 8534.60891308552, 248.5423174530028, 8262.385892052745, 3630.002079178577, 4791.085270819729, 1572.715732642448, 18042.94893454745, 1856.393587689267, 7081.566327728613, 1979.5740651777392, 8408.831918623444, -750.4659600436104, 23918.014075793933, 2639.8468510602124]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6930530104593964, "mean_inference_ms": 1.4920573671427408, "mean_action_processing_ms": 0.2925801412061823, "mean_env_wait_ms": 0.13341616847220375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036317110061645508, "StateBufferConnector_ms": 0.0029534101486206055, "ViewRequirementAgentConnector_ms": 0.08341801166534424}, "num_episodes": 23, "episode_return_max": 46419.836991418924, "episode_return_min": 0.0, "episode_return_mean": 18260.13740538105, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 365.19131810557894, "num_env_steps_trained_throughput_per_sec": 365.19131810557894, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 12109.389, "restore_workers_time_ms": 0.012, "training_step_time_ms": 12109.349, "sample_time_ms": 950.132, "learn_time_ms": 11144.08, "learn_throughput": 358.935, "synch_weights_time_ms": 14.201}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "6751e_00000", "date": "2024-08-11_19-28-38", "timestamp": 1723418918, "time_this_iter_s": 10.956799030303955, "time_total_s": 1283.6903867721558, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1283.6903867721558, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 30.41875, "ram_util_percent": 74.25625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5700208325707723, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.732838445996482, "policy_loss": -0.006531856196474225, "vf_loss": 8.739313123339699, "vf_explained_var": -0.001782403547297079, "kl": 0.018289397811969817, "entropy": 0.6581924143607023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6812948709600186, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.809833806658547, "policy_loss": -0.004570305794502101, "vf_loss": 8.813712801504387, "vf_explained_var": -8.883324880448599e-05, "kl": 0.006912975141852826, "entropy": 0.715796851354932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 46419.836991418924, "episode_reward_min": 0.0, "episode_reward_mean": 16935.44181259185, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5335.779208098409, "predator_policy": -2363.2974479529107}, "policy_reward_max": {"prey_policy": 10031.69335033369, "predator_policy": 43520.27026197599}, "policy_reward_mean": {"prey_policy": 637.9549070985533, "predator_policy": 7829.765999197372}, "custom_metrics": {}, "hist_stats": {"episode_reward": [20334.96297397432, 29217.34730441208, 32661.1921446949, 15724.072712269284, 39991.46331546604, 19072.703717598382, 8210.940091464301, 18023.848702198313, 13946.44616999452, 1447.8054173940577, 9192.492921286952, 18999.119934460414, 13787.753559180977, 19929.459620417394, 31533.819135464764, 20348.6972376668, 15973.381991941002, 18186.11774418881, 19633.52776591588, 35265.699595494065, 17181.753254531533, 5942.1250190004985, 18316.404739028418, 29347.84547394261, 38920.80414958693, 45724.373167969585, 17490.534097478965, 17982.185906051585, 4309.372706996051, 6716.285427638947, 16469.86681026114, 16551.73655262478, 46419.836991418924, 16606.41013478763, 21939.360172113593, 4385.625115810385, 17731.035969237408, 20586.59222352235, 20833.88561954977, 32916.041274880175, 15098.7592932127, 13705.635806710954, 40970.037823126855, 18545.59452936344, 18027.007383130054, 15934.456460455538, 5886.508201315242, 19646.025510729803, 9705.156685685743, 16140.998170768551, 19438.831022794217, 22251.922957724517, 18594.66598121004, 16589.199640323015, 19993.629151262936, 8821.856817780208, 36692.40675310317, 16021.476895788062, 10466.42339202348, 11104.299564301717, 17329.7012344866, 21091.107295783484, 17273.81507515954, 2151.1265040105227, 5487.4230402136645, 27554.273695202606, 12392.206609122453, 22873.273762458313, 13709.782863337583, 40775.61725435763, 3834.184121439531, 7.105427357601002e-15, 6838.384224638664, 3043.3016558308273, 0.0, 11946.206731753122, 15687.141075484284, 3333.3120908374403, 20723.59900593998, 13111.548757810937, 11887.184937267157, 25655.775919190048, 9027.796688009863, 16323.055599664727, 35306.83200183245, 36047.44164209904, 7676.596659058075, 8280.16196062931, 7423.100139211992, 10541.246792225918, 1513.0443644687791, 4330.280375763601, 7171.172959167853, 1732.7835838130638, 14644.418268783771, 14898.148256890529, 15907.499960232482, 0.0, 32037.79841493745, 2496.01883534683], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [6176.98281993827, -1119.8915464519337, -160.9062133166745, -172.78346939113902, -928.3137690503623, -71.0276886043124, 2897.4003653843, -944.7870739525769, -144.44867154641102, -647.3732872079556, 2200.7242130232135, -549.0952089345146, 4354.5634747666945, -1101.3628616150615, 6893.199125330287, -1526.40377080836, -1077.6301344902013, -960.0777245851779, 4284.279266559032, -4978.924254298275, 5162.173852515076, -1749.8471675369221, 8807.135041688487, -1138.9963590043856, 7032.717274660644, -692.8234823064142, 1104.1923375252181, -840.2526648344106, -15.478019934371169, 172.68761895189954, 7111.046057316835, -250.8344734217701, 4503.416958108923, -420.8650583424828, -307.8534816820183, -1738.996421741353, 730.1337982974732, -2569.7271382379517, -258.27537883678684, -365.61112513301754, 3711.2415321129893, -605.8545410385764, 4332.045559483278, -3109.57738116633, 7052.402157616894, -1641.0701881051598, 38.89354868386468, -402.052985638978, 257.1352982234379, -49.29251897472746, -562.7101229917766, -137.99433230171257, 1690.675158096607, -205.82087167599673, 249.48861583587023, -860.9551760839712, 5681.261223881715, -2558.8272072658497, 9012.577018648879, -2354.5172901015444, 7079.76699880366, -85.4209751131191, 3447.310146632719, -526.8603535095806, -646.1315036799454, -336.5279361560373, 4559.588240447486, -547.808021528307, 894.6538735430356, -191.15092797215718, -768.2816383508855, -4119.221439032223, 5036.308048270571, -1402.4702740195385, 5276.065833846866, -1192.5574714393676, -318.1956351858883, -1181.431409661449, -1237.1129486697648, -567.3322525526778, 2800.9939705073903, -812.2962985995805, 4948.213091807298, -1612.830131690289, -1104.7334383157076, -508.6485948825902, 4398.721192621323, -437.84633387574934, 5392.082403624732, -229.6906461680521, 10031.69335033369, -1343.3918323043613, 773.1827787621392, -4338.067542036829, 7097.768744758397, -185.59736341100026, -3895.852766656829, -3981.6892503491003, -1120.4203015794399, -2277.52540543276, 9334.75827881691, -279.2728798516538, -681.8526233941767, -1444.914883872411, 1829.7798583933445, -170.22750034745536, 1080.1924440551634, -1883.6495570256045, 1602.1561075192883, -1100.1576784961014, 1060.0990197917786, -3440.2428503539677, -520.1800838108999, -416.91512859535527, 777.1588490895406, -1851.3690991164256, 2756.7297249108237, -2454.9933759584455, 5797.897336659394, -845.831063141365, 1873.729898432657, -767.168045140488, -528.9901213098842, -84.1128742825261, 4422.623946690215, -702.3867591156178, -1323.6437579224034, -4116.035801184964, 4716.265930705359, 149.91575803336536, -1005.1496303042164, -1098.4155402268734, 6946.82782452911, -1330.7056572801364, -1303.395036616813, -637.346777338058, 2833.1699757180445, -2979.9729127327832, -391.80777938094866, -244.14498555680302, 5811.844162013607, -2258.3916803303487, 5309.684528125569, -5028.36335343772, 3152.071027002302, -2962.5432108299146, 3274.540036981622, -2102.523646275832, 5316.029610618394, -3474.5725408313315, 4314.697526342088, -1151.6420251274678, 5420.467894181321, -1625.714789928356, 456.1410538480944, -3486.629966472833, 1243.3953711540926, -419.1388874509217, 4793.666594991295, -743.2582300867249, 5399.203415799842, -1170.3844371125272, -735.6200241493565, -166.46498351472036, 6115.314873124942, -2112.3424828467214, 2573.4742009945453, -623.0956069170883, -1392.7568273941372, -698.8660879056339, -1011.0524640143507, -758.5140079277418, 6038.697092224829, -3053.638069987689, 3179.7767608462977, -1367.440050452159, 8185.156702606909, -4069.089006782825, 4069.414654292565, -982.1386782358102, 1914.0653825002141, -3341.4792706015446, 1093.5859362266992, -2153.9873127867727, 2626.3666226749197, -3251.6092599722865, 3768.6429202869376, -5335.779208098409, 5600.738879398368, -942.4619201514347, -2409.8914412548, -1881.6042752865317, 6054.819598564858, -1194.4976820823244, -24.87808164218969, 685.1692197624061, -1321.0943762383988, -1393.936489563105, 1297.150058994173, -2038.524116971344], "policy_predator_policy_reward": [16884.342455752405, -1606.470755264384, 27225.184703710835, 2325.852283409048, 27901.282664363767, 5759.250937985827, 10195.345602738893, 3576.1138180986495, 31336.474552692263, 9446.810721528143, 13841.432676315831, 3579.6420371938784, 1853.8766693154364, 3103.8628089972485, 14486.737486223761, -1829.6841385473604, 11448.807992801241, 4535.34603626866, 3504.244639459022, -1361.7942343257237, 3902.33261902176, 1877.8336172870372, 7586.287844775987, 3744.6934070003044, 9444.204538920676, -1996.3447720939312, 20453.106267382776, -787.5863196561697, 30945.50476446499, 431.10477198224146, 11055.318429952607, 2433.1672238191354, 9635.255278565275, 2255.5748136092407, 18286.736880651613, 1946.2307669605716, 17603.502377461926, 3869.6187283944555, 35821.85165479393, 67.73444466994721, 9353.696156315678, 4722.670107141439, 2189.271521395262, 2530.385319288287, 11310.612803899254, 1594.4599656173953, 28812.079760508943, 898.9251503887779, 29608.574436130653, 9104.386934207516, 31802.233493329233, 14622.844129934, 13129.810533233458, 2875.8692778249224, 16821.304400314704, 1772.3480659849588, -332.2017884082952, 1519.1404787884808, 2421.523147044533, -2363.2974479529107, 7835.670435617401, 1639.8503509532711, 13317.721410017852, 313.5653494837875, 43520.27026197599, 3882.2261692789516, 12474.008597652946, 120.62131821549005, 18156.416536106564, 3079.4406904362545, 5917.660097316687, 3355.4680958767963, 13270.013975080119, 827.1842199062237, 16410.49234090384, 92.591520210992, 20532.06912455771, 1801.4435398393366, 30113.38492857437, 4607.1015475282475, 9469.546044948016, 3640.515576356847, 9000.359441941378, 1369.8934046526097, 42583.41985632515, 0.0, 13270.353843575167, 1314.3658270426754, 10011.913809275477, 2852.701816397911, 4443.938949508215, 2802.2159929179365, 5839.790841312771, 3611.6021232771645, 12270.332830009225, 463.5212993730472, 10598.9160967868, 6983.78260590488, 13380.136520482436, 6158.807357298315, 10465.424010953237, -82.07838712430032, 22322.29349700483, 2056.396967986274, 16058.964512759463, 876.1491104047177, 14018.831763097027, 3373.824990196445, 17649.93102479348, 1841.6996974463048, 7542.793387144687, 3659.207261197703, 37629.50196550943, 0.0, 13562.881854633448, 3532.8052911815353, 7891.666397665122, 2273.020645405973, 8328.567008220707, -2176.3337174369594, 12331.028640794717, 3892.1107403997007, 16915.089535778898, 4789.120755596966, 11072.761440245164, 2480.816447339749, 4595.206770118947, 2995.599292998945, 1261.162153208501, -639.9208017335588, 25651.76266488987, 4006.0762008438364, 6395.188937779565, 380.89550409393735, 17901.747634198444, 6912.267942214705, 12722.71648809511, 1133.8693122572192, 37328.1303802448, 4083.4396390506295, -707.3250649305876, 988.0567046868642, 1285.483008591005, -1566.8041832788442, 3924.632970995678, 2724.2234374706004, 3562.491186706233, -1691.2059215811937, -1751.525904312327, -89.931165474722, 8534.60891308552, 248.5423174530028, 8262.385892052745, 3630.002079178577, 4791.085270819729, 1572.715732642448, 18042.94893454745, 1856.393587689267, 7081.566327728613, 1979.5740651777392, 8408.831918623444, -750.4659600436104, 23918.014075793933, 2639.8468510602124, 6639.93428072956, -1615.10998299792, 12825.587801124151, 1547.0892044630973, 35204.2359518649, 2194.218965267318, 32243.290154390626, 5573.717959650468, 4757.606521559675, -66.06888473873889, 5690.253947837844, 777.5713023973321, 4587.34195281928, -1280.3095094313694, 8408.57969866069, -954.6088824915339, 1492.4824481629082, 1447.9758044071916, 2557.1723991225263, 2833.5093532011488, 4914.976171502012, 2881.4394249632087, -1396.1147171938376, 4696.034588818372, 9096.478264872896, 889.6630446639656, 12987.278101811018, 6202.365871620839, 8556.398290624391, 2490.779753125544, -660.2911381202182, 0.0, 30121.2844495919, 4631.544831147056, 1807.4067211428046, 1429.9861721811972]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6910445216731805, "mean_inference_ms": 1.4855212114072736, "mean_action_processing_ms": 0.29236038706820844, "mean_env_wait_ms": 0.13282904630860964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039016008377075195, "StateBufferConnector_ms": 0.002877473831176758, "ViewRequirementAgentConnector_ms": 0.08142948150634766}, "num_episodes": 18, "episode_return_max": 46419.836991418924, "episode_return_min": 0.0, "episode_return_mean": 16935.44181259185, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.4503317360916, "num_env_steps_trained_throughput_per_sec": 368.4503317360916, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 11900.198, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11900.16, "sample_time_ms": 933.601, "learn_time_ms": 10951.601, "learn_throughput": 365.243, "synch_weights_time_ms": 14.077}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "6751e_00000", "date": "2024-08-11_19-28-49", "timestamp": 1723418929, "time_this_iter_s": 10.86028504371643, "time_total_s": 1294.5506718158722, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81ed30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1294.5506718158722, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 31.5, "ram_util_percent": 74.52666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4544239776475089, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.764830515624354, "policy_loss": -0.005646171825371249, "vf_loss": 8.770442383125346, "vf_explained_var": 0.00010850394844378113, "kl": 0.010979634686893367, "entropy": 0.6176268575998841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7546180560159935, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.682946340369169, "policy_loss": -0.004215035567715488, "vf_loss": 8.686510387299553, "vf_explained_var": -8.391255424136207e-05, "kl": 0.0065098448476270275, "entropy": 0.7473385995657986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 46419.836991418924, "episode_reward_min": 0.0, "episode_reward_mean": 15706.371913721609, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6242.775156908537, "predator_policy": -2470.8423524497593}, "policy_reward_max": {"prey_policy": 10031.69335033369, "predator_policy": 43520.27026197599}, "policy_reward_mean": {"prey_policy": 598.3764281195478, "predator_policy": 7254.809528741257}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19633.52776591588, 35265.699595494065, 17181.753254531533, 5942.1250190004985, 18316.404739028418, 29347.84547394261, 38920.80414958693, 45724.373167969585, 17490.534097478965, 17982.185906051585, 4309.372706996051, 6716.285427638947, 16469.86681026114, 16551.73655262478, 46419.836991418924, 16606.41013478763, 21939.360172113593, 4385.625115810385, 17731.035969237408, 20586.59222352235, 20833.88561954977, 32916.041274880175, 15098.7592932127, 13705.635806710954, 40970.037823126855, 18545.59452936344, 18027.007383130054, 15934.456460455538, 5886.508201315242, 19646.025510729803, 9705.156685685743, 16140.998170768551, 19438.831022794217, 22251.922957724517, 18594.66598121004, 16589.199640323015, 19993.629151262936, 8821.856817780208, 36692.40675310317, 16021.476895788062, 10466.42339202348, 11104.299564301717, 17329.7012344866, 21091.107295783484, 17273.81507515954, 2151.1265040105227, 5487.4230402136645, 27554.273695202606, 12392.206609122453, 22873.273762458313, 13709.782863337583, 40775.61725435763, 3834.184121439531, 7.105427357601002e-15, 6838.384224638664, 3043.3016558308273, 0.0, 11946.206731753122, 15687.141075484284, 3333.3120908374403, 20723.59900593998, 13111.548757810937, 11887.184937267157, 25655.775919190048, 9027.796688009863, 16323.055599664727, 35306.83200183245, 36047.44164209904, 7676.596659058075, 8280.16196062931, 7423.100139211992, 10541.246792225918, 1513.0443644687791, 4330.280375763601, 7171.172959167853, 1732.7835838130638, 14644.418268783771, 14898.148256890529, 15907.499960232482, 0.0, 32037.79841493745, 2496.01883534683, 14356.297989126473, 20885.087892638196, 3028.878187147703, 15012.476067867436, 5621.034198821438, 3290.1202125169293, 24089.331022820177, 18869.16270553971, 11138.223820870962, 7180.597338293154, 17291.186038511085, 12860.486831725226, 20109.45193971982, 579.284765715098, 973.9135244899753, 22689.65466184643, 16661.46388749522, 9037.98372190433], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [730.1337982974732, -2569.7271382379517, -258.27537883678684, -365.61112513301754, 3711.2415321129893, -605.8545410385764, 4332.045559483278, -3109.57738116633, 7052.402157616894, -1641.0701881051598, 38.89354868386468, -402.052985638978, 257.1352982234379, -49.29251897472746, -562.7101229917766, -137.99433230171257, 1690.675158096607, -205.82087167599673, 249.48861583587023, -860.9551760839712, 5681.261223881715, -2558.8272072658497, 9012.577018648879, -2354.5172901015444, 7079.76699880366, -85.4209751131191, 3447.310146632719, -526.8603535095806, -646.1315036799454, -336.5279361560373, 4559.588240447486, -547.808021528307, 894.6538735430356, -191.15092797215718, -768.2816383508855, -4119.221439032223, 5036.308048270571, -1402.4702740195385, 5276.065833846866, -1192.5574714393676, -318.1956351858883, -1181.431409661449, -1237.1129486697648, -567.3322525526778, 2800.9939705073903, -812.2962985995805, 4948.213091807298, -1612.830131690289, -1104.7334383157076, -508.6485948825902, 4398.721192621323, -437.84633387574934, 5392.082403624732, -229.6906461680521, 10031.69335033369, -1343.3918323043613, 773.1827787621392, -4338.067542036829, 7097.768744758397, -185.59736341100026, -3895.852766656829, -3981.6892503491003, -1120.4203015794399, -2277.52540543276, 9334.75827881691, -279.2728798516538, -681.8526233941767, -1444.914883872411, 1829.7798583933445, -170.22750034745536, 1080.1924440551634, -1883.6495570256045, 1602.1561075192883, -1100.1576784961014, 1060.0990197917786, -3440.2428503539677, -520.1800838108999, -416.91512859535527, 777.1588490895406, -1851.3690991164256, 2756.7297249108237, -2454.9933759584455, 5797.897336659394, -845.831063141365, 1873.729898432657, -767.168045140488, -528.9901213098842, -84.1128742825261, 4422.623946690215, -702.3867591156178, -1323.6437579224034, -4116.035801184964, 4716.265930705359, 149.91575803336536, -1005.1496303042164, -1098.4155402268734, 6946.82782452911, -1330.7056572801364, -1303.395036616813, -637.346777338058, 2833.1699757180445, -2979.9729127327832, -391.80777938094866, -244.14498555680302, 5811.844162013607, -2258.3916803303487, 5309.684528125569, -5028.36335343772, 3152.071027002302, -2962.5432108299146, 3274.540036981622, -2102.523646275832, 5316.029610618394, -3474.5725408313315, 4314.697526342088, -1151.6420251274678, 5420.467894181321, -1625.714789928356, 456.1410538480944, -3486.629966472833, 1243.3953711540926, -419.1388874509217, 4793.666594991295, -743.2582300867249, 5399.203415799842, -1170.3844371125272, -735.6200241493565, -166.46498351472036, 6115.314873124942, -2112.3424828467214, 2573.4742009945453, -623.0956069170883, -1392.7568273941372, -698.8660879056339, -1011.0524640143507, -758.5140079277418, 6038.697092224829, -3053.638069987689, 3179.7767608462977, -1367.440050452159, 8185.156702606909, -4069.089006782825, 4069.414654292565, -982.1386782358102, 1914.0653825002141, -3341.4792706015446, 1093.5859362266992, -2153.9873127867727, 2626.3666226749197, -3251.6092599722865, 3768.6429202869376, -5335.779208098409, 5600.738879398368, -942.4619201514347, -2409.8914412548, -1881.6042752865317, 6054.819598564858, -1194.4976820823244, -24.87808164218969, 685.1692197624061, -1321.0943762383988, -1393.936489563105, 1297.150058994173, -2038.524116971344, 7116.437573999605, -1982.6416598564115, 8194.657174998472, -244.5438153129987, 4500.841740641069, -1358.4278640801751, 5087.802298919321, -1198.3060523564852, 3214.323315214719, -2981.2272518665554, 3726.6652417980417, -2360.536822201658, -1394.5772116795454, -1050.338157389073, 4462.5896979172385, -836.7916171228262, 4600.6698009172005, -2925.9745107853364, 4197.518176831828, -838.43148264962, 2368.831964931356, -480.87674501782243, 6494.619807739364, -793.448784861703, -1943.778795299242, -648.4443353217156, 638.1197068193142, -6242.775156908537, 4039.8278823904993, -1599.347221041143, -266.6179162209782, -1585.8858858488977, 2815.5067482686122, -797.4252714058476, 4543.614182743808, -3225.7789499931628], "policy_predator_policy_reward": [17603.502377461926, 3869.6187283944555, 35821.85165479393, 67.73444466994721, 9353.696156315678, 4722.670107141439, 2189.271521395262, 2530.385319288287, 11310.612803899254, 1594.4599656173953, 28812.079760508943, 898.9251503887779, 29608.574436130653, 9104.386934207516, 31802.233493329233, 14622.844129934, 13129.810533233458, 2875.8692778249224, 16821.304400314704, 1772.3480659849588, -332.2017884082952, 1519.1404787884808, 2421.523147044533, -2363.2974479529107, 7835.670435617401, 1639.8503509532711, 13317.721410017852, 313.5653494837875, 43520.27026197599, 3882.2261692789516, 12474.008597652946, 120.62131821549005, 18156.416536106564, 3079.4406904362545, 5917.660097316687, 3355.4680958767963, 13270.013975080119, 827.1842199062237, 16410.49234090384, 92.591520210992, 20532.06912455771, 1801.4435398393366, 30113.38492857437, 4607.1015475282475, 9469.546044948016, 3640.515576356847, 9000.359441941378, 1369.8934046526097, 42583.41985632515, 0.0, 13270.353843575167, 1314.3658270426754, 10011.913809275477, 2852.701816397911, 4443.938949508215, 2802.2159929179365, 5839.790841312771, 3611.6021232771645, 12270.332830009225, 463.5212993730472, 10598.9160967868, 6983.78260590488, 13380.136520482436, 6158.807357298315, 10465.424010953237, -82.07838712430032, 22322.29349700483, 2056.396967986274, 16058.964512759463, 876.1491104047177, 14018.831763097027, 3373.824990196445, 17649.93102479348, 1841.6996974463048, 7542.793387144687, 3659.207261197703, 37629.50196550943, 0.0, 13562.881854633448, 3532.8052911815353, 7891.666397665122, 2273.020645405973, 8328.567008220707, -2176.3337174369594, 12331.028640794717, 3892.1107403997007, 16915.089535778898, 4789.120755596966, 11072.761440245164, 2480.816447339749, 4595.206770118947, 2995.599292998945, 1261.162153208501, -639.9208017335588, 25651.76266488987, 4006.0762008438364, 6395.188937779565, 380.89550409393735, 17901.747634198444, 6912.267942214705, 12722.71648809511, 1133.8693122572192, 37328.1303802448, 4083.4396390506295, -707.3250649305876, 988.0567046868642, 1285.483008591005, -1566.8041832788442, 3924.632970995678, 2724.2234374706004, 3562.491186706233, -1691.2059215811937, -1751.525904312327, -89.931165474722, 8534.60891308552, 248.5423174530028, 8262.385892052745, 3630.002079178577, 4791.085270819729, 1572.715732642448, 18042.94893454745, 1856.393587689267, 7081.566327728613, 1979.5740651777392, 8408.831918623444, -750.4659600436104, 23918.014075793933, 2639.8468510602124, 6639.93428072956, -1615.10998299792, 12825.587801124151, 1547.0892044630973, 35204.2359518649, 2194.218965267318, 32243.290154390626, 5573.717959650468, 4757.606521559675, -66.06888473873889, 5690.253947837844, 777.5713023973321, 4587.34195281928, -1280.3095094313694, 8408.57969866069, -954.6088824915339, 1492.4824481629082, 1447.9758044071916, 2557.1723991225263, 2833.5093532011488, 4914.976171502012, 2881.4394249632087, -1396.1147171938376, 4696.034588818372, 9096.478264872896, 889.6630446639656, 12987.278101811018, 6202.365871620839, 8556.398290624391, 2490.779753125544, -660.2911381202182, 0.0, 30121.2844495919, 4631.544831147056, 1807.4067211428046, 1429.9861721811972, 6482.839367097312, 2739.662707885977, 10340.903072687743, 2594.0714602649, -844.6954773618636, 731.1597879486826, 10530.504700191712, 592.4751211129019, -121.95644610497516, 5509.894581578235, 405.7533387476767, 1518.2384541728686, 21445.07167360441, 5089.174718284405, 15584.533903634125, -341.1692788888548, 6670.389939316437, 2793.1385914226635, 4611.373175242427, -789.862531131497, 14740.343699068433, 662.887119529151, 5750.762592849355, 1408.5532159981806, 14863.196287351571, 7838.478782989195, 2324.3841695904644, 3859.5560462138524, -2470.8423524497593, 1004.2752155903833, 21269.005889433287, 3273.152574483016, 9951.517529344572, 4691.864881287965, 2702.984349031469, 5017.164140122219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6888327529935867, "mean_inference_ms": 1.4801849446840643, "mean_action_processing_ms": 0.29140448041017764, "mean_env_wait_ms": 0.1323205037589781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004131674766540527, "StateBufferConnector_ms": 0.002644658088684082, "ViewRequirementAgentConnector_ms": 0.07712876796722412}, "num_episodes": 18, "episode_return_max": 46419.836991418924, "episode_return_min": 0.0, "episode_return_mean": 15706.371913721609, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.9078082621171, "num_env_steps_trained_throughput_per_sec": 362.9078082621171, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 11749.07, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11749.034, "sample_time_ms": 912.809, "learn_time_ms": 10821.916, "learn_throughput": 369.62, "synch_weights_time_ms": 13.565}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-00", "timestamp": 1723418940, "time_this_iter_s": 11.027111053466797, "time_total_s": 1305.577782869339, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eada550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1305.577782869339, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 30.518749999999997, "ram_util_percent": 74.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4568946460567454, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.277164569733635, "policy_loss": -0.004611215993353023, "vf_loss": 8.28175343357066, "vf_explained_var": -0.0008542729748619928, "kl": 0.007151031002962718, "entropy": 0.657464374972399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6639701409235833, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.060655697817525, "policy_loss": -0.006525647257597595, "vf_loss": 9.066399484967429, "vf_explained_var": 3.6529668424495314e-05, "kl": 0.007818038687938645, "entropy": 0.7264352717412212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 40970.037823126855, "episode_reward_min": 0.0, "episode_reward_mean": 14357.589278646905, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -6242.775156908537, "predator_policy": -4993.352345617459}, "policy_reward_max": {"prey_policy": 10420.425573935956, "predator_policy": 42583.41985632515}, "policy_reward_mean": {"prey_policy": 594.7996371161945, "predator_policy": 6583.995002207256}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15098.7592932127, 13705.635806710954, 40970.037823126855, 18545.59452936344, 18027.007383130054, 15934.456460455538, 5886.508201315242, 19646.025510729803, 9705.156685685743, 16140.998170768551, 19438.831022794217, 22251.922957724517, 18594.66598121004, 16589.199640323015, 19993.629151262936, 8821.856817780208, 36692.40675310317, 16021.476895788062, 10466.42339202348, 11104.299564301717, 17329.7012344866, 21091.107295783484, 17273.81507515954, 2151.1265040105227, 5487.4230402136645, 27554.273695202606, 12392.206609122453, 22873.273762458313, 13709.782863337583, 40775.61725435763, 3834.184121439531, 7.105427357601002e-15, 6838.384224638664, 3043.3016558308273, 0.0, 11946.206731753122, 15687.141075484284, 3333.3120908374403, 20723.59900593998, 13111.548757810937, 11887.184937267157, 25655.775919190048, 9027.796688009863, 16323.055599664727, 35306.83200183245, 36047.44164209904, 7676.596659058075, 8280.16196062931, 7423.100139211992, 10541.246792225918, 1513.0443644687791, 4330.280375763601, 7171.172959167853, 1732.7835838130638, 14644.418268783771, 14898.148256890529, 15907.499960232482, 0.0, 32037.79841493745, 2496.01883534683, 14356.297989126473, 20885.087892638196, 3028.878187147703, 15012.476067867436, 5621.034198821438, 3290.1202125169293, 24089.331022820177, 18869.16270553971, 11138.223820870962, 7180.597338293154, 17291.186038511085, 12860.486831725226, 20109.45193971982, 579.284765715098, 973.9135244899753, 22689.65466184643, 16661.46388749522, 9037.98372190433, 5208.984781483815, 16435.927796655364, 14066.973647041861, 520.1680790700955, 33274.46767512824, 21182.461946465573, 15037.321946087264, 17912.40813098585, 5141.637828791121, 1315.8110611714037, 14882.117484739598, 16069.428125039642, 28188.3103423978, 17166.604244749567, 23162.804745350295, 11162.435882294845, 0.0, 19661.80093413905, 16403.7965660773, 35505.18997812501, 6157.614919247583, 17936.772545329422], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2800.9939705073903, -812.2962985995805, 4948.213091807298, -1612.830131690289, -1104.7334383157076, -508.6485948825902, 4398.721192621323, -437.84633387574934, 5392.082403624732, -229.6906461680521, 10031.69335033369, -1343.3918323043613, 773.1827787621392, -4338.067542036829, 7097.768744758397, -185.59736341100026, -3895.852766656829, -3981.6892503491003, -1120.4203015794399, -2277.52540543276, 9334.75827881691, -279.2728798516538, -681.8526233941767, -1444.914883872411, 1829.7798583933445, -170.22750034745536, 1080.1924440551634, -1883.6495570256045, 1602.1561075192883, -1100.1576784961014, 1060.0990197917786, -3440.2428503539677, -520.1800838108999, -416.91512859535527, 777.1588490895406, -1851.3690991164256, 2756.7297249108237, -2454.9933759584455, 5797.897336659394, -845.831063141365, 1873.729898432657, -767.168045140488, -528.9901213098842, -84.1128742825261, 4422.623946690215, -702.3867591156178, -1323.6437579224034, -4116.035801184964, 4716.265930705359, 149.91575803336536, -1005.1496303042164, -1098.4155402268734, 6946.82782452911, -1330.7056572801364, -1303.395036616813, -637.346777338058, 2833.1699757180445, -2979.9729127327832, -391.80777938094866, -244.14498555680302, 5811.844162013607, -2258.3916803303487, 5309.684528125569, -5028.36335343772, 3152.071027002302, -2962.5432108299146, 3274.540036981622, -2102.523646275832, 5316.029610618394, -3474.5725408313315, 4314.697526342088, -1151.6420251274678, 5420.467894181321, -1625.714789928356, 456.1410538480944, -3486.629966472833, 1243.3953711540926, -419.1388874509217, 4793.666594991295, -743.2582300867249, 5399.203415799842, -1170.3844371125272, -735.6200241493565, -166.46498351472036, 6115.314873124942, -2112.3424828467214, 2573.4742009945453, -623.0956069170883, -1392.7568273941372, -698.8660879056339, -1011.0524640143507, -758.5140079277418, 6038.697092224829, -3053.638069987689, 3179.7767608462977, -1367.440050452159, 8185.156702606909, -4069.089006782825, 4069.414654292565, -982.1386782358102, 1914.0653825002141, -3341.4792706015446, 1093.5859362266992, -2153.9873127867727, 2626.3666226749197, -3251.6092599722865, 3768.6429202869376, -5335.779208098409, 5600.738879398368, -942.4619201514347, -2409.8914412548, -1881.6042752865317, 6054.819598564858, -1194.4976820823244, -24.87808164218969, 685.1692197624061, -1321.0943762383988, -1393.936489563105, 1297.150058994173, -2038.524116971344, 7116.437573999605, -1982.6416598564115, 8194.657174998472, -244.5438153129987, 4500.841740641069, -1358.4278640801751, 5087.802298919321, -1198.3060523564852, 3214.323315214719, -2981.2272518665554, 3726.6652417980417, -2360.536822201658, -1394.5772116795454, -1050.338157389073, 4462.5896979172385, -836.7916171228262, 4600.6698009172005, -2925.9745107853364, 4197.518176831828, -838.43148264962, 2368.831964931356, -480.87674501782243, 6494.619807739364, -793.448784861703, -1943.778795299242, -648.4443353217156, 638.1197068193142, -6242.775156908537, 4039.8278823904993, -1599.347221041143, -266.6179162209782, -1585.8858858488977, 2815.5067482686122, -797.4252714058476, 4543.614182743808, -3225.7789499931628, 4264.097829284249, -4120.560181717036, -40.13048662404257, -905.6896506452308, -270.87349299818214, -1337.5748069253823, -785.7161809219714, -3855.7315496596507, -624.7772688058095, -92.72058708719884, -1351.2067381939924, -2610.73330880271, 9480.210362503756, -692.011857876534, 4952.41328262811, -287.71438549501266, 1086.976402649996, 659.4554675034458, -867.0377871792252, -2075.3321024506367, 6199.718822834867, -2106.713820413099, 10420.425573935956, -1201.1240835226736, -2515.763742751718, -1250.05201264947, -1663.4990386778338, -1534.9969054678377, 1136.4440452518568, -2352.5609471379444, 1925.2659905192122, -883.3551778220833, 4771.391224120964, 1738.3912574600934, 3601.174436763048, -356.92647549814467, 6413.540896889652, -578.3620174047927, -849.2172897547867, -342.53551829887743, 5698.4134055254735, -2033.1954706373913, 5608.73839163309, -839.1446967531467], "policy_predator_policy_reward": [9469.546044948016, 3640.515576356847, 9000.359441941378, 1369.8934046526097, 42583.41985632515, 0.0, 13270.353843575167, 1314.3658270426754, 10011.913809275477, 2852.701816397911, 4443.938949508215, 2802.2159929179365, 5839.790841312771, 3611.6021232771645, 12270.332830009225, 463.5212993730472, 10598.9160967868, 6983.78260590488, 13380.136520482436, 6158.807357298315, 10465.424010953237, -82.07838712430032, 22322.29349700483, 2056.396967986274, 16058.964512759463, 876.1491104047177, 14018.831763097027, 3373.824990196445, 17649.93102479348, 1841.6996974463048, 7542.793387144687, 3659.207261197703, 37629.50196550943, 0.0, 13562.881854633448, 3532.8052911815353, 7891.666397665122, 2273.020645405973, 8328.567008220707, -2176.3337174369594, 12331.028640794717, 3892.1107403997007, 16915.089535778898, 4789.120755596966, 11072.761440245164, 2480.816447339749, 4595.206770118947, 2995.599292998945, 1261.162153208501, -639.9208017335588, 25651.76266488987, 4006.0762008438364, 6395.188937779565, 380.89550409393735, 17901.747634198444, 6912.267942214705, 12722.71648809511, 1133.8693122572192, 37328.1303802448, 4083.4396390506295, -707.3250649305876, 988.0567046868642, 1285.483008591005, -1566.8041832788442, 3924.632970995678, 2724.2234374706004, 3562.491186706233, -1691.2059215811937, -1751.525904312327, -89.931165474722, 8534.60891308552, 248.5423174530028, 8262.385892052745, 3630.002079178577, 4791.085270819729, 1572.715732642448, 18042.94893454745, 1856.393587689267, 7081.566327728613, 1979.5740651777392, 8408.831918623444, -750.4659600436104, 23918.014075793933, 2639.8468510602124, 6639.93428072956, -1615.10998299792, 12825.587801124151, 1547.0892044630973, 35204.2359518649, 2194.218965267318, 32243.290154390626, 5573.717959650468, 4757.606521559675, -66.06888473873889, 5690.253947837844, 777.5713023973321, 4587.34195281928, -1280.3095094313694, 8408.57969866069, -954.6088824915339, 1492.4824481629082, 1447.9758044071916, 2557.1723991225263, 2833.5093532011488, 4914.976171502012, 2881.4394249632087, -1396.1147171938376, 4696.034588818372, 9096.478264872896, 889.6630446639656, 12987.278101811018, 6202.365871620839, 8556.398290624391, 2490.779753125544, -660.2911381202182, 0.0, 30121.2844495919, 4631.544831147056, 1807.4067211428046, 1429.9861721811972, 6482.839367097312, 2739.662707885977, 10340.903072687743, 2594.0714602649, -844.6954773618636, 731.1597879486826, 10530.504700191712, 592.4751211129019, -121.95644610497516, 5509.894581578235, 405.7533387476767, 1518.2384541728686, 21445.07167360441, 5089.174718284405, 15584.533903634125, -341.1692788888548, 6670.389939316437, 2793.1385914226635, 4611.373175242427, -789.862531131497, 14740.343699068433, 662.887119529151, 5750.762592849355, 1408.5532159981806, 14863.196287351571, 7838.478782989195, 2324.3841695904644, 3859.5560462138524, -2470.8423524497593, 1004.2752155903833, 21269.005889433287, 3273.152574483016, 9951.517529344572, 4691.864881287965, 2702.984349031469, 5017.164140122219, 4071.8496436154173, 993.5974903011862, 12129.25708957766, 5252.490844346925, 7550.61119354108, 8124.810753424348, 267.12120798880716, 4894.49460166291, 31016.17256274038, 2975.7929682808685, 18937.165979500467, 6207.236013961825, 2270.6945595455254, 3978.42888191457, 10506.750786177132, 2740.958447675635, 1843.9896966205351, 1551.2162620171482, 3876.285324886974, 381.89562591429365, 9381.733716399449, 1407.378765918367, 4929.592339816454, 1920.5342948098564, 24865.37708548843, 7088.749012310542, 9462.805896459597, 10902.29429243566, 24019.35872433998, 359.56292289639975, 10378.388640220222, -257.8635706225167, -1516.4301359635929, -4993.352345617459, 16030.201531591845, 387.35144128234936, 11301.223693107724, -732.6060065152705, 35311.2752705673, 1385.6675156113804, -4134.69014735424, 6627.0871317137435, 10193.864083485561, 2973.3147669639125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6861483014295984, "mean_inference_ms": 1.473800013069034, "mean_action_processing_ms": 0.29024219952855745, "mean_env_wait_ms": 0.13170798851608953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004562973976135254, "StateBufferConnector_ms": 0.0026470422744750977, "ViewRequirementAgentConnector_ms": 0.0769186019897461}, "num_episodes": 22, "episode_return_max": 40970.037823126855, "episode_return_min": 0.0, "episode_return_mean": 14357.589278646905, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.9045889243263, "num_env_steps_trained_throughput_per_sec": 361.9045889243263, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 11586.959, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11586.923, "sample_time_ms": 894.03, "learn_time_ms": 10678.888, "learn_throughput": 374.571, "synch_weights_time_ms": 13.369}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-11", "timestamp": 1723418951, "time_this_iter_s": 11.056750059127808, "time_total_s": 1316.6345329284668, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacdaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1316.6345329284668, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 32.21999999999999, "ram_util_percent": 74.93333333333335}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5139523267036392, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.056148424098101, "policy_loss": -0.006791336836155366, "vf_loss": 8.06289197629091, "vf_explained_var": 0.001624854563405274, "kl": 0.015287029486676717, "entropy": 0.656994279509499, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6812369158580189, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.119557621365502, "policy_loss": -0.00742328338320096, "vf_loss": 9.125915080277377, "vf_explained_var": 6.877240680512928e-06, "kl": 0.010657916145752342, "entropy": 0.7841774747169837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 41598.21638498358, "episode_reward_min": 0.0, "episode_reward_mean": 14019.33166761835, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7105.491803869579, "predator_policy": -4993.352345617459}, "policy_reward_max": {"prey_policy": 10420.425573935956, "predator_policy": 37328.1303802448}, "policy_reward_mean": {"prey_policy": 629.358131614868, "predator_policy": 6380.307702194305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10466.42339202348, 11104.299564301717, 17329.7012344866, 21091.107295783484, 17273.81507515954, 2151.1265040105227, 5487.4230402136645, 27554.273695202606, 12392.206609122453, 22873.273762458313, 13709.782863337583, 40775.61725435763, 3834.184121439531, 7.105427357601002e-15, 6838.384224638664, 3043.3016558308273, 0.0, 11946.206731753122, 15687.141075484284, 3333.3120908374403, 20723.59900593998, 13111.548757810937, 11887.184937267157, 25655.775919190048, 9027.796688009863, 16323.055599664727, 35306.83200183245, 36047.44164209904, 7676.596659058075, 8280.16196062931, 7423.100139211992, 10541.246792225918, 1513.0443644687791, 4330.280375763601, 7171.172959167853, 1732.7835838130638, 14644.418268783771, 14898.148256890529, 15907.499960232482, 0.0, 32037.79841493745, 2496.01883534683, 14356.297989126473, 20885.087892638196, 3028.878187147703, 15012.476067867436, 5621.034198821438, 3290.1202125169293, 24089.331022820177, 18869.16270553971, 11138.223820870962, 7180.597338293154, 17291.186038511085, 12860.486831725226, 20109.45193971982, 579.284765715098, 973.9135244899753, 22689.65466184643, 16661.46388749522, 9037.98372190433, 5208.984781483815, 16435.927796655364, 14066.973647041861, 520.1680790700955, 33274.46767512824, 21182.461946465573, 15037.321946087264, 17912.40813098585, 5141.637828791121, 1315.8110611714037, 14882.117484739598, 16069.428125039642, 28188.3103423978, 17166.604244749567, 23162.804745350295, 11162.435882294845, 0.0, 19661.80093413905, 16403.7965660773, 35505.18997812501, 6157.614919247583, 17936.772545329422, 9980.960225373448, 296.1943881806057, 7302.339969686725, 19842.905937784544, 41598.21638498358, 14803.821436581547, 1087.2692368916523, 27681.932139891585, 9649.412284022334, 20594.326324762893, 19206.292369397455, 18508.74015484822, 28309.07545157603, 12925.39151156272, 17512.181811475883, 19182.9631116862, 19635.72375294651, 10120.66148997733], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [2756.7297249108237, -2454.9933759584455, 5797.897336659394, -845.831063141365, 1873.729898432657, -767.168045140488, -528.9901213098842, -84.1128742825261, 4422.623946690215, -702.3867591156178, -1323.6437579224034, -4116.035801184964, 4716.265930705359, 149.91575803336536, -1005.1496303042164, -1098.4155402268734, 6946.82782452911, -1330.7056572801364, -1303.395036616813, -637.346777338058, 2833.1699757180445, -2979.9729127327832, -391.80777938094866, -244.14498555680302, 5811.844162013607, -2258.3916803303487, 5309.684528125569, -5028.36335343772, 3152.071027002302, -2962.5432108299146, 3274.540036981622, -2102.523646275832, 5316.029610618394, -3474.5725408313315, 4314.697526342088, -1151.6420251274678, 5420.467894181321, -1625.714789928356, 456.1410538480944, -3486.629966472833, 1243.3953711540926, -419.1388874509217, 4793.666594991295, -743.2582300867249, 5399.203415799842, -1170.3844371125272, -735.6200241493565, -166.46498351472036, 6115.314873124942, -2112.3424828467214, 2573.4742009945453, -623.0956069170883, -1392.7568273941372, -698.8660879056339, -1011.0524640143507, -758.5140079277418, 6038.697092224829, -3053.638069987689, 3179.7767608462977, -1367.440050452159, 8185.156702606909, -4069.089006782825, 4069.414654292565, -982.1386782358102, 1914.0653825002141, -3341.4792706015446, 1093.5859362266992, -2153.9873127867727, 2626.3666226749197, -3251.6092599722865, 3768.6429202869376, -5335.779208098409, 5600.738879398368, -942.4619201514347, -2409.8914412548, -1881.6042752865317, 6054.819598564858, -1194.4976820823244, -24.87808164218969, 685.1692197624061, -1321.0943762383988, -1393.936489563105, 1297.150058994173, -2038.524116971344, 7116.437573999605, -1982.6416598564115, 8194.657174998472, -244.5438153129987, 4500.841740641069, -1358.4278640801751, 5087.802298919321, -1198.3060523564852, 3214.323315214719, -2981.2272518665554, 3726.6652417980417, -2360.536822201658, -1394.5772116795454, -1050.338157389073, 4462.5896979172385, -836.7916171228262, 4600.6698009172005, -2925.9745107853364, 4197.518176831828, -838.43148264962, 2368.831964931356, -480.87674501782243, 6494.619807739364, -793.448784861703, -1943.778795299242, -648.4443353217156, 638.1197068193142, -6242.775156908537, 4039.8278823904993, -1599.347221041143, -266.6179162209782, -1585.8858858488977, 2815.5067482686122, -797.4252714058476, 4543.614182743808, -3225.7789499931628, 4264.097829284249, -4120.560181717036, -40.13048662404257, -905.6896506452308, -270.87349299818214, -1337.5748069253823, -785.7161809219714, -3855.7315496596507, -624.7772688058095, -92.72058708719884, -1351.2067381939924, -2610.73330880271, 9480.210362503756, -692.011857876534, 4952.41328262811, -287.71438549501266, 1086.976402649996, 659.4554675034458, -867.0377871792252, -2075.3321024506367, 6199.718822834867, -2106.713820413099, 10420.425573935956, -1201.1240835226736, -2515.763742751718, -1250.05201264947, -1663.4990386778338, -1534.9969054678377, 1136.4440452518568, -2352.5609471379444, 1925.2659905192122, -883.3551778220833, 4771.391224120964, 1738.3912574600934, 3601.174436763048, -356.92647549814467, 6413.540896889652, -578.3620174047927, -849.2172897547867, -342.53551829887743, 5698.4134055254735, -2033.1954706373913, 5608.73839163309, -839.1446967531467, -1001.1886636144241, -2627.351353174106, 4433.785472398198, -7105.491803869579, 5060.262666447795, -909.3637003137753, 2873.08641058328, -528.6249944458242, -796.9539766785265, -73.91496229398851, 5830.621150881644, -492.34590561009395, 1111.913916058367, -1684.41124948778, 1646.9725883766796, -2102.546169974682, 3590.1050683078724, -746.5928707024318, 2626.3642865768516, -777.6809764925353, 3871.0774682578485, -412.9719760039338, 8245.895061685875, -155.35423049809634, 311.6515863708192, -707.2425197865813, -1465.7244049140534, -1366.5312098149573, 676.3685549939704, -1278.493291387957, 5102.853179359269, -741.0974714376783, 5582.571109828189, -143.66477688168666, 1548.3033083085838, -2993.1585214032007], "policy_predator_policy_reward": [7891.666397665122, 2273.020645405973, 8328.567008220707, -2176.3337174369594, 12331.028640794717, 3892.1107403997007, 16915.089535778898, 4789.120755596966, 11072.761440245164, 2480.816447339749, 4595.206770118947, 2995.599292998945, 1261.162153208501, -639.9208017335588, 25651.76266488987, 4006.0762008438364, 6395.188937779565, 380.89550409393735, 17901.747634198444, 6912.267942214705, 12722.71648809511, 1133.8693122572192, 37328.1303802448, 4083.4396390506295, -707.3250649305876, 988.0567046868642, 1285.483008591005, -1566.8041832788442, 3924.632970995678, 2724.2234374706004, 3562.491186706233, -1691.2059215811937, -1751.525904312327, -89.931165474722, 8534.60891308552, 248.5423174530028, 8262.385892052745, 3630.002079178577, 4791.085270819729, 1572.715732642448, 18042.94893454745, 1856.393587689267, 7081.566327728613, 1979.5740651777392, 8408.831918623444, -750.4659600436104, 23918.014075793933, 2639.8468510602124, 6639.93428072956, -1615.10998299792, 12825.587801124151, 1547.0892044630973, 35204.2359518649, 2194.218965267318, 32243.290154390626, 5573.717959650468, 4757.606521559675, -66.06888473873889, 5690.253947837844, 777.5713023973321, 4587.34195281928, -1280.3095094313694, 8408.57969866069, -954.6088824915339, 1492.4824481629082, 1447.9758044071916, 2557.1723991225263, 2833.5093532011488, 4914.976171502012, 2881.4394249632087, -1396.1147171938376, 4696.034588818372, 9096.478264872896, 889.6630446639656, 12987.278101811018, 6202.365871620839, 8556.398290624391, 2490.779753125544, -660.2911381202182, 0.0, 30121.2844495919, 4631.544831147056, 1807.4067211428046, 1429.9861721811972, 6482.839367097312, 2739.662707885977, 10340.903072687743, 2594.0714602649, -844.6954773618636, 731.1597879486826, 10530.504700191712, 592.4751211129019, -121.95644610497516, 5509.894581578235, 405.7533387476767, 1518.2384541728686, 21445.07167360441, 5089.174718284405, 15584.533903634125, -341.1692788888548, 6670.389939316437, 2793.1385914226635, 4611.373175242427, -789.862531131497, 14740.343699068433, 662.887119529151, 5750.762592849355, 1408.5532159981806, 14863.196287351571, 7838.478782989195, 2324.3841695904644, 3859.5560462138524, -2470.8423524497593, 1004.2752155903833, 21269.005889433287, 3273.152574483016, 9951.517529344572, 4691.864881287965, 2702.984349031469, 5017.164140122219, 4071.8496436154173, 993.5974903011862, 12129.25708957766, 5252.490844346925, 7550.61119354108, 8124.810753424348, 267.12120798880716, 4894.49460166291, 31016.17256274038, 2975.7929682808685, 18937.165979500467, 6207.236013961825, 2270.6945595455254, 3978.42888191457, 10506.750786177132, 2740.958447675635, 1843.9896966205351, 1551.2162620171482, 3876.285324886974, 381.89562591429365, 9381.733716399449, 1407.378765918367, 4929.592339816454, 1920.5342948098564, 24865.37708548843, 7088.749012310542, 9462.805896459597, 10902.29429243566, 24019.35872433998, 359.56292289639975, 10378.388640220222, -257.8635706225167, -1516.4301359635929, -4993.352345617459, 16030.201531591845, 387.35144128234936, 11301.223693107724, -732.6060065152705, 35311.2752705673, 1385.6675156113804, -4134.69014735424, 6627.0871317137435, 10193.864083485561, 2973.3147669639125, 5730.486882512366, 7879.013359649609, -2309.6356329890004, 5277.536352640985, 3252.5948823921967, -101.1538788394983, 15369.000355218925, 2129.4441664282126, 34854.35070239741, 7614.734621558737, 9954.829314728126, -489.2831234181778, 832.4698170625654, 827.2967532585012, 27398.496420139305, 739.0093013502798, 4925.250920368024, 1880.6491660488646, 13868.215109028095, 4877.427905650458, 14448.468562144039, 1299.7183149995526, 13017.181557571594, -2598.982233911149, 27486.713095112005, 1217.9532898797897, 9220.93636688434, 6536.7107594073805, 13704.814947230094, 4409.491600639738, 14025.151505705391, 796.0558980592637, 9619.068804356879, 4577.748615643131, 5669.915133272955, 5895.601569798991]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6840730505489959, "mean_inference_ms": 1.4688093980417691, "mean_action_processing_ms": 0.28935291742897684, "mean_env_wait_ms": 0.13122757236888152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00486302375793457, "StateBufferConnector_ms": 0.0026799440383911133, "ViewRequirementAgentConnector_ms": 0.07957792282104492}, "num_episodes": 18, "episode_return_max": 41598.21638498358, "episode_return_min": 0.0, "episode_return_mean": 14019.33166761835, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.8718271753088, "num_env_steps_trained_throughput_per_sec": 362.8718271753088, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 11420.494, "restore_workers_time_ms": 0.011, "training_step_time_ms": 11420.459, "sample_time_ms": 882.148, "learn_time_ms": 10524.544, "learn_throughput": 380.064, "synch_weights_time_ms": 13.178}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-22", "timestamp": 1723418962, "time_this_iter_s": 11.026165008544922, "time_total_s": 1327.6606979370117, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f83b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1327.6606979370117, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 30.69375, "ram_util_percent": 74.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4977389622775335, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.125777467596468, "policy_loss": -0.004651393935764356, "vf_loss": 8.13041103857535, "vf_explained_var": 0.003558918439521991, "kl": 0.005702428265887393, "entropy": 0.6199736378495655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.6012257698036375, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.89175027514261, "policy_loss": -0.004105922457806411, "vf_loss": 8.895153508867537, "vf_explained_var": -4.691005383849775e-05, "kl": 0.007026730842695654, "entropy": 0.7302510414489363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 44538.380943750206, "episode_reward_min": 0.0, "episode_reward_mean": 14849.555246791659, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7105.491803869579, "predator_policy": -4993.352345617459}, "policy_reward_max": {"prey_policy": 10420.425573935956, "predator_policy": 37836.92047463196}, "policy_reward_mean": {"prey_policy": 781.4610259157649, "predator_policy": 6643.316597480064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [25655.775919190048, 9027.796688009863, 16323.055599664727, 35306.83200183245, 36047.44164209904, 7676.596659058075, 8280.16196062931, 7423.100139211992, 10541.246792225918, 1513.0443644687791, 4330.280375763601, 7171.172959167853, 1732.7835838130638, 14644.418268783771, 14898.148256890529, 15907.499960232482, 0.0, 32037.79841493745, 2496.01883534683, 14356.297989126473, 20885.087892638196, 3028.878187147703, 15012.476067867436, 5621.034198821438, 3290.1202125169293, 24089.331022820177, 18869.16270553971, 11138.223820870962, 7180.597338293154, 17291.186038511085, 12860.486831725226, 20109.45193971982, 579.284765715098, 973.9135244899753, 22689.65466184643, 16661.46388749522, 9037.98372190433, 5208.984781483815, 16435.927796655364, 14066.973647041861, 520.1680790700955, 33274.46767512824, 21182.461946465573, 15037.321946087264, 17912.40813098585, 5141.637828791121, 1315.8110611714037, 14882.117484739598, 16069.428125039642, 28188.3103423978, 17166.604244749567, 23162.804745350295, 11162.435882294845, 0.0, 19661.80093413905, 16403.7965660773, 35505.18997812501, 6157.614919247583, 17936.772545329422, 9980.960225373448, 296.1943881806057, 7302.339969686725, 19842.905937784544, 41598.21638498358, 14803.821436581547, 1087.2692368916523, 27681.932139891585, 9649.412284022334, 20594.326324762893, 19206.292369397455, 18508.74015484822, 28309.07545157603, 12925.39151156272, 17512.181811475883, 19182.9631116862, 19635.72375294651, 10120.66148997733, 14832.815155379683, 4681.781584417701, 14267.088478805212, 21744.12142612483, 13289.03266905051, 13515.473194327544, 15502.530321822658, 19515.338461774743, 8197.719498325781, 17588.53290827582, 7934.730163362934, 8612.595664933253, 18084.2163893748, 9730.815968092707, 20352.486147502623, 27121.546218712017, 13952.242741356953, 16955.180715045142, 44538.380943750206, 8992.282398048363, 16957.01782949536, 2201.4962367517364, 37068.84569406016], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-735.6200241493565, -166.46498351472036, 6115.314873124942, -2112.3424828467214, 2573.4742009945453, -623.0956069170883, -1392.7568273941372, -698.8660879056339, -1011.0524640143507, -758.5140079277418, 6038.697092224829, -3053.638069987689, 3179.7767608462977, -1367.440050452159, 8185.156702606909, -4069.089006782825, 4069.414654292565, -982.1386782358102, 1914.0653825002141, -3341.4792706015446, 1093.5859362266992, -2153.9873127867727, 2626.3666226749197, -3251.6092599722865, 3768.6429202869376, -5335.779208098409, 5600.738879398368, -942.4619201514347, -2409.8914412548, -1881.6042752865317, 6054.819598564858, -1194.4976820823244, -24.87808164218969, 685.1692197624061, -1321.0943762383988, -1393.936489563105, 1297.150058994173, -2038.524116971344, 7116.437573999605, -1982.6416598564115, 8194.657174998472, -244.5438153129987, 4500.841740641069, -1358.4278640801751, 5087.802298919321, -1198.3060523564852, 3214.323315214719, -2981.2272518665554, 3726.6652417980417, -2360.536822201658, -1394.5772116795454, -1050.338157389073, 4462.5896979172385, -836.7916171228262, 4600.6698009172005, -2925.9745107853364, 4197.518176831828, -838.43148264962, 2368.831964931356, -480.87674501782243, 6494.619807739364, -793.448784861703, -1943.778795299242, -648.4443353217156, 638.1197068193142, -6242.775156908537, 4039.8278823904993, -1599.347221041143, -266.6179162209782, -1585.8858858488977, 2815.5067482686122, -797.4252714058476, 4543.614182743808, -3225.7789499931628, 4264.097829284249, -4120.560181717036, -40.13048662404257, -905.6896506452308, -270.87349299818214, -1337.5748069253823, -785.7161809219714, -3855.7315496596507, -624.7772688058095, -92.72058708719884, -1351.2067381939924, -2610.73330880271, 9480.210362503756, -692.011857876534, 4952.41328262811, -287.71438549501266, 1086.976402649996, 659.4554675034458, -867.0377871792252, -2075.3321024506367, 6199.718822834867, -2106.713820413099, 10420.425573935956, -1201.1240835226736, -2515.763742751718, -1250.05201264947, -1663.4990386778338, -1534.9969054678377, 1136.4440452518568, -2352.5609471379444, 1925.2659905192122, -883.3551778220833, 4771.391224120964, 1738.3912574600934, 3601.174436763048, -356.92647549814467, 6413.540896889652, -578.3620174047927, -849.2172897547867, -342.53551829887743, 5698.4134055254735, -2033.1954706373913, 5608.73839163309, -839.1446967531467, -1001.1886636144241, -2627.351353174106, 4433.785472398198, -7105.491803869579, 5060.262666447795, -909.3637003137753, 2873.08641058328, -528.6249944458242, -796.9539766785265, -73.91496229398851, 5830.621150881644, -492.34590561009395, 1111.913916058367, -1684.41124948778, 1646.9725883766796, -2102.546169974682, 3590.1050683078724, -746.5928707024318, 2626.3642865768516, -777.6809764925353, 3871.0774682578485, -412.9719760039338, 8245.895061685875, -155.35423049809634, 311.6515863708192, -707.2425197865813, -1465.7244049140534, -1366.5312098149573, 676.3685549939704, -1278.493291387957, 5102.853179359269, -741.0974714376783, 5582.571109828189, -143.66477688168666, 1548.3033083085838, -2993.1585214032007, 6972.221284834389, -410.77637863873497, 17.193036176564085, -5030.290827577079, 8736.107889950035, -716.5095318678523, 5116.8686354642405, -188.0145424603262, 5715.858576371535, -673.7106246827207, 2248.5945186269623, -1272.913838949776, -3531.090687392835, -1888.9996792085153, 4338.219976328813, -1177.5350478791606, 160.379998419976, -985.8113688256982, 6973.134948138122, -1510.1933007523332, 5989.1921148187275, -1566.228033143836, 536.6421276019893, -3992.9699684723423, 9804.722271900524, -8.244280333161793, 5120.61807236558, -982.4630525486284, 8925.91469814464, -521.6613627588625, -481.56280929769065, 224.19159845212855, 5786.87543059759, -822.8626679179051, 3828.6880630524843, -394.8180611212559, -171.57648898849743, -245.78546746471005, 2419.3227342575474, -1722.7874946032348, 2446.346508224941, -994.7720992304535, 5449.97805670049, -188.22108348281492, -915.9084097434825, -243.14584154511735], "policy_predator_policy_reward": [23918.014075793933, 2639.8468510602124, 6639.93428072956, -1615.10998299792, 12825.587801124151, 1547.0892044630973, 35204.2359518649, 2194.218965267318, 32243.290154390626, 5573.717959650468, 4757.606521559675, -66.06888473873889, 5690.253947837844, 777.5713023973321, 4587.34195281928, -1280.3095094313694, 8408.57969866069, -954.6088824915339, 1492.4824481629082, 1447.9758044071916, 2557.1723991225263, 2833.5093532011488, 4914.976171502012, 2881.4394249632087, -1396.1147171938376, 4696.034588818372, 9096.478264872896, 889.6630446639656, 12987.278101811018, 6202.365871620839, 8556.398290624391, 2490.779753125544, -660.2911381202182, 0.0, 30121.2844495919, 4631.544831147056, 1807.4067211428046, 1429.9861721811972, 6482.839367097312, 2739.662707885977, 10340.903072687743, 2594.0714602649, -844.6954773618636, 731.1597879486826, 10530.504700191712, 592.4751211129019, -121.95644610497516, 5509.894581578235, 405.7533387476767, 1518.2384541728686, 21445.07167360441, 5089.174718284405, 15584.533903634125, -341.1692788888548, 6670.389939316437, 2793.1385914226635, 4611.373175242427, -789.862531131497, 14740.343699068433, 662.887119529151, 5750.762592849355, 1408.5532159981806, 14863.196287351571, 7838.478782989195, 2324.3841695904644, 3859.5560462138524, -2470.8423524497593, 1004.2752155903833, 21269.005889433287, 3273.152574483016, 9951.517529344572, 4691.864881287965, 2702.984349031469, 5017.164140122219, 4071.8496436154173, 993.5974903011862, 12129.25708957766, 5252.490844346925, 7550.61119354108, 8124.810753424348, 267.12120798880716, 4894.49460166291, 31016.17256274038, 2975.7929682808685, 18937.165979500467, 6207.236013961825, 2270.6945595455254, 3978.42888191457, 10506.750786177132, 2740.958447675635, 1843.9896966205351, 1551.2162620171482, 3876.285324886974, 381.89562591429365, 9381.733716399449, 1407.378765918367, 4929.592339816454, 1920.5342948098564, 24865.37708548843, 7088.749012310542, 9462.805896459597, 10902.29429243566, 24019.35872433998, 359.56292289639975, 10378.388640220222, -257.8635706225167, -1516.4301359635929, -4993.352345617459, 16030.201531591845, 387.35144128234936, 11301.223693107724, -732.6060065152705, 35311.2752705673, 1385.6675156113804, -4134.69014735424, 6627.0871317137435, 10193.864083485561, 2973.3147669639125, 5730.486882512366, 7879.013359649609, -2309.6356329890004, 5277.536352640985, 3252.5948823921967, -101.1538788394983, 15369.000355218925, 2129.4441664282126, 34854.35070239741, 7614.734621558737, 9954.829314728126, -489.2831234181778, 832.4698170625654, 827.2967532585012, 27398.496420139305, 739.0093013502798, 4925.250920368024, 1880.6491660488646, 13868.215109028095, 4877.427905650458, 14448.468562144039, 1299.7183149995526, 13017.181557571594, -2598.982233911149, 27486.713095112005, 1217.9532898797897, 9220.93636688434, 6536.7107594073805, 13704.814947230094, 4409.491600639738, 14025.151505705391, 796.0558980592637, 9619.068804356879, 4577.748615643131, 5669.915133272955, 5895.601569798991, 10306.03406859339, -2034.6638194093662, 3738.7398988874656, 5956.139476930746, 4583.541027136857, 1663.9490935861804, 13619.438304024088, 3195.8290290968475, 4278.593032382021, 3968.291684979699, 7929.480547385267, 4610.311967265045, 15545.159881453606, 5377.460806970425, 11538.342687674733, 4816.310845650365, 4298.798493597796, 4724.352375133705, 3430.3531088432537, 8695.238152046732, 5544.726044943295, -2032.9599632552515, 7178.163147352032, 4890.760358451569, 6135.1625230401005, 2152.575874767326, 5775.315066647303, -182.65411837153397, 8071.736205332729, 3876.496606784066, 25104.271179027062, 2274.646250530515, 7080.907539815968, 1907.322438861248, 11982.105349433485, 1539.205363680364, 37836.92047463196, 7118.822425571519, 3260.1102732118698, 5035.636885182174, 10395.200373004092, 5110.243047496775, -3060.2607364659366, 0.0, 35542.65392009539, 2685.2460252533547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6814685615441062, "mean_inference_ms": 1.462543822916734, "mean_action_processing_ms": 0.28825782684016654, "mean_env_wait_ms": 0.13062124972644082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004592418670654297, "StateBufferConnector_ms": 0.0026903152465820312, "ViewRequirementAgentConnector_ms": 0.08071267604827881}, "num_episodes": 23, "episode_return_max": 44538.380943750206, "episode_return_min": 0.0, "episode_return_mean": 14849.555246791659, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.8338657949588, "num_env_steps_trained_throughput_per_sec": 372.8338657949588, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 11246.407, "restore_workers_time_ms": 0.012, "training_step_time_ms": 11246.372, "sample_time_ms": 869.739, "learn_time_ms": 10363.313, "learn_throughput": 385.977, "synch_weights_time_ms": 12.737}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-33", "timestamp": 1723418973, "time_this_iter_s": 10.73174500465393, "time_total_s": 1338.3924429416656, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f83bf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1338.3924429416656, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 31.600000000000005, "ram_util_percent": 74.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4895467115654832, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.987929456448429, "policy_loss": -0.007628129826237758, "vf_loss": 7.99552303798615, "vf_explained_var": 0.0017218254546009044, "kl": 0.011053549205692851, "entropy": 0.7515816592350208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5882235660518288, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.862352824337268, "policy_loss": -0.0046283537502247825, "vf_loss": 8.866366434854175, "vf_explained_var": 3.941853841145834e-06, "kl": 0.006146945888469976, "entropy": 0.6264154627524986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 44538.380943750206, "episode_reward_min": 0.0, "episode_reward_mean": 15631.902631391087, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7105.491803869579, "predator_policy": -4993.352345617459}, "policy_reward_max": {"prey_policy": 10420.425573935956, "predator_policy": 39610.554745772504}, "policy_reward_mean": {"prey_policy": 764.8258028821725, "predator_policy": 7051.125512813369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2496.01883534683, 14356.297989126473, 20885.087892638196, 3028.878187147703, 15012.476067867436, 5621.034198821438, 3290.1202125169293, 24089.331022820177, 18869.16270553971, 11138.223820870962, 7180.597338293154, 17291.186038511085, 12860.486831725226, 20109.45193971982, 579.284765715098, 973.9135244899753, 22689.65466184643, 16661.46388749522, 9037.98372190433, 5208.984781483815, 16435.927796655364, 14066.973647041861, 520.1680790700955, 33274.46767512824, 21182.461946465573, 15037.321946087264, 17912.40813098585, 5141.637828791121, 1315.8110611714037, 14882.117484739598, 16069.428125039642, 28188.3103423978, 17166.604244749567, 23162.804745350295, 11162.435882294845, 0.0, 19661.80093413905, 16403.7965660773, 35505.18997812501, 6157.614919247583, 17936.772545329422, 9980.960225373448, 296.1943881806057, 7302.339969686725, 19842.905937784544, 41598.21638498358, 14803.821436581547, 1087.2692368916523, 27681.932139891585, 9649.412284022334, 20594.326324762893, 19206.292369397455, 18508.74015484822, 28309.07545157603, 12925.39151156272, 17512.181811475883, 19182.9631116862, 19635.72375294651, 10120.66148997733, 14832.815155379683, 4681.781584417701, 14267.088478805212, 21744.12142612483, 13289.03266905051, 13515.473194327544, 15502.530321822658, 19515.338461774743, 8197.719498325781, 17588.53290827582, 7934.730163362934, 8612.595664933253, 18084.2163893748, 9730.815968092707, 20352.486147502623, 27121.546218712017, 13952.242741356953, 16955.180715045142, 44538.380943750206, 8992.282398048363, 16957.01782949536, 2201.4962367517364, 37068.84569406016, 16597.10261379104, 27920.33614875405, 7857.67054353073, 22604.167387636877, 14828.738765634907, 8131.05267788109, 12371.002720567521, 32074.65249778356, 37987.724756116804, 19841.183838744648, 18808.91633624821, 42099.16636820875, 8711.364689111322, 746.4859776792922, 15748.099093958965, 264.8173354095054, 10694.879679992222, 29464.530614871972], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [1297.150058994173, -2038.524116971344, 7116.437573999605, -1982.6416598564115, 8194.657174998472, -244.5438153129987, 4500.841740641069, -1358.4278640801751, 5087.802298919321, -1198.3060523564852, 3214.323315214719, -2981.2272518665554, 3726.6652417980417, -2360.536822201658, -1394.5772116795454, -1050.338157389073, 4462.5896979172385, -836.7916171228262, 4600.6698009172005, -2925.9745107853364, 4197.518176831828, -838.43148264962, 2368.831964931356, -480.87674501782243, 6494.619807739364, -793.448784861703, -1943.778795299242, -648.4443353217156, 638.1197068193142, -6242.775156908537, 4039.8278823904993, -1599.347221041143, -266.6179162209782, -1585.8858858488977, 2815.5067482686122, -797.4252714058476, 4543.614182743808, -3225.7789499931628, 4264.097829284249, -4120.560181717036, -40.13048662404257, -905.6896506452308, -270.87349299818214, -1337.5748069253823, -785.7161809219714, -3855.7315496596507, -624.7772688058095, -92.72058708719884, -1351.2067381939924, -2610.73330880271, 9480.210362503756, -692.011857876534, 4952.41328262811, -287.71438549501266, 1086.976402649996, 659.4554675034458, -867.0377871792252, -2075.3321024506367, 6199.718822834867, -2106.713820413099, 10420.425573935956, -1201.1240835226736, -2515.763742751718, -1250.05201264947, -1663.4990386778338, -1534.9969054678377, 1136.4440452518568, -2352.5609471379444, 1925.2659905192122, -883.3551778220833, 4771.391224120964, 1738.3912574600934, 3601.174436763048, -356.92647549814467, 6413.540896889652, -578.3620174047927, -849.2172897547867, -342.53551829887743, 5698.4134055254735, -2033.1954706373913, 5608.73839163309, -839.1446967531467, -1001.1886636144241, -2627.351353174106, 4433.785472398198, -7105.491803869579, 5060.262666447795, -909.3637003137753, 2873.08641058328, -528.6249944458242, -796.9539766785265, -73.91496229398851, 5830.621150881644, -492.34590561009395, 1111.913916058367, -1684.41124948778, 1646.9725883766796, -2102.546169974682, 3590.1050683078724, -746.5928707024318, 2626.3642865768516, -777.6809764925353, 3871.0774682578485, -412.9719760039338, 8245.895061685875, -155.35423049809634, 311.6515863708192, -707.2425197865813, -1465.7244049140534, -1366.5312098149573, 676.3685549939704, -1278.493291387957, 5102.853179359269, -741.0974714376783, 5582.571109828189, -143.66477688168666, 1548.3033083085838, -2993.1585214032007, 6972.221284834389, -410.77637863873497, 17.193036176564085, -5030.290827577079, 8736.107889950035, -716.5095318678523, 5116.8686354642405, -188.0145424603262, 5715.858576371535, -673.7106246827207, 2248.5945186269623, -1272.913838949776, -3531.090687392835, -1888.9996792085153, 4338.219976328813, -1177.5350478791606, 160.379998419976, -985.8113688256982, 6973.134948138122, -1510.1933007523332, 5989.1921148187275, -1566.228033143836, 536.6421276019893, -3992.9699684723423, 9804.722271900524, -8.244280333161793, 5120.61807236558, -982.4630525486284, 8925.91469814464, -521.6613627588625, -481.56280929769065, 224.19159845212855, 5786.87543059759, -822.8626679179051, 3828.6880630524843, -394.8180611212559, -171.57648898849743, -245.78546746471005, 2419.3227342575474, -1722.7874946032348, 2446.346508224941, -994.7720992304535, 5449.97805670049, -188.22108348281492, -915.9084097434825, -243.14584154511735, 3052.212042993887, -395.9655659081469, 410.1826231097432, -500.2441058542176, -1658.3855135423257, -2439.5148276033974, -1245.0427729172284, -983.916923899758, 8022.083048353753, -802.7826026698136, 6280.95589007417, -3855.442808950073, 3365.540752576211, -602.9380280189995, -340.8178823959913, 36.207707337969076, -1400.2132486842636, -148.11788605744528, 6648.160088872069, -1246.4500633548419, 820.2656551409789, -2092.478030406137, -1125.8397868061193, -613.7080814307366, 1277.956617288299, -2886.7424102149503, 601.4690400458668, -933.6508802988388, 2813.689534963031, -947.6932309075297, 5013.036169861951, -3252.480790708079, 1546.846318819709, -3318.8170960126413, 426.2364836247047, -1167.6588074408116], "policy_predator_policy_reward": [1807.4067211428046, 1429.9861721811972, 6482.839367097312, 2739.662707885977, 10340.903072687743, 2594.0714602649, -844.6954773618636, 731.1597879486826, 10530.504700191712, 592.4751211129019, -121.95644610497516, 5509.894581578235, 405.7533387476767, 1518.2384541728686, 21445.07167360441, 5089.174718284405, 15584.533903634125, -341.1692788888548, 6670.389939316437, 2793.1385914226635, 4611.373175242427, -789.862531131497, 14740.343699068433, 662.887119529151, 5750.762592849355, 1408.5532159981806, 14863.196287351571, 7838.478782989195, 2324.3841695904644, 3859.5560462138524, -2470.8423524497593, 1004.2752155903833, 21269.005889433287, 3273.152574483016, 9951.517529344572, 4691.864881287965, 2702.984349031469, 5017.164140122219, 4071.8496436154173, 993.5974903011862, 12129.25708957766, 5252.490844346925, 7550.61119354108, 8124.810753424348, 267.12120798880716, 4894.49460166291, 31016.17256274038, 2975.7929682808685, 18937.165979500467, 6207.236013961825, 2270.6945595455254, 3978.42888191457, 10506.750786177132, 2740.958447675635, 1843.9896966205351, 1551.2162620171482, 3876.285324886974, 381.89562591429365, 9381.733716399449, 1407.378765918367, 4929.592339816454, 1920.5342948098564, 24865.37708548843, 7088.749012310542, 9462.805896459597, 10902.29429243566, 24019.35872433998, 359.56292289639975, 10378.388640220222, -257.8635706225167, -1516.4301359635929, -4993.352345617459, 16030.201531591845, 387.35144128234936, 11301.223693107724, -732.6060065152705, 35311.2752705673, 1385.6675156113804, -4134.69014735424, 6627.0871317137435, 10193.864083485561, 2973.3147669639125, 5730.486882512366, 7879.013359649609, -2309.6356329890004, 5277.536352640985, 3252.5948823921967, -101.1538788394983, 15369.000355218925, 2129.4441664282126, 34854.35070239741, 7614.734621558737, 9954.829314728126, -489.2831234181778, 832.4698170625654, 827.2967532585012, 27398.496420139305, 739.0093013502798, 4925.250920368024, 1880.6491660488646, 13868.215109028095, 4877.427905650458, 14448.468562144039, 1299.7183149995526, 13017.181557571594, -2598.982233911149, 27486.713095112005, 1217.9532898797897, 9220.93636688434, 6536.7107594073805, 13704.814947230094, 4409.491600639738, 14025.151505705391, 796.0558980592637, 9619.068804356879, 4577.748615643131, 5669.915133272955, 5895.601569798991, 10306.03406859339, -2034.6638194093662, 3738.7398988874656, 5956.139476930746, 4583.541027136857, 1663.9490935861804, 13619.438304024088, 3195.8290290968475, 4278.593032382021, 3968.291684979699, 7929.480547385267, 4610.311967265045, 15545.159881453606, 5377.460806970425, 11538.342687674733, 4816.310845650365, 4298.798493597796, 4724.352375133705, 3430.3531088432537, 8695.238152046732, 5544.726044943295, -2032.9599632552515, 7178.163147352032, 4890.760358451569, 6135.1625230401005, 2152.575874767326, 5775.315066647303, -182.65411837153397, 8071.736205332729, 3876.496606784066, 25104.271179027062, 2274.646250530515, 7080.907539815968, 1907.322438861248, 11982.105349433485, 1539.205363680364, 37836.92047463196, 7118.822425571519, 3260.1102732118698, 5035.636885182174, 10395.200373004092, 5110.243047496775, -3060.2607364659366, 0.0, 35542.65392009539, 2685.2460252533547, 11480.523717782298, 2460.332418923026, 24363.460757588007, 3646.9368739104943, 7195.465432709225, 4760.10545196723, 20955.890140520194, 3877.236943933658, 8867.2698366379, -1257.8315166869193, 4605.193481339454, 1100.3461154175277, 6862.61914630875, 2745.7808497015803, 32256.468135368195, 122.79453747339048, 36215.769826736214, 3320.2860641222915, 15292.179074616071, -852.7052613886185, 16719.351786378244, 3361.776925135147, 39610.554745772504, 4228.159490673104, 5731.345343599955, 4588.80513843802, -464.2868025701449, 1542.9546205024083, 10892.249868681749, 2989.852921221711, -1189.730483138782, -306.0075606055872, 7114.217383430129, 5352.633073755031, 26605.002376063163, 3600.950562624932]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6794838192596641, "mean_inference_ms": 1.4577277168115796, "mean_action_processing_ms": 0.2874093057162104, "mean_env_wait_ms": 0.13015543138835567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00426638126373291, "StateBufferConnector_ms": 0.0027239322662353516, "ViewRequirementAgentConnector_ms": 0.08239591121673584}, "num_episodes": 18, "episode_return_max": 44538.380943750206, "episode_return_min": 0.0, "episode_return_mean": 15631.902631391087, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.63031296357656, "num_env_steps_trained_throughput_per_sec": 355.63031296357656, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 11110.032, "restore_workers_time_ms": 0.011, "training_step_time_ms": 11109.999, "sample_time_ms": 833.107, "learn_time_ms": 10263.816, "learn_throughput": 389.719, "synch_weights_time_ms": 12.465}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-44", "timestamp": 1723418984, "time_this_iter_s": 11.251735210418701, "time_total_s": 1349.6441781520844, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1349.6441781520844, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 31.15, "ram_util_percent": 74.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.4750889090160844, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.123816470494345, "policy_loss": -0.0060253242252483255, "vf_loss": 8.129822820582717, "vf_explained_var": -0.0006924156158689468, "kl": 0.006066945529418754, "entropy": 0.6388114646313683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.625503547339843, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.692220175707781, "policy_loss": -0.004950134843839184, "vf_loss": 8.696536698921648, "vf_explained_var": -1.2342639701076285e-05, "kl": 0.00633628019653209, "entropy": 0.6269904405667037, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 44538.380943750206, "episode_reward_min": 0.0, "episode_reward_mean": 16668.94865450518, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7105.491803869579, "predator_policy": -4993.352345617459}, "policy_reward_max": {"prey_policy": 10420.425573935956, "predator_policy": 39610.554745772504}, "policy_reward_mean": {"prey_policy": 620.6484563918439, "predator_policy": 7713.825870860747}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.1680790700955, 33274.46767512824, 21182.461946465573, 15037.321946087264, 17912.40813098585, 5141.637828791121, 1315.8110611714037, 14882.117484739598, 16069.428125039642, 28188.3103423978, 17166.604244749567, 23162.804745350295, 11162.435882294845, 0.0, 19661.80093413905, 16403.7965660773, 35505.18997812501, 6157.614919247583, 17936.772545329422, 9980.960225373448, 296.1943881806057, 7302.339969686725, 19842.905937784544, 41598.21638498358, 14803.821436581547, 1087.2692368916523, 27681.932139891585, 9649.412284022334, 20594.326324762893, 19206.292369397455, 18508.74015484822, 28309.07545157603, 12925.39151156272, 17512.181811475883, 19182.9631116862, 19635.72375294651, 10120.66148997733, 14832.815155379683, 4681.781584417701, 14267.088478805212, 21744.12142612483, 13289.03266905051, 13515.473194327544, 15502.530321822658, 19515.338461774743, 8197.719498325781, 17588.53290827582, 7934.730163362934, 8612.595664933253, 18084.2163893748, 9730.815968092707, 20352.486147502623, 27121.546218712017, 13952.242741356953, 16955.180715045142, 44538.380943750206, 8992.282398048363, 16957.01782949536, 2201.4962367517364, 37068.84569406016, 16597.10261379104, 27920.33614875405, 7857.67054353073, 22604.167387636877, 14828.738765634907, 8131.05267788109, 12371.002720567521, 32074.65249778356, 37987.724756116804, 19841.183838744648, 18808.91633624821, 42099.16636820875, 8711.364689111322, 746.4859776792922, 15748.099093958965, 264.8173354095054, 10694.879679992222, 29464.530614871972, 25022.394857186377, 20985.357410536435, 16304.685740020213, 22986.88073404263, 8529.954161949472, 3700.825317560046, 37340.81796100538, 9130.216772548274, 15298.532740316725, 19147.21694946689, 4335.618665127375, 17963.68394067966, 10063.585422521905, 8658.794637078154, 35081.13524581367, 13669.645579220645, 4865.109258879024, 9710.660873971801, 13914.03901617183, 32966.59750281346, 16620.055156490136, 19291.33423558679], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-785.7161809219714, -3855.7315496596507, -624.7772688058095, -92.72058708719884, -1351.2067381939924, -2610.73330880271, 9480.210362503756, -692.011857876534, 4952.41328262811, -287.71438549501266, 1086.976402649996, 659.4554675034458, -867.0377871792252, -2075.3321024506367, 6199.718822834867, -2106.713820413099, 10420.425573935956, -1201.1240835226736, -2515.763742751718, -1250.05201264947, -1663.4990386778338, -1534.9969054678377, 1136.4440452518568, -2352.5609471379444, 1925.2659905192122, -883.3551778220833, 4771.391224120964, 1738.3912574600934, 3601.174436763048, -356.92647549814467, 6413.540896889652, -578.3620174047927, -849.2172897547867, -342.53551829887743, 5698.4134055254735, -2033.1954706373913, 5608.73839163309, -839.1446967531467, -1001.1886636144241, -2627.351353174106, 4433.785472398198, -7105.491803869579, 5060.262666447795, -909.3637003137753, 2873.08641058328, -528.6249944458242, -796.9539766785265, -73.91496229398851, 5830.621150881644, -492.34590561009395, 1111.913916058367, -1684.41124948778, 1646.9725883766796, -2102.546169974682, 3590.1050683078724, -746.5928707024318, 2626.3642865768516, -777.6809764925353, 3871.0774682578485, -412.9719760039338, 8245.895061685875, -155.35423049809634, 311.6515863708192, -707.2425197865813, -1465.7244049140534, -1366.5312098149573, 676.3685549939704, -1278.493291387957, 5102.853179359269, -741.0974714376783, 5582.571109828189, -143.66477688168666, 1548.3033083085838, -2993.1585214032007, 6972.221284834389, -410.77637863873497, 17.193036176564085, -5030.290827577079, 8736.107889950035, -716.5095318678523, 5116.8686354642405, -188.0145424603262, 5715.858576371535, -673.7106246827207, 2248.5945186269623, -1272.913838949776, -3531.090687392835, -1888.9996792085153, 4338.219976328813, -1177.5350478791606, 160.379998419976, -985.8113688256982, 6973.134948138122, -1510.1933007523332, 5989.1921148187275, -1566.228033143836, 536.6421276019893, -3992.9699684723423, 9804.722271900524, -8.244280333161793, 5120.61807236558, -982.4630525486284, 8925.91469814464, -521.6613627588625, -481.56280929769065, 224.19159845212855, 5786.87543059759, -822.8626679179051, 3828.6880630524843, -394.8180611212559, -171.57648898849743, -245.78546746471005, 2419.3227342575474, -1722.7874946032348, 2446.346508224941, -994.7720992304535, 5449.97805670049, -188.22108348281492, -915.9084097434825, -243.14584154511735, 3052.212042993887, -395.9655659081469, 410.1826231097432, -500.2441058542176, -1658.3855135423257, -2439.5148276033974, -1245.0427729172284, -983.916923899758, 8022.083048353753, -802.7826026698136, 6280.95589007417, -3855.442808950073, 3365.540752576211, -602.9380280189995, -340.8178823959913, 36.207707337969076, -1400.2132486842636, -148.11788605744528, 6648.160088872069, -1246.4500633548419, 820.2656551409789, -2092.478030406137, -1125.8397868061193, -613.7080814307366, 1277.956617288299, -2886.7424102149503, 601.4690400458668, -933.6508802988388, 2813.689534963031, -947.6932309075297, 5013.036169861951, -3252.480790708079, 1546.846318819709, -3318.8170960126413, 426.2364836247047, -1167.6588074408116, -2544.34485808419, -1405.7654824565088, 1842.313052607295, -146.2770746820655, 2106.1683923305854, -1365.1297971725053, -676.3667309656404, -1014.2636891256867, -531.1969506701026, -2992.933947503543, 1869.1082212880704, -3027.6282831069498, -884.3076797569684, -393.5939926016593, 2409.1134954592994, -413.000697630756, 2374.38721589025, -557.920541399759, -2778.1250038960093, -2899.3465300133653, 595.5490277334252, -3878.608204049393, 1848.3707932347247, -88.0182603509269, 4762.582881753935, -1813.1318823452934, 7511.541662750502, -2099.3022406782, -919.2235758864463, -654.7427031158999, 283.9757048237635, -3508.865364710591, 1939.8684032894737, -3079.7833877574135, 4002.371537610522, -872.4653642911256, 2742.76245142599, -2020.5950423851914, 16.098229958485106, -1215.1700770631385, 3269.7573496733944, -956.2181947912512, 5302.344436682624, -881.711638779571], "policy_predator_policy_reward": [267.12120798880716, 4894.49460166291, 31016.17256274038, 2975.7929682808685, 18937.165979500467, 6207.236013961825, 2270.6945595455254, 3978.42888191457, 10506.750786177132, 2740.958447675635, 1843.9896966205351, 1551.2162620171482, 3876.285324886974, 381.89562591429365, 9381.733716399449, 1407.378765918367, 4929.592339816454, 1920.5342948098564, 24865.37708548843, 7088.749012310542, 9462.805896459597, 10902.29429243566, 24019.35872433998, 359.56292289639975, 10378.388640220222, -257.8635706225167, -1516.4301359635929, -4993.352345617459, 16030.201531591845, 387.35144128234936, 11301.223693107724, -732.6060065152705, 35311.2752705673, 1385.6675156113804, -4134.69014735424, 6627.0871317137435, 10193.864083485561, 2973.3147669639125, 5730.486882512366, 7879.013359649609, -2309.6356329890004, 5277.536352640985, 3252.5948823921967, -101.1538788394983, 15369.000355218925, 2129.4441664282126, 34854.35070239741, 7614.734621558737, 9954.829314728126, -489.2831234181778, 832.4698170625654, 827.2967532585012, 27398.496420139305, 739.0093013502798, 4925.250920368024, 1880.6491660488646, 13868.215109028095, 4877.427905650458, 14448.468562144039, 1299.7183149995526, 13017.181557571594, -2598.982233911149, 27486.713095112005, 1217.9532898797897, 9220.93636688434, 6536.7107594073805, 13704.814947230094, 4409.491600639738, 14025.151505705391, 796.0558980592637, 9619.068804356879, 4577.748615643131, 5669.915133272955, 5895.601569798991, 10306.03406859339, -2034.6638194093662, 3738.7398988874656, 5956.139476930746, 4583.541027136857, 1663.9490935861804, 13619.438304024088, 3195.8290290968475, 4278.593032382021, 3968.291684979699, 7929.480547385267, 4610.311967265045, 15545.159881453606, 5377.460806970425, 11538.342687674733, 4816.310845650365, 4298.798493597796, 4724.352375133705, 3430.3531088432537, 8695.238152046732, 5544.726044943295, -2032.9599632552515, 7178.163147352032, 4890.760358451569, 6135.1625230401005, 2152.575874767326, 5775.315066647303, -182.65411837153397, 8071.736205332729, 3876.496606784066, 25104.271179027062, 2274.646250530515, 7080.907539815968, 1907.322438861248, 11982.105349433485, 1539.205363680364, 37836.92047463196, 7118.822425571519, 3260.1102732118698, 5035.636885182174, 10395.200373004092, 5110.243047496775, -3060.2607364659366, 0.0, 35542.65392009539, 2685.2460252533547, 11480.523717782298, 2460.332418923026, 24363.460757588007, 3646.9368739104943, 7195.465432709225, 4760.10545196723, 20955.890140520194, 3877.236943933658, 8867.2698366379, -1257.8315166869193, 4605.193481339454, 1100.3461154175277, 6862.61914630875, 2745.7808497015803, 32256.468135368195, 122.79453747339048, 36215.769826736214, 3320.2860641222915, 15292.179074616071, -852.7052613886185, 16719.351786378244, 3361.776925135147, 39610.554745772504, 4228.159490673104, 5731.345343599955, 4588.80513843802, -464.2868025701449, 1542.9546205024083, 10892.249868681749, 2989.852921221711, -1189.730483138782, -306.0075606055872, 7114.217383430129, 5352.633073755031, 26605.002376063163, 3600.950562624932, 23239.235924343757, 5733.269273383296, 16337.30373073444, 2952.0177018767617, 13982.691094546735, 1580.9560503154598, 24235.129226238856, 442.381927895108, 5930.7251867497835, 6123.35987337332, 3895.1805597119037, 964.1648196670212, 31541.154988756283, 7077.564644607731, 6314.632947975102, 819.4710267446283, 13233.532843210032, 248.53322261620113, 22313.119147635058, 2511.5693357411783, 6003.289062969772, 1615.3887784735673, 15642.025957742162, 561.3054500537017, 7993.331518956106, -879.1970958428356, 6440.202103291731, -3193.6468882858617, 32378.447397490796, 4276.654127325212, 12546.792759795722, 4347.742479311762, 5573.4583758552135, 431.56586749175335, 6220.571788829268, 360.1829118231177, 9843.943783660237, 3347.927823470762, 33976.08188046543, 189.5874694527044, 14229.846492304161, 76.66950930390398, 13585.996820579832, 1284.7046171038699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6770537145068417, "mean_inference_ms": 1.4516568345136756, "mean_action_processing_ms": 0.28638189183489904, "mean_env_wait_ms": 0.1294125659314658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00387728214263916, "StateBufferConnector_ms": 0.002742290496826172, "ViewRequirementAgentConnector_ms": 0.083504319190979}, "num_episodes": 22, "episode_return_max": 44538.380943750206, "episode_return_min": 0.0, "episode_return_mean": 16668.94865450518, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.2602484426948, "num_env_steps_trained_throughput_per_sec": 357.2602484426948, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 10960.325, "restore_workers_time_ms": 0.011, "training_step_time_ms": 10960.293, "sample_time_ms": 815.665, "learn_time_ms": 10131.695, "learn_throughput": 394.801, "synch_weights_time_ms": 12.393}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "6751e_00000", "date": "2024-08-11_19-29-55", "timestamp": 1723418995, "time_this_iter_s": 11.201213359832764, "time_total_s": 1360.8453915119171, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x16eacd040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1360.8453915119171, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 30.76875, "ram_util_percent": 74.94999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.44216099184341534, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.583312400938972, "policy_loss": -0.007533962886026572, "vf_loss": 8.590798361591562, "vf_explained_var": 0.0026819817288212043, "kl": 0.015355317009773281, "entropy": 0.6567539339343076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7017629373798926, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.80176782961245, "policy_loss": -0.006424235012049653, "vf_loss": 8.80726186863329, "vf_explained_var": -5.7761694388414815e-05, "kl": 0.009301580895694267, "entropy": 0.6527415813907744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 44538.380943750206, "episode_reward_min": 264.8173354095054, "episode_reward_mean": 16475.81831381513, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -7105.491803869579, "predator_policy": -3193.6468882858617}, "policy_reward_max": {"prey_policy": 9804.722271900524, "predator_policy": 39610.554745772504}, "policy_reward_mean": {"prey_policy": 609.0379778067643, "predator_policy": 7628.871179100803}, "custom_metrics": {}, "hist_stats": {"episode_reward": [17936.772545329422, 9980.960225373448, 296.1943881806057, 7302.339969686725, 19842.905937784544, 41598.21638498358, 14803.821436581547, 1087.2692368916523, 27681.932139891585, 9649.412284022334, 20594.326324762893, 19206.292369397455, 18508.74015484822, 28309.07545157603, 12925.39151156272, 17512.181811475883, 19182.9631116862, 19635.72375294651, 10120.66148997733, 14832.815155379683, 4681.781584417701, 14267.088478805212, 21744.12142612483, 13289.03266905051, 13515.473194327544, 15502.530321822658, 19515.338461774743, 8197.719498325781, 17588.53290827582, 7934.730163362934, 8612.595664933253, 18084.2163893748, 9730.815968092707, 20352.486147502623, 27121.546218712017, 13952.242741356953, 16955.180715045142, 44538.380943750206, 8992.282398048363, 16957.01782949536, 2201.4962367517364, 37068.84569406016, 16597.10261379104, 27920.33614875405, 7857.67054353073, 22604.167387636877, 14828.738765634907, 8131.05267788109, 12371.002720567521, 32074.65249778356, 37987.724756116804, 19841.183838744648, 18808.91633624821, 42099.16636820875, 8711.364689111322, 746.4859776792922, 15748.099093958965, 264.8173354095054, 10694.879679992222, 29464.530614871972, 25022.394857186377, 20985.357410536435, 16304.685740020213, 22986.88073404263, 8529.954161949472, 3700.825317560046, 37340.81796100538, 9130.216772548274, 15298.532740316725, 19147.21694946689, 4335.618665127375, 17963.68394067966, 10063.585422521905, 8658.794637078154, 35081.13524581367, 13669.645579220645, 4865.109258879024, 9710.660873971801, 13914.03901617183, 32966.59750281346, 16620.055156490136, 19291.33423558679, 21051.184204570363, 18447.587365891428, 31271.118687579263, 5384.174336069895, 11992.81880467945, 12096.544479275173, 22251.090076228946, 8062.592446067709, 10646.825614674246, 21260.7334829973, 21397.157644261166, 15945.826221133982, 9939.229839868383, 16948.93547658306, 1908.11634696914, 13615.954861887158, 18548.30051166899, 2663.15542044962], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5608.73839163309, -839.1446967531467, -1001.1886636144241, -2627.351353174106, 4433.785472398198, -7105.491803869579, 5060.262666447795, -909.3637003137753, 2873.08641058328, -528.6249944458242, -796.9539766785265, -73.91496229398851, 5830.621150881644, -492.34590561009395, 1111.913916058367, -1684.41124948778, 1646.9725883766796, -2102.546169974682, 3590.1050683078724, -746.5928707024318, 2626.3642865768516, -777.6809764925353, 3871.0774682578485, -412.9719760039338, 8245.895061685875, -155.35423049809634, 311.6515863708192, -707.2425197865813, -1465.7244049140534, -1366.5312098149573, 676.3685549939704, -1278.493291387957, 5102.853179359269, -741.0974714376783, 5582.571109828189, -143.66477688168666, 1548.3033083085838, -2993.1585214032007, 6972.221284834389, -410.77637863873497, 17.193036176564085, -5030.290827577079, 8736.107889950035, -716.5095318678523, 5116.8686354642405, -188.0145424603262, 5715.858576371535, -673.7106246827207, 2248.5945186269623, -1272.913838949776, -3531.090687392835, -1888.9996792085153, 4338.219976328813, -1177.5350478791606, 160.379998419976, -985.8113688256982, 6973.134948138122, -1510.1933007523332, 5989.1921148187275, -1566.228033143836, 536.6421276019893, -3992.9699684723423, 9804.722271900524, -8.244280333161793, 5120.61807236558, -982.4630525486284, 8925.91469814464, -521.6613627588625, -481.56280929769065, 224.19159845212855, 5786.87543059759, -822.8626679179051, 3828.6880630524843, -394.8180611212559, -171.57648898849743, -245.78546746471005, 2419.3227342575474, -1722.7874946032348, 2446.346508224941, -994.7720992304535, 5449.97805670049, -188.22108348281492, -915.9084097434825, -243.14584154511735, 3052.212042993887, -395.9655659081469, 410.1826231097432, -500.2441058542176, -1658.3855135423257, -2439.5148276033974, -1245.0427729172284, -983.916923899758, 8022.083048353753, -802.7826026698136, 6280.95589007417, -3855.442808950073, 3365.540752576211, -602.9380280189995, -340.8178823959913, 36.207707337969076, -1400.2132486842636, -148.11788605744528, 6648.160088872069, -1246.4500633548419, 820.2656551409789, -2092.478030406137, -1125.8397868061193, -613.7080814307366, 1277.956617288299, -2886.7424102149503, 601.4690400458668, -933.6508802988388, 2813.689534963031, -947.6932309075297, 5013.036169861951, -3252.480790708079, 1546.846318819709, -3318.8170960126413, 426.2364836247047, -1167.6588074408116, -2544.34485808419, -1405.7654824565088, 1842.313052607295, -146.2770746820655, 2106.1683923305854, -1365.1297971725053, -676.3667309656404, -1014.2636891256867, -531.1969506701026, -2992.933947503543, 1869.1082212880704, -3027.6282831069498, -884.3076797569684, -393.5939926016593, 2409.1134954592994, -413.000697630756, 2374.38721589025, -557.920541399759, -2778.1250038960093, -2899.3465300133653, 595.5490277334252, -3878.608204049393, 1848.3707932347247, -88.0182603509269, 4762.582881753935, -1813.1318823452934, 7511.541662750502, -2099.3022406782, -919.2235758864463, -654.7427031158999, 283.9757048237635, -3508.865364710591, 1939.8684032894737, -3079.7833877574135, 4002.371537610522, -872.4653642911256, 2742.76245142599, -2020.5950423851914, 16.098229958485106, -1215.1700770631385, 3269.7573496733944, -956.2181947912512, 5302.344436682624, -881.711638779571, 1773.3291565035424, -303.36360413373677, 5618.706570538914, -711.2004189212097, 520.5515314069278, -2322.5995970237436, 1747.294599128484, -2649.8187620822537, 6588.363478827666, -555.7333365165431, 4416.554158174002, -3171.751438343175, 7001.4226004795255, -146.27849033300416, 330.0652867604211, -2274.7102203962145, 5969.001127486471, -3343.8605783044377, 3910.660132689622, -366.63923846785366, -1593.682931157879, -1569.3062133842461, -1301.5478901006381, -1735.6732218350332, 5681.821818182501, -2282.225632714913, 1398.8432367427165, -451.2328939101877, 2964.9726443770505, -1397.8009854034667, 4139.552398173895, -1314.3429877462936, 3250.213723219417, -772.8086415869175, 1590.8692427467906, -3787.2034380150817], "policy_predator_policy_reward": [10193.864083485561, 2973.3147669639125, 5730.486882512366, 7879.013359649609, -2309.6356329890004, 5277.536352640985, 3252.5948823921967, -101.1538788394983, 15369.000355218925, 2129.4441664282126, 34854.35070239741, 7614.734621558737, 9954.829314728126, -489.2831234181778, 832.4698170625654, 827.2967532585012, 27398.496420139305, 739.0093013502798, 4925.250920368024, 1880.6491660488646, 13868.215109028095, 4877.427905650458, 14448.468562144039, 1299.7183149995526, 13017.181557571594, -2598.982233911149, 27486.713095112005, 1217.9532898797897, 9220.93636688434, 6536.7107594073805, 13704.814947230094, 4409.491600639738, 14025.151505705391, 796.0558980592637, 9619.068804356879, 4577.748615643131, 5669.915133272955, 5895.601569798991, 10306.03406859339, -2034.6638194093662, 3738.7398988874656, 5956.139476930746, 4583.541027136857, 1663.9490935861804, 13619.438304024088, 3195.8290290968475, 4278.593032382021, 3968.291684979699, 7929.480547385267, 4610.311967265045, 15545.159881453606, 5377.460806970425, 11538.342687674733, 4816.310845650365, 4298.798493597796, 4724.352375133705, 3430.3531088432537, 8695.238152046732, 5544.726044943295, -2032.9599632552515, 7178.163147352032, 4890.760358451569, 6135.1625230401005, 2152.575874767326, 5775.315066647303, -182.65411837153397, 8071.736205332729, 3876.496606784066, 25104.271179027062, 2274.646250530515, 7080.907539815968, 1907.322438861248, 11982.105349433485, 1539.205363680364, 37836.92047463196, 7118.822425571519, 3260.1102732118698, 5035.636885182174, 10395.200373004092, 5110.243047496775, -3060.2607364659366, 0.0, 35542.65392009539, 2685.2460252533547, 11480.523717782298, 2460.332418923026, 24363.460757588007, 3646.9368739104943, 7195.465432709225, 4760.10545196723, 20955.890140520194, 3877.236943933658, 8867.2698366379, -1257.8315166869193, 4605.193481339454, 1100.3461154175277, 6862.61914630875, 2745.7808497015803, 32256.468135368195, 122.79453747339048, 36215.769826736214, 3320.2860641222915, 15292.179074616071, -852.7052613886185, 16719.351786378244, 3361.776925135147, 39610.554745772504, 4228.159490673104, 5731.345343599955, 4588.80513843802, -464.2868025701449, 1542.9546205024083, 10892.249868681749, 2989.852921221711, -1189.730483138782, -306.0075606055872, 7114.217383430129, 5352.633073755031, 26605.002376063163, 3600.950562624932, 23239.235924343757, 5733.269273383296, 16337.30373073444, 2952.0177018767617, 13982.691094546735, 1580.9560503154598, 24235.129226238856, 442.381927895108, 5930.7251867497835, 6123.35987337332, 3895.1805597119037, 964.1648196670212, 31541.154988756283, 7077.564644607731, 6314.632947975102, 819.4710267446283, 13233.532843210032, 248.53322261620113, 22313.119147635058, 2511.5693357411783, 6003.289062969772, 1615.3887784735673, 15642.025957742162, 561.3054500537017, 7993.331518956106, -879.1970958428356, 6440.202103291731, -3193.6468882858617, 32378.447397490796, 4276.654127325212, 12546.792759795722, 4347.742479311762, 5573.4583758552135, 431.56586749175335, 6220.571788829268, 360.1829118231177, 9843.943783660237, 3347.927823470762, 33976.08188046543, 189.5874694527044, 14229.846492304161, 76.66950930390398, 13585.996820579832, 1284.7046171038699, 17098.46676952743, 2482.7518826732257, 14750.550663950788, -1210.4694496770028, 23309.887087073876, 9763.27966612223, 4894.318892941512, 1392.379606082155, 9067.37227971314, -3107.1836173447987, 7993.408126518735, 2858.333632925619, 12693.507756793084, 2702.438209289392, 7590.349057112742, 2416.8883225907634, 7076.1631697804, 945.5218957118475, 13307.346644705227, 4409.365944070266, 18188.235257180484, 6371.911531622802, 14754.725000928089, 4228.322332141559, 7168.788083072946, -629.1544286721665, 15396.616952967812, 604.7081807827284, -848.9797465998429, 1189.924434595396, 9667.086090824581, 1123.6593606349527, 13852.753288858165, 2218.142141178351, 964.7204766817729, 3894.7691390361374]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6753363027775114, "mean_inference_ms": 1.4476427563117866, "mean_action_processing_ms": 0.2856242517731998, "mean_env_wait_ms": 0.1291727922850872, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114288330078125, "StateBufferConnector_ms": 0.0028797388076782227, "ViewRequirementAgentConnector_ms": 0.08386516571044922}, "num_episodes": 18, "episode_return_max": 44538.380943750206, "episode_return_min": 264.8173354095054, "episode_return_mean": 16475.81831381513, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.2368858753351, "num_env_steps_trained_throughput_per_sec": 348.2368858753351, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 11031.693, "restore_workers_time_ms": 0.011, "training_step_time_ms": 11031.662, "sample_time_ms": 814.682, "learn_time_ms": 10203.911, "learn_throughput": 392.007, "synch_weights_time_ms": 12.534}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "6751e_00000", "date": "2024-08-11_19-30-07", "timestamp": 1723419007, "time_this_iter_s": 11.490513801574707, "time_total_s": 1372.3359053134918, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f81e820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1372.3359053134918, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 31.75625, "ram_util_percent": 75.1125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.43424463535427416, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.185304147478133, "policy_loss": -0.005664125592423179, "vf_loss": 8.190912628678417, "vf_explained_var": -0.0001836068731136423, "kl": 0.017799820753143968, "entropy": 0.6987524645353751, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.604660640798864, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.53843640549473, "policy_loss": -0.005311552115849086, "vf_loss": 8.543057241641655, "vf_explained_var": 1.0627413552904886e-05, "kl": 0.006906842755638454, "entropy": 0.6349034746172567, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 44538.380943750206, "episode_reward_min": 264.8173354095054, "episode_reward_mean": 17144.13593080575, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -4232.103996047919, "predator_policy": -3193.6468882858617}, "policy_reward_max": {"prey_policy": 9804.722271900524, "predator_policy": 39610.554745772504}, "policy_reward_mean": {"prey_policy": 513.9797634059486, "predator_policy": 8058.088201996926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [13289.03266905051, 13515.473194327544, 15502.530321822658, 19515.338461774743, 8197.719498325781, 17588.53290827582, 7934.730163362934, 8612.595664933253, 18084.2163893748, 9730.815968092707, 20352.486147502623, 27121.546218712017, 13952.242741356953, 16955.180715045142, 44538.380943750206, 8992.282398048363, 16957.01782949536, 2201.4962367517364, 37068.84569406016, 16597.10261379104, 27920.33614875405, 7857.67054353073, 22604.167387636877, 14828.738765634907, 8131.05267788109, 12371.002720567521, 32074.65249778356, 37987.724756116804, 19841.183838744648, 18808.91633624821, 42099.16636820875, 8711.364689111322, 746.4859776792922, 15748.099093958965, 264.8173354095054, 10694.879679992222, 29464.530614871972, 25022.394857186377, 20985.357410536435, 16304.685740020213, 22986.88073404263, 8529.954161949472, 3700.825317560046, 37340.81796100538, 9130.216772548274, 15298.532740316725, 19147.21694946689, 4335.618665127375, 17963.68394067966, 10063.585422521905, 8658.794637078154, 35081.13524581367, 13669.645579220645, 4865.109258879024, 9710.660873971801, 13914.03901617183, 32966.59750281346, 16620.055156490136, 19291.33423558679, 21051.184204570363, 18447.587365891428, 31271.118687579263, 5384.174336069895, 11992.81880467945, 12096.544479275173, 22251.090076228946, 8062.592446067709, 10646.825614674246, 21260.7334829973, 21397.157644261166, 15945.826221133982, 9939.229839868383, 16948.93547658306, 1908.11634696914, 13615.954861887158, 18548.30051166899, 2663.15542044962, 24559.476082590587, 13771.743231408234, 957.5346785057109, 8930.645858821708, 10888.86272790358, 15815.380871971134, 12283.607175599176, 20012.30397355813, 2032.7350067388227, 37538.84753090884, 35287.370609992104, 33005.87323605851, 9836.041903204172, 11938.736263820127, 36129.98160487983, 30469.930294372214, 2662.619996218257, 20484.413483613193, 18682.244444899065, 21300.135403219494, 14172.425889761093, 23986.987889318178, 33784.850713385735], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [5715.858576371535, -673.7106246827207, 2248.5945186269623, -1272.913838949776, -3531.090687392835, -1888.9996792085153, 4338.219976328813, -1177.5350478791606, 160.379998419976, -985.8113688256982, 6973.134948138122, -1510.1933007523332, 5989.1921148187275, -1566.228033143836, 536.6421276019893, -3992.9699684723423, 9804.722271900524, -8.244280333161793, 5120.61807236558, -982.4630525486284, 8925.91469814464, -521.6613627588625, -481.56280929769065, 224.19159845212855, 5786.87543059759, -822.8626679179051, 3828.6880630524843, -394.8180611212559, -171.57648898849743, -245.78546746471005, 2419.3227342575474, -1722.7874946032348, 2446.346508224941, -994.7720992304535, 5449.97805670049, -188.22108348281492, -915.9084097434825, -243.14584154511735, 3052.212042993887, -395.9655659081469, 410.1826231097432, -500.2441058542176, -1658.3855135423257, -2439.5148276033974, -1245.0427729172284, -983.916923899758, 8022.083048353753, -802.7826026698136, 6280.95589007417, -3855.442808950073, 3365.540752576211, -602.9380280189995, -340.8178823959913, 36.207707337969076, -1400.2132486842636, -148.11788605744528, 6648.160088872069, -1246.4500633548419, 820.2656551409789, -2092.478030406137, -1125.8397868061193, -613.7080814307366, 1277.956617288299, -2886.7424102149503, 601.4690400458668, -933.6508802988388, 2813.689534963031, -947.6932309075297, 5013.036169861951, -3252.480790708079, 1546.846318819709, -3318.8170960126413, 426.2364836247047, -1167.6588074408116, -2544.34485808419, -1405.7654824565088, 1842.313052607295, -146.2770746820655, 2106.1683923305854, -1365.1297971725053, -676.3667309656404, -1014.2636891256867, -531.1969506701026, -2992.933947503543, 1869.1082212880704, -3027.6282831069498, -884.3076797569684, -393.5939926016593, 2409.1134954592994, -413.000697630756, 2374.38721589025, -557.920541399759, -2778.1250038960093, -2899.3465300133653, 595.5490277334252, -3878.608204049393, 1848.3707932347247, -88.0182603509269, 4762.582881753935, -1813.1318823452934, 7511.541662750502, -2099.3022406782, -919.2235758864463, -654.7427031158999, 283.9757048237635, -3508.865364710591, 1939.8684032894737, -3079.7833877574135, 4002.371537610522, -872.4653642911256, 2742.76245142599, -2020.5950423851914, 16.098229958485106, -1215.1700770631385, 3269.7573496733944, -956.2181947912512, 5302.344436682624, -881.711638779571, 1773.3291565035424, -303.36360413373677, 5618.706570538914, -711.2004189212097, 520.5515314069278, -2322.5995970237436, 1747.294599128484, -2649.8187620822537, 6588.363478827666, -555.7333365165431, 4416.554158174002, -3171.751438343175, 7001.4226004795255, -146.27849033300416, 330.0652867604211, -2274.7102203962145, 5969.001127486471, -3343.8605783044377, 3910.660132689622, -366.63923846785366, -1593.682931157879, -1569.3062133842461, -1301.5478901006381, -1735.6732218350332, 5681.821818182501, -2282.225632714913, 1398.8432367427165, -451.2328939101877, 2964.9726443770505, -1397.8009854034667, 4139.552398173895, -1314.3429877462936, 3250.213723219417, -772.8086415869175, 1590.8692427467906, -3787.2034380150817, 945.8250281958385, -2650.706407084925, 3489.4124533934005, -111.45837698952911, 516.1801796225222, 1106.3023088655018, 4726.59704859593, -1629.2884274533878, 1806.5712323727578, -3660.7859509898635, 8941.219076383475, -731.2599930509634, 2959.4620951599936, -792.1107367464722, 6836.324918549833, -1186.7908114699103, 2811.3128667074925, -2815.969841165631, -459.8907128470588, -442.58649292464935, -1007.2029486583355, -624.2021217527453, -906.8169483924546, -373.6633950320072, 6541.604930359104, -2755.70831507415, 5862.0232665669155, -1640.6009443350833, -1739.8278991572442, -343.81117298648167, 744.6139277173223, -1503.6047156118982, 268.06343927461364, -4232.103996047919, 8480.735848504573, -779.3849784495495, 6172.502739068636, -758.9542413346061, 985.9358588098984, -2245.432371489354, -461.2986029165288, -803.0061202228811, -1010.5758824037076, -1968.2262550197768, -422.31073089015115, -481.23064740314487], "policy_predator_policy_reward": [4278.593032382021, 3968.291684979699, 7929.480547385267, 4610.311967265045, 15545.159881453606, 5377.460806970425, 11538.342687674733, 4816.310845650365, 4298.798493597796, 4724.352375133705, 3430.3531088432537, 8695.238152046732, 5544.726044943295, -2032.9599632552515, 7178.163147352032, 4890.760358451569, 6135.1625230401005, 2152.575874767326, 5775.315066647303, -182.65411837153397, 8071.736205332729, 3876.496606784066, 25104.271179027062, 2274.646250530515, 7080.907539815968, 1907.322438861248, 11982.105349433485, 1539.205363680364, 37836.92047463196, 7118.822425571519, 3260.1102732118698, 5035.636885182174, 10395.200373004092, 5110.243047496775, -3060.2607364659366, 0.0, 35542.65392009539, 2685.2460252533547, 11480.523717782298, 2460.332418923026, 24363.460757588007, 3646.9368739104943, 7195.465432709225, 4760.10545196723, 20955.890140520194, 3877.236943933658, 8867.2698366379, -1257.8315166869193, 4605.193481339454, 1100.3461154175277, 6862.61914630875, 2745.7808497015803, 32256.468135368195, 122.79453747339048, 36215.769826736214, 3320.2860641222915, 15292.179074616071, -852.7052613886185, 16719.351786378244, 3361.776925135147, 39610.554745772504, 4228.159490673104, 5731.345343599955, 4588.80513843802, -464.2868025701449, 1542.9546205024083, 10892.249868681749, 2989.852921221711, -1189.730483138782, -306.0075606055872, 7114.217383430129, 5352.633073755031, 26605.002376063163, 3600.950562624932, 23239.235924343757, 5733.269273383296, 16337.30373073444, 2952.0177018767617, 13982.691094546735, 1580.9560503154598, 24235.129226238856, 442.381927895108, 5930.7251867497835, 6123.35987337332, 3895.1805597119037, 964.1648196670212, 31541.154988756283, 7077.564644607731, 6314.632947975102, 819.4710267446283, 13233.532843210032, 248.53322261620113, 22313.119147635058, 2511.5693357411783, 6003.289062969772, 1615.3887784735673, 15642.025957742162, 561.3054500537017, 7993.331518956106, -879.1970958428356, 6440.202103291731, -3193.6468882858617, 32378.447397490796, 4276.654127325212, 12546.792759795722, 4347.742479311762, 5573.4583758552135, 431.56586749175335, 6220.571788829268, 360.1829118231177, 9843.943783660237, 3347.927823470762, 33976.08188046543, 189.5874694527044, 14229.846492304161, 76.66950930390398, 13585.996820579832, 1284.7046171038699, 17098.46676952743, 2482.7518826732257, 14750.550663950788, -1210.4694496770028, 23309.887087073876, 9763.27966612223, 4894.318892941512, 1392.379606082155, 9067.37227971314, -3107.1836173447987, 7993.408126518735, 2858.333632925619, 12693.507756793084, 2702.438209289392, 7590.349057112742, 2416.8883225907634, 7076.1631697804, 945.5218957118475, 13307.346644705227, 4409.365944070266, 18188.235257180484, 6371.911531622802, 14754.725000928089, 4228.322332141559, 7168.788083072946, -629.1544286721665, 15396.616952967812, 604.7081807827284, -848.9797465998429, 1189.924434595396, 9667.086090824581, 1123.6593606349527, 13852.753288858165, 2218.142141178351, 964.7204766817729, 3894.7691390361374, 23069.18298245569, 3195.1744790239754, 9642.611091331395, 751.1780636729858, 2029.6811286883158, -2694.628938670629, 8022.633176564722, -2189.295938885552, 9789.220745674607, 2953.856700846079, 8837.770658053465, -1232.348869414795, 7411.466206894283, 2704.789610291422, 12818.018422148756, 1544.7514443294963, -168.1292821547557, 2205.521263351718, 38441.32473668056, 0.0, 31897.602226033217, 5021.17345436993, 29545.554237731434, 4740.799341751554, 6029.309554068284, 20.83573385093436, 6786.561792829916, 930.7521487583656, 30901.719726984586, 7311.900950038969, 30437.920255364385, 791.0008269024031, 2636.069045925593, 3990.5915070659685, 7623.65953570516, 5159.4030778529905, 14315.619835010091, -1046.9238878450462, 19596.055006451155, 2963.57690944779, 13645.777602193833, 1790.9530107066553, 24605.789514788223, 2360.000511953438, 32814.11420501205, 1874.2778866669778]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6729377921827833, "mean_inference_ms": 1.4433573183279156, "mean_action_processing_ms": 0.28402539067096233, "mean_env_wait_ms": 0.12871746348659838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032329559326171875, "StateBufferConnector_ms": 0.0028568506240844727, "ViewRequirementAgentConnector_ms": 0.08177101612091064}, "num_episodes": 23, "episode_return_max": 44538.380943750206, "episode_return_min": 264.8173354095054, "episode_return_mean": 17144.13593080575, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.3862634771862, "num_env_steps_trained_throughput_per_sec": 359.3862634771862, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 11069.651, "restore_workers_time_ms": 0.011, "training_step_time_ms": 11069.62, "sample_time_ms": 810.337, "learn_time_ms": 10245.752, "learn_throughput": 390.406, "synch_weights_time_ms": 12.992}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "6751e_00000", "date": "2024-08-11_19-30-18", "timestamp": 1723419018, "time_this_iter_s": 11.13526725769043, "time_total_s": 1383.4711725711823, "pid": 19249, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1.5, "predator_speed": 1, "grid_size": 50, "max_steps": 200, "screen_size": 600}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x31f835820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}], "predator_policy": [null, "Box(-1.0, 1.0, (4,), float32)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1383.4711725711823, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 30.437500000000004, "ram_util_percent": 75.2125}}
