{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.47906899401750513, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.565714695718554, "policy_loss": 0.0012988379900220526, "vf_loss": 4.557191395128846, "vf_explained_var": -0.00012206151371910459, "kl": 0.03612236260145745, "entropy": 1.606647577172234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2443649521738134, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.720243425722476, "policy_loss": 0.003854425344369793, "vf_loss": 9.710404793673723, "vf_explained_var": 0.00031780032884506953, "kl": 0.02992103123968398, "entropy": 1.6032376789542102, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1368.0, "episode_reward_mean": -106.11111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -253.75, "predator_policy": 200.69444444444446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -422.0, 174.0, -282.0, -418.0, -572.0, 291.0, 226.0, 154.0, -230.0, -182.0, 246.0, -81.0, -1368.0, -422.0, 179.0, -3.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -240.0, -702.0, -361.0, 200.0, -31.0, -691.0, -746.0, -317.0, -163.0, -944.0, 123.0, 123.0, 46.0, 35.0, -251.0, 200.0, 13.0, -768.0, -812.0, 145.0, -86.0, 57.0, -42.0, -284.0, -1868.0, -955.0, -603.0, -504.0, 200.0, -251.0, 200.0, -658.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 475.0, 45.0, 210.0, 125.0, 340.0, 100.0, 430.0, 215.0, 15.0, 520.0, 45.0, 0.0, 75.0, 70.0, 0.0, 205.0, 0.0, 525.0, 215.0, 270.0, 135.0, 140.0, 245.0, 0.0, 895.0, 560.0, 320.0, 365.0, 175.0, 55.0, 85.0, 370.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0990677806845939, "mean_inference_ms": 2.557035783017342, "mean_action_processing_ms": 0.4069801437304379, "mean_env_wait_ms": 0.3079129080384439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010471873813205294, "StateBufferConnector_ms": 0.003910726971096463, "ViewRequirementAgentConnector_ms": 0.25395817226833767}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1368.0, "episode_return_mean": -106.11111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 65.53950738770004, "num_env_steps_trained_throughput_per_sec": 65.53950738770004, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 61031.903, "restore_workers_time_ms": 0.02, "training_step_time_ms": 61031.844, "sample_time_ms": 2134.693, "learn_time_ms": 58874.67, "learn_throughput": 67.941, "synch_weights_time_ms": 15.834}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "ed30a_00000", "date": "2024-08-12_14-17-11", "timestamp": 1723486631, "time_this_iter_s": 61.101754903793335, "time_total_s": 61.101754903793335, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00728b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 61.101754903793335, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 52.38863636363636, "ram_util_percent": 83.42840909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7475571306294234, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.700182051885696, "policy_loss": -0.008987101784626406, "vf_loss": 6.708006402676698, "vf_explained_var": 0.000239738490846422, "kl": 0.003875813313108831, "entropy": 1.6032676456466555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.728632005670714, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.708844528500997, "policy_loss": -0.006665490608583524, "vf_loss": 9.714636430790815, "vf_explained_var": 0.0006316467883094908, "kl": 0.0029119421459838403, "entropy": 1.597667806678348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1368.0, "episode_reward_mean": -227.61111111111111, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -371.2361111111111, "predator_policy": 257.43055555555554}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -422.0, 174.0, -282.0, -418.0, -572.0, 291.0, 226.0, 154.0, -230.0, -182.0, 246.0, -81.0, -1368.0, -422.0, 179.0, -3.0, 400.0, -759.0, -1003.0, 58.0, -492.0, -1069.0, 79.0, 16.0, 12.0, 137.0, -974.0, -217.0, -500.0, 3.0, 256.0, -874.0, -354.0, -1003.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -240.0, -702.0, -361.0, 200.0, -31.0, -691.0, -746.0, -317.0, -163.0, -944.0, 123.0, 123.0, 46.0, 35.0, -251.0, 200.0, 13.0, -768.0, -812.0, 145.0, -86.0, 57.0, -42.0, -284.0, -1868.0, -955.0, -603.0, -504.0, 200.0, -251.0, 200.0, -658.0, 200.0, 200.0, -372.0, -1197.0, -702.0, -1461.0, -328.0, 101.0, -174.0, -823.0, -625.0, -1494.0, 167.0, -383.0, -1109.0, 200.0, 68.0, -361.0, -229.0, 156.0, -1219.0, -900.0, 178.0, -900.0, -1461.0, -64.0, 189.0, -581.0, 46.0, 90.0, -1241.0, -713.0, -581.0, -218.0, -1098.0, -955.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 475.0, 45.0, 210.0, 125.0, 340.0, 100.0, 430.0, 215.0, 15.0, 520.0, 45.0, 0.0, 75.0, 70.0, 0.0, 205.0, 0.0, 525.0, 215.0, 270.0, 135.0, 140.0, 245.0, 0.0, 895.0, 560.0, 320.0, 365.0, 175.0, 55.0, 85.0, 370.0, 0.0, 0.0, 810.0, 0.0, 665.0, 495.0, 240.0, 45.0, 25.0, 480.0, 640.0, 410.0, 270.0, 25.0, 480.0, 445.0, 0.0, 305.0, 25.0, 185.0, 500.0, 645.0, 330.0, 175.0, 730.0, 295.0, 65.0, 330.0, 10.0, 110.0, 410.0, 670.0, 405.0, 40.0, 615.0, 435.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9927888953080564, "mean_inference_ms": 2.303131878994753, "mean_action_processing_ms": 0.37045148819440676, "mean_env_wait_ms": 0.27687526459528006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008269151051839193, "StateBufferConnector_ms": 0.0037100580003526476, "ViewRequirementAgentConnector_ms": 0.17620623111724854}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1368.0, "episode_return_mean": -227.61111111111111, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.93637980225014, "num_env_steps_trained_throughput_per_sec": 72.93637980225014, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 57937.116, "restore_workers_time_ms": 0.022, "training_step_time_ms": 57937.052, "sample_time_ms": 1703.341, "learn_time_ms": 56211.447, "learn_throughput": 71.16, "synch_weights_time_ms": 16.476}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "ed30a_00000", "date": "2024-08-12_14-18-09", "timestamp": 1723486689, "time_this_iter_s": 54.9050509929657, "time_total_s": 116.00680589675903, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01015e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 116.00680589675903, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 39.62439024390243, "ram_util_percent": 83.34878048780489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0656099716033884, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.593171342213949, "policy_loss": -0.012687863982356494, "vf_loss": 6.60366130556379, "vf_explained_var": -0.00011805526163212206, "kl": 0.01465258389303433, "entropy": 1.5822270725139234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2653442015250524, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.705878910690389, "policy_loss": -0.01043654645389074, "vf_loss": 9.714827774693726, "vf_explained_var": 0.0010302200203850156, "kl": 0.009917778625813825, "entropy": 1.585590351700152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1504.0, "episode_reward_mean": -283.3888888888889, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 895.0}, "policy_reward_mean": {"prey_policy": -421.60185185185185, "predator_policy": 279.9074074074074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -422.0, 174.0, -282.0, -418.0, -572.0, 291.0, 226.0, 154.0, -230.0, -182.0, 246.0, -81.0, -1368.0, -422.0, 179.0, -3.0, 400.0, -759.0, -1003.0, 58.0, -492.0, -1069.0, 79.0, 16.0, 12.0, 137.0, -974.0, -217.0, -500.0, 3.0, 256.0, -874.0, -354.0, -1003.0, 400.0, -347.0, -914.0, 52.0, -818.0, -842.0, -670.0, 394.0, -255.0, -510.0, -446.0, -390.0, 90.0, -618.0, -118.0, -2.0, -201.0, -10.0, -1504.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -240.0, -702.0, -361.0, 200.0, -31.0, -691.0, -746.0, -317.0, -163.0, -944.0, 123.0, 123.0, 46.0, 35.0, -251.0, 200.0, 13.0, -768.0, -812.0, 145.0, -86.0, 57.0, -42.0, -284.0, -1868.0, -955.0, -603.0, -504.0, 200.0, -251.0, 200.0, -658.0, 200.0, 200.0, -372.0, -1197.0, -702.0, -1461.0, -328.0, 101.0, -174.0, -823.0, -625.0, -1494.0, 167.0, -383.0, -1109.0, 200.0, 68.0, -361.0, -229.0, 156.0, -1219.0, -900.0, 178.0, -900.0, -1461.0, -64.0, 189.0, -581.0, 46.0, 90.0, -1241.0, -713.0, -581.0, -218.0, -1098.0, -955.0, 200.0, 200.0, -1252.0, 200.0, -1065.0, -944.0, -119.0, -64.0, -1472.0, -361.0, -999.0, -768.0, -504.0, -1186.0, 200.0, 189.0, -1780.0, 200.0, -449.0, -526.0, -427.0, -724.0, 101.0, -1076.0, -218.0, 68.0, -284.0, -1219.0, -196.0, -372.0, -42.0, -295.0, -878.0, 2.0, 156.0, -471.0, -977.0, -1252.0], "policy_predator_policy_reward": [0.0, 0.0, 475.0, 45.0, 210.0, 125.0, 340.0, 100.0, 430.0, 215.0, 15.0, 520.0, 45.0, 0.0, 75.0, 70.0, 0.0, 205.0, 0.0, 525.0, 215.0, 270.0, 135.0, 140.0, 245.0, 0.0, 895.0, 560.0, 320.0, 365.0, 175.0, 55.0, 85.0, 370.0, 0.0, 0.0, 810.0, 0.0, 665.0, 495.0, 240.0, 45.0, 25.0, 480.0, 640.0, 410.0, 270.0, 25.0, 480.0, 445.0, 0.0, 305.0, 25.0, 185.0, 500.0, 645.0, 330.0, 175.0, 730.0, 295.0, 65.0, 330.0, 10.0, 110.0, 410.0, 670.0, 405.0, 40.0, 615.0, 435.0, 0.0, 0.0, 505.0, 200.0, 575.0, 520.0, 235.0, 0.0, 195.0, 820.0, 190.0, 735.0, 525.0, 495.0, 0.0, 5.0, 835.0, 490.0, 135.0, 330.0, 285.0, 420.0, 395.0, 190.0, 60.0, 180.0, 645.0, 240.0, 200.0, 250.0, 110.0, 225.0, 205.0, 470.0, 0.0, 305.0, 720.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.0111414581709295, "mean_inference_ms": 2.401964277717106, "mean_action_processing_ms": 0.3832613117212794, "mean_env_wait_ms": 0.29630340364002195, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011907683478461372, "StateBufferConnector_ms": 0.004306766721937392, "ViewRequirementAgentConnector_ms": 0.17995966805352104}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1504.0, "episode_return_mean": -283.3888888888889, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.02560757931367, "num_env_steps_trained_throughput_per_sec": 73.02560757931367, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 56883.182, "restore_workers_time_ms": 0.02, "training_step_time_ms": 56883.124, "sample_time_ms": 2092.799, "learn_time_ms": 54769.916, "learn_throughput": 73.033, "synch_weights_time_ms": 15.74}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "ed30a_00000", "date": "2024-08-12_14-19-04", "timestamp": 1723486744, "time_this_iter_s": 54.78533101081848, "time_total_s": 170.79213690757751, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 170.79213690757751, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 39.099999999999994, "ram_util_percent": 81.71410256410259}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.83486313632241, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.355373481972507, "policy_loss": -0.008380990916932072, "vf_loss": 4.362483433819322, "vf_explained_var": 0.0002824611449367786, "kl": 0.008473450200455783, "entropy": 1.5929771101033245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.005119829439612, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.635907319487718, "policy_loss": -0.009239586209878326, "vf_loss": 9.64405062337401, "vf_explained_var": 0.0019892715587817803, "kl": 0.00730849874645948, "entropy": 1.5742317732049045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1615.0, "episode_reward_mean": -239.83333333333334, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -381.93055555555554, "predator_policy": 262.0138888888889}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -422.0, 174.0, -282.0, -418.0, -572.0, 291.0, 226.0, 154.0, -230.0, -182.0, 246.0, -81.0, -1368.0, -422.0, 179.0, -3.0, 400.0, -759.0, -1003.0, 58.0, -492.0, -1069.0, 79.0, 16.0, 12.0, 137.0, -974.0, -217.0, -500.0, 3.0, 256.0, -874.0, -354.0, -1003.0, 400.0, -347.0, -914.0, 52.0, -818.0, -842.0, -670.0, 394.0, -255.0, -510.0, -446.0, -390.0, 90.0, -618.0, -118.0, -2.0, -201.0, -10.0, -1504.0, -248.0, 400.0, 353.0, -25.0, -222.0, 346.0, -389.0, 238.0, -324.0, -95.0, 22.0, 22.0, 29.0, -331.0, -1615.0, -290.0, 274.0, -110.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -240.0, -702.0, -361.0, 200.0, -31.0, -691.0, -746.0, -317.0, -163.0, -944.0, 123.0, 123.0, 46.0, 35.0, -251.0, 200.0, 13.0, -768.0, -812.0, 145.0, -86.0, 57.0, -42.0, -284.0, -1868.0, -955.0, -603.0, -504.0, 200.0, -251.0, 200.0, -658.0, 200.0, 200.0, -372.0, -1197.0, -702.0, -1461.0, -328.0, 101.0, -174.0, -823.0, -625.0, -1494.0, 167.0, -383.0, -1109.0, 200.0, 68.0, -361.0, -229.0, 156.0, -1219.0, -900.0, 178.0, -900.0, -1461.0, -64.0, 189.0, -581.0, 46.0, 90.0, -1241.0, -713.0, -581.0, -218.0, -1098.0, -955.0, 200.0, 200.0, -1252.0, 200.0, -1065.0, -944.0, -119.0, -64.0, -1472.0, -361.0, -999.0, -768.0, -504.0, -1186.0, 200.0, 189.0, -1780.0, 200.0, -449.0, -526.0, -427.0, -724.0, 101.0, -1076.0, -218.0, 68.0, -284.0, -1219.0, -196.0, -372.0, -42.0, -295.0, -878.0, 2.0, 156.0, -471.0, -977.0, -1252.0, -504.0, -559.0, 200.0, 200.0, 167.0, 156.0, -581.0, 156.0, -394.0, -273.0, 200.0, 101.0, -625.0, -284.0, -97.0, 200.0, -119.0, -1505.0, -9.0, -471.0, 24.0, -207.0, -328.0, 35.0, -339.0, 13.0, -438.0, -328.0, -944.0, -1626.0, -31.0, -889.0, 189.0, -20.0, -691.0, 156.0], "policy_predator_policy_reward": [0.0, 0.0, 475.0, 45.0, 210.0, 125.0, 340.0, 100.0, 430.0, 215.0, 15.0, 520.0, 45.0, 0.0, 75.0, 70.0, 0.0, 205.0, 0.0, 525.0, 215.0, 270.0, 135.0, 140.0, 245.0, 0.0, 895.0, 560.0, 320.0, 365.0, 175.0, 55.0, 85.0, 370.0, 0.0, 0.0, 810.0, 0.0, 665.0, 495.0, 240.0, 45.0, 25.0, 480.0, 640.0, 410.0, 270.0, 25.0, 480.0, 445.0, 0.0, 305.0, 25.0, 185.0, 500.0, 645.0, 330.0, 175.0, 730.0, 295.0, 65.0, 330.0, 10.0, 110.0, 410.0, 670.0, 405.0, 40.0, 615.0, 435.0, 0.0, 0.0, 505.0, 200.0, 575.0, 520.0, 235.0, 0.0, 195.0, 820.0, 190.0, 735.0, 525.0, 495.0, 0.0, 5.0, 835.0, 490.0, 135.0, 330.0, 285.0, 420.0, 395.0, 190.0, 60.0, 180.0, 645.0, 240.0, 200.0, 250.0, 110.0, 225.0, 205.0, 470.0, 0.0, 305.0, 720.0, 5.0, 320.0, 495.0, 0.0, 0.0, 0.0, 30.0, 315.0, 85.0, 145.0, 300.0, 0.0, 45.0, 375.0, 145.0, 0.0, 135.0, 735.0, 565.0, 65.0, 320.0, 205.0, 0.0, 255.0, 60.0, 110.0, 245.0, 0.0, 435.0, 955.0, 0.0, 505.0, 125.0, 5.0, 100.0, 405.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9922019243236507, "mean_inference_ms": 2.375115974532602, "mean_action_processing_ms": 0.3793322803254069, "mean_env_wait_ms": 0.2957322889214401, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010378824339972602, "StateBufferConnector_ms": 0.0040608975622389056, "ViewRequirementAgentConnector_ms": 0.16024261713027954}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1615.0, "episode_return_mean": -239.83333333333334, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.02766550812237, "num_env_steps_trained_throughput_per_sec": 74.02766550812237, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 56170.853, "restore_workers_time_ms": 0.021, "training_step_time_ms": 56170.793, "sample_time_ms": 1851.056, "learn_time_ms": 54299.283, "learn_throughput": 73.666, "synch_weights_time_ms": 15.014}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "ed30a_00000", "date": "2024-08-12_14-19-58", "timestamp": 1723486798, "time_this_iter_s": 54.08281326293945, "time_total_s": 224.87495017051697, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0113310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 224.87495017051697, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 39.18181818181817, "ram_util_percent": 81.58961038961039}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8613038935516246, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1737658908127475, "policy_loss": -0.011850886181657198, "vf_loss": 4.183463503191711, "vf_explained_var": 5.4411913352037866e-05, "kl": 0.014355293629670033, "entropy": 1.5954908311682403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.8871405038568705, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.493320066462118, "policy_loss": -0.011186435985349356, "vf_loss": 9.503031641844089, "vf_explained_var": 0.003222666373328557, "kl": 0.00983243122028064, "entropy": 1.5441005120832454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1615.0, "episode_reward_mean": -196.21212121212122, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -345.8333333333333, "predator_policy": 247.72727272727272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -422.0, 174.0, -282.0, -418.0, -572.0, 291.0, 226.0, 154.0, -230.0, -182.0, 246.0, -81.0, -1368.0, -422.0, 179.0, -3.0, 400.0, -759.0, -1003.0, 58.0, -492.0, -1069.0, 79.0, 16.0, 12.0, 137.0, -974.0, -217.0, -500.0, 3.0, 256.0, -874.0, -354.0, -1003.0, 400.0, -347.0, -914.0, 52.0, -818.0, -842.0, -670.0, 394.0, -255.0, -510.0, -446.0, -390.0, 90.0, -618.0, -118.0, -2.0, -201.0, -10.0, -1504.0, -248.0, 400.0, 353.0, -25.0, -222.0, 346.0, -389.0, 238.0, -324.0, -95.0, 22.0, 22.0, 29.0, -331.0, -1615.0, -290.0, 274.0, -110.0, -343.0, -380.0, 121.0, -926.0, 83.0, -409.0, 322.0, -152.0, 205.0, -422.0, -71.0, -576.0, 187.0, -525.0, 394.0, -387.0, 118.0, 146.0, -135.0, -218.0, -158.0, 394.0, 184.0, 65.0, 342.0, -317.0, 301.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -240.0, -702.0, -361.0, 200.0, -31.0, -691.0, -746.0, -317.0, -163.0, -944.0, 123.0, 123.0, 46.0, 35.0, -251.0, 200.0, 13.0, -768.0, -812.0, 145.0, -86.0, 57.0, -42.0, -284.0, -1868.0, -955.0, -603.0, -504.0, 200.0, -251.0, 200.0, -658.0, 200.0, 200.0, -372.0, -1197.0, -702.0, -1461.0, -328.0, 101.0, -174.0, -823.0, -625.0, -1494.0, 167.0, -383.0, -1109.0, 200.0, 68.0, -361.0, -229.0, 156.0, -1219.0, -900.0, 178.0, -900.0, -1461.0, -64.0, 189.0, -581.0, 46.0, 90.0, -1241.0, -713.0, -581.0, -218.0, -1098.0, -955.0, 200.0, 200.0, -1252.0, 200.0, -1065.0, -944.0, -119.0, -64.0, -1472.0, -361.0, -999.0, -768.0, -504.0, -1186.0, 200.0, 189.0, -1780.0, 200.0, -449.0, -526.0, -427.0, -724.0, 101.0, -1076.0, -218.0, 68.0, -284.0, -1219.0, -196.0, -372.0, -42.0, -295.0, -878.0, 2.0, 156.0, -471.0, -977.0, -1252.0, -504.0, -559.0, 200.0, 200.0, 167.0, 156.0, -581.0, 156.0, -394.0, -273.0, 200.0, 101.0, -625.0, -284.0, -97.0, 200.0, -119.0, -1505.0, -9.0, -471.0, 24.0, -207.0, -328.0, 35.0, -339.0, 13.0, -438.0, -328.0, -944.0, -1626.0, -31.0, -889.0, 189.0, -20.0, -691.0, 156.0, -966.0, 68.0, -559.0, -416.0, -141.0, 57.0, -1637.0, -394.0, 79.0, -306.0, -1494.0, 200.0, 145.0, 112.0, -130.0, -482.0, 178.0, -218.0, -1208.0, -64.0, -471.0, 35.0, -1032.0, -559.0, 79.0, -42.0, -86.0, -1054.0, 200.0, 189.0, -746.0, -471.0, -218.0, 101.0, -31.0, 57.0, -900.0, 200.0, -801.0, 68.0, -823.0, 200.0, 189.0, 200.0, 24.0, -20.0, -306.0, 101.0, 178.0, 134.0, -174.0, -768.0, 156.0, 90.0], "policy_predator_policy_reward": [0.0, 0.0, 475.0, 45.0, 210.0, 125.0, 340.0, 100.0, 430.0, 215.0, 15.0, 520.0, 45.0, 0.0, 75.0, 70.0, 0.0, 205.0, 0.0, 525.0, 215.0, 270.0, 135.0, 140.0, 245.0, 0.0, 895.0, 560.0, 320.0, 365.0, 175.0, 55.0, 85.0, 370.0, 0.0, 0.0, 810.0, 0.0, 665.0, 495.0, 240.0, 45.0, 25.0, 480.0, 640.0, 410.0, 270.0, 25.0, 480.0, 445.0, 0.0, 305.0, 25.0, 185.0, 500.0, 645.0, 330.0, 175.0, 730.0, 295.0, 65.0, 330.0, 10.0, 110.0, 410.0, 670.0, 405.0, 40.0, 615.0, 435.0, 0.0, 0.0, 505.0, 200.0, 575.0, 520.0, 235.0, 0.0, 195.0, 820.0, 190.0, 735.0, 525.0, 495.0, 0.0, 5.0, 835.0, 490.0, 135.0, 330.0, 285.0, 420.0, 395.0, 190.0, 60.0, 180.0, 645.0, 240.0, 200.0, 250.0, 110.0, 225.0, 205.0, 470.0, 0.0, 305.0, 720.0, 5.0, 320.0, 495.0, 0.0, 0.0, 0.0, 30.0, 315.0, 85.0, 145.0, 300.0, 0.0, 45.0, 375.0, 145.0, 0.0, 135.0, 735.0, 565.0, 65.0, 320.0, 205.0, 0.0, 255.0, 60.0, 110.0, 245.0, 0.0, 435.0, 955.0, 0.0, 505.0, 125.0, 5.0, 100.0, 405.0, 20.0, 35.0, 520.0, 200.0, 395.0, 205.0, 0.0, 270.0, 835.0, 135.0, 175.0, 140.0, 745.0, 25.0, 40.0, 295.0, 165.0, 75.0, 170.0, 335.0, 515.0, 80.0, 285.0, 840.0, 175.0, 135.0, 15.0, 585.0, 30.0, 5.0, 0.0, 430.0, 400.0, 5.0, 230.0, 120.0, 0.0, 205.0, 360.0, 95.0, 420.0, 210.0, 255.0, 0.0, 5.0, 100.0, 80.0, 270.0, 0.0, 0.0, 30.0, 460.0, 165.0, 0.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9648149825328839, "mean_inference_ms": 2.316172024196302, "mean_action_processing_ms": 0.3709314086380756, "mean_env_wait_ms": 0.28977483912757146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00941199485701744, "StateBufferConnector_ms": 0.0038231262052902068, "ViewRequirementAgentConnector_ms": 0.1441656941115254}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": -1615.0, "episode_return_mean": -196.21212121212122, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.88394978941892, "num_env_steps_trained_throughput_per_sec": 73.88394978941892, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 55764.475, "restore_workers_time_ms": 0.019, "training_step_time_ms": 55764.418, "sample_time_ms": 1756.73, "learn_time_ms": 53987.172, "learn_throughput": 74.092, "synch_weights_time_ms": 15.48}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "ed30a_00000", "date": "2024-08-12_14-20-53", "timestamp": 1723486853, "time_this_iter_s": 54.179123878479004, "time_total_s": 279.054074048996, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010c3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 279.054074048996, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 39.98701298701299, "ram_util_percent": 82.67532467532467}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.03524400804724, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.315990594076732, "policy_loss": -0.012546852945655624, "vf_loss": 6.326393413543701, "vf_explained_var": -0.00012446654536736704, "kl": 0.014293521751067025, "entropy": 1.5781112935177233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.89682547046394, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.611235681160418, "policy_loss": -0.007532078588736199, "vf_loss": 9.617906665297413, "vf_explained_var": 0.0034147316501254125, "kl": 0.005740557157997908, "entropy": 1.5283030972909675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1615.0, "episode_reward_mean": -236.39, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -377.995, "predator_policy": 259.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -759.0, -1003.0, 58.0, -492.0, -1069.0, 79.0, 16.0, 12.0, 137.0, -974.0, -217.0, -500.0, 3.0, 256.0, -874.0, -354.0, -1003.0, 400.0, -347.0, -914.0, 52.0, -818.0, -842.0, -670.0, 394.0, -255.0, -510.0, -446.0, -390.0, 90.0, -618.0, -118.0, -2.0, -201.0, -10.0, -1504.0, -248.0, 400.0, 353.0, -25.0, -222.0, 346.0, -389.0, 238.0, -324.0, -95.0, 22.0, 22.0, 29.0, -331.0, -1615.0, -290.0, 274.0, -110.0, -343.0, -380.0, 121.0, -926.0, 83.0, -409.0, 322.0, -152.0, 205.0, -422.0, -71.0, -576.0, 187.0, -525.0, 394.0, -387.0, 118.0, 146.0, -135.0, -218.0, -158.0, 394.0, 184.0, 65.0, 342.0, -317.0, 301.0, -492.0, -520.0, -248.0, -302.0, -288.0, -192.0, -455.0, -1417.0, 79.0, 172.0, 298.0, -1242.0, -783.0, 218.0, 161.0, -111.0, -1040.0, -362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -372.0, -1197.0, -702.0, -1461.0, -328.0, 101.0, -174.0, -823.0, -625.0, -1494.0, 167.0, -383.0, -1109.0, 200.0, 68.0, -361.0, -229.0, 156.0, -1219.0, -900.0, 178.0, -900.0, -1461.0, -64.0, 189.0, -581.0, 46.0, 90.0, -1241.0, -713.0, -581.0, -218.0, -1098.0, -955.0, 200.0, 200.0, -1252.0, 200.0, -1065.0, -944.0, -119.0, -64.0, -1472.0, -361.0, -999.0, -768.0, -504.0, -1186.0, 200.0, 189.0, -1780.0, 200.0, -449.0, -526.0, -427.0, -724.0, 101.0, -1076.0, -218.0, 68.0, -284.0, -1219.0, -196.0, -372.0, -42.0, -295.0, -878.0, 2.0, 156.0, -471.0, -977.0, -1252.0, -504.0, -559.0, 200.0, 200.0, 167.0, 156.0, -581.0, 156.0, -394.0, -273.0, 200.0, 101.0, -625.0, -284.0, -97.0, 200.0, -119.0, -1505.0, -9.0, -471.0, 24.0, -207.0, -328.0, 35.0, -339.0, 13.0, -438.0, -328.0, -944.0, -1626.0, -31.0, -889.0, 189.0, -20.0, -691.0, 156.0, -966.0, 68.0, -559.0, -416.0, -141.0, 57.0, -1637.0, -394.0, 79.0, -306.0, -1494.0, 200.0, 145.0, 112.0, -130.0, -482.0, 178.0, -218.0, -1208.0, -64.0, -471.0, 35.0, -1032.0, -559.0, 79.0, -42.0, -86.0, -1054.0, 200.0, 189.0, -746.0, -471.0, -218.0, 101.0, -31.0, 57.0, -900.0, 200.0, -801.0, 68.0, -823.0, 200.0, 189.0, 200.0, 24.0, -20.0, -306.0, 101.0, 178.0, 134.0, -174.0, -768.0, 156.0, 90.0, -229.0, -1043.0, 200.0, -1560.0, -746.0, -42.0, -603.0, -174.0, -306.0, -317.0, -317.0, -185.0, 90.0, -1395.0, -1351.0, -856.0, -207.0, 46.0, -218.0, 200.0, 13.0, 200.0, -999.0, -1153.0, -1362.0, -471.0, -152.0, 200.0, 200.0, -339.0, -328.0, -108.0, -1472.0, -768.0, -647.0, -460.0], "policy_predator_policy_reward": [0.0, 0.0, 810.0, 0.0, 665.0, 495.0, 240.0, 45.0, 25.0, 480.0, 640.0, 410.0, 270.0, 25.0, 480.0, 445.0, 0.0, 305.0, 25.0, 185.0, 500.0, 645.0, 330.0, 175.0, 730.0, 295.0, 65.0, 330.0, 10.0, 110.0, 410.0, 670.0, 405.0, 40.0, 615.0, 435.0, 0.0, 0.0, 505.0, 200.0, 575.0, 520.0, 235.0, 0.0, 195.0, 820.0, 190.0, 735.0, 525.0, 495.0, 0.0, 5.0, 835.0, 490.0, 135.0, 330.0, 285.0, 420.0, 395.0, 190.0, 60.0, 180.0, 645.0, 240.0, 200.0, 250.0, 110.0, 225.0, 205.0, 470.0, 0.0, 305.0, 720.0, 5.0, 320.0, 495.0, 0.0, 0.0, 0.0, 30.0, 315.0, 85.0, 145.0, 300.0, 0.0, 45.0, 375.0, 145.0, 0.0, 135.0, 735.0, 565.0, 65.0, 320.0, 205.0, 0.0, 255.0, 60.0, 110.0, 245.0, 0.0, 435.0, 955.0, 0.0, 505.0, 125.0, 5.0, 100.0, 405.0, 20.0, 35.0, 520.0, 200.0, 395.0, 205.0, 0.0, 270.0, 835.0, 135.0, 175.0, 140.0, 745.0, 25.0, 40.0, 295.0, 165.0, 75.0, 170.0, 335.0, 515.0, 80.0, 285.0, 840.0, 175.0, 135.0, 15.0, 585.0, 30.0, 5.0, 0.0, 430.0, 400.0, 5.0, 230.0, 120.0, 0.0, 205.0, 360.0, 95.0, 420.0, 210.0, 255.0, 0.0, 5.0, 100.0, 80.0, 270.0, 0.0, 0.0, 30.0, 460.0, 165.0, 0.0, 55.0, 205.0, 575.0, 760.0, 80.0, 185.0, 355.0, 410.0, 65.0, 0.0, 335.0, 310.0, 0.0, 215.0, 635.0, 790.0, 0.0, 225.0, 15.0, 0.0, 190.0, 15.0, 70.0, 570.0, 340.0, 485.0, 565.0, 135.0, 35.0, 180.0, 120.0, 5.0, 320.0, 440.0, 760.0, 295.0, 450.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9221701809156272, "mean_inference_ms": 2.2231811339158387, "mean_action_processing_ms": 0.35750489674321834, "mean_env_wait_ms": 0.2802027578470532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008721709251403809, "StateBufferConnector_ms": 0.0036476850509643555, "ViewRequirementAgentConnector_ms": 0.11435151100158691}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1615.0, "episode_return_mean": -236.39, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.6504315884276, "num_env_steps_trained_throughput_per_sec": 77.6504315884276, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 55055.883, "restore_workers_time_ms": 0.018, "training_step_time_ms": 55055.827, "sample_time_ms": 1663.967, "learn_time_ms": 53368.07, "learn_throughput": 74.951, "synch_weights_time_ms": 18.621}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "ed30a_00000", "date": "2024-08-12_14-21-44", "timestamp": 1723486904, "time_this_iter_s": 51.581363916397095, "time_total_s": 330.63543796539307, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010c5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 330.63543796539307, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 32.63243243243244, "ram_util_percent": 82.21756756756756}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0640952626548748, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.6187498776370255, "policy_loss": -0.010788530312113898, "vf_loss": 6.627823305886889, "vf_explained_var": 0.0001691420557637694, "kl": 0.01143398093197178, "entropy": 1.5566731062515702, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.243633624122887, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.604742150079636, "policy_loss": -0.009703935256286983, "vf_loss": 9.612600463786453, "vf_explained_var": 0.003731639233846513, "kl": 0.012304193934296333, "entropy": 1.5278630179072183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1615.0, "episode_reward_mean": -227.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -366.995, "predator_policy": 253.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -347.0, -914.0, 52.0, -818.0, -842.0, -670.0, 394.0, -255.0, -510.0, -446.0, -390.0, 90.0, -618.0, -118.0, -2.0, -201.0, -10.0, -1504.0, -248.0, 400.0, 353.0, -25.0, -222.0, 346.0, -389.0, 238.0, -324.0, -95.0, 22.0, 22.0, 29.0, -331.0, -1615.0, -290.0, 274.0, -110.0, -343.0, -380.0, 121.0, -926.0, 83.0, -409.0, 322.0, -152.0, 205.0, -422.0, -71.0, -576.0, 187.0, -525.0, 394.0, -387.0, 118.0, 146.0, -135.0, -218.0, -158.0, 394.0, 184.0, 65.0, 342.0, -317.0, 301.0, -492.0, -520.0, -248.0, -302.0, -288.0, -192.0, -455.0, -1417.0, 79.0, 172.0, 298.0, -1242.0, -783.0, 218.0, 161.0, -111.0, -1040.0, -362.0, -411.0, -474.0, 85.0, -600.0, -20.0, -132.0, 192.0, -1382.0, 92.0, -825.0, -699.0, 90.0, 340.0, -437.0, -618.0, -431.0, -128.0, 4.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -1252.0, 200.0, -1065.0, -944.0, -119.0, -64.0, -1472.0, -361.0, -999.0, -768.0, -504.0, -1186.0, 200.0, 189.0, -1780.0, 200.0, -449.0, -526.0, -427.0, -724.0, 101.0, -1076.0, -218.0, 68.0, -284.0, -1219.0, -196.0, -372.0, -42.0, -295.0, -878.0, 2.0, 156.0, -471.0, -977.0, -1252.0, -504.0, -559.0, 200.0, 200.0, 167.0, 156.0, -581.0, 156.0, -394.0, -273.0, 200.0, 101.0, -625.0, -284.0, -97.0, 200.0, -119.0, -1505.0, -9.0, -471.0, 24.0, -207.0, -328.0, 35.0, -339.0, 13.0, -438.0, -328.0, -944.0, -1626.0, -31.0, -889.0, 189.0, -20.0, -691.0, 156.0, -966.0, 68.0, -559.0, -416.0, -141.0, 57.0, -1637.0, -394.0, 79.0, -306.0, -1494.0, 200.0, 145.0, 112.0, -130.0, -482.0, 178.0, -218.0, -1208.0, -64.0, -471.0, 35.0, -1032.0, -559.0, 79.0, -42.0, -86.0, -1054.0, 200.0, 189.0, -746.0, -471.0, -218.0, 101.0, -31.0, 57.0, -900.0, 200.0, -801.0, 68.0, -823.0, 200.0, 189.0, 200.0, 24.0, -20.0, -306.0, 101.0, 178.0, 134.0, -174.0, -768.0, 156.0, 90.0, -229.0, -1043.0, 200.0, -1560.0, -746.0, -42.0, -603.0, -174.0, -306.0, -317.0, -317.0, -185.0, 90.0, -1395.0, -1351.0, -856.0, -207.0, 46.0, -218.0, 200.0, 13.0, 200.0, -999.0, -1153.0, -1362.0, -471.0, -152.0, 200.0, 200.0, -339.0, -328.0, -108.0, -1472.0, -768.0, -647.0, -460.0, -603.0, -603.0, -570.0, -724.0, -152.0, -108.0, -581.0, -449.0, -988.0, 123.0, -757.0, 145.0, 123.0, -196.0, -1230.0, -1032.0, 13.0, -31.0, -713.0, -922.0, -1505.0, -9.0, -526.0, 156.0, 200.0, 90.0, -185.0, -1032.0, -1406.0, -97.0, -592.0, -284.0, -405.0, -273.0, -185.0, -86.0], "policy_predator_policy_reward": [0.0, 0.0, 505.0, 200.0, 575.0, 520.0, 235.0, 0.0, 195.0, 820.0, 190.0, 735.0, 525.0, 495.0, 0.0, 5.0, 835.0, 490.0, 135.0, 330.0, 285.0, 420.0, 395.0, 190.0, 60.0, 180.0, 645.0, 240.0, 200.0, 250.0, 110.0, 225.0, 205.0, 470.0, 0.0, 305.0, 720.0, 5.0, 320.0, 495.0, 0.0, 0.0, 0.0, 30.0, 315.0, 85.0, 145.0, 300.0, 0.0, 45.0, 375.0, 145.0, 0.0, 135.0, 735.0, 565.0, 65.0, 320.0, 205.0, 0.0, 255.0, 60.0, 110.0, 245.0, 0.0, 435.0, 955.0, 0.0, 505.0, 125.0, 5.0, 100.0, 405.0, 20.0, 35.0, 520.0, 200.0, 395.0, 205.0, 0.0, 270.0, 835.0, 135.0, 175.0, 140.0, 745.0, 25.0, 40.0, 295.0, 165.0, 75.0, 170.0, 335.0, 515.0, 80.0, 285.0, 840.0, 175.0, 135.0, 15.0, 585.0, 30.0, 5.0, 0.0, 430.0, 400.0, 5.0, 230.0, 120.0, 0.0, 205.0, 360.0, 95.0, 420.0, 210.0, 255.0, 0.0, 5.0, 100.0, 80.0, 270.0, 0.0, 0.0, 30.0, 460.0, 165.0, 0.0, 55.0, 205.0, 575.0, 760.0, 80.0, 185.0, 355.0, 410.0, 65.0, 0.0, 335.0, 310.0, 0.0, 215.0, 635.0, 790.0, 0.0, 225.0, 15.0, 0.0, 190.0, 15.0, 70.0, 570.0, 340.0, 485.0, 565.0, 135.0, 35.0, 180.0, 120.0, 5.0, 320.0, 440.0, 760.0, 295.0, 450.0, 480.0, 315.0, 470.0, 350.0, 130.0, 215.0, 425.0, 5.0, 330.0, 515.0, 75.0, 405.0, 160.0, 105.0, 655.0, 225.0, 110.0, 0.0, 395.0, 415.0, 0.0, 815.0, 295.0, 165.0, 0.0, 50.0, 550.0, 230.0, 350.0, 535.0, 85.0, 360.0, 300.0, 250.0, 245.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.9072383015550798, "mean_inference_ms": 2.2027277041040034, "mean_action_processing_ms": 0.35489055454397056, "mean_env_wait_ms": 0.2804878788322194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008152604103088379, "StateBufferConnector_ms": 0.0035566091537475586, "ViewRequirementAgentConnector_ms": 0.11790144443511963}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1615.0, "episode_return_mean": -227.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.68898556951699, "num_env_steps_trained_throughput_per_sec": 75.68898556951699, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 54740.451, "restore_workers_time_ms": 0.018, "training_step_time_ms": 54740.396, "sample_time_ms": 1601.759, "learn_time_ms": 53115.449, "learn_throughput": 75.308, "synch_weights_time_ms": 18.436}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "ed30a_00000", "date": "2024-08-12_14-22-37", "timestamp": 1723486957, "time_this_iter_s": 52.892215967178345, "time_total_s": 383.5276539325714, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 383.5276539325714, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 37.34533333333333, "ram_util_percent": 83.04933333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8431421734826274, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.676945771615972, "policy_loss": -0.009220147962194114, "vf_loss": 7.6847295337253145, "vf_explained_var": 2.7735081930009145e-05, "kl": 0.009575960375953983, "entropy": 1.554819473829219, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.614178207674354, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.643094640560252, "policy_loss": -0.01168255049528347, "vf_loss": 9.652885577792214, "vf_explained_var": 0.005652876316554963, "kl": 0.01261050101109286, "entropy": 1.4801596302204032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2354.0, "episode_reward_mean": -268.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1802.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -399.005, "predator_policy": 264.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1504.0, -248.0, 400.0, 353.0, -25.0, -222.0, 346.0, -389.0, 238.0, -324.0, -95.0, 22.0, 22.0, 29.0, -331.0, -1615.0, -290.0, 274.0, -110.0, -343.0, -380.0, 121.0, -926.0, 83.0, -409.0, 322.0, -152.0, 205.0, -422.0, -71.0, -576.0, 187.0, -525.0, 394.0, -387.0, 118.0, 146.0, -135.0, -218.0, -158.0, 394.0, 184.0, 65.0, 342.0, -317.0, 301.0, -492.0, -520.0, -248.0, -302.0, -288.0, -192.0, -455.0, -1417.0, 79.0, 172.0, 298.0, -1242.0, -783.0, 218.0, 161.0, -111.0, -1040.0, -362.0, -411.0, -474.0, 85.0, -600.0, -20.0, -132.0, 192.0, -1382.0, 92.0, -825.0, -699.0, 90.0, 340.0, -437.0, -618.0, -431.0, -128.0, 4.0, 29.0, 18.0, -561.0, 310.0, -1071.0, -956.0, -1011.0, -670.0, 124.0, -2354.0, 184.0, -927.0, 12.0, 117.0, 254.0, -1056.0, -2.0, -1777.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-977.0, -1252.0, -504.0, -559.0, 200.0, 200.0, 167.0, 156.0, -581.0, 156.0, -394.0, -273.0, 200.0, 101.0, -625.0, -284.0, -97.0, 200.0, -119.0, -1505.0, -9.0, -471.0, 24.0, -207.0, -328.0, 35.0, -339.0, 13.0, -438.0, -328.0, -944.0, -1626.0, -31.0, -889.0, 189.0, -20.0, -691.0, 156.0, -966.0, 68.0, -559.0, -416.0, -141.0, 57.0, -1637.0, -394.0, 79.0, -306.0, -1494.0, 200.0, 145.0, 112.0, -130.0, -482.0, 178.0, -218.0, -1208.0, -64.0, -471.0, 35.0, -1032.0, -559.0, 79.0, -42.0, -86.0, -1054.0, 200.0, 189.0, -746.0, -471.0, -218.0, 101.0, -31.0, 57.0, -900.0, 200.0, -801.0, 68.0, -823.0, 200.0, 189.0, 200.0, 24.0, -20.0, -306.0, 101.0, 178.0, 134.0, -174.0, -768.0, 156.0, 90.0, -229.0, -1043.0, 200.0, -1560.0, -746.0, -42.0, -603.0, -174.0, -306.0, -317.0, -317.0, -185.0, 90.0, -1395.0, -1351.0, -856.0, -207.0, 46.0, -218.0, 200.0, 13.0, 200.0, -999.0, -1153.0, -1362.0, -471.0, -152.0, 200.0, 200.0, -339.0, -328.0, -108.0, -1472.0, -768.0, -647.0, -460.0, -603.0, -603.0, -570.0, -724.0, -152.0, -108.0, -581.0, -449.0, -988.0, 123.0, -757.0, 145.0, 123.0, -196.0, -1230.0, -1032.0, 13.0, -31.0, -713.0, -922.0, -1505.0, -9.0, -526.0, 156.0, 200.0, 90.0, -185.0, -1032.0, -1406.0, -97.0, -592.0, -284.0, -405.0, -273.0, -185.0, -86.0, -911.0, 200.0, -1527.0, 200.0, -1571.0, 200.0, 200.0, 35.0, -1197.0, -1054.0, -823.0, -988.0, -999.0, -1087.0, -460.0, -955.0, -306.0, 200.0, -1802.0, -1692.0, 200.0, -196.0, -724.0, -1428.0, 200.0, -768.0, -328.0, 145.0, -86.0, 200.0, -845.0, -1736.0, -207.0, -130.0, -1142.0, -1395.0], "policy_predator_policy_reward": [720.0, 5.0, 320.0, 495.0, 0.0, 0.0, 0.0, 30.0, 315.0, 85.0, 145.0, 300.0, 0.0, 45.0, 375.0, 145.0, 0.0, 135.0, 735.0, 565.0, 65.0, 320.0, 205.0, 0.0, 255.0, 60.0, 110.0, 245.0, 0.0, 435.0, 955.0, 0.0, 505.0, 125.0, 5.0, 100.0, 405.0, 20.0, 35.0, 520.0, 200.0, 395.0, 205.0, 0.0, 270.0, 835.0, 135.0, 175.0, 140.0, 745.0, 25.0, 40.0, 295.0, 165.0, 75.0, 170.0, 335.0, 515.0, 80.0, 285.0, 840.0, 175.0, 135.0, 15.0, 585.0, 30.0, 5.0, 0.0, 430.0, 400.0, 5.0, 230.0, 120.0, 0.0, 205.0, 360.0, 95.0, 420.0, 210.0, 255.0, 0.0, 5.0, 100.0, 80.0, 270.0, 0.0, 0.0, 30.0, 460.0, 165.0, 0.0, 55.0, 205.0, 575.0, 760.0, 80.0, 185.0, 355.0, 410.0, 65.0, 0.0, 335.0, 310.0, 0.0, 215.0, 635.0, 790.0, 0.0, 225.0, 15.0, 0.0, 190.0, 15.0, 70.0, 570.0, 340.0, 485.0, 565.0, 135.0, 35.0, 180.0, 120.0, 5.0, 320.0, 440.0, 760.0, 295.0, 450.0, 480.0, 315.0, 470.0, 350.0, 130.0, 215.0, 425.0, 5.0, 330.0, 515.0, 75.0, 405.0, 160.0, 105.0, 655.0, 225.0, 110.0, 0.0, 395.0, 415.0, 0.0, 815.0, 295.0, 165.0, 0.0, 50.0, 550.0, 230.0, 350.0, 535.0, 85.0, 360.0, 300.0, 250.0, 245.0, 30.0, 300.0, 440.0, 740.0, 605.0, 765.0, 45.0, 0.0, 75.0, 595.0, 585.0, 275.0, 580.0, 685.0, 390.0, 290.0, 455.0, 115.0, 115.0, 855.0, 285.0, 70.0, 110.0, 620.0, 605.0, 275.0, 305.0, 190.0, 110.0, 10.0, 130.0, 770.0, 755.0, 335.0, 0.0, 760.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8632898682416255, "mean_inference_ms": 2.0811812527617684, "mean_action_processing_ms": 0.33868377156877527, "mean_env_wait_ms": 0.2651460635217519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005728363990783691, "StateBufferConnector_ms": 0.0031626224517822266, "ViewRequirementAgentConnector_ms": 0.10329878330230713}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2354.0, "episode_return_mean": -268.41, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.6725938000015, "num_env_steps_trained_throughput_per_sec": 74.6725938000015, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 54593.792, "restore_workers_time_ms": 0.017, "training_step_time_ms": 54593.739, "sample_time_ms": 1552.049, "learn_time_ms": 53018.817, "learn_throughput": 75.445, "synch_weights_time_ms": 17.916}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "ed30a_00000", "date": "2024-08-12_14-23-31", "timestamp": 1723487011, "time_this_iter_s": 53.605473041534424, "time_total_s": 437.13312697410583, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010a160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 437.13312697410583, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 43.1578947368421, "ram_util_percent": 83.11842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8678505528856206, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.876507388220893, "policy_loss": -0.00784189622312114, "vf_loss": 7.883182110105242, "vf_explained_var": -4.262703436392325e-05, "kl": 0.007781091509388148, "entropy": 1.5365217407544454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.732307784046445, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.58481318761432, "policy_loss": -0.012942083906653343, "vf_loss": 9.595581996756255, "vf_explained_var": 0.005142535545207836, "kl": 0.014488535468054025, "entropy": 1.4903136723255985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 394.0, "episode_reward_min": -2354.0, "episode_reward_mean": -345.57, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1813.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 935.0}, "policy_reward_mean": {"prey_policy": -487.885, "predator_policy": 315.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.0, 83.0, -409.0, 322.0, -152.0, 205.0, -422.0, -71.0, -576.0, 187.0, -525.0, 394.0, -387.0, 118.0, 146.0, -135.0, -218.0, -158.0, 394.0, 184.0, 65.0, 342.0, -317.0, 301.0, -492.0, -520.0, -248.0, -302.0, -288.0, -192.0, -455.0, -1417.0, 79.0, 172.0, 298.0, -1242.0, -783.0, 218.0, 161.0, -111.0, -1040.0, -362.0, -411.0, -474.0, 85.0, -600.0, -20.0, -132.0, 192.0, -1382.0, 92.0, -825.0, -699.0, 90.0, 340.0, -437.0, -618.0, -431.0, -128.0, 4.0, 29.0, 18.0, -561.0, 310.0, -1071.0, -956.0, -1011.0, -670.0, 124.0, -2354.0, 184.0, -927.0, 12.0, 117.0, 254.0, -1056.0, -2.0, -1777.0, 187.0, -553.0, -283.0, -362.0, -260.0, -1459.0, -745.0, -27.0, -833.0, -1008.0, -574.0, 154.0, -1665.0, -1570.0, -723.0, -570.0, -1029.0, 75.0, 18.0, -261.0, -3.0, -296.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1637.0, -394.0, 79.0, -306.0, -1494.0, 200.0, 145.0, 112.0, -130.0, -482.0, 178.0, -218.0, -1208.0, -64.0, -471.0, 35.0, -1032.0, -559.0, 79.0, -42.0, -86.0, -1054.0, 200.0, 189.0, -746.0, -471.0, -218.0, 101.0, -31.0, 57.0, -900.0, 200.0, -801.0, 68.0, -823.0, 200.0, 189.0, 200.0, 24.0, -20.0, -306.0, 101.0, 178.0, 134.0, -174.0, -768.0, 156.0, 90.0, -229.0, -1043.0, 200.0, -1560.0, -746.0, -42.0, -603.0, -174.0, -306.0, -317.0, -317.0, -185.0, 90.0, -1395.0, -1351.0, -856.0, -207.0, 46.0, -218.0, 200.0, 13.0, 200.0, -999.0, -1153.0, -1362.0, -471.0, -152.0, 200.0, 200.0, -339.0, -328.0, -108.0, -1472.0, -768.0, -647.0, -460.0, -603.0, -603.0, -570.0, -724.0, -152.0, -108.0, -581.0, -449.0, -988.0, 123.0, -757.0, 145.0, 123.0, -196.0, -1230.0, -1032.0, 13.0, -31.0, -713.0, -922.0, -1505.0, -9.0, -526.0, 156.0, 200.0, 90.0, -185.0, -1032.0, -1406.0, -97.0, -592.0, -284.0, -405.0, -273.0, -185.0, -86.0, -911.0, 200.0, -1527.0, 200.0, -1571.0, 200.0, 200.0, 35.0, -1197.0, -1054.0, -823.0, -988.0, -999.0, -1087.0, -460.0, -955.0, -306.0, 200.0, -1802.0, -1692.0, 200.0, -196.0, -724.0, -1428.0, 200.0, -768.0, -328.0, 145.0, -86.0, 200.0, -845.0, -1736.0, -207.0, -130.0, -1142.0, -1395.0, 200.0, -383.0, -515.0, -1263.0, -559.0, -724.0, -295.0, -977.0, -339.0, -251.0, -1285.0, -1714.0, -768.0, -1472.0, -42.0, -185.0, -1109.0, -449.0, -1373.0, -955.0, -1131.0, -218.0, -64.0, 13.0, -1219.0, -1571.0, -1582.0, -1813.0, -251.0, -1582.0, -856.0, -504.0, -713.0, -1626.0, -515.0, 200.0, -240.0, -152.0, -999.0, -152.0, 79.0, -867.0, -944.0, -262.0], "policy_predator_policy_reward": [270.0, 835.0, 135.0, 175.0, 140.0, 745.0, 25.0, 40.0, 295.0, 165.0, 75.0, 170.0, 335.0, 515.0, 80.0, 285.0, 840.0, 175.0, 135.0, 15.0, 585.0, 30.0, 5.0, 0.0, 430.0, 400.0, 5.0, 230.0, 120.0, 0.0, 205.0, 360.0, 95.0, 420.0, 210.0, 255.0, 0.0, 5.0, 100.0, 80.0, 270.0, 0.0, 0.0, 30.0, 460.0, 165.0, 0.0, 55.0, 205.0, 575.0, 760.0, 80.0, 185.0, 355.0, 410.0, 65.0, 0.0, 335.0, 310.0, 0.0, 215.0, 635.0, 790.0, 0.0, 225.0, 15.0, 0.0, 190.0, 15.0, 70.0, 570.0, 340.0, 485.0, 565.0, 135.0, 35.0, 180.0, 120.0, 5.0, 320.0, 440.0, 760.0, 295.0, 450.0, 480.0, 315.0, 470.0, 350.0, 130.0, 215.0, 425.0, 5.0, 330.0, 515.0, 75.0, 405.0, 160.0, 105.0, 655.0, 225.0, 110.0, 0.0, 395.0, 415.0, 0.0, 815.0, 295.0, 165.0, 0.0, 50.0, 550.0, 230.0, 350.0, 535.0, 85.0, 360.0, 300.0, 250.0, 245.0, 30.0, 300.0, 440.0, 740.0, 605.0, 765.0, 45.0, 0.0, 75.0, 595.0, 585.0, 275.0, 580.0, 685.0, 390.0, 290.0, 455.0, 115.0, 115.0, 855.0, 285.0, 70.0, 110.0, 620.0, 605.0, 275.0, 305.0, 190.0, 110.0, 10.0, 130.0, 770.0, 755.0, 335.0, 0.0, 760.0, 0.0, 125.0, 245.0, 545.0, 680.0, 580.0, 420.0, 450.0, 460.0, 205.0, 125.0, 610.0, 930.0, 695.0, 800.0, 200.0, 0.0, 370.0, 355.0, 670.0, 650.0, 475.0, 300.0, 205.0, 0.0, 390.0, 735.0, 935.0, 890.0, 510.0, 600.0, 660.0, 130.0, 595.0, 715.0, 210.0, 180.0, 135.0, 275.0, 300.0, 590.0, 430.0, 355.0, 505.0, 405.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8330124156865051, "mean_inference_ms": 1.9858945805267099, "mean_action_processing_ms": 0.326761802476218, "mean_env_wait_ms": 0.25204265079561355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005134224891662598, "StateBufferConnector_ms": 0.003074049949645996, "ViewRequirementAgentConnector_ms": 0.10186922550201416}, "num_episodes": 22, "episode_return_max": 394.0, "episode_return_min": -2354.0, "episode_return_mean": -345.57, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.78024633213262, "num_env_steps_trained_throughput_per_sec": 76.78024633213262, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 54316.342, "restore_workers_time_ms": 0.017, "training_step_time_ms": 54316.29, "sample_time_ms": 1527.805, "learn_time_ms": 52765.825, "learn_throughput": 75.807, "synch_weights_time_ms": 17.599}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "ed30a_00000", "date": "2024-08-12_14-24-23", "timestamp": 1723487063, "time_this_iter_s": 52.140918016433716, "time_total_s": 489.27404499053955, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0074040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.27404499053955, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 34.518918918918914, "ram_util_percent": 83.12297297297297}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9512333830513021, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.823754240469958, "policy_loss": -0.010727382229798764, "vf_loss": 5.8333316972016025, "vf_explained_var": 4.5502532726873166e-05, "kl": 0.007666230225331566, "entropy": 1.5349754203564276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.91298274669067, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.35924505607161, "policy_loss": -0.014253259900582845, "vf_loss": 9.37173789998211, "vf_explained_var": 0.011608746190550466, "kl": 0.011736089372309471, "entropy": 1.4958741210755848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2354.0, "episode_reward_mean": -359.83, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -523.415, "predator_policy": 343.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [301.0, -492.0, -520.0, -248.0, -302.0, -288.0, -192.0, -455.0, -1417.0, 79.0, 172.0, 298.0, -1242.0, -783.0, 218.0, 161.0, -111.0, -1040.0, -362.0, -411.0, -474.0, 85.0, -600.0, -20.0, -132.0, 192.0, -1382.0, 92.0, -825.0, -699.0, 90.0, 340.0, -437.0, -618.0, -431.0, -128.0, 4.0, 29.0, 18.0, -561.0, 310.0, -1071.0, -956.0, -1011.0, -670.0, 124.0, -2354.0, 184.0, -927.0, 12.0, 117.0, 254.0, -1056.0, -2.0, -1777.0, 187.0, -553.0, -283.0, -362.0, -260.0, -1459.0, -745.0, -27.0, -833.0, -1008.0, -574.0, 154.0, -1665.0, -1570.0, -723.0, -570.0, -1029.0, 75.0, 18.0, -261.0, -3.0, -296.0, -159.0, -112.0, 400.0, -234.0, 400.0, -148.0, 400.0, -171.0, 198.0, -2077.0, -451.0, -503.0, -585.0, -339.0, 32.0, 16.0, -488.0, -9.0, 234.0, 376.0, -488.0, 140.0, 286.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, 90.0, -229.0, -1043.0, 200.0, -1560.0, -746.0, -42.0, -603.0, -174.0, -306.0, -317.0, -317.0, -185.0, 90.0, -1395.0, -1351.0, -856.0, -207.0, 46.0, -218.0, 200.0, 13.0, 200.0, -999.0, -1153.0, -1362.0, -471.0, -152.0, 200.0, 200.0, -339.0, -328.0, -108.0, -1472.0, -768.0, -647.0, -460.0, -603.0, -603.0, -570.0, -724.0, -152.0, -108.0, -581.0, -449.0, -988.0, 123.0, -757.0, 145.0, 123.0, -196.0, -1230.0, -1032.0, 13.0, -31.0, -713.0, -922.0, -1505.0, -9.0, -526.0, 156.0, 200.0, 90.0, -185.0, -1032.0, -1406.0, -97.0, -592.0, -284.0, -405.0, -273.0, -185.0, -86.0, -911.0, 200.0, -1527.0, 200.0, -1571.0, 200.0, 200.0, 35.0, -1197.0, -1054.0, -823.0, -988.0, -999.0, -1087.0, -460.0, -955.0, -306.0, 200.0, -1802.0, -1692.0, 200.0, -196.0, -724.0, -1428.0, 200.0, -768.0, -328.0, 145.0, -86.0, 200.0, -845.0, -1736.0, -207.0, -130.0, -1142.0, -1395.0, 200.0, -383.0, -515.0, -1263.0, -559.0, -724.0, -295.0, -977.0, -339.0, -251.0, -1285.0, -1714.0, -768.0, -1472.0, -42.0, -185.0, -1109.0, -449.0, -1373.0, -955.0, -1131.0, -218.0, -64.0, 13.0, -1219.0, -1571.0, -1582.0, -1813.0, -251.0, -1582.0, -856.0, -504.0, -713.0, -1626.0, -515.0, 200.0, -240.0, -152.0, -999.0, -152.0, 79.0, -867.0, -944.0, -262.0, 200.0, -834.0, -482.0, -350.0, 200.0, 200.0, -1153.0, -251.0, 200.0, 200.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1241.0, -922.0, 200.0, -1857.0, -1670.0, -559.0, -702.0, -1384.0, 46.0, -658.0, -812.0, -625.0, -339.0, -768.0, 200.0, -152.0, -482.0, -1560.0, -218.0, 189.0, -823.0, 200.0, -251.0, 200.0, 156.0, -988.0, -790.0, 200.0, -515.0, 200.0, -9.0], "policy_predator_policy_reward": [0.0, 55.0, 205.0, 575.0, 760.0, 80.0, 185.0, 355.0, 410.0, 65.0, 0.0, 335.0, 310.0, 0.0, 215.0, 635.0, 790.0, 0.0, 225.0, 15.0, 0.0, 190.0, 15.0, 70.0, 570.0, 340.0, 485.0, 565.0, 135.0, 35.0, 180.0, 120.0, 5.0, 320.0, 440.0, 760.0, 295.0, 450.0, 480.0, 315.0, 470.0, 350.0, 130.0, 215.0, 425.0, 5.0, 330.0, 515.0, 75.0, 405.0, 160.0, 105.0, 655.0, 225.0, 110.0, 0.0, 395.0, 415.0, 0.0, 815.0, 295.0, 165.0, 0.0, 50.0, 550.0, 230.0, 350.0, 535.0, 85.0, 360.0, 300.0, 250.0, 245.0, 30.0, 300.0, 440.0, 740.0, 605.0, 765.0, 45.0, 0.0, 75.0, 595.0, 585.0, 275.0, 580.0, 685.0, 390.0, 290.0, 455.0, 115.0, 115.0, 855.0, 285.0, 70.0, 110.0, 620.0, 605.0, 275.0, 305.0, 190.0, 110.0, 10.0, 130.0, 770.0, 755.0, 335.0, 0.0, 760.0, 0.0, 125.0, 245.0, 545.0, 680.0, 580.0, 420.0, 450.0, 460.0, 205.0, 125.0, 610.0, 930.0, 695.0, 800.0, 200.0, 0.0, 370.0, 355.0, 670.0, 650.0, 475.0, 300.0, 205.0, 0.0, 390.0, 735.0, 935.0, 890.0, 510.0, 600.0, 660.0, 130.0, 595.0, 715.0, 210.0, 180.0, 135.0, 275.0, 300.0, 590.0, 430.0, 355.0, 505.0, 405.0, 400.0, 75.0, 285.0, 435.0, 0.0, 0.0, 595.0, 575.0, 0.0, 0.0, 650.0, 870.0, 0.0, 0.0, 325.0, 545.0, 470.0, 450.0, 945.0, 505.0, 415.0, 395.0, 720.0, 115.0, 350.0, 535.0, 280.0, 345.0, 210.0, 390.0, 350.0, 300.0, 680.0, 610.0, 455.0, 170.0, 205.0, 80.0, 20.0, 0.0, 755.0, 535.0, 200.0, 255.0, 95.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.8079582184276163, "mean_inference_ms": 1.90894146897247, "mean_action_processing_ms": 0.3166487404062362, "mean_env_wait_ms": 0.24120996926766927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005038261413574219, "StateBufferConnector_ms": 0.003803849220275879, "ViewRequirementAgentConnector_ms": 0.11078131198883057}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2354.0, "episode_return_mean": -359.83, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.77834962071745, "num_env_steps_trained_throughput_per_sec": 76.77834962071745, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 54094.511, "restore_workers_time_ms": 0.017, "training_step_time_ms": 54094.459, "sample_time_ms": 1497.9, "learn_time_ms": 52574.357, "learn_throughput": 76.083, "synch_weights_time_ms": 17.281}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "ed30a_00000", "date": "2024-08-12_14-25-15", "timestamp": 1723487115, "time_this_iter_s": 52.123790979385376, "time_total_s": 541.3978359699249, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00721f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 541.3978359699249, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.060810810810814, "ram_util_percent": 83.26621621621621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0484195879054448, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.83801455604967, "policy_loss": -0.010951547360382776, "vf_loss": 1.8478156664068737, "vf_explained_var": 4.9025482601589624e-05, "kl": 0.0076695991376800905, "entropy": 1.5126416307908517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.163803388328148, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.173839217897445, "policy_loss": -0.013074166790912391, "vf_loss": 8.185647139725862, "vf_explained_var": 0.018737230540583374, "kl": 0.008441595948836289, "entropy": 1.501928114701831, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2354.0, "episode_reward_mean": -294.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -470.175, "predator_policy": 322.775}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-362.0, -411.0, -474.0, 85.0, -600.0, -20.0, -132.0, 192.0, -1382.0, 92.0, -825.0, -699.0, 90.0, 340.0, -437.0, -618.0, -431.0, -128.0, 4.0, 29.0, 18.0, -561.0, 310.0, -1071.0, -956.0, -1011.0, -670.0, 124.0, -2354.0, 184.0, -927.0, 12.0, 117.0, 254.0, -1056.0, -2.0, -1777.0, 187.0, -553.0, -283.0, -362.0, -260.0, -1459.0, -745.0, -27.0, -833.0, -1008.0, -574.0, 154.0, -1665.0, -1570.0, -723.0, -570.0, -1029.0, 75.0, 18.0, -261.0, -3.0, -296.0, -159.0, -112.0, 400.0, -234.0, 400.0, -148.0, 400.0, -171.0, 198.0, -2077.0, -451.0, -503.0, -585.0, -339.0, 32.0, 16.0, -488.0, -9.0, 234.0, 376.0, -488.0, 140.0, 286.0, 143.0, -235.0, -139.0, 400.0, 202.0, -516.0, 136.0, 311.0, 232.0, 400.0, 289.0, 400.0, -1337.0, 400.0, -500.0, -19.0, 105.0, 370.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-647.0, -460.0, -603.0, -603.0, -570.0, -724.0, -152.0, -108.0, -581.0, -449.0, -988.0, 123.0, -757.0, 145.0, 123.0, -196.0, -1230.0, -1032.0, 13.0, -31.0, -713.0, -922.0, -1505.0, -9.0, -526.0, 156.0, 200.0, 90.0, -185.0, -1032.0, -1406.0, -97.0, -592.0, -284.0, -405.0, -273.0, -185.0, -86.0, -911.0, 200.0, -1527.0, 200.0, -1571.0, 200.0, 200.0, 35.0, -1197.0, -1054.0, -823.0, -988.0, -999.0, -1087.0, -460.0, -955.0, -306.0, 200.0, -1802.0, -1692.0, 200.0, -196.0, -724.0, -1428.0, 200.0, -768.0, -328.0, 145.0, -86.0, 200.0, -845.0, -1736.0, -207.0, -130.0, -1142.0, -1395.0, 200.0, -383.0, -515.0, -1263.0, -559.0, -724.0, -295.0, -977.0, -339.0, -251.0, -1285.0, -1714.0, -768.0, -1472.0, -42.0, -185.0, -1109.0, -449.0, -1373.0, -955.0, -1131.0, -218.0, -64.0, 13.0, -1219.0, -1571.0, -1582.0, -1813.0, -251.0, -1582.0, -856.0, -504.0, -713.0, -1626.0, -515.0, 200.0, -240.0, -152.0, -999.0, -152.0, 79.0, -867.0, -944.0, -262.0, 200.0, -834.0, -482.0, -350.0, 200.0, 200.0, -1153.0, -251.0, 200.0, 200.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1241.0, -922.0, 200.0, -1857.0, -1670.0, -559.0, -702.0, -1384.0, 46.0, -658.0, -812.0, -625.0, -339.0, -768.0, 200.0, -152.0, -482.0, -1560.0, -218.0, 189.0, -823.0, 200.0, -251.0, 200.0, 156.0, -988.0, -790.0, 200.0, -515.0, 200.0, -9.0, 68.0, -130.0, 57.0, -702.0, -306.0, -273.0, 200.0, 200.0, -163.0, 200.0, -548.0, -438.0, -229.0, 145.0, 57.0, 189.0, -108.0, 200.0, 200.0, 200.0, -141.0, 200.0, 200.0, 200.0, -1615.0, -1142.0, 200.0, 200.0, 101.0, -1351.0, -207.0, -97.0, -537.0, 167.0, 200.0, 145.0], "policy_predator_policy_reward": [295.0, 450.0, 480.0, 315.0, 470.0, 350.0, 130.0, 215.0, 425.0, 5.0, 330.0, 515.0, 75.0, 405.0, 160.0, 105.0, 655.0, 225.0, 110.0, 0.0, 395.0, 415.0, 0.0, 815.0, 295.0, 165.0, 0.0, 50.0, 550.0, 230.0, 350.0, 535.0, 85.0, 360.0, 300.0, 250.0, 245.0, 30.0, 300.0, 440.0, 740.0, 605.0, 765.0, 45.0, 0.0, 75.0, 595.0, 585.0, 275.0, 580.0, 685.0, 390.0, 290.0, 455.0, 115.0, 115.0, 855.0, 285.0, 70.0, 110.0, 620.0, 605.0, 275.0, 305.0, 190.0, 110.0, 10.0, 130.0, 770.0, 755.0, 335.0, 0.0, 760.0, 0.0, 125.0, 245.0, 545.0, 680.0, 580.0, 420.0, 450.0, 460.0, 205.0, 125.0, 610.0, 930.0, 695.0, 800.0, 200.0, 0.0, 370.0, 355.0, 670.0, 650.0, 475.0, 300.0, 205.0, 0.0, 390.0, 735.0, 935.0, 890.0, 510.0, 600.0, 660.0, 130.0, 595.0, 715.0, 210.0, 180.0, 135.0, 275.0, 300.0, 590.0, 430.0, 355.0, 505.0, 405.0, 400.0, 75.0, 285.0, 435.0, 0.0, 0.0, 595.0, 575.0, 0.0, 0.0, 650.0, 870.0, 0.0, 0.0, 325.0, 545.0, 470.0, 450.0, 945.0, 505.0, 415.0, 395.0, 720.0, 115.0, 350.0, 535.0, 280.0, 345.0, 210.0, 390.0, 350.0, 300.0, 680.0, 610.0, 455.0, 170.0, 205.0, 80.0, 20.0, 0.0, 755.0, 535.0, 200.0, 255.0, 95.0, 0.0, 0.0, 205.0, 0.0, 410.0, 215.0, 225.0, 0.0, 0.0, 0.0, 165.0, 295.0, 175.0, 195.0, 25.0, 0.0, 65.0, 0.0, 140.0, 0.0, 0.0, 155.0, 75.0, 0.0, 0.0, 845.0, 575.0, 0.0, 0.0, 45.0, 705.0, 235.0, 50.0, 335.0, 140.0, 25.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7943304687849896, "mean_inference_ms": 1.863309434402142, "mean_action_processing_ms": 0.31063483187862045, "mean_env_wait_ms": 0.23474581823846843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004735469818115234, "StateBufferConnector_ms": 0.0037605762481689453, "ViewRequirementAgentConnector_ms": 0.10923457145690918}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2354.0, "episode_return_mean": -294.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.46562053117904, "num_env_steps_trained_throughput_per_sec": 77.46562053117904, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 53154.902, "restore_workers_time_ms": 0.016, "training_step_time_ms": 53154.852, "sample_time_ms": 1407.243, "learn_time_ms": 51726.296, "learn_throughput": 77.33, "synch_weights_time_ms": 16.9}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "ed30a_00000", "date": "2024-08-12_14-26-07", "timestamp": 1723487167, "time_this_iter_s": 51.6714141368866, "time_total_s": 593.0692501068115, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 593.0692501068115, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 35.735135135135145, "ram_util_percent": 83.30135135135137}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.062606353766073, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.060355573577225, "policy_loss": -0.00805633642646686, "vf_loss": 1.0676913754334525, "vf_explained_var": 9.181546786474803e-05, "kl": 0.004803559806285713, "entropy": 1.5291740143109882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.209775994883643, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.924070997591372, "policy_loss": -0.010832215091164308, "vf_loss": 5.933725549052001, "vf_explained_var": 0.01800610646999702, "kl": 0.007851130639427861, "entropy": 1.4833013735750995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2354.0, "episode_reward_mean": -199.95, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -383.275, "predator_policy": 283.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.0, 29.0, 18.0, -561.0, 310.0, -1071.0, -956.0, -1011.0, -670.0, 124.0, -2354.0, 184.0, -927.0, 12.0, 117.0, 254.0, -1056.0, -2.0, -1777.0, 187.0, -553.0, -283.0, -362.0, -260.0, -1459.0, -745.0, -27.0, -833.0, -1008.0, -574.0, 154.0, -1665.0, -1570.0, -723.0, -570.0, -1029.0, 75.0, 18.0, -261.0, -3.0, -296.0, -159.0, -112.0, 400.0, -234.0, 400.0, -148.0, 400.0, -171.0, 198.0, -2077.0, -451.0, -503.0, -585.0, -339.0, 32.0, 16.0, -488.0, -9.0, 234.0, 376.0, -488.0, 140.0, 286.0, 143.0, -235.0, -139.0, 400.0, 202.0, -516.0, 136.0, 311.0, 232.0, 400.0, 289.0, 400.0, -1337.0, 400.0, -500.0, -19.0, 105.0, 370.0, -21.0, 334.0, -251.0, 400.0, 190.0, 77.0, 400.0, -107.0, 328.0, 87.0, -44.0, 382.0, 224.0, 400.0, 340.0, 388.0, 394.0, 244.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-185.0, -86.0, -911.0, 200.0, -1527.0, 200.0, -1571.0, 200.0, 200.0, 35.0, -1197.0, -1054.0, -823.0, -988.0, -999.0, -1087.0, -460.0, -955.0, -306.0, 200.0, -1802.0, -1692.0, 200.0, -196.0, -724.0, -1428.0, 200.0, -768.0, -328.0, 145.0, -86.0, 200.0, -845.0, -1736.0, -207.0, -130.0, -1142.0, -1395.0, 200.0, -383.0, -515.0, -1263.0, -559.0, -724.0, -295.0, -977.0, -339.0, -251.0, -1285.0, -1714.0, -768.0, -1472.0, -42.0, -185.0, -1109.0, -449.0, -1373.0, -955.0, -1131.0, -218.0, -64.0, 13.0, -1219.0, -1571.0, -1582.0, -1813.0, -251.0, -1582.0, -856.0, -504.0, -713.0, -1626.0, -515.0, 200.0, -240.0, -152.0, -999.0, -152.0, 79.0, -867.0, -944.0, -262.0, 200.0, -834.0, -482.0, -350.0, 200.0, 200.0, -1153.0, -251.0, 200.0, 200.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1241.0, -922.0, 200.0, -1857.0, -1670.0, -559.0, -702.0, -1384.0, 46.0, -658.0, -812.0, -625.0, -339.0, -768.0, 200.0, -152.0, -482.0, -1560.0, -218.0, 189.0, -823.0, 200.0, -251.0, 200.0, 156.0, -988.0, -790.0, 200.0, -515.0, 200.0, -9.0, 68.0, -130.0, 57.0, -702.0, -306.0, -273.0, 200.0, 200.0, -163.0, 200.0, -548.0, -438.0, -229.0, 145.0, 57.0, 189.0, -108.0, 200.0, 200.0, 200.0, -141.0, 200.0, 200.0, 200.0, -1615.0, -1142.0, 200.0, 200.0, 101.0, -1351.0, -207.0, -97.0, -537.0, 167.0, 200.0, 145.0, -97.0, -284.0, 101.0, 178.0, -1076.0, 200.0, 200.0, 200.0, -185.0, 200.0, 90.0, -218.0, 200.0, 200.0, 24.0, -416.0, 189.0, 79.0, -108.0, -20.0, -64.0, -185.0, 200.0, 167.0, -108.0, 112.0, 200.0, 200.0, 200.0, 90.0, 200.0, 178.0, 200.0, 189.0, -9.0, 123.0], "policy_predator_policy_reward": [245.0, 30.0, 300.0, 440.0, 740.0, 605.0, 765.0, 45.0, 0.0, 75.0, 595.0, 585.0, 275.0, 580.0, 685.0, 390.0, 290.0, 455.0, 115.0, 115.0, 855.0, 285.0, 70.0, 110.0, 620.0, 605.0, 275.0, 305.0, 190.0, 110.0, 10.0, 130.0, 770.0, 755.0, 335.0, 0.0, 760.0, 0.0, 125.0, 245.0, 545.0, 680.0, 580.0, 420.0, 450.0, 460.0, 205.0, 125.0, 610.0, 930.0, 695.0, 800.0, 200.0, 0.0, 370.0, 355.0, 670.0, 650.0, 475.0, 300.0, 205.0, 0.0, 390.0, 735.0, 935.0, 890.0, 510.0, 600.0, 660.0, 130.0, 595.0, 715.0, 210.0, 180.0, 135.0, 275.0, 300.0, 590.0, 430.0, 355.0, 505.0, 405.0, 400.0, 75.0, 285.0, 435.0, 0.0, 0.0, 595.0, 575.0, 0.0, 0.0, 650.0, 870.0, 0.0, 0.0, 325.0, 545.0, 470.0, 450.0, 945.0, 505.0, 415.0, 395.0, 720.0, 115.0, 350.0, 535.0, 280.0, 345.0, 210.0, 390.0, 350.0, 300.0, 680.0, 610.0, 455.0, 170.0, 205.0, 80.0, 20.0, 0.0, 755.0, 535.0, 200.0, 255.0, 95.0, 0.0, 0.0, 205.0, 0.0, 410.0, 215.0, 225.0, 0.0, 0.0, 0.0, 165.0, 295.0, 175.0, 195.0, 25.0, 0.0, 65.0, 0.0, 140.0, 0.0, 0.0, 155.0, 75.0, 0.0, 0.0, 845.0, 575.0, 0.0, 0.0, 45.0, 705.0, 235.0, 50.0, 335.0, 140.0, 25.0, 0.0, 30.0, 330.0, 55.0, 0.0, 145.0, 480.0, 0.0, 0.0, 175.0, 0.0, 50.0, 155.0, 0.0, 0.0, 285.0, 0.0, 5.0, 55.0, 0.0, 215.0, 195.0, 10.0, 10.0, 5.0, 80.0, 140.0, 0.0, 0.0, 0.0, 50.0, 10.0, 0.0, 5.0, 0.0, 35.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7834397905359876, "mean_inference_ms": 1.8246719250196453, "mean_action_processing_ms": 0.3056880813718657, "mean_env_wait_ms": 0.22902165186740434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047054290771484375, "StateBufferConnector_ms": 0.004355430603027344, "ViewRequirementAgentConnector_ms": 0.10389208793640137}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2354.0, "episode_return_mean": -199.95, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.99451003261144, "num_env_steps_trained_throughput_per_sec": 77.99451003261144, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 52799.236, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52799.187, "sample_time_ms": 1395.928, "learn_time_ms": 51382.315, "learn_throughput": 77.848, "synch_weights_time_ms": 16.436}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "ed30a_00000", "date": "2024-08-12_14-26-58", "timestamp": 1723487218, "time_this_iter_s": 51.32487082481384, "time_total_s": 644.3941209316254, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 644.3941209316254, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 32.97361111111112, "ram_util_percent": 83.32361111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.06212955278852, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1392763901324499, "policy_loss": -0.012762125403861757, "vf_loss": 1.1509800908111392, "vf_explained_var": 0.00011960157641658076, "kl": 0.014112298425792001, "entropy": 1.5263440711788399, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.096476966678782, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.440423191665972, "policy_loss": -0.014504645333167107, "vf_loss": 4.453516819741991, "vf_explained_var": 0.014199927433457955, "kl": 0.009406778907375863, "entropy": 1.4232415064932809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2077.0, "episode_reward_mean": -86.87, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -274.76, "predator_policy": 231.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1777.0, 187.0, -553.0, -283.0, -362.0, -260.0, -1459.0, -745.0, -27.0, -833.0, -1008.0, -574.0, 154.0, -1665.0, -1570.0, -723.0, -570.0, -1029.0, 75.0, 18.0, -261.0, -3.0, -296.0, -159.0, -112.0, 400.0, -234.0, 400.0, -148.0, 400.0, -171.0, 198.0, -2077.0, -451.0, -503.0, -585.0, -339.0, 32.0, 16.0, -488.0, -9.0, 234.0, 376.0, -488.0, 140.0, 286.0, 143.0, -235.0, -139.0, 400.0, 202.0, -516.0, 136.0, 311.0, 232.0, 400.0, 289.0, 400.0, -1337.0, 400.0, -500.0, -19.0, 105.0, 370.0, -21.0, 334.0, -251.0, 400.0, 190.0, 77.0, 400.0, -107.0, 328.0, 87.0, -44.0, 382.0, 224.0, 400.0, 340.0, 388.0, 394.0, 244.0, 389.0, -280.0, 220.0, 364.0, 116.0, 364.0, -114.0, 214.0, 361.0, 358.0, -359.0, 52.0, 400.0, 334.0, 400.0, 400.0, 181.0, 352.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1142.0, -1395.0, 200.0, -383.0, -515.0, -1263.0, -559.0, -724.0, -295.0, -977.0, -339.0, -251.0, -1285.0, -1714.0, -768.0, -1472.0, -42.0, -185.0, -1109.0, -449.0, -1373.0, -955.0, -1131.0, -218.0, -64.0, 13.0, -1219.0, -1571.0, -1582.0, -1813.0, -251.0, -1582.0, -856.0, -504.0, -713.0, -1626.0, -515.0, 200.0, -240.0, -152.0, -999.0, -152.0, 79.0, -867.0, -944.0, -262.0, 200.0, -834.0, -482.0, -350.0, 200.0, 200.0, -1153.0, -251.0, 200.0, 200.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1241.0, -922.0, 200.0, -1857.0, -1670.0, -559.0, -702.0, -1384.0, 46.0, -658.0, -812.0, -625.0, -339.0, -768.0, 200.0, -152.0, -482.0, -1560.0, -218.0, 189.0, -823.0, 200.0, -251.0, 200.0, 156.0, -988.0, -790.0, 200.0, -515.0, 200.0, -9.0, 68.0, -130.0, 57.0, -702.0, -306.0, -273.0, 200.0, 200.0, -163.0, 200.0, -548.0, -438.0, -229.0, 145.0, 57.0, 189.0, -108.0, 200.0, 200.0, 200.0, -141.0, 200.0, 200.0, 200.0, -1615.0, -1142.0, 200.0, 200.0, 101.0, -1351.0, -207.0, -97.0, -537.0, 167.0, 200.0, 145.0, -97.0, -284.0, 101.0, 178.0, -1076.0, 200.0, 200.0, 200.0, -185.0, 200.0, 90.0, -218.0, 200.0, 200.0, 24.0, -416.0, 189.0, 79.0, -108.0, -20.0, -64.0, -185.0, 200.0, 167.0, -108.0, 112.0, 200.0, 200.0, 200.0, 90.0, 200.0, 178.0, 200.0, 189.0, -9.0, 123.0, 79.0, 200.0, -97.0, -658.0, -130.0, 200.0, 79.0, 200.0, 2.0, 24.0, 134.0, 200.0, 2.0, -416.0, -141.0, 200.0, 101.0, 200.0, 200.0, 123.0, -251.0, -383.0, 35.0, -218.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, 200.0, -284.0, 200.0, 112.0, 200.0], "policy_predator_policy_reward": [760.0, 0.0, 125.0, 245.0, 545.0, 680.0, 580.0, 420.0, 450.0, 460.0, 205.0, 125.0, 610.0, 930.0, 695.0, 800.0, 200.0, 0.0, 370.0, 355.0, 670.0, 650.0, 475.0, 300.0, 205.0, 0.0, 390.0, 735.0, 935.0, 890.0, 510.0, 600.0, 660.0, 130.0, 595.0, 715.0, 210.0, 180.0, 135.0, 275.0, 300.0, 590.0, 430.0, 355.0, 505.0, 405.0, 400.0, 75.0, 285.0, 435.0, 0.0, 0.0, 595.0, 575.0, 0.0, 0.0, 650.0, 870.0, 0.0, 0.0, 325.0, 545.0, 470.0, 450.0, 945.0, 505.0, 415.0, 395.0, 720.0, 115.0, 350.0, 535.0, 280.0, 345.0, 210.0, 390.0, 350.0, 300.0, 680.0, 610.0, 455.0, 170.0, 205.0, 80.0, 20.0, 0.0, 755.0, 535.0, 200.0, 255.0, 95.0, 0.0, 0.0, 205.0, 0.0, 410.0, 215.0, 225.0, 0.0, 0.0, 0.0, 165.0, 295.0, 175.0, 195.0, 25.0, 0.0, 65.0, 0.0, 140.0, 0.0, 0.0, 155.0, 75.0, 0.0, 0.0, 845.0, 575.0, 0.0, 0.0, 45.0, 705.0, 235.0, 50.0, 335.0, 140.0, 25.0, 0.0, 30.0, 330.0, 55.0, 0.0, 145.0, 480.0, 0.0, 0.0, 175.0, 0.0, 50.0, 155.0, 0.0, 0.0, 285.0, 0.0, 5.0, 55.0, 0.0, 215.0, 195.0, 10.0, 10.0, 5.0, 80.0, 140.0, 0.0, 0.0, 0.0, 50.0, 10.0, 0.0, 5.0, 0.0, 35.0, 95.0, 55.0, 55.0, 250.0, 225.0, 0.0, 150.0, 40.0, 45.0, 90.0, 0.0, 30.0, 0.0, 300.0, 0.0, 30.0, 125.0, 15.0, 45.0, 0.0, 35.0, 0.0, 275.0, 235.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 55.0, 210.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7742648863548183, "mean_inference_ms": 1.7938041603948052, "mean_action_processing_ms": 0.3015180106102058, "mean_env_wait_ms": 0.22424198413773838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004333138465881348, "StateBufferConnector_ms": 0.00432276725769043, "ViewRequirementAgentConnector_ms": 0.10218524932861328}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2077.0, "episode_return_mean": -86.87, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.82554857438262, "num_env_steps_trained_throughput_per_sec": 76.82554857438262, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 52528.306, "restore_workers_time_ms": 0.015, "training_step_time_ms": 52528.256, "sample_time_ms": 1226.239, "learn_time_ms": 51280.21, "learn_throughput": 78.003, "synch_weights_time_ms": 17.105}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "ed30a_00000", "date": "2024-08-12_14-27-50", "timestamp": 1723487270, "time_this_iter_s": 52.11635994911194, "time_total_s": 696.5104808807373, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00723a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 696.5104808807373, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 35.74594594594595, "ram_util_percent": 83.05675675675676}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0640985579362938, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4412135980116627, "policy_loss": -0.008382112358908646, "vf_loss": 0.44914398135380773, "vf_explained_var": -0.0008548689582360485, "kl": 0.00602303268743146, "entropy": 1.5206986913605343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.55035422479034, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.553669449261257, "policy_loss": -0.005432568403039738, "vf_loss": 2.558519854810503, "vf_explained_var": 0.014937706378401902, "kl": 0.003881045799112168, "entropy": 1.4427201156262999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2077.0, "episode_reward_mean": 126.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1868.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -67.905, "predator_policy": 131.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -148.0, 400.0, -171.0, 198.0, -2077.0, -451.0, -503.0, -585.0, -339.0, 32.0, 16.0, -488.0, -9.0, 234.0, 376.0, -488.0, 140.0, 286.0, 143.0, -235.0, -139.0, 400.0, 202.0, -516.0, 136.0, 311.0, 232.0, 400.0, 289.0, 400.0, -1337.0, 400.0, -500.0, -19.0, 105.0, 370.0, -21.0, 334.0, -251.0, 400.0, 190.0, 77.0, 400.0, -107.0, 328.0, 87.0, -44.0, 382.0, 224.0, 400.0, 340.0, 388.0, 394.0, 244.0, 389.0, -280.0, 220.0, 364.0, 116.0, 364.0, -114.0, 214.0, 361.0, 358.0, -359.0, 52.0, 400.0, 334.0, 400.0, 400.0, 181.0, 352.0, 295.0, 400.0, 268.0, 374.0, 334.0, 400.0, 262.0, 129.0, 394.0, 400.0, 368.0, 97.0, 329.0, 366.0, 388.0, 10.0, 292.0, 400.0, 5.0, 400.0, 340.0, -200.0, 334.0, 358.0, 94.0, 400.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -1868.0, 200.0, 200.0, 200.0, 200.0, -1241.0, -922.0, 200.0, -1857.0, -1670.0, -559.0, -702.0, -1384.0, 46.0, -658.0, -812.0, -625.0, -339.0, -768.0, 200.0, -152.0, -482.0, -1560.0, -218.0, 189.0, -823.0, 200.0, -251.0, 200.0, 156.0, -988.0, -790.0, 200.0, -515.0, 200.0, -9.0, 68.0, -130.0, 57.0, -702.0, -306.0, -273.0, 200.0, 200.0, -163.0, 200.0, -548.0, -438.0, -229.0, 145.0, 57.0, 189.0, -108.0, 200.0, 200.0, 200.0, -141.0, 200.0, 200.0, 200.0, -1615.0, -1142.0, 200.0, 200.0, 101.0, -1351.0, -207.0, -97.0, -537.0, 167.0, 200.0, 145.0, -97.0, -284.0, 101.0, 178.0, -1076.0, 200.0, 200.0, 200.0, -185.0, 200.0, 90.0, -218.0, 200.0, 200.0, 24.0, -416.0, 189.0, 79.0, -108.0, -20.0, -64.0, -185.0, 200.0, 167.0, -108.0, 112.0, 200.0, 200.0, 200.0, 90.0, 200.0, 178.0, 200.0, 189.0, -9.0, 123.0, 79.0, 200.0, -97.0, -658.0, -130.0, 200.0, 79.0, 200.0, 2.0, 24.0, 134.0, 200.0, 2.0, -416.0, -141.0, 200.0, 101.0, 200.0, 200.0, 123.0, -251.0, -383.0, 35.0, -218.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, 200.0, -284.0, 200.0, 112.0, 200.0, -240.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, 79.0, 200.0, 79.0, 200.0, 200.0, 189.0, -42.0, -9.0, 13.0, 189.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, -152.0, 123.0, 156.0, 101.0, 200.0, 200.0, 178.0, -317.0, 2.0, 2.0, 200.0, 200.0, 200.0, -372.0, 112.0, 200.0, 200.0, 200.0, 90.0, -152.0, -493.0, 200.0, 79.0, 200.0, 123.0, -86.0, -75.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 650.0, 870.0, 0.0, 0.0, 325.0, 545.0, 470.0, 450.0, 945.0, 505.0, 415.0, 395.0, 720.0, 115.0, 350.0, 535.0, 280.0, 345.0, 210.0, 390.0, 350.0, 300.0, 680.0, 610.0, 455.0, 170.0, 205.0, 80.0, 20.0, 0.0, 755.0, 535.0, 200.0, 255.0, 95.0, 0.0, 0.0, 205.0, 0.0, 410.0, 215.0, 225.0, 0.0, 0.0, 0.0, 165.0, 295.0, 175.0, 195.0, 25.0, 0.0, 65.0, 0.0, 140.0, 0.0, 0.0, 155.0, 75.0, 0.0, 0.0, 845.0, 575.0, 0.0, 0.0, 45.0, 705.0, 235.0, 50.0, 335.0, 140.0, 25.0, 0.0, 30.0, 330.0, 55.0, 0.0, 145.0, 480.0, 0.0, 0.0, 175.0, 0.0, 50.0, 155.0, 0.0, 0.0, 285.0, 0.0, 5.0, 55.0, 0.0, 215.0, 195.0, 10.0, 10.0, 5.0, 80.0, 140.0, 0.0, 0.0, 0.0, 50.0, 10.0, 0.0, 5.0, 0.0, 35.0, 95.0, 55.0, 55.0, 250.0, 225.0, 0.0, 150.0, 40.0, 45.0, 90.0, 0.0, 30.0, 0.0, 300.0, 0.0, 30.0, 125.0, 15.0, 45.0, 0.0, 35.0, 0.0, 275.0, 235.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 55.0, 210.0, 0.0, 40.0, 195.0, 140.0, 0.0, 0.0, 0.0, 110.0, 40.0, 55.0, 55.0, 0.0, 0.0, 0.0, 110.0, 5.0, 85.0, 40.0, 0.0, 5.0, 0.0, 0.0, 10.0, 35.0, 0.0, 170.0, 40.0, 10.0, 45.0, 20.0, 10.0, 0.0, 0.0, 325.0, 75.0, 15.0, 0.0, 0.0, 265.0, 0.0, 0.0, 0.0, 50.0, 0.0, 215.0, 230.0, 0.0, 55.0, 0.0, 35.0, 10.0, 245.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7590728442333317, "mean_inference_ms": 1.7560509896089271, "mean_action_processing_ms": 0.29533121217435904, "mean_env_wait_ms": 0.2182146418345846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00442957878112793, "StateBufferConnector_ms": 0.004346370697021484, "ViewRequirementAgentConnector_ms": 0.10380947589874268}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": -2077.0, "episode_return_mean": 126.19, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.37990542897808, "num_env_steps_trained_throughput_per_sec": 75.37990542897808, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 52431.375, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52431.327, "sample_time_ms": 1241.883, "learn_time_ms": 51168.168, "learn_throughput": 78.174, "synch_weights_time_ms": 17.234}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "ed30a_00000", "date": "2024-08-12_14-28-43", "timestamp": 1723487323, "time_this_iter_s": 53.09821009635925, "time_total_s": 749.6086909770966, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 749.6086909770966, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 44.312000000000005, "ram_util_percent": 83.35999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2097398147617697, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3417373721404051, "policy_loss": -0.00823679709851387, "vf_loss": 1.3490146272239232, "vf_explained_var": 0.0005131910402308065, "kl": 0.012793869059856106, "entropy": 1.4853622409401748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.891081950841127, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.573127770045447, "policy_loss": -0.012306525830731347, "vf_loss": 1.5845024236295588, "vf_explained_var": 0.018735590939799315, "kl": 0.012424904107832292, "entropy": 1.3915367812075943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1337.0, "episode_reward_mean": 211.4, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1615.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 845.0}, "policy_reward_mean": {"prey_policy": 27.575, "predator_policy": 78.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.0, 143.0, -235.0, -139.0, 400.0, 202.0, -516.0, 136.0, 311.0, 232.0, 400.0, 289.0, 400.0, -1337.0, 400.0, -500.0, -19.0, 105.0, 370.0, -21.0, 334.0, -251.0, 400.0, 190.0, 77.0, 400.0, -107.0, 328.0, 87.0, -44.0, 382.0, 224.0, 400.0, 340.0, 388.0, 394.0, 244.0, 389.0, -280.0, 220.0, 364.0, 116.0, 364.0, -114.0, 214.0, 361.0, 358.0, -359.0, 52.0, 400.0, 334.0, 400.0, 400.0, 181.0, 352.0, 295.0, 400.0, 268.0, 374.0, 334.0, 400.0, 262.0, 129.0, 394.0, 400.0, 368.0, 97.0, 329.0, 366.0, 388.0, 10.0, 292.0, 400.0, 5.0, 400.0, 340.0, -200.0, 334.0, 358.0, 94.0, 400.0, 400.0, 184.0, 400.0, 346.0, 325.0, 359.0, 400.0, 400.0, -314.0, 297.0, 184.0, 329.0, 379.0, 263.0, 302.0, 358.0, 190.0, 280.0, 376.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -9.0, 68.0, -130.0, 57.0, -702.0, -306.0, -273.0, 200.0, 200.0, -163.0, 200.0, -548.0, -438.0, -229.0, 145.0, 57.0, 189.0, -108.0, 200.0, 200.0, 200.0, -141.0, 200.0, 200.0, 200.0, -1615.0, -1142.0, 200.0, 200.0, 101.0, -1351.0, -207.0, -97.0, -537.0, 167.0, 200.0, 145.0, -97.0, -284.0, 101.0, 178.0, -1076.0, 200.0, 200.0, 200.0, -185.0, 200.0, 90.0, -218.0, 200.0, 200.0, 24.0, -416.0, 189.0, 79.0, -108.0, -20.0, -64.0, -185.0, 200.0, 167.0, -108.0, 112.0, 200.0, 200.0, 200.0, 90.0, 200.0, 178.0, 200.0, 189.0, -9.0, 123.0, 79.0, 200.0, -97.0, -658.0, -130.0, 200.0, 79.0, 200.0, 2.0, 24.0, 134.0, 200.0, 2.0, -416.0, -141.0, 200.0, 101.0, 200.0, 200.0, 123.0, -251.0, -383.0, 35.0, -218.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, 200.0, -284.0, 200.0, 112.0, 200.0, -240.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, 79.0, 200.0, 79.0, 200.0, 200.0, 189.0, -42.0, -9.0, 13.0, 189.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, -152.0, 123.0, 156.0, 101.0, 200.0, 200.0, 178.0, -317.0, 2.0, 2.0, 200.0, 200.0, 200.0, -372.0, 112.0, 200.0, 200.0, 200.0, 90.0, -152.0, -493.0, 200.0, 79.0, 200.0, 123.0, -86.0, -75.0, 200.0, 200.0, 200.0, 200.0, -130.0, 134.0, 200.0, 200.0, 101.0, 200.0, 200.0, -20.0, 189.0, 145.0, 200.0, 200.0, 200.0, 200.0, -1307.0, 178.0, 200.0, -108.0, 145.0, -141.0, -141.0, 200.0, 200.0, 134.0, -152.0, 200.0, 13.0, 189.0, 123.0, 200.0, -53.0, 68.0, 90.0, 90.0, 200.0, 156.0], "policy_predator_policy_reward": [95.0, 0.0, 0.0, 205.0, 0.0, 410.0, 215.0, 225.0, 0.0, 0.0, 0.0, 165.0, 295.0, 175.0, 195.0, 25.0, 0.0, 65.0, 0.0, 140.0, 0.0, 0.0, 155.0, 75.0, 0.0, 0.0, 845.0, 575.0, 0.0, 0.0, 45.0, 705.0, 235.0, 50.0, 335.0, 140.0, 25.0, 0.0, 30.0, 330.0, 55.0, 0.0, 145.0, 480.0, 0.0, 0.0, 175.0, 0.0, 50.0, 155.0, 0.0, 0.0, 285.0, 0.0, 5.0, 55.0, 0.0, 215.0, 195.0, 10.0, 10.0, 5.0, 80.0, 140.0, 0.0, 0.0, 0.0, 50.0, 10.0, 0.0, 5.0, 0.0, 35.0, 95.0, 55.0, 55.0, 250.0, 225.0, 0.0, 150.0, 40.0, 45.0, 90.0, 0.0, 30.0, 0.0, 300.0, 0.0, 30.0, 125.0, 15.0, 45.0, 0.0, 35.0, 0.0, 275.0, 235.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 55.0, 210.0, 0.0, 40.0, 195.0, 140.0, 0.0, 0.0, 0.0, 110.0, 40.0, 55.0, 55.0, 0.0, 0.0, 0.0, 110.0, 5.0, 85.0, 40.0, 0.0, 5.0, 0.0, 0.0, 10.0, 35.0, 0.0, 170.0, 40.0, 10.0, 45.0, 20.0, 10.0, 0.0, 0.0, 325.0, 75.0, 15.0, 0.0, 0.0, 265.0, 0.0, 0.0, 0.0, 50.0, 0.0, 215.0, 230.0, 0.0, 55.0, 0.0, 35.0, 10.0, 245.0, 0.0, 0.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 45.0, 0.0, 45.0, 100.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 545.0, 270.0, 125.0, 80.0, 125.0, 55.0, 145.0, 125.0, 30.0, 15.0, 100.0, 115.0, 15.0, 85.0, 0.0, 35.0, 100.0, 75.0, 50.0, 50.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7540355764976772, "mean_inference_ms": 1.7321819314225326, "mean_action_processing_ms": 0.29257965590087776, "mean_env_wait_ms": 0.21523701087710242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037453174591064453, "StateBufferConnector_ms": 0.0036116838455200195, "ViewRequirementAgentConnector_ms": 0.09339940547943115}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1337.0, "episode_return_mean": 211.4, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.8427826345581, "num_env_steps_trained_throughput_per_sec": 75.8427826345581, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 52291.547, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52291.499, "sample_time_ms": 1228.226, "learn_time_ms": 51042.658, "learn_throughput": 78.366, "synch_weights_time_ms": 16.754}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "ed30a_00000", "date": "2024-08-12_14-29-36", "timestamp": 1723487376, "time_this_iter_s": 52.79704809188843, "time_total_s": 802.405739068985, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1270430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 802.405739068985, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.946666666666665, "ram_util_percent": 83.08000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2146400354684346, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0561683701144324, "policy_loss": -0.006657349971916388, "vf_loss": 1.0622258885748803, "vf_explained_var": 0.00015938480695088704, "kl": 0.007997714406386367, "entropy": 1.4901661516497375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.887703842460795, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0823644801264718, "policy_loss": -0.00931290788656081, "vf_loss": 1.0910875651886853, "vf_explained_var": 0.027978830898880327, "kl": 0.007864251299983, "entropy": 1.3862270456142527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -359.0, "episode_reward_mean": 257.64, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1307.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 67.12, "predator_policy": 61.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, -21.0, 334.0, -251.0, 400.0, 190.0, 77.0, 400.0, -107.0, 328.0, 87.0, -44.0, 382.0, 224.0, 400.0, 340.0, 388.0, 394.0, 244.0, 389.0, -280.0, 220.0, 364.0, 116.0, 364.0, -114.0, 214.0, 361.0, 358.0, -359.0, 52.0, 400.0, 334.0, 400.0, 400.0, 181.0, 352.0, 295.0, 400.0, 268.0, 374.0, 334.0, 400.0, 262.0, 129.0, 394.0, 400.0, 368.0, 97.0, 329.0, 366.0, 388.0, 10.0, 292.0, 400.0, 5.0, 400.0, 340.0, -200.0, 334.0, 358.0, 94.0, 400.0, 400.0, 184.0, 400.0, 346.0, 325.0, 359.0, 400.0, 400.0, -314.0, 297.0, 184.0, 329.0, 379.0, 263.0, 302.0, 358.0, 190.0, 280.0, 376.0, 328.0, 394.0, 346.0, 117.0, 380.0, 322.0, 226.0, 196.0, 232.0, 364.0, 400.0, 305.0, 238.0, 202.0, 184.0, 244.0, 400.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 145.0, -97.0, -284.0, 101.0, 178.0, -1076.0, 200.0, 200.0, 200.0, -185.0, 200.0, 90.0, -218.0, 200.0, 200.0, 24.0, -416.0, 189.0, 79.0, -108.0, -20.0, -64.0, -185.0, 200.0, 167.0, -108.0, 112.0, 200.0, 200.0, 200.0, 90.0, 200.0, 178.0, 200.0, 189.0, -9.0, 123.0, 79.0, 200.0, -97.0, -658.0, -130.0, 200.0, 79.0, 200.0, 2.0, 24.0, 134.0, 200.0, 2.0, -416.0, -141.0, 200.0, 101.0, 200.0, 200.0, 123.0, -251.0, -383.0, 35.0, -218.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, 200.0, -284.0, 200.0, 112.0, 200.0, -240.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, 79.0, 200.0, 79.0, 200.0, 200.0, 189.0, -42.0, -9.0, 13.0, 189.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, -152.0, 123.0, 156.0, 101.0, 200.0, 200.0, 178.0, -317.0, 2.0, 2.0, 200.0, 200.0, 200.0, -372.0, 112.0, 200.0, 200.0, 200.0, 90.0, -152.0, -493.0, 200.0, 79.0, 200.0, 123.0, -86.0, -75.0, 200.0, 200.0, 200.0, 200.0, -130.0, 134.0, 200.0, 200.0, 101.0, 200.0, 200.0, -20.0, 189.0, 145.0, 200.0, 200.0, 200.0, 200.0, -1307.0, 178.0, 200.0, -108.0, 145.0, -141.0, -141.0, 200.0, 200.0, 134.0, -152.0, 200.0, 13.0, 189.0, 123.0, 200.0, -53.0, 68.0, 90.0, 90.0, 200.0, 156.0, 35.0, 178.0, 200.0, 189.0, 101.0, 200.0, 200.0, -328.0, 200.0, 90.0, 57.0, 200.0, 46.0, 35.0, 101.0, -75.0, -108.0, 200.0, 200.0, 134.0, 200.0, 200.0, -108.0, 178.0, 2.0, 101.0, -218.0, 145.0, -196.0, 200.0, 79.0, 35.0, 200.0, 200.0, 200.0, 24.0], "policy_predator_policy_reward": [25.0, 0.0, 30.0, 330.0, 55.0, 0.0, 145.0, 480.0, 0.0, 0.0, 175.0, 0.0, 50.0, 155.0, 0.0, 0.0, 285.0, 0.0, 5.0, 55.0, 0.0, 215.0, 195.0, 10.0, 10.0, 5.0, 80.0, 140.0, 0.0, 0.0, 0.0, 50.0, 10.0, 0.0, 5.0, 0.0, 35.0, 95.0, 55.0, 55.0, 250.0, 225.0, 0.0, 150.0, 40.0, 45.0, 90.0, 0.0, 30.0, 0.0, 300.0, 0.0, 30.0, 125.0, 15.0, 45.0, 0.0, 35.0, 0.0, 275.0, 235.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 55.0, 210.0, 0.0, 40.0, 195.0, 140.0, 0.0, 0.0, 0.0, 110.0, 40.0, 55.0, 55.0, 0.0, 0.0, 0.0, 110.0, 5.0, 85.0, 40.0, 0.0, 5.0, 0.0, 0.0, 10.0, 35.0, 0.0, 170.0, 40.0, 10.0, 45.0, 20.0, 10.0, 0.0, 0.0, 325.0, 75.0, 15.0, 0.0, 0.0, 265.0, 0.0, 0.0, 0.0, 50.0, 0.0, 215.0, 230.0, 0.0, 55.0, 0.0, 35.0, 10.0, 245.0, 0.0, 0.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 45.0, 0.0, 45.0, 100.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 545.0, 270.0, 125.0, 80.0, 125.0, 55.0, 145.0, 125.0, 30.0, 15.0, 100.0, 115.0, 15.0, 85.0, 0.0, 35.0, 100.0, 75.0, 50.0, 50.0, 0.0, 20.0, 70.0, 45.0, 5.0, 0.0, 45.0, 0.0, 185.0, 60.0, 40.0, 50.0, 65.0, 0.0, 80.0, 65.0, 125.0, 45.0, 140.0, 0.0, 30.0, 0.0, 0.0, 0.0, 125.0, 110.0, 135.0, 0.0, 210.0, 65.0, 75.0, 105.0, 130.0, 0.0, 0.0, 0.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7474590843487695, "mean_inference_ms": 1.7132345310488462, "mean_action_processing_ms": 0.28993808951831457, "mean_env_wait_ms": 0.21258896254554976, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036079883575439453, "StateBufferConnector_ms": 0.0037201642990112305, "ViewRequirementAgentConnector_ms": 0.11406028270721436}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -359.0, "episode_return_mean": 257.64, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.64051403264082, "num_env_steps_trained_throughput_per_sec": 74.64051403264082, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 52499.275, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52499.227, "sample_time_ms": 1233.188, "learn_time_ms": 51247.29, "learn_throughput": 78.053, "synch_weights_time_ms": 14.956}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "ed30a_00000", "date": "2024-08-12_14-30-30", "timestamp": 1723487430, "time_this_iter_s": 53.65075135231018, "time_total_s": 856.0564904212952, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 856.0564904212952, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 40.161842105263155, "ram_util_percent": 83.2342105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1173349426694648, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7224765963182247, "policy_loss": -0.01145151960737412, "vf_loss": 0.7332029610635742, "vf_explained_var": 9.923936828734382e-05, "kl": 0.009668710214998797, "entropy": 1.4671486238323193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.737487507339507, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9201042953326747, "policy_loss": -0.010233578634098487, "vf_loss": 0.9297122036811536, "vf_explained_var": 0.04750126698029735, "kl": 0.00834226623061575, "entropy": 1.3464227974730194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -359.0, "episode_reward_mean": 270.55, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1307.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 77.35, "predator_policy": 57.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [244.0, 389.0, -280.0, 220.0, 364.0, 116.0, 364.0, -114.0, 214.0, 361.0, 358.0, -359.0, 52.0, 400.0, 334.0, 400.0, 400.0, 181.0, 352.0, 295.0, 400.0, 268.0, 374.0, 334.0, 400.0, 262.0, 129.0, 394.0, 400.0, 368.0, 97.0, 329.0, 366.0, 388.0, 10.0, 292.0, 400.0, 5.0, 400.0, 340.0, -200.0, 334.0, 358.0, 94.0, 400.0, 400.0, 184.0, 400.0, 346.0, 325.0, 359.0, 400.0, 400.0, -314.0, 297.0, 184.0, 329.0, 379.0, 263.0, 302.0, 358.0, 190.0, 280.0, 376.0, 328.0, 394.0, 346.0, 117.0, 380.0, 322.0, 226.0, 196.0, 232.0, 364.0, 400.0, 305.0, 238.0, 202.0, 184.0, 244.0, 400.0, 304.0, 202.0, 373.0, 400.0, 334.0, 274.0, 335.0, 400.0, 136.0, 253.0, 151.0, 334.0, 365.0, 341.0, 184.0, 388.0, 342.0, 227.0, 143.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, 123.0, 79.0, 200.0, -97.0, -658.0, -130.0, 200.0, 79.0, 200.0, 2.0, 24.0, 134.0, 200.0, 2.0, -416.0, -141.0, 200.0, 101.0, 200.0, 200.0, 123.0, -251.0, -383.0, 35.0, -218.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, 200.0, 200.0, -284.0, 200.0, 112.0, 200.0, -240.0, 200.0, 200.0, 200.0, -42.0, 200.0, 200.0, 79.0, 200.0, 79.0, 200.0, 200.0, 189.0, -42.0, -9.0, 13.0, 189.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, -152.0, 123.0, 156.0, 101.0, 200.0, 200.0, 178.0, -317.0, 2.0, 2.0, 200.0, 200.0, 200.0, -372.0, 112.0, 200.0, 200.0, 200.0, 90.0, -152.0, -493.0, 200.0, 79.0, 200.0, 123.0, -86.0, -75.0, 200.0, 200.0, 200.0, 200.0, -130.0, 134.0, 200.0, 200.0, 101.0, 200.0, 200.0, -20.0, 189.0, 145.0, 200.0, 200.0, 200.0, 200.0, -1307.0, 178.0, 200.0, -108.0, 145.0, -141.0, -141.0, 200.0, 200.0, 134.0, -152.0, 200.0, 13.0, 189.0, 123.0, 200.0, -53.0, 68.0, 90.0, 90.0, 200.0, 156.0, 35.0, 178.0, 200.0, 189.0, 101.0, 200.0, 200.0, -328.0, 200.0, 90.0, 57.0, 200.0, 46.0, 35.0, 101.0, -75.0, -108.0, 200.0, 200.0, 134.0, 200.0, 200.0, -108.0, 178.0, 2.0, 101.0, -218.0, 145.0, -196.0, 200.0, 79.0, 35.0, 200.0, 200.0, 200.0, 24.0, 200.0, -163.0, 200.0, 68.0, 200.0, 200.0, 200.0, 79.0, 156.0, 13.0, 189.0, 101.0, 200.0, 200.0, 134.0, -218.0, -9.0, 167.0, 2.0, 24.0, 79.0, 200.0, 156.0, 189.0, 189.0, 112.0, 200.0, -196.0, 200.0, 178.0, -53.0, 200.0, 2.0, 90.0, 57.0, -119.0], "policy_predator_policy_reward": [35.0, 95.0, 55.0, 55.0, 250.0, 225.0, 0.0, 150.0, 40.0, 45.0, 90.0, 0.0, 30.0, 0.0, 300.0, 0.0, 30.0, 125.0, 15.0, 45.0, 0.0, 35.0, 0.0, 275.0, 235.0, 0.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 0.0, 0.0, 55.0, 210.0, 0.0, 40.0, 195.0, 140.0, 0.0, 0.0, 0.0, 110.0, 40.0, 55.0, 55.0, 0.0, 0.0, 0.0, 110.0, 5.0, 85.0, 40.0, 0.0, 5.0, 0.0, 0.0, 10.0, 35.0, 0.0, 170.0, 40.0, 10.0, 45.0, 20.0, 10.0, 0.0, 0.0, 325.0, 75.0, 15.0, 0.0, 0.0, 265.0, 0.0, 0.0, 0.0, 50.0, 0.0, 215.0, 230.0, 0.0, 55.0, 0.0, 35.0, 10.0, 245.0, 0.0, 0.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 45.0, 0.0, 45.0, 100.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 545.0, 270.0, 125.0, 80.0, 125.0, 55.0, 145.0, 125.0, 30.0, 15.0, 100.0, 115.0, 15.0, 85.0, 0.0, 35.0, 100.0, 75.0, 50.0, 50.0, 0.0, 20.0, 70.0, 45.0, 5.0, 0.0, 45.0, 0.0, 185.0, 60.0, 40.0, 50.0, 65.0, 0.0, 80.0, 65.0, 125.0, 45.0, 140.0, 0.0, 30.0, 0.0, 0.0, 0.0, 125.0, 110.0, 135.0, 0.0, 210.0, 65.0, 75.0, 105.0, 130.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 45.0, 60.0, 0.0, 0.0, 5.0, 50.0, 20.0, 85.0, 35.0, 10.0, 0.0, 0.0, 95.0, 125.0, 0.0, 95.0, 0.0, 125.0, 0.0, 55.0, 0.0, 20.0, 0.0, 40.0, 0.0, 180.0, 0.0, 10.0, 110.0, 85.0, 75.0, 60.0, 155.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7446267389584843, "mean_inference_ms": 1.7051379788469274, "mean_action_processing_ms": 0.2889143192475281, "mean_env_wait_ms": 0.21113648505749125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038203001022338867, "StateBufferConnector_ms": 0.0031484365463256836, "ViewRequirementAgentConnector_ms": 0.12414097785949707}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -359.0, "episode_return_mean": 270.55, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.71316518291954, "num_env_steps_trained_throughput_per_sec": 72.71316518291954, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 52715.558, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52715.509, "sample_time_ms": 1275.007, "learn_time_ms": 51421.781, "learn_throughput": 77.788, "synch_weights_time_ms": 14.821}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "ed30a_00000", "date": "2024-08-12_14-31-25", "timestamp": 1723487485, "time_this_iter_s": 55.068161964416504, "time_total_s": 911.1246523857117, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01280d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 911.1246523857117, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 42.93205128205128, "ram_util_percent": 83.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2655607735905698, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7871706596442631, "policy_loss": -0.01279049449940286, "vf_loss": 0.7990366679729608, "vf_explained_var": 0.0014260921528730442, "kl": 0.01232643182811135, "entropy": 1.4999129109281713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.966521120670611, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0198665759545904, "policy_loss": -0.010526484616652683, "vf_loss": 1.0297171917068895, "vf_explained_var": 0.035820590125189886, "kl": 0.009011584701062796, "entropy": 1.3931743769418625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -314.0, "episode_reward_mean": 280.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1307.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 87.14, "predator_policy": 53.2}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.0, 334.0, 400.0, 262.0, 129.0, 394.0, 400.0, 368.0, 97.0, 329.0, 366.0, 388.0, 10.0, 292.0, 400.0, 5.0, 400.0, 340.0, -200.0, 334.0, 358.0, 94.0, 400.0, 400.0, 184.0, 400.0, 346.0, 325.0, 359.0, 400.0, 400.0, -314.0, 297.0, 184.0, 329.0, 379.0, 263.0, 302.0, 358.0, 190.0, 280.0, 376.0, 328.0, 394.0, 346.0, 117.0, 380.0, 322.0, 226.0, 196.0, 232.0, 364.0, 400.0, 305.0, 238.0, 202.0, 184.0, 244.0, 400.0, 304.0, 202.0, 373.0, 400.0, 334.0, 274.0, 335.0, 400.0, 136.0, 253.0, 151.0, 334.0, 365.0, 341.0, 184.0, 388.0, 342.0, 227.0, 143.0, 394.0, 48.0, -127.0, 388.0, 394.0, 400.0, 248.0, 172.0, 316.0, 394.0, 225.0, 244.0, 298.0, 232.0, 400.0, 400.0, -128.0, 352.0, 285.0, 298.0, 345.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 79.0, 200.0, 79.0, 200.0, 200.0, 189.0, -42.0, -9.0, 13.0, 189.0, 200.0, 200.0, 200.0, 200.0, 123.0, 79.0, -152.0, 123.0, 156.0, 101.0, 200.0, 200.0, 178.0, -317.0, 2.0, 2.0, 200.0, 200.0, 200.0, -372.0, 112.0, 200.0, 200.0, 200.0, 90.0, -152.0, -493.0, 200.0, 79.0, 200.0, 123.0, -86.0, -75.0, 200.0, 200.0, 200.0, 200.0, -130.0, 134.0, 200.0, 200.0, 101.0, 200.0, 200.0, -20.0, 189.0, 145.0, 200.0, 200.0, 200.0, 200.0, -1307.0, 178.0, 200.0, -108.0, 145.0, -141.0, -141.0, 200.0, 200.0, 134.0, -152.0, 200.0, 13.0, 189.0, 123.0, 200.0, -53.0, 68.0, 90.0, 90.0, 200.0, 156.0, 35.0, 178.0, 200.0, 189.0, 101.0, 200.0, 200.0, -328.0, 200.0, 90.0, 57.0, 200.0, 46.0, 35.0, 101.0, -75.0, -108.0, 200.0, 200.0, 134.0, 200.0, 200.0, -108.0, 178.0, 2.0, 101.0, -218.0, 145.0, -196.0, 200.0, 79.0, 35.0, 200.0, 200.0, 200.0, 24.0, 200.0, -163.0, 200.0, 68.0, 200.0, 200.0, 200.0, 79.0, 156.0, 13.0, 189.0, 101.0, 200.0, 200.0, 134.0, -218.0, -9.0, 167.0, 2.0, 24.0, 79.0, 200.0, 156.0, 189.0, 189.0, 112.0, 200.0, -196.0, 200.0, 178.0, -53.0, 200.0, 2.0, 90.0, 57.0, -119.0, 189.0, 200.0, -42.0, -185.0, -240.0, -97.0, 178.0, 200.0, 200.0, 189.0, 200.0, 200.0, 123.0, 35.0, -97.0, 79.0, 46.0, 200.0, 200.0, 189.0, 112.0, -42.0, 13.0, 101.0, 13.0, 200.0, 101.0, -9.0, 200.0, 200.0, 200.0, 200.0, -152.0, -141.0, 200.0, 112.0, -75.0, 145.0, -42.0, 200.0, 200.0, 90.0, 189.0, 200.0], "policy_predator_policy_reward": [40.0, 55.0, 55.0, 0.0, 0.0, 0.0, 110.0, 5.0, 85.0, 40.0, 0.0, 5.0, 0.0, 0.0, 10.0, 35.0, 0.0, 170.0, 40.0, 10.0, 45.0, 20.0, 10.0, 0.0, 0.0, 325.0, 75.0, 15.0, 0.0, 0.0, 265.0, 0.0, 0.0, 0.0, 50.0, 0.0, 215.0, 230.0, 0.0, 55.0, 0.0, 35.0, 10.0, 245.0, 0.0, 0.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 45.0, 0.0, 45.0, 100.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 545.0, 270.0, 125.0, 80.0, 125.0, 55.0, 145.0, 125.0, 30.0, 15.0, 100.0, 115.0, 15.0, 85.0, 0.0, 35.0, 100.0, 75.0, 50.0, 50.0, 0.0, 20.0, 70.0, 45.0, 5.0, 0.0, 45.0, 0.0, 185.0, 60.0, 40.0, 50.0, 65.0, 0.0, 80.0, 65.0, 125.0, 45.0, 140.0, 0.0, 30.0, 0.0, 0.0, 0.0, 125.0, 110.0, 135.0, 0.0, 210.0, 65.0, 75.0, 105.0, 130.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 45.0, 60.0, 0.0, 0.0, 5.0, 50.0, 20.0, 85.0, 35.0, 10.0, 0.0, 0.0, 95.0, 125.0, 0.0, 95.0, 0.0, 125.0, 0.0, 55.0, 0.0, 20.0, 0.0, 40.0, 0.0, 180.0, 0.0, 10.0, 110.0, 85.0, 75.0, 60.0, 155.0, 50.0, 0.0, 5.0, 220.0, 55.0, 0.0, 210.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 90.0, 190.0, 0.0, 70.0, 0.0, 0.0, 5.0, 150.0, 5.0, 45.0, 85.0, 0.0, 85.0, 95.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 40.0, 90.0, 125.0, 50.0, 90.0, 5.0, 50.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7445389890546669, "mean_inference_ms": 1.7019930122906297, "mean_action_processing_ms": 0.28910139637188764, "mean_env_wait_ms": 0.2103566361290712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004011273384094238, "StateBufferConnector_ms": 0.003278493881225586, "ViewRequirementAgentConnector_ms": 0.14675867557525635}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -314.0, "episode_return_mean": 280.68, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 74.04932801971695, "num_env_steps_trained_throughput_per_sec": 74.04932801971695, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 52760.645, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52760.577, "sample_time_ms": 1304.648, "learn_time_ms": 51435.617, "learn_throughput": 77.767, "synch_weights_time_ms": 16.573}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "ed30a_00000", "date": "2024-08-12_14-32-19", "timestamp": 1723487539, "time_this_iter_s": 54.06074285507202, "time_total_s": 965.1853952407837, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 965.1853952407837, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 39.22077922077923, "ram_util_percent": 82.54155844155845}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3953440248650848, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6991876076138208, "policy_loss": -0.012766989624058759, "vf_loss": 1.710888982828332, "vf_explained_var": 0.0002618856215603137, "kl": 0.014208226537332863, "entropy": 1.5022227535802852, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.713145168748483, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.35192823842089, "policy_loss": -0.014600898737762932, "vf_loss": 2.3656017902036193, "vf_explained_var": 0.026850814478737967, "kl": 0.012364684782439071, "entropy": 1.3755996965226673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -470.0, "episode_reward_mean": 268.3, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1307.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 545.0}, "policy_reward_mean": {"prey_policy": 75.425, "predator_policy": 58.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 184.0, 400.0, 346.0, 325.0, 359.0, 400.0, 400.0, -314.0, 297.0, 184.0, 329.0, 379.0, 263.0, 302.0, 358.0, 190.0, 280.0, 376.0, 328.0, 394.0, 346.0, 117.0, 380.0, 322.0, 226.0, 196.0, 232.0, 364.0, 400.0, 305.0, 238.0, 202.0, 184.0, 244.0, 400.0, 304.0, 202.0, 373.0, 400.0, 334.0, 274.0, 335.0, 400.0, 136.0, 253.0, 151.0, 334.0, 365.0, 341.0, 184.0, 388.0, 342.0, 227.0, 143.0, 394.0, 48.0, -127.0, 388.0, 394.0, 400.0, 248.0, 172.0, 316.0, 394.0, 225.0, 244.0, 298.0, 232.0, 400.0, 400.0, -128.0, 352.0, 285.0, 298.0, 345.0, 394.0, 400.0, 27.0, 394.0, -470.0, -26.0, 388.0, 227.0, 153.0, 400.0, 266.0, -271.0, 243.0, 262.0, 383.0, 370.0, 251.0, 394.0, 304.0, 210.0, 400.0, 400.0, 186.0, 145.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -130.0, 134.0, 200.0, 200.0, 101.0, 200.0, 200.0, -20.0, 189.0, 145.0, 200.0, 200.0, 200.0, 200.0, -1307.0, 178.0, 200.0, -108.0, 145.0, -141.0, -141.0, 200.0, 200.0, 134.0, -152.0, 200.0, 13.0, 189.0, 123.0, 200.0, -53.0, 68.0, 90.0, 90.0, 200.0, 156.0, 35.0, 178.0, 200.0, 189.0, 101.0, 200.0, 200.0, -328.0, 200.0, 90.0, 57.0, 200.0, 46.0, 35.0, 101.0, -75.0, -108.0, 200.0, 200.0, 134.0, 200.0, 200.0, -108.0, 178.0, 2.0, 101.0, -218.0, 145.0, -196.0, 200.0, 79.0, 35.0, 200.0, 200.0, 200.0, 24.0, 200.0, -163.0, 200.0, 68.0, 200.0, 200.0, 200.0, 79.0, 156.0, 13.0, 189.0, 101.0, 200.0, 200.0, 134.0, -218.0, -9.0, 167.0, 2.0, 24.0, 79.0, 200.0, 156.0, 189.0, 189.0, 112.0, 200.0, -196.0, 200.0, 178.0, -53.0, 200.0, 2.0, 90.0, 57.0, -119.0, 189.0, 200.0, -42.0, -185.0, -240.0, -97.0, 178.0, 200.0, 200.0, 189.0, 200.0, 200.0, 123.0, 35.0, -97.0, 79.0, 46.0, 200.0, 200.0, 189.0, 112.0, -42.0, 13.0, 101.0, 13.0, 200.0, 101.0, -9.0, 200.0, 200.0, 200.0, 200.0, -152.0, -141.0, 200.0, 112.0, -75.0, 145.0, -42.0, 200.0, 200.0, 90.0, 189.0, 200.0, 200.0, 200.0, -141.0, 13.0, 200.0, 189.0, -834.0, -141.0, 156.0, -537.0, 178.0, 200.0, 156.0, -64.0, 13.0, -20.0, 200.0, 200.0, 24.0, 2.0, 167.0, -988.0, 200.0, -207.0, -53.0, 200.0, 189.0, 189.0, 145.0, 200.0, -53.0, 189.0, 200.0, 189.0, 200.0, 24.0, 178.0, -218.0, 200.0, 200.0, 200.0, 200.0, 112.0, -31.0, 167.0, -317.0], "policy_predator_policy_reward": [0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 45.0, 0.0, 45.0, 100.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 545.0, 270.0, 125.0, 80.0, 125.0, 55.0, 145.0, 125.0, 30.0, 15.0, 100.0, 115.0, 15.0, 85.0, 0.0, 35.0, 100.0, 75.0, 50.0, 50.0, 0.0, 20.0, 70.0, 45.0, 5.0, 0.0, 45.0, 0.0, 185.0, 60.0, 40.0, 50.0, 65.0, 0.0, 80.0, 65.0, 125.0, 45.0, 140.0, 0.0, 30.0, 0.0, 0.0, 0.0, 125.0, 110.0, 135.0, 0.0, 210.0, 65.0, 75.0, 105.0, 130.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 45.0, 60.0, 0.0, 0.0, 5.0, 50.0, 20.0, 85.0, 35.0, 10.0, 0.0, 0.0, 95.0, 125.0, 0.0, 95.0, 0.0, 125.0, 0.0, 55.0, 0.0, 20.0, 0.0, 40.0, 0.0, 180.0, 0.0, 10.0, 110.0, 85.0, 75.0, 60.0, 155.0, 50.0, 0.0, 5.0, 220.0, 55.0, 0.0, 210.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 90.0, 190.0, 0.0, 70.0, 0.0, 0.0, 5.0, 150.0, 5.0, 45.0, 85.0, 0.0, 85.0, 95.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 40.0, 90.0, 125.0, 50.0, 90.0, 5.0, 50.0, 0.0, 5.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 0.0, 505.0, 20.0, 335.0, 10.0, 0.0, 0.0, 135.0, 0.0, 160.0, 0.0, 0.0, 90.0, 150.0, 540.0, 10.0, 75.0, 175.0, 115.0, 0.0, 0.0, 5.0, 0.0, 25.0, 115.0, 0.0, 5.0, 0.0, 0.0, 80.0, 190.0, 60.0, 0.0, 0.0, 0.0, 0.0, 105.0, 0.0, 60.0, 235.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7453442371874637, "mean_inference_ms": 1.705373554346172, "mean_action_processing_ms": 0.29022535844760655, "mean_env_wait_ms": 0.2110452029680502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053098201751708984, "StateBufferConnector_ms": 0.004007458686828613, "ViewRequirementAgentConnector_ms": 0.16899657249450684}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -470.0, "episode_return_mean": 268.3, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 72.10713039824057, "num_env_steps_trained_throughput_per_sec": 72.10713039824057, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 53098.273, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53098.206, "sample_time_ms": 1322.621, "learn_time_ms": 51755.375, "learn_throughput": 77.287, "synch_weights_time_ms": 16.705}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "ed30a_00000", "date": "2024-08-12_14-33-15", "timestamp": 1723487595, "time_this_iter_s": 55.53396391868591, "time_total_s": 1020.7193591594696, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1270ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1020.7193591594696, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 43.06075949367089, "ram_util_percent": 81.84810126582279}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3487147210293977, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.004637671526147, "policy_loss": -0.012007810982072322, "vf_loss": 3.015629978470071, "vf_explained_var": 0.0002981374503443481, "kl": 0.013539977523219086, "entropy": 1.4511915661670542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.840324480886812, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4909701752914954, "policy_loss": -0.01467045931867447, "vf_loss": 3.504496107278047, "vf_explained_var": 0.02032894971509459, "kl": 0.015260327649364762, "entropy": 1.3955478215343737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -553.0, "episode_reward_mean": 226.69, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1164.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 685.0}, "policy_reward_mean": {"prey_policy": 39.62, "predator_policy": 73.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.0, 328.0, 394.0, 346.0, 117.0, 380.0, 322.0, 226.0, 196.0, 232.0, 364.0, 400.0, 305.0, 238.0, 202.0, 184.0, 244.0, 400.0, 304.0, 202.0, 373.0, 400.0, 334.0, 274.0, 335.0, 400.0, 136.0, 253.0, 151.0, 334.0, 365.0, 341.0, 184.0, 388.0, 342.0, 227.0, 143.0, 394.0, 48.0, -127.0, 388.0, 394.0, 400.0, 248.0, 172.0, 316.0, 394.0, 225.0, 244.0, 298.0, 232.0, 400.0, 400.0, -128.0, 352.0, 285.0, 298.0, 345.0, 394.0, 400.0, 27.0, 394.0, -470.0, -26.0, 388.0, 227.0, 153.0, 400.0, 266.0, -271.0, 243.0, 262.0, 383.0, 370.0, 251.0, 394.0, 304.0, 210.0, 400.0, 400.0, 186.0, 145.0, 216.0, -440.0, 400.0, 298.0, -553.0, 2.0, 330.0, -314.0, -146.0, 90.0, 136.0, 353.0, 393.0, 130.0, -212.0, 382.0, -348.0, 204.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 156.0, 35.0, 178.0, 200.0, 189.0, 101.0, 200.0, 200.0, -328.0, 200.0, 90.0, 57.0, 200.0, 46.0, 35.0, 101.0, -75.0, -108.0, 200.0, 200.0, 134.0, 200.0, 200.0, -108.0, 178.0, 2.0, 101.0, -218.0, 145.0, -196.0, 200.0, 79.0, 35.0, 200.0, 200.0, 200.0, 24.0, 200.0, -163.0, 200.0, 68.0, 200.0, 200.0, 200.0, 79.0, 156.0, 13.0, 189.0, 101.0, 200.0, 200.0, 134.0, -218.0, -9.0, 167.0, 2.0, 24.0, 79.0, 200.0, 156.0, 189.0, 189.0, 112.0, 200.0, -196.0, 200.0, 178.0, -53.0, 200.0, 2.0, 90.0, 57.0, -119.0, 189.0, 200.0, -42.0, -185.0, -240.0, -97.0, 178.0, 200.0, 200.0, 189.0, 200.0, 200.0, 123.0, 35.0, -97.0, 79.0, 46.0, 200.0, 200.0, 189.0, 112.0, -42.0, 13.0, 101.0, 13.0, 200.0, 101.0, -9.0, 200.0, 200.0, 200.0, 200.0, -152.0, -141.0, 200.0, 112.0, -75.0, 145.0, -42.0, 200.0, 200.0, 90.0, 189.0, 200.0, 200.0, 200.0, -141.0, 13.0, 200.0, 189.0, -834.0, -141.0, 156.0, -537.0, 178.0, 200.0, 156.0, -64.0, 13.0, -20.0, 200.0, 200.0, 24.0, 2.0, 167.0, -988.0, 200.0, -207.0, -53.0, 200.0, 189.0, 189.0, 145.0, 200.0, -53.0, 189.0, 200.0, 189.0, 200.0, 24.0, 178.0, -218.0, 200.0, 200.0, 200.0, 200.0, 112.0, -31.0, 167.0, -317.0, 68.0, 13.0, -647.0, -493.0, 200.0, 200.0, 200.0, 13.0, -394.0, -1164.0, 123.0, -416.0, 156.0, 79.0, -603.0, -361.0, 68.0, -669.0, -75.0, -20.0, 46.0, -130.0, 200.0, 13.0, 178.0, 200.0, 156.0, -251.0, 68.0, -790.0, 200.0, 167.0, -647.0, -251.0, 200.0, -251.0], "policy_predator_policy_reward": [0.0, 20.0, 70.0, 45.0, 5.0, 0.0, 45.0, 0.0, 185.0, 60.0, 40.0, 50.0, 65.0, 0.0, 80.0, 65.0, 125.0, 45.0, 140.0, 0.0, 30.0, 0.0, 0.0, 0.0, 125.0, 110.0, 135.0, 0.0, 210.0, 65.0, 75.0, 105.0, 130.0, 0.0, 0.0, 0.0, 0.0, 80.0, 165.0, 0.0, 45.0, 60.0, 0.0, 0.0, 5.0, 50.0, 20.0, 85.0, 35.0, 10.0, 0.0, 0.0, 95.0, 125.0, 0.0, 95.0, 0.0, 125.0, 0.0, 55.0, 0.0, 20.0, 0.0, 40.0, 0.0, 180.0, 0.0, 10.0, 110.0, 85.0, 75.0, 60.0, 155.0, 50.0, 0.0, 5.0, 220.0, 55.0, 0.0, 210.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 90.0, 190.0, 0.0, 70.0, 0.0, 0.0, 5.0, 150.0, 5.0, 45.0, 85.0, 0.0, 85.0, 95.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 40.0, 90.0, 125.0, 50.0, 90.0, 5.0, 50.0, 0.0, 5.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 0.0, 505.0, 20.0, 335.0, 10.0, 0.0, 0.0, 135.0, 0.0, 160.0, 0.0, 0.0, 90.0, 150.0, 540.0, 10.0, 75.0, 175.0, 115.0, 0.0, 0.0, 5.0, 0.0, 25.0, 115.0, 0.0, 5.0, 0.0, 0.0, 80.0, 190.0, 60.0, 0.0, 0.0, 0.0, 0.0, 105.0, 0.0, 60.0, 235.0, 65.0, 70.0, 385.0, 315.0, 0.0, 0.0, 5.0, 80.0, 320.0, 685.0, 70.0, 225.0, 75.0, 20.0, 335.0, 315.0, 45.0, 410.0, 115.0, 70.0, 85.0, 135.0, 85.0, 55.0, 10.0, 5.0, 145.0, 80.0, 60.0, 450.0, 15.0, 0.0, 550.0, 0.0, 70.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7464509848404655, "mean_inference_ms": 1.70777098942535, "mean_action_processing_ms": 0.2910544156829066, "mean_env_wait_ms": 0.211332523883565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005197644233703613, "StateBufferConnector_ms": 0.003912925720214844, "ViewRequirementAgentConnector_ms": 0.17020916938781738}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -553.0, "episode_return_mean": 226.69, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.8283330832873, "num_env_steps_trained_throughput_per_sec": 75.8283330832873, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 53163.544, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53163.476, "sample_time_ms": 1320.236, "learn_time_ms": 51823.177, "learn_throughput": 77.186, "synch_weights_time_ms": 16.732}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "ed30a_00000", "date": "2024-08-12_14-34-07", "timestamp": 1723487647, "time_this_iter_s": 52.79168677330017, "time_total_s": 1073.5110459327698, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012bdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1073.5110459327698, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 38.18533333333334, "ram_util_percent": 80.736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.488848901204962, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.46324833536905, "policy_loss": -0.014589375622876028, "vf_loss": 6.476651416506086, "vf_explained_var": 0.0007519435314905076, "kl": 0.015817400370853465, "entropy": 1.432839908864763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.238319421697546, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.683925899626717, "policy_loss": -0.012021930382720062, "vf_loss": 7.6950712211548336, "vf_explained_var": 0.010904027639873444, "kl": 0.011688101882378905, "entropy": 1.3634679566615473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2132.0, "episode_reward_mean": 70.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -77.255, "predator_policy": 112.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, 202.0, 373.0, 400.0, 334.0, 274.0, 335.0, 400.0, 136.0, 253.0, 151.0, 334.0, 365.0, 341.0, 184.0, 388.0, 342.0, 227.0, 143.0, 394.0, 48.0, -127.0, 388.0, 394.0, 400.0, 248.0, 172.0, 316.0, 394.0, 225.0, 244.0, 298.0, 232.0, 400.0, 400.0, -128.0, 352.0, 285.0, 298.0, 345.0, 394.0, 400.0, 27.0, 394.0, -470.0, -26.0, 388.0, 227.0, 153.0, 400.0, 266.0, -271.0, 243.0, 262.0, 383.0, 370.0, 251.0, 394.0, 304.0, 210.0, 400.0, 400.0, 186.0, 145.0, 216.0, -440.0, 400.0, 298.0, -553.0, 2.0, 330.0, -314.0, -146.0, 90.0, 136.0, 353.0, 393.0, 130.0, -212.0, 382.0, -348.0, 204.0, -402.0, -2132.0, -836.0, -1148.0, 250.0, -844.0, -222.0, -697.0, 400.0, -1882.0, 328.0, -1138.0, 201.0, -681.0, 88.0, -653.0, -79.0, -914.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 24.0, 200.0, -163.0, 200.0, 68.0, 200.0, 200.0, 200.0, 79.0, 156.0, 13.0, 189.0, 101.0, 200.0, 200.0, 134.0, -218.0, -9.0, 167.0, 2.0, 24.0, 79.0, 200.0, 156.0, 189.0, 189.0, 112.0, 200.0, -196.0, 200.0, 178.0, -53.0, 200.0, 2.0, 90.0, 57.0, -119.0, 189.0, 200.0, -42.0, -185.0, -240.0, -97.0, 178.0, 200.0, 200.0, 189.0, 200.0, 200.0, 123.0, 35.0, -97.0, 79.0, 46.0, 200.0, 200.0, 189.0, 112.0, -42.0, 13.0, 101.0, 13.0, 200.0, 101.0, -9.0, 200.0, 200.0, 200.0, 200.0, -152.0, -141.0, 200.0, 112.0, -75.0, 145.0, -42.0, 200.0, 200.0, 90.0, 189.0, 200.0, 200.0, 200.0, -141.0, 13.0, 200.0, 189.0, -834.0, -141.0, 156.0, -537.0, 178.0, 200.0, 156.0, -64.0, 13.0, -20.0, 200.0, 200.0, 24.0, 2.0, 167.0, -988.0, 200.0, -207.0, -53.0, 200.0, 189.0, 189.0, 145.0, 200.0, -53.0, 189.0, 200.0, 189.0, 200.0, 24.0, 178.0, -218.0, 200.0, 200.0, 200.0, 200.0, 112.0, -31.0, 167.0, -317.0, 68.0, 13.0, -647.0, -493.0, 200.0, 200.0, 200.0, 13.0, -394.0, -1164.0, 123.0, -416.0, 156.0, 79.0, -603.0, -361.0, 68.0, -669.0, -75.0, -20.0, 46.0, -130.0, 200.0, 13.0, 178.0, 200.0, 156.0, -251.0, 68.0, -790.0, 200.0, 167.0, -647.0, -251.0, 200.0, -251.0, -625.0, -207.0, -1835.0, -1362.0, -713.0, -658.0, -1120.0, -1373.0, 200.0, -75.0, -570.0, -944.0, -218.0, -229.0, -504.0, -1373.0, 200.0, 200.0, -1516.0, -1186.0, 200.0, 68.0, -1087.0, -691.0, 134.0, -108.0, -691.0, -460.0, -75.0, -97.0, -614.0, -724.0, -361.0, -53.0, -1120.0, -559.0], "policy_predator_policy_reward": [0.0, 80.0, 165.0, 0.0, 45.0, 60.0, 0.0, 0.0, 5.0, 50.0, 20.0, 85.0, 35.0, 10.0, 0.0, 0.0, 95.0, 125.0, 0.0, 95.0, 0.0, 125.0, 0.0, 55.0, 0.0, 20.0, 0.0, 40.0, 0.0, 180.0, 0.0, 10.0, 110.0, 85.0, 75.0, 60.0, 155.0, 50.0, 0.0, 5.0, 220.0, 55.0, 0.0, 210.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 90.0, 190.0, 0.0, 70.0, 0.0, 0.0, 5.0, 150.0, 5.0, 45.0, 85.0, 0.0, 85.0, 95.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 40.0, 90.0, 125.0, 50.0, 90.0, 5.0, 50.0, 0.0, 5.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 0.0, 505.0, 20.0, 335.0, 10.0, 0.0, 0.0, 135.0, 0.0, 160.0, 0.0, 0.0, 90.0, 150.0, 540.0, 10.0, 75.0, 175.0, 115.0, 0.0, 0.0, 5.0, 0.0, 25.0, 115.0, 0.0, 5.0, 0.0, 0.0, 80.0, 190.0, 60.0, 0.0, 0.0, 0.0, 0.0, 105.0, 0.0, 60.0, 235.0, 65.0, 70.0, 385.0, 315.0, 0.0, 0.0, 5.0, 80.0, 320.0, 685.0, 70.0, 225.0, 75.0, 20.0, 335.0, 315.0, 45.0, 410.0, 115.0, 70.0, 85.0, 135.0, 85.0, 55.0, 10.0, 5.0, 145.0, 80.0, 60.0, 450.0, 15.0, 0.0, 550.0, 0.0, 70.0, 185.0, 55.0, 375.0, 920.0, 145.0, 415.0, 120.0, 730.0, 615.0, 125.0, 0.0, 375.0, 295.0, 185.0, 40.0, 525.0, 655.0, 0.0, 0.0, 800.0, 20.0, 0.0, 60.0, 45.0, 595.0, 155.0, 20.0, 75.0, 395.0, 30.0, 230.0, 530.0, 155.0, 70.0, 265.0, 765.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7475115124216853, "mean_inference_ms": 1.7110915510815845, "mean_action_processing_ms": 0.2918289123362707, "mean_env_wait_ms": 0.21174383059689222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005175948143005371, "StateBufferConnector_ms": 0.003896474838256836, "ViewRequirementAgentConnector_ms": 0.1549309492111206}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2132.0, "episode_return_mean": 70.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 73.60616013285387, "num_env_steps_trained_throughput_per_sec": 73.60616013285387, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 53434.291, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53434.223, "sample_time_ms": 1331.592, "learn_time_ms": 52082.558, "learn_throughput": 76.801, "synch_weights_time_ms": 16.622}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "ed30a_00000", "date": "2024-08-12_14-35-02", "timestamp": 1723487702, "time_this_iter_s": 54.38877010345459, "time_total_s": 1127.8998160362244, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1127.8998160362244, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 39.528571428571425, "ram_util_percent": 81.88181818181819}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4872806491675201, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.10289724768785, "policy_loss": -0.009972681424324278, "vf_loss": 8.112040747536554, "vf_explained_var": -8.265347707839239e-05, "kl": 0.01105600632445396, "entropy": 1.3688188325160395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.072033735210933, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.538542911993764, "policy_loss": -0.012704307426052986, "vf_loss": 7.550274019140415, "vf_explained_var": 0.011131239347356967, "kl": 0.012976048395169878, "entropy": 1.3453530375919645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2140.0, "episode_reward_mean": -119.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -234.39, "predator_policy": 174.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [143.0, 394.0, 48.0, -127.0, 388.0, 394.0, 400.0, 248.0, 172.0, 316.0, 394.0, 225.0, 244.0, 298.0, 232.0, 400.0, 400.0, -128.0, 352.0, 285.0, 298.0, 345.0, 394.0, 400.0, 27.0, 394.0, -470.0, -26.0, 388.0, 227.0, 153.0, 400.0, 266.0, -271.0, 243.0, 262.0, 383.0, 370.0, 251.0, 394.0, 304.0, 210.0, 400.0, 400.0, 186.0, 145.0, 216.0, -440.0, 400.0, 298.0, -553.0, 2.0, 330.0, -314.0, -146.0, 90.0, 136.0, 353.0, 393.0, 130.0, -212.0, 382.0, -348.0, 204.0, -402.0, -2132.0, -836.0, -1148.0, 250.0, -844.0, -222.0, -697.0, 400.0, -1882.0, 328.0, -1138.0, 201.0, -681.0, 88.0, -653.0, -79.0, -914.0, -822.0, -144.0, -2140.0, -1343.0, -166.0, -1300.0, -746.0, -1092.0, -742.0, 400.0, -641.0, -168.0, -2129.0, -412.0, -1025.0, -23.0, -231.0, -960.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [57.0, -119.0, 189.0, 200.0, -42.0, -185.0, -240.0, -97.0, 178.0, 200.0, 200.0, 189.0, 200.0, 200.0, 123.0, 35.0, -97.0, 79.0, 46.0, 200.0, 200.0, 189.0, 112.0, -42.0, 13.0, 101.0, 13.0, 200.0, 101.0, -9.0, 200.0, 200.0, 200.0, 200.0, -152.0, -141.0, 200.0, 112.0, -75.0, 145.0, -42.0, 200.0, 200.0, 90.0, 189.0, 200.0, 200.0, 200.0, -141.0, 13.0, 200.0, 189.0, -834.0, -141.0, 156.0, -537.0, 178.0, 200.0, 156.0, -64.0, 13.0, -20.0, 200.0, 200.0, 24.0, 2.0, 167.0, -988.0, 200.0, -207.0, -53.0, 200.0, 189.0, 189.0, 145.0, 200.0, -53.0, 189.0, 200.0, 189.0, 200.0, 24.0, 178.0, -218.0, 200.0, 200.0, 200.0, 200.0, 112.0, -31.0, 167.0, -317.0, 68.0, 13.0, -647.0, -493.0, 200.0, 200.0, 200.0, 13.0, -394.0, -1164.0, 123.0, -416.0, 156.0, 79.0, -603.0, -361.0, 68.0, -669.0, -75.0, -20.0, 46.0, -130.0, 200.0, 13.0, 178.0, 200.0, 156.0, -251.0, 68.0, -790.0, 200.0, 167.0, -647.0, -251.0, 200.0, -251.0, -625.0, -207.0, -1835.0, -1362.0, -713.0, -658.0, -1120.0, -1373.0, 200.0, -75.0, -570.0, -944.0, -218.0, -229.0, -504.0, -1373.0, 200.0, 200.0, -1516.0, -1186.0, 200.0, 68.0, -1087.0, -691.0, 134.0, -108.0, -691.0, -460.0, -75.0, -97.0, -614.0, -724.0, -361.0, -53.0, -1120.0, -559.0, -1065.0, -647.0, -328.0, -196.0, -1736.0, -1439.0, -1120.0, -1373.0, -1318.0, 167.0, -1340.0, -1065.0, -790.0, -746.0, -1175.0, -867.0, -1109.0, -713.0, 200.0, 200.0, -548.0, -658.0, -427.0, -141.0, -1461.0, -1483.0, -1131.0, -306.0, -570.0, -1175.0, -1373.0, 145.0, -405.0, -141.0, -966.0, -614.0], "policy_predator_policy_reward": [155.0, 50.0, 0.0, 5.0, 220.0, 55.0, 0.0, 210.0, 0.0, 10.0, 0.0, 5.0, 0.0, 0.0, 0.0, 90.0, 190.0, 0.0, 70.0, 0.0, 0.0, 5.0, 150.0, 5.0, 45.0, 85.0, 0.0, 85.0, 95.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 165.0, 0.0, 40.0, 90.0, 125.0, 50.0, 90.0, 5.0, 50.0, 0.0, 5.0, 0.0, 0.0, 0.0, 155.0, 5.0, 0.0, 0.0, 505.0, 20.0, 335.0, 10.0, 0.0, 0.0, 135.0, 0.0, 160.0, 0.0, 0.0, 90.0, 150.0, 540.0, 10.0, 75.0, 175.0, 115.0, 0.0, 0.0, 5.0, 0.0, 25.0, 115.0, 0.0, 5.0, 0.0, 0.0, 80.0, 190.0, 60.0, 0.0, 0.0, 0.0, 0.0, 105.0, 0.0, 60.0, 235.0, 65.0, 70.0, 385.0, 315.0, 0.0, 0.0, 5.0, 80.0, 320.0, 685.0, 70.0, 225.0, 75.0, 20.0, 335.0, 315.0, 45.0, 410.0, 115.0, 70.0, 85.0, 135.0, 85.0, 55.0, 10.0, 5.0, 145.0, 80.0, 60.0, 450.0, 15.0, 0.0, 550.0, 0.0, 70.0, 185.0, 55.0, 375.0, 920.0, 145.0, 415.0, 120.0, 730.0, 615.0, 125.0, 0.0, 375.0, 295.0, 185.0, 40.0, 525.0, 655.0, 0.0, 0.0, 800.0, 20.0, 0.0, 60.0, 45.0, 595.0, 155.0, 20.0, 75.0, 395.0, 30.0, 230.0, 530.0, 155.0, 70.0, 265.0, 765.0, 0.0, 480.0, 410.0, 245.0, 135.0, 270.0, 765.0, 505.0, 645.0, 660.0, 325.0, 475.0, 630.0, 360.0, 430.0, 575.0, 375.0, 555.0, 525.0, 0.0, 0.0, 345.0, 220.0, 350.0, 50.0, 800.0, 15.0, 595.0, 430.0, 75.0, 645.0, 700.0, 505.0, 5.0, 310.0, 525.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7467643417662626, "mean_inference_ms": 1.7081817193999154, "mean_action_processing_ms": 0.29172903886332874, "mean_env_wait_ms": 0.2116315419094073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005100131034851074, "StateBufferConnector_ms": 0.003993034362792969, "ViewRequirementAgentConnector_ms": 0.14929020404815674}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2140.0, "episode_return_mean": -119.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.93290483307132, "num_env_steps_trained_throughput_per_sec": 76.93290483307132, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 53505.061, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53504.993, "sample_time_ms": 1335.526, "learn_time_ms": 52148.684, "learn_throughput": 76.704, "synch_weights_time_ms": 16.678}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "ed30a_00000", "date": "2024-08-12_14-35-54", "timestamp": 1723487754, "time_this_iter_s": 52.019132137298584, "time_total_s": 1179.918948173523, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1179.918948173523, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 36.01891891891893, "ram_util_percent": 81.46216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.457275822995201, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.410801619322842, "policy_loss": -0.01093961721872566, "vf_loss": 6.421131849036645, "vf_explained_var": 2.287222594811172e-05, "kl": 0.008125026199223553, "entropy": 1.3702819196004716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.495352361757289, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.365500917131938, "policy_loss": -0.012278914092005128, "vf_loss": 7.37684089443671, "vf_explained_var": 0.009897971720922561, "kl": 0.012519001928663856, "entropy": 1.2747734600904757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2140.0, "episode_reward_mean": -343.0, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -425.35, "predator_policy": 253.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-26.0, 388.0, 227.0, 153.0, 400.0, 266.0, -271.0, 243.0, 262.0, 383.0, 370.0, 251.0, 394.0, 304.0, 210.0, 400.0, 400.0, 186.0, 145.0, 216.0, -440.0, 400.0, 298.0, -553.0, 2.0, 330.0, -314.0, -146.0, 90.0, 136.0, 353.0, 393.0, 130.0, -212.0, 382.0, -348.0, 204.0, -402.0, -2132.0, -836.0, -1148.0, 250.0, -844.0, -222.0, -697.0, 400.0, -1882.0, 328.0, -1138.0, 201.0, -681.0, 88.0, -653.0, -79.0, -914.0, -822.0, -144.0, -2140.0, -1343.0, -166.0, -1300.0, -746.0, -1092.0, -742.0, 400.0, -641.0, -168.0, -2129.0, -412.0, -1025.0, -23.0, -231.0, -960.0, 193.0, -909.0, -435.0, -1295.0, -334.0, -398.0, -1909.0, 244.0, -1620.0, -1246.0, -118.0, -31.0, -1573.0, -648.0, 144.0, 20.0, -1310.0, 262.0, -211.0, -228.0, -383.0, -254.0, -783.0, -1909.0, -386.0, -481.0, -263.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.0, -537.0, 178.0, 200.0, 156.0, -64.0, 13.0, -20.0, 200.0, 200.0, 24.0, 2.0, 167.0, -988.0, 200.0, -207.0, -53.0, 200.0, 189.0, 189.0, 145.0, 200.0, -53.0, 189.0, 200.0, 189.0, 200.0, 24.0, 178.0, -218.0, 200.0, 200.0, 200.0, 200.0, 112.0, -31.0, 167.0, -317.0, 68.0, 13.0, -647.0, -493.0, 200.0, 200.0, 200.0, 13.0, -394.0, -1164.0, 123.0, -416.0, 156.0, 79.0, -603.0, -361.0, 68.0, -669.0, -75.0, -20.0, 46.0, -130.0, 200.0, 13.0, 178.0, 200.0, 156.0, -251.0, 68.0, -790.0, 200.0, 167.0, -647.0, -251.0, 200.0, -251.0, -625.0, -207.0, -1835.0, -1362.0, -713.0, -658.0, -1120.0, -1373.0, 200.0, -75.0, -570.0, -944.0, -218.0, -229.0, -504.0, -1373.0, 200.0, 200.0, -1516.0, -1186.0, 200.0, 68.0, -1087.0, -691.0, 134.0, -108.0, -691.0, -460.0, -75.0, -97.0, -614.0, -724.0, -361.0, -53.0, -1120.0, -559.0, -1065.0, -647.0, -328.0, -196.0, -1736.0, -1439.0, -1120.0, -1373.0, -1318.0, 167.0, -1340.0, -1065.0, -790.0, -746.0, -1175.0, -867.0, -1109.0, -713.0, 200.0, 200.0, -548.0, -658.0, -427.0, -141.0, -1461.0, -1483.0, -1131.0, -306.0, -570.0, -1175.0, -1373.0, 145.0, -405.0, -141.0, -966.0, -614.0, 167.0, -394.0, -966.0, -933.0, -119.0, -746.0, -1285.0, -1010.0, -922.0, -372.0, -339.0, -614.0, -1725.0, -1659.0, 200.0, -86.0, -1252.0, -1373.0, -1274.0, -647.0, -185.0, -108.0, -86.0, -185.0, -1395.0, -1703.0, -592.0, -1076.0, 46.0, 13.0, -1021.0, 156.0, -867.0, -1043.0, -53.0, 200.0, -1043.0, -218.0, -625.0, 2.0, -647.0, -196.0, -31.0, -1153.0, -801.0, -812.0, -1351.0, -1593.0, 57.0, -1098.0, -526.0, -460.0, -240.0, -603.0], "policy_predator_policy_reward": [20.0, 335.0, 10.0, 0.0, 0.0, 135.0, 0.0, 160.0, 0.0, 0.0, 90.0, 150.0, 540.0, 10.0, 75.0, 175.0, 115.0, 0.0, 0.0, 5.0, 0.0, 25.0, 115.0, 0.0, 5.0, 0.0, 0.0, 80.0, 190.0, 60.0, 0.0, 0.0, 0.0, 0.0, 105.0, 0.0, 60.0, 235.0, 65.0, 70.0, 385.0, 315.0, 0.0, 0.0, 5.0, 80.0, 320.0, 685.0, 70.0, 225.0, 75.0, 20.0, 335.0, 315.0, 45.0, 410.0, 115.0, 70.0, 85.0, 135.0, 85.0, 55.0, 10.0, 5.0, 145.0, 80.0, 60.0, 450.0, 15.0, 0.0, 550.0, 0.0, 70.0, 185.0, 55.0, 375.0, 920.0, 145.0, 415.0, 120.0, 730.0, 615.0, 125.0, 0.0, 375.0, 295.0, 185.0, 40.0, 525.0, 655.0, 0.0, 0.0, 800.0, 20.0, 0.0, 60.0, 45.0, 595.0, 155.0, 20.0, 75.0, 395.0, 30.0, 230.0, 530.0, 155.0, 70.0, 265.0, 765.0, 0.0, 480.0, 410.0, 245.0, 135.0, 270.0, 765.0, 505.0, 645.0, 660.0, 325.0, 475.0, 630.0, 360.0, 430.0, 575.0, 375.0, 555.0, 525.0, 0.0, 0.0, 345.0, 220.0, 350.0, 50.0, 800.0, 15.0, 595.0, 430.0, 75.0, 645.0, 700.0, 505.0, 5.0, 310.0, 525.0, 95.0, 160.0, 260.0, 535.0, 455.0, 430.0, 0.0, 685.0, 315.0, 460.0, 500.0, 465.0, 90.0, 680.0, 795.0, 130.0, 0.0, 660.0, 345.0, 675.0, 0.0, 135.0, 40.0, 185.0, 55.0, 820.0, 705.0, 505.0, 515.0, 85.0, 0.0, 525.0, 360.0, 75.0, 525.0, 0.0, 115.0, 590.0, 460.0, 95.0, 300.0, 0.0, 460.0, 490.0, 440.0, 330.0, 500.0, 270.0, 765.0, 0.0, 655.0, 215.0, 290.0, 405.0, 175.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7415273105886679, "mean_inference_ms": 1.6981578021534447, "mean_action_processing_ms": 0.2902169419115365, "mean_env_wait_ms": 0.2105244814301146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054749250411987305, "StateBufferConnector_ms": 0.003978729248046875, "ViewRequirementAgentConnector_ms": 0.12820935249328613}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": -2140.0, "episode_return_mean": -343.0, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.92018421121736, "num_env_steps_trained_throughput_per_sec": 77.92018421121736, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 53431.918, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53431.851, "sample_time_ms": 1336.811, "learn_time_ms": 52075.149, "learn_throughput": 76.812, "synch_weights_time_ms": 15.859}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "ed30a_00000", "date": "2024-08-12_14-36-45", "timestamp": 1723487805, "time_this_iter_s": 51.37101101875305, "time_total_s": 1231.289959192276, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1231.289959192276, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 33.97397260273973, "ram_util_percent": 80.7054794520548}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.468814156720878, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8392537045100377, "policy_loss": -0.009482061638245507, "vf_loss": 3.8480123744439827, "vf_explained_var": -0.00027093625573254137, "kl": 0.00964509926565341, "entropy": 1.3702958349828367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.580096701465587, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.509253712747463, "policy_loss": -0.01504885722986526, "vf_loss": 3.5232661539915378, "vf_explained_var": 0.016271624489436073, "kl": 0.013818922462728048, "entropy": 1.3426297697440657, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2140.0, "episode_reward_mean": -378.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -464.345, "predator_policy": 274.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [145.0, 216.0, -440.0, 400.0, 298.0, -553.0, 2.0, 330.0, -314.0, -146.0, 90.0, 136.0, 353.0, 393.0, 130.0, -212.0, 382.0, -348.0, 204.0, -402.0, -2132.0, -836.0, -1148.0, 250.0, -844.0, -222.0, -697.0, 400.0, -1882.0, 328.0, -1138.0, 201.0, -681.0, 88.0, -653.0, -79.0, -914.0, -822.0, -144.0, -2140.0, -1343.0, -166.0, -1300.0, -746.0, -1092.0, -742.0, 400.0, -641.0, -168.0, -2129.0, -412.0, -1025.0, -23.0, -231.0, -960.0, 193.0, -909.0, -435.0, -1295.0, -334.0, -398.0, -1909.0, 244.0, -1620.0, -1246.0, -118.0, -31.0, -1573.0, -648.0, 144.0, 20.0, -1310.0, 262.0, -211.0, -228.0, -383.0, -254.0, -783.0, -1909.0, -386.0, -481.0, -263.0, -590.0, 207.0, 382.0, 400.0, -239.0, 82.0, 245.0, 195.0, 238.0, 394.0, -38.0, 60.0, 122.0, 229.0, -364.0, 36.0, -254.0, -149.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, -317.0, 68.0, 13.0, -647.0, -493.0, 200.0, 200.0, 200.0, 13.0, -394.0, -1164.0, 123.0, -416.0, 156.0, 79.0, -603.0, -361.0, 68.0, -669.0, -75.0, -20.0, 46.0, -130.0, 200.0, 13.0, 178.0, 200.0, 156.0, -251.0, 68.0, -790.0, 200.0, 167.0, -647.0, -251.0, 200.0, -251.0, -625.0, -207.0, -1835.0, -1362.0, -713.0, -658.0, -1120.0, -1373.0, 200.0, -75.0, -570.0, -944.0, -218.0, -229.0, -504.0, -1373.0, 200.0, 200.0, -1516.0, -1186.0, 200.0, 68.0, -1087.0, -691.0, 134.0, -108.0, -691.0, -460.0, -75.0, -97.0, -614.0, -724.0, -361.0, -53.0, -1120.0, -559.0, -1065.0, -647.0, -328.0, -196.0, -1736.0, -1439.0, -1120.0, -1373.0, -1318.0, 167.0, -1340.0, -1065.0, -790.0, -746.0, -1175.0, -867.0, -1109.0, -713.0, 200.0, 200.0, -548.0, -658.0, -427.0, -141.0, -1461.0, -1483.0, -1131.0, -306.0, -570.0, -1175.0, -1373.0, 145.0, -405.0, -141.0, -966.0, -614.0, 167.0, -394.0, -966.0, -933.0, -119.0, -746.0, -1285.0, -1010.0, -922.0, -372.0, -339.0, -614.0, -1725.0, -1659.0, 200.0, -86.0, -1252.0, -1373.0, -1274.0, -647.0, -185.0, -108.0, -86.0, -185.0, -1395.0, -1703.0, -592.0, -1076.0, 46.0, 13.0, -1021.0, 156.0, -867.0, -1043.0, -53.0, 200.0, -1043.0, -218.0, -625.0, 2.0, -647.0, -196.0, -31.0, -1153.0, -801.0, -812.0, -1351.0, -1593.0, 57.0, -1098.0, -526.0, -460.0, -240.0, -603.0, -1252.0, -328.0, 123.0, -141.0, 200.0, 167.0, 200.0, 200.0, -306.0, -383.0, 167.0, -350.0, -64.0, 189.0, 24.0, -284.0, 200.0, -97.0, 189.0, 200.0, -141.0, -427.0, 68.0, -438.0, 178.0, -306.0, 200.0, -196.0, -361.0, -1153.0, -273.0, -31.0, -559.0, -185.0, -97.0, -592.0], "policy_predator_policy_reward": [60.0, 235.0, 65.0, 70.0, 385.0, 315.0, 0.0, 0.0, 5.0, 80.0, 320.0, 685.0, 70.0, 225.0, 75.0, 20.0, 335.0, 315.0, 45.0, 410.0, 115.0, 70.0, 85.0, 135.0, 85.0, 55.0, 10.0, 5.0, 145.0, 80.0, 60.0, 450.0, 15.0, 0.0, 550.0, 0.0, 70.0, 185.0, 55.0, 375.0, 920.0, 145.0, 415.0, 120.0, 730.0, 615.0, 125.0, 0.0, 375.0, 295.0, 185.0, 40.0, 525.0, 655.0, 0.0, 0.0, 800.0, 20.0, 0.0, 60.0, 45.0, 595.0, 155.0, 20.0, 75.0, 395.0, 30.0, 230.0, 530.0, 155.0, 70.0, 265.0, 765.0, 0.0, 480.0, 410.0, 245.0, 135.0, 270.0, 765.0, 505.0, 645.0, 660.0, 325.0, 475.0, 630.0, 360.0, 430.0, 575.0, 375.0, 555.0, 525.0, 0.0, 0.0, 345.0, 220.0, 350.0, 50.0, 800.0, 15.0, 595.0, 430.0, 75.0, 645.0, 700.0, 505.0, 5.0, 310.0, 525.0, 95.0, 160.0, 260.0, 535.0, 455.0, 430.0, 0.0, 685.0, 315.0, 460.0, 500.0, 465.0, 90.0, 680.0, 795.0, 130.0, 0.0, 660.0, 345.0, 675.0, 0.0, 135.0, 40.0, 185.0, 55.0, 820.0, 705.0, 505.0, 515.0, 85.0, 0.0, 525.0, 360.0, 75.0, 525.0, 0.0, 115.0, 590.0, 460.0, 95.0, 300.0, 0.0, 460.0, 490.0, 440.0, 330.0, 500.0, 270.0, 765.0, 0.0, 655.0, 215.0, 290.0, 405.0, 175.0, 525.0, 465.0, 180.0, 45.0, 15.0, 0.0, 0.0, 0.0, 190.0, 260.0, 250.0, 15.0, 0.0, 120.0, 270.0, 185.0, 35.0, 100.0, 5.0, 0.0, 295.0, 235.0, 295.0, 135.0, 60.0, 190.0, 105.0, 120.0, 480.0, 670.0, 245.0, 95.0, 120.0, 370.0, 355.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.739059322741507, "mean_inference_ms": 1.6886498701710053, "mean_action_processing_ms": 0.28893940731158835, "mean_env_wait_ms": 0.20911833878330957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004580259323120117, "StateBufferConnector_ms": 0.0032743215560913086, "ViewRequirementAgentConnector_ms": 0.10643339157104492}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2140.0, "episode_return_mean": -378.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.62598018021451, "num_env_steps_trained_throughput_per_sec": 77.62598018021451, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 53278.378, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53278.311, "sample_time_ms": 1322.782, "learn_time_ms": 51935.568, "learn_throughput": 77.019, "synch_weights_time_ms": 15.795}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "ed30a_00000", "date": "2024-08-12_14-37-37", "timestamp": 1723487857, "time_this_iter_s": 51.573615074157715, "time_total_s": 1282.8635742664337, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010a700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1282.8635742664337, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 33.31095890410959, "ram_util_percent": 80.77808219178083}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4113603845317528, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.591814030793609, "policy_loss": -0.009822543764920541, "vf_loss": 3.600881907548854, "vf_explained_var": -3.389262017749605e-05, "kl": 0.010062235511429783, "entropy": 1.3384601285217932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.344991671439832, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.776910913621307, "policy_loss": -0.010694149575225772, "vf_loss": 2.786686799955116, "vf_explained_var": 0.0177381678233071, "kl": 0.012243513675331429, "entropy": 1.3338757635424376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2140.0, "episode_reward_mean": -370.86, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 920.0}, "policy_reward_mean": {"prey_policy": -457.305, "predator_policy": 271.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.0, -402.0, -2132.0, -836.0, -1148.0, 250.0, -844.0, -222.0, -697.0, 400.0, -1882.0, 328.0, -1138.0, 201.0, -681.0, 88.0, -653.0, -79.0, -914.0, -822.0, -144.0, -2140.0, -1343.0, -166.0, -1300.0, -746.0, -1092.0, -742.0, 400.0, -641.0, -168.0, -2129.0, -412.0, -1025.0, -23.0, -231.0, -960.0, 193.0, -909.0, -435.0, -1295.0, -334.0, -398.0, -1909.0, 244.0, -1620.0, -1246.0, -118.0, -31.0, -1573.0, -648.0, 144.0, 20.0, -1310.0, 262.0, -211.0, -228.0, -383.0, -254.0, -783.0, -1909.0, -386.0, -481.0, -263.0, -590.0, 207.0, 382.0, 400.0, -239.0, 82.0, 245.0, 195.0, 238.0, 394.0, -38.0, 60.0, 122.0, 229.0, -364.0, 36.0, -254.0, -149.0, 203.0, 236.0, -84.0, 86.0, -117.0, 334.0, 376.0, -62.0, -105.0, 19.0, 280.0, 49.0, -95.0, 199.0, -291.0, 322.0, 324.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -251.0, -625.0, -207.0, -1835.0, -1362.0, -713.0, -658.0, -1120.0, -1373.0, 200.0, -75.0, -570.0, -944.0, -218.0, -229.0, -504.0, -1373.0, 200.0, 200.0, -1516.0, -1186.0, 200.0, 68.0, -1087.0, -691.0, 134.0, -108.0, -691.0, -460.0, -75.0, -97.0, -614.0, -724.0, -361.0, -53.0, -1120.0, -559.0, -1065.0, -647.0, -328.0, -196.0, -1736.0, -1439.0, -1120.0, -1373.0, -1318.0, 167.0, -1340.0, -1065.0, -790.0, -746.0, -1175.0, -867.0, -1109.0, -713.0, 200.0, 200.0, -548.0, -658.0, -427.0, -141.0, -1461.0, -1483.0, -1131.0, -306.0, -570.0, -1175.0, -1373.0, 145.0, -405.0, -141.0, -966.0, -614.0, 167.0, -394.0, -966.0, -933.0, -119.0, -746.0, -1285.0, -1010.0, -922.0, -372.0, -339.0, -614.0, -1725.0, -1659.0, 200.0, -86.0, -1252.0, -1373.0, -1274.0, -647.0, -185.0, -108.0, -86.0, -185.0, -1395.0, -1703.0, -592.0, -1076.0, 46.0, 13.0, -1021.0, 156.0, -867.0, -1043.0, -53.0, 200.0, -1043.0, -218.0, -625.0, 2.0, -647.0, -196.0, -31.0, -1153.0, -801.0, -812.0, -1351.0, -1593.0, 57.0, -1098.0, -526.0, -460.0, -240.0, -603.0, -1252.0, -328.0, 123.0, -141.0, 200.0, 167.0, 200.0, 200.0, -306.0, -383.0, 167.0, -350.0, -64.0, 189.0, 24.0, -284.0, 200.0, -97.0, 189.0, 200.0, -141.0, -427.0, 68.0, -438.0, 178.0, -306.0, 200.0, -196.0, -361.0, -1153.0, -273.0, -31.0, -559.0, -185.0, -97.0, -592.0, -141.0, 189.0, -273.0, 189.0, 200.0, -724.0, 145.0, -339.0, -438.0, -174.0, 200.0, 79.0, 200.0, 156.0, 24.0, -471.0, -702.0, 167.0, -141.0, -20.0, -20.0, 200.0, 200.0, -636.0, -746.0, 101.0, -196.0, 200.0, -306.0, -295.0, -53.0, 200.0, 101.0, 178.0, 13.0, -372.0], "policy_predator_policy_reward": [70.0, 185.0, 55.0, 375.0, 920.0, 145.0, 415.0, 120.0, 730.0, 615.0, 125.0, 0.0, 375.0, 295.0, 185.0, 40.0, 525.0, 655.0, 0.0, 0.0, 800.0, 20.0, 0.0, 60.0, 45.0, 595.0, 155.0, 20.0, 75.0, 395.0, 30.0, 230.0, 530.0, 155.0, 70.0, 265.0, 765.0, 0.0, 480.0, 410.0, 245.0, 135.0, 270.0, 765.0, 505.0, 645.0, 660.0, 325.0, 475.0, 630.0, 360.0, 430.0, 575.0, 375.0, 555.0, 525.0, 0.0, 0.0, 345.0, 220.0, 350.0, 50.0, 800.0, 15.0, 595.0, 430.0, 75.0, 645.0, 700.0, 505.0, 5.0, 310.0, 525.0, 95.0, 160.0, 260.0, 535.0, 455.0, 430.0, 0.0, 685.0, 315.0, 460.0, 500.0, 465.0, 90.0, 680.0, 795.0, 130.0, 0.0, 660.0, 345.0, 675.0, 0.0, 135.0, 40.0, 185.0, 55.0, 820.0, 705.0, 505.0, 515.0, 85.0, 0.0, 525.0, 360.0, 75.0, 525.0, 0.0, 115.0, 590.0, 460.0, 95.0, 300.0, 0.0, 460.0, 490.0, 440.0, 330.0, 500.0, 270.0, 765.0, 0.0, 655.0, 215.0, 290.0, 405.0, 175.0, 525.0, 465.0, 180.0, 45.0, 15.0, 0.0, 0.0, 0.0, 190.0, 260.0, 250.0, 15.0, 0.0, 120.0, 270.0, 185.0, 35.0, 100.0, 5.0, 0.0, 295.0, 235.0, 295.0, 135.0, 60.0, 190.0, 105.0, 120.0, 480.0, 670.0, 245.0, 95.0, 120.0, 370.0, 355.0, 185.0, 0.0, 155.0, 135.0, 185.0, 20.0, 420.0, 60.0, 220.0, 320.0, 175.0, 55.0, 0.0, 5.0, 15.0, 270.0, 115.0, 395.0, 35.0, 175.0, 5.0, 0.0, 100.0, 365.0, 120.0, 250.0, 300.0, 150.0, 45.0, 95.0, 215.0, 115.0, 60.0, 45.0, 0.0, 185.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7352246812710497, "mean_inference_ms": 1.6794942683512795, "mean_action_processing_ms": 0.2876374767836273, "mean_env_wait_ms": 0.2079047739012542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00507509708404541, "StateBufferConnector_ms": 0.0032863616943359375, "ViewRequirementAgentConnector_ms": 0.1044243574142456}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2140.0, "episode_return_mean": -370.86, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.36481071511467, "num_env_steps_trained_throughput_per_sec": 75.36481071511467, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 53311.827, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53311.759, "sample_time_ms": 1318.845, "learn_time_ms": 51972.56, "learn_throughput": 76.964, "synch_weights_time_ms": 15.959}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "ed30a_00000", "date": "2024-08-12_14-38-30", "timestamp": 1723487910, "time_this_iter_s": 53.10559105873108, "time_total_s": 1335.9691653251648, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b013d940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1335.9691653251648, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 43.589473684210525, "ram_util_percent": 82.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4934152565620564, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8920335898323666, "policy_loss": -0.009272025576570914, "vf_loss": 2.90049836881577, "vf_explained_var": 0.0004597509979570984, "kl": 0.010763295905471603, "entropy": 1.3395357912179655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.138120403365484, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6237738923420983, "policy_loss": -0.010058722762814748, "vf_loss": 2.632894570928402, "vf_explained_var": 0.018643571870036856, "kl": 0.012507273571277481, "entropy": 1.3715462751489467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2140.0, "episode_reward_mean": -253.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1736.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 820.0}, "policy_reward_mean": {"prey_policy": -374.805, "predator_policy": 248.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-914.0, -822.0, -144.0, -2140.0, -1343.0, -166.0, -1300.0, -746.0, -1092.0, -742.0, 400.0, -641.0, -168.0, -2129.0, -412.0, -1025.0, -23.0, -231.0, -960.0, 193.0, -909.0, -435.0, -1295.0, -334.0, -398.0, -1909.0, 244.0, -1620.0, -1246.0, -118.0, -31.0, -1573.0, -648.0, 144.0, 20.0, -1310.0, 262.0, -211.0, -228.0, -383.0, -254.0, -783.0, -1909.0, -386.0, -481.0, -263.0, -590.0, 207.0, 382.0, 400.0, -239.0, 82.0, 245.0, 195.0, 238.0, 394.0, -38.0, 60.0, 122.0, 229.0, -364.0, 36.0, -254.0, -149.0, 203.0, 236.0, -84.0, 86.0, -117.0, 334.0, 376.0, -62.0, -105.0, 19.0, 280.0, 49.0, -95.0, 199.0, -291.0, 322.0, 324.0, -14.0, -109.0, -58.0, 298.0, 99.0, 287.0, 94.0, 322.0, 257.0, 340.0, 88.0, 110.0, 113.0, -10.0, 57.0, 132.0, 217.0, 245.0, 10.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1120.0, -559.0, -1065.0, -647.0, -328.0, -196.0, -1736.0, -1439.0, -1120.0, -1373.0, -1318.0, 167.0, -1340.0, -1065.0, -790.0, -746.0, -1175.0, -867.0, -1109.0, -713.0, 200.0, 200.0, -548.0, -658.0, -427.0, -141.0, -1461.0, -1483.0, -1131.0, -306.0, -570.0, -1175.0, -1373.0, 145.0, -405.0, -141.0, -966.0, -614.0, 167.0, -394.0, -966.0, -933.0, -119.0, -746.0, -1285.0, -1010.0, -922.0, -372.0, -339.0, -614.0, -1725.0, -1659.0, 200.0, -86.0, -1252.0, -1373.0, -1274.0, -647.0, -185.0, -108.0, -86.0, -185.0, -1395.0, -1703.0, -592.0, -1076.0, 46.0, 13.0, -1021.0, 156.0, -867.0, -1043.0, -53.0, 200.0, -1043.0, -218.0, -625.0, 2.0, -647.0, -196.0, -31.0, -1153.0, -801.0, -812.0, -1351.0, -1593.0, 57.0, -1098.0, -526.0, -460.0, -240.0, -603.0, -1252.0, -328.0, 123.0, -141.0, 200.0, 167.0, 200.0, 200.0, -306.0, -383.0, 167.0, -350.0, -64.0, 189.0, 24.0, -284.0, 200.0, -97.0, 189.0, 200.0, -141.0, -427.0, 68.0, -438.0, 178.0, -306.0, 200.0, -196.0, -361.0, -1153.0, -273.0, -31.0, -559.0, -185.0, -97.0, -592.0, -141.0, 189.0, -273.0, 189.0, 200.0, -724.0, 145.0, -339.0, -438.0, -174.0, 200.0, 79.0, 200.0, 156.0, 24.0, -471.0, -702.0, 167.0, -141.0, -20.0, -20.0, 200.0, 200.0, -636.0, -746.0, 101.0, -196.0, 200.0, -306.0, -295.0, -53.0, 200.0, 101.0, 178.0, 13.0, -372.0, -196.0, -218.0, -9.0, -449.0, 123.0, 90.0, 200.0, -416.0, 189.0, 13.0, -108.0, -163.0, 200.0, 57.0, 101.0, -9.0, 156.0, 134.0, 200.0, -372.0, -218.0, 13.0, -284.0, 57.0, 101.0, -471.0, -229.0, -119.0, -251.0, 68.0, 46.0, -64.0, 145.0, -20.0, -9.0, -306.0], "policy_predator_policy_reward": [765.0, 0.0, 480.0, 410.0, 245.0, 135.0, 270.0, 765.0, 505.0, 645.0, 660.0, 325.0, 475.0, 630.0, 360.0, 430.0, 575.0, 375.0, 555.0, 525.0, 0.0, 0.0, 345.0, 220.0, 350.0, 50.0, 800.0, 15.0, 595.0, 430.0, 75.0, 645.0, 700.0, 505.0, 5.0, 310.0, 525.0, 95.0, 160.0, 260.0, 535.0, 455.0, 430.0, 0.0, 685.0, 315.0, 460.0, 500.0, 465.0, 90.0, 680.0, 795.0, 130.0, 0.0, 660.0, 345.0, 675.0, 0.0, 135.0, 40.0, 185.0, 55.0, 820.0, 705.0, 505.0, 515.0, 85.0, 0.0, 525.0, 360.0, 75.0, 525.0, 0.0, 115.0, 590.0, 460.0, 95.0, 300.0, 0.0, 460.0, 490.0, 440.0, 330.0, 500.0, 270.0, 765.0, 0.0, 655.0, 215.0, 290.0, 405.0, 175.0, 525.0, 465.0, 180.0, 45.0, 15.0, 0.0, 0.0, 0.0, 190.0, 260.0, 250.0, 15.0, 0.0, 120.0, 270.0, 185.0, 35.0, 100.0, 5.0, 0.0, 295.0, 235.0, 295.0, 135.0, 60.0, 190.0, 105.0, 120.0, 480.0, 670.0, 245.0, 95.0, 120.0, 370.0, 355.0, 185.0, 0.0, 155.0, 135.0, 185.0, 20.0, 420.0, 60.0, 220.0, 320.0, 175.0, 55.0, 0.0, 5.0, 15.0, 270.0, 115.0, 395.0, 35.0, 175.0, 5.0, 0.0, 100.0, 365.0, 120.0, 250.0, 300.0, 150.0, 45.0, 95.0, 215.0, 115.0, 60.0, 45.0, 0.0, 185.0, 160.0, 95.0, 210.0, 295.0, 105.0, 0.0, 85.0, 125.0, 190.0, 0.0, 85.0, 195.0, 170.0, 65.0, 0.0, 45.0, 120.0, 30.0, 20.0, 0.0, 260.0, 275.0, 40.0, 120.0, 220.0, 220.0, 140.0, 155.0, 250.0, 180.0, 135.0, 100.0, 135.0, 105.0, 15.0, 170.0, 155.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7316553855517236, "mean_inference_ms": 1.6711470390954914, "mean_action_processing_ms": 0.28637759432294563, "mean_env_wait_ms": 0.20669415190634935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054847002029418945, "StateBufferConnector_ms": 0.0032460689544677734, "ViewRequirementAgentConnector_ms": 0.10182523727416992}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2140.0, "episode_return_mean": -253.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.27041817731364, "num_env_steps_trained_throughput_per_sec": 78.27041817731364, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 53063.294, "restore_workers_time_ms": 0.014, "training_step_time_ms": 53063.227, "sample_time_ms": 1324.125, "learn_time_ms": 51719.167, "learn_throughput": 77.341, "synch_weights_time_ms": 15.78}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "ed30a_00000", "date": "2024-08-12_14-39-21", "timestamp": 1723487961, "time_this_iter_s": 51.15058398246765, "time_total_s": 1387.1197493076324, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b010a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1387.1197493076324, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 38.18055555555556, "ram_util_percent": 82.60833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5001703856010287, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.473450604191533, "policy_loss": -0.011676559112867508, "vf_loss": 3.484268348936051, "vf_explained_var": 0.00010250582896843159, "kl": 0.0114509603312428, "entropy": 1.3167952143326007, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.75741118410277, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9867970172690335, "policy_loss": -0.011467483169374564, "vf_loss": 3.997282568865983, "vf_explained_var": 0.023971007519928866, "kl": 0.013092545226312893, "entropy": 1.3892781086699673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1909.0, "episode_reward_mean": -82.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1725.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 820.0}, "policy_reward_mean": {"prey_policy": -232.3, "predator_policy": 191.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1295.0, -334.0, -398.0, -1909.0, 244.0, -1620.0, -1246.0, -118.0, -31.0, -1573.0, -648.0, 144.0, 20.0, -1310.0, 262.0, -211.0, -228.0, -383.0, -254.0, -783.0, -1909.0, -386.0, -481.0, -263.0, -590.0, 207.0, 382.0, 400.0, -239.0, 82.0, 245.0, 195.0, 238.0, 394.0, -38.0, 60.0, 122.0, 229.0, -364.0, 36.0, -254.0, -149.0, 203.0, 236.0, -84.0, 86.0, -117.0, 334.0, 376.0, -62.0, -105.0, 19.0, 280.0, 49.0, -95.0, 199.0, -291.0, 322.0, 324.0, -14.0, -109.0, -58.0, 298.0, 99.0, 287.0, 94.0, 322.0, 257.0, 340.0, 88.0, 110.0, 113.0, -10.0, 57.0, 132.0, 217.0, 245.0, 10.0, 400.0, 137.0, -28.0, 169.0, -63.0, 155.0, 328.0, -345.0, 192.0, 213.0, -98.0, 364.0, -66.0, -84.0, -8.0, 226.0, 270.0, 122.0, -317.0, -486.0, 249.0, 37.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1285.0, -1010.0, -922.0, -372.0, -339.0, -614.0, -1725.0, -1659.0, 200.0, -86.0, -1252.0, -1373.0, -1274.0, -647.0, -185.0, -108.0, -86.0, -185.0, -1395.0, -1703.0, -592.0, -1076.0, 46.0, 13.0, -1021.0, 156.0, -867.0, -1043.0, -53.0, 200.0, -1043.0, -218.0, -625.0, 2.0, -647.0, -196.0, -31.0, -1153.0, -801.0, -812.0, -1351.0, -1593.0, 57.0, -1098.0, -526.0, -460.0, -240.0, -603.0, -1252.0, -328.0, 123.0, -141.0, 200.0, 167.0, 200.0, 200.0, -306.0, -383.0, 167.0, -350.0, -64.0, 189.0, 24.0, -284.0, 200.0, -97.0, 189.0, 200.0, -141.0, -427.0, 68.0, -438.0, 178.0, -306.0, 200.0, -196.0, -361.0, -1153.0, -273.0, -31.0, -559.0, -185.0, -97.0, -592.0, -141.0, 189.0, -273.0, 189.0, 200.0, -724.0, 145.0, -339.0, -438.0, -174.0, 200.0, 79.0, 200.0, 156.0, 24.0, -471.0, -702.0, 167.0, -141.0, -20.0, -20.0, 200.0, 200.0, -636.0, -746.0, 101.0, -196.0, 200.0, -306.0, -295.0, -53.0, 200.0, 101.0, 178.0, 13.0, -372.0, -196.0, -218.0, -9.0, -449.0, 123.0, 90.0, 200.0, -416.0, 189.0, 13.0, -108.0, -163.0, 200.0, 57.0, 101.0, -9.0, 156.0, 134.0, 200.0, -372.0, -218.0, 13.0, -284.0, 57.0, 101.0, -471.0, -229.0, -119.0, -251.0, 68.0, 46.0, -64.0, 145.0, -20.0, -9.0, -306.0, 200.0, 200.0, 2.0, -75.0, -328.0, -75.0, 79.0, -20.0, -471.0, 13.0, -42.0, 57.0, 178.0, 90.0, -306.0, -394.0, -185.0, 167.0, 24.0, -86.0, -823.0, 200.0, 200.0, 134.0, 79.0, -570.0, -152.0, -97.0, -141.0, -152.0, 200.0, -119.0, 90.0, 35.0, 35.0, -163.0, -273.0, -504.0, -427.0, -394.0, 24.0, 145.0, -75.0, -163.0], "policy_predator_policy_reward": [685.0, 315.0, 460.0, 500.0, 465.0, 90.0, 680.0, 795.0, 130.0, 0.0, 660.0, 345.0, 675.0, 0.0, 135.0, 40.0, 185.0, 55.0, 820.0, 705.0, 505.0, 515.0, 85.0, 0.0, 525.0, 360.0, 75.0, 525.0, 0.0, 115.0, 590.0, 460.0, 95.0, 300.0, 0.0, 460.0, 490.0, 440.0, 330.0, 500.0, 270.0, 765.0, 0.0, 655.0, 215.0, 290.0, 405.0, 175.0, 525.0, 465.0, 180.0, 45.0, 15.0, 0.0, 0.0, 0.0, 190.0, 260.0, 250.0, 15.0, 0.0, 120.0, 270.0, 185.0, 35.0, 100.0, 5.0, 0.0, 295.0, 235.0, 295.0, 135.0, 60.0, 190.0, 105.0, 120.0, 480.0, 670.0, 245.0, 95.0, 120.0, 370.0, 355.0, 185.0, 0.0, 155.0, 135.0, 185.0, 20.0, 420.0, 60.0, 220.0, 320.0, 175.0, 55.0, 0.0, 5.0, 15.0, 270.0, 115.0, 395.0, 35.0, 175.0, 5.0, 0.0, 100.0, 365.0, 120.0, 250.0, 300.0, 150.0, 45.0, 95.0, 215.0, 115.0, 60.0, 45.0, 0.0, 185.0, 160.0, 95.0, 210.0, 295.0, 105.0, 0.0, 85.0, 125.0, 190.0, 0.0, 85.0, 195.0, 170.0, 65.0, 0.0, 45.0, 120.0, 30.0, 20.0, 0.0, 260.0, 275.0, 40.0, 120.0, 220.0, 220.0, 140.0, 155.0, 250.0, 180.0, 135.0, 100.0, 135.0, 105.0, 15.0, 170.0, 155.0, 0.0, 0.0, 110.0, 100.0, 230.0, 145.0, 10.0, 100.0, 270.0, 125.0, 85.0, 55.0, 60.0, 0.0, 250.0, 105.0, 75.0, 135.0, 150.0, 125.0, 160.0, 365.0, 30.0, 0.0, 100.0, 325.0, 0.0, 165.0, 75.0, 210.0, 145.0, 0.0, 100.0, 45.0, 105.0, 145.0, 130.0, 330.0, 135.0, 200.0, 80.0, 0.0, 115.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7274806934102459, "mean_inference_ms": 1.6618438690213129, "mean_action_processing_ms": 0.28477214232043296, "mean_env_wait_ms": 0.20523635609584756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006280422210693359, "StateBufferConnector_ms": 0.0031125545501708984, "ViewRequirementAgentConnector_ms": 0.09900343418121338}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -1909.0, "episode_return_mean": -82.35, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.05932217044995, "num_env_steps_trained_throughput_per_sec": 81.05932217044995, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 52496.884, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52496.818, "sample_time_ms": 1278.885, "learn_time_ms": 51197.561, "learn_throughput": 78.129, "synch_weights_time_ms": 16.055}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "ed30a_00000", "date": "2024-08-12_14-40-11", "timestamp": 1723488011, "time_this_iter_s": 49.39368176460266, "time_total_s": 1436.513431072235, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1436.513431072235, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 33.49154929577465, "ram_util_percent": 82.69295774647887}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5672463704038548, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.782154489572717, "policy_loss": -0.01123991032604069, "vf_loss": 4.7924665790386305, "vf_explained_var": 7.757989187089224e-05, "kl": 0.012370967557956537, "entropy": 1.2723496694413443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.512290132108819, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.726440753886308, "policy_loss": -0.012108464486325386, "vf_loss": 5.737471483119581, "vf_explained_var": 0.018146486130971758, "kl": 0.014369635328390298, "entropy": 1.3836196177850955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1238.0, "episode_reward_mean": 32.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1252.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 670.0}, "policy_reward_mean": {"prey_policy": -129.945, "predator_policy": 146.4}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-263.0, -590.0, 207.0, 382.0, 400.0, -239.0, 82.0, 245.0, 195.0, 238.0, 394.0, -38.0, 60.0, 122.0, 229.0, -364.0, 36.0, -254.0, -149.0, 203.0, 236.0, -84.0, 86.0, -117.0, 334.0, 376.0, -62.0, -105.0, 19.0, 280.0, 49.0, -95.0, 199.0, -291.0, 322.0, 324.0, -14.0, -109.0, -58.0, 298.0, 99.0, 287.0, 94.0, 322.0, 257.0, 340.0, 88.0, 110.0, 113.0, -10.0, 57.0, 132.0, 217.0, 245.0, 10.0, 400.0, 137.0, -28.0, 169.0, -63.0, 155.0, 328.0, -345.0, 192.0, 213.0, -98.0, 364.0, -66.0, -84.0, -8.0, 226.0, 270.0, 122.0, -317.0, -486.0, 249.0, 37.0, 9.0, 41.0, 94.0, -225.0, 52.0, -145.0, -1238.0, -338.0, 234.0, 76.0, -376.0, -385.0, -530.0, 166.0, -218.0, 19.0, -710.0, -232.0, 359.0, -353.0, 242.0, 311.0, 226.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-240.0, -603.0, -1252.0, -328.0, 123.0, -141.0, 200.0, 167.0, 200.0, 200.0, -306.0, -383.0, 167.0, -350.0, -64.0, 189.0, 24.0, -284.0, 200.0, -97.0, 189.0, 200.0, -141.0, -427.0, 68.0, -438.0, 178.0, -306.0, 200.0, -196.0, -361.0, -1153.0, -273.0, -31.0, -559.0, -185.0, -97.0, -592.0, -141.0, 189.0, -273.0, 189.0, 200.0, -724.0, 145.0, -339.0, -438.0, -174.0, 200.0, 79.0, 200.0, 156.0, 24.0, -471.0, -702.0, 167.0, -141.0, -20.0, -20.0, 200.0, 200.0, -636.0, -746.0, 101.0, -196.0, 200.0, -306.0, -295.0, -53.0, 200.0, 101.0, 178.0, 13.0, -372.0, -196.0, -218.0, -9.0, -449.0, 123.0, 90.0, 200.0, -416.0, 189.0, 13.0, -108.0, -163.0, 200.0, 57.0, 101.0, -9.0, 156.0, 134.0, 200.0, -372.0, -218.0, 13.0, -284.0, 57.0, 101.0, -471.0, -229.0, -119.0, -251.0, 68.0, 46.0, -64.0, 145.0, -20.0, -9.0, -306.0, 200.0, 200.0, 2.0, -75.0, -328.0, -75.0, 79.0, -20.0, -471.0, 13.0, -42.0, 57.0, 178.0, 90.0, -306.0, -394.0, -185.0, 167.0, 24.0, -86.0, -823.0, 200.0, 200.0, 134.0, 79.0, -570.0, -152.0, -97.0, -141.0, -152.0, 200.0, -119.0, 90.0, 35.0, 35.0, -163.0, -273.0, -504.0, -427.0, -394.0, 24.0, 145.0, -75.0, -163.0, 79.0, -295.0, -174.0, -75.0, -75.0, -86.0, -207.0, -273.0, -185.0, -53.0, -86.0, -394.0, -1054.0, -999.0, -636.0, -262.0, 57.0, 112.0, -97.0, -97.0, -273.0, -383.0, -295.0, -570.0, -724.0, -636.0, -185.0, 156.0, -262.0, -306.0, 101.0, -372.0, -537.0, -548.0, -42.0, -515.0, 189.0, 145.0, -262.0, -361.0, 13.0, 24.0, -53.0, 134.0, 200.0, -119.0], "policy_predator_policy_reward": [405.0, 175.0, 525.0, 465.0, 180.0, 45.0, 15.0, 0.0, 0.0, 0.0, 190.0, 260.0, 250.0, 15.0, 0.0, 120.0, 270.0, 185.0, 35.0, 100.0, 5.0, 0.0, 295.0, 235.0, 295.0, 135.0, 60.0, 190.0, 105.0, 120.0, 480.0, 670.0, 245.0, 95.0, 120.0, 370.0, 355.0, 185.0, 0.0, 155.0, 135.0, 185.0, 20.0, 420.0, 60.0, 220.0, 320.0, 175.0, 55.0, 0.0, 5.0, 15.0, 270.0, 115.0, 395.0, 35.0, 175.0, 5.0, 0.0, 100.0, 365.0, 120.0, 250.0, 300.0, 150.0, 45.0, 95.0, 215.0, 115.0, 60.0, 45.0, 0.0, 185.0, 160.0, 95.0, 210.0, 295.0, 105.0, 0.0, 85.0, 125.0, 190.0, 0.0, 85.0, 195.0, 170.0, 65.0, 0.0, 45.0, 120.0, 30.0, 20.0, 0.0, 260.0, 275.0, 40.0, 120.0, 220.0, 220.0, 140.0, 155.0, 250.0, 180.0, 135.0, 100.0, 135.0, 105.0, 15.0, 170.0, 155.0, 0.0, 0.0, 110.0, 100.0, 230.0, 145.0, 10.0, 100.0, 270.0, 125.0, 85.0, 55.0, 60.0, 0.0, 250.0, 105.0, 75.0, 135.0, 150.0, 125.0, 160.0, 365.0, 30.0, 0.0, 100.0, 325.0, 0.0, 165.0, 75.0, 210.0, 145.0, 0.0, 100.0, 45.0, 105.0, 145.0, 130.0, 330.0, 135.0, 200.0, 80.0, 0.0, 115.0, 160.0, 0.0, 225.0, 160.0, 130.0, 125.0, 130.0, 200.0, 55.0, 135.0, 155.0, 155.0, 180.0, 355.0, 460.0, 215.0, 345.0, 65.0, 0.0, 105.0, 165.0, 65.0, 215.0, 240.0, 240.0, 490.0, 340.0, 35.0, 160.0, 245.0, 105.0, 235.0, 55.0, 375.0, 0.0, 50.0, 275.0, 0.0, 25.0, 0.0, 270.0, 125.0, 80.0, 125.0, 105.0, 100.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.723957622408338, "mean_inference_ms": 1.6843962193696265, "mean_action_processing_ms": 0.28349961599622836, "mean_env_wait_ms": 0.20411555509068244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008054733276367188, "StateBufferConnector_ms": 0.0030028820037841797, "ViewRequirementAgentConnector_ms": 0.09815490245819092}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -1238.0, "episode_return_mean": 32.91, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.49311320405464, "num_env_steps_trained_throughput_per_sec": 77.49311320405464, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 52256.829, "restore_workers_time_ms": 0.014, "training_step_time_ms": 52256.78, "sample_time_ms": 1419.484, "learn_time_ms": 50818.482, "learn_throughput": 78.712, "synch_weights_time_ms": 14.232}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "ed30a_00000", "date": "2024-08-12_14-41-02", "timestamp": 1723488062, "time_this_iter_s": 51.657835960388184, "time_total_s": 1488.1712670326233, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0145940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1488.1712670326233, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.6972602739726, "ram_util_percent": 83.0890410958904}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5150016087703604, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.408155584839917, "policy_loss": -0.012724433111756172, "vf_loss": 6.419875503973986, "vf_explained_var": 7.218229707586702e-05, "kl": 0.013393579896086031, "entropy": 1.2326241691907247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.235249372386428, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.174538181193922, "policy_loss": -0.008741108640146359, "vf_loss": 7.182493086719008, "vf_explained_var": 0.013579744825918208, "kl": 0.010482704081862035, "entropy": 1.3492379763138989, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1238.0, "episode_reward_mean": -39.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1054.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 520.0}, "policy_reward_mean": {"prey_policy": -169.6, "predator_policy": 149.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.0, 203.0, 236.0, -84.0, 86.0, -117.0, 334.0, 376.0, -62.0, -105.0, 19.0, 280.0, 49.0, -95.0, 199.0, -291.0, 322.0, 324.0, -14.0, -109.0, -58.0, 298.0, 99.0, 287.0, 94.0, 322.0, 257.0, 340.0, 88.0, 110.0, 113.0, -10.0, 57.0, 132.0, 217.0, 245.0, 10.0, 400.0, 137.0, -28.0, 169.0, -63.0, 155.0, 328.0, -345.0, 192.0, 213.0, -98.0, 364.0, -66.0, -84.0, -8.0, 226.0, 270.0, 122.0, -317.0, -486.0, 249.0, 37.0, 9.0, 41.0, 94.0, -225.0, 52.0, -145.0, -1238.0, -338.0, 234.0, 76.0, -376.0, -385.0, -530.0, 166.0, -218.0, 19.0, -710.0, -232.0, 359.0, -353.0, 242.0, 311.0, 226.0, -324.0, 41.0, -1090.0, 25.0, -945.0, -335.0, 67.0, -241.0, -505.0, -477.0, 244.0, -225.0, 152.0, -786.0, -994.0, 202.0, -973.0, -270.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-97.0, -592.0, -141.0, 189.0, -273.0, 189.0, 200.0, -724.0, 145.0, -339.0, -438.0, -174.0, 200.0, 79.0, 200.0, 156.0, 24.0, -471.0, -702.0, 167.0, -141.0, -20.0, -20.0, 200.0, 200.0, -636.0, -746.0, 101.0, -196.0, 200.0, -306.0, -295.0, -53.0, 200.0, 101.0, 178.0, 13.0, -372.0, -196.0, -218.0, -9.0, -449.0, 123.0, 90.0, 200.0, -416.0, 189.0, 13.0, -108.0, -163.0, 200.0, 57.0, 101.0, -9.0, 156.0, 134.0, 200.0, -372.0, -218.0, 13.0, -284.0, 57.0, 101.0, -471.0, -229.0, -119.0, -251.0, 68.0, 46.0, -64.0, 145.0, -20.0, -9.0, -306.0, 200.0, 200.0, 2.0, -75.0, -328.0, -75.0, 79.0, -20.0, -471.0, 13.0, -42.0, 57.0, 178.0, 90.0, -306.0, -394.0, -185.0, 167.0, 24.0, -86.0, -823.0, 200.0, 200.0, 134.0, 79.0, -570.0, -152.0, -97.0, -141.0, -152.0, 200.0, -119.0, 90.0, 35.0, 35.0, -163.0, -273.0, -504.0, -427.0, -394.0, 24.0, 145.0, -75.0, -163.0, 79.0, -295.0, -174.0, -75.0, -75.0, -86.0, -207.0, -273.0, -185.0, -53.0, -86.0, -394.0, -1054.0, -999.0, -636.0, -262.0, 57.0, 112.0, -97.0, -97.0, -273.0, -383.0, -295.0, -570.0, -724.0, -636.0, -185.0, 156.0, -262.0, -306.0, 101.0, -372.0, -537.0, -548.0, -42.0, -515.0, 189.0, 145.0, -262.0, -361.0, 13.0, 24.0, -53.0, 134.0, 200.0, -119.0, -559.0, -295.0, -504.0, 200.0, -1010.0, -680.0, -570.0, 200.0, -790.0, -845.0, -141.0, -889.0, -405.0, 167.0, -229.0, -317.0, -482.0, -438.0, -383.0, -394.0, -185.0, 189.0, -251.0, -229.0, -273.0, 200.0, -603.0, -548.0, -845.0, -669.0, -163.0, 200.0, -702.0, -911.0, -339.0, -251.0], "policy_predator_policy_reward": [355.0, 185.0, 0.0, 155.0, 135.0, 185.0, 20.0, 420.0, 60.0, 220.0, 320.0, 175.0, 55.0, 0.0, 5.0, 15.0, 270.0, 115.0, 395.0, 35.0, 175.0, 5.0, 0.0, 100.0, 365.0, 120.0, 250.0, 300.0, 150.0, 45.0, 95.0, 215.0, 115.0, 60.0, 45.0, 0.0, 185.0, 160.0, 95.0, 210.0, 295.0, 105.0, 0.0, 85.0, 125.0, 190.0, 0.0, 85.0, 195.0, 170.0, 65.0, 0.0, 45.0, 120.0, 30.0, 20.0, 0.0, 260.0, 275.0, 40.0, 120.0, 220.0, 220.0, 140.0, 155.0, 250.0, 180.0, 135.0, 100.0, 135.0, 105.0, 15.0, 170.0, 155.0, 0.0, 0.0, 110.0, 100.0, 230.0, 145.0, 10.0, 100.0, 270.0, 125.0, 85.0, 55.0, 60.0, 0.0, 250.0, 105.0, 75.0, 135.0, 150.0, 125.0, 160.0, 365.0, 30.0, 0.0, 100.0, 325.0, 0.0, 165.0, 75.0, 210.0, 145.0, 0.0, 100.0, 45.0, 105.0, 145.0, 130.0, 330.0, 135.0, 200.0, 80.0, 0.0, 115.0, 160.0, 0.0, 225.0, 160.0, 130.0, 125.0, 130.0, 200.0, 55.0, 135.0, 155.0, 155.0, 180.0, 355.0, 460.0, 215.0, 345.0, 65.0, 0.0, 105.0, 165.0, 65.0, 215.0, 240.0, 240.0, 490.0, 340.0, 35.0, 160.0, 245.0, 105.0, 235.0, 55.0, 375.0, 0.0, 50.0, 275.0, 0.0, 25.0, 0.0, 270.0, 125.0, 80.0, 125.0, 105.0, 100.0, 45.0, 250.0, 280.0, 70.0, 275.0, 120.0, 480.0, 350.0, 45.0, 520.0, 170.0, 475.0, 220.0, 190.0, 115.0, 75.0, 230.0, 205.0, 210.0, 100.0, 200.0, 150.0, 90.0, 135.0, 120.0, 15.0, 210.0, 235.0, 130.0, 355.0, 165.0, 120.0, 45.0, 355.0, 285.0, 105.0, 215.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.721686990970819, "mean_inference_ms": 1.702670099018599, "mean_action_processing_ms": 0.28273334773195635, "mean_env_wait_ms": 0.20342938041418257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008037924766540527, "StateBufferConnector_ms": 0.003067612648010254, "ViewRequirementAgentConnector_ms": 0.10773849487304688}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1238.0, "episode_return_mean": -39.85, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.01286942529003, "num_env_steps_trained_throughput_per_sec": 80.01286942529003, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 51708.723, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51708.673, "sample_time_ms": 1400.41, "learn_time_ms": 50289.743, "learn_throughput": 79.539, "synch_weights_time_ms": 14.044}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "ed30a_00000", "date": "2024-08-12_14-41-52", "timestamp": 1723488112, "time_this_iter_s": 50.02095890045166, "time_total_s": 1538.192225933075, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1538.192225933075, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 35.21549295774648, "ram_util_percent": 82.82112676056337}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5559555574384316, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.066738553274245, "policy_loss": -0.013935299692724747, "vf_loss": 7.0795786572511865, "vf_explained_var": -0.0001631617546081543, "kl": 0.01460285372038629, "entropy": 1.2159077842399557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.653695948634829, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.433015039484337, "policy_loss": -0.011130410330567175, "vf_loss": 7.443346958816367, "vf_explained_var": 0.01609062773210031, "kl": 0.010646585757799745, "entropy": 1.3133573084281236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1879.0, "episode_reward_mean": -185.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1472.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 730.0}, "policy_reward_mean": {"prey_policy": -265.465, "predator_policy": 172.5}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, -109.0, -58.0, 298.0, 99.0, 287.0, 94.0, 322.0, 257.0, 340.0, 88.0, 110.0, 113.0, -10.0, 57.0, 132.0, 217.0, 245.0, 10.0, 400.0, 137.0, -28.0, 169.0, -63.0, 155.0, 328.0, -345.0, 192.0, 213.0, -98.0, 364.0, -66.0, -84.0, -8.0, 226.0, 270.0, 122.0, -317.0, -486.0, 249.0, 37.0, 9.0, 41.0, 94.0, -225.0, 52.0, -145.0, -1238.0, -338.0, 234.0, 76.0, -376.0, -385.0, -530.0, 166.0, -218.0, 19.0, -710.0, -232.0, 359.0, -353.0, 242.0, 311.0, 226.0, -324.0, 41.0, -1090.0, 25.0, -945.0, -335.0, 67.0, -241.0, -505.0, -477.0, 244.0, -225.0, 152.0, -786.0, -994.0, 202.0, -973.0, -270.0, -1879.0, -1445.0, 52.0, -1372.0, 400.0, -1702.0, 82.0, 370.0, -1159.0, -730.0, -1036.0, 45.0, -1363.0, -366.0, -999.0, -732.0, -494.0, -755.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, -372.0, -196.0, -218.0, -9.0, -449.0, 123.0, 90.0, 200.0, -416.0, 189.0, 13.0, -108.0, -163.0, 200.0, 57.0, 101.0, -9.0, 156.0, 134.0, 200.0, -372.0, -218.0, 13.0, -284.0, 57.0, 101.0, -471.0, -229.0, -119.0, -251.0, 68.0, 46.0, -64.0, 145.0, -20.0, -9.0, -306.0, 200.0, 200.0, 2.0, -75.0, -328.0, -75.0, 79.0, -20.0, -471.0, 13.0, -42.0, 57.0, 178.0, 90.0, -306.0, -394.0, -185.0, 167.0, 24.0, -86.0, -823.0, 200.0, 200.0, 134.0, 79.0, -570.0, -152.0, -97.0, -141.0, -152.0, 200.0, -119.0, 90.0, 35.0, 35.0, -163.0, -273.0, -504.0, -427.0, -394.0, 24.0, 145.0, -75.0, -163.0, 79.0, -295.0, -174.0, -75.0, -75.0, -86.0, -207.0, -273.0, -185.0, -53.0, -86.0, -394.0, -1054.0, -999.0, -636.0, -262.0, 57.0, 112.0, -97.0, -97.0, -273.0, -383.0, -295.0, -570.0, -724.0, -636.0, -185.0, 156.0, -262.0, -306.0, 101.0, -372.0, -537.0, -548.0, -42.0, -515.0, 189.0, 145.0, -262.0, -361.0, 13.0, 24.0, -53.0, 134.0, 200.0, -119.0, -559.0, -295.0, -504.0, 200.0, -1010.0, -680.0, -570.0, 200.0, -790.0, -845.0, -141.0, -889.0, -405.0, 167.0, -229.0, -317.0, -482.0, -438.0, -383.0, -394.0, -185.0, 189.0, -251.0, -229.0, -273.0, 200.0, -603.0, -548.0, -845.0, -669.0, -163.0, 200.0, -702.0, -911.0, -339.0, -251.0, -1252.0, -1472.0, -1186.0, -944.0, -152.0, -86.0, -1021.0, -1076.0, 200.0, 200.0, -1208.0, -1219.0, 68.0, -141.0, 156.0, 189.0, -878.0, -856.0, -680.0, -515.0, -768.0, -878.0, -515.0, 200.0, -966.0, -1362.0, 200.0, -1296.0, -856.0, -713.0, -581.0, -966.0, -559.0, -405.0, -724.0, -746.0], "policy_predator_policy_reward": [185.0, 160.0, 95.0, 210.0, 295.0, 105.0, 0.0, 85.0, 125.0, 190.0, 0.0, 85.0, 195.0, 170.0, 65.0, 0.0, 45.0, 120.0, 30.0, 20.0, 0.0, 260.0, 275.0, 40.0, 120.0, 220.0, 220.0, 140.0, 155.0, 250.0, 180.0, 135.0, 100.0, 135.0, 105.0, 15.0, 170.0, 155.0, 0.0, 0.0, 110.0, 100.0, 230.0, 145.0, 10.0, 100.0, 270.0, 125.0, 85.0, 55.0, 60.0, 0.0, 250.0, 105.0, 75.0, 135.0, 150.0, 125.0, 160.0, 365.0, 30.0, 0.0, 100.0, 325.0, 0.0, 165.0, 75.0, 210.0, 145.0, 0.0, 100.0, 45.0, 105.0, 145.0, 130.0, 330.0, 135.0, 200.0, 80.0, 0.0, 115.0, 160.0, 0.0, 225.0, 160.0, 130.0, 125.0, 130.0, 200.0, 55.0, 135.0, 155.0, 155.0, 180.0, 355.0, 460.0, 215.0, 345.0, 65.0, 0.0, 105.0, 165.0, 65.0, 215.0, 240.0, 240.0, 490.0, 340.0, 35.0, 160.0, 245.0, 105.0, 235.0, 55.0, 375.0, 0.0, 50.0, 275.0, 0.0, 25.0, 0.0, 270.0, 125.0, 80.0, 125.0, 105.0, 100.0, 45.0, 250.0, 280.0, 70.0, 275.0, 120.0, 480.0, 350.0, 45.0, 520.0, 170.0, 475.0, 220.0, 190.0, 115.0, 75.0, 230.0, 205.0, 210.0, 100.0, 200.0, 150.0, 90.0, 135.0, 120.0, 15.0, 210.0, 235.0, 130.0, 355.0, 165.0, 120.0, 45.0, 355.0, 285.0, 105.0, 215.0, 115.0, 730.0, 400.0, 285.0, 175.0, 115.0, 160.0, 565.0, 0.0, 0.0, 320.0, 405.0, 95.0, 60.0, 5.0, 20.0, 395.0, 180.0, 290.0, 175.0, 405.0, 205.0, 35.0, 325.0, 335.0, 630.0, 150.0, 580.0, 260.0, 310.0, 380.0, 435.0, 280.0, 190.0, 445.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7194311259522936, "mean_inference_ms": 1.720533808556746, "mean_action_processing_ms": 0.2820682446205344, "mean_env_wait_ms": 0.20277321474499896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007568359375, "StateBufferConnector_ms": 0.003084540367126465, "ViewRequirementAgentConnector_ms": 0.10821187496185303}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1879.0, "episode_return_mean": -185.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.48393482365759, "num_env_steps_trained_throughput_per_sec": 81.48393482365759, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 51342.593, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51342.543, "sample_time_ms": 1397.868, "learn_time_ms": 49926.366, "learn_throughput": 80.118, "synch_weights_time_ms": 13.913}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "ed30a_00000", "date": "2024-08-12_14-42-42", "timestamp": 1723488162, "time_this_iter_s": 49.10180187225342, "time_total_s": 1587.2940278053284, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1587.2940278053284, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 33.28142857142858, "ram_util_percent": 83.26857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.441199681525508, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.6386647792089555, "policy_loss": -0.014078283122070528, "vf_loss": 7.651688490721284, "vf_explained_var": 0.0001090018837540238, "kl": 0.014060890492637855, "entropy": 1.1805189409583965, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4168320910325125, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.157351097984919, "policy_loss": -0.013601071888423234, "vf_loss": 7.169992700455681, "vf_explained_var": 0.013053715039813328, "kl": 0.01279306408763919, "entropy": 1.309078659014727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1879.0, "episode_reward_mean": -287.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1637.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 800.0}, "policy_reward_mean": {"prey_policy": -350.385, "predator_policy": 206.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 400.0, 137.0, -28.0, 169.0, -63.0, 155.0, 328.0, -345.0, 192.0, 213.0, -98.0, 364.0, -66.0, -84.0, -8.0, 226.0, 270.0, 122.0, -317.0, -486.0, 249.0, 37.0, 9.0, 41.0, 94.0, -225.0, 52.0, -145.0, -1238.0, -338.0, 234.0, 76.0, -376.0, -385.0, -530.0, 166.0, -218.0, 19.0, -710.0, -232.0, 359.0, -353.0, 242.0, 311.0, 226.0, -324.0, 41.0, -1090.0, 25.0, -945.0, -335.0, 67.0, -241.0, -505.0, -477.0, 244.0, -225.0, 152.0, -786.0, -994.0, 202.0, -973.0, -270.0, -1879.0, -1445.0, 52.0, -1372.0, 400.0, -1702.0, 82.0, 370.0, -1159.0, -730.0, -1036.0, 45.0, -1363.0, -366.0, -999.0, -732.0, -494.0, -755.0, -263.0, -722.0, -236.0, -996.0, -851.0, 400.0, 111.0, -1350.0, -517.0, -244.0, -216.0, -343.0, -1445.0, -703.0, 41.0, 226.0, -171.0, -377.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, -306.0, 200.0, 200.0, 2.0, -75.0, -328.0, -75.0, 79.0, -20.0, -471.0, 13.0, -42.0, 57.0, 178.0, 90.0, -306.0, -394.0, -185.0, 167.0, 24.0, -86.0, -823.0, 200.0, 200.0, 134.0, 79.0, -570.0, -152.0, -97.0, -141.0, -152.0, 200.0, -119.0, 90.0, 35.0, 35.0, -163.0, -273.0, -504.0, -427.0, -394.0, 24.0, 145.0, -75.0, -163.0, 79.0, -295.0, -174.0, -75.0, -75.0, -86.0, -207.0, -273.0, -185.0, -53.0, -86.0, -394.0, -1054.0, -999.0, -636.0, -262.0, 57.0, 112.0, -97.0, -97.0, -273.0, -383.0, -295.0, -570.0, -724.0, -636.0, -185.0, 156.0, -262.0, -306.0, 101.0, -372.0, -537.0, -548.0, -42.0, -515.0, 189.0, 145.0, -262.0, -361.0, 13.0, 24.0, -53.0, 134.0, 200.0, -119.0, -559.0, -295.0, -504.0, 200.0, -1010.0, -680.0, -570.0, 200.0, -790.0, -845.0, -141.0, -889.0, -405.0, 167.0, -229.0, -317.0, -482.0, -438.0, -383.0, -394.0, -185.0, 189.0, -251.0, -229.0, -273.0, 200.0, -603.0, -548.0, -845.0, -669.0, -163.0, 200.0, -702.0, -911.0, -339.0, -251.0, -1252.0, -1472.0, -1186.0, -944.0, -152.0, -86.0, -1021.0, -1076.0, 200.0, 200.0, -1208.0, -1219.0, 68.0, -141.0, 156.0, 189.0, -878.0, -856.0, -680.0, -515.0, -768.0, -878.0, -515.0, 200.0, -966.0, -1362.0, 200.0, -1296.0, -856.0, -713.0, -581.0, -966.0, -559.0, -405.0, -724.0, -746.0, -977.0, 24.0, -526.0, -526.0, -944.0, 178.0, -999.0, -922.0, -658.0, -823.0, 200.0, 200.0, 134.0, -218.0, -1527.0, -1373.0, -1373.0, -9.0, 101.0, -900.0, 200.0, -966.0, 178.0, -1571.0, -1252.0, -1153.0, -504.0, -559.0, -559.0, 200.0, 200.0, -119.0, -966.0, 200.0, -1637.0, 200.0], "policy_predator_policy_reward": [170.0, 155.0, 0.0, 0.0, 110.0, 100.0, 230.0, 145.0, 10.0, 100.0, 270.0, 125.0, 85.0, 55.0, 60.0, 0.0, 250.0, 105.0, 75.0, 135.0, 150.0, 125.0, 160.0, 365.0, 30.0, 0.0, 100.0, 325.0, 0.0, 165.0, 75.0, 210.0, 145.0, 0.0, 100.0, 45.0, 105.0, 145.0, 130.0, 330.0, 135.0, 200.0, 80.0, 0.0, 115.0, 160.0, 0.0, 225.0, 160.0, 130.0, 125.0, 130.0, 200.0, 55.0, 135.0, 155.0, 155.0, 180.0, 355.0, 460.0, 215.0, 345.0, 65.0, 0.0, 105.0, 165.0, 65.0, 215.0, 240.0, 240.0, 490.0, 340.0, 35.0, 160.0, 245.0, 105.0, 235.0, 55.0, 375.0, 0.0, 50.0, 275.0, 0.0, 25.0, 0.0, 270.0, 125.0, 80.0, 125.0, 105.0, 100.0, 45.0, 250.0, 280.0, 70.0, 275.0, 120.0, 480.0, 350.0, 45.0, 520.0, 170.0, 475.0, 220.0, 190.0, 115.0, 75.0, 230.0, 205.0, 210.0, 100.0, 200.0, 150.0, 90.0, 135.0, 120.0, 15.0, 210.0, 235.0, 130.0, 355.0, 165.0, 120.0, 45.0, 355.0, 285.0, 105.0, 215.0, 115.0, 730.0, 400.0, 285.0, 175.0, 115.0, 160.0, 565.0, 0.0, 0.0, 320.0, 405.0, 95.0, 60.0, 5.0, 20.0, 395.0, 180.0, 290.0, 175.0, 405.0, 205.0, 35.0, 325.0, 335.0, 630.0, 150.0, 580.0, 260.0, 310.0, 380.0, 435.0, 280.0, 190.0, 445.0, 270.0, 425.0, 265.0, 250.0, 80.0, 135.0, 395.0, 560.0, 365.0, 420.0, 210.0, 0.0, 0.0, 195.0, 0.0, 750.0, 800.0, 495.0, 370.0, 140.0, 415.0, 80.0, 470.0, 555.0, 495.0, 565.0, 395.0, 150.0, 210.0, 340.0, 60.0, 145.0, 0.0, 195.0, 400.0, 320.0, 740.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7169499416629905, "mean_inference_ms": 1.7372947227072655, "mean_action_processing_ms": 0.2814036400804982, "mean_env_wait_ms": 0.2021672697261114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007136344909667969, "StateBufferConnector_ms": 0.0031239986419677734, "ViewRequirementAgentConnector_ms": 0.1109999418258667}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1879.0, "episode_return_mean": -287.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.50477750619622, "num_env_steps_trained_throughput_per_sec": 80.50477750619622, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 50876.914, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50876.865, "sample_time_ms": 1382.476, "learn_time_ms": 49475.869, "learn_throughput": 80.847, "synch_weights_time_ms": 14.095}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "ed30a_00000", "date": "2024-08-12_14-43-31", "timestamp": 1723488211, "time_this_iter_s": 49.73647904396057, "time_total_s": 1637.030506849289, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b013e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1637.030506849289, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 36.180281690140845, "ram_util_percent": 82.87605633802816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5194677695395455, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.899049253564663, "policy_loss": -0.011019313576872702, "vf_loss": 6.909318259405711, "vf_explained_var": -1.3699859538406292e-05, "kl": 0.010004299903864805, "entropy": 1.1335320603279841, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.239777316113629, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.789312360904835, "policy_loss": -0.012206295687734844, "vf_loss": 6.800713646853412, "vf_explained_var": 0.017668966042301643, "kl": 0.010733668449833868, "entropy": 1.2901522609291884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2183.0, "episode_reward_mean": -528.11, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1725.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 865.0}, "policy_reward_mean": {"prey_policy": -539.805, "predator_policy": 275.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [52.0, -145.0, -1238.0, -338.0, 234.0, 76.0, -376.0, -385.0, -530.0, 166.0, -218.0, 19.0, -710.0, -232.0, 359.0, -353.0, 242.0, 311.0, 226.0, -324.0, 41.0, -1090.0, 25.0, -945.0, -335.0, 67.0, -241.0, -505.0, -477.0, 244.0, -225.0, 152.0, -786.0, -994.0, 202.0, -973.0, -270.0, -1879.0, -1445.0, 52.0, -1372.0, 400.0, -1702.0, 82.0, 370.0, -1159.0, -730.0, -1036.0, 45.0, -1363.0, -366.0, -999.0, -732.0, -494.0, -755.0, -263.0, -722.0, -236.0, -996.0, -851.0, 400.0, 111.0, -1350.0, -517.0, -244.0, -216.0, -343.0, -1445.0, -703.0, 41.0, 226.0, -171.0, -377.0, -1362.0, 364.0, -2183.0, -1452.0, -1815.0, -310.0, -377.0, -1577.0, -1758.0, -926.0, -249.0, -487.0, -306.0, -1940.0, -552.0, -991.0, -794.0, -543.0, -569.0, 400.0, -338.0, -1292.0, -339.0, -93.0, -1594.0, 400.0, -2115.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-185.0, -53.0, -86.0, -394.0, -1054.0, -999.0, -636.0, -262.0, 57.0, 112.0, -97.0, -97.0, -273.0, -383.0, -295.0, -570.0, -724.0, -636.0, -185.0, 156.0, -262.0, -306.0, 101.0, -372.0, -537.0, -548.0, -42.0, -515.0, 189.0, 145.0, -262.0, -361.0, 13.0, 24.0, -53.0, 134.0, 200.0, -119.0, -559.0, -295.0, -504.0, 200.0, -1010.0, -680.0, -570.0, 200.0, -790.0, -845.0, -141.0, -889.0, -405.0, 167.0, -229.0, -317.0, -482.0, -438.0, -383.0, -394.0, -185.0, 189.0, -251.0, -229.0, -273.0, 200.0, -603.0, -548.0, -845.0, -669.0, -163.0, 200.0, -702.0, -911.0, -339.0, -251.0, -1252.0, -1472.0, -1186.0, -944.0, -152.0, -86.0, -1021.0, -1076.0, 200.0, 200.0, -1208.0, -1219.0, 68.0, -141.0, 156.0, 189.0, -878.0, -856.0, -680.0, -515.0, -768.0, -878.0, -515.0, 200.0, -966.0, -1362.0, 200.0, -1296.0, -856.0, -713.0, -581.0, -966.0, -559.0, -405.0, -724.0, -746.0, -977.0, 24.0, -526.0, -526.0, -944.0, 178.0, -999.0, -922.0, -658.0, -823.0, 200.0, 200.0, 134.0, -218.0, -1527.0, -1373.0, -1373.0, -9.0, 101.0, -900.0, 200.0, -966.0, 178.0, -1571.0, -1252.0, -1153.0, -504.0, -559.0, -559.0, 200.0, 200.0, -119.0, -966.0, 200.0, -1637.0, 200.0, -1021.0, -966.0, 200.0, 134.0, -1725.0, -1593.0, -1340.0, -1087.0, -1307.0, -1318.0, 189.0, -1219.0, 79.0, -1241.0, -1142.0, -1285.0, -1285.0, -1263.0, -724.0, -702.0, -1087.0, 123.0, 189.0, -1406.0, -1087.0, 46.0, -1395.0, -1615.0, 134.0, -1626.0, -779.0, -812.0, -1483.0, -801.0, -394.0, -724.0, -1164.0, -240.0, 200.0, 200.0, 79.0, -1472.0, -955.0, -1307.0, -1098.0, 24.0, 178.0, -801.0, -1274.0, -1230.0, 200.0, 200.0, -1703.0, -1692.0], "policy_predator_policy_reward": [135.0, 155.0, 155.0, 180.0, 355.0, 460.0, 215.0, 345.0, 65.0, 0.0, 105.0, 165.0, 65.0, 215.0, 240.0, 240.0, 490.0, 340.0, 35.0, 160.0, 245.0, 105.0, 235.0, 55.0, 375.0, 0.0, 50.0, 275.0, 0.0, 25.0, 0.0, 270.0, 125.0, 80.0, 125.0, 105.0, 100.0, 45.0, 250.0, 280.0, 70.0, 275.0, 120.0, 480.0, 350.0, 45.0, 520.0, 170.0, 475.0, 220.0, 190.0, 115.0, 75.0, 230.0, 205.0, 210.0, 100.0, 200.0, 150.0, 90.0, 135.0, 120.0, 15.0, 210.0, 235.0, 130.0, 355.0, 165.0, 120.0, 45.0, 355.0, 285.0, 105.0, 215.0, 115.0, 730.0, 400.0, 285.0, 175.0, 115.0, 160.0, 565.0, 0.0, 0.0, 320.0, 405.0, 95.0, 60.0, 5.0, 20.0, 395.0, 180.0, 290.0, 175.0, 405.0, 205.0, 35.0, 325.0, 335.0, 630.0, 150.0, 580.0, 260.0, 310.0, 380.0, 435.0, 280.0, 190.0, 445.0, 270.0, 425.0, 265.0, 250.0, 80.0, 135.0, 395.0, 560.0, 365.0, 420.0, 210.0, 0.0, 0.0, 195.0, 0.0, 750.0, 800.0, 495.0, 370.0, 140.0, 415.0, 80.0, 470.0, 555.0, 495.0, 565.0, 395.0, 150.0, 210.0, 340.0, 60.0, 145.0, 0.0, 195.0, 400.0, 320.0, 740.0, 180.0, 445.0, 0.0, 30.0, 665.0, 470.0, 230.0, 745.0, 680.0, 130.0, 335.0, 385.0, 410.0, 375.0, 345.0, 505.0, 265.0, 525.0, 150.0, 350.0, 270.0, 445.0, 730.0, 0.0, 545.0, 190.0, 600.0, 470.0, 810.0, 130.0, 290.0, 310.0, 625.0, 865.0, 365.0, 210.0, 550.0, 285.0, 0.0, 0.0, 815.0, 240.0, 565.0, 405.0, 520.0, 215.0, 325.0, 205.0, 525.0, 385.0, 0.0, 0.0, 515.0, 765.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7131852384468321, "mean_inference_ms": 1.75778584923849, "mean_action_processing_ms": 0.2806655116638176, "mean_env_wait_ms": 0.20147939514771576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009085416793823242, "StateBufferConnector_ms": 0.003778815269470215, "ViewRequirementAgentConnector_ms": 0.1242990493774414}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": -2183.0, "episode_return_mean": -528.11, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.93210075336118, "num_env_steps_trained_throughput_per_sec": 79.93210075336118, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 50681.826, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50681.778, "sample_time_ms": 1394.092, "learn_time_ms": 49270.177, "learn_throughput": 81.185, "synch_weights_time_ms": 14.117}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "ed30a_00000", "date": "2024-08-12_14-44-21", "timestamp": 1723488261, "time_this_iter_s": 50.08611989021301, "time_total_s": 1687.116626739502, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012b8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1687.116626739502, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 35.458571428571425, "ram_util_percent": 82.9785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5095937329625326, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.524462051240224, "policy_loss": -0.012567532194837455, "vf_loss": 8.536135299117477, "vf_explained_var": -1.9166046980196838e-05, "kl": 0.011923481101886922, "entropy": 1.0991856588257685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.491946044926921, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.003148278988228, "policy_loss": -0.012410432197863147, "vf_loss": 6.014580608549572, "vf_explained_var": 0.01940933866475625, "kl": 0.013041644346857678, "entropy": 1.2896017140812344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2237.0, "episode_reward_mean": -597.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -633.415, "predator_policy": 334.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [226.0, -324.0, 41.0, -1090.0, 25.0, -945.0, -335.0, 67.0, -241.0, -505.0, -477.0, 244.0, -225.0, 152.0, -786.0, -994.0, 202.0, -973.0, -270.0, -1879.0, -1445.0, 52.0, -1372.0, 400.0, -1702.0, 82.0, 370.0, -1159.0, -730.0, -1036.0, 45.0, -1363.0, -366.0, -999.0, -732.0, -494.0, -755.0, -263.0, -722.0, -236.0, -996.0, -851.0, 400.0, 111.0, -1350.0, -517.0, -244.0, -216.0, -343.0, -1445.0, -703.0, 41.0, 226.0, -171.0, -377.0, -1362.0, 364.0, -2183.0, -1452.0, -1815.0, -310.0, -377.0, -1577.0, -1758.0, -926.0, -249.0, -487.0, -306.0, -1940.0, -552.0, -991.0, -794.0, -543.0, -569.0, 400.0, -338.0, -1292.0, -339.0, -93.0, -1594.0, 400.0, -2115.0, -528.0, -485.0, -1976.0, -332.0, -285.0, -32.0, 400.0, -420.0, -375.0, -579.0, -82.0, -119.0, -534.0, -118.0, -2237.0, -85.0, -1867.0, -369.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -119.0, -559.0, -295.0, -504.0, 200.0, -1010.0, -680.0, -570.0, 200.0, -790.0, -845.0, -141.0, -889.0, -405.0, 167.0, -229.0, -317.0, -482.0, -438.0, -383.0, -394.0, -185.0, 189.0, -251.0, -229.0, -273.0, 200.0, -603.0, -548.0, -845.0, -669.0, -163.0, 200.0, -702.0, -911.0, -339.0, -251.0, -1252.0, -1472.0, -1186.0, -944.0, -152.0, -86.0, -1021.0, -1076.0, 200.0, 200.0, -1208.0, -1219.0, 68.0, -141.0, 156.0, 189.0, -878.0, -856.0, -680.0, -515.0, -768.0, -878.0, -515.0, 200.0, -966.0, -1362.0, 200.0, -1296.0, -856.0, -713.0, -581.0, -966.0, -559.0, -405.0, -724.0, -746.0, -977.0, 24.0, -526.0, -526.0, -944.0, 178.0, -999.0, -922.0, -658.0, -823.0, 200.0, 200.0, 134.0, -218.0, -1527.0, -1373.0, -1373.0, -9.0, 101.0, -900.0, 200.0, -966.0, 178.0, -1571.0, -1252.0, -1153.0, -504.0, -559.0, -559.0, 200.0, 200.0, -119.0, -966.0, 200.0, -1637.0, 200.0, -1021.0, -966.0, 200.0, 134.0, -1725.0, -1593.0, -1340.0, -1087.0, -1307.0, -1318.0, 189.0, -1219.0, 79.0, -1241.0, -1142.0, -1285.0, -1285.0, -1263.0, -724.0, -702.0, -1087.0, 123.0, 189.0, -1406.0, -1087.0, 46.0, -1395.0, -1615.0, 134.0, -1626.0, -779.0, -812.0, -1483.0, -801.0, -394.0, -724.0, -1164.0, -240.0, 200.0, 200.0, 79.0, -1472.0, -955.0, -1307.0, -1098.0, 24.0, 178.0, -801.0, -1274.0, -1230.0, 200.0, 200.0, -1703.0, -1692.0, -1395.0, -108.0, -240.0, -1725.0, -1274.0, -1802.0, 178.0, -2000.0, 123.0, -1538.0, 200.0, -1087.0, 200.0, 200.0, 200.0, -1560.0, 200.0, -1725.0, -1835.0, 101.0, -350.0, -42.0, 200.0, -1494.0, -1714.0, 200.0, -1208.0, 200.0, -1747.0, -1670.0, -1384.0, 189.0, -1109.0, -1593.0, 200.0, -1769.0], "policy_predator_policy_reward": [100.0, 45.0, 250.0, 280.0, 70.0, 275.0, 120.0, 480.0, 350.0, 45.0, 520.0, 170.0, 475.0, 220.0, 190.0, 115.0, 75.0, 230.0, 205.0, 210.0, 100.0, 200.0, 150.0, 90.0, 135.0, 120.0, 15.0, 210.0, 235.0, 130.0, 355.0, 165.0, 120.0, 45.0, 355.0, 285.0, 105.0, 215.0, 115.0, 730.0, 400.0, 285.0, 175.0, 115.0, 160.0, 565.0, 0.0, 0.0, 320.0, 405.0, 95.0, 60.0, 5.0, 20.0, 395.0, 180.0, 290.0, 175.0, 405.0, 205.0, 35.0, 325.0, 335.0, 630.0, 150.0, 580.0, 260.0, 310.0, 380.0, 435.0, 280.0, 190.0, 445.0, 270.0, 425.0, 265.0, 250.0, 80.0, 135.0, 395.0, 560.0, 365.0, 420.0, 210.0, 0.0, 0.0, 195.0, 0.0, 750.0, 800.0, 495.0, 370.0, 140.0, 415.0, 80.0, 470.0, 555.0, 495.0, 565.0, 395.0, 150.0, 210.0, 340.0, 60.0, 145.0, 0.0, 195.0, 400.0, 320.0, 740.0, 180.0, 445.0, 0.0, 30.0, 665.0, 470.0, 230.0, 745.0, 680.0, 130.0, 335.0, 385.0, 410.0, 375.0, 345.0, 505.0, 265.0, 525.0, 150.0, 350.0, 270.0, 445.0, 730.0, 0.0, 545.0, 190.0, 600.0, 470.0, 810.0, 130.0, 290.0, 310.0, 625.0, 865.0, 365.0, 210.0, 550.0, 285.0, 0.0, 0.0, 815.0, 240.0, 565.0, 405.0, 520.0, 215.0, 325.0, 205.0, 525.0, 385.0, 0.0, 0.0, 515.0, 765.0, 285.0, 690.0, 810.0, 670.0, 945.0, 155.0, 490.0, 1000.0, 470.0, 660.0, 335.0, 520.0, 0.0, 0.0, 265.0, 675.0, 600.0, 550.0, 750.0, 405.0, 230.0, 80.0, 550.0, 625.0, 455.0, 525.0, 580.0, 310.0, 380.0, 800.0, 595.0, 515.0, 715.0, 120.0, 715.0, 485.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7126759684560235, "mean_inference_ms": 1.7508548190430917, "mean_action_processing_ms": 0.280343685226696, "mean_env_wait_ms": 0.20095366219300734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006925106048583984, "StateBufferConnector_ms": 0.003777623176574707, "ViewRequirementAgentConnector_ms": 0.12574338912963867}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2237.0, "episode_return_mean": -597.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.81917205752809, "num_env_steps_trained_throughput_per_sec": 77.81917205752809, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 50688.489, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50688.439, "sample_time_ms": 1408.865, "learn_time_ms": 49262.044, "learn_throughput": 81.198, "synch_weights_time_ms": 14.19}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "ed30a_00000", "date": "2024-08-12_14-45-13", "timestamp": 1723488313, "time_this_iter_s": 51.43580079078674, "time_total_s": 1738.5524275302887, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1738.5524275302887, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 38.484931506849314, "ram_util_percent": 82.93561643835616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4875621278134603, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.856081512996129, "policy_loss": -0.009962103402527867, "vf_loss": 6.865460887535539, "vf_explained_var": -2.4061480527201657e-05, "kl": 0.0077694919720344155, "entropy": 1.0686380028724671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.495372588798483, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.199803297481839, "policy_loss": -0.014488703370335754, "vf_loss": 5.212976570861049, "vf_explained_var": 0.02228801480676762, "kl": 0.01753902722483049, "entropy": 1.3133136643303764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2237.0, "episode_reward_mean": -622.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -681.54, "predator_policy": 370.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-270.0, -1879.0, -1445.0, 52.0, -1372.0, 400.0, -1702.0, 82.0, 370.0, -1159.0, -730.0, -1036.0, 45.0, -1363.0, -366.0, -999.0, -732.0, -494.0, -755.0, -263.0, -722.0, -236.0, -996.0, -851.0, 400.0, 111.0, -1350.0, -517.0, -244.0, -216.0, -343.0, -1445.0, -703.0, 41.0, 226.0, -171.0, -377.0, -1362.0, 364.0, -2183.0, -1452.0, -1815.0, -310.0, -377.0, -1577.0, -1758.0, -926.0, -249.0, -487.0, -306.0, -1940.0, -552.0, -991.0, -794.0, -543.0, -569.0, 400.0, -338.0, -1292.0, -339.0, -93.0, -1594.0, 400.0, -2115.0, -528.0, -485.0, -1976.0, -332.0, -285.0, -32.0, 400.0, -420.0, -375.0, -579.0, -82.0, -119.0, -534.0, -118.0, -2237.0, -85.0, -1867.0, -369.0, -1904.0, -945.0, -1310.0, -1241.0, -838.0, 148.0, -334.0, 400.0, -317.0, -576.0, 17.0, 400.0, -2190.0, 175.0, 388.0, -283.0, 400.0, -418.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-339.0, -251.0, -1252.0, -1472.0, -1186.0, -944.0, -152.0, -86.0, -1021.0, -1076.0, 200.0, 200.0, -1208.0, -1219.0, 68.0, -141.0, 156.0, 189.0, -878.0, -856.0, -680.0, -515.0, -768.0, -878.0, -515.0, 200.0, -966.0, -1362.0, 200.0, -1296.0, -856.0, -713.0, -581.0, -966.0, -559.0, -405.0, -724.0, -746.0, -977.0, 24.0, -526.0, -526.0, -944.0, 178.0, -999.0, -922.0, -658.0, -823.0, 200.0, 200.0, 134.0, -218.0, -1527.0, -1373.0, -1373.0, -9.0, 101.0, -900.0, 200.0, -966.0, 178.0, -1571.0, -1252.0, -1153.0, -504.0, -559.0, -559.0, 200.0, 200.0, -119.0, -966.0, 200.0, -1637.0, 200.0, -1021.0, -966.0, 200.0, 134.0, -1725.0, -1593.0, -1340.0, -1087.0, -1307.0, -1318.0, 189.0, -1219.0, 79.0, -1241.0, -1142.0, -1285.0, -1285.0, -1263.0, -724.0, -702.0, -1087.0, 123.0, 189.0, -1406.0, -1087.0, 46.0, -1395.0, -1615.0, 134.0, -1626.0, -779.0, -812.0, -1483.0, -801.0, -394.0, -724.0, -1164.0, -240.0, 200.0, 200.0, 79.0, -1472.0, -955.0, -1307.0, -1098.0, 24.0, 178.0, -801.0, -1274.0, -1230.0, 200.0, 200.0, -1703.0, -1692.0, -1395.0, -108.0, -240.0, -1725.0, -1274.0, -1802.0, 178.0, -2000.0, 123.0, -1538.0, 200.0, -1087.0, 200.0, 200.0, 200.0, -1560.0, 200.0, -1725.0, -1835.0, 101.0, -350.0, -42.0, 200.0, -1494.0, -1714.0, 200.0, -1208.0, 200.0, -1747.0, -1670.0, -1384.0, 189.0, -1109.0, -1593.0, 200.0, -1769.0, -1945.0, -1549.0, -1659.0, -856.0, -647.0, -1758.0, -1032.0, -1384.0, -1109.0, -504.0, 200.0, -262.0, 178.0, -1582.0, 200.0, 200.0, -1505.0, -207.0, -130.0, -1516.0, -713.0, 200.0, 200.0, 200.0, -1791.0, -1769.0, 13.0, 57.0, 200.0, 178.0, 200.0, -1923.0, 200.0, 200.0, -1395.0, 112.0], "policy_predator_policy_reward": [105.0, 215.0, 115.0, 730.0, 400.0, 285.0, 175.0, 115.0, 160.0, 565.0, 0.0, 0.0, 320.0, 405.0, 95.0, 60.0, 5.0, 20.0, 395.0, 180.0, 290.0, 175.0, 405.0, 205.0, 35.0, 325.0, 335.0, 630.0, 150.0, 580.0, 260.0, 310.0, 380.0, 435.0, 280.0, 190.0, 445.0, 270.0, 425.0, 265.0, 250.0, 80.0, 135.0, 395.0, 560.0, 365.0, 420.0, 210.0, 0.0, 0.0, 195.0, 0.0, 750.0, 800.0, 495.0, 370.0, 140.0, 415.0, 80.0, 470.0, 555.0, 495.0, 565.0, 395.0, 150.0, 210.0, 340.0, 60.0, 145.0, 0.0, 195.0, 400.0, 320.0, 740.0, 180.0, 445.0, 0.0, 30.0, 665.0, 470.0, 230.0, 745.0, 680.0, 130.0, 335.0, 385.0, 410.0, 375.0, 345.0, 505.0, 265.0, 525.0, 150.0, 350.0, 270.0, 445.0, 730.0, 0.0, 545.0, 190.0, 600.0, 470.0, 810.0, 130.0, 290.0, 310.0, 625.0, 865.0, 365.0, 210.0, 550.0, 285.0, 0.0, 0.0, 815.0, 240.0, 565.0, 405.0, 520.0, 215.0, 325.0, 205.0, 525.0, 385.0, 0.0, 0.0, 515.0, 765.0, 285.0, 690.0, 810.0, 670.0, 945.0, 155.0, 490.0, 1000.0, 470.0, 660.0, 335.0, 520.0, 0.0, 0.0, 265.0, 675.0, 600.0, 550.0, 750.0, 405.0, 230.0, 80.0, 550.0, 625.0, 455.0, 525.0, 580.0, 310.0, 380.0, 800.0, 595.0, 515.0, 715.0, 120.0, 715.0, 485.0, 770.0, 820.0, 870.0, 700.0, 405.0, 690.0, 595.0, 580.0, 420.0, 355.0, 210.0, 0.0, 675.0, 395.0, 0.0, 0.0, 615.0, 780.0, 470.0, 600.0, 365.0, 165.0, 0.0, 0.0, 520.0, 850.0, 90.0, 15.0, 0.0, 10.0, 620.0, 820.0, 0.0, 0.0, 355.0, 510.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7116493394883375, "mean_inference_ms": 1.745708920091671, "mean_action_processing_ms": 0.28006547055684516, "mean_env_wait_ms": 0.20078373957558196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006752490997314453, "StateBufferConnector_ms": 0.003956794738769531, "ViewRequirementAgentConnector_ms": 0.14267468452453613}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2237.0, "episode_return_mean": -622.58, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.81075513152818, "num_env_steps_trained_throughput_per_sec": 77.81075513152818, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 50676.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50676.203, "sample_time_ms": 1446.777, "learn_time_ms": 49212.098, "learn_throughput": 81.281, "synch_weights_time_ms": 14.118}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "ed30a_00000", "date": "2024-08-12_14-46-04", "timestamp": 1723488364, "time_this_iter_s": 51.429035902023315, "time_total_s": 1789.981463432312, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1789.981463432312, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 39.53783783783784, "ram_util_percent": 82.43378378378378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4432000495611674, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.132092054684957, "policy_loss": -0.009623571037359181, "vf_loss": 4.141166625073347, "vf_explained_var": -2.2289298829578216e-06, "kl": 0.007319936837003354, "entropy": 1.045170818497895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.457478870285883, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8583480329740616, "policy_loss": -0.0162470333159916, "vf_loss": 2.8734316433548295, "vf_explained_var": 0.03451932678146968, "kl": 0.015512262990153049, "entropy": 1.3371086127543577, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2237.0, "episode_reward_mean": -529.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -644.525, "predator_policy": 379.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-755.0, -263.0, -722.0, -236.0, -996.0, -851.0, 400.0, 111.0, -1350.0, -517.0, -244.0, -216.0, -343.0, -1445.0, -703.0, 41.0, 226.0, -171.0, -377.0, -1362.0, 364.0, -2183.0, -1452.0, -1815.0, -310.0, -377.0, -1577.0, -1758.0, -926.0, -249.0, -487.0, -306.0, -1940.0, -552.0, -991.0, -794.0, -543.0, -569.0, 400.0, -338.0, -1292.0, -339.0, -93.0, -1594.0, 400.0, -2115.0, -528.0, -485.0, -1976.0, -332.0, -285.0, -32.0, 400.0, -420.0, -375.0, -579.0, -82.0, -119.0, -534.0, -118.0, -2237.0, -85.0, -1867.0, -369.0, -1904.0, -945.0, -1310.0, -1241.0, -838.0, 148.0, -334.0, 400.0, -317.0, -576.0, 17.0, 400.0, -2190.0, 175.0, 388.0, -283.0, 400.0, -418.0, 109.0, 143.0, 41.0, 358.0, -405.0, -83.0, -126.0, 335.0, -29.0, -270.0, 310.0, 304.0, -1800.0, 94.0, -631.0, 232.0, -2032.0, 165.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-724.0, -746.0, -977.0, 24.0, -526.0, -526.0, -944.0, 178.0, -999.0, -922.0, -658.0, -823.0, 200.0, 200.0, 134.0, -218.0, -1527.0, -1373.0, -1373.0, -9.0, 101.0, -900.0, 200.0, -966.0, 178.0, -1571.0, -1252.0, -1153.0, -504.0, -559.0, -559.0, 200.0, 200.0, -119.0, -966.0, 200.0, -1637.0, 200.0, -1021.0, -966.0, 200.0, 134.0, -1725.0, -1593.0, -1340.0, -1087.0, -1307.0, -1318.0, 189.0, -1219.0, 79.0, -1241.0, -1142.0, -1285.0, -1285.0, -1263.0, -724.0, -702.0, -1087.0, 123.0, 189.0, -1406.0, -1087.0, 46.0, -1395.0, -1615.0, 134.0, -1626.0, -779.0, -812.0, -1483.0, -801.0, -394.0, -724.0, -1164.0, -240.0, 200.0, 200.0, 79.0, -1472.0, -955.0, -1307.0, -1098.0, 24.0, 178.0, -801.0, -1274.0, -1230.0, 200.0, 200.0, -1703.0, -1692.0, -1395.0, -108.0, -240.0, -1725.0, -1274.0, -1802.0, 178.0, -2000.0, 123.0, -1538.0, 200.0, -1087.0, 200.0, 200.0, 200.0, -1560.0, 200.0, -1725.0, -1835.0, 101.0, -350.0, -42.0, 200.0, -1494.0, -1714.0, 200.0, -1208.0, 200.0, -1747.0, -1670.0, -1384.0, 189.0, -1109.0, -1593.0, 200.0, -1769.0, -1945.0, -1549.0, -1659.0, -856.0, -647.0, -1758.0, -1032.0, -1384.0, -1109.0, -504.0, 200.0, -262.0, 178.0, -1582.0, 200.0, 200.0, -1505.0, -207.0, -130.0, -1516.0, -713.0, 200.0, 200.0, 200.0, -1791.0, -1769.0, 13.0, 57.0, 200.0, 178.0, 200.0, -1923.0, 200.0, 200.0, -1395.0, 112.0, 200.0, -471.0, -317.0, 200.0, -163.0, -31.0, 134.0, 189.0, -1538.0, 68.0, -1593.0, 200.0, 200.0, -1571.0, 46.0, 189.0, -1164.0, 200.0, 200.0, -1890.0, 112.0, 123.0, 24.0, 200.0, -1549.0, -1406.0, -86.0, -75.0, -394.0, -1032.0, 46.0, 46.0, -1681.0, -1846.0, -273.0, 178.0], "policy_predator_policy_reward": [445.0, 270.0, 425.0, 265.0, 250.0, 80.0, 135.0, 395.0, 560.0, 365.0, 420.0, 210.0, 0.0, 0.0, 195.0, 0.0, 750.0, 800.0, 495.0, 370.0, 140.0, 415.0, 80.0, 470.0, 555.0, 495.0, 565.0, 395.0, 150.0, 210.0, 340.0, 60.0, 145.0, 0.0, 195.0, 400.0, 320.0, 740.0, 180.0, 445.0, 0.0, 30.0, 665.0, 470.0, 230.0, 745.0, 680.0, 130.0, 335.0, 385.0, 410.0, 375.0, 345.0, 505.0, 265.0, 525.0, 150.0, 350.0, 270.0, 445.0, 730.0, 0.0, 545.0, 190.0, 600.0, 470.0, 810.0, 130.0, 290.0, 310.0, 625.0, 865.0, 365.0, 210.0, 550.0, 285.0, 0.0, 0.0, 815.0, 240.0, 565.0, 405.0, 520.0, 215.0, 325.0, 205.0, 525.0, 385.0, 0.0, 0.0, 515.0, 765.0, 285.0, 690.0, 810.0, 670.0, 945.0, 155.0, 490.0, 1000.0, 470.0, 660.0, 335.0, 520.0, 0.0, 0.0, 265.0, 675.0, 600.0, 550.0, 750.0, 405.0, 230.0, 80.0, 550.0, 625.0, 455.0, 525.0, 580.0, 310.0, 380.0, 800.0, 595.0, 515.0, 715.0, 120.0, 715.0, 485.0, 770.0, 820.0, 870.0, 700.0, 405.0, 690.0, 595.0, 580.0, 420.0, 355.0, 210.0, 0.0, 675.0, 395.0, 0.0, 0.0, 615.0, 780.0, 470.0, 600.0, 365.0, 165.0, 0.0, 0.0, 520.0, 850.0, 90.0, 15.0, 0.0, 10.0, 620.0, 820.0, 0.0, 0.0, 355.0, 510.0, 130.0, 250.0, 230.0, 30.0, 75.0, 160.0, 5.0, 30.0, 570.0, 495.0, 795.0, 515.0, 710.0, 535.0, 75.0, 25.0, 615.0, 320.0, 875.0, 545.0, 75.0, 0.0, 0.0, 80.0, 465.0, 690.0, 80.0, 175.0, 315.0, 480.0, 70.0, 70.0, 725.0, 770.0, 70.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7108200743578275, "mean_inference_ms": 1.7408061622095443, "mean_action_processing_ms": 0.27982377196031233, "mean_env_wait_ms": 0.20062679158060995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006671786308288574, "StateBufferConnector_ms": 0.0039833784103393555, "ViewRequirementAgentConnector_ms": 0.1429288387298584}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2237.0, "episode_return_mean": -529.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 75.07971013581519, "num_env_steps_trained_throughput_per_sec": 75.07971013581519, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 50696.407, "restore_workers_time_ms": 0.013, "training_step_time_ms": 50696.357, "sample_time_ms": 1447.385, "learn_time_ms": 49231.674, "learn_throughput": 81.249, "synch_weights_time_ms": 14.333}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "ed30a_00000", "date": "2024-08-12_14-46-58", "timestamp": 1723488418, "time_this_iter_s": 53.308685064315796, "time_total_s": 1843.2901484966278, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12701f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1843.2901484966278, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 43.61066666666666, "ram_util_percent": 83.04}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.364698191870142, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7240731794840445, "policy_loss": -0.008049936370096274, "vf_loss": 0.7316245587966429, "vf_explained_var": -0.00021940614811327092, "kl": 0.00664741932488115, "entropy": 1.0248436962485945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.39235730297351, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7028158501251329, "policy_loss": -0.01664715597292694, "vf_loss": 0.7183965465733929, "vf_explained_var": 0.04640248748991224, "kl": 0.014219445264522627, "entropy": 1.3022619700936413, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2237.0, "episode_reward_mean": -361.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -512.69, "predator_policy": 331.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1452.0, -1815.0, -310.0, -377.0, -1577.0, -1758.0, -926.0, -249.0, -487.0, -306.0, -1940.0, -552.0, -991.0, -794.0, -543.0, -569.0, 400.0, -338.0, -1292.0, -339.0, -93.0, -1594.0, 400.0, -2115.0, -528.0, -485.0, -1976.0, -332.0, -285.0, -32.0, 400.0, -420.0, -375.0, -579.0, -82.0, -119.0, -534.0, -118.0, -2237.0, -85.0, -1867.0, -369.0, -1904.0, -945.0, -1310.0, -1241.0, -838.0, 148.0, -334.0, 400.0, -317.0, -576.0, 17.0, 400.0, -2190.0, 175.0, 388.0, -283.0, 400.0, -418.0, 109.0, 143.0, 41.0, 358.0, -405.0, -83.0, -126.0, 335.0, -29.0, -270.0, 310.0, 304.0, -1800.0, 94.0, -631.0, 232.0, -2032.0, 165.0, -244.0, 271.0, 400.0, 103.0, 312.0, 400.0, 166.0, 364.0, 111.0, 121.0, -77.0, 326.0, 388.0, 376.0, 394.0, 364.0, 218.0, 364.0, -67.0, 174.0, 316.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1340.0, -1087.0, -1307.0, -1318.0, 189.0, -1219.0, 79.0, -1241.0, -1142.0, -1285.0, -1285.0, -1263.0, -724.0, -702.0, -1087.0, 123.0, 189.0, -1406.0, -1087.0, 46.0, -1395.0, -1615.0, 134.0, -1626.0, -779.0, -812.0, -1483.0, -801.0, -394.0, -724.0, -1164.0, -240.0, 200.0, 200.0, 79.0, -1472.0, -955.0, -1307.0, -1098.0, 24.0, 178.0, -801.0, -1274.0, -1230.0, 200.0, 200.0, -1703.0, -1692.0, -1395.0, -108.0, -240.0, -1725.0, -1274.0, -1802.0, 178.0, -2000.0, 123.0, -1538.0, 200.0, -1087.0, 200.0, 200.0, 200.0, -1560.0, 200.0, -1725.0, -1835.0, 101.0, -350.0, -42.0, 200.0, -1494.0, -1714.0, 200.0, -1208.0, 200.0, -1747.0, -1670.0, -1384.0, 189.0, -1109.0, -1593.0, 200.0, -1769.0, -1945.0, -1549.0, -1659.0, -856.0, -647.0, -1758.0, -1032.0, -1384.0, -1109.0, -504.0, 200.0, -262.0, 178.0, -1582.0, 200.0, 200.0, -1505.0, -207.0, -130.0, -1516.0, -713.0, 200.0, 200.0, 200.0, -1791.0, -1769.0, 13.0, 57.0, 200.0, 178.0, 200.0, -1923.0, 200.0, 200.0, -1395.0, 112.0, 200.0, -471.0, -317.0, 200.0, -163.0, -31.0, 134.0, 189.0, -1538.0, 68.0, -1593.0, 200.0, 200.0, -1571.0, 46.0, 189.0, -1164.0, 200.0, 200.0, -1890.0, 112.0, 123.0, 24.0, 200.0, -1549.0, -1406.0, -86.0, -75.0, -394.0, -1032.0, 46.0, 46.0, -1681.0, -1846.0, -273.0, 178.0, 200.0, -1494.0, 200.0, -174.0, 200.0, 200.0, -284.0, 112.0, 200.0, 2.0, 200.0, 200.0, -229.0, 200.0, 134.0, 200.0, 68.0, -152.0, -251.0, 167.0, -229.0, -108.0, 145.0, 156.0, 178.0, 200.0, 200.0, 156.0, 200.0, 189.0, 134.0, 200.0, -141.0, 134.0, 134.0, 200.0, 200.0, -1472.0, 90.0, -31.0, 46.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [230.0, 745.0, 680.0, 130.0, 335.0, 385.0, 410.0, 375.0, 345.0, 505.0, 265.0, 525.0, 150.0, 350.0, 270.0, 445.0, 730.0, 0.0, 545.0, 190.0, 600.0, 470.0, 810.0, 130.0, 290.0, 310.0, 625.0, 865.0, 365.0, 210.0, 550.0, 285.0, 0.0, 0.0, 815.0, 240.0, 565.0, 405.0, 520.0, 215.0, 325.0, 205.0, 525.0, 385.0, 0.0, 0.0, 515.0, 765.0, 285.0, 690.0, 810.0, 670.0, 945.0, 155.0, 490.0, 1000.0, 470.0, 660.0, 335.0, 520.0, 0.0, 0.0, 265.0, 675.0, 600.0, 550.0, 750.0, 405.0, 230.0, 80.0, 550.0, 625.0, 455.0, 525.0, 580.0, 310.0, 380.0, 800.0, 595.0, 515.0, 715.0, 120.0, 715.0, 485.0, 770.0, 820.0, 870.0, 700.0, 405.0, 690.0, 595.0, 580.0, 420.0, 355.0, 210.0, 0.0, 675.0, 395.0, 0.0, 0.0, 615.0, 780.0, 470.0, 600.0, 365.0, 165.0, 0.0, 0.0, 520.0, 850.0, 90.0, 15.0, 0.0, 10.0, 620.0, 820.0, 0.0, 0.0, 355.0, 510.0, 130.0, 250.0, 230.0, 30.0, 75.0, 160.0, 5.0, 30.0, 570.0, 495.0, 795.0, 515.0, 710.0, 535.0, 75.0, 25.0, 615.0, 320.0, 875.0, 545.0, 75.0, 0.0, 0.0, 80.0, 465.0, 690.0, 80.0, 175.0, 315.0, 480.0, 70.0, 70.0, 725.0, 770.0, 70.0, 190.0, 415.0, 635.0, 85.0, 160.0, 0.0, 0.0, 210.0, 65.0, 90.0, 20.0, 0.0, 0.0, 125.0, 70.0, 30.0, 0.0, 155.0, 40.0, 0.0, 205.0, 185.0, 75.0, 0.0, 25.0, 10.0, 0.0, 0.0, 20.0, 0.0, 5.0, 30.0, 0.0, 145.0, 80.0, 0.0, 30.0, 720.0, 485.0, 20.0, 95.0, 35.0, 35.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7103211515971811, "mean_inference_ms": 1.7363120383159067, "mean_action_processing_ms": 0.27964760575366315, "mean_env_wait_ms": 0.20052827330515732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006937265396118164, "StateBufferConnector_ms": 0.0035761594772338867, "ViewRequirementAgentConnector_ms": 0.14089417457580566}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2237.0, "episode_return_mean": -361.73, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.71173135279895, "num_env_steps_trained_throughput_per_sec": 78.71173135279895, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 50667.754, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50667.704, "sample_time_ms": 1446.911, "learn_time_ms": 49204.004, "learn_throughput": 81.294, "synch_weights_time_ms": 13.919}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "ed30a_00000", "date": "2024-08-12_14-47-49", "timestamp": 1723488469, "time_this_iter_s": 50.860026121139526, "time_total_s": 1894.1501746177673, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1894.1501746177673, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 39.37123287671233, "ram_util_percent": 83.18356164383562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3824478253564507, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9209462687846214, "policy_loss": -0.006448488407300184, "vf_loss": 0.9269411940828567, "vf_explained_var": -0.0006213410821541277, "kl": 0.006047490663818479, "entropy": 1.0317320533530423, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.521040608154403, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2616471621409926, "policy_loss": -0.012857108144582343, "vf_loss": 1.2735870671493035, "vf_explained_var": 0.020602727724761558, "kl": 0.012229375655584412, "entropy": 1.322447030064921, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2237.0, "episode_reward_mean": -120.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -315.35, "predator_policy": 254.95}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2115.0, -528.0, -485.0, -1976.0, -332.0, -285.0, -32.0, 400.0, -420.0, -375.0, -579.0, -82.0, -119.0, -534.0, -118.0, -2237.0, -85.0, -1867.0, -369.0, -1904.0, -945.0, -1310.0, -1241.0, -838.0, 148.0, -334.0, 400.0, -317.0, -576.0, 17.0, 400.0, -2190.0, 175.0, 388.0, -283.0, 400.0, -418.0, 109.0, 143.0, 41.0, 358.0, -405.0, -83.0, -126.0, 335.0, -29.0, -270.0, 310.0, 304.0, -1800.0, 94.0, -631.0, 232.0, -2032.0, 165.0, -244.0, 271.0, 400.0, 103.0, 312.0, 400.0, 166.0, 364.0, 111.0, 121.0, -77.0, 326.0, 388.0, 376.0, 394.0, 364.0, 218.0, 364.0, -67.0, 174.0, 316.0, 400.0, 268.0, 356.0, 382.0, 352.0, 400.0, 257.0, 370.0, 394.0, 400.0, 394.0, 400.0, 400.0, -734.0, 370.0, 166.0, 352.0, 400.0, 199.0, 359.0, 316.0, 346.0, 163.0, 281.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1703.0, -1692.0, -1395.0, -108.0, -240.0, -1725.0, -1274.0, -1802.0, 178.0, -2000.0, 123.0, -1538.0, 200.0, -1087.0, 200.0, 200.0, 200.0, -1560.0, 200.0, -1725.0, -1835.0, 101.0, -350.0, -42.0, 200.0, -1494.0, -1714.0, 200.0, -1208.0, 200.0, -1747.0, -1670.0, -1384.0, 189.0, -1109.0, -1593.0, 200.0, -1769.0, -1945.0, -1549.0, -1659.0, -856.0, -647.0, -1758.0, -1032.0, -1384.0, -1109.0, -504.0, 200.0, -262.0, 178.0, -1582.0, 200.0, 200.0, -1505.0, -207.0, -130.0, -1516.0, -713.0, 200.0, 200.0, 200.0, -1791.0, -1769.0, 13.0, 57.0, 200.0, 178.0, 200.0, -1923.0, 200.0, 200.0, -1395.0, 112.0, 200.0, -471.0, -317.0, 200.0, -163.0, -31.0, 134.0, 189.0, -1538.0, 68.0, -1593.0, 200.0, 200.0, -1571.0, 46.0, 189.0, -1164.0, 200.0, 200.0, -1890.0, 112.0, 123.0, 24.0, 200.0, -1549.0, -1406.0, -86.0, -75.0, -394.0, -1032.0, 46.0, 46.0, -1681.0, -1846.0, -273.0, 178.0, 200.0, -1494.0, 200.0, -174.0, 200.0, 200.0, -284.0, 112.0, 200.0, 2.0, 200.0, 200.0, -229.0, 200.0, 134.0, 200.0, 68.0, -152.0, -251.0, 167.0, -229.0, -108.0, 145.0, 156.0, 178.0, 200.0, 200.0, 156.0, 200.0, 189.0, 134.0, 200.0, -141.0, 134.0, 134.0, 200.0, 200.0, -1472.0, 90.0, -31.0, 46.0, 200.0, 200.0, 200.0, 200.0, -42.0, 200.0, 101.0, 200.0, 167.0, 178.0, 134.0, 200.0, 200.0, -273.0, 200.0, 200.0, 145.0, 189.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -559.0, -570.0, 145.0, 200.0, -86.0, 57.0, 112.0, 200.0, 200.0, 200.0, -163.0, 112.0, 35.0, 189.0, 178.0, 68.0, 178.0, 123.0, -20.0, 68.0, 112.0, 79.0], "policy_predator_policy_reward": [515.0, 765.0, 285.0, 690.0, 810.0, 670.0, 945.0, 155.0, 490.0, 1000.0, 470.0, 660.0, 335.0, 520.0, 0.0, 0.0, 265.0, 675.0, 600.0, 550.0, 750.0, 405.0, 230.0, 80.0, 550.0, 625.0, 455.0, 525.0, 580.0, 310.0, 380.0, 800.0, 595.0, 515.0, 715.0, 120.0, 715.0, 485.0, 770.0, 820.0, 870.0, 700.0, 405.0, 690.0, 595.0, 580.0, 420.0, 355.0, 210.0, 0.0, 675.0, 395.0, 0.0, 0.0, 615.0, 780.0, 470.0, 600.0, 365.0, 165.0, 0.0, 0.0, 520.0, 850.0, 90.0, 15.0, 0.0, 10.0, 620.0, 820.0, 0.0, 0.0, 355.0, 510.0, 130.0, 250.0, 230.0, 30.0, 75.0, 160.0, 5.0, 30.0, 570.0, 495.0, 795.0, 515.0, 710.0, 535.0, 75.0, 25.0, 615.0, 320.0, 875.0, 545.0, 75.0, 0.0, 0.0, 80.0, 465.0, 690.0, 80.0, 175.0, 315.0, 480.0, 70.0, 70.0, 725.0, 770.0, 70.0, 190.0, 415.0, 635.0, 85.0, 160.0, 0.0, 0.0, 210.0, 65.0, 90.0, 20.0, 0.0, 0.0, 125.0, 70.0, 30.0, 0.0, 155.0, 40.0, 0.0, 205.0, 185.0, 75.0, 0.0, 25.0, 10.0, 0.0, 0.0, 20.0, 0.0, 5.0, 30.0, 0.0, 145.0, 80.0, 0.0, 30.0, 720.0, 485.0, 20.0, 95.0, 35.0, 35.0, 0.0, 0.0, 110.0, 0.0, 45.0, 10.0, 15.0, 0.0, 10.0, 30.0, 0.0, 0.0, 115.0, 215.0, 25.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 0.0, 0.0, 25.0, 65.0, 130.0, 40.0, 0.0, 0.0, 0.0, 85.0, 165.0, 55.0, 80.0, 0.0, 70.0, 35.0, 10.0, 115.0, 0.0, 40.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7106084190689035, "mean_inference_ms": 1.7337738508994365, "mean_action_processing_ms": 0.27968373461889373, "mean_env_wait_ms": 0.2005860868362643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004353523254394531, "StateBufferConnector_ms": 0.0033974647521972656, "ViewRequirementAgentConnector_ms": 0.13993322849273682}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2237.0, "episode_return_mean": -120.8, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.72261524011907, "num_env_steps_trained_throughput_per_sec": 76.72261524011907, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 50946.683, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50946.633, "sample_time_ms": 1484.163, "learn_time_ms": 49446.156, "learn_throughput": 80.896, "synch_weights_time_ms": 13.337}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "ed30a_00000", "date": "2024-08-12_14-48-41", "timestamp": 1723488521, "time_this_iter_s": 52.161006927490234, "time_total_s": 1946.3111815452576, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0143430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1946.3111815452576, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 41.866216216216216, "ram_util_percent": 83.35000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4048955470481246, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.922376375791257, "policy_loss": -0.012356712933008869, "vf_loss": 1.9340028724027059, "vf_explained_var": -5.562292835699818e-05, "kl": 0.009736082311617421, "entropy": 1.014046095098768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.015348839066016, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6686360392620956, "policy_loss": -0.014682225225907232, "vf_loss": 2.6822579127140145, "vf_explained_var": 0.021945992096391306, "kl": 0.014138072992106156, "entropy": 1.3174807754773943, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2230.0, "episode_reward_mean": -11.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1945.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 885.0}, "policy_reward_mean": {"prey_policy": -190.83, "predator_policy": 185.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-369.0, -1904.0, -945.0, -1310.0, -1241.0, -838.0, 148.0, -334.0, 400.0, -317.0, -576.0, 17.0, 400.0, -2190.0, 175.0, 388.0, -283.0, 400.0, -418.0, 109.0, 143.0, 41.0, 358.0, -405.0, -83.0, -126.0, 335.0, -29.0, -270.0, 310.0, 304.0, -1800.0, 94.0, -631.0, 232.0, -2032.0, 165.0, -244.0, 271.0, 400.0, 103.0, 312.0, 400.0, 166.0, 364.0, 111.0, 121.0, -77.0, 326.0, 388.0, 376.0, 394.0, 364.0, 218.0, 364.0, -67.0, 174.0, 316.0, 400.0, 268.0, 356.0, 382.0, 352.0, 400.0, 257.0, 370.0, 394.0, 400.0, 394.0, 400.0, 400.0, -734.0, 370.0, 166.0, 352.0, 400.0, 199.0, 359.0, 316.0, 346.0, 163.0, 281.0, -1432.0, 394.0, 269.0, 400.0, 400.0, 360.0, 370.0, 126.0, -1262.0, -2230.0, 138.0, 319.0, 376.0, 264.0, -374.0, 400.0, 388.0, 304.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -1769.0, -1945.0, -1549.0, -1659.0, -856.0, -647.0, -1758.0, -1032.0, -1384.0, -1109.0, -504.0, 200.0, -262.0, 178.0, -1582.0, 200.0, 200.0, -1505.0, -207.0, -130.0, -1516.0, -713.0, 200.0, 200.0, 200.0, -1791.0, -1769.0, 13.0, 57.0, 200.0, 178.0, 200.0, -1923.0, 200.0, 200.0, -1395.0, 112.0, 200.0, -471.0, -317.0, 200.0, -163.0, -31.0, 134.0, 189.0, -1538.0, 68.0, -1593.0, 200.0, 200.0, -1571.0, 46.0, 189.0, -1164.0, 200.0, 200.0, -1890.0, 112.0, 123.0, 24.0, 200.0, -1549.0, -1406.0, -86.0, -75.0, -394.0, -1032.0, 46.0, 46.0, -1681.0, -1846.0, -273.0, 178.0, 200.0, -1494.0, 200.0, -174.0, 200.0, 200.0, -284.0, 112.0, 200.0, 2.0, 200.0, 200.0, -229.0, 200.0, 134.0, 200.0, 68.0, -152.0, -251.0, 167.0, -229.0, -108.0, 145.0, 156.0, 178.0, 200.0, 200.0, 156.0, 200.0, 189.0, 134.0, 200.0, -141.0, 134.0, 134.0, 200.0, 200.0, -1472.0, 90.0, -31.0, 46.0, 200.0, 200.0, 200.0, 200.0, -42.0, 200.0, 101.0, 200.0, 167.0, 178.0, 134.0, 200.0, 200.0, -273.0, 200.0, 200.0, 145.0, 189.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -559.0, -570.0, 145.0, 200.0, -86.0, 57.0, 112.0, 200.0, 200.0, 200.0, -163.0, 112.0, 35.0, 189.0, 178.0, 68.0, 178.0, 123.0, -20.0, 68.0, 112.0, 79.0, -933.0, -1219.0, 200.0, 189.0, -20.0, 189.0, 200.0, 200.0, 200.0, 200.0, 167.0, 178.0, 145.0, 200.0, 35.0, -119.0, -1219.0, -768.0, -1538.0, -1857.0, -471.0, 134.0, 178.0, 46.0, 200.0, 156.0, 200.0, -86.0, -295.0, -339.0, 200.0, 200.0, 200.0, 178.0, 178.0, -9.0], "policy_predator_policy_reward": [715.0, 485.0, 770.0, 820.0, 870.0, 700.0, 405.0, 690.0, 595.0, 580.0, 420.0, 355.0, 210.0, 0.0, 675.0, 395.0, 0.0, 0.0, 615.0, 780.0, 470.0, 600.0, 365.0, 165.0, 0.0, 0.0, 520.0, 850.0, 90.0, 15.0, 0.0, 10.0, 620.0, 820.0, 0.0, 0.0, 355.0, 510.0, 130.0, 250.0, 230.0, 30.0, 75.0, 160.0, 5.0, 30.0, 570.0, 495.0, 795.0, 515.0, 710.0, 535.0, 75.0, 25.0, 615.0, 320.0, 875.0, 545.0, 75.0, 0.0, 0.0, 80.0, 465.0, 690.0, 80.0, 175.0, 315.0, 480.0, 70.0, 70.0, 725.0, 770.0, 70.0, 190.0, 415.0, 635.0, 85.0, 160.0, 0.0, 0.0, 210.0, 65.0, 90.0, 20.0, 0.0, 0.0, 125.0, 70.0, 30.0, 0.0, 155.0, 40.0, 0.0, 205.0, 185.0, 75.0, 0.0, 25.0, 10.0, 0.0, 0.0, 20.0, 0.0, 5.0, 30.0, 0.0, 145.0, 80.0, 0.0, 30.0, 720.0, 485.0, 20.0, 95.0, 35.0, 35.0, 0.0, 0.0, 110.0, 0.0, 45.0, 10.0, 15.0, 0.0, 10.0, 30.0, 0.0, 0.0, 115.0, 215.0, 25.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 0.0, 0.0, 25.0, 65.0, 130.0, 40.0, 0.0, 0.0, 0.0, 85.0, 165.0, 55.0, 80.0, 0.0, 70.0, 35.0, 10.0, 115.0, 0.0, 40.0, 50.0, 720.0, 0.0, 0.0, 5.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 25.0, 0.0, 65.0, 145.0, 0.0, 725.0, 885.0, 280.0, 260.0, 215.0, 35.0, 60.0, 0.0, 20.0, 95.0, 55.0, 0.0, 260.0, 0.0, 0.0, 0.0, 10.0, 70.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7114416383264732, "mean_inference_ms": 1.7330144846331685, "mean_action_processing_ms": 0.27982998982275004, "mean_env_wait_ms": 0.20081812431345847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0067653656005859375, "StateBufferConnector_ms": 0.004107117652893066, "ViewRequirementAgentConnector_ms": 0.14731049537658691}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2230.0, "episode_return_mean": -11.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.24881116084484, "num_env_steps_trained_throughput_per_sec": 77.24881116084484, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 50963.008, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50962.958, "sample_time_ms": 1350.715, "learn_time_ms": 49595.612, "learn_throughput": 80.652, "synch_weights_time_ms": 14.046}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "ed30a_00000", "date": "2024-08-12_14-49-33", "timestamp": 1723488573, "time_this_iter_s": 51.82707619667053, "time_total_s": 1998.138257741928, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01370d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1998.138257741928, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 39.560273972602744, "ram_util_percent": 82.82328767123288}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4384137566285158, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7799926180688161, "policy_loss": -0.010025368476527985, "vf_loss": 1.789443310701027, "vf_explained_var": -8.059651763350875e-05, "kl": 0.0076621808997425645, "entropy": 1.0340753657161874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.190680070497372, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8860395257435147, "policy_loss": -0.010828982685845366, "vf_loss": 2.8962628768234655, "vf_explained_var": 0.017610265716673835, "kl": 0.008075039667373902, "entropy": 1.3397109905247966, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2341.0, "episode_reward_mean": 49.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1890.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -114.16, "predator_policy": 138.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-418.0, 109.0, 143.0, 41.0, 358.0, -405.0, -83.0, -126.0, 335.0, -29.0, -270.0, 310.0, 304.0, -1800.0, 94.0, -631.0, 232.0, -2032.0, 165.0, -244.0, 271.0, 400.0, 103.0, 312.0, 400.0, 166.0, 364.0, 111.0, 121.0, -77.0, 326.0, 388.0, 376.0, 394.0, 364.0, 218.0, 364.0, -67.0, 174.0, 316.0, 400.0, 268.0, 356.0, 382.0, 352.0, 400.0, 257.0, 370.0, 394.0, 400.0, 394.0, 400.0, 400.0, -734.0, 370.0, 166.0, 352.0, 400.0, 199.0, 359.0, 316.0, 346.0, 163.0, 281.0, -1432.0, 394.0, 269.0, 400.0, 400.0, 360.0, 370.0, 126.0, -1262.0, -2230.0, 138.0, 319.0, 376.0, 264.0, -374.0, 400.0, 388.0, 304.0, -1704.0, 376.0, 334.0, 394.0, -1763.0, 400.0, 340.0, 346.0, 305.0, 86.0, 393.0, -995.0, 64.0, -2341.0, 382.0, 340.0, 400.0, 293.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1395.0, 112.0, 200.0, -471.0, -317.0, 200.0, -163.0, -31.0, 134.0, 189.0, -1538.0, 68.0, -1593.0, 200.0, 200.0, -1571.0, 46.0, 189.0, -1164.0, 200.0, 200.0, -1890.0, 112.0, 123.0, 24.0, 200.0, -1549.0, -1406.0, -86.0, -75.0, -394.0, -1032.0, 46.0, 46.0, -1681.0, -1846.0, -273.0, 178.0, 200.0, -1494.0, 200.0, -174.0, 200.0, 200.0, -284.0, 112.0, 200.0, 2.0, 200.0, 200.0, -229.0, 200.0, 134.0, 200.0, 68.0, -152.0, -251.0, 167.0, -229.0, -108.0, 145.0, 156.0, 178.0, 200.0, 200.0, 156.0, 200.0, 189.0, 134.0, 200.0, -141.0, 134.0, 134.0, 200.0, 200.0, -1472.0, 90.0, -31.0, 46.0, 200.0, 200.0, 200.0, 200.0, -42.0, 200.0, 101.0, 200.0, 167.0, 178.0, 134.0, 200.0, 200.0, -273.0, 200.0, 200.0, 145.0, 189.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -559.0, -570.0, 145.0, 200.0, -86.0, 57.0, 112.0, 200.0, 200.0, 200.0, -163.0, 112.0, 35.0, 189.0, 178.0, 68.0, 178.0, 123.0, -20.0, 68.0, 112.0, 79.0, -933.0, -1219.0, 200.0, 189.0, -20.0, 189.0, 200.0, 200.0, 200.0, 200.0, 167.0, 178.0, 145.0, 200.0, 35.0, -119.0, -1219.0, -768.0, -1538.0, -1857.0, -471.0, 134.0, 178.0, 46.0, 200.0, 156.0, 200.0, -86.0, -295.0, -339.0, 200.0, 200.0, 200.0, 178.0, 178.0, -9.0, -1758.0, -911.0, 200.0, 156.0, 200.0, 79.0, 189.0, 200.0, -1659.0, -1109.0, 200.0, 200.0, 134.0, 156.0, 112.0, 189.0, 200.0, -20.0, -20.0, -9.0, 200.0, 123.0, -416.0, -1769.0, -735.0, 189.0, -1593.0, -1648.0, 200.0, 167.0, 90.0, 200.0, 200.0, 200.0, 167.0, 46.0], "policy_predator_policy_reward": [355.0, 510.0, 130.0, 250.0, 230.0, 30.0, 75.0, 160.0, 5.0, 30.0, 570.0, 495.0, 795.0, 515.0, 710.0, 535.0, 75.0, 25.0, 615.0, 320.0, 875.0, 545.0, 75.0, 0.0, 0.0, 80.0, 465.0, 690.0, 80.0, 175.0, 315.0, 480.0, 70.0, 70.0, 725.0, 770.0, 70.0, 190.0, 415.0, 635.0, 85.0, 160.0, 0.0, 0.0, 210.0, 65.0, 90.0, 20.0, 0.0, 0.0, 125.0, 70.0, 30.0, 0.0, 155.0, 40.0, 0.0, 205.0, 185.0, 75.0, 0.0, 25.0, 10.0, 0.0, 0.0, 20.0, 0.0, 5.0, 30.0, 0.0, 145.0, 80.0, 0.0, 30.0, 720.0, 485.0, 20.0, 95.0, 35.0, 35.0, 0.0, 0.0, 110.0, 0.0, 45.0, 10.0, 15.0, 0.0, 10.0, 30.0, 0.0, 0.0, 115.0, 215.0, 25.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 0.0, 0.0, 25.0, 65.0, 130.0, 40.0, 0.0, 0.0, 0.0, 85.0, 165.0, 55.0, 80.0, 0.0, 70.0, 35.0, 10.0, 115.0, 0.0, 40.0, 50.0, 720.0, 0.0, 0.0, 5.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 25.0, 0.0, 65.0, 145.0, 0.0, 725.0, 885.0, 280.0, 260.0, 215.0, 35.0, 60.0, 0.0, 20.0, 95.0, 55.0, 0.0, 260.0, 0.0, 0.0, 0.0, 10.0, 70.0, 65.0, 905.0, 60.0, 20.0, 0.0, 55.0, 0.0, 5.0, 0.0, 910.0, 95.0, 0.0, 0.0, 0.0, 50.0, 5.0, 40.0, 100.0, 25.0, 5.0, 110.0, 35.0, 35.0, 740.0, 450.0, 315.0, 295.0, 865.0, 35.0, 15.0, 0.0, 50.0, 0.0, 0.0, 0.0, 15.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7142223363814222, "mean_inference_ms": 1.7395532461677146, "mean_action_processing_ms": 0.2809058004392261, "mean_env_wait_ms": 0.20163770263346087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006802201271057129, "StateBufferConnector_ms": 0.004140615463256836, "ViewRequirementAgentConnector_ms": 0.14989769458770752}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2341.0, "episode_return_mean": 49.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.783852731629, "num_env_steps_trained_throughput_per_sec": 76.783852731629, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 51173.24, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51173.19, "sample_time_ms": 1477.448, "learn_time_ms": 49677.517, "learn_throughput": 80.519, "synch_weights_time_ms": 15.572}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "ed30a_00000", "date": "2024-08-12_14-50-25", "timestamp": 1723488625, "time_this_iter_s": 52.114422082901, "time_total_s": 2050.252679824829, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b013d3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2050.252679824829, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 37.96216216216216, "ram_util_percent": 81.51351351351352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.456969095411755, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.273183449393227, "policy_loss": -0.009762916763475727, "vf_loss": 1.2824587674998733, "vf_explained_var": -4.8027782843857216e-05, "kl": 0.0065012720327001046, "entropy": 1.0203967423350722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.7861785505499155, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.248397035258157, "policy_loss": -0.012124099528722504, "vf_loss": 2.259882008020209, "vf_explained_var": 0.01800860630141364, "kl": 0.008521723135474508, "entropy": 1.3249107385438585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2341.0, "episode_reward_mean": 47.41, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1857.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 910.0}, "policy_reward_mean": {"prey_policy": -74.12, "predator_policy": 97.825}, "custom_metrics": {}, "hist_stats": {"episode_reward": [103.0, 312.0, 400.0, 166.0, 364.0, 111.0, 121.0, -77.0, 326.0, 388.0, 376.0, 394.0, 364.0, 218.0, 364.0, -67.0, 174.0, 316.0, 400.0, 268.0, 356.0, 382.0, 352.0, 400.0, 257.0, 370.0, 394.0, 400.0, 394.0, 400.0, 400.0, -734.0, 370.0, 166.0, 352.0, 400.0, 199.0, 359.0, 316.0, 346.0, 163.0, 281.0, -1432.0, 394.0, 269.0, 400.0, 400.0, 360.0, 370.0, 126.0, -1262.0, -2230.0, 138.0, 319.0, 376.0, 264.0, -374.0, 400.0, 388.0, 304.0, -1704.0, 376.0, 334.0, 394.0, -1763.0, 400.0, 340.0, 346.0, 305.0, 86.0, 393.0, -995.0, 64.0, -2341.0, 382.0, 340.0, 400.0, 293.0, 358.0, 400.0, 316.0, 394.0, 382.0, -47.0, -571.0, 400.0, -1364.0, -2192.0, -1910.0, 400.0, 273.0, 400.0, 241.0, 320.0, 335.0, 376.0, -1069.0, 320.0, 382.0, -1607.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-284.0, 112.0, 200.0, 2.0, 200.0, 200.0, -229.0, 200.0, 134.0, 200.0, 68.0, -152.0, -251.0, 167.0, -229.0, -108.0, 145.0, 156.0, 178.0, 200.0, 200.0, 156.0, 200.0, 189.0, 134.0, 200.0, -141.0, 134.0, 134.0, 200.0, 200.0, -1472.0, 90.0, -31.0, 46.0, 200.0, 200.0, 200.0, 200.0, -42.0, 200.0, 101.0, 200.0, 167.0, 178.0, 134.0, 200.0, 200.0, -273.0, 200.0, 200.0, 145.0, 189.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -559.0, -570.0, 145.0, 200.0, -86.0, 57.0, 112.0, 200.0, 200.0, 200.0, -163.0, 112.0, 35.0, 189.0, 178.0, 68.0, 178.0, 123.0, -20.0, 68.0, 112.0, 79.0, -933.0, -1219.0, 200.0, 189.0, -20.0, 189.0, 200.0, 200.0, 200.0, 200.0, 167.0, 178.0, 145.0, 200.0, 35.0, -119.0, -1219.0, -768.0, -1538.0, -1857.0, -471.0, 134.0, 178.0, 46.0, 200.0, 156.0, 200.0, -86.0, -295.0, -339.0, 200.0, 200.0, 200.0, 178.0, 178.0, -9.0, -1758.0, -911.0, 200.0, 156.0, 200.0, 79.0, 189.0, 200.0, -1659.0, -1109.0, 200.0, 200.0, 134.0, 156.0, 112.0, 189.0, 200.0, -20.0, -20.0, -9.0, 200.0, 123.0, -416.0, -1769.0, -735.0, 189.0, -1593.0, -1648.0, 200.0, 167.0, 90.0, 200.0, 200.0, 200.0, 167.0, 46.0, 156.0, 167.0, 200.0, 200.0, 123.0, 123.0, 189.0, 200.0, 167.0, 200.0, -449.0, 2.0, -746.0, -295.0, 200.0, 200.0, -1538.0, -636.0, -1505.0, -1472.0, -1516.0, -1274.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, 46.0, 35.0, 134.0, 156.0, 46.0, 134.0, 200.0, 156.0, -779.0, -790.0, 134.0, 156.0, 200.0, 167.0, -1087.0, -1230.0], "policy_predator_policy_reward": [210.0, 65.0, 90.0, 20.0, 0.0, 0.0, 125.0, 70.0, 30.0, 0.0, 155.0, 40.0, 0.0, 205.0, 185.0, 75.0, 0.0, 25.0, 10.0, 0.0, 0.0, 20.0, 0.0, 5.0, 30.0, 0.0, 145.0, 80.0, 0.0, 30.0, 720.0, 485.0, 20.0, 95.0, 35.0, 35.0, 0.0, 0.0, 110.0, 0.0, 45.0, 10.0, 15.0, 0.0, 10.0, 30.0, 0.0, 0.0, 115.0, 215.0, 25.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 0.0, 0.0, 25.0, 65.0, 130.0, 40.0, 0.0, 0.0, 0.0, 85.0, 165.0, 55.0, 80.0, 0.0, 70.0, 35.0, 10.0, 115.0, 0.0, 40.0, 50.0, 720.0, 0.0, 0.0, 5.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 25.0, 0.0, 65.0, 145.0, 0.0, 725.0, 885.0, 280.0, 260.0, 215.0, 35.0, 60.0, 0.0, 20.0, 95.0, 55.0, 0.0, 260.0, 0.0, 0.0, 0.0, 10.0, 70.0, 65.0, 905.0, 60.0, 20.0, 0.0, 55.0, 0.0, 5.0, 0.0, 910.0, 95.0, 0.0, 0.0, 0.0, 50.0, 5.0, 40.0, 100.0, 25.0, 5.0, 110.0, 35.0, 35.0, 740.0, 450.0, 315.0, 295.0, 865.0, 35.0, 15.0, 0.0, 50.0, 0.0, 0.0, 0.0, 15.0, 65.0, 35.0, 0.0, 0.0, 0.0, 35.0, 35.0, 5.0, 0.0, 0.0, 15.0, 385.0, 15.0, 470.0, 0.0, 0.0, 0.0, 0.0, 810.0, 785.0, 0.0, 0.0, 880.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 75.0, 85.0, 30.0, 0.0, 65.0, 90.0, 20.0, 0.0, 450.0, 50.0, 0.0, 30.0, 0.0, 15.0, 0.0, 710.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7177158372617035, "mean_inference_ms": 1.747316014923149, "mean_action_processing_ms": 0.2821850222242107, "mean_env_wait_ms": 0.20265952179848917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00667262077331543, "StateBufferConnector_ms": 0.004079699516296387, "ViewRequirementAgentConnector_ms": 0.13901424407958984}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2341.0, "episode_return_mean": 47.41, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.16465273165684, "num_env_steps_trained_throughput_per_sec": 81.16465273165684, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 51192.551, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51192.5, "sample_time_ms": 1480.216, "learn_time_ms": 49694.223, "learn_throughput": 80.492, "synch_weights_time_ms": 15.35}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "ed30a_00000", "date": "2024-08-12_14-51-14", "timestamp": 1723488674, "time_this_iter_s": 49.302634954452515, "time_total_s": 2099.5553147792816, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2099.5553147792816, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 35.397183098591555, "ram_util_percent": 81.94507042253521}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5273246627163004, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.224898186625627, "policy_loss": -0.008999687626159616, "vf_loss": 2.233225649752945, "vf_explained_var": -4.658358437674386e-05, "kl": 0.008962823196360287, "entropy": 1.0282356133852055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.942932174729291, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8545030216691356, "policy_loss": -0.013507343583528406, "vf_loss": 3.867275087038676, "vf_explained_var": 0.01587562397043541, "kl": 0.00980356705144282, "entropy": 1.3308918689293836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2341.0, "episode_reward_mean": -59.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -142.87, "predator_policy": 112.875}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 257.0, 370.0, 394.0, 400.0, 394.0, 400.0, 400.0, -734.0, 370.0, 166.0, 352.0, 400.0, 199.0, 359.0, 316.0, 346.0, 163.0, 281.0, -1432.0, 394.0, 269.0, 400.0, 400.0, 360.0, 370.0, 126.0, -1262.0, -2230.0, 138.0, 319.0, 376.0, 264.0, -374.0, 400.0, 388.0, 304.0, -1704.0, 376.0, 334.0, 394.0, -1763.0, 400.0, 340.0, 346.0, 305.0, 86.0, 393.0, -995.0, 64.0, -2341.0, 382.0, 340.0, 400.0, 293.0, 358.0, 400.0, 316.0, 394.0, 382.0, -47.0, -571.0, 400.0, -1364.0, -2192.0, -1910.0, 400.0, 273.0, 400.0, 241.0, 320.0, 335.0, 376.0, -1069.0, 320.0, 382.0, -1607.0, 382.0, 376.0, 364.0, 400.0, 400.0, -1043.0, 382.0, 400.0, 261.0, -642.0, 322.0, 394.0, 332.0, 394.0, 346.0, -1737.0, -2204.0, 382.0, -994.0, -1910.0, 320.0, -1810.0, 256.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -273.0, 200.0, 200.0, 145.0, 189.0, 200.0, 200.0, 200.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, -559.0, -570.0, 145.0, 200.0, -86.0, 57.0, 112.0, 200.0, 200.0, 200.0, -163.0, 112.0, 35.0, 189.0, 178.0, 68.0, 178.0, 123.0, -20.0, 68.0, 112.0, 79.0, -933.0, -1219.0, 200.0, 189.0, -20.0, 189.0, 200.0, 200.0, 200.0, 200.0, 167.0, 178.0, 145.0, 200.0, 35.0, -119.0, -1219.0, -768.0, -1538.0, -1857.0, -471.0, 134.0, 178.0, 46.0, 200.0, 156.0, 200.0, -86.0, -295.0, -339.0, 200.0, 200.0, 200.0, 178.0, 178.0, -9.0, -1758.0, -911.0, 200.0, 156.0, 200.0, 79.0, 189.0, 200.0, -1659.0, -1109.0, 200.0, 200.0, 134.0, 156.0, 112.0, 189.0, 200.0, -20.0, -20.0, -9.0, 200.0, 123.0, -416.0, -1769.0, -735.0, 189.0, -1593.0, -1648.0, 200.0, 167.0, 90.0, 200.0, 200.0, 200.0, 167.0, 46.0, 156.0, 167.0, 200.0, 200.0, 123.0, 123.0, 189.0, 200.0, 167.0, 200.0, -449.0, 2.0, -746.0, -295.0, 200.0, 200.0, -1538.0, -636.0, -1505.0, -1472.0, -1516.0, -1274.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, 46.0, 35.0, 134.0, 156.0, 46.0, 134.0, 200.0, 156.0, -779.0, -790.0, 134.0, 156.0, 200.0, 167.0, -1087.0, -1230.0, 167.0, 200.0, 189.0, 167.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1065.0, -603.0, 167.0, 200.0, 200.0, 200.0, -75.0, 156.0, -1164.0, -163.0, 112.0, 145.0, 189.0, 200.0, 57.0, 200.0, 200.0, 189.0, 46.0, 200.0, -801.0, -1901.0, -1593.0, -1571.0, 167.0, 200.0, -592.0, -977.0, -1263.0, -1472.0, 200.0, -20.0, -1131.0, -1494.0, 24.0, 112.0], "policy_predator_policy_reward": [0.0, 0.0, 115.0, 215.0, 25.0, 0.0, 0.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 395.0, 0.0, 0.0, 25.0, 65.0, 130.0, 40.0, 0.0, 0.0, 0.0, 85.0, 165.0, 55.0, 80.0, 0.0, 70.0, 35.0, 10.0, 115.0, 0.0, 40.0, 50.0, 720.0, 0.0, 0.0, 5.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 25.0, 0.0, 65.0, 145.0, 0.0, 725.0, 885.0, 280.0, 260.0, 215.0, 35.0, 60.0, 0.0, 20.0, 95.0, 55.0, 0.0, 260.0, 0.0, 0.0, 0.0, 10.0, 70.0, 65.0, 905.0, 60.0, 20.0, 0.0, 55.0, 0.0, 5.0, 0.0, 910.0, 95.0, 0.0, 0.0, 0.0, 50.0, 5.0, 40.0, 100.0, 25.0, 5.0, 110.0, 35.0, 35.0, 740.0, 450.0, 315.0, 295.0, 865.0, 35.0, 15.0, 0.0, 50.0, 0.0, 0.0, 0.0, 15.0, 65.0, 35.0, 0.0, 0.0, 0.0, 35.0, 35.0, 5.0, 0.0, 0.0, 15.0, 385.0, 15.0, 470.0, 0.0, 0.0, 0.0, 0.0, 810.0, 785.0, 0.0, 0.0, 880.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 75.0, 85.0, 30.0, 0.0, 65.0, 90.0, 20.0, 0.0, 450.0, 50.0, 0.0, 30.0, 0.0, 15.0, 0.0, 710.0, 15.0, 0.0, 15.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 590.0, 0.0, 15.0, 0.0, 0.0, 85.0, 95.0, 45.0, 640.0, 40.0, 25.0, 0.0, 5.0, 25.0, 50.0, 5.0, 0.0, 70.0, 30.0, 55.0, 910.0, 955.0, 5.0, 15.0, 0.0, 575.0, 0.0, 55.0, 770.0, 55.0, 85.0, 15.0, 800.0, 65.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.720025693488106, "mean_inference_ms": 1.754920844209641, "mean_action_processing_ms": 0.2833206712885829, "mean_env_wait_ms": 0.203749539237932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006424665451049805, "StateBufferConnector_ms": 0.004083752632141113, "ViewRequirementAgentConnector_ms": 0.15053129196166992}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2341.0, "episode_return_mean": -59.99, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.11727740171133, "num_env_steps_trained_throughput_per_sec": 79.11727740171133, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 51279.687, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51279.637, "sample_time_ms": 1479.179, "learn_time_ms": 49781.727, "learn_throughput": 80.351, "synch_weights_time_ms": 15.979}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "ed30a_00000", "date": "2024-08-12_14-52-05", "timestamp": 1723488725, "time_this_iter_s": 50.593124866485596, "time_total_s": 2150.148439645767, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2150.148439645767, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 36.06338028169015, "ram_util_percent": 81.9619718309859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.379196626452542, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.658696966827231, "policy_loss": -0.010494750730629282, "vf_loss": 2.6681634335921554, "vf_explained_var": -5.400496185141266e-05, "kl": 0.013710250399418098, "entropy": 1.0314635035852906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.385222819368675, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.879738183627053, "policy_loss": -0.013688256070954065, "vf_loss": 3.892597684658394, "vf_explained_var": 0.01432605575001429, "kl": 0.011049958797926718, "entropy": 1.3208166661085905, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2341.0, "episode_reward_mean": -152.23, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -209.915, "predator_policy": 133.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.0, -1432.0, 394.0, 269.0, 400.0, 400.0, 360.0, 370.0, 126.0, -1262.0, -2230.0, 138.0, 319.0, 376.0, 264.0, -374.0, 400.0, 388.0, 304.0, -1704.0, 376.0, 334.0, 394.0, -1763.0, 400.0, 340.0, 346.0, 305.0, 86.0, 393.0, -995.0, 64.0, -2341.0, 382.0, 340.0, 400.0, 293.0, 358.0, 400.0, 316.0, 394.0, 382.0, -47.0, -571.0, 400.0, -1364.0, -2192.0, -1910.0, 400.0, 273.0, 400.0, 241.0, 320.0, 335.0, 376.0, -1069.0, 320.0, 382.0, -1607.0, 382.0, 376.0, 364.0, 400.0, 400.0, -1043.0, 382.0, 400.0, 261.0, -642.0, 322.0, 394.0, 332.0, 394.0, 346.0, -1737.0, -2204.0, 382.0, -994.0, -1910.0, 320.0, -1810.0, 256.0, -1476.0, 352.0, 328.0, 388.0, -74.0, 256.0, 370.0, 400.0, -182.0, -1481.0, -516.0, -85.0, 400.0, 400.0, -646.0, -2185.0, 400.0, -921.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [112.0, 79.0, -933.0, -1219.0, 200.0, 189.0, -20.0, 189.0, 200.0, 200.0, 200.0, 200.0, 167.0, 178.0, 145.0, 200.0, 35.0, -119.0, -1219.0, -768.0, -1538.0, -1857.0, -471.0, 134.0, 178.0, 46.0, 200.0, 156.0, 200.0, -86.0, -295.0, -339.0, 200.0, 200.0, 200.0, 178.0, 178.0, -9.0, -1758.0, -911.0, 200.0, 156.0, 200.0, 79.0, 189.0, 200.0, -1659.0, -1109.0, 200.0, 200.0, 134.0, 156.0, 112.0, 189.0, 200.0, -20.0, -20.0, -9.0, 200.0, 123.0, -416.0, -1769.0, -735.0, 189.0, -1593.0, -1648.0, 200.0, 167.0, 90.0, 200.0, 200.0, 200.0, 167.0, 46.0, 156.0, 167.0, 200.0, 200.0, 123.0, 123.0, 189.0, 200.0, 167.0, 200.0, -449.0, 2.0, -746.0, -295.0, 200.0, 200.0, -1538.0, -636.0, -1505.0, -1472.0, -1516.0, -1274.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, 46.0, 35.0, 134.0, 156.0, 46.0, 134.0, 200.0, 156.0, -779.0, -790.0, 134.0, 156.0, 200.0, 167.0, -1087.0, -1230.0, 167.0, 200.0, 189.0, 167.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1065.0, -603.0, 167.0, 200.0, 200.0, 200.0, -75.0, 156.0, -1164.0, -163.0, 112.0, 145.0, 189.0, 200.0, 57.0, 200.0, 200.0, 189.0, 46.0, 200.0, -801.0, -1901.0, -1593.0, -1571.0, 167.0, 200.0, -592.0, -977.0, -1263.0, -1472.0, 200.0, -20.0, -1131.0, -1494.0, 24.0, 112.0, -977.0, -1219.0, 112.0, 200.0, 68.0, 200.0, 200.0, 178.0, -669.0, 200.0, -64.0, 200.0, 200.0, 145.0, 200.0, 200.0, -867.0, 200.0, -1450.0, -1351.0, -229.0, -702.0, 57.0, -427.0, 200.0, 200.0, 200.0, 200.0, -152.0, -1164.0, -1593.0, -1417.0, 200.0, 200.0, -658.0, -713.0], "policy_predator_policy_reward": [40.0, 50.0, 720.0, 0.0, 0.0, 5.0, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 25.0, 0.0, 65.0, 145.0, 0.0, 725.0, 885.0, 280.0, 260.0, 215.0, 35.0, 60.0, 0.0, 20.0, 95.0, 55.0, 0.0, 260.0, 0.0, 0.0, 0.0, 10.0, 70.0, 65.0, 905.0, 60.0, 20.0, 0.0, 55.0, 0.0, 5.0, 0.0, 910.0, 95.0, 0.0, 0.0, 0.0, 50.0, 5.0, 40.0, 100.0, 25.0, 5.0, 110.0, 35.0, 35.0, 740.0, 450.0, 315.0, 295.0, 865.0, 35.0, 15.0, 0.0, 50.0, 0.0, 0.0, 0.0, 15.0, 65.0, 35.0, 0.0, 0.0, 0.0, 35.0, 35.0, 5.0, 0.0, 0.0, 15.0, 385.0, 15.0, 470.0, 0.0, 0.0, 0.0, 0.0, 810.0, 785.0, 0.0, 0.0, 880.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 75.0, 85.0, 30.0, 0.0, 65.0, 90.0, 20.0, 0.0, 450.0, 50.0, 0.0, 30.0, 0.0, 15.0, 0.0, 710.0, 15.0, 0.0, 15.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 590.0, 0.0, 15.0, 0.0, 0.0, 85.0, 95.0, 45.0, 640.0, 40.0, 25.0, 0.0, 5.0, 25.0, 50.0, 5.0, 0.0, 70.0, 30.0, 55.0, 910.0, 955.0, 5.0, 15.0, 0.0, 575.0, 0.0, 55.0, 770.0, 55.0, 85.0, 15.0, 800.0, 65.0, 55.0, 0.0, 720.0, 0.0, 40.0, 60.0, 0.0, 10.0, 0.0, 395.0, 0.0, 120.0, 0.0, 25.0, 0.0, 0.0, 0.0, 10.0, 475.0, 885.0, 435.0, 5.0, 410.0, 0.0, 285.0, 0.0, 0.0, 0.0, 0.0, 50.0, 620.0, 5.0, 820.0, 0.0, 0.0, 15.0, 435.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7224205785776688, "mean_inference_ms": 1.7588436181687934, "mean_action_processing_ms": 0.2841607371172873, "mean_env_wait_ms": 0.20445326878473513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061838626861572266, "StateBufferConnector_ms": 0.00407254695892334, "ViewRequirementAgentConnector_ms": 0.14130568504333496}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2341.0, "episode_return_mean": -152.23, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.62697287426278, "num_env_steps_trained_throughput_per_sec": 80.62697287426278, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 51236.559, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51236.498, "sample_time_ms": 1465.476, "learn_time_ms": 49752.411, "learn_throughput": 80.398, "synch_weights_time_ms": 15.804}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "ed30a_00000", "date": "2024-08-12_14-52-54", "timestamp": 1723488774, "time_this_iter_s": 49.65170121192932, "time_total_s": 2199.8001408576965, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012b1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2199.8001408576965, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 34.02957746478874, "ram_util_percent": 82.55492957746479}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4761333308838032, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4233493799885746, "policy_loss": -0.007954223472107615, "vf_loss": 1.4306041756004253, "vf_explained_var": -2.424814713695062e-05, "kl": 0.009325593427304425, "entropy": 1.073511001105031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.901146659207723, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0489629442256594, "policy_loss": -0.013102413515594822, "vf_loss": 2.0613957106121004, "vf_explained_var": 0.017973704186696856, "kl": 0.008928616191167353, "entropy": 1.3114432794707163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2341.0, "episode_reward_mean": -149.14, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -209.42, "predator_policy": 134.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [304.0, -1704.0, 376.0, 334.0, 394.0, -1763.0, 400.0, 340.0, 346.0, 305.0, 86.0, 393.0, -995.0, 64.0, -2341.0, 382.0, 340.0, 400.0, 293.0, 358.0, 400.0, 316.0, 394.0, 382.0, -47.0, -571.0, 400.0, -1364.0, -2192.0, -1910.0, 400.0, 273.0, 400.0, 241.0, 320.0, 335.0, 376.0, -1069.0, 320.0, 382.0, -1607.0, 382.0, 376.0, 364.0, 400.0, 400.0, -1043.0, 382.0, 400.0, 261.0, -642.0, 322.0, 394.0, 332.0, 394.0, 346.0, -1737.0, -2204.0, 382.0, -994.0, -1910.0, 320.0, -1810.0, 256.0, -1476.0, 352.0, 328.0, 388.0, -74.0, 256.0, 370.0, 400.0, -182.0, -1481.0, -516.0, -85.0, 400.0, 400.0, -646.0, -2185.0, 400.0, -921.0, 332.0, 382.0, 346.0, 239.0, 358.0, -254.0, 335.0, 304.0, -1394.0, 394.0, -1949.0, -684.0, 400.0, 273.0, -763.0, 400.0, 377.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, -9.0, -1758.0, -911.0, 200.0, 156.0, 200.0, 79.0, 189.0, 200.0, -1659.0, -1109.0, 200.0, 200.0, 134.0, 156.0, 112.0, 189.0, 200.0, -20.0, -20.0, -9.0, 200.0, 123.0, -416.0, -1769.0, -735.0, 189.0, -1593.0, -1648.0, 200.0, 167.0, 90.0, 200.0, 200.0, 200.0, 167.0, 46.0, 156.0, 167.0, 200.0, 200.0, 123.0, 123.0, 189.0, 200.0, 167.0, 200.0, -449.0, 2.0, -746.0, -295.0, 200.0, 200.0, -1538.0, -636.0, -1505.0, -1472.0, -1516.0, -1274.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, 46.0, 35.0, 134.0, 156.0, 46.0, 134.0, 200.0, 156.0, -779.0, -790.0, 134.0, 156.0, 200.0, 167.0, -1087.0, -1230.0, 167.0, 200.0, 189.0, 167.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1065.0, -603.0, 167.0, 200.0, 200.0, 200.0, -75.0, 156.0, -1164.0, -163.0, 112.0, 145.0, 189.0, 200.0, 57.0, 200.0, 200.0, 189.0, 46.0, 200.0, -801.0, -1901.0, -1593.0, -1571.0, 167.0, 200.0, -592.0, -977.0, -1263.0, -1472.0, 200.0, -20.0, -1131.0, -1494.0, 24.0, 112.0, -977.0, -1219.0, 112.0, 200.0, 68.0, 200.0, 200.0, 178.0, -669.0, 200.0, -64.0, 200.0, 200.0, 145.0, 200.0, 200.0, -867.0, 200.0, -1450.0, -1351.0, -229.0, -702.0, 57.0, -427.0, 200.0, 200.0, 200.0, 200.0, -152.0, -1164.0, -1593.0, -1417.0, 200.0, 200.0, -658.0, -713.0, 35.0, 167.0, 200.0, 167.0, 101.0, 200.0, 79.0, 90.0, 200.0, 123.0, -845.0, 46.0, 35.0, 200.0, 200.0, 24.0, -955.0, -1164.0, 189.0, 200.0, -1670.0, -1219.0, -922.0, -372.0, 200.0, 200.0, -53.0, -9.0, -724.0, -669.0, 200.0, 200.0, 178.0, 189.0, 200.0, 200.0], "policy_predator_policy_reward": [70.0, 65.0, 905.0, 60.0, 20.0, 0.0, 55.0, 0.0, 5.0, 0.0, 910.0, 95.0, 0.0, 0.0, 0.0, 50.0, 5.0, 40.0, 100.0, 25.0, 5.0, 110.0, 35.0, 35.0, 740.0, 450.0, 315.0, 295.0, 865.0, 35.0, 15.0, 0.0, 50.0, 0.0, 0.0, 0.0, 15.0, 65.0, 35.0, 0.0, 0.0, 0.0, 35.0, 35.0, 5.0, 0.0, 0.0, 15.0, 385.0, 15.0, 470.0, 0.0, 0.0, 0.0, 0.0, 810.0, 785.0, 0.0, 0.0, 880.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 75.0, 85.0, 30.0, 0.0, 65.0, 90.0, 20.0, 0.0, 450.0, 50.0, 0.0, 30.0, 0.0, 15.0, 0.0, 710.0, 15.0, 0.0, 15.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 590.0, 0.0, 15.0, 0.0, 0.0, 85.0, 95.0, 45.0, 640.0, 40.0, 25.0, 0.0, 5.0, 25.0, 50.0, 5.0, 0.0, 70.0, 30.0, 55.0, 910.0, 955.0, 5.0, 15.0, 0.0, 575.0, 0.0, 55.0, 770.0, 55.0, 85.0, 15.0, 800.0, 65.0, 55.0, 0.0, 720.0, 0.0, 40.0, 60.0, 0.0, 10.0, 0.0, 395.0, 0.0, 120.0, 0.0, 25.0, 0.0, 0.0, 0.0, 10.0, 475.0, 885.0, 435.0, 5.0, 410.0, 0.0, 285.0, 0.0, 0.0, 0.0, 0.0, 50.0, 620.0, 5.0, 820.0, 0.0, 0.0, 15.0, 435.0, 50.0, 80.0, 15.0, 0.0, 0.0, 45.0, 40.0, 30.0, 0.0, 35.0, 70.0, 475.0, 65.0, 35.0, 0.0, 80.0, 50.0, 675.0, 0.0, 5.0, 0.0, 940.0, 0.0, 610.0, 0.0, 0.0, 170.0, 165.0, 485.0, 145.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7231311436745428, "mean_inference_ms": 1.7606070283278497, "mean_action_processing_ms": 0.284711703804328, "mean_env_wait_ms": 0.20492037258132906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003803253173828125, "StateBufferConnector_ms": 0.00394594669342041, "ViewRequirementAgentConnector_ms": 0.1384260654449463}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2341.0, "episode_return_mean": -149.14, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.36312923497677, "num_env_steps_trained_throughput_per_sec": 77.36312923497677, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 51266.86, "restore_workers_time_ms": 0.014, "training_step_time_ms": 51266.779, "sample_time_ms": 1447.58, "learn_time_ms": 49800.636, "learn_throughput": 80.32, "synch_weights_time_ms": 15.742}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "ed30a_00000", "date": "2024-08-12_14-53-46", "timestamp": 1723488826, "time_this_iter_s": 51.761921882629395, "time_total_s": 2251.562062740326, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0128a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2251.562062740326, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 40.66216216216216, "ram_util_percent": 82.70405405405405}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5505468519907148, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.902506041810626, "policy_loss": -0.006699703907022479, "vf_loss": 1.9084871185519707, "vf_explained_var": -2.442532115512424e-05, "kl": 0.009581529370270963, "entropy": 1.0550334879645595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.683853596638119, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9559343613644757, "policy_loss": -0.01734953428564406, "vf_loss": 2.97238498162971, "vf_explained_var": 0.021966695060174932, "kl": 0.011985569527465633, "entropy": 1.3259824713701924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2204.0, "episode_reward_mean": -159.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -214.04, "predator_policy": 134.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.0, 358.0, 400.0, 316.0, 394.0, 382.0, -47.0, -571.0, 400.0, -1364.0, -2192.0, -1910.0, 400.0, 273.0, 400.0, 241.0, 320.0, 335.0, 376.0, -1069.0, 320.0, 382.0, -1607.0, 382.0, 376.0, 364.0, 400.0, 400.0, -1043.0, 382.0, 400.0, 261.0, -642.0, 322.0, 394.0, 332.0, 394.0, 346.0, -1737.0, -2204.0, 382.0, -994.0, -1910.0, 320.0, -1810.0, 256.0, -1476.0, 352.0, 328.0, 388.0, -74.0, 256.0, 370.0, 400.0, -182.0, -1481.0, -516.0, -85.0, 400.0, 400.0, -646.0, -2185.0, 400.0, -921.0, 332.0, 382.0, 346.0, 239.0, 358.0, -254.0, 335.0, 304.0, -1394.0, 394.0, -1949.0, -684.0, 400.0, 273.0, -763.0, 400.0, 377.0, 400.0, 298.0, -1021.0, 394.0, 328.0, 292.0, 370.0, 400.0, 183.0, 258.0, 376.0, 320.0, 370.0, 340.0, -1936.0, -1273.0, -1757.0, 358.0, -1723.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 46.0, 156.0, 167.0, 200.0, 200.0, 123.0, 123.0, 189.0, 200.0, 167.0, 200.0, -449.0, 2.0, -746.0, -295.0, 200.0, 200.0, -1538.0, -636.0, -1505.0, -1472.0, -1516.0, -1274.0, 200.0, 200.0, -42.0, 200.0, 200.0, 200.0, 46.0, 35.0, 134.0, 156.0, 46.0, 134.0, 200.0, 156.0, -779.0, -790.0, 134.0, 156.0, 200.0, 167.0, -1087.0, -1230.0, 167.0, 200.0, 189.0, 167.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1065.0, -603.0, 167.0, 200.0, 200.0, 200.0, -75.0, 156.0, -1164.0, -163.0, 112.0, 145.0, 189.0, 200.0, 57.0, 200.0, 200.0, 189.0, 46.0, 200.0, -801.0, -1901.0, -1593.0, -1571.0, 167.0, 200.0, -592.0, -977.0, -1263.0, -1472.0, 200.0, -20.0, -1131.0, -1494.0, 24.0, 112.0, -977.0, -1219.0, 112.0, 200.0, 68.0, 200.0, 200.0, 178.0, -669.0, 200.0, -64.0, 200.0, 200.0, 145.0, 200.0, 200.0, -867.0, 200.0, -1450.0, -1351.0, -229.0, -702.0, 57.0, -427.0, 200.0, 200.0, 200.0, 200.0, -152.0, -1164.0, -1593.0, -1417.0, 200.0, 200.0, -658.0, -713.0, 35.0, 167.0, 200.0, 167.0, 101.0, 200.0, 79.0, 90.0, 200.0, 123.0, -845.0, 46.0, 35.0, 200.0, 200.0, 24.0, -955.0, -1164.0, 189.0, 200.0, -1670.0, -1219.0, -922.0, -372.0, 200.0, 200.0, -53.0, -9.0, -724.0, -669.0, 200.0, 200.0, 178.0, 189.0, 200.0, 200.0, 134.0, 24.0, -625.0, -1076.0, 189.0, 200.0, 79.0, 189.0, 178.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, -317.0, 123.0, 35.0, 200.0, 156.0, 156.0, 134.0, 200.0, 90.0, -20.0, 200.0, -1395.0, -1351.0, -1615.0, -493.0, -1076.0, -1626.0, 200.0, 123.0, -1373.0, -1175.0], "policy_predator_policy_reward": [15.0, 65.0, 35.0, 0.0, 0.0, 0.0, 35.0, 35.0, 5.0, 0.0, 0.0, 15.0, 385.0, 15.0, 470.0, 0.0, 0.0, 0.0, 0.0, 810.0, 785.0, 0.0, 0.0, 880.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 75.0, 85.0, 30.0, 0.0, 65.0, 90.0, 20.0, 0.0, 450.0, 50.0, 0.0, 30.0, 0.0, 15.0, 0.0, 710.0, 15.0, 0.0, 15.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 590.0, 0.0, 15.0, 0.0, 0.0, 85.0, 95.0, 45.0, 640.0, 40.0, 25.0, 0.0, 5.0, 25.0, 50.0, 5.0, 0.0, 70.0, 30.0, 55.0, 910.0, 955.0, 5.0, 15.0, 0.0, 575.0, 0.0, 55.0, 770.0, 55.0, 85.0, 15.0, 800.0, 65.0, 55.0, 0.0, 720.0, 0.0, 40.0, 60.0, 0.0, 10.0, 0.0, 395.0, 0.0, 120.0, 0.0, 25.0, 0.0, 0.0, 0.0, 10.0, 475.0, 885.0, 435.0, 5.0, 410.0, 0.0, 285.0, 0.0, 0.0, 0.0, 0.0, 50.0, 620.0, 5.0, 820.0, 0.0, 0.0, 15.0, 435.0, 50.0, 80.0, 15.0, 0.0, 0.0, 45.0, 40.0, 30.0, 0.0, 35.0, 70.0, 475.0, 65.0, 35.0, 0.0, 80.0, 50.0, 675.0, 0.0, 5.0, 0.0, 940.0, 0.0, 610.0, 0.0, 0.0, 170.0, 165.0, 485.0, 145.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 60.0, 80.0, 675.0, 5.0, 0.0, 5.0, 60.0, 0.0, 85.0, 60.0, 0.0, 25.0, 0.0, 0.0, 95.0, 205.0, 25.0, 75.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 100.0, 60.0, 810.0, 0.0, 815.0, 20.0, 25.0, 920.0, 0.0, 35.0, 30.0, 795.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7212933110179526, "mean_inference_ms": 1.7536591932760197, "mean_action_processing_ms": 0.2841566512559001, "mean_env_wait_ms": 0.20440664267112638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036475658416748047, "StateBufferConnector_ms": 0.0032192468643188477, "ViewRequirementAgentConnector_ms": 0.1107473373413086}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2204.0, "episode_return_mean": -159.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.99433138008766, "num_env_steps_trained_throughput_per_sec": 79.99433138008766, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 51126.536, "restore_workers_time_ms": 0.015, "training_step_time_ms": 51126.455, "sample_time_ms": 1416.961, "learn_time_ms": 49689.93, "learn_throughput": 80.499, "synch_weights_time_ms": 16.54}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "ed30a_00000", "date": "2024-08-12_14-54-36", "timestamp": 1723488876, "time_this_iter_s": 50.02791881561279, "time_total_s": 2301.5899815559387, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b013d5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2301.5899815559387, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 35.42253521126761, "ram_util_percent": 82.86619718309862}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5946808901728777, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.961640971867496, "policy_loss": -0.0085143866390729, "vf_loss": 2.9693314479772375, "vf_explained_var": -2.5040226638632477e-05, "kl": 0.010984655700267607, "entropy": 1.0621289552204192, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.450351957290891, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7927363443626927, "policy_loss": -0.011344036667376127, "vf_loss": 3.803356631596883, "vf_explained_var": 0.01639857014651021, "kl": 0.0096501745847423, "entropy": 1.3338961830214848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2204.0, "episode_reward_mean": -174.97, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -230.76, "predator_policy": 143.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1607.0, 382.0, 376.0, 364.0, 400.0, 400.0, -1043.0, 382.0, 400.0, 261.0, -642.0, 322.0, 394.0, 332.0, 394.0, 346.0, -1737.0, -2204.0, 382.0, -994.0, -1910.0, 320.0, -1810.0, 256.0, -1476.0, 352.0, 328.0, 388.0, -74.0, 256.0, 370.0, 400.0, -182.0, -1481.0, -516.0, -85.0, 400.0, 400.0, -646.0, -2185.0, 400.0, -921.0, 332.0, 382.0, 346.0, 239.0, 358.0, -254.0, 335.0, 304.0, -1394.0, 394.0, -1949.0, -684.0, 400.0, 273.0, -763.0, 400.0, 377.0, 400.0, 298.0, -1021.0, 394.0, 328.0, 292.0, 370.0, 400.0, 183.0, 258.0, 376.0, 320.0, 370.0, 340.0, -1936.0, -1273.0, -1757.0, 358.0, -1723.0, -1326.0, -2106.0, -749.0, 244.0, 304.0, -148.0, -15.0, 112.0, 383.0, 335.0, 172.0, 394.0, -314.0, -868.0, 376.0, 235.0, 376.0, 376.0, 400.0, -594.0, 181.0, -830.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1087.0, -1230.0, 167.0, 200.0, 189.0, 167.0, 200.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1065.0, -603.0, 167.0, 200.0, 200.0, 200.0, -75.0, 156.0, -1164.0, -163.0, 112.0, 145.0, 189.0, 200.0, 57.0, 200.0, 200.0, 189.0, 46.0, 200.0, -801.0, -1901.0, -1593.0, -1571.0, 167.0, 200.0, -592.0, -977.0, -1263.0, -1472.0, 200.0, -20.0, -1131.0, -1494.0, 24.0, 112.0, -977.0, -1219.0, 112.0, 200.0, 68.0, 200.0, 200.0, 178.0, -669.0, 200.0, -64.0, 200.0, 200.0, 145.0, 200.0, 200.0, -867.0, 200.0, -1450.0, -1351.0, -229.0, -702.0, 57.0, -427.0, 200.0, 200.0, 200.0, 200.0, -152.0, -1164.0, -1593.0, -1417.0, 200.0, 200.0, -658.0, -713.0, 35.0, 167.0, 200.0, 167.0, 101.0, 200.0, 79.0, 90.0, 200.0, 123.0, -845.0, 46.0, 35.0, 200.0, 200.0, 24.0, -955.0, -1164.0, 189.0, 200.0, -1670.0, -1219.0, -922.0, -372.0, 200.0, 200.0, -53.0, -9.0, -724.0, -669.0, 200.0, 200.0, 178.0, 189.0, 200.0, 200.0, 134.0, 24.0, -625.0, -1076.0, 189.0, 200.0, 79.0, 189.0, 178.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, -317.0, 123.0, 35.0, 200.0, 156.0, 156.0, 134.0, 200.0, 90.0, -20.0, 200.0, -1395.0, -1351.0, -1615.0, -493.0, -1076.0, -1626.0, 200.0, 123.0, -1373.0, -1175.0, -834.0, -1252.0, -1406.0, -1670.0, -735.0, -614.0, 13.0, 101.0, 24.0, 200.0, -713.0, 145.0, -64.0, -86.0, 134.0, -207.0, 200.0, 123.0, 35.0, 200.0, -218.0, 200.0, 200.0, 189.0, -1109.0, 200.0, -790.0, -548.0, 156.0, 200.0, 101.0, 79.0, 156.0, 200.0, 156.0, 200.0, 200.0, 200.0, -108.0, -1186.0, 57.0, -86.0, -394.0, -1131.0], "policy_predator_policy_reward": [0.0, 710.0, 15.0, 0.0, 15.0, 5.0, 30.0, 0.0, 0.0, 0.0, 0.0, 0.0, 35.0, 590.0, 0.0, 15.0, 0.0, 0.0, 85.0, 95.0, 45.0, 640.0, 40.0, 25.0, 0.0, 5.0, 25.0, 50.0, 5.0, 0.0, 70.0, 30.0, 55.0, 910.0, 955.0, 5.0, 15.0, 0.0, 575.0, 0.0, 55.0, 770.0, 55.0, 85.0, 15.0, 800.0, 65.0, 55.0, 0.0, 720.0, 0.0, 40.0, 60.0, 0.0, 10.0, 0.0, 395.0, 0.0, 120.0, 0.0, 25.0, 0.0, 0.0, 0.0, 10.0, 475.0, 885.0, 435.0, 5.0, 410.0, 0.0, 285.0, 0.0, 0.0, 0.0, 0.0, 50.0, 620.0, 5.0, 820.0, 0.0, 0.0, 15.0, 435.0, 50.0, 80.0, 15.0, 0.0, 0.0, 45.0, 40.0, 30.0, 0.0, 35.0, 70.0, 475.0, 65.0, 35.0, 0.0, 80.0, 50.0, 675.0, 0.0, 5.0, 0.0, 940.0, 0.0, 610.0, 0.0, 0.0, 170.0, 165.0, 485.0, 145.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 60.0, 80.0, 675.0, 5.0, 0.0, 5.0, 60.0, 0.0, 85.0, 60.0, 0.0, 25.0, 0.0, 0.0, 95.0, 205.0, 25.0, 75.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 100.0, 60.0, 810.0, 0.0, 815.0, 20.0, 25.0, 920.0, 0.0, 35.0, 30.0, 795.0, 45.0, 715.0, 25.0, 945.0, 540.0, 60.0, 45.0, 85.0, 30.0, 50.0, 30.0, 390.0, 5.0, 130.0, 135.0, 50.0, 35.0, 25.0, 75.0, 25.0, 0.0, 190.0, 0.0, 5.0, 575.0, 20.0, 0.0, 470.0, 0.0, 20.0, 0.0, 55.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 700.0, 160.0, 50.0, 40.0, 655.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7190807088455567, "mean_inference_ms": 1.7458217068905555, "mean_action_processing_ms": 0.28354988870379, "mean_env_wait_ms": 0.20382287432015175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037592649459838867, "StateBufferConnector_ms": 0.0032907724380493164, "ViewRequirementAgentConnector_ms": 0.11855471134185791}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2204.0, "episode_return_mean": -174.97, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.2947886931816, "num_env_steps_trained_throughput_per_sec": 81.2947886931816, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 50719.23, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50719.133, "sample_time_ms": 1426.818, "learn_time_ms": 49272.2, "learn_throughput": 81.182, "synch_weights_time_ms": 16.948}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "ed30a_00000", "date": "2024-08-12_14-55-26", "timestamp": 1723488926, "time_this_iter_s": 49.244038105010986, "time_total_s": 2350.8340196609497, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01373a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2350.8340196609497, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 33.89855072463767, "ram_util_percent": 82.79999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.513495132106322, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.2538346662092463, "policy_loss": -0.008217370666307275, "vf_loss": 2.2612960546735734, "vf_explained_var": -7.022278649466378e-05, "kl": 0.010079603539017297, "entropy": 1.0598491848145843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.306087757954522, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.552113022375359, "policy_loss": -0.010863268646170144, "vf_loss": 2.562425511287003, "vf_explained_var": 0.019877332732790992, "kl": 0.007343721371335676, "entropy": 1.3293086257561173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2185.0, "episode_reward_mean": -105.94, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1670.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -191.27, "predator_policy": 138.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [256.0, -1476.0, 352.0, 328.0, 388.0, -74.0, 256.0, 370.0, 400.0, -182.0, -1481.0, -516.0, -85.0, 400.0, 400.0, -646.0, -2185.0, 400.0, -921.0, 332.0, 382.0, 346.0, 239.0, 358.0, -254.0, 335.0, 304.0, -1394.0, 394.0, -1949.0, -684.0, 400.0, 273.0, -763.0, 400.0, 377.0, 400.0, 298.0, -1021.0, 394.0, 328.0, 292.0, 370.0, 400.0, 183.0, 258.0, 376.0, 320.0, 370.0, 340.0, -1936.0, -1273.0, -1757.0, 358.0, -1723.0, -1326.0, -2106.0, -749.0, 244.0, 304.0, -148.0, -15.0, 112.0, 383.0, 335.0, 172.0, 394.0, -314.0, -868.0, 376.0, 235.0, 376.0, 376.0, 400.0, -594.0, 181.0, -830.0, -736.0, 376.0, 238.0, 394.0, 238.0, 202.0, 400.0, -802.0, 282.0, 286.0, 381.0, 364.0, -1289.0, 203.0, -867.0, -511.0, 336.0, 400.0, 70.0, 306.0, -254.0, 310.0, 84.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [24.0, 112.0, -977.0, -1219.0, 112.0, 200.0, 68.0, 200.0, 200.0, 178.0, -669.0, 200.0, -64.0, 200.0, 200.0, 145.0, 200.0, 200.0, -867.0, 200.0, -1450.0, -1351.0, -229.0, -702.0, 57.0, -427.0, 200.0, 200.0, 200.0, 200.0, -152.0, -1164.0, -1593.0, -1417.0, 200.0, 200.0, -658.0, -713.0, 35.0, 167.0, 200.0, 167.0, 101.0, 200.0, 79.0, 90.0, 200.0, 123.0, -845.0, 46.0, 35.0, 200.0, 200.0, 24.0, -955.0, -1164.0, 189.0, 200.0, -1670.0, -1219.0, -922.0, -372.0, 200.0, 200.0, -53.0, -9.0, -724.0, -669.0, 200.0, 200.0, 178.0, 189.0, 200.0, 200.0, 134.0, 24.0, -625.0, -1076.0, 189.0, 200.0, 79.0, 189.0, 178.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, -317.0, 123.0, 35.0, 200.0, 156.0, 156.0, 134.0, 200.0, 90.0, -20.0, 200.0, -1395.0, -1351.0, -1615.0, -493.0, -1076.0, -1626.0, 200.0, 123.0, -1373.0, -1175.0, -834.0, -1252.0, -1406.0, -1670.0, -735.0, -614.0, 13.0, 101.0, 24.0, 200.0, -713.0, 145.0, -64.0, -86.0, 134.0, -207.0, 200.0, 123.0, 35.0, 200.0, -218.0, 200.0, 200.0, 189.0, -1109.0, 200.0, -790.0, -548.0, 156.0, 200.0, 101.0, 79.0, 156.0, 200.0, 156.0, 200.0, 200.0, 200.0, -108.0, -1186.0, 57.0, -86.0, -394.0, -1131.0, -493.0, -1318.0, 156.0, 200.0, 200.0, -97.0, 200.0, 189.0, 189.0, -86.0, 13.0, -31.0, 200.0, 200.0, -603.0, -614.0, 13.0, 134.0, -9.0, 200.0, 200.0, 101.0, 134.0, 200.0, -878.0, -1131.0, -207.0, 200.0, -394.0, -1098.0, -471.0, -350.0, 189.0, 57.0, 200.0, 200.0, -405.0, 200.0, 200.0, -64.0, -1021.0, 112.0, 35.0, 200.0, -361.0, 90.0], "policy_predator_policy_reward": [65.0, 55.0, 0.0, 720.0, 0.0, 40.0, 60.0, 0.0, 10.0, 0.0, 395.0, 0.0, 120.0, 0.0, 25.0, 0.0, 0.0, 0.0, 10.0, 475.0, 885.0, 435.0, 5.0, 410.0, 0.0, 285.0, 0.0, 0.0, 0.0, 0.0, 50.0, 620.0, 5.0, 820.0, 0.0, 0.0, 15.0, 435.0, 50.0, 80.0, 15.0, 0.0, 0.0, 45.0, 40.0, 30.0, 0.0, 35.0, 70.0, 475.0, 65.0, 35.0, 0.0, 80.0, 50.0, 675.0, 0.0, 5.0, 0.0, 940.0, 0.0, 610.0, 0.0, 0.0, 170.0, 165.0, 485.0, 145.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 60.0, 80.0, 675.0, 5.0, 0.0, 5.0, 60.0, 0.0, 85.0, 60.0, 0.0, 25.0, 0.0, 0.0, 95.0, 205.0, 25.0, 75.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 100.0, 60.0, 810.0, 0.0, 815.0, 20.0, 25.0, 920.0, 0.0, 35.0, 30.0, 795.0, 45.0, 715.0, 25.0, 945.0, 540.0, 60.0, 45.0, 85.0, 30.0, 50.0, 30.0, 390.0, 5.0, 130.0, 135.0, 50.0, 35.0, 25.0, 75.0, 25.0, 0.0, 190.0, 0.0, 5.0, 575.0, 20.0, 0.0, 470.0, 0.0, 20.0, 0.0, 55.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 700.0, 160.0, 50.0, 40.0, 655.0, 475.0, 600.0, 20.0, 0.0, 30.0, 105.0, 0.0, 5.0, 80.0, 55.0, 120.0, 100.0, 0.0, 0.0, 5.0, 410.0, 65.0, 70.0, 30.0, 65.0, 40.0, 40.0, 30.0, 0.0, 680.0, 40.0, 170.0, 40.0, 0.0, 625.0, 310.0, 0.0, 25.0, 65.0, 0.0, 0.0, 0.0, 275.0, 55.0, 115.0, 540.0, 115.0, 70.0, 5.0, 280.0, 75.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7167255071093445, "mean_inference_ms": 1.737892380731291, "mean_action_processing_ms": 0.28302269216369935, "mean_env_wait_ms": 0.20325835431790984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041675567626953125, "StateBufferConnector_ms": 0.003280043601989746, "ViewRequirementAgentConnector_ms": 0.10513639450073242}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2185.0, "episode_return_mean": -105.94, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.63275594403382, "num_env_steps_trained_throughput_per_sec": 79.63275594403382, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 50660.454, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50660.357, "sample_time_ms": 1414.775, "learn_time_ms": 49225.62, "learn_throughput": 81.258, "synch_weights_time_ms": 16.854}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "ed30a_00000", "date": "2024-08-12_14-56-16", "timestamp": 1723488976, "time_this_iter_s": 50.262022972106934, "time_total_s": 2401.0960426330566, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2401.0960426330566, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 35.473239436619714, "ram_util_percent": 82.74507042253525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6976797099624361, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1862073957920076, "policy_loss": -0.006712872418698179, "vf_loss": 2.192298756957685, "vf_explained_var": -5.840132476160766e-05, "kl": 0.008286484492023141, "entropy": 1.1000180217954847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.874910218406606, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.463878968279198, "policy_loss": -0.015017106622413156, "vf_loss": 2.4778757811854124, "vf_explained_var": 0.029792960705580535, "kl": 0.013603857340617228, "entropy": 1.3339754645786588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2106.0, "episode_reward_mean": -49.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1670.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -151.89, "predator_policy": 127.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-921.0, 332.0, 382.0, 346.0, 239.0, 358.0, -254.0, 335.0, 304.0, -1394.0, 394.0, -1949.0, -684.0, 400.0, 273.0, -763.0, 400.0, 377.0, 400.0, 298.0, -1021.0, 394.0, 328.0, 292.0, 370.0, 400.0, 183.0, 258.0, 376.0, 320.0, 370.0, 340.0, -1936.0, -1273.0, -1757.0, 358.0, -1723.0, -1326.0, -2106.0, -749.0, 244.0, 304.0, -148.0, -15.0, 112.0, 383.0, 335.0, 172.0, 394.0, -314.0, -868.0, 376.0, 235.0, 376.0, 376.0, 400.0, -594.0, 181.0, -830.0, -736.0, 376.0, 238.0, 394.0, 238.0, 202.0, 400.0, -802.0, 282.0, 286.0, 381.0, 364.0, -1289.0, 203.0, -867.0, -511.0, 336.0, 400.0, 70.0, 306.0, -254.0, 310.0, 84.0, 291.0, 334.0, 318.0, -442.0, 226.0, 367.0, 388.0, 289.0, 154.0, -301.0, -40.0, 340.0, -50.0, 370.0, 292.0, 130.0, -520.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-658.0, -713.0, 35.0, 167.0, 200.0, 167.0, 101.0, 200.0, 79.0, 90.0, 200.0, 123.0, -845.0, 46.0, 35.0, 200.0, 200.0, 24.0, -955.0, -1164.0, 189.0, 200.0, -1670.0, -1219.0, -922.0, -372.0, 200.0, 200.0, -53.0, -9.0, -724.0, -669.0, 200.0, 200.0, 178.0, 189.0, 200.0, 200.0, 134.0, 24.0, -625.0, -1076.0, 189.0, 200.0, 79.0, 189.0, 178.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, -317.0, 123.0, 35.0, 200.0, 156.0, 156.0, 134.0, 200.0, 90.0, -20.0, 200.0, -1395.0, -1351.0, -1615.0, -493.0, -1076.0, -1626.0, 200.0, 123.0, -1373.0, -1175.0, -834.0, -1252.0, -1406.0, -1670.0, -735.0, -614.0, 13.0, 101.0, 24.0, 200.0, -713.0, 145.0, -64.0, -86.0, 134.0, -207.0, 200.0, 123.0, 35.0, 200.0, -218.0, 200.0, 200.0, 189.0, -1109.0, 200.0, -790.0, -548.0, 156.0, 200.0, 101.0, 79.0, 156.0, 200.0, 156.0, 200.0, 200.0, 200.0, -108.0, -1186.0, 57.0, -86.0, -394.0, -1131.0, -493.0, -1318.0, 156.0, 200.0, 200.0, -97.0, 200.0, 189.0, 189.0, -86.0, 13.0, -31.0, 200.0, 200.0, -603.0, -614.0, 13.0, 134.0, -9.0, 200.0, 200.0, 101.0, 134.0, 200.0, -878.0, -1131.0, -207.0, 200.0, -394.0, -1098.0, -471.0, -350.0, 189.0, 57.0, 200.0, 200.0, -405.0, 200.0, 200.0, -64.0, -1021.0, 112.0, 35.0, 200.0, -361.0, 90.0, -31.0, 167.0, 189.0, 90.0, 145.0, 123.0, 24.0, -1241.0, -108.0, 134.0, 200.0, 112.0, 178.0, 200.0, 57.0, 167.0, 200.0, -251.0, -416.0, -240.0, -163.0, -42.0, 112.0, 178.0, -614.0, 189.0, 178.0, 167.0, 24.0, 178.0, 200.0, -295.0, -416.0, -504.0, 200.0, 200.0], "policy_predator_policy_reward": [15.0, 435.0, 50.0, 80.0, 15.0, 0.0, 0.0, 45.0, 40.0, 30.0, 0.0, 35.0, 70.0, 475.0, 65.0, 35.0, 0.0, 80.0, 50.0, 675.0, 0.0, 5.0, 0.0, 940.0, 0.0, 610.0, 0.0, 0.0, 170.0, 165.0, 485.0, 145.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 60.0, 80.0, 675.0, 5.0, 0.0, 5.0, 60.0, 0.0, 85.0, 60.0, 0.0, 25.0, 0.0, 0.0, 95.0, 205.0, 25.0, 75.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 100.0, 60.0, 810.0, 0.0, 815.0, 20.0, 25.0, 920.0, 0.0, 35.0, 30.0, 795.0, 45.0, 715.0, 25.0, 945.0, 540.0, 60.0, 45.0, 85.0, 30.0, 50.0, 30.0, 390.0, 5.0, 130.0, 135.0, 50.0, 35.0, 25.0, 75.0, 25.0, 0.0, 190.0, 0.0, 5.0, 575.0, 20.0, 0.0, 470.0, 0.0, 20.0, 0.0, 55.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 700.0, 160.0, 50.0, 40.0, 655.0, 475.0, 600.0, 20.0, 0.0, 30.0, 105.0, 0.0, 5.0, 80.0, 55.0, 120.0, 100.0, 0.0, 0.0, 5.0, 410.0, 65.0, 70.0, 30.0, 65.0, 40.0, 40.0, 30.0, 0.0, 680.0, 40.0, 170.0, 40.0, 0.0, 625.0, 310.0, 0.0, 25.0, 65.0, 0.0, 0.0, 0.0, 275.0, 55.0, 115.0, 540.0, 115.0, 70.0, 5.0, 280.0, 75.0, 55.0, 100.0, 0.0, 55.0, 35.0, 15.0, 155.0, 620.0, 90.0, 110.0, 40.0, 15.0, 0.0, 10.0, 0.0, 65.0, 135.0, 70.0, 200.0, 155.0, 165.0, 0.0, 40.0, 10.0, 370.0, 5.0, 25.0, 0.0, 10.0, 80.0, 225.0, 0.0, 0.0, 400.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7150864574573458, "mean_inference_ms": 1.7320405132954568, "mean_action_processing_ms": 0.28256749838684686, "mean_env_wait_ms": 0.20279891537219405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004519820213317871, "StateBufferConnector_ms": 0.003347635269165039, "ViewRequirementAgentConnector_ms": 0.1047598123550415}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2106.0, "episode_return_mean": -49.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.61204864915103, "num_env_steps_trained_throughput_per_sec": 80.61204864915103, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 50408.905, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50408.808, "sample_time_ms": 1379.247, "learn_time_ms": 49010.139, "learn_throughput": 81.616, "synch_weights_time_ms": 16.756}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "ed30a_00000", "date": "2024-08-12_14-57-06", "timestamp": 1723489026, "time_this_iter_s": 49.65855693817139, "time_total_s": 2450.754599571228, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0137550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2450.754599571228, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 34.823943661971825, "ram_util_percent": 82.73661971830987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5634482268933896, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4218513095820393, "policy_loss": -0.004510653551505317, "vf_loss": 2.425890486139469, "vf_explained_var": 0.0008059339233176418, "kl": 0.006286378307485725, "entropy": 1.0609095475030323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.432258534131858, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4989706132147047, "policy_loss": -0.015674496381962427, "vf_loss": 2.5136971259243275, "vf_explained_var": 0.01675754145339683, "kl": 0.012639755897444961, "entropy": 1.3355027787269107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2106.0, "episode_reward_mean": -16.37, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1670.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -136.435, "predator_policy": 128.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 298.0, -1021.0, 394.0, 328.0, 292.0, 370.0, 400.0, 183.0, 258.0, 376.0, 320.0, 370.0, 340.0, -1936.0, -1273.0, -1757.0, 358.0, -1723.0, -1326.0, -2106.0, -749.0, 244.0, 304.0, -148.0, -15.0, 112.0, 383.0, 335.0, 172.0, 394.0, -314.0, -868.0, 376.0, 235.0, 376.0, 376.0, 400.0, -594.0, 181.0, -830.0, -736.0, 376.0, 238.0, 394.0, 238.0, 202.0, 400.0, -802.0, 282.0, 286.0, 381.0, 364.0, -1289.0, 203.0, -867.0, -511.0, 336.0, 400.0, 70.0, 306.0, -254.0, 310.0, 84.0, 291.0, 334.0, 318.0, -442.0, 226.0, 367.0, 388.0, 289.0, 154.0, -301.0, -40.0, 340.0, -50.0, 370.0, 292.0, 130.0, -520.0, 400.0, 376.0, -130.0, 352.0, 355.0, 312.0, -38.0, 61.0, -20.0, 32.0, 156.0, 139.0, 118.0, 20.0, 346.0, -519.0, -136.0, -2.0, 69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 134.0, 24.0, -625.0, -1076.0, 189.0, 200.0, 79.0, 189.0, 178.0, -31.0, 200.0, 145.0, 200.0, 200.0, 200.0, -317.0, 123.0, 35.0, 200.0, 156.0, 156.0, 134.0, 200.0, 90.0, -20.0, 200.0, -1395.0, -1351.0, -1615.0, -493.0, -1076.0, -1626.0, 200.0, 123.0, -1373.0, -1175.0, -834.0, -1252.0, -1406.0, -1670.0, -735.0, -614.0, 13.0, 101.0, 24.0, 200.0, -713.0, 145.0, -64.0, -86.0, 134.0, -207.0, 200.0, 123.0, 35.0, 200.0, -218.0, 200.0, 200.0, 189.0, -1109.0, 200.0, -790.0, -548.0, 156.0, 200.0, 101.0, 79.0, 156.0, 200.0, 156.0, 200.0, 200.0, 200.0, -108.0, -1186.0, 57.0, -86.0, -394.0, -1131.0, -493.0, -1318.0, 156.0, 200.0, 200.0, -97.0, 200.0, 189.0, 189.0, -86.0, 13.0, -31.0, 200.0, 200.0, -603.0, -614.0, 13.0, 134.0, -9.0, 200.0, 200.0, 101.0, 134.0, 200.0, -878.0, -1131.0, -207.0, 200.0, -394.0, -1098.0, -471.0, -350.0, 189.0, 57.0, 200.0, 200.0, -405.0, 200.0, 200.0, -64.0, -1021.0, 112.0, 35.0, 200.0, -361.0, 90.0, -31.0, 167.0, 189.0, 90.0, 145.0, 123.0, 24.0, -1241.0, -108.0, 134.0, 200.0, 112.0, 178.0, 200.0, 57.0, 167.0, 200.0, -251.0, -416.0, -240.0, -163.0, -42.0, 112.0, 178.0, -614.0, 189.0, 178.0, 167.0, 24.0, 178.0, 200.0, -295.0, -416.0, -504.0, 200.0, 200.0, 200.0, 156.0, 200.0, -845.0, 167.0, 145.0, 200.0, 35.0, 2.0, 200.0, -504.0, 101.0, -504.0, 200.0, 57.0, -427.0, -163.0, -75.0, -339.0, 145.0, 200.0, -361.0, -306.0, 189.0, -504.0, 189.0, 200.0, 101.0, -603.0, -416.0, -339.0, -152.0, -460.0, 123.0, 167.0, -438.0], "policy_predator_policy_reward": [0.0, 0.0, 60.0, 80.0, 675.0, 5.0, 0.0, 5.0, 60.0, 0.0, 85.0, 60.0, 0.0, 25.0, 0.0, 0.0, 95.0, 205.0, 25.0, 75.0, 20.0, 0.0, 0.0, 30.0, 30.0, 50.0, 100.0, 60.0, 810.0, 0.0, 815.0, 20.0, 25.0, 920.0, 0.0, 35.0, 30.0, 795.0, 45.0, 715.0, 25.0, 945.0, 540.0, 60.0, 45.0, 85.0, 30.0, 50.0, 30.0, 390.0, 5.0, 130.0, 135.0, 50.0, 35.0, 25.0, 75.0, 25.0, 0.0, 190.0, 0.0, 5.0, 575.0, 20.0, 0.0, 470.0, 0.0, 20.0, 0.0, 55.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 700.0, 160.0, 50.0, 40.0, 655.0, 475.0, 600.0, 20.0, 0.0, 30.0, 105.0, 0.0, 5.0, 80.0, 55.0, 120.0, 100.0, 0.0, 0.0, 5.0, 410.0, 65.0, 70.0, 30.0, 65.0, 40.0, 40.0, 30.0, 0.0, 680.0, 40.0, 170.0, 40.0, 0.0, 625.0, 310.0, 0.0, 25.0, 65.0, 0.0, 0.0, 0.0, 275.0, 55.0, 115.0, 540.0, 115.0, 70.0, 5.0, 280.0, 75.0, 55.0, 100.0, 0.0, 55.0, 35.0, 15.0, 155.0, 620.0, 90.0, 110.0, 40.0, 15.0, 0.0, 10.0, 0.0, 65.0, 135.0, 70.0, 200.0, 155.0, 165.0, 0.0, 40.0, 10.0, 370.0, 5.0, 25.0, 0.0, 10.0, 80.0, 225.0, 0.0, 0.0, 400.0, 0.0, 0.0, 5.0, 15.0, 85.0, 430.0, 0.0, 40.0, 75.0, 45.0, 35.0, 75.0, 65.0, 300.0, 45.0, 320.0, 65.0, 285.0, 100.0, 170.0, 85.0, 265.0, 45.0, 255.0, 0.0, 235.0, 45.0, 290.0, 0.0, 45.0, 375.0, 125.0, 55.0, 300.0, 40.0, 295.0, 160.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7136113252046, "mean_inference_ms": 1.7268146852886628, "mean_action_processing_ms": 0.2821275167482015, "mean_env_wait_ms": 0.20238180643069753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004905104637145996, "StateBufferConnector_ms": 0.0031871795654296875, "ViewRequirementAgentConnector_ms": 0.10075545310974121}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2106.0, "episode_return_mean": -16.37, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.5053187145196, "num_env_steps_trained_throughput_per_sec": 80.5053187145196, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 50199.447, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50199.351, "sample_time_ms": 1343.135, "learn_time_ms": 48837.122, "learn_throughput": 81.905, "synch_weights_time_ms": 16.405}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "ed30a_00000", "date": "2024-08-12_14-57-55", "timestamp": 1723489075, "time_this_iter_s": 49.75719118118286, "time_total_s": 2500.511790752411, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2500.511790752411, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 32.605714285714285, "ram_util_percent": 82.91142857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.523754471130472, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.986549864622651, "policy_loss": -0.005582536890407995, "vf_loss": 1.9917457355077934, "vf_explained_var": -3.218158843025328e-05, "kl": 0.005155551508095602, "entropy": 0.9909975625535168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.498077552943003, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9074976601613263, "policy_loss": -0.016820865410882683, "vf_loss": 1.9233603624439743, "vf_explained_var": 0.018769290901365733, "kl": 0.012775496234282374, "entropy": 1.3007986912651668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1289.0, "episode_reward_mean": 76.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1318.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 700.0}, "policy_reward_mean": {"prey_policy": -76.155, "predator_policy": 114.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [244.0, 304.0, -148.0, -15.0, 112.0, 383.0, 335.0, 172.0, 394.0, -314.0, -868.0, 376.0, 235.0, 376.0, 376.0, 400.0, -594.0, 181.0, -830.0, -736.0, 376.0, 238.0, 394.0, 238.0, 202.0, 400.0, -802.0, 282.0, 286.0, 381.0, 364.0, -1289.0, 203.0, -867.0, -511.0, 336.0, 400.0, 70.0, 306.0, -254.0, 310.0, 84.0, 291.0, 334.0, 318.0, -442.0, 226.0, 367.0, 388.0, 289.0, 154.0, -301.0, -40.0, 340.0, -50.0, 370.0, 292.0, 130.0, -520.0, 400.0, 376.0, -130.0, 352.0, 355.0, 312.0, -38.0, 61.0, -20.0, 32.0, 156.0, 139.0, 118.0, 20.0, 346.0, -519.0, -136.0, -2.0, 69.0, 360.0, 76.0, 17.0, 179.0, 210.0, 136.0, -14.0, -254.0, 388.0, 172.0, 400.0, 370.0, 100.0, 245.0, 376.0, 339.0, -754.0, 200.0, -211.0, -838.0, 358.0, 232.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 101.0, 24.0, 200.0, -713.0, 145.0, -64.0, -86.0, 134.0, -207.0, 200.0, 123.0, 35.0, 200.0, -218.0, 200.0, 200.0, 189.0, -1109.0, 200.0, -790.0, -548.0, 156.0, 200.0, 101.0, 79.0, 156.0, 200.0, 156.0, 200.0, 200.0, 200.0, -108.0, -1186.0, 57.0, -86.0, -394.0, -1131.0, -493.0, -1318.0, 156.0, 200.0, 200.0, -97.0, 200.0, 189.0, 189.0, -86.0, 13.0, -31.0, 200.0, 200.0, -603.0, -614.0, 13.0, 134.0, -9.0, 200.0, 200.0, 101.0, 134.0, 200.0, -878.0, -1131.0, -207.0, 200.0, -394.0, -1098.0, -471.0, -350.0, 189.0, 57.0, 200.0, 200.0, -405.0, 200.0, 200.0, -64.0, -1021.0, 112.0, 35.0, 200.0, -361.0, 90.0, -31.0, 167.0, 189.0, 90.0, 145.0, 123.0, 24.0, -1241.0, -108.0, 134.0, 200.0, 112.0, 178.0, 200.0, 57.0, 167.0, 200.0, -251.0, -416.0, -240.0, -163.0, -42.0, 112.0, 178.0, -614.0, 189.0, 178.0, 167.0, 24.0, 178.0, 200.0, -295.0, -416.0, -504.0, 200.0, 200.0, 200.0, 156.0, 200.0, -845.0, 167.0, 145.0, 200.0, 35.0, 2.0, 200.0, -504.0, 101.0, -504.0, 200.0, 57.0, -427.0, -163.0, -75.0, -339.0, 145.0, 200.0, -361.0, -306.0, 189.0, -504.0, 189.0, 200.0, 101.0, -603.0, -416.0, -339.0, -152.0, -460.0, 123.0, 167.0, -438.0, 178.0, 167.0, -394.0, 200.0, -460.0, 167.0, -174.0, 178.0, 90.0, 35.0, 200.0, -284.0, -108.0, -251.0, -31.0, -878.0, 200.0, 178.0, 79.0, -97.0, 200.0, 200.0, 200.0, 145.0, -207.0, 57.0, -130.0, 200.0, 156.0, 200.0, 79.0, 200.0, -669.0, -515.0, -295.0, 200.0, -394.0, -97.0, -889.0, -724.0, 200.0, 123.0, -64.0, 156.0], "policy_predator_policy_reward": [45.0, 85.0, 30.0, 50.0, 30.0, 390.0, 5.0, 130.0, 135.0, 50.0, 35.0, 25.0, 75.0, 25.0, 0.0, 190.0, 0.0, 5.0, 575.0, 20.0, 0.0, 470.0, 0.0, 20.0, 0.0, 55.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 700.0, 160.0, 50.0, 40.0, 655.0, 475.0, 600.0, 20.0, 0.0, 30.0, 105.0, 0.0, 5.0, 80.0, 55.0, 120.0, 100.0, 0.0, 0.0, 5.0, 410.0, 65.0, 70.0, 30.0, 65.0, 40.0, 40.0, 30.0, 0.0, 680.0, 40.0, 170.0, 40.0, 0.0, 625.0, 310.0, 0.0, 25.0, 65.0, 0.0, 0.0, 0.0, 275.0, 55.0, 115.0, 540.0, 115.0, 70.0, 5.0, 280.0, 75.0, 55.0, 100.0, 0.0, 55.0, 35.0, 15.0, 155.0, 620.0, 90.0, 110.0, 40.0, 15.0, 0.0, 10.0, 0.0, 65.0, 135.0, 70.0, 200.0, 155.0, 165.0, 0.0, 40.0, 10.0, 370.0, 5.0, 25.0, 0.0, 10.0, 80.0, 225.0, 0.0, 0.0, 400.0, 0.0, 0.0, 5.0, 15.0, 85.0, 430.0, 0.0, 40.0, 75.0, 45.0, 35.0, 75.0, 65.0, 300.0, 45.0, 320.0, 65.0, 285.0, 100.0, 170.0, 85.0, 265.0, 45.0, 255.0, 0.0, 235.0, 45.0, 290.0, 0.0, 45.0, 375.0, 125.0, 55.0, 300.0, 40.0, 295.0, 160.0, 180.0, 0.0, 15.0, 0.0, 270.0, 310.0, 0.0, 175.0, 0.0, 0.0, 85.0, 0.0, 220.0, 260.0, 85.0, 550.0, 105.0, 10.0, 0.0, 60.0, 130.0, 0.0, 0.0, 0.0, 25.0, 185.0, 65.0, 45.0, 130.0, 20.0, 0.0, 20.0, 40.0, 430.0, 0.0, 160.0, 135.0, 280.0, 0.0, 150.0, 625.0, 0.0, 35.0, 120.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7147416449528246, "mean_inference_ms": 1.7260454760881963, "mean_action_processing_ms": 0.28249846598481226, "mean_env_wait_ms": 0.20238190615544618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006537795066833496, "StateBufferConnector_ms": 0.0032416582107543945, "ViewRequirementAgentConnector_ms": 0.1211862564086914}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -1289.0, "episode_return_mean": 76.54, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.65471900684406, "num_env_steps_trained_throughput_per_sec": 77.65471900684406, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 50141.025, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50140.93, "sample_time_ms": 1316.73, "learn_time_ms": 48806.368, "learn_throughput": 81.957, "synch_weights_time_ms": 14.846}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "ed30a_00000", "date": "2024-08-12_14-58-47", "timestamp": 1723489127, "time_this_iter_s": 51.550867795944214, "time_total_s": 2552.062658548355, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00b0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2552.062658548355, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 41.04931506849315, "ram_util_percent": 82.64931506849315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6227718727929252, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6954497733128764, "policy_loss": -0.006270116121537747, "vf_loss": 1.7012468636351288, "vf_explained_var": 0.0012220766809251573, "kl": 0.006306997521418423, "entropy": 0.9925592609498867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.473657605666963, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8493302439571058, "policy_loss": -0.01477393581354547, "vf_loss": 1.8633198489587774, "vf_explained_var": 0.019321517433438982, "kl": 0.01045769467025708, "entropy": 1.34701074853776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1289.0, "episode_reward_mean": 120.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 680.0}, "policy_reward_mean": {"prey_policy": -40.955, "predator_policy": 101.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0, 202.0, 400.0, -802.0, 282.0, 286.0, 381.0, 364.0, -1289.0, 203.0, -867.0, -511.0, 336.0, 400.0, 70.0, 306.0, -254.0, 310.0, 84.0, 291.0, 334.0, 318.0, -442.0, 226.0, 367.0, 388.0, 289.0, 154.0, -301.0, -40.0, 340.0, -50.0, 370.0, 292.0, 130.0, -520.0, 400.0, 376.0, -130.0, 352.0, 355.0, 312.0, -38.0, 61.0, -20.0, 32.0, 156.0, 139.0, 118.0, 20.0, 346.0, -519.0, -136.0, -2.0, 69.0, 360.0, 76.0, 17.0, 179.0, 210.0, 136.0, -14.0, -254.0, 388.0, 172.0, 400.0, 370.0, 100.0, 245.0, 376.0, 339.0, -754.0, 200.0, -211.0, -838.0, 358.0, 232.0, 400.0, -172.0, 298.0, 369.0, 83.0, -156.0, 143.0, 166.0, 346.0, 400.0, 400.0, 316.0, 400.0, 370.0, 394.0, 344.0, 382.0, 262.0, -169.0, 304.0, 400.0, 280.0, 196.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.0, -86.0, 13.0, -31.0, 200.0, 200.0, -603.0, -614.0, 13.0, 134.0, -9.0, 200.0, 200.0, 101.0, 134.0, 200.0, -878.0, -1131.0, -207.0, 200.0, -394.0, -1098.0, -471.0, -350.0, 189.0, 57.0, 200.0, 200.0, -405.0, 200.0, 200.0, -64.0, -1021.0, 112.0, 35.0, 200.0, -361.0, 90.0, -31.0, 167.0, 189.0, 90.0, 145.0, 123.0, 24.0, -1241.0, -108.0, 134.0, 200.0, 112.0, 178.0, 200.0, 57.0, 167.0, 200.0, -251.0, -416.0, -240.0, -163.0, -42.0, 112.0, 178.0, -614.0, 189.0, 178.0, 167.0, 24.0, 178.0, 200.0, -295.0, -416.0, -504.0, 200.0, 200.0, 200.0, 156.0, 200.0, -845.0, 167.0, 145.0, 200.0, 35.0, 2.0, 200.0, -504.0, 101.0, -504.0, 200.0, 57.0, -427.0, -163.0, -75.0, -339.0, 145.0, 200.0, -361.0, -306.0, 189.0, -504.0, 189.0, 200.0, 101.0, -603.0, -416.0, -339.0, -152.0, -460.0, 123.0, 167.0, -438.0, 178.0, 167.0, -394.0, 200.0, -460.0, 167.0, -174.0, 178.0, 90.0, 35.0, 200.0, -284.0, -108.0, -251.0, -31.0, -878.0, 200.0, 178.0, 79.0, -97.0, 200.0, 200.0, 200.0, 145.0, -207.0, 57.0, -130.0, 200.0, 156.0, 200.0, 79.0, 200.0, -669.0, -515.0, -295.0, 200.0, -394.0, -97.0, -889.0, -724.0, 200.0, 123.0, -64.0, 156.0, 200.0, 200.0, -229.0, -438.0, 13.0, 200.0, 200.0, 134.0, -526.0, 189.0, -284.0, -207.0, -75.0, 68.0, -97.0, 68.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 57.0, 189.0, 200.0, 200.0, 145.0, 200.0, 189.0, 200.0, 200.0, 24.0, 167.0, 200.0, -53.0, 200.0, -218.0, -196.0, 178.0, 46.0, 200.0, 200.0, -20.0, 200.0, 79.0, 2.0], "policy_predator_policy_reward": [80.0, 55.0, 120.0, 100.0, 0.0, 0.0, 5.0, 410.0, 65.0, 70.0, 30.0, 65.0, 40.0, 40.0, 30.0, 0.0, 680.0, 40.0, 170.0, 40.0, 0.0, 625.0, 310.0, 0.0, 25.0, 65.0, 0.0, 0.0, 0.0, 275.0, 55.0, 115.0, 540.0, 115.0, 70.0, 5.0, 280.0, 75.0, 55.0, 100.0, 0.0, 55.0, 35.0, 15.0, 155.0, 620.0, 90.0, 110.0, 40.0, 15.0, 0.0, 10.0, 0.0, 65.0, 135.0, 70.0, 200.0, 155.0, 165.0, 0.0, 40.0, 10.0, 370.0, 5.0, 25.0, 0.0, 10.0, 80.0, 225.0, 0.0, 0.0, 400.0, 0.0, 0.0, 5.0, 15.0, 85.0, 430.0, 0.0, 40.0, 75.0, 45.0, 35.0, 75.0, 65.0, 300.0, 45.0, 320.0, 65.0, 285.0, 100.0, 170.0, 85.0, 265.0, 45.0, 255.0, 0.0, 235.0, 45.0, 290.0, 0.0, 45.0, 375.0, 125.0, 55.0, 300.0, 40.0, 295.0, 160.0, 180.0, 0.0, 15.0, 0.0, 270.0, 310.0, 0.0, 175.0, 0.0, 0.0, 85.0, 0.0, 220.0, 260.0, 85.0, 550.0, 105.0, 10.0, 0.0, 60.0, 130.0, 0.0, 0.0, 0.0, 25.0, 185.0, 65.0, 45.0, 130.0, 20.0, 0.0, 20.0, 40.0, 430.0, 0.0, 160.0, 135.0, 280.0, 0.0, 150.0, 625.0, 0.0, 35.0, 120.0, 20.0, 0.0, 0.0, 315.0, 180.0, 40.0, 45.0, 15.0, 20.0, 155.0, 265.0, 255.0, 80.0, 130.0, 20.0, 135.0, 60.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 65.0, 0.0, 0.0, 0.0, 25.0, 0.0, 5.0, 80.0, 40.0, 0.0, 15.0, 0.0, 115.0, 245.0, 0.0, 70.0, 10.0, 0.0, 0.0, 100.0, 0.0, 110.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7148097812175191, "mean_inference_ms": 1.7259219463555242, "mean_action_processing_ms": 0.2827934585351455, "mean_env_wait_ms": 0.202324543635576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00811457633972168, "StateBufferConnector_ms": 0.003258228302001953, "ViewRequirementAgentConnector_ms": 0.12480247020721436}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -1289.0, "episode_return_mean": 120.19, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.57611279776704, "num_env_steps_trained_throughput_per_sec": 80.57611279776704, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 50177.022, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50176.926, "sample_time_ms": 1318.429, "learn_time_ms": 48840.085, "learn_throughput": 81.9, "synch_weights_time_ms": 15.321}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "ed30a_00000", "date": "2024-08-12_14-59-37", "timestamp": 1723489177, "time_this_iter_s": 49.68057298660278, "time_total_s": 2601.743231534958, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2601.743231534958, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 39.05857142857142, "ram_util_percent": 82.48714285714284}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4274050150756483, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2730756329480932, "policy_loss": -0.007606208082855182, "vf_loss": 1.280203849313751, "vf_explained_var": 0.0019153659621243754, "kl": 0.006373219265550726, "entropy": 0.9869663544432826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.156231843447559, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4401228497898768, "policy_loss": -0.01637047002764626, "vf_loss": 1.4558961081757116, "vf_explained_var": 0.028171803333141187, "kl": 0.007962813926774207, "entropy": 1.316462969843042, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -838.0, "episode_reward_mean": 160.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1241.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 625.0}, "policy_reward_mean": {"prey_policy": -12.135, "predator_policy": 92.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.0, 291.0, 334.0, 318.0, -442.0, 226.0, 367.0, 388.0, 289.0, 154.0, -301.0, -40.0, 340.0, -50.0, 370.0, 292.0, 130.0, -520.0, 400.0, 376.0, -130.0, 352.0, 355.0, 312.0, -38.0, 61.0, -20.0, 32.0, 156.0, 139.0, 118.0, 20.0, 346.0, -519.0, -136.0, -2.0, 69.0, 360.0, 76.0, 17.0, 179.0, 210.0, 136.0, -14.0, -254.0, 388.0, 172.0, 400.0, 370.0, 100.0, 245.0, 376.0, 339.0, -754.0, 200.0, -211.0, -838.0, 358.0, 232.0, 400.0, -172.0, 298.0, 369.0, 83.0, -156.0, 143.0, 166.0, 346.0, 400.0, 400.0, 316.0, 400.0, 370.0, 394.0, 344.0, 382.0, 262.0, -169.0, 304.0, 400.0, 280.0, 196.0, 364.0, -81.0, 354.0, 274.0, 148.0, -375.0, 340.0, 18.0, 346.0, 340.0, 364.0, 328.0, 124.0, 364.0, 292.0, 201.0, 390.0, 313.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-361.0, 90.0, -31.0, 167.0, 189.0, 90.0, 145.0, 123.0, 24.0, -1241.0, -108.0, 134.0, 200.0, 112.0, 178.0, 200.0, 57.0, 167.0, 200.0, -251.0, -416.0, -240.0, -163.0, -42.0, 112.0, 178.0, -614.0, 189.0, 178.0, 167.0, 24.0, 178.0, 200.0, -295.0, -416.0, -504.0, 200.0, 200.0, 200.0, 156.0, 200.0, -845.0, 167.0, 145.0, 200.0, 35.0, 2.0, 200.0, -504.0, 101.0, -504.0, 200.0, 57.0, -427.0, -163.0, -75.0, -339.0, 145.0, 200.0, -361.0, -306.0, 189.0, -504.0, 189.0, 200.0, 101.0, -603.0, -416.0, -339.0, -152.0, -460.0, 123.0, 167.0, -438.0, 178.0, 167.0, -394.0, 200.0, -460.0, 167.0, -174.0, 178.0, 90.0, 35.0, 200.0, -284.0, -108.0, -251.0, -31.0, -878.0, 200.0, 178.0, 79.0, -97.0, 200.0, 200.0, 200.0, 145.0, -207.0, 57.0, -130.0, 200.0, 156.0, 200.0, 79.0, 200.0, -669.0, -515.0, -295.0, 200.0, -394.0, -97.0, -889.0, -724.0, 200.0, 123.0, -64.0, 156.0, 200.0, 200.0, -229.0, -438.0, 13.0, 200.0, 200.0, 134.0, -526.0, 189.0, -284.0, -207.0, -75.0, 68.0, -97.0, 68.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 57.0, 189.0, 200.0, 200.0, 145.0, 200.0, 189.0, 200.0, 200.0, 24.0, 167.0, 200.0, -53.0, 200.0, -218.0, -196.0, 178.0, 46.0, 200.0, 200.0, -20.0, 200.0, 79.0, 2.0, 200.0, 134.0, 145.0, -581.0, 79.0, 200.0, 200.0, -31.0, 46.0, 2.0, -119.0, -801.0, 200.0, 90.0, 35.0, -317.0, 101.0, 200.0, 200.0, 90.0, 189.0, 145.0, 200.0, 68.0, -306.0, 200.0, 200.0, 134.0, 2.0, 200.0, 200.0, -284.0, 145.0, 200.0, 13.0, 200.0], "policy_predator_policy_reward": [280.0, 75.0, 55.0, 100.0, 0.0, 55.0, 35.0, 15.0, 155.0, 620.0, 90.0, 110.0, 40.0, 15.0, 0.0, 10.0, 0.0, 65.0, 135.0, 70.0, 200.0, 155.0, 165.0, 0.0, 40.0, 10.0, 370.0, 5.0, 25.0, 0.0, 10.0, 80.0, 225.0, 0.0, 0.0, 400.0, 0.0, 0.0, 5.0, 15.0, 85.0, 430.0, 0.0, 40.0, 75.0, 45.0, 35.0, 75.0, 65.0, 300.0, 45.0, 320.0, 65.0, 285.0, 100.0, 170.0, 85.0, 265.0, 45.0, 255.0, 0.0, 235.0, 45.0, 290.0, 0.0, 45.0, 375.0, 125.0, 55.0, 300.0, 40.0, 295.0, 160.0, 180.0, 0.0, 15.0, 0.0, 270.0, 310.0, 0.0, 175.0, 0.0, 0.0, 85.0, 0.0, 220.0, 260.0, 85.0, 550.0, 105.0, 10.0, 0.0, 60.0, 130.0, 0.0, 0.0, 0.0, 25.0, 185.0, 65.0, 45.0, 130.0, 20.0, 0.0, 20.0, 40.0, 430.0, 0.0, 160.0, 135.0, 280.0, 0.0, 150.0, 625.0, 0.0, 35.0, 120.0, 20.0, 0.0, 0.0, 315.0, 180.0, 40.0, 45.0, 15.0, 20.0, 155.0, 265.0, 255.0, 80.0, 130.0, 20.0, 135.0, 60.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 65.0, 0.0, 0.0, 0.0, 25.0, 0.0, 5.0, 80.0, 40.0, 0.0, 15.0, 0.0, 115.0, 245.0, 0.0, 70.0, 10.0, 0.0, 0.0, 100.0, 0.0, 110.0, 5.0, 30.0, 0.0, 60.0, 295.0, 40.0, 35.0, 105.0, 0.0, 75.0, 25.0, 0.0, 545.0, 0.0, 50.0, 235.0, 65.0, 45.0, 0.0, 0.0, 50.0, 0.0, 30.0, 60.0, 0.0, 0.0, 230.0, 30.0, 0.0, 0.0, 90.0, 65.0, 220.0, 20.0, 25.0, 85.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7164467793296404, "mean_inference_ms": 1.7253205404331737, "mean_action_processing_ms": 0.2830118719471818, "mean_env_wait_ms": 0.20222283035778246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007946610450744629, "StateBufferConnector_ms": 0.003670215606689453, "ViewRequirementAgentConnector_ms": 0.12540936470031738}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -838.0, "episode_return_mean": 160.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.77442853002886, "num_env_steps_trained_throughput_per_sec": 82.77442853002886, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 49953.646, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49953.55, "sample_time_ms": 1320.525, "learn_time_ms": 48614.919, "learn_throughput": 82.279, "synch_weights_time_ms": 14.893}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "ed30a_00000", "date": "2024-08-12_15-00-25", "timestamp": 1723489225, "time_this_iter_s": 48.357444047927856, "time_total_s": 2650.1006755828857, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2650.1006755828857, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 32.620588235294115, "ram_util_percent": 82.63676470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5178672622751306, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9776248643953334, "policy_loss": -0.004124751496843245, "vf_loss": 0.9811430199042199, "vf_explained_var": -7.230648918757364e-05, "kl": 0.008087928787951188, "entropy": 0.9673831126361928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.5465669266445925, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9656573384339926, "policy_loss": -0.016681869974034647, "vf_loss": 0.981564995583403, "vf_explained_var": 0.026349338967964132, "kl": 0.010322821187674011, "entropy": 1.3132976514952523, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -838.0, "episode_reward_mean": 181.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1032.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 625.0}, "policy_reward_mean": {"prey_policy": 4.255, "predator_policy": 86.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 376.0, -130.0, 352.0, 355.0, 312.0, -38.0, 61.0, -20.0, 32.0, 156.0, 139.0, 118.0, 20.0, 346.0, -519.0, -136.0, -2.0, 69.0, 360.0, 76.0, 17.0, 179.0, 210.0, 136.0, -14.0, -254.0, 388.0, 172.0, 400.0, 370.0, 100.0, 245.0, 376.0, 339.0, -754.0, 200.0, -211.0, -838.0, 358.0, 232.0, 400.0, -172.0, 298.0, 369.0, 83.0, -156.0, 143.0, 166.0, 346.0, 400.0, 400.0, 316.0, 400.0, 370.0, 394.0, 344.0, 382.0, 262.0, -169.0, 304.0, 400.0, 280.0, 196.0, 364.0, -81.0, 354.0, 274.0, 148.0, -375.0, 340.0, 18.0, 346.0, 340.0, 364.0, 328.0, 124.0, 364.0, 292.0, 201.0, 390.0, 313.0, 299.0, 40.0, 400.0, 316.0, 400.0, 154.0, 288.0, 113.0, -284.0, 334.0, 400.0, 256.0, 280.0, 322.0, 310.0, 226.0, 160.0, 329.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 200.0, 156.0, 200.0, -845.0, 167.0, 145.0, 200.0, 35.0, 2.0, 200.0, -504.0, 101.0, -504.0, 200.0, 57.0, -427.0, -163.0, -75.0, -339.0, 145.0, 200.0, -361.0, -306.0, 189.0, -504.0, 189.0, 200.0, 101.0, -603.0, -416.0, -339.0, -152.0, -460.0, 123.0, 167.0, -438.0, 178.0, 167.0, -394.0, 200.0, -460.0, 167.0, -174.0, 178.0, 90.0, 35.0, 200.0, -284.0, -108.0, -251.0, -31.0, -878.0, 200.0, 178.0, 79.0, -97.0, 200.0, 200.0, 200.0, 145.0, -207.0, 57.0, -130.0, 200.0, 156.0, 200.0, 79.0, 200.0, -669.0, -515.0, -295.0, 200.0, -394.0, -97.0, -889.0, -724.0, 200.0, 123.0, -64.0, 156.0, 200.0, 200.0, -229.0, -438.0, 13.0, 200.0, 200.0, 134.0, -526.0, 189.0, -284.0, -207.0, -75.0, 68.0, -97.0, 68.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 57.0, 189.0, 200.0, 200.0, 145.0, 200.0, 189.0, 200.0, 200.0, 24.0, 167.0, 200.0, -53.0, 200.0, -218.0, -196.0, 178.0, 46.0, 200.0, 200.0, -20.0, 200.0, 79.0, 2.0, 200.0, 134.0, 145.0, -581.0, 79.0, 200.0, 200.0, -31.0, 46.0, 2.0, -119.0, -801.0, 200.0, 90.0, 35.0, -317.0, 101.0, 200.0, 200.0, 90.0, 189.0, 145.0, 200.0, 68.0, -306.0, 200.0, 200.0, 134.0, 2.0, 200.0, 200.0, -284.0, 145.0, 200.0, 13.0, 200.0, 123.0, 101.0, 46.0, -306.0, 200.0, 200.0, 200.0, 46.0, 200.0, 200.0, 189.0, -240.0, 167.0, -9.0, -295.0, 178.0, -1032.0, 178.0, 200.0, 79.0, 200.0, 200.0, 123.0, 13.0, 200.0, -20.0, 189.0, 68.0, 200.0, 35.0, 123.0, -42.0, 57.0, -97.0, 200.0, 24.0], "policy_predator_policy_reward": [0.0, 0.0, 5.0, 15.0, 85.0, 430.0, 0.0, 40.0, 75.0, 45.0, 35.0, 75.0, 65.0, 300.0, 45.0, 320.0, 65.0, 285.0, 100.0, 170.0, 85.0, 265.0, 45.0, 255.0, 0.0, 235.0, 45.0, 290.0, 0.0, 45.0, 375.0, 125.0, 55.0, 300.0, 40.0, 295.0, 160.0, 180.0, 0.0, 15.0, 0.0, 270.0, 310.0, 0.0, 175.0, 0.0, 0.0, 85.0, 0.0, 220.0, 260.0, 85.0, 550.0, 105.0, 10.0, 0.0, 60.0, 130.0, 0.0, 0.0, 0.0, 25.0, 185.0, 65.0, 45.0, 130.0, 20.0, 0.0, 20.0, 40.0, 430.0, 0.0, 160.0, 135.0, 280.0, 0.0, 150.0, 625.0, 0.0, 35.0, 120.0, 20.0, 0.0, 0.0, 315.0, 180.0, 40.0, 45.0, 15.0, 20.0, 155.0, 265.0, 255.0, 80.0, 130.0, 20.0, 135.0, 60.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 65.0, 0.0, 0.0, 0.0, 25.0, 0.0, 5.0, 80.0, 40.0, 0.0, 15.0, 0.0, 115.0, 245.0, 0.0, 70.0, 10.0, 0.0, 0.0, 100.0, 0.0, 110.0, 5.0, 30.0, 0.0, 60.0, 295.0, 40.0, 35.0, 105.0, 0.0, 75.0, 25.0, 0.0, 545.0, 0.0, 50.0, 235.0, 65.0, 45.0, 0.0, 0.0, 50.0, 0.0, 30.0, 60.0, 0.0, 0.0, 230.0, 30.0, 0.0, 0.0, 90.0, 65.0, 220.0, 20.0, 25.0, 85.0, 15.0, 50.0, 25.0, 230.0, 70.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 5.0, 200.0, 75.0, 55.0, 230.0, 0.0, 10.0, 560.0, 0.0, 55.0, 0.0, 0.0, 85.0, 35.0, 95.0, 5.0, 5.0, 60.0, 0.0, 75.0, 110.0, 35.0, 40.0, 160.0, 40.0, 65.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7172128010410505, "mean_inference_ms": 1.7246046108497735, "mean_action_processing_ms": 0.28318612905538776, "mean_env_wait_ms": 0.20208837537300084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0075495243072509766, "StateBufferConnector_ms": 0.0036287307739257812, "ViewRequirementAgentConnector_ms": 0.12788605690002441}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -838.0, "episode_return_mean": 181.81, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.92284522108379, "num_env_steps_trained_throughput_per_sec": 78.92284522108379, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 50060.768, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50060.682, "sample_time_ms": 1318.067, "learn_time_ms": 48724.631, "learn_throughput": 82.094, "synch_weights_time_ms": 14.897}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "ed30a_00000", "date": "2024-08-12_15-01-16", "timestamp": 1723489276, "time_this_iter_s": 50.7150456905365, "time_total_s": 2700.8157212734222, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0120430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2700.8157212734222, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 36.16944444444445, "ram_util_percent": 82.84861111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4869342313872442, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5968037899209078, "policy_loss": -0.005105827777602133, "vf_loss": 0.6014614869756674, "vf_explained_var": 0.0013942700529855395, "kl": 0.005975085161485068, "entropy": 0.9394852917976481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.542863272012226, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7531965328175969, "policy_loss": -0.009024892181709961, "vf_loss": 0.7617818102477089, "vf_explained_var": 0.02351177142410682, "kl": 0.005861548986526239, "entropy": 1.299995905129367, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -838.0, "episode_reward_mean": 215.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1032.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 625.0}, "policy_reward_mean": {"prey_policy": 36.87, "predator_policy": 71.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0, 360.0, 76.0, 17.0, 179.0, 210.0, 136.0, -14.0, -254.0, 388.0, 172.0, 400.0, 370.0, 100.0, 245.0, 376.0, 339.0, -754.0, 200.0, -211.0, -838.0, 358.0, 232.0, 400.0, -172.0, 298.0, 369.0, 83.0, -156.0, 143.0, 166.0, 346.0, 400.0, 400.0, 316.0, 400.0, 370.0, 394.0, 344.0, 382.0, 262.0, -169.0, 304.0, 400.0, 280.0, 196.0, 364.0, -81.0, 354.0, 274.0, 148.0, -375.0, 340.0, 18.0, 346.0, 340.0, 364.0, 328.0, 124.0, 364.0, 292.0, 201.0, 390.0, 313.0, 299.0, 40.0, 400.0, 316.0, 400.0, 154.0, 288.0, 113.0, -284.0, 334.0, 400.0, 256.0, 280.0, 322.0, 310.0, 226.0, 160.0, 329.0, -180.0, 346.0, 244.0, 352.0, 282.0, 352.0, 324.0, 112.0, 267.0, 400.0, 346.0, 303.0, 400.0, 184.0, 388.0, 400.0, 295.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, -438.0, 178.0, 167.0, -394.0, 200.0, -460.0, 167.0, -174.0, 178.0, 90.0, 35.0, 200.0, -284.0, -108.0, -251.0, -31.0, -878.0, 200.0, 178.0, 79.0, -97.0, 200.0, 200.0, 200.0, 145.0, -207.0, 57.0, -130.0, 200.0, 156.0, 200.0, 79.0, 200.0, -669.0, -515.0, -295.0, 200.0, -394.0, -97.0, -889.0, -724.0, 200.0, 123.0, -64.0, 156.0, 200.0, 200.0, -229.0, -438.0, 13.0, 200.0, 200.0, 134.0, -526.0, 189.0, -284.0, -207.0, -75.0, 68.0, -97.0, 68.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 57.0, 189.0, 200.0, 200.0, 145.0, 200.0, 189.0, 200.0, 200.0, 24.0, 167.0, 200.0, -53.0, 200.0, -218.0, -196.0, 178.0, 46.0, 200.0, 200.0, -20.0, 200.0, 79.0, 2.0, 200.0, 134.0, 145.0, -581.0, 79.0, 200.0, 200.0, -31.0, 46.0, 2.0, -119.0, -801.0, 200.0, 90.0, 35.0, -317.0, 101.0, 200.0, 200.0, 90.0, 189.0, 145.0, 200.0, 68.0, -306.0, 200.0, 200.0, 134.0, 2.0, 200.0, 200.0, -284.0, 145.0, 200.0, 13.0, 200.0, 123.0, 101.0, 46.0, -306.0, 200.0, 200.0, 200.0, 46.0, 200.0, 200.0, 189.0, -240.0, 167.0, -9.0, -295.0, 178.0, -1032.0, 178.0, 200.0, 79.0, 200.0, 200.0, 123.0, 13.0, 200.0, -20.0, 189.0, 68.0, 200.0, 35.0, 123.0, -42.0, 57.0, -97.0, 200.0, 24.0, -130.0, -295.0, 200.0, 101.0, -86.0, 200.0, 112.0, 200.0, 200.0, -108.0, 200.0, 57.0, 145.0, 134.0, 189.0, -317.0, 79.0, 123.0, 200.0, 200.0, 101.0, 200.0, 145.0, 123.0, 200.0, 200.0, 2.0, 2.0, 189.0, 189.0, 200.0, 200.0, 123.0, 57.0, 200.0, 200.0], "policy_predator_policy_reward": [160.0, 180.0, 0.0, 15.0, 0.0, 270.0, 310.0, 0.0, 175.0, 0.0, 0.0, 85.0, 0.0, 220.0, 260.0, 85.0, 550.0, 105.0, 10.0, 0.0, 60.0, 130.0, 0.0, 0.0, 0.0, 25.0, 185.0, 65.0, 45.0, 130.0, 20.0, 0.0, 20.0, 40.0, 430.0, 0.0, 160.0, 135.0, 280.0, 0.0, 150.0, 625.0, 0.0, 35.0, 120.0, 20.0, 0.0, 0.0, 315.0, 180.0, 40.0, 45.0, 15.0, 20.0, 155.0, 265.0, 255.0, 80.0, 130.0, 20.0, 135.0, 60.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 65.0, 0.0, 0.0, 0.0, 25.0, 0.0, 5.0, 80.0, 40.0, 0.0, 15.0, 0.0, 115.0, 245.0, 0.0, 70.0, 10.0, 0.0, 0.0, 100.0, 0.0, 110.0, 5.0, 30.0, 0.0, 60.0, 295.0, 40.0, 35.0, 105.0, 0.0, 75.0, 25.0, 0.0, 545.0, 0.0, 50.0, 235.0, 65.0, 45.0, 0.0, 0.0, 50.0, 0.0, 30.0, 60.0, 0.0, 0.0, 230.0, 30.0, 0.0, 0.0, 90.0, 65.0, 220.0, 20.0, 25.0, 85.0, 15.0, 50.0, 25.0, 230.0, 70.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 5.0, 200.0, 75.0, 55.0, 230.0, 0.0, 10.0, 560.0, 0.0, 55.0, 0.0, 0.0, 85.0, 35.0, 95.0, 5.0, 5.0, 60.0, 0.0, 75.0, 110.0, 35.0, 40.0, 160.0, 40.0, 65.0, 0.0, 245.0, 0.0, 45.0, 10.0, 120.0, 0.0, 40.0, 140.0, 50.0, 45.0, 50.0, 30.0, 15.0, 5.0, 235.0, 0.0, 65.0, 0.0, 0.0, 30.0, 15.0, 35.0, 0.0, 0.0, 0.0, 180.0, 0.0, 10.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7180134449108857, "mean_inference_ms": 1.7240802422605277, "mean_action_processing_ms": 0.2833930515529097, "mean_env_wait_ms": 0.2019398352805966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007088303565979004, "StateBufferConnector_ms": 0.0036612749099731445, "ViewRequirementAgentConnector_ms": 0.1278623342514038}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -838.0, "episode_return_mean": 215.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.6082003318755, "num_env_steps_trained_throughput_per_sec": 80.6082003318755, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 49852.621, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49852.556, "sample_time_ms": 1333.066, "learn_time_ms": 48501.791, "learn_throughput": 82.471, "synch_weights_time_ms": 14.772}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "ed30a_00000", "date": "2024-08-12_15-02-06", "timestamp": 1723489326, "time_this_iter_s": 49.6605920791626, "time_total_s": 2750.476313352585, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2750.476313352585, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 35.151428571428575, "ram_util_percent": 82.9857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6602456275432829, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.50948439506942, "policy_loss": -0.008074756650618775, "vf_loss": 0.5169017333595239, "vf_explained_var": 0.0019674435179069557, "kl": 0.008765558335505732, "entropy": 1.0228513066100064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.264652776497382, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5483706880262597, "policy_loss": -0.013650400487203446, "vf_loss": 0.5614311200728894, "vf_explained_var": 0.04355175987122551, "kl": 0.007866225721816233, "entropy": 1.2839452626213195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -375.0, "episode_reward_mean": 261.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1032.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 560.0}, "policy_reward_mean": {"prey_policy": 76.91, "predator_policy": 53.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [232.0, 400.0, -172.0, 298.0, 369.0, 83.0, -156.0, 143.0, 166.0, 346.0, 400.0, 400.0, 316.0, 400.0, 370.0, 394.0, 344.0, 382.0, 262.0, -169.0, 304.0, 400.0, 280.0, 196.0, 364.0, -81.0, 354.0, 274.0, 148.0, -375.0, 340.0, 18.0, 346.0, 340.0, 364.0, 328.0, 124.0, 364.0, 292.0, 201.0, 390.0, 313.0, 299.0, 40.0, 400.0, 316.0, 400.0, 154.0, 288.0, 113.0, -284.0, 334.0, 400.0, 256.0, 280.0, 322.0, 310.0, 226.0, 160.0, 329.0, -180.0, 346.0, 244.0, 352.0, 282.0, 352.0, 324.0, 112.0, 267.0, 400.0, 346.0, 303.0, 400.0, 184.0, 388.0, 400.0, 295.0, 400.0, 400.0, 370.0, 256.0, 351.0, 400.0, 220.0, 400.0, 210.0, 376.0, 328.0, 265.0, 296.0, -30.0, 400.0, 122.0, 400.0, 268.0, 67.0, 400.0, 326.0, 376.0, 291.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-64.0, 156.0, 200.0, 200.0, -229.0, -438.0, 13.0, 200.0, 200.0, 134.0, -526.0, 189.0, -284.0, -207.0, -75.0, 68.0, -97.0, 68.0, 101.0, 200.0, 200.0, 200.0, 200.0, 200.0, 57.0, 189.0, 200.0, 200.0, 145.0, 200.0, 189.0, 200.0, 200.0, 24.0, 167.0, 200.0, -53.0, 200.0, -218.0, -196.0, 178.0, 46.0, 200.0, 200.0, -20.0, 200.0, 79.0, 2.0, 200.0, 134.0, 145.0, -581.0, 79.0, 200.0, 200.0, -31.0, 46.0, 2.0, -119.0, -801.0, 200.0, 90.0, 35.0, -317.0, 101.0, 200.0, 200.0, 90.0, 189.0, 145.0, 200.0, 68.0, -306.0, 200.0, 200.0, 134.0, 2.0, 200.0, 200.0, -284.0, 145.0, 200.0, 13.0, 200.0, 123.0, 101.0, 46.0, -306.0, 200.0, 200.0, 200.0, 46.0, 200.0, 200.0, 189.0, -240.0, 167.0, -9.0, -295.0, 178.0, -1032.0, 178.0, 200.0, 79.0, 200.0, 200.0, 123.0, 13.0, 200.0, -20.0, 189.0, 68.0, 200.0, 35.0, 123.0, -42.0, 57.0, -97.0, 200.0, 24.0, -130.0, -295.0, 200.0, 101.0, -86.0, 200.0, 112.0, 200.0, 200.0, -108.0, 200.0, 57.0, 145.0, 134.0, 189.0, -317.0, 79.0, 123.0, 200.0, 200.0, 101.0, 200.0, 145.0, 123.0, 200.0, 200.0, 2.0, 2.0, 189.0, 189.0, 200.0, 200.0, 123.0, 57.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 112.0, 79.0, 200.0, 101.0, 200.0, 200.0, -86.0, 156.0, 200.0, 200.0, 145.0, -75.0, 156.0, 200.0, 90.0, 178.0, 90.0, 90.0, 90.0, 156.0, -273.0, -42.0, 200.0, 200.0, -53.0, -20.0, 200.0, 200.0, 90.0, 123.0, -42.0, -31.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 178.0, 13.0], "policy_predator_policy_reward": [120.0, 20.0, 0.0, 0.0, 315.0, 180.0, 40.0, 45.0, 15.0, 20.0, 155.0, 265.0, 255.0, 80.0, 130.0, 20.0, 135.0, 60.0, 45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 65.0, 0.0, 0.0, 0.0, 25.0, 0.0, 5.0, 80.0, 40.0, 0.0, 15.0, 0.0, 115.0, 245.0, 0.0, 70.0, 10.0, 0.0, 0.0, 100.0, 0.0, 110.0, 5.0, 30.0, 0.0, 60.0, 295.0, 40.0, 35.0, 105.0, 0.0, 75.0, 25.0, 0.0, 545.0, 0.0, 50.0, 235.0, 65.0, 45.0, 0.0, 0.0, 50.0, 0.0, 30.0, 60.0, 0.0, 0.0, 230.0, 30.0, 0.0, 0.0, 90.0, 65.0, 220.0, 20.0, 25.0, 85.0, 15.0, 50.0, 25.0, 230.0, 70.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 5.0, 200.0, 75.0, 55.0, 230.0, 0.0, 10.0, 560.0, 0.0, 55.0, 0.0, 0.0, 85.0, 35.0, 95.0, 5.0, 5.0, 60.0, 0.0, 75.0, 110.0, 35.0, 40.0, 160.0, 40.0, 65.0, 0.0, 245.0, 0.0, 45.0, 10.0, 120.0, 0.0, 40.0, 140.0, 50.0, 45.0, 50.0, 30.0, 15.0, 5.0, 235.0, 0.0, 65.0, 0.0, 0.0, 30.0, 15.0, 35.0, 0.0, 0.0, 0.0, 180.0, 0.0, 10.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 20.0, 45.0, 15.0, 35.0, 0.0, 0.0, 100.0, 50.0, 0.0, 0.0, 25.0, 115.0, 0.0, 20.0, 30.0, 30.0, 0.0, 85.0, 0.0, 50.0, 285.0, 0.0, 0.0, 0.0, 140.0, 55.0, 0.0, 0.0, 55.0, 0.0, 0.0, 140.0, 0.0, 0.0, 30.0, 50.0, 0.0, 20.0, 95.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7168192809812356, "mean_inference_ms": 1.7185901073115837, "mean_action_processing_ms": 0.2828250224599237, "mean_env_wait_ms": 0.20137407978095645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055266618728637695, "StateBufferConnector_ms": 0.004039645195007324, "ViewRequirementAgentConnector_ms": 0.11782264709472656}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -375.0, "episode_return_mean": 261.42, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.70345492011488, "num_env_steps_trained_throughput_per_sec": 80.70345492011488, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 49808.684, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49808.62, "sample_time_ms": 1337.688, "learn_time_ms": 48454.149, "learn_throughput": 82.552, "synch_weights_time_ms": 13.887}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "ed30a_00000", "date": "2024-08-12_15-02-55", "timestamp": 1723489375, "time_this_iter_s": 49.6096031665802, "time_total_s": 2800.085916519165, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b013d0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2800.085916519165, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 33.47142857142857, "ram_util_percent": 82.93142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5252691934821467, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4281747273982517, "policy_loss": -0.006870022412542274, "vf_loss": 1.434560128526082, "vf_explained_var": 0.002675030124250543, "kl": 0.006461527467963702, "entropy": 0.9534303560458793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.4829603816466355, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0256676223227585, "policy_loss": -0.015828057419676234, "vf_loss": 2.040562298688939, "vf_explained_var": 0.020342747843454755, "kl": 0.012444988164219213, "entropy": 1.2416882605149002, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2587.0, "episode_reward_mean": 203.76, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": 38.63, "predator_policy": 63.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [196.0, 364.0, -81.0, 354.0, 274.0, 148.0, -375.0, 340.0, 18.0, 346.0, 340.0, 364.0, 328.0, 124.0, 364.0, 292.0, 201.0, 390.0, 313.0, 299.0, 40.0, 400.0, 316.0, 400.0, 154.0, 288.0, 113.0, -284.0, 334.0, 400.0, 256.0, 280.0, 322.0, 310.0, 226.0, 160.0, 329.0, -180.0, 346.0, 244.0, 352.0, 282.0, 352.0, 324.0, 112.0, 267.0, 400.0, 346.0, 303.0, 400.0, 184.0, 388.0, 400.0, 295.0, 400.0, 400.0, 370.0, 256.0, 351.0, 400.0, 220.0, 400.0, 210.0, 376.0, 328.0, 265.0, 296.0, -30.0, 400.0, 122.0, 400.0, 268.0, 67.0, 400.0, 326.0, 376.0, 291.0, -2587.0, 298.0, 334.0, 275.0, -1733.0, 238.0, 400.0, 88.0, 400.0, 356.0, -819.0, 328.0, 388.0, 358.0, 120.0, 259.0, -611.0, 364.0, 354.0, 196.0, 400.0, 286.0, 334.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 2.0, 200.0, 134.0, 145.0, -581.0, 79.0, 200.0, 200.0, -31.0, 46.0, 2.0, -119.0, -801.0, 200.0, 90.0, 35.0, -317.0, 101.0, 200.0, 200.0, 90.0, 189.0, 145.0, 200.0, 68.0, -306.0, 200.0, 200.0, 134.0, 2.0, 200.0, 200.0, -284.0, 145.0, 200.0, 13.0, 200.0, 123.0, 101.0, 46.0, -306.0, 200.0, 200.0, 200.0, 46.0, 200.0, 200.0, 189.0, -240.0, 167.0, -9.0, -295.0, 178.0, -1032.0, 178.0, 200.0, 79.0, 200.0, 200.0, 123.0, 13.0, 200.0, -20.0, 189.0, 68.0, 200.0, 35.0, 123.0, -42.0, 57.0, -97.0, 200.0, 24.0, -130.0, -295.0, 200.0, 101.0, -86.0, 200.0, 112.0, 200.0, 200.0, -108.0, 200.0, 57.0, 145.0, 134.0, 189.0, -317.0, 79.0, 123.0, 200.0, 200.0, 101.0, 200.0, 145.0, 123.0, 200.0, 200.0, 2.0, 2.0, 189.0, 189.0, 200.0, 200.0, 123.0, 57.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 112.0, 79.0, 200.0, 101.0, 200.0, 200.0, -86.0, 156.0, 200.0, 200.0, 145.0, -75.0, 156.0, 200.0, 90.0, 178.0, 90.0, 90.0, 90.0, 156.0, -273.0, -42.0, 200.0, 200.0, -53.0, -20.0, 200.0, 200.0, 90.0, 123.0, -42.0, -31.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 178.0, 13.0, -1615.0, -1967.0, 200.0, 13.0, 200.0, 79.0, 123.0, 112.0, -1505.0, -1043.0, -75.0, 178.0, 200.0, 200.0, 200.0, -372.0, 200.0, 200.0, -9.0, 200.0, -922.0, -592.0, 200.0, 68.0, 200.0, 178.0, 123.0, 200.0, 13.0, 2.0, -218.0, 167.0, -460.0, -471.0, 134.0, 200.0, 200.0, 24.0, -174.0, 200.0, 200.0, 200.0, 145.0, 46.0, 200.0, 79.0], "policy_predator_policy_reward": [110.0, 5.0, 30.0, 0.0, 60.0, 295.0, 40.0, 35.0, 105.0, 0.0, 75.0, 25.0, 0.0, 545.0, 0.0, 50.0, 235.0, 65.0, 45.0, 0.0, 0.0, 50.0, 0.0, 30.0, 60.0, 0.0, 0.0, 230.0, 30.0, 0.0, 0.0, 90.0, 65.0, 220.0, 20.0, 25.0, 85.0, 15.0, 50.0, 25.0, 230.0, 70.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 5.0, 200.0, 75.0, 55.0, 230.0, 0.0, 10.0, 560.0, 0.0, 55.0, 0.0, 0.0, 85.0, 35.0, 95.0, 5.0, 5.0, 60.0, 0.0, 75.0, 110.0, 35.0, 40.0, 160.0, 40.0, 65.0, 0.0, 245.0, 0.0, 45.0, 10.0, 120.0, 0.0, 40.0, 140.0, 50.0, 45.0, 50.0, 30.0, 15.0, 5.0, 235.0, 0.0, 65.0, 0.0, 0.0, 30.0, 15.0, 35.0, 0.0, 0.0, 0.0, 180.0, 0.0, 10.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 20.0, 45.0, 15.0, 35.0, 0.0, 0.0, 100.0, 50.0, 0.0, 0.0, 25.0, 115.0, 0.0, 20.0, 30.0, 30.0, 0.0, 85.0, 0.0, 50.0, 285.0, 0.0, 0.0, 0.0, 140.0, 55.0, 0.0, 0.0, 55.0, 0.0, 0.0, 140.0, 0.0, 0.0, 30.0, 50.0, 0.0, 20.0, 95.0, 5.0, 10.0, 985.0, 0.0, 85.0, 0.0, 55.0, 40.0, 0.0, 770.0, 45.0, 135.0, 0.0, 0.0, 0.0, 0.0, 260.0, 0.0, 0.0, 80.0, 85.0, 665.0, 30.0, 0.0, 60.0, 10.0, 0.0, 0.0, 35.0, 15.0, 90.0, 180.0, 130.0, 320.0, 0.0, 0.0, 30.0, 80.0, 50.0, 170.0, 0.0, 0.0, 0.0, 0.0, 95.0, 10.0, 45.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7154556135453575, "mean_inference_ms": 1.7132471540214471, "mean_action_processing_ms": 0.2822000178178449, "mean_env_wait_ms": 0.20084269853289843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037364959716796875, "StateBufferConnector_ms": 0.003935694694519043, "ViewRequirementAgentConnector_ms": 0.11068475246429443}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2587.0, "episode_return_mean": 203.76, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.83521729759168, "num_env_steps_trained_throughput_per_sec": 77.83521729759168, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 50027.381, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50027.323, "sample_time_ms": 1331.279, "learn_time_ms": 48680.057, "learn_throughput": 82.169, "synch_weights_time_ms": 12.875}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "ed30a_00000", "date": "2024-08-12_15-03-47", "timestamp": 1723489427, "time_this_iter_s": 51.43935513496399, "time_total_s": 2851.525271654129, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00c7b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2851.525271654129, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 38.087671232876716, "ram_util_percent": 82.54109589041096}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.280911059196664, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6948146741541605, "policy_loss": -0.0072060938382511415, "vf_loss": 1.7015300548423535, "vf_explained_var": 0.0008512882643906528, "kl": 0.006542764167072523, "entropy": 0.9186389495771398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.123004743535683, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1225227028919904, "policy_loss": -0.011600177920215256, "vf_loss": 2.133567032990632, "vf_explained_var": 0.018931335400021267, "kl": 0.0074112188254295015, "entropy": 1.2751821430902632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2587.0, "episode_reward_mean": 185.6, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 985.0}, "policy_reward_mean": {"prey_policy": 22.9, "predator_policy": 69.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [313.0, 299.0, 40.0, 400.0, 316.0, 400.0, 154.0, 288.0, 113.0, -284.0, 334.0, 400.0, 256.0, 280.0, 322.0, 310.0, 226.0, 160.0, 329.0, -180.0, 346.0, 244.0, 352.0, 282.0, 352.0, 324.0, 112.0, 267.0, 400.0, 346.0, 303.0, 400.0, 184.0, 388.0, 400.0, 295.0, 400.0, 400.0, 370.0, 256.0, 351.0, 400.0, 220.0, 400.0, 210.0, 376.0, 328.0, 265.0, 296.0, -30.0, 400.0, 122.0, 400.0, 268.0, 67.0, 400.0, 326.0, 376.0, 291.0, -2587.0, 298.0, 334.0, 275.0, -1733.0, 238.0, 400.0, 88.0, 400.0, 356.0, -819.0, 328.0, 388.0, 358.0, 120.0, 259.0, -611.0, 364.0, 354.0, 196.0, 400.0, 286.0, 334.0, 310.0, 316.0, 214.0, 208.0, 400.0, 106.0, 400.0, 388.0, 400.0, -913.0, 286.0, 370.0, 256.0, 400.0, -1650.0, 345.0, 70.0, 265.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [13.0, 200.0, 123.0, 101.0, 46.0, -306.0, 200.0, 200.0, 200.0, 46.0, 200.0, 200.0, 189.0, -240.0, 167.0, -9.0, -295.0, 178.0, -1032.0, 178.0, 200.0, 79.0, 200.0, 200.0, 123.0, 13.0, 200.0, -20.0, 189.0, 68.0, 200.0, 35.0, 123.0, -42.0, 57.0, -97.0, 200.0, 24.0, -130.0, -295.0, 200.0, 101.0, -86.0, 200.0, 112.0, 200.0, 200.0, -108.0, 200.0, 57.0, 145.0, 134.0, 189.0, -317.0, 79.0, 123.0, 200.0, 200.0, 101.0, 200.0, 145.0, 123.0, 200.0, 200.0, 2.0, 2.0, 189.0, 189.0, 200.0, 200.0, 123.0, 57.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 112.0, 79.0, 200.0, 101.0, 200.0, 200.0, -86.0, 156.0, 200.0, 200.0, 145.0, -75.0, 156.0, 200.0, 90.0, 178.0, 90.0, 90.0, 90.0, 156.0, -273.0, -42.0, 200.0, 200.0, -53.0, -20.0, 200.0, 200.0, 90.0, 123.0, -42.0, -31.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 178.0, 13.0, -1615.0, -1967.0, 200.0, 13.0, 200.0, 79.0, 123.0, 112.0, -1505.0, -1043.0, -75.0, 178.0, 200.0, 200.0, 200.0, -372.0, 200.0, 200.0, -9.0, 200.0, -922.0, -592.0, 200.0, 68.0, 200.0, 178.0, 123.0, 200.0, 13.0, 2.0, -218.0, 167.0, -460.0, -471.0, 134.0, 200.0, 200.0, 24.0, -174.0, 200.0, 200.0, 200.0, 145.0, 46.0, 200.0, 79.0, 112.0, 123.0, 200.0, 46.0, -141.0, 200.0, -86.0, 134.0, 200.0, 200.0, 46.0, -185.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, -812.0, -856.0, -9.0, 200.0, 200.0, 145.0, 123.0, 13.0, 200.0, 200.0, -1626.0, -1714.0, 90.0, 200.0, -295.0, 90.0, 79.0, 46.0], "policy_predator_policy_reward": [85.0, 15.0, 50.0, 25.0, 230.0, 70.0, 0.0, 0.0, 70.0, 0.0, 0.0, 0.0, 5.0, 200.0, 75.0, 55.0, 230.0, 0.0, 10.0, 560.0, 0.0, 55.0, 0.0, 0.0, 85.0, 35.0, 95.0, 5.0, 5.0, 60.0, 0.0, 75.0, 110.0, 35.0, 40.0, 160.0, 40.0, 65.0, 0.0, 245.0, 0.0, 45.0, 10.0, 120.0, 0.0, 40.0, 140.0, 50.0, 45.0, 50.0, 30.0, 15.0, 5.0, 235.0, 0.0, 65.0, 0.0, 0.0, 30.0, 15.0, 35.0, 0.0, 0.0, 0.0, 180.0, 0.0, 10.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 20.0, 45.0, 15.0, 35.0, 0.0, 0.0, 100.0, 50.0, 0.0, 0.0, 25.0, 115.0, 0.0, 20.0, 30.0, 30.0, 0.0, 85.0, 0.0, 50.0, 285.0, 0.0, 0.0, 0.0, 140.0, 55.0, 0.0, 0.0, 55.0, 0.0, 0.0, 140.0, 0.0, 0.0, 30.0, 50.0, 0.0, 20.0, 95.0, 5.0, 10.0, 985.0, 0.0, 85.0, 0.0, 55.0, 40.0, 0.0, 770.0, 45.0, 135.0, 0.0, 0.0, 0.0, 0.0, 260.0, 0.0, 0.0, 80.0, 85.0, 665.0, 30.0, 0.0, 60.0, 10.0, 0.0, 0.0, 35.0, 15.0, 90.0, 180.0, 130.0, 320.0, 0.0, 0.0, 30.0, 80.0, 50.0, 170.0, 0.0, 0.0, 0.0, 0.0, 95.0, 10.0, 45.0, 25.0, 50.0, 60.0, 10.0, 5.0, 150.0, 130.0, 30.0, 0.0, 0.0, 175.0, 70.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 755.0, 0.0, 95.0, 0.0, 20.0, 5.0, 85.0, 35.0, 0.0, 0.0, 830.0, 860.0, 25.0, 30.0, 50.0, 225.0, 85.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7143166653026587, "mean_inference_ms": 1.7091106814506951, "mean_action_processing_ms": 0.2816971730334099, "mean_env_wait_ms": 0.20040979695712924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037685632705688477, "StateBufferConnector_ms": 0.003507256507873535, "ViewRequirementAgentConnector_ms": 0.10945487022399902}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2587.0, "episode_return_mean": 185.6, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.45579488865549, "num_env_steps_trained_throughput_per_sec": 80.45579488865549, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 49975.996, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49975.938, "sample_time_ms": 1331.03, "learn_time_ms": 48628.498, "learn_throughput": 82.256, "synch_weights_time_ms": 13.112}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "ed30a_00000", "date": "2024-08-12_15-04-36", "timestamp": 1723489476, "time_this_iter_s": 49.755903005599976, "time_total_s": 2901.281174659729, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2901.281174659729, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 34.72857142857143, "ram_util_percent": 82.6257142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2458874661219184, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5205675370794125, "policy_loss": -0.0062092037754448715, "vf_loss": 1.5261213619242269, "vf_explained_var": -8.337049887924597e-05, "kl": 0.008738356661297006, "entropy": 0.8436412273891388, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.013883295923314, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9694394429840107, "policy_loss": -0.01883963472234509, "vf_loss": 1.9873270681926183, "vf_explained_var": 0.022742718521249358, "kl": 0.012693479327365394, "entropy": 1.261535929750513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2587.0, "episode_reward_mean": 149.51, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -2.895, "predator_policy": 77.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.0, -180.0, 346.0, 244.0, 352.0, 282.0, 352.0, 324.0, 112.0, 267.0, 400.0, 346.0, 303.0, 400.0, 184.0, 388.0, 400.0, 295.0, 400.0, 400.0, 370.0, 256.0, 351.0, 400.0, 220.0, 400.0, 210.0, 376.0, 328.0, 265.0, 296.0, -30.0, 400.0, 122.0, 400.0, 268.0, 67.0, 400.0, 326.0, 376.0, 291.0, -2587.0, 298.0, 334.0, 275.0, -1733.0, 238.0, 400.0, 88.0, 400.0, 356.0, -819.0, 328.0, 388.0, 358.0, 120.0, 259.0, -611.0, 364.0, 354.0, 196.0, 400.0, 286.0, 334.0, 310.0, 316.0, 214.0, 208.0, 400.0, 106.0, 400.0, 388.0, 400.0, -913.0, 286.0, 370.0, 256.0, 400.0, -1650.0, 345.0, 70.0, 265.0, 364.0, 322.0, 400.0, 376.0, -224.0, -470.0, -1240.0, -1439.0, 202.0, 238.0, 190.0, -130.0, 328.0, 400.0, 267.0, 400.0, 334.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 24.0, -130.0, -295.0, 200.0, 101.0, -86.0, 200.0, 112.0, 200.0, 200.0, -108.0, 200.0, 57.0, 145.0, 134.0, 189.0, -317.0, 79.0, 123.0, 200.0, 200.0, 101.0, 200.0, 145.0, 123.0, 200.0, 200.0, 2.0, 2.0, 189.0, 189.0, 200.0, 200.0, 123.0, 57.0, 200.0, 200.0, 200.0, 200.0, 145.0, 200.0, 112.0, 79.0, 200.0, 101.0, 200.0, 200.0, -86.0, 156.0, 200.0, 200.0, 145.0, -75.0, 156.0, 200.0, 90.0, 178.0, 90.0, 90.0, 90.0, 156.0, -273.0, -42.0, 200.0, 200.0, -53.0, -20.0, 200.0, 200.0, 90.0, 123.0, -42.0, -31.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 178.0, 13.0, -1615.0, -1967.0, 200.0, 13.0, 200.0, 79.0, 123.0, 112.0, -1505.0, -1043.0, -75.0, 178.0, 200.0, 200.0, 200.0, -372.0, 200.0, 200.0, -9.0, 200.0, -922.0, -592.0, 200.0, 68.0, 200.0, 178.0, 123.0, 200.0, 13.0, 2.0, -218.0, 167.0, -460.0, -471.0, 134.0, 200.0, 200.0, 24.0, -174.0, 200.0, 200.0, 200.0, 145.0, 46.0, 200.0, 79.0, 112.0, 123.0, 200.0, 46.0, -141.0, 200.0, -86.0, 134.0, 200.0, 200.0, 46.0, -185.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, -812.0, -856.0, -9.0, 200.0, 200.0, 145.0, 123.0, 13.0, 200.0, 200.0, -1626.0, -1714.0, 90.0, 200.0, -295.0, 90.0, 79.0, 46.0, 200.0, 134.0, 178.0, 79.0, 200.0, 200.0, 156.0, 200.0, -779.0, 35.0, 189.0, -1384.0, -1098.0, -1142.0, -977.0, -1142.0, 200.0, -218.0, -97.0, 200.0, -97.0, 112.0, -328.0, -42.0, 68.0, 200.0, 200.0, 200.0, 57.0, 145.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0], "policy_predator_policy_reward": [40.0, 65.0, 0.0, 245.0, 0.0, 45.0, 10.0, 120.0, 0.0, 40.0, 140.0, 50.0, 45.0, 50.0, 30.0, 15.0, 5.0, 235.0, 0.0, 65.0, 0.0, 0.0, 30.0, 15.0, 35.0, 0.0, 0.0, 0.0, 180.0, 0.0, 10.0, 0.0, 0.0, 0.0, 50.0, 65.0, 0.0, 0.0, 0.0, 0.0, 25.0, 0.0, 20.0, 45.0, 15.0, 35.0, 0.0, 0.0, 100.0, 50.0, 0.0, 0.0, 25.0, 115.0, 0.0, 20.0, 30.0, 30.0, 0.0, 85.0, 0.0, 50.0, 285.0, 0.0, 0.0, 0.0, 140.0, 55.0, 0.0, 0.0, 55.0, 0.0, 0.0, 140.0, 0.0, 0.0, 30.0, 50.0, 0.0, 20.0, 95.0, 5.0, 10.0, 985.0, 0.0, 85.0, 0.0, 55.0, 40.0, 0.0, 770.0, 45.0, 135.0, 0.0, 0.0, 0.0, 0.0, 260.0, 0.0, 0.0, 80.0, 85.0, 665.0, 30.0, 0.0, 60.0, 10.0, 0.0, 0.0, 35.0, 15.0, 90.0, 180.0, 130.0, 320.0, 0.0, 0.0, 30.0, 80.0, 50.0, 170.0, 0.0, 0.0, 0.0, 0.0, 95.0, 10.0, 45.0, 25.0, 50.0, 60.0, 10.0, 5.0, 150.0, 130.0, 30.0, 0.0, 0.0, 175.0, 70.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 755.0, 0.0, 95.0, 0.0, 20.0, 5.0, 85.0, 35.0, 0.0, 0.0, 830.0, 860.0, 25.0, 30.0, 50.0, 225.0, 85.0, 55.0, 0.0, 30.0, 10.0, 55.0, 0.0, 0.0, 0.0, 20.0, 0.0, 520.0, 720.0, 5.0, 1000.0, 0.0, 60.0, 620.0, 30.0, 190.0, 135.0, 0.0, 135.0, 40.0, 0.0, 240.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7142623816923924, "mean_inference_ms": 1.7080812231178113, "mean_action_processing_ms": 0.2816583122807511, "mean_env_wait_ms": 0.2004095961822889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003853321075439453, "StateBufferConnector_ms": 0.003866910934448242, "ViewRequirementAgentConnector_ms": 0.11072909832000732}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2587.0, "episode_return_mean": 149.51, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.11968600918122, "num_env_steps_trained_throughput_per_sec": 80.11968600918122, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 50006.49, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50006.425, "sample_time_ms": 1392.476, "learn_time_ms": 48596.955, "learn_throughput": 82.31, "synch_weights_time_ms": 13.594}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "ed30a_00000", "date": "2024-08-12_15-05-26", "timestamp": 1723489526, "time_this_iter_s": 49.953131914138794, "time_total_s": 2951.234306573868, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a4f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2951.234306573868, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 34.0943661971831, "ram_util_percent": 82.53521126760562}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0857757809300903, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1497734328111013, "policy_loss": -0.0023009478585134264, "vf_loss": 1.1515380389791317, "vf_explained_var": -0.0001328910784746604, "kl": 0.007151255385030685, "entropy": 0.9283410551056029, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.946284956496859, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1263479763632098, "policy_loss": -0.012183993503145835, "vf_loss": 1.1379632386423293, "vf_explained_var": 0.021165640265853318, "kl": 0.0075830968091933045, "entropy": 1.261164260225952, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2587.0, "episode_reward_mean": 129.06, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -22.145, "predator_policy": 86.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 400.0, 220.0, 400.0, 210.0, 376.0, 328.0, 265.0, 296.0, -30.0, 400.0, 122.0, 400.0, 268.0, 67.0, 400.0, 326.0, 376.0, 291.0, -2587.0, 298.0, 334.0, 275.0, -1733.0, 238.0, 400.0, 88.0, 400.0, 356.0, -819.0, 328.0, 388.0, 358.0, 120.0, 259.0, -611.0, 364.0, 354.0, 196.0, 400.0, 286.0, 334.0, 310.0, 316.0, 214.0, 208.0, 400.0, 106.0, 400.0, 388.0, 400.0, -913.0, 286.0, 370.0, 256.0, 400.0, -1650.0, 345.0, 70.0, 265.0, 364.0, 322.0, 400.0, 376.0, -224.0, -470.0, -1240.0, -1439.0, 202.0, 238.0, 190.0, -130.0, 328.0, 400.0, 267.0, 400.0, 334.0, 400.0, -236.0, 394.0, 400.0, -507.0, 322.0, 400.0, 388.0, 368.0, 400.0, 84.0, -44.0, -626.0, 364.0, 322.0, 369.0, 352.0, 160.0, 267.0, 394.0, 346.0, 370.0, 238.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 101.0, 200.0, 200.0, -86.0, 156.0, 200.0, 200.0, 145.0, -75.0, 156.0, 200.0, 90.0, 178.0, 90.0, 90.0, 90.0, 156.0, -273.0, -42.0, 200.0, 200.0, -53.0, -20.0, 200.0, 200.0, 90.0, 123.0, -42.0, -31.0, 200.0, 200.0, 200.0, 46.0, 156.0, 200.0, 178.0, 13.0, -1615.0, -1967.0, 200.0, 13.0, 200.0, 79.0, 123.0, 112.0, -1505.0, -1043.0, -75.0, 178.0, 200.0, 200.0, 200.0, -372.0, 200.0, 200.0, -9.0, 200.0, -922.0, -592.0, 200.0, 68.0, 200.0, 178.0, 123.0, 200.0, 13.0, 2.0, -218.0, 167.0, -460.0, -471.0, 134.0, 200.0, 200.0, 24.0, -174.0, 200.0, 200.0, 200.0, 145.0, 46.0, 200.0, 79.0, 112.0, 123.0, 200.0, 46.0, -141.0, 200.0, -86.0, 134.0, 200.0, 200.0, 46.0, -185.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, -812.0, -856.0, -9.0, 200.0, 200.0, 145.0, 123.0, 13.0, 200.0, 200.0, -1626.0, -1714.0, 90.0, 200.0, -295.0, 90.0, 79.0, 46.0, 200.0, 134.0, 178.0, 79.0, 200.0, 200.0, 156.0, 200.0, -779.0, 35.0, 189.0, -1384.0, -1098.0, -1142.0, -977.0, -1142.0, 200.0, -218.0, -97.0, 200.0, -97.0, 112.0, -328.0, -42.0, 68.0, 200.0, 200.0, 200.0, 57.0, 145.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, -779.0, 13.0, 189.0, 200.0, 200.0, 200.0, -119.0, -878.0, 200.0, 57.0, 200.0, 200.0, 200.0, 178.0, 189.0, 134.0, 200.0, 200.0, -75.0, -31.0, -449.0, 35.0, -1065.0, -526.0, 200.0, 134.0, 156.0, 101.0, 79.0, 200.0, 112.0, 200.0, 189.0, -229.0, 68.0, 134.0, 200.0, 189.0, 101.0, 200.0, 156.0, 189.0, 167.0, -174.0], "policy_predator_policy_reward": [15.0, 35.0, 0.0, 0.0, 100.0, 50.0, 0.0, 0.0, 25.0, 115.0, 0.0, 20.0, 30.0, 30.0, 0.0, 85.0, 0.0, 50.0, 285.0, 0.0, 0.0, 0.0, 140.0, 55.0, 0.0, 0.0, 55.0, 0.0, 0.0, 140.0, 0.0, 0.0, 30.0, 50.0, 0.0, 20.0, 95.0, 5.0, 10.0, 985.0, 0.0, 85.0, 0.0, 55.0, 40.0, 0.0, 770.0, 45.0, 135.0, 0.0, 0.0, 0.0, 0.0, 260.0, 0.0, 0.0, 80.0, 85.0, 665.0, 30.0, 0.0, 60.0, 10.0, 0.0, 0.0, 35.0, 15.0, 90.0, 180.0, 130.0, 320.0, 0.0, 0.0, 30.0, 80.0, 50.0, 170.0, 0.0, 0.0, 0.0, 0.0, 95.0, 10.0, 45.0, 25.0, 50.0, 60.0, 10.0, 5.0, 150.0, 130.0, 30.0, 0.0, 0.0, 175.0, 70.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 755.0, 0.0, 95.0, 0.0, 20.0, 5.0, 85.0, 35.0, 0.0, 0.0, 830.0, 860.0, 25.0, 30.0, 50.0, 225.0, 85.0, 55.0, 0.0, 30.0, 10.0, 55.0, 0.0, 0.0, 0.0, 20.0, 0.0, 520.0, 720.0, 5.0, 1000.0, 0.0, 60.0, 620.0, 30.0, 190.0, 135.0, 0.0, 135.0, 40.0, 0.0, 240.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 495.0, 35.0, 5.0, 0.0, 0.0, 0.0, 490.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 25.0, 0.0, 0.0, 0.0, 190.0, 370.0, 0.0, 100.0, 865.0, 30.0, 0.0, 45.0, 20.0, 35.0, 55.0, 0.0, 40.0, 5.0, 195.0, 0.0, 65.0, 5.0, 0.0, 0.0, 45.0, 20.0, 5.0, 80.0, 165.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.714256911730838, "mean_inference_ms": 1.7064616623701527, "mean_action_processing_ms": 0.2816415548002054, "mean_env_wait_ms": 0.2003284160823793, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003864288330078125, "StateBufferConnector_ms": 0.0035979747772216797, "ViewRequirementAgentConnector_ms": 0.11033272743225098}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2587.0, "episode_return_mean": 129.06, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.53920910648802, "num_env_steps_trained_throughput_per_sec": 81.53920910648802, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 49943.49, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49943.422, "sample_time_ms": 1388.679, "learn_time_ms": 48537.846, "learn_throughput": 82.41, "synch_weights_time_ms": 13.335}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "ed30a_00000", "date": "2024-08-12_15-06-16", "timestamp": 1723489576, "time_this_iter_s": 49.097004890441895, "time_total_s": 3000.3313114643097, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b008d280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3000.3313114643097, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 32.62608695652174, "ram_util_percent": 81.81449275362318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7785107460523408, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1962443616182086, "policy_loss": -0.0038621602801694756, "vf_loss": 1.1995228701009952, "vf_explained_var": 5.777648517063686e-05, "kl": 0.007781971295230385, "entropy": 0.8293489444192755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.395658721826064, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4458906105822986, "policy_loss": -0.016612845862397637, "vf_loss": 1.4620047620364598, "vf_explained_var": 0.02641109827334288, "kl": 0.006649201823843189, "entropy": 1.2315776510844154, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2587.0, "episode_reward_mean": 120.66, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -28.47, "predator_policy": 88.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [291.0, -2587.0, 298.0, 334.0, 275.0, -1733.0, 238.0, 400.0, 88.0, 400.0, 356.0, -819.0, 328.0, 388.0, 358.0, 120.0, 259.0, -611.0, 364.0, 354.0, 196.0, 400.0, 286.0, 334.0, 310.0, 316.0, 214.0, 208.0, 400.0, 106.0, 400.0, 388.0, 400.0, -913.0, 286.0, 370.0, 256.0, 400.0, -1650.0, 345.0, 70.0, 265.0, 364.0, 322.0, 400.0, 376.0, -224.0, -470.0, -1240.0, -1439.0, 202.0, 238.0, 190.0, -130.0, 328.0, 400.0, 267.0, 400.0, 334.0, 400.0, -236.0, 394.0, 400.0, -507.0, 322.0, 400.0, 388.0, 368.0, 400.0, 84.0, -44.0, -626.0, 364.0, 322.0, 369.0, 352.0, 160.0, 267.0, 394.0, 346.0, 370.0, 238.0, 368.0, 400.0, -1546.0, 346.0, 382.0, 316.0, 376.0, 352.0, 263.0, 394.0, 400.0, 400.0, 376.0, 400.0, 334.0, 322.0, 202.0, 250.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 13.0, -1615.0, -1967.0, 200.0, 13.0, 200.0, 79.0, 123.0, 112.0, -1505.0, -1043.0, -75.0, 178.0, 200.0, 200.0, 200.0, -372.0, 200.0, 200.0, -9.0, 200.0, -922.0, -592.0, 200.0, 68.0, 200.0, 178.0, 123.0, 200.0, 13.0, 2.0, -218.0, 167.0, -460.0, -471.0, 134.0, 200.0, 200.0, 24.0, -174.0, 200.0, 200.0, 200.0, 145.0, 46.0, 200.0, 79.0, 112.0, 123.0, 200.0, 46.0, -141.0, 200.0, -86.0, 134.0, 200.0, 200.0, 46.0, -185.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, -812.0, -856.0, -9.0, 200.0, 200.0, 145.0, 123.0, 13.0, 200.0, 200.0, -1626.0, -1714.0, 90.0, 200.0, -295.0, 90.0, 79.0, 46.0, 200.0, 134.0, 178.0, 79.0, 200.0, 200.0, 156.0, 200.0, -779.0, 35.0, 189.0, -1384.0, -1098.0, -1142.0, -977.0, -1142.0, 200.0, -218.0, -97.0, 200.0, -97.0, 112.0, -328.0, -42.0, 68.0, 200.0, 200.0, 200.0, 57.0, 145.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, -779.0, 13.0, 189.0, 200.0, 200.0, 200.0, -119.0, -878.0, 200.0, 57.0, 200.0, 200.0, 200.0, 178.0, 189.0, 134.0, 200.0, 200.0, -75.0, -31.0, -449.0, 35.0, -1065.0, -526.0, 200.0, 134.0, 156.0, 101.0, 79.0, 200.0, 112.0, 200.0, 189.0, -229.0, 68.0, 134.0, 200.0, 189.0, 101.0, 200.0, 156.0, 189.0, 167.0, -174.0, 13.0, 200.0, 200.0, 200.0, -1516.0, -900.0, 200.0, 101.0, 167.0, 200.0, 200.0, 46.0, 178.0, 178.0, 200.0, 112.0, 134.0, 24.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 79.0, 200.0, 57.0, -152.0, 189.0, -9.0, 134.0], "policy_predator_policy_reward": [95.0, 5.0, 10.0, 985.0, 0.0, 85.0, 0.0, 55.0, 40.0, 0.0, 770.0, 45.0, 135.0, 0.0, 0.0, 0.0, 0.0, 260.0, 0.0, 0.0, 80.0, 85.0, 665.0, 30.0, 0.0, 60.0, 10.0, 0.0, 0.0, 35.0, 15.0, 90.0, 180.0, 130.0, 320.0, 0.0, 0.0, 30.0, 80.0, 50.0, 170.0, 0.0, 0.0, 0.0, 0.0, 95.0, 10.0, 45.0, 25.0, 50.0, 60.0, 10.0, 5.0, 150.0, 130.0, 30.0, 0.0, 0.0, 175.0, 70.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 755.0, 0.0, 95.0, 0.0, 20.0, 5.0, 85.0, 35.0, 0.0, 0.0, 830.0, 860.0, 25.0, 30.0, 50.0, 225.0, 85.0, 55.0, 0.0, 30.0, 10.0, 55.0, 0.0, 0.0, 0.0, 20.0, 0.0, 520.0, 720.0, 5.0, 1000.0, 0.0, 60.0, 620.0, 30.0, 190.0, 135.0, 0.0, 135.0, 40.0, 0.0, 240.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 495.0, 35.0, 5.0, 0.0, 0.0, 0.0, 490.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 25.0, 0.0, 0.0, 0.0, 190.0, 370.0, 0.0, 100.0, 865.0, 30.0, 0.0, 45.0, 20.0, 35.0, 55.0, 0.0, 40.0, 5.0, 195.0, 0.0, 65.0, 5.0, 0.0, 0.0, 45.0, 20.0, 5.0, 80.0, 165.0, 70.0, 85.0, 0.0, 0.0, 780.0, 90.0, 0.0, 45.0, 0.0, 15.0, 30.0, 40.0, 10.0, 10.0, 0.0, 40.0, 25.0, 80.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 5.0, 50.0, 25.0, 40.0, 165.0, 0.0, 95.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7139236963992459, "mean_inference_ms": 1.7052500413502014, "mean_action_processing_ms": 0.28150078938983564, "mean_env_wait_ms": 0.20038240107133773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00408172607421875, "StateBufferConnector_ms": 0.003547191619873047, "ViewRequirementAgentConnector_ms": 0.11035346984863281}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2587.0, "episode_return_mean": 120.66, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.06117466571007, "num_env_steps_trained_throughput_per_sec": 81.06117466571007, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 49727.027, "restore_workers_time_ms": 0.013, "training_step_time_ms": 49726.961, "sample_time_ms": 1270.848, "learn_time_ms": 48439.504, "learn_throughput": 82.577, "synch_weights_time_ms": 13.285}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "ed30a_00000", "date": "2024-08-12_15-07-05", "timestamp": 1723489625, "time_this_iter_s": 49.39895296096802, "time_total_s": 3049.7302644252777, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a4040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3049.7302644252777, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 33.357142857142854, "ram_util_percent": 82.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.193159255464241, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5991275425310487, "policy_loss": -0.004453816553134294, "vf_loss": 1.6030210272029595, "vf_explained_var": 0.000260606707719268, "kl": 0.0074710509146936645, "entropy": 0.8506527624748371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.426370982833641, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.80483337583996, "policy_loss": -0.013781606580781203, "vf_loss": 1.8178198006733384, "vf_explained_var": 0.011128278573354085, "kl": 0.010602469013518728, "entropy": 1.2913316683794456, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2351.0, "episode_reward_mean": 130.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1714.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -23.795, "predator_policy": 89.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.0, 310.0, 316.0, 214.0, 208.0, 400.0, 106.0, 400.0, 388.0, 400.0, -913.0, 286.0, 370.0, 256.0, 400.0, -1650.0, 345.0, 70.0, 265.0, 364.0, 322.0, 400.0, 376.0, -224.0, -470.0, -1240.0, -1439.0, 202.0, 238.0, 190.0, -130.0, 328.0, 400.0, 267.0, 400.0, 334.0, 400.0, -236.0, 394.0, 400.0, -507.0, 322.0, 400.0, 388.0, 368.0, 400.0, 84.0, -44.0, -626.0, 364.0, 322.0, 369.0, 352.0, 160.0, 267.0, 394.0, 346.0, 370.0, 238.0, 368.0, 400.0, -1546.0, 346.0, 382.0, 316.0, 376.0, 352.0, 263.0, 394.0, 400.0, 400.0, 376.0, 400.0, 334.0, 322.0, 202.0, 250.0, 368.0, 400.0, 230.0, 281.0, -2351.0, 370.0, 400.0, 347.0, 298.0, 370.0, -867.0, 386.0, 280.0, 345.0, 354.0, 340.0, -662.0, -813.0, 154.0, 364.0, 400.0, -210.0, 229.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 79.0, 112.0, 123.0, 200.0, 46.0, -141.0, 200.0, -86.0, 134.0, 200.0, 200.0, 46.0, -185.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, -812.0, -856.0, -9.0, 200.0, 200.0, 145.0, 123.0, 13.0, 200.0, 200.0, -1626.0, -1714.0, 90.0, 200.0, -295.0, 90.0, 79.0, 46.0, 200.0, 134.0, 178.0, 79.0, 200.0, 200.0, 156.0, 200.0, -779.0, 35.0, 189.0, -1384.0, -1098.0, -1142.0, -977.0, -1142.0, 200.0, -218.0, -97.0, 200.0, -97.0, 112.0, -328.0, -42.0, 68.0, 200.0, 200.0, 200.0, 57.0, 145.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, -779.0, 13.0, 189.0, 200.0, 200.0, 200.0, -119.0, -878.0, 200.0, 57.0, 200.0, 200.0, 200.0, 178.0, 189.0, 134.0, 200.0, 200.0, -75.0, -31.0, -449.0, 35.0, -1065.0, -526.0, 200.0, 134.0, 156.0, 101.0, 79.0, 200.0, 112.0, 200.0, 189.0, -229.0, 68.0, 134.0, 200.0, 189.0, 101.0, 200.0, 156.0, 189.0, 167.0, -174.0, 13.0, 200.0, 200.0, 200.0, -1516.0, -900.0, 200.0, 101.0, 167.0, 200.0, 200.0, 46.0, 178.0, 178.0, 200.0, 112.0, 134.0, 24.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 79.0, 200.0, 57.0, -152.0, 189.0, -9.0, 134.0, 200.0, 68.0, 200.0, 200.0, 68.0, 57.0, 178.0, -42.0, -1637.0, -1604.0, 189.0, 101.0, 200.0, 200.0, 123.0, 189.0, 123.0, 90.0, 200.0, 145.0, -625.0, -647.0, 156.0, 200.0, 68.0, 112.0, 200.0, 90.0, 79.0, 200.0, 90.0, 200.0, 123.0, -1670.0, -735.0, -768.0, 189.0, -240.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1010.0, -42.0, 156.0], "policy_predator_policy_reward": [10.0, 45.0, 25.0, 50.0, 60.0, 10.0, 5.0, 150.0, 130.0, 30.0, 0.0, 0.0, 175.0, 70.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 755.0, 0.0, 95.0, 0.0, 20.0, 5.0, 85.0, 35.0, 0.0, 0.0, 830.0, 860.0, 25.0, 30.0, 50.0, 225.0, 85.0, 55.0, 0.0, 30.0, 10.0, 55.0, 0.0, 0.0, 0.0, 20.0, 0.0, 520.0, 720.0, 5.0, 1000.0, 0.0, 60.0, 620.0, 30.0, 190.0, 135.0, 0.0, 135.0, 40.0, 0.0, 240.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 495.0, 35.0, 5.0, 0.0, 0.0, 0.0, 490.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 25.0, 0.0, 0.0, 0.0, 190.0, 370.0, 0.0, 100.0, 865.0, 30.0, 0.0, 45.0, 20.0, 35.0, 55.0, 0.0, 40.0, 5.0, 195.0, 0.0, 65.0, 5.0, 0.0, 0.0, 45.0, 20.0, 5.0, 80.0, 165.0, 70.0, 85.0, 0.0, 0.0, 780.0, 90.0, 0.0, 45.0, 0.0, 15.0, 30.0, 40.0, 10.0, 10.0, 0.0, 40.0, 25.0, 80.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 5.0, 50.0, 25.0, 40.0, 165.0, 0.0, 95.0, 30.0, 60.0, 40.0, 0.0, 0.0, 10.0, 95.0, 110.0, 35.0, 815.0, 75.0, 35.0, 45.0, 0.0, 0.0, 0.0, 35.0, 85.0, 0.0, 25.0, 0.0, 0.0, 405.0, 20.0, 10.0, 40.0, 60.0, 40.0, 15.0, 30.0, 45.0, 50.0, 0.0, 850.0, 35.0, 690.0, 0.0, 205.0, 0.0, 0.0, 30.0, 0.0, 0.0, 255.0, 345.0, 0.0, 115.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7136050731892677, "mean_inference_ms": 1.7027616433726942, "mean_action_processing_ms": 0.28136991764748365, "mean_env_wait_ms": 0.20029064860936782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006073713302612305, "StateBufferConnector_ms": 0.004138469696044922, "ViewRequirementAgentConnector_ms": 0.12437546253204346}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2351.0, "episode_return_mean": 130.96, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.95156816021563, "num_env_steps_trained_throughput_per_sec": 81.95156816021563, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 49643.708, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49643.631, "sample_time_ms": 1265.313, "learn_time_ms": 48360.96, "learn_throughput": 82.711, "synch_weights_time_ms": 14.063}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "ed30a_00000", "date": "2024-08-12_15-07-54", "timestamp": 1723489674, "time_this_iter_s": 48.8577561378479, "time_total_s": 3098.5880205631256, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3098.5880205631256, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 32.052173913043475, "ram_util_percent": 82.4550724637681}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1598467000972026, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.8120413516879712, "policy_loss": -0.006014393428192725, "vf_loss": 1.8174766947668066, "vf_explained_var": 0.00026129323338705394, "kl": 0.007720557377253492, "entropy": 0.911594682111942, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.286079041699253, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4899190219306442, "policy_loss": -0.013593010663266772, "vf_loss": 1.502835339938522, "vf_explained_var": 0.023489571343023312, "kl": 0.009022554044848276, "entropy": 1.310863598250838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2461.0, "episode_reward_mean": 124.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1780.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -27.48, "predator_policy": 89.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.0, 364.0, 322.0, 400.0, 376.0, -224.0, -470.0, -1240.0, -1439.0, 202.0, 238.0, 190.0, -130.0, 328.0, 400.0, 267.0, 400.0, 334.0, 400.0, -236.0, 394.0, 400.0, -507.0, 322.0, 400.0, 388.0, 368.0, 400.0, 84.0, -44.0, -626.0, 364.0, 322.0, 369.0, 352.0, 160.0, 267.0, 394.0, 346.0, 370.0, 238.0, 368.0, 400.0, -1546.0, 346.0, 382.0, 316.0, 376.0, 352.0, 263.0, 394.0, 400.0, 400.0, 376.0, 400.0, 334.0, 322.0, 202.0, 250.0, 368.0, 400.0, 230.0, 281.0, -2351.0, 370.0, 400.0, 347.0, 298.0, 370.0, -867.0, 386.0, 280.0, 345.0, 354.0, 340.0, -662.0, -813.0, 154.0, 364.0, 400.0, -210.0, 229.0, 346.0, 322.0, 358.0, 400.0, 280.0, 278.0, 373.0, 97.0, 334.0, 325.0, 136.0, 388.0, 360.0, 320.0, 278.0, -471.0, -2461.0, -20.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 46.0, 200.0, 134.0, 178.0, 79.0, 200.0, 200.0, 156.0, 200.0, -779.0, 35.0, 189.0, -1384.0, -1098.0, -1142.0, -977.0, -1142.0, 200.0, -218.0, -97.0, 200.0, -97.0, 112.0, -328.0, -42.0, 68.0, 200.0, 200.0, 200.0, 57.0, 145.0, 200.0, 200.0, 200.0, 79.0, 200.0, 200.0, -779.0, 13.0, 189.0, 200.0, 200.0, 200.0, -119.0, -878.0, 200.0, 57.0, 200.0, 200.0, 200.0, 178.0, 189.0, 134.0, 200.0, 200.0, -75.0, -31.0, -449.0, 35.0, -1065.0, -526.0, 200.0, 134.0, 156.0, 101.0, 79.0, 200.0, 112.0, 200.0, 189.0, -229.0, 68.0, 134.0, 200.0, 189.0, 101.0, 200.0, 156.0, 189.0, 167.0, -174.0, 13.0, 200.0, 200.0, 200.0, -1516.0, -900.0, 200.0, 101.0, 167.0, 200.0, 200.0, 46.0, 178.0, 178.0, 200.0, 112.0, 134.0, 24.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 79.0, 200.0, 57.0, -152.0, 189.0, -9.0, 134.0, 200.0, 68.0, 200.0, 200.0, 68.0, 57.0, 178.0, -42.0, -1637.0, -1604.0, 189.0, 101.0, 200.0, 200.0, 123.0, 189.0, 123.0, 90.0, 200.0, 145.0, -625.0, -647.0, 156.0, 200.0, 68.0, 112.0, 200.0, 90.0, 79.0, 200.0, 90.0, 200.0, 123.0, -1670.0, -735.0, -768.0, 189.0, -240.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1010.0, -42.0, 156.0, 101.0, 200.0, 101.0, 156.0, 145.0, 178.0, 200.0, 200.0, 57.0, 123.0, 200.0, -152.0, 200.0, 68.0, 200.0, -383.0, 200.0, 79.0, 57.0, 178.0, -284.0, 200.0, 178.0, 200.0, 167.0, 178.0, 200.0, 35.0, -97.0, 145.0, -1681.0, 200.0, -1681.0, -1780.0, -75.0, -295.0], "policy_predator_policy_reward": [85.0, 55.0, 0.0, 30.0, 10.0, 55.0, 0.0, 0.0, 0.0, 20.0, 0.0, 520.0, 720.0, 5.0, 1000.0, 0.0, 60.0, 620.0, 30.0, 190.0, 135.0, 0.0, 135.0, 40.0, 0.0, 240.0, 60.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 0.0, 0.0, 55.0, 0.0, 0.0, 495.0, 35.0, 5.0, 0.0, 0.0, 0.0, 490.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 25.0, 0.0, 0.0, 0.0, 190.0, 370.0, 0.0, 100.0, 865.0, 30.0, 0.0, 45.0, 20.0, 35.0, 55.0, 0.0, 40.0, 5.0, 195.0, 0.0, 65.0, 5.0, 0.0, 0.0, 45.0, 20.0, 5.0, 80.0, 165.0, 70.0, 85.0, 0.0, 0.0, 780.0, 90.0, 0.0, 45.0, 0.0, 15.0, 30.0, 40.0, 10.0, 10.0, 0.0, 40.0, 25.0, 80.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 5.0, 50.0, 25.0, 40.0, 165.0, 0.0, 95.0, 30.0, 60.0, 40.0, 0.0, 0.0, 10.0, 95.0, 110.0, 35.0, 815.0, 75.0, 35.0, 45.0, 0.0, 0.0, 0.0, 35.0, 85.0, 0.0, 25.0, 0.0, 0.0, 405.0, 20.0, 10.0, 40.0, 60.0, 40.0, 15.0, 30.0, 45.0, 50.0, 0.0, 850.0, 35.0, 690.0, 0.0, 205.0, 0.0, 0.0, 30.0, 0.0, 0.0, 255.0, 345.0, 0.0, 115.0, 30.0, 15.0, 20.0, 45.0, 10.0, 25.0, 0.0, 0.0, 35.0, 65.0, 70.0, 160.0, 50.0, 55.0, 230.0, 50.0, 0.0, 55.0, 65.0, 25.0, 220.0, 0.0, 10.0, 0.0, 0.0, 15.0, 75.0, 10.0, 105.0, 125.0, 160.0, 850.0, 95.0, 905.0, 50.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7136319575388655, "mean_inference_ms": 1.7013967345179974, "mean_action_processing_ms": 0.2813207030475515, "mean_env_wait_ms": 0.20027118371311226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005981802940368652, "StateBufferConnector_ms": 0.004206418991088867, "ViewRequirementAgentConnector_ms": 0.128623366355896}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2461.0, "episode_return_mean": 124.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.90834047034797, "num_env_steps_trained_throughput_per_sec": 76.90834047034797, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 50012.295, "restore_workers_time_ms": 0.014, "training_step_time_ms": 50012.217, "sample_time_ms": 1281.648, "learn_time_ms": 48713.202, "learn_throughput": 82.113, "synch_weights_time_ms": 14.323}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "ed30a_00000", "date": "2024-08-12_15-08-46", "timestamp": 1723489726, "time_this_iter_s": 52.040868043899536, "time_total_s": 3150.628888607025, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20a3ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3150.628888607025, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 43.16351351351352, "ram_util_percent": 81.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3340541186313781, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.301722897455175, "policy_loss": -0.004295897891094524, "vf_loss": 1.305491112338172, "vf_explained_var": 0.00024984179350434155, "kl": 0.007035691958724568, "entropy": 0.8901389915161032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.816398357052021, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3495100461459033, "policy_loss": -0.013738869526793086, "vf_loss": 1.3624416962975547, "vf_explained_var": 0.01800279488008489, "kl": 0.010762940233188325, "entropy": 1.3310403106704591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2461.0, "episode_reward_mean": 155.99, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1813.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 915.0}, "policy_reward_mean": {"prey_policy": -6.58, "predator_policy": 84.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -236.0, 394.0, 400.0, -507.0, 322.0, 400.0, 388.0, 368.0, 400.0, 84.0, -44.0, -626.0, 364.0, 322.0, 369.0, 352.0, 160.0, 267.0, 394.0, 346.0, 370.0, 238.0, 368.0, 400.0, -1546.0, 346.0, 382.0, 316.0, 376.0, 352.0, 263.0, 394.0, 400.0, 400.0, 376.0, 400.0, 334.0, 322.0, 202.0, 250.0, 368.0, 400.0, 230.0, 281.0, -2351.0, 370.0, 400.0, 347.0, 298.0, 370.0, -867.0, 386.0, 280.0, 345.0, 354.0, 340.0, -662.0, -813.0, 154.0, 364.0, 400.0, -210.0, 229.0, 346.0, 322.0, 358.0, 400.0, 280.0, 278.0, 373.0, 97.0, 334.0, 325.0, 136.0, 388.0, 360.0, 320.0, 278.0, -471.0, -2461.0, -20.0, 353.0, 400.0, 400.0, 307.0, 400.0, 329.0, 310.0, 358.0, 353.0, 400.0, -904.0, 400.0, 394.0, -242.0, -608.0, 371.0, 316.0, 346.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -779.0, 13.0, 189.0, 200.0, 200.0, 200.0, -119.0, -878.0, 200.0, 57.0, 200.0, 200.0, 200.0, 178.0, 189.0, 134.0, 200.0, 200.0, -75.0, -31.0, -449.0, 35.0, -1065.0, -526.0, 200.0, 134.0, 156.0, 101.0, 79.0, 200.0, 112.0, 200.0, 189.0, -229.0, 68.0, 134.0, 200.0, 189.0, 101.0, 200.0, 156.0, 189.0, 167.0, -174.0, 13.0, 200.0, 200.0, 200.0, -1516.0, -900.0, 200.0, 101.0, 167.0, 200.0, 200.0, 46.0, 178.0, 178.0, 200.0, 112.0, 134.0, 24.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 79.0, 200.0, 57.0, -152.0, 189.0, -9.0, 134.0, 200.0, 68.0, 200.0, 200.0, 68.0, 57.0, 178.0, -42.0, -1637.0, -1604.0, 189.0, 101.0, 200.0, 200.0, 123.0, 189.0, 123.0, 90.0, 200.0, 145.0, -625.0, -647.0, 156.0, 200.0, 68.0, 112.0, 200.0, 90.0, 79.0, 200.0, 90.0, 200.0, 123.0, -1670.0, -735.0, -768.0, 189.0, -240.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1010.0, -42.0, 156.0, 101.0, 200.0, 101.0, 156.0, 145.0, 178.0, 200.0, 200.0, 57.0, 123.0, 200.0, -152.0, 200.0, 68.0, 200.0, -383.0, 200.0, 79.0, 57.0, 178.0, -284.0, 200.0, 178.0, 200.0, 167.0, 178.0, 200.0, 35.0, -97.0, 145.0, -1681.0, 200.0, -1681.0, -1780.0, -75.0, -295.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, 200.0, 90.0, 189.0, 57.0, 178.0, 200.0, 123.0, 68.0, 200.0, 200.0, 200.0, -1813.0, -141.0, 200.0, 200.0, 189.0, 200.0, 200.0, -977.0, 134.0, -1582.0, 200.0, 101.0, 46.0, 200.0, 123.0, 178.0], "policy_predator_policy_reward": [0.0, 0.0, 495.0, 35.0, 5.0, 0.0, 0.0, 0.0, 490.0, 0.0, 5.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 25.0, 0.0, 0.0, 0.0, 190.0, 370.0, 0.0, 100.0, 865.0, 30.0, 0.0, 45.0, 20.0, 35.0, 55.0, 0.0, 40.0, 5.0, 195.0, 0.0, 65.0, 5.0, 0.0, 0.0, 45.0, 20.0, 5.0, 80.0, 165.0, 70.0, 85.0, 0.0, 0.0, 780.0, 90.0, 0.0, 45.0, 0.0, 15.0, 30.0, 40.0, 10.0, 10.0, 0.0, 40.0, 25.0, 80.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 5.0, 50.0, 25.0, 40.0, 165.0, 0.0, 95.0, 30.0, 60.0, 40.0, 0.0, 0.0, 10.0, 95.0, 110.0, 35.0, 815.0, 75.0, 35.0, 45.0, 0.0, 0.0, 0.0, 35.0, 85.0, 0.0, 25.0, 0.0, 0.0, 405.0, 20.0, 10.0, 40.0, 60.0, 40.0, 15.0, 30.0, 45.0, 50.0, 0.0, 850.0, 35.0, 690.0, 0.0, 205.0, 0.0, 0.0, 30.0, 0.0, 0.0, 255.0, 345.0, 0.0, 115.0, 30.0, 15.0, 20.0, 45.0, 10.0, 25.0, 0.0, 0.0, 35.0, 65.0, 70.0, 160.0, 50.0, 55.0, 230.0, 50.0, 0.0, 55.0, 65.0, 25.0, 220.0, 0.0, 10.0, 0.0, 0.0, 15.0, 75.0, 10.0, 105.0, 125.0, 160.0, 850.0, 95.0, 905.0, 50.0, 300.0, 35.0, 50.0, 0.0, 0.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 50.0, 0.0, 75.0, 0.0, 0.0, 35.0, 40.0, 45.0, 0.0, 0.0, 915.0, 135.0, 0.0, 0.0, 5.0, 0.0, 535.0, 0.0, 30.0, 810.0, 40.0, 30.0, 70.0, 0.0, 10.0, 35.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7126257915200171, "mean_inference_ms": 1.6973994349442438, "mean_action_processing_ms": 0.28089639853746223, "mean_env_wait_ms": 0.19990046936772474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005933880805969238, "StateBufferConnector_ms": 0.003994107246398926, "ViewRequirementAgentConnector_ms": 0.12696516513824463}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2461.0, "episode_return_mean": 155.99, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.17948043830337, "num_env_steps_trained_throughput_per_sec": 80.17948043830337, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 49932.861, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49932.783, "sample_time_ms": 1281.272, "learn_time_ms": 48633.326, "learn_throughput": 82.248, "synch_weights_time_ms": 14.884}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "ed30a_00000", "date": "2024-08-12_15-09-36", "timestamp": 1723489776, "time_this_iter_s": 49.939229011535645, "time_total_s": 3200.568117618561, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a41f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3200.568117618561, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 34.81830985915494, "ram_util_percent": 78.53661971830985}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0553215898218609, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.166727470468592, "policy_loss": -0.005357746596117972, "vf_loss": 2.1715731524285817, "vf_explained_var": 3.799231594832486e-05, "kl": 0.006827350697930237, "entropy": 0.785028326101404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.625138377859479, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3147106704573153, "policy_loss": -0.017450797202548496, "vf_loss": 2.3311735905352093, "vf_explained_var": 0.025212445713224865, "kl": 0.013171675944542634, "entropy": 1.308309199759569, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2461.0, "episode_reward_mean": 142.96, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1813.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 915.0}, "policy_reward_mean": {"prey_policy": -11.145, "predator_policy": 82.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [238.0, 368.0, 400.0, -1546.0, 346.0, 382.0, 316.0, 376.0, 352.0, 263.0, 394.0, 400.0, 400.0, 376.0, 400.0, 334.0, 322.0, 202.0, 250.0, 368.0, 400.0, 230.0, 281.0, -2351.0, 370.0, 400.0, 347.0, 298.0, 370.0, -867.0, 386.0, 280.0, 345.0, 354.0, 340.0, -662.0, -813.0, 154.0, 364.0, 400.0, -210.0, 229.0, 346.0, 322.0, 358.0, 400.0, 280.0, 278.0, 373.0, 97.0, 334.0, 325.0, 136.0, 388.0, 360.0, 320.0, 278.0, -471.0, -2461.0, -20.0, 353.0, 400.0, 400.0, 307.0, 400.0, 329.0, 310.0, 358.0, 353.0, 400.0, -904.0, 400.0, 394.0, -242.0, -608.0, 371.0, 316.0, 346.0, 370.0, 364.0, 304.0, 310.0, 149.0, 400.0, 394.0, 346.0, 400.0, 364.0, 232.0, -470.0, 285.0, 258.0, 373.0, 161.0, -1863.0, 292.0, 322.0, -28.0, 327.0, 94.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, -174.0, 13.0, 200.0, 200.0, 200.0, -1516.0, -900.0, 200.0, 101.0, 167.0, 200.0, 200.0, 46.0, 178.0, 178.0, 200.0, 112.0, 134.0, 24.0, 200.0, 189.0, 200.0, 200.0, 200.0, 200.0, 200.0, 156.0, 200.0, 200.0, 200.0, 79.0, 200.0, 57.0, -152.0, 189.0, -9.0, 134.0, 200.0, 68.0, 200.0, 200.0, 68.0, 57.0, 178.0, -42.0, -1637.0, -1604.0, 189.0, 101.0, 200.0, 200.0, 123.0, 189.0, 123.0, 90.0, 200.0, 145.0, -625.0, -647.0, 156.0, 200.0, 68.0, 112.0, 200.0, 90.0, 79.0, 200.0, 90.0, 200.0, 123.0, -1670.0, -735.0, -768.0, 189.0, -240.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1010.0, -42.0, 156.0, 101.0, 200.0, 101.0, 156.0, 145.0, 178.0, 200.0, 200.0, 57.0, 123.0, 200.0, -152.0, 200.0, 68.0, 200.0, -383.0, 200.0, 79.0, 57.0, 178.0, -284.0, 200.0, 178.0, 200.0, 167.0, 178.0, 200.0, 35.0, -97.0, 145.0, -1681.0, 200.0, -1681.0, -1780.0, -75.0, -295.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, 200.0, 90.0, 189.0, 57.0, 178.0, 200.0, 123.0, 68.0, 200.0, 200.0, 200.0, -1813.0, -141.0, 200.0, 200.0, 189.0, 200.0, 200.0, -977.0, 134.0, -1582.0, 200.0, 101.0, 46.0, 200.0, 123.0, 178.0, 145.0, 200.0, 79.0, 200.0, 24.0, 200.0, 101.0, 134.0, 79.0, -185.0, 200.0, 200.0, 200.0, 189.0, 145.0, 156.0, 200.0, 200.0, 200.0, 134.0, 13.0, 79.0, -504.0, -306.0, 35.0, 145.0, 101.0, 112.0, 200.0, 123.0, 2.0, 24.0, -1505.0, -1153.0, 200.0, 2.0, 145.0, 112.0, -229.0, -9.0, 200.0, 57.0, 35.0, -141.0], "policy_predator_policy_reward": [80.0, 165.0, 70.0, 85.0, 0.0, 0.0, 780.0, 90.0, 0.0, 45.0, 0.0, 15.0, 30.0, 40.0, 10.0, 10.0, 0.0, 40.0, 25.0, 80.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 5.0, 50.0, 25.0, 40.0, 165.0, 0.0, 95.0, 30.0, 60.0, 40.0, 0.0, 0.0, 10.0, 95.0, 110.0, 35.0, 815.0, 75.0, 35.0, 45.0, 0.0, 0.0, 0.0, 35.0, 85.0, 0.0, 25.0, 0.0, 0.0, 405.0, 20.0, 10.0, 40.0, 60.0, 40.0, 15.0, 30.0, 45.0, 50.0, 0.0, 850.0, 35.0, 690.0, 0.0, 205.0, 0.0, 0.0, 30.0, 0.0, 0.0, 255.0, 345.0, 0.0, 115.0, 30.0, 15.0, 20.0, 45.0, 10.0, 25.0, 0.0, 0.0, 35.0, 65.0, 70.0, 160.0, 50.0, 55.0, 230.0, 50.0, 0.0, 55.0, 65.0, 25.0, 220.0, 0.0, 10.0, 0.0, 0.0, 15.0, 75.0, 10.0, 105.0, 125.0, 160.0, 850.0, 95.0, 905.0, 50.0, 300.0, 35.0, 50.0, 0.0, 0.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 50.0, 0.0, 75.0, 0.0, 0.0, 35.0, 40.0, 45.0, 0.0, 0.0, 915.0, 135.0, 0.0, 0.0, 5.0, 0.0, 535.0, 0.0, 30.0, 810.0, 40.0, 30.0, 70.0, 0.0, 10.0, 35.0, 25.0, 0.0, 55.0, 30.0, 50.0, 30.0, 45.0, 30.0, 40.0, 215.0, 0.0, 0.0, 5.0, 0.0, 5.0, 40.0, 0.0, 0.0, 0.0, 30.0, 110.0, 30.0, 340.0, 0.0, 75.0, 30.0, 0.0, 45.0, 35.0, 15.0, 80.0, 55.0, 390.0, 405.0, 90.0, 0.0, 40.0, 25.0, 0.0, 210.0, 65.0, 5.0, 0.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7112577371544581, "mean_inference_ms": 1.6923254910783347, "mean_action_processing_ms": 0.2803485271051204, "mean_env_wait_ms": 0.19942286123342184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006065726280212402, "StateBufferConnector_ms": 0.004047393798828125, "ViewRequirementAgentConnector_ms": 0.1251842975616455}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2461.0, "episode_return_mean": 142.96, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.26460796917698, "num_env_steps_trained_throughput_per_sec": 82.26460796917698, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 49832.945, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49832.868, "sample_time_ms": 1264.112, "learn_time_ms": 48550.28, "learn_throughput": 82.389, "synch_weights_time_ms": 15.209}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "ed30a_00000", "date": "2024-08-12_15-10-25", "timestamp": 1723489825, "time_this_iter_s": 48.66003608703613, "time_total_s": 3249.228153705597, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00b8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3249.228153705597, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 31.769565217391303, "ram_util_percent": 78.3072463768116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0729024891263594, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7084785694167728, "policy_loss": -0.005827152667685397, "vf_loss": 1.7139368644782476, "vf_explained_var": 8.713199348046035e-05, "kl": 0.004918078623322706, "entropy": 0.7605969834895361, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.586689791855989, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.0114582814867537, "policy_loss": -0.015298956471110976, "vf_loss": 2.026018253520683, "vf_explained_var": 0.014418554495251368, "kl": 0.009853137964897857, "entropy": 1.258239946100447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2487.0, "episode_reward_mean": 91.35, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -54.925, "predator_policy": 100.6}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2351.0, 370.0, 400.0, 347.0, 298.0, 370.0, -867.0, 386.0, 280.0, 345.0, 354.0, 340.0, -662.0, -813.0, 154.0, 364.0, 400.0, -210.0, 229.0, 346.0, 322.0, 358.0, 400.0, 280.0, 278.0, 373.0, 97.0, 334.0, 325.0, 136.0, 388.0, 360.0, 320.0, 278.0, -471.0, -2461.0, -20.0, 353.0, 400.0, 400.0, 307.0, 400.0, 329.0, 310.0, 358.0, 353.0, 400.0, -904.0, 400.0, 394.0, -242.0, -608.0, 371.0, 316.0, 346.0, 370.0, 364.0, 304.0, 310.0, 149.0, 400.0, 394.0, 346.0, 400.0, 364.0, 232.0, -470.0, 285.0, 258.0, 373.0, 161.0, -1863.0, 292.0, 322.0, -28.0, 327.0, 94.0, 364.0, 253.0, 400.0, 390.0, 298.0, -142.0, 346.0, 171.0, -232.0, 328.0, 322.0, -415.0, -2487.0, 364.0, -104.0, 208.0, 400.0, 394.0, -1637.0, 370.0, 400.0, 400.0, 300.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1637.0, -1604.0, 189.0, 101.0, 200.0, 200.0, 123.0, 189.0, 123.0, 90.0, 200.0, 145.0, -625.0, -647.0, 156.0, 200.0, 68.0, 112.0, 200.0, 90.0, 79.0, 200.0, 90.0, 200.0, 123.0, -1670.0, -735.0, -768.0, 189.0, -240.0, 134.0, 200.0, 200.0, 200.0, 200.0, -1010.0, -42.0, 156.0, 101.0, 200.0, 101.0, 156.0, 145.0, 178.0, 200.0, 200.0, 57.0, 123.0, 200.0, -152.0, 200.0, 68.0, 200.0, -383.0, 200.0, 79.0, 57.0, 178.0, -284.0, 200.0, 178.0, 200.0, 167.0, 178.0, 200.0, 35.0, -97.0, 145.0, -1681.0, 200.0, -1681.0, -1780.0, -75.0, -295.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, 200.0, 90.0, 189.0, 57.0, 178.0, 200.0, 123.0, 68.0, 200.0, 200.0, 200.0, -1813.0, -141.0, 200.0, 200.0, 189.0, 200.0, 200.0, -977.0, 134.0, -1582.0, 200.0, 101.0, 46.0, 200.0, 123.0, 178.0, 145.0, 200.0, 79.0, 200.0, 24.0, 200.0, 101.0, 134.0, 79.0, -185.0, 200.0, 200.0, 200.0, 189.0, 145.0, 156.0, 200.0, 200.0, 200.0, 134.0, 13.0, 79.0, -504.0, -306.0, 35.0, 145.0, 101.0, 112.0, 200.0, 123.0, 2.0, 24.0, -1505.0, -1153.0, 200.0, 2.0, 145.0, 112.0, -229.0, -9.0, 200.0, 57.0, 35.0, -141.0, 200.0, 134.0, 167.0, -9.0, 200.0, 200.0, 145.0, 200.0, 57.0, 156.0, -306.0, -141.0, 200.0, 101.0, -20.0, 46.0, -1142.0, 200.0, -42.0, 200.0, 167.0, 90.0, -2000.0, 200.0, -1769.0, -1648.0, 200.0, 134.0, -658.0, 134.0, 189.0, -141.0, 200.0, 200.0, 200.0, 189.0, -1791.0, -1076.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 178.0, 57.0], "policy_predator_policy_reward": [815.0, 75.0, 35.0, 45.0, 0.0, 0.0, 0.0, 35.0, 85.0, 0.0, 25.0, 0.0, 0.0, 405.0, 20.0, 10.0, 40.0, 60.0, 40.0, 15.0, 30.0, 45.0, 50.0, 0.0, 850.0, 35.0, 690.0, 0.0, 205.0, 0.0, 0.0, 30.0, 0.0, 0.0, 255.0, 345.0, 0.0, 115.0, 30.0, 15.0, 20.0, 45.0, 10.0, 25.0, 0.0, 0.0, 35.0, 65.0, 70.0, 160.0, 50.0, 55.0, 230.0, 50.0, 0.0, 55.0, 65.0, 25.0, 220.0, 0.0, 10.0, 0.0, 0.0, 15.0, 75.0, 10.0, 105.0, 125.0, 160.0, 850.0, 95.0, 905.0, 50.0, 300.0, 35.0, 50.0, 0.0, 0.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 50.0, 0.0, 75.0, 0.0, 0.0, 35.0, 40.0, 45.0, 0.0, 0.0, 915.0, 135.0, 0.0, 0.0, 5.0, 0.0, 535.0, 0.0, 30.0, 810.0, 40.0, 30.0, 70.0, 0.0, 10.0, 35.0, 25.0, 0.0, 55.0, 30.0, 50.0, 30.0, 45.0, 30.0, 40.0, 215.0, 0.0, 0.0, 5.0, 0.0, 5.0, 40.0, 0.0, 0.0, 0.0, 30.0, 110.0, 30.0, 340.0, 0.0, 75.0, 30.0, 0.0, 45.0, 35.0, 15.0, 80.0, 55.0, 390.0, 405.0, 90.0, 0.0, 40.0, 25.0, 0.0, 210.0, 65.0, 5.0, 0.0, 200.0, 30.0, 0.0, 90.0, 5.0, 0.0, 0.0, 20.0, 25.0, 20.0, 65.0, 285.0, 20.0, 45.0, 0.0, 50.0, 95.0, 280.0, 430.0, 70.0, 100.0, 15.0, 50.0, 1000.0, 385.0, 845.0, 85.0, 30.0, 0.0, 420.0, 0.0, 145.0, 15.0, 0.0, 0.0, 5.0, 0.0, 355.0, 875.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.710221155344542, "mean_inference_ms": 1.6898291743098812, "mean_action_processing_ms": 0.28019398456463646, "mean_env_wait_ms": 0.19905244353804857, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058585405349731445, "StateBufferConnector_ms": 0.0040051937103271484, "ViewRequirementAgentConnector_ms": 0.12555670738220215}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2487.0, "episode_return_mean": 91.35, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.51216057365326, "num_env_steps_trained_throughput_per_sec": 79.51216057365326, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 49907.205, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49907.127, "sample_time_ms": 1307.749, "learn_time_ms": 48581.021, "learn_throughput": 82.337, "synch_weights_time_ms": 15.238}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "ed30a_00000", "date": "2024-08-12_15-11-15", "timestamp": 1723489875, "time_this_iter_s": 50.375600814819336, "time_total_s": 3299.6037545204163, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01203a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3299.6037545204163, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.54084507042253, "ram_util_percent": 79.17464788732391}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.028321156000334, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1389084175150233, "policy_loss": -0.0057155366188713485, "vf_loss": 2.1443217656599782, "vf_explained_var": 8.917614896461446e-05, "kl": 0.008058038117427831, "entropy": 0.6877104005170247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.48729499007659, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.328853021443836, "policy_loss": -0.015801751081555807, "vf_loss": 2.343666117721134, "vf_explained_var": 0.022831565267825253, "kl": 0.013182123070441887, "entropy": 1.273603201038623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2487.0, "episode_reward_mean": 100.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -49.26, "predator_policy": 99.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [229.0, 346.0, 322.0, 358.0, 400.0, 280.0, 278.0, 373.0, 97.0, 334.0, 325.0, 136.0, 388.0, 360.0, 320.0, 278.0, -471.0, -2461.0, -20.0, 353.0, 400.0, 400.0, 307.0, 400.0, 329.0, 310.0, 358.0, 353.0, 400.0, -904.0, 400.0, 394.0, -242.0, -608.0, 371.0, 316.0, 346.0, 370.0, 364.0, 304.0, 310.0, 149.0, 400.0, 394.0, 346.0, 400.0, 364.0, 232.0, -470.0, 285.0, 258.0, 373.0, 161.0, -1863.0, 292.0, 322.0, -28.0, 327.0, 94.0, 364.0, 253.0, 400.0, 390.0, 298.0, -142.0, 346.0, 171.0, -232.0, 328.0, 322.0, -415.0, -2487.0, 364.0, -104.0, 208.0, 400.0, 394.0, -1637.0, 370.0, 400.0, 400.0, 300.0, -1330.0, 365.0, 268.0, -646.0, 91.0, 292.0, 380.0, 346.0, 341.0, -69.0, 347.0, -1858.0, 370.0, 388.0, 400.0, 364.0, 388.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-42.0, 156.0, 101.0, 200.0, 101.0, 156.0, 145.0, 178.0, 200.0, 200.0, 57.0, 123.0, 200.0, -152.0, 200.0, 68.0, 200.0, -383.0, 200.0, 79.0, 57.0, 178.0, -284.0, 200.0, 178.0, 200.0, 167.0, 178.0, 200.0, 35.0, -97.0, 145.0, -1681.0, 200.0, -1681.0, -1780.0, -75.0, -295.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, 200.0, 90.0, 189.0, 57.0, 178.0, 200.0, 123.0, 68.0, 200.0, 200.0, 200.0, -1813.0, -141.0, 200.0, 200.0, 189.0, 200.0, 200.0, -977.0, 134.0, -1582.0, 200.0, 101.0, 46.0, 200.0, 123.0, 178.0, 145.0, 200.0, 79.0, 200.0, 24.0, 200.0, 101.0, 134.0, 79.0, -185.0, 200.0, 200.0, 200.0, 189.0, 145.0, 156.0, 200.0, 200.0, 200.0, 134.0, 13.0, 79.0, -504.0, -306.0, 35.0, 145.0, 101.0, 112.0, 200.0, 123.0, 2.0, 24.0, -1505.0, -1153.0, 200.0, 2.0, 145.0, 112.0, -229.0, -9.0, 200.0, 57.0, 35.0, -141.0, 200.0, 134.0, 167.0, -9.0, 200.0, 200.0, 145.0, 200.0, 57.0, 156.0, -306.0, -141.0, 200.0, 101.0, -20.0, 46.0, -1142.0, 200.0, -42.0, 200.0, 167.0, 90.0, -2000.0, 200.0, -1769.0, -1648.0, 200.0, 134.0, -658.0, 134.0, 189.0, -141.0, 200.0, 200.0, 200.0, 189.0, -1791.0, -1076.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 178.0, 57.0, -1098.0, -1032.0, 200.0, 90.0, 200.0, -42.0, -504.0, -482.0, 2.0, -31.0, -53.0, 200.0, 145.0, 200.0, 200.0, 101.0, 200.0, -9.0, -1054.0, 200.0, 200.0, 57.0, -1560.0, -1208.0, 200.0, 145.0, 178.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 178.0, 101.0, -460.0], "policy_predator_policy_reward": [0.0, 115.0, 30.0, 15.0, 20.0, 45.0, 10.0, 25.0, 0.0, 0.0, 35.0, 65.0, 70.0, 160.0, 50.0, 55.0, 230.0, 50.0, 0.0, 55.0, 65.0, 25.0, 220.0, 0.0, 10.0, 0.0, 0.0, 15.0, 75.0, 10.0, 105.0, 125.0, 160.0, 850.0, 95.0, 905.0, 50.0, 300.0, 35.0, 50.0, 0.0, 0.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 50.0, 0.0, 75.0, 0.0, 0.0, 35.0, 40.0, 45.0, 0.0, 0.0, 915.0, 135.0, 0.0, 0.0, 5.0, 0.0, 535.0, 0.0, 30.0, 810.0, 40.0, 30.0, 70.0, 0.0, 10.0, 35.0, 25.0, 0.0, 55.0, 30.0, 50.0, 30.0, 45.0, 30.0, 40.0, 215.0, 0.0, 0.0, 5.0, 0.0, 5.0, 40.0, 0.0, 0.0, 0.0, 30.0, 110.0, 30.0, 340.0, 0.0, 75.0, 30.0, 0.0, 45.0, 35.0, 15.0, 80.0, 55.0, 390.0, 405.0, 90.0, 0.0, 40.0, 25.0, 0.0, 210.0, 65.0, 5.0, 0.0, 200.0, 30.0, 0.0, 90.0, 5.0, 0.0, 0.0, 20.0, 25.0, 20.0, 65.0, 285.0, 20.0, 45.0, 0.0, 50.0, 95.0, 280.0, 430.0, 70.0, 100.0, 15.0, 50.0, 1000.0, 385.0, 845.0, 85.0, 30.0, 0.0, 420.0, 0.0, 145.0, 15.0, 0.0, 0.0, 5.0, 0.0, 355.0, 875.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 195.0, 605.0, 50.0, 25.0, 50.0, 60.0, 310.0, 30.0, 0.0, 120.0, 30.0, 115.0, 25.0, 10.0, 25.0, 20.0, 80.0, 70.0, 215.0, 570.0, 65.0, 25.0, 880.0, 30.0, 25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 45.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.710654523642967, "mean_inference_ms": 1.6875502966123508, "mean_action_processing_ms": 0.2801175210630579, "mean_env_wait_ms": 0.19890401681176834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003885030746459961, "StateBufferConnector_ms": 0.003450751304626465, "ViewRequirementAgentConnector_ms": 0.11381876468658447}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2487.0, "episode_return_mean": 100.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.08288454266317, "num_env_steps_trained_throughput_per_sec": 81.08288454266317, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 49701.367, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49701.299, "sample_time_ms": 1303.349, "learn_time_ms": 48379.262, "learn_throughput": 82.68, "synch_weights_time_ms": 15.761}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "ed30a_00000", "date": "2024-08-12_15-12-04", "timestamp": 1723489924, "time_this_iter_s": 49.38527703285217, "time_total_s": 3348.9890315532684, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00b8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3348.9890315532684, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 33.91428571428571, "ram_util_percent": 78.9242857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0671849830756113, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1887270815788753, "policy_loss": -0.004852628654544119, "vf_loss": 2.1932660410643887, "vf_explained_var": 3.372251041351803e-05, "kl": 0.008364429867289072, "entropy": 0.7313688099068939, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.664202162923005, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1630249642190478, "policy_loss": -0.014304752909780416, "vf_loss": 3.176264028952866, "vf_explained_var": 0.014918222345372356, "kl": 0.014209194051852652, "entropy": 1.1982141194520173, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2487.0, "episode_reward_mean": 84.8, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -57.675, "predator_policy": 100.075}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-20.0, 353.0, 400.0, 400.0, 307.0, 400.0, 329.0, 310.0, 358.0, 353.0, 400.0, -904.0, 400.0, 394.0, -242.0, -608.0, 371.0, 316.0, 346.0, 370.0, 364.0, 304.0, 310.0, 149.0, 400.0, 394.0, 346.0, 400.0, 364.0, 232.0, -470.0, 285.0, 258.0, 373.0, 161.0, -1863.0, 292.0, 322.0, -28.0, 327.0, 94.0, 364.0, 253.0, 400.0, 390.0, 298.0, -142.0, 346.0, 171.0, -232.0, 328.0, 322.0, -415.0, -2487.0, 364.0, -104.0, 208.0, 400.0, 394.0, -1637.0, 370.0, 400.0, 400.0, 300.0, -1330.0, 365.0, 268.0, -646.0, 91.0, 292.0, 380.0, 346.0, 341.0, -69.0, 347.0, -1858.0, 370.0, 388.0, 400.0, 364.0, 388.0, -14.0, 352.0, 343.0, -835.0, 394.0, 400.0, 98.0, 394.0, -72.0, 365.0, 208.0, 384.0, 374.0, 322.0, 400.0, 284.0, -1963.0, 82.0, -1211.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.0, -295.0, 68.0, 200.0, 200.0, 200.0, 200.0, 200.0, 2.0, 200.0, 200.0, 200.0, 90.0, 189.0, 57.0, 178.0, 200.0, 123.0, 68.0, 200.0, 200.0, 200.0, -1813.0, -141.0, 200.0, 200.0, 189.0, 200.0, 200.0, -977.0, 134.0, -1582.0, 200.0, 101.0, 46.0, 200.0, 123.0, 178.0, 145.0, 200.0, 79.0, 200.0, 24.0, 200.0, 101.0, 134.0, 79.0, -185.0, 200.0, 200.0, 200.0, 189.0, 145.0, 156.0, 200.0, 200.0, 200.0, 134.0, 13.0, 79.0, -504.0, -306.0, 35.0, 145.0, 101.0, 112.0, 200.0, 123.0, 2.0, 24.0, -1505.0, -1153.0, 200.0, 2.0, 145.0, 112.0, -229.0, -9.0, 200.0, 57.0, 35.0, -141.0, 200.0, 134.0, 167.0, -9.0, 200.0, 200.0, 145.0, 200.0, 57.0, 156.0, -306.0, -141.0, 200.0, 101.0, -20.0, 46.0, -1142.0, 200.0, -42.0, 200.0, 167.0, 90.0, -2000.0, 200.0, -1769.0, -1648.0, 200.0, 134.0, -658.0, 134.0, 189.0, -141.0, 200.0, 200.0, 200.0, 189.0, -1791.0, -1076.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 178.0, 57.0, -1098.0, -1032.0, 200.0, 90.0, 200.0, -42.0, -504.0, -482.0, 2.0, -31.0, -53.0, 200.0, 145.0, 200.0, 200.0, 101.0, 200.0, -9.0, -1054.0, 200.0, 200.0, 57.0, -1560.0, -1208.0, 200.0, 145.0, 178.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 178.0, 101.0, -460.0, 189.0, 123.0, 167.0, 156.0, -647.0, -988.0, 189.0, 200.0, 200.0, 200.0, 24.0, -251.0, 200.0, 189.0, -141.0, -86.0, 156.0, 189.0, -152.0, 200.0, 200.0, 134.0, 200.0, 134.0, 200.0, 57.0, 200.0, 200.0, 200.0, -31.0, -1538.0, -1340.0, -350.0, 167.0, -999.0, -1032.0], "policy_predator_policy_reward": [50.0, 300.0, 35.0, 50.0, 0.0, 0.0, 0.0, 0.0, 60.0, 45.0, 0.0, 0.0, 50.0, 0.0, 75.0, 0.0, 0.0, 35.0, 40.0, 45.0, 0.0, 0.0, 915.0, 135.0, 0.0, 0.0, 5.0, 0.0, 535.0, 0.0, 30.0, 810.0, 40.0, 30.0, 70.0, 0.0, 10.0, 35.0, 25.0, 0.0, 55.0, 30.0, 50.0, 30.0, 45.0, 30.0, 40.0, 215.0, 0.0, 0.0, 5.0, 0.0, 5.0, 40.0, 0.0, 0.0, 0.0, 30.0, 110.0, 30.0, 340.0, 0.0, 75.0, 30.0, 0.0, 45.0, 35.0, 15.0, 80.0, 55.0, 390.0, 405.0, 90.0, 0.0, 40.0, 25.0, 0.0, 210.0, 65.0, 5.0, 0.0, 200.0, 30.0, 0.0, 90.0, 5.0, 0.0, 0.0, 20.0, 25.0, 20.0, 65.0, 285.0, 20.0, 45.0, 0.0, 50.0, 95.0, 280.0, 430.0, 70.0, 100.0, 15.0, 50.0, 1000.0, 385.0, 845.0, 85.0, 30.0, 0.0, 420.0, 0.0, 145.0, 15.0, 0.0, 0.0, 5.0, 0.0, 355.0, 875.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 195.0, 605.0, 50.0, 25.0, 50.0, 60.0, 310.0, 30.0, 0.0, 120.0, 30.0, 115.0, 25.0, 10.0, 25.0, 20.0, 80.0, 70.0, 215.0, 570.0, 65.0, 25.0, 880.0, 30.0, 25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 45.0, 300.0, 0.0, 40.0, 20.0, 0.0, 410.0, 390.0, 5.0, 0.0, 0.0, 0.0, 210.0, 115.0, 5.0, 0.0, 10.0, 145.0, 20.0, 0.0, 0.0, 160.0, 20.0, 30.0, 30.0, 10.0, 0.0, 65.0, 0.0, 0.0, 45.0, 70.0, 880.0, 35.0, 250.0, 15.0, 125.0, 695.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.709950177189842, "mean_inference_ms": 1.6849079791347017, "mean_action_processing_ms": 0.2799682626303487, "mean_env_wait_ms": 0.1986280489204172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003840208053588867, "StateBufferConnector_ms": 0.0035088062286376953, "ViewRequirementAgentConnector_ms": 0.11225223541259766}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2487.0, "episode_return_mean": 84.8, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.47046008355527, "num_env_steps_trained_throughput_per_sec": 81.47046008355527, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 49639.448, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49639.381, "sample_time_ms": 1297.984, "learn_time_ms": 48322.535, "learn_throughput": 82.777, "synch_weights_time_ms": 16.074}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "ed30a_00000", "date": "2024-08-12_15-12-54", "timestamp": 1723489974, "time_this_iter_s": 49.13770914077759, "time_total_s": 3398.126740694046, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3398.126740694046, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 33.12714285714285, "ram_util_percent": 79.56857142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0097978694177179, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6060220609266291, "policy_loss": -0.006437746633741039, "vf_loss": 1.6120339917127418, "vf_explained_var": 0.00021728668263349584, "kl": 0.011354933135920894, "entropy": 0.8571553969824756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.790432325904331, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.922663730004477, "policy_loss": -0.011788829932329319, "vf_loss": 1.9336152679705747, "vf_explained_var": 0.010004835563992696, "kl": 0.011163925028067656, "entropy": 1.1631394335201808, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2690.0, "episode_reward_mean": 34.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -90.62, "predator_policy": 107.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 149.0, 400.0, 394.0, 346.0, 400.0, 364.0, 232.0, -470.0, 285.0, 258.0, 373.0, 161.0, -1863.0, 292.0, 322.0, -28.0, 327.0, 94.0, 364.0, 253.0, 400.0, 390.0, 298.0, -142.0, 346.0, 171.0, -232.0, 328.0, 322.0, -415.0, -2487.0, 364.0, -104.0, 208.0, 400.0, 394.0, -1637.0, 370.0, 400.0, 400.0, 300.0, -1330.0, 365.0, 268.0, -646.0, 91.0, 292.0, 380.0, 346.0, 341.0, -69.0, 347.0, -1858.0, 370.0, 388.0, 400.0, 364.0, 388.0, -14.0, 352.0, 343.0, -835.0, 394.0, 400.0, 98.0, 394.0, -72.0, 365.0, 208.0, 384.0, 374.0, 322.0, 400.0, 284.0, -1963.0, 82.0, -1211.0, 328.0, 266.0, 256.0, 270.0, 364.0, 292.0, -2690.0, 400.0, 296.0, -595.0, 304.0, -98.0, 352.0, 334.0, 375.0, 382.0, 394.0, 81.0, -473.0, 328.0, 260.0, -1804.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, 134.0, 79.0, -185.0, 200.0, 200.0, 200.0, 189.0, 145.0, 156.0, 200.0, 200.0, 200.0, 134.0, 13.0, 79.0, -504.0, -306.0, 35.0, 145.0, 101.0, 112.0, 200.0, 123.0, 2.0, 24.0, -1505.0, -1153.0, 200.0, 2.0, 145.0, 112.0, -229.0, -9.0, 200.0, 57.0, 35.0, -141.0, 200.0, 134.0, 167.0, -9.0, 200.0, 200.0, 145.0, 200.0, 57.0, 156.0, -306.0, -141.0, 200.0, 101.0, -20.0, 46.0, -1142.0, 200.0, -42.0, 200.0, 167.0, 90.0, -2000.0, 200.0, -1769.0, -1648.0, 200.0, 134.0, -658.0, 134.0, 189.0, -141.0, 200.0, 200.0, 200.0, 189.0, -1791.0, -1076.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 178.0, 57.0, -1098.0, -1032.0, 200.0, 90.0, 200.0, -42.0, -504.0, -482.0, 2.0, -31.0, -53.0, 200.0, 145.0, 200.0, 200.0, 101.0, 200.0, -9.0, -1054.0, 200.0, 200.0, 57.0, -1560.0, -1208.0, 200.0, 145.0, 178.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 178.0, 101.0, -460.0, 189.0, 123.0, 167.0, 156.0, -647.0, -988.0, 189.0, 200.0, 200.0, 200.0, 24.0, -251.0, 200.0, 189.0, -141.0, -86.0, 156.0, 189.0, -152.0, 200.0, 200.0, 134.0, 200.0, 134.0, 200.0, 57.0, 200.0, 200.0, 200.0, -31.0, -1538.0, -1340.0, -350.0, 167.0, -999.0, -1032.0, 68.0, 200.0, 112.0, -31.0, 200.0, -64.0, -75.0, 200.0, 200.0, 134.0, 13.0, 189.0, -1890.0, -1780.0, 200.0, 200.0, 90.0, 156.0, -933.0, -262.0, 156.0, 68.0, -537.0, 24.0, 200.0, 112.0, 79.0, 200.0, 145.0, 200.0, 167.0, 200.0, 200.0, 189.0, -449.0, 200.0, -438.0, -625.0, 68.0, 200.0, 145.0, -130.0, -900.0, -1879.0], "policy_predator_policy_reward": [45.0, 30.0, 40.0, 215.0, 0.0, 0.0, 5.0, 0.0, 5.0, 40.0, 0.0, 0.0, 0.0, 30.0, 110.0, 30.0, 340.0, 0.0, 75.0, 30.0, 0.0, 45.0, 35.0, 15.0, 80.0, 55.0, 390.0, 405.0, 90.0, 0.0, 40.0, 25.0, 0.0, 210.0, 65.0, 5.0, 0.0, 200.0, 30.0, 0.0, 90.0, 5.0, 0.0, 0.0, 20.0, 25.0, 20.0, 65.0, 285.0, 20.0, 45.0, 0.0, 50.0, 95.0, 280.0, 430.0, 70.0, 100.0, 15.0, 50.0, 1000.0, 385.0, 845.0, 85.0, 30.0, 0.0, 420.0, 0.0, 145.0, 15.0, 0.0, 0.0, 5.0, 0.0, 355.0, 875.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 195.0, 605.0, 50.0, 25.0, 50.0, 60.0, 310.0, 30.0, 0.0, 120.0, 30.0, 115.0, 25.0, 10.0, 25.0, 20.0, 80.0, 70.0, 215.0, 570.0, 65.0, 25.0, 880.0, 30.0, 25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 45.0, 300.0, 0.0, 40.0, 20.0, 0.0, 410.0, 390.0, 5.0, 0.0, 0.0, 0.0, 210.0, 115.0, 5.0, 0.0, 10.0, 145.0, 20.0, 0.0, 0.0, 160.0, 20.0, 30.0, 30.0, 10.0, 0.0, 65.0, 0.0, 0.0, 45.0, 70.0, 880.0, 35.0, 250.0, 15.0, 125.0, 695.0, 60.0, 0.0, 80.0, 105.0, 120.0, 0.0, 25.0, 120.0, 30.0, 0.0, 90.0, 0.0, 905.0, 75.0, 0.0, 0.0, 0.0, 50.0, 600.0, 0.0, 20.0, 60.0, 80.0, 335.0, 0.0, 40.0, 55.0, 0.0, 10.0, 20.0, 15.0, 0.0, 0.0, 5.0, 155.0, 175.0, 555.0, 35.0, 0.0, 60.0, 120.0, 125.0, 30.0, 945.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7095213214960705, "mean_inference_ms": 1.6828917203374187, "mean_action_processing_ms": 0.27995882756747237, "mean_env_wait_ms": 0.19833695796109502, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037393569946289062, "StateBufferConnector_ms": 0.003274679183959961, "ViewRequirementAgentConnector_ms": 0.11118972301483154}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2690.0, "episode_return_mean": 34.01, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.39969130213053, "num_env_steps_trained_throughput_per_sec": 80.39969130213053, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 49622.061, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49621.999, "sample_time_ms": 1251.441, "learn_time_ms": 48352.146, "learn_throughput": 82.726, "synch_weights_time_ms": 15.664}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "ed30a_00000", "date": "2024-08-12_15-13-44", "timestamp": 1723490024, "time_this_iter_s": 49.80913424491882, "time_total_s": 3447.935874938965, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3447.935874938965, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 34.47464788732395, "ram_util_percent": 79.84366197183098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4204321947520373, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.4584146703992573, "policy_loss": -0.00610722836584996, "vf_loss": 2.464216223280266, "vf_explained_var": 0.0014874675601878494, "kl": 0.00815126095271782, "entropy": 0.8309664660660678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.553380668384057, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2137617622733745, "policy_loss": -0.013879206686073706, "vf_loss": 3.2269235752246996, "vf_explained_var": 0.018881969634818023, "kl": 0.009565246366870225, "entropy": 1.1438928311464016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2690.0, "episode_reward_mean": 4.45, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -118.45, "predator_policy": 120.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [94.0, 364.0, 253.0, 400.0, 390.0, 298.0, -142.0, 346.0, 171.0, -232.0, 328.0, 322.0, -415.0, -2487.0, 364.0, -104.0, 208.0, 400.0, 394.0, -1637.0, 370.0, 400.0, 400.0, 300.0, -1330.0, 365.0, 268.0, -646.0, 91.0, 292.0, 380.0, 346.0, 341.0, -69.0, 347.0, -1858.0, 370.0, 388.0, 400.0, 364.0, 388.0, -14.0, 352.0, 343.0, -835.0, 394.0, 400.0, 98.0, 394.0, -72.0, 365.0, 208.0, 384.0, 374.0, 322.0, 400.0, 284.0, -1963.0, 82.0, -1211.0, 328.0, 266.0, 256.0, 270.0, 364.0, 292.0, -2690.0, 400.0, 296.0, -595.0, 304.0, -98.0, 352.0, 334.0, 375.0, 382.0, 394.0, 81.0, -473.0, 328.0, 260.0, -1804.0, -2071.0, 322.0, 352.0, -224.0, 271.0, 400.0, 221.0, -2301.0, 133.0, -641.0, 370.0, 400.0, 400.0, 267.0, 382.0, 227.0, 400.0, 388.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [35.0, -141.0, 200.0, 134.0, 167.0, -9.0, 200.0, 200.0, 145.0, 200.0, 57.0, 156.0, -306.0, -141.0, 200.0, 101.0, -20.0, 46.0, -1142.0, 200.0, -42.0, 200.0, 167.0, 90.0, -2000.0, 200.0, -1769.0, -1648.0, 200.0, 134.0, -658.0, 134.0, 189.0, -141.0, 200.0, 200.0, 200.0, 189.0, -1791.0, -1076.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 178.0, 57.0, -1098.0, -1032.0, 200.0, 90.0, 200.0, -42.0, -504.0, -482.0, 2.0, -31.0, -53.0, 200.0, 145.0, 200.0, 200.0, 101.0, 200.0, -9.0, -1054.0, 200.0, 200.0, 57.0, -1560.0, -1208.0, 200.0, 145.0, 178.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 178.0, 101.0, -460.0, 189.0, 123.0, 167.0, 156.0, -647.0, -988.0, 189.0, 200.0, 200.0, 200.0, 24.0, -251.0, 200.0, 189.0, -141.0, -86.0, 156.0, 189.0, -152.0, 200.0, 200.0, 134.0, 200.0, 134.0, 200.0, 57.0, 200.0, 200.0, 200.0, -31.0, -1538.0, -1340.0, -350.0, 167.0, -999.0, -1032.0, 68.0, 200.0, 112.0, -31.0, 200.0, -64.0, -75.0, 200.0, 200.0, 134.0, 13.0, 189.0, -1890.0, -1780.0, 200.0, 200.0, 90.0, 156.0, -933.0, -262.0, 156.0, 68.0, -537.0, 24.0, 200.0, 112.0, 79.0, 200.0, 145.0, 200.0, 167.0, 200.0, 200.0, 189.0, -449.0, 200.0, -438.0, -625.0, 68.0, 200.0, 145.0, -130.0, -900.0, -1879.0, -1879.0, -1362.0, 178.0, 79.0, 200.0, 112.0, 200.0, -944.0, 46.0, 90.0, 200.0, 200.0, 2.0, -31.0, -1615.0, -1571.0, -163.0, 101.0, -163.0, -1978.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 68.0, 167.0, 200.0, -42.0, 134.0, 200.0, 200.0, 200.0, 178.0], "policy_predator_policy_reward": [0.0, 200.0, 30.0, 0.0, 90.0, 5.0, 0.0, 0.0, 20.0, 25.0, 20.0, 65.0, 285.0, 20.0, 45.0, 0.0, 50.0, 95.0, 280.0, 430.0, 70.0, 100.0, 15.0, 50.0, 1000.0, 385.0, 845.0, 85.0, 30.0, 0.0, 420.0, 0.0, 145.0, 15.0, 0.0, 0.0, 5.0, 0.0, 355.0, 875.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 65.0, 0.0, 195.0, 605.0, 50.0, 25.0, 50.0, 60.0, 310.0, 30.0, 0.0, 120.0, 30.0, 115.0, 25.0, 10.0, 25.0, 20.0, 80.0, 70.0, 215.0, 570.0, 65.0, 25.0, 880.0, 30.0, 25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 45.0, 300.0, 0.0, 40.0, 20.0, 0.0, 410.0, 390.0, 5.0, 0.0, 0.0, 0.0, 210.0, 115.0, 5.0, 0.0, 10.0, 145.0, 20.0, 0.0, 0.0, 160.0, 20.0, 30.0, 30.0, 10.0, 0.0, 65.0, 0.0, 0.0, 45.0, 70.0, 880.0, 35.0, 250.0, 15.0, 125.0, 695.0, 60.0, 0.0, 80.0, 105.0, 120.0, 0.0, 25.0, 120.0, 30.0, 0.0, 90.0, 0.0, 905.0, 75.0, 0.0, 0.0, 0.0, 50.0, 600.0, 0.0, 20.0, 60.0, 80.0, 335.0, 0.0, 40.0, 55.0, 0.0, 10.0, 20.0, 15.0, 0.0, 0.0, 5.0, 155.0, 175.0, 555.0, 35.0, 0.0, 60.0, 120.0, 125.0, 30.0, 945.0, 200.0, 970.0, 55.0, 10.0, 40.0, 0.0, 10.0, 510.0, 80.0, 55.0, 0.0, 0.0, 125.0, 125.0, 885.0, 0.0, 55.0, 140.0, 600.0, 900.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 0.0, 15.0, 105.0, 30.0, 0.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7092856199265376, "mean_inference_ms": 1.6818692250060414, "mean_action_processing_ms": 0.2798668419130195, "mean_env_wait_ms": 0.1982836324417123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038900375366210938, "StateBufferConnector_ms": 0.0032699108123779297, "ViewRequirementAgentConnector_ms": 0.11452138423919678}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2690.0, "episode_return_mean": 4.45, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.43238225884356, "num_env_steps_trained_throughput_per_sec": 81.43238225884356, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 49628.496, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49628.438, "sample_time_ms": 1253.576, "learn_time_ms": 48356.921, "learn_throughput": 82.718, "synch_weights_time_ms": 15.513}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "ed30a_00000", "date": "2024-08-12_15-14-33", "timestamp": 1723490073, "time_this_iter_s": 49.1551628112793, "time_total_s": 3497.091037750244, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a4d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3497.091037750244, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 34.61285714285715, "ram_util_percent": 79.68142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3081001738234173, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.1616064390177447, "policy_loss": -0.005459420091137487, "vf_loss": 2.166711440982011, "vf_explained_var": 0.0017785733654385521, "kl": 0.009451213239286257, "entropy": 0.8426554375224643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.206767933488523, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4373491624044994, "policy_loss": -0.011372548413940918, "vf_loss": 3.4481334469305773, "vf_explained_var": 0.012359293491121323, "kl": 0.00784349797868132, "entropy": 1.170595538111591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2690.0, "episode_reward_mean": -87.12, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 975.0}, "policy_reward_mean": {"prey_policy": -171.36, "predator_policy": 127.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, -1330.0, 365.0, 268.0, -646.0, 91.0, 292.0, 380.0, 346.0, 341.0, -69.0, 347.0, -1858.0, 370.0, 388.0, 400.0, 364.0, 388.0, -14.0, 352.0, 343.0, -835.0, 394.0, 400.0, 98.0, 394.0, -72.0, 365.0, 208.0, 384.0, 374.0, 322.0, 400.0, 284.0, -1963.0, 82.0, -1211.0, 328.0, 266.0, 256.0, 270.0, 364.0, 292.0, -2690.0, 400.0, 296.0, -595.0, 304.0, -98.0, 352.0, 334.0, 375.0, 382.0, 394.0, 81.0, -473.0, 328.0, 260.0, -1804.0, -2071.0, 322.0, 352.0, -224.0, 271.0, 400.0, 221.0, -2301.0, 133.0, -641.0, 370.0, 400.0, 400.0, 267.0, 382.0, 227.0, 400.0, 388.0, 400.0, 382.0, 314.0, -1747.0, -1947.0, 376.0, -2245.0, 239.0, 274.0, -1910.0, 382.0, 364.0, 310.0, 339.0, 340.0, 318.0, 400.0, -1789.0, 200.0, 364.0, 65.0, -2354.0, -1747.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.0, 57.0, -1098.0, -1032.0, 200.0, 90.0, 200.0, -42.0, -504.0, -482.0, 2.0, -31.0, -53.0, 200.0, 145.0, 200.0, 200.0, 101.0, 200.0, -9.0, -1054.0, 200.0, 200.0, 57.0, -1560.0, -1208.0, 200.0, 145.0, 178.0, 200.0, 200.0, 200.0, 134.0, 200.0, 200.0, 178.0, 101.0, -460.0, 189.0, 123.0, 167.0, 156.0, -647.0, -988.0, 189.0, 200.0, 200.0, 200.0, 24.0, -251.0, 200.0, 189.0, -141.0, -86.0, 156.0, 189.0, -152.0, 200.0, 200.0, 134.0, 200.0, 134.0, 200.0, 57.0, 200.0, 200.0, 200.0, -31.0, -1538.0, -1340.0, -350.0, 167.0, -999.0, -1032.0, 68.0, 200.0, 112.0, -31.0, 200.0, -64.0, -75.0, 200.0, 200.0, 134.0, 13.0, 189.0, -1890.0, -1780.0, 200.0, 200.0, 90.0, 156.0, -933.0, -262.0, 156.0, 68.0, -537.0, 24.0, 200.0, 112.0, 79.0, 200.0, 145.0, 200.0, 167.0, 200.0, 200.0, 189.0, -449.0, 200.0, -438.0, -625.0, 68.0, 200.0, 145.0, -130.0, -900.0, -1879.0, -1879.0, -1362.0, 178.0, 79.0, 200.0, 112.0, 200.0, -944.0, 46.0, 90.0, 200.0, 200.0, 2.0, -31.0, -1615.0, -1571.0, -163.0, 101.0, -163.0, -1978.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 68.0, 167.0, 200.0, -42.0, 134.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 167.0, 145.0, 134.0, -1153.0, -1384.0, -1285.0, -1527.0, 200.0, 156.0, -1549.0, -1681.0, 57.0, 2.0, 189.0, -20.0, -1604.0, -1296.0, 167.0, 200.0, 134.0, 200.0, 189.0, 46.0, 79.0, 200.0, 90.0, 200.0, 101.0, 167.0, 200.0, 200.0, -1692.0, -1197.0, 35.0, 90.0, 200.0, 134.0, -119.0, 24.0, -1923.0, -1406.0, -1725.0, -922.0], "policy_predator_policy_reward": [65.0, 0.0, 195.0, 605.0, 50.0, 25.0, 50.0, 60.0, 310.0, 30.0, 0.0, 120.0, 30.0, 115.0, 25.0, 10.0, 25.0, 20.0, 80.0, 70.0, 215.0, 570.0, 65.0, 25.0, 880.0, 30.0, 25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 45.0, 300.0, 0.0, 40.0, 20.0, 0.0, 410.0, 390.0, 5.0, 0.0, 0.0, 0.0, 210.0, 115.0, 5.0, 0.0, 10.0, 145.0, 20.0, 0.0, 0.0, 160.0, 20.0, 30.0, 30.0, 10.0, 0.0, 65.0, 0.0, 0.0, 45.0, 70.0, 880.0, 35.0, 250.0, 15.0, 125.0, 695.0, 60.0, 0.0, 80.0, 105.0, 120.0, 0.0, 25.0, 120.0, 30.0, 0.0, 90.0, 0.0, 905.0, 75.0, 0.0, 0.0, 0.0, 50.0, 600.0, 0.0, 20.0, 60.0, 80.0, 335.0, 0.0, 40.0, 55.0, 0.0, 10.0, 20.0, 15.0, 0.0, 0.0, 5.0, 155.0, 175.0, 555.0, 35.0, 0.0, 60.0, 120.0, 125.0, 30.0, 945.0, 200.0, 970.0, 55.0, 10.0, 40.0, 0.0, 10.0, 510.0, 80.0, 55.0, 0.0, 0.0, 125.0, 125.0, 885.0, 0.0, 55.0, 140.0, 600.0, 900.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 0.0, 15.0, 105.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 35.0, 0.0, 765.0, 25.0, 730.0, 135.0, 15.0, 5.0, 960.0, 25.0, 110.0, 70.0, 105.0, 0.0, 820.0, 170.0, 15.0, 0.0, 0.0, 30.0, 0.0, 75.0, 25.0, 35.0, 0.0, 50.0, 50.0, 0.0, 0.0, 0.0, 925.0, 175.0, 0.0, 75.0, 0.0, 30.0, 160.0, 0.0, 0.0, 975.0, 0.0, 900.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7080668519975596, "mean_inference_ms": 1.6779547182766357, "mean_action_processing_ms": 0.2794351261465878, "mean_env_wait_ms": 0.19794538284392643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006140947341918945, "StateBufferConnector_ms": 0.0036284923553466797, "ViewRequirementAgentConnector_ms": 0.10785090923309326}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2690.0, "episode_return_mean": -87.12, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.88190012797463, "num_env_steps_trained_throughput_per_sec": 81.88190012797463, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 49579.036, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49578.978, "sample_time_ms": 1252.8, "learn_time_ms": 48308.492, "learn_throughput": 82.801, "synch_weights_time_ms": 15.537}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "ed30a_00000", "date": "2024-08-12_15-15-22", "timestamp": 1723490122, "time_this_iter_s": 48.89341902732849, "time_total_s": 3545.9844567775726, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20a3940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3545.9844567775726, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 32.34347826086957, "ram_util_percent": 79.9304347826087}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2200037213387314, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7102277097878633, "policy_loss": -0.005910313890990678, "vf_loss": 2.7157452643233, "vf_explained_var": 0.002358372627742707, "kl": 0.010473431541211567, "entropy": 0.8867816645316977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.49079462081667, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.303763848637778, "policy_loss": -0.013594971831257224, "vf_loss": 4.316567663288621, "vf_explained_var": 0.013536346999425736, "kl": 0.010548666971389953, "entropy": 1.1137765094716714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2690.0, "episode_reward_mean": -169.73, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -227.24, "predator_policy": 142.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-14.0, 352.0, 343.0, -835.0, 394.0, 400.0, 98.0, 394.0, -72.0, 365.0, 208.0, 384.0, 374.0, 322.0, 400.0, 284.0, -1963.0, 82.0, -1211.0, 328.0, 266.0, 256.0, 270.0, 364.0, 292.0, -2690.0, 400.0, 296.0, -595.0, 304.0, -98.0, 352.0, 334.0, 375.0, 382.0, 394.0, 81.0, -473.0, 328.0, 260.0, -1804.0, -2071.0, 322.0, 352.0, -224.0, 271.0, 400.0, 221.0, -2301.0, 133.0, -641.0, 370.0, 400.0, 400.0, 267.0, 382.0, 227.0, 400.0, 388.0, 400.0, 382.0, 314.0, -1747.0, -1947.0, 376.0, -2245.0, 239.0, 274.0, -1910.0, 382.0, 364.0, 310.0, 339.0, 340.0, 318.0, 400.0, -1789.0, 200.0, 364.0, 65.0, -2354.0, -1747.0, 169.0, -81.0, 178.0, 353.0, 252.0, 370.0, -619.0, 400.0, 328.0, 5.0, -1867.0, -2226.0, 259.0, -1586.0, 358.0, -2444.0, 250.0, -1623.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.0, -460.0, 189.0, 123.0, 167.0, 156.0, -647.0, -988.0, 189.0, 200.0, 200.0, 200.0, 24.0, -251.0, 200.0, 189.0, -141.0, -86.0, 156.0, 189.0, -152.0, 200.0, 200.0, 134.0, 200.0, 134.0, 200.0, 57.0, 200.0, 200.0, 200.0, -31.0, -1538.0, -1340.0, -350.0, 167.0, -999.0, -1032.0, 68.0, 200.0, 112.0, -31.0, 200.0, -64.0, -75.0, 200.0, 200.0, 134.0, 13.0, 189.0, -1890.0, -1780.0, 200.0, 200.0, 90.0, 156.0, -933.0, -262.0, 156.0, 68.0, -537.0, 24.0, 200.0, 112.0, 79.0, 200.0, 145.0, 200.0, 167.0, 200.0, 200.0, 189.0, -449.0, 200.0, -438.0, -625.0, 68.0, 200.0, 145.0, -130.0, -900.0, -1879.0, -1879.0, -1362.0, 178.0, 79.0, 200.0, 112.0, 200.0, -944.0, 46.0, 90.0, 200.0, 200.0, 2.0, -31.0, -1615.0, -1571.0, -163.0, 101.0, -163.0, -1978.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 68.0, 167.0, 200.0, -42.0, 134.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 167.0, 145.0, 134.0, -1153.0, -1384.0, -1285.0, -1527.0, 200.0, 156.0, -1549.0, -1681.0, 57.0, 2.0, 189.0, -20.0, -1604.0, -1296.0, 167.0, 200.0, 134.0, 200.0, 189.0, 46.0, 79.0, 200.0, 90.0, 200.0, 101.0, 167.0, 200.0, 200.0, -1692.0, -1197.0, 35.0, 90.0, 200.0, 134.0, -119.0, 24.0, -1923.0, -1406.0, -1725.0, -922.0, -185.0, 134.0, -636.0, 145.0, 46.0, 57.0, 68.0, 200.0, 35.0, 112.0, 200.0, 145.0, -515.0, -449.0, 200.0, 200.0, 200.0, 68.0, 101.0, -416.0, -1956.0, -911.0, -1384.0, -1912.0, 24.0, 90.0, -1175.0, -1241.0, 123.0, 200.0, -1868.0, -1516.0, 200.0, -75.0, -1021.0, -1472.0], "policy_predator_policy_reward": [45.0, 300.0, 0.0, 40.0, 20.0, 0.0, 410.0, 390.0, 5.0, 0.0, 0.0, 0.0, 210.0, 115.0, 5.0, 0.0, 10.0, 145.0, 20.0, 0.0, 0.0, 160.0, 20.0, 30.0, 30.0, 10.0, 0.0, 65.0, 0.0, 0.0, 45.0, 70.0, 880.0, 35.0, 250.0, 15.0, 125.0, 695.0, 60.0, 0.0, 80.0, 105.0, 120.0, 0.0, 25.0, 120.0, 30.0, 0.0, 90.0, 0.0, 905.0, 75.0, 0.0, 0.0, 0.0, 50.0, 600.0, 0.0, 20.0, 60.0, 80.0, 335.0, 0.0, 40.0, 55.0, 0.0, 10.0, 20.0, 15.0, 0.0, 0.0, 5.0, 155.0, 175.0, 555.0, 35.0, 0.0, 60.0, 120.0, 125.0, 30.0, 945.0, 200.0, 970.0, 55.0, 10.0, 40.0, 0.0, 10.0, 510.0, 80.0, 55.0, 0.0, 0.0, 125.0, 125.0, 885.0, 0.0, 55.0, 140.0, 600.0, 900.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 0.0, 15.0, 105.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 35.0, 0.0, 765.0, 25.0, 730.0, 135.0, 15.0, 5.0, 960.0, 25.0, 110.0, 70.0, 105.0, 0.0, 820.0, 170.0, 15.0, 0.0, 0.0, 30.0, 0.0, 75.0, 25.0, 35.0, 0.0, 50.0, 50.0, 0.0, 0.0, 0.0, 925.0, 175.0, 0.0, 75.0, 0.0, 30.0, 160.0, 0.0, 0.0, 975.0, 0.0, 900.0, 20.0, 200.0, 380.0, 30.0, 5.0, 70.0, 25.0, 60.0, 40.0, 65.0, 0.0, 25.0, 345.0, 0.0, 0.0, 0.0, 60.0, 0.0, 320.0, 0.0, 980.0, 20.0, 880.0, 190.0, 110.0, 35.0, 655.0, 175.0, 30.0, 5.0, 0.0, 940.0, 15.0, 110.0, 870.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7075463806211417, "mean_inference_ms": 1.6761000363044727, "mean_action_processing_ms": 0.2791830954961555, "mean_env_wait_ms": 0.19782814488901265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006518363952636719, "StateBufferConnector_ms": 0.003579854965209961, "ViewRequirementAgentConnector_ms": 0.10310149192810059}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2690.0, "episode_return_mean": -169.73, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.19905665111727, "num_env_steps_trained_throughput_per_sec": 81.19905665111727, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 49624.27, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49624.215, "sample_time_ms": 1279.638, "learn_time_ms": 48327.869, "learn_throughput": 82.768, "synch_weights_time_ms": 14.454}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "ed30a_00000", "date": "2024-08-12_15-16-11", "timestamp": 1723490171, "time_this_iter_s": 49.33335304260254, "time_total_s": 3595.317809820175, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a9430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3595.317809820175, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 33.26571428571429, "ram_util_percent": 80.2742857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2513324460655293, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.9047241188861705, "policy_loss": -0.008271406453703998, "vf_loss": 2.9126639405886334, "vf_explained_var": 0.0016032567415287886, "kl": 0.008842344201728134, "entropy": 0.8283193800815198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4702337461804587, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.607235059536324, "policy_loss": -0.012691356273732645, "vf_loss": 4.619353044600714, "vf_explained_var": 0.013805331786473592, "kl": 0.007644915847827464, "entropy": 1.1474811722992588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2690.0, "episode_reward_mean": -192.19, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -244.62, "predator_policy": 148.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1211.0, 328.0, 266.0, 256.0, 270.0, 364.0, 292.0, -2690.0, 400.0, 296.0, -595.0, 304.0, -98.0, 352.0, 334.0, 375.0, 382.0, 394.0, 81.0, -473.0, 328.0, 260.0, -1804.0, -2071.0, 322.0, 352.0, -224.0, 271.0, 400.0, 221.0, -2301.0, 133.0, -641.0, 370.0, 400.0, 400.0, 267.0, 382.0, 227.0, 400.0, 388.0, 400.0, 382.0, 314.0, -1747.0, -1947.0, 376.0, -2245.0, 239.0, 274.0, -1910.0, 382.0, 364.0, 310.0, 339.0, 340.0, 318.0, 400.0, -1789.0, 200.0, 364.0, 65.0, -2354.0, -1747.0, 169.0, -81.0, 178.0, 353.0, 252.0, 370.0, -619.0, 400.0, 328.0, 5.0, -1867.0, -2226.0, 259.0, -1586.0, 358.0, -2444.0, 250.0, -1623.0, 230.0, -2628.0, -667.0, 58.0, 83.0, 358.0, 353.0, -1213.0, 248.0, 312.0, 380.0, 118.0, 400.0, 275.0, 203.0, 244.0, 322.0, 194.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-999.0, -1032.0, 68.0, 200.0, 112.0, -31.0, 200.0, -64.0, -75.0, 200.0, 200.0, 134.0, 13.0, 189.0, -1890.0, -1780.0, 200.0, 200.0, 90.0, 156.0, -933.0, -262.0, 156.0, 68.0, -537.0, 24.0, 200.0, 112.0, 79.0, 200.0, 145.0, 200.0, 167.0, 200.0, 200.0, 189.0, -449.0, 200.0, -438.0, -625.0, 68.0, 200.0, 145.0, -130.0, -900.0, -1879.0, -1879.0, -1362.0, 178.0, 79.0, 200.0, 112.0, 200.0, -944.0, 46.0, 90.0, 200.0, 200.0, 2.0, -31.0, -1615.0, -1571.0, -163.0, 101.0, -163.0, -1978.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 68.0, 167.0, 200.0, -42.0, 134.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 167.0, 145.0, 134.0, -1153.0, -1384.0, -1285.0, -1527.0, 200.0, 156.0, -1549.0, -1681.0, 57.0, 2.0, 189.0, -20.0, -1604.0, -1296.0, 167.0, 200.0, 134.0, 200.0, 189.0, 46.0, 79.0, 200.0, 90.0, 200.0, 101.0, 167.0, 200.0, 200.0, -1692.0, -1197.0, 35.0, 90.0, 200.0, 134.0, -119.0, 24.0, -1923.0, -1406.0, -1725.0, -922.0, -185.0, 134.0, -636.0, 145.0, 46.0, 57.0, 68.0, 200.0, 35.0, 112.0, 200.0, 145.0, -515.0, -449.0, 200.0, 200.0, 200.0, 68.0, 101.0, -416.0, -1956.0, -911.0, -1384.0, -1912.0, 24.0, 90.0, -1175.0, -1241.0, 123.0, 200.0, -1868.0, -1516.0, 200.0, -75.0, -1021.0, -1472.0, 90.0, 90.0, -1802.0, -1956.0, -372.0, -790.0, -86.0, -31.0, 200.0, -757.0, 123.0, 200.0, 189.0, 134.0, -889.0, -944.0, 167.0, -284.0, 200.0, 2.0, 200.0, 145.0, 68.0, -185.0, 200.0, 200.0, 2.0, 178.0, 68.0, 35.0, -53.0, 167.0, 134.0, 123.0, 200.0, -251.0], "policy_predator_policy_reward": [125.0, 695.0, 60.0, 0.0, 80.0, 105.0, 120.0, 0.0, 25.0, 120.0, 30.0, 0.0, 90.0, 0.0, 905.0, 75.0, 0.0, 0.0, 0.0, 50.0, 600.0, 0.0, 20.0, 60.0, 80.0, 335.0, 0.0, 40.0, 55.0, 0.0, 10.0, 20.0, 15.0, 0.0, 0.0, 5.0, 155.0, 175.0, 555.0, 35.0, 0.0, 60.0, 120.0, 125.0, 30.0, 945.0, 200.0, 970.0, 55.0, 10.0, 40.0, 0.0, 10.0, 510.0, 80.0, 55.0, 0.0, 0.0, 125.0, 125.0, 885.0, 0.0, 55.0, 140.0, 600.0, 900.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 0.0, 15.0, 105.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 35.0, 0.0, 765.0, 25.0, 730.0, 135.0, 15.0, 5.0, 960.0, 25.0, 110.0, 70.0, 105.0, 0.0, 820.0, 170.0, 15.0, 0.0, 0.0, 30.0, 0.0, 75.0, 25.0, 35.0, 0.0, 50.0, 50.0, 0.0, 0.0, 0.0, 925.0, 175.0, 0.0, 75.0, 0.0, 30.0, 160.0, 0.0, 0.0, 975.0, 0.0, 900.0, 20.0, 200.0, 380.0, 30.0, 5.0, 70.0, 25.0, 60.0, 40.0, 65.0, 0.0, 25.0, 345.0, 0.0, 0.0, 0.0, 60.0, 0.0, 320.0, 0.0, 980.0, 20.0, 880.0, 190.0, 110.0, 35.0, 655.0, 175.0, 30.0, 5.0, 0.0, 940.0, 15.0, 110.0, 870.0, 0.0, 50.0, 0.0, 995.0, 135.0, 495.0, 0.0, 35.0, 140.0, 315.0, 325.0, 35.0, 0.0, 0.0, 30.0, 520.0, 100.0, 220.0, 145.0, 45.0, 65.0, 20.0, 15.0, 175.0, 60.0, 0.0, 0.0, 10.0, 85.0, 100.0, 0.0, 15.0, 115.0, 65.0, 0.0, 145.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.707342487528536, "mean_inference_ms": 1.6748037300784768, "mean_action_processing_ms": 0.2790035720771467, "mean_env_wait_ms": 0.19780546323099796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007117867469787598, "StateBufferConnector_ms": 0.0035010576248168945, "ViewRequirementAgentConnector_ms": 0.10276985168457031}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2690.0, "episode_return_mean": -192.19, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.80247446131324, "num_env_steps_trained_throughput_per_sec": 79.80247446131324, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 49435.649, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49435.583, "sample_time_ms": 1272.435, "learn_time_ms": 48146.273, "learn_throughput": 83.08, "synch_weights_time_ms": 14.182}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "ed30a_00000", "date": "2024-08-12_15-17-01", "timestamp": 1723490221, "time_this_iter_s": 50.16103005409241, "time_total_s": 3645.4788398742676, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b012baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3645.4788398742676, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 37.244285714285716, "ram_util_percent": 81.02142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1824567734091371, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.748510271783859, "policy_loss": -0.007755997759984836, "vf_loss": 3.7557583019216225, "vf_explained_var": 0.0009710736060268664, "kl": 0.013545557699302485, "entropy": 0.8348373697548316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.882305185946207, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.411956409802513, "policy_loss": -0.013140292368366053, "vf_loss": 5.424361803922704, "vf_explained_var": 0.01281193009129277, "kl": 0.009798642277742808, "entropy": 1.1242065858588648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2628.0, "episode_reward_mean": -379.31, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1978.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -376.455, "predator_policy": 186.8}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1804.0, -2071.0, 322.0, 352.0, -224.0, 271.0, 400.0, 221.0, -2301.0, 133.0, -641.0, 370.0, 400.0, 400.0, 267.0, 382.0, 227.0, 400.0, 388.0, 400.0, 382.0, 314.0, -1747.0, -1947.0, 376.0, -2245.0, 239.0, 274.0, -1910.0, 382.0, 364.0, 310.0, 339.0, 340.0, 318.0, 400.0, -1789.0, 200.0, 364.0, 65.0, -2354.0, -1747.0, 169.0, -81.0, 178.0, 353.0, 252.0, 370.0, -619.0, 400.0, 328.0, 5.0, -1867.0, -2226.0, 259.0, -1586.0, 358.0, -2444.0, 250.0, -1623.0, 230.0, -2628.0, -667.0, 58.0, 83.0, 358.0, 353.0, -1213.0, 248.0, 312.0, 380.0, 118.0, 400.0, 275.0, 203.0, 244.0, 322.0, 194.0, -1180.0, 250.0, 370.0, -1670.0, -1723.0, 400.0, -2285.0, -1826.0, 334.0, 34.0, -861.0, -2080.0, 190.0, -2264.0, -1301.0, 337.0, -2142.0, 116.0, -1722.0, 400.0, -1502.0, -372.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-900.0, -1879.0, -1879.0, -1362.0, 178.0, 79.0, 200.0, 112.0, 200.0, -944.0, 46.0, 90.0, 200.0, 200.0, 2.0, -31.0, -1615.0, -1571.0, -163.0, 101.0, -163.0, -1978.0, 200.0, 145.0, 200.0, 200.0, 200.0, 200.0, 79.0, 68.0, 167.0, 200.0, -42.0, 134.0, 200.0, 200.0, 200.0, 178.0, 200.0, 200.0, 200.0, 167.0, 145.0, 134.0, -1153.0, -1384.0, -1285.0, -1527.0, 200.0, 156.0, -1549.0, -1681.0, 57.0, 2.0, 189.0, -20.0, -1604.0, -1296.0, 167.0, 200.0, 134.0, 200.0, 189.0, 46.0, 79.0, 200.0, 90.0, 200.0, 101.0, 167.0, 200.0, 200.0, -1692.0, -1197.0, 35.0, 90.0, 200.0, 134.0, -119.0, 24.0, -1923.0, -1406.0, -1725.0, -922.0, -185.0, 134.0, -636.0, 145.0, 46.0, 57.0, 68.0, 200.0, 35.0, 112.0, 200.0, 145.0, -515.0, -449.0, 200.0, 200.0, 200.0, 68.0, 101.0, -416.0, -1956.0, -911.0, -1384.0, -1912.0, 24.0, 90.0, -1175.0, -1241.0, 123.0, 200.0, -1868.0, -1516.0, 200.0, -75.0, -1021.0, -1472.0, 90.0, 90.0, -1802.0, -1956.0, -372.0, -790.0, -86.0, -31.0, 200.0, -757.0, 123.0, 200.0, 189.0, 134.0, -889.0, -944.0, 167.0, -284.0, 200.0, 2.0, 200.0, 145.0, 68.0, -185.0, 200.0, 200.0, 2.0, 178.0, 68.0, 35.0, -53.0, 167.0, 134.0, 123.0, 200.0, -251.0, -1241.0, -669.0, 79.0, 46.0, 200.0, 145.0, -1241.0, -1494.0, -1593.0, -1230.0, 200.0, 200.0, -1549.0, -1571.0, -1252.0, -1384.0, 112.0, 167.0, 112.0, -383.0, -152.0, -1549.0, -1846.0, -1164.0, 156.0, -141.0, -1824.0, -1780.0, -1021.0, -1010.0, 167.0, 145.0, -1791.0, -1296.0, -130.0, -9.0, -1285.0, -1472.0, 200.0, 200.0, -1043.0, -1384.0, -306.0, -416.0], "policy_predator_policy_reward": [30.0, 945.0, 200.0, 970.0, 55.0, 10.0, 40.0, 0.0, 10.0, 510.0, 80.0, 55.0, 0.0, 0.0, 125.0, 125.0, 885.0, 0.0, 55.0, 140.0, 600.0, 900.0, 0.0, 25.0, 0.0, 0.0, 0.0, 0.0, 70.0, 50.0, 0.0, 15.0, 105.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 35.0, 0.0, 765.0, 25.0, 730.0, 135.0, 15.0, 5.0, 960.0, 25.0, 110.0, 70.0, 105.0, 0.0, 820.0, 170.0, 15.0, 0.0, 0.0, 30.0, 0.0, 75.0, 25.0, 35.0, 0.0, 50.0, 50.0, 0.0, 0.0, 0.0, 925.0, 175.0, 0.0, 75.0, 0.0, 30.0, 160.0, 0.0, 0.0, 975.0, 0.0, 900.0, 20.0, 200.0, 380.0, 30.0, 5.0, 70.0, 25.0, 60.0, 40.0, 65.0, 0.0, 25.0, 345.0, 0.0, 0.0, 0.0, 60.0, 0.0, 320.0, 0.0, 980.0, 20.0, 880.0, 190.0, 110.0, 35.0, 655.0, 175.0, 30.0, 5.0, 0.0, 940.0, 15.0, 110.0, 870.0, 0.0, 50.0, 0.0, 995.0, 135.0, 495.0, 0.0, 35.0, 140.0, 315.0, 325.0, 35.0, 0.0, 0.0, 30.0, 520.0, 100.0, 220.0, 145.0, 45.0, 65.0, 20.0, 15.0, 175.0, 60.0, 0.0, 0.0, 10.0, 85.0, 100.0, 0.0, 15.0, 115.0, 65.0, 0.0, 145.0, 100.0, 730.0, 0.0, 0.0, 125.0, 25.0, 0.0, 140.0, 925.0, 205.0, 895.0, 0.0, 0.0, 835.0, 0.0, 730.0, 80.0, 40.0, 15.0, 40.0, 265.0, 795.0, 45.0, 0.0, 930.0, 20.0, 155.0, 930.0, 410.0, 10.0, 720.0, 0.0, 25.0, 45.0, 900.0, 110.0, 145.0, 815.0, 220.0, 0.0, 0.0, 55.0, 870.0, 40.0, 310.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7068697809569163, "mean_inference_ms": 1.6725983093342915, "mean_action_processing_ms": 0.2787521314350576, "mean_env_wait_ms": 0.197741479010448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007942795753479004, "StateBufferConnector_ms": 0.0037305355072021484, "ViewRequirementAgentConnector_ms": 0.10792851448059082}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2628.0, "episode_return_mean": -379.31, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.19407983514853, "num_env_steps_trained_throughput_per_sec": 79.19407983514853, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 49497.724, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49497.658, "sample_time_ms": 1283.806, "learn_time_ms": 48196.749, "learn_throughput": 82.993, "synch_weights_time_ms": 14.703}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "ed30a_00000", "date": "2024-08-12_15-17-52", "timestamp": 1723490272, "time_this_iter_s": 50.54604482650757, "time_total_s": 3696.024884700775, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1627dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3696.024884700775, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 37.74166666666667, "ram_util_percent": 81.25972222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2762288927716552, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4724350419624774, "policy_loss": -0.008295177174337878, "vf_loss": 3.4802369231269474, "vf_explained_var": 0.0005758382655956127, "kl": 0.013154715474992366, "entropy": 0.8962468930653164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.646135702524235, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7223584249536827, "policy_loss": -0.012921499893828122, "vf_loss": 3.7346194354314655, "vf_explained_var": 0.015519521665320826, "kl": 0.008806301431337565, "entropy": 1.137963508991968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2628.0, "episode_reward_mean": -338.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -357.535, "predator_policy": 188.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1947.0, 376.0, -2245.0, 239.0, 274.0, -1910.0, 382.0, 364.0, 310.0, 339.0, 340.0, 318.0, 400.0, -1789.0, 200.0, 364.0, 65.0, -2354.0, -1747.0, 169.0, -81.0, 178.0, 353.0, 252.0, 370.0, -619.0, 400.0, 328.0, 5.0, -1867.0, -2226.0, 259.0, -1586.0, 358.0, -2444.0, 250.0, -1623.0, 230.0, -2628.0, -667.0, 58.0, 83.0, 358.0, 353.0, -1213.0, 248.0, 312.0, 380.0, 118.0, 400.0, 275.0, 203.0, 244.0, 322.0, 194.0, -1180.0, 250.0, 370.0, -1670.0, -1723.0, 400.0, -2285.0, -1826.0, 334.0, 34.0, -861.0, -2080.0, 190.0, -2264.0, -1301.0, 337.0, -2142.0, 116.0, -1722.0, 400.0, -1502.0, -372.0, 240.0, 262.0, 358.0, 334.0, 208.0, 60.0, 341.0, 42.0, 388.0, 40.0, 298.0, 179.0, -1140.0, -299.0, 238.0, 225.0, -2152.0, 285.0, 364.0, 310.0, 297.0, -188.0, 200.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1285.0, -1527.0, 200.0, 156.0, -1549.0, -1681.0, 57.0, 2.0, 189.0, -20.0, -1604.0, -1296.0, 167.0, 200.0, 134.0, 200.0, 189.0, 46.0, 79.0, 200.0, 90.0, 200.0, 101.0, 167.0, 200.0, 200.0, -1692.0, -1197.0, 35.0, 90.0, 200.0, 134.0, -119.0, 24.0, -1923.0, -1406.0, -1725.0, -922.0, -185.0, 134.0, -636.0, 145.0, 46.0, 57.0, 68.0, 200.0, 35.0, 112.0, 200.0, 145.0, -515.0, -449.0, 200.0, 200.0, 200.0, 68.0, 101.0, -416.0, -1956.0, -911.0, -1384.0, -1912.0, 24.0, 90.0, -1175.0, -1241.0, 123.0, 200.0, -1868.0, -1516.0, 200.0, -75.0, -1021.0, -1472.0, 90.0, 90.0, -1802.0, -1956.0, -372.0, -790.0, -86.0, -31.0, 200.0, -757.0, 123.0, 200.0, 189.0, 134.0, -889.0, -944.0, 167.0, -284.0, 200.0, 2.0, 200.0, 145.0, 68.0, -185.0, 200.0, 200.0, 2.0, 178.0, 68.0, 35.0, -53.0, 167.0, 134.0, 123.0, 200.0, -251.0, -1241.0, -669.0, 79.0, 46.0, 200.0, 145.0, -1241.0, -1494.0, -1593.0, -1230.0, 200.0, 200.0, -1549.0, -1571.0, -1252.0, -1384.0, 112.0, 167.0, 112.0, -383.0, -152.0, -1549.0, -1846.0, -1164.0, 156.0, -141.0, -1824.0, -1780.0, -1021.0, -1010.0, 167.0, 145.0, -1791.0, -1296.0, -130.0, -9.0, -1285.0, -1472.0, 200.0, 200.0, -1043.0, -1384.0, -306.0, -416.0, 145.0, -240.0, 101.0, 46.0, -97.0, 200.0, 189.0, 90.0, 200.0, -152.0, -317.0, 112.0, 46.0, 200.0, -108.0, -130.0, 178.0, 200.0, -339.0, 79.0, 68.0, 145.0, -306.0, 200.0, -1021.0, -1714.0, -713.0, -86.0, -42.0, 145.0, 200.0, -240.0, -1769.0, -1703.0, -20.0, 200.0, 200.0, 134.0, 167.0, 68.0, 145.0, 112.0, -812.0, 134.0, 200.0, -350.0], "policy_predator_policy_reward": [730.0, 135.0, 15.0, 5.0, 960.0, 25.0, 110.0, 70.0, 105.0, 0.0, 820.0, 170.0, 15.0, 0.0, 0.0, 30.0, 0.0, 75.0, 25.0, 35.0, 0.0, 50.0, 50.0, 0.0, 0.0, 0.0, 925.0, 175.0, 0.0, 75.0, 0.0, 30.0, 160.0, 0.0, 0.0, 975.0, 0.0, 900.0, 20.0, 200.0, 380.0, 30.0, 5.0, 70.0, 25.0, 60.0, 40.0, 65.0, 0.0, 25.0, 345.0, 0.0, 0.0, 0.0, 60.0, 0.0, 320.0, 0.0, 980.0, 20.0, 880.0, 190.0, 110.0, 35.0, 655.0, 175.0, 30.0, 5.0, 0.0, 940.0, 15.0, 110.0, 870.0, 0.0, 50.0, 0.0, 995.0, 135.0, 495.0, 0.0, 35.0, 140.0, 315.0, 325.0, 35.0, 0.0, 0.0, 30.0, 520.0, 100.0, 220.0, 145.0, 45.0, 65.0, 20.0, 15.0, 175.0, 60.0, 0.0, 0.0, 10.0, 85.0, 100.0, 0.0, 15.0, 115.0, 65.0, 0.0, 145.0, 100.0, 730.0, 0.0, 0.0, 125.0, 25.0, 0.0, 140.0, 925.0, 205.0, 895.0, 0.0, 0.0, 835.0, 0.0, 730.0, 80.0, 40.0, 15.0, 40.0, 265.0, 795.0, 45.0, 0.0, 930.0, 20.0, 155.0, 930.0, 410.0, 10.0, 720.0, 0.0, 25.0, 45.0, 900.0, 110.0, 145.0, 815.0, 220.0, 0.0, 0.0, 55.0, 870.0, 40.0, 310.0, 180.0, 155.0, 70.0, 45.0, 135.0, 120.0, 50.0, 5.0, 0.0, 160.0, 90.0, 175.0, 70.0, 25.0, 95.0, 185.0, 10.0, 0.0, 55.0, 245.0, 25.0, 60.0, 145.0, 140.0, 760.0, 835.0, 500.0, 0.0, 25.0, 110.0, 85.0, 180.0, 325.0, 995.0, 100.0, 5.0, 30.0, 0.0, 40.0, 35.0, 0.0, 40.0, 460.0, 30.0, 140.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7063028348859303, "mean_inference_ms": 1.6717052863953143, "mean_action_processing_ms": 0.2785977553477018, "mean_env_wait_ms": 0.19770247479362507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008297443389892578, "StateBufferConnector_ms": 0.003788471221923828, "ViewRequirementAgentConnector_ms": 0.11430418491363525}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2628.0, "episode_return_mean": -338.82, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.04051729079393, "num_env_steps_trained_throughput_per_sec": 79.04051729079393, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 49696.062, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49695.995, "sample_time_ms": 1328.546, "learn_time_ms": 48350.301, "learn_throughput": 82.73, "synch_weights_time_ms": 14.735}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "ed30a_00000", "date": "2024-08-12_15-18-43", "timestamp": 1723490323, "time_this_iter_s": 50.638916015625, "time_total_s": 3746.6638007164, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1637b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3746.6638007164, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 36.56666666666667, "ram_util_percent": 82.39166666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4066483351604018, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.82974928661629, "policy_loss": -0.009803351978943855, "vf_loss": 4.839077821484318, "vf_explained_var": 0.0005789121622761721, "kl": 0.012662094512963707, "entropy": 0.8226360748684596, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.053264258494453, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.383964994470909, "policy_loss": -0.013480798254853913, "vf_loss": 6.396717010225569, "vf_explained_var": 0.01102289425002204, "kl": 0.009716889299577139, "entropy": 1.188561369565429, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2628.0, "episode_reward_mean": -394.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -409.345, "predator_policy": 211.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1747.0, 169.0, -81.0, 178.0, 353.0, 252.0, 370.0, -619.0, 400.0, 328.0, 5.0, -1867.0, -2226.0, 259.0, -1586.0, 358.0, -2444.0, 250.0, -1623.0, 230.0, -2628.0, -667.0, 58.0, 83.0, 358.0, 353.0, -1213.0, 248.0, 312.0, 380.0, 118.0, 400.0, 275.0, 203.0, 244.0, 322.0, 194.0, -1180.0, 250.0, 370.0, -1670.0, -1723.0, 400.0, -2285.0, -1826.0, 334.0, 34.0, -861.0, -2080.0, 190.0, -2264.0, -1301.0, 337.0, -2142.0, 116.0, -1722.0, 400.0, -1502.0, -372.0, 240.0, 262.0, 358.0, 334.0, 208.0, 60.0, 341.0, 42.0, 388.0, 40.0, 298.0, 179.0, -1140.0, -299.0, 238.0, 225.0, -2152.0, 285.0, 364.0, 310.0, 297.0, -188.0, 200.0, 400.0, 16.0, -98.0, -1915.0, 76.0, -1771.0, -2068.0, 33.0, -1990.0, -203.0, -173.0, 328.0, 400.0, -200.0, 208.0, -2086.0, -1124.0, -1709.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1725.0, -922.0, -185.0, 134.0, -636.0, 145.0, 46.0, 57.0, 68.0, 200.0, 35.0, 112.0, 200.0, 145.0, -515.0, -449.0, 200.0, 200.0, 200.0, 68.0, 101.0, -416.0, -1956.0, -911.0, -1384.0, -1912.0, 24.0, 90.0, -1175.0, -1241.0, 123.0, 200.0, -1868.0, -1516.0, 200.0, -75.0, -1021.0, -1472.0, 90.0, 90.0, -1802.0, -1956.0, -372.0, -790.0, -86.0, -31.0, 200.0, -757.0, 123.0, 200.0, 189.0, 134.0, -889.0, -944.0, 167.0, -284.0, 200.0, 2.0, 200.0, 145.0, 68.0, -185.0, 200.0, 200.0, 2.0, 178.0, 68.0, 35.0, -53.0, 167.0, 134.0, 123.0, 200.0, -251.0, -1241.0, -669.0, 79.0, 46.0, 200.0, 145.0, -1241.0, -1494.0, -1593.0, -1230.0, 200.0, 200.0, -1549.0, -1571.0, -1252.0, -1384.0, 112.0, 167.0, 112.0, -383.0, -152.0, -1549.0, -1846.0, -1164.0, 156.0, -141.0, -1824.0, -1780.0, -1021.0, -1010.0, 167.0, 145.0, -1791.0, -1296.0, -130.0, -9.0, -1285.0, -1472.0, 200.0, 200.0, -1043.0, -1384.0, -306.0, -416.0, 145.0, -240.0, 101.0, 46.0, -97.0, 200.0, 189.0, 90.0, 200.0, -152.0, -317.0, 112.0, 46.0, 200.0, -108.0, -130.0, 178.0, 200.0, -339.0, 79.0, 68.0, 145.0, -306.0, 200.0, -1021.0, -1714.0, -713.0, -86.0, -42.0, 145.0, 200.0, -240.0, -1769.0, -1703.0, -20.0, 200.0, 200.0, 134.0, 167.0, 68.0, 145.0, 112.0, -812.0, 134.0, 200.0, -350.0, 200.0, 200.0, -9.0, -130.0, -284.0, -229.0, -1406.0, -1439.0, 200.0, -394.0, -1505.0, -1131.0, -1626.0, -1857.0, -438.0, 156.0, -1373.0, -1417.0, 200.0, -1098.0, -669.0, 46.0, 123.0, 145.0, 200.0, 200.0, 2.0, -592.0, -152.0, 200.0, -1901.0, -1835.0, -746.0, -1043.0, -1505.0, -1494.0], "policy_predator_policy_reward": [0.0, 900.0, 20.0, 200.0, 380.0, 30.0, 5.0, 70.0, 25.0, 60.0, 40.0, 65.0, 0.0, 25.0, 345.0, 0.0, 0.0, 0.0, 60.0, 0.0, 320.0, 0.0, 980.0, 20.0, 880.0, 190.0, 110.0, 35.0, 655.0, 175.0, 30.0, 5.0, 0.0, 940.0, 15.0, 110.0, 870.0, 0.0, 50.0, 0.0, 995.0, 135.0, 495.0, 0.0, 35.0, 140.0, 315.0, 325.0, 35.0, 0.0, 0.0, 30.0, 520.0, 100.0, 220.0, 145.0, 45.0, 65.0, 20.0, 15.0, 175.0, 60.0, 0.0, 0.0, 10.0, 85.0, 100.0, 0.0, 15.0, 115.0, 65.0, 0.0, 145.0, 100.0, 730.0, 0.0, 0.0, 125.0, 25.0, 0.0, 140.0, 925.0, 205.0, 895.0, 0.0, 0.0, 835.0, 0.0, 730.0, 80.0, 40.0, 15.0, 40.0, 265.0, 795.0, 45.0, 0.0, 930.0, 20.0, 155.0, 930.0, 410.0, 10.0, 720.0, 0.0, 25.0, 45.0, 900.0, 110.0, 145.0, 815.0, 220.0, 0.0, 0.0, 55.0, 870.0, 40.0, 310.0, 180.0, 155.0, 70.0, 45.0, 135.0, 120.0, 50.0, 5.0, 0.0, 160.0, 90.0, 175.0, 70.0, 25.0, 95.0, 185.0, 10.0, 0.0, 55.0, 245.0, 25.0, 60.0, 145.0, 140.0, 760.0, 835.0, 500.0, 0.0, 25.0, 110.0, 85.0, 180.0, 325.0, 995.0, 100.0, 5.0, 30.0, 0.0, 40.0, 35.0, 0.0, 40.0, 460.0, 30.0, 140.0, 210.0, 0.0, 0.0, 100.0, 55.0, 250.0, 165.0, 50.0, 880.0, 270.0, 0.0, 150.0, 715.0, 935.0, 480.0, 5.0, 310.0, 0.0, 800.0, 590.0, 105.0, 290.0, 160.0, 25.0, 35.0, 0.0, 0.0, 385.0, 5.0, 160.0, 0.0, 945.0, 705.0, 580.0, 85.0, 410.0, 880.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7071511029082542, "mean_inference_ms": 1.6709941418294665, "mean_action_processing_ms": 0.27862405432108256, "mean_env_wait_ms": 0.19789357363302787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006050467491149902, "StateBufferConnector_ms": 0.003764510154724121, "ViewRequirementAgentConnector_ms": 0.11228573322296143}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2628.0, "episode_return_mean": -394.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.56985923877163, "num_env_steps_trained_throughput_per_sec": 80.56985923877163, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 49630.02, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49629.951, "sample_time_ms": 1280.834, "learn_time_ms": 48332.186, "learn_throughput": 82.761, "synch_weights_time_ms": 14.516}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "ed30a_00000", "date": "2024-08-12_15-19-32", "timestamp": 1723490372, "time_this_iter_s": 49.69092273712158, "time_total_s": 3796.3547234535217, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00b81f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3796.3547234535217, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 34.370000000000005, "ram_util_percent": 82.05428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4166927738006783, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.782289637459649, "policy_loss": -0.007656522486457434, "vf_loss": 5.789604505407747, "vf_explained_var": 0.00032247017931055137, "kl": 0.009110669587263295, "entropy": 0.7556722884455686, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2520289004795133, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.726376675550269, "policy_loss": -0.016560444306020463, "vf_loss": 7.742021661334568, "vf_explained_var": 0.011430721371262161, "kl": 0.012206256631710974, "entropy": 1.2057506095164667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2628.0, "episode_reward_mean": -475.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1956.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -490.91, "predator_policy": 253.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1623.0, 230.0, -2628.0, -667.0, 58.0, 83.0, 358.0, 353.0, -1213.0, 248.0, 312.0, 380.0, 118.0, 400.0, 275.0, 203.0, 244.0, 322.0, 194.0, -1180.0, 250.0, 370.0, -1670.0, -1723.0, 400.0, -2285.0, -1826.0, 334.0, 34.0, -861.0, -2080.0, 190.0, -2264.0, -1301.0, 337.0, -2142.0, 116.0, -1722.0, 400.0, -1502.0, -372.0, 240.0, 262.0, 358.0, 334.0, 208.0, 60.0, 341.0, 42.0, 388.0, 40.0, 298.0, 179.0, -1140.0, -299.0, 238.0, 225.0, -2152.0, 285.0, 364.0, 310.0, 297.0, -188.0, 200.0, 400.0, 16.0, -98.0, -1915.0, 76.0, -1771.0, -2068.0, 33.0, -1990.0, -203.0, -173.0, 328.0, 400.0, -200.0, 208.0, -2086.0, -1124.0, -1709.0, -1201.0, -1565.0, -1057.0, -814.0, -2052.0, -784.0, -2018.0, -558.0, -403.0, -1249.0, -1655.0, -332.0, -1278.0, -785.0, 382.0, -650.0, 376.0, -98.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1021.0, -1472.0, 90.0, 90.0, -1802.0, -1956.0, -372.0, -790.0, -86.0, -31.0, 200.0, -757.0, 123.0, 200.0, 189.0, 134.0, -889.0, -944.0, 167.0, -284.0, 200.0, 2.0, 200.0, 145.0, 68.0, -185.0, 200.0, 200.0, 2.0, 178.0, 68.0, 35.0, -53.0, 167.0, 134.0, 123.0, 200.0, -251.0, -1241.0, -669.0, 79.0, 46.0, 200.0, 145.0, -1241.0, -1494.0, -1593.0, -1230.0, 200.0, 200.0, -1549.0, -1571.0, -1252.0, -1384.0, 112.0, 167.0, 112.0, -383.0, -152.0, -1549.0, -1846.0, -1164.0, 156.0, -141.0, -1824.0, -1780.0, -1021.0, -1010.0, 167.0, 145.0, -1791.0, -1296.0, -130.0, -9.0, -1285.0, -1472.0, 200.0, 200.0, -1043.0, -1384.0, -306.0, -416.0, 145.0, -240.0, 101.0, 46.0, -97.0, 200.0, 189.0, 90.0, 200.0, -152.0, -317.0, 112.0, 46.0, 200.0, -108.0, -130.0, 178.0, 200.0, -339.0, 79.0, 68.0, 145.0, -306.0, 200.0, -1021.0, -1714.0, -713.0, -86.0, -42.0, 145.0, 200.0, -240.0, -1769.0, -1703.0, -20.0, 200.0, 200.0, 134.0, 167.0, 68.0, 145.0, 112.0, -812.0, 134.0, 200.0, -350.0, 200.0, 200.0, -9.0, -130.0, -284.0, -229.0, -1406.0, -1439.0, 200.0, -394.0, -1505.0, -1131.0, -1626.0, -1857.0, -438.0, 156.0, -1373.0, -1417.0, 200.0, -1098.0, -669.0, 46.0, 123.0, 145.0, 200.0, 200.0, 2.0, -592.0, -152.0, 200.0, -1901.0, -1835.0, -746.0, -1043.0, -1505.0, -1494.0, -702.0, -1219.0, -834.0, -1681.0, -1516.0, -1186.0, -482.0, -922.0, -1758.0, -1219.0, -1153.0, -471.0, -1285.0, -1648.0, -691.0, -1087.0, -526.0, -977.0, -1406.0, -1208.0, -1197.0, -1483.0, -768.0, -64.0, -911.0, -1142.0, -1263.0, -537.0, 167.0, 200.0, 68.0, -1593.0, 156.0, 200.0, -284.0, -229.0], "policy_predator_policy_reward": [870.0, 0.0, 50.0, 0.0, 995.0, 135.0, 495.0, 0.0, 35.0, 140.0, 315.0, 325.0, 35.0, 0.0, 0.0, 30.0, 520.0, 100.0, 220.0, 145.0, 45.0, 65.0, 20.0, 15.0, 175.0, 60.0, 0.0, 0.0, 10.0, 85.0, 100.0, 0.0, 15.0, 115.0, 65.0, 0.0, 145.0, 100.0, 730.0, 0.0, 0.0, 125.0, 25.0, 0.0, 140.0, 925.0, 205.0, 895.0, 0.0, 0.0, 835.0, 0.0, 730.0, 80.0, 40.0, 15.0, 40.0, 265.0, 795.0, 45.0, 0.0, 930.0, 20.0, 155.0, 930.0, 410.0, 10.0, 720.0, 0.0, 25.0, 45.0, 900.0, 110.0, 145.0, 815.0, 220.0, 0.0, 0.0, 55.0, 870.0, 40.0, 310.0, 180.0, 155.0, 70.0, 45.0, 135.0, 120.0, 50.0, 5.0, 0.0, 160.0, 90.0, 175.0, 70.0, 25.0, 95.0, 185.0, 10.0, 0.0, 55.0, 245.0, 25.0, 60.0, 145.0, 140.0, 760.0, 835.0, 500.0, 0.0, 25.0, 110.0, 85.0, 180.0, 325.0, 995.0, 100.0, 5.0, 30.0, 0.0, 40.0, 35.0, 0.0, 40.0, 460.0, 30.0, 140.0, 210.0, 0.0, 0.0, 100.0, 55.0, 250.0, 165.0, 50.0, 880.0, 270.0, 0.0, 150.0, 715.0, 935.0, 480.0, 5.0, 310.0, 0.0, 800.0, 590.0, 105.0, 290.0, 160.0, 25.0, 35.0, 0.0, 0.0, 385.0, 5.0, 160.0, 0.0, 945.0, 705.0, 580.0, 85.0, 410.0, 880.0, 0.0, 720.0, 905.0, 45.0, 825.0, 820.0, 0.0, 590.0, 890.0, 35.0, 115.0, 725.0, 65.0, 850.0, 665.0, 555.0, 560.0, 540.0, 620.0, 745.0, 315.0, 710.0, 500.0, 0.0, 725.0, 50.0, 175.0, 840.0, 15.0, 0.0, 50.0, 825.0, 20.0, 0.0, 415.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7069467942755469, "mean_inference_ms": 1.6697044161471706, "mean_action_processing_ms": 0.27854311181249025, "mean_env_wait_ms": 0.19790218824425673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00579833984375, "StateBufferConnector_ms": 0.0037364959716796875, "ViewRequirementAgentConnector_ms": 0.11528635025024414}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2628.0, "episode_return_mean": -475.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.32681460391099, "num_env_steps_trained_throughput_per_sec": 81.32681460391099, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 49615.224, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49615.154, "sample_time_ms": 1285.507, "learn_time_ms": 48312.865, "learn_throughput": 82.794, "synch_weights_time_ms": 14.462}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "ed30a_00000", "date": "2024-08-12_15-20-21", "timestamp": 1723490421, "time_this_iter_s": 49.21117091178894, "time_total_s": 3845.5658943653107, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1637ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3845.5658943653107, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 34.41014492753622, "ram_util_percent": 82.06376811594204}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4399667279430168, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.954032853923778, "policy_loss": -0.007944874440088238, "vf_loss": 4.961615686315708, "vf_explained_var": -6.206183837204383e-05, "kl": 0.009654663763556608, "entropy": 0.8282749229638035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.168366988941475, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.95239447399422, "policy_loss": -0.014525998397188251, "vf_loss": 5.9661977770467285, "vf_explained_var": 0.014264716673149633, "kl": 0.009636113106099168, "entropy": 1.179668128679669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2744.0, "episode_reward_mean": -604.25, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -592.55, "predator_policy": 290.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1670.0, -1723.0, 400.0, -2285.0, -1826.0, 334.0, 34.0, -861.0, -2080.0, 190.0, -2264.0, -1301.0, 337.0, -2142.0, 116.0, -1722.0, 400.0, -1502.0, -372.0, 240.0, 262.0, 358.0, 334.0, 208.0, 60.0, 341.0, 42.0, 388.0, 40.0, 298.0, 179.0, -1140.0, -299.0, 238.0, 225.0, -2152.0, 285.0, 364.0, 310.0, 297.0, -188.0, 200.0, 400.0, 16.0, -98.0, -1915.0, 76.0, -1771.0, -2068.0, 33.0, -1990.0, -203.0, -173.0, 328.0, 400.0, -200.0, 208.0, -2086.0, -1124.0, -1709.0, -1201.0, -1565.0, -1057.0, -814.0, -2052.0, -784.0, -2018.0, -558.0, -403.0, -1249.0, -1655.0, -332.0, -1278.0, -785.0, 382.0, -650.0, 376.0, -98.0, -1275.0, -2744.0, 220.0, -1686.0, -1245.0, -410.0, 400.0, 353.0, -858.0, -2279.0, -1103.0, -472.0, 331.0, 303.0, -2152.0, -1536.0, -617.0, -1787.0, 400.0, 400.0, 65.0, -69.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1241.0, -1494.0, -1593.0, -1230.0, 200.0, 200.0, -1549.0, -1571.0, -1252.0, -1384.0, 112.0, 167.0, 112.0, -383.0, -152.0, -1549.0, -1846.0, -1164.0, 156.0, -141.0, -1824.0, -1780.0, -1021.0, -1010.0, 167.0, 145.0, -1791.0, -1296.0, -130.0, -9.0, -1285.0, -1472.0, 200.0, 200.0, -1043.0, -1384.0, -306.0, -416.0, 145.0, -240.0, 101.0, 46.0, -97.0, 200.0, 189.0, 90.0, 200.0, -152.0, -317.0, 112.0, 46.0, 200.0, -108.0, -130.0, 178.0, 200.0, -339.0, 79.0, 68.0, 145.0, -306.0, 200.0, -1021.0, -1714.0, -713.0, -86.0, -42.0, 145.0, 200.0, -240.0, -1769.0, -1703.0, -20.0, 200.0, 200.0, 134.0, 167.0, 68.0, 145.0, 112.0, -812.0, 134.0, 200.0, -350.0, 200.0, 200.0, -9.0, -130.0, -284.0, -229.0, -1406.0, -1439.0, 200.0, -394.0, -1505.0, -1131.0, -1626.0, -1857.0, -438.0, 156.0, -1373.0, -1417.0, 200.0, -1098.0, -669.0, 46.0, 123.0, 145.0, 200.0, 200.0, 2.0, -592.0, -152.0, 200.0, -1901.0, -1835.0, -746.0, -1043.0, -1505.0, -1494.0, -702.0, -1219.0, -834.0, -1681.0, -1516.0, -1186.0, -482.0, -922.0, -1758.0, -1219.0, -1153.0, -471.0, -1285.0, -1648.0, -691.0, -1087.0, -526.0, -977.0, -1406.0, -1208.0, -1197.0, -1483.0, -768.0, -64.0, -911.0, -1142.0, -1263.0, -537.0, 167.0, 200.0, 68.0, -1593.0, 156.0, 200.0, -284.0, -229.0, -1373.0, -647.0, -1890.0, -1879.0, 145.0, -845.0, -1450.0, -1021.0, -1197.0, -988.0, -977.0, -108.0, 200.0, 200.0, 134.0, 189.0, -438.0, -1725.0, -1472.0, -1692.0, -779.0, -1054.0, 200.0, -1417.0, 46.0, 200.0, -97.0, 200.0, -1780.0, -1637.0, -1065.0, -1241.0, 57.0, -1439.0, -1318.0, -1329.0, 200.0, 200.0, 200.0, 200.0, -636.0, 156.0, 200.0, -779.0], "policy_predator_policy_reward": [140.0, 925.0, 205.0, 895.0, 0.0, 0.0, 835.0, 0.0, 730.0, 80.0, 40.0, 15.0, 40.0, 265.0, 795.0, 45.0, 0.0, 930.0, 20.0, 155.0, 930.0, 410.0, 10.0, 720.0, 0.0, 25.0, 45.0, 900.0, 110.0, 145.0, 815.0, 220.0, 0.0, 0.0, 55.0, 870.0, 40.0, 310.0, 180.0, 155.0, 70.0, 45.0, 135.0, 120.0, 50.0, 5.0, 0.0, 160.0, 90.0, 175.0, 70.0, 25.0, 95.0, 185.0, 10.0, 0.0, 55.0, 245.0, 25.0, 60.0, 145.0, 140.0, 760.0, 835.0, 500.0, 0.0, 25.0, 110.0, 85.0, 180.0, 325.0, 995.0, 100.0, 5.0, 30.0, 0.0, 40.0, 35.0, 0.0, 40.0, 460.0, 30.0, 140.0, 210.0, 0.0, 0.0, 100.0, 55.0, 250.0, 165.0, 50.0, 880.0, 270.0, 0.0, 150.0, 715.0, 935.0, 480.0, 5.0, 310.0, 0.0, 800.0, 590.0, 105.0, 290.0, 160.0, 25.0, 35.0, 0.0, 0.0, 385.0, 5.0, 160.0, 0.0, 945.0, 705.0, 580.0, 85.0, 410.0, 880.0, 0.0, 720.0, 905.0, 45.0, 825.0, 820.0, 0.0, 590.0, 890.0, 35.0, 115.0, 725.0, 65.0, 850.0, 665.0, 555.0, 560.0, 540.0, 620.0, 745.0, 315.0, 710.0, 500.0, 0.0, 725.0, 50.0, 175.0, 840.0, 15.0, 0.0, 50.0, 825.0, 20.0, 0.0, 415.0, 0.0, 745.0, 0.0, 75.0, 950.0, 430.0, 490.0, 785.0, 0.0, 110.0, 830.0, 540.0, 135.0, 0.0, 0.0, 0.0, 30.0, 875.0, 430.0, 720.0, 165.0, 0.0, 730.0, 10.0, 735.0, 70.0, 15.0, 125.0, 75.0, 755.0, 510.0, 770.0, 0.0, 75.0, 690.0, 860.0, 0.0, 0.0, 0.0, 0.0, 0.0, 315.0, 230.0, 70.0, 440.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7065221454564152, "mean_inference_ms": 1.667635629804401, "mean_action_processing_ms": 0.2784286674257572, "mean_env_wait_ms": 0.19783350868458122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005096912384033203, "StateBufferConnector_ms": 0.0037337541580200195, "ViewRequirementAgentConnector_ms": 0.11427891254425049}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2744.0, "episode_return_mean": -604.25, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.09242415386673, "num_env_steps_trained_throughput_per_sec": 82.09242415386673, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 49578.026, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49577.956, "sample_time_ms": 1299.213, "learn_time_ms": 48261.853, "learn_throughput": 82.881, "synch_weights_time_ms": 14.428}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "ed30a_00000", "date": "2024-08-12_15-21-10", "timestamp": 1723490470, "time_this_iter_s": 48.761608839035034, "time_total_s": 3894.3275032043457, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0120820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3894.3275032043457, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 31.99855072463769, "ram_util_percent": 82.2840579710145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3555915394315012, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.779516663627019, "policy_loss": -0.010811899422800966, "vf_loss": 5.7898936074877545, "vf_explained_var": 8.283134490724593e-05, "kl": 0.011598851123397244, "entropy": 0.7823312227057402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.139154994803131, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.119727721037688, "policy_loss": -0.015100885671563447, "vf_loss": 6.133995247896387, "vf_explained_var": 0.01249672843034936, "kl": 0.011111501812468753, "entropy": 1.1797589400457957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2744.0, "episode_reward_mean": -477.28, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 995.0}, "policy_reward_mean": {"prey_policy": -521.49, "predator_policy": 282.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-372.0, 240.0, 262.0, 358.0, 334.0, 208.0, 60.0, 341.0, 42.0, 388.0, 40.0, 298.0, 179.0, -1140.0, -299.0, 238.0, 225.0, -2152.0, 285.0, 364.0, 310.0, 297.0, -188.0, 200.0, 400.0, 16.0, -98.0, -1915.0, 76.0, -1771.0, -2068.0, 33.0, -1990.0, -203.0, -173.0, 328.0, 400.0, -200.0, 208.0, -2086.0, -1124.0, -1709.0, -1201.0, -1565.0, -1057.0, -814.0, -2052.0, -784.0, -2018.0, -558.0, -403.0, -1249.0, -1655.0, -332.0, -1278.0, -785.0, 382.0, -650.0, 376.0, -98.0, -1275.0, -2744.0, 220.0, -1686.0, -1245.0, -410.0, 400.0, 353.0, -858.0, -2279.0, -1103.0, -472.0, 331.0, 303.0, -2152.0, -1536.0, -617.0, -1787.0, 400.0, 400.0, 65.0, -69.0, -1080.0, -2491.0, 339.0, -196.0, -299.0, 103.0, -446.0, 141.0, 292.0, 287.0, -9.0, 230.0, -1115.0, 160.0, 32.0, -208.0, -594.0, -14.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-306.0, -416.0, 145.0, -240.0, 101.0, 46.0, -97.0, 200.0, 189.0, 90.0, 200.0, -152.0, -317.0, 112.0, 46.0, 200.0, -108.0, -130.0, 178.0, 200.0, -339.0, 79.0, 68.0, 145.0, -306.0, 200.0, -1021.0, -1714.0, -713.0, -86.0, -42.0, 145.0, 200.0, -240.0, -1769.0, -1703.0, -20.0, 200.0, 200.0, 134.0, 167.0, 68.0, 145.0, 112.0, -812.0, 134.0, 200.0, -350.0, 200.0, 200.0, -9.0, -130.0, -284.0, -229.0, -1406.0, -1439.0, 200.0, -394.0, -1505.0, -1131.0, -1626.0, -1857.0, -438.0, 156.0, -1373.0, -1417.0, 200.0, -1098.0, -669.0, 46.0, 123.0, 145.0, 200.0, 200.0, 2.0, -592.0, -152.0, 200.0, -1901.0, -1835.0, -746.0, -1043.0, -1505.0, -1494.0, -702.0, -1219.0, -834.0, -1681.0, -1516.0, -1186.0, -482.0, -922.0, -1758.0, -1219.0, -1153.0, -471.0, -1285.0, -1648.0, -691.0, -1087.0, -526.0, -977.0, -1406.0, -1208.0, -1197.0, -1483.0, -768.0, -64.0, -911.0, -1142.0, -1263.0, -537.0, 167.0, 200.0, 68.0, -1593.0, 156.0, 200.0, -284.0, -229.0, -1373.0, -647.0, -1890.0, -1879.0, 145.0, -845.0, -1450.0, -1021.0, -1197.0, -988.0, -977.0, -108.0, 200.0, 200.0, 134.0, 189.0, -438.0, -1725.0, -1472.0, -1692.0, -779.0, -1054.0, 200.0, -1417.0, 46.0, 200.0, -97.0, 200.0, -1780.0, -1637.0, -1065.0, -1241.0, 57.0, -1439.0, -1318.0, -1329.0, 200.0, 200.0, 200.0, 200.0, -636.0, 156.0, 200.0, -779.0, -911.0, -779.0, -1835.0, -1736.0, 112.0, -163.0, 200.0, -1021.0, -1692.0, -152.0, -1307.0, 145.0, -625.0, -306.0, 101.0, -240.0, 200.0, 2.0, 189.0, 13.0, 2.0, -196.0, -42.0, 57.0, -1307.0, -1098.0, -86.0, 46.0, -53.0, -75.0, -328.0, -295.0, -471.0, -713.0, -207.0, -152.0], "policy_predator_policy_reward": [40.0, 310.0, 180.0, 155.0, 70.0, 45.0, 135.0, 120.0, 50.0, 5.0, 0.0, 160.0, 90.0, 175.0, 70.0, 25.0, 95.0, 185.0, 10.0, 0.0, 55.0, 245.0, 25.0, 60.0, 145.0, 140.0, 760.0, 835.0, 500.0, 0.0, 25.0, 110.0, 85.0, 180.0, 325.0, 995.0, 100.0, 5.0, 30.0, 0.0, 40.0, 35.0, 0.0, 40.0, 460.0, 30.0, 140.0, 210.0, 0.0, 0.0, 100.0, 55.0, 250.0, 165.0, 50.0, 880.0, 270.0, 0.0, 150.0, 715.0, 935.0, 480.0, 5.0, 310.0, 0.0, 800.0, 590.0, 105.0, 290.0, 160.0, 25.0, 35.0, 0.0, 0.0, 385.0, 5.0, 160.0, 0.0, 945.0, 705.0, 580.0, 85.0, 410.0, 880.0, 0.0, 720.0, 905.0, 45.0, 825.0, 820.0, 0.0, 590.0, 890.0, 35.0, 115.0, 725.0, 65.0, 850.0, 665.0, 555.0, 560.0, 540.0, 620.0, 745.0, 315.0, 710.0, 500.0, 0.0, 725.0, 50.0, 175.0, 840.0, 15.0, 0.0, 50.0, 825.0, 20.0, 0.0, 415.0, 0.0, 745.0, 0.0, 75.0, 950.0, 430.0, 490.0, 785.0, 0.0, 110.0, 830.0, 540.0, 135.0, 0.0, 0.0, 0.0, 30.0, 875.0, 430.0, 720.0, 165.0, 0.0, 730.0, 10.0, 735.0, 70.0, 15.0, 125.0, 75.0, 755.0, 510.0, 770.0, 0.0, 75.0, 690.0, 860.0, 0.0, 0.0, 0.0, 0.0, 0.0, 315.0, 230.0, 70.0, 440.0, 515.0, 95.0, 130.0, 950.0, 200.0, 190.0, 555.0, 70.0, 740.0, 805.0, 630.0, 635.0, 0.0, 485.0, 205.0, 75.0, 90.0, 0.0, 85.0, 0.0, 185.0, 0.0, 135.0, 80.0, 585.0, 705.0, 70.0, 130.0, 160.0, 0.0, 355.0, 60.0, 590.0, 0.0, 160.0, 185.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.706243214514693, "mean_inference_ms": 1.666083915274471, "mean_action_processing_ms": 0.2783089306705829, "mean_env_wait_ms": 0.19780239044839007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0044547319412231445, "StateBufferConnector_ms": 0.0036469697952270508, "ViewRequirementAgentConnector_ms": 0.11193978786468506}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2744.0, "episode_return_mean": -477.28, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.3257178759964, "num_env_steps_trained_throughput_per_sec": 81.3257178759964, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 49521.376, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49521.306, "sample_time_ms": 1275.304, "learn_time_ms": 48228.832, "learn_throughput": 82.938, "synch_weights_time_ms": 14.681}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "ed30a_00000", "date": "2024-08-12_15-22-00", "timestamp": 1723490520, "time_this_iter_s": 49.2319450378418, "time_total_s": 3943.5594482421875, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20a3af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3943.5594482421875, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 34.53285714285714, "ram_util_percent": 82.34142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4947392694376134, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.084746179631147, "policy_loss": -0.011088263736692843, "vf_loss": 6.095399923425503, "vf_explained_var": 6.151360178750659e-05, "kl": 0.011586996654658562, "entropy": 0.6984653825797732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.780909398781559, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.092460452185737, "policy_loss": -0.01612487957620668, "vf_loss": 7.1076195421673, "vf_explained_var": 0.013822984411602929, "kl": 0.012877272365915345, "entropy": 1.1735556328738177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2744.0, "episode_reward_mean": -565.85, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 950.0}, "policy_reward_mean": {"prey_policy": -598.6, "predator_policy": 315.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 400.0, 16.0, -98.0, -1915.0, 76.0, -1771.0, -2068.0, 33.0, -1990.0, -203.0, -173.0, 328.0, 400.0, -200.0, 208.0, -2086.0, -1124.0, -1709.0, -1201.0, -1565.0, -1057.0, -814.0, -2052.0, -784.0, -2018.0, -558.0, -403.0, -1249.0, -1655.0, -332.0, -1278.0, -785.0, 382.0, -650.0, 376.0, -98.0, -1275.0, -2744.0, 220.0, -1686.0, -1245.0, -410.0, 400.0, 353.0, -858.0, -2279.0, -1103.0, -472.0, 331.0, 303.0, -2152.0, -1536.0, -617.0, -1787.0, 400.0, 400.0, 65.0, -69.0, -1080.0, -2491.0, 339.0, -196.0, -299.0, 103.0, -446.0, 141.0, 292.0, 287.0, -9.0, 230.0, -1115.0, 160.0, 32.0, -208.0, -594.0, -14.0, -903.0, -62.0, 322.0, -473.0, 15.0, -432.0, 298.0, 400.0, 160.0, -818.0, -499.0, 168.0, -519.0, -254.0, -1390.0, -204.0, -1295.0, -447.0, -1705.0, -565.0, 30.0, 400.0, -766.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -350.0, 200.0, 200.0, -9.0, -130.0, -284.0, -229.0, -1406.0, -1439.0, 200.0, -394.0, -1505.0, -1131.0, -1626.0, -1857.0, -438.0, 156.0, -1373.0, -1417.0, 200.0, -1098.0, -669.0, 46.0, 123.0, 145.0, 200.0, 200.0, 2.0, -592.0, -152.0, 200.0, -1901.0, -1835.0, -746.0, -1043.0, -1505.0, -1494.0, -702.0, -1219.0, -834.0, -1681.0, -1516.0, -1186.0, -482.0, -922.0, -1758.0, -1219.0, -1153.0, -471.0, -1285.0, -1648.0, -691.0, -1087.0, -526.0, -977.0, -1406.0, -1208.0, -1197.0, -1483.0, -768.0, -64.0, -911.0, -1142.0, -1263.0, -537.0, 167.0, 200.0, 68.0, -1593.0, 156.0, 200.0, -284.0, -229.0, -1373.0, -647.0, -1890.0, -1879.0, 145.0, -845.0, -1450.0, -1021.0, -1197.0, -988.0, -977.0, -108.0, 200.0, 200.0, 134.0, 189.0, -438.0, -1725.0, -1472.0, -1692.0, -779.0, -1054.0, 200.0, -1417.0, 46.0, 200.0, -97.0, 200.0, -1780.0, -1637.0, -1065.0, -1241.0, 57.0, -1439.0, -1318.0, -1329.0, 200.0, 200.0, 200.0, 200.0, -636.0, 156.0, 200.0, -779.0, -911.0, -779.0, -1835.0, -1736.0, 112.0, -163.0, 200.0, -1021.0, -1692.0, -152.0, -1307.0, 145.0, -625.0, -306.0, 101.0, -240.0, 200.0, 2.0, 189.0, 13.0, 2.0, -196.0, -42.0, 57.0, -1307.0, -1098.0, -86.0, 46.0, -53.0, -75.0, -328.0, -295.0, -471.0, -713.0, -207.0, -152.0, -1967.0, -86.0, 200.0, -647.0, 189.0, 68.0, -768.0, -295.0, -75.0, -185.0, -251.0, -1516.0, 13.0, 200.0, 200.0, 200.0, -97.0, 57.0, -713.0, -1065.0, -438.0, -361.0, -647.0, 200.0, -185.0, -889.0, 200.0, -999.0, -955.0, -1450.0, -284.0, -625.0, -1065.0, -1065.0, -746.0, -361.0, -1670.0, -1230.0, -383.0, -1087.0, -251.0, 46.0, 200.0, 200.0, -284.0, -1582.0], "policy_predator_policy_reward": [140.0, 210.0, 0.0, 0.0, 100.0, 55.0, 250.0, 165.0, 50.0, 880.0, 270.0, 0.0, 150.0, 715.0, 935.0, 480.0, 5.0, 310.0, 0.0, 800.0, 590.0, 105.0, 290.0, 160.0, 25.0, 35.0, 0.0, 0.0, 385.0, 5.0, 160.0, 0.0, 945.0, 705.0, 580.0, 85.0, 410.0, 880.0, 0.0, 720.0, 905.0, 45.0, 825.0, 820.0, 0.0, 590.0, 890.0, 35.0, 115.0, 725.0, 65.0, 850.0, 665.0, 555.0, 560.0, 540.0, 620.0, 745.0, 315.0, 710.0, 500.0, 0.0, 725.0, 50.0, 175.0, 840.0, 15.0, 0.0, 50.0, 825.0, 20.0, 0.0, 415.0, 0.0, 745.0, 0.0, 75.0, 950.0, 430.0, 490.0, 785.0, 0.0, 110.0, 830.0, 540.0, 135.0, 0.0, 0.0, 0.0, 30.0, 875.0, 430.0, 720.0, 165.0, 0.0, 730.0, 10.0, 735.0, 70.0, 15.0, 125.0, 75.0, 755.0, 510.0, 770.0, 0.0, 75.0, 690.0, 860.0, 0.0, 0.0, 0.0, 0.0, 0.0, 315.0, 230.0, 70.0, 440.0, 515.0, 95.0, 130.0, 950.0, 200.0, 190.0, 555.0, 70.0, 740.0, 805.0, 630.0, 635.0, 0.0, 485.0, 205.0, 75.0, 90.0, 0.0, 85.0, 0.0, 185.0, 0.0, 135.0, 80.0, 585.0, 705.0, 70.0, 130.0, 160.0, 0.0, 355.0, 60.0, 590.0, 0.0, 160.0, 185.0, 775.0, 375.0, 165.0, 220.0, 60.0, 5.0, 335.0, 255.0, 85.0, 190.0, 755.0, 580.0, 0.0, 85.0, 0.0, 0.0, 135.0, 65.0, 660.0, 300.0, 300.0, 0.0, 275.0, 340.0, 505.0, 50.0, 10.0, 535.0, 210.0, 805.0, 300.0, 405.0, 135.0, 700.0, 585.0, 75.0, 725.0, 470.0, 325.0, 580.0, 200.0, 35.0, 0.0, 0.0, 800.0, 300.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7051834250369001, "mean_inference_ms": 1.6623792551261654, "mean_action_processing_ms": 0.27796384526207957, "mean_env_wait_ms": 0.1975211952713924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036764144897460938, "StateBufferConnector_ms": 0.003391742706298828, "ViewRequirementAgentConnector_ms": 0.10205864906311035}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2744.0, "episode_return_mean": -565.85, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.03918391673261, "num_env_steps_trained_throughput_per_sec": 80.03918391673261, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 49606.877, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49606.807, "sample_time_ms": 1267.269, "learn_time_ms": 48320.782, "learn_throughput": 82.78, "synch_weights_time_ms": 16.056}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "ed30a_00000", "date": "2024-08-12_15-22-50", "timestamp": 1723490570, "time_this_iter_s": 50.00981116294861, "time_total_s": 3993.569259405136, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 3993.569259405136, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 34.78142857142857, "ram_util_percent": 82.55857142857144}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5179311774710498, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.451756863871579, "policy_loss": -0.009243507178441163, "vf_loss": 6.460657805488223, "vf_explained_var": 0.0002408111852312845, "kl": 0.009134813205167711, "entropy": 0.6000578669170854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.253020781120926, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.344867973983603, "policy_loss": -0.012108067259015072, "vf_loss": 7.35636891284317, "vf_explained_var": 0.009163913651118202, "kl": 0.008094942322073296, "entropy": 1.214686788263775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2744.0, "episode_reward_mean": -569.98, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 950.0}, "policy_reward_mean": {"prey_policy": -616.64, "predator_policy": 331.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1709.0, -1201.0, -1565.0, -1057.0, -814.0, -2052.0, -784.0, -2018.0, -558.0, -403.0, -1249.0, -1655.0, -332.0, -1278.0, -785.0, 382.0, -650.0, 376.0, -98.0, -1275.0, -2744.0, 220.0, -1686.0, -1245.0, -410.0, 400.0, 353.0, -858.0, -2279.0, -1103.0, -472.0, 331.0, 303.0, -2152.0, -1536.0, -617.0, -1787.0, 400.0, 400.0, 65.0, -69.0, -1080.0, -2491.0, 339.0, -196.0, -299.0, 103.0, -446.0, 141.0, 292.0, 287.0, -9.0, 230.0, -1115.0, 160.0, 32.0, -208.0, -594.0, -14.0, -903.0, -62.0, 322.0, -473.0, 15.0, -432.0, 298.0, 400.0, 160.0, -818.0, -499.0, 168.0, -519.0, -254.0, -1390.0, -204.0, -1295.0, -447.0, -1705.0, -565.0, 30.0, 400.0, -766.0, -729.0, -599.0, -1181.0, -1670.0, -1140.0, -688.0, -861.0, -453.0, 130.0, -1256.0, -753.0, -430.0, -943.0, 310.0, -638.0, 310.0, 206.0, 5.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1505.0, -1494.0, -702.0, -1219.0, -834.0, -1681.0, -1516.0, -1186.0, -482.0, -922.0, -1758.0, -1219.0, -1153.0, -471.0, -1285.0, -1648.0, -691.0, -1087.0, -526.0, -977.0, -1406.0, -1208.0, -1197.0, -1483.0, -768.0, -64.0, -911.0, -1142.0, -1263.0, -537.0, 167.0, 200.0, 68.0, -1593.0, 156.0, 200.0, -284.0, -229.0, -1373.0, -647.0, -1890.0, -1879.0, 145.0, -845.0, -1450.0, -1021.0, -1197.0, -988.0, -977.0, -108.0, 200.0, 200.0, 134.0, 189.0, -438.0, -1725.0, -1472.0, -1692.0, -779.0, -1054.0, 200.0, -1417.0, 46.0, 200.0, -97.0, 200.0, -1780.0, -1637.0, -1065.0, -1241.0, 57.0, -1439.0, -1318.0, -1329.0, 200.0, 200.0, 200.0, 200.0, -636.0, 156.0, 200.0, -779.0, -911.0, -779.0, -1835.0, -1736.0, 112.0, -163.0, 200.0, -1021.0, -1692.0, -152.0, -1307.0, 145.0, -625.0, -306.0, 101.0, -240.0, 200.0, 2.0, 189.0, 13.0, 2.0, -196.0, -42.0, 57.0, -1307.0, -1098.0, -86.0, 46.0, -53.0, -75.0, -328.0, -295.0, -471.0, -713.0, -207.0, -152.0, -1967.0, -86.0, 200.0, -647.0, 189.0, 68.0, -768.0, -295.0, -75.0, -185.0, -251.0, -1516.0, 13.0, 200.0, 200.0, 200.0, -97.0, 57.0, -713.0, -1065.0, -438.0, -361.0, -647.0, 200.0, -185.0, -889.0, 200.0, -999.0, -955.0, -1450.0, -284.0, -625.0, -1065.0, -1065.0, -746.0, -361.0, -1670.0, -1230.0, -383.0, -1087.0, -251.0, 46.0, 200.0, 200.0, -284.0, -1582.0, -229.0, -1450.0, -570.0, -504.0, -878.0, -933.0, -1725.0, -845.0, -1109.0, -1021.0, -669.0, -779.0, -625.0, -801.0, -1736.0, 13.0, -295.0, 200.0, -1461.0, -900.0, -537.0, -1021.0, -218.0, -812.0, -933.0, -735.0, 200.0, 35.0, -680.0, -933.0, 35.0, 200.0, 200.0, -1439.0, -9.0, -196.0], "policy_predator_policy_reward": [410.0, 880.0, 0.0, 720.0, 905.0, 45.0, 825.0, 820.0, 0.0, 590.0, 890.0, 35.0, 115.0, 725.0, 65.0, 850.0, 665.0, 555.0, 560.0, 540.0, 620.0, 745.0, 315.0, 710.0, 500.0, 0.0, 725.0, 50.0, 175.0, 840.0, 15.0, 0.0, 50.0, 825.0, 20.0, 0.0, 415.0, 0.0, 745.0, 0.0, 75.0, 950.0, 430.0, 490.0, 785.0, 0.0, 110.0, 830.0, 540.0, 135.0, 0.0, 0.0, 0.0, 30.0, 875.0, 430.0, 720.0, 165.0, 0.0, 730.0, 10.0, 735.0, 70.0, 15.0, 125.0, 75.0, 755.0, 510.0, 770.0, 0.0, 75.0, 690.0, 860.0, 0.0, 0.0, 0.0, 0.0, 0.0, 315.0, 230.0, 70.0, 440.0, 515.0, 95.0, 130.0, 950.0, 200.0, 190.0, 555.0, 70.0, 740.0, 805.0, 630.0, 635.0, 0.0, 485.0, 205.0, 75.0, 90.0, 0.0, 85.0, 0.0, 185.0, 0.0, 135.0, 80.0, 585.0, 705.0, 70.0, 130.0, 160.0, 0.0, 355.0, 60.0, 590.0, 0.0, 160.0, 185.0, 775.0, 375.0, 165.0, 220.0, 60.0, 5.0, 335.0, 255.0, 85.0, 190.0, 755.0, 580.0, 0.0, 85.0, 0.0, 0.0, 135.0, 65.0, 660.0, 300.0, 300.0, 0.0, 275.0, 340.0, 505.0, 50.0, 10.0, 535.0, 210.0, 805.0, 300.0, 405.0, 135.0, 700.0, 585.0, 75.0, 725.0, 470.0, 325.0, 580.0, 200.0, 35.0, 0.0, 0.0, 800.0, 300.0, 755.0, 195.0, 20.0, 455.0, 20.0, 610.0, 0.0, 900.0, 510.0, 480.0, 480.0, 280.0, 215.0, 350.0, 645.0, 625.0, 20.0, 205.0, 330.0, 775.0, 380.0, 425.0, 350.0, 250.0, 140.0, 585.0, 15.0, 60.0, 440.0, 535.0, 0.0, 75.0, 730.0, 715.0, 0.0, 210.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7044088323797187, "mean_inference_ms": 1.659710718660602, "mean_action_processing_ms": 0.2776919560382272, "mean_env_wait_ms": 0.19726762630691236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003750920295715332, "StateBufferConnector_ms": 0.003241419792175293, "ViewRequirementAgentConnector_ms": 0.1010744571685791}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2744.0, "episode_return_mean": -569.98, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.13571597207182, "num_env_steps_trained_throughput_per_sec": 78.13571597207182, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 49841.091, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49841.019, "sample_time_ms": 1277.365, "learn_time_ms": 48544.279, "learn_throughput": 82.399, "synch_weights_time_ms": 16.077}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "ed30a_00000", "date": "2024-08-12_15-23-41", "timestamp": 1723490621, "time_this_iter_s": 51.246825218200684, "time_total_s": 4044.816084623337, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0120f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4044.816084623337, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 38.82602739726027, "ram_util_percent": 81.81232876712328}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6311062294970113, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.575239479983295, "policy_loss": -0.007372976795316886, "vf_loss": 7.582356218307737, "vf_explained_var": 3.212769195516274e-05, "kl": 0.0068331572214812035, "entropy": 0.6268755550264682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.363575890802202, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.20322200457255, "policy_loss": -0.01645850618024943, "vf_loss": 8.21883438529161, "vf_explained_var": 0.01219087940044504, "kl": 0.011281813780755252, "entropy": 1.2302087006745515, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2491.0, "episode_reward_mean": -437.46, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 950.0}, "policy_reward_mean": {"prey_policy": -521.105, "predator_policy": 302.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1686.0, -1245.0, -410.0, 400.0, 353.0, -858.0, -2279.0, -1103.0, -472.0, 331.0, 303.0, -2152.0, -1536.0, -617.0, -1787.0, 400.0, 400.0, 65.0, -69.0, -1080.0, -2491.0, 339.0, -196.0, -299.0, 103.0, -446.0, 141.0, 292.0, 287.0, -9.0, 230.0, -1115.0, 160.0, 32.0, -208.0, -594.0, -14.0, -903.0, -62.0, 322.0, -473.0, 15.0, -432.0, 298.0, 400.0, 160.0, -818.0, -499.0, 168.0, -519.0, -254.0, -1390.0, -204.0, -1295.0, -447.0, -1705.0, -565.0, 30.0, 400.0, -766.0, -729.0, -599.0, -1181.0, -1670.0, -1140.0, -688.0, -861.0, -453.0, 130.0, -1256.0, -753.0, -430.0, -943.0, 310.0, -638.0, 310.0, 206.0, 5.0, -561.0, 400.0, -715.0, -637.0, -546.0, -970.0, 400.0, -240.0, 64.0, -40.0, -168.0, -391.0, -669.0, -423.0, -789.0, -308.0, -3.0, -1105.0, -170.0, 103.0, -1004.0, -225.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1450.0, -1021.0, -1197.0, -988.0, -977.0, -108.0, 200.0, 200.0, 134.0, 189.0, -438.0, -1725.0, -1472.0, -1692.0, -779.0, -1054.0, 200.0, -1417.0, 46.0, 200.0, -97.0, 200.0, -1780.0, -1637.0, -1065.0, -1241.0, 57.0, -1439.0, -1318.0, -1329.0, 200.0, 200.0, 200.0, 200.0, -636.0, 156.0, 200.0, -779.0, -911.0, -779.0, -1835.0, -1736.0, 112.0, -163.0, 200.0, -1021.0, -1692.0, -152.0, -1307.0, 145.0, -625.0, -306.0, 101.0, -240.0, 200.0, 2.0, 189.0, 13.0, 2.0, -196.0, -42.0, 57.0, -1307.0, -1098.0, -86.0, 46.0, -53.0, -75.0, -328.0, -295.0, -471.0, -713.0, -207.0, -152.0, -1967.0, -86.0, 200.0, -647.0, 189.0, 68.0, -768.0, -295.0, -75.0, -185.0, -251.0, -1516.0, 13.0, 200.0, 200.0, 200.0, -97.0, 57.0, -713.0, -1065.0, -438.0, -361.0, -647.0, 200.0, -185.0, -889.0, 200.0, -999.0, -955.0, -1450.0, -284.0, -625.0, -1065.0, -1065.0, -746.0, -361.0, -1670.0, -1230.0, -383.0, -1087.0, -251.0, 46.0, 200.0, 200.0, -284.0, -1582.0, -229.0, -1450.0, -570.0, -504.0, -878.0, -933.0, -1725.0, -845.0, -1109.0, -1021.0, -669.0, -779.0, -625.0, -801.0, -1736.0, 13.0, -295.0, 200.0, -1461.0, -900.0, -537.0, -1021.0, -218.0, -812.0, -933.0, -735.0, 200.0, 35.0, -680.0, -933.0, 35.0, 200.0, 200.0, -1439.0, -9.0, -196.0, -405.0, -1351.0, 200.0, 200.0, -592.0, -1098.0, -416.0, -691.0, -405.0, -581.0, -724.0, -801.0, 200.0, 200.0, -1065.0, -75.0, 35.0, -141.0, -31.0, -284.0, -174.0, -614.0, -581.0, -570.0, -812.0, -647.0, -537.0, -306.0, -1274.0, -845.0, -790.0, -108.0, -64.0, -174.0, -1230.0, -845.0, 145.0, -845.0, -130.0, 13.0, -713.0, -1461.0, -350.0, -295.0], "policy_predator_policy_reward": [785.0, 0.0, 110.0, 830.0, 540.0, 135.0, 0.0, 0.0, 0.0, 30.0, 875.0, 430.0, 720.0, 165.0, 0.0, 730.0, 10.0, 735.0, 70.0, 15.0, 125.0, 75.0, 755.0, 510.0, 770.0, 0.0, 75.0, 690.0, 860.0, 0.0, 0.0, 0.0, 0.0, 0.0, 315.0, 230.0, 70.0, 440.0, 515.0, 95.0, 130.0, 950.0, 200.0, 190.0, 555.0, 70.0, 740.0, 805.0, 630.0, 635.0, 0.0, 485.0, 205.0, 75.0, 90.0, 0.0, 85.0, 0.0, 185.0, 0.0, 135.0, 80.0, 585.0, 705.0, 70.0, 130.0, 160.0, 0.0, 355.0, 60.0, 590.0, 0.0, 160.0, 185.0, 775.0, 375.0, 165.0, 220.0, 60.0, 5.0, 335.0, 255.0, 85.0, 190.0, 755.0, 580.0, 0.0, 85.0, 0.0, 0.0, 135.0, 65.0, 660.0, 300.0, 300.0, 0.0, 275.0, 340.0, 505.0, 50.0, 10.0, 535.0, 210.0, 805.0, 300.0, 405.0, 135.0, 700.0, 585.0, 75.0, 725.0, 470.0, 325.0, 580.0, 200.0, 35.0, 0.0, 0.0, 800.0, 300.0, 755.0, 195.0, 20.0, 455.0, 20.0, 610.0, 0.0, 900.0, 510.0, 480.0, 480.0, 280.0, 215.0, 350.0, 645.0, 625.0, 20.0, 205.0, 330.0, 775.0, 380.0, 425.0, 350.0, 250.0, 140.0, 585.0, 15.0, 60.0, 440.0, 535.0, 0.0, 75.0, 730.0, 715.0, 0.0, 210.0, 705.0, 490.0, 0.0, 0.0, 360.0, 615.0, 405.0, 65.0, 330.0, 110.0, 480.0, 75.0, 0.0, 0.0, 420.0, 480.0, 50.0, 120.0, 5.0, 270.0, 180.0, 440.0, 235.0, 525.0, 275.0, 515.0, 165.0, 255.0, 570.0, 760.0, 140.0, 450.0, 185.0, 50.0, 465.0, 505.0, 430.0, 100.0, 145.0, 75.0, 415.0, 755.0, 325.0, 95.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7033144719407269, "mean_inference_ms": 1.6559901187281334, "mean_action_processing_ms": 0.2773785004950063, "mean_env_wait_ms": 0.19688938127165698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036035776138305664, "StateBufferConnector_ms": 0.003237485885620117, "ViewRequirementAgentConnector_ms": 0.09717285633087158}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2491.0, "episode_return_mean": -437.46, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.81480729294238, "num_env_steps_trained_throughput_per_sec": 79.81480729294238, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 49926.527, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49926.462, "sample_time_ms": 1248.477, "learn_time_ms": 48658.467, "learn_throughput": 82.206, "synch_weights_time_ms": 16.236}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "ed30a_00000", "date": "2024-08-12_15-24-31", "timestamp": 1723490671, "time_this_iter_s": 50.157678842544556, "time_total_s": 4094.9737634658813, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16271f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4094.9737634658813, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 36.621126760563385, "ram_util_percent": 82.58450704225352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5508936088709604, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.641362523023414, "policy_loss": -0.009117189881751541, "vf_loss": 5.6502065657307865, "vf_explained_var": -0.0004159512343230071, "kl": 0.007283870276571791, "entropy": 0.6416643476360059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.63097986862773, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.221619229594236, "policy_loss": -0.017356765611225334, "vf_loss": 6.23798029712899, "vf_explained_var": 0.013843170927945899, "kl": 0.013276018884561418, "entropy": 1.1952325959684988, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2491.0, "episode_reward_mean": -373.54, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1967.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -479.195, "predator_policy": 292.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-69.0, -1080.0, -2491.0, 339.0, -196.0, -299.0, 103.0, -446.0, 141.0, 292.0, 287.0, -9.0, 230.0, -1115.0, 160.0, 32.0, -208.0, -594.0, -14.0, -903.0, -62.0, 322.0, -473.0, 15.0, -432.0, 298.0, 400.0, 160.0, -818.0, -499.0, 168.0, -519.0, -254.0, -1390.0, -204.0, -1295.0, -447.0, -1705.0, -565.0, 30.0, 400.0, -766.0, -729.0, -599.0, -1181.0, -1670.0, -1140.0, -688.0, -861.0, -453.0, 130.0, -1256.0, -753.0, -430.0, -943.0, 310.0, -638.0, 310.0, 206.0, 5.0, -561.0, 400.0, -715.0, -637.0, -546.0, -970.0, 400.0, -240.0, 64.0, -40.0, -168.0, -391.0, -669.0, -423.0, -789.0, -308.0, -3.0, -1105.0, -170.0, 103.0, -1004.0, -225.0, -659.0, 364.0, -68.0, 226.0, -841.0, 196.0, -200.0, -606.0, -2189.0, 4.0, 126.0, -157.0, -178.0, 22.0, 83.0, -586.0, -1222.0, 184.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -779.0, -911.0, -779.0, -1835.0, -1736.0, 112.0, -163.0, 200.0, -1021.0, -1692.0, -152.0, -1307.0, 145.0, -625.0, -306.0, 101.0, -240.0, 200.0, 2.0, 189.0, 13.0, 2.0, -196.0, -42.0, 57.0, -1307.0, -1098.0, -86.0, 46.0, -53.0, -75.0, -328.0, -295.0, -471.0, -713.0, -207.0, -152.0, -1967.0, -86.0, 200.0, -647.0, 189.0, 68.0, -768.0, -295.0, -75.0, -185.0, -251.0, -1516.0, 13.0, 200.0, 200.0, 200.0, -97.0, 57.0, -713.0, -1065.0, -438.0, -361.0, -647.0, 200.0, -185.0, -889.0, 200.0, -999.0, -955.0, -1450.0, -284.0, -625.0, -1065.0, -1065.0, -746.0, -361.0, -1670.0, -1230.0, -383.0, -1087.0, -251.0, 46.0, 200.0, 200.0, -284.0, -1582.0, -229.0, -1450.0, -570.0, -504.0, -878.0, -933.0, -1725.0, -845.0, -1109.0, -1021.0, -669.0, -779.0, -625.0, -801.0, -1736.0, 13.0, -295.0, 200.0, -1461.0, -900.0, -537.0, -1021.0, -218.0, -812.0, -933.0, -735.0, 200.0, 35.0, -680.0, -933.0, 35.0, 200.0, 200.0, -1439.0, -9.0, -196.0, -405.0, -1351.0, 200.0, 200.0, -592.0, -1098.0, -416.0, -691.0, -405.0, -581.0, -724.0, -801.0, 200.0, 200.0, -1065.0, -75.0, 35.0, -141.0, -31.0, -284.0, -174.0, -614.0, -581.0, -570.0, -812.0, -647.0, -537.0, -306.0, -1274.0, -845.0, -790.0, -108.0, -64.0, -174.0, -1230.0, -845.0, 145.0, -845.0, -130.0, 13.0, -713.0, -1461.0, -350.0, -295.0, -460.0, -1054.0, 134.0, 200.0, -636.0, 68.0, 200.0, -119.0, -691.0, -900.0, 200.0, -174.0, 200.0, -900.0, -361.0, -790.0, -1813.0, -1351.0, 156.0, -1197.0, 200.0, -339.0, -317.0, -130.0, -196.0, -317.0, -372.0, 134.0, -130.0, -317.0, -603.0, -493.0, -735.0, -1197.0, 123.0, -119.0], "policy_predator_policy_reward": [70.0, 440.0, 515.0, 95.0, 130.0, 950.0, 200.0, 190.0, 555.0, 70.0, 740.0, 805.0, 630.0, 635.0, 0.0, 485.0, 205.0, 75.0, 90.0, 0.0, 85.0, 0.0, 185.0, 0.0, 135.0, 80.0, 585.0, 705.0, 70.0, 130.0, 160.0, 0.0, 355.0, 60.0, 590.0, 0.0, 160.0, 185.0, 775.0, 375.0, 165.0, 220.0, 60.0, 5.0, 335.0, 255.0, 85.0, 190.0, 755.0, 580.0, 0.0, 85.0, 0.0, 0.0, 135.0, 65.0, 660.0, 300.0, 300.0, 0.0, 275.0, 340.0, 505.0, 50.0, 10.0, 535.0, 210.0, 805.0, 300.0, 405.0, 135.0, 700.0, 585.0, 75.0, 725.0, 470.0, 325.0, 580.0, 200.0, 35.0, 0.0, 0.0, 800.0, 300.0, 755.0, 195.0, 20.0, 455.0, 20.0, 610.0, 0.0, 900.0, 510.0, 480.0, 480.0, 280.0, 215.0, 350.0, 645.0, 625.0, 20.0, 205.0, 330.0, 775.0, 380.0, 425.0, 350.0, 250.0, 140.0, 585.0, 15.0, 60.0, 440.0, 535.0, 0.0, 75.0, 730.0, 715.0, 0.0, 210.0, 705.0, 490.0, 0.0, 0.0, 360.0, 615.0, 405.0, 65.0, 330.0, 110.0, 480.0, 75.0, 0.0, 0.0, 420.0, 480.0, 50.0, 120.0, 5.0, 270.0, 180.0, 440.0, 235.0, 525.0, 275.0, 515.0, 165.0, 255.0, 570.0, 760.0, 140.0, 450.0, 185.0, 50.0, 465.0, 505.0, 430.0, 100.0, 145.0, 75.0, 415.0, 755.0, 325.0, 95.0, 525.0, 330.0, 0.0, 30.0, 340.0, 160.0, 145.0, 0.0, 525.0, 225.0, 0.0, 170.0, 435.0, 65.0, 0.0, 545.0, 20.0, 955.0, 475.0, 570.0, 150.0, 115.0, 290.0, 0.0, 125.0, 210.0, 95.0, 165.0, 235.0, 295.0, 285.0, 225.0, 20.0, 690.0, 170.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7024639318196298, "mean_inference_ms": 1.6534118739759258, "mean_action_processing_ms": 0.277032302063397, "mean_env_wait_ms": 0.19660757111116975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035914182662963867, "StateBufferConnector_ms": 0.003237605094909668, "ViewRequirementAgentConnector_ms": 0.09689664840698242}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2491.0, "episode_return_mean": -373.54, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.01038744335364, "num_env_steps_trained_throughput_per_sec": 81.01038744335364, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 49851.789, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49851.736, "sample_time_ms": 1238.156, "learn_time_ms": 48594.23, "learn_throughput": 82.314, "synch_weights_time_ms": 16.248}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "ed30a_00000", "date": "2024-08-12_15-25-21", "timestamp": 1723490721, "time_this_iter_s": 49.4092481136322, "time_total_s": 4144.383011579514, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4144.383011579514, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 33.71857142857144, "ram_util_percent": 82.20714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.370600528817959, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.118925910399704, "policy_loss": -0.006418524110177286, "vf_loss": 5.125112803524764, "vf_explained_var": -0.0001971930738479372, "kl": 0.006177263124547342, "entropy": 0.5818251255801115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.437931680963153, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.4694005341756915, "policy_loss": -0.013625992140757343, "vf_loss": 5.4823354478866335, "vf_explained_var": 0.010761132662889188, "kl": 0.009214303381142885, "entropy": 1.1600810615473953, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2189.0, "episode_reward_mean": -368.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -468.69, "predator_policy": 284.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.0, -432.0, 298.0, 400.0, 160.0, -818.0, -499.0, 168.0, -519.0, -254.0, -1390.0, -204.0, -1295.0, -447.0, -1705.0, -565.0, 30.0, 400.0, -766.0, -729.0, -599.0, -1181.0, -1670.0, -1140.0, -688.0, -861.0, -453.0, 130.0, -1256.0, -753.0, -430.0, -943.0, 310.0, -638.0, 310.0, 206.0, 5.0, -561.0, 400.0, -715.0, -637.0, -546.0, -970.0, 400.0, -240.0, 64.0, -40.0, -168.0, -391.0, -669.0, -423.0, -789.0, -308.0, -3.0, -1105.0, -170.0, 103.0, -1004.0, -225.0, -659.0, 364.0, -68.0, 226.0, -841.0, 196.0, -200.0, -606.0, -2189.0, 4.0, 126.0, -157.0, -178.0, 22.0, 83.0, -586.0, -1222.0, 184.0, -705.0, 400.0, -496.0, -287.0, 198.0, -375.0, -1164.0, -104.0, 208.0, -313.0, 70.0, -992.0, -322.0, -605.0, -39.0, 184.0, 340.0, -369.0, 317.0, -482.0, -138.0, 235.0, -1113.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-75.0, -185.0, -251.0, -1516.0, 13.0, 200.0, 200.0, 200.0, -97.0, 57.0, -713.0, -1065.0, -438.0, -361.0, -647.0, 200.0, -185.0, -889.0, 200.0, -999.0, -955.0, -1450.0, -284.0, -625.0, -1065.0, -1065.0, -746.0, -361.0, -1670.0, -1230.0, -383.0, -1087.0, -251.0, 46.0, 200.0, 200.0, -284.0, -1582.0, -229.0, -1450.0, -570.0, -504.0, -878.0, -933.0, -1725.0, -845.0, -1109.0, -1021.0, -669.0, -779.0, -625.0, -801.0, -1736.0, 13.0, -295.0, 200.0, -1461.0, -900.0, -537.0, -1021.0, -218.0, -812.0, -933.0, -735.0, 200.0, 35.0, -680.0, -933.0, 35.0, 200.0, 200.0, -1439.0, -9.0, -196.0, -405.0, -1351.0, 200.0, 200.0, -592.0, -1098.0, -416.0, -691.0, -405.0, -581.0, -724.0, -801.0, 200.0, 200.0, -1065.0, -75.0, 35.0, -141.0, -31.0, -284.0, -174.0, -614.0, -581.0, -570.0, -812.0, -647.0, -537.0, -306.0, -1274.0, -845.0, -790.0, -108.0, -64.0, -174.0, -1230.0, -845.0, 145.0, -845.0, -130.0, 13.0, -713.0, -1461.0, -350.0, -295.0, -460.0, -1054.0, 134.0, 200.0, -636.0, 68.0, 200.0, -119.0, -691.0, -900.0, 200.0, -174.0, 200.0, -900.0, -361.0, -790.0, -1813.0, -1351.0, 156.0, -1197.0, 200.0, -339.0, -317.0, -130.0, -196.0, -317.0, -372.0, 134.0, -130.0, -317.0, -603.0, -493.0, -735.0, -1197.0, 123.0, -119.0, -625.0, -900.0, 200.0, 200.0, 189.0, -1835.0, -350.0, -537.0, -31.0, 79.0, -295.0, -405.0, -878.0, -911.0, -141.0, -163.0, 200.0, -152.0, -339.0, -394.0, 200.0, -405.0, -1164.0, -658.0, -240.0, -372.0, -1164.0, -471.0, 200.0, -614.0, -97.0, 101.0, 200.0, 90.0, -1384.0, -240.0, 2.0, 200.0, -1472.0, 200.0, -229.0, -174.0, -152.0, 167.0, -889.0, -1054.0], "policy_predator_policy_reward": [85.0, 190.0, 755.0, 580.0, 0.0, 85.0, 0.0, 0.0, 135.0, 65.0, 660.0, 300.0, 300.0, 0.0, 275.0, 340.0, 505.0, 50.0, 10.0, 535.0, 210.0, 805.0, 300.0, 405.0, 135.0, 700.0, 585.0, 75.0, 725.0, 470.0, 325.0, 580.0, 200.0, 35.0, 0.0, 0.0, 800.0, 300.0, 755.0, 195.0, 20.0, 455.0, 20.0, 610.0, 0.0, 900.0, 510.0, 480.0, 480.0, 280.0, 215.0, 350.0, 645.0, 625.0, 20.0, 205.0, 330.0, 775.0, 380.0, 425.0, 350.0, 250.0, 140.0, 585.0, 15.0, 60.0, 440.0, 535.0, 0.0, 75.0, 730.0, 715.0, 0.0, 210.0, 705.0, 490.0, 0.0, 0.0, 360.0, 615.0, 405.0, 65.0, 330.0, 110.0, 480.0, 75.0, 0.0, 0.0, 420.0, 480.0, 50.0, 120.0, 5.0, 270.0, 180.0, 440.0, 235.0, 525.0, 275.0, 515.0, 165.0, 255.0, 570.0, 760.0, 140.0, 450.0, 185.0, 50.0, 465.0, 505.0, 430.0, 100.0, 145.0, 75.0, 415.0, 755.0, 325.0, 95.0, 525.0, 330.0, 0.0, 30.0, 340.0, 160.0, 145.0, 0.0, 525.0, 225.0, 0.0, 170.0, 435.0, 65.0, 0.0, 545.0, 20.0, 955.0, 475.0, 570.0, 150.0, 115.0, 290.0, 0.0, 125.0, 210.0, 95.0, 165.0, 235.0, 295.0, 285.0, 225.0, 20.0, 690.0, 170.0, 10.0, 490.0, 330.0, 0.0, 0.0, 675.0, 475.0, 215.0, 385.0, 20.0, 130.0, 325.0, 0.0, 265.0, 360.0, 0.0, 200.0, 160.0, 0.0, 125.0, 295.0, 240.0, 35.0, 790.0, 40.0, 0.0, 290.0, 860.0, 170.0, 150.0, 225.0, 75.0, 105.0, 0.0, 50.0, 485.0, 770.0, 35.0, 80.0, 125.0, 665.0, 190.0, 75.0, 85.0, 135.0, 630.0, 200.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7007304285368104, "mean_inference_ms": 1.6499621365714312, "mean_action_processing_ms": 0.2766565933268889, "mean_env_wait_ms": 0.19614889944459668, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036257505416870117, "StateBufferConnector_ms": 0.0032230615615844727, "ViewRequirementAgentConnector_ms": 0.09664583206176758}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2189.0, "episode_return_mean": -368.53, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.07855542926154, "num_env_steps_trained_throughput_per_sec": 81.07855542926154, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 49734.394, "restore_workers_time_ms": 0.015, "training_step_time_ms": 49734.341, "sample_time_ms": 1228.777, "learn_time_ms": 48486.867, "learn_throughput": 82.497, "synch_weights_time_ms": 15.584}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "ed30a_00000", "date": "2024-08-12_15-26-10", "timestamp": 1723490770, "time_this_iter_s": 49.34873604774475, "time_total_s": 4193.731747627258, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b16368b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4193.731747627258, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 36.528985507246375, "ram_util_percent": 82.67826086956524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5356458116145362, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.678521250921582, "policy_loss": -0.007497675696304117, "vf_loss": 5.68573619953539, "vf_explained_var": -0.0009502393858773368, "kl": 0.007539308918184982, "entropy": 0.5819957882165909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.742647732407958, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.551177479476525, "policy_loss": -0.01491859168560791, "vf_loss": 5.565408470264818, "vf_explained_var": 0.015219357625517264, "kl": 0.009167978266893742, "entropy": 1.1182974886641932, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2189.0, "episode_reward_mean": -348.01, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1835.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -452.355, "predator_policy": 278.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.0, -729.0, -599.0, -1181.0, -1670.0, -1140.0, -688.0, -861.0, -453.0, 130.0, -1256.0, -753.0, -430.0, -943.0, 310.0, -638.0, 310.0, 206.0, 5.0, -561.0, 400.0, -715.0, -637.0, -546.0, -970.0, 400.0, -240.0, 64.0, -40.0, -168.0, -391.0, -669.0, -423.0, -789.0, -308.0, -3.0, -1105.0, -170.0, 103.0, -1004.0, -225.0, -659.0, 364.0, -68.0, 226.0, -841.0, 196.0, -200.0, -606.0, -2189.0, 4.0, 126.0, -157.0, -178.0, 22.0, 83.0, -586.0, -1222.0, 184.0, -705.0, 400.0, -496.0, -287.0, 198.0, -375.0, -1164.0, -104.0, 208.0, -313.0, 70.0, -992.0, -322.0, -605.0, -39.0, 184.0, 340.0, -369.0, 317.0, -482.0, -138.0, 235.0, -1113.0, -626.0, 262.0, 304.0, 280.0, -341.0, -27.0, -964.0, -756.0, -171.0, 57.0, 203.0, 183.0, -687.0, -1208.0, -726.0, -281.0, 36.0, -143.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-284.0, -1582.0, -229.0, -1450.0, -570.0, -504.0, -878.0, -933.0, -1725.0, -845.0, -1109.0, -1021.0, -669.0, -779.0, -625.0, -801.0, -1736.0, 13.0, -295.0, 200.0, -1461.0, -900.0, -537.0, -1021.0, -218.0, -812.0, -933.0, -735.0, 200.0, 35.0, -680.0, -933.0, 35.0, 200.0, 200.0, -1439.0, -9.0, -196.0, -405.0, -1351.0, 200.0, 200.0, -592.0, -1098.0, -416.0, -691.0, -405.0, -581.0, -724.0, -801.0, 200.0, 200.0, -1065.0, -75.0, 35.0, -141.0, -31.0, -284.0, -174.0, -614.0, -581.0, -570.0, -812.0, -647.0, -537.0, -306.0, -1274.0, -845.0, -790.0, -108.0, -64.0, -174.0, -1230.0, -845.0, 145.0, -845.0, -130.0, 13.0, -713.0, -1461.0, -350.0, -295.0, -460.0, -1054.0, 134.0, 200.0, -636.0, 68.0, 200.0, -119.0, -691.0, -900.0, 200.0, -174.0, 200.0, -900.0, -361.0, -790.0, -1813.0, -1351.0, 156.0, -1197.0, 200.0, -339.0, -317.0, -130.0, -196.0, -317.0, -372.0, 134.0, -130.0, -317.0, -603.0, -493.0, -735.0, -1197.0, 123.0, -119.0, -625.0, -900.0, 200.0, 200.0, 189.0, -1835.0, -350.0, -537.0, -31.0, 79.0, -295.0, -405.0, -878.0, -911.0, -141.0, -163.0, 200.0, -152.0, -339.0, -394.0, 200.0, -405.0, -1164.0, -658.0, -240.0, -372.0, -1164.0, -471.0, 200.0, -614.0, -97.0, 101.0, 200.0, 90.0, -1384.0, -240.0, 2.0, 200.0, -1472.0, 200.0, -229.0, -174.0, -152.0, 167.0, -889.0, -1054.0, -680.0, -801.0, 79.0, 68.0, 24.0, 200.0, 13.0, 167.0, -306.0, -460.0, -64.0, -273.0, -834.0, -735.0, -735.0, -746.0, -460.0, -251.0, -86.0, -207.0, 123.0, -185.0, 189.0, -196.0, -460.0, -1417.0, -746.0, -1472.0, -592.0, -1219.0, -1032.0, 156.0, -97.0, -97.0, -878.0, 200.0], "policy_predator_policy_reward": [800.0, 300.0, 755.0, 195.0, 20.0, 455.0, 20.0, 610.0, 0.0, 900.0, 510.0, 480.0, 480.0, 280.0, 215.0, 350.0, 645.0, 625.0, 20.0, 205.0, 330.0, 775.0, 380.0, 425.0, 350.0, 250.0, 140.0, 585.0, 15.0, 60.0, 440.0, 535.0, 0.0, 75.0, 730.0, 715.0, 0.0, 210.0, 705.0, 490.0, 0.0, 0.0, 360.0, 615.0, 405.0, 65.0, 330.0, 110.0, 480.0, 75.0, 0.0, 0.0, 420.0, 480.0, 50.0, 120.0, 5.0, 270.0, 180.0, 440.0, 235.0, 525.0, 275.0, 515.0, 165.0, 255.0, 570.0, 760.0, 140.0, 450.0, 185.0, 50.0, 465.0, 505.0, 430.0, 100.0, 145.0, 75.0, 415.0, 755.0, 325.0, 95.0, 525.0, 330.0, 0.0, 30.0, 340.0, 160.0, 145.0, 0.0, 525.0, 225.0, 0.0, 170.0, 435.0, 65.0, 0.0, 545.0, 20.0, 955.0, 475.0, 570.0, 150.0, 115.0, 290.0, 0.0, 125.0, 210.0, 95.0, 165.0, 235.0, 295.0, 285.0, 225.0, 20.0, 690.0, 170.0, 10.0, 490.0, 330.0, 0.0, 0.0, 675.0, 475.0, 215.0, 385.0, 20.0, 130.0, 325.0, 0.0, 265.0, 360.0, 0.0, 200.0, 160.0, 0.0, 125.0, 295.0, 240.0, 35.0, 790.0, 40.0, 0.0, 290.0, 860.0, 170.0, 150.0, 225.0, 75.0, 105.0, 0.0, 50.0, 485.0, 770.0, 35.0, 80.0, 125.0, 665.0, 190.0, 75.0, 85.0, 135.0, 630.0, 200.0, 295.0, 560.0, 40.0, 75.0, 40.0, 40.0, 100.0, 0.0, 255.0, 170.0, 210.0, 100.0, 105.0, 500.0, 475.0, 250.0, 385.0, 155.0, 305.0, 45.0, 155.0, 110.0, 15.0, 175.0, 715.0, 475.0, 935.0, 75.0, 430.0, 655.0, 180.0, 415.0, 80.0, 150.0, 255.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7006887322795845, "mean_inference_ms": 1.6483943822206049, "mean_action_processing_ms": 0.27650635714829624, "mean_env_wait_ms": 0.19605015578910723, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046530961990356445, "StateBufferConnector_ms": 0.003214597702026367, "ViewRequirementAgentConnector_ms": 0.09936177730560303}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2189.0, "episode_return_mean": -348.01, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 6.937576579359261, "num_env_steps_trained_throughput_per_sec": 6.937576579359261, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 102330.719, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102330.665, "sample_time_ms": 1214.995, "learn_time_ms": 101095.803, "learn_throughput": 39.566, "synch_weights_time_ms": 16.614}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "ed30a_00000", "date": "2024-08-12_15-35-47", "timestamp": 1723491347, "time_this_iter_s": 576.6289229393005, "time_total_s": 4770.360670566559, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4770.360670566559, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 58.43837209302324, "ram_util_percent": 82.81627906976745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3207892453544354, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.879780428245585, "policy_loss": -0.008053187006424186, "vf_loss": 5.887557018875445, "vf_explained_var": -0.0002137245955290618, "kl": 0.007376024551248756, "entropy": 0.4331020345448186, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7845913441723615, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.115392910992658, "policy_loss": -0.014142328783593797, "vf_loss": 6.128681898117065, "vf_explained_var": 0.015217987917087696, "kl": 0.011377814412120917, "entropy": 1.0696848546386395, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2550.0, "episode_reward_mean": -358.82, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -449.385, "predator_policy": 269.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [5.0, -561.0, 400.0, -715.0, -637.0, -546.0, -970.0, 400.0, -240.0, 64.0, -40.0, -168.0, -391.0, -669.0, -423.0, -789.0, -308.0, -3.0, -1105.0, -170.0, 103.0, -1004.0, -225.0, -659.0, 364.0, -68.0, 226.0, -841.0, 196.0, -200.0, -606.0, -2189.0, 4.0, 126.0, -157.0, -178.0, 22.0, 83.0, -586.0, -1222.0, 184.0, -705.0, 400.0, -496.0, -287.0, 198.0, -375.0, -1164.0, -104.0, 208.0, -313.0, 70.0, -992.0, -322.0, -605.0, -39.0, 184.0, 340.0, -369.0, 317.0, -482.0, -138.0, 235.0, -1113.0, -626.0, 262.0, 304.0, 280.0, -341.0, -27.0, -964.0, -756.0, -171.0, 57.0, 203.0, 183.0, -687.0, -1208.0, -726.0, -281.0, 36.0, -143.0, 256.0, -2550.0, -677.0, -791.0, 238.0, -657.0, 270.0, -1425.0, -2210.0, 114.0, -649.0, 394.0, -22.0, 346.0, -938.0, -959.0, -573.0, -2399.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-9.0, -196.0, -405.0, -1351.0, 200.0, 200.0, -592.0, -1098.0, -416.0, -691.0, -405.0, -581.0, -724.0, -801.0, 200.0, 200.0, -1065.0, -75.0, 35.0, -141.0, -31.0, -284.0, -174.0, -614.0, -581.0, -570.0, -812.0, -647.0, -537.0, -306.0, -1274.0, -845.0, -790.0, -108.0, -64.0, -174.0, -1230.0, -845.0, 145.0, -845.0, -130.0, 13.0, -713.0, -1461.0, -350.0, -295.0, -460.0, -1054.0, 134.0, 200.0, -636.0, 68.0, 200.0, -119.0, -691.0, -900.0, 200.0, -174.0, 200.0, -900.0, -361.0, -790.0, -1813.0, -1351.0, 156.0, -1197.0, 200.0, -339.0, -317.0, -130.0, -196.0, -317.0, -372.0, 134.0, -130.0, -317.0, -603.0, -493.0, -735.0, -1197.0, 123.0, -119.0, -625.0, -900.0, 200.0, 200.0, 189.0, -1835.0, -350.0, -537.0, -31.0, 79.0, -295.0, -405.0, -878.0, -911.0, -141.0, -163.0, 200.0, -152.0, -339.0, -394.0, 200.0, -405.0, -1164.0, -658.0, -240.0, -372.0, -1164.0, -471.0, 200.0, -614.0, -97.0, 101.0, 200.0, 90.0, -1384.0, -240.0, 2.0, 200.0, -1472.0, 200.0, -229.0, -174.0, -152.0, 167.0, -889.0, -1054.0, -680.0, -801.0, 79.0, 68.0, 24.0, 200.0, 13.0, 167.0, -306.0, -460.0, -64.0, -273.0, -834.0, -735.0, -735.0, -746.0, -460.0, -251.0, -86.0, -207.0, 123.0, -185.0, 189.0, -196.0, -460.0, -1417.0, -746.0, -1472.0, -592.0, -1219.0, -1032.0, 156.0, -97.0, -97.0, -878.0, 200.0, 200.0, -64.0, -1780.0, -1725.0, -2000.0, -372.0, -1604.0, -207.0, 178.0, -75.0, -1010.0, -317.0, 123.0, 2.0, -1208.0, -1087.0, -1725.0, -1450.0, 200.0, -361.0, -735.0, -614.0, 189.0, 200.0, -1417.0, 200.0, 101.0, 200.0, -878.0, -955.0, -889.0, -735.0, -449.0, -724.0, -2000.0, -1439.0], "policy_predator_policy_reward": [0.0, 210.0, 705.0, 490.0, 0.0, 0.0, 360.0, 615.0, 405.0, 65.0, 330.0, 110.0, 480.0, 75.0, 0.0, 0.0, 420.0, 480.0, 50.0, 120.0, 5.0, 270.0, 180.0, 440.0, 235.0, 525.0, 275.0, 515.0, 165.0, 255.0, 570.0, 760.0, 140.0, 450.0, 185.0, 50.0, 465.0, 505.0, 430.0, 100.0, 145.0, 75.0, 415.0, 755.0, 325.0, 95.0, 525.0, 330.0, 0.0, 30.0, 340.0, 160.0, 145.0, 0.0, 525.0, 225.0, 0.0, 170.0, 435.0, 65.0, 0.0, 545.0, 20.0, 955.0, 475.0, 570.0, 150.0, 115.0, 290.0, 0.0, 125.0, 210.0, 95.0, 165.0, 235.0, 295.0, 285.0, 225.0, 20.0, 690.0, 170.0, 10.0, 490.0, 330.0, 0.0, 0.0, 675.0, 475.0, 215.0, 385.0, 20.0, 130.0, 325.0, 0.0, 265.0, 360.0, 0.0, 200.0, 160.0, 0.0, 125.0, 295.0, 240.0, 35.0, 790.0, 40.0, 0.0, 290.0, 860.0, 170.0, 150.0, 225.0, 75.0, 105.0, 0.0, 50.0, 485.0, 770.0, 35.0, 80.0, 125.0, 665.0, 190.0, 75.0, 85.0, 135.0, 630.0, 200.0, 295.0, 560.0, 40.0, 75.0, 40.0, 40.0, 100.0, 0.0, 255.0, 170.0, 210.0, 100.0, 105.0, 500.0, 475.0, 250.0, 385.0, 155.0, 305.0, 45.0, 155.0, 110.0, 15.0, 175.0, 715.0, 475.0, 935.0, 75.0, 430.0, 655.0, 180.0, 415.0, 80.0, 150.0, 255.0, 280.0, 0.0, 120.0, 55.0, 900.0, 985.0, 710.0, 575.0, 445.0, 5.0, 130.0, 670.0, 0.0, 60.0, 85.0, 15.0, 855.0, 965.0, 0.0, 135.0, 140.0, 260.0, 440.0, 5.0, 0.0, 635.0, 560.0, 20.0, 25.0, 435.0, 460.0, 270.0, 395.0, 105.0, 495.0, 40.0, 1000.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.7002846562197533, "mean_inference_ms": 1.6473316158986782, "mean_action_processing_ms": 0.276477042195556, "mean_env_wait_ms": 0.19591642721617045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004728198051452637, "StateBufferConnector_ms": 0.003408670425415039, "ViewRequirementAgentConnector_ms": 0.108634352684021}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2550.0, "episode_return_mean": -358.82, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 77.83645337646726, "num_env_steps_trained_throughput_per_sec": 77.83645337646726, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 102505.064, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102505.012, "sample_time_ms": 1266.317, "learn_time_ms": 101217.541, "learn_throughput": 39.519, "synch_weights_time_ms": 17.678}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "ed30a_00000", "date": "2024-08-12_15-36-38", "timestamp": 1723491398, "time_this_iter_s": 51.42012166976929, "time_total_s": 4821.780792236328, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b014a1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4821.780792236328, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 39.47397260273972, "ram_util_percent": 81.16849315068494}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.382388830831442, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.110024125361568, "policy_loss": -0.005764880237568702, "vf_loss": 5.1156213947074125, "vf_explained_var": -0.00021132678581924034, "kl": 0.004469459911461519, "entropy": 0.4331770106598183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.186136730007394, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.452038003401782, "policy_loss": -0.01250038481940806, "vf_loss": 5.463956165061426, "vf_explained_var": 0.014548535920955516, "kl": 0.0077629397713900195, "entropy": 1.0304859932137544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2550.0, "episode_reward_mean": -346.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -432.885, "predator_policy": 259.425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-225.0, -659.0, 364.0, -68.0, 226.0, -841.0, 196.0, -200.0, -606.0, -2189.0, 4.0, 126.0, -157.0, -178.0, 22.0, 83.0, -586.0, -1222.0, 184.0, -705.0, 400.0, -496.0, -287.0, 198.0, -375.0, -1164.0, -104.0, 208.0, -313.0, 70.0, -992.0, -322.0, -605.0, -39.0, 184.0, 340.0, -369.0, 317.0, -482.0, -138.0, 235.0, -1113.0, -626.0, 262.0, 304.0, 280.0, -341.0, -27.0, -964.0, -756.0, -171.0, 57.0, 203.0, 183.0, -687.0, -1208.0, -726.0, -281.0, 36.0, -143.0, 256.0, -2550.0, -677.0, -791.0, 238.0, -657.0, 270.0, -1425.0, -2210.0, 114.0, -649.0, 394.0, -22.0, 346.0, -938.0, -959.0, -573.0, -2399.0, 277.0, 354.0, -317.0, 320.0, 133.0, -460.0, 190.0, 161.0, 316.0, -631.0, 375.0, -1736.0, 15.0, -1990.0, 160.0, 59.0, -1981.0, -352.0, -770.0, 400.0, -180.0, -920.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-350.0, -295.0, -460.0, -1054.0, 134.0, 200.0, -636.0, 68.0, 200.0, -119.0, -691.0, -900.0, 200.0, -174.0, 200.0, -900.0, -361.0, -790.0, -1813.0, -1351.0, 156.0, -1197.0, 200.0, -339.0, -317.0, -130.0, -196.0, -317.0, -372.0, 134.0, -130.0, -317.0, -603.0, -493.0, -735.0, -1197.0, 123.0, -119.0, -625.0, -900.0, 200.0, 200.0, 189.0, -1835.0, -350.0, -537.0, -31.0, 79.0, -295.0, -405.0, -878.0, -911.0, -141.0, -163.0, 200.0, -152.0, -339.0, -394.0, 200.0, -405.0, -1164.0, -658.0, -240.0, -372.0, -1164.0, -471.0, 200.0, -614.0, -97.0, 101.0, 200.0, 90.0, -1384.0, -240.0, 2.0, 200.0, -1472.0, 200.0, -229.0, -174.0, -152.0, 167.0, -889.0, -1054.0, -680.0, -801.0, 79.0, 68.0, 24.0, 200.0, 13.0, 167.0, -306.0, -460.0, -64.0, -273.0, -834.0, -735.0, -735.0, -746.0, -460.0, -251.0, -86.0, -207.0, 123.0, -185.0, 189.0, -196.0, -460.0, -1417.0, -746.0, -1472.0, -592.0, -1219.0, -1032.0, 156.0, -97.0, -97.0, -878.0, 200.0, 200.0, -64.0, -1780.0, -1725.0, -2000.0, -372.0, -1604.0, -207.0, 178.0, -75.0, -1010.0, -317.0, 123.0, 2.0, -1208.0, -1087.0, -1725.0, -1450.0, 200.0, -361.0, -735.0, -614.0, 189.0, 200.0, -1417.0, 200.0, 101.0, 200.0, -878.0, -955.0, -889.0, -735.0, -449.0, -724.0, -2000.0, -1439.0, 200.0, -163.0, 79.0, 200.0, 13.0, -1120.0, 79.0, 46.0, 167.0, -284.0, -625.0, -515.0, -185.0, 200.0, -438.0, 134.0, 46.0, 200.0, -823.0, -713.0, 200.0, 90.0, -1307.0, -1659.0, 90.0, -460.0, -1065.0, -1890.0, -130.0, 90.0, -9.0, -97.0, -1362.0, -1439.0, -592.0, -350.0, -856.0, -889.0, 200.0, 200.0, 101.0, -856.0, -1736.0, -64.0], "policy_predator_policy_reward": [325.0, 95.0, 525.0, 330.0, 0.0, 30.0, 340.0, 160.0, 145.0, 0.0, 525.0, 225.0, 0.0, 170.0, 435.0, 65.0, 0.0, 545.0, 20.0, 955.0, 475.0, 570.0, 150.0, 115.0, 290.0, 0.0, 125.0, 210.0, 95.0, 165.0, 235.0, 295.0, 285.0, 225.0, 20.0, 690.0, 170.0, 10.0, 490.0, 330.0, 0.0, 0.0, 675.0, 475.0, 215.0, 385.0, 20.0, 130.0, 325.0, 0.0, 265.0, 360.0, 0.0, 200.0, 160.0, 0.0, 125.0, 295.0, 240.0, 35.0, 790.0, 40.0, 0.0, 290.0, 860.0, 170.0, 150.0, 225.0, 75.0, 105.0, 0.0, 50.0, 485.0, 770.0, 35.0, 80.0, 125.0, 665.0, 190.0, 75.0, 85.0, 135.0, 630.0, 200.0, 295.0, 560.0, 40.0, 75.0, 40.0, 40.0, 100.0, 0.0, 255.0, 170.0, 210.0, 100.0, 105.0, 500.0, 475.0, 250.0, 385.0, 155.0, 305.0, 45.0, 155.0, 110.0, 15.0, 175.0, 715.0, 475.0, 935.0, 75.0, 430.0, 655.0, 180.0, 415.0, 80.0, 150.0, 255.0, 280.0, 0.0, 120.0, 55.0, 900.0, 985.0, 710.0, 575.0, 445.0, 5.0, 130.0, 670.0, 0.0, 60.0, 85.0, 15.0, 855.0, 965.0, 0.0, 135.0, 140.0, 260.0, 440.0, 5.0, 0.0, 635.0, 560.0, 20.0, 25.0, 435.0, 460.0, 270.0, 395.0, 105.0, 495.0, 40.0, 1000.0, 125.0, 115.0, 20.0, 55.0, 595.0, 195.0, 70.0, 125.0, 200.0, 50.0, 205.0, 475.0, 175.0, 0.0, 155.0, 310.0, 70.0, 0.0, 585.0, 320.0, 35.0, 50.0, 385.0, 845.0, 85.0, 300.0, 965.0, 0.0, 175.0, 25.0, 165.0, 0.0, 0.0, 820.0, 270.0, 320.0, 345.0, 630.0, 0.0, 0.0, 325.0, 250.0, 880.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6999436367249467, "mean_inference_ms": 1.6461945727521985, "mean_action_processing_ms": 0.27641520265651387, "mean_env_wait_ms": 0.19576254664955095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004671692848205566, "StateBufferConnector_ms": 0.0034083127975463867, "ViewRequirementAgentConnector_ms": 0.11087095737457275}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2550.0, "episode_return_mean": -346.92, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.95417627187422, "num_env_steps_trained_throughput_per_sec": 79.95417627187422, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 102589.503, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102589.448, "sample_time_ms": 1266.427, "learn_time_ms": 101300.931, "learn_throughput": 39.486, "synch_weights_time_ms": 18.254}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "ed30a_00000", "date": "2024-08-12_15-37-28", "timestamp": 1723491448, "time_this_iter_s": 50.08353090286255, "time_total_s": 4871.864323139191, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b014ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4871.864323139191, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 33.64366197183099, "ram_util_percent": 82.17323943661972}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3454852404890867, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.112022780110596, "policy_loss": -0.007730616016618947, "vf_loss": 6.1196350471052545, "vf_explained_var": 0.002857235215959095, "kl": 0.0063114956420282815, "entropy": 0.423873280816608, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.102749981829729, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.331487092643819, "policy_loss": -0.018031167416099125, "vf_loss": 5.348631156815423, "vf_explained_var": 0.010769116468530484, "kl": 0.011827842510064513, "entropy": 1.0921268198225234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2550.0, "episode_reward_mean": -335.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -433.82, "predator_policy": 266.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [184.0, -705.0, 400.0, -496.0, -287.0, 198.0, -375.0, -1164.0, -104.0, 208.0, -313.0, 70.0, -992.0, -322.0, -605.0, -39.0, 184.0, 340.0, -369.0, 317.0, -482.0, -138.0, 235.0, -1113.0, -626.0, 262.0, 304.0, 280.0, -341.0, -27.0, -964.0, -756.0, -171.0, 57.0, 203.0, 183.0, -687.0, -1208.0, -726.0, -281.0, 36.0, -143.0, 256.0, -2550.0, -677.0, -791.0, 238.0, -657.0, 270.0, -1425.0, -2210.0, 114.0, -649.0, 394.0, -22.0, 346.0, -938.0, -959.0, -573.0, -2399.0, 277.0, 354.0, -317.0, 320.0, 133.0, -460.0, 190.0, 161.0, 316.0, -631.0, 375.0, -1736.0, 15.0, -1990.0, 160.0, 59.0, -1981.0, -352.0, -770.0, 400.0, -180.0, -920.0, -836.0, 66.0, 185.0, 106.0, 128.0, 12.0, 400.0, 204.0, -1387.0, -161.0, -605.0, -255.0, -920.0, -1019.0, -210.0, -493.0, 198.0, -135.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [123.0, -119.0, -625.0, -900.0, 200.0, 200.0, 189.0, -1835.0, -350.0, -537.0, -31.0, 79.0, -295.0, -405.0, -878.0, -911.0, -141.0, -163.0, 200.0, -152.0, -339.0, -394.0, 200.0, -405.0, -1164.0, -658.0, -240.0, -372.0, -1164.0, -471.0, 200.0, -614.0, -97.0, 101.0, 200.0, 90.0, -1384.0, -240.0, 2.0, 200.0, -1472.0, 200.0, -229.0, -174.0, -152.0, 167.0, -889.0, -1054.0, -680.0, -801.0, 79.0, 68.0, 24.0, 200.0, 13.0, 167.0, -306.0, -460.0, -64.0, -273.0, -834.0, -735.0, -735.0, -746.0, -460.0, -251.0, -86.0, -207.0, 123.0, -185.0, 189.0, -196.0, -460.0, -1417.0, -746.0, -1472.0, -592.0, -1219.0, -1032.0, 156.0, -97.0, -97.0, -878.0, 200.0, 200.0, -64.0, -1780.0, -1725.0, -2000.0, -372.0, -1604.0, -207.0, 178.0, -75.0, -1010.0, -317.0, 123.0, 2.0, -1208.0, -1087.0, -1725.0, -1450.0, 200.0, -361.0, -735.0, -614.0, 189.0, 200.0, -1417.0, 200.0, 101.0, 200.0, -878.0, -955.0, -889.0, -735.0, -449.0, -724.0, -2000.0, -1439.0, 200.0, -163.0, 79.0, 200.0, 13.0, -1120.0, 79.0, 46.0, 167.0, -284.0, -625.0, -515.0, -185.0, 200.0, -438.0, 134.0, 46.0, 200.0, -823.0, -713.0, 200.0, 90.0, -1307.0, -1659.0, 90.0, -460.0, -1065.0, -1890.0, -130.0, 90.0, -9.0, -97.0, -1362.0, -1439.0, -592.0, -350.0, -856.0, -889.0, 200.0, 200.0, 101.0, -856.0, -1736.0, -64.0, -196.0, -1780.0, 200.0, -614.0, 24.0, -64.0, 200.0, -339.0, 200.0, -537.0, -1153.0, 200.0, 200.0, 200.0, -372.0, 156.0, -1846.0, -471.0, -262.0, -559.0, -570.0, -680.0, -416.0, -339.0, -713.0, -757.0, -966.0, -768.0, -603.0, -97.0, -130.0, -1263.0, 200.0, -482.0, -427.0, -108.0], "policy_predator_policy_reward": [170.0, 10.0, 490.0, 330.0, 0.0, 0.0, 675.0, 475.0, 215.0, 385.0, 20.0, 130.0, 325.0, 0.0, 265.0, 360.0, 0.0, 200.0, 160.0, 0.0, 125.0, 295.0, 240.0, 35.0, 790.0, 40.0, 0.0, 290.0, 860.0, 170.0, 150.0, 225.0, 75.0, 105.0, 0.0, 50.0, 485.0, 770.0, 35.0, 80.0, 125.0, 665.0, 190.0, 75.0, 85.0, 135.0, 630.0, 200.0, 295.0, 560.0, 40.0, 75.0, 40.0, 40.0, 100.0, 0.0, 255.0, 170.0, 210.0, 100.0, 105.0, 500.0, 475.0, 250.0, 385.0, 155.0, 305.0, 45.0, 155.0, 110.0, 15.0, 175.0, 715.0, 475.0, 935.0, 75.0, 430.0, 655.0, 180.0, 415.0, 80.0, 150.0, 255.0, 280.0, 0.0, 120.0, 55.0, 900.0, 985.0, 710.0, 575.0, 445.0, 5.0, 130.0, 670.0, 0.0, 60.0, 85.0, 15.0, 855.0, 965.0, 0.0, 135.0, 140.0, 260.0, 440.0, 5.0, 0.0, 635.0, 560.0, 20.0, 25.0, 435.0, 460.0, 270.0, 395.0, 105.0, 495.0, 40.0, 1000.0, 125.0, 115.0, 20.0, 55.0, 595.0, 195.0, 70.0, 125.0, 200.0, 50.0, 205.0, 475.0, 175.0, 0.0, 155.0, 310.0, 70.0, 0.0, 585.0, 320.0, 35.0, 50.0, 385.0, 845.0, 85.0, 300.0, 965.0, 0.0, 175.0, 25.0, 165.0, 0.0, 0.0, 820.0, 270.0, 320.0, 345.0, 630.0, 0.0, 0.0, 325.0, 250.0, 880.0, 0.0, 865.0, 275.0, 170.0, 310.0, 105.0, 120.0, 245.0, 0.0, 335.0, 130.0, 605.0, 360.0, 0.0, 0.0, 280.0, 140.0, 0.0, 930.0, 335.0, 325.0, 155.0, 490.0, 305.0, 195.0, 365.0, 185.0, 10.0, 705.0, 205.0, 285.0, 475.0, 425.0, 305.0, 175.0, 245.0, 155.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6998538073406533, "mean_inference_ms": 1.645648605533391, "mean_action_processing_ms": 0.2764225330975934, "mean_env_wait_ms": 0.19571342553325016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004605650901794434, "StateBufferConnector_ms": 0.003333449363708496, "ViewRequirementAgentConnector_ms": 0.10788679122924805}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2550.0, "episode_return_mean": -335.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 78.16640386733519, "num_env_steps_trained_throughput_per_sec": 78.16640386733519, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 102834.234, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102834.179, "sample_time_ms": 1269.336, "learn_time_ms": 101542.689, "learn_throughput": 39.392, "synch_weights_time_ms": 18.489}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "ed30a_00000", "date": "2024-08-12_15-38-19", "timestamp": 1723491499, "time_this_iter_s": 51.218613147735596, "time_total_s": 4923.082936286926, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0090dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4923.082936286926, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 40.195890410958896, "ram_util_percent": 82.55616438356165}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5402904072608898, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.991381077287058, "policy_loss": -0.008266451338148385, "vf_loss": 3.999519140505917, "vf_explained_var": 0.002127218561828452, "kl": 0.006847620802876226, "entropy": 0.49593543315690664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.560223172360628, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.607320480624204, "policy_loss": -0.016178834413932194, "vf_loss": 4.6228056702033555, "vf_explained_var": 0.013090617000741303, "kl": 0.009248426539736544, "entropy": 1.0393212796203675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2550.0, "episode_reward_mean": -364.58, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -453.565, "predator_policy": 271.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1113.0, -626.0, 262.0, 304.0, 280.0, -341.0, -27.0, -964.0, -756.0, -171.0, 57.0, 203.0, 183.0, -687.0, -1208.0, -726.0, -281.0, 36.0, -143.0, 256.0, -2550.0, -677.0, -791.0, 238.0, -657.0, 270.0, -1425.0, -2210.0, 114.0, -649.0, 394.0, -22.0, 346.0, -938.0, -959.0, -573.0, -2399.0, 277.0, 354.0, -317.0, 320.0, 133.0, -460.0, 190.0, 161.0, 316.0, -631.0, 375.0, -1736.0, 15.0, -1990.0, 160.0, 59.0, -1981.0, -352.0, -770.0, 400.0, -180.0, -920.0, -836.0, 66.0, 185.0, 106.0, 128.0, 12.0, 400.0, 204.0, -1387.0, -161.0, -605.0, -255.0, -920.0, -1019.0, -210.0, -493.0, 198.0, -135.0, 217.0, -1191.0, -60.0, 346.0, 274.0, -1323.0, -392.0, -123.0, 352.0, -36.0, 400.0, -2064.0, -348.0, -213.0, -1444.0, 400.0, -977.0, -1655.0, 66.0, -293.0, 55.0, 400.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-889.0, -1054.0, -680.0, -801.0, 79.0, 68.0, 24.0, 200.0, 13.0, 167.0, -306.0, -460.0, -64.0, -273.0, -834.0, -735.0, -735.0, -746.0, -460.0, -251.0, -86.0, -207.0, 123.0, -185.0, 189.0, -196.0, -460.0, -1417.0, -746.0, -1472.0, -592.0, -1219.0, -1032.0, 156.0, -97.0, -97.0, -878.0, 200.0, 200.0, -64.0, -1780.0, -1725.0, -2000.0, -372.0, -1604.0, -207.0, 178.0, -75.0, -1010.0, -317.0, 123.0, 2.0, -1208.0, -1087.0, -1725.0, -1450.0, 200.0, -361.0, -735.0, -614.0, 189.0, 200.0, -1417.0, 200.0, 101.0, 200.0, -878.0, -955.0, -889.0, -735.0, -449.0, -724.0, -2000.0, -1439.0, 200.0, -163.0, 79.0, 200.0, 13.0, -1120.0, 79.0, 46.0, 167.0, -284.0, -625.0, -515.0, -185.0, 200.0, -438.0, 134.0, 46.0, 200.0, -823.0, -713.0, 200.0, 90.0, -1307.0, -1659.0, 90.0, -460.0, -1065.0, -1890.0, -130.0, 90.0, -9.0, -97.0, -1362.0, -1439.0, -592.0, -350.0, -856.0, -889.0, 200.0, 200.0, 101.0, -856.0, -1736.0, -64.0, -196.0, -1780.0, 200.0, -614.0, 24.0, -64.0, 200.0, -339.0, 200.0, -537.0, -1153.0, 200.0, 200.0, 200.0, -372.0, 156.0, -1846.0, -471.0, -262.0, -559.0, -570.0, -680.0, -416.0, -339.0, -713.0, -757.0, -966.0, -768.0, -603.0, -97.0, -130.0, -1263.0, 200.0, -482.0, -427.0, -108.0, -273.0, 200.0, -1120.0, -1131.0, -537.0, 2.0, 200.0, 101.0, -31.0, 200.0, -1164.0, -1164.0, -328.0, -669.0, -1230.0, 112.0, 112.0, 200.0, -372.0, -9.0, 200.0, 200.0, -1527.0, -1637.0, -757.0, -251.0, -757.0, 79.0, -856.0, -1978.0, 200.0, 200.0, -801.0, -801.0, -1439.0, -1296.0, -240.0, -9.0, -251.0, -427.0, -163.0, -97.0, 200.0, 200.0, 200.0, 200.0], "policy_predator_policy_reward": [630.0, 200.0, 295.0, 560.0, 40.0, 75.0, 40.0, 40.0, 100.0, 0.0, 255.0, 170.0, 210.0, 100.0, 105.0, 500.0, 475.0, 250.0, 385.0, 155.0, 305.0, 45.0, 155.0, 110.0, 15.0, 175.0, 715.0, 475.0, 935.0, 75.0, 430.0, 655.0, 180.0, 415.0, 80.0, 150.0, 255.0, 280.0, 0.0, 120.0, 55.0, 900.0, 985.0, 710.0, 575.0, 445.0, 5.0, 130.0, 670.0, 0.0, 60.0, 85.0, 15.0, 855.0, 965.0, 0.0, 135.0, 140.0, 260.0, 440.0, 5.0, 0.0, 635.0, 560.0, 20.0, 25.0, 435.0, 460.0, 270.0, 395.0, 105.0, 495.0, 40.0, 1000.0, 125.0, 115.0, 20.0, 55.0, 595.0, 195.0, 70.0, 125.0, 200.0, 50.0, 205.0, 475.0, 175.0, 0.0, 155.0, 310.0, 70.0, 0.0, 585.0, 320.0, 35.0, 50.0, 385.0, 845.0, 85.0, 300.0, 965.0, 0.0, 175.0, 25.0, 165.0, 0.0, 0.0, 820.0, 270.0, 320.0, 345.0, 630.0, 0.0, 0.0, 325.0, 250.0, 880.0, 0.0, 865.0, 275.0, 170.0, 310.0, 105.0, 120.0, 245.0, 0.0, 335.0, 130.0, 605.0, 360.0, 0.0, 0.0, 280.0, 140.0, 0.0, 930.0, 335.0, 325.0, 155.0, 490.0, 305.0, 195.0, 365.0, 185.0, 10.0, 705.0, 205.0, 285.0, 475.0, 425.0, 305.0, 175.0, 245.0, 155.0, 140.0, 150.0, 455.0, 605.0, 235.0, 240.0, 45.0, 0.0, 40.0, 65.0, 460.0, 545.0, 425.0, 180.0, 545.0, 450.0, 0.0, 40.0, 30.0, 315.0, 0.0, 0.0, 935.0, 165.0, 165.0, 495.0, 25.0, 440.0, 430.0, 960.0, 0.0, 0.0, 445.0, 180.0, 715.0, 365.0, 200.0, 115.0, 65.0, 320.0, 155.0, 160.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6999176329906958, "mean_inference_ms": 1.6450143598406641, "mean_action_processing_ms": 0.27643700755128964, "mean_env_wait_ms": 0.19570489144859324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004616498947143555, "StateBufferConnector_ms": 0.00335538387298584, "ViewRequirementAgentConnector_ms": 0.11537051200866699}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2550.0, "episode_return_mean": -364.58, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.92141082429677, "num_env_steps_trained_throughput_per_sec": 81.92141082429677, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 102798.486, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102798.414, "sample_time_ms": 1273.704, "learn_time_ms": 101502.321, "learn_throughput": 39.408, "synch_weights_time_ms": 18.592}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "ed30a_00000", "date": "2024-08-12_15-39-08", "timestamp": 1723491548, "time_this_iter_s": 48.85619497299194, "time_total_s": 4971.939131259918, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4971.939131259918, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 34.42142857142857, "ram_util_percent": 82.48285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.302501002411363, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.570973464799306, "policy_loss": -0.00630053570531013, "vf_loss": 4.577174531593524, "vf_explained_var": 0.000660720704093812, "kl": 0.005304391134704351, "entropy": 0.449643358414766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.551911812926096, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.896544650244334, "policy_loss": -0.012766037033082395, "vf_loss": 4.908524862799064, "vf_explained_var": 0.013867754217178103, "kl": 0.010477543947726684, "entropy": 1.032549743898331, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2701.0, "episode_reward_mean": -386.93, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -459.615, "predator_policy": 266.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-143.0, 256.0, -2550.0, -677.0, -791.0, 238.0, -657.0, 270.0, -1425.0, -2210.0, 114.0, -649.0, 394.0, -22.0, 346.0, -938.0, -959.0, -573.0, -2399.0, 277.0, 354.0, -317.0, 320.0, 133.0, -460.0, 190.0, 161.0, 316.0, -631.0, 375.0, -1736.0, 15.0, -1990.0, 160.0, 59.0, -1981.0, -352.0, -770.0, 400.0, -180.0, -920.0, -836.0, 66.0, 185.0, 106.0, 128.0, 12.0, 400.0, 204.0, -1387.0, -161.0, -605.0, -255.0, -920.0, -1019.0, -210.0, -493.0, 198.0, -135.0, 217.0, -1191.0, -60.0, 346.0, 274.0, -1323.0, -392.0, -123.0, 352.0, -36.0, 400.0, -2064.0, -348.0, -213.0, -1444.0, 400.0, -977.0, -1655.0, 66.0, -293.0, 55.0, 400.0, 400.0, -1287.0, 201.0, -1182.0, -788.0, 358.0, -1026.0, -140.0, 34.0, 388.0, -2701.0, 115.0, 112.0, 208.0, -1218.0, 76.0, -525.0, -247.0, -188.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-878.0, 200.0, 200.0, -64.0, -1780.0, -1725.0, -2000.0, -372.0, -1604.0, -207.0, 178.0, -75.0, -1010.0, -317.0, 123.0, 2.0, -1208.0, -1087.0, -1725.0, -1450.0, 200.0, -361.0, -735.0, -614.0, 189.0, 200.0, -1417.0, 200.0, 101.0, 200.0, -878.0, -955.0, -889.0, -735.0, -449.0, -724.0, -2000.0, -1439.0, 200.0, -163.0, 79.0, 200.0, 13.0, -1120.0, 79.0, 46.0, 167.0, -284.0, -625.0, -515.0, -185.0, 200.0, -438.0, 134.0, 46.0, 200.0, -823.0, -713.0, 200.0, 90.0, -1307.0, -1659.0, 90.0, -460.0, -1065.0, -1890.0, -130.0, 90.0, -9.0, -97.0, -1362.0, -1439.0, -592.0, -350.0, -856.0, -889.0, 200.0, 200.0, 101.0, -856.0, -1736.0, -64.0, -196.0, -1780.0, 200.0, -614.0, 24.0, -64.0, 200.0, -339.0, 200.0, -537.0, -1153.0, 200.0, 200.0, 200.0, -372.0, 156.0, -1846.0, -471.0, -262.0, -559.0, -570.0, -680.0, -416.0, -339.0, -713.0, -757.0, -966.0, -768.0, -603.0, -97.0, -130.0, -1263.0, 200.0, -482.0, -427.0, -108.0, -273.0, 200.0, -1120.0, -1131.0, -537.0, 2.0, 200.0, 101.0, -31.0, 200.0, -1164.0, -1164.0, -328.0, -669.0, -1230.0, 112.0, 112.0, 200.0, -372.0, -9.0, 200.0, 200.0, -1527.0, -1637.0, -757.0, -251.0, -757.0, 79.0, -856.0, -1978.0, 200.0, 200.0, -801.0, -801.0, -1439.0, -1296.0, -240.0, -9.0, -251.0, -427.0, -163.0, -97.0, 200.0, 200.0, 200.0, 200.0, -1098.0, -944.0, -141.0, 167.0, -933.0, -1274.0, -944.0, -559.0, 123.0, 200.0, -900.0, -1351.0, -339.0, -141.0, 189.0, -460.0, 200.0, 178.0, -1747.0, -1989.0, -42.0, -53.0, 13.0, -141.0, 200.0, -152.0, -900.0, -933.0, 200.0, -394.0, -394.0, -416.0, 178.0, -1010.0, 200.0, -878.0], "policy_predator_policy_reward": [255.0, 280.0, 0.0, 120.0, 55.0, 900.0, 985.0, 710.0, 575.0, 445.0, 5.0, 130.0, 670.0, 0.0, 60.0, 85.0, 15.0, 855.0, 965.0, 0.0, 135.0, 140.0, 260.0, 440.0, 5.0, 0.0, 635.0, 560.0, 20.0, 25.0, 435.0, 460.0, 270.0, 395.0, 105.0, 495.0, 40.0, 1000.0, 125.0, 115.0, 20.0, 55.0, 595.0, 195.0, 70.0, 125.0, 200.0, 50.0, 205.0, 475.0, 175.0, 0.0, 155.0, 310.0, 70.0, 0.0, 585.0, 320.0, 35.0, 50.0, 385.0, 845.0, 85.0, 300.0, 965.0, 0.0, 175.0, 25.0, 165.0, 0.0, 0.0, 820.0, 270.0, 320.0, 345.0, 630.0, 0.0, 0.0, 325.0, 250.0, 880.0, 0.0, 865.0, 275.0, 170.0, 310.0, 105.0, 120.0, 245.0, 0.0, 335.0, 130.0, 605.0, 360.0, 0.0, 0.0, 280.0, 140.0, 0.0, 930.0, 335.0, 325.0, 155.0, 490.0, 305.0, 195.0, 365.0, 185.0, 10.0, 705.0, 205.0, 285.0, 475.0, 425.0, 305.0, 175.0, 245.0, 155.0, 140.0, 150.0, 455.0, 605.0, 235.0, 240.0, 45.0, 0.0, 40.0, 65.0, 460.0, 545.0, 425.0, 180.0, 545.0, 450.0, 0.0, 40.0, 30.0, 315.0, 0.0, 0.0, 935.0, 165.0, 165.0, 495.0, 25.0, 440.0, 430.0, 960.0, 0.0, 0.0, 445.0, 180.0, 715.0, 365.0, 200.0, 115.0, 65.0, 320.0, 155.0, 160.0, 0.0, 0.0, 0.0, 0.0, 680.0, 75.0, 145.0, 30.0, 545.0, 480.0, 265.0, 450.0, 35.0, 0.0, 330.0, 895.0, 340.0, 0.0, 0.0, 305.0, 10.0, 0.0, 1000.0, 35.0, 210.0, 0.0, 145.0, 95.0, 160.0, 0.0, 615.0, 0.0, 265.0, 5.0, 270.0, 15.0, 175.0, 410.0, 20.0, 470.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6997066883538422, "mean_inference_ms": 1.6438275151193051, "mean_action_processing_ms": 0.27634810494245304, "mean_env_wait_ms": 0.19558263812066554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035752058029174805, "StateBufferConnector_ms": 0.003205418586730957, "ViewRequirementAgentConnector_ms": 0.11216425895690918}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2701.0, "episode_return_mean": -386.93, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.12503268291425, "num_env_steps_trained_throughput_per_sec": 82.12503268291425, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 102671.556, "restore_workers_time_ms": 0.015, "training_step_time_ms": 102671.483, "sample_time_ms": 1280.55, "learn_time_ms": 101369.0, "learn_throughput": 39.46, "synch_weights_time_ms": 18.058}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "ed30a_00000", "date": "2024-08-12_15-39-57", "timestamp": 1723491597, "time_this_iter_s": 48.74348187446594, "time_total_s": 5020.682613134384, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2125d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5020.682613134384, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 31.81304347826087, "ram_util_percent": 82.85217391304349}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7950405667698572, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7708069289172137, "policy_loss": -0.009312470373081624, "vf_loss": 3.7799750228407523, "vf_explained_var": 0.0005956698977758014, "kl": 0.007699892152267542, "entropy": 0.5485249977105509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.646398908404446, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.834959783125176, "policy_loss": -0.015549664738928042, "vf_loss": 3.849602357420341, "vf_explained_var": 0.016216219922222157, "kl": 0.0120945133469759, "entropy": 1.0604257169854705, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2701.0, "episode_reward_mean": -244.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1989.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -352.695, "predator_policy": 230.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [320.0, 133.0, -460.0, 190.0, 161.0, 316.0, -631.0, 375.0, -1736.0, 15.0, -1990.0, 160.0, 59.0, -1981.0, -352.0, -770.0, 400.0, -180.0, -920.0, -836.0, 66.0, 185.0, 106.0, 128.0, 12.0, 400.0, 204.0, -1387.0, -161.0, -605.0, -255.0, -920.0, -1019.0, -210.0, -493.0, 198.0, -135.0, 217.0, -1191.0, -60.0, 346.0, 274.0, -1323.0, -392.0, -123.0, 352.0, -36.0, 400.0, -2064.0, -348.0, -213.0, -1444.0, 400.0, -977.0, -1655.0, 66.0, -293.0, 55.0, 400.0, 400.0, -1287.0, 201.0, -1182.0, -788.0, 358.0, -1026.0, -140.0, 34.0, 388.0, -2701.0, 115.0, 112.0, 208.0, -1218.0, 76.0, -525.0, -247.0, -188.0, 22.0, 160.0, -20.0, 400.0, 316.0, -490.0, -127.0, 189.0, 400.0, 85.0, 400.0, 350.0, 214.0, 166.0, 124.0, -394.0, 346.0, -307.0, -180.0, 268.0, 82.0, 204.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [79.0, 46.0, 167.0, -284.0, -625.0, -515.0, -185.0, 200.0, -438.0, 134.0, 46.0, 200.0, -823.0, -713.0, 200.0, 90.0, -1307.0, -1659.0, 90.0, -460.0, -1065.0, -1890.0, -130.0, 90.0, -9.0, -97.0, -1362.0, -1439.0, -592.0, -350.0, -856.0, -889.0, 200.0, 200.0, 101.0, -856.0, -1736.0, -64.0, -196.0, -1780.0, 200.0, -614.0, 24.0, -64.0, 200.0, -339.0, 200.0, -537.0, -1153.0, 200.0, 200.0, 200.0, -372.0, 156.0, -1846.0, -471.0, -262.0, -559.0, -570.0, -680.0, -416.0, -339.0, -713.0, -757.0, -966.0, -768.0, -603.0, -97.0, -130.0, -1263.0, 200.0, -482.0, -427.0, -108.0, -273.0, 200.0, -1120.0, -1131.0, -537.0, 2.0, 200.0, 101.0, -31.0, 200.0, -1164.0, -1164.0, -328.0, -669.0, -1230.0, 112.0, 112.0, 200.0, -372.0, -9.0, 200.0, 200.0, -1527.0, -1637.0, -757.0, -251.0, -757.0, 79.0, -856.0, -1978.0, 200.0, 200.0, -801.0, -801.0, -1439.0, -1296.0, -240.0, -9.0, -251.0, -427.0, -163.0, -97.0, 200.0, 200.0, 200.0, 200.0, -1098.0, -944.0, -141.0, 167.0, -933.0, -1274.0, -944.0, -559.0, 123.0, 200.0, -900.0, -1351.0, -339.0, -141.0, 189.0, -460.0, 200.0, 178.0, -1747.0, -1989.0, -42.0, -53.0, 13.0, -141.0, 200.0, -152.0, -900.0, -933.0, 200.0, -394.0, -394.0, -416.0, 178.0, -1010.0, 200.0, -878.0, -493.0, 200.0, 2.0, -317.0, -482.0, 112.0, 200.0, 200.0, 200.0, 46.0, -812.0, -438.0, 200.0, -812.0, 200.0, -251.0, 200.0, 200.0, 101.0, -306.0, 200.0, 200.0, 200.0, 90.0, -141.0, 200.0, -229.0, 200.0, -284.0, 178.0, -955.0, -339.0, 112.0, 189.0, -240.0, -317.0, -31.0, -1164.0, 13.0, 145.0, 200.0, -383.0, 200.0, -306.0], "policy_predator_policy_reward": [70.0, 125.0, 200.0, 50.0, 205.0, 475.0, 175.0, 0.0, 155.0, 310.0, 70.0, 0.0, 585.0, 320.0, 35.0, 50.0, 385.0, 845.0, 85.0, 300.0, 965.0, 0.0, 175.0, 25.0, 165.0, 0.0, 0.0, 820.0, 270.0, 320.0, 345.0, 630.0, 0.0, 0.0, 325.0, 250.0, 880.0, 0.0, 865.0, 275.0, 170.0, 310.0, 105.0, 120.0, 245.0, 0.0, 335.0, 130.0, 605.0, 360.0, 0.0, 0.0, 280.0, 140.0, 0.0, 930.0, 335.0, 325.0, 155.0, 490.0, 305.0, 195.0, 365.0, 185.0, 10.0, 705.0, 205.0, 285.0, 475.0, 425.0, 305.0, 175.0, 245.0, 155.0, 140.0, 150.0, 455.0, 605.0, 235.0, 240.0, 45.0, 0.0, 40.0, 65.0, 460.0, 545.0, 425.0, 180.0, 545.0, 450.0, 0.0, 40.0, 30.0, 315.0, 0.0, 0.0, 935.0, 165.0, 165.0, 495.0, 25.0, 440.0, 430.0, 960.0, 0.0, 0.0, 445.0, 180.0, 715.0, 365.0, 200.0, 115.0, 65.0, 320.0, 155.0, 160.0, 0.0, 0.0, 0.0, 0.0, 680.0, 75.0, 145.0, 30.0, 545.0, 480.0, 265.0, 450.0, 35.0, 0.0, 330.0, 895.0, 340.0, 0.0, 0.0, 305.0, 10.0, 0.0, 1000.0, 35.0, 210.0, 0.0, 145.0, 95.0, 160.0, 0.0, 615.0, 0.0, 265.0, 5.0, 270.0, 15.0, 175.0, 410.0, 20.0, 470.0, 230.0, 85.0, 210.0, 265.0, 50.0, 300.0, 0.0, 0.0, 0.0, 70.0, 10.0, 750.0, 45.0, 440.0, 195.0, 45.0, 0.0, 0.0, 75.0, 215.0, 0.0, 0.0, 30.0, 30.0, 0.0, 155.0, 160.0, 35.0, 230.0, 0.0, 385.0, 515.0, 45.0, 0.0, 240.0, 10.0, 615.0, 400.0, 0.0, 110.0, 20.0, 245.0, 85.0, 225.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6991565647701747, "mean_inference_ms": 1.6413029253465763, "mean_action_processing_ms": 0.27614230058519756, "mean_env_wait_ms": 0.1953848035317183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033777952194213867, "StateBufferConnector_ms": 0.0029668807983398438, "ViewRequirementAgentConnector_ms": 0.09939122200012207}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2701.0, "episode_return_mean": -244.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.10852936166137, "num_env_steps_trained_throughput_per_sec": 81.10852936166137, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 102483.921, "restore_workers_time_ms": 0.014, "training_step_time_ms": 102483.85, "sample_time_ms": 1285.959, "learn_time_ms": 101175.061, "learn_throughput": 39.535, "synch_weights_time_ms": 19.168}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "ed30a_00000", "date": "2024-08-12_15-40-46", "timestamp": 1723491646, "time_this_iter_s": 49.346879959106445, "time_total_s": 5070.029493093491, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0072430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5070.029493093491, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 34.34285714285714, "ram_util_percent": 83.00714285714287}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6074122826731394, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.721565572925345, "policy_loss": -0.007086410089740875, "vf_loss": 4.7285248506636846, "vf_explained_var": 0.00020232020862518795, "kl": 0.006779856695146721, "entropy": 0.5412448943134338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.365027054655489, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.374079013627673, "policy_loss": -0.014904100687499281, "vf_loss": 5.388207868041185, "vf_explained_var": 0.01394723546568048, "kl": 0.010336524225949205, "entropy": 0.9697145845524218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2701.0, "episode_reward_mean": -255.17, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1989.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -359.735, "predator_policy": 232.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.0, -836.0, 66.0, 185.0, 106.0, 128.0, 12.0, 400.0, 204.0, -1387.0, -161.0, -605.0, -255.0, -920.0, -1019.0, -210.0, -493.0, 198.0, -135.0, 217.0, -1191.0, -60.0, 346.0, 274.0, -1323.0, -392.0, -123.0, 352.0, -36.0, 400.0, -2064.0, -348.0, -213.0, -1444.0, 400.0, -977.0, -1655.0, 66.0, -293.0, 55.0, 400.0, 400.0, -1287.0, 201.0, -1182.0, -788.0, 358.0, -1026.0, -140.0, 34.0, 388.0, -2701.0, 115.0, 112.0, 208.0, -1218.0, 76.0, -525.0, -247.0, -188.0, 22.0, 160.0, -20.0, 400.0, 316.0, -490.0, -127.0, 189.0, 400.0, 85.0, 400.0, 350.0, 214.0, 166.0, 124.0, -394.0, 346.0, -307.0, -180.0, 268.0, 82.0, 204.0, -191.0, -505.0, 100.0, -312.0, -320.0, -473.0, 400.0, -1772.0, 161.0, 58.0, 226.0, -1246.0, -662.0, -1601.0, 333.0, -990.0, 280.0, -550.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1736.0, -64.0, -196.0, -1780.0, 200.0, -614.0, 24.0, -64.0, 200.0, -339.0, 200.0, -537.0, -1153.0, 200.0, 200.0, 200.0, -372.0, 156.0, -1846.0, -471.0, -262.0, -559.0, -570.0, -680.0, -416.0, -339.0, -713.0, -757.0, -966.0, -768.0, -603.0, -97.0, -130.0, -1263.0, 200.0, -482.0, -427.0, -108.0, -273.0, 200.0, -1120.0, -1131.0, -537.0, 2.0, 200.0, 101.0, -31.0, 200.0, -1164.0, -1164.0, -328.0, -669.0, -1230.0, 112.0, 112.0, 200.0, -372.0, -9.0, 200.0, 200.0, -1527.0, -1637.0, -757.0, -251.0, -757.0, 79.0, -856.0, -1978.0, 200.0, 200.0, -801.0, -801.0, -1439.0, -1296.0, -240.0, -9.0, -251.0, -427.0, -163.0, -97.0, 200.0, 200.0, 200.0, 200.0, -1098.0, -944.0, -141.0, 167.0, -933.0, -1274.0, -944.0, -559.0, 123.0, 200.0, -900.0, -1351.0, -339.0, -141.0, 189.0, -460.0, 200.0, 178.0, -1747.0, -1989.0, -42.0, -53.0, 13.0, -141.0, 200.0, -152.0, -900.0, -933.0, 200.0, -394.0, -394.0, -416.0, 178.0, -1010.0, 200.0, -878.0, -493.0, 200.0, 2.0, -317.0, -482.0, 112.0, 200.0, 200.0, 200.0, 46.0, -812.0, -438.0, 200.0, -812.0, 200.0, -251.0, 200.0, 200.0, 101.0, -306.0, 200.0, 200.0, 200.0, 90.0, -141.0, 200.0, -229.0, 200.0, -284.0, 178.0, -955.0, -339.0, 112.0, 189.0, -240.0, -317.0, -31.0, -1164.0, 13.0, 145.0, 200.0, -383.0, 200.0, -306.0, -218.0, -218.0, -75.0, -1395.0, -9.0, -31.0, 200.0, -1307.0, 134.0, -999.0, -328.0, -790.0, 200.0, 200.0, -999.0, -1593.0, -20.0, 46.0, 57.0, -284.0, -119.0, 200.0, -1461.0, -735.0, -548.0, -614.0, -1351.0, -1065.0, 178.0, 35.0, -614.0, -1076.0, -240.0, 200.0, 145.0, -1615.0], "policy_predator_policy_reward": [880.0, 0.0, 865.0, 275.0, 170.0, 310.0, 105.0, 120.0, 245.0, 0.0, 335.0, 130.0, 605.0, 360.0, 0.0, 0.0, 280.0, 140.0, 0.0, 930.0, 335.0, 325.0, 155.0, 490.0, 305.0, 195.0, 365.0, 185.0, 10.0, 705.0, 205.0, 285.0, 475.0, 425.0, 305.0, 175.0, 245.0, 155.0, 140.0, 150.0, 455.0, 605.0, 235.0, 240.0, 45.0, 0.0, 40.0, 65.0, 460.0, 545.0, 425.0, 180.0, 545.0, 450.0, 0.0, 40.0, 30.0, 315.0, 0.0, 0.0, 935.0, 165.0, 165.0, 495.0, 25.0, 440.0, 430.0, 960.0, 0.0, 0.0, 445.0, 180.0, 715.0, 365.0, 200.0, 115.0, 65.0, 320.0, 155.0, 160.0, 0.0, 0.0, 0.0, 0.0, 680.0, 75.0, 145.0, 30.0, 545.0, 480.0, 265.0, 450.0, 35.0, 0.0, 330.0, 895.0, 340.0, 0.0, 0.0, 305.0, 10.0, 0.0, 1000.0, 35.0, 210.0, 0.0, 145.0, 95.0, 160.0, 0.0, 615.0, 0.0, 265.0, 5.0, 270.0, 15.0, 175.0, 410.0, 20.0, 470.0, 230.0, 85.0, 210.0, 265.0, 50.0, 300.0, 0.0, 0.0, 0.0, 70.0, 10.0, 750.0, 45.0, 440.0, 195.0, 45.0, 0.0, 0.0, 75.0, 215.0, 0.0, 0.0, 30.0, 30.0, 0.0, 155.0, 160.0, 35.0, 230.0, 0.0, 385.0, 515.0, 45.0, 0.0, 240.0, 10.0, 615.0, 400.0, 0.0, 110.0, 20.0, 245.0, 85.0, 225.0, 180.0, 65.0, 525.0, 440.0, 105.0, 35.0, 305.0, 490.0, 0.0, 545.0, 205.0, 440.0, 0.0, 0.0, 0.0, 820.0, 0.0, 135.0, 255.0, 30.0, 0.0, 145.0, 0.0, 950.0, 125.0, 375.0, 75.0, 740.0, 75.0, 45.0, 185.0, 515.0, 200.0, 120.0, 205.0, 715.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6988812089264982, "mean_inference_ms": 1.6401710607062927, "mean_action_processing_ms": 0.275940614897508, "mean_env_wait_ms": 0.19524715809327886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003576993942260742, "StateBufferConnector_ms": 0.0030089616775512695, "ViewRequirementAgentConnector_ms": 0.1019134521484375}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2701.0, "episode_return_mean": -255.17, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 79.43057593807121, "num_env_steps_trained_throughput_per_sec": 79.43057593807121, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 102508.164, "restore_workers_time_ms": 0.014, "training_step_time_ms": 102508.094, "sample_time_ms": 1297.886, "learn_time_ms": 101187.619, "learn_throughput": 39.531, "synch_weights_time_ms": 18.968}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "ed30a_00000", "date": "2024-08-12_15-41-37", "timestamp": 1723491697, "time_this_iter_s": 50.38740277290344, "time_total_s": 5120.416895866394, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2125f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5120.416895866394, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.39295774647886, "ram_util_percent": 83.11549295774648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.587364442812072, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.274500534774134, "policy_loss": -0.007136339710276357, "vf_loss": 4.281445652971823, "vf_explained_var": 0.0002942547280952413, "kl": 0.010198841918839895, "entropy": 0.5164719145607065, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.52460882360973, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.242762129142801, "policy_loss": -0.016858661300921566, "vf_loss": 4.2586754501181305, "vf_explained_var": 0.015002454020989636, "kl": 0.012604537651477368, "entropy": 0.9655178861327903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2701.0, "episode_reward_mean": -242.56, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1989.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -336.58, "predator_policy": 215.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [274.0, -1323.0, -392.0, -123.0, 352.0, -36.0, 400.0, -2064.0, -348.0, -213.0, -1444.0, 400.0, -977.0, -1655.0, 66.0, -293.0, 55.0, 400.0, 400.0, -1287.0, 201.0, -1182.0, -788.0, 358.0, -1026.0, -140.0, 34.0, 388.0, -2701.0, 115.0, 112.0, 208.0, -1218.0, 76.0, -525.0, -247.0, -188.0, 22.0, 160.0, -20.0, 400.0, 316.0, -490.0, -127.0, 189.0, 400.0, 85.0, 400.0, 350.0, 214.0, 166.0, 124.0, -394.0, 346.0, -307.0, -180.0, 268.0, 82.0, 204.0, -191.0, -505.0, 100.0, -312.0, -320.0, -473.0, 400.0, -1772.0, 161.0, 58.0, 226.0, -1246.0, -662.0, -1601.0, 333.0, -990.0, 280.0, -550.0, 400.0, -668.0, 9.0, -734.0, -580.0, 376.0, 61.0, 312.0, 310.0, 340.0, 298.0, -2516.0, -80.0, 351.0, 394.0, 352.0, -252.0, -78.0, -44.0, -1751.0, -244.0, -1395.0, 70.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-31.0, 200.0, -1164.0, -1164.0, -328.0, -669.0, -1230.0, 112.0, 112.0, 200.0, -372.0, -9.0, 200.0, 200.0, -1527.0, -1637.0, -757.0, -251.0, -757.0, 79.0, -856.0, -1978.0, 200.0, 200.0, -801.0, -801.0, -1439.0, -1296.0, -240.0, -9.0, -251.0, -427.0, -163.0, -97.0, 200.0, 200.0, 200.0, 200.0, -1098.0, -944.0, -141.0, 167.0, -933.0, -1274.0, -944.0, -559.0, 123.0, 200.0, -900.0, -1351.0, -339.0, -141.0, 189.0, -460.0, 200.0, 178.0, -1747.0, -1989.0, -42.0, -53.0, 13.0, -141.0, 200.0, -152.0, -900.0, -933.0, 200.0, -394.0, -394.0, -416.0, 178.0, -1010.0, 200.0, -878.0, -493.0, 200.0, 2.0, -317.0, -482.0, 112.0, 200.0, 200.0, 200.0, 46.0, -812.0, -438.0, 200.0, -812.0, 200.0, -251.0, 200.0, 200.0, 101.0, -306.0, 200.0, 200.0, 200.0, 90.0, -141.0, 200.0, -229.0, 200.0, -284.0, 178.0, -955.0, -339.0, 112.0, 189.0, -240.0, -317.0, -31.0, -1164.0, 13.0, 145.0, 200.0, -383.0, 200.0, -306.0, -218.0, -218.0, -75.0, -1395.0, -9.0, -31.0, 200.0, -1307.0, 134.0, -999.0, -328.0, -790.0, 200.0, 200.0, -999.0, -1593.0, -20.0, 46.0, 57.0, -284.0, -119.0, 200.0, -1461.0, -735.0, -548.0, -614.0, -1351.0, -1065.0, 178.0, 35.0, -614.0, -1076.0, -240.0, 200.0, 145.0, -1615.0, 200.0, 200.0, -1527.0, -31.0, 167.0, -493.0, -350.0, -944.0, -515.0, -625.0, 178.0, 178.0, -504.0, -130.0, 156.0, 101.0, 35.0, 200.0, 200.0, 90.0, 13.0, 200.0, -1659.0, -1857.0, 200.0, -680.0, 167.0, 134.0, 189.0, 200.0, 112.0, 200.0, 79.0, -1076.0, -405.0, -53.0, 57.0, -471.0, -1604.0, -1582.0, -306.0, -328.0, -1307.0, -1263.0, -405.0, 200.0], "policy_predator_policy_reward": [40.0, 65.0, 460.0, 545.0, 425.0, 180.0, 545.0, 450.0, 0.0, 40.0, 30.0, 315.0, 0.0, 0.0, 935.0, 165.0, 165.0, 495.0, 25.0, 440.0, 430.0, 960.0, 0.0, 0.0, 445.0, 180.0, 715.0, 365.0, 200.0, 115.0, 65.0, 320.0, 155.0, 160.0, 0.0, 0.0, 0.0, 0.0, 680.0, 75.0, 145.0, 30.0, 545.0, 480.0, 265.0, 450.0, 35.0, 0.0, 330.0, 895.0, 340.0, 0.0, 0.0, 305.0, 10.0, 0.0, 1000.0, 35.0, 210.0, 0.0, 145.0, 95.0, 160.0, 0.0, 615.0, 0.0, 265.0, 5.0, 270.0, 15.0, 175.0, 410.0, 20.0, 470.0, 230.0, 85.0, 210.0, 265.0, 50.0, 300.0, 0.0, 0.0, 0.0, 70.0, 10.0, 750.0, 45.0, 440.0, 195.0, 45.0, 0.0, 0.0, 75.0, 215.0, 0.0, 0.0, 30.0, 30.0, 0.0, 155.0, 160.0, 35.0, 230.0, 0.0, 385.0, 515.0, 45.0, 0.0, 240.0, 10.0, 615.0, 400.0, 0.0, 110.0, 20.0, 245.0, 85.0, 225.0, 180.0, 65.0, 525.0, 440.0, 105.0, 35.0, 305.0, 490.0, 0.0, 545.0, 205.0, 440.0, 0.0, 0.0, 0.0, 820.0, 0.0, 135.0, 255.0, 30.0, 0.0, 145.0, 0.0, 950.0, 125.0, 375.0, 75.0, 740.0, 75.0, 45.0, 185.0, 515.0, 200.0, 120.0, 205.0, 715.0, 0.0, 0.0, 785.0, 105.0, 95.0, 240.0, 515.0, 45.0, 340.0, 220.0, 0.0, 20.0, 305.0, 390.0, 0.0, 55.0, 65.0, 10.0, 0.0, 50.0, 85.0, 0.0, 1000.0, 0.0, 5.0, 395.0, 30.0, 20.0, 0.0, 5.0, 0.0, 40.0, 520.0, 225.0, 290.0, 90.0, 0.0, 370.0, 820.0, 615.0, 275.0, 115.0, 480.0, 695.0, 275.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979315562609456, "mean_inference_ms": 1.6378929430630629, "mean_action_processing_ms": 0.27567315194130176, "mean_env_wait_ms": 0.19492890902696478, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004604935646057129, "StateBufferConnector_ms": 0.0038297176361083984, "ViewRequirementAgentConnector_ms": 0.1035085916519165}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2701.0, "episode_return_mean": -242.56, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 80.87567702439188, "num_env_steps_trained_throughput_per_sec": 80.87567702439188, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 102516.388, "restore_workers_time_ms": 0.014, "training_step_time_ms": 102516.318, "sample_time_ms": 1307.741, "learn_time_ms": 101186.331, "learn_throughput": 39.531, "synch_weights_time_ms": 18.932}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "ed30a_00000", "date": "2024-08-12_15-42-26", "timestamp": 1723491746, "time_this_iter_s": 49.48755717277527, "time_total_s": 5169.904453039169, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b1296940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5169.904453039169, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 32.511428571428574, "ram_util_percent": 83.07000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4749585114931933, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.750132949768551, "policy_loss": -0.00455549983726568, "vf_loss": 5.754582651582345, "vf_explained_var": -0.00036348747828650097, "kl": 0.005642721726314992, "entropy": 0.5386388211653976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.758301701621404, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.746737711644046, "policy_loss": -0.019486661953235628, "vf_loss": 5.765099717195703, "vf_explained_var": 0.012756538769555471, "kl": 0.014995353391542706, "entropy": 1.0361990014712015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2701.0, "episode_reward_mean": -205.77, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1989.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -309.135, "predator_policy": 206.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, -1287.0, 201.0, -1182.0, -788.0, 358.0, -1026.0, -140.0, 34.0, 388.0, -2701.0, 115.0, 112.0, 208.0, -1218.0, 76.0, -525.0, -247.0, -188.0, 22.0, 160.0, -20.0, 400.0, 316.0, -490.0, -127.0, 189.0, 400.0, 85.0, 400.0, 350.0, 214.0, 166.0, 124.0, -394.0, 346.0, -307.0, -180.0, 268.0, 82.0, 204.0, -191.0, -505.0, 100.0, -312.0, -320.0, -473.0, 400.0, -1772.0, 161.0, 58.0, 226.0, -1246.0, -662.0, -1601.0, 333.0, -990.0, 280.0, -550.0, 400.0, -668.0, 9.0, -734.0, -580.0, 376.0, 61.0, 312.0, 310.0, 340.0, 298.0, -2516.0, -80.0, 351.0, 394.0, 352.0, -252.0, -78.0, -44.0, -1751.0, -244.0, -1395.0, 70.0, 259.0, 294.0, 376.0, 5.0, -783.0, 341.0, -689.0, -422.0, 138.0, -10.0, -1087.0, -63.0, 178.0, -638.0, 178.0, -133.0, -508.0, -678.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, -1098.0, -944.0, -141.0, 167.0, -933.0, -1274.0, -944.0, -559.0, 123.0, 200.0, -900.0, -1351.0, -339.0, -141.0, 189.0, -460.0, 200.0, 178.0, -1747.0, -1989.0, -42.0, -53.0, 13.0, -141.0, 200.0, -152.0, -900.0, -933.0, 200.0, -394.0, -394.0, -416.0, 178.0, -1010.0, 200.0, -878.0, -493.0, 200.0, 2.0, -317.0, -482.0, 112.0, 200.0, 200.0, 200.0, 46.0, -812.0, -438.0, 200.0, -812.0, 200.0, -251.0, 200.0, 200.0, 101.0, -306.0, 200.0, 200.0, 200.0, 90.0, -141.0, 200.0, -229.0, 200.0, -284.0, 178.0, -955.0, -339.0, 112.0, 189.0, -240.0, -317.0, -31.0, -1164.0, 13.0, 145.0, 200.0, -383.0, 200.0, -306.0, -218.0, -218.0, -75.0, -1395.0, -9.0, -31.0, 200.0, -1307.0, 134.0, -999.0, -328.0, -790.0, 200.0, 200.0, -999.0, -1593.0, -20.0, 46.0, 57.0, -284.0, -119.0, 200.0, -1461.0, -735.0, -548.0, -614.0, -1351.0, -1065.0, 178.0, 35.0, -614.0, -1076.0, -240.0, 200.0, 145.0, -1615.0, 200.0, 200.0, -1527.0, -31.0, 167.0, -493.0, -350.0, -944.0, -515.0, -625.0, 178.0, 178.0, -504.0, -130.0, 156.0, 101.0, 35.0, 200.0, 200.0, 90.0, 13.0, 200.0, -1659.0, -1857.0, 200.0, -680.0, 167.0, 134.0, 189.0, 200.0, 112.0, 200.0, 79.0, -1076.0, -405.0, -53.0, 57.0, -471.0, -1604.0, -1582.0, -306.0, -328.0, -1307.0, -1263.0, -405.0, 200.0, 24.0, -75.0, -86.0, 200.0, 156.0, 200.0, -295.0, 35.0, -812.0, -746.0, 112.0, 189.0, -955.0, -614.0, -1241.0, 134.0, 200.0, -482.0, -97.0, -108.0, -966.0, -1186.0, -317.0, -141.0, -31.0, 79.0, 167.0, -1670.0, 200.0, -207.0, -317.0, -196.0, -460.0, -383.0, -328.0, -845.0], "policy_predator_policy_reward": [0.0, 0.0, 680.0, 75.0, 145.0, 30.0, 545.0, 480.0, 265.0, 450.0, 35.0, 0.0, 330.0, 895.0, 340.0, 0.0, 0.0, 305.0, 10.0, 0.0, 1000.0, 35.0, 210.0, 0.0, 145.0, 95.0, 160.0, 0.0, 615.0, 0.0, 265.0, 5.0, 270.0, 15.0, 175.0, 410.0, 20.0, 470.0, 230.0, 85.0, 210.0, 265.0, 50.0, 300.0, 0.0, 0.0, 0.0, 70.0, 10.0, 750.0, 45.0, 440.0, 195.0, 45.0, 0.0, 0.0, 75.0, 215.0, 0.0, 0.0, 30.0, 30.0, 0.0, 155.0, 160.0, 35.0, 230.0, 0.0, 385.0, 515.0, 45.0, 0.0, 240.0, 10.0, 615.0, 400.0, 0.0, 110.0, 20.0, 245.0, 85.0, 225.0, 180.0, 65.0, 525.0, 440.0, 105.0, 35.0, 305.0, 490.0, 0.0, 545.0, 205.0, 440.0, 0.0, 0.0, 0.0, 820.0, 0.0, 135.0, 255.0, 30.0, 0.0, 145.0, 0.0, 950.0, 125.0, 375.0, 75.0, 740.0, 75.0, 45.0, 185.0, 515.0, 200.0, 120.0, 205.0, 715.0, 0.0, 0.0, 785.0, 105.0, 95.0, 240.0, 515.0, 45.0, 340.0, 220.0, 0.0, 20.0, 305.0, 390.0, 0.0, 55.0, 65.0, 10.0, 0.0, 50.0, 85.0, 0.0, 1000.0, 0.0, 5.0, 395.0, 30.0, 20.0, 0.0, 5.0, 0.0, 40.0, 520.0, 225.0, 290.0, 90.0, 0.0, 370.0, 820.0, 615.0, 275.0, 115.0, 480.0, 695.0, 275.0, 0.0, 120.0, 190.0, 130.0, 50.0, 20.0, 0.0, 45.0, 220.0, 435.0, 340.0, 40.0, 0.0, 340.0, 540.0, 655.0, 30.0, 245.0, 175.0, 140.0, 55.0, 890.0, 175.0, 245.0, 150.0, 15.0, 115.0, 0.0, 865.0, 135.0, 50.0, 75.0, 305.0, 265.0, 70.0, 465.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6979497133217148, "mean_inference_ms": 1.636195465909165, "mean_action_processing_ms": 0.27547644341823646, "mean_env_wait_ms": 0.19473790338036479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005005836486816406, "StateBufferConnector_ms": 0.003840804100036621, "ViewRequirementAgentConnector_ms": 0.09758484363555908}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2701.0, "episode_return_mean": -205.77, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.93802956720907, "num_env_steps_trained_throughput_per_sec": 81.93802956720907, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 102464.639, "restore_workers_time_ms": 0.014, "training_step_time_ms": 102464.569, "sample_time_ms": 1303.362, "learn_time_ms": 101139.53, "learn_throughput": 39.549, "synch_weights_time_ms": 18.363}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "ed30a_00000", "date": "2024-08-12_15-43-15", "timestamp": 1723491795, "time_this_iter_s": 48.85418105125427, "time_total_s": 5218.758634090424, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b014ae50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5218.758634090424, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 33.339130434782604, "ram_util_percent": 83.25507246376814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4800020907133344, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.096525732676188, "policy_loss": -0.00541025651421733, "vf_loss": 6.101827970635954, "vf_explained_var": -0.00016957660200734619, "kl": 0.005761102940873459, "entropy": 0.46816488036087583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.650296879319287, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.161505711520159, "policy_loss": -0.016932876094949072, "vf_loss": 6.177575189852841, "vf_explained_var": 0.012603685496345399, "kl": 0.011512023550029647, "entropy": 1.0307799220400513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2516.0, "episode_reward_mean": -146.04, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1857.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -271.57, "predator_policy": 198.55}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-188.0, 22.0, 160.0, -20.0, 400.0, 316.0, -490.0, -127.0, 189.0, 400.0, 85.0, 400.0, 350.0, 214.0, 166.0, 124.0, -394.0, 346.0, -307.0, -180.0, 268.0, 82.0, 204.0, -191.0, -505.0, 100.0, -312.0, -320.0, -473.0, 400.0, -1772.0, 161.0, 58.0, 226.0, -1246.0, -662.0, -1601.0, 333.0, -990.0, 280.0, -550.0, 400.0, -668.0, 9.0, -734.0, -580.0, 376.0, 61.0, 312.0, 310.0, 340.0, 298.0, -2516.0, -80.0, 351.0, 394.0, 352.0, -252.0, -78.0, -44.0, -1751.0, -244.0, -1395.0, 70.0, 259.0, 294.0, 376.0, 5.0, -783.0, 341.0, -689.0, -422.0, 138.0, -10.0, -1087.0, -63.0, 178.0, -638.0, 178.0, -133.0, -508.0, -678.0, 190.0, -626.0, -1054.0, 112.0, -160.0, -90.0, 370.0, -454.0, 24.0, -75.0, -20.0, 358.0, -26.0, -27.0, -210.0, -60.0, 130.0, 369.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -878.0, -493.0, 200.0, 2.0, -317.0, -482.0, 112.0, 200.0, 200.0, 200.0, 46.0, -812.0, -438.0, 200.0, -812.0, 200.0, -251.0, 200.0, 200.0, 101.0, -306.0, 200.0, 200.0, 200.0, 90.0, -141.0, 200.0, -229.0, 200.0, -284.0, 178.0, -955.0, -339.0, 112.0, 189.0, -240.0, -317.0, -31.0, -1164.0, 13.0, 145.0, 200.0, -383.0, 200.0, -306.0, -218.0, -218.0, -75.0, -1395.0, -9.0, -31.0, 200.0, -1307.0, 134.0, -999.0, -328.0, -790.0, 200.0, 200.0, -999.0, -1593.0, -20.0, 46.0, 57.0, -284.0, -119.0, 200.0, -1461.0, -735.0, -548.0, -614.0, -1351.0, -1065.0, 178.0, 35.0, -614.0, -1076.0, -240.0, 200.0, 145.0, -1615.0, 200.0, 200.0, -1527.0, -31.0, 167.0, -493.0, -350.0, -944.0, -515.0, -625.0, 178.0, 178.0, -504.0, -130.0, 156.0, 101.0, 35.0, 200.0, 200.0, 90.0, 13.0, 200.0, -1659.0, -1857.0, 200.0, -680.0, 167.0, 134.0, 189.0, 200.0, 112.0, 200.0, 79.0, -1076.0, -405.0, -53.0, 57.0, -471.0, -1604.0, -1582.0, -306.0, -328.0, -1307.0, -1263.0, -405.0, 200.0, 24.0, -75.0, -86.0, 200.0, 156.0, 200.0, -295.0, 35.0, -812.0, -746.0, 112.0, 189.0, -955.0, -614.0, -1241.0, 134.0, 200.0, -482.0, -97.0, -108.0, -966.0, -1186.0, -317.0, -141.0, -31.0, 79.0, 167.0, -1670.0, 200.0, -207.0, -317.0, -196.0, -460.0, -383.0, -328.0, -845.0, -185.0, 200.0, -1120.0, -361.0, -1054.0, -735.0, -20.0, 2.0, -1120.0, 200.0, -669.0, 134.0, 200.0, 145.0, -350.0, -559.0, -141.0, -75.0, -218.0, -97.0, 167.0, -592.0, 200.0, 123.0, -361.0, -20.0, 13.0, -570.0, -229.0, -251.0, -647.0, 112.0, -295.0, 200.0, 200.0, 79.0], "policy_predator_policy_reward": [20.0, 470.0, 230.0, 85.0, 210.0, 265.0, 50.0, 300.0, 0.0, 0.0, 0.0, 70.0, 10.0, 750.0, 45.0, 440.0, 195.0, 45.0, 0.0, 0.0, 75.0, 215.0, 0.0, 0.0, 30.0, 30.0, 0.0, 155.0, 160.0, 35.0, 230.0, 0.0, 385.0, 515.0, 45.0, 0.0, 240.0, 10.0, 615.0, 400.0, 0.0, 110.0, 20.0, 245.0, 85.0, 225.0, 180.0, 65.0, 525.0, 440.0, 105.0, 35.0, 305.0, 490.0, 0.0, 545.0, 205.0, 440.0, 0.0, 0.0, 0.0, 820.0, 0.0, 135.0, 255.0, 30.0, 0.0, 145.0, 0.0, 950.0, 125.0, 375.0, 75.0, 740.0, 75.0, 45.0, 185.0, 515.0, 200.0, 120.0, 205.0, 715.0, 0.0, 0.0, 785.0, 105.0, 95.0, 240.0, 515.0, 45.0, 340.0, 220.0, 0.0, 20.0, 305.0, 390.0, 0.0, 55.0, 65.0, 10.0, 0.0, 50.0, 85.0, 0.0, 1000.0, 0.0, 5.0, 395.0, 30.0, 20.0, 0.0, 5.0, 0.0, 40.0, 520.0, 225.0, 290.0, 90.0, 0.0, 370.0, 820.0, 615.0, 275.0, 115.0, 480.0, 695.0, 275.0, 0.0, 120.0, 190.0, 130.0, 50.0, 20.0, 0.0, 45.0, 220.0, 435.0, 340.0, 40.0, 0.0, 340.0, 540.0, 655.0, 30.0, 245.0, 175.0, 140.0, 55.0, 890.0, 175.0, 245.0, 150.0, 15.0, 115.0, 0.0, 865.0, 135.0, 50.0, 75.0, 305.0, 265.0, 70.0, 465.0, 30.0, 105.0, 70.0, 600.0, 255.0, 225.0, 510.0, 0.0, 130.0, 315.0, 445.0, 50.0, 395.0, 0.0, 25.0, 395.0, 60.0, 240.0, 0.0, 15.0, 225.0, 360.0, 45.0, 0.0, 35.0, 0.0, 355.0, 160.0, 370.0, 50.0, 220.0, 165.0, 310.0, 200.0, 25.0, 35.0, 55.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6974299636011846, "mean_inference_ms": 1.6341907967425704, "mean_action_processing_ms": 0.27526007977184536, "mean_env_wait_ms": 0.19450245544047917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005470871925354004, "StateBufferConnector_ms": 0.004117369651794434, "ViewRequirementAgentConnector_ms": 0.09867167472839355}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2516.0, "episode_return_mean": -146.04, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.31083612901061, "num_env_steps_trained_throughput_per_sec": 81.31083612901061, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 49727.011, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49726.943, "sample_time_ms": 1270.286, "learn_time_ms": 48436.522, "learn_throughput": 82.582, "synch_weights_time_ms": 16.861}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "ed30a_00000", "date": "2024-08-12_15-44-05", "timestamp": 1723491845, "time_this_iter_s": 49.2470600605011, "time_total_s": 5268.005694150925, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5268.005694150925, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 34.418571428571425, "ram_util_percent": 82.81285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3475025662984799, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.095153416779937, "policy_loss": -0.007096487530457871, "vf_loss": 6.1021325025608935, "vf_explained_var": -8.484412122655798e-05, "kl": 0.006260433057078666, "entropy": 0.3905111654725655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.206373445098362, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.364735969412264, "policy_loss": -0.017268151593660668, "vf_loss": 5.381205144256511, "vf_explained_var": 0.011027999056710137, "kl": 0.010652942642358405, "entropy": 1.051083476139755, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2599.0, "episode_reward_mean": -261.24, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -367.27, "predator_policy": 236.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [204.0, -191.0, -505.0, 100.0, -312.0, -320.0, -473.0, 400.0, -1772.0, 161.0, 58.0, 226.0, -1246.0, -662.0, -1601.0, 333.0, -990.0, 280.0, -550.0, 400.0, -668.0, 9.0, -734.0, -580.0, 376.0, 61.0, 312.0, 310.0, 340.0, 298.0, -2516.0, -80.0, 351.0, 394.0, 352.0, -252.0, -78.0, -44.0, -1751.0, -244.0, -1395.0, 70.0, 259.0, 294.0, 376.0, 5.0, -783.0, 341.0, -689.0, -422.0, 138.0, -10.0, -1087.0, -63.0, 178.0, -638.0, 178.0, -133.0, -508.0, -678.0, 190.0, -626.0, -1054.0, 112.0, -160.0, -90.0, 370.0, -454.0, 24.0, -75.0, -20.0, 358.0, -26.0, -27.0, -210.0, -60.0, 130.0, 369.0, -2599.0, -257.0, -269.0, -1170.0, 400.0, 214.0, -295.0, -1477.0, -415.0, -57.0, -199.0, -1553.0, 242.0, 236.0, -114.0, -1754.0, 112.0, 43.0, -892.0, 311.0, 208.0, -419.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, -306.0, -218.0, -218.0, -75.0, -1395.0, -9.0, -31.0, 200.0, -1307.0, 134.0, -999.0, -328.0, -790.0, 200.0, 200.0, -999.0, -1593.0, -20.0, 46.0, 57.0, -284.0, -119.0, 200.0, -1461.0, -735.0, -548.0, -614.0, -1351.0, -1065.0, 178.0, 35.0, -614.0, -1076.0, -240.0, 200.0, 145.0, -1615.0, 200.0, 200.0, -1527.0, -31.0, 167.0, -493.0, -350.0, -944.0, -515.0, -625.0, 178.0, 178.0, -504.0, -130.0, 156.0, 101.0, 35.0, 200.0, 200.0, 90.0, 13.0, 200.0, -1659.0, -1857.0, 200.0, -680.0, 167.0, 134.0, 189.0, 200.0, 112.0, 200.0, 79.0, -1076.0, -405.0, -53.0, 57.0, -471.0, -1604.0, -1582.0, -306.0, -328.0, -1307.0, -1263.0, -405.0, 200.0, 24.0, -75.0, -86.0, 200.0, 156.0, 200.0, -295.0, 35.0, -812.0, -746.0, 112.0, 189.0, -955.0, -614.0, -1241.0, 134.0, 200.0, -482.0, -97.0, -108.0, -966.0, -1186.0, -317.0, -141.0, -31.0, 79.0, 167.0, -1670.0, 200.0, -207.0, -317.0, -196.0, -460.0, -383.0, -328.0, -845.0, -185.0, 200.0, -1120.0, -361.0, -1054.0, -735.0, -20.0, 2.0, -1120.0, 200.0, -669.0, 134.0, 200.0, 145.0, -350.0, -559.0, -141.0, -75.0, -218.0, -97.0, 167.0, -592.0, 200.0, 123.0, -361.0, -20.0, 13.0, -570.0, -229.0, -251.0, -647.0, 112.0, -295.0, 200.0, 200.0, 79.0, -2000.0, -1989.0, 200.0, -1307.0, -262.0, -372.0, -1021.0, -779.0, 200.0, 200.0, 200.0, -141.0, 200.0, -1835.0, -1252.0, -2000.0, 156.0, -1461.0, 200.0, -647.0, -1010.0, 156.0, -988.0, -1560.0, 123.0, -31.0, 200.0, -229.0, -339.0, -240.0, -1329.0, -1505.0, 200.0, -328.0, 24.0, -196.0, -185.0, -1692.0, 57.0, 189.0, 46.0, 2.0, -1879.0, 200.0], "policy_predator_policy_reward": [85.0, 225.0, 180.0, 65.0, 525.0, 440.0, 105.0, 35.0, 305.0, 490.0, 0.0, 545.0, 205.0, 440.0, 0.0, 0.0, 0.0, 820.0, 0.0, 135.0, 255.0, 30.0, 0.0, 145.0, 0.0, 950.0, 125.0, 375.0, 75.0, 740.0, 75.0, 45.0, 185.0, 515.0, 200.0, 120.0, 205.0, 715.0, 0.0, 0.0, 785.0, 105.0, 95.0, 240.0, 515.0, 45.0, 340.0, 220.0, 0.0, 20.0, 305.0, 390.0, 0.0, 55.0, 65.0, 10.0, 0.0, 50.0, 85.0, 0.0, 1000.0, 0.0, 5.0, 395.0, 30.0, 20.0, 0.0, 5.0, 0.0, 40.0, 520.0, 225.0, 290.0, 90.0, 0.0, 370.0, 820.0, 615.0, 275.0, 115.0, 480.0, 695.0, 275.0, 0.0, 120.0, 190.0, 130.0, 50.0, 20.0, 0.0, 45.0, 220.0, 435.0, 340.0, 40.0, 0.0, 340.0, 540.0, 655.0, 30.0, 245.0, 175.0, 140.0, 55.0, 890.0, 175.0, 245.0, 150.0, 15.0, 115.0, 0.0, 865.0, 135.0, 50.0, 75.0, 305.0, 265.0, 70.0, 465.0, 30.0, 105.0, 70.0, 600.0, 255.0, 225.0, 510.0, 0.0, 130.0, 315.0, 445.0, 50.0, 395.0, 0.0, 25.0, 395.0, 60.0, 240.0, 0.0, 15.0, 225.0, 360.0, 45.0, 0.0, 35.0, 0.0, 355.0, 160.0, 370.0, 50.0, 220.0, 165.0, 310.0, 200.0, 25.0, 35.0, 55.0, 980.0, 410.0, 620.0, 230.0, 90.0, 275.0, 0.0, 630.0, 0.0, 0.0, 155.0, 0.0, 480.0, 860.0, 845.0, 930.0, 755.0, 135.0, 275.0, 115.0, 400.0, 255.0, 825.0, 170.0, 60.0, 90.0, 185.0, 80.0, 405.0, 60.0, 290.0, 790.0, 30.0, 210.0, 70.0, 145.0, 695.0, 290.0, 0.0, 65.0, 90.0, 70.0, 315.0, 945.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6968233065069808, "mean_inference_ms": 1.631650627986291, "mean_action_processing_ms": 0.274969116256755, "mean_env_wait_ms": 0.19418326539897016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006354212760925293, "StateBufferConnector_ms": 0.004144072532653809, "ViewRequirementAgentConnector_ms": 0.10126543045043945}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -2599.0, "episode_return_mean": -261.24, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 83.92391961687686, "num_env_steps_trained_throughput_per_sec": 83.92391961687686, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 49354.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49354.184, "sample_time_ms": 1214.213, "learn_time_ms": 48119.336, "learn_throughput": 83.127, "synch_weights_time_ms": 17.574}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "ed30a_00000", "date": "2024-08-12_15-44-52", "timestamp": 1723491892, "time_this_iter_s": 47.70775127410889, "time_total_s": 5315.713445425034, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2064f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5315.713445425034, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.708955223880597, "ram_util_percent": 82.70298507462687}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7798923935051318, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.614528708987766, "policy_loss": -0.006772934989239922, "vf_loss": 5.621202605363553, "vf_explained_var": -0.000598100915787712, "kl": 0.00528234813310477, "entropy": 0.4274187700773673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.978216333774032, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.771968114439142, "policy_loss": -0.02112185496482111, "vf_loss": 4.792126305645736, "vf_explained_var": 0.01492040961507767, "kl": 0.012848644475715923, "entropy": 1.0467355664760347, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2599.0, "episode_reward_mean": -210.42, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 1000.0}, "policy_reward_mean": {"prey_policy": -339.66, "predator_policy": 234.45}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.0, 400.0, -668.0, 9.0, -734.0, -580.0, 376.0, 61.0, 312.0, 310.0, 340.0, 298.0, -2516.0, -80.0, 351.0, 394.0, 352.0, -252.0, -78.0, -44.0, -1751.0, -244.0, -1395.0, 70.0, 259.0, 294.0, 376.0, 5.0, -783.0, 341.0, -689.0, -422.0, 138.0, -10.0, -1087.0, -63.0, 178.0, -638.0, 178.0, -133.0, -508.0, -678.0, 190.0, -626.0, -1054.0, 112.0, -160.0, -90.0, 370.0, -454.0, 24.0, -75.0, -20.0, 358.0, -26.0, -27.0, -210.0, -60.0, 130.0, 369.0, -2599.0, -257.0, -269.0, -1170.0, 400.0, 214.0, -295.0, -1477.0, -415.0, -57.0, -199.0, -1553.0, 242.0, 236.0, -114.0, -1754.0, 112.0, 43.0, -892.0, 311.0, 208.0, -419.0, 298.0, -328.0, -145.0, -172.0, -470.0, -169.0, 175.0, 160.0, 336.0, -9.0, -177.0, -445.0, -668.0, -57.0, -152.0, 225.0, -30.0, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.0, -1615.0, 200.0, 200.0, -1527.0, -31.0, 167.0, -493.0, -350.0, -944.0, -515.0, -625.0, 178.0, 178.0, -504.0, -130.0, 156.0, 101.0, 35.0, 200.0, 200.0, 90.0, 13.0, 200.0, -1659.0, -1857.0, 200.0, -680.0, 167.0, 134.0, 189.0, 200.0, 112.0, 200.0, 79.0, -1076.0, -405.0, -53.0, 57.0, -471.0, -1604.0, -1582.0, -306.0, -328.0, -1307.0, -1263.0, -405.0, 200.0, 24.0, -75.0, -86.0, 200.0, 156.0, 200.0, -295.0, 35.0, -812.0, -746.0, 112.0, 189.0, -955.0, -614.0, -1241.0, 134.0, 200.0, -482.0, -97.0, -108.0, -966.0, -1186.0, -317.0, -141.0, -31.0, 79.0, 167.0, -1670.0, 200.0, -207.0, -317.0, -196.0, -460.0, -383.0, -328.0, -845.0, -185.0, 200.0, -1120.0, -361.0, -1054.0, -735.0, -20.0, 2.0, -1120.0, 200.0, -669.0, 134.0, 200.0, 145.0, -350.0, -559.0, -141.0, -75.0, -218.0, -97.0, 167.0, -592.0, 200.0, 123.0, -361.0, -20.0, 13.0, -570.0, -229.0, -251.0, -647.0, 112.0, -295.0, 200.0, 200.0, 79.0, -2000.0, -1989.0, 200.0, -1307.0, -262.0, -372.0, -1021.0, -779.0, 200.0, 200.0, 200.0, -141.0, 200.0, -1835.0, -1252.0, -2000.0, 156.0, -1461.0, 200.0, -647.0, -1010.0, 156.0, -988.0, -1560.0, 123.0, -31.0, 200.0, -229.0, -339.0, -240.0, -1329.0, -1505.0, 200.0, -328.0, 24.0, -196.0, -185.0, -1692.0, 57.0, 189.0, 46.0, 2.0, -1879.0, 200.0, 57.0, 156.0, -339.0, -284.0, -174.0, -361.0, -251.0, -361.0, -713.0, -317.0, -845.0, 156.0, -405.0, 145.0, -174.0, 134.0, 200.0, -9.0, -20.0, -504.0, -1582.0, 200.0, 189.0, -1329.0, -1274.0, -284.0, 13.0, -680.0, 167.0, -834.0, 90.0, 35.0, -306.0, -119.0, 200.0, 200.0], "policy_predator_policy_reward": [205.0, 715.0, 0.0, 0.0, 785.0, 105.0, 95.0, 240.0, 515.0, 45.0, 340.0, 220.0, 0.0, 20.0, 305.0, 390.0, 0.0, 55.0, 65.0, 10.0, 0.0, 50.0, 85.0, 0.0, 1000.0, 0.0, 5.0, 395.0, 30.0, 20.0, 0.0, 5.0, 0.0, 40.0, 520.0, 225.0, 290.0, 90.0, 0.0, 370.0, 820.0, 615.0, 275.0, 115.0, 480.0, 695.0, 275.0, 0.0, 120.0, 190.0, 130.0, 50.0, 20.0, 0.0, 45.0, 220.0, 435.0, 340.0, 40.0, 0.0, 340.0, 540.0, 655.0, 30.0, 245.0, 175.0, 140.0, 55.0, 890.0, 175.0, 245.0, 150.0, 15.0, 115.0, 0.0, 865.0, 135.0, 50.0, 75.0, 305.0, 265.0, 70.0, 465.0, 30.0, 105.0, 70.0, 600.0, 255.0, 225.0, 510.0, 0.0, 130.0, 315.0, 445.0, 50.0, 395.0, 0.0, 25.0, 395.0, 60.0, 240.0, 0.0, 15.0, 225.0, 360.0, 45.0, 0.0, 35.0, 0.0, 355.0, 160.0, 370.0, 50.0, 220.0, 165.0, 310.0, 200.0, 25.0, 35.0, 55.0, 980.0, 410.0, 620.0, 230.0, 90.0, 275.0, 0.0, 630.0, 0.0, 0.0, 155.0, 0.0, 480.0, 860.0, 845.0, 930.0, 755.0, 135.0, 275.0, 115.0, 400.0, 255.0, 825.0, 170.0, 60.0, 90.0, 185.0, 80.0, 405.0, 60.0, 290.0, 790.0, 30.0, 210.0, 70.0, 145.0, 695.0, 290.0, 0.0, 65.0, 90.0, 70.0, 315.0, 945.0, 15.0, 70.0, 295.0, 0.0, 5.0, 385.0, 210.0, 230.0, 90.0, 470.0, 45.0, 475.0, 145.0, 290.0, 150.0, 50.0, 55.0, 90.0, 310.0, 205.0, 810.0, 395.0, 695.0, 0.0, 190.0, 700.0, 370.0, 240.0, 440.0, 75.0, 100.0, 0.0, 330.0, 65.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6961929254072706, "mean_inference_ms": 1.6293121149208565, "mean_action_processing_ms": 0.27472567481165555, "mean_env_wait_ms": 0.19389812980331633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008269429206848145, "StateBufferConnector_ms": 0.004081130027770996, "ViewRequirementAgentConnector_ms": 0.09892582893371582}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2599.0, "episode_return_mean": -210.42, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.15107258623543, "num_env_steps_trained_throughput_per_sec": 81.15107258623543, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 49280.465, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49280.399, "sample_time_ms": 1216.17, "learn_time_ms": 48044.91, "learn_throughput": 83.255, "synch_weights_time_ms": 16.651}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "ed30a_00000", "date": "2024-08-12_15-45-42", "timestamp": 1723491942, "time_this_iter_s": 49.33863663673401, "time_total_s": 5365.052082061768, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5365.052082061768, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 35.76714285714286, "ram_util_percent": 82.68142857142855}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0547908861801107, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.767633210918891, "policy_loss": -0.004828756210941171, "vf_loss": 3.772389795035912, "vf_explained_var": -0.0002842449006580171, "kl": 0.0038495174105863403, "entropy": 0.3775527751240781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.963611808844975, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.176495954220888, "policy_loss": -0.015252618475881203, "vf_loss": 4.190916757734995, "vf_explained_var": 0.01117143501680364, "kl": 0.011090851748947791, "entropy": 0.9284281507055595, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2599.0, "episode_reward_mean": -151.61, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -290.93, "predator_policy": 215.125}, "custom_metrics": {}, "hist_stats": {"episode_reward": [70.0, 259.0, 294.0, 376.0, 5.0, -783.0, 341.0, -689.0, -422.0, 138.0, -10.0, -1087.0, -63.0, 178.0, -638.0, 178.0, -133.0, -508.0, -678.0, 190.0, -626.0, -1054.0, 112.0, -160.0, -90.0, 370.0, -454.0, 24.0, -75.0, -20.0, 358.0, -26.0, -27.0, -210.0, -60.0, 130.0, 369.0, -2599.0, -257.0, -269.0, -1170.0, 400.0, 214.0, -295.0, -1477.0, -415.0, -57.0, -199.0, -1553.0, 242.0, 236.0, -114.0, -1754.0, 112.0, 43.0, -892.0, 311.0, 208.0, -419.0, 298.0, -328.0, -145.0, -172.0, -470.0, -169.0, 175.0, 160.0, 336.0, -9.0, -177.0, -445.0, -668.0, -57.0, -152.0, 225.0, -30.0, 400.0, -32.0, 400.0, -314.0, 400.0, -1808.0, 256.0, 400.0, 376.0, 250.0, 211.0, 394.0, -20.0, -648.0, 209.0, 370.0, 22.0, 136.0, -110.0, -61.0, -201.0, 90.0, -246.0, 118.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-405.0, 200.0, 24.0, -75.0, -86.0, 200.0, 156.0, 200.0, -295.0, 35.0, -812.0, -746.0, 112.0, 189.0, -955.0, -614.0, -1241.0, 134.0, 200.0, -482.0, -97.0, -108.0, -966.0, -1186.0, -317.0, -141.0, -31.0, 79.0, 167.0, -1670.0, 200.0, -207.0, -317.0, -196.0, -460.0, -383.0, -328.0, -845.0, -185.0, 200.0, -1120.0, -361.0, -1054.0, -735.0, -20.0, 2.0, -1120.0, 200.0, -669.0, 134.0, 200.0, 145.0, -350.0, -559.0, -141.0, -75.0, -218.0, -97.0, 167.0, -592.0, 200.0, 123.0, -361.0, -20.0, 13.0, -570.0, -229.0, -251.0, -647.0, 112.0, -295.0, 200.0, 200.0, 79.0, -2000.0, -1989.0, 200.0, -1307.0, -262.0, -372.0, -1021.0, -779.0, 200.0, 200.0, 200.0, -141.0, 200.0, -1835.0, -1252.0, -2000.0, 156.0, -1461.0, 200.0, -647.0, -1010.0, 156.0, -988.0, -1560.0, 123.0, -31.0, 200.0, -229.0, -339.0, -240.0, -1329.0, -1505.0, 200.0, -328.0, 24.0, -196.0, -185.0, -1692.0, 57.0, 189.0, 46.0, 2.0, -1879.0, 200.0, 57.0, 156.0, -339.0, -284.0, -174.0, -361.0, -251.0, -361.0, -713.0, -317.0, -845.0, 156.0, -405.0, 145.0, -174.0, 134.0, 200.0, -9.0, -20.0, -504.0, -1582.0, 200.0, 189.0, -1329.0, -1274.0, -284.0, 13.0, -680.0, 167.0, -834.0, 90.0, 35.0, -306.0, -119.0, 200.0, 200.0, -449.0, 57.0, 200.0, 200.0, -1076.0, 112.0, 200.0, 200.0, -1450.0, -1318.0, 178.0, -42.0, 200.0, 200.0, 189.0, 167.0, 79.0, 101.0, 200.0, -284.0, 200.0, 189.0, -251.0, -119.0, -361.0, -702.0, 57.0, 57.0, 200.0, 145.0, -394.0, 101.0, -284.0, 200.0, 189.0, -944.0, -493.0, 112.0, -262.0, -174.0, -438.0, 178.0, -372.0, -559.0, -317.0, 200.0], "policy_predator_policy_reward": [275.0, 0.0, 120.0, 190.0, 130.0, 50.0, 20.0, 0.0, 45.0, 220.0, 435.0, 340.0, 40.0, 0.0, 340.0, 540.0, 655.0, 30.0, 245.0, 175.0, 140.0, 55.0, 890.0, 175.0, 245.0, 150.0, 15.0, 115.0, 0.0, 865.0, 135.0, 50.0, 75.0, 305.0, 265.0, 70.0, 465.0, 30.0, 105.0, 70.0, 600.0, 255.0, 225.0, 510.0, 0.0, 130.0, 315.0, 445.0, 50.0, 395.0, 0.0, 25.0, 395.0, 60.0, 240.0, 0.0, 15.0, 225.0, 360.0, 45.0, 0.0, 35.0, 0.0, 355.0, 160.0, 370.0, 50.0, 220.0, 165.0, 310.0, 200.0, 25.0, 35.0, 55.0, 980.0, 410.0, 620.0, 230.0, 90.0, 275.0, 0.0, 630.0, 0.0, 0.0, 155.0, 0.0, 480.0, 860.0, 845.0, 930.0, 755.0, 135.0, 275.0, 115.0, 400.0, 255.0, 825.0, 170.0, 60.0, 90.0, 185.0, 80.0, 405.0, 60.0, 290.0, 790.0, 30.0, 210.0, 70.0, 145.0, 695.0, 290.0, 0.0, 65.0, 90.0, 70.0, 315.0, 945.0, 15.0, 70.0, 295.0, 0.0, 5.0, 385.0, 210.0, 230.0, 90.0, 470.0, 45.0, 475.0, 145.0, 290.0, 150.0, 50.0, 55.0, 90.0, 310.0, 205.0, 810.0, 395.0, 695.0, 0.0, 190.0, 700.0, 370.0, 240.0, 440.0, 75.0, 100.0, 0.0, 330.0, 65.0, 0.0, 0.0, 260.0, 100.0, 0.0, 0.0, 170.0, 480.0, 0.0, 0.0, 765.0, 195.0, 10.0, 110.0, 0.0, 0.0, 15.0, 5.0, 5.0, 65.0, 155.0, 140.0, 0.0, 5.0, 350.0, 0.0, 355.0, 60.0, 95.0, 0.0, 25.0, 0.0, 40.0, 275.0, 185.0, 35.0, 370.0, 275.0, 0.0, 320.0, 0.0, 235.0, 220.0, 130.0, 480.0, 205.0, 20.0, 215.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6952198667491041, "mean_inference_ms": 1.6261546188680376, "mean_action_processing_ms": 0.2743903057797443, "mean_env_wait_ms": 0.19357576309763544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007408738136291504, "StateBufferConnector_ms": 0.0034017562866210938, "ViewRequirementAgentConnector_ms": 0.1019812822341919}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -2599.0, "episode_return_mean": -151.61, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 76.85418175250885, "num_env_steps_trained_throughput_per_sec": 76.85418175250885, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 49367.839, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49367.773, "sample_time_ms": 1212.107, "learn_time_ms": 48136.83, "learn_throughput": 83.096, "synch_weights_time_ms": 16.131}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "ed30a_00000", "date": "2024-08-12_15-46-34", "timestamp": 1723491994, "time_this_iter_s": 52.11755585670471, "time_total_s": 5417.169637918472, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b20c4ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5417.169637918472, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 38.7472972972973, "ram_util_percent": 83.16216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6253688349767967, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.309847569844079, "policy_loss": -0.004852558418408667, "vf_loss": 4.314656866038287, "vf_explained_var": -0.0006792791621394889, "kl": 0.004615253598770651, "entropy": 0.3556590058027752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.492949489121715, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.555533036226949, "policy_loss": -0.011869907725070204, "vf_loss": 4.566745935041438, "vf_explained_var": 0.0069020997279535526, "kl": 0.008760072793660267, "entropy": 0.9936974823159516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -2599.0, "episode_reward_mean": -117.74, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 980.0}, "policy_reward_mean": {"prey_policy": -262.77, "predator_policy": 203.9}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-678.0, 190.0, -626.0, -1054.0, 112.0, -160.0, -90.0, 370.0, -454.0, 24.0, -75.0, -20.0, 358.0, -26.0, -27.0, -210.0, -60.0, 130.0, 369.0, -2599.0, -257.0, -269.0, -1170.0, 400.0, 214.0, -295.0, -1477.0, -415.0, -57.0, -199.0, -1553.0, 242.0, 236.0, -114.0, -1754.0, 112.0, 43.0, -892.0, 311.0, 208.0, -419.0, 298.0, -328.0, -145.0, -172.0, -470.0, -169.0, 175.0, 160.0, 336.0, -9.0, -177.0, -445.0, -668.0, -57.0, -152.0, 225.0, -30.0, 400.0, -32.0, 400.0, -314.0, 400.0, -1808.0, 256.0, 400.0, 376.0, 250.0, 211.0, 394.0, -20.0, -648.0, 209.0, 370.0, 22.0, 136.0, -110.0, -61.0, -201.0, 90.0, -246.0, 118.0, 126.0, 160.0, 274.0, 274.0, 279.0, -237.0, 258.0, 8.0, -57.0, -72.0, -71.0, 340.0, 370.0, 400.0, 8.0, 62.0, -566.0, -663.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-328.0, -845.0, -185.0, 200.0, -1120.0, -361.0, -1054.0, -735.0, -20.0, 2.0, -1120.0, 200.0, -669.0, 134.0, 200.0, 145.0, -350.0, -559.0, -141.0, -75.0, -218.0, -97.0, 167.0, -592.0, 200.0, 123.0, -361.0, -20.0, 13.0, -570.0, -229.0, -251.0, -647.0, 112.0, -295.0, 200.0, 200.0, 79.0, -2000.0, -1989.0, 200.0, -1307.0, -262.0, -372.0, -1021.0, -779.0, 200.0, 200.0, 200.0, -141.0, 200.0, -1835.0, -1252.0, -2000.0, 156.0, -1461.0, 200.0, -647.0, -1010.0, 156.0, -988.0, -1560.0, 123.0, -31.0, 200.0, -229.0, -339.0, -240.0, -1329.0, -1505.0, 200.0, -328.0, 24.0, -196.0, -185.0, -1692.0, 57.0, 189.0, 46.0, 2.0, -1879.0, 200.0, 57.0, 156.0, -339.0, -284.0, -174.0, -361.0, -251.0, -361.0, -713.0, -317.0, -845.0, 156.0, -405.0, 145.0, -174.0, 134.0, 200.0, -9.0, -20.0, -504.0, -1582.0, 200.0, 189.0, -1329.0, -1274.0, -284.0, 13.0, -680.0, 167.0, -834.0, 90.0, 35.0, -306.0, -119.0, 200.0, 200.0, -449.0, 57.0, 200.0, 200.0, -1076.0, 112.0, 200.0, 200.0, -1450.0, -1318.0, 178.0, -42.0, 200.0, 200.0, 189.0, 167.0, 79.0, 101.0, 200.0, -284.0, 200.0, 189.0, -251.0, -119.0, -361.0, -702.0, 57.0, 57.0, 200.0, 145.0, -394.0, 101.0, -284.0, 200.0, 189.0, -944.0, -493.0, 112.0, -262.0, -174.0, -438.0, 178.0, -372.0, -559.0, -317.0, 200.0, -119.0, 90.0, -229.0, 189.0, -31.0, 200.0, 57.0, 112.0, 123.0, 101.0, -152.0, -460.0, 123.0, 35.0, -702.0, 200.0, 200.0, -702.0, -42.0, -570.0, 145.0, -856.0, 90.0, 200.0, 200.0, 145.0, 200.0, 200.0, -174.0, 2.0, -548.0, 200.0, -779.0, -592.0, -372.0, -746.0], "policy_predator_policy_reward": [465.0, 30.0, 105.0, 70.0, 600.0, 255.0, 225.0, 510.0, 0.0, 130.0, 315.0, 445.0, 50.0, 395.0, 0.0, 25.0, 395.0, 60.0, 240.0, 0.0, 15.0, 225.0, 360.0, 45.0, 0.0, 35.0, 0.0, 355.0, 160.0, 370.0, 50.0, 220.0, 165.0, 310.0, 200.0, 25.0, 35.0, 55.0, 980.0, 410.0, 620.0, 230.0, 90.0, 275.0, 0.0, 630.0, 0.0, 0.0, 155.0, 0.0, 480.0, 860.0, 845.0, 930.0, 755.0, 135.0, 275.0, 115.0, 400.0, 255.0, 825.0, 170.0, 60.0, 90.0, 185.0, 80.0, 405.0, 60.0, 290.0, 790.0, 30.0, 210.0, 70.0, 145.0, 695.0, 290.0, 0.0, 65.0, 90.0, 70.0, 315.0, 945.0, 15.0, 70.0, 295.0, 0.0, 5.0, 385.0, 210.0, 230.0, 90.0, 470.0, 45.0, 475.0, 145.0, 290.0, 150.0, 50.0, 55.0, 90.0, 310.0, 205.0, 810.0, 395.0, 695.0, 0.0, 190.0, 700.0, 370.0, 240.0, 440.0, 75.0, 100.0, 0.0, 330.0, 65.0, 0.0, 0.0, 260.0, 100.0, 0.0, 0.0, 170.0, 480.0, 0.0, 0.0, 765.0, 195.0, 10.0, 110.0, 0.0, 0.0, 15.0, 5.0, 5.0, 65.0, 155.0, 140.0, 0.0, 5.0, 350.0, 0.0, 355.0, 60.0, 95.0, 0.0, 25.0, 0.0, 40.0, 275.0, 185.0, 35.0, 370.0, 275.0, 0.0, 320.0, 0.0, 235.0, 220.0, 130.0, 480.0, 205.0, 20.0, 215.0, 35.0, 120.0, 0.0, 200.0, 0.0, 105.0, 105.0, 0.0, 55.0, 0.0, 375.0, 0.0, 25.0, 75.0, 115.0, 395.0, 410.0, 35.0, 240.0, 300.0, 450.0, 190.0, 0.0, 50.0, 0.0, 25.0, 0.0, 0.0, 180.0, 0.0, 285.0, 125.0, 360.0, 445.0, 0.0, 455.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6946832454754602, "mean_inference_ms": 1.6243164946992181, "mean_action_processing_ms": 0.2742091801290425, "mean_env_wait_ms": 0.19339063299119177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006929278373718262, "StateBufferConnector_ms": 0.0033462047576904297, "ViewRequirementAgentConnector_ms": 0.10254514217376709}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -2599.0, "episode_return_mean": -117.74, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.11366638996901, "num_env_steps_trained_throughput_per_sec": 81.11366638996901, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 49416.444, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49416.396, "sample_time_ms": 1227.005, "learn_time_ms": 48168.949, "learn_throughput": 83.041, "synch_weights_time_ms": 17.791}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "ed30a_00000", "date": "2024-08-12_15-47-23", "timestamp": 1723492043, "time_this_iter_s": 49.33964419364929, "time_total_s": 5466.509282112122, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b01268b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5466.509282112122, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 32.69420289855073, "ram_util_percent": 83.2855072463768}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5980173505487896, "cur_kl_coeff": 0.004687499999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.398989433586282, "policy_loss": -0.004407415155902821, "vf_loss": 4.4033744367972885, "vf_explained_var": -0.0006765664254546796, "kl": 0.004781629821359662, "entropy": 0.38176483959748003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.568991031280901, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.249520336635529, "policy_loss": -0.01404220939677938, "vf_loss": 4.26294409661066, "vf_explained_var": 0.009768415317333565, "kl": 0.008246000083451588, "entropy": 0.9611265057924563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1808.0, "episode_reward_mean": -71.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -2000.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 945.0}, "policy_reward_mean": {"prey_policy": -234.445, "predator_policy": 198.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1170.0, 400.0, 214.0, -295.0, -1477.0, -415.0, -57.0, -199.0, -1553.0, 242.0, 236.0, -114.0, -1754.0, 112.0, 43.0, -892.0, 311.0, 208.0, -419.0, 298.0, -328.0, -145.0, -172.0, -470.0, -169.0, 175.0, 160.0, 336.0, -9.0, -177.0, -445.0, -668.0, -57.0, -152.0, 225.0, -30.0, 400.0, -32.0, 400.0, -314.0, 400.0, -1808.0, 256.0, 400.0, 376.0, 250.0, 211.0, 394.0, -20.0, -648.0, 209.0, 370.0, 22.0, 136.0, -110.0, -61.0, -201.0, 90.0, -246.0, 118.0, 126.0, 160.0, 274.0, 274.0, 279.0, -237.0, 258.0, 8.0, -57.0, -72.0, -71.0, 340.0, 370.0, 400.0, 8.0, 62.0, -566.0, -663.0, 250.0, 229.0, -50.0, 171.0, 4.0, 238.0, -237.0, 46.0, 142.0, -121.0, 400.0, 400.0, -382.0, -469.0, -263.0, -212.0, 400.0, -427.0, -467.0, 286.0, 28.0, -428.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1021.0, -779.0, 200.0, 200.0, 200.0, -141.0, 200.0, -1835.0, -1252.0, -2000.0, 156.0, -1461.0, 200.0, -647.0, -1010.0, 156.0, -988.0, -1560.0, 123.0, -31.0, 200.0, -229.0, -339.0, -240.0, -1329.0, -1505.0, 200.0, -328.0, 24.0, -196.0, -185.0, -1692.0, 57.0, 189.0, 46.0, 2.0, -1879.0, 200.0, 57.0, 156.0, -339.0, -284.0, -174.0, -361.0, -251.0, -361.0, -713.0, -317.0, -845.0, 156.0, -405.0, 145.0, -174.0, 134.0, 200.0, -9.0, -20.0, -504.0, -1582.0, 200.0, 189.0, -1329.0, -1274.0, -284.0, 13.0, -680.0, 167.0, -834.0, 90.0, 35.0, -306.0, -119.0, 200.0, 200.0, -449.0, 57.0, 200.0, 200.0, -1076.0, 112.0, 200.0, 200.0, -1450.0, -1318.0, 178.0, -42.0, 200.0, 200.0, 189.0, 167.0, 79.0, 101.0, 200.0, -284.0, 200.0, 189.0, -251.0, -119.0, -361.0, -702.0, 57.0, 57.0, 200.0, 145.0, -394.0, 101.0, -284.0, 200.0, 189.0, -944.0, -493.0, 112.0, -262.0, -174.0, -438.0, 178.0, -372.0, -559.0, -317.0, 200.0, -119.0, 90.0, -229.0, 189.0, -31.0, 200.0, 57.0, 112.0, 123.0, 101.0, -152.0, -460.0, 123.0, 35.0, -702.0, 200.0, 200.0, -702.0, -42.0, -570.0, 145.0, -856.0, 90.0, 200.0, 200.0, 145.0, 200.0, 200.0, -174.0, 2.0, -548.0, 200.0, -779.0, -592.0, -372.0, -746.0, -75.0, 200.0, -196.0, 200.0, 90.0, -515.0, 200.0, -229.0, -350.0, 79.0, 200.0, -97.0, -460.0, -152.0, 46.0, -295.0, 35.0, 2.0, 200.0, -856.0, 200.0, 200.0, 200.0, 200.0, -1582.0, 200.0, -1835.0, 156.0, -1483.0, 200.0, -724.0, 2.0, 200.0, 200.0, -493.0, -394.0, -317.0, -515.0, 57.0, 134.0, 200.0, -647.0, -1208.0, 90.0], "policy_predator_policy_reward": [0.0, 630.0, 0.0, 0.0, 155.0, 0.0, 480.0, 860.0, 845.0, 930.0, 755.0, 135.0, 275.0, 115.0, 400.0, 255.0, 825.0, 170.0, 60.0, 90.0, 185.0, 80.0, 405.0, 60.0, 290.0, 790.0, 30.0, 210.0, 70.0, 145.0, 695.0, 290.0, 0.0, 65.0, 90.0, 70.0, 315.0, 945.0, 15.0, 70.0, 295.0, 0.0, 5.0, 385.0, 210.0, 230.0, 90.0, 470.0, 45.0, 475.0, 145.0, 290.0, 150.0, 50.0, 55.0, 90.0, 310.0, 205.0, 810.0, 395.0, 695.0, 0.0, 190.0, 700.0, 370.0, 240.0, 440.0, 75.0, 100.0, 0.0, 330.0, 65.0, 0.0, 0.0, 260.0, 100.0, 0.0, 0.0, 170.0, 480.0, 0.0, 0.0, 765.0, 195.0, 10.0, 110.0, 0.0, 0.0, 15.0, 5.0, 5.0, 65.0, 155.0, 140.0, 0.0, 5.0, 350.0, 0.0, 355.0, 60.0, 95.0, 0.0, 25.0, 0.0, 40.0, 275.0, 185.0, 35.0, 370.0, 275.0, 0.0, 320.0, 0.0, 235.0, 220.0, 130.0, 480.0, 205.0, 20.0, 215.0, 35.0, 120.0, 0.0, 200.0, 0.0, 105.0, 105.0, 0.0, 55.0, 0.0, 375.0, 0.0, 25.0, 75.0, 115.0, 395.0, 410.0, 35.0, 240.0, 300.0, 450.0, 190.0, 0.0, 50.0, 0.0, 25.0, 0.0, 0.0, 180.0, 0.0, 285.0, 125.0, 360.0, 445.0, 0.0, 455.0, 0.0, 125.0, 180.0, 45.0, 80.0, 295.0, 85.0, 115.0, 265.0, 10.0, 55.0, 80.0, 330.0, 45.0, 0.0, 295.0, 105.0, 0.0, 360.0, 175.0, 0.0, 0.0, 0.0, 0.0, 725.0, 275.0, 485.0, 725.0, 255.0, 765.0, 105.0, 405.0, 0.0, 0.0, 35.0, 425.0, 0.0, 365.0, 0.0, 95.0, 170.0, 305.0, 50.0, 640.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6947564286071455, "mean_inference_ms": 1.6239047237978497, "mean_action_processing_ms": 0.27437153498811406, "mean_env_wait_ms": 0.1934547678563423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011585474014282227, "StateBufferConnector_ms": 0.003762364387512207, "ViewRequirementAgentConnector_ms": 0.14142775535583496}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": -1808.0, "episode_return_mean": -71.84, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.71129944648601, "num_env_steps_trained_throughput_per_sec": 81.71129944648601, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 49441.106, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49441.058, "sample_time_ms": 1287.21, "learn_time_ms": 48134.963, "learn_throughput": 83.1, "synch_weights_time_ms": 16.607}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "ed30a_00000", "date": "2024-08-12_15-48-12", "timestamp": 1723492092, "time_this_iter_s": 48.9984769821167, "time_total_s": 5515.507759094238, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x32e701670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5515.507759094238, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 33.92714285714286, "ram_util_percent": 83.02000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7834604528530564, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.145197347736863, "policy_loss": -0.005674018225972614, "vf_loss": 4.150857273106853, "vf_explained_var": 0.0013148929391588484, "kl": 0.006012744203337591, "entropy": 0.3896838456234604, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.026679084382991, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.699602854945672, "policy_loss": -0.016077885988153635, "vf_loss": 4.714861392344116, "vf_explained_var": 0.011273064499809629, "kl": 0.010924721279641957, "entropy": 0.939361729823723, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1808.0, "episode_reward_mean": -16.09, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -182.195, "predator_policy": 174.15}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-419.0, 298.0, -328.0, -145.0, -172.0, -470.0, -169.0, 175.0, 160.0, 336.0, -9.0, -177.0, -445.0, -668.0, -57.0, -152.0, 225.0, -30.0, 400.0, -32.0, 400.0, -314.0, 400.0, -1808.0, 256.0, 400.0, 376.0, 250.0, 211.0, 394.0, -20.0, -648.0, 209.0, 370.0, 22.0, 136.0, -110.0, -61.0, -201.0, 90.0, -246.0, 118.0, 126.0, 160.0, 274.0, 274.0, 279.0, -237.0, 258.0, 8.0, -57.0, -72.0, -71.0, 340.0, 370.0, 400.0, 8.0, 62.0, -566.0, -663.0, 250.0, 229.0, -50.0, 171.0, 4.0, 238.0, -237.0, 46.0, 142.0, -121.0, 400.0, 400.0, -382.0, -469.0, -263.0, -212.0, 400.0, -427.0, -467.0, 286.0, 28.0, -428.0, 40.0, 376.0, -353.0, -81.0, 349.0, -162.0, 400.0, 400.0, 400.0, -1498.0, 119.0, -835.0, 394.0, -731.0, 173.0, 295.0, 94.0, 35.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1879.0, 200.0, 57.0, 156.0, -339.0, -284.0, -174.0, -361.0, -251.0, -361.0, -713.0, -317.0, -845.0, 156.0, -405.0, 145.0, -174.0, 134.0, 200.0, -9.0, -20.0, -504.0, -1582.0, 200.0, 189.0, -1329.0, -1274.0, -284.0, 13.0, -680.0, 167.0, -834.0, 90.0, 35.0, -306.0, -119.0, 200.0, 200.0, -449.0, 57.0, 200.0, 200.0, -1076.0, 112.0, 200.0, 200.0, -1450.0, -1318.0, 178.0, -42.0, 200.0, 200.0, 189.0, 167.0, 79.0, 101.0, 200.0, -284.0, 200.0, 189.0, -251.0, -119.0, -361.0, -702.0, 57.0, 57.0, 200.0, 145.0, -394.0, 101.0, -284.0, 200.0, 189.0, -944.0, -493.0, 112.0, -262.0, -174.0, -438.0, 178.0, -372.0, -559.0, -317.0, 200.0, -119.0, 90.0, -229.0, 189.0, -31.0, 200.0, 57.0, 112.0, 123.0, 101.0, -152.0, -460.0, 123.0, 35.0, -702.0, 200.0, 200.0, -702.0, -42.0, -570.0, 145.0, -856.0, 90.0, 200.0, 200.0, 145.0, 200.0, 200.0, -174.0, 2.0, -548.0, 200.0, -779.0, -592.0, -372.0, -746.0, -75.0, 200.0, -196.0, 200.0, 90.0, -515.0, 200.0, -229.0, -350.0, 79.0, 200.0, -97.0, -460.0, -152.0, 46.0, -295.0, 35.0, 2.0, 200.0, -856.0, 200.0, 200.0, 200.0, 200.0, -1582.0, 200.0, -1835.0, 156.0, -1483.0, 200.0, -724.0, 2.0, 200.0, 200.0, -493.0, -394.0, -317.0, -515.0, 57.0, 134.0, 200.0, -647.0, -1208.0, 90.0, 200.0, -460.0, 200.0, 156.0, -537.0, -196.0, 145.0, -581.0, 79.0, 200.0, -9.0, -603.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1142.0, -1461.0, 189.0, -295.0, -603.0, -647.0, 200.0, 189.0, 200.0, -1901.0, 112.0, -174.0, 134.0, -119.0, -196.0, 35.0, -680.0, 200.0], "policy_predator_policy_reward": [315.0, 945.0, 15.0, 70.0, 295.0, 0.0, 5.0, 385.0, 210.0, 230.0, 90.0, 470.0, 45.0, 475.0, 145.0, 290.0, 150.0, 50.0, 55.0, 90.0, 310.0, 205.0, 810.0, 395.0, 695.0, 0.0, 190.0, 700.0, 370.0, 240.0, 440.0, 75.0, 100.0, 0.0, 330.0, 65.0, 0.0, 0.0, 260.0, 100.0, 0.0, 0.0, 170.0, 480.0, 0.0, 0.0, 765.0, 195.0, 10.0, 110.0, 0.0, 0.0, 15.0, 5.0, 5.0, 65.0, 155.0, 140.0, 0.0, 5.0, 350.0, 0.0, 355.0, 60.0, 95.0, 0.0, 25.0, 0.0, 40.0, 275.0, 185.0, 35.0, 370.0, 275.0, 0.0, 320.0, 0.0, 235.0, 220.0, 130.0, 480.0, 205.0, 20.0, 215.0, 35.0, 120.0, 0.0, 200.0, 0.0, 105.0, 105.0, 0.0, 55.0, 0.0, 375.0, 0.0, 25.0, 75.0, 115.0, 395.0, 410.0, 35.0, 240.0, 300.0, 450.0, 190.0, 0.0, 50.0, 0.0, 25.0, 0.0, 0.0, 180.0, 0.0, 285.0, 125.0, 360.0, 445.0, 0.0, 455.0, 0.0, 125.0, 180.0, 45.0, 80.0, 295.0, 85.0, 115.0, 265.0, 10.0, 55.0, 80.0, 330.0, 45.0, 0.0, 295.0, 105.0, 0.0, 360.0, 175.0, 0.0, 0.0, 0.0, 0.0, 725.0, 275.0, 485.0, 725.0, 255.0, 765.0, 105.0, 405.0, 0.0, 0.0, 35.0, 425.0, 0.0, 365.0, 0.0, 95.0, 170.0, 305.0, 50.0, 640.0, 145.0, 155.0, 20.0, 0.0, 335.0, 45.0, 10.0, 345.0, 35.0, 35.0, 0.0, 450.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 400.0, 705.0, 225.0, 0.0, 0.0, 415.0, 0.0, 5.0, 955.0, 15.0, 120.0, 115.0, 135.0, 145.0, 75.0, 180.0, 220.0, 295.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6948563946548519, "mean_inference_ms": 1.6241326181495785, "mean_action_processing_ms": 0.27444097941681306, "mean_env_wait_ms": 0.19348122387991196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010859847068786621, "StateBufferConnector_ms": 0.0037478208541870117, "ViewRequirementAgentConnector_ms": 0.14177119731903076}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": -1808.0, "episode_return_mean": -16.09, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 81.24850530365951, "num_env_steps_trained_throughput_per_sec": 81.24850530365951, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 49432.61, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49432.563, "sample_time_ms": 1275.928, "learn_time_ms": 48138.614, "learn_throughput": 83.093, "synch_weights_time_ms": 15.873}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "ed30a_00000", "date": "2024-08-12_15-49-02", "timestamp": 1723492142, "time_this_iter_s": 49.26076602935791, "time_total_s": 5564.768525123596, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b00a31f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5564.768525123596, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 33.36666666666667, "ram_util_percent": 82.87246376811594}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.869700737668093, "cur_kl_coeff": 0.0023437499999999995, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.443347470217912, "policy_loss": -0.00596012744249372, "vf_loss": 5.44929020291283, "vf_explained_var": 0.0019183464151210886, "kl": 0.007426079263607075, "entropy": 0.4301323483229945, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.565374546360086, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.92937546318801, "policy_loss": -0.015362342833615247, "vf_loss": 4.9439133568415565, "vf_explained_var": 0.0058797840088132824, "kl": 0.010992625369943236, "entropy": 0.9506054864043281, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": -1808.0, "episode_reward_mean": -33.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -1901.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 955.0}, "policy_reward_mean": {"prey_policy": -180.545, "predator_policy": 163.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1808.0, 256.0, 400.0, 376.0, 250.0, 211.0, 394.0, -20.0, -648.0, 209.0, 370.0, 22.0, 136.0, -110.0, -61.0, -201.0, 90.0, -246.0, 118.0, 126.0, 160.0, 274.0, 274.0, 279.0, -237.0, 258.0, 8.0, -57.0, -72.0, -71.0, 340.0, 370.0, 400.0, 8.0, 62.0, -566.0, -663.0, 250.0, 229.0, -50.0, 171.0, 4.0, 238.0, -237.0, 46.0, 142.0, -121.0, 400.0, 400.0, -382.0, -469.0, -263.0, -212.0, 400.0, -427.0, -467.0, 286.0, 28.0, -428.0, 40.0, 376.0, -353.0, -81.0, 349.0, -162.0, 400.0, 400.0, 400.0, -1498.0, 119.0, -835.0, 394.0, -731.0, 173.0, 295.0, 94.0, 35.0, 400.0, 140.0, -849.0, -1221.0, -344.0, 310.0, -462.0, -41.0, -361.0, -643.0, 400.0, 377.0, 369.0, -1583.0, 376.0, 400.0, 214.0, 223.0, -26.0, -314.0, -905.0, 262.0, 310.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-1450.0, -1318.0, 178.0, -42.0, 200.0, 200.0, 189.0, 167.0, 79.0, 101.0, 200.0, -284.0, 200.0, 189.0, -251.0, -119.0, -361.0, -702.0, 57.0, 57.0, 200.0, 145.0, -394.0, 101.0, -284.0, 200.0, 189.0, -944.0, -493.0, 112.0, -262.0, -174.0, -438.0, 178.0, -372.0, -559.0, -317.0, 200.0, -119.0, 90.0, -229.0, 189.0, -31.0, 200.0, 57.0, 112.0, 123.0, 101.0, -152.0, -460.0, 123.0, 35.0, -702.0, 200.0, 200.0, -702.0, -42.0, -570.0, 145.0, -856.0, 90.0, 200.0, 200.0, 145.0, 200.0, 200.0, -174.0, 2.0, -548.0, 200.0, -779.0, -592.0, -372.0, -746.0, -75.0, 200.0, -196.0, 200.0, 90.0, -515.0, 200.0, -229.0, -350.0, 79.0, 200.0, -97.0, -460.0, -152.0, 46.0, -295.0, 35.0, 2.0, 200.0, -856.0, 200.0, 200.0, 200.0, 200.0, -1582.0, 200.0, -1835.0, 156.0, -1483.0, 200.0, -724.0, 2.0, 200.0, 200.0, -493.0, -394.0, -317.0, -515.0, 57.0, 134.0, 200.0, -647.0, -1208.0, 90.0, 200.0, -460.0, 200.0, 156.0, -537.0, -196.0, 145.0, -581.0, 79.0, 200.0, -9.0, -603.0, 200.0, 200.0, 200.0, 200.0, 200.0, 200.0, -1142.0, -1461.0, 189.0, -295.0, -603.0, -647.0, 200.0, 189.0, 200.0, -1901.0, 112.0, -174.0, 134.0, -119.0, -196.0, 35.0, -680.0, 200.0, 200.0, 200.0, 189.0, -284.0, -570.0, -724.0, -933.0, -1538.0, -515.0, -449.0, 200.0, 35.0, -240.0, -647.0, -581.0, 145.0, -515.0, -471.0, -350.0, -1098.0, 200.0, 200.0, 112.0, 200.0, 200.0, 134.0, -1538.0, -1010.0, 200.0, 156.0, 200.0, 200.0, 145.0, -86.0, -251.0, 189.0, -174.0, -152.0, 79.0, -988.0, -460.0, -1120.0, -53.0, 200.0, 200.0, 35.0], "policy_predator_policy_reward": [765.0, 195.0, 10.0, 110.0, 0.0, 0.0, 15.0, 5.0, 5.0, 65.0, 155.0, 140.0, 0.0, 5.0, 350.0, 0.0, 355.0, 60.0, 95.0, 0.0, 25.0, 0.0, 40.0, 275.0, 185.0, 35.0, 370.0, 275.0, 0.0, 320.0, 0.0, 235.0, 220.0, 130.0, 480.0, 205.0, 20.0, 215.0, 35.0, 120.0, 0.0, 200.0, 0.0, 105.0, 105.0, 0.0, 55.0, 0.0, 375.0, 0.0, 25.0, 75.0, 115.0, 395.0, 410.0, 35.0, 240.0, 300.0, 450.0, 190.0, 0.0, 50.0, 0.0, 25.0, 0.0, 0.0, 180.0, 0.0, 285.0, 125.0, 360.0, 445.0, 0.0, 455.0, 0.0, 125.0, 180.0, 45.0, 80.0, 295.0, 85.0, 115.0, 265.0, 10.0, 55.0, 80.0, 330.0, 45.0, 0.0, 295.0, 105.0, 0.0, 360.0, 175.0, 0.0, 0.0, 0.0, 0.0, 725.0, 275.0, 485.0, 725.0, 255.0, 765.0, 105.0, 405.0, 0.0, 0.0, 35.0, 425.0, 0.0, 365.0, 0.0, 95.0, 170.0, 305.0, 50.0, 640.0, 145.0, 155.0, 20.0, 0.0, 335.0, 45.0, 10.0, 345.0, 35.0, 35.0, 0.0, 450.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 400.0, 705.0, 225.0, 0.0, 0.0, 415.0, 0.0, 5.0, 955.0, 15.0, 120.0, 115.0, 135.0, 145.0, 75.0, 180.0, 220.0, 295.0, 0.0, 0.0, 15.0, 220.0, 415.0, 30.0, 345.0, 905.0, 295.0, 325.0, 0.0, 75.0, 140.0, 285.0, 70.0, 325.0, 305.0, 320.0, 215.0, 590.0, 0.0, 0.0, 35.0, 30.0, 10.0, 25.0, 360.0, 605.0, 0.0, 20.0, 0.0, 0.0, 35.0, 120.0, 140.0, 145.0, 205.0, 95.0, 470.0, 125.0, 35.0, 640.0, 0.0, 115.0, 75.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6944053927394246, "mean_inference_ms": 1.6238016439823693, "mean_action_processing_ms": 0.27454484556380004, "mean_env_wait_ms": 0.19347079301444828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008737802505493164, "StateBufferConnector_ms": 0.003779292106628418, "ViewRequirementAgentConnector_ms": 0.14248549938201904}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": -1808.0, "episode_return_mean": -33.84, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 82.88351028473946, "num_env_steps_trained_throughput_per_sec": 82.88351028473946, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 49222.816, "restore_workers_time_ms": 0.014, "training_step_time_ms": 49222.769, "sample_time_ms": 1262.824, "learn_time_ms": 47941.794, "learn_throughput": 83.435, "synch_weights_time_ms": 15.997}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": true, "training_iteration": 100, "trial_id": "ed30a_00000", "date": "2024-08-12_15-49-50", "timestamp": 1723492190, "time_this_iter_s": 48.30780506134033, "time_total_s": 5613.0763301849365, "pid": 52161, "hostname": "joys-mbp.lan", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 20, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b12ae3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 5613.0763301849365, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 31.563768115942036, "ram_util_percent": 82.89420289855072}}
